{
  "table_of_contents": [
    {
      "title": "Legendre PRF (Multiple) Key Attacks and the Power of Preprocessing",
      "heading_level": null,
      "page_id": 0,
      "polygon": [
        [
          108.09068010075566,
          60.025390625
        ],
        [
          486.4080604534005,
          58.380859375
        ],
        [
          486.4080604534005,
          109.361328125
        ],
        [
          108.09068010075566,
          111.005859375
        ]
      ]
    },
    {
      "title": "I. Introduction",
      "heading_level": null,
      "page_id": 0,
      "polygon": [
        [
          124.60453400503778,
          654.9345703125
        ],
        [
          206.42317380352642,
          654.9345703125
        ],
        [
          206.42317380352642,
          665.8023152270703
        ],
        [
          124.263671875,
          665.8023152270703
        ]
      ]
    },
    {
      "title": "A. Motivation",
      "heading_level": null,
      "page_id": 0,
      "polygon": [
        [
          39.78337531486146,
          670.5576171875
        ],
        [
          104.18359375,
          668.9130859375
        ],
        [
          104.18359375,
          680.0480854853072
        ],
        [
          39.78337531486146,
          680.0480854853072
        ]
      ]
    },
    {
      "title": "B. Related work on Legendre PRF security",
      "heading_level": null,
      "page_id": 0,
      "polygon": [
        [
          302.947265625,
          418.37577916295635
        ],
        [
          492.4130982367758,
          418.1220703125
        ],
        [
          492.4130982367758,
          428.1228851291184
        ],
        [
          301.783203125,
          428.8115234375
        ]
      ]
    },
    {
      "title": "C. Oracle-access based Attack Model",
      "heading_level": null,
      "page_id": 1,
      "polygon": [
        [
          40.53400503778337,
          422.12466607301866
        ],
        [
          201.16876574307304,
          420.5888671875
        ],
        [
          201.16876574307304,
          431.1219946571683
        ],
        [
          39.869140625,
          431.2783203125
        ]
      ]
    },
    {
      "title": "D. Our contributions",
      "heading_level": null,
      "page_id": 1,
      "polygon": [
        [
          303.2544080604534,
          180.8984375
        ],
        [
          397.8337531486146,
          179.25390625
        ],
        [
          397.0831234256927,
          191.94300979519144
        ],
        [
          303.2544080604534,
          191.19323241317898
        ]
      ]
    },
    {
      "title": "II. LEGENDRE PRF BASICS",
      "heading_level": null,
      "page_id": 3,
      "polygon": [
        [
          100.58438287153652,
          154.4541406945681
        ],
        [
          230.44332493702768,
          153.763671875
        ],
        [
          230.44332493702768,
          163.45146927871772
        ],
        [
          100.58438287153652,
          163.630859375
        ]
      ]
    },
    {
      "title": "III. PRECOMPUTATION ATTACK",
      "heading_level": null,
      "page_id": 3,
      "polygon": [
        [
          356.203125,
          582.1640625
        ],
        [
          502.1712846347607,
          582.1640625
        ],
        [
          502.1712846347607,
          592.3241317898486
        ],
        [
          356.203125,
          592.3241317898486
        ]
      ]
    },
    {
      "title": "A. Random Walks - Precomputation and Online",
      "heading_level": null,
      "page_id": 4,
      "polygon": [
        [
          39.032745591939545,
          229.43187889581478
        ],
        [
          253.71284634760704,
          229.43187889581478
        ],
        [
          253.71284634760704,
          240.5126953125
        ],
        [
          39.032745591939545,
          240.5126953125
        ]
      ]
    },
    {
      "title": "B. Colliding Walks solve Legendre.",
      "heading_level": null,
      "page_id": 4,
      "polygon": [
        [
          39.032745591939545,
          677.0489759572573
        ],
        [
          193.6624685138539,
          677.0489759572573
        ],
        [
          193.6624685138539,
          687.5458593054318
        ],
        [
          39.032745591939545,
          687.8251953125
        ]
      ]
    },
    {
      "title": "Algorithm 1: Pre-Legendre",
      "heading_level": null,
      "page_id": 5,
      "polygon": [
        [
          44.525390625,
          56.23330365093499
        ],
        [
          185.958984375,
          56.23330365093499
        ],
        [
          184.794921875,
          69.892578125
        ],
        [
          43.361328125,
          69.892578125
        ]
      ]
    },
    {
      "title": "IV. MULTIPLE-KEY PRECOMPUTATION ATTACK",
      "heading_level": null,
      "page_id": 5,
      "polygon": [
        [
          319.53515625,
          673.8466796875
        ],
        [
          538.2015113350126,
          672.2021484375
        ],
        [
          538.2015113350126,
          683.047195013357
        ],
        [
          319.53515625,
          683.047195013357
        ]
      ]
    },
    {
      "title": "V. Multiple-Key Attack (without Precomputation)",
      "heading_level": null,
      "page_id": 6,
      "polygon": [
        [
          340.7858942065491,
          698.5146484375
        ],
        [
          518.6851385390428,
          696.8701171875
        ],
        [
          518.6851385390428,
          719.786286731968
        ],
        [
          340.7858942065491,
          720.7158203125
        ]
      ]
    },
    {
      "title": "A. High-Level idea",
      "heading_level": null,
      "page_id": 7,
      "polygon": [
        [
          39.032745591939545,
          524.0943900267141
        ],
        [
          123.85390428211586,
          523.3720703125
        ],
        [
          123.85390428211586,
          533.8414959928762
        ],
        [
          39.032745591939545,
          534.0615234375
        ]
      ]
    },
    {
      "title": "B. How to detect collisions",
      "heading_level": null,
      "page_id": 7,
      "polygon": [
        [
          303.2544080604534,
          303.416015625
        ],
        [
          422.60453400503775,
          301.771484375
        ],
        [
          422.60453400503775,
          311.9073909171861
        ],
        [
          302.947265625,
          311.9073909171861
        ]
      ]
    },
    {
      "title": "VI. EXPERIMENTS",
      "heading_level": null,
      "page_id": 9,
      "polygon": [
        [
          386.46875,
          377.88780053428314
        ],
        [
          472.1460957178841,
          376.59765625
        ],
        [
          472.1460957178841,
          386.88512911843276
        ],
        [
          386.46875,
          386.88512911843276
        ]
      ]
    },
    {
      "title": "REFERENCES",
      "heading_level": null,
      "page_id": 10,
      "polygon": [
        [
          135.8639798488665,
          476.9140625
        ],
        [
          195.91435768261965,
          475.26953125
        ],
        [
          195.91435768261965,
          486.60552092609083
        ],
        [
          135.03125,
          486.78125
        ]
      ]
    }
  ],
  "page_stats": [
    {
      "page_id": 0,
      "text_extraction_method": "surya",
      "block_counts": [
        [
          "Span",
          141
        ],
        [
          "Line",
          124
        ],
        [
          "Text",
          19
        ],
        [
          "SectionHeader",
          4
        ],
        [
          "Equation",
          3
        ]
      ],
      "block_metadata": {
        "llm_request_count": 0,
        "llm_error_count": 0,
        "llm_tokens_used": 0,
        "previous_text": "",
        "previous_type": "",
        "previous_order": 0
      }
    },
    {
      "page_id": 1,
      "text_extraction_method": "surya",
      "block_counts": [
        [
          "Span",
          179
        ],
        [
          "Line",
          129
        ],
        [
          "Text",
          16
        ],
        [
          "SectionHeader",
          2
        ],
        [
          "PageFooter",
          1
        ]
      ],
      "block_metadata": {
        "llm_request_count": 0,
        "llm_error_count": 0,
        "llm_tokens_used": 0,
        "previous_text": "",
        "previous_type": "",
        "previous_order": 0
      }
    },
    {
      "page_id": 2,
      "text_extraction_method": "surya",
      "block_counts": [
        [
          "Line",
          137
        ],
        [
          "Span",
          89
        ],
        [
          "Text",
          15
        ],
        [
          "PageFooter",
          1
        ]
      ],
      "block_metadata": {
        "llm_request_count": 0,
        "llm_error_count": 0,
        "llm_tokens_used": 0,
        "previous_text": "",
        "previous_type": "",
        "previous_order": 0
      }
    },
    {
      "page_id": 3,
      "text_extraction_method": "surya",
      "block_counts": [
        [
          "Span",
          175
        ],
        [
          "Line",
          119
        ],
        [
          "Text",
          18
        ],
        [
          "Equation",
          5
        ],
        [
          "Reference",
          5
        ],
        [
          "SectionHeader",
          2
        ],
        [
          "PageFooter",
          1
        ]
      ],
      "block_metadata": {
        "llm_request_count": 0,
        "llm_error_count": 0,
        "llm_tokens_used": 0,
        "previous_text": "",
        "previous_type": "",
        "previous_order": 0
      }
    },
    {
      "page_id": 4,
      "text_extraction_method": "surya",
      "block_counts": [
        [
          "Span",
          162
        ],
        [
          "Line",
          105
        ],
        [
          "Text",
          15
        ],
        [
          "Equation",
          7
        ],
        [
          "Reference",
          6
        ],
        [
          "SectionHeader",
          2
        ],
        [
          "Figure",
          1
        ],
        [
          "Caption",
          1
        ],
        [
          "PageFooter",
          1
        ],
        [
          "FigureGroup",
          1
        ]
      ],
      "block_metadata": {
        "llm_request_count": 0,
        "llm_error_count": 0,
        "llm_tokens_used": 0,
        "previous_text": "",
        "previous_type": "",
        "previous_order": 0
      }
    },
    {
      "page_id": 5,
      "text_extraction_method": "surya",
      "block_counts": [
        [
          "Span",
          171
        ],
        [
          "Line",
          106
        ],
        [
          "Text",
          13
        ],
        [
          "Equation",
          5
        ],
        [
          "Reference",
          5
        ],
        [
          "SectionHeader",
          2
        ],
        [
          "Code",
          1
        ],
        [
          "Figure",
          1
        ],
        [
          "Caption",
          1
        ],
        [
          "PageFooter",
          1
        ],
        [
          "FigureGroup",
          1
        ]
      ],
      "block_metadata": {
        "llm_request_count": 0,
        "llm_error_count": 0,
        "llm_tokens_used": 0,
        "previous_text": "",
        "previous_type": "",
        "previous_order": 0
      }
    },
    {
      "page_id": 6,
      "text_extraction_method": "surya",
      "block_counts": [
        [
          "Span",
          220
        ],
        [
          "Line",
          116
        ],
        [
          "Text",
          14
        ],
        [
          "Reference",
          5
        ],
        [
          "Equation",
          4
        ],
        [
          "Code",
          2
        ],
        [
          "SectionHeader",
          1
        ],
        [
          "PageFooter",
          1
        ]
      ],
      "block_metadata": {
        "llm_request_count": 0,
        "llm_error_count": 0,
        "llm_tokens_used": 0,
        "previous_text": "",
        "previous_type": "",
        "previous_order": 0
      }
    },
    {
      "page_id": 7,
      "text_extraction_method": "surya",
      "block_counts": [
        [
          "Span",
          167
        ],
        [
          "Line",
          102
        ],
        [
          "Text",
          15
        ],
        [
          "Equation",
          6
        ],
        [
          "SectionHeader",
          2
        ],
        [
          "Reference",
          2
        ],
        [
          "Picture",
          1
        ],
        [
          "Caption",
          1
        ],
        [
          "PageFooter",
          1
        ],
        [
          "PictureGroup",
          1
        ]
      ],
      "block_metadata": {
        "llm_request_count": 0,
        "llm_error_count": 0,
        "llm_tokens_used": 0,
        "previous_text": "",
        "previous_type": "",
        "previous_order": 0
      }
    },
    {
      "page_id": 8,
      "text_extraction_method": "surya",
      "block_counts": [
        [
          "Span",
          225
        ],
        [
          "Line",
          99
        ],
        [
          "Text",
          26
        ],
        [
          "Reference",
          6
        ],
        [
          "Equation",
          5
        ],
        [
          "Code",
          2
        ],
        [
          "PageFooter",
          1
        ]
      ],
      "block_metadata": {
        "llm_request_count": 0,
        "llm_error_count": 0,
        "llm_tokens_used": 0,
        "previous_text": "",
        "previous_type": "",
        "previous_order": 0
      }
    },
    {
      "page_id": 9,
      "text_extraction_method": "surya",
      "block_counts": [
        [
          "Line",
          112
        ],
        [
          "Span",
          103
        ],
        [
          "Text",
          14
        ],
        [
          "Equation",
          6
        ],
        [
          "Reference",
          2
        ],
        [
          "Figure",
          1
        ],
        [
          "Caption",
          1
        ],
        [
          "SectionHeader",
          1
        ],
        [
          "PageFooter",
          1
        ],
        [
          "FigureGroup",
          1
        ]
      ],
      "block_metadata": {
        "llm_request_count": 0,
        "llm_error_count": 0,
        "llm_tokens_used": 0,
        "previous_text": "",
        "previous_type": "",
        "previous_order": 0
      }
    },
    {
      "page_id": 10,
      "text_extraction_method": "surya",
      "block_counts": [
        [
          "Line",
          199
        ],
        [
          "Span",
          108
        ],
        [
          "ListItem",
          31
        ],
        [
          "Reference",
          27
        ],
        [
          "ListGroup",
          3
        ],
        [
          "SectionHeader",
          1
        ],
        [
          "PageFooter",
          1
        ]
      ],
      "block_metadata": {
        "llm_request_count": 0,
        "llm_error_count": 0,
        "llm_tokens_used": 0,
        "previous_text": "",
        "previous_type": "",
        "previous_order": 0
      }
    }
  ],
  "debug_data_path": "debug_data/2021_645",
  "eprint": {
    "title": "Legendre PRF (Multiple) Key Attacks and the Power of Preprocessing",
    "authors": [
      {
        "name": "Alexander May",
        "email": "may@rub",
        "affiliation": ""
      },
      {
        "name": "Floyd Zweydinger",
        "email": "zweydinger@rub",
        "affiliation": ""
      }
    ],
    "abstract": "Due to its amazing speed and multiplicative properties the Legendre PRF recently finds widespread applications e.g. in Ethereum 2.0, multiparty computation and in the quantum-secure signature proposal LegRoast. However, its security is not yet extensively studied.\n\nThe Legendre PRF computes for a key $k$ on input $x$ the Legendre symbol $L_k(x) = \\left( \\frac {x+k} {p} \\right)$ in some finite field $\\F_p$. As standard notion, PRF security is analysed by giving an attacker oracle access to $L_k(\\cdot)$. Khovratovich's collision-based algorithm recovers $k$ using $L_k(\\cdot)$ in time $\\sqrt{p}$ with constant memory. It is a major open problem whether this birthday-bound complexity can be beaten.\n\nWe show a somewhat surprising wide-ranging analogy between the discrete logarithm problem and Legendre symbol computations. This analogy allows us to adapt various algorithmic ideas from the discrete logarithm setting.\n\nMore precisely, we present a small memory multiple-key attack on $m$ Legendre keys $k_1, \\ldots, k_m$ in time $\\sqrt{mp}$, i.e. with amortized cost $\\sqrt{p/m}$ per key. This multiple-key attack might be of interest in the Ethereum context, since recovering many keys simultaneously maximizes an attacker's profit.\n\nMoreover, we show that the Legendre PRF admits precomputation attacks, where the precomputation depends on the public $p$ only -- and not on a key $k$. Namely, an attacker may compute e.g. in precomputation time $p^{\\frac 2 3}$ a hint of size $p^{\\frac 1 3}$. On receiving access to $L_k(\\cdot)$ in an online phase, the attacker then uses the hint to recover the desired key $k$ in time only $p^{\\frac 1 3}$. Thus, the attacker's online complexity again beats the birthday-bound.\n\nIn addition, our precomputation attack can also be combined with our multiple-key attack. We explicitly give various tradeoffs between precomputation and online phase. E.g. for attacking $m$ keys one may spend time $mp^{\\frac 2 3}$  in the precomputation phase for constructing a hint of size $m^2 p^{\\frac 1 3}$. In an online phase, one then  finds {\\em all $m$ keys in total time} only $p^{\\frac 1 3}$.\n\nPrecomputation attacks might again be interesting in the Ethereum 2.0 context, where keys are frequently changed such that a heavy key-independent precomputation pays off.",
    "keywords": [
      "Preprocessing",
      "Legendre PRF",
      "Ethereum 2.0"
    ],
    "category": "Public-key cryptography",
    "publication_info": "Preprint. MINOR revision.",
    "last_updated": "2021-09-17",
    "license": "CC BY",
    "related_papers": []
  }
}
