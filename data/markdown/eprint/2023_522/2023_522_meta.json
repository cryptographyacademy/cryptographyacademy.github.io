{
  "table_of_contents": [
    {
      "title": "SAFE: Sponge API for Field Elements",
      "heading_level": null,
      "page_id": 0,
      "polygon": [
        [
          171.228515625,
          95.05975341796875
        ],
        [
          439.1000061035156,
          95.05975341796875
        ],
        [
          439.1000061035156,
          112.27520751953125
        ],
        [
          171.228515625,
          112.27520751953125
        ]
      ]
    },
    {
      "title": "Abstract",
      "heading_level": null,
      "page_id": 0,
      "polygon": [
        [
          284.185546875,
          260.26171875
        ],
        [
          326.260986328125,
          260.26171875
        ],
        [
          326.260986328125,
          270.18084716796875
        ],
        [
          284.185546875,
          270.18084716796875
        ]
      ]
    },
    {
      "title": "1 Introduction",
      "heading_level": null,
      "page_id": 0,
      "polygon": [
        [
          56.69293975830078,
          435.5148620605469
        ],
        [
          169.66925048828125,
          435.4453125
        ],
        [
          169.66925048828125,
          449.8610534667969
        ],
        [
          56.69293975830078,
          449.8610534667969
        ]
      ]
    },
    {
      "title": "2 Sponges",
      "heading_level": null,
      "page_id": 1,
      "polygon": [
        [
          55.58203125,
          524.390625
        ],
        [
          138.0789794921875,
          522.84375
        ],
        [
          138.0789794921875,
          539.7522277832031
        ],
        [
          55.58203125,
          539.859375
        ]
      ]
    },
    {
      "title": "3 The SAFE API",
      "heading_level": null,
      "page_id": 2,
      "polygon": [
        [
          56.69300842285156,
          259.97393798828125
        ],
        [
          190.353515625,
          259.1015625
        ],
        [
          190.2848358154297,
          274.3201904296875
        ],
        [
          55.880859375,
          274.3201904296875
        ]
      ]
    },
    {
      "title": "3.1 API Overview",
      "heading_level": null,
      "page_id": 2,
      "polygon": [
        [
          56.69300842285156,
          285.3984375
        ],
        [
          171.52734375,
          283.8515625
        ],
        [
          171.2238311767578,
          297.6108093261719
        ],
        [
          55.58203125,
          297.6108093261719
        ]
      ]
    },
    {
      "title": "3.2 Security",
      "heading_level": null,
      "page_id": 3,
      "polygon": [
        [
          56.1796875,
          467.047607421875
        ],
        [
          135.5255584716797,
          466.3828125
        ],
        [
          135.5255584716797,
          479.0028076171875
        ],
        [
          56.1796875,
          479.0028076171875
        ]
      ]
    },
    {
      "title": "3.3 From IO Patterns to Tags to Instances",
      "heading_level": null,
      "page_id": 3,
      "polygon": [
        [
          55.283203125,
          636.8625946044922
        ],
        [
          315.283935546875,
          636.8625946044922
        ],
        [
          315.283935546875,
          648.8177947998047
        ],
        [
          55.283203125,
          648.8177947998047
        ]
      ]
    },
    {
      "title": "3.4 Detailed API",
      "heading_level": null,
      "page_id": 4,
      "polygon": [
        [
          55.58203125,
          463.7806396484375
        ],
        [
          165.38966369628906,
          462.90234375
        ],
        [
          165.38966369628906,
          475.73583984375
        ],
        [
          55.58203125,
          475.73583984375
        ]
      ]
    },
    {
      "title": "Algorithm 1 START and FINISH operations.",
      "heading_level": null,
      "page_id": 5,
      "polygon": [
        [
          55.58203125,
          58.0078125
        ],
        [
          257.25311279296875,
          58.0078125
        ],
        [
          257.25311279296875,
          68.8359375
        ],
        [
          54.38671875,
          68.8359375
        ]
      ]
    },
    {
      "title": "START:",
      "heading_level": null,
      "page_id": 5,
      "polygon": [
        [
          54.984375,
          99.3619384765625
        ],
        [
          90.79364013671875,
          97.83984375
        ],
        [
          90.79364013671875,
          109.32452392578125
        ],
        [
          54.984375,
          109.32452392578125
        ]
      ]
    },
    {
      "title": "FINISH:",
      "heading_level": null,
      "page_id": 5,
      "polygon": [
        [
          308.091796875,
          99.36199951171875
        ],
        [
          344.5976257324219,
          97.83984375
        ],
        [
          344.5976257324219,
          109.3245849609375
        ],
        [
          306.896484375,
          109.3245849609375
        ]
      ]
    },
    {
      "title": "Algorithm 2 ABSORB and SQUEEZE operations.",
      "heading_level": null,
      "page_id": 5,
      "polygon": [
        [
          56.692996978759766,
          281.53125
        ],
        [
          277.93914794921875,
          279.984375
        ],
        [
          277.93914794921875,
          291.7845153808594
        ],
        [
          55.58203125,
          292.359375
        ]
      ]
    },
    {
      "title": "ABSORB:",
      "heading_level": null,
      "page_id": 5,
      "polygon": [
        [
          54.984375,
          296.2265625
        ],
        [
          98.6806411743164,
          294.6796875
        ],
        [
          98.6806411743164,
          308.0685119628906
        ],
        [
          53.7890625,
          308.0685119628906
        ]
      ]
    },
    {
      "title": "SQUEEZE:",
      "heading_level": null,
      "page_id": 5,
      "polygon": [
        [
          308.98828125,
          295.83984375
        ],
        [
          357.39666748046875,
          295.83984375
        ],
        [
          357.39666748046875,
          308.06854248046875
        ],
        [
          307.79296875,
          308.06854248046875
        ]
      ]
    },
    {
      "title": "4 SAFE Applications",
      "heading_level": null,
      "page_id": 5,
      "polygon": [
        [
          56.1796875,
          602.12109375
        ],
        [
          216.35183715820312,
          602.12109375
        ],
        [
          216.35183715820312,
          617.5881958007812
        ],
        [
          54.984375,
          617.5881958007812
        ]
      ]
    },
    {
      "title": "Algorithm 3 SAFE for fixed-length hashing",
      "heading_level": null,
      "page_id": 6,
      "polygon": [
        [
          55.58203125,
          268.76953125
        ],
        [
          254.00390625,
          267.22265625
        ],
        [
          253.65451049804688,
          278.78948974609375
        ],
        [
          54.38671875,
          278.82421875
        ]
      ]
    },
    {
      "title": "Algorithm 5 SAFE for Commitment schemes",
      "heading_level": null,
      "page_id": 6,
      "polygon": [
        [
          56.1796875,
          539.2349090576172
        ],
        [
          261.1961975097656,
          538.3125
        ],
        [
          261.1961975097656,
          549.197509765625
        ],
        [
          56.1796875,
          549.197509765625
        ]
      ]
    },
    {
      "title": "Algorithm 6 SAFE for Sigma protocols",
      "heading_level": null,
      "page_id": 7,
      "polygon": [
        [
          56.25,
          58.39453125
        ],
        [
          236.25,
          58.39453125
        ],
        [
          236.25,
          68.44921875
        ],
        [
          55.283203125,
          68.44921875
        ]
      ]
    },
    {
      "title": "Interactive form:",
      "heading_level": null,
      "page_id": 7,
      "polygon": [
        [
          55.283203125,
          74.25
        ],
        [
          130.5,
          74.25
        ],
        [
          130.5,
          82.5
        ],
        [
          55.283203125,
          82.5
        ]
      ]
    },
    {
      "title": "Sponge calls via SAFE:",
      "heading_level": null,
      "page_id": 7,
      "polygon": [
        [
          308.98828125,
          74.25
        ],
        [
          414.0,
          73.08984375
        ],
        [
          414.0,
          83.25
        ],
        [
          308.98828125,
          84.69140625
        ]
      ]
    },
    {
      "title": "Algorithm 7 SAFE for authenticated encryption",
      "heading_level": null,
      "page_id": 7,
      "polygon": [
        [
          55.58203125,
          245.1796875
        ],
        [
          275.25,
          243.6328125
        ],
        [
          275.25,
          255.75
        ],
        [
          54.38671875,
          256.0078125
        ]
      ]
    },
    {
      "title": "Pseudocode:",
      "heading_level": null,
      "page_id": 7,
      "polygon": [
        [
          54.984375,
          263.25
        ],
        [
          111.0,
          261.80859375
        ],
        [
          111.0,
          271.5
        ],
        [
          53.7890625,
          271.86328125
        ]
      ]
    },
    {
      "title": "Sponge calls via SAFE:",
      "heading_level": null,
      "page_id": 7,
      "polygon": [
        [
          308.98828125,
          261.80859375
        ],
        [
          413.25,
          260.26171875
        ],
        [
          413.25,
          272.25
        ],
        [
          308.98828125,
          272.25
        ]
      ]
    },
    {
      "title": "Algorithm 8 SAFE for stream cipher and PRNG",
      "heading_level": null,
      "page_id": 7,
      "polygon": [
        [
          54.685546875,
          494.2265625
        ],
        [
          277.5,
          492.6796875
        ],
        [
          277.5,
          503.25
        ],
        [
          54.685546875,
          503.5078125
        ]
      ]
    },
    {
      "title": "Protocol:",
      "heading_level": null,
      "page_id": 7,
      "polygon": [
        [
          54.685546875,
          509.6953125
        ],
        [
          96.75,
          509.6953125
        ],
        [
          96.75,
          518.9765625
        ],
        [
          53.490234375,
          518.9765625
        ]
      ]
    },
    {
      "title": "Sponge calls via SAFE:",
      "heading_level": null,
      "page_id": 7,
      "polygon": [
        [
          308.390625,
          510.75
        ],
        [
          413.25,
          510.75
        ],
        [
          413.25,
          520.5234375
        ],
        [
          308.390625,
          520.5234375
        ]
      ]
    },
    {
      "title": "References",
      "heading_level": null,
      "page_id": 8,
      "polygon": [
        [
          56.1796875,
          55.4439697265625
        ],
        [
          132.16835021972656,
          54.9140625
        ],
        [
          132.16835021972656,
          69.79022216796875
        ],
        [
          56.1796875,
          69.79022216796875
        ]
      ]
    }
  ],
  "page_stats": [
    {
      "page_id": 0,
      "text_extraction_method": "pdftext",
      "block_counts": [
        [
          "Span",
          155
        ],
        [
          "Line",
          48
        ],
        [
          "Text",
          8
        ],
        [
          "SectionHeader",
          3
        ],
        [
          "ListItem",
          2
        ],
        [
          "Footnote",
          1
        ],
        [
          "PageFooter",
          1
        ],
        [
          "ListGroup",
          1
        ],
        [
          "Reference",
          1
        ]
      ],
      "block_metadata": {
        "llm_request_count": 0,
        "llm_error_count": 0,
        "llm_tokens_used": 0,
        "previous_text": "",
        "previous_type": "",
        "previous_order": 0
      }
    },
    {
      "page_id": 1,
      "text_extraction_method": "pdftext",
      "block_counts": [
        [
          "Span",
          229
        ],
        [
          "Line",
          47
        ],
        [
          "ListItem",
          14
        ],
        [
          "Text",
          7
        ],
        [
          "ListGroup",
          4
        ],
        [
          "SectionHeader",
          1
        ],
        [
          "PageFooter",
          1
        ]
      ],
      "block_metadata": {
        "llm_request_count": 0,
        "llm_error_count": 0,
        "llm_tokens_used": 0,
        "previous_text": "",
        "previous_type": "",
        "previous_order": 0
      }
    },
    {
      "page_id": 2,
      "text_extraction_method": "pdftext",
      "block_counts": [
        [
          "Span",
          335
        ],
        [
          "Line",
          61
        ],
        [
          "ListItem",
          7
        ],
        [
          "Text",
          6
        ],
        [
          "SectionHeader",
          2
        ],
        [
          "ListGroup",
          2
        ],
        [
          "Figure",
          1
        ],
        [
          "Caption",
          1
        ],
        [
          "PageFooter",
          1
        ],
        [
          "FigureGroup",
          1
        ],
        [
          "Reference",
          1
        ]
      ],
      "block_metadata": {
        "llm_request_count": 0,
        "llm_error_count": 0,
        "llm_tokens_used": 0,
        "previous_text": "",
        "previous_type": "",
        "previous_order": 0
      }
    },
    {
      "page_id": 3,
      "text_extraction_method": "pdftext",
      "block_counts": [
        [
          "Span",
          171
        ],
        [
          "Line",
          34
        ],
        [
          "ListItem",
          6
        ],
        [
          "Text",
          4
        ],
        [
          "SectionHeader",
          2
        ],
        [
          "ListGroup",
          2
        ],
        [
          "Reference",
          2
        ],
        [
          "Picture",
          1
        ],
        [
          "Caption",
          1
        ],
        [
          "PageFooter",
          1
        ],
        [
          "PictureGroup",
          1
        ]
      ],
      "block_metadata": {
        "llm_request_count": 0,
        "llm_error_count": 0,
        "llm_tokens_used": 0,
        "previous_text": "",
        "previous_type": "",
        "previous_order": 0
      }
    },
    {
      "page_id": 4,
      "text_extraction_method": "pdftext",
      "block_counts": [
        [
          "Span",
          229
        ],
        [
          "Line",
          42
        ],
        [
          "Text",
          9
        ],
        [
          "ListItem",
          6
        ],
        [
          "ListGroup",
          2
        ],
        [
          "SectionHeader",
          1
        ],
        [
          "PageFooter",
          1
        ],
        [
          "Reference",
          1
        ]
      ],
      "block_metadata": {
        "llm_request_count": 0,
        "llm_error_count": 0,
        "llm_tokens_used": 0,
        "previous_text": "",
        "previous_type": "",
        "previous_order": 0
      }
    },
    {
      "page_id": 5,
      "text_extraction_method": "pdftext",
      "block_counts": [
        [
          "Span",
          556
        ],
        [
          "Line",
          68
        ],
        [
          "ListItem",
          31
        ],
        [
          "SectionHeader",
          7
        ],
        [
          "ListGroup",
          5
        ],
        [
          "Text",
          3
        ],
        [
          "Reference",
          2
        ],
        [
          "PageFooter",
          1
        ]
      ],
      "block_metadata": {
        "llm_request_count": 0,
        "llm_error_count": 0,
        "llm_tokens_used": 0,
        "previous_text": "",
        "previous_type": "",
        "previous_order": 0
      }
    },
    {
      "page_id": 6,
      "text_extraction_method": "pdftext",
      "block_counts": [
        [
          "Span",
          314
        ],
        [
          "Line",
          50
        ],
        [
          "TableCell",
          13
        ],
        [
          "ListItem",
          4
        ],
        [
          "Reference",
          3
        ],
        [
          "SectionHeader",
          2
        ],
        [
          "Code",
          2
        ],
        [
          "Table",
          1
        ],
        [
          "Text",
          1
        ],
        [
          "PageFooter",
          1
        ],
        [
          "ListGroup",
          1
        ]
      ],
      "block_metadata": {
        "llm_request_count": 0,
        "llm_error_count": 0,
        "llm_tokens_used": 0,
        "previous_text": "",
        "previous_type": "",
        "previous_order": 0
      }
    },
    {
      "page_id": 7,
      "text_extraction_method": "surya",
      "block_counts": [
        [
          "Span",
          165
        ],
        [
          "Line",
          132
        ],
        [
          "ListItem",
          52
        ],
        [
          "SectionHeader",
          9
        ],
        [
          "ListGroup",
          6
        ],
        [
          "Reference",
          3
        ],
        [
          "PageFooter",
          1
        ]
      ],
      "block_metadata": {
        "llm_request_count": 0,
        "llm_error_count": 0,
        "llm_tokens_used": 0,
        "previous_text": "",
        "previous_type": "",
        "previous_order": 0
      }
    },
    {
      "page_id": 8,
      "text_extraction_method": "pdftext",
      "block_counts": [
        [
          "Span",
          88
        ],
        [
          "Line",
          22
        ],
        [
          "ListItem",
          9
        ],
        [
          "Reference",
          9
        ],
        [
          "SectionHeader",
          1
        ],
        [
          "PageFooter",
          1
        ],
        [
          "ListGroup",
          1
        ]
      ],
      "block_metadata": {
        "llm_request_count": 0,
        "llm_error_count": 0,
        "llm_tokens_used": 0,
        "previous_text": "",
        "previous_type": "",
        "previous_order": 0
      }
    }
  ],
  "debug_data_path": "debug_data/2023_522",
  "eprint": {
    "title": "SAFE: Sponge API for Field Elements",
    "authors": [
      {
        "name": "JP Aumasson",
        "email": "jp@taurusgroup",
        "affiliation": ""
      },
      {
        "name": "Dmitry Khovratovich",
        "email": "chkhovratovich@gmail",
        "affiliation": ""
      },
      {
        "name": "Bart Mennink",
        "email": "mennink@cs",
        "affiliation": ""
      },
      {
        "name": "Por√ßu Quine",
        "email": "nlporcuquine@gmail",
        "affiliation": ""
      }
    ],
    "abstract": "From hashing and commitment schemes to Fiat-Shamir and encryption,\r\nhash functions are everywhere in zero-knowledge proofsystems (ZKPs), and minor performance changes in ``vanilla'' implementations can translate in major discrepancies when the hash is processed as a circuit within the proofsystem.\r\n\r\nProtocol designers have resorted to a number of techniques and custom\r\nmodes to optimize hash functions for ZKPs settings, but so far without a single established, well-studied construction. To address this need, we define the Sponge API for Field Elements (SAFE), a unified framework for permutation-based schemes (including AEAD, Sigma, PRNGs, and so on).  SAFE eliminates the performance overhead, is pluggable in any field-oriented protocol, and is suitable for any permutation algorithm.\r\n\r\nSAFE is implemented in Filecoin's Neptune hash framework, {which is} our reference implementation (in Rust). SAFE is also being integrated in other prominent ZKP projects. This report specifies SAFE and describes some use cases.\r\n\r\nAmong other improvements, our construction is  among the first to store\r\nthe protocol metadata in the sponge inner part in a provably secure\r\nway, which may be of independent interest to the sponge use cases outside of ZKP.",
    "keywords": [
      "hashing",
      "fiat-shamir",
      "sponges"
    ],
    "category": "Implementation",
    "publication_info": "Preprint.",
    "last_updated": "2023-04-12",
    "license": "CC0",
    "related_papers": []
  }
}
