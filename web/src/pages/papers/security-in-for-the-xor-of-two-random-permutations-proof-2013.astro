---
import BaseLayout from '../../layouts/BaseLayout.astro';

const EPRINT_URL = 'https://eprint.iacr.org/2013/368';
const CRAWLER = 'mistral';
const CONVERTED_DATE = '2026-02-16';
const TITLE_HTML = 'Security in $O(2^n)$ for the Xor of Two Random Permutations\\\\ -- Proof with the standard $H$ technique--';
const AUTHORS_HTML = 'Jacques Patarin';

const CONTENT = `    <p class="text-gray-300">Jacques Patarin Université de Versailles 45 avenue des Etats-Unis 78035 Versailles Cedex - France</p>

    <h6 id="sec-2" class="text-base font-medium mt-4">Abstract</h6>

    <p class="text-gray-300">Xoring two permutations is a very simple way to construct pseudorandom functions from pseudorandom permutations. In <em>[13]</em>, it is proved that we have security against CPA-2 attacks when <span class="math">m\\ll O(2^{n})</span>, where <span class="math">m</span> is the number of queries and <span class="math">n</span> is the number of bits of the inputs and outputs of the bijections. In this paper, we will obtain similar (but slightly different) results by using the “standard H technique” instead of the “<span class="math">H_{\\sigma}</span> technique”. It will be interesting to compare the two techniques, their similarities and the differences between the proofs and the results.</p>

    <h4 id="sec-3" class="text-lg font-semibold mt-6">Key words:</h4>

    <p class="text-gray-300">Pseudorandom functions, pseudorandom permutations, security beyond the birthday bound, Luby-Rackoff backwards.</p>

    <h2 id="sec-4" class="text-2xl font-bold">1 Introduction</h2>

    <p class="text-gray-300">The problem of converting pseudorandom permutations (PRP) into pseudorandom functions (PRF) named “Luby-Rackoff backwards” was first considered in <em>[3]</em>. This problem is obvious if we are interested in an asymptotical polynomial versus non polynomial security model (since a PRP is then a PRF), but not if we are interested in achieving more optimal and concrete security bounds. More precisely, the loss of security when regarding a PRP as a PRF comes from the “birthday attack” which can distinguish a random permutation from a random function of <span class="math">n</span> bits to <span class="math">n</span> bits, in <span class="math">2^{\\frac{n}{2}}</span> operations and <span class="math">2^{\\frac{n}{2}}</span> queries. Therefore different ways to build PRF from PRP with a security above <span class="math">2^{\\frac{n}{2}}</span> and by performing very few computations have been suggested (see <em>[2, 3, 4, 6]</em>). One of the simplest way is simply to Xor <span class="math">k</span> independent pseudorandom permutations, for example with <span class="math">k=2</span>. In <em>[6]</em> (Theorem 2 p.474), it has been proved, with a simple proof, that the Xor of k independent PRP gives a PRF with security at least in <span class="math">O(2^{\\frac{k}{k+1}n})</span>. (For <span class="math">k=2</span> this gives <span class="math">O(2^{\\frac{2}{3}n})</span>). In <em>[2]</em>, a much more complex strategy (based on Azuma inequality and Chernoff bounds) is presented. It is claimed that with this strategy we may prove that the Xor of two PRP gives a PRF with security at least in <span class="math">O(2^{n}/n^{\\frac{2}{3}})</span> and at most in <span class="math">O(2^{n})</span>, which is much better than the birthday bound in <span class="math">O(2^{\\frac{n}{2}})</span>. However the authors of <em>[2]</em> present a very general framework of proof and they do not give every</p>

    <p class="text-gray-300">details for this result. For example, page 9 they wrote “we give only a very brief summary of how this works”, and page 10 they introduce <span class="math">O</span> functions that are not easy to express explicitly. In this paper we will use a completely different proof strategy, based on the “standard <span class="math">H</span> technique” (see Section 3 below), simple counting arguments and induction. This paper is self contained. It is nevertheless interesting to compare this paper with <em>[13]</em> where similar (but slightly different results, as we will explain) are obtained by using the <span class="math">H_{\\sigma}</span> technique instead of the standard <span class="math">H</span> technique.</p>

    <p class="text-gray-300">Related Problems. In <em>[14]</em> the best know attacks on the Xor of <span class="math">k</span> random permutations are studied in various scenarios. For <span class="math">k=2</span> the bound obtained are near our security bounds. In <em>[7]</em> attacks on the Xor of two public permutations are studied (i.e. indifferentiability instead of indistinguishibility).</p>

    <h2 id="sec-5" class="text-2xl font-bold">Part I From the Xor of Two Permutations to the <span class="math">h_{i}</span> values</h2>

    <h3 id="sec-6" class="text-xl font-semibold mt-8">2 Notation and Aim of this paper</h3>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">In all this paper we will denote <span class="math">I_{n}=\\{0,1\\}^{n}</span>. <span class="math">F_{n}</span> will be the set of all applications from <span class="math">I_{n}</span> to <span class="math">I_{n}</span>, and <span class="math">B_{n}</span> will be the set of all permutations from <span class="math">I_{n}</span> to <span class="math">I_{n}</span>. Therefore $</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">I_{n}</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">=2^{n}<span class="math">, </span></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">F_{n}</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">=2^{n\\cdot 2^{n}}<span class="math"> and </span></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">B_{n}</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">=(2^{n})!<span class="math">. </span>x\\in_{R}A<span class="math"> means that </span>x<span class="math"> is randomly chosen in </span>A$ with a uniform distribution.</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">The aim of this paper is to prove the theorem below, with an explicit O function (to be determined).</p>

    <h6 id="sec-7" class="text-base font-medium mt-4">Theorem 1</h6>

    <p class="text-gray-300">For all CPA-2 (Adaptive chosen plaintext attack) <span class="math">\\phi</span> on a function <span class="math">G</span> of <span class="math">F_{n}</span> with <span class="math">m</span> chosen plaintext, we have: <span class="math">\\mathrm{Adv}^{\\mathrm{PRF}}_{\\phi}\\leq O(\\frac{m}{2^{n}})</span> where <span class="math">\\mathrm{Adv}^{\\mathrm{PRF}}_{\\phi}</span> denotes the advantage to distinguish <span class="math">f\\oplus g</span>, with <span class="math">f,g\\in_{R}B_{n}</span> from <span class="math">h\\in_{R}F_{n}</span>.</p>

    <p class="text-gray-300">This theorem says that there is no way (with an adaptive chosen plaintext attack) to distinguish with a good probability <span class="math">f\\oplus g</span> when <span class="math">f,g\\in_{R}B_{n}</span> from <span class="math">h\\in_{R}F_{n}</span> when <span class="math">m\\ll 2^{n}</span> (and this even if we have access to infinite computing power, as long as we have access to only <span class="math">m</span> queries). Therefore, it implies that the number <span class="math">\\lambda</span> of computations to distinguish <span class="math">f\\oplus g</span> with <span class="math">f,g\\in_{R}B_{n}</span> from <span class="math">h\\in_{R}F_{n}</span> satisfies: <span class="math">\\lambda\\geq O(2^{n})</span>. We say also that there is no generic CPA-2 attack with less than <span class="math">O(2^{n})</span> computations for this problem, or that the security obtained is greater than or equal to <span class="math">O(2^{n})</span>. Since we know (for example from <em>[2]</em> or <em>[14]</em>) that there is an attack in <span class="math">O(2^{n})</span>, Theorem 1 also says that <span class="math">O(2^{n})</span> is the exact security bound for this problem.</p>

    <h3 id="sec-8" class="text-xl font-semibold mt-8">3 The general Proof Strategy (“ standard <span class="math">H</span> technique”)</h3>

    <p class="text-gray-300">Let <span class="math">a=(a_{i},1\\leq i\\leq m)</span> be <span class="math">m</span> pairwise distinct values of <span class="math">I_{n}</span>. Let <span class="math">b=(b_{i},1\\leq i\\leq m)</span> be <span class="math">m</span> values of <span class="math">I_{n}</span> (not necessarily distinct). <span class="math">\\bullet</span> We will denote by <span class="math">H(a,b)</span>, or by <span class="math">H(b)</span> since we will see that <span class="math">H(a,b)</span> does not depend on <span class="math">a</span>, the number of <span class="math">(f,g)\\in B_{n}^{2}</span> such that: <span class="math">\\forall i,\\;1\\leq i\\leq m,\\;(f\\oplus g)(a_{i})=b_{i}</span>. Often we will denote <span class="math">H(b)</span> by</p>

    <p class="text-gray-300"><span class="math">H_{m}</span> for simplicity (but <span class="math">H(b)</span> depends on <span class="math">b</span>).</p>

    <p class="text-gray-300">Introducing <span class="math">h</span> instead of <span class="math">H</span></p>

    <p class="text-gray-300"><span class="math">\\bullet</span> We will denote by <span class="math">h(b)</span>, or simply by <span class="math">h_{m}</span> for simplicity (but <span class="math">h</span> depends on <span class="math">b</span>) the number of sequences <span class="math">x_{i},\\;1\\leq i\\leq m,\\;x_{i}\\in I_{n}</span>, such that:</p>

    <ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">

      <li>The <span class="math">x_{i}</span> are pairwise distinct, <span class="math">1\\leq i\\leq m</span>.</li>

      <li>The <span class="math">x_{i}\\oplus b_{i}</span> are pairwise distinct, <span class="math">1\\leq i\\leq m</span>.</li>

    </ol>

    <h6 id="sec-9" class="text-base font-medium mt-4">Theorem 2</h6>

    <p class="text-gray-300">We have</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">$H(a,b)=h(b)\\cdot\\frac{</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">B_{n}</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">^{2}}{(2^{n}(2^{n}-1)\\ldots(2^{n}-m+1))^{2}}$</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">(and therefore <span class="math">H(a,b)</span> does not depend on <span class="math">a</span>, i.e. does not depend on the pairwise distinct values <span class="math">a_{i}</span>, <span class="math">1\\leq i\\leq m</span>).</p>

    <p class="text-gray-300">Proof. When the <span class="math">x_{i}</span> are fixed, <span class="math">f</span> and <span class="math">g</span> are fixed on exactly <span class="math">m</span> pairwise distinct points by <span class="math">\\forall i,\\;1\\leq i\\leq m,\\;f(a_{i})=x_{i}</span> and <span class="math">g(a_{i})=b_{i}\\oplus x_{i}</span>. <span class="math">\\Box</span></p>

    <h6 id="sec-10" class="text-base font-medium mt-4">Theorem 3</h6>

    <p class="text-gray-300"><span class="math">h_{m}</span> is the number of <span class="math">(P_{1},P_{2},\\ldots,P_{m},Q_{1},\\ldots,Q_{m})\\in I_{n}^{2m}</span> such that</p>

    <ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">

      <li>The <span class="math">P_{i}</span> are pairwise distinct (i.e. <span class="math">i\\neq j\\Rightarrow P_{i}\\neq P_{j}</span>).</li>

      <li>The <span class="math">Q_{i}</span> are pairwise distinct (i.e. <span class="math">i\\neq j\\Rightarrow Q_{i}\\neq Q_{j}</span>).</li>

      <li><span class="math">\\forall i,\\;1\\leq i\\leq m,\\;P_{i}\\oplus Q_{i}=b_{i}</span>.</li>

    </ol>

    <p class="text-gray-300">Proof. Since <span class="math">Q_{i}</span> is fixed when <span class="math">P_{i}</span> is fixed, Theorem 3 is obvious from the definition of <span class="math">h_{m}</span>, i.e. just take <span class="math">P_{i}=x_{i}</span> and <span class="math">Q_{i}=x_{i}\\oplus b_{i}</span>. <span class="math">\\Box</span></p>

    <p class="text-gray-300">Computation of <span class="math">E(h)=\\tilde{h}_{m}</span></p>

    <p class="text-gray-300">We will denote by <span class="math">\\tilde{h_{m}}</span> the average of <span class="math">h_{m}</span> when <span class="math">b\\in_{R}I_{n}^{m}</span>.</p>

    <h6 id="sec-11" class="text-base font-medium mt-4">Theorem 4</h6>

    <p class="text-gray-300"><span class="math">\\tilde{h_{m}}=\\frac{(2^{n}(2^{n}-1)\\ldots(2^{n}-m+1))^{2}}{2^{nm}}</span></p>

    <p class="text-gray-300">Proof. Let <span class="math">b=(b_{1},\\ldots,b_{n})</span>, and <span class="math">x=(x_{1},\\ldots,x_{n})</span>. For <span class="math">x\\in I_{n}^{m}</span>, let</p>

    <p class="text-gray-300">\\[ \\delta_{x}=1\\Leftrightarrow\\left\\{\\begin{array}[]{ll}\\mbox{The <span class="math">x_{i}</span> are pairwise distinct},&1\\leq i\\leq m\\\\ \\mbox{The <span class="math">x_{i}\\oplus b_{i}</span> are pairwise distinct},&1\\leq i\\leq m\\end{array}\\right. \\]</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">and <span class="math">\\delta_{x}=0\\Leftrightarrow\\delta_{x}\\neq 1</span>. Let <span class="math">J_{n}^{m}</span> be the set of all sequences <span class="math">x_{i}</span> such that all the <span class="math">x_{i}</span> are pairwise distinct, <span class="math">1\\leq i\\leq m</span>. Then $</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">J_{n}^{m}</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">=2^{n}(2^{n}-1)\\ldots(2^{n}-m+1)<span class="math"> and </span>N=\\sum_{x\\in J_{n}^{m}}\\delta_{x}<span class="math">. So we have </span>E(h)=\\sum_{x\\in J_{n}^{m}}E(\\delta_{x})<span class="math">. For </span>x\\in J_{n}^{m}$,</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300"><span class="math">E(\\delta_{x})=Pr_{b\\in_{R}I_{n}^{m}}(\\mbox{All the </span>x_{i}\\oplus b_{i}<span class="math"> are pairwise distinct})=\\frac{2^{n}(2^{n}-1)\\ldots(2^{n}-m+1)}{2^{nm}}</span></p>

    <p class="text-gray-300">Therefore</p>

    <div class="my-4 text-center"><span class="math-block"></span></div>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">E(h) =</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">J_n^m</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\cdot \\frac{2^n(2^n - 1)\\ldots(2^n - m + 1)}{2^{nm}} = \\frac{(2^n(2^n - 1)\\ldots(2^n - m + 1))^2}{2^{nm}}</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <div class="my-4 text-center"><span class="math-block"></span></div>

    <p class="text-gray-300">as expected. <span class="math">\\square</span></p>

    <p class="text-gray-300">We will denote by <span class="math">Adv_m</span> the best Advantage that we can get in CPA-2 with <span class="math">m</span> queries when we try to distinguish <span class="math">f \\oplus g</span>, with <span class="math">f, g \\in_R B_n</span> from <span class="math">h \\in_R F_n</span>. As we will see now, there is a very deep connection between <span class="math">Adv_m</span> and the coefficients <span class="math">h_m</span>. More precisely:</p>

    <p class="text-gray-300"><strong>Theorem 5</strong> An exact formula for <span class="math">Adv</span>.</p>

    <p class="text-gray-300">Let <span class="math">F = \\{(b_1, \\ldots, b_m) \\in I_n^m \\text{ such that: } h(b_1, \\ldots, b_m) \\geq \\tilde{h_m}\\}</span>. Then:</p>

    <p class="text-gray-300">$$ \\begin{aligned}</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Adv_m &amp;= \\frac{1}{2. [2^n(2^n - 1)\\ldots(2^n - m + 1)]^2} \\sum_{b_1, \\ldots, b_m \\in I_n}</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">h_m - \\tilde{h_m}</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\\\</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">&amp;= \\frac{1}{2^{nm}} \\sum_{b_1, \\ldots, b_m \\in F} \\left(\\frac{h_m}{h_m} - 1\\right) \\\\ &amp;= \\frac{1}{2^{nm}} \\sum_{b_1, \\ldots, b_m \\in I_n \\setminus F} \\left(1 - \\frac{h_m}{h_m}\\right) \\end{aligned} $$</p>

    <p class="text-gray-300"><strong>Proof.</strong> We have seen above that the choice of the pairwise distinct values <span class="math">a_i</span> has no influence. Therefore, here the best CPA-2 is this one denoted by <span class="math">\\phi</span> (<span class="math">\\phi</span> is also the best KPA attack): choose <span class="math">m</span> pairwise distinct values <span class="math">a_1, \\ldots, a_m</span>,</p>

    <p class="text-gray-300"><span class="math">\\forall i, 1 \\leq i \\leq m</span>, ask for <span class="math">f(a_i) = b_i</span> and now</p>

    <ul class="list-disc list-inside space-y-1 text-gray-300 my-2 ml-4">

      <li>If <span class="math">H(b_1, \\ldots, b_m) \\geq \\tilde{H}_m</span> output 1.</li>

      <li>If <span class="math">H(b_1, \\ldots, b_m) &amp;lt; \\tilde{H}_m</span> output 0.</li>

    </ul>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Here <span class="math">\\tilde{H}_m</span> denotes the average of <span class="math">H(b_1, \\ldots, b_m)</span> when <span class="math">(b_1, \\ldots, b_m) \\in I_n^m</span>, i.e. $\\tilde{H}_m = \\frac{</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">B_n</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">^2}{2^{nm}}$.</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Let <span class="math">p_1^<em></span> be the probability that <span class="math">\\phi</span> outputs 1 when <span class="math">f \\in_R F_n</span>. <span class="math">p_1^</em></span> is also the probability that <span class="math">H(b_1, \\ldots, b_m) \\geq \\tilde{H}_m</span> when <span class="math">(b_1, \\ldots, b_m) \\in_R I_n^m</span>. Therefore $p_1^* = \\frac{</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">F</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">}{2^{nm}}<span class="math">. Let </span>p_1<span class="math"> be the probability that </span>\\phi<span class="math"> outputs 1 when </span>f = g \\oplus h<span class="math"> with </span>(g, h) \\in_R B_n^2<span class="math">. Then: </span>Adv = Adv(\\phi) =</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">p_1 - p_1^*</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"><span class="math">. </span>p_1 = \\sum_{(b_1, \\ldots, b_m) \\in F} \\frac{H(b_1, \\ldots, b_m)}{</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">B_n</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">^2}<span class="math">. We know that </span>H_m = \\frac{h_m</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">B_n</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">^2}{[2^n(2^n - 1) \\ldots (2^n - m + 1)]^2}$ (cf (3.2)). Therefore,</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <div class="my-4 text-center"><span class="math-block">p_1 - p_1^* = \\sum_{b_1, \\ldots, b_m \\in F} \\left( \\frac{h_m (b_1, \\ldots, b_m)}{[2^n(2^n - 1) \\ldots (2^n - m + 1)]^2} - \\frac{1}{2^{nm}} \\right)</span></div>

    <div class="my-4 text-center"><span class="math-block">p_1 - p_1^* = \\sum_{b_1, \\ldots, b_m \\in F} \\left( \\frac{h_m - \\tilde{h_m}}{[2^n(2^n - 1) \\ldots (2^n - m + 1)]^2} \\right)</span></div>

    <p class="text-gray-300">Therefore from Theorem 4:</p>

    <div class="my-4 text-center"><span class="math-block">Adv_m = p_1 - p_1^* = \\frac{1}{2^{nm}} \\sum_{b_1, \\ldots, b_m \\in F} \\left( \\frac{h_m}{\\tilde{h_m}} - 1 \\right)</span></div>

    <p class="text-gray-300">Now from <span class="math">\\frac{1}{2^{nm}} \\sum_{b_1, \\ldots, b_m \\in F} h_m = \\frac{\\tilde{h_m}}{2}</span>, we obtain the other equality of Theorem 5. <span class="math">\\square</span></p>

    <p class="text-gray-300">As a direct corollary of this Theorem 5 we get:</p>

    <h6 id="sec-12" class="text-base font-medium mt-4">Theorem 6</h6>

    <p class="text-gray-300">(“Standard H technique theorem”)</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Let <span class="math">\\alpha</span> and <span class="math">\\beta</span> be real numbers, <span class="math">\\alpha&gt;0</span> and <span class="math">\\beta&gt;0</span>. Let <span class="math">\\mathcal{E}</span> be a subset of <span class="math">I_{n}^{m}</span> such that $</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\mathcal{E}</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\geq(1-\\beta)\\cdot 2^{nm}$.</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">If</p>

    <ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">

      <li>For all sequences <span class="math">b_{i},\\;1\\leq i\\leq m</span> of <span class="math">\\mathcal{E}</span> we have <span class="math">h_{m}(b)\\geq\\tilde{h_{m}}(1-\\alpha)</span>.</li>

    </ol>

    <p class="text-gray-300">Then</p>

    <ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">

      <li><span class="math">Adv_{m}\\leq\\alpha+\\beta</span>.</li>

    </ol>

    <p class="text-gray-300">Proof From Theorem 5</p>

    <p class="text-gray-300"><span class="math">Adv_{m}=\\frac{1}{2^{nm}}\\sum_{b_{1},\\ldots,b_{m}\\in I_{n}\\setminus F}(1-\\frac{h_{m}}{\\tilde{h_{m}}})</span></p>

    <p class="text-gray-300"><span class="math">I_{n}\\setminus F\\subset(I_{n}\\setminus E)\\cup(E\\setminus F)</span>, so</p>

    <p class="text-gray-300"><span class="math">Adv_{m}\\leq\\frac{1}{2^{nm}}(\\beta\\cdot 2^{nm}+\\alpha\\cdot 2^{nm})\\leq\\alpha+\\beta</span></p>

    <p class="text-gray-300">as claimed. <span class="math">\\square</span> Theorem 4 and theorem 5 show the proof strategy that we will follow in this paper: we will study and evaluate the values <span class="math">h_{m}</span>, and try to show that “most of the time” <span class="math">h_{m}\\stackrel{{\\scriptstyle&gt;}}{{\\sim}}\\tilde{h_{m}}</span> where <span class="math">a\\stackrel{{\\scriptstyle&gt;}}{{\\sim}}b</span> means <span class="math">a\\geq b</span> or <span class="math">a\\simeq b</span>. Remarks</p>

    <ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">

      <li>In <em>[13]</em> a slightly different strategy is used, by studying <span class="math">\\sigma(h_{m})</span>, the standard deviation on the <span class="math">h_{m}</span> values.</li>

      <li>Theorem 4 and theorem 5 are specific of this problem. However Theorem 6 is a very classical “coefficient H theorem” and can also be proved independently of Theorem 5 with more general conditions (see for example <em>[13, 12]</em>).</li>

      <li>The probability to distinguish is <span class="math">\\frac{1}{2}+Adv\\cdot\\frac{1}{2}</span>, as usual.</li>

    </ol>

    <h6 id="sec-13" class="text-base font-medium mt-4">Theorem 7</h6>

    <p class="text-gray-300">(<span class="math">H_{worse\\,case}</span> theorem) Let <span class="math">\\alpha\\geq 0</span>. If</p>

    <ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">

      <li>For all sequences <span class="math">b_{i},\\;1\\leq b_{i}\\leq m</span>, of <span class="math">I_{n}^{m}</span> we have <span class="math">h_{m}(b)\\geq\\tilde{h_{m}}(1-\\alpha)</span></li>

    </ol>

    <p class="text-gray-300">Then</p>

    <ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">

      <li><span class="math">Adv_{m}\\leq\\alpha</span>.</li>

    </ol>

    <p class="text-gray-300">Proof. This follows immediately from Theorem 6 with <span class="math">\\beta=0</span>. <span class="math">\\square</span></p>

    <h2 id="sec-14" class="text-2xl font-bold">Part II Analysis of the <span class="math">h_{i}</span> values</h2>

    <h3 id="sec-15" class="text-xl font-semibold mt-8">4 Orange equations, security in <span class="math">O(\\frac{m^{3}}{2^{2n}})</span></h3>

    <p class="text-gray-300">Let <span class="math">\\epsilon\\geq 0</span>. From Theorem 7, (i.e. coefficients H technique) we know that if for all <span class="math">b_{1},\\ldots,b_{\\alpha}\\in I_{n}</span> we have <span class="math">h_{\\alpha}(b_{1},b_{2},\\ldots,b_{\\alpha})\\geq\\tilde{h}_{\\alpha}(1-\\epsilon)</span>, then: <span class="math">Avd^{PRF}\\leq 2\\epsilon</span> (where <span class="math">Avd^{PRF}</span> is as before the advantage</p>

    <p class="text-gray-300">to distinguish <span class="math">f\\oplus g</span> with <span class="math">f,g\\in_{R}B_{n}</span> from <span class="math">h\\in_{R}F_{n}</span> with a CPA-2 attack). Therefore we want to study <span class="math">\\frac{h_{\\alpha}}{h_{\\alpha}}</span>.</p>

    <p class="text-gray-300"><span class="math">\\tilde{h}_{\\alpha+1}=\\tilde{h}_{\\alpha}\\frac{(2^{n}-\\alpha)^{2}}{2^{n}}</span> <span class="math">\\tilde{h}_{\\alpha+1}=\\tilde{h}_{\\alpha}(2^{n}-2\\alpha+\\frac{\\alpha^{2}}{2^{n}})</span> (4.1)</p>

    <p class="text-gray-300">Now we want to evaluate <span class="math">h_{\\alpha+1}</span> from <span class="math">h_{\\alpha}</span> and compare the result with (4.1). In <span class="math">h_{\\alpha+1}</span>, we have:</p>

    <ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">

      <li>The previous conditions on <span class="math">h_{\\alpha}</span>.</li>

      <li>Two new variables <span class="math">P_{\\alpha+1}</span> and <span class="math">Q_{\\alpha+1}</span>.</li>

      <li>One more equation <span class="math">P_{\\alpha+1}\\oplus Q_{\\alpha+1}=b_{\\alpha+1}</span>. We call <span class="math">X</span> this equation.</li>

      <li><span class="math">2\\alpha</span> new non equalities: <span class="math">P_{\\alpha+1}\\neq P_{i}</span>, <span class="math">\\forall i,\\,1\\leq i\\leq\\alpha</span>, and <span class="math">Q_{\\alpha+1}\\neq Q_{i}</span>, <span class="math">\\forall i,\\,1\\leq i\\leq\\alpha</span>. We will denote by <span class="math">\\beta_{1},\\beta_{2},\\ldots,\\beta_{2\\alpha}</span>, the <span class="math">2\\alpha</span> equalities that should not be satisfied here (for example <span class="math">P_{\\alpha+1}=P_{1}</span>).</li>

    </ol>

    <p class="text-gray-300">Let <span class="math">B_{i}=\\{(P_{1},P_{2},\\ldots,P_{\\alpha+1},Q_{1},Q_{2},\\ldots,Q_{\\alpha+1})\\in I_{n}^{2\\alpha+2}</span> that satisfy the conditions on <span class="math">h_{\\alpha}</span>,</p>

    <p class="text-gray-300">the equation <span class="math">X,\\text{ and the equalitity </span>\\beta_{i}<span class="math">}\\}</span>.</p>

    <p class="text-gray-300">We have</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">$h_{\\alpha+1}=2^{n}h_{\\alpha}-</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\cup_{i=1}^{2\\alpha}B_{i}</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">$</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">Moreover, since 3 equalities <span class="math">\\beta_{i}</span> are necessarily not compatible with the conditions on <span class="math">h_{\\alpha}</span>, we have:</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">$h_{\\alpha+1}=2^{n}h_{\\alpha}-\\sum_{i=1}^{2\\alpha}</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">B_{i}</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">+\\sum_{i<j}</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">B_{i}\\cap B_{j}</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">$ (4.2)</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300"><span class="math">\\bullet</span> <span class="math">X+1</span> equations.</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">We have $</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">B_{i}</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">=h_{\\alpha}<span class="math"> (since </span>X<span class="math"> and </span>\\beta_{i}<span class="math"> will fix </span>P_{\\alpha+1}<span class="math"> and </span>Q_{\\alpha+1}<span class="math">), and </span>-\\sum_{i=1}^{2\\alpha}</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">B_{i}</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">=-2\\alpha h_{\\alpha}$.</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300"><span class="math">\\bullet</span> <span class="math">X+2</span> equations.</p>

    <p class="text-gray-300"><span class="math">X</span> is : <span class="math">P_{\\alpha+1}\\oplus Q_{\\alpha+1}=b_{\\alpha+1}</span>. To be compatible with the conditions on <span class="math">h_{\\alpha}</span> the 2 new equalities should be of the type: <span class="math">P_{\\alpha+1}=P_{i}</span> and <span class="math">Q_{\\alpha+1}=Q_{j}</span>, with <span class="math">i\\leq\\alpha</span> and <span class="math">j\\leq\\alpha</span>. Therefore <span class="math">P_{i}\\oplus Q_{j}=b_{\\alpha+1}</span>. We will denote by <span class="math">h^{\\prime}_{\\alpha}(b_{1},\\ldots,b_{\\alpha})(i,j)</span> or simply by <span class="math">h^{\\prime}_{\\alpha}(i,j)</span> for simplicity, the number of <span class="math">(P_{1},\\ldots P_{\\alpha},Q_{1},\\ldots,Q_{\\alpha})\\in I_{n}^{2\\alpha}</span> such that</p>

    <ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">

      <li>We have the conditions on <span class="math">h_{\\alpha}</span> (i.e. the <span class="math">P_{i}</span> are pairwise distinct, the <span class="math">Q_{i}</span> are pairwise distinct, and <span class="math">\\forall i,\\,1\\leq i\\leq\\alpha,\\,P_{i}\\oplus Q_{i}=b_{i}</span>).</li>

      <li><span class="math">P_{i}\\oplus Q_{j}=b_{\\alpha+1}</span> (this is one more affine equality).</li>

    </ol>

    <p class="text-gray-300">Then:</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">$\\sum_{1\\leq i<j\\leq 2\\alpha}</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">B_{i}\\cap B_{j}</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">=\\sum_{i=1}^{\\alpha}\\sum_{j=1}^{\\alpha}h^{\\prime}_{\\alpha}(i,j)$</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">(there, unlike (4.2), we can have <span class="math">i=j</span> because they do not come from the same <span class="math">\\beta_{i}</span>). From (4.2), we get:</p>

    <p class="text-gray-300"><span class="math">h_{\\alpha+1}=(2^{n}-2\\alpha)h_{\\alpha}+\\sum_{i=1}^{\\alpha}\\sum_{j=1}^{\\alpha}h^{\\prime}_{\\alpha}(i,j)</span> (4.3)</p>

    <p class="text-gray-300">Let <span class="math">M = \\{i, 1 \\leq i \\leq \\alpha, b_i = b_{\\alpha + 1}\\}</span>. Let <span class="math">Y(i, j)</span> be the equation added in <span class="math">h_\\alpha&#x27;</span> (i.e. <span class="math">Y(i, j)</span> is <span class="math">P_i \\oplus Q_j = b_{\\alpha + 1}</span>). If <span class="math">i \\in M</span>, then <span class="math">h_\\alpha&#x27;(i, i) = h_\\alpha</span>, and if <span class="math">i \\notin M</span>, then <span class="math">h_\\alpha&#x27;(i, i) = 0</span>. (This is because <span class="math">Y(i, i)</span> is <span class="math">P_i \\oplus Q_i = b_{\\alpha + 1}</span> and we have <span class="math">P_i \\oplus Q_i = b_i</span>). Moreover, if <span class="math">i \\in M</span>, then <span class="math">\\forall j, 1 \\leq j \\leq \\alpha, j \\neq i</span>, we have <span class="math">h_\\alpha&#x27;(i, j) = 0</span>, and <span class="math">h_\\alpha&#x27;(j, i) = 0</span> (*).</p>

    <p class="text-gray-300">(Proof: This is because <span class="math">Y(i,j)</span> is <span class="math">P_{i} \\oplus Q_{j} = b_{\\alpha + 1}</span>. Moreover <span class="math">b_{\\alpha + 1} = b_{i}</span>, since <span class="math">i \\in M</span>, and <span class="math">P_{i} \\oplus Q_{i} = b_{i}</span>. So we would have <span class="math">Q_{i} = Q_{j}</span>. Similarly, <span class="math">Y(j,i)</span> is <span class="math">P_{j} \\oplus Q_{i} = b_{\\alpha + 1} = b_{i}</span> and from <span class="math">P_{i} \\oplus Q_{i} = b_{i}</span>, we would have <span class="math">P_{j} = P_{i}</span>). Therefore, from these results and (4.3), we have obtained:</p>

    <p class="text-gray-300"><strong>Theorem 8</strong> ("Orange equations")</p>

    <p class="text-gray-300">With <span class="math">M = \\{i, 1 \\leq i \\leq \\alpha, b_i = b_{\\alpha + 1}\\}</span>, we have:</p>

    <div class="my-4 text-center"><span class="math-block"></span></div>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">h _ {\\alpha + 1} = (2 ^ {n} - 2 \\alpha +</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">M</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">) h _ {\\alpha} + \\sum_ {i \\notin M} \\sum_ {j \\notin M, j \\neq i} h _ {\\alpha} ^ {\\prime} (i, j)</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <div class="my-4 text-center"><span class="math-block"></span></div>

    <p class="text-gray-300"><strong>Theorem 9</strong> ("Stabilization formula for <span class="math">h_{\\alpha +1}</span>")</p>

    <div class="my-4 text-center"><span class="math-block">\\sum_ {b _ {\\alpha + 1} \\in I _ {n}} h _ {\\alpha + 1} = (2 ^ {n} - \\alpha) ^ {2} h _ {\\alpha}</span></div>

    <p class="text-gray-300"><strong>Proof.</strong> This comes immediately from the fact that in <span class="math">h_{\\alpha + 1}</span> we have <span class="math">P_{\\alpha + 1}</span> and <span class="math">Q_{\\alpha + 1}</span> as new variables, with <span class="math">P_{\\alpha + 1} \\notin \\{P_1, \\ldots, P_\\alpha\\}</span> and <span class="math">Q_{\\alpha + 1} \\notin \\{Q_1, \\ldots, Q_\\alpha\\}</span>. <span class="math">\\square</span></p>

    <p class="text-gray-300"><strong>Theorem 10</strong> ("Stabilization formula for <span class="math">h_\\alpha^\\prime</span>")</p>

    <p class="text-gray-300"><span class="math">\\forall i,j,i\\neq j,\\sum_{b_{\\alpha +1}\\notin \\{b_i,b_j\\}}h_\\alpha &#x27;(i,j) = h_\\alpha .</span></p>

    <p class="text-gray-300"><strong>Proof.</strong> Theorem 10 follows immediately from <span class="math">(*)</span> above (just before Theorem 8). <span class="math">\\square</span></p>

    <p class="text-gray-300"><strong>First Approximation: Security in <span class="math">O\\left(\\frac{m^3}{2^{2n}}\\right)</span></strong></p>

    <p class="text-gray-300">From (4.2) we have: <span class="math">h_{\\alpha + 1} \\geq (2^n - 2\\alpha)h_\\alpha</span>. Then from (4.1)</p>

    <div class="my-4 text-center"><span class="math-block">\\frac {h _ {\\alpha + 1}}{\\tilde {h} _ {\\alpha + 1}} = \\frac {h _ {\\alpha}}{\\tilde {h} _ {\\alpha}} \\frac {(2 ^ {n} - 2 \\alpha)}{2 ^ {n} - 2 \\alpha + \\frac {\\alpha^ {2}}{2 ^ {n}}}</span></div>

    <div class="my-4 text-center"><span class="math-block">\\frac {h _ {\\alpha + 1}}{\\tilde {h} _ {\\alpha + 1}} = \\frac {h _ {\\alpha}}{\\tilde {h} _ {\\alpha}} \\Big (1 - \\frac {\\frac {\\alpha^ {2}}{2 ^ {n}}}{2 ^ {n} - 2 \\alpha + \\frac {\\alpha^ {2}}{2 ^ {n}}} \\Big)</span></div>

    <p class="text-gray-300">Now since <span class="math">h_1 = 2^n</span> and <span class="math">\\tilde{h}_1 = 2^n</span>,</p>

    <div class="my-4 text-center"><span class="math-block">h _ {\\alpha} \\geq \\tilde {h} _ {\\alpha} \\Big (1 - \\frac {\\alpha^ {2}}{2 ^ {2 n} - 2 \\alpha \\cdot 2 ^ {n} + \\alpha^ {2}} \\Big) ^ {\\alpha}</span></div>

    <p class="text-gray-300"><strong>First step result:</strong></p>

    <div class="my-4 text-center"><span class="math-block">h _ {\\alpha} \\geq \\tilde {h} _ {\\alpha} \\left(1 - \\frac {\\alpha^ {3}}{2 ^ {2 n} - 2 \\alpha \\cdot 2 ^ {n} + \\alpha^ {2}}\\right) \\tag {4.4}</span></div>

    <p class="text-gray-300">Therefore (from Theorem 7):</p>

    <p class="text-gray-300">Theorem 11</p>

    <p class="text-gray-300"><span class="math">Adv_{\\alpha}^{PRF}\\leq\\frac{\\alpha^{3}}{2^{2n}-2\\alpha\\cdot 2^{n}+\\alpha^{2}}</span> (4.5)</p>

    <p class="text-gray-300">(and the probability to distinguish is <span class="math">\\frac{1}{2}+\\frac{1}{2}\\cdot Adv_{m}</span> as usual).</p>

    <p class="text-gray-300">We have proved security in <span class="math">O(\\frac{\\alpha^{3}}{2^{2n}})</span>.</p>

    <p class="text-gray-300">Remark. the fact that we have so far proved security when <span class="math">\\alpha\\ll 2^{\\frac{2n}{3}}</span> is not very impressive compared with we have previously obtained with the <span class="math">H_{\\sigma}</span> technique (i.e. with the <span class="math">\\lambda_{\\alpha}</span> values). However, the fact that <span class="math">Adv^{PRF}</span> decreases in <span class="math">2^{2n}</span> when <span class="math">\\alpha</span> is fixed is interesting.</p>

    <h2 id="sec-16" class="text-2xl font-bold">5 Second Approximation: Security in <span class="math">O(\\frac{m^{4}}{2^{3n}}+\\frac{m^{2}}{2^{2n}})</span></h2>

    <h6 id="sec-17" class="text-base font-medium mt-4">Lemma 1</h6>

    <p class="text-gray-300">(Simple Approximation of <span class="math">h_{\\alpha}^{\\prime}</span>) If <span class="math">i\\notin M,\\;j\\notin M</span>, and <span class="math">i\\neq j</span>, we always have:</p>

    <p class="text-gray-300"><span class="math">\\frac{h_{\\alpha}}{2^{n}}(1-\\frac{4\\alpha}{2^{n}})\\leq h_{\\alpha}^{\\prime}(i,j)\\leq\\frac{h_{\\alpha}}{2^{n}(1-\\frac{4\\alpha}{2^{n}})}</span></p>

    <p class="text-gray-300">Proof. Without loss of generality, just by changing the order of the indices, we can assume that <span class="math">i=\\alpha-1</span> and <span class="math">j=\\alpha</span>, i.e. that the new equation <span class="math">Y</span> is: <span class="math">P_{\\alpha-1}\\oplus Q_{\\alpha}=b_{\\alpha+1}</span>. We will now evaluate <span class="math">h_{\\alpha}</span> and <span class="math">h_{\\alpha}^{\\prime}</span> from <span class="math">h_{\\alpha-2}</span>. When we go from <span class="math">h_{\\alpha-2}</span> to <span class="math">h_{\\alpha}</span>, we have 4 new variables <span class="math">P_{\\alpha},Q_{\\alpha},P_{\\alpha-1},Q_{\\alpha-1}</span> such that <span class="math">P_{\\alpha}\\oplus Q_{\\alpha}=b_{\\alpha}</span>, <span class="math">P_{\\alpha-1}\\oplus Q_{\\alpha-1}=b_{\\alpha-1}</span>, <span class="math">\\forall i,\\,1\\leq i\\leq\\alpha-2,\\;P_{\\alpha-1}\\neq P_{i}</span> <span class="math">\\forall i,\\,1\\leq i\\leq\\alpha-2,\\;Q_{\\alpha-1}\\neq Q_{i}</span> <span class="math">\\forall i,\\,1\\leq i\\leq\\alpha-1,\\;P_{\\alpha}\\neq P_{i}</span> <span class="math">\\forall i,\\,1\\leq i\\leq\\alpha-1,\\;Q_{\\alpha}\\neq Q_{i}</span> For <span class="math">P_{\\alpha-1}</span>, we have between <span class="math">2^{n}-(\\alpha-2)</span> and <span class="math">2^{n}-2(\\alpha-2)</span> possibilities. Now, when <span class="math">P_{\\alpha-1}</span> is fixed, for <span class="math">P_{\\alpha}</span>, we have between <span class="math">2^{n}-(\\alpha-1)</span> and <span class="math">2^{n}-2(\\alpha-1)</span> possibilities. Therefore:</p>

    <p class="text-gray-300"><span class="math">(2^{n}-2(\\alpha-1))(2^{n}-2(\\alpha-2))h_{\\alpha-2}\\leq h_{\\alpha}\\leq(2^{n}-(\\alpha-1))(2^{n}-(\\alpha-2))h_{\\alpha-2}</span></p>

    <p class="text-gray-300">So</p>

    <p class="text-gray-300"><span class="math">(2^{2n}-4\\alpha\\cdot 2^{n})h_{\\alpha-2}\\leq h_{\\alpha}\\leq 2^{2n}h_{\\alpha-2}</span> (5.1)</p>

    <p class="text-gray-300">Similarly, when we go from <span class="math">h_{\\alpha-2}</span> to <span class="math">h_{\\alpha}^{\\prime}</span>, we have 4 new variables <span class="math">P_{\\alpha},Q_{\\alpha},P_{\\alpha-1},Q_{\\alpha-1}</span> such that: <span class="math">P_{\\alpha}\\oplus Q_{\\alpha}=b_{\\alpha},\\;P_{\\alpha-1}\\oplus Q_{\\alpha-1}=b_{\\alpha-1},\\;P_{\\alpha-1}\\oplus Q_{\\alpha}=b_{\\alpha+1}</span>, and <span class="math">\\forall i,\\,1\\leq i\\leq\\alpha-2:\\;P_{\\alpha-1}\\neq P_{i},\\,Q_{\\alpha-1}\\neq Q_{i},\\;P_{\\alpha}\\neq P_{i}</span>, and <span class="math">Q_{\\alpha}\\neq Q_{i}</span>. (we necessarily have <span class="math">P_{\\alpha}\\neq P_{\\alpha-1}</span> and <span class="math">Q_{\\alpha}\\neq Q_{\\alpha-1}</span> since <span class="math">P_{\\alpha}\\oplus P_{\\alpha-1}=b_{\\alpha}\\oplus b_{\\alpha+1}</span> and <span class="math">Q_{\\alpha}\\oplus Q_{\\alpha-1}=b_{\\alpha}\\oplus b_{\\alpha+1}</span> and these values are <span class="math">\\neq 0</span> since <span class="math">i\\notin M</span> and <span class="math">j\\notin M</span>). Therefore, for <span class="math">P_{\\alpha}</span> we have between <span class="math">2^{n}-(\\alpha-2)</span> and <span class="math">2^{n}-4(\\alpha-2)</span> possibilities.</p>

    <p class="text-gray-300"><span class="math">(2^{n}-4(\\alpha-2))h_{\\alpha-2}\\leq h_{\\alpha}\\leq(2^{n}-(\\alpha-2))h_{\\alpha-2}</span> (5.2)</p>

    <p class="text-gray-300">From (5.1) and (5.2), we obtain lemma 1, as claimed. <span class="math">\\Box</span></p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Lemma 2 (A simple way to get ride of $</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">M</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">$)</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">If <span class="math">\\alpha \\leq \\frac{2^n}{6}</span>, then there exists a value <span class="math">h_\\alpha&#x27;</span> such that:</p>

    <div class="my-4 text-center"><span class="math-block">h_{\\alpha+1} \\geq (2^n - 2\\alpha) h_\\alpha + \\alpha (\\alpha - 1) h_\\alpha&#x27;</span></div>

    <p class="text-gray-300">(The condition <span class="math">\\alpha \\leq \\frac{2^n}{6}</span> could be improved with further analysis).</p>

    <p class="text-gray-300">Proof of Lemma 2. From Theorem 8, we have:</p>

    <div class="my-4 text-center"><span class="math-block"></span></div>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">h_{\\alpha+1} \\geq (2^n - 2\\alpha +</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">M</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">) h_\\alpha + [(\\alpha -</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">M</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">)(\\alpha -</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">M</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">) - \\alpha] h_\\alpha'</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <div class="my-4 text-center"><span class="math-block"></span></div>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">So a sufficient condition for <span class="math">h_{\\alpha+1} \\geq (2^n - 2\\alpha) h_\\alpha + [\\alpha^2 - \\alpha] h_\\alpha&#x27;</span> is to have $</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">M</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">h_\\alpha \\geq (2\\alpha</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">M</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">-</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">M</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">^2) h_\\alpha' (*)$.</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">Security in <span class="math">O\\left(\\frac{m^2}{2^{2n}} + \\frac{m^4}{2^{2n}}\\right)</span></p>

    <p class="text-gray-300">From Theorem 8 and Lemma 1, we have:</p>

    <div class="my-4 text-center"><span class="math-block"></span></div>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">h_{\\alpha+1} \\geq (2^n - 2\\alpha +</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">M</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">) h_\\alpha + [(\\alpha -</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">M</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">)(\\alpha -</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">M</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">) - \\alpha] \\frac{h_\\alpha}{2^n} \\left(1 - \\frac{4\\alpha}{2^n}\\right)</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <div class="my-4 text-center"><span class="math-block"></span></div>

    <div class="my-4 text-center"><span class="math-block"></span></div>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">h_{\\alpha+1} \\geq (2^n - 2\\alpha +</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">M</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">+ \\frac{\\alpha^2 - 2</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">M</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\alpha +</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">M</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">^2 - \\alpha}{2^n}) h_\\alpha - \\frac{4\\alpha^3}{2^{2n}} h_\\alpha</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <div class="my-4 text-center"><span class="math-block"></span></div>

    <p class="text-gray-300">We have</p>

    <div class="my-4 text-center"><span class="math-block"></span></div>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">M</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">+ \\frac{-2</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">M</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\alpha +</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">M</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">^2}{2^n} \\geq 0 \\Leftrightarrow \\alpha \\leq \\frac{2^n +</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">M</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">}{2}</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <div class="my-4 text-center"><span class="math-block"></span></div>

    <p class="text-gray-300">We will assume that <span class="math">\\alpha \\leq \\frac{2^n}{2}</span> (this condition could be improved with further analysis). Then</p>

    <div class="my-4 text-center"><span class="math-block">h_{\\alpha+1} \\geq \\left(2^n - 2\\alpha + \\frac{\\alpha^2 - \\alpha}{2^n} - \\frac{4\\alpha^3}{2^{2n}}\\right) h_\\alpha</span></div>

    <p class="text-gray-300">Remark. We can also get this directly from Lemma 2 and Lemma 1 but with <span class="math">\\alpha \\leq \\frac{2^n}{6}</span> instead of <span class="math">\\alpha \\leq \\frac{2^n}{2}</span></p>

    <div class="my-4 text-center"><span class="math-block">\\frac{h_{\\alpha+1}}{\\tilde{h}_{\\alpha+1}} \\geq \\frac{2^n - 2\\alpha + \\frac{\\alpha^2 - \\alpha}{2^n} - \\frac{4\\alpha^3}{2^{2n}} h_\\alpha}{2^n - 2\\alpha + \\frac{\\alpha^2}{2^n}} \\frac{h_\\alpha}{\\tilde{h}_\\alpha}</span></div>

    <div class="my-4 text-center"><span class="math-block">\\frac{h_{\\alpha+1}}{\\tilde{h}_{\\alpha+1}} \\geq \\left(1 - \\frac{\\alpha}{(2^n - \\alpha)^2} - \\frac{4\\alpha^3}{2^n (2^n - \\alpha)^2}\\right) \\frac{h_\\alpha}{\\tilde{h}_\\alpha}</span></div>

    <p class="text-gray-300">Therefore</p>

    <div class="my-4 text-center"><span class="math-block">h_\\alpha \\geq \\left(1 - \\frac{\\alpha}{(2^n - \\alpha)^2} - \\frac{4\\alpha^3}{2^n (2^n - \\alpha)^2}\\right)^\\alpha \\tilde{h}_\\alpha</span></div>

    <p class="text-gray-300">Second Step result:</p>

    <div class="my-4 text-center"><span class="math-block">\\underline{h_\\alpha \\geq \\left(1 - \\frac{\\alpha^2}{(2^n - \\alpha)^2} - \\frac{4\\alpha^4}{2^n (2^n - \\alpha)^2}\\right) \\tilde{h}_\\alpha} \\tag{5.3}</span></div>

    <p class="text-gray-300">Now from (5.3) we have for all CPA-2 attacks with <span class="math">m</span> queries:</p>

    <p class="text-gray-300"><span class="math">Adv^{PRF}\\leq\\frac{m^{2}}{(2^{n}-m)^{2}}+\\frac{4m^{4}}{2^{n}(2^{n}-m)^{2}}</span> (5.4)</p>

    <p class="text-gray-300">(here we do not need to say “when <span class="math">m\\leq\\frac{2^{n}}{2}</span>” since for larger <span class="math">m</span>, this value is larger than 1).</p>

    <p class="text-gray-300">Remark (5.4) gives security in <span class="math">O(\\frac{m^{2}}{2^{2n}}+\\frac{m^{4}}{2^{3n}})</span> with <span class="math">m</span> queries as wanted in this section. In (5.4), we have two terms. The first term in <span class="math">\\frac{m^{2}}{2^{2n}}</span> is consistent with the fact that when <span class="math">m=2</span> for example we know that we must have a term in <span class="math">2^{2n}</span> (see Appendix A: the value for the advantage with 2 queries is exactly <span class="math">\\frac{1}{2^{n}(2^{n}-1)}</span>). The second term gives security only when <span class="math">m\\ll 2^{\\frac{3n}{4}}</span> and we will see in the next sections how to improve this term.</p>

    <h2 id="sec-18" class="text-2xl font-bold">6 An induction formula on <span class="math">h^{\\prime}_{\\alpha}</span> (“First purple equations”)</h2>

    <h6 id="sec-19" class="text-base font-medium mt-4">Theorem 12</h6>

    <p class="text-gray-300">(“first purple equations”):</p>

    <p class="text-gray-300"><span class="math">h^{\\prime}_{\\alpha+1}=h_{\\alpha}+(-2\\alpha+2+\\nu+\\xi+\\mu)h^{\\prime}_{\\alpha}+\\sum_{(i,j)\\in\\mathcal{N}}h^{\\prime\\prime}_{\\alpha}</span></p>

    <p class="text-gray-300">with</p>

    <ul class="list-disc list-inside space-y-1 text-gray-300 my-2 ml-4">

      <li><span class="math">\\mathcal{N}=\\{(i,j),\\,i\\neq j,\\,2\\leq i\\leq\\alpha,\\,2\\leq j\\leq\\alpha,\\,\\text{such that none of the 4 equalitites </span>\\mathcal{S}<span class="math"> are satified}\\}</span></li>

    </ul>

    <p class="text-gray-300">The <span class="math">\\mathcal{S}</span> equalities are</p>

    <ul class="list-disc list-inside space-y-1 text-gray-300 my-2 ml-4">

      <li><span class="math">b_{\\alpha+1}=b_{j}</span>.</li>

      <li><span class="math">b_{\\alpha+2}=b_{j}</span>.</li>

      <li><span class="math">b_{\\alpha+1}=b_{i}</span>.</li>

      <li><span class="math">b_{1}\\oplus b_{\\alpha+1}\\oplus b_{\\alpha+2}\\oplus b_{i}=0</span>.</li>

      <li><span class="math">\\mu</span> is the number of <span class="math">i,\\,2\\leq i\\leq\\alpha,\\ b_{\\alpha+1}=b_{i}</span>.</li>

      <li><span class="math">\\xi</span> is the number of <span class="math">i,\\,2\\leq i\\leq\\alpha,\\ b_{\\alpha+2}=b_{i}</span>.</li>

      <li><span class="math">\\nu</span> is the number of <span class="math">i,\\,2\\leq i\\leq\\alpha,\\ b_{1}\\oplus b_{\\alpha+1}\\oplus b_{\\alpha+2}\\oplus b_{i}=0</span>.</li>

    </ul>

    <p class="text-gray-300">Proof. We have that <span class="math">h^{\\prime}_{\\alpha+1}</span> is the number of <span class="math">P_{1},\\ldots,P_{\\alpha+1},Q_{1},\\ldots,Q_{\\alpha+1}</span> such that:</p>

    <ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">

      <li>The <span class="math">P_{i}</span> values are pairwise distinct.</li>

      <li>The <span class="math">Q_{i}</span> values are pairwise distinct.</li>

      <li>We have all the equalities of <span class="math">h_{\\alpha+1}</span>: <span class="math">P_{1}\\oplus Q_{1}=b_{1},\\ldots,P_{\\alpha+1}\\oplus Q_{\\alpha+1}=b_{\\alpha+1}</span>.</li>

      <li>We have the extra equation <span class="math">X</span>: <span class="math">Q_{\\alpha+1}\\oplus P_{1}=b_{\\alpha+2}</span>, with <span class="math">b_{\\alpha+1}\\neq b_{\\alpha+2}</span> (in order to have <span class="math">P_{\\alpha+1}\\neq P_{1}</span>) and <span class="math">b_{1}\\neq b_{\\alpha+2}</span> (in order to have <span class="math">Q_{\\alpha+1}\\neq Q_{1}</span>).</li>

    </ol>

    <p class="text-gray-300"><span class="math">\\forall i,\\ 1\\leq i\\leq 2\\alpha</span>, we define by <span class="math">B^{\\prime}_{i}</span> the set of all <span class="math">(P_{1},\\ldots,P_{\\alpha+1},Q_{1},\\ldots,Q_{\\alpha+1})</span> that satisfy:</p>

    <ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">

      <li>All the conditions <span class="math">h_{\\alpha}</span></li>

    </ol>

    <p class="text-gray-300">(b) The equation  <span class="math">X</span> (c) The equation  <span class="math">P_{\\alpha +1}\\oplus Q_{\\alpha +1} = b_{\\alpha +1}</span> (d) The equation  <span class="math">\\beta_{i}</span>  (these equations have been defined in section 4, for example  <span class="math">\\beta_{1}</span>  is  <span class="math">P_{\\alpha +1} = P_1</span> ,  <span class="math">\\beta_{2}</span>  is  <span class="math">P_{\\alpha +1} = P_2</span> , ...,  <span class="math">\\beta_{\\alpha}</span>  is  <span class="math">P_{\\alpha +1} = P_{\\alpha}</span> ,  <span class="math">\\beta_{\\alpha +1}</span>  is  <span class="math">Q_{\\alpha +1} = Q_1</span> , ..., and  <span class="math">\\beta_{2\\alpha}</span>  is  <span class="math">Q_{\\alpha +1} = Q_{\\alpha}</span> ).</p>

    <p class="text-gray-300">In  <span class="math">h_{\\alpha + 1}&#x27;</span>  we have 2 new variables  <span class="math">P_{\\alpha + 1}</span>  and  <span class="math">Q_{\\alpha + 1}</span> . These variables are fixed by:</p>

    <div class="my-4 text-center"><span class="math-block">\\left\\{ \\begin{array}{l} P _ {\\alpha + 1} \\oplus Q _ {\\alpha + 1} = b _ {\\alpha + 1} \\\\ X: Q _ {\\alpha + 1} \\oplus P _ {1} = b _ {\\alpha + 2} \\end{array} \\right.</span></div>

    <p class="text-gray-300">We have:</p>

    <div class="my-4 text-center"><span class="math-block"></span></div>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">h_{\\alpha +1}^{\\prime} = h_{\\alpha} -</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\bigcup_{\\substack{i = 2\\\\ i\\neq \\alpha +1}}^{2\\alpha}B_{i}^{\\prime}</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <div class="my-4 text-center"><span class="math-block"></span></div>

    <p class="text-gray-300">(here  <span class="math">i = 1</span>  is excluded since  <span class="math">P_{\\alpha +1}\\neq P_1</span>  and similarly  <span class="math">i = \\alpha +1</span>  is excluded since  <span class="math">Q_{\\alpha +1}\\neq Q_1</span> ).</p>

    <p class="text-gray-300">!<a href="img-0.jpeg">img-0.jpeg</a> Figure 1: "6-point figure" for  <span class="math">X + (1</span>  equation  <span class="math">P_{\\alpha + 1} = P_i)</span> .</p>

    <p class="text-gray-300">Since 3 equations  <span class="math">\\beta_{i}</span>  are not compatible with the conditions  <span class="math">h_\\alpha</span> , we have:</p>

    <div class="my-4 text-center"><span class="math-block"></span></div>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">h_{\\alpha +1}^{\\prime} = h_{\\alpha} - \\sum_{\\substack{i = 2\\\\ i\\neq \\alpha +1}}^{2\\alpha}</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">B_{i}^{\\prime}</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">+ \\sum_{i = 2}^{\\alpha}\\sum_{j = \\alpha +2}^{2\\alpha}</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">B_{i}^{\\prime}\\cap B_{j}^{\\prime}</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <div class="my-4 text-center"><span class="math-block"></span></div>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">We want to evaluate  $</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">B_i'</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"><span class="math"> . These values are denoted as a value  </span>h_\\alpha'<span class="math">  (since we have one more equation than in  </span>h_\\alpha<span class="math"> ), except when  </span></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">B_i'</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">= 0$ .</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Case 1. If  <span class="math">\\beta_{i}</span>  is  <span class="math">P_{\\alpha +1} = P_{i}</span>  ( <span class="math">2\\leq i\\leq \\alpha</span> ) we will have  $</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">B_i^{\\prime}</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">= 0<span class="math">  if  </span>\\beta_{i}<span class="math">  generates a collision on  </span>Q_{i}<span class="math"> , this means here the collision  </span>Q_{i} = Q_{1}$  (see Figure 1).</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300"><span class="math">P_{\\alpha +1} = P_{i}</span>  means  <span class="math">P_{1} = P_{i}\\oplus b_{\\alpha +1}\\oplus b_{\\alpha +2}</span></p>

    <p class="text-gray-300"><span class="math">Q_{i} = Q_{1}</span>  means  <span class="math">b_{i} = b_{1}\\oplus b_{\\alpha +1}\\oplus b_{\\alpha +2}</span>  (  <span class="math">\\nu</span>  values  <span class="math">i</span>  are like this).</p>

    <p class="text-gray-300">Remark.  <span class="math">Q_{i} \\neq Q_{\\alpha + 1}</span>  (unlike  <span class="math">Q_{i} \\neq Q_{1}</span> ) is not one of the conditions of  <span class="math">B_{i}&#x27;</span> . (We want to evaluate  <span class="math">h_{\\alpha + 1}&#x27;</span>  from solutions  <span class="math">h_{\\alpha}</span>  and in  <span class="math">h_{\\alpha}</span>  we do not have the variables  <span class="math">P_{\\alpha + 1}</span>  and  <span class="math">Q_{\\alpha + 1}</span> ). Here  <span class="math">Q_{i} = Q_{\\alpha + 1}</span>  means  <span class="math">b_{i} = b_{\\alpha + 1}</span> , and we have  <span class="math">\\mu</span>  values  <span class="math">i</span>  like this but we do not need this here.</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Case 2. If  <span class="math">\\beta_{j}</span>  is  <span class="math">Q_{\\alpha +1} = Q_{i}</span>  ( <span class="math">2\\leq i\\leq \\alpha</span> ,  <span class="math">j = \\alpha +i</span> ) we will have  $</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">B_i^{\\prime}</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">= 0<span class="math">  if  </span>\\beta_{j}<span class="math">  generates a collision  </span>P_{i} = P_{1}$ .</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300"><span class="math">Q_{\\alpha +1} = Q_{i}</span>  means  <span class="math">P_{1} = P_{i}\\oplus b_{i}\\oplus b_{\\alpha +2}</span></p>

    <p class="text-gray-300"><span class="math">P_{i} = P_{1}</span>  means  <span class="math">b_{i} = b_{\\alpha +2}</span>  ( <span class="math">\\xi</span>  values  <span class="math">i</span>  are like this).</p>

    <p class="text-gray-300">Remark.  <span class="math">P_{i} \\neq P_{\\alpha + 1}</span>  (unlike  <span class="math">P_{i} \\neq P_{1}</span> ) is not one of the conditions of  <span class="math">B_{i}&#x27;</span> . (We want to evaluate  <span class="math">h_{\\alpha + 1}&#x27;</span>  from solutions  <span class="math">h_{\\alpha}</span>  and in  <span class="math">h_{\\alpha}</span>  we do not have the variables  <span class="math">P_{\\alpha + 1}</span>  and  <span class="math">Q_{\\alpha + 1}</span> ). Here  <span class="math">P_{i} = P_{\\alpha + 1}</span>  means  <span class="math">b_{i} = b_{\\alpha + 1}</span> , and we have  <span class="math">\\mu</span>  values  <span class="math">i</span>  like this, but we do not need this here.</p>

    <p class="text-gray-300">From Case 1 and Case 2, we have:</p>

    <p class="text-gray-300">!<a href="img-1.jpeg">img-1.jpeg</a> Figure 2: "8-point figure" for  <span class="math">X + 2</span>  equations</p>

    <p class="text-gray-300">Case 1. The two equations <span class="math">P_{\\alpha+1}=P_{i}</span> and <span class="math">Q_{\\alpha+1}=Q_{j}</span> are not independent and create a term in <span class="math">h^{\\prime}_{\\alpha}</span>. This implies that <span class="math">i=j</span> (because if <span class="math">i\\neq j</span> then <span class="math">Q_{i}</span> and <span class="math">Q_{j}</span> are not connected by <span class="math">P_{\\alpha+1}=P_{i}</span>) and then <span class="math">Q_{i}=Q_{\\alpha+1}</span> means <span class="math">b_{i}=b_{\\alpha+1}</span> as seen in the section <span class="math">X+1</span> equation above. Therefore, we have here a term in <span class="math">\\mu\\,h^{\\prime}_{\\alpha}</span>. If <span class="math">i=j</span> and <span class="math">b_{i}\\neq b_{\\alpha+1}</span> then <span class="math">Q_{\\alpha+1}\\neq Q_{j}</span>. Therefore we will now assume (in Case 2) that <span class="math">i\\neq j</span>. Case 2. <span class="math">i\\neq j</span> and the two equations <span class="math">P_{\\alpha+1}=P_{i}</span> and <span class="math">Q_{\\alpha+1}=Q_{j}</span> generate a collision. We have seen in the section <span class="math">X+1</span> equation that from <span class="math">P_{\\alpha+1}=P_{i}</span>, <span class="math">Q_{i}=Q_{1}</span> means <span class="math">b_{i}=b_{1}\\oplus b_{\\alpha+1}\\oplus b_{\\alpha+2}</span> (<span class="math">\\nu</span> values) (<span class="math">Q_{i}=Q_{\\alpha+1}</span> means <span class="math">b_{i}=b_{\\alpha+1}</span>, <span class="math">\\mu</span> values, this will occur below on <span class="math">Q_{i}=Q_{j}</span>) and from <span class="math">Q_{\\alpha+1}=Q_{j}</span>, <span class="math">P_{j}=P_{1}</span> means <span class="math">b_{j}=b_{\\alpha+2}</span> (<span class="math">\\xi</span> values) (<span class="math">P_{j}=P_{\\alpha+1}</span> means <span class="math">b_{j}=b_{\\alpha+1}</span>, <span class="math">\\mu</span> values, this will occur below on <span class="math">P_{i}=P_{j}</span>) Moreover: <span class="math">P_{i}=P_{j}</span> means here <span class="math">b_{j}=b_{\\alpha+1}</span> (the same as <span class="math">P_{j}=P_{\\alpha+1}</span> since we have <span class="math">P_{\\alpha+1}=P_{i}</span>) <span class="math">Q_{i}=Q_{j}</span> means here <span class="math">b_{i}=b_{\\alpha+1}</span> (the same as <span class="math">Q_{i}=Q_{\\alpha+1}</span> since we have <span class="math">Q_{\\alpha+1}=Q_{j}</span>). With the definitions of <span class="math">\\mathcal{N}</span> and <span class="math">\\mathcal{S}</span> given above and from Case 1 and Case 2, we see that</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">$\\sum_{i=2}^{\\alpha}\\sum_{j=\\alpha+2}^{2\\alpha}</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">B^{\\prime}_{i}\\cap B^{\\prime}_{j}</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">=\\mu h^{\\prime}_{\\alpha}+\\sum_{(i,j)\\in\\mathcal{N}}h^{\\prime\\prime}_{\\alpha}$</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">Therefore</p>

    <p class="text-gray-300"><span class="math">h^{\\prime}_{\\alpha+1}=h_{\\alpha}+(-2\\alpha+2+\\nu+\\xi+\\mu)h^{\\prime}_{\\alpha}+\\sum_{(i,j)\\in\\mathcal{N}}h^{\\prime\\prime}_{\\alpha}</span></p>

    <p class="text-gray-300">as claimed. <span class="math">\\square</span> Example Let compute <span class="math">h^{\\prime}_{3}</span> when <span class="math">b_{2}=b_{3}</span> is the only exceptional relation on the <span class="math">b_{i}</span> values. We have: <span class="math">P_{1}\\oplus Q_{1}=b_{1}</span>, <span class="math">P_{2}\\oplus Q_{2}=b_{2}</span>, <span class="math">P_{3}\\oplus Q_{3}=b_{3}=b_{2}</span> and <span class="math">X:\\,Q_{3}\\oplus P_{1}=b_{4}</span>. Here <span class="math">\\alpha=2</span>, <span class="math">\\mu=1</span>, <span class="math">\\nu=\\xi=0</span>. Theorem 12 gives:</p>

    <p class="text-gray-300"><span class="math">h^{\\prime}_{3}=h_{2}+(-4+2+1)h^{\\prime}_{2}+\\sum_{(i,j)\\in\\mathcal{N}}h^{\\prime\\prime}_{2}</span></p>

    <p class="text-gray-300">Since <span class="math">h^{\\prime\\prime}_{2}=0</span> (because all the variables are already linked in <span class="math">h^{\\prime}_{2}</span>) and since <span class="math">h^{\\prime}_{2}=2^{n}</span> and <span class="math">h_{2}=2^{n}(2^{n}-2)</span> (because <span class="math">b_{1}\\neq b_{2}</span>), this gives: <span class="math">h^{\\prime}_{3}=2^{n}(2^{n}-2)-2^{n}=2^{n}(2^{n}-3)</span>. This value can also be verified directly. It is also interesting to see how the proof of Theorem 12 proceeds on this example.</p>

    <p class="text-gray-300">We have: <span class="math">\\beta_{1}:P_{3}=P_{1}</span> (impossible since <span class="math">b_{2}\\neq b_{4}</span>) <span class="math">\\beta_{2}:P_{3}=P_{2}</span> <span class="math">\\beta_{3}:Q_{3}=Q_{1}</span> (impossible since <span class="math">b_{1}\\neq b_{4}</span>) <span class="math">\\beta_{4}:Q_{3}=Q_{2}</span></p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">In <span class="math">h^{\\prime}_{3}</span> we have 2 new variables <span class="math">P_{3}</span> and <span class="math">Q_{3}</span>. These variables are fixed from <span class="math">P_{1}</span>; however all the solutions for <span class="math">h_{2}</span> do not necessary give a solution <span class="math">h^{\\prime}_{3}</span> since in <span class="math">h^{\\prime}_{3}</span> we must have <span class="math">P_{3}\\neq P_{2}</span> and <span class="math">Q_{3}\\neq Q_{2}</span>. More precisely: $h^{\\prime}_{3}=h_{2}-</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">B^{\\prime}_{2}\\cup B^{\\prime}_{4}</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">$. This gives:</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">$h^{\\prime}_{3}=h_{2}-</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">B^{\\prime}_{2}</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">-</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">B^{\\prime}_{4}</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">+</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">B^{\\prime}_{2}\\cap B^{\\prime}_{4}</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">$</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">!<a href="img-2.jpeg">img-2.jpeg</a> Figure 3: Computation of  <span class="math">h_3&#x27;</span>  from  <span class="math">h_2</span>  on this example.</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">We have:  $</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">B_2'</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">= h_3' = 2^n<span class="math">  because  </span>P_3 = P_2<span class="math">  do not generate  </span>Q_2 = Q_1<span class="math">  (since  </span>b_1 \\neq b_4<span class="math"> ). Similarly  </span></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">B_4'</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">= h_3' = 2^n<span class="math"> . Moreover  </span></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">B_2' \\cap B_4'</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">= 2^n<span class="math">  since here  </span>P_3 = P_2 \\Leftrightarrow Q_3 = Q_2<span class="math">  (since  </span>b_2 = b_3<span class="math"> ). Therefore  </span>h_3' = 2^n (2^n - 2) - 2^n = 2^n (2^n - 3)$ .</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">Theorem 13 With the same notation of Theorem 12, we have:</p>

    <div class="my-4 text-center"><span class="math-block"></span></div>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\mathcal {N}</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">= (\\alpha - 1) (\\alpha - 2) - (\\alpha - 2) (2 \\mu + \\nu + \\xi) + \\mu (\\mu - 1) + \\mu \\xi + \\nu \\xi + \\xi (\\nu - \\epsilon_ {1})</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <div class="my-4 text-center"><span class="math-block"></span></div>

    <p class="text-gray-300">with</p>

    <div class="my-4 text-center"><span class="math-block">\\epsilon_ {1} = 1 \\Leftrightarrow b _ {1} = b _ {\\alpha + 1}</span></div>

    <p class="text-gray-300">and</p>

    <div class="my-4 text-center"><span class="math-block">\\epsilon_ {1} = 0 \\Leftrightarrow b _ {1} \\neq b _ {\\alpha + 1}</span></div>

    <p class="text-gray-300">Proof.  <span class="math">\\mathcal{N}</span>  is the set of all  <span class="math">(i,j)</span> ,  <span class="math">i \\neq j</span> ,  <span class="math">2 \\leq i \\leq \\alpha</span> ,  <span class="math">2 \\leq j \\leq \\alpha</span>  such that we have none of these 4 equalities:</p>

    <p class="text-gray-300"><span class="math">b_{i} = b_{\\alpha +1}</span>  (1)  <span class="math">(\\mu</span>  values)</p>

    <p class="text-gray-300"><span class="math">b_{i} = b_{1}\\oplus b_{\\alpha +1}\\oplus b_{\\alpha +2}</span>  (2)  <span class="math">(\\nu</span>  values)</p>

    <p class="text-gray-300"><span class="math">b_{j} = b_{\\alpha +1}</span>  (3)  <span class="math">(\\mu</span>  values)</p>

    <p class="text-gray-300"><span class="math">b_{j} = b_{\\alpha +2}</span>  (4)  <span class="math">(\\xi</span>  values)</p>

    <p class="text-gray-300">(1) and (2) are not compatible since  <span class="math">b_{1} \\neq b_{\\alpha + 2}</span> (3) and (4) are not compatible since  <span class="math">b_{\\alpha + 1} \\neq b_{\\alpha + 2}</span> .</p>

    <p class="text-gray-300">We have  <span class="math">(\\alpha - 1)(\\alpha - 2)</span>  values  <span class="math">(i, j)</span> ,  <span class="math">i \\neq j</span> ,  <span class="math">2 \\leq i \\leq \\alpha</span> ,  <span class="math">2 \\leq j \\leq \\alpha</span> . We have  <span class="math">(\\mu + \\nu)(\\alpha - 2)</span>  values  <span class="math">(i, j)</span>  such that  <span class="math">i</span>  satisfies (1) or (2) and  <span class="math">j \\neq i</span> . We have  <span class="math">(\\mu + \\xi)(\\alpha - 2)</span>  values  <span class="math">(i, j)</span>  such that  <span class="math">j</span>  satisfies (3) or (4) and  <span class="math">j \\neq i</span> . Therefore</p>

    <div class="my-4 text-center"><span class="math-block"></span></div>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\mathcal {N}</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">= (\\alpha - 1) (\\alpha - 2) - (\\mu + \\nu) (\\alpha - 2) - (\\mu + \\xi) (\\alpha - 2) +</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\mathcal {P}</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <div class="my-4 text-center"><span class="math-block"></span></div>

    <p class="text-gray-300">where  <span class="math">\\mathcal{P} = \\{(i,j)</span>  such that  <span class="math">i</span>  satisfies (1) or (2), and  <span class="math">j</span>  satisfies (3) or (4)}</p>

    <p class="text-gray-300">(1) and (3): we have  <span class="math">\\mu (\\mu -1)</span>  values.</p>

    <p class="text-gray-300">(1) and (4): we have <span class="math">\\mu.\\xi</span> values (<span class="math">i\\neq j</span> since <span class="math">b_{\\alpha+1}\\neq b_{\\alpha+2}</span>). (2) and (3) : we have <span class="math">\\nu\\xi</span> values (because <span class="math">b_{1}\\neq b_{\\alpha+2}</span>). (2) and (4): \\[ \\left\\{\\begin{array}[]{l}b_{i}=b_{1}\\oplus b_{\\alpha+1}\\oplus b_{\\alpha+2}\\ (\\nu\\ \\mbox{values})\\\\ b_{j}=b_{\\alpha+2}\\ (\\xi\\ \\mbox{values})\\end{array}\\right. \\]</p>

    <p class="text-gray-300">We must have <span class="math">i\\neq j</span>. However <span class="math">i=j</span> gives <span class="math">b_{1}=b_{\\alpha+1}</span>.</p>

    <p class="text-gray-300">Case 1. <span class="math">b_{1}=b_{\\alpha+1}</span>. Then for (2) and (4) we have <span class="math">\\nu\\xi</span> possibilities.</p>

    <p class="text-gray-300">Case 2. <span class="math">b_{1}=b_{\\alpha+1}</span>. Then <span class="math">\\xi=\\nu</span> and for (2) and (4) we have <span class="math">\\xi(\\nu-1)</span> possibilities.</p>

    <p class="text-gray-300">Therefore</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">$</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\mathcal{N}</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">=(\\alpha-1)(\\alpha-2)-(\\alpha-2)(2\\mu+\\nu+\\xi)+\\mu(\\mu-1)+\\mu\\xi+\\nu\\xi+\\xi(\\nu-\\epsilon_{1})$</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">as claimed. <span class="math">\\Box</span></p>

    <h2 id="sec-21" class="text-2xl font-bold">7 A simple variant of the schemes with only one permutation</h2>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Instead of <span class="math">G=f_{1}\\oplus f_{2},f_{1},f_{2}\\in_{R}B_{n}</span>, we can study $G^{\\prime}(x)=f(x\\</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">0)\\oplus f(x\\</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">1)<span class="math">, with </span>f\\in_{R}B_{n}<span class="math"> and </span>x\\in I_{n-1}<span class="math">. This variant was already introduced in <em>[2]</em> and it is for this that in <em>[2]</em> p.9 the security in </span>\\frac{m}{2^{n}}+O(n)(\\frac{m}{2^{n}})^{3/2}<span class="math"> is presented. In fact, from a theoretical point of view, this variant </span>G^{\\prime}<span class="math"> is very similar to </span>G<span class="math">, and it is possible to prove that our analysis can be modified to obtain a similar proof of security for </span>G^{\\prime}$.</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <h2 id="sec-22" class="text-2xl font-bold">8 A simple property about the Xor of two permutations and a new conjecture</h2>

    <p class="text-gray-300">I have conjectured this property:</p>

    <p class="text-gray-300"><span class="math">\\forall f\\in F_{n},\\ \\mbox{if}\\ \\bigoplus_{x\\in I_{n}}f(x)=0,\\ \\mbox{then}\\ \\exists(g,h)\\in B_{n}^{2},\\ \\mbox{such that}\\ f=g\\oplus h.</span></p>

    <p class="text-gray-300">Just one day after this paper was put on eprint, J.F. Dillon pointed to us that in fact this was proved by Marshall Hall Jr in 1952 in <em>[5]</em>. We thank him a lot for this information. (This property was proved again independently in 1979 in <em>[15]</em>).</p>

    <p class="text-gray-300">A new conjecture. However I conjecture a stronger property. Conjecture:</p>

    <p class="text-gray-300"><span class="math">\\forall f\\in F_{n},\\ \\mbox{if}\\ \\bigoplus_{x\\in I_{n}}f(x)=0,\\ \\mbox{then the number}\\ H\\ \\mbox{of}\\ (g,h)\\in B_{n}^{2},</span></p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">$\\mbox{such that}\\ f=g\\oplus h\\ \\mbox{satisfies}\\ H\\geq\\frac{</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">B_{n}</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">^{2}}{2^{n2^{n}}}.$</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">Variant: I also conjecture that this property is true in any group, not only with Xor.</p>

    <p class="text-gray-300">Remark: in this paper, I have proved weaker results involving <span class="math">m</span> equations with <span class="math">m\\ll O(2^{n})</span> instead of all the <span class="math">2^{n}</span> equations. These weaker results were sufficient for the cryptographic security wanted.</p>

    <p class="text-gray-300">##</p>

    <p class="text-gray-300">9 Conclusion</p>

    <p class="text-gray-300">The results in this paper improve our understanding of the PRF-security of the Xor of two random permutations. More precisely in this paper we have proved that the Adaptive Chosen Plaintext security for this problem is in <span class="math">O(2^{n})</span>, and we have obtained an explicit <span class="math">O</span> function. These results belong to the field of finding security proofs for cryptographic designs above the “birthday bound”. (In <em>[1, 8, 10]</em>, some results “above the birthday bound” on completely different cryptographic designs are also given). Since building PRF from PRP has many practical applications,we believe that these results are of real interest both from a theoretical point of view and a practical point of view. Our proofs need a few pages, so are a bit hard to read, but the results obtained are very easy to use and the mathematics used are elementary (essentially combinatorial and induction arguments). Moreover, we have proved (in Section 5) that this cryptographic problem of security is directly related to a very simple to describe and purely combinatorial problem. We have obtained this transformation by using the “<span class="math">H_{\\sigma}</span> technique”, i.e. combining the “coefficient H technique” of <em>[10, 2]</em> and a specific computation of the standard deviation of <span class="math">H</span>. (In a way, from a cryptographic point of view, this is maybe the most important result, and all the analysis after Section 5 can be seen as combinatorial mathematics and not cryptography anymore). It is also interesting to notice that in our proof with have proceeded with “necessary and sufficient” conditions, i.e. that the <span class="math">H_{\\sigma}</span> property that we proved is exactly equivalent to the cryptographic property that we wanted. Moreover, as we have seen, less strong results of security are quickly obtained.</p>

    <h2 id="sec-23" class="text-2xl font-bold">References</h2>

    <ul class="list-disc list-inside space-y-1 text-gray-300 my-2 ml-4">

      <li>[1] William Aiello and Ramarathnam Venkatesan. Foiling Birthday Attacks in Length-Doubling Transformations - Benes: A Non-Reversible Alternative to Feistel. In Ueli M. Maurer, editor, Advances in Cryptology – EUROCRYPT ’96, volume 1070 of Lecture Notes in Computer Science, pages 307–320. Springer-Verlag, 1996.</li>

      <li>[2] Mihir Bellare and Russell Impagliazzo. A Tool for Obtaining Tighter Security Analyses of Pseudorandom Function Based Constructions, with Applications to PRP to PRF Conversion. ePrint Archive 1999/024: Listing for 1999.</li>

      <li>[3] Mihir Bellare, Ted Krovetz, and Phillip Rogaway. Luby-Rackoff Backwards: Increasing Security by Making Block Ciphers Non-invertible. In Kaisa Nyberg, editor, Advances in cryptology – EUROCRYPT 1998, volume 1403 of Lecture Notes in Computer Science, pages 266–280. Springer-Verlag, 1998.</li>

      <li>[4] Chris Hall, David Wagner, John Kelsey, and Bruce Schneier. Building PRFs from PRPs. In Hugo Krawczyk, editor, Advances in Cryptology – CRYPTO 1998, volume 1462 of Lecture Notes in Computer Science, pages 370–389. Springer-Verlag, 1998.</li>

      <li>[5] Marshall Hall Jr. A Combinatorial Problem on Abelian Groups. Proceedings of the Americal Mathematical Society, 3(4):584–587, 1952.</li>

      <li>[6] Stefan Lucks. The Sum of PRPs Is a Secure PRF. In Bart Preneel, editor, Advances in Cryptology – EUROCRYPT 2000, volume 1807 of Lecture Notes in Computer Science, pages 470–487. Springer-Verlag, 2000.</li>

    </ul>

    <p class="text-gray-300">-</p>

    <p class="text-gray-300">[7] Avradip Mandal, Jacques Patarin, and Valérie Nachef. Indifferentiability beyond the Birthday Bound for the Xor of Two Public Random Permutations. In Guang Gong and Kishan Chand Gupta, editors, Progress in Cryptology – INDOCRYPT 2010, volume 6948 of Lecture Notes in Computer Science, pages 69–81. Springer-Verlag, 2010.</p>

    <ul class="list-disc list-inside space-y-1 text-gray-300 my-2 ml-4">

      <li>[8] Ueli Maurer and Krzysztof Pietrzak. The Security of Many-Round Luby-Rackoff Pseudo-Random Permutations. In Eli Biham, editor, Advances in Cryptology – EUROCRYPT 2003, volume 2656 of Lecture Notes in Computer Science, pages 544–561. Springer-Verlag, 2003.</li>

      <li>[9] Jacques Patarin. Introduction to Mirror Theory: Analysis of Systems of Linear Equalities and Linear Non Equalitites for Cryptography. Cryptology ePrint archive: 2010/287: Listing for 2010.</li>

      <li>[10] Jacques Patarin. Luby-Rackoff: 7 Rounds are Enough for <span class="math">2^{n(1-\\epsilon)}</span> Security. In Dan Boneh, editor, Advances in Cryptology – CRYPTO 2003, volume 2729 of Lecture Notes in Computer Science, pages 513–529. Springer-Verlag, 2003.</li>

      <li>[11] Jacques Patarin. On linear systems of equations with distinct variables and Small block size. In Dongho Wan and Seungjoo Kim, editors, ICISC 2005, volume 3935 of Lecture Notes in Computer Science, pages 299–321. Springer-Verlag, 2006.</li>

      <li>[12] Jacques Patarin. The coefficients <span class="math">H</span> technique. In Roberto Avanzi, Liam Keliher, and Francesco Sica, editors, SAC 2008, volume 5381 of Lecture Notes in Computer Science, pages 328–345. Springer-Verlag, 2008.</li>

      <li>[13] Jacques Patarin. A Proof of Security in <span class="math">O(2^{n})</span> for the Xor of Two Random Permutations . In Reihaneh Safavi-Naini, editor, ICITS 2008, volume 5155 of Lecture Notes in Computer Science, pages 232–248. Springer-Verlag, 2008. An extended version is also on eprint.</li>

      <li>[14] Jacques Patarin. Generic Attacks for the Xor of <span class="math">k</span> Random Permutations. In Michael J. Jacobson Jr., Michael E. Locasto, Payman Mohassel, and Reihaneh Safavi-Naini, editors, ACNS 2013, volume 7954 of Lecture Notes in Computer Science, pages 154–169. Springer-Verlag, 2013.</li>

      <li>[15] F. Salzborn and G. Szekeres. A Problem in Combinatorial Group Theory. Ars Combinatoria, 7:3–5, 1979.</li>

      <li>[16] Emmanuel Volte, Jacques Patarin, and Valérie Nachef. Mirror Theory: Theorems and Conjectures. Applicaitons to Cryptography. Available from the authors.</li>

    </ul>

    <h2 id="sec-24" class="text-2xl font-bold">Appendix A Examples of <span class="math">h_{m}</span> with <span class="math">m=1,2</span> or <span class="math">3</span></h2>

    <p class="text-gray-300">As examples, we present here the exact values for <span class="math">h_{m}</span> and <span class="math">h_{m}^{\\prime}</span> when <span class="math">m=1,2</span> or <span class="math">3</span>. The values that we will obtain are summarized in Table 1.</p>

    <p class="text-gray-300"><span class="math">(*)</span> <span class="math">h_{3}^{\\prime}</span> denotes the condition <span class="math">h_{3}</span> plus <span class="math">X:P_{1}\\oplus Q_{3}=b_{4}</span> with <span class="math">b_{1}\\neq b_{4}</span> and <span class="math">b_{3}\\neq b_{4}</span>. <span class="math">\\mathcal{E}</span> denotes these 4 equalities: <span class="math">b_{2}=b_{3},\\;b_{2}=b_{1}\\oplus b_{3}\\oplus b_{4},\\;b_{2}=b_{4}</span> and <span class="math">b_{1}=b_{2}</span>.</p>

    <p class="text-gray-300">Table 1: Summary of the results on  <span class="math">{h}_{m}</span>  for  <span class="math">m = 1,2,3</span></p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">h1=2n</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">·If b1≠b2:h2=2n(2n-2)·If b1=b2:h2=2n(2n-1)</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">·If b1,b2,b3are pairwise distinct :h3=2n(22n-6.2n+10)·If b1=b2≠b3:h3=2n(22n-5.2n+6)·If b1=b2=b3:h3=2n(22n-3.2n+2)</th>

          </tr>

        </thead>

        <tbody>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">Adv1=0</td>

            <td class="px-3 py-2 border-b border-gray-700">h′2=2n</td>

            <td class="px-3 py-2 border-b border-gray-700">·If we have no equality in E (*):h′3=2n(2n-4)·If we have 1 equality in E:h′3=2n(2n-3)·If we have 2 equalities in E:h′3=2n(2n-2)</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">Adv2=1/2n(2n-1)Adv2≈1/22n</td>

            <td class="px-3 py-2 border-b border-gray-700">h″3=2n</td>

          </tr>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">|   |  | If n≥3, Adv3=1/22n(3.22n-12.2n+4/(2n-1)(2n-2))Adv3≈3/22n  |</p>

    <p class="text-gray-300">From  <span class="math">h_m</span>  we get the exact value for  <span class="math">Adv_m</span>  by using Theorem 5 (and Theorem 4 to get the value of  <span class="math">\\tilde{h}_m</span> ).</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">By definition,  <span class="math">h_1</span>  is the number of  <span class="math">P_1, Q_1 \\in I_n</span>  such that  <span class="math">P_1 \\oplus Q_1 = b_1</span> . Therefore,  <span class="math">h_1 = 2^n</span> . Now from  $Adv_1 = \\frac{1}{2^{2n}} \\sum_{b_1 \\in I_n}</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">h_1 - \\tilde{h_1}</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"><span class="math">  and  </span>\\tilde{h_1} = 2^n<span class="math"> , we get:  </span>Adv_1 = 0$ .</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">By definition,  <span class="math">h_2</span>  is the number of  <span class="math">P_1, P_2, Q_1, Q_2 \\in I_n</span>  such that:  <span class="math">P_1 \\neq P_2</span> ,  <span class="math">Q_1 \\neq Q_2</span> ,  <span class="math">P_1 \\oplus Q_1 = b_1</span>  and  <span class="math">P_2 \\oplus Q_2 = b_2</span> . We have  <span class="math">Q_1 \\neq Q_2 \\Leftrightarrow P_1 \\oplus P_2 \\neq b_1 \\oplus b_2</span> .</p>

    <p class="text-gray-300">Case 1.  <span class="math">b_{1} \\neq b_{2}</span> . Then  <span class="math">h_{2} = 2^{n}(2^{n} - 2)</span>  (because for  <span class="math">P_{1}</span>  we have  <span class="math">2^{n}</span>  possibilities, and then for  <span class="math">P_{2}</span> , we have  <span class="math">2^{n} - 2</span>  possibilities).</p>

    <p class="text-gray-300">Case 2.  <span class="math">b_{1} = b_{2}</span> . Then  <span class="math">h_{2} = 2^{n}(2^{n} - 1)</span>  (because for  <span class="math">P_{1}</span>  we have  <span class="math">2^{n}</span>  possibilities, and then for  <span class="math">P_{2}</span> , we have  <span class="math">2^{n} - 1</span>  possibilities).</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Now from  $Adv_{2} = \\frac{1}{2.[2^{n}(2^{n} - 1)]^{2}}\\sum_{b_{1},b_{2}\\in I_{n}}</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">h_{2} - \\tilde{h_{2}}</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"><span class="math">  and  </span>\\tilde{h_2} = \\frac{[2^n(2^n - 1)]^2}{2^{2n}} = (2^n -1)^2<span class="math"> , we get:  </span>Adv_{2} = \\frac{1}{2^{n}(2^{n} - 1)}\\simeq \\frac{1}{2^{2n}}$ .</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Les  <span class="math">\\sigma</span>  be the standard deviation of  <span class="math">h_2</span>  when  <span class="math">b_{1}, b_{2} \\in_{R} I_{n}</span> .  <span class="math">\\sigma = \\sqrt{V(h_2)} = \\sqrt{E(h_2 - \\tilde{h_2})^2}</span> . Let  <span class="math">\\sigma&#x27;</span>  be the average deviation of  <span class="math">h_2</span>  when  <span class="math">b_{1}, b_{2} \\in_{R} I_{n}</span> .  $\\sigma' = E(</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">h_2 - \\tilde{h_2}</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">)$ .</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <div class="my-4 text-center"><span class="math-block">V (h _ {2}) = \\frac {1}{2 ^ {2 n}} [ 2 ^ {n} (2 ^ {n} - 1) ^ {2} + 2 ^ {n} (2 ^ {n} - 1) ] = 2 ^ {n} - 1</span></div>

    <p class="text-gray-300">Therefore <span class="math">\\sigma=\\sqrt{2^{n}-1}\\simeq\\frac{\\tilde{h_{2}}}{2^{1.5n}}</span>.</p>

    <p class="text-gray-300"><span class="math">\\sigma^{\\prime}=\\frac{1}{2^{2n}}[2^{n}(2^{n}-1)+2^{n}(2^{n}-1).1]</span></p>

    <p class="text-gray-300">Therefore <span class="math">\\sigma^{\\prime}=\\frac{2(2^{n}-1)}{2^{n}}\\simeq\\frac{2\\tilde{h_{2}}}{2^{2n}}</span>. We see that here <span class="math">\\sigma^{\\prime}\\simeq\\frac{2\\sigma}{\\sqrt{2^{n}}}</span>.</p>

    <p class="text-gray-300">So <span class="math">\\sigma</span> is much larger than <span class="math">\\sigma^{\\prime}</span> when <span class="math">n</span> is large. This is one of the reasons that explains that when <span class="math">m</span> is fixed and small the approximation of <span class="math">Adv</span> obtained by Bienaymé-Tchebichev from <span class="math">\\sigma</span> (used in <em>[13]</em>) gives when <span class="math">m</span> is fixed and small only <span class="math">Adv\\leq O(\\frac{1}{2^{n}})</span> while the real Advantage is in <span class="math">O(\\frac{1}{2^{2n}})</span>.</p>

    <h3 id="sec-28" class="text-xl font-semibold mt-8">A.3 <span class="math">m=3</span></h3>

    <p class="text-gray-300">In section 4 we have sen that (orange equation):</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">$h_{\\alpha+1}=(2^{n}-2\\alpha+</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">M</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">)h_{\\alpha}+\\sum_{i\\notin M}\\sum_{j\\notin M,j\\neq i}h^{\\prime}_{\\alpha}(i,j)$</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">with <span class="math">M=\\{i,\\,1\\leq i\\leq\\alpha,\\;b_{i}=b_{\\alpha+1}\\}</span>.</p>

    <p class="text-gray-300">With <span class="math">\\alpha=2</span>, this formula will give us <span class="math">h_{3}</span> from <span class="math">h_{2}</span> and <span class="math">h^{\\prime}_{2}</span>.</p>

    <p class="text-gray-300"><span class="math">M=\\{i,\\,1\\leq i\\leq 2,\\;b_{i}=b_{3}\\}</span>.</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Case 1. <span class="math">b_{1},b_{2},b_{3}</span> are pairwise distinct. Then $</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">M</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">=0<span class="math"> and </span>h_{3}=(2^{n}-4)h_{2}+2h^{\\prime}_{2}<span class="math">. </span>h_{3}=(2^{n}-4).2^{n}.(2^{n}-2)+2.2^{n}$.</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300"><span class="math">h_{3}=2^{n}(2^{2n}-6.2^{n}+10)</span> and since <span class="math">\\tilde{h_{3}}=\\frac{[2^{n}(2^{n}-1)(2^{n}-2)]^{2}}{2^{3n}}=2^{3n}-6.2^{2n}+13.2^{n}-12+\\frac{4}{2^{n}}</span>, we have <span class="math">h_{3}-\\tilde{h_{3}}=-3.2^{n}+12-\\frac{4}{2^{n}}</span>. Therefore, when <span class="math">n\\geq 2</span>, we have <span class="math">h_{3}&lt;\\tilde{h_{3}}</span> in this case 1 (and without loss of generality, we can assume <span class="math">n\\geq 2</span> since for <span class="math">n=1</span> we have only two values in <span class="math">I_{n}</span> but here the number <span class="math">m</span> of queries is <span class="math">m=3</span>).</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Case 2. We have <span class="math">b_{1}=b_{3}\\neq b_{2}</span>. Then $</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">M</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">=1<span class="math">, </span>h_{3}=(2^{n}-3)h_{2}<span class="math">, </span>h_{3}=(2^{n}-3).2^{n}(2^{n}-2)<span class="math">, </span>h_{3}=2^{n}(2^{2n}-5.2^{n}+6)<span class="math">. Here </span>h_{3}-\\tilde{h_{3}}=2^{2n}-7.2^{n}+12-\\frac{4}{2^{n}}=(2^{n}-2)(2^{n}-5+\\frac{2}{2^{n}})<span class="math">. Therefore, when </span>n\\geq 3<span class="math">, we have </span>h_{3}>\\tilde{h_{3}}<span class="math">, and when </span>n=3<span class="math">, we have </span>h_{3}<\\tilde{h_{3}}$.</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">Case 2 bis. We can check that when <span class="math">b_{1}=b_{2}\\neq b_{3}</span> we obtain the same value (this is obvious by symmetry of the hypothesis but not obvious from the orange equation).</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Here $</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">M</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">=0<span class="math"> and </span>h_{3}=(2^{n}-4)h_{2}+2h^{\\prime}_{2}$.</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300"><span class="math">h_{3}=(2^{n}-4).2\\cdot(2^{n}-1)+2.2^{n}</span></p>

    <p class="text-gray-300"><span class="math">h_{3}=2^{n}(2^{2n}-5.2^{n}+6)</span> as in Case 2.</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Case 3. <span class="math">b_{1}=b_{2}=b_{3}</span>. Here $</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">M</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">=2<span class="math"> and </span>h_{3}=(2^{n}-2)h_{2}=(2^{n}-2)2^{n}(2^{n}-1)<span class="math"> So </span>h_{3}=2^{n}(2^{2n}-3.2^{n}+2)<span class="math"> and </span>h_{3}-\\tilde{h_{3}}=3.2^{2n}-11.2^{n}+12-\\frac{4}{2^{n}}<span class="math"> and it is easy to see that this is always </span>\\geq 0<span class="math"> if </span>n\\geq 0$. (We can also say that we have</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300"><span class="math">h_{3}\\geq\\tilde{h_{3}}</span> <span class="math">\\Leftrightarrow</span> <span class="math">2^{n}(2^{n}-1)(2^{n}-2)\\geq\\frac{[2^{n}(2^{n}-1)(2^{n}-2)]^{2}}{2^{3n}}</span> <span class="math">\\Leftrightarrow</span> <span class="math">2^{2n}\\geq(2^{n}-1)(2^{n}-2)</span></p>

    <p class="text-gray-300">since <span class="math">n\\geq 2</span> since we have <span class="math">m=3</span> queries). Therefore <span class="math">h_{3}</span> is always <span class="math">\\geq\\tilde{h_{3}}</span> in Case 3.</p>

    <p class="text-gray-300">Finally, from</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">$Adv_{3}=\\frac{1}{2.[2^{n}(2^{n}-1)(2^{n}-2)]^{2}}\\sum_{b_{1},b_{2},b_{3}\\in I_{n}}</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">h_{3}-\\tilde{h_{3}}</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">$</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">or from</p>

    <p class="text-gray-300"><span class="math">Adv_{3}=\\frac{1}{[2^{n}(2^{n}-1)(2^{n}-2)]^{2}}\\sum_{b_{1},b_{2},b_{3}/h_{3}&lt;\\tilde{h}_{3}}(\\tilde{h}_{3}-h_{3})</span></p>

    <p class="text-gray-300">we obtain, if <span class="math">n\\geq 3</span></p>

    <p class="text-gray-300"><span class="math">Adv_{3}=\\frac{1}{[2^{n}(2^{n}-1)(2^{n}-2)]^{2}}2^{n}(2^{n}-1)(2^{n}-2)(3.2^{n}-12+\\frac{4}{2^{n}})</span> <span class="math">Adv_{3}=\\frac{1}{2^{2n}(2^{n}-1)(2^{n}-2)}(3.2^{2n}-12.2^{n}+4)\\simeq\\frac{3}{2^{2n}}</span></p>

    <p class="text-gray-300">We did not need the value <span class="math">h_{3}^{\\prime}</span> to compute <span class="math">h_{3}</span>. However these values are directly given from section 6: “first purple equations”. With <span class="math">\\alpha=2</span>, <span class="math">h_{2}^{\\prime\\prime}=0</span>, <span class="math">X:P_{1}\\oplus Q_{3}=b_{4}</span>, <span class="math">b_{4}\\neq b_{1}</span>, <span class="math">b_{4}\\neq b_{3}</span>, we get : <span class="math">h_{3}^{\\prime}=h_{2}+(-2+\\mu+\\xi+\\nu).2^{n}</span>, with <span class="math">\\mu=1</span> if <span class="math">b_{3}=b_{2}</span>, <span class="math">\\xi=1</span> if <span class="math">b_{4}=b_{2}</span> and <span class="math">\\nu=1</span> if <span class="math">b_{1}\\oplus b_{2}\\oplus b_{3}\\oplus b_{4}=0</span>.</p>

    <p class="text-gray-300">The stabilization formulas We can check these values with the “Stabilization formulas” (i.e. Theorem 9 and Theorem 10).</p>

    <p class="text-gray-300">The stabilization formula for <span class="math">h_{3}</span> is:</p>

    <p class="text-gray-300"><span class="math">\\sum_{b_{3}\\in I_{n}}h_{3}=(2^{n}-2)^{2}h_{2}</span></p>

    <p class="text-gray-300"><span class="math">\\bullet</span> If <span class="math">b_{1}\\neq b_{2}</span>, this gives: <span class="math">(2^{n}-2).2^{n}(2^{2n}-6.2^{n}+10)+2.2^{n}(2^{2n}-5.2^{n}+6)=(2^{n}-2)^{2}.2^{n}(2^{n}-2)</span>. <span class="math">\\bullet</span> If <span class="math">b_{1}=b_{2}</span>, this gives: <span class="math">(2^{n}-1).2^{n}(2^{2n}-5.2^{n}+6)+(2^{2n}-3.2^{n}+2)=(2^{n}-2)^{2}.2^{n}(2^{n}-1)</span>.</p>

    <p class="text-gray-300">The stabilization formula for <span class="math">h_{3}^{\\prime}</span> is:</p>

    <p class="text-gray-300"><span class="math">\\sum_{b_{4}\\notin\\{b_{1},b_{3}\\}}h_{3}^{\\prime}=h_{3}\\quad(\\text{since </span>X<span class="math"> is </span>P_{1}\\oplus Q_{3}=b_{4}<span class="math">})</span></p>

    <p class="text-gray-300">There are 4 special values for <span class="math">b_{4}</span>: <span class="math">b_{1},b_{2},b_{3}</span> and <span class="math">b_{1}\\oplus b_{2}\\oplus b_{3}</span> (<span class="math">h_{3}^{\\prime}=0</span> if <span class="math">b_{4}=b_{1}</span> or <span class="math">b_{4}=b_{3}</span>). <span class="math">\\bullet</span> If <span class="math">b_{1},b_{2},b_{3}</span> are pairwise distinct, this gives: <span class="math">(2^{n}-4).2^{n}(2^{n}-4)+2.2^{n}(2^{n}-3)=2^{n}(2^{2n}-6.2^{n}+10)</span>. <span class="math">\\bullet</span> If <span class="math">b_{1}=b_{2}\\neq b_{3}</span>, this gives: <span class="math">(2^{n}-2).2^{n}(2^{n}-3)=2^{n}(2^{2n}-5.2^{n}+6)</span>. <span class="math">\\bullet</span> If <span class="math">b_{1}=b_{2}=b_{3}</span>, this gives: <span class="math">(2^{n}-1).2^{n}(2^{n}-2)=2^{n}(2^{2n}-3.2^{n}+2)</span>.</p>

    <h2 id="sec-29" class="text-2xl font-bold">Appendix B Example of unusual values for <span class="math">h_{m}</span></h2>

    <p class="text-gray-300"><span class="math">h_{m}</span>; or more precisely, <span class="math">h_{m}(b)</span>,is the number of <span class="math">(P_{1},P_{2},\\ldots,P_{m},Q_{1},\\ldots,Q_{m})\\in I_{n}^{2m}</span> such that</p>

    <ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">

      <li>The <span class="math">P_{i}</span> are pairwise distinct.</li>

      <li>The <span class="math">Q_{i}</span> are pairwise distinct.</li>

      <li><span class="math">\\forall i,\\;1\\leq i\\leq m,\\;P_{i}\\oplus Q_{i}=b_{i}</span>.</li>

    </ol>

    <p class="text-gray-300">The average value of  <span class="math">h_m</span> , when  <span class="math">(b_1, \\ldots, b_m) \\in I_n^m</span>  is:</p>

    <div class="my-4 text-center"><span class="math-block">\\tilde {h _ {m}} = \\frac {(2 ^ {n} (2 ^ {n} - 1) \\ldots (2 ^ {n} - m + 1)) ^ {2}}{2 ^ {n m}} \\quad (\\mathrm {c f T h e o r e m 4})</span></div>

    <p class="text-gray-300">Theorem 14 When  <span class="math">b_{i}</span>  is a constant, i.e.  <span class="math">\\forall i, 1 \\leq i \\leq m</span> ,  <span class="math">b_{i} = b_{1}</span> , we have:</p>

    <div class="my-4 text-center"><span class="math-block">h _ {m} = 2 ^ {n} (2 ^ {n} - 1) \\dots (2 ^ {n} - m + 1)</span></div>

    <p class="text-gray-300">Proof. We have to choose the  <span class="math">P_{i}</span>  pairwise distinct, and then the values  <span class="math">Q_{i}</span>  are fixed and pairwise distinct by:  <span class="math">\\forall i, 1 \\leq i \\leq m, Q_{i} = b_{1} \\oplus P_{i}</span> .</p>

    <p class="text-gray-300">This value  <span class="math">2^{n}(2^{n} - 1) \\ldots (2^{n} - m + 1)</span>  is the maximum possible value for  <span class="math">h_m</span> , since when  <span class="math">P_1, \\ldots, P_m</span>  are fixed, there is at most one possibility for  <span class="math">Q_1, \\ldots, Q_m</span> .</p>

    <p class="text-gray-300">Remark. It is conjectured that the minimum value for  <span class="math">h_m</span>  is obtained when the values  <span class="math">b_1, \\ldots, b_m</span>  are pairwise distinct. When  <span class="math">m</span>  is small (for example  <span class="math">m \\leq \\sqrt{2^n}</span> ), this is proven, but when  <span class="math">m = 2^n</span>  for example, no proof of this conjecture is known.</p>

    <p class="text-gray-300">From the results above, when  <span class="math">b_{i}</span>  is a constant, we have:</p>

    <div class="my-4 text-center"><span class="math-block">h _ {m} / \\tilde {h _ {m}} = \\frac {2 ^ {n m}}{2 ^ {n} (2 ^ {n} - 1) \\ldots (2 ^ {n} - m + 1)} = \\frac {1}{(1 - \\frac {1}{2 ^ {n}}) (1 - \\frac {2}{2 ^ {n}}) \\ldots (1 - \\frac {m - 1}{2 ^ {n}})}</span></div>

    <p class="text-gray-300">It is easy to see that this expression can tend to infinity when  <span class="math">m</span>  is large and  <span class="math">\\sqrt{2^n} \\ll m \\leq 2^n</span>  (by taking the log of  <span class="math">h_m / \\tilde{h_m}</span>  for example). Therefore, we see that  <span class="math">h_m / \\tilde{h_m}</span>  is not bounded in general. Unlike this result,  <span class="math">h_m</span>  is generally  <span class="math">\\geq \\tilde{h_m}(1 - \\epsilon)</span>  where  <span class="math">\\epsilon</span>  is small (see the results of this paper, when  <span class="math">m \\ll 2^{\\frac{2n}{3}}</span>  for example).</p>

    <p class="text-gray-300">!<a href="img-3.jpeg">img-3.jpeg</a> Figure 4: The different values  <span class="math">h_m</span></p>

    <p class="text-gray-300">Figure 4 illustrate these results. (This figure is a classical figure in "Mirror Theory", i.e. it appears often when we deal with sets of linear equalities and linear non equalities).</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">It is also interesting to notice that very large values  <span class="math">h_m</span>  exist, but do not occur often, and that very large values  <span class="math">h_m</span>  will affect more the standard deviation  <span class="math">\\sigma(h_m)</span>  of  <span class="math">h_m</span>  than the average deviation  <span class="math">\\sigma&#x27;(h_m)</span>  of  <span class="math">h_m</span> .  <span class="math">(\\sigma(h_m) = \\sqrt{E(h - h_m)^2}</span>  and  $\\sigma'(h_m) = E(</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">h - h_m</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">))$ .</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">C Summary of our notation and of our General Proof Strategy</p>

    <p class="text-gray-300">In this Appendix C we will summarize the proof strategy and the main notations used in this paper.</p>

    <ul class="list-disc list-inside space-y-1 text-gray-300 my-2 ml-4">

      <li><span class="math">m</span> and <span class="math">n</span> are two integers. <span class="math">I_{n}=\\{0,1\\}^{n}</span>. (From a cryptographic point of view, <span class="math">m</span> will be the number of queries, and <span class="math">n</span> is the number of bits of the inputs and outputs of each query).</li>

      <li><span class="math">H_{m}</span> (cf section 3) denotes the number of <span class="math">(f,g)\\in B_{n}^{2}</span> such that <span class="math">\\forall i,\\ 1\\leq i\\leq m,\\ (f\\oplus g)(a_{i})=b_{i}</span>. <span class="math">H_{m}</span> is a compact notation for <span class="math">H_{m}(b_{1},b_{2},\\ldots,b_{m})</span>.</li>

    </ul>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">- <span class="math">h_{m}</span> (cf section 3) denotes the number of <span class="math">(P_{1},P_{2},\\ldots,P_{m},Q_{1},Q_{2},\\ldots,Q_{m})\\in I_{n}^{2m}</span> such that: the <span class="math">P_{i}</span> are pairwise distinct, the <span class="math">Q_{i}</span> are pairwise distinct, and: <span class="math">\\forall i,\\ 1\\leq i\\leq m,\\ P_{i}\\oplus Q_{i}=b_{i}</span>. <span class="math">h_{m}</span> is a compact notation for <span class="math">h_{m}(b_{1},b_{2},\\ldots,b_{m})</span>. (<span class="math">H_{m}</span> and <span class="math">h_{m}</span> are equal up to a multiplicative constant: $H_{m}=h_{m}.\\frac{</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">B_{n}</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">^{2}}{(2^{n}(2^{n}-1)...(2^{n}-m+1))^{2}}$, cf Theorem 2 of section 3).</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <ul class="list-disc list-inside space-y-1 text-gray-300 my-2 ml-4">

      <li><span class="math">\\tilde{h}_{m}</span> denotes <span class="math">\\frac{(2^{n}(2^{n}-1)...(2^{n}-m+1))^{2}}{2^{nm}}</span>. <span class="math">\\tilde{h}_{m}</span> is the average value of <span class="math">h_{m}</span> when <span class="math">b\\in_{R}I_{n}^{m}</span>.</li>

    </ul>

    <p class="text-gray-300">Our aim is to prove that: when <span class="math">m\\ll 2^{n}</span> then for most values <span class="math">b</span>, <span class="math">h_{m}\\stackrel{{\\scriptstyle&gt;}}{{\\sim}}\\tilde{h}_{m}</span> (<span class="math">C1</span>)(where <span class="math">a\\stackrel{{\\scriptstyle&gt;}}{{\\sim}}b</span> means <span class="math">a\\geq b</span> or <span class="math">a\\simeq b</span>), because then, from Theorem 6 (standard “<span class="math">H</span> technique theorem”) we will get CPA-2 security. In fact we will often prove a stronger property: that: when <span class="math">m\\ll 2^{n}</span> then for all values <span class="math">b</span>, <span class="math">h_{m}\\stackrel{{\\scriptstyle&gt;}}{{\\sim}}\\tilde{h}_{m}</span> (<span class="math">C2</span>). In order to prove (<span class="math">C1</span>) or (<span class="math">C2</span>), we proceed in this paper with what we call the “usual proof strategy in Mirror Theory” or the “colored proof strategy”. (“Mirror Theory” is the theory that analyses the number of solutions of sets of affine equalities (=) and affine non equalities (<span class="math">\\neq</span>) in finite fields). Essentially the two main ideas of this “colored proof strategy” are:</p>

    <ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">

      <li>To compare <span class="math">\\frac{h_{\\alpha+1}}{h_{\\alpha}}</span> with <span class="math">\\frac{\\tilde{h}_{\\alpha+1}}{h_{\\alpha}}</span> and to use</li>

    </ol>

    <p class="text-gray-300"><span class="math">h_{\\alpha}=\\frac{h_{\\alpha}}{h_{\\alpha-1}}.\\frac{h_{\\alpha-1}}{h_{\\alpha-2}}.\\frac{h_{\\alpha-2}}{h_{\\alpha-3}}\\ldots\\frac{h_{2}}{h_{1}}h_{1}</span></p>

    <p class="text-gray-300">instead of studying <span class="math">h_{\\alpha}</span> globally.</p>

    <ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">

      <li>To look carefully if the affine equations that will appear in the analysis of <span class="math">\\frac{h_{\\alpha+1}}{h_{\\alpha}}</span> are independent, consequences, or in contradiction with the linear equalities in <span class="math">h_{\\alpha}</span>.</li>

    </ol>

    <p class="text-gray-300">More precisely, here, with <span class="math">h_{\\alpha}</span> values, this “colored proof strategy” is this one:</p>

    <ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">

      <li>We get an equation (called the “orange equation”) that evaluates <span class="math">h_{\\alpha+1}</span> from <span class="math">h_{\\alpha}</span> and <span class="math">h^{\\prime}_{\\alpha}</span> where <span class="math">h^{\\prime}_{\\alpha}(X)</span> denotes the number of solutions that satisfy the conditions <span class="math">h_{\\alpha}</span> plus one equation <span class="math">X</span>: <span class="math">Q_{\\alpha+1}\\oplus P_{1}=b_{\\alpha+1}</span>, when this equation <span class="math">X</span> is linearly independent with the non equalities of <span class="math">h_{\\alpha}</span>. <span class="math">h^{\\prime}_{\\alpha}</span> denotes any such value <span class="math">h^{\\prime}_{\\alpha}(X)</span>. This was done in section 4 of this paper.</li>

      <li>We get an equation (called the “first purple equation”) that evaluates <span class="math">h^{\\prime}_{\\alpha}</span> from <span class="math">h_{\\alpha-1}</span>, <span class="math">h^{\\prime}_{\\alpha-1}</span> and <span class="math">h^{\\prime\\prime}_{\\alpha-1}</span> (where in <span class="math">h^{\\prime\\prime}_{\\alpha-1}</span> we have introduced two extra and independent affine equations from the <span class="math">\\lambda_{\\alpha-1}</span> conditions). This was done in section 6 of this paper.</li>

      <li>We get the equations (called “all purple equations”) that evaluate <span class="math">h^{(d)}_{\\alpha}</span> from <span class="math">h^{(d-1)}_{\\alpha-1}</span>, <span class="math">h^{(d)}_{\\alpha-1}</span>, and <span class="math">h^{(d+1)}_{\\alpha-1}</span>, (where in <span class="math">h^{(d)}_{\\alpha-1}</span>, we have introduced <span class="math">d</span> extra and independent affine equations from the <span class="math">h_{\\alpha-1}</span> equations).</li>

    </ol>

    <p class="text-gray-300">!<a href="img-4.jpeg">img-4.jpeg</a> Figure 5: General view of the "colored proof strategy" used in this paper</p>

    <ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">

      <li>Now, from these evaluations we are able to compare  <span class="math">\\frac{h_{\\alpha + 1}}{h_{\\alpha}}</span>  with  <span class="math">\\frac{\\tilde{h}_{\\alpha + 1}}{h_{\\alpha}}</span>  and therefore  <span class="math">h_\\alpha</span>  from  <span class="math">\\tilde{h}_{\\alpha}</span> .</li>

    </ol>

    <p class="text-gray-300">In [5] in 1952 (and independently in [15] in 1979) it was proved that:</p>

    <div class="my-4 text-center"><span class="math-block">\\forall f \\in F _ {n}, \\text { if } \\oplus_ {x \\in I _ {n}} f (x) = 0, \\text { then } \\exists (g, h) \\in B _ {n} ^ {2} \\text { such that } f = g \\oplus h</span></div>

    <p class="text-gray-300">([5] was pointed to me by J.F. Dillon).</p>

    <p class="text-gray-300">Since 2008, I conjectured a stronger property.</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Conjecture:  <span class="math">\\forall f\\in F_n</span>  , if  <span class="math">\\oplus_{x\\in I_n}f(x) = 0</span>  , then the number  <span class="math">H</span>  of  <span class="math">(g,h)\\in B_n^2</span>  such that  <span class="math">f = g\\oplus h</span>  satisfies  $H\\geq \\frac{</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">B_n</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">^2}{2^n\\cdot 2^n}$</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">Variant: I also conjectures that this property is true in any group (commutative or not), not only with Xor.</p>

    <p class="text-gray-300">In this paper I have proved results involving  <span class="math">m</span>  equations with  <span class="math">m \\ll O(2^n)</span>  instead of all the  <span class="math">2^n</span>  equations. These results were sufficient for the cryptographic security wanted (cf Figure 6).</p>

    <p class="text-gray-300">!<a href="img-5.jpeg">img-5.jpeg</a> Figure 6: The different cases for the values  <span class="math">m</span></p>

    <p class="text-gray-300">Zone 1: (i.e. "below the birthday bound"): when  <span class="math">1 \\leq m \\ll \\sqrt{2^n}</span> .</p>

    <p class="text-gray-300">Zone 2: (i.e. the cryptographic zone "above the birthday bound"): when  <span class="math">\\sqrt{2^n} \\leq m \\leq \\frac{2^n}{3}</span> : the properties of this zone are the main subject of this paper.</p>

    <p class="text-gray-300">(1)</p>

    <p class="text-gray-300">Zone 3: <span class="math">\\frac{2^n}{3} \\leq m \\leq 2^n - 1</span>: this zone was not studied carefully in this paper. Our proof technique may also give some results in this zone, but this was not studied.</p>

    <p class="text-gray-300">Zone 4: <span class="math">m = 2^n - 1</span> and <span class="math">m = 2^n</span>: the zone of the new conjecture, and of [5] and [13].</p>

    <h2 id="sec-32" class="text-2xl font-bold">Equivalent Conjectures</h2>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Let $\\tilde{H}_{\\alpha} = \\frac{</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">B_n</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">^2}{2^{n\\alpha}}<span class="math"> be the average value of </span>H_{\\alpha}$.</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300"><strong>Theorem 15</strong> The new conjecture given above is equivalent to each of these (not proved properties):</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">1. <span class="math">\\forall f\\in F_n</span>, if <span class="math">\\oplus_{x\\in I_n}f(x) = 0</span>, then $H_{2^n}(f)\\geq \\frac{</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">B_n</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">^2}{2^{n.2^n}} (= \\tilde{H}_{2^n})$</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">

      <li><span class="math">\\forall f\\in F_n</span>, <span class="math">\\forall \\alpha</span>, <span class="math">1 \\leq \\alpha \\leq 2^n - 1</span>, <span class="math">H_{\\alpha}(f) \\geq \\frac{\\tilde{H}_{\\alpha}}{2^n}</span></li>

      <li><span class="math">\\forall \\alpha</span>, <span class="math">1 \\leq \\alpha \\leq 2^n - 1</span>, <span class="math">\\forall b_1, \\ldots, b_\\alpha</span>, <span class="math">h_\\alpha(b_1, \\ldots, b_\\alpha) \\geq \\frac{\\tilde{b}_\\alpha}{2^n}</span></li>

    </ol>

    <p class="text-gray-300"><strong>Proof of Theorem 15.</strong></p>

    <ul class="list-disc list-inside space-y-1 text-gray-300 my-2 ml-4">

      <li>(1) is the conjecture given above.</li>

      <li><span class="math">\\tilde{H}_{2^{n}-1} = \\frac{\\tilde{H}_{2^n}}{2^n}</span> and if <span class="math">\\bigoplus_{x \\in I_n} f(x) = 0</span> then the last value of <span class="math">f</span> is fixed when all the other values of <span class="math">f</span> are given, and therefore if <span class="math">\\bigoplus_{x \\in I_n} f(x) = 0</span>, then <span class="math">H_{2^n}(f) = H_{2^{n-1}}(f)</span>. So (1) <span class="math">\\Leftrightarrow</span> (2).</li>

      <li>(3) <span class="math">\\Rightarrow</span> (2) is obvious (just take <span class="math">\\alpha = 2^n - 1</span>).</li>

      <li>Let assume that (2) is true. Then <span class="math">\\forall \\alpha</span>, <span class="math">1 \\leq \\alpha \\leq 2^n - 1</span>, <span class="math">\\forall f \\in F_n</span>,</li>

    </ul>

    <div class="my-4 text-center"><span class="math-block">H _ {\\alpha} (f) = \\sum_ {b _ {\\alpha + 1}, \\dots , b _ {2 ^ {n} - 1}} [ \\text {Number of} (g, h) \\in B _ {n} ^ {2} / g \\oplus h = f ^ {\\prime} ]</span></div>

    <p class="text-gray-300">where <span class="math">\\forall i, 1 \\leq i \\leq \\alpha</span>, <span class="math">f&#x27;(a_i) = f(a_i)</span> and <span class="math">\\forall i, \\alpha + 1 \\leq i \\leq 2^n - 1</span>, <span class="math">f&#x27;(a_i) = b_i</span>.</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">So from (2): $H_{\\alpha} \\geq (2^{n})^{2^{n} - \\alpha - 1} \\frac{\\tilde{H}_{2^{n} - 2}}{2^{n}} = \\frac{2^{n.2^{n}}}{2^{n}.2^{nn}} \\cdot \\frac{</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">B_{n}</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">^{2}}{2^{n.2^{n}}} = \\frac{\\tilde{H}_{\\alpha}}{2^{n}}<span class="math">. Therefore (2) </span>\\Rightarrow$ (3).</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">- Finally since $H_{\\alpha} = h_{\\alpha} \\cdot \\frac{</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">B_n</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">^2}{[2^n(2^n - 1) \\dots (2^n - \\alpha)]^2}<span class="math">, we have: (3) </span>\\Leftrightarrow$ (4)</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300"><strong>Remark 1.</strong> The coefficient <span class="math">2^n</span> in (3) looks a bit artificial, and even stronger properties may be true (as suggested by our simulations done in [16]).</p>

    <p class="text-gray-300"><strong>Remark 2.</strong> If we compare the conjecture above with the results of section 6, we see that:</p>

    <ul class="list-disc list-inside space-y-1 text-gray-300 my-2 ml-4">

      <li>Section 6 is stronger when <span class="math">m \\ll 2^{\\frac{3n}{4}}</span> since it shows that <span class="math">H_{\\alpha} \\simeq \\tilde{H}_{\\alpha}</span> (instead of <span class="math">\\geq \\frac{\\tilde{H}_{\\alpha}}{2^n}</span>).</li>

      <li>The conjecture is stronger when <span class="math">m \\gg 2^{\\frac{3n}{4}}</span> since <span class="math">H_{\\alpha} \\geq \\frac{\\tilde{H}_{\\alpha}}{2^n}</span> implies that <span class="math">H_{\\alpha} \\neq 0</span> for example.</li>

    </ul>

    <p class="text-gray-300">24</p>`;
---

<BaseLayout title="Security in $O(2^n)$ for the Xor of Two Random Permutations\... (2013/368)">
  <article class="max-w-4xl mx-auto article-prose">
    <nav class="mb-8">
      <a href="/papers" class="text-blue-400 hover:text-blue-300">
        &larr; Back to Papers
      </a>
    </nav>

    <header class="mb-12">
      <h1 class="text-3xl font-bold mb-4"
        set:html={TITLE_HTML} />
      <p class="text-gray-400 mb-2"
        set:html={AUTHORS_HTML} />
      <p class="text-gray-500 text-sm mb-4">
        2013 &middot; eprint 2013/368
      </p>
      <div class="flex gap-4 text-sm">
        <a
          href={EPRINT_URL}
          target="_blank"
          rel="noopener noreferrer"
          class="text-blue-400 hover:text-blue-300"
        >
          Paper (eprint) &rarr;
        </a>
      </div>
      <p class="mt-4 text-xs text-gray-500">
        All content below belongs to the original authors. This page
        reproduces the paper for educational purposes. Always
        <a
          href={EPRINT_URL}
          target="_blank"
          rel="noopener noreferrer"
          class="text-blue-400 hover:text-blue-300"
        >cite the original</a>.
      </p>
      <p class="mt-1 text-xs text-gray-600">
        Converted with: {CRAWLER} &middot; {CONVERTED_DATE}
      </p>
    </header>

    <Fragment set:html={CONTENT} />

  </article>
</BaseLayout>
