---
import BaseLayout from '../../layouts/BaseLayout.astro';
import PaperDisclaimer from '../../components/PaperDisclaimer.astro';
import PaperHistory from '../../components/PaperHistory.astro';

const EPRINT_URL = 'https://eprint.iacr.org/2016/209';
const CRAWLER = 'marker';
const CONVERTED_DATE = '2026-02-20';
const TITLE_HTML = '**Automatic Differential Analysis of ARX Block Ciphers with Application to SPECK and LEA** *⋆*';
const AUTHORS_HTML = 'Ling Song&lt;sup&gt;1&lt;/sup&gt;*,*2*,*&lt;sup&gt;3&lt;/sup&gt; , Zhangjie Huang&lt;sup&gt;1&lt;/sup&gt;*,*2() , Qianqian Yang&lt;sup&gt;1&lt;/sup&gt;*,*&lt;sup&gt;2&lt;/sup&gt;';

const CONTENT = `    <p class="text-gray-300">Ling Song&lt;sup&gt;1&lt;/sup&gt;<em>,</em>2<em>,</em>&lt;sup&gt;3&lt;/sup&gt; , Zhangjie Huang&lt;sup&gt;1&lt;/sup&gt;<em>,</em>2() , Qianqian Yang&lt;sup&gt;1&lt;/sup&gt;<em>,</em>&lt;sup&gt;2&lt;/sup&gt;</p>

    <p class="text-gray-300">&lt;sup&gt;1&lt;/sup&gt; State Key Laboratory of Information Security, Institute of Information Engineering, Chinese Academy of Sciences, Beijing 100093, China &lt;sup&gt;2&lt;/sup&gt; Data Assurance and Communication Security Research Center, Chinese Academy of Sciences, Beijing 100093, China &lt;sup&gt;3&lt;/sup&gt; Nanyang Technological University, Singapore <em>{</em>songling,huangzhangjie,yangqianqian<em>}</em>@iie.ac.cn</p>

    <p class="text-gray-300"><strong>Abstract.</strong> In this paper, we focus on the automatic differential cryptanalysis of ARX block ciphers with respect to XOR-difference, and develop Mouha et al.'s framework for finding differential characteristics by adding a new method to construct long characteristics from short ones. The new method reduces the searching time a lot and makes it possible to search differential characteristics for ARX block ciphers with large word sizes such as <em>n</em> = 48<em>,</em> 64. What's more, we take the differential effect into consideration and find that the differential probability increases by a factor of 1<em>.</em>4 <em>∼</em> 8 for SPECK and about 2&lt;sup&gt;10&lt;/sup&gt; for LEA when multiple characteristics are counted in. The efficiency of our method is demonstrated by improved attacks of SPECK and LEA, which attack 1, 1, 4 and 6 more rounds of SPECK48, SPECK64, SPECK96 and SPECK128, respectively, and 2 more rounds of LEA than previous works.</p>

    <p class="text-gray-300"><strong>Key words:</strong> Differential cryptanalysis, automatic search, ARX, SPECK, LEA</p>

    <h2 id="sec-1" class="text-2xl font-bold"><strong>1 Introduction</strong></h2>

    <p class="text-gray-300">ARX ciphers are a broad class of symmetric-key cryptographic algorithms that only consists of three operations: additions modulo 2<em>&lt;sup&gt;n&lt;/sup&gt;</em>, bit rotations and XORs. Some examples of ARX ciphers are: the block ciphers SPECK [3], LEA [14], Chaskey [17], the stream cipher Salsa20 [4], and the SHA-3 finalists Skein [11] and</p>

    <p class="text-gray-300"><em>&lt;sup&gt;⋆&lt;/sup&gt;</em> <strong>Note</strong>: The paper with the same title was published on ACISP 2016. After the publication, the authors found that when calculating the probability of a differential, the number of solutions was computed inaccurately due to some simplifications of STP. To revise the paper, the authors re-evaluate the differential effect using another solver named Yices [10]. The experiments show that STP overestimates the number of solutions by a factor of 2 for most cases and thus the actual probabilities of differentials should be slightly lower. After revision, all the differentials and attacks are still valid. The authors would like to thank Pascal Jung for the helpful discussion.</p>

    <p class="text-gray-300">Blake [2]. To evaluate the security of an ARX cipher, differential cryptanalysis [5] is one of the most important attacks that should be considered.</p>

    <p class="text-gray-300">Even though ARX ciphers have a long history for use, their security analysis are lagging behind. For S-box based symmetric-key ciphers, their security against differential cryptanalysis is measured by the number of active S-boxes. On the contrary, there is no rigorous security proof of ARX ciphers against differential cryptanalysis in existing literature, so searching optimal differentials becomes the only way for evaluation. In 2013, Mouha et al. introduce a framework [18] for searching optimal differential characteristics of ARX ciphers, assuming all the operations in the cipher are independent. From the application to Salsa20, the assumption is shown to be invalid sometimes. In [7, 6], Biryukov et al. proposed a tool for automatically searching differential characteristics in ARX ciphers based on Matsui's algorithm and partial difference distribution tables. This tool suits differential search with respect to both XOR- and ADD- differences. However, the it is not applicable for cases where the block size is too large, such as <em>n</em> = 48<em>,</em> 64. [12]</p>

    <p class="text-gray-300">In this paper, we focus on the automatic differential cryptanalysis of ARX block ciphers with respect to XOR-difference. We apply Mouha et al.'s framework of finding differential characteristics to ARX block ciphers assuming additions are independent, and develop the framework by adding a new method for constructing long characteristics from short ones. The new method reduces the searching time, especially for a large word size such as <em>n</em> = 64. Besides, we take the differential effect into consideration and find that the differential probability increases by a factor of 1<em>.</em>4 <em>∼</em> 2 &lt;sup&gt;10&lt;/sup&gt; when multiple characteristics are counted in. The efficiency of our new method can be demonstrated by the application to two block ciphers: SPECK and LEA, in which better differentials are found and differential attacks against them are improved. The results are summarized in Table 1 and compared with the best ones of previous works. As can be seen, for SPECK we reduce the complexities of differential attack on SPECK32/64, and attack 1, 1, 4 and 6 more rounds against SPECK48, SPECK64, SPECK96 and SPECK128, respectively; for LEA, except the attacks in the specification we provide the first differential analysis for it and attack 13, 13 and 15 rounds of LEA-128, LEA-192 and LEA-256, respectively.</p>

    <p class="text-gray-300">During the submission of this paper, there are another two related papers presented on FSE 2016 [12, 8]. In [12] Fu et al. extend Sun's MILP-based automatic search algorithms for differential and linear trails [21] from Sbox-based block ciphers to ARX block ciphers and improve the differential and linear attacks on SPECK. In the other paper, Biryukov et al. [8] propose the first adaptation of Matsuis algorithm for finding the best differential and linear trails in ARX ciphers and the adapted algorithm is also applied to SPECK. Still the differential characteristics of SPECK96 and SPECK128 are the best in terms of the number of rounds, and the ones of SPECK32, SPECK48 and SPECK64 are best in terms of probabilities because we take differential effect into account.</p>

    <p class="text-gray-300">The rest of this paper is organized as follows. Section 2 provides a background of differential cryptanalysis; Section 3 elaborates on searching method developed</p>

    <div class="overflow-x-auto my-4">
      <table class="min-w-full text-sm text-gray-300">
        <thead>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">Variant</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">Rounds attacked/</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">Time</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">Data</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">Memory</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">Reference</th>
        </thead>
        <tbody>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Total rounds</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">(CP)</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">SPECK32/64</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">14/22</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">63&lt;br&gt;2</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">31&lt;br&gt;2</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">22&lt;br&gt;2</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">[9]</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">14/22</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">62.47&lt;br&gt;2</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">30.47&lt;br&gt;2</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">22&lt;br&gt;2</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">This paper</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">SPECK48/72</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">14/22</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">65&lt;br&gt;2</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">41&lt;br&gt;2</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">22&lt;br&gt;2</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">[9]</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">15/22</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">69.31&lt;br&gt;2</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">45.31&lt;br&gt;2</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">22&lt;br&gt;2</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">This paper</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">SPECK48/96</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">15/23</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">89&lt;br&gt;2</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">41&lt;br&gt;2</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">22&lt;br&gt;2</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">[9]</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">16/23</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">93.31&lt;br&gt;2</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">45.31&lt;br&gt;2</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">22&lt;br&gt;2</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">This paper</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">SPECK64/96</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">18/26</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">93&lt;br&gt;2</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">61&lt;br&gt;2</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">22&lt;br&gt;2</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">[9]</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">19/26</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">93.56&lt;br&gt;2</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">61.56&lt;br&gt;2</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">22&lt;br&gt;2</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">This paper</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">SPECK64/128</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">19/27</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">125&lt;br&gt;2</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">61&lt;br&gt;2</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">22&lt;br&gt;2</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">[9]</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">20/27</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">125.56 2&lt;br&gt;2</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">61.56</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">22&lt;br&gt;2</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">This paper</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">SPECK96/96</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">16/28</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">85&lt;br&gt;2</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">85&lt;br&gt;2</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">22&lt;br&gt;2</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">[9]</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">18/28</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">82&lt;br&gt;2</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">82&lt;br&gt;2</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">22&lt;br&gt;2</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">This paper</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">20/28</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">95.94&lt;br&gt;2</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">95.94&lt;br&gt;2</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">22&lt;br&gt;2</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">This paper</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">SPECK96/144</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">17/29</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">133&lt;br&gt;2</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">85&lt;br&gt;2</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">22&lt;br&gt;2</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">[9]</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">19/29</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">130&lt;br&gt;2</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">82&lt;br&gt;2</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">22&lt;br&gt;2</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">This paper</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">21/29</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">143.94 2&lt;br&gt;2</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">95.94</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">22&lt;br&gt;2</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">This paper</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">SPECK128/128</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">17/32</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">113&lt;br&gt;2</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">113&lt;br&gt;2</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">22&lt;br&gt;2</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">[9]</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">23/32</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">125.35 2&lt;br&gt;2</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">125.35</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">22&lt;br&gt;2</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">This paper</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">SPECK128/192</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">18/33</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">177&lt;br&gt;2</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">113&lt;br&gt;2</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">22&lt;br&gt;2</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">[9]</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">24/33</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">189.35 2&lt;br&gt;2</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">125.35</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">22&lt;br&gt;2</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">This paper</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">SPECK128/256</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">19/34</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">241&lt;br&gt;2</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">113&lt;br&gt;2</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">22&lt;br&gt;2</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">[9]</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">25/34</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">253.35 2&lt;br&gt;2</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">125.35</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">22&lt;br&gt;2</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">This paper</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">LEA-128</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">12/24</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">84&lt;br&gt;2</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">100&lt;br&gt;2</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">76&lt;br&gt;2</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">[14]</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">LEA-128</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">14/24</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">124.79 2&lt;br&gt;2</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">124.79</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">22&lt;br&gt;2</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">This paper</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">LEA-192</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">14/28</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">124.79 2&lt;br&gt;2</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">124.79</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">22&lt;br&gt;2</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">This paper</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">LEA-256</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">15/32</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">252.79 2&lt;br&gt;2</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">124.79</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">22&lt;br&gt;2</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">This paper</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
        </tbody>
      </table>
    </div>

    <p class="text-gray-300"><strong>Table 1.</strong> Previous attacks and our new attacks on SPECK.</p>

    <p class="text-gray-300">in this paper; Section 4 briefly describes the two block ciphers SPECK and LEA; in Section 5 we provide the searching results for differentials of SPECK and LEA, on which attacks are launched; Section 6 is a short discussion; and finally, the last section is the conclusion.</p>

    <p class="text-gray-300">A few words on notations: differences here are expressed using XOR; values for differences are represented in hexadecimal.</p>

    <h2 id="sec-2" class="text-2xl font-bold"><strong>2 Background</strong></h2>

    <p class="text-gray-300">This section briefly reviews the differential cryptanalysis and differential properties of addition. At the end of this section, the assumption we take in this paper is clarified.</p>

    <h4 id="sec-3" class="text-lg font-semibold mt-6"><strong>2.1 Differential Cryptanalysis</strong></h4>

    <p class="text-gray-300">Differential cryptanalysis was introduced by Biham and Shamir in [5]. For block ciphers, it is used to analyze how input differences lead to output differences. If certain input/output difference happens in a non-random way, it can be used to build a distinguisher or even to recover keys.</p>

    <p class="text-gray-300">To consider the security of iterated block ciphers against differential cryptanalysis, Lai et al. first introduced the theory of Markov ciphers and made a distinction between a differential and a differential characteristic [15]. A differential is a difference propagation from an input difference to an output difference, while a differential characteristic specifies not only the input/output difference, but also all the internal differences after each round. For a Markov cipher, the probability of a differential characteristic is the multiplication of difference transition probabilities of each round, and the probability of a differential is equal to the sum of the probabilities of all differential characteristics which correspond to the differential.</p>

    <h4 id="sec-4" class="text-lg font-semibold mt-6"><strong>2.2 Estimating Differential Probabilities for ARX Ciphers</strong></h4>

    <p class="text-gray-300">For ARX block ciphers, only additions modulo 2<em>&lt;sup&gt;n&lt;/sup&gt;</em> are non-linear operations and propagate differences indefinitely. So we focus on calculating differential probability of addition. In [16], Lipmaa and Moriai study the differential properties of addition. Let xdp&lt;sup&gt;+&lt;/sup&gt;(<em>α, β &lt;sup&gt;→&lt;/sup&gt; &lt;sup&gt;γ&lt;/sup&gt;</em>) be the XOR-differential probability of addition modulo 2<em>&lt;sup&gt;n&lt;/sup&gt;</em>, with input differences <em>α, β</em> and output difference <em>γ</em>. The authors prove that the differential (<em>α, β → γ</em>) is valid if and only if</p>

    <p class="text-gray-300"><span class="math">$eq(\\alpha \\ll 1, \\beta \\ll 1, \\gamma \\ll 1) \\land (\\alpha \\oplus \\beta \\oplus \\gamma \\oplus (\\beta \\ll 1)) = 0, \\tag{1}</span>$</p>

    <p class="text-gray-300">where</p>

    <p class="text-gray-300"><span class="math">$eq(x, y, z) := (\\neg x \\oplus y) \\land (\\neg x \\oplus z). \\tag{2}</span>$</p>

    <p class="text-gray-300">For every valid differential (<em>α, β → γ</em>), the weight <em>w</em>(<em>α, β → γ</em>) is defined as follows:</p>

    <p class="text-gray-300"><span class="math">$w(\\alpha, \\beta \\to \\gamma) := -\\log_2(xdp^+(\\alpha, \\beta \\to \\gamma)).</span>$</p>

    <p class="text-gray-300">The weight of a valid differential can be calculated as:</p>

    <p class="text-gray-300"><span class="math">$w(\\alpha, \\beta \\to \\gamma) = h(\\neg eq(\\alpha, \\beta, \\gamma)),</span>$
(3)</p>

    <p class="text-gray-300">where <em>h</em>(<em>x</em>) denotes the number of non-zero bits in <em>x</em> except the most significant bit.</p>

    <p class="text-gray-300"><strong>Assumption of independent additions.</strong> In this paper, we assume that additions in the block cipher are independent of each other with regard to XORdifference due to the use of round keys. Under this assumption, the probability of a differential characteristic is equal to the multiplication of the probabilities of all addition operations. Specifically, we calculate the weight of a differential characteristic as the sum of weights of all addition operations.</p>

    <h2 id="sec-5" class="text-2xl font-bold"><strong>3 Automatic Search for Characteristics and Differentials in ARX Block Ciphers</strong></h2>

    <p class="text-gray-300">In this section we elaborate on the searching method used in this paper.</p>

    <h4 id="sec-6" class="text-lg font-semibold mt-6"><strong>3.1 Mouha's Framework for Searching Differential Characteristics of ARX Ciphers</strong></h4>

    <p class="text-gray-300">In [18], Mouha and Preneel construct a framework to search for optimal differential characteristics of ARX ciphers and apply it to Salsa20. In their framework, a typical Satisfiability Modulo Theory (SMT) solver STP [13] is used. STP is built upon a SAT solver. Since many word-wise operations are included in its input language, it is suitable for searching problems of ARX ciphers.</p>

    <p class="text-gray-300">In the framework, they find differential characteristics up to a certain weight <em>W</em> with STP. First, they write simple equations with respect to XOR-difference for every addition, rotation and XOR of an ARX cipher as follows.</p>

    <ul class="list-disc list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li><strong>–</strong> Use <em>n</em>-bit variables to represent input difference words.</li>
      <li><strong>–</strong> Introduce additional <em>n</em>-bit variables to represent the differences after the addition, XOR, and rotation operations when required.</li>
      <li><strong>–</strong> Use Equation (1) and (2) for every addition modulo 2<em>&lt;sup&gt;n&lt;/sup&gt;</em> of the cipher to ensure that the input and output differences correspond to a valid differential of the addition operation.</li>
      <li><strong>–</strong> Include Equation (3) to calculate the weight of each addition operation, and represent the sum of weights of all additions with <em>W</em>, which corresponds to the weight of the differential characteristics under consideration.</li>
      <li><strong>–</strong> Specify that input difference is non-zero and restrict <em>W</em> to a maximum of a certain number.</li>
    </ul>

    <p class="text-gray-300">Second, they feed the equations generated into STP. STP converts these equations into formulae of conjunctive normal form (CNF), and then invokes an underlying SAT solver to find solutions.</p>

    <p class="text-gray-300">Although Mouha's framework that multiplies the differential probabilities of all additions was originally applied to a stream cipher, it is more suitable for ARX block ciphers where a round key is XORed each round. The reason is that additions in an ARX stream cipher are usually not independent, while additions in an ARX block cipher may be independent due to the use of round keys.</p>

    <h4 id="sec-7" class="text-lg font-semibold mt-6"><strong>3.2 Obtaining a Long Characteristic from Two Short Ones</strong></h4>

    <p class="text-gray-300">Mouha's framework can be applied directly to ARX block ciphers where additions are independent with regard to XOR-difference. However, due to the limitation of computation power, it takes too much time to find a long characteristic. In this paper, we introduce a method to obtain a long characteristic from two short ones. The method lies in searching differential characteristics from an internal difference which has only one active bit. This idea for searching long characteristics was inspired by the phenomenon that many optimal characteristics obtained have a special internal difference with only one active bit which usually leads to a differential transition of the nearest round with probability 1.</p>

    <p class="text-gray-300">The method for obtaining long characteristics is illustrated in Fig. 1. First, we set an internal difference after some rounds <em>D</em> to be a value where only one bit is nonzero, and then search forward and backward independently to get</p>

    <p class="text-gray-300">6 L. Song et al.</p>

    <p class="text-gray-300">two short characteristics. After that we combine these two short characteristics together to get a long one. Since either the input or output difference is fixed, two short characteristics with best probability can be easily searched. Note that this method saves much time for searching long characteristics, but does not always guarantee best characteristics.</p>

    <p class="text-gray-300">    <img src="_page_5_Figure_3.jpeg" alt="" class="my-4 max-w-full" />
</p>

    <p class="text-gray-300"><strong>Fig. 1.</strong> Obtaining a longer characteristic from two shorter ones.</p>

    <p class="text-gray-300">This method in differential attack resembles the one used in boomerang attack [22]. However, conditions for the two short characteristics are different. Suppose the probabilities of the two short characteristics are <em>p</em> and <em>q</em> respectively, and the block size is <em>N</em>. For standard differential attacks, <em>pq &gt;</em> 2 <em>&lt;sup&gt;−&lt;/sup&gt;&lt;sup&gt;N&lt;/sup&gt;</em> and the two short characteristics must be connected, while for boomerang attacks <em>pq &gt;</em> 2 <em>&lt;sup&gt;−&lt;/sup&gt;N/</em>2+1 and the two short characteristics are independent.</p>

    <h3 id="sec-8" class="text-xl font-semibold mt-8"><strong>3.3 Characteristics to Differentials</strong></h3>

    <p class="text-gray-300">For ARX ciphers, the probability of one characteristic cannot well approximate the probability of the corresponding differential because of a strong differential effect, that is, between the input difference and the output difference there are many characteristics.</p>

    <p class="text-gray-300">To calculate the differential probability as accurately as possible, more characteristics sharing the same input and output difference should be counted in. After a good characteristic is obtained, we fix the input and output difference, and search all characteristics with probability less or equal than that of the one obtained. More precisely, if the characteristic obtained has a weight <em>W</em>, we search all characteristics with the same input and output difference where the weight is <em>W, W</em> + 1<em>, W</em> + 2<em>, · · ·</em> , and add the probabilities of all these characteristics together.</p>

    <p class="text-gray-300"><strong>STP to Yices.</strong> Note that STP just outputs one solution. To find all solutions, in [19], i.e., the version of this paper published on ACISP 2016, the authors used STP to generate the CNF formulae, and then invoke a SAT solver, such as CryptoMiniSat [20], to get all solutions. However, due to some simplifications of STP in outputing CNF which preserve satisfiability, but not the number of solutions, the number of solutions we obtained was not accurate. To revise this, we now use Yices [10], another SMT solver to generate CNF formulae. Yices uses its own input language but it also supports SMT-LIB 1.0 and 2.0. Actually, Yices is an alternative of STP, but Yices is only used to patch the part of evaluating the differential effect.</p>

    <h2 id="sec-9" class="text-2xl font-bold"><strong>4 Description of SPECK and LEA</strong></h2>

    <h4 id="sec-10" class="text-lg font-semibold mt-6"><strong>4.1 SPECK</strong></h4>

    <p class="text-gray-300">SPECK is a family of lightweight block ciphers designed by researchers from the U.S. National Security Agency (NSA)[3]. It contains 10 variants, each of which is characterized by its block size 2<em>n</em> and key size <em>mn</em>. For example, SPECK32/64 refers to the SPECK block cipher with block size 32 bits and key size 64 bits. The parameters of SPECK are listed in Table 4.</p>

    <p class="text-gray-300">The SPECK2<em>n</em> encryption maps a plaintext of two <em>n</em>-bit words (<em>x</em>0<em>, y</em>0) into a ciphertext (<em>x&lt;sup&gt;T&lt;/sup&gt; , y&lt;sup&gt;T&lt;/sup&gt;</em> ), using a sequence of <em>T</em> rounds. The key-dependent round function is defined as</p>

    <p class="text-gray-300"><span class="math">$R^k(x,y) = (((x \\ggg \\alpha) \\boxplus y) \\oplus k, (y \\lll \\beta) \\oplus ((x \\ggg \\alpha) \\boxplus y) \\oplus k),</span>$</p>

    <p class="text-gray-300">where <em>k</em> is the round key, and rotation constants <em>α</em> and <em>β</em> are given in Table 4.</p>

    <p class="text-gray-300">The SPECK key schedule reuses the round function to generate the round keys <em>k</em>0<em>, · · · , k&lt;sup&gt;T&lt;/sup&gt;</em> . The <em>m</em>-word master key <em>K</em> = (<em>l&lt;sup&gt;m&lt;/sup&gt;−</em>&lt;sup&gt;2&lt;/sup&gt;<em>, · · · , l</em>0<em>, k</em>0) are used as follow:</p>

    <p class="text-gray-300"><span class="math">$l_{i+m-1} = (k_i \\boxplus (l_i \\gg \\alpha)) \\oplus i</span>$</p>

    <p class="text-gray-300"><span class="math">$k_{i+1} = (k_i \\ll \\beta) \\oplus l_{i+m-1}.</span>$</p>

    <p class="text-gray-300">Figure 2 provides a schematic view on the round function and the key schedule of SPECK.</p>

    <p class="text-gray-300">    <img src="_page_6_Picture_12.jpeg" alt="" class="my-4 max-w-full" />
</p>

    <p class="text-gray-300"><strong>Fig. 2.</strong> The round function and the key schedule of SPECK. <em>R i</em> is the SPECK round function with <em>i</em> acting as the round key.</p>

    <h4 id="sec-11" class="text-lg font-semibold mt-6">4.2 LEA</h4>

    <p class="text-gray-300">LEA is an ARX block cipher designed by Hong et al.[14] and provides a high-speed software encryption on general-purpose processors. It has the block size of 128 bits and the key size of 128, 192, or 256 bits. We denote the algorithms with 128-bit, 192-bit, and 256-bit keys by LEA-128, LEA-192, and LEA-256, respectively.</p>

    <p class="text-gray-300">The encryption of LEA maps a plaintext of four 32-bit words  <span class="math">(x_0^0, x_1^0, x_2^0, x_3^0)</span>  into a ciphertext  <span class="math">(x_0^r, x_1^r, x_2^r, x_3^r)</span>  using a sequence of r rounds, where r = 24 for LEA-128, r = 28 for LEA-192 and r = 32 for LEA-256. The round function for round  <span class="math">i, 0 \\le i &lt; r</span>  is defined as follows:</p>

    <p class="text-gray-300"><span class="math">$\\begin{split} x_0^{i+1} &amp;\\leftarrow ((x_0^i \\oplus rk_0^i) \\boxplus (x_1^i \\oplus rk_1^i)) \\lll 9, \\\\ x_1^{i+1} &amp;\\leftarrow ((x_1^i \\oplus rk_2^i) \\boxplus (x_2^i \\oplus rk_3^i)) \\ggg 5, \\\\ x_2^{i+1} &amp;\\leftarrow ((x_2^i \\oplus rk_4^i) \\boxplus (x_3^i \\oplus rk_5^i)) \\ggg 3, \\\\ x_3^{i+1} &amp;\\leftarrow x_0^i. \\end{split}</span>$</p>

    <p class="text-gray-300">where  <span class="math">rk^i = (rk_0^i, rk_1^i, rk_2^i, rk_3^i, rk_4^i, rk_5^i)</span>  is the round key, which is generated by a key schedule. We take LEA-128 as an example. Let  <span class="math">K = (k_0, k_1, k_2, k_3)</span>  be a 128-bit key. We set  <span class="math">t_i^0 = k_i</span>  for  <span class="math">0 \\le i &lt; 4</span> . For round  <span class="math">i, 0 \\le i &lt; r</span> ,  <span class="math">rk^i</span>  is produced through following relations:</p>

    <p class="text-gray-300"><span class="math">$\\begin{split} t_0^{i+1} &amp;\\leftarrow (t_0^i \\boxplus (\\delta^i \\lll i)) \\lll 1, \\\\ t_1^{i+1} &amp;\\leftarrow (t_1^i \\boxplus (\\delta^i \\lll i+1)) \\lll 3, \\\\ t_2^{i+1} &amp;\\leftarrow (t_2^i \\boxplus (\\delta^i \\lll i+2)) \\lll 6, \\\\ t_3^{i+1} &amp;\\leftarrow (t_3^i \\boxplus (\\delta^i \\lll i+3)) \\lll 11, \\\\ rk^i &amp;\\leftarrow (t_0^{i+1}, t_1^{i+1}, t_2^{i+1}, t_1^{i+1}, t_3^{i+1}, t_1^{i+1}). \\end{split}</span>$</p>

    <p class="text-gray-300">where  <span class="math">\\delta^i</span>  is the constant for round <em>i</em>. Figure 3 provides a schematic view on the round function of LEA and the key schedule of LEA-128. For key schedules of LEA-192 and LEA-256, please refer to Appendix A.2.</p>

    <p class="text-gray-300">    <img src="_page_7_Figure_9.jpeg" alt="" class="my-4 max-w-full" />
</p>

    <p class="text-gray-300">Fig. 3. The round function of LEA and the key schedule of LEA-128.</p>

    <h2 id="sec-12" class="text-2xl font-bold"><strong>5 Searching Results and Attacks of SPECK and LEA</strong></h2>

    <p class="text-gray-300">In this section we apply the searching method explained in Section 3 to SPECK and LEA. For five versions of SPECK (in respect of block size) and LEA, we would like to find the longest characteristics. To this goal, we need to find the minimal weight of differential characteristics with given number of rounds. Suppose the block size is <em>N</em>. If the weight of an <em>r</em>-round differential characteristic is less than <em>N</em>, then the corresponding differential characteristic can be used to build a distinguisher or to recover the key. On the contrary, if the minimal weight of all <em>r</em>-round differential characteristics is no less than <em>N</em>, then no useful differential characteristic exists for that <em>r</em>-round cipher. However, even though the weight of some characteristics is larger than <em>N</em>, the weight of the corresponding differential may be less than <em>N</em>. Therefore, we also evaluate the probability of the corresponding differential by counting in more characteristics which share the same input and output difference. For a differential, as long as its weight is less than <em>N</em>, it is useful, and our attacks in this paper are mounted based on differentials. Note that all of the characteristics are searched with STP2.0 on a 3.4GHz Intel Core i7-2600 processor, and CryptoMiniSat4 is used as the underlying solver of STP. The differential effect is evaluated using Yices 2.5.</p>

    <h3 id="sec-13" class="text-xl font-semibold mt-8"><strong>5.1 Characteristics and Differentials of SPECK</strong></h3>

    <p class="text-gray-300"><strong>Characteristics of SPECK32 and SPECK48.</strong> We directly apply Mouha's framework to SPECK with block size 2<em>n</em> = 32<em>,</em> 48. For SPECK32, the best 9 round characteristic obtained has a weight of 30, which coincides with that of [6]. We provide the Python code for generating Yices problems in Appendix D for verification. In addition, from a 10-round characteristic with weight 35 as shown in Table 5, we get the corresponding differential (0040<em>,</em> 2040) <em>→</em> (<em>A</em>840<em>,</em> 0800) with weight slightly less than 32. The probability calculation of the differential is displayed in Fig. 4. As far as we know, this 10-round characteristic is the longest distinguisher for SPECK32 in the literature. For SPECK48, our computer takes 12.5 days to find a 11-round characteristic with weight 46, and the corresponding differential has a weight of 44.31.</p>

    <p class="text-gray-300"><strong>Characteristics of SPECK64, SPECK96 and SPECK128.</strong> We construct long characteristics for these versions where 2<em>n</em> = 64<em>,</em> 96<em>,</em> 128 from two short ones. Take SPECK64 as an example. We set an internal difference to be (00000080<em>,</em> 00000000) and search forward and backward independently. According to experiments, a 4-round forward characteristic with weight 9 and an 11-round backward characteristic with weight 53 can be combined to get a 15 round characteristic of weight 62. The corresponding differential has a weight less than 60.56. For SPECK96 and SPECK128, the searching works similarly. However, for both of them, differentials are derived from characteristics with weight equal to the block size. Specifically, from a 17-round characteristic of SPECK96 with weight 96 we get a 17-round differential with weight less than 94.94; from a 19-round characteristic of SPECK128 with weight 128, we obtain a 19-round differential with weight less than 124.35. The times for searching</p>

    <div class="overflow-x-auto my-4">
      <table class="min-w-full text-sm text-gray-300">
        <thead>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">weight</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">#sol.</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">log2Pr.</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">log2Σacc</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"></th>
        </thead>
        <tbody>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">35</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-35</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-35</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">36</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">2</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-35</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-34</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">37</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">3</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-35.42</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-33.54</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">38</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">8</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-35</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-33.09</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">39</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">19</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-34.75</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-32.70</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">40</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">25</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-35.36</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-32.48</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">41</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">44</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-35.54</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-32.32</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">42</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">46</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-36.48</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-32.24</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">43</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">90</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-36.51</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-32.17</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">44</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">113</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-37.18</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-32.12</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">45</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">142</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-37.85</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-32.10</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">46</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">251</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-38.03</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-32.07</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">47</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">401</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-38.35</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-32.06</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">48</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">648</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-38.66</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-32.04</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">49</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1022</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-39.00</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-32.03</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">50</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1823</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-39.17</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-32.02</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">51</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">2987</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-39.46</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-32.0109</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">52</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">5130</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-39.67</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-32.0038</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">53</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">9703</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-39.76</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-31.9971</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">54</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">18688</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-39.81</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-31.9907</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
        </tbody>
      </table>
    </div>

    <p class="text-gray-300"><strong>Fig. 4.</strong> A 10-round differential of SPECK32 with (<em>∆x</em>0<em>, ∆y</em>0) = (2040<em>,</em> 0040), (<em>∆x</em>10<em>, ∆y</em>10) = (0800<em>, A</em>840).</p>

    <p class="text-gray-300">long characteristics for SPECK64, SPECK96 and SPECK128 are 0.9 hour, 11.3 hours and 5.2 hours respectively, which are much less compared with the time for directly searching characteristics of SPECK48.</p>

    <p class="text-gray-300"><strong>Comparison.</strong> Table 2 compares the differentials of SPECK we find with the ones in the literature. For SPECK32, we find a 10-round differential with probability 2<em>−</em>31<em>.</em>&lt;sup&gt;99&lt;/sup&gt;, the best distinguisher of SPECK32 to date. We also find a 9 round characteristic of SPECK32 that coincides with that of [6] but has a tighter estimation of differential probability. For SPECK48, we obtain an 11-round characteristic with a better weight. For SPECK64, SPECK96 and SPECK128, the characteristics cover 1, 4 and 5 more round(s) than previous works.</p>

    <h4 id="sec-14" class="text-lg font-semibold mt-6"><strong>5.2 Characteristics and Differentials of LEA</strong></h4>

    <p class="text-gray-300"><strong>Characteristics of LEA.</strong> We construct long characteristics for LEA from two short ones. We set an internal difference to be (00000100<em>,</em> 00000000<em>,</em> 00000000<em>,</em> 000 00000) and search forward and backward independently. A 12-round characteristic of weight 112 can be constructed by combining two short ones of 6 forward rounds and 6 backward rounds respectively. From this characteristic we derive a 12-round differential</p>

    <pre><code class="language-text">(10401080, 0A001080, 02041208, 00049228)
→(88008008, 88A2A00A, 22020060, 00000010)
</code></pre>

    <p class="text-gray-300">with weight less than 103.19. Also, a 13-round characteristic can be constructed by connecting two short ones of 6 forward rounds and 7 backward rounds and its weight is 134. From this characteristic a 13-round differential</p>

    <pre><code class="language-text">(00049018, 40049000, 10220041, 00028001)
→(88008008, 88A2A00A, 22020060, 00000010)
</code></pre>

    <div class="overflow-x-auto my-4">
      <table class="min-w-full text-sm text-gray-300">
        <thead>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"></th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">Block Rounds Prob.</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"></th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">Input</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">Output</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">Reference</th>
        </thead>
        <tbody>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Size</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">r</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Difference</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Difference</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">9</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">2−30</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">(8054, A900)</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">(0040, 0542)</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">[6]</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">32</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">9</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">2−29.47</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">(8054, A900)</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">(0040, 0542)</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">This paper</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">10</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">2−31.99</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">(2040, 0040)</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">(A840, 0800)</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">This paper</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">11</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">2−46.48</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">(202040, 082921)</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">(808424, 84A905)</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">[6]</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">48</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">11</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">2−44.31</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">(504200, 004240)</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">(202001, 202000)</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">This paper</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">14</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">2−59.02</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">(00000009, 01000000) (00040024, 04200D01)</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">[6]</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">64</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">15</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">2−60.56</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">(04092400, 20040104) (808080A0, A08481A4) This paper</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">2−84</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">(2A20200800A2,</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">(1008004C804,</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">13&lt;br&gt;96&lt;br&gt;15&lt;br&gt;17</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">322320680801)</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">C0180228C60)</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">[1]</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">2−81</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">(082020000000,</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">(800400008124,</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">This paper</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">000120200000)</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">842004008801)</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">2−94.94</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">(240004000009,</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">(A0A000008880,</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">This paper</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">010420040000)</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">81A02004C88C)</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">15</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">2−117.28</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">(0640240804002440,</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">(828028080A080888,</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">[1]</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">128&lt;br&gt;18</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">6004400C20040004)</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">E88C81A4A0924B2C)</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">2−113</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">(0800202000000000,</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">(8080808000000020,</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">This paper</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">4808012020000000)</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">A084808000000124)</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">(0124000400000000,</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">(8004000080000124,</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">20</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">2−124.35</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">0801042004000000)</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">8420040080000801)</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">This paper</td>
          </tr>
        </tbody>
      </table>
    </div>

    <p class="text-gray-300"><strong>Table 2.</strong> Comparison of our differentials of SPECK with previous ones.</p>

    <p class="text-gray-300">of weight less than 123.79 is derived. The probability calculation of the differential is displayed in Fig. 5. Note that, besides the input and output differences, an intermediate difference after the seventh round is also fixed to speed up the calculation. It seems that the accumulated probability <em>Σacc</em> has a property of slow convergence, which is different from the case of SPECK. The underlying reason keeps unexplored for the moment.</p>

    <p class="text-gray-300">The details of these two characteristics are shown in Table 7. Compared with the only differential analysis in the specification of LEA, the differential in this paper covers two more rounds.</p>

    <p class="text-gray-300"><strong>Table 3.</strong> Comparison of our differentials of LEA with previous ones.</p>

    <div class="overflow-x-auto my-4">
      <table class="min-w-full text-sm text-gray-300">
        <thead>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">#Rounds</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">Prob.</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">Reference</th>
        </thead>
        <tbody>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">11</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">2−98</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">[14]</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">12</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">2−128</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">[14]</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">12</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">2−103.19 This paper</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">13</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">2−123.79 This paper</td>
          </tr>
        </tbody>
      </table>
    </div>

    <p class="text-gray-300">    <img src="_page_11_Figure_2.jpeg" alt="" class="my-4 max-w-full" />
</p>

    <p class="text-gray-300"><strong>Fig. 5.</strong> A 13-round differential of LEA,  <span class="math">(00049018, 40049000, 10220041, 00028001) \\rightarrow (88008008, 88A2A00A, 22020060, 00000010).</span></p>

    <h4 id="sec-15" class="text-lg font-semibold mt-6">5.3 Differential Attacks on SPECK and LEA</h4>

    <p class="text-gray-300"><strong>Differential attacks on SPECK.</strong> In [9] Dinur proposed an enumeration technique for key recovery in differential attacks against SPECK. Given a differential characteristic for SPECK2n/mn that covers r rounds of the cipher with probability  <span class="math">p &gt; 2 \\cdot 2^{-2n}</span> , the enumeration technique can be used to recover the key of a variant with (r+m) rounds with  <span class="math">2 \\cdot p^{-1}</span>  chosen plaintexts, in an average time complexity of  <span class="math">2 \\cdot p^{-1} \\cdot 2^{(m-2)n}</span>  encryptions. The required memory is constant for all versions of SPECK, which is  <span class="math">2^{22}</span>  bytes, i.e. only a few megabytes. Appendix B provides more information about Dinur's enumeration technique.</p>

    <p class="text-gray-300">Adding one round for free. We use the r-round differential  <span class="math">(\\alpha \\to \\beta)</span>  over rounds  <span class="math">2 \\sim (r+1)</span> , and choose pairs of plaintexts such that their difference after the first round is  <span class="math">\\alpha</span> . In this way, one more round can be extended for free. This idea was also adopted by Abed et al. in [1]. Consequently, given an r-round differential, the attack can cover (r+m+1) rounds.</p>

    <p class="text-gray-300">For SPECK32/64, we use the same 9-round differential as in [1,6]. According to our experiments, the differential holds with probability at least  <span class="math">2^{-29.47}</span> , which is larger than  <span class="math">2^{-30}</span> , the probability of the best characteristic of the differential. This indicates that the complexities of the attack can be reduced with a tighter estimation of the probability of the differential. Combined with Dinur's enumeration technique for key recovery, the differential can be used to attack a 14-round SPECK32/64 at a cost of  <span class="math">2 \\cdot 2^{29.47} = 2^{30.47}</span>  plaintexts and  <span class="math">2 \\cdot 2^{29.47} \\cdot 2^{32} = 2^{62.47}</span>  encryptions.</p>

    <p class="text-gray-300">Differential attacks for the rest variants are similar to that of SPECK32/64, so we omit the details on calculation of the complexities. The attacks are mounted based on the differentials in Table 2 and the results are summarized in Table 1. Compared with the previous works, the attacks on SPECK48, SPECK64, SPCKE96, SPECK128 extend 1, 1, 4 and 6 more round(s) respectively.</p>

    <p class="text-gray-300"><strong>Differential attacks on LEA.</strong> Since the differential equations of addition in the key recovery of LEA are similar to that of SPECK, Dinur's enumeration technique can be adapted to LEA. Given an r-round differential characteristic of LEA with probability  <span class="math">p &gt; 2 \\cdot 2^{-N}</span>  where N is the block size, for LEA-128 and LEA-192, the attack recovers the key of a variant of (r+1) rounds with  <span class="math">2 \\cdot p^{-1}</span>  plaintexts, in expected time complexity of  <span class="math">2 \\cdot p^{-1}</span>  encryptions, while (r+2) rounds of LEA-256 can be attacked with  <span class="math">2 \\cdot p^{-1}</span>  plaintexts and  <span class="math">2 \\cdot p^{-1} \\cdot 2^{N}</span>  encryptions in average. The attacks are summarized in Table 1.</p>

    <h4 id="sec-16" class="text-lg font-semibold mt-6">6 Discussion</h4>

    <p class="text-gray-300"><strong>Differential effect.</strong> Experimental results confirm the strong differential effect of ARX block ciphers. When the characteristics sharing the same input and output difference are counted in, the differential probability increases by a factor of  <span class="math">1.4 \\sim 8</span>  for SPECK and by a factor around  <span class="math">2^{10}</span>  for LEA. Due to this differential effect, the probability of a characteristic shouldn't be simply taken as the differential probability for these ARX block ciphers.</p>

    <p class="text-gray-300"><strong>Limitation of our searching method.</strong> The searching method discussed in this paper takes the assumption of independent additions with respect to XOR-difference. However, additions are not independent in most ARX block ciphers, such as TEA [23], and Chaskey [17], to which our searching method can not be applied directly. One of our future work is to deal with the dependency among additions.</p>

    <h4 id="sec-17" class="text-lg font-semibold mt-6">7 Conclusion</h4>

    <p class="text-gray-300">In this paper, we apply Mouha's framework of finding differential characteristics to ARX block ciphers where the additions are independent with respect to XOR differences, and develop this framework by adding a new method for constructing long characteristics from short ones. This new method reduces the searching time a lot and makes it possible to search differential characteristics for ARX block ciphers with large word size such as n=64. In addition, we take the differential effect into consideration and the results show the probability of a characteristic shouldn't be simply taken as the differential probability for these ARX block ciphers. The efficiency of our method is demonstrated by improved attacks of SPECK and LEA. One of our future work is to deal with the dependency among additions which are common in most ARX ciphers.</p>

    <p class="text-gray-300"><strong>Acknowledgement:</strong> The authors would like to thank Jian Guo for his valuable suggestions and thank the anonymous reviewers for their valuable comments and suggestions.</p>

    <h4 id="sec-18" class="text-lg font-semibold mt-6">References</h4>

    <ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li>Farzaneh Abed, Eik List, Stefan Lucks, and Jakob Wenzel. Differential cryptanalysis of round-reduced simom and speck. In Cid Carlos and Rechberger Christian,</li>
    </ol>

    <ul class="list-disc list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li><p class="text-gray-300">editors, <em>Fast Software Encryption FSE 2014</em>, volume 8540 of <em>Lecture Notes in Computer Science</em>, pages 525–545. Springer Berlin Heidelberg, 2014.</p></li>
      <li><ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li>Jean-Philippe Aumasson, Luca Henzen, Willi Meier, and Raphael C.-W. Phan. Sha-3 proposal blake. Technical report, Submission to the NIST SHA-3 Competition (Round 2), 2008.</li>
    </ol></li>
      <li><ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li>Ray Beaulieu, Douglas Shors, Jason Smith, Stefan Treatman-Clark, Bryan Weeks, and Louis Wingers. The simon and speck families of lightweight block ciphers. Technical report, Cryptology ePrint Archive, Report 2013/404, 2013.</li>
    </ol></li>
      <li><ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li>Daniel J. Bernstein. <em>The Salsa20 Family of Stream Ciphers</em>, volume 4986, pages 84–97. Springer Berlin Heidelberg, 2008.</li>
    </ol></li>
      <li><ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li>Eli Biham and Adi Shamir. Differential cryptanalysis of des-like cryptosystems. <em>Journal of Cryptology</em>, 4(1):3–72, 1991.</li>
    </ol></li>
      <li><ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li>Alex Biryukov, Arnab Roy, and Vesselin Velichkov. Differential analysis of block ciphers simon and speck. In Cid Carlos and Rechberger Christian, editors, <em>Fast Software Encryption - FSE 2014</em>, volume 8540 of <em>Lecture Notes in Computer Science</em>, pages 525–545. Springer Berlin Heidelberg, 2014.</li>
    </ol></li>
      <li><ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li>Alex Biryukov and Vesselin Velichkov. Automatic search for differential trails in arx ciphers. In Josh Benaloh, editor, <em>Topics in Cryptology – CT-RSA 2014</em>, volume 8366 of <em>Lecture Notes in Computer Science</em>, pages 227–250. Springer International Publishing, 2014.</li>
    </ol></li>
      <li><ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li>Alex Biryukov, Vesselin Velichkov, and Yann Le Corre. Milp-based automatic search algorithms for differential and linear trails for speck. In Thomas Peyrin, editor, <em>Fast Software Encryption - FSE 2016</em>. To appear in FSE 2016, 2016.</li>
    </ol></li>
      <li><ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li>Itai Dinur. Improved differential cryptanalysis of round-reduced speck. In Antoine Joux and Amr Youssef, editors, <em>Selected Areas in Cryptography – SAC 2014</em>, volume 8781 of <em>Lecture Notes in Computer Science</em>, pages 147–164. Springer International Publishing, 2014.</li>
    </ol></li>
      <li><ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li>Bruno Dutertre. The yices smt solver. Website, 2017. http://yices.csl.sri. com/.</li>
    </ol></li>
      <li><ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li>Niels Ferguson, Stefan Lucks, Bruce Schneier, Doug Whiting, Mihir Bellare, Tadayoshi Kohno, Jon Callas, and Jesse Walker. The skein hash function family. Technical report, Submission to the NIST SHA-3 Competition (Round 2), 2009.</li>
    </ol></li>
      <li><ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li>Kai Fu, Meiqin Wang, Yinghua Guo, Siwei Sun, and Lei Hu. Automatic search for the best trails in arx: Application to block cipher speck. In Thomas Peyrin, editor, <em>Fast Software Encryption - FSE 2016</em>. To appear in FSE 2016, 2016.</li>
    </ol></li>
      <li><ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li>Vijay Ganesh and David L. Dill. A decision procedure for bit-vectors and arrays. In <em>Proceedings of the 19th International Conference on Computer Aided Verification</em>, CAV'07, pages 519–531, Berlin, Heidelberg, 2007. Springer-Verlag.</li>
    </ol></li>
      <li><ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li>Deukjo Hong, Jung-Keun Lee, Dong-Chan Kim, Daesung Kwon, Kwon Ho Ryu, and Dong-Geon Lee. Lea: A 128-bit block cipher for fast encryption on common processors. In Yongdae Kim, Heejo Lee, and Adrian Perrig, editors, <em>Information Security Applications - WISA 2013</em>, volume 8267 of <em>Lecture Notes in Computer Science</em>, pages 3–27. Springer International Publishing, 2014.</li>
    </ol></li>
      <li><ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li>Xuejia Lai, JamesL. Massey, and Sean Murphy. Markov ciphers and differential cryptanalysis. In Donald W. Davies, editor, <em>Advances in Cryptology - EU-ROCRYPT 91</em>, volume 547 of <em>Lecture Notes in Computer Science</em>, pages 17–38. Springer Berlin Heidelberg, 1991.</li>
    </ol></li>
      <li><ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li>Helger Lipmaa and Shiho Moriai. Efficient algorithms for computing differential properties of addition. In Mitsuru Matsui, editor, <em>Fast Software Encryption</em>, volume 2355 of <em>Lecture Notes in Computer Science</em>, pages 336–350. Springer Berlin Heidelberg, 2002.</li>
    </ol></li>
      <li><ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li>Nicky Mouha, Bart Mennink, Anthony Herrewege, Dai Watanabe, Bart Preneel, and Ingrid Verbauwhede. Chaskey: An efficient mac algorithm for 32-bit microcontrollers. In Antoine Joux and Amr Youssef, editors, <em>Selected Areas in Cryptography – SAC 2014</em>, volume 8781 of <em>Lecture Notes in Computer Science</em>, pages 306–323. Springer International Publishing, 2014.</li>
    </ol></li>
      <li><ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li>Nicky Mouha and Bart Preneel. Towards finding optimal differential characteristics for arx: Application to salsa20. Technical report, Cryptology ePrint Archive, Report 2013/328, 2013.</li>
    </ol></li>
      <li><ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li>Ling Song, Zhangjie Huang, and Qianqian Yang. Automatic differential analysis of ARX block ciphers with application to SPECK and LEA. In Joseph K. Liu and Ron Steinfeld, editors, <em>Information Security and Privacy - 21st Australasian Conference, ACISP 2016, Melbourne, VIC, Australia, July 4-6, 2016, Proceedings, Part II</em>, volume 9723 of <em>Lecture Notes in Computer Science</em>, pages 379–394. Springer, 2016.</li>
    </ol></li>
      <li><ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li>Mate Soos, Karsten Nohl, and Claude Castelluccia. Extending sat solvers to cryptographic problems. In <em>Proceedings of the 12th International Conference on Theory and Applications of Satisfiability Testing</em>, SAT '09, pages 244–257, Berlin, Heidelberg, 2009. Springer-Verlag.</li>
    </ol></li>
      <li><ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li>Siwei Sun, Lei Hu, Peng Wang, Kexin Qiao, Xiaoshuang Ma, and Ling Song. <em>Automatic Security Evaluation and (Related-key) Differential Characteristic Search: Application to SIMON, PRESENT, LBlock, DES(L) and Other Bit-Oriented Block Ciphers</em>, pages 158–178. Springer Berlin Heidelberg, Berlin, Heidelberg, 2014.</li>
    </ol></li>
      <li><ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li>David Wagner. The boomerang attack. In Lars Knudsen, editor, <em>Fast Software Encryption</em>, volume 1636 of <em>Lecture Notes in Computer Science</em>, pages 156–170. Springer Berlin Heidelberg, 1999.</li>
    </ol></li>
      <li><ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li>David J. Wheeler and Roger M. Needham. <em>TEA, a tiny encryption algorithm</em>, volume 1008, pages 363–366. Springer Berlin Heidelberg, 1995.</li>
    </ol></li>
    </ul>

    <h2 id="sec-19" class="text-2xl font-bold"><strong>A More Description of SPECK and LEA</strong></h2>

    <h4 id="sec-20" class="text-lg font-semibold mt-6"><strong>A.1 Parameters of SPECK</strong></h4>

    <p class="text-gray-300"><strong>Table 4.</strong> The SPECK parameters.</p>

    <div class="overflow-x-auto my-4">
      <table class="min-w-full text-sm text-gray-300">
        <thead>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">Block Size</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">Key Size</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">Word Size</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">Key Words</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">Rounds</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">α</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">β</th>
        </thead>
        <tbody>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">2n</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">mn</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">n</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">m</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">T</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">32</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">64</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">16</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">4</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">22</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">7</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">2</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">48</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">72</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">24</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">3</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">22</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">8</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">3</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">96</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">4</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">23</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">8</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">3</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">64</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">96</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">32</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">3</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">26</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">8</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">3</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">128</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">4</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">27</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">8</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">3</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">96</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">96</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">48</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">2</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">28</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">8</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">3</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">144</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">3</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">29</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">8</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">3</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">128</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">128</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">64</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">2</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">32</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">8</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">3</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">192</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">3</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">33</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">8</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">3</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">256</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">4</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">34</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">8</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">3</td>
          </tr>
        </tbody>
      </table>
    </div>

    <h4 id="sec-21" class="text-lg font-semibold mt-6">A.2 Key Schedules of LEA-192 and LEA-256</h4>

    <p class="text-gray-300"><strong>Key schedule of LEA-192</strong> Let  <span class="math">K = (k_0, k_1, k_2, k_3, k_4, k_5)</span>  be a 192-bit key. We set  <span class="math">t_i^0 = k_i</span>  for  <span class="math">0 \\le i &lt; 6</span> . For round  <span class="math">i, 0 \\le i &lt; 28</span> ,  <span class="math">rk^i</span>  is produced through following relations:</p>

    <p class="text-gray-300"><span class="math">$\\begin{split} t_0^{i+1} &amp;\\leftarrow (t_0^i \\boxplus (\\delta^i \\lll i)) \\lll 1, \\\\ t_1^{i+1} &amp;\\leftarrow (t_1^i \\boxplus (\\delta^i \\lll i+1)) \\lll 3, \\\\ t_2^{i+1} &amp;\\leftarrow (t_2^i \\boxplus (\\delta^i \\lll i+2)) \\lll 6, \\\\ t_3^{i+1} &amp;\\leftarrow (t_3^i \\boxplus (\\delta^i \\lll i+3)) \\lll 11, \\\\ t_4^{i+1} &amp;\\leftarrow (t_4^i \\boxplus (\\delta^i \\lll i+3)) \\lll 13, \\\\ t_5^{i+1} &amp;\\leftarrow (t_5^i \\boxplus (\\delta^i \\lll i+5)) \\lll 17, \\\\ rk^i &amp;\\leftarrow (t_0^{i+1}, t_1^{i+1}, t_2^{i+1}, t_3^{i+1}, t_4^{i+1}, t_5^{i+1}). \\end{split}</span>$</p>

    <p class="text-gray-300">where  <span class="math">\\delta^i</span>  is the constant for round i.</p>

    <p class="text-gray-300"><strong>Key schedule of LEA-256</strong> Let  <span class="math">K = (k_0, k_1, k_2, k_3, k_4, k_5, k_6, k_7)</span>  be a 192-bit key. We set  <span class="math">t_i^0 = k_i</span>  for  <span class="math">0 \\le i &lt; 8</span> . For round  <span class="math">i, 0 \\le i &lt; 32</span> ,  <span class="math">rk^i</span>  is produced through following relations:</p>

    <pre><code class="language-text">t_{6i \\bmod 8} \\leftarrow (t_{6i \\bmod 8} \\boxplus (\\delta^{i} \\ll i)) \\ll 1,
t_{6i+1 \\bmod 8} \\leftarrow (t_{6i+1 \\bmod 8} \\boxplus (\\delta^{i} \\ll i+1)) \\ll 3,
t_{6i+2 \\bmod 8} \\leftarrow (t_{6i+2 \\bmod 8} \\boxplus (\\delta^{i} \\ll i+2)) \\ll 6,
t_{6i+3 \\bmod 8} \\leftarrow (t_{6i+3 \\bmod 8} \\boxplus (\\delta^{i} \\ll i+3)) \\ll 11,
t_{6i+4 \\bmod 8} \\leftarrow (t_{6i+4 \\bmod 8} \\boxplus (\\delta^{i} \\ll i+4)) \\ll 13,
t_{6i+5 \\bmod 8} \\leftarrow (t_{6i+5 \\bmod 8} \\boxplus (\\delta^{i} \\ll i+5)) \\ll 17,
rk^{i} \\leftarrow (t_{6i \\bmod 8}, t_{6i+11 \\bmod 8}, t_{6i+2 \\bmod 8}, t_{6i+3 \\bmod 8}, t_{6i+4 \\bmod 8}, t_{6i+5 \\bmod 8}).
</code></pre>

    <p class="text-gray-300">where  <span class="math">\\delta^i</span>  is the constant for round i.</p>

    <h2 id="sec-22" class="text-2xl font-bold">B Dinur's Enumeration Technique for Key Recovery Attack against SPECK</h2>

    <p class="text-gray-300">In this section, we review Itai's key recovery attack against SPECK and refer the reader to [9] for a complete description.</p>

    <h4 id="sec-23" class="text-lg font-semibold mt-6">B.1 The Full Differential Attack</h4>

    <p class="text-gray-300">Counting techniques are common in key recovery of differential cryptanalysis, while in the differential cryptanalysis of SPECK, Itai increased the number of rounds attacked by the application of enumeration techniques in the key recovery [9]. Instead of extracting partial key material from outer rounds of the cipher</p>

    <p class="text-gray-300">using statistical analysis, the enumeration technique tries all suggestions for the full key proposed by a sub-cipher attack.</p>

    <p class="text-gray-300">To describe the details of Itai's attack on SPECK with enumeration technique, we first consider the case that m=2, i.e. the master key contains 2 words. The attack of the case that m=2 can be easily extended to other cases, in which m=3 or m=4.</p>

    <p class="text-gray-300">Given an r-round differential of the cipher  <span class="math">(\\Delta x_0, \\Delta y_0) \\to (\\Delta x_r, \\Delta y_r)</span>  with high probability p, the (r+2)-round attack is proceeded as follow.</p>

    <ul class="list-disc list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li><ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li>Request the encryption of  <span class="math">p^{-1}</span>  plaintext pairs P and  <span class="math">P&#x27; = P \\oplus (\\Delta x_0, \\Delta y_0)</span>  and denote the corresponding ciphertexts by C and C', respectively.</li>
    </ol></li>
      <li><ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li>For each plaintext pair P and P':</li>
    </ol>

    <ul class="list-disc list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li>(a) Execute the 2-round attack (Section 7 of [9]) using  <span class="math">(\\Delta x_r, \\Delta y_r)</span> , C and C' and get suggestions for  <span class="math">k_{r+1}</span>  and  <span class="math">k_r</span> .</li>
      <li>(b) For each returned value of  <span class="math">k_{r+1}</span>  and  <span class="math">k_r</span> , reverse the key schedule to obtain the master key. Test the master key using additional encryptions. Return the master key if it passes the test.</li>
    </ul></li>
    </ul>

    <p class="text-gray-300">The above attack requires  <span class="math">2 \\cdot p^{-1}</span>  chosen plaintexts. Since in the key recovery, the 2-round attack has an average time complexity less than 2 encryptions, the total time complexity of the attack is  <span class="math">2 \\cdot p^{-1}</span> . As Itai pointed out in [9], the memory complexity is  <span class="math">2^{22}</span>  bytes, i.e. only a few megabytes. In next subsection, we describe the 2-round attack.</p>

    <p class="text-gray-300">For m &gt; 2 (m = 3 or m = 4), by guessing the last m - 2 round key(s), the attack can cover r + m rounds with data complexity of  <span class="math">2 \\cdot p^{-1}</span>  plaintexts and time complexity of  <span class="math">2 \\cdot p^{-1} \\cdot 2^{(m-2)n}</span>  encryptions.</p>

    <h4 id="sec-24" class="text-lg font-semibold mt-6">B.2 The 2-Round Attack</h4>

    <p class="text-gray-300">As described in Section B.1, for a 2-round attack we have a known input difference  <span class="math">(\\Delta x_r, \\Delta y_y)</span>  and two ciphertexts  <span class="math">(x_{r+2}, y_{r+2})</span>  and  <span class="math">(x_{r+2} \\oplus \\Delta x_{r+2}, y_{r+2} \\oplus \\Delta y_{r+2})</span> . The 2-round attack is to enumerate all the possible round keys  <span class="math">k_r</span>  and  <span class="math">k_{r+1}</span>  under which after the 2-round decryption the difference of the two ciphertexts is equal to  <span class="math">(\\Delta x_r, \\Delta y_y)</span> .</p>

    <p class="text-gray-300">Since  <span class="math">\\Delta y_{r+1} = (\\Delta x_{r+2} \\oplus \\Delta y_{r+2}) \\gg \\beta</span>  and  <span class="math">\\Delta x_{r+1} = \\Delta y_{r+1} \\oplus (\\Delta y_r \\ll \\beta)</span>  can be calculated immediately according known variables, all the differences in the 2-round scheme are determined. Similarly, the value  <span class="math">y_{r+1}</span>  can be calculated from the known ciphertexts, whereas  <span class="math">(x_r, y_r)</span>  and  <span class="math">x_{r+1}</span>  remain unknown. Further, deriving  <span class="math">k_r</span>  and  <span class="math">k_{r+1}</span>  is equivalent to deriving  <span class="math">x_r</span>  and  <span class="math">x_{r+1}</span> , because  <span class="math">k_{r+1} = (y_{r+1} \\boxplus (x_{r+1} \\gg \\alpha)) \\oplus x_{r+1}</span>  and as  <span class="math">y_r = (x_{r+1} \\oplus y_{r+1}) \\gg \\beta</span> , then  <span class="math">k_r = (y_r \\boxplus (x_r \\gg \\alpha)) \\oplus x_{r+1}</span>  can be computed as well. Thus, the key point is to deriving the values  <span class="math">x_r</span>  and  <span class="math">x_{r+1}</span> .</p>

    <p class="text-gray-300">For convenience, we omit the right circular shift  <span class="math">\\gg \\alpha</span> , and then we have two differential equations of addition</p>

    <p class="text-gray-300"><span class="math">$(x_r \\oplus \\Delta x_r) \\boxplus (y_r \\oplus \\Delta y_r) = (x_r \\boxplus y_r) \\oplus \\Delta x_{r+1},</span>$
<span class="math">$(x_{r+1} \\oplus \\Delta x_{r+1}) \\boxplus (y_{r+1} \\oplus \\Delta y_{r+1}) = (x_{r+1} \\boxplus y_{r+1}) \\oplus \\Delta x_{r+2}.</span>$</p>

    <p class="text-gray-300">where all differences are known, and in the second equation <em>yr</em>+1 and <em>yr</em>+1 <em>⊕ ∆yr</em>+1 are also known.</p>

    <p class="text-gray-300">This type of differential equations of addition has an average of 1 solution. However, for almost any value of (<em>∆xr, ∆yr</em>), a large part of ciphertext pairs lead to no solutions. Therefore, to save the time, a filtering process is needed before solving these two equations.</p>

    <p class="text-gray-300">Again, the property of addition explained by Equation (1) and Equation (2) are used as filters, which means checking whether the equation holds given all differences of the 2-round scheme. Using the filter, the complexity of the 2-round attacked can be optimized to less than 2 encryptions, which was verified by a lots of experiments on SPECK in [9].</p>

    <h2 id="sec-25" class="text-2xl font-bold"><strong>C Differential Characteristics of SPECK and LEA</strong></h2>

    <div class="overflow-x-auto my-4">
      <table class="min-w-full text-sm text-gray-300">
        <thead>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">r</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">SPECK32</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"></th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">SPECK48</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"></th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">SPECK64</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"></th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"></th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"></th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"></th>
        </thead>
        <tbody>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">∆x</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">∆y</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">log2&lt;br&gt;p</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">∆x</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">∆y</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">log2&lt;br&gt;p</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">∆x</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">∆y</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">log2&lt;br&gt;p</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">0</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">2040 0040</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">504200 004240</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">04092400 20040104</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">8000 8100</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-1</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">001202 020002</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-5</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">20000820 20200001</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-6</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">2</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">8000 8402</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-1</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">000010 100000</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-3</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">00000009 01000000</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-4</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">3</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">8D02 9D08</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-4</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">000000 800000</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-1</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">08000000 00000000</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-2</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">4</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">6002 1420</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-9</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">800000 800004</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">0</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">00080000 00080000</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-1</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">5</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1060 40E0</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-5</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">808004 808020</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-2</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">00080800 00480800</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-2</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">6</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">0380 0001</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-6</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">8400A0 8001A4</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-4</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">00480008 02084008</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-4</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">7</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">0004 0000</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-3</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">608DA4 608080</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-9</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">06080808 164A0848</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-7</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">8</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">0800 0800</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-1</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">042003 002400</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-11</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">F2400040 40104200</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-13</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">9</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">0810 2810</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-2</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">012020 000020</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-5</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">00820200 00001202</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-8</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">10</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">0800 A840</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-3</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">200100 200000</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-3</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">00009000 00000010</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-4</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">11</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">202001 202000</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-3</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">00000080 00000000</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-2</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">12</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">80000000 80000000</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">0</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">13</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">80800000 80800004</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-1</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">14</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">80008004 84008020</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-3</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">15</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">808080A0 A08481A4</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-5</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Σr log2&lt;br&gt;pr</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-35</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-46</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-62</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">log2&lt;br&gt;pdiff &gt;</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-31.99</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-44.31</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-60.56</td>
          </tr>
        </tbody>
      </table>
    </div>

    <p class="text-gray-300"><strong>Table 5.</strong> Differential characteristics for SPECK32, SPECK48 and SPECK64.</p>

    <h3 id="sec-26" class="text-xl font-semibold mt-8"><strong>D Source Code</strong></h3>

    <p class="text-gray-300">Copy the Python code below, and generate the Yices file for the 9-round problem of SPECK32. The Yices problems of other versions can be generated easily by changing the word size and the number of rounds. Solve the Yices problem with Yices or use –logic=QF BV of Yices to export the corresponding CNF file and then find all solutions with CryptoMiniSAT using option –maxsol.</p>

    <p class="text-gray-300"><strong>Table 6.</strong> Differential characteristics for SPECK96 and SPECK128.</p>

    <div class="overflow-x-auto my-4">
      <table class="min-w-full text-sm text-gray-300">
        <thead>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">r</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">SPECK96</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"></th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">SPECK128</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"></th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"></th>
        </thead>
        <tbody>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">∆x&lt;br&gt;∆y</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">log2&lt;br&gt;p</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">∆x&lt;br&gt;∆y</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">log2&lt;br&gt;p</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">0</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">240004000009 010420040000</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">0124000400000000 0801042004000000</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">082020000000 000120200000</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-6</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">0800202000000000 4808012020000000</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-6</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">2</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">000900000000 000001000000</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-4</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">4800010000000000 0840080100000002</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-6</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">3</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">000008000000 000000000000</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-2</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">0808080000000006 4A08480800000016</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-7</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">4</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">000000080000 000000080000</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-1</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">4000400000000032 1042004000000080</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-12</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">5</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">000000080800 000000480800</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-2</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">0202000000000080 8012020000000480</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-7</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">6</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">000000480008 000002084008</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-4</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">0010000000000480 0080100000002084</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-5</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">7</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">0800FE080808 0800EE4A0848</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-12</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">8080000000006080 84808000000164A0</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-6</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">8</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">000772400040 400000104200</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-21</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">0400000000032400 2004000000080104</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-11</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">9</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">000000820200 000000001202</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-11</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">2000000000080020 2020000000480801</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-7</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">10</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">000000009000 000000000010</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-4</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">0000000000480001 0100000002084008</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-6</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">11</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">000000000080 000000000000</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-2</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">000000000E080808 080000001E4A0848</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-8</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">12</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">800000000000 800000000000</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">0</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">00000000F2400040 4000000000104200</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-15</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">13</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">808000000000 808000000004</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-1</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">0000000000820200 0000000000001202</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-8</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">14</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">800080000004 840080000020</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-3</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">0000000000009000 0000000000000010</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-4</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">15</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">808080800020 A08480800124</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-5</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">0000000000000080 0000000000000000</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-2</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">16</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">800400008124 842004008801</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-9</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">8000000000000000 8000000000000000</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">0</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">17</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">A0A000008880 81A02004C88C</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-9</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">8080000000000000 8080000000000004</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-1</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">18</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">8000800000000004 8400800000000020</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-3</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">19</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">8080808000000020 A084808000000124</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-5</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">20</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">8004000080000124 8420040080000801</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-9</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Σr log2&lt;br&gt;pr</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-96</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-128</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">log2&lt;br&gt;pdiff &gt;</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-94.94</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-124.35</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
        </tbody>
      </table>
    </div>

    <p class="text-gray-300"><strong>Table 7.</strong> Differential characteristics for LEA.</p>

    <div class="overflow-x-auto my-4">
      <table class="min-w-full text-sm text-gray-300">
        <thead>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">r</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">12-round</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"></th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">13-round</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"></th>
        </thead>
        <tbody>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">∆x0 ∥ ∆x1 ∥ ∆x2 ∥ ∆x3</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">log2 p</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">∆x0 ∥ ∆x1 ∥ ∆x2 ∥ ∆x3</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">log2 p</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">0</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">104010800A0010800204120800049228</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">00049018400490000002800110220041</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">80000014404020140040100410401080</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-20</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">104010800A0010800204100800049018</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-20</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">2</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">80400080860000808200001080000014</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-16</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">800000144040200C0040100410401080</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-20</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">3</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">8000000C8040000C8040000480400080</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-14</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">80400080860000808200001080000014</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-18</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">4</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">8000000080000000800000108000000C</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-10</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">8000000C8040000C8040000480400080</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-14</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">5</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">00000000800000008000000080000000</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-4</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">8000000080000000800000108000000C</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-10</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">6</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">00000100000000000000000000000000</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">0</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">00000000800000008000000080000000</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-4</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">7</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">00020000000000000000000000000100</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-1</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">00000100000000000000000000000000</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-0</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">8</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">04000000000000000000002000020000</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-2</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">00020000000000000000000000000100</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-1</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">9</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">00000008000000070000400404000000</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-6</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">04000000000000000000002000020000</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-2</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">10</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">00000200080002008080080000000008</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-11</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">00000008000000070000400404000000</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-6</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">11</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">00000010044400501010010100000200</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-9</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">00000200080002008080080000000008</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-11</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">12</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">8800800888A2A00A2202006000000010</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-19</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">00000010044400501010010100000200</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-9</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">13</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">8800800888A2A00A2202006000000010</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">19</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Σr log2 pr</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-112</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-134</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">log2 pdiff &gt;</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-103.19</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-123.79</td>
          </tr>
        </tbody>
      </table>
    </div>

    <pre><code class="language-text">Rnds = 9
bound = 30 # bound for the weight
ws = 16 # word size
alpha = 7 # 8 for word size &gt; 16
beta = 2 # 3 for word size &gt; 16
zero = &#x27;zero&#x27;
f = open(&#x27;speck&#x27; + str(Rnds) + &#x27;.ys&#x27;, &#x27;w&#x27;)
\\begin{array}{cccccccccccccccccccccccccccccccccccc
\\begin{array}{llllllllllllllllllllllllllllllllllll
def shift1(v0):
    return &#x27;(bv-shift-left0 &#x27;+v0+&#x27; 1)&#x27;
def add(v0, x0, x3):
    negv0 = &#x27;(bv-not &#x27;+shift1(v0)+&#x27;)&#x27;
    eq = &#x27;(bv-and (bv-xor &#x27;+negv0+&#x27; &#x27;+shift1(x0)+&#x27;) (bv-xor &#x27;+negv0+&#x27; &#x27;+shift1(x3)

\\begin{array}{llllllllllllllllllllllllllllllllllll
def weight (p0):
              s=[]
for i in range(ws-1):

 \\begin{array}{llllllllllllllllllllllllllllllllllll
f.write(&#x27;; intermediate variables\\n&#x27;)
vAfterRt = [&#x27;v&#x27; + str(i) for i in range(Rnds)]
for i in range(Rnds):

f.write(&#x27;; penalty variables\\n&#x27;)
pen = [&#x27;p&#x27; + str(i) for i in range(Rnds)]
for i in range(Rnds):

f.write(&#x27;; weight of the characteristic\\n&#x27;) f.write(&#x27;(define weight:: (bitvector 11))\\n\\n&#x27;) f.write(&#x27;(assert (= zero (mk-bv &#x27;+str(ws)+&#x27; 0)))\\n&#x27;)
for i in range(Rnds):
    f.write( rotr(states[2*i+1], vAfterRt[i], alpha))
    f.write(add(vAfterRt[i], states[2*i], states[2*i+3]))
    f.write( rotl(states[2*i], states[2*i+3], states[2*i+2], beta))
    f.write(penalty(vAfterRt[i], states[2*i], states[2*i+3], pen[i]))
#f.write(&#x27;; No all?zero characteristic :\\n&#x27;)
f.write(&#x27;(assert (/= (bv-or &#x27;+states[0]+&#x27; &#x27;+ states[1] +&#x27;) &#x27;+zero+&#x27;))\\n&#x27;)
sumW = []
for i in range(Rnds):
    sumW += weight(pen[i])
f.write(&#x27;(assert (= weight (bv-add &#x27;+ &#x27; &#x27;.join(sumW)+&#x27;)))\\n&#x27;)
f.write(&#x27;; fix the input and output differences \\n&#x27;)
f.write(&#x27;(assert (= x0 (mk-bv 16 &#x27;+str(int(0x4900 ))+&#x27;)))\\n&#x27;)
f.write(&#x27;(assert (= x1 (mk-bv 16 &#x27;+str(int(0x8054 ))+&#x27;)))\\n&#x27;)
f.write(&#x27;(assert (= x&#x27;+str(2*Rnds )+&#x27; (mk-bv 16 &#x27;+str(int(0x0542 ))+&#x27;)))\\n&#x27;)
f.write(&#x27;(assert (= x&#x27;+str(2*Rnds+1)+&#x27; (mk-bv 16 &#x27;+str(int(0x0040 ))+&#x27;)))\\n&#x27;)
f.write(&#x27;(assert (bv-le weight (mk-bv 11 &#x27;+ str(bound)+&#x27;)))\\n&#x27;)
f.write(&#x27;(check)\\n&#x27;)
f.write(&#x27;(show-model)\\n&#x27;)
f.write(&#x27;(export-to-dimacs &quot;test.cnf&quot;)&#x27;)
</code></pre>

`;
---

<BaseLayout title="**Automatic Differential Analysis of ARX Block Ciphers with ... (2016/209)">
  <article class="max-w-4xl mx-auto article-prose">
    <nav class="mb-8">
      <a href="/papers" class="text-blue-400 hover:text-blue-300">
        &larr; Back to Papers
      </a>
    </nav>

    <header class="mb-12">
      <h1 class="text-3xl font-bold mb-4"
        set:html={TITLE_HTML} />
      <p class="text-gray-400 mb-2"
        set:html={AUTHORS_HTML} />
      <p class="text-gray-500 text-sm mb-4">
        2016 &middot; eprint 2016/209
      </p>
      <div class="flex gap-4 text-sm">
        <a
          href={EPRINT_URL}
          target="_blank"
          rel="noopener noreferrer"
          class="text-blue-400 hover:text-blue-300"
        >
          Paper (eprint) &rarr;
        </a>
      </div>
      <PaperDisclaimer eprintUrl={EPRINT_URL} />
      <p class="mt-1 text-xs text-gray-600">
        Converted with: {CRAWLER} &middot; {CONVERTED_DATE}
      </p>
    </header>

    <Fragment set:html={CONTENT} />

    <PaperHistory slug="automatic-differential-analysis-of-arx-block-ciphers-with-2016" />
  </article>
</BaseLayout>
