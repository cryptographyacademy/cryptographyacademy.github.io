---
import BaseLayout from '../../layouts/BaseLayout.astro';

const EPRINT_URL = 'https://eprint.iacr.org/2014/747';
const CRAWLER = 'mistral';
const CONVERTED_DATE = '2026-02-16';
const TITLE_HTML = 'Towards Finding the Best Characteristics of Some Bit-oriented Block Ciphers and Automatic Enumeration of (Related-key) Differential and Linear Characteristics with Predefined Properties';
const AUTHORS_HTML = 'Siwei Sun, Lei Hu, Meiqin Wang, Peng Wang, Kexin Qiao, Xiaoshuang Ma, Danping Shi, Ling Song, Kai Fu';

const CONTENT = `    <p class="text-gray-300">Towards Finding the Best Characteristics of Some Bit-oriented Block Ciphers and Automatic Enumeration of (Related-key) Differential and Linear Characteristics with Predefined Properties</p>

    <p class="text-gray-300">Siwei Sun^{1,2}, Lei Hu^{1,2}, Meiqin Wang^{3}, Peng Wang^{1,2}, Kexin Qiao^{1,2}, Xiaoshuang Ma^{1,2}, Danping Shi^{1,2}, Ling Song^{1,2}, Kai Fu^{3}</p>

    <p class="text-gray-300">^{1}State Key Laboratory of Information Security, Institute of Information Engineering, Chinese Academy of Sciences, Beijing 100093, China ^{2}Data Assurance and Communication Security Research Center, Chinese Academy of Sciences, Beijing 100093, China ^{3}Key Laboratory of Cryptologic Technology and Information Security, Ministry of Education, Shandong University, Jinan 250100, China {sunsiwei,hulei}@iie.ac.cn, mqwang@sdu.edu.cn, {wpeng,qiaokexin,maxiaoshuang,shidanping,songling}@iie.ac.cn</p>

    <p class="text-gray-300">Abstract. In this paper, we investigate the Mixed-integer Linear Programming (MILP) modelling of the differential and linear behavior of a wide range of block ciphers. We point out that the differential behavior of an arbitrary S-box can be exactly described by a small system of linear inequalities.</p>

    <p class="text-gray-300">Based on this observation and MILP technique, we propose an automatic method for finding high probability (related-key) differential or linear characteristics of block ciphers. Compared with Sun et al.’s heuristic method presented in Asiacrypt 2014, the new method is exact for most ciphers in the sense that every feasible 0-1 solution of the MILP model generated by the new method corresponds to a valid characteristic, and therefore there is no need to repeatedly add valid cutting-off inequalities into the MILP model as is done in Sun et al.’s method; the new method is more powerful which allows us to get the exact lower bounds of the number of differentially or linearly active S-boxes; and the new method is more efficient which allows to obtain characteristic with higher probability or covering more rounds of a cipher (sometimes with less computational effort).</p>

    <p class="text-gray-300">Further, by encoding the probability information of the differentials of an S-boxes into its differential patterns, we present a novel MILP modelling technique which can be used to search for the characteristics with the maximal probability, rather than the characteristics with the smallest number of active S-boxes. With this technique, we are able to get tighter security bounds and find better characteristics.</p>

    <p class="text-gray-300">Moreover, by employing a type of specially constructed linear inequalities which can remove exactly one feasible 0-1 solution from the feasible region of an MILP problem, we propose a method for automatic enumeration of all (related-key) differential or linear characteristics with some predefined properties, e.g., characteristics with given input or/and output difference/mask, or with a limited number of active S-boxes. Such a method is very useful in the automatic (related-key) differential analysis, truncated (related-key) differential analysis, linear hull analysis, and the automatic construction of (related-key) boomerang/rectangle distinguishers.</p>

    <p class="text-gray-300">The methods presented in this paper are very simple and straightforward, based on which we implement a Python framework for automatic cryptanalysis, and extensive experiments are performed using this framework. To demonstrate the usefulness of these methods, we apply them to SIMON, PRESENT, Serpent, LBlock, DESL, and we obtain some improved cryptanalytic results.</p>

    <p class="text-gray-300">Keywords: Automatic cryptanalysis, Related-key differential cryptanalysis, Linear cryptanalysis, Mixed-integer Linear Programming, Convex hull, Enumeration</p>

    <h2 id="sec-1" class="text-2xl font-bold">1 Introduction</h2>

    <p class="text-gray-300">Differential cryptanalysis <em>[1]</em> and linear cryptanalysis <em>[2]</em> are two of the most powerful attacks on modern symmetric-key ciphers. Based on differential and linear cryptanalysis, lots of techniques have been developed for analyzing the security of block ciphers, such as the related-key differential attack <em>[3, 4, 5]</em>, truncated differential attack <em>[6]</em>, statistical saturation attack <em>[7]</em> (it has been shown in <em>[8]</em> that a statistical saturation attack is the same as a truncated differential attack), (probabilistic) higher order differential attack <em>[6, 9]</em>, impossible differential attack <em>[10, 11]</em>, boomerang attack <em>[12]</em>, multiple differential attack <em>[13, 14, 15, 16]</em>, differential-linear cryptanalysis <em>[17]</em>, multiple linear attack <em>[18, 19, 20, 21, 22]</em> and so on so forth. To a large extent, providing a security</p>

    <p class="text-gray-300">evaluation with respect to the differential and linear attacks has become a basic requirement for a newly designed block cipher to be accepted by the cryptographic community.</p>

    <p class="text-gray-300">Matsui’s branch and bound search algorithm <em>[23]</em> is one of the most powerful and classic methods for obtaining a security bound with respect to differential and linear attack. However, in some cases this method is impractical. Calculating the minimum number of active S-boxes is another way to evaluate the resistance of a block cipher against the differential and linear attack <em>[24, 25, 26, 27, 28, 29]</em>. Searching for differential and linear characteristics is not only performed in basic differential and linear attacks, but also is indispensable in some new cryptanalytic techniques such as the rebound attack <em>[30]</em> and the sieve-in-the-middle technique <em>[31]</em>. Moreover, some new technique for cryptanalysis (e.g., the biclique attack <em>[32]</em>) and some symmetric-key cryptographic schemes which can be designed based on block ciphers (e.g., the authenticated encryption schemes) make the related-key model more important and highly relevant to the design and cryptanalysis of symmetric-key primitives. Therefore, methods which can be used to evaluate the security of a block cipher with respect to the (related-key) differential and linear attacks, and search for (related-key) differential or linear characteristics are of great importance. In fact, this direction of research has got much attention from many cryptanalysts <em>[23, 33, 34, 35, 36, 37, 38]</em>.</p>

    <p class="text-gray-300">Mouha et al. <em>[39]</em> and Wu et al. <em>[40]</em> translated the problem of counting the minimum number of differentially active S-boxes, into an MILP problem which can be solved automatically with open source or commercially available MILP solvers. This method has been applied in evaluating the security against (related-key) differential attacks of many word-oriented symmetric schemes, as well as in searching for linear or differential characteristics with specific patterns <em>[41, 42]</em>. By introducing bit-level representations, Winnen et al. <em>[43]</em> and Sun et al. <em>[44]</em> extended Mouha et al.’s framework, and presented methods for counting the minimum number of differentially active S-boxes of bit-oriented block ciphers both in the single-key and related-key models. We notice that such MILP based methods are also mentioned or used in the recent analysis and design of several authenticated encryption schemes <em>[45, 46, 42, 47, 48, 49, 50, 25]</em>.</p>

    <p class="text-gray-300">In Asiacrypt 2014, two systematic methods for generating linear inequalities describing the differential properties of an arbitrary S-box were given in <em>[51]</em>. With these inequalities, the authors of <em>[51]</em> were able to construct an MILP model whose feasible region is a more accurate description of the differential behavior of a given cipher. Based on such MILP models, the authors of <em>[51]</em> proposed a heuristic algorithm for finding (related-key) differential characteristics, which is applicable to a wide range of block ciphers. However, some important problems have not been solved yet in <em>[51]</em>. For example, is it possible to construct an MILP model whose feasible region of all 0-1 solutions is exactly the set of all possible (related-key) differential or linear characteristics? Is it possible to find the characteristics with the maximal probability instead of characteristics with the minimal number of active S-boxes by an MILP technique? Can we extract all characteristics with some predefined properties (e.g., characteristics with given input or/and output difference/mask, or with a limited number of active S-boxes)? In this work, we make a first step towards solving these problems.</p>

    <h4 id="sec-2" class="text-lg font-semibold mt-6">Our contribution.</h4>

    <p class="text-gray-300">In this work, we investigate the MILP modelling of the differential and linear behavior of a wide range of block ciphers. We point out that the convex hull description presented in Sun et al.’s work <em>[51]</em> is exact for any set <span class="math">P\\subseteq\\{0,1\\}^{n}\\subseteq\\mathbb{R}^{n}</span> (which can be seen as the set of all differential or linear patterns of an operation) according to a fact which have been known since at least 1972 <em>[52]</em>: for any <span class="math">x\\in\\{0,1\\}^{n}</span>, <span class="math">x</span> is in the convex hull of <span class="math">P</span> if and only if <span class="math">x\\in P</span>. This fact has some important implications. Firstly, we now know that there is no need to use the inequalities generated by the method based on logical condition modelling presented in <em>[51]</em> since the inequalities generated by the method based on convex hull computation are already enough. Secondly, Sun et al.’s heuristic method for finding (related-key) differential (or linear) characteristics can be transformed into an exact algorithm (for most ciphers) by adding all the linear inequalities in the H-representation of the convex hull, since by doing this, the feasible region of the MILP problem is exactly the set of all possible (related-key) differential (or linear) characteristics.</p>

    <p class="text-gray-300">However, as already pointed in <em>[51]</em>, there are so many inequalities in the H-representation of the convex hull and adding all of them to the MILP problem will make it insolvable in practical time. To overcome this obstacle, we select only a small number of inequalities from the convex hull such that the feasible region of the</p>

    <p class="text-gray-300">resulting MILP problem is still the set of all possible (related-key) differential or linear characteristics, and this is accomplished by a minor modification of Sun et al.’s greedy algorithm <em>[51]</em> for selecting inequalities from the convex hull. Eventually, we are able to build an exact and practical algorithm for finding (related-key) differential and linear characteristics.</p>

    <p class="text-gray-300">Further, by encoding the probability information of an <span class="math">4\\times 4</span> S-box into its differential patterns, we present an MILP based method which can be used to find the differential characteristic with the maximal probability instead of minimal active S-boxes for block ciphers with <span class="math">4\\times 4</span> S-boxes.</p>

    <p class="text-gray-300">Moreover, based on a type of specially constructed inequalities which can remove exactly one 0-1 solution from the feasible region of an MILP problem, we present a method for enumerating all the (related-key) differential and linear characteristics with some predefined properties, which is very useful differential- and linear-type cryptanalysis, such as the analysis of differential and linear hull effect.</p>

    <p class="text-gray-300">Based on the methods presented in this paper, we develop a Python <em>[54]</em> based framework for automatic (related-key) differential and linear (hull) analysis, automatic truncated (related-key) differential analysis, and automatic construction of boomerang distinguishers. Using this framework, we obtain the following results:</p>

    <ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">

      <li>We get the exact lower bounds of the number of differentially active S-boxes for some round-reduced versions of LBlock, and we prove that the probability of any related-key differential characteristic for the full LBlock is upper bounded by <span class="math">2^{-68}</span>, which is the tightest security bound so far for the cipher LBlock. Moreover, the computational cost used to derive this bound is significantly reduced than that of <em>[51]</em>.</li>

      <li>We automatically prove that there is no single-key differential characteristic for Serpent <em>[55]</em> (one of the AES finalist) with probability higher than <span class="math">2^{-128}</span> in no more than 73 minutes on a PC. Note that obtaining this bound is a very difficult task at the time of the AES selection process. We also show that this bound can be further improved by using the MILP technique for finding the characteristic with the maximal probability presented in Sect. 5.</li>

      <li>For the 8-round DESL, we find a related-key differential characteristic with probability <span class="math">2^{-33.45}</span> on a PC in no more than 4 minutes. Note that the best previously published related-key characteristic (whose probability is <span class="math">2^{-34.78}</span>) for the 8-round DESL was found on a PC using roughly 10 minutes. In addition, we automatically find a truncated related-key differential with probability <span class="math">2^{-34.06}</span> for the 9-round DESL on a PC using no more than 28 minutes. Moreover, we find a 4-round differential characteristic with probability <span class="math">2^{-40}</span> covering 4 rounds (using S-boxes: <span class="math">S_{5},S_{6},S_{7},S_{0}</span>) of Serpent. While the best characteristic covering this 4 rounds of Serpent published previously is given in <em>[56]</em>, whose probability is <span class="math">2^{-47}</span>.</li>

      <li>We find a 16-round standard (non truncated) related-key differential with probability <span class="math">2^{-55.64}</span>, which is even better than the best truncated related-key differential published previously for the 16-round LBlock whose probability is about <span class="math">2^{-59}</span> <em>[57]</em>. To the best of our knowledge, this is the best (related-key) differential for LBlock published so far, and this is the first concrete result demonstrating the related-key differential effect.</li>

      <li>We present a single-key differential covering 16 rounds of SIMON48 whose probability is at least <span class="math">2^{-44.65}</span>, and a single-key differential covering 22 rounds of SIMON64 whose probability is at least <span class="math">2^{-62.21}</span>. To the best of our knowledge, there are no published single-key differentials covering more than 15 rounds of SIMON48 and 21 rounds of SIMON64. These differentials can be used to produce the best known attacks on SIMON48 and SIMON64 with the technique presented in <em>[58]</em>.</li>

      <li>We present a linear characteristic for the 55-round SIMON128 which covering more rounds and with higher bias than the 52-round linear characteristic given in <em>[59]</em>. We also present a 16-round linear hull with potential <span class="math">2^{-44.92}</span> for SIMON48 leading to an attack on 23-round SIMON48. To the best of our knowledge, this is so far the best attack on SIMON48.</li>

      <li>We improve the currently best known related-key boomerang distinguishers for the 14-round PRESENT-128 and the 16-round LBlock.</li>

    </ol>

    <p class="text-gray-300">We would like to emphasis that the specific result is not the focus of this paper, and we believe that there always exists a dedicated method for a specific cipher which can produce better results than ours. Instead, the focus is the methodology, which is simple, straight-forward and automatic. Moreover, the results presented in this paper probably can be further improved by taking more computational effort. We have set up a web site at http://siweisun.github.io/ where we present some MILP models such that anyone can solve them and try to produce better results. Besides, this method has some limitations which will be discussed in Sect. 7, and if we have any progress on dealing with the limitations, we will present the new findings to the web site as soon as possible. This site also contains some other applications of the method. For example, based on Zhao et. al.’s work <em>[60]</em>, in <em>[61]</em> our tool produces the currently best single-key differential attack on the block cipher PRIDE <em>[62]</em>, and more new results concerning the linear analysis of SIMON are presented in <em>[63]</em>.</p>

    <p class="text-gray-300">##</p>

    <p class="text-gray-300">Organization. We start with a brief introduction of Sun et al.’s method <em>[44, 51]</em> for automatic differential cryptanalysis of bit-oriented block ciphers in Sect. 2. Then, in Sect. 3, we investigate the problem of describing an arbitrary subset of <span class="math">\\{0,1\\}^{n}\\subseteq\\mathbb{R}^{n}</span> with linear inequalities, and present some theorems which are of fundamental importance for the remaining work of this paper. In Sect. 4, a method for constructing an MILP model whose feasible region is exactly the set of all (related-key) differential or linear characteristics is proposed with its application in obtaining exact lower bound of the number of active S-boxes, and searching for (related-key) differential or linear characteristics. We show how to search for the best characteristic of ciphers with <span class="math">4\\times 4</span> S-boxes in Sect. 5. Based on the work of Sect. 4 and a type of specially constructed inequality, we present a method for automatic enumeration of (related-key) differential or linear characteristics with some predefined properties in Sect. 6, which is applicable in the automatic (related-key) differential and linear (hull) analysis, automatic truncated (related-key) differential analysis, and the automatic construction of boomerang/rectangle distinguishers. In Sect.7, we discuss the limitations of our methods. Sect. 8 is the conclusion.</p>

    <h2 id="sec-3" class="text-2xl font-bold">2 Automatic (Related-key) Differential and Linear Analysis of Bit-oriented Block Ciphers</h2>

    <p class="text-gray-300">In this section, we give a brief introduction of Sun et al.’s method which can be used to search for (related-key) differential characteristics and obtain security bounds of a cipher with respect to the (related-key) differential attack automatically. We refer the reader to <em>[44, 51]</em> for more information. In addition, the same method can be used in automatic linear analysis, and we present it in Appendix A.</p>

    <p class="text-gray-300">Sun et al.’s method <em>[51]</em> is an extension of Mouha et al.’s technique <em>[39]</em> which describes the differential behavior of a cipher by an MILP problem, and it is applicable to block ciphers involving bitwise XOR, bitwise permutation <span class="math">L</span> which permutes the bit positions of a <span class="math">n</span> dimensional vector in <span class="math">\\mathbb{F}_{2}^{n}</span>, and S-box operation <span class="math">\\mathcal{S}:\\mathbb{F}_{2}^{n}\\to\\mathbb{F}_{2}^{n}</span>.</p>

    <p class="text-gray-300">Theoretically, Sun et al.’s method is also applicable to ciphers containing general linear transformation <span class="math">T:\\mathbb{F}_{2}^{n}\\to\\mathbb{F}_{2}^{m}</span>, since <span class="math">T</span> can be converted into some XOR summations of different bits. However, such operation will introduce a large number of variables and constraints into the MILP problem and make it very difficult to be solved in practical time.</p>

    <p class="text-gray-300">For every input and output bit-level differences, introduce a new 0-1 variable <span class="math">x_{i}</span> to denote whether this bit has a nonzero difference or not:</p>

    <p class="text-gray-300">\\[ x_{i}=\\left\\{\\begin{array}[]{ll}1,&\\text{for nonzero difference at this bit,}\\\\ 0,&\\text{otherwise.}\\end{array}\\right. \\]</p>

    <p class="text-gray-300">Also, for every S-box in the schematic diagram of the cipher under consideration, including the encryption process and the key schedule algorithm, introduce a new 0-1 variable <span class="math">A_{j}</span> such that</p>

    <p class="text-gray-300">\\[ A_{j}=\\left\\{\\begin{array}[]{ll}1,&\\text{if the input word of the Sbox is nonzero,}\\\\ 0,&\\text{otherwise.}\\end{array}\\right. \\]</p>

    <p class="text-gray-300">Here we say that <span class="math">A_{j}</span> indicates the activity of an S-box, or an S-box is marked by <span class="math">A_{j}</span>.</p>

    <p class="text-gray-300">Now, we are ready to describe Sun et al.’s method by clarifying the objective function and constraints in the MILP model. Note that we assume that all variables involved are 0-1 variables.</p>

    <p class="text-gray-300">Objective Function. The objective function is to minimize the sum of all variables indicating the activities of the S-boxes appearing in the schematic description of the encryption and key schedule algorithm of a cipher: <span class="math">\\sum_{j}A_{j}</span>.</p>

    <p class="text-gray-300">Constraints. Firstly, for every XOR operation with bit-level input differences <span class="math">a,b</span> and bit-level output difference <span class="math">c</span>, include the following constraints</p>

    <p class="text-gray-300">\\[ \\left\\{\\begin{array}[]{ll}d_{\\oplus}\\geq a,~{}d_{\\oplus}\\geq b,~{}d_{\\oplus}\\geq c\\\\ a+b+c\\geq 2d_{\\oplus}\\\\ a+b+c\\leq 2\\end{array}\\right. \\] (1)</p>

    <p class="text-gray-300">where <span class="math">d_{\\oplus}</span> is a dummy variable.</p>

    <p class="text-gray-300">Assuming <span class="math">(x_{i_{0}},\\cdots,x_{i_{\\omega-1}})</span> and <span class="math">(y_{i_{0}},\\cdots,y_{i_{\\nu-1}})</span> are the input and output differences of an <span class="math">\\omega\\times\\nu</span> S-box marked by <span class="math">A_{t}</span>, we have</p>

    <p class="text-gray-300">\\[ \\left\\{&A_{t}-x_{i_{k}}\\geq 0,\\ k\\in\\{0,\\ldots,\\omega-1\\}\\\\ &-A_{t}+\\sum_{j=0}^{\\omega-1}x_{i_{j}}\\geq 0\\right. \\] (2)</p>

    <p class="text-gray-300">which ensures that nonzero input difference must activate the S-box. Moreover, the Hamming weight of the <span class="math">(\\omega+\\nu)</span>-bit word <span class="math">x_{i_{0}}\\cdots x_{i_{\\omega-1}}y_{j_{0}}\\cdots y_{j_{\\nu-1}}</span> must be greater than or equal to the branch number <span class="math">\\mathcal{B}_{\\mathcal{S}}</span> of the S-box for nonzero input difference <span class="math">x_{i_{0}}\\cdots x_{i_{\\omega-1}}</span>:</p>

    <p class="text-gray-300">\\[ \\left\\{&\\sum_{k=0}^{\\omega-1}x_{i_{k}}+\\sum_{k=0}^{\\nu-1}y_{j_{k}}\\geq\\mathcal{B}_{\\mathcal{S}}d_{\\mathcal{S}}\\\\ &d_{\\mathcal{S}}\\geq x_{i_{k}},\\ \\ 0\\leq k\\leq\\omega-1\\\\ &d_{\\mathcal{S}}\\geq y_{j_{k}},\\ \\ 0\\leq k\\leq\\nu-1\\right. \\] (3)</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">where <span class="math">d_{\\mathcal{S}}</span> is a dummy variable, and the branch number <span class="math">\\mathcal{B}_{\\mathcal{S}}</span> of an S-box <span class="math">\\mathcal{S}</span>, is defined as $\\min_{a\\neq b}\\{\\mathrm{wt}((a\\oplus b)</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">(\\mathcal{S}(a)\\oplus\\mathcal{S}(b)):a,b\\in\\mathbb{F}_{2}^{\\omega}\\}<span class="math"> and </span>\\mathrm{wt}(\\cdot)<span class="math"> is the standard Hamming weight of a </span>(\\omega+\\nu)$-bit word.</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">For an bijective S-box we have</p>

    <p class="text-gray-300">\\[ \\left\\{&\\omega\\sum_{k=0}^{\\nu-1}y_{j_{k}}-\\sum_{k=0}^{\\omega-1}x_{i_{k}}\\geq 0\\\\ &\\nu\\sum_{k=0}^{\\omega-1}x_{i_{k}}-\\sum_{k=0}^{\\nu-1}y_{j_{k}}\\geq 0\\right. \\] (4)</p>

    <p class="text-gray-300">since nonzero input difference must result in nonzero output difference and vice versa. Note that for an S-box with branch number <span class="math">\\mathcal{B}_{\\mathcal{S}}=2</span>, the constraints presented in (3) are redundant <em>[51]</em>.</p>

    <p class="text-gray-300">To describe the differential properties of an S-box more accurately, Sun et al. proposed two systematic ways for generating valid cutting-off inequalities <em>[51]</em> which are used to remove some impossible differential patterns of the S-box from the feasible region of the MILP problem:</p>

    <p class="text-gray-300">Logical Condition Modelling. Borrowing the idea from general MILP modelling technique for logical conditions, Sun et al. showed that some conditional differential properties of an S-box can be described by linear inequalities. For example, the least significant bit of the output difference of the PRESENT S-box is always 0 if the input difference is 1001. This conditional differential property is equivalent to the following constraint</p>

    <p class="text-gray-300"><span class="math">-x_{0}+x_{1}+x_{2}-x_{3}-y_{3}+2\\geq 0</span></p>

    <p class="text-gray-300">where <span class="math">x_{i}</span>, <span class="math">y_{i}\\in\\{0,1\\}\\subseteq\\mathbb{R}</span>, and <span class="math">(x_{0},\\cdots,x_{3})</span> and <span class="math">(y_{0},\\cdots,y_{3})</span> are the input and output difference respectively. This fact can be easily verified by enumerating all possible 0-1 assignments of the variables <span class="math">x_{i}</span> and <span class="math">y_{i}</span>.</p>

    <p class="text-gray-300">Convex Hull Computation. A convex hull of a finite set <span class="math">P</span> of points is the smallest convex set that contains <span class="math">P</span>. Sun et al. treat every possible input-output differential pattern <span class="math">(x_{0},\\cdots,x_{\\omega-1})\\rightarrow(y_{0},\\cdots,y_{\\nu-1})</span> of an <span class="math">\\omega\\times\\nu</span> S-box as an <span class="math">(\\omega+\\nu)</span>-dimensional vector <span class="math">(x_{0},\\cdots,x_{\\omega-1},y_{0},\\cdots,y_{\\nu-1})\\in\\{0,1\\}^{\\omega+\\nu}\\subseteq\\mathbb{R}^{\\omega+\\nu}</span>. By computing the H-Representation of the convex hull of all possible input-output differential patterns of an S-box, many linear inequalities which can be used to remove some impossible differential patterns of the S-box are obtained. Moreover, a greedy algorithm is developed for selecting a small number of inequalities from the H-representation of the convex hull.</p>

    <p class="text-gray-300">Finally, we note that Sun et al.’s method <em>[51]</em> is also applicable in automatic linear cryptanalysis, and the MILP modelling process is given in Appendix A.</p>

    <h2 id="sec-4" class="text-2xl font-bold">3 Describing Subsets of <span class="math">\\{0,1\\}^{n}\\subseteq\\mathbb{R}^{n}</span> with Linear Inequalities</h2>

    <p class="text-gray-300">In this section, we start by thoroughly investigating the problem of describing an arbitrary set <span class="math">P\\subseteq\\{0,1\\}^{n}\\subseteq\\mathbb{R}^{n}</span> with linear inequalities, which eventually leads us to the construction of MILP models whose feasible regions are exactly the sets of all (related-key) differential (or linear) characteristics for a wide range of ciphers.</p>

    <p class="text-gray-300">Firstly, we introduce some notations for the convenience of discussion. Let <span class="math">\\mathcal{L}=\\{l_{0},\\ldots,l_{m-1}\\}</span> be a system of linear inequalities of the form <span class="math">l_{i}:\\ \\sum_{j=0}^{n-1}\\lambda_{ij}x_{j}+\\beta_{i}\\geq 0,0\\leq i\\leq m-1</span>. Then, we use <span class="math">Sol(\\mathcal{L})</span> to denote the set of all solutions of <span class="math">\\mathcal{L}</span> in <span class="math">\\mathbb{R}^{n}</span>. In addition, <span class="math">Sol(\\mathcal{L})\\cap A</span> is represented by <span class="math">Sol_{A}(\\mathcal{L})</span>, where <span class="math">A</span> is a subset of <span class="math">\\mathbb{R}^{n}</span>. Under these notations, <span class="math">Sol_{\\mathbb{B}^{n}}(\\mathcal{L})=Sol(\\mathcal{L})\\cap\\mathbb{B}^{n}</span> is the set of all 0-1 solutions of <span class="math">\\mathcal{L}</span>, where <span class="math">\\mathbb{B}=\\{0,1\\}\\subseteq\\mathbb{R}</span>.</p>

    <p class="text-gray-300">###</p>

    <p class="text-gray-300">Moreover, we use <span class="math">Cut_{\\mathbb{B}^n}(l_i) = Cut_{\\mathbb{B}^n}(\\sum_{j=0}^{n-1} \\lambda_{ij} x_j + \\beta_i \\geq 0)</span> to denote the set of all 0-1 vectors in <span class="math">\\mathbb{R}^n</span> which are not satisfied by <span class="math">l_i</span>. That is, <span class="math">Cut_{\\mathbb{B}^n}(l_i) = \\mathbb{B}^n - Sol_{\\mathbb{B}^n}(\\{l_i\\})</span>. Also, we use <span class="math">Cut_{\\mathbb{B}^n}(\\mathcal{L})</span> to represent the set <span class="math">\\cup_{l_i \\in \\mathcal{L}} Cut_{\\mathbb{B}^n}(l_i)</span>. According to this notation, we have <span class="math">Cut_{\\mathbb{B}^n}(\\mathcal{L}) = \\mathbb{B}^n - Sol_{\\mathbb{B}^n}(\\mathcal{L})</span>.</p>

    <p class="text-gray-300"><strong>Definition 1.</strong> A set <span class="math">C \\subseteq \\mathbb{R}^n</span> is said to be convex if, for all <span class="math">x, y \\in C</span> and all <span class="math">t \\in [0,1]</span>, the point <span class="math">(1 - t)x + ty</span> also belongs to <span class="math">C</span>.</p>

    <p class="text-gray-300"><strong>Definition 2.</strong> The smallest convex set that contains <span class="math">P \\subseteq \\mathbb{R}^n</span> is said to be the convex hull of <span class="math">P</span>, and is denoted by <span class="math">\\operatorname{conv}(P)</span>.</p>

    <p class="text-gray-300"><strong>Lemma 1.</strong> The set of all solutions of the following system of (in)equalities</p>

    <div class="my-4 text-center"><span class="math-block">\\left\\{ \\begin{array}{l} \\lambda_{0,0} x_0 + \\cdots + \\lambda_{0,n-1} x_{n-1} + \\lambda_{0,n} \\geq 0 \\\\ \\cdots \\\\ \\gamma_{0,0} x_0 + \\cdots + \\gamma_{0,n-1} x_{n-1} + \\gamma_{0,n} = 0 \\\\ \\cdots \\end{array} \\right. \\tag{5}</span></div>

    <p class="text-gray-300">is convex, where <span class="math">\\lambda_{i,j}</span> and <span class="math">\\gamma_{i,j}</span> are fixed real numbers. For any subset <span class="math">X \\subseteq \\mathbb{R}^n</span> with finitely many discrete points, there exists a system <span class="math">\\mathcal{H}_{\\mathrm{conv}(X)}</span> of linear inequalities of the form of (5), such that <span class="math">Sol(\\mathcal{H}_{\\mathrm{conv}(X)}) = \\mathrm{conv}(X)</span>, and we call <span class="math">\\mathcal{H}_{\\mathrm{conv}(X)}</span> the <span class="math">H</span>-representation of <span class="math">\\mathrm{conv}(X)</span>.</p>

    <p class="text-gray-300">The above definitions and lemma are well known in computational geometry, and for a given set <span class="math">P \\subseteq \\mathbb{R}^n</span> of finitely many points, there are algorithms which can compute the H-representation of <span class="math">\\mathrm{conv}(P)</span> [64–67].</p>

    <p class="text-gray-300"><strong>Lemma 2.</strong> For a given 0-1 vector <span class="math">\\delta = (\\delta_0, \\delta_1, \\dots, \\delta_{n-1}) \\in \\{0,1\\}^n \\subseteq \\mathbb{R}^n</span>, <span class="math">Cut_{\\mathbb{B}^n}(\\sum_{i=0}^{n-1} [\\delta_i + (-1)^{\\delta_i} x_i] \\geq 1) = \\{(\\delta_0, \\delta_1, \\dots, \\delta_{n-1})\\}</span>.</p>

    <p class="text-gray-300"><strong>Proof.</strong> Without loss of generality, we assume</p>

    <div class="my-4 text-center"><span class="math-block">\\delta = (\\delta_0, \\dots, \\delta_{n-1}) = (\\delta_0, \\dots, \\delta_{s-1}; \\delta_s, \\dots, \\delta_{n-1}) = (1, \\dots, 1; 0, 0, \\dots, 0).</span></div>

    <p class="text-gray-300">For other 0-1 pattern, it can be permuted into such a form and this will not affect our proof.</p>

    <p class="text-gray-300">Firstly, substituting <span class="math">x_i</span> by <span class="math">\\delta_i</span>, we have</p>

    <div class="my-4 text-center"><span class="math-block">\\sum_{i=0}^{n-1} [\\delta_i + (-1)^{\\delta_i} x_i] = \\sum_{i=0}^{s_1-1} \\delta_i + \\sum_{i=0}^{s_1-1} (-1)^{\\delta_i} \\delta_i = 0 &amp;lt; 1.</span></div>

    <p class="text-gray-300">That is, <span class="math">\\delta</span> is not satisfied by <span class="math">\\sum_{i=0}^{n-1} [\\delta_i + (-1)^{\\delta_i} x_i] \\geq 1</span>.</p>

    <p class="text-gray-300">Secondly, for <span class="math">\\delta&#x27; = (\\delta_0&#x27;, \\ldots, \\delta_{n-1}&#x27;) \\neq \\delta</span>, substituting <span class="math">x_i</span> by <span class="math">\\delta_i&#x27;</span>, we have</p>

    <div class="my-4 text-center"><span class="math-block">\\sum_{i=0}^{n-1} [\\delta_i + (-1)^{\\delta_i} x_i] = \\sum_{i=0}^{s_1-1} \\delta_i + \\sum_{i=0}^{n-1} (-1)^{\\delta_i} \\delta_i&#x27; \\geq s_1 - s_1 + 1 = 1.</span></div>

    <p class="text-gray-300">That is, all vectors other than <span class="math">\\delta</span> are satisfied by <span class="math">\\sum_{i=0}^{n-1} [\\delta_i + (-1)^{\\delta_i} x_i] \\geq 1</span>.</p>

    <p class="text-gray-300">The proof is completed.</p>

    <p class="text-gray-300">Below, we use <span class="math">l^{(\\delta_0,\\delta_1,\\dots,\\delta_{n-1})}</span> or <span class="math">l^{(\\delta)}</span> to denote the linear inequality <span class="math">\\sum_{i=0}^{n-1} [\\delta_i + (-1)^{\\delta_i} x_i] \\geq 1</span>. Therefore, we have <span class="math">Cut_{\\mathbb{B}^n}(l^{(\\delta)}) = Cut_{\\mathbb{B}^n}(l^{(\\delta_0,\\dots,\\delta_{n-1})}) = \\{\\delta\\} = \\{(\\delta_0, \\dots, \\delta_{n-1})\\}</span>.</p>

    <p class="text-gray-300">That is, <span class="math">l^{(\\delta)}</span> can be used to remove exactly one 0-1 vector. This kind of inequalities plays a significant role in our algorithm for enumerating (related-key) differential (or linear) characteristics, and is useful for proving the following theorem. Recently, some researchers inform us that the following theorem has already been proved by Egon Balas et al. [52] in 1972 (Although they are different in appearance, they are the same in essential). Hence, this theorem should be attributed to Egon Balas et al. Still, we would like to provide our proof for the sake of completeness.</p>

    <p class="text-gray-300"><strong>Theorem 1.</strong> Assume <span class="math">x \\in \\{0,1\\}^n</span> and let <span class="math">\\operatorname{conv}(X)</span> be the convex hull of <span class="math">X \\subseteq \\{0,1\\}^n \\subseteq \\mathbb{R}^n</span>. Then <span class="math">x \\in \\operatorname{conv}(X)</span> if and only if <span class="math">x \\in X</span>.</p>

    <p class="text-gray-300">Proof. Since <span class="math">\\mathrm{conv}(X)</span> is the convex hull of <span class="math">X</span> which is the smallest convex set containing <span class="math">X</span>, we have <span class="math">x\\in\\mathrm{conv}(X)</span> for every <span class="math">x\\in X</span>.</p>

    <p class="text-gray-300">Then, we prove that <span class="math">y\\in X</span> for every 0-1 vector <span class="math">y\\in\\mathrm{conv}(X)</span> by contradiction. If this is not the case, then there exists a 0-1 vector <span class="math">y^{<em>}\\in\\mathrm{conv}(X)</span>, such that <span class="math">y^{</em>}\\notin X</span>. Consider the set of linear inequalities <span class="math">\\mathcal{L}=\\mathcal{H}_{\\mathrm{conv}(X)}\\cup\\{l^{(y^{*})}\\}</span>, where <span class="math">\\mathcal{H}_{\\mathrm{conv}(X)}</span> is the H-representation of <span class="math">\\mathrm{conv}(X)</span>.</p>

    <p class="text-gray-300">On the one hand, We have <span class="math">Cut_{\\mathbb{B}^{n}}(\\mathcal{L})=Cut_{\\mathbb{B}^{n}}(\\mathcal{H}_{\\mathrm{conv}(X)})\\cup\\{y^{<em>}\\}</span> according to the definition of <span class="math">l^{(y^{</em>})}</span> and Lemma 2. Hence, <span class="math">Sol_{\\mathbb{B}^{n}}(\\mathcal{L})=\\mathbb{B}^{n}-Cut_{\\mathbb{B}^{n}}(\\mathcal{L})=\\mathbb{B}^{n}-Cut_{\\mathbb{B}^{n}}(\\mathcal{H}_{\\mathrm{conv}(X)})-\\{y^{<em>}\\}=Sol_{\\mathbb{B}^{n}}(\\mathcal{H}_{\\mathrm{conv}(X)})-\\{y^{</em>}\\}=\\mathrm{conv}(X)\\cap\\mathbb{B}^{n}-\\{y^{*}\\}</span>, from which we can deduce that <span class="math">Sol_{\\mathbb{B}^{n}}(\\mathcal{L})\\subsetneqq\\mathrm{conv}(X)\\cap\\mathbb{B}^{n}</span>.</p>

    <p class="text-gray-300">On the other hand, <span class="math">\\mathrm{conv}(X)\\subseteq Sol(\\mathcal{L})</span> since <span class="math">Sol(\\mathcal{L})</span> is a convex set containing <span class="math">X</span> and <span class="math">\\mathrm{conv}(X)</span> is the smallest convex set containing <span class="math">X</span>. Consequently, <span class="math">\\mathrm{conv}(X)\\cap\\mathbb{B}^{n}\\subseteq Sol_{\\mathbb{B}^{n}}(\\mathcal{L})</span>, which is a contradiction. The proof is completed.</p>

    <h2 id="sec-5" class="text-2xl font-bold">4 MILP Models with Feasible Regions Equal to the Sets of All (Related-key) Differential (or Linear) Characteristics and Its Applications</h2>

    <h3 id="sec-6" class="text-xl font-semibold mt-8">4.1 Model Construction</h3>

    <p class="text-gray-300">The key idea behind Sun et al.’s work <em>[44]</em> on automatic differential cryptanalysis for bit-oriented block ciphers is to construct an MILP model whose feasible region contains the set of all differential characteristics of the cipher under consideration. Such a model is constructed in <em>[44]</em> by introducing 0-1 variables for every bit-level input and output differences of every operation involved in the cipher, and modelling the constraints on differential propagation imposed by every operation as a system of linear inequalities. For block ciphers involving XOR, bit permutation, and S-boxes, the modelling technique presented in <em>[44]</em> leads to MILP models whose feasible region are much larger than the sets of all valid (related-key) differential characteristics of the cipher under consideration, since the linear inequalities used in these MILP models are far from being perfect to rule out all invalid (related-key) differential characteristics of a cipher.</p>

    <p class="text-gray-300">Subsequently, Sun et al. <em>[51]</em> introduce the concept of valid cutting-off inequalities which can be used to remove some impossible differential patterns from the feasible region, and they design a heuristic algorithm for finding (related-key) differential characteristics. This algorithm tries to extract a differential characteristic with a small number of active S-boxes from the feasible region of the MILP model which may contain invalid characteristics, and the extracted solution is not guaranteed to be a valid characteristic. Therefore, the algorithm needs to repeatedly add valid cutting-off inequalities to the MILP model to make the feasible region more restrictive until the extracted solution pass the check that it is indeed a valid characteristic.</p>

    <p class="text-gray-300">In the following, we show that we can construct MILP models whose feasible region are exactly the sets of all valid (related-key) differential characteristics for a wide range of block ciphers by using the convex hull computation approach.</p>

    <p class="text-gray-300">For linear analysis, by using a similar method, we can construct MILP models whose feasible regions are exactly the set of all linear characteristics, and the method is presented in Appendix A.</p>

    <h6 id="sec-7" class="text-base font-medium mt-4">Definition 3.</h6>

    <p class="text-gray-300">Let <span class="math">\\mathcal{L}</span> be a set of linear inequalities and <span class="math">X\\subseteq\\{0,1\\}^{n}\\subseteq\\mathbb{R}^{n}</span>. We say <span class="math">\\mathcal{L}</span> is a linear-inequality description of <span class="math">X</span> if <span class="math">X\\subseteq Sol_{\\mathbb{B}^{n}}(\\mathcal{L})</span>, and we say the description is exact for <span class="math">X</span> if <span class="math">Sol_{\\mathbb{B}^{n}}(\\mathcal{L})=X</span>.</p>

    <p class="text-gray-300">In order to construct an MILP model whose feasible region is exactly the set of all (related-key) differential characteristics of a given cipher, we must use constraints that are exact linear-inequality descriptions of the differential behavior for all operations involved in the cipher.</p>

    <p class="text-gray-300">For block ciphers involving bit permutations, XOR operations, and S-boxes, the S-box operations are the most difficult parts since we already have exact descriptions for bit permutations and XOR operations (see Sect. 2). Next, we show how to deal with the S-box parts.</p>

    <h6 id="sec-8" class="text-base font-medium mt-4">Definition 4.</h6>

    <p class="text-gray-300">Let <span class="math">S</span> be an arbitrary <span class="math">\\omega\\times\\nu</span> S-box such that <span class="math">(b_{0},\\ldots,b_{\\nu-1})=S(a_{0},\\ldots,a_{\\omega-1})</span>. The differential set <span class="math">\\mathcal{D}_{S}</span> of <span class="math">S</span> is defined to be the set of all differential patterns of <span class="math">S</span>. That is, <span class="math">\\mathcal{D}_{S}=\\{(x_{0},\\ldots,x_{\\omega-1},y_{0},\\ldots,y_{\\nu-1})\\in\\mathbb{B}^{\\omega+\\nu}:\\Pr_{S}[(x_{0},\\ldots,x_{\\omega-1})\\to(y_{0},\\ldots,y_{\\nu-1})]&gt;0\\}</span>, where <span class="math">\\Pr_{S}[(x_{0},\\ldots,x_{\\omega-1})\\to(y_{0},\\ldots,y_{\\nu-1})]</span> is the probability associated with the differential <span class="math">(x_{0},\\ldots,x_{\\omega-1})\\to(y_{0},\\ldots,y_{\\nu-1})</span> across the S-box operation.</p>

    <p class="text-gray-300">Note that <span class="math">\\mathcal{D}_{S}</span> can be built directly from the differential distribution table of <span class="math">S</span></p>

    <p class="text-gray-300">Fact 1. Let  <span class="math">S</span>  be an arbitrary  <span class="math">\\omega \\times \\nu</span>  S-box, and  <span class="math">\\mathcal{D}_S \\subseteq \\{0,1\\}^{\\omega + \\nu}</span>  be the set of all differential patterns with probability greater than 0. Then  <span class="math">\\mathcal{H}_{\\mathrm{conv}(\\mathcal{D}_S)}</span>  is an exact linear-inequality description of  <span class="math">\\mathcal{D}_S</span> , where  <span class="math">\\mathcal{H}_{\\mathrm{conv}(\\mathcal{D}_S)}</span>  is the  <span class="math">H</span> -representation of  <span class="math">\\mathrm{conv}(\\mathcal{D}_S)</span> .</p>

    <p class="text-gray-300">Proof. Assuming  <span class="math">x \\in \\{0,1\\}^n</span> , then  <span class="math">x \\in \\mathrm{conv}(\\mathcal{D}_S)</span>  if and only if  <span class="math">x \\in \\mathcal{D}_S</span>  according to Theorem 1. Therefore,  <span class="math">\\mathrm{conv}(\\mathcal{D}_S) \\cap \\mathbb{B}^n = Sol_{\\mathbb{B}^n}(\\mathcal{H}_{\\mathrm{conv}(\\mathcal{D}_S)}) = \\mathcal{D}_S</span> . Hence,  <span class="math">\\mathcal{H}_{\\mathrm{conv}(\\mathcal{D}_S)}</span>  is an exact description of  <span class="math">\\mathcal{D}_S</span> . The proof is completed.</p>

    <p class="text-gray-300">According to Fact 1, we can build an MILP model whose feasible region is exactly the set of all (related-key) differential characteristics for a given cipher by following the modelling process introduced in Sect. 2 and adding all the linear inequalities in the H-representations of the convex hulls of all S-boxes involved into the MILP model.</p>

    <p class="text-gray-300">However, as already pointed out in [51], there are too many inequalities in the H-representation, and MILP models with a large number of constraints are very difficult to solve. Therefore, we need to construct MILP models with less constraints while the sets of all 0-1 solutions of these models are still the sets of all valid (related-key) differential or linear characteristics.</p>

    <p class="text-gray-300">Definition 5. Let  <span class="math">\\mathcal{L}</span>  be a system of linear inequalities of the following form</p>

    <div class="my-4 text-center"><span class="math-block">\\left\\{ \\begin{array}{l} \\lambda_ {0, 0} x _ {0} + \\dots + \\lambda_ {0, n - 1} x _ {n - 1} + \\lambda_ {0, n} \\geq 0 \\\\ \\dots \\\\ \\gamma_ {0, 0} x _ {0} + \\dots + \\gamma_ {0, n - 1} x _ {n - 1} + \\gamma_ {0, n} = 0 \\\\ \\dots \\end{array} \\right.</span></div>

    <p class="text-gray-300">Then, a set  <span class="math">\\mathcal{L}^<em> \\subseteq \\mathcal{L}</span>  is said to be cutting-off equivalent to  <span class="math">\\mathcal{L}</span>  if  <span class="math">Cut_{\\mathbb{B}^n}(\\mathcal{L}^</em>) = Cut_{\\mathbb{B}^n}(\\mathcal{L})</span> .</p>

    <p class="text-gray-300">In order to reduce the number of inequalities in the MILP model, we give the following algorithm which can be used to select a subset of  <span class="math">\\mathcal{H}_{\\mathrm{conv}(\\mathcal{D}_S)}</span>  with less inequalities that is cutting-off equivalent to  <span class="math">\\mathcal{H}_{\\mathrm{conv}(\\mathcal{D}_S)}</span> .</p>

    <p class="text-gray-300">Algorithm 1: Select a system of inequalities from  <span class="math">\\mathcal{H}_{\\mathrm{conv}(\\mathcal{D}_S)}</span> Input:  <span class="math">\\mathcal{H}_{\\mathrm{conv}(\\mathcal{D}_S)}</span>  : the set of all inequalities in the H-representation of the convex hull of an S-box  <span class="math">S</span>  Output:  <span class="math">\\mathcal{O}_S</span>  : A set of inequalities selected from  <span class="math">\\mathcal{H}_{\\mathrm{conv}(\\mathcal{D}_S)}</span>  which is cutting-off equivalent to  <span class="math">\\mathcal{H}_{\\mathrm{conv}(\\mathcal{D}_S)}</span> 1  <span class="math">l^{<em>} := \\text{None};</span> 2  <span class="math">\\mathcal{X} :=</span>  the set of all impossible differential patterns of an S-box; 3  <span class="math">\\mathcal{X}^{</em>} := \\mathcal{X}</span> ; 4  <span class="math">\\mathcal{H}^{<em>} := \\mathcal{H}_{\\mathrm{conv}(\\mathcal{D}_S)}</span> ; 5  <span class="math">\\mathcal{O}_S := \\emptyset</span> ; 6 while True do 7  <span class="math">l^{</em>} :=</span>  The inequality in  <span class="math">\\mathcal{H}^{<em>}</span>  which maximizes the number of removed impossible differential patterns from  <span class="math">\\mathcal{X}^{</em>}</span> ; 8  <span class="math">\\mathcal{X}^{<em>} := \\mathcal{X}^{</em>} - Cut_{\\mathbb{B}^n}(\\{l^<em>\\})</span> ; 9  <span class="math">\\mathcal{H}^{</em>} := \\mathcal{H}^{<em>} - \\{l^{</em>}\\}</span> ; 10  <span class="math">\\mathcal{O}_S := \\mathcal{O}_S \\cup \\{l^{<em>}\\}</span> ; 11 if  <span class="math">\\mathcal{X}^{</em>} = \\emptyset</span>  then 12 return  <span class="math">\\mathcal{O}_S</span>  and Terminate 13 end 14 end</p>

    <p class="text-gray-300">Algorithm 1 builds up a set  <span class="math">\\mathcal{O}_S</span>  of valid cutting-off inequalities by selecting at each step an inequality from  <span class="math">\\mathcal{H}_{\\mathrm{conv}(\\mathcal{D}_S)}</span>  until there is no inequality in  <span class="math">\\mathcal{H}_{\\mathrm{conv}(\\mathcal{D}_S)} - \\mathcal{O}_S</span>  which can remove an impossible differential pattern of  <span class="math">S</span>  which satisfies all inequalities already in  <span class="math">\\mathcal{O}_S</span> .</p>

    <p class="text-gray-300">Therefore, we have  <span class="math">Cut_{\\mathbb{B}^n}(\\mathcal{O}_S) = Cut_{\\mathbb{B}^n}(\\mathcal{H}_{\\mathrm{conv}(\\mathcal{D}_S)})</span> . That is,  <span class="math">\\mathcal{O}_S</span>  is cutting-off equivalent to  <span class="math">\\mathcal{H}_{\\mathrm{conv}(\\mathcal{D}_S)}</span> . Consequently, we can include  <span class="math">\\mathcal{O}_S</span> , instead of  <span class="math">\\mathcal{H}_{\\mathrm{conv}(\\mathcal{D}_S)}</span> , as the constraints imposed by the differential properties of  <span class="math">S</span> , and the resulting MILP model will be easier to solve if the number of inequalities in  <span class="math">\\mathcal{O}_S</span>  is much smaller than that of  <span class="math">\\mathcal{H}_{\\mathrm{conv}(\\mathcal{D}_S)}</span> .</p>

    <p class="text-gray-300">Definition 6. We call the set  <span class="math">\\mathcal{O}_S</span>  of inequalities produced by algorithm 1 for an  <span class="math">S</span> -box  <span class="math">S</span>  a critical set of  <span class="math">\\mathcal{H}_{\\mathrm{conv}(\\mathcal{D}_S)}</span> .</p>

    <p class="text-gray-300">We have computed the critical sets for some typical  <span class="math">4 \\times 4</span>  S-boxes, and the results show that the number of inequalities in  <span class="math">\\mathcal{O}_S</span>  is indeed much smaller than that of  <span class="math">\\mathcal{H}_{\\mathrm{conv}(\\mathcal{D}_S)}</span>  (see Table 1).</p>

    <p class="text-gray-300">Table 1: Numbers of inequalities in  <span class="math">\\mathcal{O}_S</span>  and  <span class="math">\\mathcal{H}_{\\mathrm{conv}(\\mathcal{D}_S)}</span>  for typical  <span class="math">4\\times 4</span>  S-boxes.</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">S-box</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">#OS</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">#Hconv(DS)</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">S-box</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">#OS</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">#Hconv(DS)</th>

          </tr>

        </thead>

        <tbody>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">Klein [68]</td>

            <td class="px-3 py-2 border-b border-gray-700">22</td>

            <td class="px-3 py-2 border-b border-gray-700">311</td>

            <td class="px-3 py-2 border-b border-gray-700">LBlock S6</td>

            <td class="px-3 py-2 border-b border-gray-700">27</td>

            <td class="px-3 py-2 border-b border-gray-700">205</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">Piccolo [69]</td>

            <td class="px-3 py-2 border-b border-gray-700">23</td>

            <td class="px-3 py-2 border-b border-gray-700">202</td>

            <td class="px-3 py-2 border-b border-gray-700">LBlock S7</td>

            <td class="px-3 py-2 border-b border-gray-700">27</td>

            <td class="px-3 py-2 border-b border-gray-700">205</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">TWINE [70]</td>

            <td class="px-3 py-2 border-b border-gray-700">23</td>

            <td class="px-3 py-2 border-b border-gray-700">324</td>

            <td class="px-3 py-2 border-b border-gray-700">LBlock S8</td>

            <td class="px-3 py-2 border-b border-gray-700">28</td>

            <td class="px-3 py-2 border-b border-gray-700">205</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">PRINCE [27, 28]</td>

            <td class="px-3 py-2 border-b border-gray-700">26</td>

            <td class="px-3 py-2 border-b border-gray-700">300</td>

            <td class="px-3 py-2 border-b border-gray-700">LBlock S9</td>

            <td class="px-3 py-2 border-b border-gray-700">27</td>

            <td class="px-3 py-2 border-b border-gray-700">205</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">MIBS [71]</td>

            <td class="px-3 py-2 border-b border-gray-700">27</td>

            <td class="px-3 py-2 border-b border-gray-700">378</td>

            <td class="px-3 py-2 border-b border-gray-700">Serpent S0 [55]</td>

            <td class="px-3 py-2 border-b border-gray-700">23</td>

            <td class="px-3 py-2 border-b border-gray-700">327</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">PRESENT/LED [24, 72]</td>

            <td class="px-3 py-2 border-b border-gray-700">22</td>

            <td class="px-3 py-2 border-b border-gray-700">327</td>

            <td class="px-3 py-2 border-b border-gray-700">Serpent S1</td>

            <td class="px-3 py-2 border-b border-gray-700">24</td>

            <td class="px-3 py-2 border-b border-gray-700">327</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">LBlock S0 [73]</td>

            <td class="px-3 py-2 border-b border-gray-700">28</td>

            <td class="px-3 py-2 border-b border-gray-700">205</td>

            <td class="px-3 py-2 border-b border-gray-700">Serpent S2</td>

            <td class="px-3 py-2 border-b border-gray-700">25</td>

            <td class="px-3 py-2 border-b border-gray-700">325</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">LBlock S1</td>

            <td class="px-3 py-2 border-b border-gray-700">27</td>

            <td class="px-3 py-2 border-b border-gray-700">205</td>

            <td class="px-3 py-2 border-b border-gray-700">Serpent S3</td>

            <td class="px-3 py-2 border-b border-gray-700">31</td>

            <td class="px-3 py-2 border-b border-gray-700">368</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">LBlock S2</td>

            <td class="px-3 py-2 border-b border-gray-700">27</td>

            <td class="px-3 py-2 border-b border-gray-700">205</td>

            <td class="px-3 py-2 border-b border-gray-700">Serpent S4</td>

            <td class="px-3 py-2 border-b border-gray-700">26</td>

            <td class="px-3 py-2 border-b border-gray-700">321</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">LBlock S3</td>

            <td class="px-3 py-2 border-b border-gray-700">27</td>

            <td class="px-3 py-2 border-b border-gray-700">205</td>

            <td class="px-3 py-2 border-b border-gray-700">Serpent S5</td>

            <td class="px-3 py-2 border-b border-gray-700">25</td>

            <td class="px-3 py-2 border-b border-gray-700">321</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">LBlock S4</td>

            <td class="px-3 py-2 border-b border-gray-700">28</td>

            <td class="px-3 py-2 border-b border-gray-700">205</td>

            <td class="px-3 py-2 border-b border-gray-700">Serpent S6</td>

            <td class="px-3 py-2 border-b border-gray-700">22</td>

            <td class="px-3 py-2 border-b border-gray-700">327</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">LBlock S5</td>

            <td class="px-3 py-2 border-b border-gray-700">27</td>

            <td class="px-3 py-2 border-b border-gray-700">205</td>

            <td class="px-3 py-2 border-b border-gray-700">Serpent S7</td>

            <td class="px-3 py-2 border-b border-gray-700">30</td>

            <td class="px-3 py-2 border-b border-gray-700">368</td>

          </tr>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">According to the above analysis, we are now able to construct MILP models whose feasible regions are exactly the sets of all (related-key) differential or linear characteristics, which leads to the following applications.</p>

    <p class="text-gray-300">Obtaining Exact Lower Bounds of the Numbers of Active S-boxes. By setting the objective function to be  <span class="math">\\sum_{j} A_{j}</span> , where  <span class="math">A_{j}</span> 's are the variables marking the activities of the involved S-boxes, we can obtain an MILP model whose optimized solution corresponds to a (related-key) differential characteristic which has the minimum number of active S-boxes, and the objective value of this solution is the exact lower bound of the number of active S-boxes.</p>

    <p class="text-gray-300">We apply the method to LBlock, and the results are listed in Table 2. From Table 2, we can see that there are at least 10 differentially active S-boxes for consecutive 10 rounds of LBlock, and 12 active S-boxes for consecutive 11 rounds of LBlock in the related-key model. Therefore, the probability of the best related-key characteristic for the 32-round LBlock is at most  <span class="math">(2^{-2})^{12 + 12 + 10} = 2^{-68}</span> . While the previously published best result concerning the security bound of LBlock in the related-key model is given in [51] stating that the probability of the best related-key characteristic for the 32-round LBlock is at most  <span class="math">2^{-60}</span> . Moreover, the bound presented in this paper is obtained on a PC in no more than 6 days, while the bound presented in [51] was obtained on a PC using more than 49 days. The main reason of the reduction of the computational effort is that we can get better bounds without considering characteristics covering more rounds, and we refer the reader to [51] for more information.</p>

    <p class="text-gray-300">Table 2: The exact lower bounds of the number of differentially active S-boxes for round-reduced variants of LBlock in the related-key model</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Rounds</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">The number of active S-boxes</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Time (in seconds)</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

          </tr>

        </thead>

        <tbody>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">This paper</td>

            <td class="px-3 py-2 border-b border-gray-700">[51]</td>

            <td class="px-3 py-2 border-b border-gray-700">This paper</td>

            <td class="px-3 py-2 border-b border-gray-700">[51]</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">5</td>

            <td class="px-3 py-2 border-b border-gray-700">1</td>

            <td class="px-3 py-2 border-b border-gray-700">1</td>

            <td class="px-3 py-2 border-b border-gray-700">3</td>

            <td class="px-3 py-2 border-b border-gray-700">2</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">6</td>

            <td class="px-3 py-2 border-b border-gray-700">2</td>

            <td class="px-3 py-2 border-b border-gray-700">2</td>

            <td class="px-3 py-2 border-b border-gray-700">35</td>

            <td class="px-3 py-2 border-b border-gray-700">12</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">7</td>

            <td class="px-3 py-2 border-b border-gray-700">4</td>

            <td class="px-3 py-2 border-b border-gray-700">3</td>

            <td class="px-3 py-2 border-b border-gray-700">70</td>

            <td class="px-3 py-2 border-b border-gray-700">38</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">8</td>

            <td class="px-3 py-2 border-b border-gray-700">6</td>

            <td class="px-3 py-2 border-b border-gray-700">5</td>

            <td class="px-3 py-2 border-b border-gray-700">271</td>

            <td class="px-3 py-2 border-b border-gray-700">128</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">9</td>

            <td class="px-3 py-2 border-b border-gray-700">8</td>

            <td class="px-3 py-2 border-b border-gray-700">6</td>

            <td class="px-3 py-2 border-b border-gray-700">11656</td>

            <td class="px-3 py-2 border-b border-gray-700">386</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">10</td>

            <td class="px-3 py-2 border-b border-gray-700">10</td>

            <td class="px-3 py-2 border-b border-gray-700">8</td>

            <td class="px-3 py-2 border-b border-gray-700">105475</td>

            <td class="px-3 py-2 border-b border-gray-700">19932</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">11</td>

            <td class="px-3 py-2 border-b border-gray-700">12</td>

            <td class="px-3 py-2 border-b border-gray-700">10</td>

            <td class="px-3 py-2 border-b border-gray-700">376235</td>

            <td class="px-3 py-2 border-b border-gray-700">43793</td>

          </tr>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">We also apply the method to Serpent (one of the AES finalists), and we automatically prove that the probability of the best single-key differential characteristic for the 27-round Serpent is upper bounded by  <span class="math">2^{-132}</span> . The detail of the result is given in Appendix B.</p>

    <p class="text-gray-300">An Exact Method for Finding (Related-key) Differential and Linear Characteristics. For a given cipher, build an MILP problem whose feasible region is exactly the set of all related-key differential or linear characteristics of the cipher. Then solve it using any MILP optimizer, e.g., Gurobi [74] or SCIP [75]. When the value of the objective function decreases to  <span class="math">N</span> , terminate the solving process and extract the current solution whose objective value is  <span class="math">N</span> . This solution corresponds to a (related-key) differential or linear characteristic with  <span class="math">N</span>  active S-boxes.</p>

    <p class="text-gray-300">Using this method, we find an 8-round related-key differential characteristic for DESL with probability  <span class="math">2^{-33.45}</span>  (see Table 3 and Table 4). This result is obtained on a PC in no more than 4 minutes. Compared with the method presented in [51], which outputs an 8-round related-key characteristic with probability  <span class="math">2^{-34.78}</span>  on a PC using roughly 10 minutes, the new method presented in this paper produces a better characteristic with less computational effort.</p>

    <p class="text-gray-300">Table 3: An 8-round related-key differential characteristic for DESL (characteristic in the encryption process)</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Rounds</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Left</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Right</th>

          </tr>

        </thead>

        <tbody>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">0</td>

            <td class="px-3 py-2 border-b border-gray-700">00010000000000000000000000000010</td>

            <td class="px-3 py-2 border-b border-gray-700">00000000000000000000010000000000</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">1</td>

            <td class="px-3 py-2 border-b border-gray-700">00000000000000000000010000000000</td>

            <td class="px-3 py-2 border-b border-gray-700">000000000000000000000000000000000000000000000000000000000000000000000</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">2</td>

            <td class="px-3 py-2 border-b border-gray-700">0000000000000000000000000000000010</td>

            <td class="px-3 py-2 border-b border-gray-700">0000000000000000000000000000001100000000000</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">3</td>

            <td class="px-3 py-2 border-b border-gray-700">0000000000000000000000110000000000</td>

            <td class="px-3 py-2 border-b border-gray-700">000000000000000000000000000000000000000000000000000000000000000000000</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">4</td>

            <td class="px-3 py-2 border-b border-gray-700">000000000000000000000000000000001010</td>

            <td class="px-3 py-2 border-b border-gray-700">00000000000000000000000000000000000000000000000000000000000000000000</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">5</td>

            <td class="px-3 py-2 border-b border-gray-700">00000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000000000</td>

            <td class="px-3 py-2 border-b border-gray-700">000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">6</td>

            <td class="px-3 py-2 border-b border-gray-700">00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000</td>

            <td class="px-3 py-2 border-b border-gray-700">000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">7</td>

            <td class="px-3 py-2 border-b border-gray-700">00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000</td>

            <td class="px-3 py-2 border-b border-gray-700">000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">8</td>

            <td class="px-3 py-2 border-b border-gray-700">000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000</td>

            <td class="px-3 py-2 border-b border-gray-700">000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000</td>

          </tr>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">Table 4: An 8-round related-key differential characteristic for DESL (characteristic in the key schedule algorithm)</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Rounds</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Differences in the Key Register</th>

          </tr>

        </thead>

        <tbody>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">1</td>

            <td class="px-3 py-2 border-b border-gray-700">0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">2</td>

            <td class="px-3 py-2 border-b border-gray-700">0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">3</td>

            <td class="px-3 py-2 border-b border-gray-700">00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">4</td>

            <td class="px-3 py-2 border-b border-gray-700">0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">5</td>

            <td class="px-3 py-2 border-b border-gray-700">0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">6</td>

            <td class="px-3 py-2 border-b border-gray-700">000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">7</td>

            <td class="px-3 py-2 border-b border-gray-700">000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">8</td>

            <td class="px-3 py-2 border-b border-gray-700">00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000</td>

          </tr>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">We also use this method to search for linear characteristics for round-reduced versions of SIMON128, and the results are given in Appendix C. Very recently, Alizadeh et al. [59] presented a 52-round linear characteristic for SIMON128 with bias  <span class="math">2^{-128}</span> , while the characteristic we find covers 55 rounds and the bias of this characteristic is  <span class="math">2^{-109}</span> . Moreover, the method of this section is a basic tool used to search for (related-key) differential characteristics in the following sections.</p>

    <p class="text-gray-300">Finding the best characteristic of a cipher is generally an extremely difficult task. Matsui's approach [23] and its variants and improvements [33, 76-78] are the most important and effective methods used to search for the best characteristics. However, Matsui's approach has some important limitations making it not practically applicable in many cases. Moreover, some speeding up techniques employed by Matsui's approach is intimately related to the special properties and structure of the cipher under consideration, which makes it very difficult to implement. In this section, we provide another method for finding the best characteristic for block ciphers using  <span class="math">4 \\times 4</span>  S-boxes based on MILP technique. Compared with the method presented in Sect. 4, the main</p>

    <p class="text-gray-300">differences of the new technique involve the modeling of the differential patterns of the S-boxes, and the selection of the objective function. However, we think the contribution of this new method is in fact very limited since preliminary experiments show that the MILP model generated by this method is very difficult to solve, which is one of the reasons that we only apply our method to block ciphers with  <span class="math">4 \\times 4</span>  S-boxes.</p>

    <p class="text-gray-300">One main drawback of the method presented in Sect. 4 is that it only focuses on finding characteristics with minimal (or very small) number of active S-boxes. However, it is well possible that the characteristics with the maximal probability do not have the minimal number of active S-boxes. Therefore, we may miss some better characteristics by using the method presented in Sect. 4 even we are given unlimited computational power, which makes us very uncomfortable. In the following, we show how to model the differential behavior of an  <span class="math">4 \\times 4</span>  S-box without losing its information of differential probability.</p>

    <p class="text-gray-300">Take the PRESENT S-box  <span class="math">S</span>  for example. For every possible differential pattern  <span class="math">(x_0, x_1, x_2, x_3) \\to (y_0, y_1, y_2, y_3)</span> , we can construct a corresponding differential pattern with probability information  <span class="math">(x_0, x_1, x_2, x_3, y_0, y_1, y_2, y_3; p_0, p_1) \\in \\mathbb{B}^{8+2}</span>  where the two extra bits  <span class="math">(p_0, p_1)</span>  are used to encode the differential probability  <span class="math">\\operatorname{Pr}_S[(x_0, \\ldots, x_{\\omega-1}) \\to (y_0, \\ldots, y_{\\nu-1})]</span>  as follows</p>

    <div class="my-4 text-center"><span class="math-block">\\left\\{ \\begin{array}{l} \\left(p _ {0}, p _ {1}\\right) = (0, 0) \\in \\mathbb {B} ^ {2}, \\text { if } \\Pr_ {S} \\left[ \\left(x _ {0}, \\dots , x _ {\\omega - 1}\\right) \\rightarrow \\left(y _ {0}, \\dots , y _ {\\nu - 1}\\right)\\right] = 2 ^ {- 0} = 1; \\\\ \\left(p _ {0}, p _ {1}\\right) = (0, 1) \\in \\mathbb {B} ^ {2}, \\text { if } \\Pr_ {S} \\left[\\left(x _ {0}, \\dots , x _ {\\omega - 1}\\right) \\rightarrow \\left(y _ {0}, \\dots , y _ {\\nu - 1}\\right)\\right] = 2 ^ {- 2}; \\\\ \\left(p _ {0}, p _ {1}\\right) = (1, 1) \\in \\mathbb {B} ^ {2}, \\text { if } \\Pr_ {S} \\left[\\left(x _ {0}, \\dots , x _ {\\omega - 1}\\right) \\rightarrow \\left(y _ {0}, \\dots , y _ {\\nu - 1}\\right)\\right] = 2 ^ {- 3}. \\end{array} \\right. \\tag {6}</span></div>

    <p class="text-gray-300">Note that there are only 3 different entries in the differential distribution table of the PRESENT S-box, and  <span class="math">(p_0,p_1)</span>  is exactly the binary encoding of  <span class="math">-\\log_22^{-x}</span> . Hence, the probability of the differential pattern  <span class="math">(x_0,x_1,x_2,x_3)\\to (y_0,y_1,y_2,y_3)</span>  is  <span class="math">2^{-(p_0 + 2p_1)}</span> . In the new technique, the constraints for S-boxes is the critical sets of all differential patterns with probability information instead of ordinary differential patterns, and the objective function is chosen to be minimizing  <span class="math">\\sum (p_0 + 2p_1)</span> . Now, the optimized solution of the MILP model generated by this technique corresponds to a characteristic with the maximal probability, that is, the best characteristic.</p>

    <p class="text-gray-300">We implement the above technique in our Python framework for automatic cryptanalysis, and apply it to Serpent on a PC. We find a single-key differential characteristic covering rounds 5, 6, 7, and 8 of Serpent with Probability  <span class="math">2^{-40}</span>  (see Table 5), whereas the previously published best characteristic covering these rounds of Serpent is given in [56] with probability  <span class="math">2^{-47}</span> .</p>

    <p class="text-gray-300">This method is not only useful in finding improved characteristics, but also enable us to obtain the exact upper bound of the probability of the characteristics for round-reduced versions of a block cipher, which may lead to a tighter security bound for the full cipher. For example, using the method presented in this section, we can prove that the probability of the best characteristic covering rounds 0, 1, 2 of Serpent (using S-boxes  <span class="math">S_0, S_1</span>  and  <span class="math">S_2</span> ) is  <span class="math">2^{-19}</span> , which is better than the result presented in Appendix B stating that the probability is upper bounded by  <span class="math">(2^{-2})^8 = 2^{-16}</span>  (see Table 17 in Appendix B).</p>

    <p class="text-gray-300">Table 5: A 4-round differential characteristic of Serpent</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Rounds</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Input difference of the S-box layer</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Output difference of the S-box layer</th>

          </tr>

        </thead>

        <tbody>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">5 (S5)</td>

            <td class="px-3 py-2 border-b border-gray-700">001001000000000000011001001000000</td>

            <td class="px-3 py-2 border-b border-gray-700">00000000000000000001000000000000</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">001001000000000000011000001000000</td>

            <td class="px-3 py-2 border-b border-gray-700">0000010000000000000100100000000</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">00100100000000000001001001000000</td>

            <td class="px-3 py-2 border-b border-gray-700">00000000000000000000001001000000</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">000001000000000000011000001000000</td>

            <td class="px-3 py-2 border-b border-gray-700">00100000000000000000100100000000</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">6 (S6)</td>

            <td class="px-3 py-2 border-b border-gray-700">100000000000000000000000000000000</td>

            <td class="px-3 py-2 border-b border-gray-700">0000000000000000000000000000000</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">000000000000000000000000000000</td>

            <td class="px-3 py-2 border-b border-gray-700">00000000000000000000000000000100</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">10000000000000000000000000000100</td>

            <td class="px-3 py-2 border-b border-gray-700">1000000000000000000000000000000</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">000000000000000000000000000000</td>

            <td class="px-3 py-2 border-b border-gray-700">00000000000000000000000000000100</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">7 (S7)</td>

            <td class="px-3 py-2 border-b border-gray-700">00000000000000000000000000000000</td>

            <td class="px-3 py-2 border-b border-gray-700">0000000000000000000000000000000</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">000000000000000000000000000000</td>

            <td class="px-3 py-2 border-b border-gray-700">00000000000000000000000000000</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">00000001000000000000000000000</td>

            <td class="px-3 py-2 border-b border-gray-700">00000001000000000000000000000</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">00000000000000000000000000000</td>

            <td class="px-3 py-2 border-b border-gray-700">00000001000000000000000000000</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">8 (S0)</td>

            <td class="px-3 py-2 border-b border-gray-700">00000000000000000000000010010010</td>

            <td class="px-3 py-2 border-b border-gray-700">1001000000000010000000000000100</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">00010000000000000000000000000</td>

            <td class="px-3 py-2 border-b border-gray-700">0001000100100000000000010010010</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">00000001001000100000000000000</td>

            <td class="px-3 py-2 border-b border-gray-700">10010000000000100000000010010110</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">1000000000000000000000000000100</td>

            <td class="px-3 py-2 border-b border-gray-700">10010001001000100000000010010110</td>

          </tr>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">Although the new method produces better results for a specific cipher, experimental results show that the model generated by the new technique is more difficult to solve than that generated by the method presented in Sect. 4. For example, we also apply the method to PRESENT. For 4-round PRESENT, we find its best single-key differential characteristic whose probability is  <span class="math">2^{-12}</span>  in 5 seconds, and for 8-round PRESENT, we find its best single-key differential characteristic with probability  <span class="math">2^{-32}</span>  in 358675 seconds, and the corresponding characteristics are listed in Table 6 and Table 7. Compared with the models generated by the method presented in Sect. 4, the models generated by this technique involve more variables and constraints, which makes it more difficult to solve.</p>

    <p class="text-gray-300">In practice, we can also use the new technique to find good (instead of the best) characteristic by extracting a solution from the optimizer as soon as the objective value is low enough. Although we can not make sure that the extracted solution is one of the best characteristics, this approach will reduce the time of computation significantly. Take the 8-round PRESENT as an example, the Gurobi optimizer can discover an 8-round characteristic with probability  <span class="math">2^{-32}</span>  in no more than 35008 seconds, and an 8-round characteristic with probability  <span class="math">2^{-34}</span>  in no more than 18962 seconds. Note that before the Gurobi complete its computation (cost 358675 seconds in total), we can not make sure that the probability of the best characteristic is  <span class="math">2^{-32}</span>  though a characteristic with this probability has already been found in just 35008 seconds.</p>

    <p class="text-gray-300">Table 6: A 4-round single-key differential characteristic for PRESENT with the maximal possible probability</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Rounds</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">In</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Out</th>

          </tr>

        </thead>

        <tbody>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">1</td>

            <td class="px-3 py-2 border-b border-gray-700">00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000</td>

            <td class="px-3 py-2 border-b border-gray-700">00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">2</td>

            <td class="px-3 py-2 border-b border-gray-700">00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000</td>

            <td class="px-3 py-2 border-b border-gray-700">0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">3</td>

            <td class="px-3 py-2 border-b border-gray-700">00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000</td>

            <td class="px-3 py-2 border-b border-gray-700">00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">4</td>

            <td class="px-3 py-2 border-b border-gray-700">00000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000</td>

            <td class="px-3 py-2 border-b border-gray-700">00000011000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000</td>

          </tr>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">Table 7: An 8-round single-key differential characteristic for PRESENT with the maximal possible probability</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Rounds</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">In</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Out</th>

          </tr>

        </thead>

        <tbody>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">1</td>

            <td class="px-3 py-2 border-b border-gray-700">000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000</td>

            <td class="px-3 py-2 border-b border-gray-700">0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">2</td>

            <td class="px-3 py-2 border-b border-gray-700">00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000</td>

            <td class="px-3 py-2 border-b border-gray-700">0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">3</td>

            <td class="px-3 py-2 border-b border-gray-700">00000000000000010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000</td>

            <td class="px-3 py-2 border-b border-gray-700">00000000000001001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">4</td>

            <td class="px-3 py-2 border-b border-gray-700">000100000000000100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000</td>

            <td class="px-3 py-2 border-b border-gray-700">00010000000001001000000000000000000000000000000000000000000000000000000000000000000000000000000000</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">5</td>

            <td class="px-3 py-2 border-b border-gray-700">1001000000001001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000</td>

            <td class="px-3 py-2 border-b border-gray-700">000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">6</td>

            <td class="px-3 py-2 border-b border-gray-700">00000000000000000000001000000000000000000000000000000000000000000000000000000000000000000000000000000</td>

            <td class="px-3 py-2 border-b border-gray-700">0000000000000000000000000000000000000000000000000000000000000000000000000000</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">7</td>

            <td class="px-3 py-2 border-b border-gray-700">0000000000000000000010010000000000000000000000000000000000000000000000000000000000000000000000000000000000</td>

            <td class="px-3 py-2 border-b border-gray-700">0000000000000000000000000000000000000000000000000000000000000000000000000000000000000</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">8</td>

            <td class="px-3 py-2 border-b border-gray-700">000000000000000000000100000000000000000000000000000000000000000000000000000000000000000000000000000</td>

            <td class="px-3 py-2 border-b border-gray-700">00000000000000000000000000000000000000000000000000000000000000000000000000000</td>

          </tr>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">By now, we are able to search for (related-key) differential or linear characteristics for a wide range of ciphers. However, just being able to obtain a characteristic with a small number of active S-boxes is not enough. Several works [79-81] have demonstrated that the differential attack based on one characteristic can be strengthened with multiple characteristics with the same input and output differences (the so called differential), and therefore we want to find all high probability characteristics with the same input and output differences. In the linear hull analysis, we need to find all linear characteristics with the same input and output linear masks. In the (related-key) boomerang/rectangle attack, two short differentials  <span class="math">\\alpha \\rightarrow \\beta</span>  and  <span class="math">\\gamma \\rightarrow \\delta</span>  are used to construct a boomerang distinguisher. By allowing  <span class="math">\\beta</span>  and  <span class="math">\\gamma</span>  to change, the probability of the constructed distinguisher can be improved. Hence, we want to find all high probability differential characteristics with a fixed input (or output) difference. In the structure attack [79], a form of differential cryptanalysis exploiting differentials with multiple input differences and a single output difference, we also need to search for characteristics sharing a same output difference. To summarize, we need to find all characteristics of some given properties according to the context, and the procedure for enumerating all characteristics covering round 1 to round  <span class="math">r</span>  of a cipher with some given properties is listed as follows.</p>

    <p class="text-gray-300">Step 1. Construct an MILP model  <span class="math">\\mathcal{M}</span>  describing the differential (or linear) behavior of the cipher (round 1 to round  <span class="math">r</span> ) according to Sect. 4 (or Appendix A).</p>

    <p class="text-gray-300">Step 2. Add the constraints imposed by the given properties (concrete examples will be given in the following sections).</p>

    <p class="text-gray-300">Step 3. Solve the model using an MILP optimizer. If a feasible solution <span class="math">x</span> is found, save <span class="math">x</span> to a file and update the model by adding the linear inequality <span class="math">l^{(x)}</span> to remove <span class="math">x</span> from the feasible region of <span class="math">\\mathcal{M}</span>; if the updated model <span class="math">\\mathcal{M}</span> is infeasible, go to Step 4. Otherwise, repeat Step 3.</p>

    <p class="text-gray-300">Step 4. Terminate the procedure and extract all the characteristics with the given properties from the saved solutions.</p>

    <p class="text-gray-300">In the following subsections, we show concrete applications of the above method.</p>

    <h3 id="sec-12" class="text-xl font-semibold mt-8">6.1 Automatic (Related-key) Differential and Linear Hull Analysis</h3>

    <p class="text-gray-300">The clustering of multiple differential characteristics satisfying the same (fixed) input and output difference is referred to as the differential effect. By considering the differential effect, the computed expected differential probability (EDP) may become significantly higher than that of any differential characteristic in the differential. Therefore, the probability of the differential serves to be a more accurate indication of the security of a block cipher with respect to the differential attack.</p>

    <p class="text-gray-300">Currently available methods for searching for high probability single-key differential characteristics include the branch-and-bound approach <em>[82]</em>, variants of Matsui’s algorithm <em>[83, 53]</em>, and those rather dedicated methods <em>[79, 81]</em>. In what follows we will propose a generic and automatic method for searching for differential characteristics in a given differential in both the single-key and related-key model. The new method is not only conceptually simpler, but also easier to implement compared to existing methods.</p>

    <p class="text-gray-300">Given an <span class="math">r</span>-round differential characteristic <span class="math">(\\alpha_{0},\\alpha_{1},\\ldots,\\alpha_{r-1},\\alpha_{r})</span>, we can find all <span class="math">r</span>-round differential characteristics with the following properties: (1) the input difference is <span class="math">\\alpha_{0}</span> and the output difference is <span class="math">\\alpha_{r}</span>, (2) the characteristic activates at most <span class="math">N_{A}</span> S-boxes. This can be done by the following procedure.</p>

    <p class="text-gray-300">Step 1. Construct an MILP model <span class="math">\\mathcal{M}</span> describing the differential behavior of the cipher (from round 1 to round <span class="math">r</span>) according to Sect. 4.</p>

    <p class="text-gray-300">Step 2. Add the constraints describing that the input difference must be <span class="math">\\alpha_{0}</span> and the output difference must be <span class="math">\\alpha_{r}</span> (these constraints are simple equations fixing the input and output bit-level differences), and add the constraint <span class="math">\\sum_{j}S_{j}\\leq N_{A}</span>, where the <span class="math">S_{j}</span>’s are variables marking the activities of the S-boxes involved.</p>

    <p class="text-gray-300">Step 3. Solve the model using an MILP optimizer. If a feasible solution <span class="math">x</span> is found, save <span class="math">x</span> to a file and update the model by adding the linear inequality <span class="math">l^{(x)}</span> to remove <span class="math">x</span> from the feasible region of <span class="math">\\mathcal{M}</span>; if the updated model <span class="math">\\mathcal{M}</span> is infeasible, go to Step 4. Otherwise, repeat Step 3.</p>

    <p class="text-gray-300">Step 4. Terminate the procedure and extract all the differential characteristics in the differential with at most <span class="math">N_{A}</span> active S-boxes from the saved solutions.</p>

    <h4 id="sec-13" class="text-lg font-semibold mt-6">Differential Analysis of SIMON and LBlock.</h4>

    <p class="text-gray-300">SIMON <em>[84]</em> is a family of lightweight block ciphers designed by the U.S. National Security Agency (NSA). The design of SIMON<span class="math">n_{b}/n_{K}</span> is a Feistel scheme with a block size of <span class="math">n_{b}</span> bits and key size of <span class="math">n_{K}</span> bits. The bitwise AND operation is the only nonlinear operation of SIMON<span class="math">n_{b}/n_{K}</span>. For a detailed description of SIMON and existing attacks on it, we refer the reader to <em>[84, 85, 86, 87, 58, 53, 59, 58]</em>.</p>

    <p class="text-gray-300">By treating the AND (<span class="math">\\mathbb{F}_{2}\\times\\mathbb{F}_{2}\\rightarrow\\mathbb{F}_{2}</span>) operation as a <span class="math">2\\times 1</span> S-box, we apply our method to SIMON in the single-key model. In our MILP models we treat the input bits of the AND operation as <em>independent input bits</em>, and the dependencies of the input bits to the AND operation are not considered. Therefore, the characteristic obtained by our method is not guaranteed to be valid for SIMON (other ciphers do not have this problem). Hence, every time after the Gurobi optimizer outputs a good solution (characteristic), we check its validity and compute its probability by the method presented in <em>[53]</em>.</p>

    <p class="text-gray-300">We find a 16-round single-key differential characteristic for SIMON48 with probability <span class="math">2^{-50}</span> (see Table 8). Then we compute the probability of the differential with its input and output differences fixed to the values given in Table 8 with the method presented in this section. To be more specific, we search for all characteristics with probability <span class="math">p</span> such that <span class="math">2^{-60}\\leq p\\leq 2^{-50}</span> in this differential, and the distribution of these characteristics is given in Table 9, from which we can deduce that the probability of this differential is greater than <span class="math">2^{-44.65}</span>. To the best of our knowledge, this is the first published single-key differential covering more than 15 rounds of SIMON48.</p>

    <p class="text-gray-300">In addition, using the method presented in Sect. 4, we find a 21-round single-key differential characteristic for SIMON64 with probability <span class="math">2^{-70}</span> which is given in Table 10. Note that the probability of the best previously published single-key differential characteristic for the 21-round SIMON64 is <span class="math">2^{-72}</span> *[53]</p>

    <p class="text-gray-300">Table 8: A single-key differential characteristic of 16-round SIMON48 with probability  <span class="math">2^{-50}</span> .</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Rounds</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">The input differences</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

          </tr>

        </thead>

        <tbody>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">0 (Input)</td>

            <td class="px-3 py-2 border-b border-gray-700">1000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">1</td>

            <td class="px-3 py-2 border-b border-gray-700">00100010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">2</td>

            <td class="px-3 py-2 border-b border-gray-700">000010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">3</td>

            <td class="px-3 py-2 border-b border-gray-700">000000100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">4</td>

            <td class="px-3 py-2 border-b border-gray-700">000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">5</td>

            <td class="px-3 py-2 border-b border-gray-700">00000010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">6</td>

            <td class="px-3 py-2 border-b border-gray-700">000010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">7</td>

            <td class="px-3 py-2 border-b border-gray-700">001000100000000100000000000000000000000000000000000000000000000000000000000000000000000000000000000</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">8</td>

            <td class="px-3 py-2 border-b border-gray-700">1000001000001000000100000000000000000000000000000000000000000000000000000000000000000000000000000</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">9</td>

            <td class="px-3 py-2 border-b border-gray-700">001000100000000100000000000000000000000000000000000000000000000000000000000000000000000000000000</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">10</td>

            <td class="px-3 py-2 border-b border-gray-700">0000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">11</td>

            <td class="px-3 py-2 border-b border-gray-700">00000010000000000000000000000000000000000000000000000000000000000000000000000000000000</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">12</td>

            <td class="px-3 py-2 border-b border-gray-700">0000000000000000000000000000000000000000000000000000000000000000000000000000000000000</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">13</td>

            <td class="px-3 py-2 border-b border-gray-700">0000001000000000000000000000000000000000000000000000000000000000000000000000000000000</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">14</td>

            <td class="px-3 py-2 border-b border-gray-700">000010000000000000000000000000000000000000000000000000000000000000000000000000000000000000</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">15</td>

            <td class="px-3 py-2 border-b border-gray-700">00100010000000000000000000000000000000000000000000000000000000000000000000000000000000000</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">16 (Output)</td>

            <td class="px-3 py-2 border-b border-gray-700">10000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

          </tr>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">Table 9: The distribution of the characteristics of SIMON48 in the differential specified by the input and output differences given in Table 8. The invalid characteristics is due to the special property of the dependent inputs of the AND operations in SIMON, and we refer the reader to [51, 53] for more information.</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Probability</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">2-50</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">2-51</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">2-52</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">2-53</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">2-54</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">2-55</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">2-56</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">2-57</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">2-58</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">2-59</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">2-60</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Invalid</th>

          </tr>

        </thead>

        <tbody>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">#Characteristics</td>

            <td class="px-3 py-2 border-b border-gray-700">1</td>

            <td class="px-3 py-2 border-b border-gray-700">6</td>

            <td class="px-3 py-2 border-b border-gray-700">15</td>

            <td class="px-3 py-2 border-b border-gray-700">46</td>

            <td class="px-3 py-2 border-b border-gray-700">100</td>

            <td class="px-3 py-2 border-b border-gray-700">114</td>

            <td class="px-3 py-2 border-b border-gray-700">379</td>

            <td class="px-3 py-2 border-b border-gray-700">685</td>

            <td class="px-3 py-2 border-b border-gray-700">953</td>

            <td class="px-3 py-2 border-b border-gray-700">913</td>

            <td class="px-3 py-2 border-b border-gray-700">724</td>

            <td class="px-3 py-2 border-b border-gray-700">3568</td>

          </tr>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">Table 10: A single-key differential characteristic of the 21-round SIMON64 with probability  <span class="math">2^{-70}</span> .</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Rounds</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">The input differences</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

          </tr>

        </thead>

        <tbody>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">0 (Input)</td>

            <td class="px-3 py-2 border-b border-gray-700">00000000000010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">1</td>

            <td class="px-3 py-2 border-b border-gray-700">0000000000000010001000000000000000000000000000000000000000000000000000000000000000000000000000000</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">2</td>

            <td class="px-3 py-2 border-b border-gray-700">000000000000000010000000000000000000000000000000000000000000000000000000000000000000000000000000000</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">3</td>

            <td class="px-3 py-2 border-b border-gray-700">00000000000000000010000000000000000000000000000000000000000000000000000000000000000000000000000</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">4</td>

            <td class="px-3 py-2 border-b border-gray-700">0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">5</td>

            <td class="px-3 py-2 border-b border-gray-700">000000000000000000100000000000000000000000000000000000000000000000000000000000000000000000000000</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">6</td>

            <td class="px-3 py-2 border-b border-gray-700">00000000000000000100000000000000000000000000000000000000000000000000000000000000000000000000000</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">7</td>

            <td class="px-3 py-2 border-b border-gray-700">00000000000000010001000000000000000000000000000000000000000000000000000000000000000000000000000</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">8</td>

            <td class="px-3 py-2 border-b border-gray-700">000000000000000010000000000000000000000000000000000000000000000000000000000000000000000000</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">9</td>

            <td class="px-3 py-2 border-b border-gray-700">000000000000000000100000000000000000000000000000000000000000000000000000000000000000000000</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">10</td>

            <td class="px-3 py-2 border-b border-gray-700">00000000100000001000000000000000000000000000000000000000000000000000000000000000000000000</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">11</td>

            <td class="px-3 py-2 border-b border-gray-700">00000010001000000010000000000000000000000000000000000000000000000000000000000000000</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">12</td>

            <td class="px-3 py-2 border-b border-gray-700">0000100001100000000000000000000000000000000000000000000000000000000000000000000000000000</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">13</td>

            <td class="px-3 py-2 border-b border-gray-700">00000011001000000010000000000000000000000000000000000000000000000000000000000000000</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">14</td>

            <td class="px-3 py-2 border-b border-gray-700">0000000010000000100000000000000000000000000000000000000000000000000000000000000000</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">15</td>

            <td class="px-3 py-2 border-b border-gray-700">00000000001000100010000000000000000000000000000000000000000000000000000000000000000</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">16</td>

            <td class="px-3 py-2 border-b border-gray-700">0000000000001000000000000000000000000000000000000000000000000000000000000000000000000000</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">17</td>

            <td class="px-3 py-2 border-b border-gray-700">000000000000001000100000000000000000000000000000000000000000000000000000000000000</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">18</td>

            <td class="px-3 py-2 border-b border-gray-700">000000000000000010000000000000000000000000000000000000000000000000000000000000000</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">19</td>

            <td class="px-3 py-2 border-b border-gray-700">00000000000000000100000000000000000000000000000000000000000000000000000000000000</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">20</td>

            <td class="px-3 py-2 border-b border-gray-700">00000000000000000000000000000000000000000000000000000000000000000000000000000000</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">21 (Output)</td>

            <td class="px-3 py-2 border-b border-gray-700">00000000000000000010000000000000000000000000000000000000000000000000000000</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

          </tr>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">Table 11: The distribution of the characteristics of SIMON64 in the differential specified by the input and output differences given in Table 10.</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Probability</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">2-70</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">2-71</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">2-72</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">2-73</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">2-74</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">2-75</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">2-76</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">2-77</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">2-78</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">2-79</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Invalid</th>

          </tr>

        </thead>

        <tbody>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">#Characteristics</td>

            <td class="px-3 py-2 border-b border-gray-700">2</td>

            <td class="px-3 py-2 border-b border-gray-700">14</td>

            <td class="px-3 py-2 border-b border-gray-700">74</td>

            <td class="px-3 py-2 border-b border-gray-700">306</td>

            <td class="px-3 py-2 border-b border-gray-700">1105</td>

            <td class="px-3 py-2 border-b border-gray-700">3502</td>

            <td class="px-3 py-2 border-b border-gray-700">10213</td>

            <td class="px-3 py-2 border-b border-gray-700">25553</td>

            <td class="px-3 py-2 border-b border-gray-700">48016</td>

            <td class="px-3 py-2 border-b border-gray-700">50827</td>

            <td class="px-3 py-2 border-b border-gray-700">19942</td>

          </tr>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">By adding the constraints that the input and output differences are fixed to be the values suggested in Table 10, we search for all characteristics in this differential with probability  <span class="math">p</span>  such that  <span class="math">2^{-79} \\leq p \\leq 2^{-70}</span> . We obtain 159554 characteristics (including 19942 invalid ones) in total with varying probability. The details of the distribution of these characteristics are given in Table 11, from which we can deduce that the probability of the differential for the 21-round SIMON64 is greater than  <span class="math">2^{-60.21}</span> . Note that the probability of the best previously published 21-round differential for SIMON64 is  <span class="math">2^{-60.53}</span> . By extending one more round of this differential, we obtain a 22-round single-key differential characteristic for SIMON64 with probability at least  <span class="math">2^{-62.21}</span> , which is the first published single-key differential characteristic covering more than 21 rounds of SIMON64. Note that the 21-round characteristic presented in [53] can not be simply extended to obtain a 22-round characteristic with probability less than  <span class="math">2^{-64}</span> , since the Hamming weight of its output is higher and extending one more round will decrease the probability significantly. The differentials presented in this paper for SIMON can be used to produce the best differential attacks on SIMON48 and SIMON64 with Wang et al.'s technique [58].</p>

    <p class="text-gray-300">We also apply the method to LBlock, and we find a 16-round standard (non truncated) related-key differential with probability  <span class="math">2^{-55.64}</span> , which is even better than the previously published best truncated related-key differential for the 16-round LBlock whose probability is about  <span class="math">2^{-59}</span>  [57]. The results are given in Appendix D.</p>

    <p class="text-gray-300">Linear (Hull) Analysis of SIMON48. For the sake of completeness, we also present an example on SIMON48 demonstrating that our method is also applicable in linear hull analysis, and this part can be safely skipped by the readers since there is no essential difference between the two methods for differential and linear hull analysis. A linear hull, first announced by Nyberg et al. in [88], is a collection of linear characteristics with a certain (fixed) input and output masks. It is the counterpart to differentials in differential cryptanalysis, and there are a lot of works (e.g. [89-95]) studying the linear hull effect.</p>

    <p class="text-gray-300">Using the MILP technique, we find a 16-round linear characteristic with bias  <span class="math">2^{-26}</span>  (see Table 12). By considering multiple linear approximations with the same input and output masks specified in Table 12, we obtain 394271 linear characteristics where 16767 characteristics are valid, which lead to a linear hull with potential  <span class="math">2^{-44.92}</span> . Using Matsui's Algorithm 2 [96], we can attack 23-round SIMON48/96 by adding 3 rounds at the top and 4 rounds at the bottom of the linear hull (see Fig. 1 in Appendix E). Note that the subkey bits without underscore are secret bits to be guessed in the attack. To the best of our knowledge, there is no published linear attack on SIMON48/96 which can cover 23 rounds of SIMON48/96.</p>

    <p class="text-gray-300">Table 12: A 16-round linear characteristic for SIMON48</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Round</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Left</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Right</th>

          </tr>

        </thead>

        <tbody>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">0</td>

            <td class="px-3 py-2 border-b border-gray-700">001000000000000000100010</td>

            <td class="px-3 py-2 border-b border-gray-700">100000000000000000000000</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">1</td>

            <td class="px-3 py-2 border-b border-gray-700">10000000000000000000000</td>

            <td class="px-3 py-2 border-b border-gray-700">000000000000000000100010</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">2</td>

            <td class="px-3 py-2 border-b border-gray-700">000000000000000000100010</td>

            <td class="px-3 py-2 border-b border-gray-700">000000000000000000001000</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">3</td>

            <td class="px-3 py-2 border-b border-gray-700">000000000000000000001000</td>

            <td class="px-3 py-2 border-b border-gray-700">000000000000000000100000</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">4</td>

            <td class="px-3 py-2 border-b border-gray-700">000000000000000000100000</td>

            <td class="px-3 py-2 border-b border-gray-700">00000000000000000000000</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">5</td>

            <td class="px-3 py-2 border-b border-gray-700">00000000000000000000000</td>

            <td class="px-3 py-2 border-b border-gray-700">000000000000000000100000</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">6</td>

            <td class="px-3 py-2 border-b border-gray-700">000000000000000000100000</td>

            <td class="px-3 py-2 border-b border-gray-700">001000000000000000001000</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">7</td>

            <td class="px-3 py-2 border-b border-gray-700">001000000000000000001000</td>

            <td class="px-3 py-2 border-b border-gray-700">000000000010000000100010</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">8</td>

            <td class="px-3 py-2 border-b border-gray-700">000000000010000000100010</td>

            <td class="px-3 py-2 border-b border-gray-700">100000100000100000100000</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">9</td>

            <td class="px-3 py-2 border-b border-gray-700">100000100000100000100000</td>

            <td class="px-3 py-2 border-b border-gray-700">000000000010000000100010</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">10</td>

            <td class="px-3 py-2 border-b border-gray-700">000000000010000000100010</td>

            <td class="px-3 py-2 border-b border-gray-700">001000000000000000001000</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">11</td>

            <td class="px-3 py-2 border-b border-gray-700">001000000000000000001000</td>

            <td class="px-3 py-2 border-b border-gray-700">000000000000000000100000</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">12</td>

            <td class="px-3 py-2 border-b border-gray-700">000000000000000000100000</td>

            <td class="px-3 py-2 border-b border-gray-700">00000000000000000000000</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">13</td>

            <td class="px-3 py-2 border-b border-gray-700">00000000000000000000000</td>

            <td class="px-3 py-2 border-b border-gray-700">000000000000000000100000</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">14</td>

            <td class="px-3 py-2 border-b border-gray-700">000000000000000000100000</td>

            <td class="px-3 py-2 border-b border-gray-700">000000000000000000001000</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">15</td>

            <td class="px-3 py-2 border-b border-gray-700">000000000000000000001000</td>

            <td class="px-3 py-2 border-b border-gray-700">000000000000000000100010</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">16</td>

            <td class="px-3 py-2 border-b border-gray-700">000000000000000000100010</td>

            <td class="px-3 py-2 border-b border-gray-700">100000000000000000000000</td>

          </tr>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">In basic truncated differential analysis, the fixed output difference <span class="math">\\beta</span> of a differential <span class="math">\\alpha \\rightarrow \\beta</span> is truncated to be a bit string with some specific bits allowed to be any valued in <span class="math">\\{0,1\\}</span>. With this relaxation, the probability of the truncated differential can be increased. Truncated differential is a very useful tool in cryptanalysis and several ciphers which are secure against standard differential attack are vulnerable to truncated differential attack.</p>

    <p class="text-gray-300">We now present an automatic method for enumerating all high probability (related-key) differential characteristics in a given truncated (related-key) differential.</p>

    <p class="text-gray-300">Step 1. Construct an MILP model <span class="math">\\mathcal{M}</span> describing the differential behavior of the cipher (from round 1 to round <span class="math">r</span>) according to Sect. 4.</p>

    <p class="text-gray-300">Step 2. For a given truncated differential <span class="math">\\alpha_0 \\to \\alpha_r</span> where <span class="math">\\alpha_r = (\\alpha_{r,0}, \\dots, \\alpha_{r,n-1})</span> and</p>

    <div class="my-4 text-center"><span class="math-block">\\left\\{ \\begin{array}{l} \\alpha_{j_0} = 0, \\dots, \\alpha_{j_{s_r}} = 0 \\\\ \\alpha_{j_{s_{r+1}}} = 1, \\dots, \\alpha_{j_{s_t}} = 1 \\\\ \\alpha_{j_{s_{t+1}}} = *, \\dots, \\alpha_{j_{n-1}} = *, \\end{array} \\right. \\tag{7}</span></div>

    <p class="text-gray-300">add the system of equations</p>

    <div class="my-4 text-center"><span class="math-block">\\left\\{ \\begin{array}{l} \\alpha_{j_0} = 0, \\dots, \\alpha_{j_{s_r}} = 0 \\\\ \\alpha_{j_{s_{r+1}}} = 1, \\dots, \\alpha_{j_{s_t}} = 1 \\end{array} \\right. \\tag{8}</span></div>

    <p class="text-gray-300">and the constraint <span class="math">\\sum_j S_j \\leq N_A</span> into the model <span class="math">\\mathcal{M}</span>, where the <span class="math">S_j</span>'s are the variables marking the activities of the S-boxes involved.</p>

    <p class="text-gray-300">Step 3. Solve the model using an MILP optimizer. If a feasible solution <span class="math">x</span> is found, save <span class="math">x</span> to a file and update the model by adding the linear inequality <span class="math">l^{(x)}</span> to remove <span class="math">x</span> from the feasible region of <span class="math">\\mathcal{M}</span>; if the updated model <span class="math">\\mathcal{M}</span> is infeasible, go to Step 4. Otherwise, repeat Step 3.</p>

    <p class="text-gray-300">Step 4. Terminate the procedure and extract all the differential characteristics in the given truncated differential with at most <span class="math">N_A</span> active S-boxes from the saved solutions.</p>

    <p class="text-gray-300">We apply the above method to DESL. Firstly, we find a related-key differential characteristic for the 9-round DESL, and the results are given in Table 13 and Table 14.</p>

    <p class="text-gray-300">Table 13: A 9-round related-key differential characteristic for DESL (characteristic in the encryption process)</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Rounds</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Left</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Right</th>

          </tr>

        </thead>

        <tbody>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">0</td>

            <td class="px-3 py-2 border-b border-gray-700">0000000000000010000000000000000</td>

            <td class="px-3 py-2 border-b border-gray-700">0000000001000000000000000000000</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">1</td>

            <td class="px-3 py-2 border-b border-gray-700">00000000010000000000000000000000</td>

            <td class="px-3 py-2 border-b border-gray-700">0000000000000000000000000000000</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">2</td>

            <td class="px-3 py-2 border-b border-gray-700">00000000000000000000000000000000</td>

            <td class="px-3 py-2 border-b border-gray-700">0000000001000000000000000000000</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">3</td>

            <td class="px-3 py-2 border-b border-gray-700">00000000010000000000000000000000</td>

            <td class="px-3 py-2 border-b border-gray-700">000001000000000000000000000000</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">4</td>

            <td class="px-3 py-2 border-b border-gray-700">00000100000000000000000000000000</td>

            <td class="px-3 py-2 border-b border-gray-700">0000000001000000010000000000000</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">5</td>

            <td class="px-3 py-2 border-b border-gray-700">00000000010000000100000000000000</td>

            <td class="px-3 py-2 border-b border-gray-700">0010000000000000000000110000000</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">6</td>

            <td class="px-3 py-2 border-b border-gray-700">0010000000000000000000110000000</td>

            <td class="px-3 py-2 border-b border-gray-700">0000001011000000010000000000000</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">7</td>

            <td class="px-3 py-2 border-b border-gray-700">00000010110000000100000000000000</td>

            <td class="px-3 py-2 border-b border-gray-700">000000000000010000000000000000</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">8</td>

            <td class="px-3 py-2 border-b border-gray-700">0000000000000100000000000000000</td>

            <td class="px-3 py-2 border-b border-gray-700">0000001010000000010000000000000</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">9</td>

            <td class="px-3 py-2 border-b border-gray-700">00000010100000000100000000000000</td>

            <td class="px-3 py-2 border-b border-gray-700">001001000000100000000000000000</td>

          </tr>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">Then, we truncate the output difference (the input difference of the 10th round) to be</p>

    <div class="my-4 text-center"><span class="math-block">00000010100000000100000000000000 0**00*0*0000**0*0*00000**00*0*00</span></div>

    <p class="text-gray-300">and we try to find all related-key differential characteristic with at most 21 active S-boxes in this truncated related-key differential. Finally, we find 14700 characteristics in total leading to a 9-round truncated related-key differential for DESL with probability <span class="math">2^{-34.06}</span>.</p>

    <p class="text-gray-300">The main idea behind the boomerang/rectangle attack is to exploit two short differentials with high probabilities instead of one long differential with a low probability. Let <span class="math">E: \\{0,1\\}^n \\times \\{0,1\\}^k \\to \\{0,1\\}^n</span> be a</p>

    <p class="text-gray-300">Table 14: A 9-round related-key differential characteristic for DESL (characteristic in the key schedule algorithm)</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Rounds</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">The differences in the key register</th>

          </tr>

        </thead>

        <tbody>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">1</td>

            <td class="px-3 py-2 border-b border-gray-700">000000000000000010000000000000000000000000000000000000000000000000000000000000000000000000000000000000</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">2</td>

            <td class="px-3 py-2 border-b border-gray-700">00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">3</td>

            <td class="px-3 py-2 border-b border-gray-700">000000000000100000000000000000000000000000000000000000000000000000000000000000000000000000000000</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">4</td>

            <td class="px-3 py-2 border-b border-gray-700">00000000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">5</td>

            <td class="px-3 py-2 border-b border-gray-700">0000000000000100000000000000000000000000000000000000000000000000000000000000000000000000000000</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">6</td>

            <td class="px-3 py-2 border-b border-gray-700">010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">7</td>

            <td class="px-3 py-2 border-b border-gray-700">000000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">8</td>

            <td class="px-3 py-2 border-b border-gray-700">0000000000000000000000010000000000000000000000000000000000000000000000000000000000000000000000</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">9</td>

            <td class="px-3 py-2 border-b border-gray-700">0000000000000001000000000000000000000000000000000000000000000000000000000000000000000000000</td>

          </tr>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">block cipher which can be described as  <span class="math">E = E_{1} \\circ E_{0}</span> , such that for  <span class="math">E_{0}</span>  there exists a differential  <span class="math">\\alpha \\rightarrow \\beta</span>  with probability  <span class="math">p</span> , and for  <span class="math">E_{1}</span>  there exists a differential  <span class="math">\\gamma \\rightarrow \\delta</span>  with probability  <span class="math">q</span> .</p>

    <p class="text-gray-300">In the rectangle distinguisher, the attacker constructs quartets of plaintexts of the form  <span class="math">(P_{1}, P_{2}, P_{3}, P_{4})</span>  such that  <span class="math">P_{1} \\oplus P_{2} = P_{3} \\oplus P_{4} = \\alpha</span> . A quartet is said to be a right quartet if the following conditions are satisfied:</p>

    <ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">

      <li><span class="math">E_0(P_1) \\oplus E_0(P_2) = E_0(P_3) \\oplus E_0(P_4) = \\beta</span> ;</li>

      <li><span class="math">E_0(P_1)\\oplus E_0(P_3) = \\gamma</span>  (or  <span class="math">E_0(P_2)\\oplus E_0(P_4) = \\gamma</span></li>

      <li><span class="math">C_1\\oplus C_3 = C_2\\oplus C_4 = \\delta</span></li>

    </ol>

    <p class="text-gray-300">It can be shown that the probability of a quartet to be right is approximately  <span class="math">2^{-n}(pq)^2</span> . The above process can be used to distinguish  <span class="math">E</span>  from a random permutation if  <span class="math">(pq)^2 &amp;gt; 2^{-n}</span> , since for a random permutation, the probability of  <span class="math">C_1 \\oplus C_3 = C_2 \\oplus C_4 = \\delta</span>  is  <span class="math">2^{-2n}</span> .</p>

    <p class="text-gray-300">It is suggested in [97] that the attack can be mounted for all possible  <span class="math">\\beta</span> 's and  <span class="math">\\gamma</span> 's to improve the attack. Therefore the rectangle process can be employed to distinguish  <span class="math">E</span>  from a random permutation if  <span class="math">(\\hat{p}\\hat{q})^2 &amp;gt; 2^{-n}</span> , where</p>

    <div class="my-4 text-center"><span class="math-block">\\hat {p} = \\sqrt {\\sum_ {\\beta} P r ^ {2} [ \\alpha \\rightarrow \\beta ]} a n d \\hat {q} = \\sqrt {\\sum_ {\\gamma} P r ^ {2} [ \\gamma \\rightarrow \\delta ]}</span></div>

    <p class="text-gray-300">In some cases, this improvement reduces the complexity for the rectangle attack significantly. In practice,  <span class="math">\\hat{p}</span>  is computed as follows. Firstly, the attacker finds a differential (or differential characteristic)  <span class="math">\\alpha \\rightarrow \\beta</span>  for  <span class="math">E_0</span>  with probability  <span class="math">p_0</span> . Then he or she tries to find all high probability differentials with input difference  <span class="math">\\alpha</span> . For example, if he or she obtain  <span class="math">n_j</span>  differential (characteristics) with probability  <span class="math">p_j</span> , then  <span class="math">\\hat{p}</span>  can be approximated by  <span class="math">\\sqrt{\\sum_{j} n_j p_j^2}</span> . Similar situation is also encountered in the so called structure attack [79], in which the attacker needs to find high probability differentials sharing the same output difference. We now show that such tasks can be accomplished automatically with an MILP technique, and the procedure is presented as follows.</p>

    <p class="text-gray-300">Step 1. Construct an MILP model  <span class="math">\\mathcal{M}</span>  describing the differential behavior of  <span class="math">E_0</span>  according to Sect. 4.</p>

    <p class="text-gray-300">Step 2. Add the constraints describing that the input difference must be  <span class="math">\\alpha_0</span>  (these constraints are simple equations fixing the input bit-level differences), and add the constraint  <span class="math">\\sum_{j} S_{j} \\leq N_{A}</span> , where the  <span class="math">S_{j}</span> 's are variables marking the activities of the S-boxes involved and  <span class="math">N_{A}</span>  is chosen by the attacker to make sure that the probabilities of the characteristics found are not too small.</p>

    <p class="text-gray-300">Step 3. Solve the model using an MILP optimizer. If a feasible solution  <span class="math">x</span>  is found, save  <span class="math">x</span>  to a file and update the model by adding the linear inequality  <span class="math">l^{(x)}</span>  to remove  <span class="math">x</span>  from the feasible region of  <span class="math">\\mathcal{M}</span> ; if the updated model  <span class="math">\\mathcal{M}</span>  is infeasible, go to Step 4. Otherwise, repeat Step 3.</p>

    <p class="text-gray-300">Step 4. Terminate the procedure and extract all the differential characteristics in the differential with at most  <span class="math">N_{A}</span>  active S-boxes from the saved solutions, and compute  <span class="math">\\hat{p}</span>  by the above method.</p>

    <p class="text-gray-300">Application to PRESENT-128 and LBlock. For PRESENT-128, using the method presented in Sect. 4.2, we find a related-key characteristic of  <span class="math">E_0</span>  ( <span class="math">E_0</span>  and  <span class="math">E_1</span>  are specified in [98]) with 0 active S-boxes in the key schedule and probability  <span class="math">2^{-11}</span>  (5 active S-boxes) and the characteristic is given in Table 15 and Table 16, which is almost the same characteristic presented in [51]. Then we use the method presented in this section</p>

    <p class="text-gray-300">to find all characteristics with at most 9 active S-boxes whose input difference to the S-box of the first round is</p>

    <p class="text-gray-300">001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000</p>

    <p class="text-gray-300">Finally, we obtain totally 1028 characteristics. There are 4 characteristics with probability  <span class="math">2^{-11}</span> , 128 characteristics with probability  <span class="math">2^{-19}</span> , 256 characteristics with probability  <span class="math">2^{-20}</span> , 512 characteristics with probability  <span class="math">2^{-21}</span> , and 128 characteristics with probability  <span class="math">2^{-22}</span> . Hence the overall probability  <span class="math">\\hat{p}</span>  for  <span class="math">E_0</span>  is approximately</p>

    <div class="my-4 text-center"><span class="math-block">\\sqrt {4 \\times (2 ^ {- 1 1}) ^ {2} + 1 2 8 \\times (2 ^ {- 1 9}) ^ {2} + 2 5 6 \\times (2 ^ {- 2 0}) ^ {2} + 5 1 2 \\times (2 ^ {- 2 1}) ^ {2} + 1 2 8 \\times (2 ^ {- 2 2}) ^ {2}} \\approx 2 ^ {- 1 0}.</span></div>

    <p class="text-gray-300">Table 15: A 7-round related-key characteristic for PRESENT-128 (characteristic in the encryption process)</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Rounds</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">The input and output differences of the S-box layer</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

          </tr>

        </thead>

        <tbody>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">In</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">Out</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">1</td>

            <td class="px-3 py-2 border-b border-gray-700">0010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000</td>

            <td class="px-3 py-2 border-b border-gray-700">010100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000</td>

            <td class="px-3 py-2 border-b border-gray-700">01010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000</td>

            <td class="px-3 py-2 border-b border-gray-700">01010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000</td>

            <td class="px-3 py-2 border-b border-gray-700">0101000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">2</td>

            <td class="px-3 py-2 border-b border-gray-700">00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000</td>

            <td class="px-3 py-2 border-b border-gray-700">0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000</td>

            <td class="px-3 py-2 border-b border-gray-700">00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000</td>

            <td class="px-3 py-2 border-b border-gray-700">00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">3</td>

            <td class="px-3 py-2 border-b border-gray-700">000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000</td>

            <td class="px-3 py-2 border-b border-gray-700">000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000</td>

            <td class="px-3 py-2 border-b border-gray-700">0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000</td>

            <td class="px-3 py-2 border-b border-gray-700">000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

          </tr>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">Table 16: A 7-round related-key characteristic for PRESENT-128 (characteristic in the key schedule algorithm)</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Rounds</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">The differences in the key register</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

          </tr>

        </thead>

        <tbody>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">0 [Master Key]</td>

            <td class="px-3 py-2 border-b border-gray-700">000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000</td>

            <td class="px-3 py-2 border-b border-gray-700">0100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000</td>

            <td class="px-3 py-2 border-b border-gray-700">0100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000</td>

            <td class="px-3 py-2 border-b border-gray-700">01000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

          </tr>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">Using this result and the related-key differential characteristic covering  <span class="math">E_{1}</span>  (specified in [98]) with probability  <span class="math">\\hat{q} \\approx 2^{-12}</span>  presented in [98], we can produce an improved related-key rectangle attack on the 17-round PRESENT-128 using the same method presented in [98].</p>

    <p class="text-gray-300">Using the same method, we also obtain an improved related-key boomerang distinguisher for LBlock, and the result is given in Appendix F.</p>

    <p class="text-gray-300">The method presented in this paper has some limitations which we are not able to overcome. Firstly, this method is not practically applicable to evaluate the security of ARX/LRX constructions. Although we can treat the addition mod  <span class="math">2^n</span>  as a  <span class="math">2n \\times n</span>  S-box and compute the convex hull of all its differential patterns, this is impractical for real ARX ciphers where  <span class="math">n</span>  is typically at least 16. For practical tools which can be applied to ARX/LRX constructions, we refer the reader to [83, 99-103]. For ARX/LRX constructions, we think the approaches proposed by Mouha et al. [99], Aumasson et al. [103] and Kolbl [104] are promising.</p>

    <p class="text-gray-300">Secondly, the method is not exact for all ciphers. In the case of SIMON, we do not know how to construct an MILP model whose feasible region contains no invalid characteristics due to its dependent inputs. A method which can be used to construct an exact model for SIMON will make the analysis of SIMON much more convenient.</p>

    <p class="text-gray-300">Finally, it seems that the technique can be applied mostly to lightweight ciphers since the solution of a MILP model with thousands of variables and constrains is really difficult. Therefore, further investigation of how to solve such models efficiently is of great importance.</p>

    <p class="text-gray-300">In addition, if we have any progress on dealing with these limitations, we will present our new findings to the website http://siweisun.github.io/ as soon as possible.</p>

    <p class="text-gray-300">8 Conclusion</p>

    <p class="text-gray-300">In this work, we show that there is an exact linear-inequality description for any subset of <span class="math">\\{0,1\\}^{n}\\subseteq\\mathbb{R}^{n}</span>. Thanks to this, we are now able to construct MILP models whose feasible regions are exactly the sets of all valid (related-key) differential (or linear) characteristics for a wide range of ciphers. Based on these MILP models, we convert Sun et al.’s heuristic algorithm for finding (related-key) differential (or linear) characteristics into an exact one, and present a method which can be employed to find all (related-key) differential (or linear) characteristics with some given properties. Such a method is very useful in differential and linear-type cryptanalysis.</p>

    <p class="text-gray-300">Moreover, the methods presented in this paper are automatic, and can be applied to a wide range of ciphers. We have developed a Python based framework for automatic differential- and linear-type cryptanalysis. With the help of this framework, we obtain new cryptanalytic results for Serpent, SIMON, LBlock, PRESENT and DESL. In addition, we believe that the results presented in this paper can be further improved by taking more computational effort.</p>

    <h2 id="sec-17" class="text-2xl font-bold">References</h2>

    <ul class="list-disc list-inside space-y-1 text-gray-300 my-2 ml-4">

      <li>[1] Eli Biham and Adi Shamir. Differential cryptanalysis of DES-like cryptosystems. Journal of Cryptology, 4(1):3–72, 1991.</li>

      <li>[2] Mitsuru Matsui, Atsuhiro Yamagishi. A new method for known plaintext attack of FEAL cipher. In Advances in Cryptology–EUROCRYPT 1992, pages 81–91. Springer, 1993.</li>

      <li>[3] Eli Biham. New types of cryptanalytic attacks using related keys. Journal of Cryptology, 7(4):229–246, 1994.</li>

      <li>[4] Alex Biryukov, Dmitry Khovratovich and Ivica Nikolić. Distinguisher and related-key attack on the full AES-256. In Advances in Cryptology–CRYPTO 2009, pages 231–249. Springer, 2009.</li>

      <li>[5] Alex Biryukov and Dmitry Khovratovich. Related-key cryptanalysis of the full AES-192 and AES-256. In Advances in Cryptology–ASIACRYPT 2009, pages 1–18. Springer, 2009.</li>

      <li>[6] Lars R. Knudsen. Truncated and higher order differentials. In Fast Software Encryption – FSE 1995, pages 196–211. Springer, 1995.</li>

      <li>[7] Baudoin Collard and Francois-Xavier Standaert. A statistical saturation attack against the block cipher PRESENT. In Topics in Cryptology–CT-RSA 2009, pages 195–210. Springer, 2009.</li>

      <li>[8] Céline Blondeau and Kaisa Nyberg. Links between truncated differential and multidimensional linear properties of block ciphers and underlying attack complexities. In Advances in Cryptology–EUROCRYPT 2014, pages 165–182. Springer, 2014.</li>

      <li>[9] Tetsu Iwata, Kaoru Kurosawa. Probabilistic higher order differential attack and higher order bent functions. In Advances in Cryptology–ASIACRYPT 1999, pages 62–74. Springer, 1999.</li>

      <li>[10] Alex Biryukov. Impossible differential attack. In Encyclopedia of Cryptography and Security, pages 597–597. Springer, 2011.</li>

      <li>[11] Lars Knudsen. DEAL-a 128-bit block cipher. Complexity, 258(2), 1998.</li>

      <li>[12] David Wagner. The boomerang attack. In Fast Software Encryption – FSE 1999, pages 156–170. Springer, 1999.</li>

      <li>[13] Anne Canteaut, Thomas Fuhr, Henri Gilbert, María Naya-Plasencia and Jean-René Reinhard. Multiple differential cryptanalysis of round-reduced PRINCE. In Fast Software Encryption – FSE 2014. Springer, 2014.</li>

      <li>[14] Anne Canteaut, Thomas Fuhr, Henri Gilbert, María Naya-Plasencia and Jean-René Reinhard. Multiple differential cryptanalysis of round-reduced PRINCE (full version). IACR Cryptology ePrint Archive, Report 2014/089, 2014. http://eprint.iacr.org/2014/089.</li>

      <li>[15] Céline Blondeau and Benoît Gérard. Multiple differential cryptanalysis: Theory and practice. In Fast Software Encryption – FSE 2011, pages 35–54. Springer, 2011.</li>

      <li>[16] Céline Blondeau, Benoît Gérard and Kaisa Nyberg. Multiple differential cryptanalysis using LLR and <span class="math">\\chi^{2}</span> statistics. In Security and Cryptography for Networks, pages 343–360. Springer, 2012.</li>

      <li>[17] Susan K. Langford and Martin E. Hellman. Differential-linear cryptanalysis. In Advances in Cryptology–CRYPTO 1994, pages 17–25. Springer, 1994.</li>

      <li>[18] Alex Biryukov, Christophe De Canniere and Michaël Quisquater. On multiple linear approximations. In Advances in Cryptology–CRYPTO 2004, pages 1–22. Springer, 2004.</li>

      <li>[19] Burton S. Kaliski Jr., Matthew J. B. Robshaw. Linear cryptanalysis using multiple approximations. In Advances in Cryptology–CRYPTO 1994, pages 26–39. Springer, 1994.</li>

      <li>[20] Miia Hermelin, Kaisa Nyberg. Linear cryptanalysis using multiple linear approximations. IACR Cryptology ePrint Archive, Report 2011/93, 2011. https://eprint.iacr.org/2011/093.</li>

      <li>[21] Miia Hermelin, Joo Yeon Cho, Kaisa Nyberg. Multidimensional linear cryptanalysis of reduced round Serpent. In Information Security and Privacy, pages 203–215. Springer, 2008.</li>

      <li>[22] Miia Hermelin, Joo Yeon Cho and Kaisa Nyberg. Multidimensional extension of Matsuis algorithm 2. In Fast Software Encryption – FSE 2009, pages 209–227. Springer, 2009.</li>

    </ul>

    <p class="text-gray-300">-</p>

    <ul class="list-disc list-inside space-y-1 text-gray-300 my-2 ml-4">

      <li>[23] Mitsuru Matsui. On correlation between the order of S-boxes and the strength of DES. In Advances in Cryptology–EUROCRYPT 1994, pages 366–375. Springer, 1995.</li>

      <li>[24] Andrey Bogdanov, Lars R. Knudsen, Gregor Leander, Christof Paar, Axel Poschmann, Matthew J. B. Robshaw, Yannick Seurin and Charlotte Vikkelsoe. PRESENT: An ultra-lightweight block cipher. In Cryptographic Hardware and Embedded Systems – CHES 2007, pages 450–466. Springer, 2007.</li>

      <li>[25] Begül Bilgin, Andrey Bogdanov, Miroslav Knežević, Florian Mendel and Qingju Wang. Fides: Lightweight authenticated cipher with side-channel resistance for constrained hardware. In Cryptographic Hardware and Embedded Systems, pages 142–158. Springer, 2013.</li>

      <li>[26] Joan Daemen and Vincent Rijmen. AES Proposal: Rijndael. In Proceedings from the First Advanced Encryption Standard Candidate Conference, 1998.</li>

      <li>[27] Julia Borghoff, Anne Canteaut, Tim Güneysu, Elif Bilge Kavun, Lars R. Knudsen, Leander Gregor, Christof Paar, Christian Rechberger, Peter Rombouts and others. PRINCE–a low-latency block cipher for pervasive computing applications Full version. IACR Cryptology ePrint Archive, Report 2012/529, 2012. http://eprint.iacr.org/2012/529.</li>

      <li>[28] Julia Borghoff, Anne Canteaut, Tim Güneysu, Elif Bilge Kavun, Miroslav Knezevic, Lars R. Knudsen, Gregor Leander, Ventzislav Nikov, Christof Paar, Christian Rechberger, and others. PRINCE–a low-latency block cipher for pervasive computing applications. In Advances in Cryptology–ASIACRYPT 2012, pages 208–225. Springer, 2012.</li>

      <li>[29] Kazumaro Aoki, Tetsuya Ichikawa, Masayuki Kanda, Mitsuru Matsui, Shiho Moriai, Junko Nakajima and Toshio Tokita. Camellia: A 128-bit block cipher suitable for multiple platforms–design and analysis. In Selected Areas in Cryptography – SAC 2001, pages 39–56. Springer, 2001.</li>

      <li>[30] Florian Mendel, Christian Rechberger, Martin Schläffer and Søren S. Thomsen. The rebound attack: Cryptanalysis of reduced Whirlpool and Grøstl. In Fast Software Encryption – FSE 2009, pages 260–276. Springer, 2009.</li>

      <li>[31] Anne Canteaut, María Naya-Plasencia and Bastien Vayssière. Sieve-in-the-middle: improved MITM attacks. In Advances in Cryptology–CRYPTO 2013, pages 222–240. Springer, 2013.</li>

      <li>[32] Andrey Bogdanov, Dmitry Khovratovich, Christian Rechberger. Biclique cryptanalysis of the full AES. In Advances in Cryptology–ASIACRYPT 2011, pages 344–371. Springer, 2011.</li>

      <li>[33] Alex Biryukov and Ivica Nikolić . Search for related-key differential characteristics in DES-like ciphers. In Fast Software Encryption – FSE 2011, pages 18–34. Springer, 2011.</li>

      <li>[34] Alex Biryukov and Ivica Nikolić. Automatic search for related-key differential characteristics in byte-oriented block ciphers: Application to AES, Camellia, Khazad and others. In Advances in Cryptology–EUROCRYPT 2010, pages 322–344. Springer, 2010.</li>

      <li>[35] Ivica Nikolic. Tweaking AES. In Selected Areas in Cryptography – SAC 2010, pages 198–210. Springer, 2010.</li>

      <li>[36] Pierre-Alain Fouque, Jérémy Jean and Thomas Peyrin. Structural Evaluation of AES and Chosen-Key Distinguisher of 9-Round AES-128. In Advances in Cryptology–CRYPTO 2013, pages 183–203. Springer, 2013.</li>

      <li>[37] Sareh Emami, San Ling, Ivica Nikolić, Josef Pieprzyk and Huaxiong Wang. The resistance of PRESENT-80 against related-key differential attacks. Cryptography and Communications, pages 1–17, 2013.</li>

      <li>[38] Jérémy Jean, Ivica Nikolić, Thomas Peyrin. Tweaks and Keys for Block Ciphers: the TWEAKEY Framework. In Advances in Cryptology–ASIACRYPT 2014, 2014.</li>

      <li>[39] Nicky Mouha, Qingju Wang, Dawu Gu and Bart Preneel. Differential and linear cryptanalysis using mixed-integer linear programming. In Information Security and Cryptology –ISC 2012, pages 57–76. Springer, 2012.</li>

      <li>[40] Shengbao Wu and Mingsheng Wang. Security evaluation against differential cryptanalysis for block cipher structures. IACR Cryptology ePrint Archive, Report 2011/551, 2011. https://eprint.iacr.org/2011/551.</li>

      <li>[41] Mingjie Liu and Jiazhe Chen. Improved linear attacks on the Chinese block cipher standard. IACR Cryptology ePrint Archive, Report 2013/626, 2013. http://eprint.iacr.org/2013/626.</li>

      <li>[42] Shengbao Wu, Hongjun Wu, Tao Huang, Mingsheng Wang and Wenling Wu. Leaked-state-forgery attack against the authenticated encryption algorithm ALE. In Advances in Cryptology–ASIACRYPT 2013, pages 377–404. Springer, 2013.</li>

      <li>[43] Laura Winnen. Sage S-box milp toolkit. http://www.ecrypt.eu.org/tools/sage-s-box-milp-toolkit.</li>

      <li>[44] Siwei Sun, Lei Hu, Ling Song, Yonghong Xie and Peng Wang. Automatic security evaluation of block ciphers with S-bP structures against related-key differential attacks. In Inscrypt 2013, 2014.</li>

      <li>[45] Elena Andreeva, Begül Bilgin, Andrey Bogdanov, Atul Luykx, Florian Mendel, Bart Mennink, Nicky Mouha, Qingju Wang and Kan Yasuda. PRIMATE s v1. CAESAR submission, 2014. http://competitions.cr.yp.to/round1/primatesv1.pdf.</li>

      <li>[46] Elif Bilge Kavun, Martin M. Lauridsen, Gregor Leander, Christian Rechberger, Peter Schwabe and Tolga Yalcin. PrØst v1. CAESAR submission, 2014. http://competitions.cr.yp.to/round1/proestv1.pdf.</li>

      <li>[47] Jérémy Jean, Ivica Nikolić and Thomas Peyrin. Deoxys v1. CAESAR submission, 2014. http://competitions.cr.yp.to/round1/deoxysv1.pdf.</li>

      <li>[48] Jérémy Jean, Ivica Nikolić and Thomas Peyrin. Joltik v1. CAESAR submission, 2014. http://competitions.cr.yp.to/round1/joltikv1.pdf.</li>

      <li>[49] Jérémy Jean, Ivica Nikolić and Thomas Peyrin. Kiasu v1. CAESAR submission, 2014. http://competitions.cr.yp.to/round1/kiasuv1.pdf.</li>

    </ul>

    <ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">

      <li>Yu Sasaki, Yosuke Todo, Kazumaro Aoki, Yusuke Naito, Takeshi Sugawara, Yumiko Murakami, Mitsuru Matsui and Shoichi Hirose. Minalpher v1. CAESAR submission, 2014. http://competitions.cr.yp.to/round1/minalpherv1.pdf.</li>

    </ol>

    <ul class="list-disc list-inside space-y-1 text-gray-300 my-2 ml-4">

      <li>51. Siwei Sun, Lei Hu, Peng Wang, Kexin Qiao, Xiaoshuang Ma and Ling Song. Automatic Security Evaluation and (Related-key) Differential Characteristic Search: Application to SIMON, PRESENT, LBlock, DES(L) and Other Bit-oriented Block Ciphers. In Advances in Cryptology–ASIACRYPT 2014, 2014.</li>

      <li>52. Egon Balas, Robert Jeroslow. Canonical cuts on the unit hypercube. SIAM Journal on Applied Mathematics, 23(1):61–69, 1972.</li>

      <li>53. Alex Biryukov, Arnab Roy, Vesselin Velichkov. Differential analysis of block ciphers SIMON and SPECK. In Fast Software Encryption – FSE 2014. Springer, 2014.</li>

      <li>54. Guido Van Rossum et al. Python programming language. In USENIX Annual Technical Conference, 2007.</li>

      <li>55. Eli Biham, Ross Anderson and Lars Knudsen. Serpent: A new block cipher proposal. In Fast Software Encryption, pages 222–238. Springer, 1998.</li>

      <li>56. Eli Biham, Orr Dunkelman, Nathan Keller. Rectangle Attack–Rectangling the Serpent. In Advances in Cryptology–EUROCRYPT 2001, pages 340–357. Springer, 2001.</li>

      <li>57. Shusheng Liu, Zheng Gong and Libin Wang. Improved related-key differential attacks on reduced-round LBlock. In Information and Communications Security, pages 58–69. Springer, 2012.</li>

      <li>58. Ning Wang, Xiaoyun Wang, Keting Jia and Jingyuan Zhao. Improved differential attacks on reduced SIMON versions. IACR Cryptology ePrint Archive, Report 2014/448, 2014. http://eprint.iacr.org/2014/448.</li>

      <li>59. Javad Alizadeh, Hoda A. Alkhzaimi, Mohammad Reza Aref, Nasour Bagheri, Praveen Gauravaram, and Martin M.Lauridsen . Improved linear cryptanalysis of round reduced SIMON. IACR Cryptology ePrint Archive, Reprot 2014/681, 2014. http://eprint.iacr.org/2014/681.pdf.</li>

      <li>60. Jingyuan Zhao, Xiaoyun Wang, Meiqin Wang, Xiaoyang Dong. Differential Analysis on Block Cipher PRIDE. IACR Cryptology ePrint Archive, Report 2014/525, 2014. http://eprint.iacr.org/2014/525.</li>

      <li>61. Qianqian Yang, Lei Hu, Siwei Sun, Kexin Qiao, Ling Song, Jinyong Shan, Xiaoshuang Ma. Improved Differential Analysis of Block Cipher PRIDE. IACR Cryptology ePrint Archive, Report 2014/978, 2014. http://eprint.iacr.org/2014/978.</li>

      <li>62. Martin R. Albrecht, Benedikt Driessen, Elif Bilge Kavun, Gregor Leander, Christof Paar, Tolga Yalçın. Block Ciphers–Focus on the Linear Layer (feat. PRIDE). In Advances in Cryptology–CRYPTO 2014, pages 57–76. Springer, 2014.</li>

      <li>63. Danping Shi, Lei Hu, Siwei Sun, Ling Song, Kexin Qiao, Xiaoshuang Ma. Improved Linear (hull) Cryptanalysis of Round-reduced Versions of SIMON. IACR Cryptology ePrint Archive, Report 2014/973, 2014. http://eprint.iacr.org/2014/973.</li>

      <li>64. Franco P. Preparata and Michael I. Shamos. Computational geometry: An introduction. 1985.</li>

      <li>65. Jacob E. Goodman and Joseph O’Rourke. Handbook of discrete and computational geometry. CRC press, 2010.</li>

      <li>66. Joseph O’Rourke. Computational geometry in C. Cambridge university press, 1998.</li>

      <li>67. Mark de Berg, Marc van Kreveld, Mark Overmars and Otfried Schwarzkopf. Computational geometry: Algorithms and applications. 2000.</li>

      <li>68. Zheng Gong, Svetla Nikova and Yee Wei Law. KLEIN: a new family of lightweight block ciphers. In RFID. Security and Privacy, pages 1–18. Springer, 2012.</li>

      <li>69. Kyoji Shibutani, Takanori Isobe, Harunaga Hiwatari, Atsushi Mitsuda, Toru Akishita and Taizo Shirai. Piccolo: an ultra-lightweight blockcipher. In Cryptographic Hardware and Embedded Systems – CHES 2011, pages 342–357. Springer, 2011.</li>

      <li>70. Tomoyasu Suzaki, Kazuhiko Minematsu, Sumio Morioka and Eita Kobayashi. TWINE: A lightweight, versatile block cipher. In ECRYPT Workshop on Lightweight Cryptography, pages 146–169, 2011.</li>

      <li>71. Maryam Izadi, Babak Sadeghiyan, Seyed Saeed Sadeghian and Hossein Arabnezhad Khanooki. MIBS: a new lightweight block cipher. In Cryptology and Network Security, pages 334–348. Springer, 2009.</li>

      <li>72. Jian Guo, Thomas Peyrin, Axel Poschmann, Matthew J. B. Robshaw. The LED block cipher. In Cryptographic Hardware and Embedded Systems – CHES 2011, pages 326–341. Springer, 2011.</li>

      <li>73. Wenling Wu and Lei Zhang. LBlock: a lightweight block cipher. In Applied Cryptography and Network Security – ACNS 2011, pages 327–344. Springer, 2011.</li>

      <li>74. Gurobi Optimization. Gurobi optimizer reference manual. 2013. http://www.gurobi.com.</li>

      <li>75. Tobias Achterberg. SCIP-a framework to integrate constraint and mixed integer programming. Konrad-Zuse-Zentrum für Informationstechnik Berlin, 2004.</li>

      <li>76. Kazuo Ohta, Shiho Moriai, Kazumaro Aoki. Improving the search algorithm for the best linear expression. In Advances in Cryptology – CRYPTO 1995, pages 157–170. Springer, 1995.</li>

      <li>77. Kazumaro Aoki, Kunio Kobayashi, Shiho Moriai. Best differential characteristic search of feal. In Fast Software Encryption – FSE, pages 41–53. Springer, 1997.</li>

      <li>78. Zhenzhen Bao, Wentao Zhang, Dongdai Lin. Speeding up the Search Algorithm for the Best Differential and Best Linear Trails. In Inscrypt 2014, 2014.</li>

      <li>79. Meiqin Wang, Yue Sun, Elmar Tischhauser and Bart Preneel. A model for structure attacks, with applications to PRESENT and Serpent. In Fast Software Encryption – FSE 2012, pages 49–68. Springer, 2012.</li>

    </ul>

    <ul class="list-disc list-inside space-y-1 text-gray-300 my-2 ml-4">

      <li>[80] Xuejia Lai, James L. Massey and Sean Murphy. Markov ciphers and differential cryptanalysis. In Advances in Cryptology–EUROCRYPT 1991, pages 17–38. Springer, 1991.</li>

      <li>[81] Yue Sun, Meiqin Wang, Shujia Jiang and Qiumei Sun. Differential cryptanalysis of reduced-round ICEBERG. In Progress in Cryptology–AFRICACRYPT 2012, pages 155–171. Springer, 2012.</li>

      <li>[82] Hoda A. Alkhzaimi, Martin M. Lauridsen. Cryptanalysis of the SIMON family of block ciphers. IACR Cryptology ePrint Archive, Report 2013/543, 2013. http://eprint.iacr.org/2013/543.</li>

      <li>[83] Alex Biryukov and Vesselin Velichkov. Automatic search for differential trails in ARX ciphers. In Topics in Cryptology–CT-RSA 2014, pages 227–250. Springer, 2014.</li>

      <li>[84] Ray Beaulieu, Douglas Shors, Jason Smith, Stefan Treatman-Clark, Bryan Weeks and Louis Wingers. The SIMON and SPECK families of lightweight block ciphers. IACR Cryptology ePrint Archive, Report 2013/404, 2013. http://eprint.iacr.org/2013/404.</li>

      <li>[85] Farzaneh Abed, Eik List, Jakob Wenzel and Stefan Lucks. Differential cryptanalysis of round-reduced SIMON and SPECK. In Fast Software Encryption – FSE 2014, 2014.</li>

      <li>[86] Javad Alizadeh, Nasour Bagheri, Praveen Gauravaram, Abhishek Kumar, and Somitra Kumar Sanadhya. Linear cryptanalysis of round reduced SIMON. IACR Cryptology ePrint Archive, Report 2013/663, 2013. http://eprint.iacr.org/2013/663.</li>

      <li>[87] Christina Boura, Mara Naya-Plasencia, Valentin Suder. Scrutinizing and Improving Impossible Differential Attacks: Applications to CLEFIA, Camellia, LBlock and Simon. In Advances in Cryptology–ASIACRYPT 2014, pages 179–199, 2014.</li>

      <li>[88] Kaisa Nyberg. Linear approximation of block ciphers. In Advances in Cryptology–EUROCRYPT 1994, pages 439–444. Springer, 1995.</li>

      <li>[89] Jorge Nakahara Jr, Pouyan Sepehrdad, Bingsheng Zhang and Meiqin Wang. Linear (hull) and algebraic cryptanalysis of the block cipher PRESENT. In Cryptology and Network Security, pages 58–75. Springer, 2009.</li>

      <li>[90] Gregor Leander. On linear hulls, statistical saturation attacks, PRESENT and a cryptanalysis of PUFFIN. In Advances in Cryptology–EUROCRYPT 2011, pages 303–322. Springer, 2011.</li>

      <li>[91] Kenji Ohkuma. Weak keys of reduced-round PRESENT for linear cryptanalysis. In Selected Areas in Cryptography – SAC 2009, pages 249–265. Springer, 2009.</li>

      <li>[92] Mohamed Ahmed Abdelraheem, Martin Ågren, Peter Beelen and Gregor Leander. On the distribution of linear biases: Three instructive examples. In Advances in Cryptology–CRYPTO 2012, pages 50–67. Springer, 2012.</li>

      <li>[93] Sean Murphy. The effectiveness of the linear hull effect. Journal of Mathematical Cryptology, 6(2):137–147, 2012.</li>

      <li>[94] Stanislav Bulygin. More on linear hulls of PRESENT-like ciphers and a cryptanalysis of full-round EPCBC–96. IACR Cryptology ePrint Archive, Report 2013/028, 2013. https://eprint.iacr.org/2013/028.</li>

      <li>[95] Mohamed Ahmed Abdelraheem. Estimating the probabilities of low-weight differential and linear approximations on present-like ciphers. In Information Security and Cryptology–ICISC 2012, pages 368–382. Springer, 2013.</li>

      <li>[96] Mitsuru Matsui. Linear cryptanalysis method for des cipher. In Advances in Cryptology–EUROCRYPT 1993, pages 386–397. Springer, 1994.</li>

      <li>[97] John Kelsey, Tadayoshi Kohno and Bruce Schneier. Amplified boomerang attacks against reduced-round MARS and Serpent. In Fast Software Encryption – FSE 2001, pages 75–93. Springer, 2001.</li>

      <li>[98] Onur Özen, Kerem Varıcı, Cihangir Tezcan and Çelebi Kocair. Lightweight block ciphers revisited: Cryptanalysis of reduced round PRESENT and HIGHT. In Information Security and Privacy, pages 90–107. Springer, 2009.</li>

      <li>[99] Nicky Mouha and Bart Preneel. Towards finding optimal differential characteristics for ARX: Application to Salsa20. IACR Cryptology ePrint Archive, Report 2013/328, 2013. http://eprint.iacr.org/2013/328.</li>

      <li>[100] Gaëtan Leurent. Construction of differential characteristics in ARX designs application to skein. In Advances in Cryptology–CRYPTO 2013, pages 241–258. Springer, 2013.</li>

      <li>[101] Helger Lipmaa and Shiho Moriai. Efficient algorithms for computing differential properties of addition. In Fast Software Encryption – FSE 2002, pages 336–350. Springer, 2002.</li>

      <li>[102] Helger Lipmaa, Johan Wallén, and Philippe Dumas. On the additive differential probability of exclusive-or. In Fast Software Encryption – FSE 2004, pages 317–331. Springer, 2004.</li>

      <li>[103] Jean-Philippe Aumasson, Philipp Jovanovic, Samuel Neves. Analysis of NORX: Investigating Differential and Rotational Properties. In Latincrypt 2014, 2014.</li>

      <li>[104] Stefan Kölbl. CryptoSMT: An easy to use tool for cryptanalysis of symmetric primitives. https://github.com/kste/cryptosmt.</li>

      <li>[105] Xiaoyun Wang and L. C. K. Hui etc. Differential cryptanalysis of an AES finalist-Serpent. 2000. Technical report.</li>

      <li>[106] Ali Aydın Selçuk. On probability of success in linear and differential cryptanalysis. Journal of Cryptology, 21(1):131–147, 2008.</li>

    </ul>

    <h2 id="sec-18" class="text-2xl font-bold">Appendix A Constructing MILP Models for Automatic Linear Analysis</h2>

    <p class="text-gray-300">Based on Sun et al.’s methods <em>[44, 51]</em>, we can construct an MILP model whose feasible region is exactly the set of all valid linear characteristics for a cipher involving the following operations</p>

    <ul class="list-disc list-inside space-y-1 text-gray-300 my-2 ml-4">

      <li>bitwise XOR;</li>

      <li>bitwise permutation <span class="math">L</span> which permutes the bit positions of a <span class="math">n</span> dimensional vector in <span class="math">\\mathbb{F}_{2}^{n}</span>;</li>

      <li>three-forked branch operation (see <em>[39]</em>);</li>

      <li>S-box, <span class="math">\\mathcal{S}:\\mathbb{F}_{2}^{\\omega}\\rightarrow\\mathbb{F}_{2}^{\\nu}</span>.</li>

    </ul>

    <p class="text-gray-300">For every bit of the linear masks introduce a 0-1 variable <span class="math">x_{i}</span>. Also, for every S-box in the schematic description of the cipher under consideration, introduce a new 0-1 variable <span class="math">A_{j}</span> such that</p>

    <p class="text-gray-300">\\[ A_{j}=\\left\\{\\begin{array}[]{ll}1,&\\text{if the output mask of the Sbox is nonzero,}\\\\ 0,&\\text{otherwise.}\\end{array}\\right. \\]</p>

    <p class="text-gray-300">Here we say that <span class="math">A_{j}</span> indicates the linear activity of an S-box, or an S-box is marked by <span class="math">A_{j}</span>.</p>

    <p class="text-gray-300">Objective Function. The objective function is to minimize the sum of all variables indicating the linear activities of the S-boxes appearing in the schematic description of the cipher: <span class="math">\\sum_{j}A_{j}</span>.</p>

    <p class="text-gray-300">Constraints. For every XOR operation with input masks <span class="math">a,b</span> and output mask <span class="math">c</span>, include the following constraints</p>

    <p class="text-gray-300"><span class="math">a=b=c.</span> (9)</p>

    <p class="text-gray-300">For every three-forked branch with input mask <span class="math">a</span>, and output mask <span class="math">b,c</span>, include the following constraints</p>

    <p class="text-gray-300">\\[ \\left\\{\\begin{array}[]{ll}d_{\\!\\!{\\bf\\scriptscriptstyle\\cal A}}\\geq a,~{}d_{\\!\\!{\\bf\\scriptscriptstyle\\cal A}}\\geq b,~{}d_{\\!\\!{\\bf\\scriptscriptstyle\\cal A}}\\geq c\\\\ a+b+c\\geq d_{\\!\\!{\\bf\\scriptscriptstyle\\cal A}}\\\\ a+b+c\\leq 2\\end{array}\\right. \\] (10)</p>

    <p class="text-gray-300">where <span class="math">d_{\\!\\!{\\bf\\scriptscriptstyle\\cal A}}</span> is a dummy variable.</p>

    <p class="text-gray-300">Assuming <span class="math">(x_{i_{0}},\\ldots,x_{i_{\\omega-1}})</span> and <span class="math">(y_{i_{0}},\\ldots,y_{i_{\\nu-1}})</span> are the input and output linear masks of an <span class="math">\\omega\\times\\nu</span> S-box marked by <span class="math">A_{t}</span>, we have</p>

    <p class="text-gray-300">\\[ \\left\\{\\begin{array}[]{ll}A_{t}-y_{i_{k}}\\geq 0,~{}k\\in\\{0,\\ldots,\\nu-1\\}\\\\ (\\sum\\limits_{j=0}^{\\nu-1}y_{i_{j}})-A_{t}\\geq 0\\end{array}\\right. \\] (11)</p>

    <p class="text-gray-300">which ensures that nonzero output linear mask must activate the S-box.</p>

    <p class="text-gray-300">For an bijective S-box we have</p>

    <p class="text-gray-300">\\[ \\left\\{\\begin{array}[]{ll}\\omega\\sum\\limits_{k=0}^{\\nu-1}y_{j_{k}}-\\sum\\limits_{k=0}^{\\omega-1}x_{i_{k}}\\geq 0\\\\ \\nu\\sum\\limits_{k=0}^{\\omega-1}x_{i_{k}}-\\sum\\limits_{k=0}^{\\nu-1}y_{j_{k}}\\geq 0\\end{array}\\right. \\] (12)</p>

    <p class="text-gray-300">since nonzero input linear mask must result in nonzero output linear mask and vice versa.</p>

    <p class="text-gray-300">For every S-box appearing in the schematic description of the cipher, compute the critical set <span class="math">\\mathcal{O}_{S}</span> of <span class="math">\\mathcal{H}_{\\mathrm{conv}(\\mathcal{M}_{S})}</span> using Algorithm 1, and add all the linear inequalities in the critical set to the MILP model, where <span class="math">\\mathcal{M}_{S}</span> is defined as following.</p>

    <h6 id="sec-19" class="text-base font-medium mt-4">Definition 7.</h6>

    <p class="text-gray-300">Let <span class="math">S</span> be an arbitrary <span class="math">\\omega\\times\\nu</span> S-box such that <span class="math">(x_{0},\\ldots,x_{\\omega-1})</span> and <span class="math">(y_{0},\\ldots,y_{\\nu-1})</span> are its input and output linear masks respectively. The linear approximation set <span class="math">\\mathcal{M}_{S}</span> of <span class="math">S</span> is defined to be the set of all linear approximation patterns of <span class="math">S</span>. That is, <span class="math">\\mathcal{M}_{S}=\\{(x_{0},\\ldots,x_{\\omega-1},y_{0},\\ldots,y_{\\nu-1})\\in\\mathbb{B}^{\\omega+\\nu}:\\text{the bias of the resulting linear approximation is nonzero}\\}</span>.</p>

    <h2 id="sec-20" class="text-2xl font-bold">Appendix B The Security Bound of Serpent with respect to Single-key Differential Attack</h2>

    <p class="text-gray-300">We apply the method for obtaining the exact lower bound of the number of active S-boxes to Serpent, one of the AES finalists, and the results are summarized in Table 17, from which we can deduce that the probability of the best single-key differential characteristic for the 27-round Serpent is upper bounded by <span class="math">(2^{-2})^{8+7+8+7+7+7+7+7+8}=2^{-132}</span>, and the result is obtained on a PC in no more than 1.3 hours.</p>

    <p class="text-gray-300">At the time of the AES selection process, it is very hard to obtain the security bound of Serpent with respect to the single-key differential attack , and the designers of Serpent conjectured that the probability of the best 28-round differential for Serpent is not higher than <span class="math">2^{-120}</span>. In this work, our tool confirms this conjecture automatically. Note that this is not the best published bound for Serpent (see Wang et al.’s work <em>[105]</em>). However, compared with Wang et al.’s method <em>[105]</em> which involves tedious case by case study of the differential propagation, our approach is much more simple and straightforward.</p>

    <p class="text-gray-300">Table 17: The exact lower bounds of the number of differentially active S-boxes for round-reduced variants of Serpent in the single-key model. Note that there is no need to computed the model covering rounds 24-25-26 since it uses the same S-boxes as rounds 0-1-2.</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Rounds covered</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">S-boxes used</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">#Active S-boxes</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Time (in seconds)</th>

          </tr>

        </thead>

        <tbody>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">0-1-2</td>

            <td class="px-3 py-2 border-b border-gray-700"><span class="math">S_{0}</span>-<span class="math">S_{1}</span>-<span class="math">S_{2}</span></td>

            <td class="px-3 py-2 border-b border-gray-700">8</td>

            <td class="px-3 py-2 border-b border-gray-700">897</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">3-4-5</td>

            <td class="px-3 py-2 border-b border-gray-700"><span class="math">S_{3}</span>-<span class="math">S_{4}</span>-<span class="math">S_{5}</span></td>

            <td class="px-3 py-2 border-b border-gray-700">7</td>

            <td class="px-3 py-2 border-b border-gray-700">481</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">6-7-8</td>

            <td class="px-3 py-2 border-b border-gray-700"><span class="math">S_{6}</span>-<span class="math">S_{7}</span>-<span class="math">S_{0}</span></td>

            <td class="px-3 py-2 border-b border-gray-700">8</td>

            <td class="px-3 py-2 border-b border-gray-700">985</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">9-10-11</td>

            <td class="px-3 py-2 border-b border-gray-700"><span class="math">S_{1}</span>-<span class="math">S_{2}</span>-<span class="math">S_{3}</span></td>

            <td class="px-3 py-2 border-b border-gray-700">7</td>

            <td class="px-3 py-2 border-b border-gray-700">370</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">12-13-14</td>

            <td class="px-3 py-2 border-b border-gray-700"><span class="math">S_{4}</span>-<span class="math">S_{5}</span>-<span class="math">S_{6}</span></td>

            <td class="px-3 py-2 border-b border-gray-700">7</td>

            <td class="px-3 py-2 border-b border-gray-700">288</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">15-16-17</td>

            <td class="px-3 py-2 border-b border-gray-700"><span class="math">S_{7}</span>-<span class="math">S_{0}</span>-<span class="math">S_{1}</span></td>

            <td class="px-3 py-2 border-b border-gray-700">7</td>

            <td class="px-3 py-2 border-b border-gray-700">331</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">18-19-20</td>

            <td class="px-3 py-2 border-b border-gray-700"><span class="math">S_{2}</span>-<span class="math">S_{3}</span>-<span class="math">S_{4}</span></td>

            <td class="px-3 py-2 border-b border-gray-700">7</td>

            <td class="px-3 py-2 border-b border-gray-700">536</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">21-22-23</td>

            <td class="px-3 py-2 border-b border-gray-700"><span class="math">S_{5}</span>-<span class="math">S_{6}</span>-<span class="math">S_{7}</span></td>

            <td class="px-3 py-2 border-b border-gray-700">7</td>

            <td class="px-3 py-2 border-b border-gray-700">491</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">24-25-26</td>

            <td class="px-3 py-2 border-b border-gray-700"><span class="math">S_{0}</span>-<span class="math">S_{1}</span>-<span class="math">S_{2}</span></td>

            <td class="px-3 py-2 border-b border-gray-700">8</td>

            <td class="px-3 py-2 border-b border-gray-700">No need to compute</td>

          </tr>

        </tbody>

      </table>

    </div>

    <h2 id="sec-21" class="text-2xl font-bold">Appendix C Linear Characteristic of SIMON128</h2>

    <p class="text-gray-300">The 55-round characteristic we find for SIMON128 with bias <span class="math">2^{-109}</span> is given in Table 18 and Table 19. Note that the previously published longest linear characteristic for SIMON128 is a 52-round characteristic with bias <span class="math">2^{-128}</span> [59]. Before the readers checking this characteristic, we would like to give a remark on the computation of the bias of the linear characteristic for SIMON.</p>

    <p class="text-gray-300"><span class="math">L^{r}</span>: the left half input of the <span class="math">r</span>-th round <span class="math">R^{r}</span>: the right half input of the <span class="math">r</span>-th round <span class="math">K^{r}</span>: the subkey of the <span class="math">r</span>-th round <span class="math">X[j]</span>: the <span class="math">(j\\bmod 64)</span>-th bit of <span class="math">X</span> <span class="math">X\\lll i</span>: the left circular shift of <span class="math">X</span> by <span class="math">i</span> bits <span class="math">\\wedge</span>: bitwise AND <span class="math">S</span>: the <span class="math">2\\times 1</span> S-box with 2-bit input and 1-bit output, that is, <span class="math">S(x,y)=x\\wedge y</span></p>

    <p class="text-gray-300">Under the above notations, the round function can be described as follows</p>

    <p class="text-gray-300"><span class="math">L^{r+1}</span> <span class="math">=R^{r}\\oplus K^{r}\\oplus(L^{r}\\lll 2)\\oplus(G(L^{r}))</span> <span class="math">R^{r+1}</span> <span class="math">=L^{r}</span></p>

    <p class="text-gray-300">where <span class="math">G(L^{r})=(L^{r}\\lll 1)\\wedge(L^{r}\\lll 8)</span>.</p>

    <p class="text-gray-300">Clearly, <span class="math">G(L^{r})[j]=L^{r}[j+1]\\wedge(L^{r}[j+8])=S(L^{r}[j+1],L^{r}[j+8])</span>. Let <span class="math">\\alpha^{r}</span> be the mask of <span class="math">L^{r}\\lll 1</span>, <span class="math">\\beta^{r}</span> be the mask of <span class="math">L^{r}\\lll 8</span>, and <span class="math">\\gamma^{r}</span> be the output mask of <span class="math">G(L^{r})</span>. Let <span class="math">y^{r}</span> be the 64-bit output of <span class="math">G(L^{r})</span>. Then</p>

    <p class="text-gray-300"><span class="math">y^{r}[j]=L^{r}[j+1]\\wedge L^{r}[j+8]=S(L^{r}[j+1],L^{r}[j+8]).</span></p>

    <p class="text-gray-300">The linear approximation expression of the <span class="math">j</span>th AND operation in the <span class="math">r</span>th round is</p>

    <p class="text-gray-300"><span class="math">\\alpha^{r}[j]\\cdot L^{r}[j+1]\\oplus\\beta^{r}[j]\\cdot L^{r}[j+8]=\\gamma^{r}[j]\\cdot y^{r}[j],</span> (13)</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">and we assume (13) holds with probability <span class="math">P^{r}[j]</span>. Let $\\epsilon^{r}[j]=</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">P^{r}[j]-1/2</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"><span class="math"> be the bias of (13). If </span>\\gamma^{r}[j]=0<span class="math">, then </span>(\\alpha^{r}[j],\\beta^{r}[j])=(0,0)<span class="math"> and </span>\\epsilon^{r}[j]=1/2<span class="math">. If </span>\\gamma^{r}[j]\\neq 0<span class="math">, then </span>\\epsilon^{r}[j]=1/4$.</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">Typically, the inputs of the S-boxes in each round of a cipher are independent. However, this is not the case for SIMON. Therefore, we should be careful when compute the bias of the characteristics for SIMON. For example,</p>

    <p class="text-gray-300"><span class="math">y^{r}[1]</span> <span class="math">=S(L^{r}[2],L^{r}[9])</span> <span class="math">y^{r}[8]</span> <span class="math">=S(L^{r}[9],L^{r}[16])</span></p>

    <p class="text-gray-300">Suppose these two S-boxes are both active, then the two linear approximation expressions are</p>

    <p class="text-gray-300"><span class="math">\\alpha^{r}[1]\\cdot L^{r}[2]\\oplus\\beta^{r}[1]\\cdot L^{r}[9]\\oplus y^{r}[1]=0</span> (14) <span class="math">\\alpha^{r}[8]\\cdot L^{r}[9]\\oplus\\beta^{r}[8]\\cdot L^{r}[16]\\oplus y^{r}[8]=0</span> (15)</p>

    <p class="text-gray-300">If (14) and (15) are independent, then the bias of (14) + (15) would be <span class="math">2^{-3}=2\\cdot 2^{-2}\\cdot 2^{-2}</span> according to the piling-up lemma. However (14) and (15) are not independent here, and the bias of</p>

    <p class="text-gray-300"><span class="math">\\alpha^{r}[1]\\cdot L^{r}[2]\\oplus\\beta^{r}[1]\\cdot L^{r}[9]\\oplus y^{r}[1]\\oplus\\alpha^{r}[8]\\cdot L^{r}[9]\\oplus\\beta^{r}[8]\\cdot L^{r}[16]\\oplus y^{r}[8]</span> <span class="math">=</span> <span class="math">\\alpha^{r}[1]\\cdot L^{r}[2]\\oplus\\beta^{r}[1]\\cdot L^{r}[9]\\oplus\\alpha^{r}[8]\\cdot L^{r}[9]\\oplus\\beta^{r}[8]\\cdot L^{r}[16]\\oplus L^{r}[2]\\cdot L^{r}[9]\\oplus L^{r}[9]\\cdot L^{r}[16]</span> <span class="math">=</span> <span class="math">\\alpha^{r}[1]\\cdot L^{r}[2]\\oplus(\\beta^{r}[1]\\oplus\\alpha^{r}[8])\\cdot L^{r}[9]\\oplus\\beta^{r}[8]\\cdot L^{r}[16]\\oplus(L^{r}[2]\\oplus L^{r}[16])\\cdot L^{r}[9]</span> <span class="math">=</span> <span class="math">0</span></p>

    <p class="text-gray-300">is <span class="math">0</span> or <span class="math">2^{-2}\\neq 2\\cdot 2^{-2}\\cdot 2^{-2}</span>. Hence, when we compute the bias of the characteristic of SIMON, we should take this phenomenon into account.</p>

    <h2 id="sec-22" class="text-2xl font-bold">Appendix D A 16-round Related-key Differential of LBlock</h2>

    <p class="text-gray-300">We find a 16-round standard (non truncated) related-key differential with probability <span class="math">2^{-55.64}</span>, which is even better than the previously published best truncated related-key differential for the 16-round LBlock whose probability is about <span class="math">2^{-59}</span> <em>[57]</em>.</p>

    <p class="text-gray-300">This related-key differential characteristic is discovered as follows. Firstly, by using the method presented in Sect. 4.2, we find a related-key differential characteristic for the 15-round LBlock with 23 active S-boxes and probability <span class="math">2^{-63}</span> (see Table 20 and Table 21).</p>

    <p class="text-gray-300">Then, we use the method presented in Sect. 5.1 to search for all related-key differential characteristics whose input/output differences and master-key difference are fixed to the values suggested in Table 20 and Table 21 respectively. To further reduce the searching space, we require that any one of these characteristics has at most 25 active S-boxes.</p>

    <p class="text-gray-300">Finally, we find all the characteristics enjoying the above properties, and the distribution of these characteristics are given in Table 22. Interestingly, all these characteristics share the same differential patterns in the key schedule algorithm.</p>

    <p class="text-gray-300">From Table 22, it can be computed that the probability of the 15-round related-key differential for LBlock specified by the input, output and master-key differences given in Table 20 and Table 21 is at least <span class="math">2^{-53.64}</span>. Since the Hamming weight of the left part of the output difference of the 15th round is low and the subkey difference of the 16th round is 0, by extending one more round of this related-key differential, we obtain a related-key differential with probability at least <span class="math">2^{-(53.64+2)}=2^{-55.64}</span>.</p>

    <p class="text-gray-300">Table 18: A 55-round linear characteristic for SIMON128 (the input masks of the left parts)</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Rounds</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">The input linear mask of the left half</th>

          </tr>

        </thead>

        <tbody>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">0</td>

            <td class="px-3 py-2 border-b border-gray-700">00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">1</td>

            <td class="px-3 py-2 border-b border-gray-700">00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">2</td>

            <td class="px-3 py-2 border-b border-gray-700">0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">3</td>

            <td class="px-3 py-2 border-b border-gray-700">0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">4</td>

            <td class="px-3 py-2 border-b border-gray-700">000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">5</td>

            <td class="px-3 py-2 border-b border-gray-700">00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">6</td>

            <td class="px-3 py-2 border-b border-gray-700">000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">7</td>

            <td class="px-3 py-2 border-b border-gray-700">000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">8</td>

            <td class="px-3 py-2 border-b border-gray-700">0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">9</td>

            <td class="px-3 py-2 border-b border-gray-700">00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">10</td>

            <td class="px-3 py-2 border-b border-gray-700">000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">11</td>

            <td class="px-3 py-2 border-b border-gray-700">00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">12</td>

            <td class="px-3 py-2 border-b border-gray-700">000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">13</td>

            <td class="px-3 py-2 border-b border-gray-700">0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">14</td>

            <td class="px-3 py-2 border-b border-gray-700">000000000000000000000000000000000000000000000000000000000000000000000000000000000000</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">15</td>

            <td class="px-3 py-2 border-b border-gray-700">000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">16</td>

            <td class="px-3 py-2 border-b border-gray-700">000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">17</td>

            <td class="px-3 py-2 border-b border-gray-700">0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">18</td>

            <td class="px-3 py-2 border-b border-gray-700">000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">19</td>

            <td class="px-3 py-2 border-b border-gray-700">0000000000000000000000000000000000000000000000000000000000000000000000000000000000</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">20</td>

            <td class="px-3 py-2 border-b border-gray-700">00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">21</td>

            <td class="px-3 py-2 border-b border-gray-700">00000000000000000000000000000000000000000000000000000000000000000000000000000000000000</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">22</td>

            <td class="px-3 py-2 border-b border-gray-700">0000000000000000000000000000000000000000000000000000000000000000000000000000000000000</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">23</td>

            <td class="px-3 py-2 border-b border-gray-700">0000000000000000000000000000000000000000000000000000000000000000000000000000000000000</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">24</td>

            <td class="px-3 py-2 border-b border-gray-700">0000000000000000000000000000000000000000000000000000000000000000000000000000000000000</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">25</td>

            <td class="px-3 py-2 border-b border-gray-700">000000000000000000000000000000000000000000000000000000000000000000000000000000</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">26</td>

            <td class="px-3 py-2 border-b border-gray-700">0000000000000000000000000000000000000000000000000000000000000000000000000000000000</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">27</td>

            <td class="px-3 py-2 border-b border-gray-700">0000000000000000000000000000000000000000000000000000000000000000000000000000000000</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">28</td>

            <td class="px-3 py-2 border-b border-gray-700">00000000000000000000000000000000000000000000000000000000000000000000000000000000</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">29</td>

            <td class="px-3 py-2 border-b border-gray-700">000000000000000000000000000000000000000000000000000000000000000000000000000</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">30</td>

            <td class="px-3 py-2 border-b border-gray-700">000000000000000000000000000000000000000000000000000000000000000000000000000000000</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">31</td>

            <td class="px-3 py-2 border-b border-gray-700">00000000000000000000000000000000000000000000000000000000000000000000000000000000000</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">32</td>

            <td class="px-3 py-2 border-b border-gray-700">00000000000000000000000000000000000000000000000000000000000000000000000000000000000</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">33</td>

            <td class="px-3 py-2 border-b border-gray-700">000000000000000000000000000000000000000000000000000000000000000000000000000000000000</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">34</td>

            <td class="px-3 py-2 border-b border-gray-700">0000000000000000000000000000000000000000000000000000000000000000000000000000000000</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">35</td>

            <td class="px-3 py-2 border-b border-gray-700">0000000000000000000000000000000000000000000000000000000000000000000000000000</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">36</td>

            <td class="px-3 py-2 border-b border-gray-700">000000000000000000000000000000000000000000000000000000000000000000000000000</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">37</td>

            <td class="px-3 py-2 border-b border-gray-700">000000000000000000000000000000000000000000000000000000000000000000000000000</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">38</td>

            <td class="px-3 py-2 border-b border-gray-700">000000000000000000000000000000000000000000000000000000000000000000000000000</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">39</td>

            <td class="px-3 py-2 border-b border-gray-700">000000000000000000000000000000000000000000000000000000000000000000000000000</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">40</td>

            <td class="px-3 py-2 border-b border-gray-700">000000000000000000000000000000000000000000000000000000000000000000000000000</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">41</td>

            <td class="px-3 py-2 border-b border-gray-700">000000000000000000000000000000000000000000000000000000000000000000000000000</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">42</td>

            <td class="px-3 py-2 border-b border-gray-700">000000000000000000000000000000000000000000000000000000000000000000000000000</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">43</td>

            <td class="px-3 py-2 border-b border-gray-700">0000000000000000000000000000000000000000000000000000000000000000000</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">44</td>

            <td class="px-3 py-2 border-b border-gray-700">0000000000000000000000000000000000000000000000000000000000000000</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">45</td>

            <td class="px-3 py-2 border-b border-gray-700">000000000000000000000000000000000000000000000000000000000000</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">46</td>

            <td class="px-3 py-2 border-b border-gray-700">0000000000000000000000000000000000000000000000000000000000</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">47</td>

            <td class="px-3 py-2 border-b border-gray-700">0000000000000000000000000000000000000000000000000000000000</td>

          </tr>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">Table 19: A 55-round linear characteristic for SIMON128 (the input masks of the right parts)</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Rounds</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">The input linear mask of the right half</th>

          </tr>

        </thead>

        <tbody>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">0</td>

            <td class="px-3 py-2 border-b border-gray-700">00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">1</td>

            <td class="px-3 py-2 border-b border-gray-700">0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">2</td>

            <td class="px-3 py-2 border-b border-gray-700">00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">3</td>

            <td class="px-3 py-2 border-b border-gray-700">00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">4</td>

            <td class="px-3 py-2 border-b border-gray-700">000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">5</td>

            <td class="px-3 py-2 border-b border-gray-700">00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">6</td>

            <td class="px-3 py-2 border-b border-gray-700">000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">7</td>

            <td class="px-3 py-2 border-b border-gray-700">0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">8</td>

            <td class="px-3 py-2 border-b border-gray-700">00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">9</td>

            <td class="px-3 py-2 border-b border-gray-700">0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">10</td>

            <td class="px-3 py-2 border-b border-gray-700">000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">11</td>

            <td class="px-3 py-2 border-b border-gray-700">000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">12</td>

            <td class="px-3 py-2 border-b border-gray-700">000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">13</td>

            <td class="px-3 py-2 border-b border-gray-700">0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">14</td>

            <td class="px-3 py-2 border-b border-gray-700">0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">15</td>

            <td class="px-3 py-2 border-b border-gray-700">0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">16</td>

            <td class="px-3 py-2 border-b border-gray-700">00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">17</td>

            <td class="px-3 py-2 border-b border-gray-700">0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">18</td>

            <td class="px-3 py-2 border-b border-gray-700">00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">19</td>

            <td class="px-3 py-2 border-b border-gray-700">0000000000000000000000000000000000000000000000000000000000000000000000000000000000000</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">20</td>

            <td class="px-3 py-2 border-b border-gray-700">0000000000000000000000000000000000000000000000000000000000000000000000000000000000000</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">21</td>

            <td class="px-3 py-2 border-b border-gray-700">000000000000000000000000000000000000000000000000000000000000000000000000000000000000</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">22</td>

            <td class="px-3 py-2 border-b border-gray-700">000000000000000000000000000000000000000000000000000000000000000000000000000000000000</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">23</td>

            <td class="px-3 py-2 border-b border-gray-700">000000000000000000000000000000000000000000000000000000000000000000000000000000000000</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">24</td>

            <td class="px-3 py-2 border-b border-gray-700">000000000000000000000000000000000000000000000000000000000000000000000000000000000000</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">25</td>

            <td class="px-3 py-2 border-b border-gray-700">00000000000000000000000000000000000000000000000000000000000000000000000000000</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">26</td>

            <td class="px-3 py-2 border-b border-gray-700">00000000000000000000000000000000000000000000000000000000000000000000000000000</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">27</td>

            <td class="px-3 py-2 border-b border-gray-700">0000000000000000000000000000000000000000000000000000000000000000000000000000</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">28</td>

            <td class="px-3 py-2 border-b border-gray-700">0000000000000000000000000000000000000000000000000000000000000000000000000000</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">29</td>

            <td class="px-3 py-2 border-b border-gray-700">0000000000000000000000000000000000000000000000000000000000000000000</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">30</td>

            <td class="px-3 py-2 border-b border-gray-700">0000000000000000000000000000000000000000000000000000000000000000000000000000</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">31</td>

            <td class="px-3 py-2 border-b border-gray-700">00000000000000000000000000000000000000000000000000000000000000000000</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">32</td>

            <td class="px-3 py-2 border-b border-gray-700">000000000000000000000000000000000000000000000000000000000000000000000</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">33</td>

            <td class="px-3 py-2 border-b border-gray-700">00000000000000000000000000000000000000000000000000000000000000000000</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">34</td>

            <td class="px-3 py-2 border-b border-gray-700">00000000000000000000000000000000000000000000000000000000000000000000</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">35</td>

            <td class="px-3 py-2 border-b border-gray-700">0000000000000000000000000000000000000000000000000000000000000</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">36</td>

            <td class="px-3 py-2 border-b border-gray-700">0000000000000000000000000000000000000000000000000000000000000</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">37</td>

            <td class="px-3 py-2 border-b border-gray-700">00000000000000000000000000000000000000000000000000000000000</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">38</td>

            <td class="px-3 py-2 border-b border-gray-700">0000000000000000000000000000000000000000000000000000000000000</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">39</td>

            <td class="px-3 py-2 border-b border-gray-700">000000000000000000000000000000000000000000000000000000000000</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">40</td>

            <td class="px-3 py-2 border-b border-gray-700">000000000000000000000000000000000000000000000000000000000000</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">41</td>

            <td class="px-3 py-2 border-b border-gray-700">0000000000000000000000000000000000000000000000000000000000</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">42</td>

            <td class="px-3 py-2 border-b border-gray-700">000000000000000000000000000000000000000000000000000000000000</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">43</td>

            <td class="px-3 py-2 border-b border-gray-700">00000000000000000000000000000000000000000000000000000000000</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">44</td>

            <td class="px-3 py-2 border-b border-gray-700">000000000000000000000000000000000000000000000000000000000</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">45</td>

            <td class="px-3 py-2 border-b border-gray-700">00000000000000000000000000000000000000000000000000000</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">46</td>

            <td class="px-3 py-2 border-b border-gray-700">0000000000000000000000000000000000000000000000000000</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">47</td>

            <td class="px-3 py-2 border-b border-gray-700">0000000000000000000000000000000000000000000000000000</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">48</td>

            <td class="px-3 py-2 border-b border-gray-700">0000000000000000000000000000000000000000000000000000</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">49</td>

            <td class="px-3 py-2 border-b border-gray-700">000000000000000000000000000000000000000000000000000</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">50</td>

            <td class="px-3 py-2 border-b border-gray-700">000000000000000000000000000000000000000000000000000</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">51</td>

            <td class="px-3 py-2 border-b border-gray-700">00000000000000000000000000000000000000000000000000</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">52</td>

            <td class="px-3 py-2 border-b border-gray-700">0000000000000000000000000000000000000000000000000</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">53</td>

            <td class="px-3 py-2 border-b border-gray-700">00000000000000000000000000000000000000000000000000</td>

          </tr>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">Table 20: A 15-round related-key differential characteristic for LBlock with probability  <span class="math">2^{-63}</span>  (characteristic in the encryption process).</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Rounds</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">The differences</th>

          </tr>

        </thead>

        <tbody>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">0 (Input)</td>

            <td class="px-3 py-2 border-b border-gray-700">0000000000000000000011000000000000000000101000000000000000111111</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">1</td>

            <td class="px-3 py-2 border-b border-gray-700">10100000000000000000111100000000000000000000000000011000000000</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">2</td>

            <td class="px-3 py-2 border-b border-gray-700">00000000000111001101000000000000101000000000000000011110000000</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">3</td>

            <td class="px-3 py-2 border-b border-gray-700">000000000000111100000000000000000000000001110011010000000000</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">4</td>

            <td class="px-3 py-2 border-b border-gray-700">00010000110100000000000000000000000000000011110000000000000</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">5</td>

            <td class="px-3 py-2 border-b border-gray-700">000011111011101000000000000000000010000110100000000000000</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">6</td>

            <td class="px-3 py-2 border-b border-gray-700">00000001000010000000000000100000000111110111010000000000000</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">7</td>

            <td class="px-3 py-2 border-b border-gray-700">000000000000000000000000000000000000100001000000000000010000</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">8</td>

            <td class="px-3 py-2 border-b border-gray-700">00001000000000000010000000000000000000000000000000000</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">9</td>

            <td class="px-3 py-2 border-b border-gray-700">00110000000000000000000110100000000100000000000001000000000</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">10</td>

            <td class="px-3 py-2 border-b border-gray-700">000000000000000000000000000000001100000000000000000011010000</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">11</td>

            <td class="px-3 py-2 border-b border-gray-700">000000000000000000000000000000000000000000000000000000</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">12</td>

            <td class="px-3 py-2 border-b border-gray-700">000000000000000000000000000000000000000000000000000000</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">13</td>

            <td class="px-3 py-2 border-b border-gray-700">0000000000000000000000000000000000000000000000000000</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">14</td>

            <td class="px-3 py-2 border-b border-gray-700">0000100000000000000000000000000000000000000000000000</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">15 (Output)</td>

            <td class="px-3 py-2 border-b border-gray-700">000100000000000000000000000000000000100000000000000000000</td>

          </tr>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">Table 21: A 15-round related-key differential characteristic for LBlock with probability  <span class="math">2^{-63}</span>  (characteristic in the key schedule algorithm).</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Rounds</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">The differences of the master key and subkeys</th>

          </tr>

        </thead>

        <tbody>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">Master Key</td>

            <td class="px-3 py-2 border-b border-gray-700">000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">Subkey 1</td>

            <td class="px-3 py-2 border-b border-gray-700">0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">Subkey 2</td>

            <td class="px-3 py-2 border-b border-gray-700">0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">Subkey 3</td>

            <td class="px-3 py-2 border-b border-gray-700">000000000000111000000000000000000000000000000000000000000000000000000000000000000000000000000000</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">Subkey 4</td>

            <td class="px-3 py-2 border-b border-gray-700">000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">Subkey 5</td>

            <td class="px-3 py-2 border-b border-gray-700">0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">Subkey 6</td>

            <td class="px-3 py-2 border-b border-gray-700">0000110000000000000000000000000000000000000000000000000000000000000000000000000000000000000</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">Subkey 7</td>

            <td class="px-3 py-2 border-b border-gray-700">00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">Subkey 8</td>

            <td class="px-3 py-2 border-b border-gray-700">00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">Subkey 9</td>

            <td class="px-3 py-2 border-b border-gray-700">000000000000000000000000000000000000000000000000000000000000000000000000000000000</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">Subkey 10</td>

            <td class="px-3 py-2 border-b border-gray-700">0000000000000000000000000000000000000000000000000000000000000000000000000000000000</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">Subkey 11</td>

            <td class="px-3 py-2 border-b border-gray-700">000000000000000000000000000000000000000000000000000000000000000000000000000000000</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">Subkey 12</td>

            <td class="px-3 py-2 border-b border-gray-700">0000000000000000000000000000000000000000000000000000000000000000000</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">Subkey 13</td>

            <td class="px-3 py-2 border-b border-gray-700">00000000000000000000000000000000000000000000000000000000000000000</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">Subkey 14</td>

            <td class="px-3 py-2 border-b border-gray-700">00000000000001100000000000000000000000000000000000000000000000000</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">Subkey 15</td>

            <td class="px-3 py-2 border-b border-gray-700">00000000000000000000000000000000000000000000000000000000000000000</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">Subkey 16</td>

            <td class="px-3 py-2 border-b border-gray-700">0000000000000000000000000000000000000000000000000000000000</td>

          </tr>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">Table 22: The distribution of the related-key differential characteristics of LBlock in the differential specified by the input and output differences given in Table 20.</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Probability</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">2-60</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">2-61</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">2-62</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">2-63</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">2-64</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">2-65</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">2-66</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">2-67</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">2-68</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">2-69</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">2-70</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">2-71</th>

          </tr>

        </thead>

        <tbody>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">#Characteristics</td>

            <td class="px-3 py-2 border-b border-gray-700">2</td>

            <td class="px-3 py-2 border-b border-gray-700">18</td>

            <td class="px-3 py-2 border-b border-gray-700">25</td>

            <td class="px-3 py-2 border-b border-gray-700">71</td>

            <td class="px-3 py-2 border-b border-gray-700">164</td>

            <td class="px-3 py-2 border-b border-gray-700">375</td>

            <td class="px-3 py-2 border-b border-gray-700">499</td>

            <td class="px-3 py-2 border-b border-gray-700">583</td>

            <td class="px-3 py-2 border-b border-gray-700">797</td>

            <td class="px-3 py-2 border-b border-gray-700">772</td>

            <td class="px-3 py-2 border-b border-gray-700">561</td>

            <td class="px-3 py-2 border-b border-gray-700">142</td>

          </tr>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">The 16-round linear hull presented in Sect. 6.1 Table 12 can be extended to a linear attack on 23-round SIMON48/96.</p>

    <p class="text-gray-300">!<a href="img-0.jpeg">img-0.jpeg</a> Fig. 1: Linear hull cryptanalysis of SIMON48/96</p>

    <p class="text-gray-300">Considering the linear approximation corresponding to the 16-round linear hull:</p>

    <div class="my-4 text-center"><span class="math-block">L ^ {3} [ 2 ] \\oplus L ^ {3} [ 1 8 ] \\oplus L ^ {3} [ 2 2 ] \\oplus R ^ {3} [ 0 ] \\oplus L ^ {1 9} [ 1 8 ] \\oplus L ^ {1 9} [ 2 2 ] \\oplus R ^ {1 9} [ 0 ] \\tag {16}</span></div>

    <p class="text-gray-300">each bit in the approximation can be expressed by some bits of plaintext, ciphertext and subkeys. For example,  <span class="math">L^3 [i] = K^2 [i]\\oplus K^0 [i]\\oplus R^0 [i]\\oplus L^0 [i + 2]\\oplus L^0 [i + 1]\\wedge L^0 [i + 8]\\oplus K^1 [i + 2]\\oplus L^0 [i + 2]\\oplus K^0 [i + 4]\\oplus R^0 [i + 4]\\oplus</span> <span class="math">L^0 [i + 6]\\oplus L^0 [i + 5]\\wedge L^0 [i + 12]\\oplus (K^0 [i + 3]\\oplus R^0 [i + 3]\\oplus L^0 [i + 5]\\oplus L^0 [i + 4]\\wedge L^0 [i + 11])\\wedge (K^0 [i + 10]\\oplus R^0 [i +</span> <span class="math">10]\\oplus L^0 [i + 12]\\oplus L^0 [i + 11]\\wedge L^0 [i + 18])\\oplus \\{K^1 [i + 1]\\oplus L^0 [i + 1]\\oplus K^0 [i + 3]\\oplus R^0 [i + 3]\\oplus L^0 [i + 5] + L^0 [i + 4]\\wedge</span> <span class="math">L^0 [i + 11]\\oplus (K^0 [i + 2]\\oplus R^0 [i + 2]\\oplus L^0 [i + 4]\\oplus L^0 [i + 3]\\wedge L^0 [i + 10])\\wedge (K^0 [i + 9]\\oplus R^0 [i + 9]\\oplus L^0 [i + 11]\\oplus L^0 [i +</span></p>

    <p class="text-gray-300"><span class="math">10]\\wedge L^{0}[i+17])\\}\\wedge\\{K^{1}[i+8]\\oplus L^{0}[i+8]\\oplus K^{0}[i+10]\\oplus R^{0}[i+10]\\oplus L^{0}[i+12]\\oplus L^{0}[i+11]\\wedge L^{0}[i+18]\\oplus(K^{0}[i+9]\\oplus R^{0}[i+9]\\oplus L^{0}[i+11]\\oplus L^{0}[i+10]\\wedge L^{0}[i+17])\\wedge(K^{0}[i+16]\\oplus R^{0}[i+16]\\oplus L^{0}[i+18]\\oplus L^{0}[i+17]\\wedge L^{0}[i+24])\\}</span>. Not that all additions are modulo <span class="math">24</span>.</p>

    <p class="text-gray-300">From the above equation, <span class="math">L^{3}[i]</span> can be computed from some bits of plaintext and subkeys: <span class="math">K^{0}[i],K^{0}[i+4],K^{1}[i+2],K^{0}[i+2],K^{0}[i+3],K^{0}[i+9],K^{0}[i+10],K^{0}[i+16],K^{1}[i+1],K^{1}[i+8],K^{2}[i]</span>. Since <span class="math">K^{0}[i],K^{0}[i+4],K^{2}[i],K^{1}[i+2]</span> are in linear form, thus they have no effect on the absolute value of the bias of the approximation presented in equation (16). Therefore, we do not need to guess such bits in the attack which are labeled with underscores in Fig. 1, from which we can see that <span class="math">45</span> bits need to bo be guessed.</p>

    <p class="text-gray-300">By choosing <span class="math">N=8\\cdot 2^{-44.92}=2^{47.92}</span> pairs of plaintext and ciphertext, the probability of success will achieve <span class="math">97\\%</span> with <span class="math">8</span>-bit advantage <em>[106]</em>, and the time complexity is <span class="math">N\\cdot 2^{45}=2^{92.92}</span>.</p>

    <p class="text-gray-300">Using the method presented in Sect. 4.2, we find a related-key differential characteristic for the 8-round LBlock with 6 active S-boxes in total (zero active S-box in its key schedule algorithm), and the results are given in Table 20 and Table 21.</p>

    <p class="text-gray-300">Table 23: An 8-round related-key differential characteristic with 6 active S-boxes for LBlock (characteristic in the key schedule algorithm).</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Rounds</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">The differences of the master key and subkeys</th>

          </tr>

        </thead>

        <tbody>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">Master Key</td>

            <td class="px-3 py-2 border-b border-gray-700">000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">Subkey 1</td>

            <td class="px-3 py-2 border-b border-gray-700">0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">Subkey 2</td>

            <td class="px-3 py-2 border-b border-gray-700">0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">Subkey 3</td>

            <td class="px-3 py-2 border-b border-gray-700">000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">Subkey 4</td>

            <td class="px-3 py-2 border-b border-gray-700">0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">Subkey 5</td>

            <td class="px-3 py-2 border-b border-gray-700">000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">Subkey 6</td>

            <td class="px-3 py-2 border-b border-gray-700">00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">Subkey 7</td>

            <td class="px-3 py-2 border-b border-gray-700">00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">Subkey 8</td>

            <td class="px-3 py-2 border-b border-gray-700">0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000</td>

          </tr>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">Table 24: An 8-round related-key differential characteristic with 6 active S-boxes for LBlock (characteristic in the encryption process).</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Rounds</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">The differences</th>

          </tr>

        </thead>

        <tbody>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">0 (Input)</td>

            <td class="px-3 py-2 border-b border-gray-700">00000011000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">1</td>

            <td class="px-3 py-2 border-b border-gray-700">000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">2</td>

            <td class="px-3 py-2 border-b border-gray-700">00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">3</td>

            <td class="px-3 py-2 border-b border-gray-700">00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">4</td>

            <td class="px-3 py-2 border-b border-gray-700">000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">5</td>

            <td class="px-3 py-2 border-b border-gray-700">0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">6</td>

            <td class="px-3 py-2 border-b border-gray-700">0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">7</td>

            <td class="px-3 py-2 border-b border-gray-700">00001001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">8 (Output)</td>

            <td class="px-3 py-2 border-b border-gray-700">110011100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000</td>

          </tr>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">Then we use the method presented in Sect. 5 to find all the related-key differential characteristics with input difference</p>

    <p class="text-gray-300">00000011000000000000000000000000000000010000001000000000000000000000</p>

    <p class="text-gray-300">and master-key difference</p>

    <p class="text-gray-300">00000000000000000000000000000000000000000000000000000000000001100000000000000000000000,</p>

    <p class="text-gray-300">each of which has at most 6 active S-boxes. We obtain 300 such characteristics in no more than 10 seconds on a PC. And there are 28 characteristics with probability  <span class="math">2^{-15}</span> , 128 characteristics with probability  <span class="math">2^{-16}</span> , and 144 characteristics with probability  <span class="math">2^{-17}</span> . Hence, the overall probability  <span class="math">\\hat{p}</span>  for  <span class="math">E_0</span>  is approximately</p>

    <div class="my-4 text-center"><span class="math-block">\\sqrt {2 8 \\times (2 ^ {- 1 5}) ^ {2} + 1 2 8 \\times (2 ^ {- 1 6}) ^ {2} + 1 4 4 \\times (2 ^ {- 1 7}) ^ {2}} \\approx 2 ^ {- 1 2}.</span></div>

    <p class="text-gray-300">Using this result and the related-key differential characteristic covering  <span class="math">E_{1}</span>  with probability  <span class="math">\\hat{q} \\approx 2^{-16}</span>  presented in [57], a 16-round related-key boomerang distinguisher with probability  <span class="math">(2^{-12} \\times 2^{-16})^2 = 2^{-56}</span>  can be constructed. Note that the probability of the best previously published boomerang distinguisher for the 16-round LBlock is  <span class="math">2^{-60}</span>  [57].</p>`;
---

<BaseLayout title="Towards Finding the Best Characteristics of Some Bit-oriente... (2014/747)">
  <article class="max-w-4xl mx-auto article-prose">
    <nav class="mb-8">
      <a href="/papers" class="text-blue-400 hover:text-blue-300">
        &larr; Back to Papers
      </a>
    </nav>

    <header class="mb-12">
      <h1 class="text-3xl font-bold mb-4"
        set:html={TITLE_HTML} />
      <p class="text-gray-400 mb-2"
        set:html={AUTHORS_HTML} />
      <p class="text-gray-500 text-sm mb-4">
        2014 &middot; eprint 2014/747
      </p>
      <div class="flex gap-4 text-sm">
        <a
          href={EPRINT_URL}
          target="_blank"
          rel="noopener noreferrer"
          class="text-blue-400 hover:text-blue-300"
        >
          Paper (eprint) &rarr;
        </a>
      </div>
      <p class="mt-4 text-xs text-gray-500">
        All content below belongs to the original authors. This page
        reproduces the paper for educational purposes. Always
        <a
          href={EPRINT_URL}
          target="_blank"
          rel="noopener noreferrer"
          class="text-blue-400 hover:text-blue-300"
        >cite the original</a>.
      </p>
      <p class="mt-1 text-xs text-gray-600">
        Converted with: {CRAWLER} &middot; {CONVERTED_DATE}
      </p>
    </header>

    <Fragment set:html={CONTENT} />

  </article>
</BaseLayout>
