---
import BaseLayout from '../../layouts/BaseLayout.astro';
import PaperDisclaimer from '../../components/PaperDisclaimer.astro';
import PaperHistory from '../../components/PaperHistory.astro';

const EPRINT_URL = 'https://eprint.iacr.org/2019/458';
const CRAWLER = 'marker';
const CONVERTED_DATE = '2026-02-12';
const LEAN_BASE =
  'https://github.com/badaas/cryptography.academy/blob/main/lean/CryptoAcademy';
const LEAN_POSEIDON = `${LEAN_BASE}/Primitives/Hash/Poseidon`;
const LEAN_SPONGE = `${LEAN_BASE}/Primitives/Hash/Sponge.lean`;
const LEAN_SECURITY = `${LEAN_BASE}/Primitives/Security.lean`;

/* ── Lean 4 Web: compilable code groups ── */

const LEAN_WEB = 'https://live.lean-lang.org';

function leanUrl(code: string): string {
  return `${LEAN_WEB}/?theme=dark`
    + `#project=MathlibDemo`
    + `&code=${encodeURIComponent(code)}`;
}

const CODE_SPONGE = `\
import Mathlib.Data.ZMod.Basic

/-! # Sponge Construction
From [BDPA08], adapted for finite fields. -/

structure SpongeConfig (F : Type*) [Field F] where
  r : ℕ              -- Rate
  c : ℕ              -- Capacity
  t : ℕ              -- State width
  ht : t = r + c
  hr : r > 0
  hc : c > 0
  perm : (Fin t → F) → (Fin t → F)

structure SpongeState {F : Type*} [Field F]
    (cfg : SpongeConfig F) where
  state : Fin cfg.t → F

def SpongeState.init {F : Type*} [Field F]
    (cfg : SpongeConfig F) : SpongeState cfg :=
  ⟨fun _ => 0⟩`;

const CODE_HADES = `\
import Mathlib.Data.ZMod.Basic
import Mathlib.Data.Matrix.Basic

variable (p : ℕ) [Fact (Nat.Prime p)]

/-! # S-Box -/

namespace SBox

def validExponent (α : ℕ) : Prop :=
  α ≥ 3 ∧ Nat.Coprime α (p - 1)

def sbox (α : ℕ) (x : ZMod p) : ZMod p :=
  x ^ α

theorem sbox_bijective (α : ℕ)
    (hα : Nat.Coprime α (p - 1)) :
    Function.Bijective (sbox p α) := by sorry

def fullSBoxLayer (t α : ℕ)
    (state : Fin t → ZMod p) : Fin t → ZMod p :=
  fun i => sbox p α (state i)

def partialSBoxLayer (t α : ℕ) (ht : t > 0)
    (state : Fin t → ZMod p) : Fin t → ZMod p :=
  fun i =>
    if i = ⟨0, ht⟩ then sbox p α (state i)
    else state i

end SBox

/-! # MDS Matrix -/

namespace MDS

def mixLayer (t : ℕ)
    (M : Matrix (Fin t) (Fin t) (ZMod p))
    (state : Fin t → ZMod p) :
    Fin t → ZMod p :=
  M.mulVec state

end MDS

/-! # HADES Design Strategy -/

structure HADESConfig where
  t : ℕ
  α : ℕ
  R_f : ℕ
  R_P : ℕ
  R_F : ℕ := 2 * R_f
  R : ℕ := 2 * R_f + R_P
  hα : SBox.validExponent p α
  ht : t > 0`;

const CODE_POSEIDON = `\
import Mathlib.Data.ZMod.Basic

variable (p : ℕ) [Fact (Nat.Prime p)]

/-! # Poseidon Hash Function -/

inductive DomainTag where
  | merkleTree (arity : ℕ)
  | variableLength (outputLen : ℕ)
  | constantLength (inputLen outputLen : ℕ)
  | encryption

def DomainTag.value : DomainTag → ℕ
  | .merkleTree arity => 2 ^ arity - 1
  | .variableLength o => 2 ^ 64 + (o - 1)
  | .constantLength len o => len * 2 ^ 64 + (o - 1)
  | .encryption => 2 ^ 32

structure InstanceParams where
  name : String
  securityLevel : ℕ
  α : ℕ
  t : ℕ
  R_F : ℕ
  R_P : ℕ

def poseidon128_t3 : InstanceParams :=
  { name := "POSEIDON^π-128"
    securityLevel := 128, α := 5,
    t := 3, R_F := 8, R_P := 57 }

def poseidon128_t5 : InstanceParams :=
  { name := "POSEIDON^π-128"
    securityLevel := 128, α := 5,
    t := 5, R_F := 8, R_P := 60 }

-- Consistency checks
example : poseidon128_t3.R_F = 8 := rfl
example : poseidon128_t3.α = 5 := rfl`;

const CODE_SECURITY = `\
import Mathlib.Data.ZMod.Basic
import Mathlib.Data.Finset.Basic

/-! # Cryptographic Security Definitions
Definitions 5.1–5.5 from [GKRRS19]. -/

/-- Def 5.1: T-security against collisions. -/
def CollisionResistant
    {α β : Type*} (F : α → β) (T : ℕ) : Prop :=
  ∀ (x₁ x₂ : α), F x₁ = F x₂ → x₁ = x₂ ∨ T = 0

/-- Def 5.2: T-security against preimages. -/
def PreimageResistant
    {α β : Type*} (F : α → β) (T : ℕ) : Prop :=
  ∀ (y : β), (∃ (x : α), F x = y) → T > 0

/-- Def 5.3: T-security against second preimages. -/
def SecondPreimageResistant
    {α β : Type*} (F : α → β) (T : ℕ) : Prop :=
  ∀ (x₁ x₂ : α), x₁ ≠ x₂ → F x₁ = F x₂ → T = 0

/-- Def 5.4: CICO problem. -/
structure CICOProblem
    (F : Type*) [Field F]
    (t r c : ℕ) (htrc : t = r + c)
    (P : (Fin t → F) → (Fin t → F)) where
  inputRate : Fin r → F
  outputRate : Fin r → F
  inputCapacity : Fin c → F
  outputCapacity : Fin c → F

def CICOSecure
    (F : Type*) [Field F]
    (t r c : ℕ) (htrc : t = r + c)
    (P : (Fin t → F) → (Fin t → F))
    (T : ℕ) : Prop :=
  ∀ (_prob : CICOProblem F t r c htrc P), T > 0

/-- Def 5.5: Zero-sum partition. -/
structure ZeroSumPartition
    {F : Type*} [AddCommMonoid F]
    {t : ℕ}
    (P : (Fin t → F) → (Fin t → F))
    (K : ℕ) where
  sets : Fin K → Finset (Fin t → F)
  disjoint : ∀ (i j : Fin K), i ≠ j →
    Disjoint (sets i) (sets j)
  zeroSumInput : ∀ (i : Fin K) (k : Fin t),
    (sets i).sum (fun x => x k) = 0
  zeroSumOutput : ∀ (i : Fin K) (k : Fin t),
    (sets i).sum (fun x => P x k) = 0`;

const CODE_GRAIN = `\
import Mathlib.Data.ZMod.Basic

variable (p : ℕ) [Fact (Nat.Prime p)]

/-! # Grain LFSR Parameter Generation
Appendix E of [GKRRS19]. -/

structure GrainConfig where
  fieldType : Fin 4
  sboxType : Fin 16
  n : ℕ            -- Field size ≈ log₂(p)
  t : ℕ            -- State width
  R_F : ℕ          -- Full rounds
  R_P : ℕ          -- Partial rounds

def LFSRState := Fin 80 → Bool

def grainInit (_cfg : GrainConfig) :
    LFSRState := sorry

def grainNext (_state : LFSRState) :
    LFSRState := sorry

def generateConstants
    (cfg : GrainConfig)
    (numConstants : ℕ) : List (ZMod p) := sorry`;
---

<BaseLayout title="POSEIDON (2019/458)">
  <article class="max-w-4xl mx-auto article-prose">
    <nav class="mb-8">
      <a href="/papers" class="text-blue-400 hover:text-blue-300">
        &larr; Back to Papers
      </a>
    </nav>

    <!-- ============================================================ -->
    <!-- HEADER                                                       -->
    <!-- ============================================================ -->

    <header class="mb-12">
      <h1 class="text-3xl font-bold mb-4">
        POSEIDON: A New Hash Function for Zero-Knowledge Proof
        Systems
      </h1>
      <p class="text-gray-400 mb-2">
        Lorenzo Grassi, Dmitry Khovratovich, Christian
        Rechberger, Arnab Roy, Markus Schofnegger
      </p>
      <p class="text-gray-500 text-sm mb-4">
        2019 &middot; Updated Version &middot; eprint 2019/458
      </p>
      <div class="flex gap-4 text-sm">
        <a
          href={EPRINT_URL}
          target="_blank"
          rel="noopener noreferrer"
          class="text-blue-400 hover:text-blue-300"
        >
          Paper (eprint) &rarr;
        </a>
        <a
          href={`${LEAN_POSEIDON}/Basic.lean`}
          target="_blank"
          rel="noopener noreferrer"
          class="text-blue-400 hover:text-blue-300"
        >
          Lean formalization &rarr;
        </a>
      </div>
      <PaperDisclaimer eprintUrl={EPRINT_URL} />
      <p class="mt-1 text-xs text-gray-600">Converted with: {CRAWLER} &middot; {CONVERTED_DATE}</p>
    </header>

    <!-- ============================================================ -->
    <!-- TABLE OF CONTENTS                                            -->
    <!-- ============================================================ -->

    <nav id="toc" class="mb-10 p-6 rounded-lg"
      style="background: rgba(255,255,255,0.03);
             border: 1px solid rgba(255,255,255,0.06);">
      <h2 class="text-lg font-bold mb-4">Table of Contents</h2>
      <ol class="space-y-1 text-sm text-gray-300
        list-decimal list-inside">
        <li>
          <a href="#abstract"
            class="hover:text-white">Abstract</a>
        </li>
        <li>
          <a href="#sec-1"
            class="hover:text-white">Introduction</a>
        </li>
        <li>
          <a href="#sec-2"
            class="hover:text-white">Design</a>
          <ol class="ml-6 mt-1 space-y-1 list-decimal
            list-inside text-gray-400">
            <li>
              <a href="#sec-2.1"
                class="hover:text-white">
                Sponge Construction</a>
            </li>
            <li>
              <a href="#sec-2.2"
                class="hover:text-white">
                The HADES Design Strategy</a>
            </li>
            <li>
              <a href="#sec-2.3"
                class="hover:text-white">
                Components</a>
            </li>
          </ol>
        </li>
        <li>
          <a href="#sec-3"
            class="hover:text-white">Applications</a>
        </li>
        <li>
          <a href="#sec-4"
            class="hover:text-white">Concrete Instances</a>
        </li>
        <li>
          <a href="#sec-5"
            class="hover:text-white">Security Analysis</a>
          <ol class="ml-6 mt-1 space-y-1 list-decimal
            list-inside text-gray-400">
            <li>
              <a href="#sec-5.1"
                class="hover:text-white">
                Security Definitions</a>
            </li>
            <li>
              <a href="#sec-5.2"
                class="hover:text-white">
                Security Claims</a>
            </li>
            <li>
              <a href="#sec-5.3"
                class="hover:text-white">
                Statistical Attacks</a>
            </li>
            <li>
              <a href="#sec-5.4"
                class="hover:text-white">
                Algebraic Attacks</a>
            </li>
            <li>
              <a href="#sec-5.5"
                class="hover:text-white">
                Round Number Propositions</a>
            </li>
            <li>
              <a href="#sec-5.6"
                class="hover:text-white">
                Security Margin</a>
            </li>
          </ol>
        </li>
        <li>
          <a href="#sec-6"
            class="hover:text-white">
            POSEIDON in ZK Proof Systems</a>
          <ol class="ml-6 mt-1 space-y-1 list-decimal
            list-inside text-gray-400">
            <li>
              <a href="#sec-6.1"
                class="hover:text-white">
                State of the Art</a>
            </li>
            <li>
              <a href="#sec-6.2"
                class="hover:text-white">
                SNARKs with Poseidon</a>
            </li>
            <li>
              <a href="#sec-6.3"
                class="hover:text-white">
                Comparison with Other Hash Algorithms</a>
            </li>
            <li>
              <a href="#sec-6.4"
                class="hover:text-white">
                STARKs with Poseidon</a>
            </li>
          </ol>
        </li>
        <li>
          <a href="#sec-7"
            class="hover:text-white">Acknowledgements</a>
        </li>
      </ol>
      <p class="text-xs text-gray-500 mt-4 mb-1 font-semibold">
        Appendices
      </p>
      <ol class="space-y-1 text-sm text-gray-400
        list-[upper-alpha] list-inside">
        <li>
          <a href="#app-a"
            class="hover:text-white">Auxiliary Files</a>
        </li>
        <li>
          <a href="#app-b"
            class="hover:text-white">
            Efficient Implementation</a>
        </li>
        <li>
          <a href="#app-c"
            class="hover:text-white">
            Security Analysis Details</a>
        </li>
        <li>
          <a href="#app-d"
            class="hover:text-white">
            Compact Constraints for STARKs and SNARKs</a>
        </li>
        <li>
          <a href="#app-e"
            class="hover:text-white">
            Grain LFSR Parameter Generation</a>
        </li>
        <li>
          <a href="#app-f"
            class="hover:text-white">
            Concrete Instances with Security Margin</a>
        </li>
        <li>
          <a href="#app-g"
            class="hover:text-white">
            Selecting Number of Rounds</a>
        </li>
        <li>
          <a href="#app-h"
            class="hover:text-white">
            Merkle Tree Instances</a>
        </li>
        <li>
          <a href="#app-i"
            class="hover:text-white">
            About STARKAD (Dismissed)</a>
        </li>
        <li>
          <a href="#app-j"
            class="hover:text-white">
            About <span class="math">x^&#123;-1&#125;</span>-POSEIDON (Dismissed)</a>
        </li>
      </ol>
      <p class="text-xs text-gray-500 mt-4 mb-1 font-semibold">
        Additional
      </p>
      <ul class="space-y-1 text-sm text-gray-400 list-disc
        list-inside">
        <li>
          <a href="#caveats"
            class="hover:text-white">Caveats</a>
        </li>
        <li>
          <a href="#references"
            class="hover:text-white">References</a>
        </li>
        <li>
          <a href="#formalization"
            class="hover:text-white">
            Formalization Status</a>
        </li>
      </ul>
    </nav>

    <!-- ============================================================ -->
    <!-- ABSTRACT                                                     -->
    <!-- ============================================================ -->

    <section id="abstract" class="mb-10">
      <h2 class="text-2xl font-bold">Abstract</h2>
      <p class="text-gray-300">
        The area of practical computational integrity proof systems,
        like SNARKs, STARKs, Bulletproofs, is seeing a very dynamic
        development with several constructions having appeared
        recently with improved properties and relaxed setup
        requirements. Many use cases of such systems involve, often
        as their most expensive part, proving the knowledge of a
        preimage under a certain cryptographic hash function, which
        is expressed as a circuit over a large prime field.
      </p>
      <p class="text-gray-300">
        In this paper, we present a modular framework and concrete
        instances of cryptographic hash functions which work
        natively with
        <span class="math">\text&#123;GF&#125;(p)</span> objects. Our hash function POSEIDON uses up to 8x
        fewer constraints per message bit than Pedersen Hash. Our
        construction is not only expressed compactly as a circuit,
        but can also be tailored for various proof systems using
        specially crafted polynomials, thus bringing another boost
        in performance. We demonstrate this by implementing a
        1-out-of-a-billion membership proof with Merkle trees in
        less than a second by using Bulletproofs.
      </p>

      <h3 class="text-lg font-semibold mt-6">Previous Versions</h3>
      <p class="text-gray-300">
        This paper is an <em>updated</em> version of
        [GKR+19] and [GKR+21] published at
        USENIX 2021. In this updated version, the authors limit
        themselves to POSEIDON over a prime field
        <span class="math">\mathbb&#123;F&#125;_p^t</span> instantiated
        with
        <span class="math">x \mapsto x^\alpha</span>, where
        <span class="math">\alpha \geq 3</span> is the smallest
        positive integer satisfying
        <span class="math">\gcd(\alpha, p-1) = 1</span>. The security
        analysis has been updated to account for attacks in
        [KR21, BCD+20], flaws in the Groebner basis
        analysis have been fixed, and results from [ABM23] are
        incorporated. Both the entire family of STARKAD and
        POSEIDON instantiated with
        <span class="math">x \mapsto x^&#123;-1&#125;</span> are
        considered <strong>dismissed</strong>.
      </p>
    </section>

    <!-- ============================================================ -->
    <!-- 1. INTRODUCTION                                              -->
    <!-- ============================================================ -->

    <section id="sec-1" class="mb-10">
      <h2 class="text-2xl font-bold">1. Introduction</h2>
      <p class="text-gray-300">
        The recent advances in computational integrity proof systems
        made a number of computational tasks verifiable in short
        time and/or in zero knowledge. Several protocols require one
        party to prove the knowledge of a seed-derived secret, of an
        element being part of a large set, or their combination. An
        alternative to accumulator-based solutions is to express
        secret derivation using cryptographic hash functions, and to
        prove set membership by presenting an opening in a properly
        chosen Merkle tree.
      </p>
      <p class="text-gray-300">
        The goal of Poseidon is to design a family of hash functions
        that are optimal in the R1CS metric (the most widespread)
        and good in the AET metric, while also supporting different
        finite field sizes. The substitution-permutation network
        (SPN) design allows for a generic hash function framework
        where the only security-critical parameter is the number of
        rounds.
      </p>
      <p class="text-gray-300">
        The S-box is chosen as the power map
        <span class="math">x \mapsto x^\alpha</span>, where
        <span class="math">\alpha \geq 3</span> is chosen as the
        smallest integer that guarantees invertibility. In
        particular, the choice
        <span class="math">\alpha = 5</span> is suitable for two of
        the most popular prime fields in ZK applications: the scalar
        fields of BLS12-381 and BN254.
      </p>
      <p class="text-gray-300">
        The internal permutation Poseidon<span class="math"
          >^\pi</span
        > is based on the HADES design strategy, which uses a
        combination of <em>full</em> rounds (all state elements pass
        through the S-box) and <em>partial</em> rounds (only one
        element does). This reduces the R1CS or AET cost while
        maintaining equivalent security.
      </p>

      <!-- Table 1: Primary proposals and competitors -->

      <div id="table-1" class="overflow-x-auto my-6">
        <p class="text-sm text-gray-400 mb-2">
          <strong>Table 1.</strong> Primary proposals and competitors.
          R1CS/bit costs are obtained by dividing the R1CS prover
          costs by the message rate. Timings from a third-party
          implementation on an i9-8950 CPU @2.9 GHz, 32 GB RAM.
        </p>
        <table class="w-full text-sm">
          <thead>
            <tr class="border-b border-gray-700">
              <th class="text-left py-2 pr-4">Name</th>
              <th class="text-left py-2 pr-4">S-box</th>
              <th class="text-left py-2 pr-4">Rate bits</th>
              <th class="text-left py-2 pr-4">Tree</th>
              <th class="text-left py-2 pr-4">
                <span class="math">R_F</span>
              </th>
              <th class="text-left py-2 pr-4">
                <span class="math">R_P</span>
              </th>
              <th class="text-left py-2 pr-4">R1CS/perm</th>
              <th class="text-left py-2 pr-4">R1CS/bit</th>
              <th class="text-left py-2">Time/perm</th>
            </tr>
          </thead>
          <tbody class="text-gray-300">
            <tr class="border-b border-gray-800">
              <td class="py-2 pr-4" rowspan="2">Poseidon-80</td>
              <td class="py-2 pr-4">
                <span class="math">x^5</span>
              </td>
              <td class="py-2 pr-4">510</td>
              <td class="py-2 pr-4">2:1</td>
              <td class="py-2 pr-4">8</td>
              <td class="py-2 pr-4">33</td>
              <td class="py-2 pr-4">171</td>
              <td class="py-2 pr-4">0.34</td>
              <td class="py-2">0.021 ms</td>
            </tr>
            <tr class="border-b border-gray-800">
              <td class="py-2 pr-4">
                <span class="math">x^5</span>
              </td>
              <td class="py-2 pr-4">1020</td>
              <td class="py-2 pr-4">4:1</td>
              <td class="py-2 pr-4">8</td>
              <td class="py-2 pr-4">35</td>
              <td class="py-2 pr-4">225</td>
              <td class="py-2 pr-4">0.22</td>
              <td class="py-2">0.05 ms</td>
            </tr>
            <tr class="border-b border-gray-800">
              <td class="py-2 pr-4" rowspan="3">Poseidon-128</td>
              <td class="py-2 pr-4">
                <span class="math">x^5</span>
              </td>
              <td class="py-2 pr-4">510</td>
              <td class="py-2 pr-4">2:1</td>
              <td class="py-2 pr-4">8</td>
              <td class="py-2 pr-4">57</td>
              <td class="py-2 pr-4">243</td>
              <td class="py-2 pr-4">0.47</td>
              <td class="py-2">0.033 ms</td>
            </tr>
            <tr class="border-b border-gray-800">
              <td class="py-2 pr-4">
                <span class="math">x^5</span>
              </td>
              <td class="py-2 pr-4">1020</td>
              <td class="py-2 pr-4">4:1</td>
              <td class="py-2 pr-4">8</td>
              <td class="py-2 pr-4">60</td>
              <td class="py-2 pr-4">300</td>
              <td class="py-2 pr-4">0.29</td>
              <td class="py-2">0.08 ms</td>
            </tr>
            <tr class="border-b border-gray-800">
              <td class="py-2 pr-4">
                <span class="math">x^5</span>
              </td>
              <td class="py-2 pr-4">2040</td>
              <td class="py-2 pr-4">8:1</td>
              <td class="py-2 pr-4">8</td>
              <td class="py-2 pr-4">63</td>
              <td class="py-2 pr-4">405</td>
              <td class="py-2 pr-4">0.20</td>
              <td class="py-2">0.259 ms</td>
            </tr>
            <tr class="border-b border-gray-800">
              <td class="py-2 pr-4" rowspan="2">Poseidon-256</td>
              <td class="py-2 pr-4">
                <span class="math">x^5</span>
              </td>
              <td class="py-2 pr-4">1020</td>
              <td class="py-2 pr-4">2:1</td>
              <td class="py-2 pr-4">8</td>
              <td class="py-2 pr-4">120</td>
              <td class="py-2 pr-4">504</td>
              <td class="py-2 pr-4">0.50</td>
              <td class="py-2">0.216 ms</td>
            </tr>
            <tr class="border-b border-gray-800">
              <td class="py-2 pr-4">
                <span class="math">x^5</span>
              </td>
              <td class="py-2 pr-4">2040</td>
              <td class="py-2 pr-4">4:1</td>
              <td class="py-2 pr-4">8</td>
              <td class="py-2 pr-4">120</td>
              <td class="py-2 pr-4">600</td>
              <td class="py-2 pr-4">0.30</td>
              <td class="py-2">0.578 ms</td>
            </tr>
            <tr class="border-b border-gray-800">
              <td class="py-2 pr-4">Pedersen Hash</td>
              <td class="py-2 pr-4">&mdash;</td>
              <td class="py-2 pr-4">516</td>
              <td class="py-2 pr-4">2:1</td>
              <td class="py-2 pr-4">&mdash;</td>
              <td class="py-2 pr-4">&mdash;</td>
              <td class="py-2 pr-4">869</td>
              <td class="py-2 pr-4">1.68</td>
              <td class="py-2">&mdash;</td>
            </tr>
            <tr class="border-b border-gray-800">
              <td class="py-2 pr-4" rowspan="3">Rescue</td>
              <td class="py-2 pr-4">
                <span class="math">x^5</span> &amp;
                <span class="math">x^&#123;1/5&#125;</span>
              </td>
              <td class="py-2 pr-4">510</td>
              <td class="py-2 pr-4">2:1</td>
              <td class="py-2 pr-4">16</td>
              <td class="py-2 pr-4">&mdash;</td>
              <td class="py-2 pr-4">268</td>
              <td class="py-2 pr-4">0.52</td>
              <td class="py-2">0.525 ms</td>
            </tr>
            <tr class="border-b border-gray-800">
              <td class="py-2 pr-4">
                <span class="math">x^5</span> &amp;
                <span class="math">x^&#123;1/5&#125;</span>
              </td>
              <td class="py-2 pr-4">1020</td>
              <td class="py-2 pr-4">4:1</td>
              <td class="py-2 pr-4">10</td>
              <td class="py-2 pr-4">&mdash;</td>
              <td class="py-2 pr-4">300</td>
              <td class="py-2 pr-4">0.29</td>
              <td class="py-2">0.555 ms</td>
            </tr>
            <tr class="border-b border-gray-800">
              <td class="py-2 pr-4">
                <span class="math">x^5</span> &amp;
                <span class="math">x^&#123;1/5&#125;</span>
              </td>
              <td class="py-2 pr-4">2040</td>
              <td class="py-2 pr-4">8:1</td>
              <td class="py-2 pr-4">10</td>
              <td class="py-2 pr-4">&mdash;</td>
              <td class="py-2 pr-4">450</td>
              <td class="py-2 pr-4">0.22</td>
              <td class="py-2">1.03 ms</td>
            </tr>
          </tbody>
        </table>
      </div>

      <h3 class="text-lg font-semibold">Our Contributions</h3>
      <p class="text-gray-300">
        The authors design and analyze a family of hash functions
        over
        <span class="math">\text&#123;GF&#125;(p)</span> named POSEIDON.
        The internal permutation
        Poseidon<span class="math">^\pi</span> is based on the HADES
        design strategy [GLR+20], using
        substitution-permutation networks with
        <span class="math">t</span> cells and partial rounds where
        only one S-box is used. Security levels of 80, 128, and
        256 bits are supported, where the security is the same for
        collision and preimage resistance. An extensive
        cryptanalysis is provided with an accent on algebraic
        methods (interpolation, Groebner basis, higher-order
        differential attacks). Third-party benchmarks are available
        for PLONK (<a href="#table-6">Table 6</a>), Groth16
        (<a href="#table-3">Table 3</a>), and Bulletproofs
        (<a href="#table-5">Table 5</a>).
      </p>

      <h3 class="text-lg font-semibold">Related Work</h3>
      <p class="text-gray-300">
        The Zcash designers introduced Pedersen hash [HBHW19],
        which utilizes 869 constraints per 516-bit message chunk
        (1.7 constraints per bit), whereas POSEIDON instances use
        from 0.2 to 0.45 constraints per bit. Ashur and Dhooghe
        [AD18] introduced the STARK-friendly JARVIS/FRIDAY, which
        were broken shortly after publication [ACG+19].
        In response, the Rescue family [AABS+19] was
        created with two differences from POSEIDON: all S-box
        layers are full (no partial rounds), and every second layer
        uses
        <span class="math">x^&#123;1/d&#125;</span> S-boxes, which
        prevents some algebraic attacks but requires more squarings
        in software.
      </p>

      <h3 class="text-lg font-semibold">Historic Remarks</h3>
      <p class="text-gray-300">
        Work on POSEIDON began in fall 2018, triggered by the STARK
        paper [BBHR19] proposing a Rijndael-based hash function.
        The design was inspired by LowMC [ARS+15] (partial
        S-box layers), SHARK [RDP+96] (inverse S-box +
        MDS matrix), and MiMC [AGR+16] (cube S-box). In
        2019, the design split into the block cipher HADESMIMC and
        hash functions POSEIDON/STARKAD. STARKAD (binary fields)
        was eventually dropped due to security weaknesses
        [KR21, BCD+20]. After initial publication,
        third-party requests led to adding Merkle tree support,
        encryption modes, and additional security levels. The
        authors initially targeted Groth16, Bulletproofs, and
        STARKs, later adding PLONK due to its increased popularity.
      </p>
    </section>

    <!-- ============================================================ -->
    <!-- 2. DESIGN                                                    -->
    <!-- ============================================================ -->

    <section id="sec-2" class="mb-10">
      <h2 class="text-2xl font-bold">2. Design</h2>
      <p class="text-gray-300">
        Poseidon maps strings over
        <span class="math">\mathbb&#123;F&#125;_p</span>
        to fixed-length strings over
        <span class="math">\mathbb&#123;F&#125;_p</span>, i.e.,
        <span class="math">\text&#123;Poseidon&#125; : \mathbb&#123;F&#125;_p^* \to \mathbb&#123;F&#125;_p^o</span>, where
        <span class="math">o</span> is the output length (usually
        <span class="math">o = 1</span>). It is constructed by
        instantiating a sponge function with the
        Poseidon<span class="math">^\pi</span> permutation.
      </p>

      <!-- 2.1 Sponge Construction -->

      <h3 id="sec-2.1" class="text-xl font-semibold">
        2.1 Sponge Construction
      </h3>
      <p class="text-gray-300">
        A sponge construction builds upon an internal permutation
        and is parametrized by two values: the
        <em>rate</em> <span class="math">r</span> (throughput) and
        the <em>capacity</em> <span class="math">c</span>
        (security level). The state width is
        <span class="math">t = r + c</span>. The initial state
        contains all zeros:
        <span class="math">I = 0^r \| 0^c</span>.
      </p>
      <p class="text-gray-300">
        If the internal permutation is modeled as a randomly chosen
        permutation, the sponge function is indifferentiable from a
        random oracle for up to
        <span class="math">|\mathbb&#123;F&#125;|^&#123;c/2&#125;</span>
        calls. A sponge hash function with capacity
        <span class="math">c</span> can therefore provide
        <span class="math">2^&#123;c/2&#125;</span> bits of
        collision and preimage resistance.
      </p>

      <div
        id="def-sponge"
        class="formal-block formal-block-definition"
      >
        <div class="flex items-start justify-between mb-2">
          <span class="text-sm font-bold text-blue-400">
            Definition (Sponge Construction)
          </span>
          <a
            href={LEAN_SPONGE}
            target="_blank"
            rel="noopener noreferrer"
            class="text-xs text-gray-500 hover:text-gray-300"
          >
            Sponge.lean
          </a>
        </div>
        <p class="text-sm text-gray-300 mb-3">
          A sponge is parametrized by a rate
          <span class="math">r</span>, a capacity
          <span class="math">c</span>, and an internal permutation
          over
          <span class="math">\mathbb&#123;F&#125;^t</span>
          where <span class="math">t = r + c</span>. Message
          blocks are absorbed into the rate portion, the permutation
          is applied between each block, and output is squeezed from
          the rate.
        </p>
        <iframe
          src={leanUrl(CODE_SPONGE)}
          class="lean-iframe"
          title="Lean 4 — Sponge construction"
          loading="lazy"
        ></iframe>
      </div>

      <!-- 2.2 HADES Design Strategy -->

      <h3 id="sec-2.2" class="text-xl font-semibold">
        2.2 The HADES Design Strategy
      </h3>
      <p class="text-gray-300">
        Cryptographic permutations usually consist of an efficient
        round function applied sufficiently many times. HADES mixes
        rounds with <em>full S-box layers</em> and rounds with
        <em>partial S-box layers</em>. Full layers are expensive in
        ZK proof systems but protect against statistical attacks;
        partial layers are cheap but similarly effective against
        algebraic attacks.
      </p>
      <p class="text-gray-300">
        The structure is:
        <span class="math">R_f</span> full rounds at the beginning,
        <span class="math">R_P</span> partial rounds in the middle
        (only 1 S-box per round), and
        <span class="math">R_f</span> full rounds at the end. The
        total number of full rounds is
        <span class="math">R_F = 2 \cdot R_f</span>.
      </p>

      <div
        id="def-hades"
        class="formal-block formal-block-definition"
      >
        <div class="flex items-start justify-between mb-2">
          <span class="text-sm font-bold text-blue-400">
            Definition (HADES Configuration)
          </span>
          <a
            href={`${LEAN_POSEIDON}/HADES.lean`}
            target="_blank"
            rel="noopener noreferrer"
            class="text-xs text-gray-500 hover:text-gray-300"
          >
            HADES.lean
          </a>
        </div>
        <p class="text-sm text-gray-300 mb-3">
          The HADES design strategy configures the permutation with
          three phases:
          <span class="math">R_f</span> full rounds,
          <span class="math">R_P</span> partial rounds, then
          <span class="math">R_f</span> full rounds.
        </p>
        <iframe
          src={leanUrl(CODE_HADES)}
          class="lean-iframe"
          title="Lean 4 — HADES design strategy"
          loading="lazy"
        ></iframe>
      </div>

      <p class="text-gray-300">
        Each round function consists of three operations applied in
        sequence:
      </p>
      <ol class="list-decimal list-inside text-gray-300 mb-4">
        <li>
          <strong>AddRoundConstants (ARC)</strong>: add
          round-specific constants to each state element
        </li>
        <li>
          <strong>SubWords (S-box)</strong>: apply the nonlinear
          S-box layer
        </li>
        <li>
          <strong>MixLayer (M)</strong>: multiply the state by the
          MDS matrix
        </li>
      </ol>

      <div class="formal-block formal-block-definition">
        <div class="flex items-start justify-between mb-2">
          <span class="text-sm font-bold text-blue-400">
            Definition (Round Functions)
          </span>
          <a
            href={`${LEAN_POSEIDON}/HADES.lean`}
            target="_blank"
            rel="noopener noreferrer"
            class="text-xs text-gray-500 hover:text-gray-300"
          >
            HADES.lean
          </a>
        </div>
        <p class="text-sm text-gray-300 mb-3">
          A full round applies the S-box to every state element; a
          partial round applies it only to the first element.
        </p>
        <iframe
          src={leanUrl(CODE_HADES)}
          class="lean-iframe"
          title="Lean 4 — Round functions"
          loading="lazy"
        ></iframe>
      </div>

      <!-- 2.3 Components -->

      <h3 id="sec-2.3" class="text-xl font-semibold">
        2.3 Components
      </h3>
      <p class="text-gray-300">
        <strong>The S-Box Layer.</strong> The S-box is defined as
        the power map
        <span class="math">\text&#123;S-box&#125;(x) = x^\alpha</span>, where
        <span class="math">\alpha \geq 3</span> is the smallest
        positive integer satisfying
        <span class="math">\gcd(\alpha, p-1) = 1</span>. The coprimality condition ensures the power map is
        a permutation over
        <span class="math">\mathbb&#123;F&#125;_p</span>. The common choice is
        <span class="math">\alpha = 5</span>, suitable for
        BLS12-381, BN254, and Ed25519 scalar fields.
      </p>

      <div
        id="def-sbox"
        class="formal-block formal-block-definition"
      >
        <div class="flex items-start justify-between mb-2">
          <span class="text-sm font-bold text-blue-400">
            Definition (S-Box)
          </span>
          <a
            href={`${LEAN_POSEIDON}/SBox.lean`}
            target="_blank"
            rel="noopener noreferrer"
            class="text-xs text-gray-500 hover:text-gray-300"
          >
            SBox.lean
          </a>
        </div>
        <p class="text-sm text-gray-300 mb-3">
          A valid S-box exponent satisfies
          <span class="math">\alpha \geq 3</span> and
          <span class="math">\gcd(\alpha, p-1) = 1</span>. The S-box function maps
          <span class="math">x \mapsto x^\alpha</span>.
        </p>
        <iframe
          src={leanUrl(CODE_HADES)}
          class="lean-iframe"
          title="Lean 4 — S-Box definition"
          loading="lazy"
        ></iframe>
      </div>

      <p class="text-gray-300">
        <strong>The Linear Layer.</strong> A
        <span class="math">t \times t</span> MDS (Maximum Distance
        Separable) matrix with elements in
        <span class="math">\mathbb&#123;F&#125;_p</span> exists when
        <span class="math">2t + 1 \leq p</span>. MDS matrices
        ensure full diffusion: every output element depends on every
        input element. One construction uses a Cauchy matrix:
        <span class="math">\mathcal&#123;M&#125;_&#123;i,j&#125; = 1/(x_i + y_j)</span>, where the sequences
        <span class="math">\&#123;x_i\&#125;</span> and
        <span class="math">\&#123;y_j\&#125;</span> are pairwise distinct.
      </p>

      <div
        id="def-mds"
        class="formal-block formal-block-definition"
      >
        <div class="flex items-start justify-between mb-2">
          <span class="text-sm font-bold text-blue-400">
            Definition (MDS Matrix)
          </span>
          <a
            href={`${LEAN_POSEIDON}/MDS.lean`}
            target="_blank"
            rel="noopener noreferrer"
            class="text-xs text-gray-500 hover:text-gray-300"
          >
            MDS.lean
          </a>
        </div>
        <p class="text-sm text-gray-300 mb-3">
          A matrix is MDS if every square submatrix has nonzero
          determinant. Cauchy matrices are always MDS.
        </p>
        <iframe
          src={leanUrl(CODE_HADES)}
          class="lean-iframe"
          title="Lean 4 — MDS matrix"
          loading="lazy"
        ></iframe>
      </div>

      <p class="text-gray-300">
        <strong>The Full Poseidon Hash.</strong> Poseidon bundles
        the HADES configuration with an MDS matrix, round constants,
        and sponge parameters. The permutation
        Poseidon<span class="math">^\pi</span> applies
        <span class="math">R_f</span> full rounds, then
        <span class="math">R_P</span> partial rounds, then
        <span class="math">R_f</span> full rounds. The hash
        function instantiates a sponge with this permutation.
      </p>

      <div
        id="def-poseidon"
        class="formal-block formal-block-definition"
      >
        <div class="flex items-start justify-between mb-2">
          <span class="text-sm font-bold text-blue-400">
            Definition (Poseidon Hash Function)
          </span>
          <a
            href={`${LEAN_POSEIDON}/Basic.lean`}
            target="_blank"
            rel="noopener noreferrer"
            class="text-xs text-gray-500 hover:text-gray-300"
          >
            Basic.lean
          </a>
        </div>
        <p class="text-sm text-gray-300 mb-3">
          Full configuration for a Poseidon instance, combining
          HADES, MDS matrix, round constants, and sponge
          parameters.
        </p>
        <iframe
          src={leanUrl(CODE_POSEIDON)}
          class="lean-iframe"
          title="Lean 4 — Poseidon hash function"
          loading="lazy"
        ></iframe>
      </div>

      <p class="text-gray-300">
        <strong>Domain Separation.</strong> The capacity element
        encodes the use case to prevent cross-domain attacks.
        Poseidon defines domain tags for Merkle trees, variable- and
        constant-length hashing, and encryption.
      </p>

      <div class="formal-block formal-block-definition">
        <div class="flex items-start justify-between mb-2">
          <span class="text-sm font-bold text-blue-400">
            Definition (Domain Separation)
          </span>
          <a
            href={`${LEAN_POSEIDON}/Basic.lean`}
            target="_blank"
            rel="noopener noreferrer"
            class="text-xs text-gray-500 hover:text-gray-300"
          >
            Basic.lean
          </a>
        </div>
        <iframe
          src={leanUrl(CODE_POSEIDON)}
          class="lean-iframe"
          title="Lean 4 — Domain separation"
          loading="lazy"
        ></iframe>
      </div>
    </section>

    <!-- ============================================================ -->
    <!-- 3. APPLICATIONS                                              -->
    <!-- ============================================================ -->

    <section id="sec-3" class="mb-10">
      <h2 class="text-2xl font-bold">3. Applications</h2>
      <p class="text-gray-300">
        Poseidon is suggested for all applications of
        zero-knowledge-friendly hashing:
      </p>
      <ul class="list-disc list-inside text-gray-300 mb-4 space-y-2">
        <li>
          <strong>Commitments</strong>: single-call
          permutation-based hashing with POSEIDON-128. Faster than
          Pedersen Hash and usable in signature schemes.
        </li>
        <li>
          <strong>Variable-length hashing</strong>: sponge-based
          hashing with POSEIDON-128 or POSEIDON-80 (width 5, rate
          4).
        </li>
        <li>
          <strong>Merkle trees</strong>: recommended arity 4 (width
          5) with POSEIDON-128 for highest ZK performance. Trees of
          arity 2 and other arities are also supported.
        </li>
        <li>
          <strong>Verifiable encryption</strong>: Poseidon inside
          the DuplexSponge authenticated encryption framework,
          initialized with a session key based on the recipient's
          public key.
        </li>
      </ul>
      <p class="text-gray-300">
        Third-party protocols using Poseidon include Filecoin (Merkle
        tree proofs), Dusk Network (Zcash-like protocol for
        securities trading), Sovrin (Merkle-tree based revocation),
        and Loopring (private trading on Ethereum).
      </p>
    </section>

    <!-- ============================================================ -->
    <!-- 4. CONCRETE INSTANCES                                        -->
    <!-- ============================================================ -->

    <section id="sec-4" class="mb-10">
      <h2 class="text-2xl font-bold">4. Concrete Instances</h2>
      <p class="text-gray-300">
        The primary instances use S-box
        <span class="math">f(x) = x^5</span> over the scalar fields of BLS12-381, BN254, and
        Ed25519 (all approximately
        <span class="math">2^&#123;255&#125;</span> in size). The
        round numbers include a security margin: +2 on
        <span class="math">R_F</span> and +7.5% on
        <span class="math">R_P</span>.
      </p>

      <div class="overflow-x-auto my-6">
        <table class="w-full text-sm">
          <thead>
            <tr class="border-b border-gray-700">
              <th class="text-left py-2 pr-4">Instance</th>
              <th class="text-left py-2 pr-4">
                <span class="math">t</span>
              </th>
              <th class="text-left py-2 pr-4">
                <span class="math">R_F</span>
              </th>
              <th class="text-left py-2 pr-4">
                <span class="math">R_P</span>
              </th>
              <th class="text-left py-2">Lean</th>
            </tr>
          </thead>
          <tbody class="text-gray-300">
            <tr class="border-b border-gray-800">
              <td class="py-2 pr-4">
                POSEIDON<span class="math">^\pi</span>-128
              </td>
              <td class="py-2 pr-4">3</td>
              <td class="py-2 pr-4">8</td>
              <td class="py-2 pr-4">57</td>
              <td class="py-2 font-mono text-xs">
                poseidon128_t3
              </td>
            </tr>
            <tr class="border-b border-gray-800">
              <td class="py-2 pr-4">
                POSEIDON<span class="math">^\pi</span>-128
              </td>
              <td class="py-2 pr-4">5</td>
              <td class="py-2 pr-4">8</td>
              <td class="py-2 pr-4">60</td>
              <td class="py-2 font-mono text-xs">
                poseidon128_t5
              </td>
            </tr>
            <tr class="border-b border-gray-800">
              <td class="py-2 pr-4">
                POSEIDON<span class="math">^\pi</span>-80
              </td>
              <td class="py-2 pr-4">3</td>
              <td class="py-2 pr-4">8</td>
              <td class="py-2 pr-4">33</td>
              <td class="py-2 font-mono text-xs">
                poseidon80_t3
              </td>
            </tr>
            <tr class="border-b border-gray-800">
              <td class="py-2 pr-4">
                POSEIDON<span class="math">^\pi</span>-80
              </td>
              <td class="py-2 pr-4">5</td>
              <td class="py-2 pr-4">8</td>
              <td class="py-2 pr-4">35</td>
              <td class="py-2 font-mono text-xs">
                poseidon80_t5
              </td>
            </tr>
            <tr class="border-b border-gray-800">
              <td class="py-2 pr-4">
                POSEIDON<span class="math">^\pi</span>-256
              </td>
              <td class="py-2 pr-4">6</td>
              <td class="py-2 pr-4">8</td>
              <td class="py-2 pr-4">120</td>
              <td class="py-2 font-mono text-xs">
                poseidon256_t6
              </td>
            </tr>
            <tr class="border-b border-gray-800">
              <td class="py-2 pr-4">
                POSEIDON<span class="math">^\pi</span>-256
              </td>
              <td class="py-2 pr-4">10</td>
              <td class="py-2 pr-4">8</td>
              <td class="py-2 pr-4">120</td>
              <td class="py-2 font-mono text-xs">
                poseidon256_t10
              </td>
            </tr>
          </tbody>
        </table>
      </div>

      <div class="formal-block formal-block-definition">
        <div class="flex items-start justify-between mb-2">
          <span class="text-sm font-bold text-blue-400">
            Definition (Instance Parameters)
          </span>
          <a
            href={`${LEAN_POSEIDON}/Instances.lean`}
            target="_blank"
            rel="noopener noreferrer"
            class="text-xs text-gray-500 hover:text-gray-300"
          >
            Instances.lean
          </a>
        </div>
        <iframe
          src={leanUrl(CODE_POSEIDON)}
          class="lean-iframe"
          title="Lean 4 — Poseidon instance parameters"
          loading="lazy"
        ></iframe>
      </div>

      <p class="text-gray-300">
        Round constants and MDS matrices are generated
        deterministically using the Grain LFSR in self-shrinking
        mode, providing the NUMS (Nothing-Up-My-Sleeve) property.
        See <a href="#app-e">Appendix E</a>.
      </p>
    </section>

    <!-- ============================================================ -->
    <!-- 5. SECURITY ANALYSIS                                         -->
    <!-- ============================================================ -->

    <section id="sec-5" class="mb-10">
      <h2 class="text-2xl font-bold">5. Security Analysis</h2>
      <p class="text-gray-300">
        The security of Poseidon relies on choosing the number of
        rounds so that the internal permutation does not exhibit
        non-generic properties relevant to collision or preimage
        attacks faster than
        <span class="math">2^M</span> queries. The analysis
        considers both statistical attacks (differential, linear,
        truncated differential, rebound) and algebraic attacks
        (interpolation, Groebner basis, higher-order differential).
      </p>

      <h3 id="sec-5.1" class="text-xl font-semibold">
        5.1 Security Definitions
      </h3>
      <p class="text-gray-300">
        The paper defines five security notions for hash functions
        and permutations, all formalized in Lean.
      </p>

      <!-- Definition 5.1: Collision Resistance -->

      <div
        id="def-5.1"
        class="formal-block formal-block-definition"
      >
        <div class="flex items-start justify-between mb-2">
          <span class="text-sm font-bold text-blue-400">
            Definition 5.1 (Collision Resistance)
          </span>
          <a
            href={LEAN_SECURITY}
            target="_blank"
            rel="noopener noreferrer"
            class="text-xs text-gray-500 hover:text-gray-300"
          >
            Security.lean
          </a>
        </div>
        <p class="text-sm text-gray-300 mb-3">
          The function
          <span class="math">F</span> is
          <span class="math">T</span>-secure against collisions if
          there is no algorithm with expected complexity smaller than
          <span class="math">T</span> that finds
          <span class="math">x_1 \neq x_2</span> with
          <span class="math">F(x_1) = F(x_2)</span>.
        </p>
        <iframe
          src={leanUrl(CODE_SECURITY)}
          class="lean-iframe"
          title="Lean 4 — Security definitions"
          loading="lazy"
        ></iframe>
      </div>

      <!-- Definition 5.2: Preimage Resistance -->

      <div
        id="def-5.2"
        class="formal-block formal-block-definition"
      >
        <div class="flex items-start justify-between mb-2">
          <span class="text-sm font-bold text-blue-400">
            Definition 5.2 (Preimage Resistance)
          </span>
          <a
            href={LEAN_SECURITY}
            target="_blank"
            rel="noopener noreferrer"
            class="text-xs text-gray-500 hover:text-gray-300"
          >
            Security.lean
          </a>
        </div>
        <p class="text-sm text-gray-300 mb-3">
          The function
          <span class="math">F</span> is
          <span class="math">T</span>-secure against preimages if
          there is no algorithm with expected complexity smaller than
          <span class="math">T</span> that, given
          <span class="math">y</span>, finds
          <span class="math">x</span> with
          <span class="math">F(x) = y</span>.
        </p>
        <iframe
          src={leanUrl(CODE_SECURITY)}
          class="lean-iframe"
          title="Lean 4 — Preimage Resistance"
          loading="lazy"
        ></iframe>
      </div>

      <!-- Definition 5.3: Second Preimage -->

      <div
        id="def-5.3"
        class="formal-block formal-block-definition"
      >
        <div class="flex items-start justify-between mb-2">
          <span class="text-sm font-bold text-blue-400">
            Definition 5.3 (Second Preimage Resistance)
          </span>
          <a
            href={LEAN_SECURITY}
            target="_blank"
            rel="noopener noreferrer"
            class="text-xs text-gray-500 hover:text-gray-300"
          >
            Security.lean
          </a>
        </div>
        <p class="text-sm text-gray-300 mb-3">
          Given
          <span class="math">x_1</span>, no algorithm finds
          <span class="math">x_2</span> with
          <span class="math">F(x_1) = F(x_2)</span> in fewer than
          <span class="math">T</span> steps.
        </p>
        <iframe
          src={leanUrl(CODE_SECURITY)}
          class="lean-iframe"
          title="Lean 4 — Second Preimage Resistance"
          loading="lazy"
        ></iframe>
      </div>

      <!-- Definition 5.4: CICO -->

      <div
        id="def-5.4"
        class="formal-block formal-block-definition"
      >
        <div class="flex items-start justify-between mb-2">
          <span class="text-sm font-bold text-blue-400">
            Definition 5.4 (CICO Problem)
          </span>
          <a
            href={LEAN_SECURITY}
            target="_blank"
            rel="noopener noreferrer"
            class="text-xs text-gray-500 hover:text-gray-300"
          >
            Security.lean
          </a>
        </div>
        <p class="text-sm text-gray-300 mb-3">
          The invertible function
          <span class="math">P</span> is
          <span class="math">T</span>-secure against the CICO
          (<span class="math">m_1, m_2</span>)-problem if no
          algorithm with expected complexity smaller than
          <span class="math">T</span> can, given partial
          input/output constraints, find the remaining values such
          that
          <span class="math">P(I_1 \| I_2) = O_1 \| O_2</span>.
        </p>
        <iframe
          src={leanUrl(CODE_SECURITY)}
          class="lean-iframe"
          title="Lean 4 — CICO Problem"
          loading="lazy"
        ></iframe>
      </div>

      <!-- Definition 5.5: Zero-Sum Partition -->

      <div
        id="def-5.5"
        class="formal-block formal-block-definition"
      >
        <div class="flex items-start justify-between mb-2">
          <span class="text-sm font-bold text-blue-400">
            Definition 5.5 (Zero-Sum Partition)
          </span>
          <a
            href={LEAN_SECURITY}
            target="_blank"
            rel="noopener noreferrer"
            class="text-xs text-gray-500 hover:text-gray-300"
          >
            Security.lean
          </a>
        </div>
        <p class="text-sm text-gray-300 mb-3">
          A collection of
          <span class="math">K</span> disjoint sets
          <span class="math">\&#123;X_1, \ldots, X_K\&#125;</span> such that for each set
          <span class="math">X_i</span>:
          <span class="math">\sum_&#123;x \in X_i&#125; x = \sum_&#123;x \in X_i&#125; P(x) = 0</span>.
          The authors explicitly do not claim security against
          zero-sum partitions, citing the gap between
          distinguishable rounds and attackable rounds (cf. full
          KECCAK-f is distinguishable but only 6-round KECCAK can
          be attacked).
        </p>
        <iframe
          src={leanUrl(CODE_SECURITY)}
          class="lean-iframe"
          title="Lean 4 — Zero-Sum Partition"
          loading="lazy"
        ></iframe>
      </div>

      <!-- 5.2 Security Claims -->

      <h3 id="sec-5.2" class="text-xl font-semibold">5.2 Security Claims</h3>

      <div class="formal-block formal-block-claim">
        <div class="flex items-start justify-between mb-2">
          <span class="text-sm font-bold text-cyan-400">
            Claim (Collision &amp; Preimage Security)
          </span>
          <a
            href={`${LEAN_POSEIDON}/Security.lean`}
            target="_blank"
            rel="noopener noreferrer"
            class="text-xs text-gray-500 hover:text-gray-300"
          >
            Security.lean
          </a>
        </div>
        <p class="text-sm text-gray-300 mb-3">
          POSEIDON-<span class="math">M</span> is
          <span class="math">2^M</span>-secure against collisions
          and (second) preimages.
        </p>
        <iframe
          src={leanUrl(CODE_SECURITY)}
          class="lean-iframe"
          title="Lean 4 — Poseidon collision and preimage security"
          loading="lazy"
        ></iframe>
      </div>

      <div class="formal-block formal-block-claim">
        <div class="flex items-start justify-between mb-2">
          <span class="text-sm font-bold text-cyan-400">
            Claim (CICO Security)
          </span>
          <a
            href={`${LEAN_POSEIDON}/Security.lean`}
            target="_blank"
            rel="noopener noreferrer"
            class="text-xs text-gray-500 hover:text-gray-300"
          >
            Security.lean
          </a>
        </div>
        <p class="text-sm text-gray-300 mb-3">
          Poseidon<span class="math">^\pi</span> is
          <span class="math">2^&#123;\min(M, m_1, m_2)&#125;</span>-secure against the CICO
          (<span class="math">m_1, m_2</span>)-problem.
        </p>
        <iframe
          src={leanUrl(CODE_SECURITY)}
          class="lean-iframe"
          title="Lean 4 — Poseidon CICO security"
          loading="lazy"
        ></iframe>
      </div>

      <!-- 5.3 Statistical Attacks -->

      <h3 id="sec-5.3" class="text-xl font-semibold">
        5.3 Statistical Attacks
      </h3>
      <p class="text-gray-300">
        At least 6 rounds with full S-box layers are necessary to
        provide security against differential and linear attacks.
        Specifically, for
        <span class="math">R_F &lt; 6</span> when
        <span class="math">M \leq (\lfloor \log_2 p \rfloor - \mathcal&#123;C&#125;) \cdot (t+1)</span> (where
        <span class="math">\mathcal&#123;C&#125; = \log_2(\alpha - 1)</span>), or
        <span class="math">R_F &lt; 10</span> otherwise, attacks
        may be possible. Truncated differentials with probability 1
        cover at most a single round; 4 full rounds suffice against
        them, and 6 full rounds suffice against rebound attacks.
      </p>

      <div class="formal-block formal-block-claim">
        <div class="flex items-start justify-between mb-2">
          <span class="text-sm font-bold text-cyan-400">
            Claim (Statistical Attack Bound)
          </span>
          <a
            href={`${LEAN_POSEIDON}/Security.lean`}
            target="_blank"
            rel="noopener noreferrer"
            class="text-xs text-gray-500 hover:text-gray-300"
          >
            Security.lean
          </a>
        </div>
        <iframe
          src={leanUrl(CODE_SECURITY)}
          class="lean-iframe"
          title="Lean 4 — Statistical attack full rounds bound"
          loading="lazy"
        ></iframe>
      </div>

      <p class="text-gray-300">
        The choice of the MDS matrix (Section 2.3) prevents the
        existence of subspaces that generate infinitely long
        subspace trails with inactive S-boxes. For any MDS matrix,
        no such trail can cover more than
        <span class="math">t - 1</span> partial rounds.
      </p>

      <div class="formal-block formal-block-definition">
        <div class="flex items-start justify-between mb-2">
          <span class="text-sm font-bold text-blue-400">
            Definition (Inactive S-Box Subspace)
          </span>
          <a
            href={`${LEAN_POSEIDON}/MDS.lean`}
            target="_blank"
            rel="noopener noreferrer"
            class="text-xs text-gray-500 hover:text-gray-300"
          >
            MDS.lean
          </a>
        </div>
        <p class="text-sm text-gray-300 mb-3">
          <span class="math">\mathcal&#123;S&#125;^&#123;(i)&#125; := \&#123; v \in \mathbb&#123;F&#125;^t \mid [\mathcal&#123;M&#125;^j \cdot v]_0 = 0, \; j &lt; i \&#125;</span>, where
          <span class="math">\dim(\mathcal&#123;S&#125;^&#123;(i)&#125;) \geq t - i</span>.
        </p>
        <iframe
          src={leanUrl(CODE_SECURITY)}
          class="lean-iframe"
          title="Lean 4 — Inactive S-Box subspace"
          loading="lazy"
        ></iframe>
      </div>

      <!-- 5.4 Algebraic Attacks -->

      <h3 id="sec-5.4" class="text-xl font-semibold">
        5.4 Algebraic Attacks
      </h3>

      <div
        id="lemma-c1"
        class="formal-block formal-block-lemma"
      >
        <div class="flex items-start justify-between mb-2">
          <span class="text-sm font-bold text-amber-400">
            Lemma C.1 (Algebraic Degree Bound)
          </span>
          <a
            href={`${LEAN_POSEIDON}/Security.lean`}
            target="_blank"
            rel="noopener noreferrer"
            class="text-xs text-gray-500 hover:text-gray-300"
          >
            Security.lean
          </a>
        </div>
        <p class="text-sm text-gray-300 mb-3">
          The algebraic degree
          <span class="math">D_\alpha(r)</span> of
          <span class="math">r</span>-round
          Poseidon<span class="math">^\pi</span> with S-box
          <span class="math">x^\alpha</span> is at most
          <span class="math">\alpha^r</span>, and is expected to
          reach this bound regardless of whether full or partial
          rounds are used.
        </p>
        <iframe
          src={leanUrl(CODE_SECURITY)}
          class="lean-iframe"
          title="Lean 4 — Algebraic degree bound"
          loading="lazy"
        ></iframe>
      </div>

      <p class="text-gray-300">
        <strong>Interpolation Attack.</strong> The attack constructs
        an interpolation polynomial describing the function. For a
        security level of
        <span class="math">M</span> bits, the number of rounds that
        can be attacked is
        <span class="math">R \leq \lceil \log_\alpha(2) \cdot \min\&#123;M, \log_2(p)\&#125; \rceil + \lceil \log_\alpha(t) \rceil</span>.
      </p>

      <div class="formal-block formal-block-theorem">
        <div class="flex items-start justify-between mb-2">
          <span class="text-sm font-bold text-green-400">
            Theorem (Interpolation Attack Bound)
          </span>
          <a
            href={`${LEAN_POSEIDON}/Security.lean`}
            target="_blank"
            rel="noopener noreferrer"
            class="text-xs text-gray-500 hover:text-gray-300"
          >
            Security.lean
          </a>
        </div>
        <iframe
          src={leanUrl(CODE_SECURITY)}
          class="lean-iframe"
          title="Lean 4 — Interpolation attack bound"
          loading="lazy"
        ></iframe>
      </div>

      <p class="text-gray-300">
        <strong>Groebner Basis Attack.</strong> One tries to solve a
        system of nonlinear equations describing the function. Three
        conditions, any of which allows an attack faster than
        <span class="math">2^M</span>:
      </p>
      <ol
        class="list-decimal list-inside text-gray-300 mb-4
          text-sm space-y-1"
      >
        <li>
          <span class="math">R_F + R_P \leq \log_\alpha(2) \cdot \min\&#123;M, \log_2(p)\&#125;</span>
        </li>
        <li>
          <span class="math">R_F + R_P \leq t - 1 + \log_\alpha(2) \cdot \min\&#123;M/(t+1), \log_2(p)/2\&#125;</span>
        </li>
        <li>
          <span class="math">(t-1) \cdot R_F + R_P \leq t - 2 + M / (2 \cdot \log_2(\alpha))</span>
        </li>
      </ol>
      <p class="text-gray-300">
        The round numbers must exceed all three bounds to ensure
        security.
      </p>

      <div class="formal-block formal-block-theorem">
        <div class="flex items-start justify-between mb-2">
          <span class="text-sm font-bold text-green-400">
            Theorem (Groebner Basis Bound)
          </span>
          <a
            href={`${LEAN_POSEIDON}/Security.lean`}
            target="_blank"
            rel="noopener noreferrer"
            class="text-xs text-gray-500 hover:text-gray-300"
          >
            Security.lean
          </a>
        </div>
        <iframe
          src={leanUrl(CODE_SECURITY)}
          class="lean-iframe"
          title="Lean 4 — Groebner basis attack bound"
          loading="lazy"
        ></iframe>
      </div>

      <!-- 5.5 Round Number Propositions -->

      <h3 id="sec-5.5" class="text-xl font-semibold">
        5.5 Round Number Propositions
      </h3>
      <p class="text-gray-300">
        The following propositions give the minimum round numbers
        (before adding the security margin) for each security level.
        After adding +2 on
        <span class="math">R_F</span> and +7.5% on
        <span class="math">R_P</span>, these yield the concrete
        instances in <a href="#sec-4">Section 4</a>.
      </p>

      <div
        id="prop-5.1"
        class="formal-block formal-block-proposition"
      >
        <div class="flex items-start justify-between mb-2">
          <span class="text-sm font-bold text-violet-400">
            Proposition 5.1
            (<span class="math">x^5</span>-POSEIDON-128)
          </span>
          <a
            href={`${LEAN_POSEIDON}/Security.lean`}
            target="_blank"
            rel="noopener noreferrer"
            class="text-xs text-gray-500 hover:text-gray-300"
          >
            Security.lean
          </a>
        </div>
        <p class="text-sm text-gray-300 mb-3">
          With <span class="math">\alpha = 5</span>,
          <span class="math">M = 128</span>,
          <span class="math">\log_2(p) \approx 255</span>: the minimum rounds before margin are
          <span class="math">R_F = 6</span>,
          <span class="math">R = R_F + R_P = 56 + \lceil \log_5(t) \rceil</span>.
          After margin:
          <span class="math">R_F = 8</span>,
          <span class="math">R_P = 57</span>
          (<span class="math">t = 3</span>).
        </p>
        <iframe
          src={leanUrl(CODE_SECURITY)}
          class="lean-iframe"
          title="Lean 4 — Poseidon-128 round numbers"
          loading="lazy"
        ></iframe>
      </div>

      <div
        id="prop-5.2"
        class="formal-block formal-block-proposition"
      >
        <div class="flex items-start justify-between mb-2">
          <span class="text-sm font-bold text-violet-400">
            Proposition 5.2
            (<span class="math">x^5</span>-POSEIDON-80)
          </span>
          <a
            href={`${LEAN_POSEIDON}/Security.lean`}
            target="_blank"
            rel="noopener noreferrer"
            class="text-xs text-gray-500 hover:text-gray-300"
          >
            Security.lean
          </a>
        </div>
        <p class="text-sm text-gray-300 mb-3">
          With <span class="math">\alpha = 5</span>,
          <span class="math">M = 80</span>:
          minimum <span class="math">R_F = 6</span>,
          <span class="math">R = R_F + R_P = 35 + \lceil \log_5(t) \rceil</span>.
          After margin:
          <span class="math">R_F = 8</span>,
          <span class="math">R_P = 33</span>
          (<span class="math">t = 3</span>).
        </p>
        <iframe
          src={leanUrl(CODE_SECURITY)}
          class="lean-iframe"
          title="Lean 4 — Poseidon-80 round numbers"
          loading="lazy"
        ></iframe>
      </div>

      <div
        id="prop-5.3"
        class="formal-block formal-block-proposition"
      >
        <div class="flex items-start justify-between mb-2">
          <span class="text-sm font-bold text-violet-400">
            Proposition 5.3
            (<span class="math">x^5</span>-POSEIDON-256)
          </span>
          <a
            href={`${LEAN_POSEIDON}/Security.lean`}
            target="_blank"
            rel="noopener noreferrer"
            class="text-xs text-gray-500 hover:text-gray-300"
          >
            Security.lean
          </a>
        </div>
        <p class="text-sm text-gray-300 mb-3">
          With <span class="math">\alpha = 5</span>,
          <span class="math">M = 256</span>:
          minimum <span class="math">R_F = 6</span>,
          <span class="math">R = R_F + R_P = 111 + \lceil \log_5(t) \rceil</span>.
          After margin:
          <span class="math">R_F = 8</span>,
          <span class="math">R_P = 120</span>
          (<span class="math">t = 6</span>).
        </p>
        <iframe
          src={leanUrl(CODE_SECURITY)}
          class="lean-iframe"
          title="Lean 4 — Poseidon-256 round numbers"
          loading="lazy"
        ></iframe>
      </div>

      <!-- 5.6 Security Margin -->

      <h3 id="sec-5.6" class="text-xl font-semibold">5.6 Security Margin</h3>
      <p class="text-gray-300">
        Given the minimum number of rounds necessary for security,
        the authors add:
      </p>
      <ol class="list-decimal list-inside text-gray-300 mb-4">
        <li>
          Two more rounds with full S-box layers
          (+2 <span class="math">R_F</span>)
        </li>
        <li>
          7.5% more rounds with partial S-box layers
          (+7.5% <span class="math">R_P</span>)
        </li>
      </ol>

      <div class="formal-block formal-block-definition">
        <div class="flex items-start justify-between mb-2">
          <span class="text-sm font-bold text-blue-400">
            Definition (Security Margin)
          </span>
          <a
            href={`${LEAN_POSEIDON}/Security.lean`}
            target="_blank"
            rel="noopener noreferrer"
            class="text-xs text-gray-500 hover:text-gray-300"
          >
            Security.lean
          </a>
        </div>
        <iframe
          src={leanUrl(CODE_SECURITY)}
          class="lean-iframe"
          title="Lean 4 — Security margin"
          loading="lazy"
        ></iframe>
      </div>
    </section>

    <!-- ============================================================ -->
    <!-- 6. POSEIDON IN ZK PROOF SYSTEMS                              -->
    <!-- ============================================================ -->

    <section id="sec-6" class="mb-10">
      <h2 class="text-2xl font-bold">
        6. POSEIDON in Zero-Knowledge Proof Systems
      </h2>
      <p class="text-gray-300">
        The hash functions have been designed to be friendly to
        zero-knowledge applications. Specifically, the goal is to
        minimize the proof generation time, the proof size, and the
        verification time. A single hash function cannot be optimal
        for all ZK proof systems because they use different
        arithmetizations: STARKs can use prime and binary fields,
        Bulletproofs uses any prime field, whereas most SNARKs use
        a prime field based on a scalar field of a pairing-friendly
        elliptic curve. Therefore, for each proof system a new
        instance of POSEIDON may be needed.
      </p>

      <!-- 6.1 State of the Art -->

      <h3 id="sec-6.1" class="text-xl font-semibold">
        6.1 State of the Art
      </h3>
      <p class="text-gray-300">
        Let <span class="math">\mathcal&#123;P&#125;</span> be a circuit
        over some finite field
        <span class="math">\mathbb&#123;F&#125;</span> where gates are
        low-degree polynomials. The <em>computational integrity
        problem</em> consists of proving that some given
        <span class="math">O_0</span> is the result of executing
        <span class="math">\mathcal&#123;P&#125;</span> over some
        <span class="math">I_0</span>. It is not difficult to show
        that any limited-time program on a modern CPU can be
        converted to such a circuit [BCTV14], and making the proof
        zero-knowledge is often possible with little overhead.
      </p>
      <p class="text-gray-300">
        The first generation of SNARKs (Pinocchio [PHGR13],
        Groth16 [Gro16]) require a separate trusted setup for each
        circuit. The next generation (Sonic [MBKM19],
        PLONK [GWC19], Marlin [CHM+20]) can use one
        reference string of size <span class="math">d</span> for all
        circuits with at most <span class="math">d</span> gates.
        Later, proof systems without trusted setups appeared:
        Bulletproofs [BBB+18] (short proofs, linear
        verifier), STARKs [BBHR19] (post-quantum, iterative
        programs), and RedShift [KPV19] (STARK-inspired, large
        proofs). Current benchmarks demonstrate that programs with
        millions of gates can be processed within a few seconds.
      </p>
      <p class="text-gray-300">
        The bottleneck of privacy-preserving applications (Zcash,
        Ethereum mixers) is the proof creation time, which took 42
        seconds in the early version of Zcash. Both prover and
        verifier performance are determined by the size of the
        circuit that describes a Merkle proof, and thus dependent
        on the hash function constituting the tree.
      </p>

      <!-- 6.2 SNARKs with Poseidon^π -->

      <h3 id="sec-6.2" class="text-xl font-semibold">
        6.2 SNARKs with Poseidon<span class="math">^\pi</span>
      </h3>
      <p class="text-gray-300">
        In SNARKs, the prime field is typically the scalar field of
        a pairing-friendly elliptic curve. After
        <span class="math">p</span> is fixed, we check if
        <span class="math">x^\alpha</span> is invertible in
        <span class="math">\text&#123;GF&#125;(p)</span>, which is
        true if
        <span class="math">p \bmod \alpha \neq 1</span>. The S-box
        <span class="math">x^3</span> requires 2 constraints and
        <span class="math">x^5</span> requires 3 constraints in
        R1CS. The total constraint count is:
      </p>
      <ul class="list-disc list-inside text-gray-300 mb-4 space-y-1">
        <li>
          <span class="math">2tR_F + 2R_P</span> constraints for
          <span class="math">x^3</span>-POSEIDON<span class="math">^\pi</span>
        </li>
        <li>
          <span class="math">3tR_F + 3R_P</span> constraints for
          <span class="math">x^5</span>-POSEIDON<span class="math">^\pi</span>
        </li>
      </ul>
      <p class="text-gray-300">
        No additional constraints are needed because linear layers
        and round constants can be incorporated. In the sponge
        mode, with
        <span class="math">2M</span> bits reserved for capacity,
        the constraints per bit are
        <span class="math">\frac&#123;3tR_F + 3R_P&#125;&#123;N - 2M&#125;</span> for
        <span class="math">x^5</span>-POSEIDON<span class="math">^\pi</span>.
      </p>

      <!-- 6.2.1 Groth16 -->

      <h4 id="sec-6.2.1" class="text-lg font-semibold mt-4">
        6.2.1 Groth16
      </h4>
      <p class="text-gray-300">
        Groth16 [Gro16] is an optimization of Pinocchio and
        currently the fastest SNARK with the smallest proofs. Its
        prover complexity is
        <span class="math">O(s)</span>, where
        <span class="math">s</span> is the number of rank-1
        constraints. Each full round with a full S-box layer is
        represented by constraints that incorporate the MDS matrix
        <span class="math">\mathcal&#123;M&#125;</span>. In partial
        rounds, only one S-box constraint is needed; the remaining
        <span class="math">t - 1</span> linear constraints can be
        composed with constraints from adjacent rounds.
      </p>

      <!-- Table 3: libsnark performance -->

      <div id="table-3" class="overflow-x-auto my-6">
        <p class="text-sm text-gray-400 mb-2">
          <strong>Table 3.</strong> libsnark [SCI] performance of the
          POSEIDON preimage prover (one permutation call). Intel
          Core i7-8700 CPU @3.2 GHz, 32 GiB RAM.
        </p>
        <table class="w-full text-sm">
          <thead>
            <tr class="border-b border-gray-700">
              <th class="text-left py-2 pr-4">Field</th>
              <th class="text-left py-2 pr-4">Arity (t)</th>
              <th class="text-left py-2 pr-4">Prove</th>
              <th class="text-left py-2 pr-4">Verify</th>
              <th class="text-left py-2">R1CS</th>
            </tr>
          </thead>
          <tbody class="text-gray-300">
            <tr class="border-b border-gray-800">
              <td class="py-2 pr-4" rowspan="2">BN254</td>
              <td class="py-2 pr-4">2:1 (3)</td>
              <td class="py-2 pr-4">43.1 ms</td>
              <td class="py-2 pr-4">1.2 ms</td>
              <td class="py-2">276</td>
            </tr>
            <tr class="border-b border-gray-800">
              <td class="py-2 pr-4">4:1 (5)</td>
              <td class="py-2 pr-4">57.9 ms</td>
              <td class="py-2 pr-4">1.1 ms</td>
              <td class="py-2">440</td>
            </tr>
            <tr class="border-b border-gray-800">
              <td class="py-2 pr-4" rowspan="2">BN254</td>
              <td class="py-2 pr-4">2:1 (3)</td>
              <td class="py-2 pr-4">32.8 ms</td>
              <td class="py-2 pr-4">1.2 ms</td>
              <td class="py-2">180</td>
            </tr>
            <tr class="border-b border-gray-800">
              <td class="py-2 pr-4">4:1 (5)</td>
              <td class="py-2 pr-4">46.9 ms</td>
              <td class="py-2 pr-4">1.1 ms</td>
              <td class="py-2">290</td>
            </tr>
          </tbody>
        </table>
        <p class="text-xs text-gray-500 mt-1">
          Top rows: Poseidon-128. Bottom rows: Poseidon-80.
        </p>
      </div>

      <!-- 6.2.2 Bulletproofs -->

      <h4 id="sec-6.2.2" class="text-lg font-semibold mt-4">
        6.2.2 Bulletproofs
      </h4>
      <p class="text-gray-300">
        Bulletproofs [BBB+18] is a proof system without
        trusted setup, notable for logarithmic proof sizes and the
        shortest range proofs without a trusted setup. However, its
        verifier is linear in the program size. The Bulletproofs
        library "dalek" is among the most popular ZK primitives.
        The authors implemented a Merkle tree prover for POSEIDON
        in Bulletproofs using the same R1CS constraint system as
        for Groth16.
      </p>

      <!-- Table 5: Bulletproofs performance -->

      <div id="table-5" class="overflow-x-auto my-6">
        <p class="text-sm text-gray-400 mb-2">
          <strong>Table 5.</strong> Bulletproofs performance to prove
          1 out of
          <span class="math">2^&#123;30&#125;</span>-element Merkle
          tree (Poseidon-128).
        </p>
        <table class="w-full text-sm">
          <thead>
            <tr class="border-b border-gray-700">
              <th class="text-left py-2 pr-4">Field</th>
              <th class="text-left py-2 pr-4">Arity</th>
              <th class="text-left py-2 pr-4">Prove</th>
              <th class="text-left py-2 pr-4">Verify</th>
              <th class="text-left py-2">R1CS</th>
            </tr>
          </thead>
          <tbody class="text-gray-300">
            <tr class="border-b border-gray-800">
              <td class="py-2 pr-4" rowspan="3">BLS12-381</td>
              <td class="py-2 pr-4">2:1</td>
              <td class="py-2 pr-4">16.8 s</td>
              <td class="py-2 pr-4">1.5 s</td>
              <td class="py-2">7290</td>
            </tr>
            <tr class="border-b border-gray-800">
              <td class="py-2 pr-4">4:1</td>
              <td class="py-2 pr-4">13.8 s</td>
              <td class="py-2 pr-4">1.65 s</td>
              <td class="py-2">4500</td>
            </tr>
            <tr class="border-b border-gray-800">
              <td class="py-2 pr-4">8:1</td>
              <td class="py-2 pr-4">11 s</td>
              <td class="py-2 pr-4">1.4 s</td>
              <td class="py-2">4050</td>
            </tr>
            <tr class="border-b border-gray-800">
              <td class="py-2 pr-4" rowspan="3">BN254</td>
              <td class="py-2 pr-4">2:1</td>
              <td class="py-2 pr-4">11.2 s</td>
              <td class="py-2 pr-4">1.1 s</td>
              <td class="py-2">7290</td>
            </tr>
            <tr class="border-b border-gray-800">
              <td class="py-2 pr-4">4:1</td>
              <td class="py-2 pr-4">9.6 s</td>
              <td class="py-2 pr-4">1.15 s</td>
              <td class="py-2">4500</td>
            </tr>
            <tr class="border-b border-gray-800">
              <td class="py-2 pr-4">8:1</td>
              <td class="py-2 pr-4">7.4 s</td>
              <td class="py-2 pr-4">1.0 s</td>
              <td class="py-2">4050</td>
            </tr>
            <tr class="border-b border-gray-800">
              <td class="py-2 pr-4" rowspan="3">Ristretto</td>
              <td class="py-2 pr-4">2:1</td>
              <td class="py-2 pr-4">8.4 s</td>
              <td class="py-2 pr-4">0.78 s</td>
              <td class="py-2">7290</td>
            </tr>
            <tr class="border-b border-gray-800">
              <td class="py-2 pr-4">4:1</td>
              <td class="py-2 pr-4">6.45 s</td>
              <td class="py-2 pr-4">0.72 s</td>
              <td class="py-2">4500</td>
            </tr>
            <tr class="border-b border-gray-800">
              <td class="py-2 pr-4">8:1</td>
              <td class="py-2 pr-4">5.25 s</td>
              <td class="py-2 pr-4">0.76 s</td>
              <td class="py-2">4050</td>
            </tr>
            <tr class="border-b border-gray-800">
              <td class="py-2 pr-4" colspan="2">
                SHA-256 [BBB+18]
              </td>
              <td class="py-2 pr-4">582 s</td>
              <td class="py-2 pr-4">21 s</td>
              <td class="py-2">762000</td>
            </tr>
          </tbody>
        </table>
      </div>

      <!-- 6.2.3 PLONK -->

      <h4 id="sec-6.2.3" class="text-lg font-semibold mt-4">
        6.2.3 PLONK
      </h4>
      <p class="text-gray-300">
        PLONK [GWC19] is a SNARK using a universal trusted setup,
        where a structured reference string of size
        <span class="math">d</span> serves any circuit of
        <span class="math">d</span> gates or less. The standard
        version works with R1CS constraints plus special machinery
        for wire layout. The prover complexity for a
        Poseidon<span class="math">^\pi</span> permutation with
        S-box <span class="math">x^5</span> of width
        <span class="math">w</span> and
        <span class="math">R</span> rounds is
        <span class="math">11(w(w+6)+3)R</span> point
        multiplications, and the proof has 7 group elements and 7
        field elements.
      </p>
      <p class="text-gray-300">
        The authors suggest optimizations for POSEIDON's near-identical
        rounds in PLONK: (1) define a separate polynomial for each
        S-box line, (2) eliminate wire layout polynomials, (3) express
        round transitions as affine equations over polynomial values
        at adjacent points. This reduces the prover to only
        <span class="math">(w + 11)R</span> point multiplications,
        with proofs of
        <span class="math">(w + 3)</span> group elements and
        <span class="math">2w</span> field elements &mdash; a
        25&ndash;40x increase in performance depending on
        <span class="math">w</span>.
      </p>

      <!-- Table 6: PLONK performance -->

      <div id="table-6" class="overflow-x-auto my-6">
        <p class="text-sm text-gray-400 mb-2">
          <strong>Table 6.</strong> PLONK performance to prove
          1-out-of-<span class="math">2^n</span>-Merkle tree of
          arity 4 (Poseidon-128 over BLS12-381). Third-party
          non-optimized Rust implementation, Intel i5-7300HQ
          @2.50 GHz.
        </p>
        <table class="w-full text-sm">
          <thead>
            <tr class="border-b border-gray-700">
              <th class="text-left py-2 pr-4">Set size</th>
              <th class="text-left py-2 pr-4">Prove</th>
              <th class="text-left py-2 pr-4">Verify</th>
              <th class="text-left py-2">R1CS</th>
            </tr>
          </thead>
          <tbody class="text-gray-300">
            <tr class="border-b border-gray-800">
              <td class="py-2 pr-4">
                <span class="math">2^&#123;16&#125;</span>
              </td>
              <td class="py-2 pr-4">3.59 s</td>
              <td class="py-2 pr-4">0.7 ms</td>
              <td class="py-2">2400</td>
            </tr>
            <tr class="border-b border-gray-800">
              <td class="py-2 pr-4">
                <span class="math">2^&#123;34&#125;</span>
              </td>
              <td class="py-2 pr-4">6.3 s</td>
              <td class="py-2 pr-4">1.55 ms</td>
              <td class="py-2">5100</td>
            </tr>
            <tr class="border-b border-gray-800">
              <td class="py-2 pr-4">
                <span class="math">2^&#123;68&#125;</span>
              </td>
              <td class="py-2 pr-4">9.9 s</td>
              <td class="py-2 pr-4">2.7 ms</td>
              <td class="py-2">10200</td>
            </tr>
          </tbody>
        </table>
      </div>

      <!-- 6.2.4 RedShift -->

      <h4 id="sec-6.2.4" class="text-lg font-semibold mt-4">
        6.2.4 RedShift
      </h4>
      <p class="text-gray-300">
        RedShift [KPV19] is a STARK-inspired proof system which
        works with an arbitrary set of constraints. It can be
        viewed as PLONK with pairing-based polynomial commitments
        replaced by Reed-Solomon trustless commitments. The
        RedShift proof size is
        <span class="math">c_\lambda \log d^2</span> KB, where
        <span class="math">d</span> is the degree of circuit
        polynomials and
        <span class="math">c_\lambda \approx 2.5</span> for 120-bit
        security. The same optimizations as in PLONK apply, so the
        entire Merkle tree proof requires polynomials of degree
        4800 for width 5, resulting in proofs around 12 KB in size.
      </p>

      <!-- 6.3 Comparison with Other Hash Algorithms -->

      <h3 id="sec-6.3" class="text-xl font-semibold">
        6.3 Comparison with Other Hash Algorithms
      </h3>
      <p class="text-gray-300">
        For all systems considered, the prover performance
        increases monotonically (and in practice almost linearly)
        with the number of multiplications or equivalently the
        number of R1CS constraints. The following table provides a
        summary of constraint counts for a Merkle tree with
        <span class="math">2^&#123;30&#125;</span> elements.
      </p>

      <!-- Table 4: R1CS comparison -->

      <div id="table-4" class="overflow-x-auto my-6">
        <p class="text-sm text-gray-400 mb-2">
          <strong>Table 4.</strong> Number of R1CS constraints for a
          circuit proving leaf knowledge in a Merkle tree of
          <span class="math">2^&#123;30&#125;</span> elements.
        </p>
        <table class="w-full text-sm">
          <thead>
            <tr class="border-b border-gray-700">
              <th class="text-left py-2 pr-4">Hash</th>
              <th class="text-left py-2 pr-4">Arity</th>
              <th class="text-left py-2 pr-4">Width</th>
              <th class="text-left py-2 pr-4">
                <span class="math">R_F</span>
              </th>
              <th class="text-left py-2 pr-4">
                <span class="math">R_P</span>
              </th>
              <th class="text-left py-2">Total</th>
            </tr>
          </thead>
          <tbody class="text-gray-300">
            <tr class="border-b border-gray-800">
              <td class="py-2 pr-4" rowspan="3">Poseidon-128</td>
              <td class="py-2 pr-4">2:1</td>
              <td class="py-2 pr-4">3</td>
              <td class="py-2 pr-4">8</td>
              <td class="py-2 pr-4">57</td>
              <td class="py-2">7290</td>
            </tr>
            <tr class="border-b border-gray-800">
              <td class="py-2 pr-4">4:1</td>
              <td class="py-2 pr-4">5</td>
              <td class="py-2 pr-4">8</td>
              <td class="py-2 pr-4">60</td>
              <td class="py-2">4500</td>
            </tr>
            <tr class="border-b border-gray-800">
              <td class="py-2 pr-4">8:1</td>
              <td class="py-2 pr-4">9</td>
              <td class="py-2 pr-4">8</td>
              <td class="py-2 pr-4">63</td>
              <td class="py-2">4050</td>
            </tr>
            <tr class="border-b border-gray-800">
              <td class="py-2 pr-4" rowspan="3">
                Rescue-<span class="math">x^5</span>
              </td>
              <td class="py-2 pr-4">2:1</td>
              <td class="py-2 pr-4">3</td>
              <td class="py-2 pr-4">16</td>
              <td class="py-2 pr-4">&mdash;</td>
              <td class="py-2">8640</td>
            </tr>
            <tr class="border-b border-gray-800">
              <td class="py-2 pr-4">4:1</td>
              <td class="py-2 pr-4">5</td>
              <td class="py-2 pr-4">10</td>
              <td class="py-2 pr-4">&mdash;</td>
              <td class="py-2">4500</td>
            </tr>
            <tr class="border-b border-gray-800">
              <td class="py-2 pr-4">8:1</td>
              <td class="py-2 pr-4">9</td>
              <td class="py-2 pr-4">10</td>
              <td class="py-2 pr-4">&mdash;</td>
              <td class="py-2">5400</td>
            </tr>
            <tr class="border-b border-gray-800">
              <td class="py-2 pr-4">Pedersen hash</td>
              <td class="py-2 pr-4" colspan="4">&mdash;</td>
              <td class="py-2">41400</td>
            </tr>
            <tr class="border-b border-gray-800">
              <td class="py-2 pr-4">SHA-256</td>
              <td class="py-2 pr-4" colspan="4">&mdash;</td>
              <td class="py-2">826020</td>
            </tr>
            <tr class="border-b border-gray-800">
              <td class="py-2 pr-4">Blake2s</td>
              <td class="py-2 pr-4" colspan="4">&mdash;</td>
              <td class="py-2">630180</td>
            </tr>
            <tr class="border-b border-gray-800">
              <td class="py-2 pr-4">MiMC-2p/p</td>
              <td class="py-2 pr-4">1:1</td>
              <td class="py-2 pr-4">2</td>
              <td class="py-2 pr-4">324</td>
              <td class="py-2 pr-4">&mdash;</td>
              <td class="py-2">19440</td>
            </tr>
          </tbody>
        </table>
      </div>
      <p class="text-gray-300">
        POSEIDON and Rescue have the fastest provers among the
        compared hash functions, which is also confirmed for the
        STARK case [BSGL20]. However, Rescue has slower performance
        in the non-ZK case (<a href="#table-1">Table 1</a>).
      </p>

      <!-- 6.4 STARKs with Poseidon^π -->

      <h3 id="sec-6.4" class="text-xl font-semibold">
        6.4 STARKs with Poseidon<span class="math">^\pi</span>
      </h3>
      <p class="text-gray-300">
        ZK-STARKs [BBHR19] is a proof system for computational
        integrity which is not vulnerable to quantum computers and
        does not use a trusted setup. STARKs operate with programs
        whose internal state is represented as
        <span class="math">w</span> registers, each belonging to a
        <span class="math">2^n</span>-subgroup
        <span class="math">\mathbb&#123;G&#125;</span> of a
        prime-order group. The program execution is represented as
        <span class="math">T</span> internal states. The prover
        complexity is
        <span class="math">8w \cdot T \cdot d \cdot \log(wT)</span>
        operations in
        <span class="math">\mathbb&#123;G&#125;</span>.
      </p>
      <p class="text-gray-300">
        Poseidon<span class="math">^\pi</span> can be represented
        with few registers, a small number of steps, and low
        degree. Setting <span class="math">w = t</span>, we get
        <span class="math">T = R_F + \lceil R_P / t \rceil</span>
        and
        <span class="math">wT = tR_F + R_P</span>. The AET cost
        is:
      </p>
      <ul class="list-disc list-inside text-gray-300 mb-4 space-y-1">
        <li>
          <span class="math">24(tR_F + R_P) \cdot \log_2(tR_F + R_P)</span>
          operations in
          <span class="math">\mathbb&#123;G&#125;</span> for the
          prover
        </li>
        <li>
          Prover memory in
          <span class="math">\Omega(63 \cdot (tR_F + R_P))</span>
        </li>
        <li>
          Communication (verifier time) of
          <span class="math">63 \cdot (t + \log_2^2(24(tR_F + R_P)))</span>
        </li>
      </ul>
      <p class="text-gray-300">
        For the primary instance Poseidon-128 with width 3, the AET
        cost is 20540 per permutation call, yielding 40 operations
        per bit over 510 bits. For width 5, the AET cost is 38214,
        or 38 operations per bit.
      </p>
    </section>

    <!-- ============================================================ -->
    <!-- 7. ACKNOWLEDGEMENTS                                          -->
    <!-- ============================================================ -->

    <section id="sec-7" class="mb-10">
      <h2 class="text-2xl font-bold">7. Acknowledgements</h2>
      <p class="text-gray-300">
        This work is partially supported by the Ethereum
        Foundation, Starkware Ltd, and IOV42 Ltd. The authors thank
        Alexander Vlasov, Lovesh Harshandani, and Carlos Perez for
        benchmarking POSEIDON in various environments.
      </p>
    </section>

    <!-- ============================================================ -->
    <!-- APPENDIX A: AUXILIARY FILES                                   -->
    <!-- ============================================================ -->

    <section id="app-a" class="mb-10">
      <h2 class="text-2xl font-bold">
        Appendix A. Auxiliary Files
      </h2>
      <p class="text-gray-300">
        The following files are provided as supplementary material:
      </p>
      <ul class="list-disc list-inside text-gray-300 mb-4 space-y-1">
        <li>
          <code class="text-sm">generate_params_poseidon.sage</code>
          &mdash; calculate round numbers, generate round constants
          and matrices
        </li>
        <li>
          <code class="text-sm">poseidonperm_x5_254_3.sage</code>,
          <code class="text-sm">poseidonperm_x5_254_5.sage</code>,
          <code class="text-sm">poseidonperm_x5_255_3.sage</code>,
          <code class="text-sm">poseidonperm_x5_255_5.sage</code>
          &mdash; reference implementations and test vectors
        </li>
        <li>
          <code class="text-sm">test_vectors.txt</code> &mdash;
          test vectors
        </li>
        <li>
          <code class="text-sm">poseidonperm_x3_64_24_optimized.sage</code>
          &mdash; optimized
          <span class="math">x^3</span>-POSEIDON<span class="math">^\pi</span>
          using the modifications from
          <a href="#app-b">Appendix B</a>
        </li>
      </ul>
      <p class="text-gray-300">
        All supplementary files are available at
        <code class="text-sm">
          https://extgit.iaik.tugraz.at/krypto/hadeshash
        </code>.
      </p>
    </section>

    <!-- ============================================================ -->
    <!-- APPENDIX B: EFFICIENT IMPLEMENTATION                          -->
    <!-- ============================================================ -->

    <section id="app-b" class="mb-10">
      <h2 class="text-2xl font-bold">
        Appendix B. Efficient Implementation
      </h2>
      <p class="text-gray-300">
        The partial nonlinear layer in
        <span class="math">R_P</span> rounds can be used to reduce
        the size of round constants and the number of constant
        multiplications. The main advantage reduces multiplications
        from
        <span class="math">t^2</span> to
        <span class="math">2t</span> per partial round, which is
        particularly useful for large
        <span class="math">t</span> and
        <span class="math">R_P</span>.
      </p>

      <h3 class="text-lg font-semibold">Round Constants</h3>
      <p class="text-gray-300">
        In an SPN, one can swap the order of the linear layer and
        round constant addition (both being linear operations). For
        round constant
        <span class="math">c^&#123;(i)&#125;</span>, the equivalent
        constant is
        <span class="math">\hat&#123;c&#125;^&#123;(i)&#125; = MC^&#123;-1&#125;(c^&#123;(i)&#125;)</span>,
        where <span class="math">MC</span> is the linear layer. By
        splitting constants into the S-box part and the identity
        part, and moving the identity part through successive
        rounds, one obtains a representation where constants are
        only added to S-box outputs, apart from one constant
        applied to the entire state after the first
        <span class="math">R_f</span> full rounds.
      </p>

      <h3 class="text-lg font-semibold">Linear Layer</h3>
      <p class="text-gray-300">
        For rounds with a single S-box, the
        <span class="math">t \times t</span> MDS matrix
        <span class="math">\mathcal&#123;M&#125;</span> decomposes as
        <span class="math">\mathcal&#123;M&#125; = \mathcal&#123;M&#125;' \times \mathcal&#123;M&#125;''</span>,
        where:
      </p>
      <ul class="list-disc list-inside text-gray-300 mb-4 space-y-1">
        <li>
          <span class="math">\mathcal&#123;M&#125;'</span> is
          block-diagonal with
          <span class="math">(1)</span> and
          <span class="math">\hat&#123;\mathcal&#123;M&#125;&#125;</span>
          (the
          <span class="math">(t-1) \times (t-1)</span> MDS
          submatrix)
        </li>
        <li>
          <span class="math">\mathcal&#123;M&#125;''</span> is sparse
          with
          <span class="math">\hat&#123;w&#125; = \hat&#123;\mathcal&#123;M&#125;&#125;^&#123;-1&#125; \times w</span>
          and an identity block, having
          <span class="math">t^2 - 3t + 2</span> zero entries and
          <span class="math">t - 1</span> entries equal to one
        </li>
      </ul>
      <p class="text-gray-300">
        By swapping the S-box layer and
        <span class="math">\mathcal&#123;M&#125;'</span>, each
        linear layer in the partial rounds reduces to
        multiplication by the sparse matrix
        <span class="math">\mathcal&#123;M&#125;''</span>, greatly
        reducing operations. For example,
        <span class="math">x^3</span>-Poseidon<span class="math">^\pi</span>
        with
        <span class="math">(n,t,R_F,R_P)=(64,24,8,42)</span>
        improves performance by about 5x (4 ms average in Sage).
      </p>
    </section>

    <!-- ============================================================ -->
    <!-- APPENDIX C: SECURITY ANALYSIS                                 -->
    <!-- ============================================================ -->

    <section id="app-c" class="mb-10">
      <h2 class="text-2xl font-bold">
        Appendix C. Security Analysis:
        <span class="math">x^\alpha</span>-Poseidon<span class="math">^\pi</span>
      </h2>
      <p class="text-gray-300">
        The following analysis assumes
        <span class="math">x \mapsto x^\alpha</span> is invertible
        (<span class="math">\gcd(\alpha, p-1) = 1</span>). This is
        more tailored than the HADESMiMC analysis, as POSEIDON uses
        <em>unkeyed</em> permutations in a sponge function (no
        MitM approaches apply). The analysis considers settings
        with
        <span class="math">\chi &lt; t</span> input/output words,
        reflecting the sponge attacker model.
      </p>

      <!-- C.1 Statistical Attacks -->

      <h3 id="app-c.1" class="text-xl font-semibold">
        C.1 Statistical Attacks
      </h3>
      <p class="text-gray-300">
        The results for impossible differentials, the
        multiple-of-8 property, mixture differentials, and integral
        distinguishers are equivalent to those for HADESMiMC
        [GLR+20].
      </p>

      <h4 id="app-c.1.1" class="text-lg font-semibold mt-4">
        C.1.1 Differential Cryptanalysis
      </h4>
      <p class="text-gray-300">
        The cube function
        <span class="math">f(x) = x^3</span> is an almost perfect
        nonlinear (APN) permutation with differential probability
        bounded by
        <span class="math">2/|\mathbb&#123;F&#125;_p|</span>.
        POSEIDON<span class="math">^\pi</span> is secure against
        differential cryptanalysis if each differential has
        probability at most
        <span class="math">p^&#123;-t&#125;</span>. Working with
        the "weaker" permutation
        <span class="math">R^&#123;R_f&#125; \circ L \circ R^&#123;R_f&#125;</span>
        (where <span class="math">L</span> is an invertible linear
        layer), the minimum number of active S-boxes over
        <span class="math">R^s \circ L \circ R^r</span> is at least
        <span class="math">(\lfloor s/2 \rfloor + \lfloor r/2 \rfloor) \cdot (t+1)</span>
        plus end-of-round corrections. For
        <span class="math">S(x) = x^5</span>, the bound
        <span class="math">DP_&#123;\max&#125; = 4/p</span> applies, and
        <span class="math">R_F \geq 6</span> suffices.
      </p>

      <h4 id="app-c.1.2" class="text-lg font-semibold mt-4">
        C.1.2 Linear Cryptanalysis
      </h4>
      <p class="text-gray-300">
        The maximum square correlation of the cube function is
        <span class="math">2/p</span> [AABL12], providing optimal
        resistance against linear cryptanalysis with the same round
        numbers as for differential attacks.
      </p>

      <h4 id="app-c.1.3" class="text-lg font-semibold mt-4">
        C.1.3 Truncated Differential
      </h4>
      <p class="text-gray-300">
        Probability-1 truncated differentials cover at most a
        single round of POSEIDON<span class="math">^\pi</span>
        (e.g.,
        <span class="math">[\alpha, 0, \ldots, 0]^T \xrightarrow&#123;R(\cdot)&#125; \mathcal&#123;M&#125; \times [\beta, 0, \ldots, 0]^T</span>).
        The next S-box layer destroys these linear relations. Four
        rounds with full S-box layers suffice for security.
      </p>

      <h4 id="app-c.1.4" class="text-lg font-semibold mt-4">
        C.1.4 Rebound Attacks
      </h4>
      <p class="text-gray-300">
        Rebound attacks [LMR+09, MRST09] have an
        inbound phase placed in the middle of the permutation and
        outbound phases at either end. The best rebound attack on
        AES covers 8 rounds. Since (1) one round of
        POSEIDON<span class="math">^\pi</span> provides full
        diffusion (vs. 2 rounds for AES) and (2) the best
        truncated differential covers 1 round (vs. 3 for AES),
        6 rounds with full S-box layers suffice.
      </p>

      <h4 id="app-c.1.5" class="text-lg font-semibold mt-4">
        C.1.5 Invariant Subspace Attack
      </h4>

      <div
        id="def-c.1"
        class="formal-block formal-block-definition"
      >
        <span class="text-sm font-bold text-blue-400">
          Definition C.1 (Invariant Subspace Trail)
        </span>
        <p class="text-sm text-gray-300 mt-2">
          Let
          <span class="math">K_&#123;\text&#123;weak&#125;&#125;</span> be a
          set of keys and
          <span class="math">k \in K_&#123;\text&#123;weak&#125;&#125;</span>.
          The subspace <span class="math">U</span> generates an
          invariant subspace trail of length
          <span class="math">r</span> for
          <span class="math">F_k(\cdot) \equiv F(\cdot) \oplus k</span>
          if for each
          <span class="math">i = 1, \ldots, r</span> there exists
          <span class="math">A_i \subseteq U^c</span> such that
          <span class="math">\forall a_i \in A_i, \exists a_&#123;i+1&#125; \in A_&#123;i+1&#125;</span>
          with
          <span class="math">F_&#123;k^i&#125;(U \oplus a_i) = U \oplus a_&#123;i+1&#125;</span>.
        </p>
      </div>

      <div
        id="def-c.2"
        class="formal-block formal-block-definition"
      >
        <span class="text-sm font-bold text-blue-400">
          Definition C.2 (Subspace Trails)
        </span>
        <p class="text-sm text-gray-300 mt-2">
          Let
          <span class="math">(U_1, U_2, \ldots, U_&#123;r+1&#125;)</span>
          be subspaces with
          <span class="math">\dim(U_i) \leq \dim(U_&#123;i+1&#125;)</span>.
          If for each <span class="math">i</span> and each
          <span class="math">a_i</span> there exists
          <span class="math">a_&#123;i+1&#125;</span> such that
          <span class="math">F(U_i \oplus a_i) \subseteq U_&#123;i+1&#125; \oplus a_&#123;i+1&#125;</span>,
          then this is a subspace trail of length
          <span class="math">r</span>. If all hold with equality,
          it is a <em>constant-dimensional</em> subspace trail.
        </p>
      </div>

      <p class="text-gray-300">
        For full S-box layers, random round constants provide
        protection [BCLR17]. For partial S-box layers, a subspace
        trail can always be constructed for
        <span class="math">t - 1</span> rounds without activating
        any S-box, but due to the matrix choice in Section 2.3,
        <span class="math">t - 1</span> is also an upper bound.
      </p>

      <!-- C.2 Algebraic Attacks -->

      <h3 id="app-c.2" class="text-xl font-semibold">
        C.2 Algebraic Attacks
      </h3>

      <h4 id="app-c.2.1" class="text-lg font-semibold mt-4">
        C.2.1 Interpolation Attack
      </h4>
      <p class="text-gray-300">
        The interpolation attack [JK97] constructs a polynomial
        representation of the function. For
        <span class="math">\chi</span> unknown input words, the
        number of monomials is estimated as
        <span class="math">(D_\alpha(R) + 1)^\chi</span>. Requiring
        this to be close to
        <span class="math">\min\&#123;2^M, p^\chi\&#125;</span>, the
        number of rounds must satisfy
        <span class="math">R \geq \min\&#123;M, \log_\alpha(p)\&#125;</span>.
        Additionally, the polynomial must be dense, requiring
        <span class="math">1 + \lceil \log_\alpha(p) \rceil + \lceil \log_\alpha(t) \rceil</span>
        rounds. The backward direction (using
        <span class="math">x^&#123;1/\alpha&#125;</span>) has higher
        degree, so the forward attack dominates. The MitM variant
        does not apply since the attacker sees only part of the
        output in the sponge setting.
      </p>
      <p class="text-gray-300">
        The total round requirement is:
        <span class="math">R_P + R_F \geq 1 + \lceil \log_\alpha(2) \cdot \min\&#123;M, \log_2(p)\&#125; \rceil + \log_\alpha(t)</span>.
      </p>

      <h4 id="app-c.2.2" class="text-lg font-semibold mt-4">
        C.2.2 Groebner Basis Attack
      </h4>
      <p class="text-gray-300">
        The Groebner basis attack consists of (1) computing the
        basis in degrevlex order, (2) converting to lexicographic
        order, and (3) factorizing the univariate polynomial. The
        complexity for a system of
        <span class="math">\mathcal&#123;N&#125;</span> polynomials
        in <span class="math">\mathcal&#123;V&#125;</span> variables
        is
        <span class="math">O\left(\binom&#123;\mathcal&#123;V&#125; + D_&#123;\text&#123;reg&#125;&#125;&#125;&#123;D_&#123;\text&#123;reg&#125;&#125;&#125;\right)^\omega</span>,
        where
        <span class="math">D_&#123;\text&#123;reg&#125;&#125;</span> is the
        degree of regularity and
        <span class="math">2 \leq \omega &lt; 3</span> is the
        linear algebra constant.
      </p>
      <p class="text-gray-300">
        <strong>Full-permutation equations</strong>: For
        <span class="math">\chi = 1</span> (one equation), root
        finding costs
        <span class="math">D \cdot \log_2(D)^2</span>, giving
        <span class="math">r \leq \log_\alpha(2) \cdot \min\&#123;M, \log_2(p)\&#125;</span>.
        For <span class="math">\chi \geq 2</span>, the cost is at
        least
        <span class="math">\alpha^&#123;2r\chi&#125;</span>,
        optimized at <span class="math">\chi = 2</span>.
      </p>
      <p class="text-gray-300">
        <strong>Exploiting
        <span class="math">\mathcal&#123;S&#125;^&#123;(i)&#125;</span></strong>:
        The subspace of texts with no active S-boxes over
        <span class="math">r</span> partial rounds allows replacing
        nonlinear equations with linear ones. Due to the matrix
        assumption in Section 2.3, this covers at most
        <span class="math">t - 1</span> partial rounds, leading to
        <span class="math">R_F + R_P \geq t - 1 + \min\left\&#123;\frac&#123;\log_\alpha(2) \cdot M&#125;&#123;t+1&#125;, \frac&#123;\log_\alpha(2) \cdot \log_2(p)&#125;&#123;2&#125;\right\&#125;</span>.
      </p>
      <p class="text-gray-300">
        <strong>Round-level equations</strong>: Using degree-<span class="math">\alpha</span>
        equations per S-box, the regularity is
        <span class="math">D_&#123;\text&#123;reg&#125;&#125; \approx 1 + (\alpha - 1)((t-1)R_F + R_P)</span>,
        giving
        <span class="math">(t-1)R_F + R_P \geq (t-2) + \frac&#123;M&#125;&#123;2 \log_2(\alpha)&#125;</span>.
      </p>
      <p class="text-gray-300">
        <strong>Follow-up [ABM23]</strong>: The system is not
        regular, giving a better estimate
        <span class="math">D_&#123;\text&#123;reg&#125;&#125; \approx r \cdot R_F/2 + R_P + \alpha</span>.
        However, this does not affect instances currently in
        practice (<span class="math">t \in \&#123;3, 5\&#125;</span>
        for SNARKs,
        <span class="math">t \in \&#123;12, 24\&#125;</span> for
        FRI-based approaches).
      </p>
    </section>

    <!-- ============================================================ -->
    <!-- APPENDIX D: COMPACT CONSTRAINTS                               -->
    <!-- ============================================================ -->

    <section id="app-d" class="mb-10">
      <h2 class="text-2xl font-bold">
        Appendix D. Compact Constraints for STARKs and SNARKs
      </h2>
      <p class="text-gray-300">
        When <span class="math">t</span> is relatively small
        compared to <span class="math">R_P</span>, constraints can
        be generated for S-boxes that depend on only a few
        variables. Let
        <span class="math">A_r^i</span> denote the ARK outputs in
        round <span class="math">r</span> and
        <span class="math">B_r^i</span> the MDS inputs. In full
        rounds,
        <span class="math">S(A_r^i) = B_r^i</span>; in partial
        rounds,
        <span class="math">S(A_r^t) = B_r^t</span> and
        <span class="math">A_r^i = B_r^i</span> for
        <span class="math">i &lt; t</span>.
      </p>
      <p class="text-gray-300">
        By working with two consecutive segments of
        <span class="math">t</span> partial rounds, expressing
        intermediate values as affine functions, and substituting
        <span class="math">B_j^t \leftarrow S(A_j^t)</span>, a
        system
        <span class="math">P_1</span> of
        <span class="math">t</span> degree-<span class="math">d</span>
        polynomial constraints is obtained on
        <span class="math">2t</span> S-box input variables. This
        system is constant-independent (depending on
        <span class="math">r</span> only in the constant term).
      </p>
      <p class="text-gray-300">
        The resulting total for the entire permutation is
        <span class="math">tR_F + R_P - t</span> constraints of
        degree <span class="math">d</span>, structured as:
      </p>
      <ul class="list-disc list-inside text-gray-300 mb-4 space-y-1">
        <li>
          First full rounds:
          <span class="math">t(R_F/2 - 1)</span> constraints
        </li>
        <li>
          Bridge (last full &harr; first
          <span class="math">t</span> partial):
          <span class="math">t</span> constraints
        </li>
        <li>
          All <span class="math">R_P</span> partial rounds:
          <span class="math">R_P</span> constraints (grouped in
          blocks of <span class="math">t</span>)
        </li>
        <li>
          Bridge (last <span class="math">t</span> partial &harr;
          first full): <span class="math">t</span> constraints
        </li>
        <li>
          Last full rounds:
          <span class="math">t(R_F/2 - 1)</span> constraints
        </li>
      </ul>
    </section>

    <!-- ============================================================ -->
    <!-- APPENDIX E: GRAIN LFSR                                       -->
    <!-- ============================================================ -->

    <section id="app-e" class="mb-10">
      <h2 class="text-2xl font-bold">
        Appendix E. Grain LFSR Parameter Generation
      </h2>
      <p class="text-gray-300">
        Round constants and MDS matrices are generated
        deterministically using the Grain LFSR in self-shrinking
        mode. The 80-bit initial state encodes the Poseidon instance
        parameters (field type, S-box type, field size, state width,
        round numbers).
      </p>
      <p class="text-gray-300">
        The generation process:
      </p>
      <ol class="list-decimal list-inside text-gray-300 mb-4">
        <li>
          Initialize the 80-bit LFSR with instance parameters.
        </li>
        <li>
          Update using the feedback polynomial:
          <span class="math">b_&#123;i+80&#125; = b_&#123;i+62&#125; \oplus b_&#123;i+51&#125; \oplus b_&#123;i+38&#125; \oplus b_&#123;i+23&#125; \oplus b_&#123;i+13&#125; \oplus b_i</span>.
        </li>
        <li>Discard the first 160 bits.</li>
        <li>
          Use self-shrinking mode: evaluate bits in pairs. If the
          first bit is 1, output the second; otherwise discard both.
        </li>
        <li>
          Reject samples
          <span class="math">\geq p</span>.
        </li>
      </ol>

      <div class="formal-block formal-block-definition">
        <div class="flex items-start justify-between mb-2">
          <span class="text-sm font-bold text-blue-400">
            Definition (Grain LFSR)
          </span>
          <a
            href={`${LEAN_POSEIDON}/Grain.lean`}
            target="_blank"
            rel="noopener noreferrer"
            class="text-xs text-gray-500 hover:text-gray-300"
          >
            Grain.lean
          </a>
        </div>
        <iframe
          src={leanUrl(CODE_GRAIN)}
          class="lean-iframe"
          title="Lean 4 — Grain LFSR parameter generation"
          loading="lazy"
        ></iframe>
      </div>
    </section>

    <!-- ============================================================ -->
    <!-- APPENDIX F: CONCRETE INSTANCES WITH SECURITY MARGIN          -->
    <!-- ============================================================ -->

    <section id="app-f" class="mb-10">
      <h2 class="text-2xl font-bold">
        Appendix F. Concrete Instances with Security Margin
      </h2>
      <p class="text-gray-300">
        Concrete instances for
        <span class="math">x^3</span>-POSEIDON<span class="math">^\pi</span>
        and
        <span class="math">x^5</span>-POSEIDON<span class="math">^\pi</span>,
        including the security margin, are given in Tables 7 and 8.
      </p>

      <!-- Table 7: x^3 instances -->

      <div id="table-7" class="overflow-x-auto my-6">
        <p class="text-sm text-gray-400 mb-2">
          <strong>Table 7.</strong> Concrete instances for
          <span class="math">x^3</span>-Poseidon<span class="math">^\pi</span>
          over
          <span class="math">\mathbb&#123;F&#125;_p</span>, where
          S-box<span class="math">(x) = x^3</span>.
        </p>
        <table class="w-full text-sm">
          <thead>
            <tr class="border-b border-gray-700">
              <th class="text-left py-2 pr-4">
                <span class="math">M</span>
              </th>
              <th class="text-left py-2 pr-4">
                <span class="math">N</span>
              </th>
              <th class="text-left py-2 pr-4">
                <span class="math">n</span>
              </th>
              <th class="text-left py-2 pr-4">
                <span class="math">t</span>
              </th>
              <th class="text-left py-2 pr-4">
                <span class="math">R_F</span>
              </th>
              <th class="text-left py-2 pr-4">
                <span class="math">R_P</span>
              </th>
              <th class="text-left py-2">Cost</th>
            </tr>
          </thead>
          <tbody class="text-gray-300">
            <tr class="border-b border-gray-800">
              <td class="py-2 pr-4">128</td>
              <td class="py-2 pr-4">1536</td>
              <td class="py-2 pr-4">768</td>
              <td class="py-2 pr-4">2</td>
              <td class="py-2 pr-4">8</td>
              <td class="py-2 pr-4">83</td>
              <td class="py-2">99</td>
            </tr>
            <tr class="border-b border-gray-800">
              <td class="py-2 pr-4">128</td>
              <td class="py-2 pr-4">1536</td>
              <td class="py-2 pr-4">384</td>
              <td class="py-2 pr-4">4</td>
              <td class="py-2 pr-4">8</td>
              <td class="py-2 pr-4">84</td>
              <td class="py-2">116</td>
            </tr>
            <tr class="border-b border-gray-800">
              <td class="py-2 pr-4">128</td>
              <td class="py-2 pr-4">1536</td>
              <td class="py-2 pr-4">256</td>
              <td class="py-2 pr-4">6</td>
              <td class="py-2 pr-4">8</td>
              <td class="py-2 pr-4">84</td>
              <td class="py-2">132</td>
            </tr>
            <tr class="border-b border-gray-800">
              <td class="py-2 pr-4">256</td>
              <td class="py-2 pr-4">1536</td>
              <td class="py-2 pr-4">768</td>
              <td class="py-2 pr-4">2</td>
              <td class="py-2 pr-4">8</td>
              <td class="py-2 pr-4">170</td>
              <td class="py-2">186</td>
            </tr>
            <tr class="border-b border-gray-800">
              <td class="py-2 pr-4">256</td>
              <td class="py-2 pr-4">1536</td>
              <td class="py-2 pr-4">384</td>
              <td class="py-2 pr-4">4</td>
              <td class="py-2 pr-4">8</td>
              <td class="py-2 pr-4">171</td>
              <td class="py-2">203</td>
            </tr>
            <tr class="border-b border-gray-800">
              <td class="py-2 pr-4">256</td>
              <td class="py-2 pr-4">1536</td>
              <td class="py-2 pr-4">256</td>
              <td class="py-2 pr-4">6</td>
              <td class="py-2 pr-4">8</td>
              <td class="py-2 pr-4">171</td>
              <td class="py-2">219</td>
            </tr>
          </tbody>
        </table>
      </div>

      <!-- Table 8: x^5 instances -->

      <div id="table-8" class="overflow-x-auto my-6">
        <p class="text-sm text-gray-400 mb-2">
          <strong>Table 8.</strong> Concrete instances for
          <span class="math">x^5</span>-POSEIDON<span class="math">^\pi</span>
          over
          <span class="math">\mathbb&#123;F&#125;_p</span>, where
          S-box<span class="math">(x) = x^5</span>.
        </p>
        <table class="w-full text-sm">
          <thead>
            <tr class="border-b border-gray-700">
              <th class="text-left py-2 pr-4">
                <span class="math">M</span>
              </th>
              <th class="text-left py-2 pr-4">
                <span class="math">N</span>
              </th>
              <th class="text-left py-2 pr-4">
                <span class="math">n</span>
              </th>
              <th class="text-left py-2 pr-4">
                <span class="math">t</span>
              </th>
              <th class="text-left py-2 pr-4">
                <span class="math">R_F</span>
              </th>
              <th class="text-left py-2 pr-4">
                <span class="math">R_P</span>
              </th>
              <th class="text-left py-2">Cost</th>
            </tr>
          </thead>
          <tbody class="text-gray-300">
            <tr class="border-b border-gray-800">
              <td class="py-2 pr-4">128</td>
              <td class="py-2 pr-4">1536</td>
              <td class="py-2 pr-4">768</td>
              <td class="py-2 pr-4">2</td>
              <td class="py-2 pr-4">8</td>
              <td class="py-2 pr-4">56</td>
              <td class="py-2">72</td>
            </tr>
            <tr class="border-b border-gray-800">
              <td class="py-2 pr-4">128</td>
              <td class="py-2 pr-4">1536</td>
              <td class="py-2 pr-4">384</td>
              <td class="py-2 pr-4">4</td>
              <td class="py-2 pr-4">8</td>
              <td class="py-2 pr-4">56</td>
              <td class="py-2">88</td>
            </tr>
            <tr class="border-b border-gray-800">
              <td class="py-2 pr-4">128</td>
              <td class="py-2 pr-4">1536</td>
              <td class="py-2 pr-4">256</td>
              <td class="py-2 pr-4">6</td>
              <td class="py-2 pr-4">8</td>
              <td class="py-2 pr-4">57</td>
              <td class="py-2">105</td>
            </tr>
            <tr class="border-b border-gray-800">
              <td class="py-2 pr-4">256</td>
              <td class="py-2 pr-4">1536</td>
              <td class="py-2 pr-4">768</td>
              <td class="py-2 pr-4">2</td>
              <td class="py-2 pr-4">8</td>
              <td class="py-2 pr-4">116</td>
              <td class="py-2">132</td>
            </tr>
            <tr class="border-b border-gray-800">
              <td class="py-2 pr-4">256</td>
              <td class="py-2 pr-4">1536</td>
              <td class="py-2 pr-4">384</td>
              <td class="py-2 pr-4">4</td>
              <td class="py-2 pr-4">8</td>
              <td class="py-2 pr-4">116</td>
              <td class="py-2">148</td>
            </tr>
            <tr class="border-b border-gray-800">
              <td class="py-2 pr-4">256</td>
              <td class="py-2 pr-4">1536</td>
              <td class="py-2 pr-4">256</td>
              <td class="py-2 pr-4">6</td>
              <td class="py-2 pr-4">8</td>
              <td class="py-2 pr-4">117</td>
              <td class="py-2">165</td>
            </tr>
          </tbody>
        </table>
      </div>
    </section>

    <!-- ============================================================ -->
    <!-- APPENDIX G: SELECTING NUMBER OF ROUNDS                        -->
    <!-- ============================================================ -->

    <section id="app-g" class="mb-10">
      <h2 class="text-2xl font-bold">
        Appendix G. Selecting Number of Rounds in General Case
      </h2>
      <p class="text-gray-300">
        The design goal is to minimize R1CS costs. For a fixed
        S-box function, the minimum costs are delivered by the
        smallest number of S-boxes, though the field size also
        plays a role. For each combination (security level
        <span class="math">M</span>, field type, S-box size, S-box
        function), the number of S-boxes is minimized subject to
        the constraints of Eq. (3) and Eq. (4).
      </p>
      <p class="text-gray-300">
        The cost function to minimize is:
        <span class="math">\text&#123;number of S-boxes&#125; = t \cdot R_F + R_P</span>,
        where <span class="math">t \geq 2</span>. The procedure:
      </p>
      <ol class="list-decimal list-inside text-gray-300 mb-4 space-y-1">
        <li>
          Choose
          <span class="math">S(x) = x^\alpha</span> using the
          smallest <span class="math">\alpha</span> such that
          <span class="math">\gcd(\alpha, p-1) = 1</span>
        </li>
        <li>
          Select minimum
          <span class="math">R_F</span> for statistical attack
          security (at least
          <span class="math">R_F = 6</span>)
        </li>
        <li>
          Select <span class="math">R_P</span> that minimizes
          <span class="math">tR_F + R_P</span> subject to algebraic
          attack bounds
        </li>
      </ol>
      <p class="text-gray-300">
        A script is provided to calculate the optimal round
        numbers, using the security margin from Section 5.
      </p>
    </section>

    <!-- ============================================================ -->
    <!-- APPENDIX H: MERKLE TREE INSTANCES                             -->
    <!-- ============================================================ -->

    <section id="app-h" class="mb-10">
      <h2 class="text-2xl font-bold">
        Appendix H. Merkle Tree Instances of POSEIDON
      </h2>
      <p class="text-gray-300">
        POSEIDON instances with width
        <span class="math">t</span> are used for Merkle trees with
        arity <span class="math">t - c</span> where
        <span class="math">c</span> is the capacity (at word
        level). In the prime field setting with 128-bit security
        and a 256-bit field, <span class="math">c = 1</span> and
        the arity is <span class="math">t - 1</span>.
      </p>
      <p class="text-gray-300">
        A tree node may have 0 to
        <span class="math">t - c</span> child elements. Missing
        children are denoted by
        <span class="math">\emptyset</span>. The node hash
        function
        <span class="math">\widehat&#123;H&#125;</span> maps
        <span class="math">\widehat&#123;\mathbb&#123;F&#125;&#125;^&#123;t-c&#125;</span>
        to
        <span class="math">\mathbb&#123;F&#125;^c</span>, where
        <span class="math">\widehat&#123;\mathbb&#123;F&#125;&#125; = \mathbb&#123;F&#125; \cup \&#123;\emptyset\&#125;</span>.
        A missing subtree of depth
        <span class="math">d</span> has hash
        <span class="math">\widehat&#123;H&#125;^d_\emptyset = \widehat&#123;H&#125;(\widehat&#123;H&#125;^&#123;d-1&#125;_\emptyset, \ldots, \widehat&#123;H&#125;^&#123;d-1&#125;_\emptyset)</span>.
      </p>
      <p class="text-gray-300">
        The capacity element encodes a bitmask of which leaves are
        present, using the Iverson bracket notation. For
        variable-length sponge instances, messages are padded with
        a single <span class="math">1 \in \mathbb&#123;F&#125;</span>
        and then zero elements to reach a multiple of
        <span class="math">t - c</span>.
      </p>
    </section>

    <!-- ============================================================ -->
    <!-- APPENDIX I: STARKAD (DISMISSED)                               -->
    <!-- ============================================================ -->

    <section id="app-i" class="mb-10">
      <h2 class="text-2xl font-bold">
        Appendix I. About STARKAD (Currently Dismissed)
      </h2>
      <div class="bg-gray-800 p-4 rounded-lg mb-4">
        <p class="font-semibold mb-1 text-red-400">
          Dismissed variant
        </p>
        <p class="text-gray-400 text-sm">
          STARKAD and all binary field variants are considered
          <strong>dismissed</strong>. "Weaker" versions have been
          broken in [KR21, BCD+20]. The authors advise
          against using them.
        </p>
      </div>
      <p class="text-gray-300">
        STARKAD is the binary field counterpart of POSEIDON,
        constructed by instantiating a sponge with the
        STARKAD<span class="math">^\pi</span> permutation. The
        differences from POSEIDON<span class="math">^\pi</span>
        are: (1) it operates over
        <span class="math">\mathbb&#123;F&#125;_&#123;2^n&#125;^t</span>
        instead of a prime field, and (2) the S-box exponent
        <span class="math">\alpha</span> must satisfy
        <span class="math">\gcd(\alpha, 2^n - 1) = 1</span>.
      </p>
      <p class="text-gray-300">
        The security analysis is similar to POSEIDON, but
        higher-order differential attacks are expected to be more
        effective over binary fields. The MDS matrices originally
        proposed for STARKAD were weak (their squares were
        multiples of the identity), a weakness exploited in
        [KR21, BCD+20].
      </p>

      <!-- Table 9: Old STARKAD parameters -->

      <div id="table-9" class="overflow-x-auto my-6">
        <p class="text-sm text-gray-400 mb-2">
          <strong>Table 9.</strong> <strong>Old</strong> parameter
          sets for STARKAD with S-box<span class="math">(x) = x^3</span>
          (with security margin). These round numbers are
          <strong>not</strong> claimed to be secure.
        </p>
        <table class="w-full text-sm">
          <thead>
            <tr class="border-b border-gray-700">
              <th class="text-left py-2 pr-4">
                <span class="math">M</span>
              </th>
              <th class="text-left py-2 pr-4">
                <span class="math">N</span>
              </th>
              <th class="text-left py-2 pr-4">
                <span class="math">n</span>
              </th>
              <th class="text-left py-2 pr-4">
                <span class="math">t</span>
              </th>
              <th class="text-left py-2 pr-4">
                <span class="math">R_F</span>
              </th>
              <th class="text-left py-2 pr-4">
                <span class="math">R_P</span>
              </th>
              <th class="text-left py-2">Field</th>
            </tr>
          </thead>
          <tbody class="text-gray-300">
            <tr class="border-b border-gray-800">
              <td class="py-2 pr-4">128</td>
              <td class="py-2 pr-4">1512</td>
              <td class="py-2 pr-4">63</td>
              <td class="py-2 pr-4">24</td>
              <td class="py-2 pr-4">8</td>
              <td class="py-2 pr-4">45</td>
              <td class="py-2">
                <span class="math">\mathbb&#123;F&#125;_&#123;2^n&#125;</span>
              </td>
            </tr>
            <tr class="border-b border-gray-800">
              <td class="py-2 pr-4">128</td>
              <td class="py-2 pr-4">1551</td>
              <td class="py-2 pr-4">33</td>
              <td class="py-2 pr-4">47</td>
              <td class="py-2 pr-4">8</td>
              <td class="py-2 pr-4">25</td>
              <td class="py-2">
                <span class="math">\mathbb&#123;F&#125;_&#123;2^n&#125;</span>
              </td>
            </tr>
            <tr class="border-b border-gray-800">
              <td class="py-2 pr-4">256</td>
              <td class="py-2 pr-4">1512</td>
              <td class="py-2 pr-4">63</td>
              <td class="py-2 pr-4">24</td>
              <td class="py-2 pr-4">8</td>
              <td class="py-2 pr-4">45</td>
              <td class="py-2">
                <span class="math">\mathbb&#123;F&#125;_&#123;2^n&#125;</span>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </section>

    <!-- ============================================================ -->
    <!-- APPENDIX J: x^{-1}-POSEIDON (DISMISSED)                      -->
    <!-- ============================================================ -->

    <section id="app-j" class="mb-10">
      <h2 class="text-2xl font-bold">
        Appendix J. About
        <span class="math">x^&#123;-1&#125;</span>-POSEIDON
        (Currently Dismissed)
      </h2>
      <div class="bg-gray-800 p-4 rounded-lg mb-4">
        <p class="font-semibold mb-1 text-red-400">
          Dismissed variant
        </p>
        <p class="text-gray-400 text-sm">
          The inverse S-box variant of POSEIDON
          (<span class="math">x \mapsto x^&#123;-1&#125;</span>) is
          considered <strong>dismissed</strong>. Mistakes in the
          security analysis have been found, and no known
          application uses this version. The authors advise against
          using it.
        </p>
      </div>
      <p class="text-gray-300">
        Besides
        <span class="math">x^\alpha</span>-POSEIDON<span class="math">^\pi</span>,
        a version with S-box
        <span class="math">x \mapsto x^&#123;-1&#125;</span> was
        proposed in the previous version [GKR+21]. The
        only difference regards the S-box details. Old parameter
        sets are listed in
        <a href="#table-10">Table 10</a> for reference.
      </p>

      <!-- Table 10: Old x^{-1}-POSEIDON parameters -->

      <div id="table-10" class="overflow-x-auto my-6">
        <p class="text-sm text-gray-400 mb-2">
          <strong>Table 10.</strong> <strong>Old</strong>
          <span class="math">x^&#123;-1&#125;</span>-POSEIDON over
          <span class="math">\mathbb&#123;F&#125;_p^t</span> (with
          security margin). These round numbers are
          <strong>not</strong> claimed to be secure.
        </p>
        <table class="w-full text-sm">
          <thead>
            <tr class="border-b border-gray-700">
              <th class="text-left py-2 pr-4">
                <span class="math">M</span>
              </th>
              <th class="text-left py-2 pr-4">
                <span class="math">N</span>
              </th>
              <th class="text-left py-2 pr-4">
                <span class="math">n</span>
              </th>
              <th class="text-left py-2 pr-4">
                <span class="math">t</span>
              </th>
              <th class="text-left py-2 pr-4">
                <span class="math">R_F</span>
              </th>
              <th class="text-left py-2 pr-4">
                <span class="math">R_P</span>
              </th>
              <th class="text-left py-2">Cost</th>
            </tr>
          </thead>
          <tbody class="text-gray-300">
            <tr class="border-b border-gray-800">
              <td class="py-2 pr-4">128</td>
              <td class="py-2 pr-4">1536</td>
              <td class="py-2 pr-4">768</td>
              <td class="py-2 pr-4">2</td>
              <td class="py-2 pr-4">8</td>
              <td class="py-2 pr-4">65</td>
              <td class="py-2">81</td>
            </tr>
            <tr class="border-b border-gray-800">
              <td class="py-2 pr-4">128</td>
              <td class="py-2 pr-4">1536</td>
              <td class="py-2 pr-4">256</td>
              <td class="py-2 pr-4">6</td>
              <td class="py-2 pr-4">8</td>
              <td class="py-2 pr-4">57</td>
              <td class="py-2">105</td>
            </tr>
            <tr class="border-b border-gray-800">
              <td class="py-2 pr-4">256</td>
              <td class="py-2 pr-4">1536</td>
              <td class="py-2 pr-4">768</td>
              <td class="py-2 pr-4">2</td>
              <td class="py-2 pr-4">8</td>
              <td class="py-2 pr-4">134</td>
              <td class="py-2">150</td>
            </tr>
            <tr class="border-b border-gray-800">
              <td class="py-2 pr-4">256</td>
              <td class="py-2 pr-4">1536</td>
              <td class="py-2 pr-4">256</td>
              <td class="py-2 pr-4">6</td>
              <td class="py-2 pr-4">8</td>
              <td class="py-2 pr-4">126</td>
              <td class="py-2">174</td>
            </tr>
          </tbody>
        </table>
      </div>
    </section>

    <!-- ============================================================ -->
    <!-- CAVEATS                                                      -->
    <!-- ============================================================ -->

    <section id="caveats" class="mb-10">
      <h2 class="text-2xl font-bold">Caveats</h2>
      <div class="space-y-4 text-sm text-gray-300">
        <div class="bg-gray-800 p-4 rounded-lg">
          <p class="font-semibold mb-1">
            No claim on zero-sum partitions
          </p>
          <p class="text-gray-400">
            The authors do not claim security against zero-sum
            partitions, citing the gap between distinguishable
            rounds and attackable rounds (cf. full KECCAK-f is
            distinguishable but only 6-round KECCAK can be
            attacked).
          </p>
        </div>
        <div class="bg-gray-800 p-4 rounded-lg">
          <p class="font-semibold mb-1">
            STARKAD and
            <span class="math">x^&#123;-1&#125;</span>-POSEIDON dismissed
          </p>
          <p class="text-gray-400">
            The binary field variant (STARKAD) and the inverse
            S-box variant are dismissed due to discovered
            weaknesses.
          </p>
        </div>
        <div class="bg-gray-800 p-4 rounded-lg">
          <p class="font-semibold mb-1">
            Groebner basis degree of regularity
          </p>
          <p class="text-gray-400">
            The result from [ABM23] showing the degree of
            regularity is overestimated does not affect instances
            currently used in practice
            (<span class="math">t \in [3, 5]</span> for SNARKs,
            <span class="math">t \in [12, 24]</span> for
            FRI-based approaches).
          </p>
        </div>
      </div>
    </section>

    <!-- ============================================================ -->
    <!-- REFERENCES                                                   -->
    <!-- ============================================================ -->

    <section id="references" class="mb-10">
      <h2 class="text-2xl font-bold">References</h2>
      <ul class="text-sm text-gray-400 space-y-2">
        <li>
          [GKRRS19] Grassi, Khovratovich, Rechberger, Roy,
          Schofnegger.
          <em>
            POSEIDON: A New Hash Function for Zero-Knowledge
            Proof Systems (Updated Version)</em
          >.
          <a
            href="https://eprint.iacr.org/2019/458"
            target="_blank"
            rel="noopener noreferrer"
          >
            eprint 2019/458
          </a>.
        </li>
        <li>
          [GKR+21] Grassi, Khovratovich,
          Rechberger, Roy, Schofnegger.
          <em>POSEIDON: A New Hash Function for Zero-Knowledge
          Proof Systems</em>. USENIX Security 2021, pp. 519-535.
        </li>
        <li>
          [GLR+20] Grassi, Luftenegger,
          Rechberger, Rotaru, Schofnegger.
          <em>On a Generalization of Substitution-Permutation
          Networks: The HADES Design Strategy</em>.
          EUROCRYPT 2020, LNCS 12106, pp. 674-704.
          <a href="/papers/hades-2019" class="text-blue-400 hover:text-blue-300">[page on this site]</a>
        </li>
        <li>
          [BDPA08] Bertoni, Daemen, Peeters, Van Assche.
          <em>On the Indifferentiability of the Sponge
          Construction</em>. EUROCRYPT 2008, LNCS 4965.
        </li>
        <li>
          [BDPA11] Bertoni, Daemen, Peeters, Van Assche.
          <em>Duplexing the Sponge: Single-Pass Authenticated
          Encryption</em>. SAC 2011, LNCS 7118.
        </li>
        <li>
          [GRS21] Grassi, Rechberger, Schofnegger.
          <em>Proving Resistance Against Infinitely Long
          Subspace Trails</em>. IACR Trans. Symmetric Cryptol.,
          2021(2):314-352.
        </li>
        <li>
          [BCD+20] Beyne, Canteaut, Dinur et al.
          <em>Out of Oddity &mdash; New Cryptanalytic Techniques
          against Symmetric Primitives Optimized for Integrity
          Proof Systems</em>. CRYPTO 2020, LNCS 12172.
          <a href="/papers/out-of-oddity-2020" class="text-blue-400 hover:text-blue-300">[page on this site]</a>
        </li>
        <li>
          [KR21] Keller, Rosemarin.
          <em>Mind the Middle Layer: The HADES Design Strategy
          Revisited</em>. EUROCRYPT 2021, LNCS 12697.
          <a href="/papers/hades-revisited-2020" class="text-blue-400 hover:text-blue-300">[page on this site]</a>
        </li>
        <li>
          [ABM23] Ashur, Buschman, Mahzoun.
          <em>Algebraic Cryptanalysis of POSEIDON</em>.
          IACR ePrint 2023/537.
        </li>
        <li>
          [HJMM08] Hell, Johansson, Maximov, Meier.
          <em>The Grain Family of Stream Ciphers</em>.
          eSTREAM Finalists, LNCS 4986.
        </li>
        <li>
          [Gro16] Groth.
          <em>On the Size of Pairing-Based Non-Interactive
          Arguments</em>. EUROCRYPT 2016, LNCS 9666.
        </li>
        <li>
          [BBB+18] Bunz, Bootle, Boneh et al.
          <em>Bulletproofs: Short Proofs for Confidential
          Transactions and More</em>. IEEE S&amp;P 2018.
        </li>
        <li>
          [BBHR19] Ben-Sasson, Bentov, Horesh, Riabzev.
          <em>Scalable Zero Knowledge with No Trusted
          Setup</em>. CRYPTO 2019, LNCS 11694.
        </li>
        <li>
          [GWC19] Gabizon, Williamson, Ciobotaru.
          <em>PLONK: Permutations over Lagrange-Bases for
          Oecumenical Noninteractive Arguments of
          Knowledge</em>. ePrint 2019/953.
          <a href="/papers/plonk-2019" class="text-blue-400 hover:text-blue-300">[page on this site]</a>
        </li>
        <li>
          [PHGR13] Parno, Howell, Gentry, Raykova.
          <em>Pinocchio: Nearly Practical Verifiable
          Computation</em>. IEEE S&amp;P 2013.
        </li>
        <li>
          [CHM+20] Chiesa, Hu, Maller et al.
          <em>Marlin: Preprocessing zkSNARKs with Universal
          and Updatable SRS</em>. EUROCRYPT 2020.
        </li>
        <li>
          [KPV19] Kattis, Panarin, Vlasov.
          <em>RedShift: Transparent SNARKs from List Polynomial
          Commitment IOPs</em>. ePrint 2019/1400.
        </li>
        <li>
          [MBKM19] Maller, Bowe, Kohlweiss, Meiklejohn.
          <em>Sonic: Zero-Knowledge SNARKs from Linear-Size
          Universal and Updatable Structured Reference
          Strings</em>. CCS 2019.
        </li>
        <li>
          [BCTV14] Ben-Sasson, Chiesa, Tromer, Virza.
          <em>Succinct Non-Interactive Zero Knowledge for a
          von Neumann Architecture</em>. USENIX Security 2014.
        </li>
        <li>
          [AGR+16] Albrecht, Grassi, Rechberger
          et al.
          <em>MiMC: Efficient Encryption and Cryptographic
          Hashing with Minimal Multiplicative
          Complexity</em>. ASIACRYPT 2016, LNCS 10031.
        </li>
        <li>
          [ARS+15] Albrecht, Rechberger, Schneider
          et al.
          <em>Ciphers for MPC and FHE</em>. EUROCRYPT 2015,
          LNCS 9056.
        </li>
        <li>
          [RDP+96] Rijmen, Daemen, Preneel et al.
          <em>The Cipher SHARK</em>. FSE 1996, LNCS 1039.
        </li>
        <li>
          [AABS+19] Aly, Ashur, Ben-Sasson et al.
          <em>Design of Symmetric-Key Primitives for Advanced
          Cryptographic Protocols</em>. ePrint 2019/426.
        </li>
        <li>
          [HBHW19] Hopwood, Bowe, Hornby, Wilcox.
          <em>Zcash Protocol Specification</em>. 2019.
        </li>
        <li>
          [BSGL20] Ben-Sasson, Goldberg, Levit.
          <em>STARK Friendly Hash &mdash; Survey and
          Recommendation</em>. ePrint 2020/948.
        </li>
        <li>
          [JK97] Jakobsen, Knudsen.
          <em>The Interpolation Attack on Block Ciphers</em>.
          FSE 1997, LNCS 1267.
        </li>
        <li>
          [BCLR17] Beierle, Canteaut, Leander, Rotella.
          <em>Proving Resistance Against Invariant Attacks:
          How to Choose the Round Constants</em>. CRYPTO 2017,
          LNCS 10402.
        </li>
        <li>
          [DKP+19] Dinur, Kales, Promitzer et al.
          <em>Linear Equivalence of Block Ciphers with Partial
          Non-Linear Layers</em>. EUROCRYPT 2019, LNCS 11476.
        </li>
        <li>
          [KZG10] Kate, Zaverucha, Goldberg.
          <em>Constant-Size Commitments to Polynomials and
          Their Applications</em>. ASIACRYPT 2010, LNCS 6477.
        </li>
        <li>
          [SCI] SCIPR Lab.
          <em>C++ Library for zkSNARKs (libsnark)</em>.
        </li>
        <li>
          [BS91] Biham, Shamir.
          <em>Differential Cryptanalysis of DES-like
          Cryptosystems</em>. J. Cryptology, 4(1):3-72, 1991.
        </li>
        <li>
          [LMR+09] Lamberger, Mendel, Rechberger
          et al.
          <em>Rebound Distinguishers</em>. ASIACRYPT 2009,
          LNCS 5912.
        </li>
        <li>
          [LAAZ11] Leander, Abdelraheem, AlKhzaimi, Zenner.
          <em>A Cryptanalysis of PRINTcipher: The Invariant
          Subspace Attack</em>. CRYPTO 2011, LNCS 6841.
        </li>
        <li>
          [GKRS22] Grassi, Khovratovich, Ronjom, Schofnegger.
          <em>The Legendre Symbol and the Modulo-2 Operator
          in Symmetric Schemes</em>. IACR Trans. Symmetric
          Cryptol., 2022(1):5-37.
        </li>
        <li>
          [BFSY05] Bardet, Faugere, Salvy, Yang.
          <em>Asymptotic Behaviour of the Index of Regularity
          of Quadratic Semi-Regular Polynomial Systems</em>.
          MEGA 2005.
        </li>
        <li>
          [BCD11] Boura, Canteaut, De Canniere.
          <em>Higher-Order Differential Properties of Keccak
          and Luffa</em>. FSE 2011, LNCS 6733.
        </li>
        <li>
          [W+14] Wood et al.
          <em>Ethereum: A Secure Decentralised Generalised
          Transaction Ledger</em>. 2014.
        </li>
      </ul>
    </section>

    <!-- ============================================================ -->
    <!-- FORMALIZATION STATUS                                         -->
    <!-- ============================================================ -->

    <section id="formalization" class="mb-12">
      <h2 class="text-2xl font-bold mb-4">
        Formalization Status
      </h2>
      <div class="overflow-x-auto">
        <table class="w-full text-sm">
          <thead>
            <tr class="border-b border-gray-700">
              <th class="text-left py-2 pr-4">File</th>
              <th class="text-left py-2 pr-4">Content</th>
              <th class="text-left py-2">Status</th>
            </tr>
          </thead>
          <tbody class="text-gray-300">
            <tr class="border-b border-gray-800">
              <td class="py-2 pr-4 font-mono text-xs">
                Security.lean
              </td>
              <td class="py-2 pr-4">
                Collision, preimage, CICO, zero-sum
              </td>
              <td class="py-2 text-yellow-400">Stated</td>
            </tr>
            <tr class="border-b border-gray-800">
              <td class="py-2 pr-4 font-mono text-xs">
                Sponge.lean
              </td>
              <td class="py-2 pr-4">
                Generic sponge construction
              </td>
              <td class="py-2 text-yellow-400">Stated</td>
            </tr>
            <tr class="border-b border-gray-800">
              <td class="py-2 pr-4 font-mono text-xs">
                SBox.lean
              </td>
              <td class="py-2 pr-4">
                Power map, bijectivity, DP bounds
              </td>
              <td class="py-2 text-yellow-400">Stated</td>
            </tr>
            <tr class="border-b border-gray-800">
              <td class="py-2 pr-4 font-mono text-xs">
                MDS.lean
              </td>
              <td class="py-2 pr-4">
                Cauchy matrix, MDS property, subspaces
              </td>
              <td class="py-2 text-yellow-400">Stated</td>
            </tr>
            <tr class="border-b border-gray-800">
              <td class="py-2 pr-4 font-mono text-xs">
                HADES.lean
              </td>
              <td class="py-2 pr-4">
                Full/partial rounds, ARC, S-box layers
              </td>
              <td class="py-2 text-orange-400">Partial</td>
            </tr>
            <tr class="border-b border-gray-800">
              <td class="py-2 pr-4 font-mono text-xs">
                Basic.lean
              </td>
              <td class="py-2 pr-4">
                Poseidon config, permutation, hash, domain
                separation
              </td>
              <td class="py-2 text-yellow-400">Stated</td>
            </tr>
            <tr class="border-b border-gray-800">
              <td class="py-2 pr-4 font-mono text-xs">
                Poseidon/Security.lean
              </td>
              <td class="py-2 pr-4">
                All security claims, lemma, propositions
              </td>
              <td class="py-2 text-yellow-400">Stated</td>
            </tr>
            <tr class="border-b border-gray-800">
              <td class="py-2 pr-4 font-mono text-xs">
                Instances.lean
              </td>
              <td class="py-2 pr-4">
                Concrete parameter sets (Table 2)
              </td>
              <td class="py-2 text-green-400">Complete</td>
            </tr>
            <tr class="border-b border-gray-800">
              <td class="py-2 pr-4 font-mono text-xs">
                Grain.lean
              </td>
              <td class="py-2 pr-4">
                LFSR parameter generation
              </td>
              <td class="py-2 text-yellow-400">Stated</td>
            </tr>
            <tr class="border-b border-gray-800">
              <td class="py-2 pr-4 font-mono text-xs">
                &mdash;
              </td>
              <td class="py-2 pr-4">
                Section 6: ZK proof systems (R1CS constraints,
                Groth16, Bulletproofs, PLONK, STARKs)
              </td>
              <td class="py-2 text-gray-500">
                Not yet formalized
              </td>
            </tr>
            <tr class="border-b border-gray-800">
              <td class="py-2 pr-4 font-mono text-xs">
                &mdash;
              </td>
              <td class="py-2 pr-4">
                Appendix B: Efficient implementation
                (round constant optimization, sparse matrices)
              </td>
              <td class="py-2 text-gray-500">
                Not yet formalized
              </td>
            </tr>
            <tr class="border-b border-gray-800">
              <td class="py-2 pr-4 font-mono text-xs">
                &mdash;
              </td>
              <td class="py-2 pr-4">
                Appendix C: Security analysis (differential,
                linear, interpolation, Groebner basis attacks)
              </td>
              <td class="py-2 text-gray-500">
                Not yet formalized
              </td>
            </tr>
            <tr class="border-b border-gray-800">
              <td class="py-2 pr-4 font-mono text-xs">
                &mdash;
              </td>
              <td class="py-2 pr-4">
                Appendix D: Compact constraints for partial
                rounds
              </td>
              <td class="py-2 text-gray-500">
                Not yet formalized
              </td>
            </tr>
            <tr class="border-b border-gray-800">
              <td class="py-2 pr-4 font-mono text-xs">
                &mdash;
              </td>
              <td class="py-2 pr-4">
                Appendix F: Concrete instances with security
                margin (Tables 7&ndash;8)
              </td>
              <td class="py-2 text-gray-500">
                Not yet formalized
              </td>
            </tr>
            <tr class="border-b border-gray-800">
              <td class="py-2 pr-4 font-mono text-xs">
                &mdash;
              </td>
              <td class="py-2 pr-4">
                Appendix G&ndash;H: Round selection, Merkle
                tree instances
              </td>
              <td class="py-2 text-gray-500">
                Not yet formalized
              </td>
            </tr>
          </tbody>
        </table>
      </div>
      <div class="mt-4 flex gap-6 text-xs text-gray-500">
        <span>
          <span class="text-green-400">Complete</span> = proved
        </span>
        <span>
          <span class="text-orange-400">Partial</span> = some
          defs proved
        </span>
        <span>
          <span class="text-yellow-400">Stated</span> =
          definitions + sorry
        </span>
        <span>
          <span class="text-gray-500">Not yet formalized</span>
          = no Lean coverage
        </span>
      </div>
    </section>
    <PaperHistory slug="poseidon-2019" />
  </article>
</BaseLayout>
