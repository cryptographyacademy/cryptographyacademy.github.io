---
import BaseLayout from '../../layouts/BaseLayout.astro';
import PaperDisclaimer from '../../components/PaperDisclaimer.astro';
import PaperHistory from '../../components/PaperHistory.astro';

const EPRINT_URL = 'https://eprint.iacr.org/2019/1107';
const CRAWLER = 'marker';
const CONVERTED_DATE = '2026-02-16';
const TITLE_HTML = 'On a Generalization of Substitution-Permutation Networks: The HADES Design Strategy';
const AUTHORS_HTML = 'Lorenzo Grassi, Reinhard L&uuml;ftenegger, Christian Rechberger, Dragos Rotaru, Markus Schofnegger';

const CONTENT = `    <section id="abstract" class="mb-10">
      <h2 class="text-2xl font-bold">Abstract</h2>
      <p class="text-gray-300">Keyed and unkeyed cryptographic permutations often iterate simple round functions. Substitution-permutation networks (SPNs) are an approach that is popular since the mid 1990s. One of the new directions in the design of these round functions is to reduce the substitution (S-Box) layer from a full one to a partial one, uniformly distributed over all the rounds. LowMC and Zorro are examples of this approach.

A relevant freedom in the design space is to allow for a highly non-uniform distribution of S-Boxes. However, choosing rounds that are so different from each other is very rarely done, as it makes security analysis and implementation much harder.

We develop the design strategy Hades and an analysis framework for it, which despite this increased complexity allows for security arguments against many classes of attacks, similar to earlier simpler SPNs.
The framework builds upon the wide trail design strategy, and it additionally allows for security arguments against algebraic attacks, which are much more of a concern when algebraically simple S-Boxes are used.

Subsequently, this is put into practice by concrete instances and benchmarks for a use case that generally benefits from a smaller number of S-Boxes and showcases the diversity of design options we support: A candidate cipher natively working with objects in GF(p), for securing data transfers with distributed databases using secure multiparty computation (MPC). Compared to the currently fastest design MiMC, we observe significant improvements in online bandwidth requirements and throughput with a simultaneous reduction of preprocessing effort, while having a comparable online latency.</p>
      <p class="text-gray-300"><strong>Keywords:</strong> Hades Strategy &middot; Cryptographic Permutations &middot; Secure Multiparty Computation (MPC)</p>
    </section>

    <p class="text-gray-300">(Updated Version)</p>

    <p class="text-gray-300">Lorenzo Grassi1,<sup>3</sup> , Reinhard L&uuml;ftenegger<sup>1</sup> , Christian Rechberger<sup>1</sup> , Dragos Rotaru2,<sup>4</sup> , Markus Schofnegger<sup>1</sup></p>

    <p class="text-gray-300">1 IAIK, Graz University of Technology, Austria <sup>2</sup> University of Bristol, Bristol, UK <sup>3</sup> Know-Center, TU Graz, Austria 4 imec-Cosic, Dept. Electrical Engineering, KU Leuven firstname.surname@iaik.tugraz.at, dragos.rotaru@esat.kuleuven.be</p>

    <p class="text-gray-300">Abstract. Keyed and unkeyed cryptographic permutations often iterate simple round functions. Substitution-permutation networks (SPNs) are an approach that is popular since the mid 1990s. One of the new directions in the design of these round functions is to reduce the substitution (S-Box) layer from a full one to a partial one, uniformly distributed over all the rounds. LowMC and Zorro are examples of this approach.</p>

    <p class="text-gray-300">A relevant freedom in the design space is to allow for a highly nonuniform distribution of S-Boxes. However, choosing rounds that are so different from each other is very rarely done, as it makes security analysis and implementation much harder.</p>

    <p class="text-gray-300">We develop the design strategy Hades and an analysis framework for it, which despite this increased complexity allows for security arguments against many classes of attacks, similar to earlier simpler SPNs. The framework builds upon the wide trail design strategy, and it additionally allows for security arguments against algebraic attacks, which are much more of a concern when algebraically simple S-Boxes are used.</p>

    <p class="text-gray-300">Subsequently, this is put into practice by concrete instances and benchmarks for a use case that generally benefits from a smaller number of S-Boxes and showcases the diversity of design options we support: A candidate cipher natively working with objects in GF(p), for securing data transfers with distributed databases using secure multiparty computation (MPC). Compared to the currently fastest design MiMC, we observe significant improvements in online bandwidth requirements and throughput with a simultaneous reduction of preprocessing effort, while having a comparable online latency.</p>

    <p class="text-gray-300">Keywords: Hades Strategy &ndash; Cryptographic Permutations &ndash; Secure Multiparty Computation (MPC)</p>

    <p class="text-gray-300">This updated version differs from the one appeared at Eurocrypt 2020 mainly for the following reasons.</p>

    <p class="text-gray-300">A Different Linear Layer Matrix. We assume that the MDS matrix prevents the possibility to set up infinitely long subspace trails (either invariant or iterative and either with active S-Boxes or with inactive S-Boxes) for the rounds with partial S-Box layers. In order to test if a matrix satisfies the assumption just given, we suggest to use the tools provided in <a href="#page-35-0">[36]</a>. This allows to prevent possible attacks that exploit the possibility to &quot;skip&quot; all rounds with partial S-Box layers due to unwanted weaknesses in the matrix.</p>

    <p class="text-gray-300">Generic S-Box. We replaced the cube S-Box S(x) = x <sup>3</sup> with the generic power map S(x) = x <sup>&alpha;</sup>, where &alpha; &ge; 3 is the smallest integer s.t. gcd(p &minus; 1, &alpha;) = 1.</p>

    <p class="text-gray-300">Updated Cryptanalysis. We revisited the cryptanalysis in order to take care of recently published attacks (we refer to <a href="#page-34-0">[11,</a><a href="#page-35-1">40,</a><a href="#page-35-0">36]</a> for more details).</p>

    <div class="overflow-x-auto my-4">
      <table class="min-w-full text-sm text-gray-300">
        <thead>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">1</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">Intro</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">oduction</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"></th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"></th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"></th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"></th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"></th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"></th>
        </thead>
        <tbody>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Our Contribution in a Nutshell</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1.1</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">The Big Caveat: Security Analysis of P-SPNs</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">How Risky are Partial SP Networks?</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1.2</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">The Idea in a Nutshell &ndash; The HADES Strategy</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1.3</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Related Work &ndash; Designs with Different Round Functions</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1.4</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">HADESMiMC: Concrete Instantiations for MPC Applications</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">2</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Desc</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">cription of the HADES Strategy</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Crucial Points of the HADES Strategy</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">3</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">The</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Keyed Permutation HadesMiMC</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">3.1</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Specification of HADESMiMC</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">3.2</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Design Considerations: Reviving &quot;Old&quot; Design Ideas</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Why SHARK Among Many Others?</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Choosing the S-Box.</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">4</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Secu</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">rity Analysis</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">4.1</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Main Points of Our Cryptanalysis Results</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Number of Rounds</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Statistical Attacks</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Algebraic Attacks</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Some Considerations &amp; Other Attacks</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">4.2</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Statistical Attacks &ndash; Security Level: <span class="math">\\kappa = N</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Differential Cryptanalysis</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">4.3</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Algebraic Attacks &ndash; Security Level: <span class="math">\\kappa = N \\dots 18</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Interpolation Attack</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">5</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Secu</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">urity Analysis for MPC: <span class="math">\\kappa = n</span> and Data <span class="math">\\leq p^{1/2} \\dots 23</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">5.1</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Statistical Attacks</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">5.2</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Algebraic Attacks</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">6</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Nun</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">aber of Rounds: Security and Efficiency</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Security</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Several Combinations of <span class="math">(\\mathbf{R_F}, \\mathbf{R_P})</span> for the Same Security Level 24</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">6.1</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Efficiency in the Case of MPC Applications</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Cost Metric for MPC: &quot;Number of S-Boxes&quot; and Depth 25</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">6.2</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Best Ratio Between <span class="math">\\mathbf{R_F}</span> and <span class="math">\\mathbf{R_P}</span> &ndash; MPC Application</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Security</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Efficiency &ndash; Best Combination <span class="math">(\\mathbf{R_F}, \\mathbf{R_P})</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">6.3</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Concrete Round Numbers of HADESMiMC</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Reduced and Toy Versions</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Comparison with Ciphers in &quot;Traditional Use Cases&quot;</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">7</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">MP</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">C Applications</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Preliminaries</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Standard Banchmarks</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
        </tbody>
      </table>
    </div>

    <div class="overflow-x-auto my-4">
      <table class="min-w-full text-sm text-gray-300">
        <thead>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"></th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">Experiment Results: Table 2<br>29</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"></th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"></th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"></th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"></th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"></th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"></th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"></th>
        </thead>
        <tbody>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Related Work<br>31</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">8<br>Concluding Remarks: Possible Variants for Future Works</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Acknowledgements<br>32</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">A</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Concrete Instantiations<br>36</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">B</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">MDS Matrix Construction</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">C</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">37<br>Efficient Implementation<br>38</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Round Constants<br>38</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Linear Layer<br>39</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">D</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Statistical Attacks on HadesMiMC&ndash; Details<br><br>40</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">D.1<br>Linear Cryptanalysis<br>40</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">D.2<br>Truncated Differentials<br>40</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">D.3<br>Differential Meet-in-the-Middle Attack<br>41</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">D.4<br>Impossible Differential<br>42</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">D.5<br>Boomerang Attack<br>42</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">D.6<br>Multiple-of-n and &quot;Mixture Differential Cryptanalysis&quot;<br>42</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">D.7<br>Invariant Subspace Attack<br>43</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">D.8<br>Integral/Square Attack<br>44</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">D.9<br>Biclique Cryptanalysis<br>44</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">E</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Algebraic Attacks &ndash; Details</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">44<br>E.1<br>Interpolation Attack and Dense Polynomial<br>44</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">E.2<br>GCD Attack<br>45</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">E.3<br>Gr&ouml;bner Basis Attack &ndash; Details<br>46</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">First Strategy &ndash; Exploiting the &quot;Invariant&quot; Subspace S<br>47</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Second Strategy<br>48</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Third Strategy<br>51</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Special Case: RP<br>= 0<br>53</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1/2<br>E.4<br>Gr&ouml;bner Basis Attack: &kappa; = n and Data &le; p<br>(MPC Application)<br>53</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">First Strategy<br>53</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Second Strategy<br>54</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">F</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Comparison: HadesMiMC with S-Box(x) =<br>&minus;1<br>x<br><br>54</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Main Result<br>55</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Interpolation Attack &ndash; Details<br>55</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">G</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">GMiMCerf<br>for MPC Applications<br>58</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Key Schedule<br>58</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Statistical Attacks<br>58</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Algebraic Attacks<br>59</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
        </tbody>
      </table>
    </div>

    <p class="text-gray-300">Starting out with a layer of local substitution boxes (S-Boxes), combining it with a global permutation box (sometimes merely wires, sometimes affine transformations), and iterating such a round a number of times is a major design approach in symmetric cryptography. The resulting constructions are often referred to as substitution-permutation networks (SPNs) and are used to instantiate block ciphers, permutations, pseudo-random functions (PRFs), one-way functions, hash functions, and various other constructions. The approach can be traced back to Shannon's confusion-diffusion paradigm. There is a considerable amount of efficient designs that exploit this design strategy, including Rijndael/AES <a href="#page-34-1">[22]</a> which is perhaps the most important one. Theoretical aspects have been analyzed too, which include the asymptotic analysis by Miles and Viola <a href="#page-35-2">[46]</a>, and more recent results in the provable security framework <a href="#page-34-2">[28,</a><a href="#page-34-3">18]</a>.</p>

    <p class="text-gray-300">Driven by various new application areas and settings, a variation of the SPN approach &ndash; the so-called partial substitution-permutation network (P-SPN) &ndash; has been proposed and investigated on the practical side <a href="#page-33-1">[5,</a><a href="#page-35-3">30]</a>. The idea is to replace parts of the substitution layer with an identity mapping, leading to substantial practical advantages. A big caveat of this approach is that existing elegant approaches to rule out large classes of attacks via the so-called wide trail strategy <a href="#page-34-4">[21]</a> are no longer applicable and have to be replaced by more ad-hoc approaches, as discussed in more details in Section <a href="#page-5-0">1.1.</a> We note that the well studied Feistel approach and its generalizations, when the round function is using S-Boxes, also have the property that only a part of the internal state is affected by S-Boxes in each round.</p>

    <p class="text-gray-300">Our Contribution in a Nutshell. We propose a new generalization of SPNs, which we call the &quot;Hades&quot; approach<a href="#page-4-2">1</a> . This is illustrated in Fig. <a href="#page-5-1">1.</a> It (1st) restores the ability to apply the elegant wide trail strategy to rule out important classes of attacks, (2nd) is accompanied with a broad framework to rule out various other attack vectors for many relevant instantiation possibilities, and (3rd) is demonstrated to result in even better implementation characteristics in the same application domains P-SPNs have been introduced for.</p>

    <p class="text-gray-300">We use the rest of the introduction to explain this further. In Section <a href="#page-5-0">1.1</a> we explain the difficulty of the security analysis of P-SPNs, in Section <a href="#page-6-1">1.2</a> we outline our alternative generalization of SPNs called Hades. A big part of the paper will then be spent on detailing the approach and its framework for the security analysis. On the practical side, in Section <a href="#page-7-1">1.4</a> we will discuss how applications which rely on properties like a small number of S-Boxes can benefit from this framework. A very recent and independent work <a href="#page-33-2">[3]</a> explores various generalized Feistel networks as a method benefiting similar settings. This nicely complements our paper, and we include this approach in our practical comparisons.</p>

    <p class="text-gray-300"><sup>1</sup> Referring to Fig. <a href="#page-5-1">1</a> and Fig. <a href="#page-9-0">2,</a> if one highlights the S-Boxes per round, the obtained picture resembles a &quot;bident&quot;. In classical mythology, the bident is a weapon associated with Hades, the ruler of the underworld.</p>

    <p class="text-gray-300">    <img src="_page_5_Figure_0.jpeg" alt="" class="my-4 max-w-full" />
</p>

    <p class="text-gray-300">Fig. 1: SP-Networks and Generalizations (P-SPNs and Hades).</p>

      <h3 id="sec-1.1" class="text-xl font-semibold mt-8">1.1 The Big Caveat: Security Analysis of P-SPNs</h3>

    <p class="text-gray-300">The wide trail strategy cannot guarantee security against all attacks in the literature. As a concrete example, algebraic attacks that exploit the low degree of the encryption or decryption function &ndash; like the interpolation attack <a href="#page-35-4">[37]</a> or the higher-order differential one <a href="#page-35-5">[41]</a> &ndash; are (almost) independent of the linear layer used in the round transformation<a href="#page-5-2">2</a> , which is the crucial point of such a design strategy. In other words, especially in the case of a low-degree S-Box, the wide trail strategy is not sufficient by itself, and it must be combined with something else (e.g., increasing the number of rounds) to guarantee security against all known attacks.</p>

    <p class="text-gray-300">Moreover, the &quot;hidden&quot; assumption of such a strategy is that each round contains a full S-Box layer. Even if this is a well accepted practice, there are various applications/contexts in which non-linear operations are much less expensive than linear ones. For example, this includes masking and practical applications of secure multi-party computation (MPC), fully homomorphic encryption (FHE), and zero-knowledge proofs (ZK) that use symmetric primitives.</p>

    <p class="text-gray-300">A possible way to achieve a lower implementation cost is by designing a primitive minimizing the number of non-linear operations. To achieve this goal, possible strategies are looking for low-degree S-Boxes and/or exploiting SPN structures where not all the state goes through the S-Boxes in each round. This second approach has been proposed for the first time by G&eacute;rard et al. <a href="#page-35-3">[30]</a> at CHES 2013. Such partial non-linear SP networks &ndash; in which the non-linear operation is applied to only part of the state in every round &ndash; contain a wide range of possible concrete schemes that were not considered so far, some of which have performance advantages on certain platforms. A concrete instantiation of their methodology is Zorro <a href="#page-35-3">[30]</a>, a 128-bit lightweight AES-like cipher which reduces the number of S-Boxes per round from 16 to only 4 (to compensate, the number of rounds has been increased to 24).</p>

    <p class="text-gray-300"><sup>2</sup> We remark that a linear/affine function does in general not change the degree.</p>

    <p class="text-gray-300">A similar approach has then been considered by Albrecht et al. <a href="#page-33-1">[5]</a> in the recent design of a family of block ciphers called LowMC proposed at Eurocrypt 2015. LowMC is a flexible block cipher based on an SPN structure and designed for MPC/FHE/ZK applications. It combines an incomplete S-Box layer with a strong linear layer to reduce the total number of AND gates.</p>

    <p class="text-gray-300">How Risky are Partial SP Networks? The wide trail strategy and tools that were developed in order to formally prove the security of block ciphers against standard differential and linear cryptanalysis do not apply to partial SP networks such as Zorro, and authors use heuristic arguments instead.</p>

    <p class="text-gray-300">For the case of Zorro, the simple bounds on the number of active S-Boxes in linear and differential characteristics cannot be used due to the modified Sub-Bytes operation. Even though the authors came up with a dedicated approach to show the security of their design, this turned out to be insufficient, as Wang et al. <a href="#page-36-0">[51]</a> found iterative differential and linear characteristics that were missed by the heuristic and used them to break full Zorro. An automated characteristic search tool and dedicated key-recovery algorithms for SP networks with partial non-linear layers have been presented in <a href="#page-33-3">[8]</a>. In there, the authors propose generic techniques for differential and linear cryptanalysis of SP networks with partial non-linear layers. Besides obtaining practical attacks on P-SPN ciphers, the authors concluded that even if &quot;the methodology of building PSP networks based on AES in a straightforward way is flawed, [...] the basic PSP network design methodology can potentially be reused in future secure designs &quot;.</p>

    <p class="text-gray-300">Similarly, the authors of LowMC chose the number of rounds in order to guarantee that no differential/linear characteristic can cover the whole cipher with non-negligible probability. However, they do not provide such strong security arguments against other attack vectors including algebraic attacks. As a result, the security of earlier versions of LowMC against algebraic attacks was found to be lower than expected <a href="#page-34-5">[25,</a><a href="#page-34-6">27]</a>, and full key-recovery attacks on LowMC have been set up. More recently, generalizations of impossible differential attacks have been found for some LowMC instances <a href="#page-35-6">[48]</a>.</p>

    <p class="text-gray-300">Summarizing the current situation: The wide trail strategy is appealing due to its simplicity, but limited to differential and linear attacks, and does not work with partial S-Box layers. Additionally, when S-Boxes are chosen to have a low degree, other attacks vectors are more relevant anyhow. Designs of this type, like Zorro and LowMC, require a lot of ad-hoc analysis.</p>

    <p class="text-gray-300">To address this issue we propose to start with a classical wide trail design, i.e., with a full S-Box layer (outer layer), and then add a part with full and/or partial S-Box layers in the middle. Even without the middle part, the outer layer in itself is supposed to give arguments against differential and linear attacks in exactly the same way the wide trail strategy does. At the same time, arguments against low-degree attacks can be obtained working on the middle layer. Since algebraic attacks exploit the small degree of the encryption/decryption function, the main role of this middle part is to achieve a high degree, with perhaps only few (e.g., one) S-Boxes per round. Depending on the cost metric of the target application one has in mind (e.g., minimizing the total number of non-linear operations), we show that the best solution is to choose the optimal ratio between the number of rounds with full S-Box layers and with partial S-Box layers in order to achieve both security and performance. We refer to this high-level approach as the &quot;Hades&quot; strategy and will be more concrete in the following.</p>

      <h3 id="sec-1.3" class="text-xl font-semibold mt-8">1.3 Related Work &ndash; Designs with Different Round Functions</h3>

    <p class="text-gray-300">Almost all designs for block ciphers and permutations, not only those following the wide trail design strategy, use round functions that are very similar, differing often only in so-called round constants which break symmetries in order to prevent attacks like slide attacks. Notable exceptions to this are the AES finalist MARS, the lightweight cipher PRINCE <a href="#page-34-7">[16]</a> and the cipher Rescue <a href="#page-33-4">[6]</a>, recently proposed for ZK-STARK proof systems and MPC applications. MARS has whitening rounds with a different structure than the inner rounds with the idea to frustrate cryptanalytic attacks. A downside was perhaps that it also complicated cryptanalysis. PRINCE rounds differ in that the latter half of the rounds is essentially the inverse of the first half of the rounds, and a special middle round is introduced. This allows to achieve a special property, namely that a circuit describing PRINCE computes its own inverse (when keyed in a particular way). Similar to PRINCE, each round of Rescue is composed of two steps, which are respectively a non-linear S-Box layer and its inverse (that is, R(&middot;) = M<sup>0</sup> &#9702; S <sup>&minus;</sup><sup>1</sup> &#9702; M &#9702; S(&middot;) for particular affine layers M, M<sup>0</sup> ). Finally, we mention the cases of LowMC <a href="#page-33-1">[5]</a> and Rasta <a href="#page-34-8">[26]</a>, for which different (independent and random) linear layers are used in each round. Due to their particular design strategies, this allows to maximize the amount of diffusion achieved by the linear layer. In none of these cases, however, the amount of non-linearity, and hence their cryptographic strength, differs over the rounds.</p>

    <p class="text-gray-300">We briefly outline the use cases in the following and discuss how our new design compares against the best-in-class.</p>

    <p class="text-gray-300">MPC. There is a large application area around secure multi-party computation. The setting is a secret-sharing-based MPC system where data is often shared as elements of a finite field F<sup>p</sup> for large p. In order to get data securely in and out of such a system, an efficient solution can be to directly evaluate a symmetric primitive within such an MPC system. Note that &quot;traditional&quot; PRFs such as AES are not efficient in this setting, since they are built for computational engines which work over data types that do not easily match the operations possible in the MPC engine. For example, AES is a byte-oriented cipher, which is hard to represent using arithmetic in Fp. More details can be found in <a href="#page-35-7">[35]</a>, where for the first time this setting was explicitly analyzed and where the authors concluded that among various other options MiMC <a href="#page-33-5">[4]</a> was competitive. After these initial works, several new primitives have been proposed for MPC applications, including GMiMC <a href="#page-33-2">[3]</a> (a generalization of MiMC based on Feistel networks), Jarvis and Friday <a href="#page-33-6">[7]</a>, and Rescue and Vision <a href="#page-33-4">[6]</a>. GMiMC was recently broken <a href="#page-34-9">[15]</a> by exploiting its weak key schedule, Gr&ouml;bner basis attacks were found against Jarvis and Friday <a href="#page-33-7">[2]</a>, and also some versions of MiMC were broken using a higher-order differential approach <a href="#page-35-8">[29]</a>.</p>

    <p class="text-gray-300">Concrete Instances. For our concrete instantiations of HadesMiMC, we borrow ideas from the pre-predecessor of AES, namely SHARK <a href="#page-35-9">[49]</a>, an SPN design with a single large MDS layer covering the whole internal state. Concretely specified instances, both full and toy versions, together with their reference implementation, test vectors, and helper scripts are available online.<a href="#page-8-1">3</a></p>

    <p class="text-gray-300">When benchmarking our new design HadesMiMC for MPC applications, we observe significant improvements in online bandwidth requirements and throughput with a simultaneous reduction of preprocessing effort with respect to MiMC and Rescue, while having a comparable online latency. The same holds also for the comparison between HadesMiMC and GMiMC, with the exception for the online throughput when the number of blocks is bigger than or equal to 16.</p>

    <p class="text-gray-300">New Instances for Future Use Cases. HadesMiMC is a very parameterizable design approach: Given any block size and a cost metric that one aims to minimize, a concrete secure instantiation &ndash; hence, the best S-Box size and the best ratio between rounds with full S-Box and partial S-Box layers &ndash; can be created easily using our scripts. In fact we can already report on such usage: A variant of HadesMiMC has been proposed <a href="#page-35-10">[32]</a> for use cases of efficient proof systems like STARKs, SNARKs and Bulletproofs, for which they outperform competing designs, often by a large margin.</p>

    <p class="text-gray-300">Block ciphers and cryptographic permutations are typically designed by iterating an efficiently implementable round function many times in the hope that the resulting composition behaves like a randomly drawn permutation. In general, the same round function is iterated enough times to make sure that any symmetries and structural properties that might exist in the round function vanish. In our case, instead of considering the same non-linear layer for all rounds, we propose to consider a variable number of S-Boxes per round, that is, to use different S-Box layers in the round functions.</p>

    <p class="text-gray-300">Each round of a cipher based on Hades is composed of three steps:</p>

    <ul class="list-disc list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li><ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li>Add Round Key denoted by ARK(&middot;);</li>
    </ol></li>
      <li><ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li>SubWords denoted by S-Box(&middot;);</li>
    </ol></li>
    </ul>

    <p class="text-gray-300"><sup>3</sup> <a href="https://extgit.iaik.tugraz.at/krypto/hadesmimc" target="_blank" rel="noopener noreferrer">https://extgit.iaik.tugraz.at/krypto/hadesmimc</a></p>

    <p class="text-gray-300">    <img src="_page_9_Figure_0.jpeg" alt="" class="my-4 max-w-full" />
</p>

    <p class="text-gray-300">Fig. 2: Construction of Hades (the final matrix multiplication can be omitted).</p>

    <h4 id="sec-misc-1" class="text-lg font-semibold mt-6">3. MixLayer &ndash; denoted by <span class="math">M(\\cdot)</span> .</h4>

    <p class="text-gray-300">A final round key addition is then performed, and the final MixLayer operation can be omitted (we sometimes include it in this description for simplicity):</p>

    <p class="text-gray-300"><span class="math">$\\underbrace{ARK \\to \\text{S-Box} \\to M}_{\\text{1st round}} \\to \\cdots \\to \\underbrace{ARK \\to \\text{S-Box} \\to M}_{(R-1)\\text{-}th \\text{ round}} \\to \\underbrace{ARK \\to \\text{S-Box}}_{\\text{R-}th \\text{ round}} \\to ARK</span>$</p>

    <p class="text-gray-300">The crucial property of HADES is that the number of S-Boxes per round is not the same for every round:</p>

    <ul class="list-disc list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li>a certain number of rounds denoted by  <span class="math">R_F</span>  has a full S-Box layer, i.e., t S-Box functions;</li>
      <li>a certain number of rounds denoted by  <span class="math">R_P</span>  has a partial S-Box layer, i.e.,  <span class="math">1 \\le s &lt; t</span>  S-Boxes and (t-s) identity functions.</li>
    </ul>

    <p class="text-gray-300">In the following, we only consider the case s=1, that is,  <span class="math">R_P</span>  rounds have a single S-Box per round and t-1 identity functions. However, we remark that this construction can be easily generalized (e.g., like LowMC) allowing more than a single S-Box per round in the middle  <span class="math">R_P</span>  rounds.</p>

    <p class="text-gray-300">In more details, assume  <span class="math">R_F = 2 \\cdot R_f</span>  is an even number. Then</p>

    <ul class="list-disc list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li>the first  <span class="math">R_f</span>  rounds have a full S-Box layer,</li>
      <li>the middle  <span class="math">R_P</span>  rounds have a partial S-Box layer (i.e., 1 S-Box per round),</li>
      <li>the last  <span class="math">R_f</span>  rounds have a full S-Box layer.</li>
    </ul>

    <p class="text-gray-300">Note that the rounds with a partial S-Box layer are &quot;masked&quot; by the rounds with a full S-Box layer, which means that an attacker should not (directly) take advantage of the rounds with a partial S-Box layer.</p>

    <p class="text-gray-300">Crucial Points of the HADES Strategy. In the HADES design,  <span class="math">R_f^{\\rm stat}</span>  rounds with full S-Box layers situated at the beginning and the end provide security arguments against statistical attacks, yielding a total of  <span class="math">R_F^{\\rm stat} = 2 \\cdot R_f^{\\rm stat}</span>  rounds with full S-Box layers. As we are going to show, they are sufficient in order to apply the wide trail strategy, even without the middle rounds with partial S-Box layers. Moreover, the choice to have the same number of rounds with full nonlinear layers at the beginning and at the end aims to provide the same security with respect to chosen-plaintext and chosen-ciphertext attacks.</p>

    <p class="text-gray-300">Security against all algebraic attacks is achieved working both with rounds  <span class="math">R_F = R_F^{\\rm stat} + R_F&#x27; \\geq R_F^{\\rm stat}</span>  with full S-Box layers and rounds  <span class="math">R_P \\geq 0</span>  with partial S-Box layers. The degree of the encryption/decryption function has a major impact on the cost of an algebraic attack. Even if one S-Box per round is potentially sufficient to increase this degree, other factors can have a crucial impact on the cost of such attacks too (e.g., a Gr&ouml;bner basis attack also depends on the number of non-linear equations and variables).</p>

    <p class="text-gray-300">Finally, another crucial point of our HADES strategy regards the possibility to choose among several possible combinations of rounds  <span class="math">(R_F \\geq R_F^{\\rm stat}, R_P \\geq 0)</span>  that provide the <em>same</em> security level. Namely, one can potentially decrease (resp. increase) the number of rounds with partial S-Box layers and add (resp. remove)  <span class="math">R&#x27;_F = 2 \\cdot R&#x27;_f \\geq 0</span>  rounds with full S-Box layers instead without affecting the security level. This freedom allows to choose the best combination of rounds  <span class="math">(R_F, R_P)</span>  that minimizes a given cost metric. Roughly speaking, the idea is to find a balance between the approach in an SPN and a P-SPN cipher.</p>

    <p class="text-gray-300">Choosing the Field and the Linear/Non-Linear Layer. Our strategy does not pose any restriction/constriction on the choice of the field, on the linear layer, or on the choice of the S-Box. The idea is to consider a &quot;traditional&quot; SPN cipher &ndash; defined over  <span class="math">(\\mathbb{F}_{q^n})^t</span>  for q=2 or q=p prime &ndash; based on the wide trail strategy, and then to replace a certain number of rounds with full S-Box layers with the same number of rounds with partial S-Box layers in order to reduce the number of non-linear operations, but without affecting the security. The HADES strategy has a considerable impact especially in the case of ciphers with low-degree S-Boxes, since in this case a large number of rounds is required to provide security against algebraic attacks.</p>

    <p class="text-gray-300">HADESMiMC is a construction for cryptographic permutations based on the strategy just proposed. It is obtained by applying the HADES strategy to the cipher SHARK [49] proposed by Rijmen et al. in 1996 and based on the wide trail strategy. Our design works with texts of  <span class="math">t \\geq 2</span>  words<sup>4</sup> in  <span class="math">(\\mathbb{F}_p, +, \\times) \\equiv (GF(p), +, \\times)</span> , where p is a prime of size  <span class="math">p \\approx 2^n \\geq 11</span>  (namely, the smallest prime bigger than  <span class="math">2^3 = 8</span> ) and where + and  <span class="math">\\times</span>  are resp. the addition and the multiplication in  <span class="math">\\mathbb{F}_p</span> . In the following, N denotes  <span class="math">N := \\lceil \\log_2 p \\rceil \\cdot t</span> .</p>

    <p class="text-gray-300">Each round  <span class="math">R_k(\\cdot): (\\mathbb{F}_p)^t \\to (\\mathbb{F}_p)^t</span>  of HADESMiMC is defined as</p>

    <p class="text-gray-300"><span class="math">$R_k(\\cdot) = k + M \\times \\mathcal{S}(\\cdot),</span>$</p>

    <p class="text-gray-300">where  <span class="math">k \\in (\\mathbb{F}_p)^t</span>  is the secret subkey,  <span class="math">M \\in (\\mathbb{F}_p)^{t \\times t}</span>  is an invertible matrix that defines the linear layer,  <span class="math">S(\\cdot) : (\\mathbb{F}_p)^t \\to (\\mathbb{F}_p)^t</span>  is the S-Box layer, defined as  <span class="math">S = [S(\\cdot), \\ldots, S(\\cdot)]</span>  for the rounds with full S-Box layers and as  <span class="math">S = [S(\\cdot), I(\\cdot), \\ldots, I(\\cdot)]</span>  for the rounds with partial S-Box layers, where  <span class="math">S(\\cdot) : \\mathbb{F}_p \\to \\mathbb{F}_p</span>  is a non-linear S-Box and  <span class="math">I(\\cdot)</span>  is the identity function.</p>

    <p class="text-gray-300">The number of rounds  <span class="math">R=2\\cdot R_f+R_P</span>  depends on the choice of the S-Box and of the parameters p and t. For the MPC applications we have in mind, we usually consider a large prime number (namely,  <span class="math">p\\geq 2^{64}</span> , e.g.  <span class="math">p\\approx 2^{128}</span> ), and each round is composed of the following operations:</p>

    <ul class="list-disc list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li>the non-linear S-Box is defined as the <em>power</em> map</li>
    </ul>

    <p class="text-gray-300"><span class="math">$S\\text{-}Box(x) = x^{\\alpha}</span>$</p>

    <p class="text-gray-300">where  <span class="math">\\alpha \\geq 3</span>  is the smallest integer s.t.  <span class="math">\\gcd(p-1,\\alpha)=1</span>  (e.g.,  <span class="math">\\alpha=3</span>  if  <span class="math">\\gcd(p-1,3)=1</span> , or  <span class="math">\\alpha=5</span>  if  <span class="math">\\gcd(p-1,3)\\neq 1</span>  and  <span class="math">\\gcd(p-1,5)=1</span> , and so on)<sup>5</sup>:</p>

    <p class="text-gray-300">&ndash; as in SHARK, the MixLayer of HadesMiMC is defined by a multiplication with a fixed  <span class="math">t \\times t</span>  MDS matrix, which satisfies the assumption given below.</p>

    <p class="text-gray-300">Details about the MDS matrix, the key schedule, and the number of rounds are given in the following. We also provide concrete instantiations in Supplementary Material A.</p>

    <p class="text-gray-300"><strong>About the MDS Matrix.</strong> A  <span class="math">t \\times t</span>  MDS matrix<sup>6</sup> M with elements in GF(p) exists if the condition  <span class="math">2t + 1 \\le p</span>  is satisfied (see [44] for details). An overview</p>

    <p class="text-gray-300"><sup>&amp;</sup>lt;sup&gt;4</sup> The case t = 1 corresponds to MiMC [4].</p>

    <p class="text-gray-300"><sup>&amp;</sup>lt;sup&gt;5</sup> More generally, a power map  <span class="math">x \\mapsto x^{\\alpha}</span>  is a permutation over  <span class="math">\\mathbb{F}_p</span>  if and only if  <span class="math">\\gcd(\\alpha, p-1) \\neq 1</span>  &ndash; see e.g. Hermite's criterion for more details.</p>

    <p class="text-gray-300"><sup>&amp;</sup>lt;sup&gt;6</sup> A matrix  <span class="math">M \\in \\mathbb{F}^{t \\times t}</span>  is called a maximum distance separable (MDS) matrix iff it has a branch number  <span class="math">\\mathcal{B}(M)</span>  equal to  <span class="math">\\mathcal{B}(M) = t+1</span> . The branch number is defined as  <span class="math">\\mathcal{B}(M) = \\min_{x \\in \\mathbb{F}^t \\setminus \\{0\\}} \\{ \\operatorname{wt}(x) + \\operatorname{wt}(M(x)) \\}</span> , where  <span class="math">\\operatorname{wt}(\\cdot)</span>  is the bundle weight in wide trail terminology. Equally, a matrix M is MDS iff every submatrix of M is non-singular.</p>

    <p class="text-gray-300">of several strategies to construct MDS matrices is given in Supplementary Material B.</p>

    <p class="text-gray-300">For our concrete instantiations, we use Cauchy matrices, and we note that not every Cauchy matrix provides the same level of security. Indeed, recent results have shown vulnerabilities in certain classes of Cauchy matrices [11,40,36]. To discuss them, let us first recall what a subspace trail is.</p>

    <p class="text-gray-300"><strong>Definition 1.</strong> [33] Let  <span class="math">(U_1, ..., U_{r+1})</span>  denote a set of r+1 subspaces with  <span class="math">\\dim(U_i) \\le \\dim(U_{i+1})</span> . If for each  <span class="math">i \\in \\{1, ..., r\\}</span>  and for each  <span class="math">a_i</span>  there exists  <span class="math">a_{i+1} \\in U_{i+1}^c</span>  (namely, the complementary subspace of  <span class="math">U_{i+1}</span> ) such that</p>

    <p class="text-gray-300"><span class="math">$R^{(i)}(\\mathcal{U}_i + a_i) \\subseteq \\mathcal{U}_{i+1} + a_{i+1},</span>$</p>

    <p class="text-gray-300">then  <span class="math">(\\mathcal{U}_1, \\ldots, \\mathcal{U}_{r+1})</span>  is a subspace trail of length r for the function  <span class="math">F(\\cdot) = R^{(r)} \\circ \\cdots \\circ R^{(1)}(\\cdot)</span> . If all the previous relations hold with equality, the trail is called a constant-dimensional subspace trail. If the subspace  <span class="math">\\mathcal{U}_i</span>  is invariant (namely,  <span class="math">\\mathcal{U}_i = \\mathcal{U}_{i+1}</span> ), the subspace trail is called invariant.</p>

    <p class="text-gray-300">With this definition in mind, we assume that the MDS matrix prevents the possibility to set up infinitely long subspace trails (either invariant or iterative and either with active S-Boxes or with inactive S-Boxes) for the rounds with partial S-Box layers. Hence, the MDS matrix must guarantee that the longest subspace trail with inactive S-Boxes can cover at most t-1 rounds, where note that such a subspace trail exists independently of the details of the matrix in the case in which only 1 S-Box is applied per round. Indeed, for each  <span class="math">i \\geq 1</span> , we define  <span class="math">\\mathcal{S}^i</span>  as</p>

    <p class="text-gray-300">
<span class="math">$S^{i} := \\{ x \\in \\mathbb{F}^{t} \\mid \\forall j \\le i - 1 : (M^{j} \\cdot x)[0] = 0 \\in \\mathbb{F} \\}, \\tag{1}</span>$</p>

    <p class="text-gray-300">where x[0] denotes the first word of x and where  <span class="math">M^j = M \\cdot \\cdots \\cdot M</span>  for  <span class="math">j \\geq 1</span>  and  <span class="math">M^0 = I</span>  (where I is the identity matrix). It is not hard to check that  <span class="math">\\{S^i, M \\cdot S^i, \\dots, M^{i-1} \\cdot S^i\\}</span>  forms a subspace trail for i partial rounds with inactive S-Boxes.</p>

    <p class="text-gray-300">In order to test if a matrix satisfies the assumption just given, we suggest to use the tools provided in [36]. These tools allow to discard matrices that are weak w.r.t. such assumption. As explained in [36], it is sufficient to test few random Cauchy matrices in order to find a secure one w.r.t. the assumption just given. More details about this and the way we construct the matrices are also given in Supplementary Material A.</p>

    <p class="text-gray-300">Security Level  <span class="math">\\kappa</span>  and Key Schedule. For our goals, we define two security levels, respectively  <span class="math">\\kappa = \\log_2(p) \\cdot t \\approx n \\cdot t = N</span>  and  <span class="math">\\kappa = \\log_2(p) \\approx n</span>  (note that  <span class="math">n = \\lceil \\log_2(p) \\rceil</span>  is the field size in bits).</p>

    <p class="text-gray-300">Case:  <span class="math">\\kappa = \\log_2(p) \\cdot t \\approx N</span> . Let  <span class="math">k \\in (\\mathbb{F}_p)^t</span>  be the secret key of size  <span class="math">N \\approx t \\cdot \\log_2(p)</span>  bits, and let  <span class="math">k = [k_0, k_1, \\dots, k_{t-1}]</span>  be its representation over  <span class="math">\\mathbb{F}_p</span>  (namely,  <span class="math">k_j \\in \\mathbb{F}_p</span>  for each  <span class="math">0 \\le j &lt; t</span> ). We define the <em>i</em>-th round key  <span class="math">k^{(i)}</span>  for  <span class="math">0 \\le i \\le R</span>  (where R is the number of rounds) as follows. For the first round i = 0, the</p>

    <p class="text-gray-300">subkey is simply given by the whitening key, that is,  <span class="math">k^{(0)} := k</span> . For the next rounds, the subkeys are defined by a linear key schedule as</p>

    <p class="text-gray-300"><span class="math">$\\forall i = 1, \\dots, R: \\quad k^{(i)} := \\hat{M} \\cdot k^{(i-1)} + RC^{(i)}</span>$</p>

    <p class="text-gray-300">where  <span class="math">RC^{(i)} \\neq 0</span>  are random round constants and  <span class="math">\\hat{M}</span>  is an MDS matrix<sup>7</sup>. For the matrix  <span class="math">\\hat{M}</span>  we require that  <span class="math">\\hat{M}^i = \\prod_{i=1}^R \\hat{M}</span>  has no zero coefficient<sup>8</sup>, where  <span class="math">1 \\leq i \\leq R</span>  and R is the total number of rounds. This condition implies that each word of each subkey  <span class="math">k^{(i)}</span>  (linearly) depends on all words of k. As a result, even if an attacker guesses a certain number of words of a subkey  <span class="math">k^{(i)}</span> , they do not have information about other subkeys (more precisely, they cannot deduce any words of other subkeys).</p>

    <p class="text-gray-300">Case:  <span class="math">\\kappa = \\log_2(p) \\approx n</span>  (for MPC Applications). Let  <span class="math">k&#x27; \\in \\mathbb{F}_p</span>  be the secret key of size  <span class="math">n \\approx \\log_2(p)</span>  bits. We define the subkeys as</p>

    <p class="text-gray-300"><span class="math">$\\forall i = 0, \\dots, R: \\quad k^{(i)} = \\underbrace{[\\underline{k&#x27;, k&#x27;, \\dots, k&#x27;}]}_{t \\text{ times}} \\oplus RC^{(i)},</span>$</p>

    <p class="text-gray-300">for random round constants  <span class="math">RC^{(i)}</span> .</p>

    <p class="text-gray-300">Efficient Implementation and Decryption. Like for LowMC, the amount of operations required in each round with a partial non-linear layer can be reduced. Referring to the idea proposed in [24], in Supplementary Material C we recall an equivalent representation of an SPN with partial non-linear layers that can be exploited for an efficient implementation of HADESMiMC.</p>

    <p class="text-gray-300">Finally, we mention that &ndash; as for MiMC [4] &ndash; decryption is much more expensive than encryption (e.g.,  <span class="math">x^{1/3} \\equiv x^{(2p-1)/3}</span>  over  <span class="math">\\mathbb{F}_p</span> ). However, we emphasize that HADESMiMC has been proposed for applications where the decryption process (hence, computing the inverse) is not required. We therefore provide benchmark results only for the encryption function. If used for confidentiality, we suggest to use modes where the inverse is not needed (e.g., the counter (CTR) mode).</p>

      <h3 id="sec-3.2" class="text-xl font-semibold mt-8">3.2 Design Considerations: Reviving &quot;Old&quot; Design Ideas</h3>

    <p class="text-gray-300">Why SHARK Among Many Others? Since in our practical applications (e.g., the MPC use case which we will mainly consider) the cost of linear operations is much lower than the cost of non-linear ones, we decided to focus on the most efficient linear layer (from the security point of view) to construct HADESMIMC, namely the one that provides the fastest diffusion at word level. This corresponds to a linear layer defined as a multiplication with an MDS matrix that involves the entire state, which is exactly the case for SHARK.</p>

    <p class="text-gray-300">Since our design strategy can be applied to any SPN design, a possible interesting future problem would be to apply HADES to e.g. AES, in order to see if a certain number of rounds of AES can be replaced with rounds that contain partial non-linear layers without decreasing its security.</p>

    <p class="text-gray-300"><sup>&amp;</sup>lt;sup&gt;7</sup> To be as general as possible,  <span class="math">\\hat{M}</span>  can be equal or different from M.</p>

    <p class="text-gray-300"><sup>&amp;</sup>lt;sup&gt;8</sup> If this is not possible, one must minimize the number of zero coefficients.</p>

    <p class="text-gray-300">Choosing the S-Box. Before going on, we mention that we also considered possible variants of HadesMiMC instantiated by S-Boxes defined by e.g. a different power exponent. In order to motivate our choice, we remember that, since our final goal is to use HadesMiMC for MPC applications over a LAN, the performance in such application is mainly influenced by the total number of non-linear operations (the AND depth/multiplication depth has a small impact on the cost of an MPC application over a LAN, while it could play a crucial role in the case of a WAN). Since linear operations are basically free, the choice to consider a cube S-Box among many other non-linear permutations is motivated by the following considerations:</p>

    <ul class="list-disc list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li>First of all, since there are no quadratic permutation polynomials (namely, x 7&rarr; x <sup>2</sup>+a&middot;x+b for a, b &isin; Fp) over the finite field F<sup>p</sup> (see e.g. <a href="#page-35-13">[43,</a> Theorem 6 - 7] and <a href="#page-34-11">[23,</a> Sect. 2] for details), the cube S-Box requires the smallest number of non-linear operations (namely, two) and at the same time it offers high security against statistical attacks (e.g. its maximum differential probability satisfies DPmax &le; 2/|F| where |F| is the size of the field F);</li>
      <li>Secondly, let us focus on algebraic attacks when using an S-Box of the form S-Box(x) = x d . An S-Box with a higher degree than the cube one allows to reach the maximum degree faster, hence a smaller number of rounds is potentially sufficient to provide security. However, an S-Box with a higher degree requires more operations to be computed. As a result, even if the number of rounds can potentially be decreased<a href="#page-14-2">9</a> , in general the total number of non-linear operations does not change significantly (see e.g. <a href="#page-33-5">[4,</a> Sect. 5] for a detailed analysis<a href="#page-14-3">10</a>). Thus, from this point of view, the choice of the S-Box is in continuity with the choice of the cube S-Box made e.g. for MiMC and for Rescue <a href="#page-33-4">[6]</a> for similar applications.</li>
    </ul>

    <p class="text-gray-300">It is paramount for a new design to present a concrete security analysis. In the following, we provide an in-depth analysis of the security of the HadesMiMC family of block ciphers. Since we cannot ensure that a cipher is secure against all possible attacks, the best option of determining its security is to ensure that it is secure against all known attacks. We follow this strategy for our proposals and the number of rounds of HadesMiMC is then chosen accordingly.</p>

    <p class="text-gray-300">The crucial points of our security analysis are the following:</p>

    <p class="text-gray-300"><sup>9</sup> We emphasize that this is not always the case. For a concrete example, we analyze the security of HadesMiMC instantiated by the inverse S-Box S-Box(x) = 1/x in Supplementary Material <a href="#page-55-1">F.</a> In there, we show that, even though this S-Box has the highest possible degree, the number of rounds needed for security is of the same order as the number of rounds required for the cubic case (see also <a href="#page-35-4">[37,</a> Sect. 3.4] for more details).</p>

    <p class="text-gray-300"><sup>10</sup> In there, the authors show e.g. that the total number of non-linear operations over F<sup>p</sup> (hence, including the square operations) is constant for each permutation function of the form x 7&rarr; x d for d = 2<sup>d</sup> 0 &minus; 1.</p>

    <ul class="list-disc list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li>Security against statistical attacks is obtained exploiting the wide trail strategy by using  <span class="math">R_F^{\\rm stat} = 2 \\cdot R_f^{\\rm stat}</span>  rounds with full S-Box layers.</li>
      <li>The combination of both rounds  <span class="math">R_F = R_F^{\\rm stat} + R&#x27;</span>  with full S-Box layers and/or rounds  <span class="math">R_P \\geq 0</span>  with partial S-Box layers provide security against all other possible attacks. Indeed, even if rounds with partial S-Box layers are sufficient to increase the degree of the encryption/decryption function, other factors can also have a crucial impact on the cost of an algebraic attack.</li>
    </ul>

    <p class="text-gray-300">In the following, we present our security analysis for the case  <span class="math">\\kappa=N</span>  (and full data case). Then, we adapt it for the case  <span class="math">\\kappa=n</span>  (together with the restriction  <span class="math">p^{t/2}\\approx 2^{N/2}</span> ) used for the MPC applications we have in mind.</p>

    <p class="text-gray-300">Here we limit ourselves to highlight the main points of our cryptanalysis results &ndash; a detailed description of the attacks can be found in the following.</p>

    <p class="text-gray-300">Number of Rounds. In the following, given the number of rounds of a distinguisher which is independent of the key, we add at least 2 rounds with full S-Box layers to prevent key-guessing attacks. This choice is motivated by the fact that it is not possible to skip more than a single round with a full S-Box layer without guessing the entire key. Indeed, one round of HADESMIMC already provides full diffusion at word level, while the S-Box provides full diffusion at bit level.</p>

    <p class="text-gray-300"><strong>Statistical Attacks.</strong> Assuming  <span class="math">p \\geq (\\alpha - 1)^2</span>  (which is in general satisfied for large  <span class="math">p \\gg 1</span> ), we are going to show that at least 6 rounds with full S-Box layers are needed to protect HADESMIMC against all statistical attacks in the literature (that is, differential, linear, truncated/impossible differential, boomerang, ...). Depending on p and t, in some cases 10 rounds are necessary in order to guarantee security against these attacks.</p>

    <p class="text-gray-300"><strong>Algebraic Attacks.</strong> Algebraic attacks exploit mainly the low degree of the encryption/decryption function in order to break the cipher. However, as already mentioned, other factors can influence the cost of such attacks.</p>

    <p class="text-gray-300">Interpolation Attack. The goal of an interpolation attack is to construct the polynomial that describes the function: If the number of monomials is too large, such a polynomial cannot be constructed faster than via a brute force attack. A (lower/upper) bound of the number of different monomials can be estimated given the degree of the function. We show that &ndash; when the polynomial is dense &ndash; the attack complexity is approximately  <span class="math">\\mathcal{O}(d^t)</span> , where d is the degree of the polynomial after r rounds. Since  <span class="math">d = \\alpha^r</span> ,  <span class="math">\\log_{\\alpha}(p) + \\log_{\\alpha}(t)</span>  rounds with partial S-Box layers are necessary to guarantee security, where  <span class="math">\\log_{\\alpha}(t)</span>  more rounds guarantee that the polynomial is dense. The cost of the attack does not change when working with rounds with full S-Box layers.</p>

    <p class="text-gray-300">We finally remark that the degree of a function can also depend on its &quot;representation&quot;. To give a concrete example, the function  <span class="math">x^{-1}</span>  can be written as a function of degree p-2 (namely,  <span class="math">x^{-1} \\equiv x^{p-2}</span>  for  <span class="math">x \\neq 0</span> ) or using the &quot;fraction representation&quot; 1/x as introduced in [37], where both the numerator and the denominator are functions of degree at most 1 (see Supplementary Material F for more details on the influence of such representation on the interpolation attack).</p>

    <p class="text-gray-300">Gr&ouml;bner Basis Attack. In a Gr&ouml;bner basis attack, one tries to solve a system of non-linear equations that describe the cipher. The cost of such an attack depends on the degree of the equations, but also on the number of equations and on the number of variables. We show that &ndash; when working with rounds with full S-Box layers &ndash; the attack complexity is approximately  <span class="math">\\mathcal{O}((d/t)^t)</span> . If a partial S-Box layer is used in order to guarantee security against this attack, it could become more efficient to consider degree- <span class="math">\\alpha</span>  equations for single S-Boxes. In this case, a higher number of rounds may be necessary to provide security.</p>

    <p class="text-gray-300">To summarize, a round with a partial S-Box layer can be described by just 1 non-linear equation of degree d and t-1 linear equations, while a round with a full S-Box layer can be described by t non-linear equations of degree d. If the cost of the attack depends on other properties than just the degree (as in the case of a Gr&ouml;bner basis attack), this fact can influence its final cost.</p>

    <p class="text-gray-300">Higher-Order Differential Attack. In the case of a function defined over a Boolean field, the higher-order differential attack exploits the property that given a function  <span class="math">f(\\cdot)</span>  of algebraic degree  <span class="math">\\delta</span> , then  <span class="math">\\bigoplus_{x\\in V\\oplus \\phi} f(x)=0</span>  if the dimension of the subspace V satisfies  <span class="math">\\dim(V)\\geq \\delta+1</span>  (where the algebraic degree  <span class="math">\\delta</span>  of a function  <span class="math">f(x)=x^d</span>  is given by the hamming weight of d, which we denote by  <span class="math">\\operatorname{hw}(d)</span> ). If the algebraic degree is sufficiently high, then the attack does not work.</p>

    <p class="text-gray-300">At first thought, one may think that this attack does not apply (or is much less powerful) in  <span class="math">\\mathbb{F}_p^t</span>  (due to the fact that the only subspaces of  <span class="math">\\mathbb{F}_p</span>  are  <span class="math">\\{0\\}</span>  and  <span class="math">\\mathbb{F}_p</span>  itself). Recently, it has been shown in [11] how to set up an higher-order differential over  <span class="math">\\mathbb{F}_p^t</span> . Given f over  <span class="math">\\mathbb{F}_p</span>  of degree  <span class="math">d \\leq p-2</span> , then  <span class="math">\\sum_{x \\in \\mathbb{F}_p} f(x) = 0</span> . Since this result is related to the degree of the polynomial that describes the permutation, we claim that the number of rounds necessary to guarantee security against the interpolation attack provides security against this attack as well.</p>

    <p class="text-gray-300">Some Considerations &amp; Other Attacks. About the Subspace Trails given in Eq. (1). As we have seen before, independently of the details of the matrix that defines the MixLayer, there exist subspaces trails (of the form  <span class="math">\\{S^r, M \\cdot S^r, \\dots, M^{r-1} \\cdot S^r\\}</span>  &ndash; see Eq. (1) for details) for at most t-1 rounds with partial S-Box layers. Here we discuss the impact of their existence on the security of HADESMiMC. Since rounds with partial S-Box layers are &quot;masked&quot; both by (at least)  <span class="math">R_f \\geq 3</span>  rounds with full S-Box layers and by the presence of the secret key, it seems very hard to exploit them in a non-trivial way in order to set up a</p>

    <p class="text-gray-300">key-recovery attack<sup>11</sup>.</p>

    <p class="text-gray-300">Related-Key Attacks. The related-key attack model is a class of cryptanalytic attacks in which the attacker knows or chooses a relation between several keys and is given access to encryption/decryption functions with all these keys. We explicitly state that we do not make claims in the related-key model as we do not consider it to be relevant for the intended use case.</p>

    <p class="text-gray-300">Hades MiMC Permutation: Security. Since we do not require the indistinguishability of the permutation obtained by Hades MiMC with a fixed key from a &quot;randomly drawn&quot; permutation<sup>12</sup> in the practical applications considered in the following, we explicitly state that we do not make claims about the indistinguishability of the Hades MiMC Permutation.</p>

    <p class="text-gray-300"><strong>Differential Cryptanalysis.</strong> Differential cryptanalysis [13] and its variations are the most widely used techniques to analyze symmetric-key primitives. The differential probability of any function over the finite field  <span class="math">(\\mathbb{F}, +, \\times)</span>  is defined as</p>

    <p class="text-gray-300"><span class="math">$Prob[\\alpha \\to \\beta] := |\\{x : f(x + \\alpha) - f(x) = \\beta\\}|/|\\mathbb{F}|</span>$</p>

    <p class="text-gray-300">where  <span class="math">|\\mathbb{F}|</span>  is the size of the field and where &quot;-&quot; denotes the subtraction operation (x-y=z) iff x=z+y. The probability for the power function  <span class="math">f(x)=x^{\\alpha}</span>  is bounded above by  <span class="math">(\\alpha-1)/|\\mathbb{F}_p|=(\\alpha-1)/p</span> . For example, the cube map has an optimal differential probability over a prime field [47].</p>

    <p class="text-gray-300">As largely done in the literature, we first compute the number of rounds necessary to guarantee that each characteristic has probability at most  <span class="math">p^{-t} \\approx 2^{-N}</span> . Since more characteristics can be used simultaneously in order to set up a differential attack, the previous number of rounds is in general not sufficient to guarantee security. For this reason, we claim that HADESMIMC is secure against differential cryptanalysis if each characteristic has probability smaller than  <span class="math">p^{-2 \\cdot t} \\approx 2^{-2 \\cdot N}</span> . We emphasize that (1st) this basically corresponds to doubling the number of rounds necessary to guarantee that each characteristic has probability at most  <span class="math">2^{-N}</span>  and (2nd) that a similar strategy is largely used in the literature (including e.g. AES).</p>

    <p class="text-gray-300">To give a concrete example, given texts in the same input coset of a subspace  <span class="math">S^r</span> , then after l &lt; r rounds such texts would be in the same output coset of the subspace  <span class="math">M^l \\cdot S^r</span> . At the same time, since it is not possible to choose texts in the &quot;middle&quot; of the cipher due to e.g. the presence of the secret key, it seems hard to exploit this fact in a non-trivial way (that is, without guessing the key or without working in a probabilistic way) in order to break the scheme.</p>

    <p class="text-gray-300">This basically corresponds to the known-key or chosen-key models, where the attacker can have access or even choose the key(s) used, and where the goal is to find some (plaintext, ciphertext) pairs having a certain property with a complexity lower than what is expected for randomly chosen permutations.</p>

    <p class="text-gray-300">As we are going to show, the idea is to compute the <em>minimum number of</em> rounds with full S-Box layers that guarantee this. In other words, we consider a &quot;weaker&quot; version of the cipher defined as</p>

    <p class="text-gray-300">
<span class="math">$R^{R_f} \\circ L \\circ R^{R_f}(\\cdot)</span>$
, where (2)</p>

    <ul class="list-disc list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li>L is an <em>invertible linear layer</em> (which is the &quot;weakest&quot; possible assumption),</li>
      <li><span class="math">-R(\\cdot) = M \\circ \\text{S-Box} \\circ ARK(\\cdot)</span>  where S-Box(\\cdot) is a full S-Box layer (remember that M is an MDS matrix).</li>
    </ul>

    <p class="text-gray-300">Assuming  <span class="math">p \\ge (\\alpha - 1)^2</span>  (which is in general satisfied for  <span class="math">p \\gg 1</span> ), we show that this &quot;weaker&quot; cipher is secure against differential cryptanalysis for</p>

    <p class="text-gray-300">
<span class="math">$R_F^{\\text{stat}} = \\begin{cases} 6 &amp; \\text{if } p \\ge (\\alpha - 1)^{t+1}, \\\\ 10 &amp; \\text{otherwise.} \\end{cases}</span>$
(3)</p>

    <p class="text-gray-300">As a result, it follows that also HADESMiMC (instantiated with  <span class="math">R_F</span>  rounds with full S-Box layers) is secure against such an attack. Indeed, if the linear layer L (which we only assume to be invertible) is replaced by  <span class="math">R_P</span>  rounds of HADESMiMC, its security cannot decrease. The same strategy is exploited in the following in order to prove security against all attacks in this subsection.</p>

    <p class="text-gray-300">In order to prove the result just given, we need a lower bound on the number of active S-Boxes. Observe that the minimum number of active S-Boxes of a cipher of the form</p>

    <p class="text-gray-300"><span class="math">$R^{r&#x27;} \\circ L \\circ R^r(\\cdot) \\equiv SB \\circ \\underbrace{M \\circ SB}_{r&#x27;-1 \\text{ times}} \\circ \\underbrace{L&#x27;}_{\\equiv L \\circ M(\\cdot)} \\circ SB \\circ \\underbrace{M \\circ SB}_{r-1 \\text{ times}}(\\cdot),</span>$</p>

    <p class="text-gray-300">where  <span class="math">r&#x27;, r \\geq 1</span> ,  <span class="math">R(\\cdot)</span>  is a round with a full S-Box layer and where L' is an invertible linear layer, is at least 13</p>

    <p class="text-gray-300">number active S-Boxes
<span class="math">$\\geq (\\lfloor r&#x27;/2 \\rfloor + \\lfloor r/2 \\rfloor) \\times (t+1) + (r&#x27; \\mod 2) + (r \\mod 2)</span>$
.</p>

    <p class="text-gray-300">We emphasize that the middle linear layer  <span class="math">L&#x27;(\\cdot) \\equiv L \\circ M(\\cdot)</span>  plays no role in the computation of the previous number (it has branch number equal to 2). By choosing r' = r = 2, it follows that &ndash; since at least  <span class="math">2 \\cdot (t+1)</span>  S-Boxes are active in the weaker cipher  <span class="math">R^2 \\circ L \\circ R^2(\\cdot)</span>  and since the maximum differential probability of the S-Box is  <span class="math">DP_{max} = (\\alpha - 1)/p</span>  &ndash; each characteristic has probability at most</p>

    <p class="text-gray-300"><span class="math">$\\left(\\frac{\\alpha-1}{p}\\right)^{2\\cdot (t+1)} = \\begin{cases} p^{-2t} \\cdot \\frac{(\\alpha-1)^{2(t+1)}}{p^2} \\le p^{-2\\cdot t} \\approx 2^{-2\\cdot N} &amp; \\text{if } p \\ge (\\alpha-1)^{t+1} \\\\ p^{-t} \\cdot \\frac{(\\alpha-1)^{2(t+1)}}{p^{t+1}} &lt; p^{-t} \\approx 2^{-N} &amp; \\text{since } p^{0.5} &gt; \\alpha - 1 \\end{cases}</span>$</p>

    <p class="text-gray-300">By doubling this number of rounds (i.e., by choosing r' = r = 4), we get that each characteristic has probability at most  <span class="math">p^{-2 \\cdot t} \\approx 2^{-2 \\cdot N}</span> . Finally, 2 more rounds</p>

    <p class="text-gray-300">If  <span class="math">r&#x27;=2\\cdot s&#x27;</span>  is even, then the minimum number of active S-Boxes over  <span class="math">R^{r&#x27;}(\\cdot)</span>  rounds with full S-Box layers is  <span class="math">\\lfloor r&#x27;/2 \\rfloor \\cdot (t+1)</span> . Instead, if  <span class="math">r&#x27;=2\\cdot s&#x27;+1</span>  is odd, then the minimum number of active S-Boxes over  <span class="math">R^{r&#x27;}(\\cdot)</span>  rounds with full S-Box layers is  <span class="math">\\lfloor r&#x27;/2 \\rfloor \\cdot (t+1)+1</span> .</p>

    <p class="text-gray-300">with full S-Box layers guarantee that no differential attack can be set up by key guessing. Indeed, note that (1st) given a partial round key, one has no information about the other round keys (due to the key schedule), and (2nd) 1 round with a full S-Box layer is sufficient to provide full diffusion. Hence, no more than a single round can be skipped by exploiting a partially guessed key.</p>

    <p class="text-gray-300">Other Attacks. In Supplementary Material <a href="#page-41-0">D,</a> we present a (detailed) security analysis against other statistical attacks, including the linear one <a href="#page-35-15">[45]</a>, truncated <a href="#page-35-5">[41]</a> and impossible differential attacks <a href="#page-34-13">[12]</a>, meet-in-the-middle statistical attacks, the integral attack <a href="#page-34-14">[20]</a>, the boomerang attack <a href="#page-35-16">[50]</a>, the multiple-of-8 distinguisher <a href="#page-35-17">[34]</a>, the mixture differential attack <a href="#page-35-18">[31]</a>, and the invariant subspace attack <a href="#page-35-19">[42]</a>. In there, we argue that (the &quot;basic&quot; variants of ) all these attacks do not outperform the differential attack discussed here. Finally, a discussion about biclique cryptanalysis <a href="#page-34-15">[14]</a> is provided.</p>

    <p class="text-gray-300">Interpolation Attack. One of the most powerful attacks against HadesMiMC is the interpolation attack, introduced by Jakobsen and Knudsen <a href="#page-35-4">[37]</a> in 1997.</p>

    <p class="text-gray-300">The strategy of the attack is to construct a polynomial corresponding to the encryption function without knowledge of the secret key. Let E<sup>k</sup> : F &rarr; F be an encryption function. For a randomly fixed key k, the interpolation polynomial P(&middot;) representing Ek(&middot;) can be constructed using e.g. the Vandermonde matrix (cost of &asymp; O(t 2 )) or Lagrange's theorem (cost of &asymp; O(t &middot; log t)). If an adversary can construct such an interpolation polynomial without using the full code book, then they can potentially use it to set up a forgery attack or a key-recovery attack. The attack proceeds by simply guessing the key of the final round, decrypting the ciphertexts and constructing the polynomial for r &minus; 1 rounds<a href="#page-19-2">14</a> . With one extra (plaintext, ciphertext) pair, the attacker checks whether the polynomial is correct. The data cost of the attack is well approximated by the number of texts necessary to construct the interpolation polynomial.</p>

    <p class="text-gray-300">Considering HadesMiMC, the degree of each word after r rounds is roughly approximated by &alpha; r . In particular, since in each round at least one S-Box is applied and since the affine layer does (in general) not change the degree, the degree of one round is three as well. It follows that, if the degree of each word after r &ge; 1 rounds is &alpha; r , then the degree of each word after r + 1 rounds is well approximated by &alpha; <sup>r</sup>+1 even if only one S-Box per round (together with a linear layer that provides &quot;sufficiently good&quot; diffusion at word level, in our case the multiplication with an MDS matrix) is applied. For this reason, in the following we consider a weaker cipher in which each round contains only a single S-Box. If such a cipher is secure against the interpolation attack, then our design is also secure (more S-Boxes per round do not decrease the security). Finally, we recall</p>

    <p class="text-gray-300"><sup>14</sup> The &quot;hidden&quot; assumption is that the cost to construct such a polynomial is smaller than the cost of an encryption. If this assumption does not hold, then the cost of the attack is bigger than the cost of a brute-force attack.</p>

    <p class="text-gray-300">that since at least 3 rounds with a full S-Box layer are applied at the beginning and at the end, our design prevents the possibility to skip a certain number of rounds by a proper choice of the input texts (e.g., by having no active S-Box), as happens for the case of partial SPN ciphers. For this reason, we do not take care of this last event.</p>

    <p class="text-gray-300">Note that not all terms of (total) degree  <span class="math">\\alpha^r</span>  appear before the (r+1)-th round<sup>15</sup>. Thus, assuming the interpolation polynomial of degree  <span class="math">\\alpha^{r-1}</span>  is not sparse in the r-th round, a (rough) estimation for the number of monomials of the interpolation polynomial (and so of the attack complexity) is given by</p>

    <p class="text-gray-300"><span class="math">$(\\alpha^{r-1} + 1)^t \\ge \\alpha^{(r-1)\\cdot t},</span>$</p>

    <p class="text-gray-300">since after r rounds there are t words each of degree at least  <span class="math">\\alpha^{r-1}</span> . By requiring that the number of monomials is equal to the full code book  <span class="math">(\\alpha^{(r-1)\\cdot t} \\simeq p^t</span> , that is,  <span class="math">\\alpha^{r-1} \\simeq p</span> ), the number of rounds must be at least  <span class="math">r \\simeq 1 + \\log_{\\alpha}(p)</span> . However, this estimation for the number of rounds does not guarantee that the interpolation polynomial is dense. For this reason, since the cipher works over a finite field with characteristic p and due to the specific algebraic structure of the cube function, we add  <span class="math">\\lceil \\log_{\\alpha}(t) \\rceil</span>  more rounds in order to guarantee that the interpolation polynomial is not sparse (see Supplementary Material E.1 for details).</p>

    <p class="text-gray-300">A MitM variant of the interpolation attack can also be performed. To thwart this variant and due to the high degree of S-Box <span class="math">^{-1}(x)=x^{1/\\alpha}</span> , it is sufficient to add 2 rounds. Finally, 2 more rounds are added to prevent key-guessing attacks. As a result, the total number of rounds R must satisfy<sup>16</sup></p>

    <p class="text-gray-300">
<span class="math">$R = R_P + R_F \\ge R^{\\text{inter}}(N, t) \\equiv 5 + \\lceil \\log_{\\alpha}(p) \\rceil + \\lceil \\log_{\\alpha}(t) \\rceil</span>$
(4)</p>

    <p class="text-gray-300">to thwart the interpolation attack.</p>

    <p class="text-gray-300">Gr&ouml;bner Basis and GCD Attacks. In the greatest common divisors (GCD) attack [4], given more than one known (plaintext, ciphertext) pair or working on the output of each S-Box of a single (known) pair, one constructs their polynomial representations and computes their polynomial GCD to recover a multiple of the key. We refer to Supplementary Material E.2 for all details about the GCD attack.</p>

    <p class="text-gray-300">The natural generalization of GCDs is the notion of Gr&ouml;bner bases [19]. The attack proceeds like the GCD attack with the final GCD computation replaced by a Gr&ouml;bner basis computation. As our design exhibits a strong algebraic structure, it is paramount to carefully analyze its resistance against Gr&ouml;bner basis attacks. For example, it has been shown recently that this attack vector has been able</p>

    <p class="text-gray-300"><sup>&amp;</sup>lt;sup&gt;15</sup> E.g., after the first round not all words of degree  <span class="math">\\alpha</span>  appear. Indeed, the input of each S-Box in the first round is composed of a single word, which means that after the first round there is no <em>non-linear</em> mixing of different words. Similarly, not all terms of (total) degree  <span class="math">\\alpha^r</span>  appear before the (r+1)-th round.</p>

    <p class="text-gray-300"><sup>&amp;</sup>lt;sup&gt;16</sup> We emphasize that in this analysis we do not take into account the cost to construct the interpolation polynomial, which is (in general) non-negligible.</p>

    <p class="text-gray-300">to break two proposed primitives which do not seem to be vulnerable to other types of classical algebraic attacks [2].</p>

    <p class="text-gray-300">A Gr&ouml;bner basis attack consists of the following steps:</p>

    <ul class="list-disc list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li><ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li>computing the Gr&ouml;bner basis in degrevlex order;</li>
    </ol></li>
      <li><ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li>converting the Gr&ouml;bner basis into lex order;</li>
    </ol></li>
      <li><ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li>factorizing the univariate polynomial, and back-substituting its roots.</li>
    </ol></li>
    </ul>

    <p class="text-gray-300">As largely done in the literature, we assume that the security of ciphers against Gr&ouml;bner basis attacks follows from the infeasible complexity of computing the Gr&ouml;bner basis in degrevlex order. For generic systems, the complexity of this step (hence, a lower bound for the complexity of computing a Gr&ouml;bner basis) for a system of  <span class="math">n_e</span>  polynomials  <span class="math">f_i</span>  in  <span class="math">n_v</span>  variables is  <span class="math">\\mathcal{O}\\left(\\binom{n_v+D_{\\text{reg}}}{D_{\\text{reg}}}^{\\omega}\\right)</span>  operations over the base field  <span class="math">\\mathbb{F}</span>  [19], where  <span class="math">D_{\\text{reg}}</span>  is the degree of regularity and  <span class="math">2 \\leq \\omega &lt; 3</span>  is the linear algebra constant (the memory requirement of these algorithms is of the same order as the running time). The degree of regularity depends on the degrees of the polynomials d and the number of polynomials  <span class="math">n_e</span> .</p>

    <p class="text-gray-300">In the following, we provide three different strategies to attack our design using Gr&ouml;bner bases. We give a brief overview here, while we provide more details in Supplementary Material E.3.</p>

    <p class="text-gray-300">First Strategy. The first strategy consists in using t variables  <span class="math">k_0, \\ldots, k_{t-1}</span>  and t equations for each (plaintext, ciphertext) pair. When being provided at most  <span class="math">p^t-1</span>  (plaintext, ciphertext) pairs, the system of equations that describes the cipher is composed of at most  <span class="math">n_e = t \\cdot (p^t-1)</span>  equations of the form  <span class="math">\\hat{c}_i = f_i(\\hat{p}_0, \\ldots, \\hat{p}_{t-1}, k_0, \\ldots, k_{t-1})</span>  in  <span class="math">n_v = t</span>  variables  <span class="math">k_0, \\ldots, k_{t-1}</span>  (remember that the key schedule is linear). In this over-determined case  <span class="math">(n_e &gt; n_v)</span> , there is no closed-form expression to compute  <span class="math">D_{\\text{reg}}</span> , which is defined as the index of the first non-positive coefficient in</p>

    <p class="text-gray-300"><span class="math">$H(z) = \\frac{\\prod_{i=1}^{n_e} (1-z^{d_i})}{(1-z)^{n_v}} = \\frac{(1-z^{3^r})^{n_e}}{(1-z)^{n_v}} = (1-z^{3^r})^{n_e-n_v} \\cdot (1+z+z^2)^{n_v},</span>$</p>

    <p class="text-gray-300">where  <span class="math">d_i = \\alpha^r</span>  is the degree of the <em>i</em>-th equation. By simple observation, the index of the first non-positive coefficient cannot be smaller than  <span class="math">d = \\alpha^r</span> , since  <span class="math">(1 + z + z^2)^{n_v}</span>  contains only positive terms.</p>

    <p class="text-gray-300">Depending on parameter choices, the hybrid approach [10], which combines exhaustive search with Gr&ouml;bner basis computations, may lead to a reduced cost. Following [10], guessing  <span class="math">\\kappa &lt; t</span>  parts of the key leads to a complexity of</p>

    <p class="text-gray-300">
<span class="math">$\\mathcal{O}\\left(p^{\\kappa} \\cdot \\left(t - \\kappa + D_{\\text{reg}}&#x27;\\right)^{\\omega}\\right),\\tag{5}</span>$</p>

    <p class="text-gray-300">where  <span class="math">D&#x27;_{\\text{reg}} \\leq D_{\\text{reg}}</span>  is the degree of regularity for the system of equations after substituting  <span class="math">\\kappa</span>  variables with their guesses. It follows that to prevent Gr&ouml;bner basis attacks, the minimum number of rounds r must satisfy  <span class="math">p^{\\kappa} \\cdot \\binom{t-\\kappa+D&#x27;_{\\text{reg}}}{D&#x27;_{\\text{reg}}}^{\\omega} \\geq p^t</span>  for all  <span class="math">0 \\leq \\kappa \\leq t-1</span> , and where the degree of regularity  <span class="math">D&#x27;_{\\text{reg}} = \\mathcal{O}(d) \\approx \\alpha^r</span> . In</p>

    <p class="text-gray-300">our cases, the expression Eq. <a href="#page-21-0">(5)</a> is minimized by &kappa; = 0, which implies that</p>

    <p class="text-gray-300"><span class="math">$\\begin{pmatrix} t+d \\\\ d \\end{pmatrix} = \\frac{1}{t!} \\cdot \\prod_{i=1}^t (d+i) \\geq \\frac{d^t}{t!} \\geq \\left(\\frac{d}{t}\\right)^t = 2^{t \\log_2(d/t)},</span>$</p>

    <p class="text-gray-300">where x! &le; x x for x &ge; 1. Setting &omega; = 2, we obtain 2tlog<sup>2</sup> (d/t) &asymp; log<sup>2</sup> (p)&middot;t and</p>

    <p class="text-gray-300"><span class="math">$r \\ge 2 + \\log_{\\alpha}(p)/2 + \\log_{\\alpha}(t),\\tag{6}</span>$</p>

    <p class="text-gray-300">where 2 rounds are added to thwart the MitM version of the attack (note that the degree of the S-Box in the decryption direction is much higher, especially for large p: hence, 2 rounds are in general sufficient to reach maximum degree in the backward direction). As a result,</p>

    <p class="text-gray-300"><span class="math">$R \\ge \\lceil \\log_{\\alpha}(p)/2 \\rceil + \\lceil \\log_{\\alpha}(t) \\rceil + 2</span>$</p>

    <p class="text-gray-300">rounds are sufficient to protect the cipher from this attack. Note that the analysis just proposed is independent of the fact whether the rounds contain a full or a partial S-Box layer.</p>

    <p class="text-gray-300">In general, it is possible to make use of the existence of the subspace S defined as in Eq. <a href="#page-12-0">(1)</a> in order to improve the attack just described. As shown in <a href="#page-34-0">[11]</a>, such a subspace can be exploited in order to replace some non-linear equations of the system that we are trying to solve with linear equations. Indeed, given a text in a coset of the subspace S (r) , the output of this text after r rounds with partial S-Box layers is simply the result of an affine map applied to the input (that is, no S-Box is involved). We analyzed this variant in details in Supplementary Material <a href="#page-47-0">E.3.</a> It turns out that the modified variant of this attack is less competitive than the attack just presented (roughly speaking, due to the higher number of variables that are necessary to describe the system).</p>

    <p class="text-gray-300">Second Strategy. While we use only t variables in the first strategy, the second strategy is to add intermediate variables in each round. Specifically for the rounds with a partial S-Box layer, it is sufficient to add only one intermediate variable. In total, we get a system with more variables and equations compared to the first strategy, but with much lower degrees. We describe this strategy in detail in Supplementary Material <a href="#page-47-0">E.3,</a> where we conclude that R<sup>F</sup> and R<sup>P</sup> have to fulfill</p>

    <p class="text-gray-300"><span class="math">$R_F \\cdot t + R_P \\ge \\left\\lceil \\frac{N}{2 \\cdot \\log_2(\\alpha^{\\alpha}/(\\alpha - 1)^{\\alpha - 1})} \\right\\rceil + \\left\\lceil \\frac{t}{2} \\right\\rceil + 1</span>$</p>

    <p class="text-gray-300">in order for our design to be secure against this type of attack.</p>

    <p class="text-gray-300">Third Strategy. The third strategy is merely a combination of the previous two strategies. We use 2t variables for the R<sup>F</sup> rounds with full S-box layers (i.e., we do not add intermediate variables in these rounds), but we apply the idea from the second strategy during the R<sup>P</sup> rounds with partial S-box layers (i.e., we add intermediate variables in these rounds). This approach gives us a system of 2t equations of degree &alpha; <sup>R</sup><sup>f</sup> and R<sup>P</sup> equations of degree &alpha; in 2t+R<sup>P</sup> variables (t variables for the key and t + R<sup>P</sup> intermediate variables). Since the number of variables is the same as the number of equations, we can estimate  <span class="math">D_{\\text{reg}}</span>  and conclude that our design is secure if<sup>17</sup></p>

    <p class="text-gray-300"><span class="math">$R_F \\geq 2 + \\left\\lceil \\log_{\\alpha}(2) \\cdot \\left( \\frac{N}{2t + R_P} + 2 \\cdot \\log_2(t + R_P) \\right\\rceil - \\left\\lfloor 2 \\cdot \\log_2(t) \\right) \\right\\rfloor,</span>$</p>

    <p class="text-gray-300">is fulfilled (see Supplementary Material E.3 for more details).</p>

    <p class="text-gray-300">Conclusion. We claim that if  <span class="math">R_F</span>  and  <span class="math">R_P</span>  satisfy</p>

    <p class="text-gray-300">
$$\\begin{cases}
R_P + R_F \\ge R^{1\\text{st-Grob}}(N, t) \\equiv 2 + \\left\\lceil \\log_{\\alpha}(p)/2 \\right\\rceil + \\left\\lceil \\log_{\\alpha}(t) \\right\\rceil \\
R_F \\cdot t + R_P \\ge R^{2\\text{nd-Grob}}(N, t) \\equiv \\left\\lceil \\frac{N}{2 \\cdot \\log_2(\\alpha^{\\alpha}/(\\alpha - 1)^{\\alpha - 1})} \\right\\rceil + \\left\\lceil \\frac{t}{2} \\right\\rceil + 1 \\
R_F \\ge R^{3\\text{rd-Grob}}(N, t, R_P) \\equiv 2 + \\left\\lceil \\log_{\\alpha}(2) \\cdot \\left( \\frac{N}{2t + R_P} + 2 \\cdot \\log_2(t + R_P) \\right) \\right\\rceil - \\left\\lfloor 2 \\cdot \\log_2(t) \\right) \\right\\rceil
\\end{cases}$$
(7)</p>

    <p class="text-gray-300">for  <span class="math">N \\approx t \\cdot \\log_2(p)</span> , then HADESMiMC can be considered secure against the Gr&ouml;bner basis attacks proposed here. We mention that if  <span class="math">R_F</span>  satisfies  <span class="math">R_F \\geq R^{\\text{1st-Grob}}(N,t) \\equiv 2 + \\left\\lceil \\log_{\\alpha}(p)/2 \\right\\rceil + \\left\\lceil \\log_{\\alpha}(t) \\right\\rceil</span>  (namely, rounds with full S-Box layers are sufficient to provide security w.r.t. the first strategy), then the second and the third condition are also satisfied.</p>

    <p class="text-gray-300"><strong>Higher-Order Differential Attack.</strong> A well-known result from the theory of Boolean functions is that if the algebraic degree of a vectorial Boolean function  <span class="math">f(\\cdot)</span>  (like a permutation) is d, then the sum over the outputs of the function applied to all elements of an affine vector space  <span class="math">\\mathcal{V} \\oplus c</span>  of dimension  <span class="math">\\geq d+1</span>  for an arbitrary constant c is zero, that is,  <span class="math">\\bigoplus_{v \\in \\mathcal{V} \\oplus c} v = \\bigoplus_{v \\in \\mathcal{V} \\oplus c} f(v) = 0</span> .</p>

    <p class="text-gray-300">This property is exploited by higher-order differential attacks [41]. However, it only holds if  <span class="math">\\mathcal{V}</span>  is a subspace, and not just a generic set of elements. While  <span class="math">\\mathbb{F}_{2^m}</span>  is always a subspace of  <span class="math">\\mathbb{F}_{2^n}</span>  for each  <span class="math">m \\leq n</span> , the only subspaces of  <span class="math">\\mathbb{F}_p</span>  are  <span class="math">\\{0\\}</span>  and  <span class="math">\\mathbb{F}_p</span> . It follows that the biggest subspace of  <span class="math">(\\mathbb{F}_p)^t</span>  has dimension t, in contrast to the biggest subspace of  <span class="math">(\\mathbb{F}_{2^n})^t</span> , which has dimension  <span class="math">n \\cdot t = N</span> .</p>

    <p class="text-gray-300">Due to this consideration, at first thought, one may think that this attack does not apply (or is much less powerful) in  <span class="math">\\mathbb{F}_p^t</span> . Recently, it has been shown in [11] how to set up an higher-order differential over  <span class="math">\\mathbb{F}_p^t</span> . Given f over  <span class="math">\\mathbb{F}_p</span>  of degree  <span class="math">d \\leq p-2</span> , then  <span class="math">\\sum_{x \\in \\mathbb{F}_p} f(x) = 0</span> . Since this result is related to the degree of the polynomial that describes the permutation, we claim that the number of rounds necessary to guarantee security against the interpolation attack provides security against this attack as well.<sup>18</sup></p>

    <p class="text-gray-300"> <span class="math">&lt;sup&gt;^{17}&lt;/sup&gt;</span>  A &quot;more precise&quot; condition can be found in Supplementary Material E.3.</p>

    <p class="text-gray-300"><sup>&amp;</sup>lt;sup&gt;18</sup> We emphasize that this does not hold in general. In particular, working over  <span class="math">\\mathbb{F}_2^N</span> , note that a scheme is secure against the interpolation attack if the corresponding polynomial is full/dense. However, for security against higher-order differential attacks, we want a maximum algebraic degree. These two things are in general not strictly related.</p>

    <p class="text-gray-300">In this section, we will adjust our security arguments in order to provide a security level of only  <span class="math">\\log_2(p) \\approx n</span>  bits (instead of the previous  <span class="math">\\log_2(p^t) \\approx N</span>  bits). At the same time, we only allow an attacker to use  <span class="math">p^{1/2}</span>  data.</p>

      <h3 id="sec-5.1" class="text-xl font-semibold mt-8">5.1 Statistical Attacks</h3>

    <p class="text-gray-300"><strong>Differential Attack.</strong> As before, we assume that the cipher is secure if every characteristic has probability smaller than  <span class="math">p^{-2}</span>  (namely, smaller than the square of the data complexity equal to  <span class="math">\\sqrt{p}</span> ). Working with the weaker cipher  <span class="math">R^{R_f} \\circ L \\circ R^{R_f}(\\cdot)</span>  defined as in Eq. (2), it follows that  <span class="math">R_f = 2</span>  rounds with full S-Box layers are sufficient, since each characteristic has a probability of at most</p>

    <p class="text-gray-300"><span class="math">$\\left(\\frac{(\\alpha-1)}{p}\\right)^{2(t+1)} = \\frac{1}{p^{t+1}} \\cdot \\frac{(\\alpha-1)^{2(t+1)}}{(p)^{t+1}} &lt; p^{-(t+1)},</span>$</p>

    <p class="text-gray-300">under the assumption  <span class="math">p \\geq (\\alpha - 1)^2</span>  (which is in general satisfied for large  <span class="math">p \\gg 1</span> ). However, since a total number of  <span class="math">R_F = 2</span>  full rounds would not lead to 2 consecutive full rounds in our design (recall that we use partial rounds in the middle), we add two other rounds to have at least 2 consecutive rounds both at the beginning and at the end. Finally, we add two more rounds to prevent differential attacks with key guessing and conclude that  <span class="math">R_F \\geq R_F^{\\rm stat} = 6</span>  rounds are needed in this setting.</p>

    <p class="text-gray-300">Other Attacks. The situation in this setting does not differ from the situation analyzed in Section 4.2 (namely, other statistical attacks do not outperform the differential attack just discussed). Therefore, we argue that  <span class="math">R_F = 6</span>  rounds also prevent (the &quot;basic&quot; variant of) all other statistical attacks in the literature.</p>

      <h3 id="sec-5.2" class="text-xl font-semibold mt-8">5.2 Algebraic Attacks</h3>

    <p class="text-gray-300">Interpolation Attack. The approach in this setting follows the analysis given in Section 4.3. By choosing plaintexts with <em>just one active word</em>, the interpolation polynomial depends on a single variable (namely, the active word). Hence, the number of monomials after r rounds is approximated by  <span class="math">\\alpha^r + 1</span> . Since the data complexity is limited to  <span class="math">\\sqrt{p}</span> , here we require that  <span class="math">\\alpha^r + 1 \\ge \\sqrt{p} \\implies r \\ge 0.5 \\cdot \\log_{\\alpha}(p)</span> . We finally add  <span class="math">\\log_{\\alpha}(t) + 4</span>  rounds due to the reasons given in Section 4.3 and conclude that</p>

    <p class="text-gray-300">
<span class="math">$R_F + R_P \\ge R^{\\text{inter}}(p, t) \\equiv 4 + \\left\\lceil \\frac{\\log_{\\alpha}(p)}{2} \\right\\rceil + \\lceil \\log_{\\alpha}(t) \\rceil</span>$
(8)</p>

    <p class="text-gray-300">rounds are needed to prevent the interpolation attack.</p>

    <p class="text-gray-300">GCD and Gr&ouml;bner Basis Attack. As further explained in Supplementary Material E.2, the GCD attack for a key from  <span class="math">(\\mathbb{F}_p)^t</span>  works by first guessing t-1 components of the key in order to have a univariate polynomial in the last</p>

    <p class="text-gray-300">component. Since we are using only one key component in this setting, we do not need to guess these components. With other words, the encryption path alone already yields a univariate polynomial. Since the cost of the GCD computation is approximated by  <span class="math">\\mathcal{O}\\left(d\\log_2^2 d\\right)</span> , we target a complexity of  <span class="math">d\\log_2^2 d \\approx p</span> , where d is well approximated by  <span class="math">\\alpha^{r-1}</span> , and thus require that</p>

    <p class="text-gray-300">
<span class="math">$R_F + R_P \\ge R^{\\text{GCD}}(p, t) \\equiv 4 + \\lceil \\log_{\\alpha}(p) \\rceil - |2\\log_{\\alpha}(\\log_2(p))|. \\tag{9}</span>$</p>

    <p class="text-gray-300">Finally, since computing the Gr&ouml;bner Basis of a univariate system of equations is equivalent to computing the greatest common divisor (GCD) [17], we expect that this attack does not outperform the GCD one just discussed (we refer to Supplementary Material E.3 for more details).</p>

    <p class="text-gray-300">The design goal of HADESMiMC is to offer a cipher optimized for schemes whose performance critically depends on the MULTdepth/ANDdepth, the number of MULTs/ANDs, or the number of MULTs/ANDs per bit. We thus try to be as close to the number of rounds needed for security as possible.</p>

    <p class="text-gray-300"><strong>Security.</strong> HadesMiMC with a security level equal to  <span class="math">\\kappa = N</span>  is secure iff</p>

    <p class="text-gray-300"><span class="math">$\\begin{cases} R_F \\geq \\max \\left\\{ R_F^{\\text{stat}}; R^{\\text{3rd-Grob}}(p,t,R_P) \\right\\}, \\\\ R_P + R_F \\geq \\Psi^{(1)}(p,t) \\equiv \\max \\left\\{ R^{\\text{inter}}(p,t); R^{\\text{1st-Grob}}(p,t); R^{\\text{GCD}}(p,t) \\right\\} = R^{\\text{inter}}(p,t), \\\\ R_P + t \\cdot R_F \\geq \\Psi^{(t)}(p,t) \\equiv R^{\\text{2nd-Grob}}(p,t), \\end{cases}</span>$</p>

    <p class="text-gray-300">where  <span class="math">R^{\\text{inter}}(p,t)</span>  and  <span class="math">R^{\\text{1st-Grob}}(p,t)</span> ,  <span class="math">R^{\\text{2nd-Grob}}(p,t)</span> ,  <span class="math">R^{\\text{3rd-Grob}}(p,t,R_P)</span>  are resp. defined in Eq. (4) and Eq. (7) for the case  <span class="math">\\kappa = N</span> . The analogous case  <span class="math">\\kappa = n</span>  (used for the MPC applications that we have in mind) is discussed in the following.</p>

    <p class="text-gray-300">Several Combinations of  <span class="math">(\\mathbf{R_F}, \\mathbf{R_P})</span>  for the Same Security Level. Besides the possibility to choose the size of the S-Box, we emphasize that one of the strengths of our design is the freedom to choose the ratio between the number of rounds  <span class="math">R_F</span>  with full S-Box layers and the number of rounds  <span class="math">R_P</span>  with partial S-Box layers without affecting the security level. In other words, the crucial point here is that for each given p and t, the designer has in general the freedom to choose among several combinations of rounds  <span class="math">(R_F, R_P)</span>  &ndash; that guarantee the same security &ndash; in order to minimize the analyzed cost metric.</p>

    <p class="text-gray-300">In the following, we show how to choose the best combination of  <span class="math">(R_F, R_P)</span>  in order to minimize a given cost metric (for the same security level). We provide a script<sup>19</sup> that, given an input p, returns the best t and the best ratio between  <span class="math">R_P</span>  and  <span class="math">R_F</span>  for several cost metrics &ndash; as the total number of non-linear operations, the depth, etc., for both  <span class="math">\\kappa = N</span>  and  <span class="math">\\kappa = n</span> .</p>

    <p class="text-gray-300">We mention that we propose also a variant of such script that takes p and t as input, and that returns the best choice of  <span class="math">R_F</span>  and  <span class="math">R_P</span>  that minimizes the given cost metric.</p>

      <h3 id="sec-6.1" class="text-xl font-semibold mt-8">6.1 Efficiency in the Case of MPC Applications</h3>

    <p class="text-gray-300">Consider a generic scenario in which the main goal is to minimize the total number of non-linear operations (namely, the number of S-Boxes in our case) and/or the depth and/or the total number of linear operations proportional respectively to some parameters 0 &le; &#981;, &psi;, &rho; &le; 1 s.t. &#981; + &psi; + &rho; = 1. Among all possible combinations of rounds (R<sup>F</sup> , R<sup>P</sup> ) that provides the same security level, the goal is to find the one that minimizes the metric given by</p>

    <p class="text-gray-300"><span class="math">$\\frac{\\varphi}{\\varphi + \\psi + \\rho} \\times \\# \\text{ S-Boxes } + \\frac{\\psi}{\\varphi + \\psi + \\rho} \\times \\text{ depth } + \\frac{\\rho}{\\varphi + \\psi + \\rho} \\times \\# \\text{ Linear Op.} =</span>$</p>

    <p class="text-gray-300"><span class="math">$= \\frac{\\varphi \\times (t \\cdot R_F + R_P) + \\psi \\times (R_F + R_P) + \\rho \\times (t^2 \\cdot R_F + (3t - 2) \\cdot R_P)}{\\varphi + \\psi + \\rho}</span>$</p>

    <p class="text-gray-300">where the equality holds only for the HadesMiMC design (a precise estimation of the number of linear operations in the case of an efficient implementation of HadesMiMC is provided in Supplementary Material <a href="#page-39-0">C)</a>.</p>

    <p class="text-gray-300">Cost Metric for MPC: &quot;Number of S-Boxes&quot; and Depth. Due to the MPC applications we have in mind, we limit ourselves to optimize HadesMiMC w.r.t. the metric that takes into account both the number of multiplications/S-Boxes and the depth. Motivated by real-life applications, the goal that we face is to reduce the total runtime (described in details in the following). Since the main bottleneck of a protocol run on top of the SPDZ framework is the triple generation mechanism, which is given by the number of non-linear operations, in such a case the goal would be to minimize the total number of S-Boxes, while the depth plays a minor role (and where the cost of a single linear operation is negligible compared to the cost of a single non-linear operation). Due to this consideration, here we focus only on the case 0 &le; &rho; &#981;. For the simplified case &rho; = 0, the previous metric can be simplified as follows:</p>

    <p class="text-gray-300">
<span class="math">$\\gamma \\times number \\ of \\ S\\text{-}Boxes \\ + (1 - \\gamma) \\times depth =</span>$</p>

    <p class="text-gray-300"><span class="math">$= \\gamma \\times (t \\cdot R_F + R_P) + (1 - \\gamma) \\times (R_F + R_P) = R_F \\times [1 + \\gamma \\cdot (t - 1)] + R_P</span>$
(10)</p>

    <p class="text-gray-300">for different values of a parameter &gamma;, where 0 &le; &gamma; &le; 1. Note that &gamma; = 1 and &gamma; = 0 correspond to the cases in which one aims to minimize the total number of S-Boxes and the depth, respectively.</p>

    <p class="text-gray-300">We focus on HadesMiMC with a security level of &kappa; = n (and the data complexity allowed for the attack is less than p 1/2 ), namely the case suitable for the MPC applications we have in mind.</p>

    <p class="text-gray-300">Security. Due to the analysis provided in the previous section, HadesMiMC is secure if the following inequalities are satisfied:</p>

    <p class="text-gray-300"><span class="math">$\\begin{cases} R_F \\ge R_F^{\\text{stat}}; \\\\ R_P + R_F \\ge \\Psi(p, t) \\equiv \\max\\{R^{\\text{GCD}}(p, t); R^{\\text{inter}}(p, t)\\} \\end{cases}</span>$</p>

    <p class="text-gray-300">where  <span class="math">R^{GCD}(p,t)</span>  and  <span class="math">R^{inter}(p,t)</span>  are defined resp. in Eq. (9) and in Eq. (8).</p>

    <p class="text-gray-300">Efficiency &ndash; Best Combination ( <span class="math">\\mathbf{R_F}, \\mathbf{R_P}</span> ). The goal is to find the best combination of rounds  <span class="math">R_F = R_F^{\\text{stat}} + R_F&#x27; \\geq R_F^{\\text{stat}}</span>  and  <span class="math">R_P</span>  that minimizes the cost for different values of  <span class="math">\\gamma</span> , assuming  <span class="math">\\Psi(p,t)</span>  is fixed (equivalently, both p and t are fixed). As we are going to show, in the case in which a single inequality of the form  <span class="math">R_P + R_F \\geq \\Psi(p,t)</span>  must be satisfied, for each  <span class="math">\\gamma</span>  the cost metric Eq. (10) is always minimized by choosing the smallest possible  <span class="math">R_F</span>  (namely,  <span class="math">R_F = R_F^{\\text{stat}}</span> ).</p>

    <p class="text-gray-300">By combining the equation  <span class="math">R_P + R_F \\ge \\Psi(p, t)</span>  with the cost metric for generic  <span class="math">\\alpha</span> , we get that the cost is upper bounded by</p>

    <p class="text-gray-300"><span class="math">$R_F \\times [1 + \\gamma \\cdot (t-1)] + R_P \\bigg|_{R_P + R_F \\ge \\Psi} \\ge R_F \\times \\gamma \\times (t-1) + \\Psi,</span>$</p>

    <p class="text-gray-300">which is minimized by the following choice:</p>

    <ul class="list-disc list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li>if  <span class="math">\\gamma \\neq 0</span> , then the cost is minimized by taking the <em>minimum</em> value of  <span class="math">R_F</span>  (where note that  <span class="math">\\Psi</span>  is fixed for t and N fixed), that is,  <span class="math">R_F = R_F^{\\text{stat}}</span> ;</li>
      <li>if  <span class="math">\\gamma = 0</span> , then the cost is equal for each choice of  <span class="math">(R_F, R_P)</span>  s.t.  <span class="math">R_P + R_F = \\Psi</span> .</li>
    </ul>

    <p class="text-gray-300">Let us analyze the case in which  <span class="math">\\gamma=0</span>  in more details. Even if every choice of  <span class="math">R_F</span>  and  <span class="math">R_P</span>  leads to the same cost w.r.t. the metric  <span class="math">R_F+R_P</span>  (namely, the depth), one possibility would be to choose the combination that minimizes other metrics. By taking into account the number of non-linear and linear operations, it turns out that the best choice is to take the <em>minimum</em> value of  <span class="math">R_F</span> , since</p>

    <p class="text-gray-300"><span class="math">$t \\times R_F + R_P \\Big|_{R_P + R_F \\ge \\Psi} \\ge R_F \\times (t-1) + \\Psi</span>$</p>

    <p class="text-gray-300">are both minimized by taking the minimum  <span class="math">R_F \\geq R_F^{\\text{stat}}</span> .</p>

      <h3 id="sec-6.3" class="text-xl font-semibold mt-8">6.3 Concrete Round Numbers of HadesMiMC</h3>

    <p class="text-gray-300">Based on the security analysis just proposed, in Table 1 we present some example round numbers of HADESMiMC for different security levels and/or applications. Due to the applications that we have in mind, we fixed  <span class="math">\\alpha=3</span>  (namely, we work with the cube S-Box): we remember that the prime p must be chosen s.t.  <span class="math">\\gcd(p-1,3)=1</span> . More details together with conrete instantiations of HADESMiMC are given in Supplementary Material A.</p>

    <p class="text-gray-300">Reduced and Toy Versions. Many classes of cryptanalytic attacks become more difficult with an increased number of rounds. In order to facilitate third-party cryptanalysis and estimate the security margin, reduced-round variants need to be considered. Hence we encourage to study reduced-round variants of HADESMIMC where the symmetry around the middle is kept. For this reason, we highlight that it is also possible to specify toy versions of our cipher which aim at achieving, e.g., only 32 bits of security.</p>

    <p class="text-gray-300">Table 1: A range of different parameter sets for HadesMiMC (based on the cube S-Box &ndash; &alpha; = 3) offering different trade-offs. The first set is for AES-like security (&asymp; 128 bits). The second set is for MPC applications (where the ratio between R<sup>F</sup> and R<sup>P</sup> is chosen in order to minimize the metric cost for given values of &gamma;). The last set includes an example of a toy version useful to facilitate third-party cryptanalysis.</p>

    <div class="overflow-x-auto my-4">
      <table class="min-w-full text-sm text-gray-300">
        <thead>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"></th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"></th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">Text Size Security S-Box Size #S-Box</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"></th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">&gamma;</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">Rounds RF</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">Rounds RP</th>
        </thead>
        <tbody>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">log2<br>p &times; t</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">&kappa;</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">(log2<br>p)</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">(t)</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">(Full S-Box) (Partial S-Box)</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">128</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">128</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">8</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">16</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">10</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">4</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">128</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">128</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">16</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">8</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">8</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">10</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">256</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">128</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">128</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">2</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">0, 0.25, 0.5, 0.75, 1</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">6</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">71</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">256</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">256</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">128</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">2</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">0, 0.25, 0.5, 0.75, 1</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">12</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">76</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">512</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">128</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">128</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">4</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">0, 0.25, 0.5, 0.75, 1</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">6</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">71</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">512</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">512</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">128</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">4</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">0, 0.25, 0.5, 0.75, 1</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">12</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">76</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1 024</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">128</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">128</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">8</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">0, 0.25, 0.5, 0.75, 1</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">6</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">71</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1 024</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1 024</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">128</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">8</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">0, 0.25</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">16</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">72</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1 024</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1 024</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">128</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">8</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">0.5, 0.75, 1</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">14</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">79</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">2 048</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">128</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">128</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">16</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">0, 0.25, 0.5, 0.75, 1</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">6</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">71</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">2 048</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">2 048</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">128</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">16</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">0, 0.25, 0.5</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">20</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">69</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">2 048</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">2 048</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">128</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">16</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">0.75, 1</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">18</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">93</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">4 096</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">128</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">128</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">32</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">0, 0.25, 0.5, 0.75, 1</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">6</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">71</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">4 096</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">4 096</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">128</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">32</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">0</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">24</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">66</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">4 096</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">4 096</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">128</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">32</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">0.25, 0.5</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">22</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">83</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">4 096</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">4 096</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">128</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">32</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">0.75, 1</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">20</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">121</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">8 192</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">128</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">128</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">64</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">0, 0.25, 0.5, 0.75, 1</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">6</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">71</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">8 192</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">8 192</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">128</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">64</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">0</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">32</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">58</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">8 192</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">8 192</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">128</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">64</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">0.25, 0.5</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">22</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">151</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">8 192</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">8 192</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">128</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">64</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">0.75, 1</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">20</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">240</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">32</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">32</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">8</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">4</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">6</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">7</td>
          </tr>
        </tbody>
      </table>
    </div>

    <p class="text-gray-300">About the case in which the security level &kappa; is equal to the size of the S-Box (namely, &kappa; = log<sup>2</sup> p): the given number of rounds provided security only if the data used for the attack is smaller than p 1/2 &ndash; no restriction for the case &kappa; = log<sup>2</sup> p &middot; t &asymp; N.</p>

    <p class="text-gray-300">Comparison with Ciphers in &quot;Traditional Use Cases&quot;. We remark that our strategy is not primarily intended to be used for pure encryption/decryption purposes, and that it is specifically tailored towards new applications like the MPC use case explained previously.</p>

    <p class="text-gray-300">However, if only encryption/decryption is needed, we still expect HadesMiMC to not be significantly worse than more suitable constructions when considering the number of S-Boxes. E.g, when choosing the first instance given in Table <a href="#page-28-1">1</a> (namely, p &asymp; 2 <sup>8</sup> and t = 16) and comparing it to AES-128, we can observe that the total number of S-Boxes is 10 &middot;(16 + 4) = 200 in AES-128 (including the key schedule), and only 10 &middot; 16 + 4 = 164 in our design. At the same time, we point</p>

    <p class="text-gray-300">out that the linear layer of HadesMiMC compared to the one of AES is likely to be a bottleneck when trying to reduce the number of operations.</p>

    <p class="text-gray-300">For MPC applications, we evaluated the HadesMiMC cipher (based on the cube S-Box) using the SPDZ framework <a href="#page-35-20">[39]</a> within a prime field F<sup>p</sup> following the reasoning of <a href="#page-35-7">[35]</a>.</p>

    <p class="text-gray-300">Preliminaries. In the following, we denote by [x] a sharing of x, where each party P<sup>i</sup> holds a random x<sup>i</sup> &isin; Fp. The process of parties reconstructing x is called an opening, i.e., going from a shared value [x] to a public value x known to all parties. As with modern MPC frameworks, a protocol is split into two steps: an input-independent preprocessing phase where parties generate random Beaver triples [a] = [b] &middot; [c], and an input-dependent online phase where parties share their inputs and use the triples generated in the preprocessing phase. The cost of a multiplication between two secret values [z] &larr; [x]&middot;[y] is twofold: one Beaver triple generated in the preprocessing phase as well as two openings and one round of communications in the online phase. Since secretly shared multiplications can be done in parallel, the number of communication rounds in the online phase is given by the multiplicative depth of the circuit (AND depth) to be evaluated. Linear operations such as additions and multiplications by public scalars are non-interactive and require only a small computational overhead.</p>

    <p class="text-gray-300">To evaluate a block cipher in our setting, both the key [k] and the message [m] are secretly shared between the parties. Since most of the computation is linear and is computed locally by the parties, the last thing to show is how to compute the S-Box. The trivial way is to perform [x 2 ] &larr; [x] &middot; [x] and then [x 3 ] &larr; [x 2 ] &middot; [x] using two triples. This can be done with two communication rounds and it has an online cost of 3 openings and uses two triples. However, we use the Grassi et al. version <a href="#page-35-7">[35]</a> to reduce the online cost to one communication round with the same amount of openings and triples. Note that every multiplication translates into two field elements broadcasted by each party (256 bits for p &asymp; 2 <sup>128</sup>).</p>

    <p class="text-gray-300">Standard Benchmarks. We implemented and benchmarked HadesMiMC with a security level of &kappa; = 128 &asymp; log<sup>2</sup> p bits using the SPDZ protocol in the MP-SPDZ library<a href="#page-29-3">20</a> between two computers equipped with i7-7700K CPUs, 32GB RAM, and connected via a 10Gb/s LAN connection with an average round-trip time of 0.47 ms. The choice of MP-SPDZ was due to having the fastest triple generation mechanism for a dishonest majority <a href="#page-35-21">[38]</a> and because it integrates the preprocessing with the online phase to check the end-to-end runtime of a protocol.</p>

    <p class="text-gray-300">In Table <a href="#page-31-0">2,</a> we present a comparison between HadesMiMC and other existing PRFs/block ciphers proposed in the literature for MPC applications &ndash; namely,</p>

    <p class="text-gray-300"><sup>20</sup> <a href="https://github.com/data61/MP-SPDZ" target="_blank" rel="noopener noreferrer">https://github.com/data61/MP-SPDZ</a></p>

    <p class="text-gray-300">MiMC and GMiMC<sub>erf</sub> (both with a security level of  <span class="math">\\kappa = 128</span>  bits) and Rescue (with a security level of  <span class="math">\\kappa = t \\cdot 128</span>  bits) &ndash; in terms of four metrics:</p>

    <ul class="list-disc list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li><ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li><em>latency</em> represents the best running time of a single cipher evaluation by running sequential single-threaded executions of it;</li>
    </ol></li>
      <li><ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li>throughput represents the encryption rate given in the number of field elements that can be encrypted in parallel per second by running multiple executions using different threads;</li>
    </ol></li>
      <li><ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li>communication done by each party per encrypted field element;</li>
    </ol></li>
      <li><ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li>round complexity which is the multiplicative depth of the circuit when computed in MPC.</li>
    </ol></li>
    </ul>

    <p class="text-gray-300">Moreover, we show the difference in throughput and communication between the online phase (columns denoted by 'Online') and when running the entire end-to-end protocols (Runtime).</p>

    <p class="text-gray-300"><strong>Experiment Results: Table 2.</strong> Our design is better in all metrics for t = 2 compared to all other block ciphers (except round complexity when looking at MiMC in CTR mode), and also enjoys the smallest online latency for all t's.</p>

    <p class="text-gray-300">In terms of online throughput it is surpassed by GMiMC<sub>erf</sub> from  <span class="math">t \\geq 16</span>  due to the local computation involving MDS matrices. In more details, from  <span class="math">t \\geq 16</span>  GMiMC<sub>erf</sub> has the best online throughput due to a low number of openings in the online phase and a low computational overhead as it is just swapping and adding states.</p>

    <p class="text-gray-300">When looking at the Runtime column, we see that HADESMiMC outperforms all the existing work from t=2 and the gap increases by a factor of four for t=64 when comparing with GMiMC<sub>erf</sub>. Note that for the runtime column one has to choose carefully the number of encryptions done in parallel. This is because for different t's MP-SPDZ produces triples in a batch of size 524288 and some of them might be unused. We tried to diminish this gap by tweaking the number of encryptions to be produced when benchmarking such that it utilizes a maximum number of triples from the last batch.</p>

    <p class="text-gray-300">Remarks about GMiMC<sub>erf</sub> and Rescue. In order to understand the previous results, we emphasize two facts. First, all versions of GMiMC<sub>erf</sub> with  <span class="math">n \\approx \\log_2 p</span>  bits of security are vulnerable to an attack presented in [15]. Specifically, in [3] the authors propose a number of rounds for  <span class="math">n \\approx \\log_2 p</span>  bits of security, assuming the attacker has access to the full code book (up to  <span class="math">p^t \\approx 2^N</span>  different texts). Secondly, in order to have a more precise comparison, in Supplementary Material G we adapt their analysis in the case in which the attacker has access to at most  <span class="math">p^{1/2}</span>  different chosen texts. This attack &ndash; which is reminiscent of a slide attack &ndash; makes only use of the weak key schedule and does not exploit any particular properties of the cipher. Hence, while the versions of GMiMC<sub>erf</sub> used here are broken in theory, we conjecture that a stronger key schedule can help to avoid this attack. Therefore, since in MPC applications round keys are precomputed (the cost of MPC applications is not influenced by the key schedule), we decided</p>

    <p class="text-gray-300"></p>

    <div class="overflow-x-auto my-4">
      <table class="min-w-full text-sm text-gray-300">
        <thead>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">Cipher</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">Text Size</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">Online</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"></th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"></th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">Runtime (multi-thread)</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"></th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"></th>
        </thead>
        <tbody>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">log2<br>p &times; t</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">(MPC)<br>Rounds</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Lat. (ms)<br>(s-thr)</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Fp/s<br>(m-thr)</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Comm.<br>per Fp</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Fp/s</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Comm.<br>per Fp</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Rescue</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">256</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">98</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">5.54</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">23 464</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">6.10</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">70</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">971</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">MiMC2</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">256</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">73</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">3.53</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">79 728</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">3.50</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">192</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">366</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">GMiMCerf</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">256</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">146</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">7.50</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">71 661</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">3.50</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">137</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">487</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">HMiMC</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">256</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">78</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">3.85</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">117 358</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1.90</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">261</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">266</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Rescue</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">512</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">50</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1.25</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">46 890</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">3.08</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">136</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">485</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">MiMC4</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">512</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">73</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1.69</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">83 876</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">3.50</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">192</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">366</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">GMiMCerf</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">512</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">150</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">3.42</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">137 058</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1.80</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">274</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">243</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">HMiMC</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">512</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">78</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1.90</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">185 160</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1.14</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">526</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">133.2</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Rescue</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1024</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">32</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">0.59</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">72 689</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1.93</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">137</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">484</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">MiMC8</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1024</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">73</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1.08</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">85 795</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">3.50</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">192</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">366</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">GMiMCerf</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1024</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">158</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1.98</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">252 102</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">0.94</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">271</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">241</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">HMiMC</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1024</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">78</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">0.98</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">253 475</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">0.71</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1045</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">66.8</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Rescue</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">2048</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">32</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">0.45</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">66 830</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1.93</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">273</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">243</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">MiMC16</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">2048</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">73</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">0.63</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">87 318</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">3.50</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">192</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">366</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">GMiMCerf</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">2048</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">174</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1.09</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">425 717</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">0.52</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">137</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">483</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">HMiMC</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">2048</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">78</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">0.5</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">283 678</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">0.50</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1088</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">60.9</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Rescue</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">4096</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">32</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">0.42</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">57 695</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1.93</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">274</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">243</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">MiMC32</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">4096</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">73</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">0.34</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">87 831</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">3.5</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">192</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">366</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">GMiMCerf</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">4096</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">206</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">0.68</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">637 747</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">0.3</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">276</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">241</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">HMiMC</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">4096</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">78</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">0.32</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">258 610</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">0.39</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1098</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">60.8</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Rescue</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">8192</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">32</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">0.31</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">44 697</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1.93</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">283</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">243</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">MiMC64</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">8192</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">73</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">0.20</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">87 773</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">3.50</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">192</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">366</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">GMiMCerf</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">8192</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">323</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">0.50</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">664 091</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">0.24</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">550</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">120</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">HMiMC</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">8192</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">78</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">0.11</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">189 772</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">0.32</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">2189</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">30.6</td>
          </tr>
        </tbody>
      </table>
    </div>

    <p class="text-gray-300">Table 2: Two-party costs for Rescue, MiMC<sup>t</sup> (namely, t parallel MiMC-128/128 in CTR mode), GMiMCerf and HMiMC&equiv;HadesMiMC over a 10Gb/s LAN. Communication is given in KiloBytes. Runtime column represents the entire protocol execution, including preprocessing.</p>

    <p class="text-gray-300">to keep the corresponding numbers in the table, noting that a secure variant of GMiMCerf using an appropriate key schedule would yield the same results.</p>

    <p class="text-gray-300">We highlight that Rescue is specified with a security level of p <sup>t</sup> &asymp; 2 <sup>N</sup> bits only, besides a conservative security margin of 100%. Due to the particular design of Rescue (each round contains a non-linear layer and its inverse), this choice has been made due to the fact that &quot;[...] the field of algebraic attacks seems rather underexplored. As a result, it is difficult to make a compelling security argument valid for the entire family of attacks&quot; (see <a href="#page-33-4">[6,</a> Sect. 3.5]). Hence, we mention that it is potentially possible that the gap (in terms of performance) between Rescue and HADESMIMC can actually be reduced in the case in which the &quot;design choices [of Rescue are] indeed too conservative, and that the complexity and security margins can safely be reduced&quot; (see [6, Sect. 4.6]).</p>

    <p class="text-gray-300"><strong>Related Work.</strong> At CCS'18, Agrawal <em>et al.</em> [1] applied a threshold PRF to compute an encryption between several parties where one party  <span class="math">P_{\\rm ext}</span>  holds a plaintext m, does a 2-round protocol with multiple servers, and  <span class="math">P_{\\rm ext}</span>  receives an encryption  <span class="math">E_k(m)</span>  where the key k is shared among the servers. This use case is covered by us as well by having the servers computing the block cipher in MPC with  <span class="math">P_{\\rm ext}</span>  as an external party providing the input m and getting the output  <span class="math">E_k(m)</span> . In the two-server case where one external party gets the ciphertext, Agrawal <em>et al.</em> obtain a latency of 0.05 ms and a throughput of around 2 million encrypted blocks. HADESMIMC with t=2 blocks can achieve an online latency of 3.85 ms and an online throughput of more than 117 000 blocks per second.</p>

    <p class="text-gray-300">Although this design performs orders of magnitude slower than Agrawal et al.'s, we provide more flexibility: (1st)  <span class="math">P_{\\rm ext}</span>  does not have to be online with the other servers as in Agrawal et al. to compute the encryption; (2nd) it is more friendly towards working with encrypted databases: servers upload the ciphertext to a DB and anyone holding k can decrypt, whereas for Agrawal et al. each party  <span class="math">(P_{\\rm ext}</span>  or else) needs to be online with the servers to decrypt.</p>

    <p class="text-gray-300">In this paper, we proposed the HADES design strategy, based on the idea of mixing rounds with full S-Box layers and partial S-Box layers in a SPN scheme with the goal to achieve security and at the same time good performance in all applications where the cost is proportional to the number of non-linear operations. As a concrete cipher, we proposed HADESMiMC, obtained by applying the HADES strategy to (a modified version of) the block cipher SHARK defined over  <span class="math">\\mathbb{F}_p^t</span>  for a prime p.</p>

    <p class="text-gray-300">As future work, it could be interesting to define ciphers based on the HADES strategy over  <span class="math">\\mathbb{F}_{2^n}^t</span>  or over  <span class="math">\\mathbb{F}_{p^n}^t</span> . E.g., consider the case of HADESMiMC defined over  <span class="math">\\mathbb{F}_{2^n}^t</span>  or over  <span class="math">\\mathbb{F}_{p^n}^t</span> :</p>

    <ul class="list-disc list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li>the S-Box  <span class="math">S(x) = x^{\\alpha}</span>  is a permutation if  <span class="math">gcd(2^{n} 1, \\alpha) = 1</span>  (e.g., if n odd for  <span class="math">\\alpha = 3</span> ) and if  <span class="math">gcd(p^{n} 1, \\alpha) = 1</span>  (e.g.,  <span class="math">gcd(p 1, \\alpha) = 1</span>  and n odd);</li>
      <li>the number of rounds cannot be smaller than the corresponding number of rounds of HADESMiMC defined over  <span class="math">\\mathbb{F}_q^t</span>  for the prime q closest to  <span class="math">2^n</span>  or  <span class="math">p^n</span> .</li>
    </ul>

    <p class="text-gray-300">About this last point, note indeed that all attacks analyzed in this paper work approximately in the same way if HADESMIMC is defined over  <span class="math">\\mathbb{F}_{2^n}^t</span>  or over  <span class="math">\\mathbb{F}_{p^n}^t</span> . At the same time, other attacks (as the higher-order differential attack) that exploit the existence of subspaces of  <span class="math">\\mathbb{F}_{2^n}^t</span>  or of  <span class="math">\\mathbb{F}_{p^n}^t</span>  may be more efficient than the attacks defined here.</p>

    <p class="text-gray-300">Finally, we point out that it is possible to define cryptographic key-less permutations using the strategy proposed here (e.g., it is sufficient to take HadesMiMC and fix the key to some public value). In such a case, we suggest to opportunely modify the number of rounds depending on the context in which the permutations are used.</p>

    <p class="text-gray-300">Acknowledgements. The authors thank the anonymous reviewers for their valuable comments and suggestions. L. Grassi has been supported by IOV42. D. Rotaru has been supported in part by the Defense Advanced Research Projects Agency (DARPA) and Space and Naval Warfare Systems Center, Pacific (SSC Pacific) under contract No. N66001-15-C-4070, by the Office of the Director of National Intelligence (ODNI), Intelligence Advanced Research Projects Activity (IARPA) via Contract No. 2019-1902070006 and by the CyberSecurity Research Flanders with reference number VR20192203. Any opinions, findings and conclusions or recommendations expressed in this material are those of the author(s) and do not necessarily reflect the views of the ODNI, United States Air Force, IARPA, DARPA, the US Government or FWO. The U.S. Government is authorized to reproduce and distribute reprints for governmental purposes notwithstanding any copyright annotation therein.</p>

    <ul class="list-disc list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li><p class="text-gray-300">1. Agrawal, S., Mohassel, P., Mukherjee, P., Rindal, P.: DiSE: Distributed Symmetrickey Encryption. In: CCS. pp. 1993&ndash;2010. ACM (2018)</p></li>
      <li><p class="text-gray-300">2. Albrecht, M.R., Cid, C., Grassi, L., Khovratovich, D., L&uuml;ftenegger, R., Rechberger, C., Schofnegger, M.: Algebraic Cryptanalysis of STARK-Friendly Designs: Application to MARVELlous and MiMC. In: ASIACRYPT 2019. LNCS, vol. 11923, pp. 371&ndash;397 (2019)</p></li>
      <li><p class="text-gray-300">3. Albrecht, M.R., Grassi, L., Perrin, L., Ramacher, S., Rechberger, C., Rotaru, D., Roy, A., Schofnegger, M.: Feistel Structures for MPC, and More. In: ESORICS 2019. LNCS, vol. 11736, pp. 151&ndash;171 (2019)</p></li>
      <li><p class="text-gray-300">4. Albrecht, M.R., Grassi, L., Rechberger, C., Roy, A., Tiessen, T.: MiMC: Efficient Encryption and Cryptographic Hashing with Minimal Multiplicative Complexity. In: ASIACRYPT 2016. LNCS, vol. 10031, pp. 191&ndash;219 (2016)</p></li>
      <li><p class="text-gray-300">5. Albrecht, M.R., Rechberger, C., Schneider, T., Tiessen, T., Zohner, M.: Ciphers for MPC and FHE. In: EUROCRYPT 2015. LNCS, vol. 9056, pp. 430&ndash;454 (2015)</p></li>
      <li><p class="text-gray-300">6. Aly, A., Ashur, T., Ben-Sasson, E., Dhooghe, S., Szepieniec, A.: Design of Symmetric-Key Primitives for Advanced Cryptographic Protocols. Cryptology ePrint Archive, Report 2019/426 (2019), <a href="https://eprint.iacr.org/2019/426" target="_blank" rel="noopener noreferrer">https://eprint.iacr.org/2019/426</a></p></li>
      <li><p class="text-gray-300">7. Ashur, T., Dhooghe, S.: MARVELlous: a STARK-Friendly Family of Cryptographic Primitives. Cryptology ePrint Archive, Report 2018/1098 (2018)</p></li>
      <li><p class="text-gray-300">8. Bar-On, A., Dinur, I., Dunkelman, O., Lallemand, V., Keller, N., Tsaban, B.: Cryptanalysis of SP Networks with Partial Non-Linear Layers. In: EUROCRYPT 2015. LNCS, vol. 9056, pp. 315&ndash;342 (2015)</p></li>
      <li><p class="text-gray-300">9. Beierle, C., Canteaut, A., Leander, G., Rotella, Y.: Proving Resistance Against Invariant Attacks: How to Choose the Round Constants. In: CRYPTO 2017. LNCS, vol. 10402, pp. 647&ndash;678 (2017)</p></li>
      <li><p class="text-gray-300">10. Bettale, L., Faug&egrave;re, J.C., Perret, L.: Hybrid approach for solving multivariate systems over finite fields. Journal of Mathematical Cryptology 3(3), 177&ndash;197 (2009)</p></li>
      <li><p class="text-gray-300">11. Beyne, T., Canteaut, A., Dinur, I., Eichlseder, M., Leander, G., Leurent, G., Naya-Plasencia, M., Perrin, L., Sasaki, Y., Todo, Y., Wiemer, F.: Out of Oddity &ndash; New Cryptanalytic Techniques against Symmetric Primitives Optimized for Integrity Proof Systems. Cryptology ePrint Archive, Report 2020/188 (2020), <a href="https://eprint.iacr.org/2020/188" target="_blank" rel="noopener noreferrer">https://eprint.iacr.org/2020/188</a> &ndash; accepted at CRYPTO 2020</p></li>
      <li><p class="text-gray-300">12. Biham, E., Biryukov, A., Shamir, A.: Cryptanalysis of Skipjack Reduced to 31 Rounds Using Impossible Differentials. In: EUROCRYPT 1999. LNCS, vol. 1592, pp. 12&ndash;23 (1999)</p></li>
      <li><p class="text-gray-300">13. Biham, E., Shamir, A.: Differential Cryptanalysis of DES-like Cryptosystems. Journal of Cryptology 4(1), 3&ndash;72 (1991)</p></li>
      <li><p class="text-gray-300">14. Bogdanov, A., Khovratovich, D., Rechberger, C.: Biclique Cryptanalysis of the Full AES. In: ASIACRYPT 2011. LNCS, vol. 7073, pp. 344&ndash;371 (2011)</p></li>
      <li><p class="text-gray-300">15. Bonnetain, X.: Collisions on Feistel-MiMC and univariate GMiMC. Cryptology ePrint Archive, Report 2019/951 (2019), <a href="https://eprint.iacr.org/2019/951" target="_blank" rel="noopener noreferrer">https://eprint.iacr.org/2019/951</a></p></li>
      <li><p class="text-gray-300">16. Borghoff, J., Canteaut, A., G&uuml;neysu, T., Kavun, E.B., Knezevic, M., Knudsen, L.R., Leander, G., Nikov, V., Paar, C., Rechberger, C., Rombouts, P., Thomsen, S.S., Yal&ccedil;in, T.: PRINCE - A Low-Latency Block Cipher for Pervasive Computing Applications. In: ASIACRYPT 2012. LNCS, vol. 7658, pp. 208&ndash;225 (2012)</p></li>
      <li><p class="text-gray-300">17. Buchberger, B.: Bruno Buchberger's PhD thesis 1965: An algorithm for finding the basis elements of the residue class ring of a zero dimensional polynomial ideal. Journal of Symbolic Computation 41, 475&ndash;511 (2006)</p></li>
      <li><p class="text-gray-300">18. Cogliati, B., Dodis, Y., Katz, J., Lee, J., Steinberger, J.P., Thiruvengadam, A., Zhang, Z.: Provable Security of (Tweakable) Block Ciphers Based on Substitution-Permutation Networks. In: CRYPTO 2018. LNCS, vol. 10991, pp. 722&ndash;753 (2018)</p></li>
      <li><p class="text-gray-300">19. Cox, D.A., Little, J., O'Shea, D.: Ideals, varieties, and algorithms - an introduction to computational algebraic geometry and commutative algebra (2. ed.). Undergraduate texts in mathematics, Springer (1997)</p></li>
      <li><p class="text-gray-300">20. Daemen, J., Knudsen, L.R., Rijmen, V.: The Block Cipher Square. In: FSE 1997. LNCS, vol. 1267, pp. 149&ndash;165 (1997)</p></li>
      <li><p class="text-gray-300">21. Daemen, J., Rijmen, V.: The Wide Trail Design Strategy. In: Cryptography and Coding - IMA International Conference 2001. LNCS, vol. 2260, pp. 222&ndash;238 (2001)</p></li>
      <li><p class="text-gray-300">22. Daemen, J., Rijmen, V.: The Design of Rijndael: AES - The Advanced Encryption Standard. Information Security and Cryptography, Springer (2002)</p></li>
      <li><p class="text-gray-300">23. Diaz-Vargas, J., Rubio-Barrios, C.J., Sozaya-Chan, J.A., Tapia-Recillas, H.: Self-Invertible Permutation Polynomials over Zm. International Journal of Algebra 5(23), 1135 &ndash; 1153 (2011)</p></li>
      <li><p class="text-gray-300">24. Dinur, I., Kales, D., Promitzer, A., Ramacher, S., Rechberger, C.: Linear Equivalence of Block Ciphers with Partial Non-Linear Layers: Application to LowMC. In: EUROCRYPT 2019. LNCS, vol. 11476, pp. 343&ndash;372 (2019)</p></li>
      <li><p class="text-gray-300">25. Dinur, I., Liu, Y., Meier, W., Wang, Q.: Optimized Interpolation Attacks on LowMC. In: ASIACRYPT 2015. LNCS, vol. 9453, pp. 535&ndash;560 (2015)</p></li>
      <li><p class="text-gray-300">26. Dobraunig, C., Eichlseder, M., Grassi, L., Lallemand, V., Leander, G., List, E., Mendel, F., Rechberger, C.: Rasta: A Cipher with Low ANDdepth and Few ANDs per Bit. In: CRYPTO 2018. LNCS, vol. 10991, pp. 662&ndash;692 (2018)</p></li>
      <li><p class="text-gray-300">27. Dobraunig, C., Eichlseder, M., Mendel, F.: Higher-Order Cryptanalysis of LowMC. In: ICISC 2015. LNCS, vol. 9558, pp. 87&ndash;101 (2015)</p></li>
      <li><p class="text-gray-300">28. Dodis, Y., Stam, M., Steinberger, J.P., Liu, T.: Indifferentiability of Confusion-Diffusion Networks. In: EUROCRYPT 2016. LNCS, vol. 9666, pp. 679&ndash;704 (2016)</p></li>
      <li><p class="text-gray-300">29. Eichlseder, M., Grassi, L., L&uuml;ftenegger, R., &Oslash;ygarden, M., Rechberger, C., Schofnegger, M., Wang, Q.: An Algebraic Attack on Ciphers with Low-Degree Round Functions: Application to Full MiMC. IACR Cryptol. ePrint Arch. 2020, 182 (2020)</p></li>
      <li><p class="text-gray-300">30. G&eacute;rard, B., Grosso, V., Naya-Plasencia, M., Standaert, F.: Block Ciphers That Are Easier to Mask: How Far Can We Go? In: CHES 2013. LNCS, vol. 8086, pp. 383&ndash;399 (2013)</p></li>
      <li><p class="text-gray-300">31. Grassi, L.: Mixture Differential Cryptanalysis: a New Approach to Distinguishers and Attacks on round-reduced AES. IACR Trans. Symmetric Cryptol. 2018(2), 133&ndash;160 (2018)</p></li>
      <li><p class="text-gray-300">32. Grassi, L., Khovratovich, D., Roy, A., Rechberger, C., Schofnegger, M.: Poseidon: A New Hash Function for Zero-Knowledge Proof Systems. IACR Cryptol. ePrint Arch. 2019, 458 (2019)</p></li>
      <li><p class="text-gray-300">33. Grassi, L., Rechberger, C., R&oslash;njom, S.: Subspace Trail Cryptanalysis and its Applications to AES. IACR Trans. Symmetric Cryptol. 2016(2), 192&ndash;225 (2016)</p></li>
      <li><p class="text-gray-300">34. Grassi, L., Rechberger, C., R&oslash;njom, S.: A New Structural-Differential Property of 5-Round AES. In: EUROCRYPT 2017. LNCS, vol. 10211, pp. 289&ndash;317 (2017)</p></li>
      <li><p class="text-gray-300">35. Grassi, L., Rechberger, C., Rotaru, D., Scholl, P., Smart, N.P.: MPC-friendly symmetric key primitives. In: CCS. pp. 430&ndash;443. ACM (2016)</p></li>
      <li><p class="text-gray-300">36. Grassi, L., Rechberger, C., Schofnegger, M.: Weak linear layers in word-oriented partial SPN and hades-like ciphers. IACR Cryptol. ePrint Arch. 2020, 500 (2020)</p></li>
      <li><p class="text-gray-300">37. Jakobsen, T., Knudsen, L.R.: The Interpolation Attack on Block Ciphers. In: FSE 1997. LNCS, vol. 1267, pp. 28&ndash;40 (1997)</p></li>
      <li><p class="text-gray-300">38. Keller, M., Pastro, V., Rotaru, D.: Overdrive: Making SPDZ Great Again. In: EUROCRYPT 2018. LNCS, vol. 10822, pp. 158&ndash;189 (2018)</p></li>
      <li><p class="text-gray-300">39. Keller, M., Scholl, P., Smart, N.P.: An architecture for practical actively secure MPC with dishonest majority. In: CCS. pp. 549&ndash;560. ACM (2013)</p></li>
      <li><p class="text-gray-300">40. Keller, N., Rosemarin, A.: Mind the Middle Layer: The HADES Design Strategy Revisited. Cryptology ePrint Archive, Report 2020/179 (2020), <a href="https://eprint.iacr.org/2020/179" target="_blank" rel="noopener noreferrer">https://eprint.</a> <a href="https://eprint.iacr.org/2020/179" target="_blank" rel="noopener noreferrer">iacr.org/2020/179</a></p></li>
      <li><p class="text-gray-300">41. Knudsen, L.R.: Truncated and Higher Order Differentials. In: FSE 1994. LNCS, vol. 1008, pp. 196&ndash;211 (1994)</p></li>
      <li><p class="text-gray-300">42. Leander, G., Abdelraheem, M.A., AlKhzaimi, H., Zenner, E.: A Cryptanalysis of PRINTcipher: The Invariant Subspace Attack. In: CRYPTO 2011. LNCS, vol. 6841, pp. 206&ndash;221 (2011)</p></li>
      <li><p class="text-gray-300">43. Li, S.: Permutation Polynomials modulo m. arXiv Mathematics e-prints (2005)</p></li>
      <li><p class="text-gray-300">44. MacWilliams, F.J., Sloane, N.J.A.: The Theory of Error-Correcting Codes. Northholland Publishing Company (1978)</p></li>
      <li><p class="text-gray-300">45. Matsui, M.: Linear Cryptanalysis Method for DES Cipher. In: EUROCRYPT 1993. LNCS, vol. 765, pp. 386&ndash;397 (1993)</p></li>
      <li><p class="text-gray-300">46. Miles, E., Viola, E.: Substitution-Permutation Networks, Pseudorandom Functions, and Natural Proofs. Journal of the ACM 62(6), 46:1&ndash;46:29 (2015)</p></li>
      <li><p class="text-gray-300">47. Nyberg, K., Knudsen, L.R.: Provable Security Against Differential Cryptanalysis. In: CRYPTO 1992. LNCS, vol. 740, pp. 566&ndash;574 (1992)</p></li>
      <li><p class="text-gray-300">48. Rechberger, C., Soleimany, H., Tiessen, T.: Cryptanalysis of Low-Data Instances of Full LowMCv2. IACR Trans. Symmetric Cryptol. 2018(3), 163&ndash;181 (2018)</p></li>
      <li><p class="text-gray-300">49. Rijmen, V., Daemen, J., Preneel, B., Bosselaers, A., Win, E.D.: The Cipher SHARK. In: FSE 1996. LNCS, vol. 1039, pp. 99&ndash;111 (1996)</p></li>
      <li><p class="text-gray-300">50. Wagner, D.A.: The Boomerang Attack. In: FSE 1999. LNCS, vol. 1636, pp. 156&ndash;170 (1999)</p></li>
    </ul>

    <p class="text-gray-300">51. Wang, Y., Wu, W., Guo, Z., Yu, X.: Differential Cryptanalysis and Linear Distinguisher of Full-Round Zorro. In: ACNS 2014. LNCS, vol. 8479, pp. 308&ndash;323 (2014)</p>

    <section id="app-a" class="mb-10">
      <h2 class="text-2xl font-bold">A Concrete Instantiations</h2>

    <p class="text-gray-300">Here we specify how we generate pseudo-random bits, the round constants, and the MDS matrices for the linear layer. All values are given in hexadecimal notation. The MDS matrices are Cauchy matrices, further described in Supplementary Material B. The example instances are implemented using Sage and we provide the files online.<sup>21</sup></p>

    <p class="text-gray-300">Pseudo-Random Number Generator. All pseudo-random numbers are generated using the Grain LFSR [62] in a self-shrinking mode:</p>

    <ul class="list-disc list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li><ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li>Initialize the state with 80 bits  <span class="math">b_0, b_1, \\ldots, b_{79}</span> , where</li>
    </ol>

    <ul class="list-disc list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li>(a)  <span class="math">b_0, b_1</span>  are fixed to  <span class="math">b_1 || b_0 = 0x1</span> ,</li>
      <li>(b)  <span class="math">b_i</span>  for  <span class="math">2 \\le i \\le 5</span>  are fixed to  <span class="math">b_5 \\mid\\mid b_4 \\mid\\mid b_3 \\mid\\mid b_2 = 0</span> x0,</li>
      <li>(c)  <span class="math">b_i</span>  for  <span class="math">6 \\le i \\le 17</span>  are the binary representation of n,</li>
      <li>(d)  <span class="math">b_i</span>  for  <span class="math">18 \\le i \\le 29</span>  are the binary representation of t,</li>
      <li>(e)  <span class="math">b_i</span>  for  <span class="math">30 \\le i \\le 39</span>  are the binary representation of  <span class="math">R_F</span> ,</li>
      <li>(f)  <span class="math">b_i</span>  for  <span class="math">40 \\le i \\le 49</span>  are the binary representation of  <span class="math">R_P</span> , and</li>
      <li>(g)  <span class="math">b_i</span>  for  <span class="math">50 \\le i \\le 79</span>  are set to 1.</li>
    </ul></li>
      <li><ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li>Update the bits using  <span class="math">b_{i+80} = b_{i+62} \\oplus b_{i+51} \\oplus b_{i+38} \\oplus b_{i+23} \\oplus b_{i+13} \\oplus b_i</span> .</li>
    </ol></li>
      <li><ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li>Discard the first 160 bits.</li>
    </ol></li>
      <li><ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li>Evaluate bits in pairs: If the first bit is a 1, output the second bit. If it is a 0, discard the second bit.</li>
    </ol></li>
    </ul>

    <p class="text-gray-300">We focus on generating elements of GF(p). If a randomly sampled integer is larger than or equal to p, we discard this value and take the next one. We first generate the round constants, then the MDS matrix for the linear layer, and finally the MDS matrix for the key schedule.</p>

    <p class="text-gray-300">Round Constants. For the round constants, we simply use the pseudo-random number generator just given. All numbers are generated by starting from the most significant bit (changing this order makes no difference regarding the security). Note that cryptographically strong randomness is not needed for the round constants or the matrices, and other methods can also be used.</p>

    <p class="text-gray-300">MDS Matrices. All our MDS matrices are Cauchy matrices. However, we note that not every MDS matrix provides the same level of security, in particular when considering partial SPN constructions or our design, which also uses rounds with partial S-Box layers. Indeed, recent results [11,40,36] have shown that there exist vulnerabilities when using certain Cauchy matrices.</p>

    <p class="text-gray-300">Even if no attack based on such weakness has been proposed on HADESMiMC, we generate our matrices using the algorithms provided in [36], and we precisely use the following method to generate them:</p>

    <ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li>Randomly select pairwise distinct  <span class="math">\\{x_i\\}_{i=1}^t</span>  and  <span class="math">\\{y_i\\}_{i=1}^t</span> , where  <span class="math">x_i + y_j \\neq 0</span>  and where  <span class="math">i \\in \\{1, \\ldots, t\\}</span>  and  <span class="math">j \\in \\{1, \\ldots, t\\}</span> .</li>
    </ol>

    <p class="text-gray-300"><sup>21</sup> https://extgit.iaik.tugraz.at/krypto/hadesmimc</p>

    <ul class="list-disc list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li><ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li>Determine if the matrix is secure using the tools provided in [36]. For a secure matrix, no infinitely long (invariant and/or iterative) subspace trail (with or without active S-Boxes) can be set up for the rounds with partial S-Box layers.</li>
    </ol></li>
      <li><ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li>Repeat this procedure until a secure matrix is found (in general, the probability that a matrix is secure is quite high, hence few tests are sufficient).</li>
    </ol></li>
    </ul>

    <p class="text-gray-300">We used this method to generate the matrices for all our instantiations. For [36, Algorithm 3], we used a search period of l=4t, and we additionally made sure that no invariant subspace trails with active S-Boxes exist for  <span class="math">M, M^2, \\ldots, M^l</span> .</p>

    <p class="text-gray-300"><span class="math">Test\\ Vectors.</span>  The plaintext and the key are chosen deterministically using increasing sequences of integers. All parameters and the final ciphertexts can be found in the files provided online.  <span class="math">^{22}</span></p>

    </section>

    <section id="app-b" class="mb-10">
      <h2 class="text-2xl font-bold"><strong>B</strong> MDS Matrix Construction</h2>

    <p class="text-gray-300">Here we recall several ways (proposed in the literature) that can be used to construct an MDS matrix.</p>

    <p class="text-gray-300"><strong>Cauchy Matrix [65].</strong> We now discuss Cauchy matrices. Let  <span class="math">x_i, y_i \\in \\mathbb{F}_p</span>  for  <span class="math">i = 1, \\ldots, t</span>  s.t.</p>

    <p class="text-gray-300"><span class="math">$- \\forall i \\neq j: \\quad x_i \\neq x_j, \\quad y_i \\neq y_j, - \\text{ for } 1 \\leq i \\leq t \\text{ and } 1 \\leq j \\leq t: \\quad x_i + y_j \\neq 0.</span>$</p>

    <p class="text-gray-300">To fulfill these conditions, one can simply consider  <span class="math">x_i</span>  s.t. the  <span class="math">t - \\log_2(t)</span>  most significant bits are zero. Then, choosing  <span class="math">r \\in \\mathbb{F}_p</span>  s.t. the  <span class="math">t - \\log_2(t)</span>  most significant bits are non zero, let  <span class="math">y_i = x_i + r</span> . Let A be the Cauchy matrix defined by</p>

    <p class="text-gray-300"><span class="math">$a_{i,j} = \\frac{1}{x_i + y_j}.</span>$</p>

    <p class="text-gray-300">It follows that A is MDS.</p>

    <p class="text-gray-300"><strong>Sequential Matrix [60,61].</strong> Let  <span class="math">\\beta</span>  be a <em>generator</em> for  <span class="math">\\mathbb{F}_p</span> . In other words, for each  <span class="math">x \\in \\mathbb{F}_p</span> , there exists i s.t.  <span class="math">\\beta^i = x</span> . Let the generator polynomial be</p>

    <p class="text-gray-300"><span class="math">$g(x) = (x - \\beta) \\cdot (x - \\beta^2) \\cdot \\dots \\cdot (x - \\beta^t) = x^t + c_{t-1}x^{t-1} + \\dots + c_1x + c_0.</span>$</p>

    <p class="text-gray-300">Define the matrix S as</p>

    <p class="text-gray-300"><span class="math">$S = \\begin{bmatrix} 0 &amp; 1 &amp; 0 &amp; 0 &amp; \\cdots &amp; 0 \\\\ 0 &amp; 0 &amp; 1 &amp; 0 &amp; \\cdots &amp; 0 \\\\ 0 &amp; 0 &amp; 0 &amp; 1 &amp; \\cdots &amp; 0 \\\\ \\vdots &amp; &amp; &amp; \\ddots &amp; \\vdots \\\\ 0 &amp; 0 &amp; 0 &amp; 0 &amp; \\cdots &amp; 1 \\\\ c_{t-1} &amp; c_{t-2} &amp; \\cdots &amp; c_2 &amp; c_1 &amp; c_0 \\end{bmatrix}</span>$</p>

    <p class="text-gray-300">https://extgit.iaik.tugraz.at/krypto/hadesmimo</p>

    <p class="text-gray-300">and let</p>

    <p class="text-gray-300"><span class="math">$A = S^t \\equiv \\underbrace{S \\times S \\times \\cdots \\times S}_{t \\text{ times}}.</span>$</p>

    <p class="text-gray-300">It is possible to prove that A is an MDS matrix (see [44] for details).</p>

    <p class="text-gray-300"><span class="math">$A = vand_t(a_0, a_1, \\dots, a_{t-1}) = \\begin{bmatrix} 1 &amp; a_0 &amp; a_0^2 &amp; \\cdots &amp; a_0^{t-1} \\\\ 1 &amp; a_1 &amp; a_1^2 &amp; \\cdots &amp; a_1^{t-1} \\\\ 1 &amp; a_2 &amp; a_2^2 &amp; \\cdots &amp; a_2^{t-1} \\\\ \\vdots &amp; &amp; \\ddots &amp; \\vdots \\\\ 1 &amp; a_{t-1} &amp; a_{t-1}^2 &amp; \\cdots &amp; a_{t-1}^{t-1} \\end{bmatrix},</span>$</p>

    <p class="text-gray-300">where  <span class="math">a_i \\neq a_j</span> . Let A and B be two matrices as before, s.t.  <span class="math">a_i \\neq b_j</span>  for each i, j. It is possible to prove that</p>

    <p class="text-gray-300"><span class="math">$M = A \\times B^{-1}</span>$</p>

    <p class="text-gray-300">is an MDS matrix.</p>

    <p class="text-gray-300">Like for LowMC, the fact that the non-linear layer is partial in  <span class="math">R_P</span>  rounds can be used to reduce the amount of operations required in each of these rounds. Referring to [24], we recall here an equivalent representation of an SPN with partial non-linear layers for an efficient implementation.</p>

    <p class="text-gray-300"><strong>Round Constants.</strong> In the description of an SPN, it is possible to swap the order of the linear layer and the round key addition as both operations are linear. The round key then needs to be exchanged with an equivalent one. For round key  <span class="math">k^{(i)}</span> , the equivalent one can be written as  <span class="math">\\hat{k}^{(i)} = MC^{-1}(k^{(i)})</span> , where MC is the linear layer in the <em>i</em>-th round. If one works with partial non-linear layers, it is possible to use this property to move parts of the original round keys from the last round all the way through the cipher to the whitening key. In more details:</p>

    <ul class="list-disc list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li>First, find an equivalent key that is applied before the affine layer by moving the round key through the affine layer, namely  <span class="math">\\hat{k}^{(i)} = MC^{-1}(k^{(i)})</span> .</li>
      <li>Then split the round key in two parts, one that applies to the S-Box part of the non-linear layer and one that applies to the identity part of the non-linear layer. The part of the key that only applies to the linear layer part (namely, the part where no non-linear layer is applied) can now move further up where it is merged with the previous round key.</li>
      <li>Working in this way for all round keys, we finally end up with an equivalent representation in which round keys are only added to the output of the S-Boxes apart from one whitening key which is applied to the entire state after the first  <span class="math">R_f</span>  rounds.</li>
    </ul>

    <p class="text-gray-300">Note that the round keys of this equivalent representation can still be calculated as linear functions of the master key. This simplified representation can in certain cases also reduce the implementation cost of an SPN block cipher with a partial non-linear layer. For instance, the standard representation of HadesMiMC requires key matrices of total size  <span class="math">t \\cdot \\log_2 p \\cdot (R+1)</span> , where  <span class="math">R = R_P + R_F</span>  is the number of rounds. The optimized representation only requires  <span class="math">t \\cdot \\log_2 p \\cdot (R_F + 1) + \\log_2 p \\cdot R_P</span> , thus potentially greatly reducing the amount of needed memory and calculation to produce the round keys.</p>

    <p class="text-gray-300"><strong>Linear Layer.</strong> A similar trick as above can be used also for the matrix multiplication. As we use MDS matrices, the situation is simpler than for LowMC and we can avoid the additional complexity of [24].</p>

    <p class="text-gray-300">Focusing on the rounds with a single S-Box, let M be the  <span class="math">t \\times t</span>  MDS matrix of the linear layer:</p>

    <p class="text-gray-300"><span class="math">$M = \\begin{bmatrix} M_{0,0} &amp; M_{0,1} &amp; M_{0,2} &amp; \\cdots &amp; M_{0,t-1} &amp; M_{0,t} \\\\ \\hline M_{1,0} &amp; &amp; &amp; &amp; \\\\ M_{2,0} &amp; &amp; &amp; &amp; \\\\ \\vdots &amp; &amp; &amp; \\hat{M} &amp; &amp; \\\\ M_{t-1,0} &amp; &amp; &amp; &amp; \\\\ M_{t,0} &amp; &amp; &amp; &amp; \\end{bmatrix} \\equiv \\begin{bmatrix} M_{0,0} &amp; v \\\\ \\hline w &amp; \\hat{M} \\end{bmatrix},</span>$</p>

    <p class="text-gray-300">where  <span class="math">\\hat{M}</span>  is a  <span class="math">(t-1) \\times (t-1)</span>  MDS matrix (note that since M is MDS, every submatrix of M is also MDS), v is a  <span class="math">1 \\times (t-1)</span>  matrix and w is a  <span class="math">(t-1) \\times 1</span>  vector. By simple computation,</p>

    <p class="text-gray-300">
<span class="math">$M = \\underbrace{\\begin{bmatrix} 1 &amp; 0 \\\\ 0 &amp; \\hat{M} \\end{bmatrix}}_{M&#x27;} \\times \\underbrace{\\begin{bmatrix} M_{0,0} | v \\\\ \\hat{w} &amp; I \\end{bmatrix}}_{M&#x27;&#x27;}, \\tag{11}</span>$</p>

    <p class="text-gray-300">where</p>

    <p class="text-gray-300"><span class="math">$\\hat{w} = \\hat{M}^{-1} \\times w</span>$</p>

    <p class="text-gray-300">and I is the  <span class="math">(t-1)\\times(t-1)</span>  identity matrix. Note that both M' and  <span class="math">M^{&#x27;&#x27;}</span>  are two invertible matrices. <sup>23</sup></p>

    <p class="text-gray-300">As for the round constants discussed previously, it is possible to use the previous equivalence Eq. (11) in order to swap the S-Box layer (formed by a single S-Box and t-1 identity functions) and the matrix multiplication with the matrix M'. As a result, each linear part in the  <span class="math">R_P</span>  rounds is defined only by a multiplication with a matrix of the form M'', which is a sparse matrix, since  <span class="math">(t-1)^2-(t-1)=t^2-3t+2</span>  coefficients of M'' are equal to zero (moreover, t-1 coefficients of M'' are equal to one). This optimized representation may greatly reduce the amount of needed memory and calculation to compute the linear layer multiplication.</p>

    <p class="text-gray-300">First of all,  <span class="math">\\det(M&#x27;) = \\det(\\hat{M}) \\neq 0</span>  since  <span class="math">\\hat{M}</span>  is an MDS matrix, and so it is invertible. Secondly,  <span class="math">\\det(M) = \\det(M&#x27;) \\cdot \\det(M&#x27;&#x27;)</span> . Since  <span class="math">\\det(M) \\neq 0</span>  and  <span class="math">\\det(M&#x27;) \\neq 0</span> , it follows that  <span class="math">\\det(M&#x27;&#x27;) \\neq 0</span> .</p>

    </section>

    <section id="app-d" class="mb-10">
      <h2 class="text-2xl font-bold">D Statistical Attacks on HadesMiMC- Details</h2>

    <p class="text-gray-300">In the case of Boolean functions, linear cryptanalysis searches for a linear combination of input, output and key bits that is unbalanced, i.e., biased towards 0 or towards 1. The natural extension of linear cryptanalysis to the case of elements in  <span class="math">\\mathbb{F}_p</span>  would be the search of a linear combination of input, output, and key words that is unbalanced, i.e., biased towards an element of  <span class="math">\\mathbb{F}_p</span>  with probability higher than  <span class="math">1/|\\mathbb{F}_p| = 1/p</span>  (where  <span class="math">|\\cdot|</span>  is the size of the field).<sup>24</sup></p>

    <p class="text-gray-300">Similar to differential attacks, linear attacks [45] pose no threat to the HadesMiMC family of block ciphers instantiated with the same number of rounds previously defined for classical differential cryptanalysis. E.g., in the case of the cube S-Box ( <span class="math">\\alpha=3</span> ), this follows from the fact that the maximum square correlation of the cubic function is limited to 2/p (see [52] for details). As a result, it offers (one of) the best possible resistance against linear cryptanalysis (analogous to the case of differential cryptanalysis).</p>

      <h3 id="app-d.2" class="text-xl font-semibold mt-8">D.2 Truncated Differentials</h3>

    <p class="text-gray-300">A variant of classical differential cryptanalysis is the truncated differential one [41], in which the attacker can predict only part of the difference between pairs of texts. Working on the &quot;weaker&quot; cipher described in Eq. (2) and focusing only on active/passive bytes (and not on the actual differences), there exist several differentials with probability 1 for a maximum of 1 round of HADESMIMC, e.g.,</p>

    <p class="text-gray-300"><span class="math">$[\\alpha, 0, \\dots, 0]^T \\xrightarrow{R(\\cdot)} M \\times [\\beta, 0, \\dots, 0]^T,</span>$</p>

    <p class="text-gray-300">where  <span class="math">\\alpha, \\beta</span>  denote non-zero differences. Due to the next S-Box layer, the linear relations given by  <span class="math">M \\times (\\beta, 0, \\dots, 0)^T</span>  are destroyed in the next round. As a result, no probability-one truncated differential covers more than a single round.</p>

    <p class="text-gray-300">For comparison, in the AES case it is possible to set up 3-round truncated differential trails (which are independent of the S-Box) even if 2-round AES already provides full diffusion. Recently, new truncated differential attacks on 5- and 6-round AES have been proposed [59,53,54]. Roughly speaking, these attacks are obtained by combining two 2-round truncated differentials of prob. 1:</p>

    <p class="text-gray-300"><span class="math">$\\mathcal{D}_i \\oplus a \\xrightarrow[\\text{prob. } 1]{R^2(\\cdot)} MC(\\mathcal{ID}_i \\oplus b) \\xrightarrow[\\text{Re}]{R(\\cdot) \\text{ or } R^2(\\cdot)} \\mathcal{D}_J \\oplus c \\xrightarrow[\\text{prob. } 1]{R^2(\\cdot)} MC(\\mathcal{ID}_J \\oplus d),</span>$</p>

    <p class="text-gray-300">where  <span class="math">\\mathcal{D}_I</span>  is a set of chosen plaintexts with  <span class="math">1 \\leq |I| \\leq 3</span>  active diagonal(s), while  <span class="math">\\mathcal{ID}_J</span>  is a set of chosen plaintexts with  <span class="math">1 \\leq |J| \\leq 3</span>  active anti-diagonal(s). We emphasize that in this attack the attacker works with active/passive words, and not with actual differences.</p>

    <p class="text-gray-300">Note that this is analogous to the case of a Boolean field  <span class="math">\\mathbb{F}_2</span> , where the only elements of  <span class="math">\\mathbb{F}_2</span>  are 0 and 1, and where  <span class="math">1/|\\mathbb{F}_2| = 1/2</span> .</p>

    <p class="text-gray-300">Due to the strong relation between AES and our design, and since (1st) the AES mixing layer works only on part of the state, while in our case it works on the entire state (that is, 2 rounds of AES are necessary to provide full diffusion versus 1 round of HadesMiMC) and (2nd) the best truncated differential attack on AES has been set up using active/passive words, rather than actual differences, we conjecture that 4 rounds (with full S-Box layers) of HadesMiMC are secure against truncated differential attacks.</p>

    <p class="text-gray-300">To summarize, even if we do not exclude the possibility to set up longer truncated differential trails (which do or do not depend on the details of the S-Box), it seems hard to set up a truncated differential which is independent of the secret key for more than 4 rounds. As a result and due to the key schedule, it turns out that 6 rounds with full S-Box layers make HadesMiMC secure against this attack.</p>

    <p class="text-gray-300">A possible way to extend (truncated) differential attacks over more rounds is using the meet-in-the-middle (MitM) technique.<a href="#page-42-1">25</a> The main idea is to split the cipher into two independent parts and use a time-memory trade-off for a more efficient attack. In more details, assume to split the cipher E into two parts E(&middot;) = E<sup>2</sup> &#9702; E1(&middot;). Roughly speaking, given a (plaintext, ciphertext) pair (p, c) obtained under the secret key K, the attacker partially guesses the secret key and computes</p>

    <p class="text-gray-300"><span class="math">$p \\xrightarrow{E_1(\\cdot)} \\overrightarrow{v} \\stackrel{?}{=} \\overleftarrow{v} \\xleftarrow{E_2(\\cdot)} c.</span>$</p>

    <p class="text-gray-300">If there is no match in the middle, it turns out that the guessed key is wrong.</p>

    <p class="text-gray-300">Due to the classical and truncated differential analysis just proposed (together with the fact that 1-round HadesMiMC provides full diffusion), we argue that the number of rounds (with full S-Box layers) necessary to provide security against classical and truncated differential attacks is sufficient to provide security against this attack. For comparison, note that the best MitM attack on AES-128 covers 7 rounds <a href="#page-61-6">[58]</a>, and (1st) that 8 rounds of AES are necessary in order to guarantee that each characteristic has probability smaller than 2 <sup>&minus;</sup><sup>256</sup> = (2<sup>128</sup>) &minus;2 (the probability of a characteristic over 4-round AES is at most (2<sup>&minus;</sup><sup>6</sup> ) <sup>25</sup> = 2<sup>&minus;</sup><sup>150</sup>), (2nd) that 2 rounds of AES are necessary to guarantee full diffusion (instead of 1 in our case) and (3rd) that the key schedule of HadesMiMC provides full diffusion (at word level) after one round, while the AES one needs more rounds to achieve the same result.<a href="#page-42-2">26</a></p>

    <p class="text-gray-300"><sup>25</sup> We refer to Section <a href="#page-19-0">4.3</a> for a discussion about the security against &quot;algebraic&quot; meetin-the-middle Attacks &ndash; here we focus on differential MitM attacks.</p>

    <p class="text-gray-300"><sup>26</sup> This fact is heavily exploited in order to set up a MitM attack on AES. Indeed, it basically implies that the knowledge of part of one (or more) subkey(s) can be &quot;reused&quot; in more than a single round, due to the fact that full diffusion is not achieved.</p>

      <h3 id="app-d.4" class="text-xl font-semibold mt-8">D.4 Impossible Differential</h3>

    <p class="text-gray-300">Impossible differential cryptanalysis was introduced by Biham <em>et al.</em> [12] and Knudsen [63]. This cryptanalytic technique exploits differentials occurring with probability 0.</p>

    <p class="text-gray-300">In the following, we focus only on impossible differentials which are independent of the S-Box details, i.e., we do not consider the actual differences but only active/passive words. To find them, we use the possible transitions of the linear layer combined with the fact that the S-Box is a bijection. We found that the longest impossible differential (in this class) only spans 2 rounds, e.g.,</p>

    <p class="text-gray-300"><span class="math">$\\begin{bmatrix} \\alpha \\\\ 0 \\\\ \\dots \\\\ 0 \\end{bmatrix} \\xrightarrow[\\text{prob. 1}]{R(\\cdot)} \\begin{bmatrix} M_{0,0} \\cdot \\beta \\\\ M_{1,0} \\cdot \\beta \\\\ \\dots \\\\ M_{t-1,0} \\cdot \\beta \\end{bmatrix} \\neq \\begin{bmatrix} \\gamma \\\\ 0 \\\\ \\dots \\\\ 0 \\end{bmatrix} \\xleftarrow[\\text{prob. 1}]{R^{-1}(\\cdot)} \\begin{bmatrix} M_{0,0} \\cdot \\delta \\\\ M_{1,0} \\cdot \\delta \\\\ \\dots \\\\ M_{t-1,0} \\cdot \\delta \\end{bmatrix}</span>$</p>

    <p class="text-gray-300">for  <span class="math">\\alpha, \\beta, \\gamma, \\delta \\neq 0</span>  (note that no coefficient of M is equal to zero since M is an MDS matrix). As a result and due to the key schedule, it turns out that 6 rounds with full S-Box layers make HADESMiMC secure against this attack.</p>

    <p class="text-gray-300">Note that it is possible to compare this result with a similar one on AES, where the best known impossible differential is also in this class (of impossible differentials) and spans four rounds [56].</p>

      <h3 id="app-d.5" class="text-xl font-semibold mt-8">D.5 Boomerang Attack</h3>

    <p class="text-gray-300">In boomerang attacks [50], good partial differential characteristics that cover only part of the cipher can be combined to attack ciphers that might be immune to standard differential cryptanalysis. In these attacks, two differential characteristics are combined, one that covers the first part of the cipher and another that covers the second part. If both have about the same probability, the complexity corresponds roughly to the inverse of the product of the square of each of their probabilities.</p>

    <p class="text-gray-300">To calculate the number of rounds sufficient to ensure that no good boomerang exists, we determine the number of rounds after which we cannot separate the cipher into two parts and find a differential for each such that the product of their probabilities is less than  <span class="math">p^{-t/2} \\approx 2^{-N/2}</span> . Exploiting the analysis proposed before, it turns out that 6 rounds with full S-Boxes are sufficient for this goal.</p>

      <h3 id="app-d.6" class="text-xl font-semibold mt-8">D.6 Multiple-of-n and &quot;Mixture Differential Cryptanalysis&quot;</h3>

    <p class="text-gray-300">The &quot;Multiple-of-8&quot; distinguisher [34] was proposed at Eurocrypt 2017 by Grassi et al. as the first 5-round secret-key distinguisher for AES that exploits a property which is independent of the secret key and of the details of the S-Box. By appropriate choices of a number of input pairs it is possible to make sure that the number of times that the difference of the resulting output pairs lie in a particular subspace is always a multiple of 8. The input pairs of texts that satisfy a certain output difference are related by linear/differential relations. Such</p>

    <p class="text-gray-300">relations are exploited by a variant of such a distinguisher, called the &quot;mixture differential&quot; distinguisher [31] proposed at FSE/ToSC 2019.</p>

    <p class="text-gray-300">Regarding HADESMiMC, it is possible to set up such distinguishers on 2 rounds only. In particular, consider a set of texts with  <span class="math">2 \\le s \\le t</span>  active words (and t-s constant words). The number of pairs of texts that satisfy an (arbitrary) output truncated differential is always a multiple of  <span class="math">2^{s-1}</span> . Moreover, the relations of the input pairs of texts exploited by mixture differential cryptanalysis are known.</p>

    <p class="text-gray-300">The proofs of these two properties are analogous to the ones proposed in [31,34] and in [57]. E.g., consider two texts  <span class="math">\\tau^1</span>  and  <span class="math">\\tau^2</span>  of the form</p>

    <p class="text-gray-300"><span class="math">$\\tau^1 = C + [x_0 \\ x_1 \\ 0 \\cdots 0]^T, \\qquad \\tau^2 = C + [y_0 \\ y_1 \\ 0 \\cdots 0]^T</span>$</p>

    <p class="text-gray-300">for some constant C and where  <span class="math">x_i \\neq y_i</span>  for i=0,1. After one round, the difference in each word is of the form</p>

    <p class="text-gray-300"><span class="math">$M_0 \\cdot [S\\text{-Box}(x_0 + c_0) + S\\text{-Box}(x_1 + c_1)] + M_1 \\cdot [S\\text{-Box}(y_0 + c_0) + S\\text{-Box}(y_1 + c_1)],</span>$</p>

    <p class="text-gray-300">where  <span class="math">M_0, M_1</span>  depend on the MixLayer and  <span class="math">c_0, c_1</span>  depend on the secret key. By simple observation, the same output difference is given by the pair of texts</p>

    <p class="text-gray-300"><span class="math">$\\hat{\\tau}^1 = C + [y_0 \\ x_1 \\ 0 \\cdots 0]^T, \\qquad \\hat{\\tau}^2 = C + [x_0 \\ y_1 \\ 0 \\cdots 0]^T.</span>$</p>

    <p class="text-gray-300">Combining this result with a 1-round truncated differential with prob. 1, it is possible to set up a multiple-of-n distinguisher (where  <span class="math">n=2^{s-1}</span> ) and a mixture differential one on 2 rounds of HadesMiMC. As a result and due to the key schedule, it turns out that 6 rounds with full S-Box layers make HadesMiMC secure against these attacks.</p>

      <h3 id="app-d.7" class="text-xl font-semibold mt-8">D.7 Invariant Subspace Attack</h3>

    <p class="text-gray-300">The invariant subspace attack [42] makes use of affine subspaces that are invariant under the round function. As the round key addition translates this invariant subspace [9], ciphers exhibit weak keys when all round keys are such that the affine subspace stays invariant including the key addition. Therefore, those attacks are mainly an issue for block ciphers that use identical round keys.</p>

    <p class="text-gray-300">Here we consider the two cases separately, namely rounds with full S-Box layers and rounds with partial S-Box layers.</p>

    <ul class="list-disc list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li>In the first case, as the round constant addition translates this invariant subspace [9], random round constants provide a good protection against these attacks.</li>
      <li>In the second case, it is always possible to construct a subspace trail for (at least) t-1 rounds without activating any S-Box and for any choice of the linear layer. Due to the assumption made in Section 3.1, t-1 is also an upper bound for the number of rounds for which such a trail can be constructed.</li>
    </ul>

    <p class="text-gray-300">In order words, due to the choice of the matrix that defines the MixLayer (described in details in Section 3.1), it is not possible to cover more than t-1 rounds with a subspace trail (or equivalently, a truncated differential with prob. 1) with active/inactive S-Boxes. We refer to [36] for more details about the possibility to set up infinitely-long subspace trails for partial SPN schemes (equivalently, for the rounds with partial S-Box layers in HADES-like schemes).</p>

    <p class="text-gray-300">Integral cryptanalysis is a technique first applied on SQUARE [20] and is particularly efficient against block ciphers based on substitution-permutation networks, like AES or HADESMiMC.</p>

    <p class="text-gray-300">The idea is to study the propagation of sums of values. For the case of HADESMIMC, it is possible to set up an integral distinguisher over two rounds, e.g.</p>

    <p class="text-gray-300"><span class="math">$\\begin{bmatrix} A \\\\ C \\\\ \\dots \\\\ C \\end{bmatrix} \\xrightarrow{\\text{S-Box}(\\cdot)} \\begin{bmatrix} A \\\\ C \\\\ \\dots \\\\ C \\end{bmatrix} \\xrightarrow{M(\\cdot)} \\begin{bmatrix} A \\\\ A \\\\ \\dots \\\\ A \\end{bmatrix} \\xrightarrow{\\text{S-Box}(\\cdot)} \\begin{bmatrix} A \\\\ A \\\\ \\dots \\\\ A \\end{bmatrix} \\xrightarrow{M(\\cdot)} \\begin{bmatrix} B \\\\ B \\\\ \\dots \\\\ B \\end{bmatrix}</span>$</p>

    <p class="text-gray-300">where A denotes an active word, C a constant one and B a balanced one.<sup>27</sup> As a result and due to the key schedule, it turns out that 6 rounds with full S-Box layers make HADESMiMC secure against this attack.</p>

      <h3 id="app-d.9" class="text-xl font-semibold mt-8">D.9 Biclique Cryptanalysis</h3>

    <p class="text-gray-300">Biclique cryptanalysis [14] can be viewed as an improvement of classical MitM attacks. It improves the complexity of exhaustive search by computing only a part of the encryption algorithm. The improved factor &ndash; often evaluated by the ratio of the number of S-Boxes involved in the partial computation to all S-Boxes in the cipher &ndash; can be relatively big when the number of rounds in the cipher is (very) small. Since we do not think that improving the exhaustive search by a small factor will turn into a serious vulnerability in the future, HADESMIMC is not designed to resist biclique cryptanalysis with small improvement.</p>

    </section>

    <section id="app-e" class="mb-10">
      <h2 class="text-2xl font-bold">E Algebraic Attacks &ndash; Details</h2>

      <h3 id="app-e.1" class="text-xl font-semibold mt-8">E.1 Interpolation Attack and Dense Polynomial</h3>

    <p class="text-gray-300">The encryption function  <span class="math">E_k : (\\mathbb{F}_p)^t \\to \\mathbb{F}_p</span>  under the secret key k can be uniquely represented by a polynomial over  <span class="math">\\mathbb{F}_p</span> , also denoted by  <span class="math">E_k</span> , in t unknowns with maximum degree p-1 in each variable. Because the data complexity of an interpolation attack depends on the number of non-vanishing monomials in  <span class="math">E_k</span> , it is important to make sure all monomials in  <span class="math">E_k</span>  can be expected to occur.</p>

    <p class="text-gray-300">For completeness, we recall that given a set of texts  <span class="math">\\{x_i\\}_{i\\in I}</span> , the word  <span class="math">x^j</span>  is <em>active</em> if  <span class="math">x_i^j \\neq x_l^j</span>  for each  <span class="math">i \\neq l</span> , constant if  <span class="math">x_i^j = x_l^j</span>  for each i, l, and balanced if  <span class="math">\\sum_i x_i^j = 0</span> .</p>

    <p class="text-gray-300">The following Lemma provides a means to give the minimum number of rounds such that E<sup>k</sup> has full weight p t . For simplicity, here we work only in the case &alpha; = 3 (namely, the cube S-Box). We conjecture that a similar result works as well for the generic case S(x) = x &alpha;.</p>

    <p class="text-gray-300">Lemma 1. After dlog<sup>3</sup> (p &minus; 1)e + dlog<sup>3</sup> (t)e rounds all monomials in the encryption polynomial do occur. Furthermore, it is the minimum number of rounds with this property.</p>

    <p class="text-gray-300">Proof. After one round the encryption polynomial is of the form</p>

    <p class="text-gray-300"><span class="math">$\\sum_{i=0}^{2} a_{0,i} X_0^{3-i} + \\ldots + \\sum_{i=0}^{2} a_{t-1,i} X_{t-1}^{3-i} + a,</span>$</p>

    <p class="text-gray-300">for some elements ai,j , a &isin; Fp. Now it is easy to see that in order to reach the maximum degree p &minus; 1 in one variable the number of rounds r has to satisfy the inequality</p>

    <p class="text-gray-300"><span class="math">$3^r \\ge p - 1,</span>$</p>

    <p class="text-gray-300">or equivalently (using the monotonicity of the logarithmic and cube function respectively)</p>

    <p class="text-gray-300"><span class="math">$r \\ge \\log_3(p-1).</span>$</p>

    <p class="text-gray-300">In other words, after at least dlog<sup>3</sup> (p &minus; 1)e rounds all the monomials X j i , for 0 &le; i &le; t &minus; 1 and 0 &le; j &le; p &minus; 1, occur in the encryption polynomial. We claim that it takes at least dlog<sup>3</sup> (t)e more rounds until all t variables are exhausted and hence the encryption polynomial has reached its full weight. To see this, note that after one more round all the monomials</p>

    <p class="text-gray-300"><span class="math">$X_{i_1}^{j_1} X_{i_2}^{j_2} X_{i_3}^{j_3},</span>$</p>

    <p class="text-gray-300">for 0 &le; i1, i2, i<sup>3</sup> &le; t &minus; 1 and 0 &le; j1, j2, j<sup>3</sup> &le; p &minus; 1, are forced to appear. By an inductive argument, it takes at least dlog<sup>3</sup> (t)e more rounds until all p <sup>t</sup> monomials in the encryption polynomial do occur, as stated. ut</p>

    <p class="text-gray-300">As for MiMC <a href="#page-33-5">[4]</a>, an attack strategy is to compute greatest common divisors (GCD). In particular, given more than one known (plaintext, ciphertext) pair or working on the output of each S-Box of a single known (plaintext, ciphertext) pair, it is possible to construct their polynomial representation and compute their polynomial GCD to recover a multiple of the key. Note that this is a known-plaintext attack, and not a chosen-plaintext one.</p>

    <p class="text-gray-300">Denote by E(k, x) the encryption of x under the key k. For a (plaintext, ciphertext) pair (x, y), E(K, x) &minus; y denotes a univariate polynomial in Fq[K] corresponding to (x, y). Note that in our case the polynomial E(K, x)&minus;y can be constructed conceptually easily from the encryption process, but writing down E(K,x)-y becomes computationally expensive as the number of rounds increases. Indeed, writing down E(K,x)-y requires not only large computational resources but also an exponential (in r) amount of memory.</p>

    <p class="text-gray-300">Consider now two such polynomials  <span class="math">E(K, x_1) - y_1</span>  and  <span class="math">E(K, x_2) - y_2</span> , where  <span class="math">y_i = E(k, x_i)</span>  for i = 1, 2 and for a fixed but unknown key k. It is clear that these polynomials share (K - k) as a factor. Thus, by computing the GCD of the two polynomials (with high probability the greatest common divisor will be (K - k)), we can find the value of k.</p>

    <p class="text-gray-300">As we are going to show, this attack is less efficient than e.g. the interpolation attack. However, we remark that this is one of the few attacks that applies in the low-data scenario. In particular, a single (plaintext, ciphertext) pair is sufficient to compute the required polynomial E(K,x)-y, and the GCD can be computed among the output of two different S-Boxes of the final round.</p>

    <p class="text-gray-300">What about the complexity? It is well-known that the complexity for finding the GCD of two polynomials of degree d is  <span class="math">\\mathcal{O}(M(d)\\log_2 d)</span> , where M(d) is the cost of multiplying two degree-d polynomials. The best (known) complexity for M(d) is  <span class="math">\\mathcal{O}(d\\log_2 d)</span>  using an FFT. Thus, we expect a GCD computation to cost  <span class="math">\\mathcal{O}\\left(d\\log_2^2 d\\right)</span> , where the hidden constant is greater than 1. In order to estimate the computational cost of such an attack, we have to estimate the degree of K in E(K,x)-y, which depends on the number of rounds r.</p>

    <p class="text-gray-300">To set up the attack, the attacker first guesses t-1 words of the key in order to construct an univariate polynomial. Since the complexity of the attack depends on the degree and since one S-Box per round (together with an affine layer) is sufficient to increase the degree of each word, we can focus only on the rounds  <span class="math">R_P</span>  with a single S-Box. As a result, after r&gt;1 rounds, the degree d is well estimated by  <span class="math">\\alpha^{r-1}</span> . Thus, to derive an estimate for the required number of rounds, we target  <span class="math">d\\log_2^2 d \\approx p</span>  (note that the attacker has guessed t-1 words of the key, so the cost of this step of the attack reduces from  <span class="math">p^t</span>  to p), which implies</p>

    <p class="text-gray-300"><span class="math">$r \\ge \\log_{\\alpha} p + 1 - 2\\log_{\\alpha}(\\log_2 p).</span>$</p>

    <p class="text-gray-300">To thwart a MitM variant of this attack, it is sufficient to add 1 round. Finally, we add two rounds to prevent a key-guessing attack. As a result, the total number of rounds must be</p>

    <p class="text-gray-300"><span class="math">$R_P + R_F \\ge R^{\\text{GCD}}(p, t) \\equiv 4 + \\lceil \\log_{\\alpha} p \\rceil - \\lfloor 2 \\log_{\\alpha} (\\log_2 p) \\rfloor.</span>$
(12)</p>

    <p class="text-gray-300">As a result, if HADESMIMC is secure against the interpolation attack, then it is also secure against the GCD attack (note that working with more S-Boxes per round does in general not decrease the security).</p>

      <h3 id="app-e.3" class="text-xl font-semibold mt-8">E.3 Gr&ouml;bner Basis Attack - Details</h3>

    <p class="text-gray-300">In Section 4.3, we determined the minimum number of rounds necessary to protect HADESMiMC from a Gr&ouml;bner basis attack. In this case, we worked with a system of equations of degree  <span class="math">\\alpha^r</span> . As we already anticipate there, this is not the only possible strategy that can be used to set up this attack. In particular,</p>

    <p class="text-gray-300">each one of these equations can be rewritten as a system of r equations of degree  <span class="math">\\alpha</span> . Here we compute the minimum number of rounds necessary to protect HADESMIMC from this attack using this second strategy.</p>

    <p class="text-gray-300">Before doing that, we analyzed a modified version of the First Strategy that exploits the subspace  <span class="math">\\mathcal{S}^{(r)}</span>  defined as in Eq. (1) in order to reduce the complexity of the system of equations to solve.</p>

    <p class="text-gray-300">First Strategy &ndash; Exploiting the &quot;Invariant&quot; Subspace  <span class="math">\\mathcal{S}</span> . As shown in [11], the attack based on the first strategy can be improved by exploiting the existence of the subspace  <span class="math">\\mathcal{S}^{(r)}</span>  defined as in Eq. (1). In particular, given a text in a coset of  <span class="math">\\mathcal{S}^{(r)}</span> , the output of such text after r rounds with partial S-Box layer is just the result of an affine map applied to the input. As explained in details in [11], this fact can be exploited in order to replace some non-linear equations of the system that we are trying to solve with linear equations. In particular, by starting in the &quot;middle&quot; with texts in a coset of  <span class="math">\\mathcal{S}^{(r)}</span> , one faces the following scenario</p>

    <p class="text-gray-300">input
<span class="math">$\\xrightarrow{R_F^{R_f}(\\cdot)} \\xrightarrow{R_P^{R_P-r}(\\cdot)} \\text{ text in a coset of } \\mathcal{S}^{(r)} \\xrightarrow{R_P^r(\\cdot)} \\xrightarrow{\\text{&quot;linear&quot; equations}}</span>$</p>

    <p class="text-gray-300"><span class="math">$\\text{text in a coset of } M^r(\\mathcal{S}^{(r)}) \\xrightarrow{R_P^{R_P-r}(\\cdot)} \\xrightarrow{R_F^{R_f}(\\cdot)} \\text{ output}</span>$</p>

    <p class="text-gray-300"><span class="math">$(13)</span>$</p>

    <p class="text-gray-300">where  <span class="math">M^r</span>  is a  <span class="math">t \\times t</span>  matrix that depends on the details of the cipher and on the subspace  <span class="math">\\mathcal{S}^{(r)}</span>  (and where  <span class="math">M^r(\\mathcal{S}^{(r)}) = \\{M^r \\times x \\mid x \\in \\mathcal{S}^{(r)}\\}.</span> )</p>

    <p class="text-gray-300">Obviously, the number of rounds r described by linear equations is related to the dimension of the subspace  <span class="math">\\mathcal{S}^{(r)}</span> : this fact has an impact on the chance to find a solution of the system of equations we are trying to solve (indeed, the number of variables of this system of equations is related to the dimension of the subspace). In any case, due to the assumption made in Section 3.1 on the matrix that defines the MixLayer, this strategy does not allow the attacker to cover more than t-1 rounds with partial S-Box layers.</p>

    <p class="text-gray-300">The scenario Eq. (13) can be described as follows.</p>

    <ul class="list-disc list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li>first part: t equations of degree  <span class="math">\\alpha^{R_f + \\frac{R_P r}{2}}</span> ;</li>
      <li>middle part: d linear equations and t-d non-linear equations of degree  <span class="math">\\alpha^r</span>  (where d is the dimension of the subspace  <span class="math">\\mathcal{S}^{(r)}</span> );</li>
      <li>final part: t equations of degree  <span class="math">\\alpha^{R_f + \\frac{R_P r}{2}}</span> .</li>
    </ul>

    <p class="text-gray-300">Here, r = t - d under the assumption made in Section 3.1.</p>

    <p class="text-gray-300">Let us focus on the middle part (r rounds). Let  <span class="math">\\mathcal{S} = \\langle s_1, \\ldots, s_d \\rangle</span>  be the subspace defined before of dimension d, and let  <span class="math">\\mathcal{S}^c = \\langle w_1, \\ldots, w_{t-d} \\rangle</span>  where  <span class="math">\\mathcal{S}^c</span>  denotes the complementary space of  <span class="math">\\mathcal{S}</span>  (obviously,  <span class="math">\\mathbb{F}_p^t = \\langle s_1, \\ldots, s_d, w_1, \\ldots, w_{t-d} \\rangle</span> ). Let x and y be resp. the input and the corresponding output of the middle part, where y = F(x) for a specific function  <span class="math">F(\\cdot)</span>  of degree  <span class="math">\\alpha^r</span> . Given x in a coset of  <span class="math">\\mathcal{S}</span>  and by definition of  <span class="math">\\mathcal{S}</span> , the output y is in a subspace of  <span class="math">M^r(\\mathcal{S}^{(r)})</span>  for a particular</p>

    <p class="text-gray-300">matrix  <span class="math">M^r</span> . Hence, the middle part can be described by a system of t equations of the form:</p>

    <p class="text-gray-300">d linear equations:</p>

    <p class="text-gray-300"><span class="math">$s_i^T \\cdot y = s_i^T \\cdot (M^r \\times x) \\quad \\forall i \\in \\{1, \\dots, d\\};</span>$</p>

    <p class="text-gray-300">t-d non-linear equations:</p>

    <p class="text-gray-300"><span class="math">$w_i^T \\cdot y = w_i^T \\cdot F(x) \\quad \\forall i \\in \\{1, \\dots, t - d\\};</span>$</p>

    <p class="text-gray-300">where  <span class="math">a^T \\cdot b</span>  denotes the scalar product between  <span class="math">a, b \\in \\mathbb{F}^t</span> .</p>

    <p class="text-gray-300">Working as before, this means that the attacker has to face a system of t + (t - d) + t = 3t - d equations in 3t - d variables. By adding constraints on the previous t - d non-linear equations (which corresponds to &quot;fixing&quot; the coset of the subspace  <span class="math">\\mathcal{S}</span> ), the number of equations/variables can be reduced to  <span class="math">t + \\chi</span> .</p>

    <p class="text-gray-300">By using the previous computation and since  <span class="math">D_{\\text{reg}} = 1 + (3t - d) \\cdot (\\alpha^{R_f + \\frac{R_P - r}{2}} - 1) \\approx (3t - d) \\cdot \\alpha^{\\frac{R_F + R_P - r}{2}}</span> , the cost can be approximated by</p>

    <p class="text-gray-300"><span class="math">$\\left( (3t - d) \\cdot \\alpha^{\\frac{R_F + R_P - r}{2}} \\right)^{\\omega} \\leq \\left[ \\frac{\\left( (3t - d) \\cdot \\alpha^{\\frac{R_F + R_P - r}{2}} \\right)^{3t - d}}{(3t - d)!} \\right]^2 \\leq \\left( \\alpha^{(R_F + R_P - t + d) \\cdot (3t - d)} \\right)^{\\omega} \\leq \\left[ \\frac{\\left( (3t - d) \\cdot \\alpha^{\\frac{R_F + R_P - r}{2}} \\right)^{3t - d}}{(3t - d)!} \\right]^2 \\leq C^{(R_F + R_P - t + d) \\cdot (3t - d)}</span>$</p>

    <p class="text-gray-300">assuming  <span class="math">\\omega \\approx 2</span> . Hence, the number of rounds to be attacked is calculated as</p>

    <p class="text-gray-300"><span class="math">$\\alpha^{(R_F + R_P - t + d) \\cdot (3t - d)} \\le 2^N,</span>$</p>

    <p class="text-gray-300"><span class="math">$\\implies R_F + R_P \\le t - d + \\frac{t \\cdot \\log_{\\alpha}(p)}{3t - d}.</span>$</p>

    <p class="text-gray-300">Since the maximum number of rounds to be attacked is achieved for d = t - 1, the security is provided by choosing</p>

    <p class="text-gray-300"><span class="math">$R_F + R_P \\ge 2 + \\frac{t \\cdot \\log_{\\alpha}(p)}{2t + 1} \\approx 1 + \\frac{\\log_{\\alpha}(p)}{2}.</span>$</p>

    <p class="text-gray-300">As a result, it does not seem that the first strategy can be improved using the existence of the subspace S.</p>

    <p class="text-gray-300"><strong>Second Strategy.</strong> Let  <span class="math">x_0^{(j)}, x_1^{(j)}, \\ldots, x_{t-1}^{(j)}</span>  denote the word values right after the round key addition of the current round, where  <span class="math">j \\geq 1</span>  denotes the j-th round with a partial S-Box layer. When using one S-Box, we know that only  <span class="math">x_0^{(j)}</span>  will enter this function in the j-th partial round. Further note that every S-Box output  <span class="math">(x_0^{(j)})^{\\alpha}</span>  is a linear combination of  <span class="math">x_0^{(j+1)}, x_1^{(j+1)}, \\ldots, x_{t-1}^{(j+1)}</span> . Of these values, all the  <span class="math">x_1^{(j+1)}, x_2^{(j+1)}, \\ldots, x_{t-1}^{(j+1)}</span>  are linear combinations of  <span class="math">x_0^{(j+2)}, x_1^{(j+2)}, \\ldots, x_{t-1}^{(j+2)}</span> . The idea is therefore to introduce a variable and an equation for each  <span class="math">x_0^{(j)}</span> , where</p>

    <p class="text-gray-300"></p>

    <div class="overflow-x-auto my-4">
      <table class="min-w-full text-sm text-gray-300">
        <thead>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">RF<br>Rounds RP</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">Rounds log2</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">(p)</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">t</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">Data Complexity (M)</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">Cost of the Attack<br>(log2<br>(&middot;) scale)</th>
        </thead>
        <tbody>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">6</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">36</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">128</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">2</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">257.97</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">6</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">0</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">16</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">16</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">521.45</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">6</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">0</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">8</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">32</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1049.39</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">6</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">83</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">256</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">2</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">515.95</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">6</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">0</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">32</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">16</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">521.45</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">6</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">0</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">16</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">32</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1049.39</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">6</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">176</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">512</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">2</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1027.38</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">6</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">92</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">64</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">16</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1027.38</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">6</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">0</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">32</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">32</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1049.39</td>
          </tr>
        </tbody>
      </table>
    </div>

    <p class="text-gray-300">Table 3: Let R<sup>F</sup> = 6 fixed. In this table, we present the minimum number of rounds R<sup>P</sup> necessary to protect HadesMiMC (instantiated with the cube S-Box &ndash; &alpha; = 3) for attacks based on Gr&ouml;bner bases when choosing M &ge; 1 (plaintexts, ciphertexts). In all these cases, the cost is minimized by choosing M = 1. The block size is n &middot; t bits.</p>

    <p class="text-gray-300">the equations map the (linear) output of each S-Box to the cube of its input, which is a single variable.</p>

    <p class="text-gray-300">Thus, we have R<sup>P</sup> variables and R<sup>P</sup> equations of degree &alpha; for the partial rounds. In total, the number of variables and equations in the low-data case &ndash; 1 (plaintext, ciphertext) pair &ndash; is R<sup>F</sup> &middot; t + R<sup>P</sup> &minus; &kappa; (as for the attack discussed in Section <a href="#page-19-0">4.3,</a> the best attack can be achieved without guessing any key word, that is, &kappa; = 0), which results in a cost of</p>

    <p class="text-gray-300"><span class="math">$\\begin{split} &amp; \\left[ \\begin{pmatrix} (R_F \\cdot t + R_P) + (1 + (\\alpha - 1) \\cdot (R_F \\cdot t + R_P)) \\\\ 1 + (\\alpha - 1) \\cdot (R_F \\cdot t + R_P) \\end{pmatrix} \\right]^2 \\approx \\\\ &amp; \\approx \\left[ \\begin{pmatrix} \\alpha \\cdot (R_F \\cdot t + R_P) \\\\ (\\alpha - 1) \\cdot (R_F \\cdot t + R_P) \\end{pmatrix} \\right]^2 \\approx \\left( \\frac{\\alpha^{\\alpha}}{(\\alpha - 1)^{\\alpha - 1}} \\right)^{2(R_F \\cdot t + R_P)}, \\end{split}</span>$</p>

    <p class="text-gray-300">and R<sup>F</sup> &middot; t + R<sup>P</sup> &asymp; N 2&middot;(log<sup>2</sup> (&alpha;&alpha;/(&alpha;&minus;1)&alpha;&minus;1) . Working in the same way, the cost of the attack in the decryption direction (remember that S-Box(x) = x <sup>1</sup>/&alpha; = x (&rho;&middot;(p&minus;1)+1)/&alpha; where &rho; &ge; 1 is the smallest integer s.t. &alpha; divides &rho; &middot; (p &minus; 1) + 1) turns out to be</p>

    <p class="text-gray-300"><span class="math">$\\left[ \\left( (R_F \\cdot t + R_P) + (1 + [(\\alpha - 1) \\cdot (\\rho \\cdot (p - 1) + 1)/\\alpha] \\cdot (R_F \\cdot t + R_P)) \\right) \\right]^2 \\approx \\left( \\frac{\\rho \\cdot (p - 1) + 1}{\\alpha} \\right)^{2(R_F \\cdot t + R_P)},</span>$</p>

    <p class="text-gray-300">It follows that</p>

    <p class="text-gray-300"><span class="math">$R_F \\cdot t + R_P \\approx \\left\\lceil \\frac{N}{2 \\cdot \\log_2(\\alpha^{\\alpha}/(\\alpha - 1)^{\\alpha - 1})} \\right\\rceil + \\left\\lceil \\frac{N}{2 \\cdot \\log_2((\\rho \\cdot (p - 1) + 1)/\\alpha)} \\right\\rceil,</span>$</p>

    <p class="text-gray-300">in order to thwart the MitM version of the attack. Note that</p>

    <p class="text-gray-300"><span class="math">$\\frac{N}{2 \\cdot \\log_2((\\rho \\cdot (p-1)+1)/\\alpha)} \\approx \\frac{t}{2} \\cdot \\frac{\\log_2(p)}{\\log_2(p) + \\log_2(\\rho/\\alpha)} \\approx \\frac{t}{2} + 1</span>$</p>

    <p class="text-gray-300">under the assumption log<sup>2</sup> (&rho;/&alpha;) log<sup>2</sup> (p).</p>

    <p class="text-gray-300">Full-Data Case. When working in the full-data case, the number of equations and variables can be increased by using multiple (plaintext, ciphertext) pairs. In particular, the key variables stay the same, while additional intermediate variables have to be introduced for each pair. Let M denote the amount of data used by the attacker (obviously, 1 &le; M &le; 2 <sup>N</sup> &minus; 1). This means that the number of equations differs from the number of variables when using the same attack strategy together with multiple pairs. Therefore, we have to use the Hilbert series in order to determine the degree of regularity, which is the index of the first non-positive coefficient in</p>

    <p class="text-gray-300"><span class="math">$H(z) = \\frac{\\prod_{i=1}^{n_e} (1 - z^{d_i})}{(1 - z)^{n_v}} = \\frac{(1 - z^{\\alpha})^{n_e}}{(1 - z)^{n_v}} = (1 - z^{\\alpha})^{n_e - n_v} \\cdot (1 + z + z^2)^{n_v},</span>$</p>

    <p class="text-gray-300">where n<sup>e</sup> is the number of equations, n<sup>v</sup> is the number of variables, and d<sup>i</sup> = &alpha; is the degree of the i-th equation. When increasing the number of (plaintext, ciphertext) pairs M, both n<sup>e</sup> and n<sup>v</sup> increase. In our case:</p>

    <p class="text-gray-300"><span class="math">$n_e = M \\cdot (t \\cdot R_F + R_P)</span>$
and  <span class="math">n_v = t + M \\cdot ((R_F - 1) \\cdot t + R_P)</span> .</p>

    <p class="text-gray-300">Note that n<sup>e</sup> &minus; n<sup>v</sup> = t &middot; (M &minus; 1) and that (1 + z + z 2 ) <sup>n</sup><sup>v</sup> contains only positive terms. Since</p>

    <p class="text-gray-300"><span class="math">$(1-z^{\\alpha})^{n_e-n_v} = 1 - t \\cdot (M-1) \\cdot z^{\\alpha} + \\dots</span>$</p>

    <p class="text-gray-300">it follows that the index of the first non-positive coefficient must be at least &alpha;, which means Dreg &ge; &alpha;.</p>

    <p class="text-gray-300">Unfortunately, this estimation is too pessimistic in order to derive a useful approximation of the number of rounds necessary to guarantee security. However, by practical experiments (in the case &alpha; = 3), it turns out that a much smaller number of rounds is sufficient for this scope. Table <a href="#page-50-0">3</a> shows the complexities of Gr&ouml;bner basis attacks on various instantiations of HadesMiMC when setting R<sup>F</sup> = 6 and choosing M such that the complexity is minimized. The crucial point is that in all cases that we practically tested, the computational complexity is minimized when M = 1. As concrete examples of the fact that using more (plaintext, ciphertext) pairs increases the attack complexity (using the strategy proposed here), Fig. <a href="#page-52-1">3</a> and Fig. <a href="#page-52-1">4</a> show that R<sup>P</sup> can be kept lower when increasing M and maintaining the same security level.</p>

    <p class="text-gray-300">Since similar results hold also in the decryption direction, we conjecture that</p>

    <p class="text-gray-300"><span class="math">$R_F \\cdot t + R_P \\ge \\left\\lceil \\frac{N}{2 \\cdot \\log_2(\\alpha^{\\alpha}/(\\alpha - 1)^{\\alpha - 1})} \\right\\rceil + \\left\\lceil \\frac{t}{2} \\right\\rceil + 1</span>$</p>

    <p class="text-gray-300">rounds are sufficient in order to protect HadesMiMC from the Gr&ouml;bner basis attack strategy proposed here.</p>

    <p class="text-gray-300">    <img src="_page_52_Figure_0.jpeg" alt="" class="my-4 max-w-full" />
</p>

    <p class="text-gray-300">Fig. 3: Let R<sup>F</sup> = 6 fixed. Number of round R<sup>P</sup> necessary for 256-bit security when using M pairs and the attack strategy proposed here (case: cube S-Box &ndash; &alpha; = 3). The number of rounds is maximized when M = 1.</p>

    <p class="text-gray-300">    <img src="_page_52_Figure_2.jpeg" alt="" class="my-4 max-w-full" />
</p>

    <p class="text-gray-300">Fig. 4: Let R<sup>F</sup> = 6 fixed. Number of round R<sup>P</sup> necessary for 1024-bit security when using M pairs and the attack strategy proposed here (case: cube S-Box &ndash; &alpha; = 3). The number of rounds is maximized when M = 1.</p>

    <p class="text-gray-300">Exploiting the &quot;Invariant&quot; Subspace S. Since each round with a partial S-Box layer can be described by a single equation of degree &alpha;, it seems there is no advantage to exploit the previous strategy based on the existence of the subspace S defined in Eq. <a href="#page-12-0">(1)</a>.</p>

    <p class="text-gray-300">Third Strategy. Another strategy can be applied as well. Let us work for simplicity in the encryption direction (similar results work in the decryption one). Given an input x = (x0, . . . , xt&minus;1), the output of the first R<sup>f</sup> rounds with full S-Box layers can be described by t equations of degree &alpha; R<sup>f</sup> , where R<sup>f</sup> = R<sup>F</sup> /2. Then, working round per round, the output of each round with a partial S-Box layer is described by 1 non-linear equation of degree &alpha; and t &minus; 1 linear equations. Finally, t more equations of degree &alpha; <sup>R</sup><sup>f</sup> describe the relations between the output of the rounds with partial S-Box layers and the input of the final rounds with full S-Box layers. As a result, in the case of a single (plaintext, ciphertext) pair, one works with</p>

    <ul class="list-disc list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li>2t equations of degree  <span class="math">\\alpha^{R_f}</span>  and  <span class="math">R_P</span>  equations of degree  <span class="math">\\alpha</span> ;</li>
      <li>t variables that describe the key and  <span class="math">t+R_P</span>  variables that describe the internal state of the texts.</li>
    </ul>

    <p class="text-gray-300">Since the number of variables is equal to the number of equations, it follows that</p>

    <p class="text-gray-300"><span class="math">$D_{\\text{reg}} = 1 + 2t \\cdot (\\alpha^{R_F/2} - 1) + 2 \\cdot R_P.</span>$</p>

    <p class="text-gray-300">Setting  <span class="math">\\omega = 2</span> , the cost of this attack is well described by</p>

    <p class="text-gray-300"><span class="math">$\\begin{split} &amp; \\left[ \\left( (2t + R_P) + [1 + 2t \\cdot (\\alpha^{R_F/2} - 1) + 2 \\cdot R_P] \\right) \\right]^2 \\approx \\left[ \\left( \\alpha \\cdot R_P + 2t \\cdot \\alpha^{R_F/2} \\right) \\right]^2 \\geq \\\\ &amp; 2t + R_P \\\\ &amp; \\geq \\left( \\frac{1 + 2 \\cdot R_P + 2t \\cdot \\alpha^{R_F/2} - 2t}{2t + R_P} \\right)^{2R_P + 4t} \\geq \\left( \\frac{2t \\cdot \\alpha^{R_F/2}}{2t + R_P} \\right)^{2R_P + 4t}. \\end{split}</span>$</p>

    <p class="text-gray-300">It follows that HADESMiMC is secure if 28</p>

    <p class="text-gray-300"><span class="math">$R_F \\geq R^{3\\text{rd-Grob}}(N,t,R_P) \\equiv 2 + \\log_{\\alpha} \\left[ 1 + 2^{\\frac{N}{2t+R_P}} \\cdot \\left( 1 + \\frac{R_P}{t} \\right) - \\frac{R_P}{t} \\right],</span>$</p>

    <p class="text-gray-300">where 2 more rounds have been added in order to thwart meet-in-the-middle versions of this attack (based on the high degree of the decryption function).</p>

    <p class="text-gray-300">Since  <span class="math">\\log_{\\alpha}\\left[1+2^{\\frac{N}{2t+R_P}}\\cdot\\left(1+\\frac{R_P}{t}\\right)-\\frac{R_P}{t}\\right] \\leq \\log_{\\alpha}\\left[1+2^{\\frac{N}{2t+R_P}}\\cdot\\left(1+\\frac{R_P}{t}\\right)\\right]</span> , a useful approximation of the previous formula is given by</p>

    <p class="text-gray-300"><span class="math">$R_F \\ge 2 + \\log_{\\alpha}(2) \\cdot \\left(\\frac{N}{2t + R_P} + 2 \\cdot \\log_2\\left(1 + \\frac{R_P}{t}\\right)\\right).</span>$</p>

    <p class="text-gray-300">We point out that this last approximation holds only in the case in which  <span class="math">R_P \\ll \\infty</span> . This is due to the fact that</p>

    <p class="text-gray-300"><span class="math">$\\lim_{R_P \\to \\infty} \\frac{N}{2t + R_P} + 2 \\cdot \\log_2 \\left( 1 + \\frac{R_P}{t} \\right) = \\infty</span>$</p>

    <p class="text-gray-300">We point out that the following estimation of  <span class="math">R^{3rd\\text{-}Grob}(N,t,R_P)</span>  is actually an upper bound. In particular, when increasing  <span class="math">R_P</span> , one may expect that  <span class="math">R^{3rd\\text{-}Grob}(N,t,R_P)</span>  decreases (indeed, one may expect that the cost of the attack becomes higher, until the inequality  <span class="math">R_F \\geq R^{3rd\\text{-}Grob}(N,t,R_P)</span>  is satisfied, which means that the cipher is secure). However, this does not happen. In particular, for certain values of p,t, it can happen that  <span class="math">dR^{3rd\\text{-}Grob}/dR_P &gt; 0</span> , which means that the attack becomes &quot;easier&quot; by increasing the number of rounds (in any case, observe that  <span class="math">dR^{3rd\\text{-}Grob}/dR_P &lt; 0</span>  for each  <span class="math">R_P \\leq R_P^*</span>  and that  <span class="math">\\lim_{R_P \\to \\infty} dR^{3rd\\text{-}Grob}/dR_P = 0</span> ). The reason of this fact is due to the approximation of  <span class="math">\\binom{3\\cdot R_P + 2t\\cdot \\alpha^R_F/2}{2t+R_P}</span> ). We expect that a more precise approximation of the binomial coefficient allows to prevent this situation. On the other hand, since this estimation is a lower bound, we remark that the cipher is secure for each  <span class="math">R_F</span>  and  <span class="math">R_P</span>  that satisfy  <span class="math">R_F \\geq R^{3rd\\text{-}Grob}(N,t,R_P)</span> , even if it can potentially be secure also with a smaller number of rounds.</p>

    <p class="text-gray-300">while note that</p>

    <p class="text-gray-300"><span class="math">$\\lim_{R_P \\to \\infty} \\log_{\\alpha} \\left[ 1 + 2^{\\frac{N}{2t + R_P}} \\cdot \\left( 1 + \\frac{R_P}{t} \\right) - \\frac{R_P}{t} \\right] = 0.</span>$</p>

    <p class="text-gray-300">Full-Data Case. The strategy is similar when one works with more (plaintext, ciphertext) pairs. As for the previous strategy, we found that in all cases that we practically tested (for the case &alpha; = 3), the computational complexity is minimized when the attacker uses a single (plaintext, ciphertext) pair. For this reason, we conjecture that HadesMiMC is secure against this version of the Gr&ouml;bner basis attack if</p>

    <p class="text-gray-300"><span class="math">$R_F \\ge 2 + \\log_{\\alpha}(2) \\cdot \\left(\\frac{N}{2t + R_P} + 2 \\cdot \\log_2(t + R_P) - 2 \\cdot \\log_2(t)\\right)</span>$</p>

    <p class="text-gray-300">is satisfied.</p>

    <p class="text-gray-300">Exploiting the &quot;Invariant&quot; Subspace S. Since each round with a partial S-Box layer can be described by a single equation of degree &alpha;, it seems there is no advantage to exploit the previous strategy based on the existence of the subspace S defined in Eq. <a href="#page-12-0">(1)</a>.</p>

    <p class="text-gray-300">Special Case: R<sup>P</sup> = 0. Finally, let us briefly analyze the case in which the security against Gr&ouml;bner basis attacks is guaranteed by rounds with full S-Box layers. Since the strategy described in Section <a href="#page-19-0">4.3</a> requires R<sup>F</sup> &ge; 2 + log&alpha;(p)/2 + log&alpha;(t) rounds in order to provide security (assuming R<sup>P</sup> = 0), the attack strategies proposed here do not outperform it. In other words, if the condition R<sup>F</sup> &ge; 2 + log&alpha;(p)/2 + log&alpha;(t) is fulfilled (which corresponds to the condition proposed for the first strategy in the case in which R<sup>P</sup> = 0), then the cipher is secure also w.r.t. the two strategies proposed in details in this section.</p>

      <h3 id="app-e.4" class="text-xl font-semibold mt-8">E.4 Gr&ouml;bner Basis Attack: &kappa; = n and Data &le; p 1/2 (MPC Application)</h3>

    <p class="text-gray-300">Here we present the details of the Gr&ouml;bner Basis Attack in the case in which &kappa; = n and data is limited by &le; p 1/2 (namely, the scenario of the MPC application). The goal is to show that such an attack does not outperform the GCD attack presented in Section <a href="#page-24-0">5.</a></p>

    <p class="text-gray-300">First Strategy. As shown before, in our first attack strategy we consider t equations each of degree &alpha; r (after r rounds). Since in this case the key size is &kappa; = n, it follows that the system is described by n<sup>v</sup> = 1 variable and n<sup>e</sup> = t equations of degree &alpha; r . Using generic bounds, the complexity of computing a Gr&ouml;bner basis with these parameters is in</p>

    <p class="text-gray-300"><span class="math">$\\mathcal{O}\\left(\\binom{1+D_{\\text{reg}}}{D_{\\text{reg}}}^{\\omega}\\right),</span>$</p>

    <p class="text-gray-300">where we pessimistically assume &omega; = 2 and Dreg = O(&alpha; r ). It follows that 1+&alpha; r &alpha;<sup>r</sup> 2 = (&alpha; <sup>r</sup> + 1)<sup>2</sup> &ge; p if and only if</p>

    <p class="text-gray-300"><span class="math">$r = R_F + R_P \\ge R^{\\text{1st-Grob}}(p,t) \\equiv R^{\\text{Grobner}}(p,t) \\equiv 2 + \\left\\lceil \\frac{\\log_{\\alpha}(p)}{2} \\right\\rceil.</span>$</p>

    <p class="text-gray-300">where we add 2 additional rounds to thwart a MitM version of the attack.</p>

    <p class="text-gray-300">Second Strategy. The crucial difference between the full-key variant of our design and the variant with n-bit security is that each round with a full S-Box layer can essentially be transformed into a round with a partial S-Box layer, from an algebraic point of view. For example, consider the state after the application of the first round. Since only one key component is used and since we clearly know all words of the input, knowing one word after the first S-Box layer is sufficient in order to derive all output words after the first round. Using the same idea, knowing one of the output words after the second S-Box layer (together with the output words after the first round) is sufficient in order to derive all output words after the second round. By using this strategy for the first R<sup>f</sup> rounds with a full S-Box layer, we can describe this part of the permutation with 1+R<sup>f</sup> variables and R<sup>f</sup> equations.</p>

    <p class="text-gray-300">We consider the middle part of the permutation (i.e., the R<sup>P</sup> rounds with a partial S-Box layer) the same way as before, resulting in R<sup>P</sup> equations and R<sup>P</sup> variables. The final R<sup>f</sup> rounds can then be described with R<sup>f</sup> variables and R<sup>f</sup> equations using the idea from above and working in backwards direction for the last equation.</p>

    <p class="text-gray-300">In total, we now have 1 +R<sup>F</sup> +R<sup>P</sup> variables and R<sup>F</sup> +R<sup>P</sup> equations (2R<sup>f</sup> = R<sup>F</sup> ). We argue that by removing one variable from the equation system, the computation of a Gr&ouml;bner basis for the new system does not become harder. Thus, using Dreg = 1 + 2(R<sup>F</sup> +R<sup>P</sup> ) as an estimation for the degree of regularity (our equations are of degree &alpha;), we get a condition of the form</p>

    <p class="text-gray-300"><span class="math">$\\begin{pmatrix} R_F + R_P + D_{\\text{reg}} \\\\ D_{\\text{reg}} \\end{pmatrix}^{\\omega} = \\begin{pmatrix} R_F + R_P + 1 + (\\alpha - 1)(R_F + R_P) \\\\ 1 + (\\alpha - 1)(R_F + R_P) \\end{pmatrix}^2 \\ge \\left(\\frac{\\alpha R}{(\\alpha - 1)R}\\right)^2 \\approx \\left(\\frac{\\alpha^{\\alpha}}{(\\alpha - 1)^{\\alpha - 1}}\\right)^{2R} \\ge p,</span>$</p>

    <p class="text-gray-300">where R = R<sup>F</sup> + R<sup>P</sup> , which means</p>

    <p class="text-gray-300"><span class="math">$R \\ge 2 + \\frac{\\log_{\\alpha^{\\alpha}/(\\alpha - 1)^{\\alpha - 1}}(p)}{2} = 2 + \\frac{\\log_2(p)}{2 \\cdot \\log_2(\\alpha^{\\alpha}/(\\alpha - 1)^{\\alpha - 1})} \\approx 2 + \\frac{\\log_2(p)}{2 \\cdot \\log_2(\\alpha)}</span>$</p>

    <p class="text-gray-300">(where 2 rounds have been added to thwart a MitM version of the attack).</p>

    </section>

    <section id="app-f" class="mb-10">
      <h2 class="text-2xl font-bold">F Comparison: HadesMiMC with S-Box(x) = x &minus;1</h2>

    <p class="text-gray-300">As mentioned in Section <a href="#page-8-0">2,</a> HadesMiMC can be instantiated by an S-Box with a higher degree than 3. Here we analyze the number of rounds necessary to provide security against algebraic attacks. Since the degree of the S-Box is higher, it follows that the degree of the encryption/decryption function grows much faster than in the case of the cube S-Box. Thus, one may expect that a smaller number of rounds is sufficient in order to provide security. Here we propose the security analysis of HADESMiMC instantiated with S-Box <span class="math">(x) = x^{-1}</span> , and we show that this is in general not the case.</p>

    <p class="text-gray-300">Main Result. As a concrete example, here we briefly report the results related to the analysis for the interpolation attack (see in the following for more details). In order to guarantee security against interpolation attacks, the number of monomials of the interpolation polynomial has to be close to the full code book. For the cube case, one needs approximately</p>

    <p class="text-gray-300"><span class="math">$R_P + R_F \\ge 3 + \\log_3(p) + \\log_3(t)</span>$</p>

    <p class="text-gray-300">rounds in order to guarantee this, while for the inverse case one needs</p>

    <p class="text-gray-300"><span class="math">$R_P + \\log_2(t) \\cdot R_F \\ge 2 + 2 \\cdot \\log_2(p)</span>$</p>

    <p class="text-gray-300">rounds, as shown in the following. Since we want to minimize the total number of S-Boxes (given by  <span class="math">R_P + t \\cdot R_F</span> ), the best idea is to minimize the number of rounds with full S-Box layers. Indeed, in this case, the number of S-Boxes</p>

    <p class="text-gray-300"><span class="math">$R_P + t \\cdot R_F \\Big|_{R_P + \\phi(t) \\cdot R_F \\ge \\psi(N, t)} \\ge \\psi(N, t) + R_F \\cdot [t - \\phi(t)]</span>$</p>

    <p class="text-gray-300">(where  <span class="math">\\phi(t)=1</span>  or  <span class="math">\\phi(t)=\\log_2(t)</span> ) is minimized by choosing the minimum  <span class="math">R_F=R_F^{\\rm stat}</span> .</p>

    <p class="text-gray-300">As a result, the number of rounds for the cube and the inverse case</p>

    <p class="text-gray-300"><span class="math">$\\begin{split} R_P^{\\text{cube}} &amp;\\geq \\max\\{0; 3 + \\log_3(p) + \\log_3(t) - R_F^{\\text{stat}}\\} \\\\ R_P^{\\text{inverse}} &amp;\\geq \\max\\{0; 2 + 2 \\cdot \\log_2(p) - \\log_2(t) \\cdot R_F^{\\text{stat}}\\} \\end{split}</span>$</p>

    <p class="text-gray-300">are close when t is not much bigger than  <span class="math">\\log_2(p)</span> . At the same time, the total number of non-linear operations in order to compute the two S-Boxes is in general much bigger for the inverse than for the cube case. A similar conclusion holds as well for the Gr&ouml;bner basis attack. In conclusion, it seems there is no advantage to use an S-Box different than the cube one in the case in which one aims to minimize the total number of non-linear operations.</p>

    <p class="text-gray-300">Interpolation Attack &ndash; Details. As we have already seen, the goal of an interpolation attack [37] is to determine the polynomial representation of a state word. Since the inverse function has high degree, one may think that the interpolation attack can cover only few rounds in this case. However, exploiting the original idea proposed by Jakobsen and Knudsen in [37], it is possible to show the following:</p>

    <ul class="list-disc list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li>for a full S-Box layer, the S-Box  <span class="math">f(x) = x^{-1}</span>  has the same behavior as a function of algebraic degree t (i.e., the number of words)<sup>29</sup> &quot;from the point of view&quot; of the interpolation attack;</li>
      <li>for a partial S-Box layer (with a single S-Box), the S-Box  <span class="math">f(x) = x^{-1}</span>  has the same behavior as a function of algebraic degree 2 &quot;from the point of view&quot; of the interpolation attack.</li>
    </ul>

    <p class="text-gray-300">Note that the two previous cases lead to two completely different results, while we emphasize that they are equivalent for a cube S-Box. It follows that the choice whether to use partial or full S-Box layers in order to protect from algebraic attacks also depends on the details of the S-Box.</p>

    <p class="text-gray-300">Full S-Box Layer. Firstly, consider t=1. In this case, every encryption function can be written as</p>

    <p class="text-gray-300"><span class="math">$f(x) = \\frac{x+A}{B \\cdot x + C}</span>$</p>

    <p class="text-gray-300">for any number of rounds and for some constants A, B, C. This means that 4 texts are sufficient to break the cipher.</p>

    <p class="text-gray-300">Consider the case t=2. Let  <span class="math">f_i^r(\\cdot) \\equiv \\frac{Nf_i^r(\\cdot)}{Df_i^r(\\cdot)}</span>  (for i=0,1) be the interpolation polynomial at round r of the i-th word. By simple computation, the i-th word of the function at round r+1 (assuming a full S-Box layer) for i=0,1 can be written as</p>

    <p class="text-gray-300"><span class="math">$\\begin{split} &amp;f_{i}^{r+1}(x\\equiv[x_{0},x_{1}])=\\frac{A}{f_{0}^{r}(x\\equiv[x_{0},x_{1}])+k_{0}}+\\frac{B}{f_{1}^{r}(x\\equiv[x_{0},x_{1}])+k_{1}}=\\\\ &amp;=\\frac{A\\cdot Df_{0}^{r}(x)}{Nf_{0}^{r}(x)+k_{0}\\cdot Df_{0}^{r}(x)}+\\frac{B\\cdot Df_{1}^{r}(x)}{Nf_{1}^{r}(x)+k_{1}\\cdot Df_{1}^{r}(x)}=\\\\ &amp;=\\frac{A\\cdot\\left[Nf_{1}^{r}(x)+k_{1}\\cdot Df_{1}^{r}(x)\\right]\\times Df_{0}^{r}(x)+B\\cdot\\left[Nf_{0}^{r}(x)+k_{0}\\cdot Df_{0}^{r}(x)\\right]\\times Df_{1}^{r}(x)}{\\left[Nf_{0}^{r}(x)+k_{0}\\cdot Df_{0}^{r}(x)\\right]\\times \\left[Nf_{1}^{r}(x)+k_{1}\\cdot Df_{1}^{r}(x)\\right]}=\\\\ &amp;=\\frac{Nf_{i}^{r+1}(x\\equiv[x_{0},x_{1}])}{Df_{i}^{r+1}(x\\equiv[x_{0},x_{1}])} \\end{split}</span>$</p>

    <p class="text-gray-300">for some constants A, B. It follows that the degree of the function increases at most by a factor of 2 (where the degree after the first round is 1). As a result, the number of unknown coefficients after r rounds is at most  <span class="math">2 \\cdot (2^{r-1} + 1)^2</span> , where the degree of the numerator (and so the number of unknown coefficients) is always less than or equal to the degree of the denominator.</p>

    <p class="text-gray-300">As a result, the number of unknown coefficients after r rounds for t words is approximately  <span class="math">2 \\cdot (t^{r-1}+1)^t</span> . The cipher can be considered secure if  <span class="math">2 \\cdot (t^{r-1}+1)^t \\simeq p^t</span> , that is,  <span class="math">t^{r-1} \\simeq p</span> , which implies</p>

    <p class="text-gray-300"><span class="math">$r \\ge \\log_t(p) + 1</span>$
.</p>

    <p class="text-gray-300">More precisely, the degree of S-Box <span class="math">(x) = x^{-1} \\equiv x^{p-2}</span>  &quot;from the point of view of the interpolation attack&quot; is min <span class="math">\\{t, p-2\\}</span> , where t is due to the fraction representation and p-2 is due to the &quot;normal&quot; representation. Since t &lt; p/2+1 in order to guarantee that a  <span class="math">t \\times t</span>  MDS matrix with coefficients in  <span class="math">\\mathbb{F}_p</span>  exists, it follows that min <span class="math">\\{t, p-2\\} = t</span> .</p>

    <p class="text-gray-300">A MitM variant of this attack can be performed. To thwart this variant (note that S-Box<sup>-1</sup>(x) = S-Box(x) = x<sup>-1</sup>), it is sufficient to double the number of rounds  <span class="math">r \\ge 2\\log_t(p) + 2</span> . Finally, we add two rounds to prevent the key-guessing attack. As a result, the total number of rounds (with full S-Box layers) must be</p>

    <p class="text-gray-300"><span class="math">$R_F \\ge 2\\log_t(p) + 4 = 4 + 2\\log_t(p).</span>$</p>

    <p class="text-gray-300">Partial S-Box Layer. Referring to the expression of  <span class="math">f_i^r</span>  given before, it is possible to note that all denominators at rounds r (for any r) are in general equal, while all numerators are in general different, that is,</p>

    <p class="text-gray-300"><span class="math">$\\forall i, j \\in [0, 1, \\dots, t - 1] : Df_i^r = Df_j^r.</span>$</p>

    <p class="text-gray-300">This observation seems to have no effect on the complexity of the previous attack. Indeed, since the S-Boxes are applied on each word and since the numerators are different, it turns out that the denominators of S-Box <span class="math">(f^r)</span>  (which correspond to the numerator of  <span class="math">f^r</span> ) are all different.</p>

    <p class="text-gray-300">However, this has an important effect in the case in which we work with a partial non-linear layer, e.g. a non-linear layer composed of a single S-Box. Consider first the case t=2 assuming the S-Box is applied only on the first word:</p>

    <p class="text-gray-300"><span class="math">$\\begin{split} &amp;f_{i}^{r+1}(x\\equiv[x_{0},x_{1}])=\\frac{A}{f_{0}^{r}(x\\equiv[x_{0},x_{1}])+k_{0}}+B\\cdot\\left[f_{1}^{r}(x\\equiv[x_{0},x_{1}])+k_{1}\\right]=\\\\ &amp;=\\frac{A\\cdot Df_{0}^{r}(x)}{Nf_{0}^{r}(x)+k_{0}\\cdot Df_{0}^{r}(x)}+\\frac{B\\cdot\\left[Nf_{1}^{r}(x)+k_{1}\\cdot Df_{1}^{r}(x)\\right]}{Df_{1}^{r}(x)}=\\\\ &amp;=\\frac{A\\cdot Df_{0}^{r}(x)\\times Df_{0}^{r}(x)+B\\cdot\\left[Nf_{1}^{r}(x)+k_{1}\\cdot Df_{1}^{r}(x)\\right]\\times\\left[Nf_{0}^{r}(x)+k_{0}\\cdot Df_{0}^{r}(x)\\right]}{\\left[Nf_{0}^{r}(x)+k_{0}\\cdot Df_{0}^{r}(x)\\right]\\times Df_{1}^{r}(x)}=\\\\ &amp;=\\frac{Nf_{i}^{r+1}(x\\equiv[x_{0},x_{1}])}{Df_{i}^{r+1}(x\\equiv[x_{0},x_{1}])}. \\end{split}</span>$</p>

    <p class="text-gray-300">In this case, there is no difference w.r.t. the previous case.</p>

    <p class="text-gray-300">Consider now the case  <span class="math">t \\geq 3</span> . By the previous observation, it follows that  <span class="math">Df_i^r(x) = Df_j^r(x)</span>  for each  <span class="math">i, j \\geq 1</span> , which implies that</p>

    <p class="text-gray-300"><span class="math">$Df_i^{r+1} = [Nf_0^r(x) + k_0 \\cdot Df_0^r(x)] \\times Df_1^r(x)</span>$</p>

    <p class="text-gray-300">also for the case  <span class="math">t \\geq 3</span> . This fact has a considerable impact on the number of monomials of the corresponding polynomial at round r. Indeed, the number of unknown coefficients after r rounds for t words is approximately  <span class="math">2 \\cdot (2^{r-1} + 1)^t</span> , which is much smaller than  <span class="math">2 \\cdot (t^{r-1} + 1)^t</span>  for large t. The cipher can be considered secure if  <span class="math">2 \\cdot (2^{r-1} + 1)^t \\simeq p^t</span> , that is,  <span class="math">2^{r-1} \\simeq p</span> , which implies</p>

    <p class="text-gray-300"><span class="math">$r \\ge \\log_2(p) + 1</span>$
.</p>

    <p class="text-gray-300">The previous result can even be improved. Since at least  <span class="math">R_F \\geq 6</span>  rounds have a full S-Box layer, it follows that the number of unknown coefficients after  <span class="math">R = R_P + R_F</span>  rounds for t words is approximately</p>

    <p class="text-gray-300"><span class="math">$2 \\cdot (2^{R_P} \\cdot t^{R_F - 1} + 1)^t \\equiv 2 \\cdot (2^{R_P + (R_F - 1) \\cdot \\log_2(t)} + 1)^t.</span>$</p>

    <p class="text-gray-300">The cipher can be considered secure if  <span class="math">2 \\cdot (2^{R_P + (R_F - 1) \\cdot \\log_2(t)} + 1)^t \\simeq p^t</span> , that is,</p>

    <p class="text-gray-300"><span class="math">$R_P + (R_F - 1) \\cdot \\log_2(t) \\ge \\log_2(p).</span>$</p>

    <p class="text-gray-300">As for the GCD attack, a MitM variant of this attack can be performed. To thwart this variant (note that S-Box<sup>-1</sup>(x) = S-Box(x) =  <span class="math">x^{-1}</span> ), it is sufficient to double the number of rounds  <span class="math">R_P + \\log_2(t) \\cdot (R_F - 1) \\ge 2 \\cdot \\log_2(p)</span> . Finally, we add two rounds to prevent the key-guessing attack. As a result, the total number of rounds (with partial S-Box layers) must be</p>

    <p class="text-gray-300"><span class="math">$R_P \\ge 2 + 2 \\cdot \\log_2(p) - \\log_2(t) \\cdot (R_F - 1).</span>$</p>

    <p class="text-gray-300">In [3], the authors present a security analysis for GMiMC <span class="math">_{\\rm erf}</span>  in the case in which the security level is  <span class="math">\\kappa=n</span>  and in which no limitation is imposed on data cost. Here we adapt this analysis for the case in which there is also a limitation on the data, namely the attacker can use at most  <span class="math">\\leq 2^{n/2}</span>  chosen plaintexts/ciphertexts. As we are going to show, the minimum number of rounds necessary to guarantee security in this setting is given by</p>

    <p class="text-gray-300"><span class="math">$\\max \\big\\{ 2 \\cdot \\lceil \\log_3(p) \\rceil - 4 \\cdot \\lfloor \\log_3(\\log_2 p) \\rfloor + 2t - 2; \\dots t + 3 \\big\\}.</span>$</p>

    <p class="text-gray-300">Key Schedule. In [15], Bonnetain presented an attack on Feistel-MiMC and univariate GMiMC. This attack, which is reminiscent of a slide attack, only relies on their weak key schedules, and is independent of the round function and the number of rounds. This attack only depends on the weak key schedule of GMiMC. Thus, a change of the key schedule should be sufficient to restore the security. Here we do not propose any key schedule. We limit ourselves to recall that the MPC costs are independent of the details of the key schedule, since all subkeys can be precomputed in advance.</p>

    <p class="text-gray-300"><strong>Statistical Attacks.</strong> Here we show that 5t + 3 rounds are sufficient to provide security against statistical attacks (we remember that in the case in which full data is available, then the number of rounds is of order  <span class="math">t^2</span> ).</p>

    <p class="text-gray-300">(Truncated) Diff. Attack. As shown in [3, App. D.1], there exists a characteristic of prob.  <span class="math">(2/p)^2</span>  over t+1 rounds defined as</p>

    <p class="text-gray-300"><span class="math">$(0,\\ldots,0,\\Delta_I) \\xrightarrow[\\text{prob. } 1]{R^{t-1}(\\cdot)} (\\Delta_I,0,\\ldots,0) \\xrightarrow[\\text{prob. } 1]{R(\\cdot)} (\\Delta,\\Delta,\\ldots,\\Delta_I) \\xrightarrow[\\text{prob. } 2/p]{R(\\cdot)} (0,\\ldots,0,\\Delta&#x27;,\\Delta)</span>$</p>

    <p class="text-gray-300">for generic  <span class="math">\\Delta_I \\neq 0</span> , where the characteristic over the next t-2 rounds has prob. 1. Following our argument provided in Section 5.1, we claim that GMiMC<sub>erf</sub> is secure if every characteristic has probability smaller than  <span class="math">p^{-2}</span> . As a result, 3t+2 rounds are sufficient to provide security against this attack, where 2 more rounds</p>

    <p class="text-gray-300">are added in order to prevent key-guessing attack. Finally, in order to prevent meet-in-the-middle (differential) attacks, we add 2t + 1 more rounds.</p>

    <p class="text-gray-300">Other Statistical Attacks. As shown in <a href="#page-33-2">[3]</a>, 2t+ 2 rounds are sufficient to provide security against other statistical attacks (e.g. impossible differential attack).</p>

    <p class="text-gray-300">Algebraic Attacks. Here we give the number of rounds necessary to provide security against algebraic attacks.</p>

    <p class="text-gray-300">GCD Attack. As shown in <a href="#page-33-2">[3,</a> App. C.4], 2&middot;dlog<sup>3</sup> (p)e&minus;4&middot;blog<sup>3</sup> (log<sup>2</sup> p)c+2t&minus;2 rounds are sufficient to prevent a (MitM) GCD attack. Note that 2 texts are sufficient to set up this attack.</p>

    <p class="text-gray-300">Interpolation Attack. Working as in <a href="#page-33-2">[3,</a> App. C.1] and choosing texts with just one active words (as done in Section <a href="#page-24-2">5.2)</a>, the number of monomials after r rounds is given by (3<sup>r</sup> + 1). Hence, the number of rounds necessary to provide security must satisfy 3 <sup>r</sup> + 1 &ge; p 1/2 , which implies r &ge; 0.5 &middot; log<sup>3</sup> (p). Note that by choosing plaintexts of the form (C, . . . , C, A) where C and A denotes resp. constant and active words, no S-Box is active in the first t &minus; 1 rounds. Since a MitM variant of the attack can be set up, the minimum number of rounds necessary to prevent this attack is then dlog<sup>3</sup> (p)e + 2t + 4.</p>

    <p class="text-gray-300">Gr&ouml;bner Basis Attack. As noted in <a href="#page-33-2">[3,</a> App. C.3], the Gr&ouml;bner basis attack is equivalent to a GCD attack in the case for which 2 <sup>&kappa;</sup> &asymp; p. Since the GCD attack uses only 2 texts, the number of rounds is also 2&middot;dlog<sup>3</sup> (p)e&minus;4&middot;blog<sup>3</sup> (log<sup>2</sup> p)c+2t&minus;2 in this case.</p>

    <ul class="list-disc list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li><p class="text-gray-300">52. Abdelraheem, M.A., &Aring;gren, M., Beelen, P., Leander, G.: On the Distribution of Linear Biases: Three Instructive Examples. In: CRYPTO 2012. LNCS, vol. 7417, pp. 50&ndash;67 (2012)</p></li>
      <li><p class="text-gray-300">53. Bao, Z., Guo, J., List, E.: Extended Expectation Cryptanalysis on Round-reduced AES. IACR Cryptology ePrint Archive 2019, 622 (2019), <a href="https://eprint.iacr.org/2019/622" target="_blank" rel="noopener noreferrer">https://eprint.iacr.</a> <a href="https://eprint.iacr.org/2019/622" target="_blank" rel="noopener noreferrer">org/2019/622</a></p></li>
      <li><p class="text-gray-300">54. Bardeh, N.G., R&oslash;njom, S.: The Exchange Attack: How to Distinguish 6 Rounds of AES with 288.2 chosen plaintexts. IACR Cryptology ePrint Archive 2019, 652 (2019), <a href="https://eprint.iacr.org/2019/652" target="_blank" rel="noopener noreferrer">https://eprint.iacr.org/2019/652</a></p></li>
      <li><ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li>Beierle, C., Canteaut, A., Leander, G., Rotella, Y.: Proving Resistance Against Invariant Attacks: How to Choose the Round Constants. In: CRYPTO 2017. LNCS, vol. 10402, pp. 647&ndash;678 (2017)</li>
    </ol></li>
      <li><p class="text-gray-300">56. Biham, E., Keller, N.: Cryptanalysis of Reduced Variants of Rijndael (2001), <a href="http://csrc.nist.gov/archive/aes/round2/conf3/papers/35-ebiham.pdf" target="_blank" rel="noopener noreferrer">http://csrc.nist.gov/archive/aes/round2/conf3/papers/35-ebiham.pdf</a>, unpublished</p></li>
      <li><p class="text-gray-300">57. Boura, C., Canteaut, A., Coggia, D.: A General Proof Framework for Recent AES Distinguishers. IACR Trans. Symmetric Cryptol. 2019(1), 170&ndash;191 (2019), <a href="https://doi.org/10.13154/tosc.v2019.i1.170-191" target="_blank" rel="noopener noreferrer">https:</a> <a href="https://doi.org/10.13154/tosc.v2019.i1.170-191" target="_blank" rel="noopener noreferrer">//doi.org/10.13154/tosc.v2019.i1.170-191</a></p></li>
      <li><p class="text-gray-300">58. Derbez, P., Fouque, P.: Exhausting Demirci-Sel&ccedil;uk Meet-in-the-Middle Attacks Against Reduced-Round AES. In: FSE 2013. LNCS, vol. 8424, pp. 541&ndash;560. Springer (2013)</p></li>
      <li><p class="text-gray-300">59. Grassi, L., Rechberger, C.: New Rigorous Analysis of Truncated Differentials for 5 round AES. Cryptology ePrint Archive, Report 2018/182 (2018), <a href="https://eprint.iacr.org/2018/182" target="_blank" rel="noopener noreferrer">https://eprint.</a> <a href="https://eprint.iacr.org/2018/182" target="_blank" rel="noopener noreferrer">iacr.org/2018/182</a></p></li>
      <li><p class="text-gray-300">60. Guo, J., Peyrin, T., Poschmann, A.: The PHOTON Family of Lightweight Hash Functions. In: CRYPTO 2011. LNCS, vol. 6841, pp. 222&ndash;239 (2011)</p></li>
      <li><p class="text-gray-300">61. Guo, J., Peyrin, T., Poschmann, A., Robshaw, M.J.B.: The LED Block Cipher. In: CHES 2011. LNCS, vol. 6917, pp. 326&ndash;341 (2011)</p></li>
      <li><p class="text-gray-300">62. Hell, M., Johansson, T., Meier, W.: Grain: a stream cipher for constrained environments. IJWMC 2(1), 86&ndash;93 (2007)</p></li>
      <li><p class="text-gray-300">63. Knudsen, L.R.: DEAL - A 128-bit Block Cipher. Technical Report, Department of Informatics, Bergen, Norway (1998)</p></li>
      <li><p class="text-gray-300">64. Lacan, J., Fimes, J.: Systematic MDS Erasure Codes Based on Vandermonde Matrices. IEEE Communications Letters 8(9), 570&ndash;572 (2004)</p></li>
      <li><p class="text-gray-300">65. Youssef, A.M., Mister, S., Tavares, S.E.: On the Design of Linear Transformations for Substitution Permutation Encryption Networks. In: School of Computer Science, Carleton University. pp. 40&ndash;48 (1997)</p></li>
    </ul>

    </section>
`;
---

<BaseLayout title="On a Generalization of Substitution-Permutation Networks: Th... (2019/1107)">
  <article class="max-w-4xl mx-auto article-prose">
    <nav class="mb-8">
      <a href="/papers" class="text-blue-400 hover:text-blue-300">
        &larr; Back to Papers
      </a>
    </nav>

    <header class="mb-12">
      <h1 class="text-3xl font-bold mb-4"
        set:html={TITLE_HTML} />
      <p class="text-gray-400 mb-2"
        set:html={AUTHORS_HTML} />
      <p class="text-gray-500 text-sm mb-4">
        2019 &middot; eprint 2019/1107
      </p>
      <div class="flex gap-4 text-sm">
        <a
          href={EPRINT_URL}
          target="_blank"
          rel="noopener noreferrer"
          class="text-blue-400 hover:text-blue-300"
        >
          Paper (eprint) &rarr;
        </a>
      </div>
      <PaperDisclaimer eprintUrl={EPRINT_URL} />
      <p class="mt-1 text-xs text-gray-600">
        Converted with: {CRAWLER} &middot; {CONVERTED_DATE}
      </p>
    </header>

    <nav id="toc" class="mb-10 p-6 rounded-lg" style="background: rgba(255,255,255,0.03); border: 1px solid rgba(255,255,255,0.06);">
      <h2 class="text-lg font-bold mb-4">Table of Contents</h2>
      <ol class="space-y-1 text-sm text-gray-300
        list-decimal list-inside">
        <li>
          <a href="#sec-1" class="hover:text-white">Introduction</a>
          <ol class="ml-6 mt-1 space-y-1 list-decimal
            list-inside text-gray-400">
            <li><a href="#sec-1.1" class="hover:text-white">The Big Caveat: Security Analysis of P-SPNs</a></li>
            <li><a href="#sec-1.2" class="hover:text-white">The Idea in a Nutshell &ndash; The Hades Strategy</a></li>
            <li><a href="#sec-1.3" class="hover:text-white">Related Work &ndash; Designs with Different Round Functions</a></li>
            <li><a href="#sec-1.4" class="hover:text-white">HadesMiMC: Concrete Instantiations for MPC Applications</a></li>
          </ol>
        </li>
        <li><a href="#sec-2" class="hover:text-white">Description of the Hades Strategy</a></li>
        <li>
          <a href="#sec-3" class="hover:text-white">The Keyed Permutation HadesMiMC</a>
          <ol class="ml-6 mt-1 space-y-1 list-decimal
            list-inside text-gray-400">
            <li><a href="#sec-3.1" class="hover:text-white">Specification of HadesMiMC</a></li>
            <li><a href="#sec-3.2" class="hover:text-white">Design Considerations: Reviving &quot;Old&quot; Design Ideas</a></li>
          </ol>
        </li>
        <li>
          <a href="#sec-4" class="hover:text-white">Security Analysis</a>
          <ol class="ml-6 mt-1 space-y-1 list-decimal
            list-inside text-gray-400">
            <li><a href="#sec-4.1" class="hover:text-white">Main Points of Our Cryptanalysis Results</a></li>
            <li><a href="#sec-4.2" class="hover:text-white">Statistical Attacks &ndash; Security Level: \kappa = N</a></li>
            <li><a href="#sec-4.3" class="hover:text-white">Algebraic Attacks &ndash; Security Level: &kappa; = N</a></li>
          </ol>
        </li>
        <li>
          <a href="#sec-5" class="hover:text-white">Security Analysis for MPC: \kappa=n and Data \leq p^&#123;1/2&#125;</a>
          <ol class="ml-6 mt-1 space-y-1 list-decimal
            list-inside text-gray-400">
            <li><a href="#sec-5.1" class="hover:text-white">Statistical Attacks</a></li>
            <li><a href="#sec-5.2" class="hover:text-white">Algebraic Attacks</a></li>
          </ol>
        </li>
        <li>
          <a href="#sec-6" class="hover:text-white">Number of Rounds: Security and Efficiency</a>
          <ol class="ml-6 mt-1 space-y-1 list-decimal
            list-inside text-gray-400">
            <li><a href="#sec-6.1" class="hover:text-white">Efficiency in the Case of MPC Applications</a></li>
            <li><a href="#sec-6.2" class="hover:text-white">Best Ratio Between RF and RP &ndash; MPC Application</a></li>
            <li><a href="#sec-6.3" class="hover:text-white">Concrete Round Numbers of HadesMiMC</a></li>
          </ol>
        </li>
        <li><a href="#sec-7" class="hover:text-white">MPC Applications</a></li>
        <li><a href="#sec-8" class="hover:text-white">Concluding Remarks: Possible Variants for Future Works</a></li>
      </ol>
      <p class="text-xs text-gray-500 mt-4 mb-1 font-semibold">
        Appendices
      </p>
      <ol class="space-y-1 text-sm text-gray-400
        list-[upper-alpha] list-inside">
        <li><a href="#app-a" class="hover:text-white">Concrete Instantiations</a></li>
        <li><a href="#app-b" class="hover:text-white">MDS Matrix Construction</a></li>
        <li><a href="#app-c" class="hover:text-white">Efficient Implementation</a></li>
        <li>
          <a href="#app-d" class="hover:text-white">Statistical Attacks on HadesMiMC- Details</a>
          <ol class="ml-6 mt-1 space-y-1 list-decimal
            list-inside text-gray-400">
            <li><a href="#app-d.1" class="hover:text-white">Linear Cryptanalysis</a></li>
            <li><a href="#app-d.2" class="hover:text-white">Truncated Differentials</a></li>
            <li><a href="#app-d.3" class="hover:text-white">Differential Meet-in-the-Middle Attack</a></li>
            <li><a href="#app-d.4" class="hover:text-white">Impossible Differential</a></li>
            <li><a href="#app-d.5" class="hover:text-white">Boomerang Attack</a></li>
            <li><a href="#app-d.6" class="hover:text-white">Multiple-of-n and &quot;Mixture Differential Cryptanalysis&quot;</a></li>
            <li><a href="#app-d.7" class="hover:text-white">Invariant Subspace Attack</a></li>
            <li><a href="#app-d.8" class="hover:text-white">Integral/Square Attack</a></li>
            <li><a href="#app-d.9" class="hover:text-white">Biclique Cryptanalysis</a></li>
          </ol>
        </li>
        <li>
          <a href="#app-e" class="hover:text-white">Algebraic Attacks &ndash; Details</a>
          <ol class="ml-6 mt-1 space-y-1 list-decimal
            list-inside text-gray-400">
            <li><a href="#app-e.1" class="hover:text-white">Interpolation Attack and Dense Polynomial</a></li>
            <li><a href="#app-e.2" class="hover:text-white">GCD Attack</a></li>
            <li><a href="#app-e.3" class="hover:text-white">Gr&ouml;bner Basis Attack - Details</a></li>
          </ol>
        </li>
        <li><a href="#app-g" class="hover:text-white">GMiMC&lt;sub&gt;erf&lt;/sub&gt; for MPC Applications</a></li>
      </ol>
      <p class="text-xs text-gray-500 mt-4 mb-1 font-semibold">
        Additional
      </p>
      <ul class="space-y-1 text-sm text-gray-400
        list-disc list-inside">
        <li><a href="#references" class="hover:text-white">References</a></li>
      </ul>
    </nav>


    <Fragment set:html={CONTENT} />

    <PaperHistory slug="on-a-generalization-of-substitution-permutation-networks-2019" />
  </article>
</BaseLayout>
