---
import BaseLayout from '../../layouts/BaseLayout.astro';

const EPRINT_URL = 'https://eprint.iacr.org/2019/652';
const CRAWLER = 'marker';
const CONVERTED_DATE = '2026-02-13';
---

<BaseLayout title="The Exchange Attack (2019/652)">
  <article class="max-w-4xl mx-auto article-prose">
    <nav class="mb-8">
      <a href="/papers" class="text-blue-400 hover:text-blue-300">
        &larr; Back to Papers
      </a>
    </nav>

    <!-- ============================================================ -->
    <!-- HEADER                                                       -->
    <!-- ============================================================ -->

    <header class="mb-12">
      <h1 class="text-3xl font-bold mb-4">
        The Exchange Attack: How to Distinguish Six Rounds of
        AES with
        <span class="math">2^&#123;88.2&#125;</span> Chosen
        Plaintexts
      </h1>
      <p class="text-gray-400 mb-2">
        Navid Ghaedi Bardeh, Sondre R&oslash;njom
      </p>
      <p class="text-gray-500 text-sm mb-4">
        2019 &middot; Full Version &middot; eprint 2019/652
      </p>
      <div class="flex gap-4 text-sm">
        <a
          href={EPRINT_URL}
          target="_blank"
          rel="noopener noreferrer"
          class="text-blue-400 hover:text-blue-300"
        >
          Paper (eprint) &rarr;
        </a>
      </div>
      <p class="mt-4 text-xs text-gray-500">
        All content below belongs to the original authors. This page
        reproduces the paper for educational purposes. Always
        <a
          href={EPRINT_URL}
          target="_blank"
          rel="noopener noreferrer"
          class="text-blue-400 hover:text-blue-300"
        >cite the original</a>.
      </p>
      <p class="mt-1 text-xs text-gray-600">Converted with: {CRAWLER} &middot; {CONVERTED_DATE}</p>
    </header>

    <!-- ============================================================ -->
    <!-- TABLE OF CONTENTS                                            -->
    <!-- ============================================================ -->

    <nav id="toc" class="mb-10 p-6 rounded-lg"
      style="background: rgba(255,255,255,0.03);
             border: 1px solid rgba(255,255,255,0.06);">
      <h2 class="text-lg font-bold mb-4">Table of Contents</h2>
      <ol class="space-y-1 text-sm text-gray-300
        list-decimal list-inside">
        <li>
          <a href="#abstract"
            class="hover:text-white">Abstract</a>
        </li>
        <li>
          <a href="#sec-1"
            class="hover:text-white">Introduction</a>
          <ol class="ml-6 mt-1 space-y-1 list-decimal
            list-inside text-gray-400">
            <li>
              <a href="#sec-1.1"
                class="hover:text-white">Our Contribution</a>
            </li>
            <li>
              <a href="#sec-1.2"
                class="hover:text-white">
                Overview of This Paper and Main Results</a>
            </li>
          </ol>
        </li>
        <li>
          <a href="#sec-2"
            class="hover:text-white">Preliminaries</a>
          <ol class="ml-6 mt-1 space-y-1 list-decimal
            list-inside text-gray-400">
            <li>
              <a href="#sec-2.1"
                class="hover:text-white">
                Collision and Multicollision in a Set</a>
            </li>
          </ol>
        </li>
        <li>
          <a href="#sec-3"
            class="hover:text-white">
            When Column Exchange Equals Diagonal Exchange</a>
        </li>
        <li>
          <a href="#sec-4"
            class="hover:text-white">
            The Exchange Attack on Five Rounds AES</a>
          <ol class="ml-6 mt-1 space-y-1 list-decimal
            list-inside text-gray-400">
            <li>
              <a href="#sec-4.1"
                class="hover:text-white">
                Complexity of Distinguisher</a>
            </li>
          </ol>
        </li>
        <li>
          <a href="#sec-5"
            class="hover:text-white">
            The Exchange Attack on Six Rounds AES</a>
          <ol class="ml-6 mt-1 space-y-1 list-decimal
            list-inside text-gray-400">
            <li>
              <a href="#sec-5.1"
                class="hover:text-white">
                Distinguishing Attack Algorithm for Six Rounds</a>
            </li>
            <li>
              <a href="#sec-5.2"
                class="hover:text-white">
                Complexity of Distinguisher</a>
            </li>
          </ol>
        </li>
        <li>
          <a href="#sec-6"
            class="hover:text-white">Conclusion</a>
        </li>
        <li>
          <a href="#sec-7"
            class="hover:text-white">Acknowledgments</a>
        </li>
      </ol>
      <p class="text-xs text-gray-500 mt-4 mb-1 font-semibold">
        Additional
      </p>
      <ul class="space-y-1 text-sm text-gray-400 list-disc
        list-inside">
        <li>
          <a href="#references"
            class="hover:text-white">References</a>
        </li>
      </ul>
    </nav>

    <!-- ============================================================ -->
    <!-- ABSTRACT                                                     -->
    <!-- ============================================================ -->

    <section id="abstract" class="mb-10">
      <h2 class="text-2xl font-bold">Abstract</h2>
      <p class="text-gray-300">
        In this paper we present exchange-equivalence attacks which is
        a new cryptanalytic attack technique suitable for SPN-like
        block cipher designs. Our new technique results in the first
        secret-key chosen plaintext distinguisher for 6-round AES. The
        complexity of the distinguisher is about
        <span class="math">2^&#123;88.2&#125;</span> in terms of data,
        memory and computational complexity. The distinguishing attack
        for AES reduced to six rounds is a straightforward extension
        of an exchange attack for 5-round AES that requires
        <span class="math">2^&#123;30&#125;</span> in terms of chosen
        plaintexts and computation. This is also a new record for AES
        reduced to five rounds. The main result of this paper is that
        AES up to at least six rounds is biased when restricted to
        exchange-invariant sets of plaintexts.
      </p>
      <p class="text-gray-300">
        <strong>Keywords:</strong> SPN, AES, Exchange-Equivalence
        Attacks, Exchange-Invariant Sets, Exchange-Equivalence Class,
        Secret-Key model, Differential Cryptanalysis
      </p>
    </section>

    <!-- ============================================================ -->
    <!-- 1. INTRODUCTION                                              -->
    <!-- ============================================================ -->

    <section id="sec-1" class="mb-10">
      <h2 class="text-2xl font-bold">1. Introduction</h2>
      <p class="text-gray-300">
        Block ciphers are typically designed by iterating an
        efficiently computable round function many times in the hope
        that the resulting composition behaves like a randomly drawn
        permutation. The designer is typically constrained by various
        practical criterion, e.g. security target, implementation
        boundaries, and specialized applications, that might lead the
        designer to introduce symmetries and structures into the round
        function as a compromise between efficiency and security. In
        the compromise, a round function is iterated enough times to
        make sure that any symmetries and structural properties that
        might exist in the round function vanish. Thus, a round
        function is typically designed to increasingly decorrelate with
        structure and symmetries after several rounds. However, what
        actually constitutes structure is an open question which
        requires continuous investigation as long as using randomly
        drawn codebooks is out of reach.
      </p>
      <p class="text-gray-300">
        Low data- and computational-complexity distinguishers and
        key-recovery attacks on round-reduced block ciphers have
        recently gained renewed interest in the literature. There are
        several reasons for this. In one direction cryptanalysis of
        block ciphers has focused on maximizing the number of rounds
        that can be broken without exhausting the full codebook and key
        space. This often leads to attacks marginally close to that of
        pure brute-force. These are attacks that typically have been
        improved over time based on many years of cryptanalysis. The
        most successful attacks often become de-facto standard methods
        of cryptanalysis for a particular block cipher and might
        discourage anyone from pursuing new directions in cryptanalysis
        that do not reach the same number of rounds. This in itself
        might hinder new breakthroughs, thus it can be important to
        investigate new promising ideas that might not have reached its
        full potential yet. New methods of cryptanalysis that break or
        distinguish fewer rounds faster but with lower complexity than
        established cryptanalysis is therefore interesting in this
        process. Many constructions employ reduced round AES as part of
        their design. On the other hand, reduced versions of AES have
        nice and well-studied properties that can be favorable as
        components of larger designs (see for instance Simpira [GM16]).
      </p>
      <p class="text-gray-300">
        The security of Rijndael-type block cipher designs is believed
        to be a well-studied topic and has been in the focus of a large
        group of cryptanalysts during the last 20 years (e.g. see
        [Rij97, BK00, KW02, DR06, DR07, BDD+12, DF16, GRR16]). Thus, it is rather surprising
        that new and quite fundamental results continuously appear for
        2&ndash;4 rounds of AES that enables completely new types of
        more efficient attacks for an increasing number of rounds of
        AES. At Crypto 2016, the authors of [SLG+16] presented the very
        first secret-key 5-round distinguisher for AES. Secret-key (or
        key-independent) means that the attack does not care about the
        particular round keys (e.g. in contrast to related-key
        attacks). They extend a 4-round integral property to 5 rounds
        by exploiting properties of the AES MixColumn matrix. Although
        their distinguisher requires the whole codebook, it spawned a
        series of new fundamental results for AES. It was later
        improved to
        <span class="math">2^&#123;98.2&#125;</span> chosen plaintexts
        with
        <span class="math">2^&#123;107&#125;</span> computations by
        extending a 4-round impossible differential property to a
        5-round property. Then, at Eurocrypt 2017, the authors of [GRR17]
        proposed the first 5-round secret-key chosen plaintext
        distinguisher which requires
        <span class="math">2^&#123;32&#125;</span> chosen texts with a
        computational cost of
        <span class="math">2^&#123;35.6&#125;</span> look-ups into
        memory of size
        <span class="math">2^&#123;36&#125;</span> bytes. They showed
        that by encrypting cosets of certain subspaces of the plaintext
        space the number of times the difference of ciphertext pairs
        lie in a particular subspace of the state space always is a
        multiple of 8.
      </p>
      <p class="text-gray-300">
        Later, at Asiacrypt 2017, the authors of [RBH17] presented new
        fundamental properties for Rijndael-type block cipher designs
        leading to new types of 3- to 6-round secret-key
        distinguishers for AES that beats all previous records. The
        authors introduced a new deterministic 4-round property in AES,
        which states that sets of pairs of plaintexts that are
        equivalent by exchange of any subset of diagonals encrypts to a
        set of pairs of ciphertexts after four rounds that all have a
        difference of zero in exactly the same columns before the final
        linear layer. This was further explored in [Gra18] under the name
        &ldquo;mixture cryptanalysis&rdquo;.
      </p>

      <h3 id="sec-1.1" class="text-xl font-semibold mt-8 mb-3">
        1.1 Our Contribution
      </h3>
      <p class="text-gray-300">
        The first 5-round secret-key chosen-plaintext distinguisher for
        AES was introduced at Crypto 2016, almost 20 years after
        Rijndael was first proposed as a candidate in the
        AES-competition, and required the whole codebook. In this
        paper, only three years later, we introduce the first 6-round
        secret-key distinguisher for AES that has complexity of about
        <span class="math">2^&#123;88.2&#125;</span> computations and
        ciphertexts. This is a giant leap for cryptanalysis of AES. Our
        distinguishers are based on simple techniques which are easy to
        verify theoretically and in practice. Moreover, we prove that
        AES up to at least 6 rounds is biased on exchange-invariant
        sets. The 5-round distinguisher has been practically verified
        on a scaled down version in C/C++ on a standard laptop.
      </p>

      <h3 id="sec-1.2" class="text-xl font-semibold mt-8 mb-3">
        1.2 Overview of This Paper and Main Results
      </h3>
      <p class="text-gray-300">
        In Section 2 we briefly describe results and notation that
        makes up the machinery for the rest of this paper. In
        particular, we describe what we call exchange operators,
        exchange-invariant sets and exchange-equivalence classes, and
        their relations to AES. In Section 3, we prove that five full
        rounds of AES is biased on exchange-invariant sets and in
        Section 4 and Section 5 we turn this result into simple
        distinguishers for AES reduced to five and six rounds.
      </p>
      <p class="text-gray-300">
        The currently best secret-key distinguishers for 5- and
        6-round AES are given in Table 1. We adopt that data
        complexity is measured in a minimum number of chosen
        plaintexts/ciphertexts CP/CC or adaptively chosen
        plaintexts/ciphertexts ACP/ACC. Time complexity is measured in
        equivalent number of AES encryptions (E), memory accesses (M)
        and/or XOR operations (XOR) &mdash; adopting that
        <span class="math">20M \approx 1</span> round of AES.
      </p>

      <div class="overflow-x-auto my-6">
        <table class="w-full text-sm">
          <caption class="text-gray-400 text-xs mb-2">
            Table 1: Secret-Key Distinguishers for AES
          </caption>
          <thead>
            <tr class="border-b border-gray-700">
              <th class="text-left p-2 text-gray-300">Property</th>
              <th class="text-left p-2 text-gray-300">Rounds</th>
              <th class="text-left p-2 text-gray-300">Data</th>
              <th class="text-left p-2 text-gray-300">Cost</th>
              <th class="text-left p-2 text-gray-300">Ref.</th>
            </tr>
          </thead>
          <tbody class="text-gray-400">
            <tr class="border-b border-gray-800">
              <td class="p-2">Impossible Diff</td>
              <td class="p-2">5</td>
              <td class="p-2">&mdash;</td>
              <td class="p-2">
                <span class="math">2^&#123;129.6&#125;</span> XORs
              </td>
              <td class="p-2">[SLG+16]</td>
            </tr>
            <tr class="border-b border-gray-800">
              <td class="p-2">Multiple-8</td>
              <td class="p-2">5</td>
              <td class="p-2">
                <span class="math">2^&#123;32&#125;</span> CP
              </td>
              <td class="p-2">
                <span class="math">2^&#123;35.6&#125;</span> M
              </td>
              <td class="p-2">[GRR17]</td>
            </tr>
            <tr class="border-b border-gray-800">
              <td class="p-2">Exchange Attack</td>
              <td class="p-2">5</td>
              <td class="p-2">
                <span class="math">2^&#123;30&#125;</span> CP
              </td>
              <td class="p-2">
                <span class="math">2^&#123;30&#125;</span> E
              </td>
              <td class="p-2">Sect. 4</td>
            </tr>
            <tr class="border-b border-gray-800">
              <td class="p-2">Zero difference</td>
              <td class="p-2">6</td>
              <td class="p-2">
                <span class="math">2^&#123;122.8&#125;</span> ACC
              </td>
              <td class="p-2">
                <span class="math">2^&#123;110.1&#125;</span>
              </td>
              <td class="p-2">[RBH17]</td>
            </tr>
            <tr class="border-b border-gray-800">
              <td class="p-2">Exchange Attack</td>
              <td class="p-2">6</td>
              <td class="p-2">
                <span class="math">2^&#123;88.2&#125;</span> CP
              </td>
              <td class="p-2">
                <span class="math">2^&#123;88.2&#125;</span> E
              </td>
              <td class="p-2">Sect. 5</td>
            </tr>
          </tbody>
        </table>
      </div>
    </section>

    <!-- ============================================================ -->
    <!-- 2. PRELIMINARIES                                             -->
    <!-- ============================================================ -->

    <section id="sec-2" class="mb-10">
      <h2 class="text-2xl font-bold">2. Preliminaries</h2>
      <p class="text-gray-300">
        The Advanced Encryption Standard (AES) [DR02] is the most widely
        adopted block cipher in the world today and is a critical
        component in protecting information in both commercial and
        high-assurance communication. The AES internal state is
        typically represented by a 4 by 4 matrix in
        <span class="math">\mathbb&#123;F&#125;_&#123;2^8&#125;^&#123;4 \times 4&#125;</span>.
        One full round of AES consists of SubBytes (SB), ShiftRows
        (SR), MixColumns (MC) and AddKey (AK). The SB-layer applies a
        fixed permutation over
        <span class="math">\mathbb&#123;F&#125;_&#123;2^8&#125;</span>
        independently to each byte of the state, the SR-layer
        cyclically shifts the <em>i</em>-th row by <em>i</em>
        positions, while the MC-layer applies a fixed linear
        transformation to each column. One full round is composed as
        <span class="math">R = AK \circ MC \circ SR \circ SB</span>.
        We write
        <span class="math">R^t(x)</span> to mean <em>t</em> rounds of
        AES where each round key is fixed to some random value.
      </p>

      <div class="formal-block formal-block-definition">
        <div class="formal-block-title text-blue-400">
          Definition 1
        </div>
        <div class="formal-block-content">
          <p class="text-gray-300">
            For a vector
            <span class="math">v \in \mathbb&#123;F&#125;_2^4</span>
            and a pair of states
            <span class="math">\alpha, \beta \in \mathbb&#123;F&#125;_&#123;2^8&#125;^&#123;4 \times 4&#125;</span>
            define the column exchange difference
            <span class="math">\Delta_v^&#123;\alpha,\beta&#125; \in \mathbb&#123;F&#125;_&#123;2^8&#125;^&#123;4 \times 4&#125;</span>
            where the <em>i</em>-th column is defined by
          </p>
          <div class="math-block">
            (\Delta_v^&#123;\alpha,\beta&#125;)_i = (\alpha_i \oplus \beta_i) v_i
          </div>
        </div>
      </div>

      <div class="formal-block formal-block-definition">
        <div class="formal-block-title text-blue-400">
          Definition 2 (Column exchange)
        </div>
        <div class="formal-block-content">
          <p class="text-gray-300">
            For a vector
            <span class="math">v \in \mathbb&#123;F&#125;_2^4</span>
            and a pair of states
            <span class="math">\alpha, \beta \in \mathbb&#123;F&#125;_&#123;2^8&#125;^&#123;4 \times 4&#125;</span>,
            define column exchange according to <em>v</em> as
          </p>
          <div class="math-block">
            \rho_c^v(\alpha,\beta) = \alpha \oplus \Delta_v^&#123;\alpha,\beta&#125;
          </div>
        </div>
      </div>

      <div class="formal-block formal-block-definition">
        <div class="formal-block-title text-blue-400">
          Definition 3 (Diagonal exchange)
        </div>
        <div class="formal-block-content">
          <p class="text-gray-300">
            For a vector
            <span class="math">v \in \mathbb&#123;F&#125;_2^4</span>
            and a pair of states
            <span class="math">\alpha, \beta \in \mathbb&#123;F&#125;_&#123;2^8&#125;^&#123;4 \times 4&#125;</span>,
            define diagonal exchange according to <em>v</em> as
          </p>
          <div class="math-block">
            \rho_d^v(\alpha,\beta) = \alpha \oplus SR^&#123;-1&#125;(\Delta_v^&#123;SR(\alpha),SR(\beta)&#125;)
          </div>
        </div>
      </div>

      <div class="formal-block formal-block-lemma">
        <div class="formal-block-title text-amber-400">Lemma 1</div>
        <div class="formal-block-content">
          <p class="text-gray-300">
            From the definition of
            <span class="math">\rho_d^v</span> and
            <span class="math">\rho_c^v</span> it follows that
          </p>
          <div class="math-block">
            R(\rho_d^v(\alpha, \beta)) = \rho_c^v(R(\alpha), R(\beta))
          </div>
        </div>
      </div>

      <div class="formal-block formal-block-definition">
        <div class="formal-block-title text-blue-400">
          Definition 4 (Mixed exchange)
        </div>
        <div class="formal-block-content">
          <p class="text-gray-300">
            For a vector
            <span class="math">v \in \mathbb&#123;F&#125;_2^4</span>
            and a pair of states
            <span class="math">\alpha, \beta \in \mathbb&#123;F&#125;_&#123;2^8&#125;^&#123;4 \times 4&#125;</span>
            define mixed exchange according to <em>v</em> as
          </p>
          <div class="math-block">
            \rho_m^v(\alpha,\beta) = \alpha \oplus L(\Delta_v^&#123;L^&#123;-1&#125;(\alpha),L^&#123;-1&#125;(\beta)&#125;)
          </div>
          <p class="text-gray-300">
            where
            <span class="math">L = MC \circ SR</span>.
          </p>
        </div>
      </div>

      <div class="formal-block formal-block-lemma">
        <div class="formal-block-title text-amber-400">Lemma 2</div>
        <div class="formal-block-content">
          <p class="text-gray-300">
            From the definition of
            <span class="math">\rho_c^v</span> and
            <span class="math">\rho_m^v</span> it follows that
          </p>
          <div class="math-block">
            R(\rho_c^v(\alpha, \beta)) = \rho_m^v(R(\alpha), R(\beta))
          </div>
        </div>
      </div>

      <div class="formal-block formal-block-theorem">
        <div class="formal-block-title text-green-400">Theorem 1</div>
        <div class="formal-block-content">
          <p class="text-gray-300">
            For two random states
            <span class="math">\alpha, \beta</span> and some non-zero
            vector
            <span class="math">v \in \mathbb&#123;F&#125;_2^4</span>,
            we have that
          </p>
          <div class="math-block">
            R^2(\rho_d^v(\alpha,\beta)) = \rho_m^v(R^2(\alpha),R^2(\beta))
          </div>
        </div>
      </div>

      <div class="formal-block formal-block-definition">
        <div class="formal-block-title text-blue-400">
          Definition 5
        </div>
        <div class="formal-block-content">
          <p class="text-gray-300">
            A set
            <span class="math">A \subset \mathbb&#123;F&#125;_&#123;2^8&#125;^&#123;4 \times 4&#125;</span>
            is called exchange-invariant if it satisfies
          </p>
          <div class="math-block">
            A = \&#123; \rho^v(a,b) \mid a,b \in A,\, v \in \mathbb&#123;F&#125;_2^4 \&#125;
          </div>
          <p class="text-gray-300">
            where
            <span class="math">\rho</span> is either of the three
            exchange operators.
          </p>
        </div>
      </div>

      <div class="formal-block formal-block-definition">
        <div class="formal-block-title text-blue-400">
          Definition 6
        </div>
        <div class="formal-block-content">
          <p class="text-gray-300">
            Let
            <span class="math">\alpha, \beta</span> be a pair of
            states that are different in diagonals indicated by
            <span class="math">H \subset \&#123;0,1,2,3\&#125;</span>
            and let
            <span class="math">H^* \subset H</span> denote the set
            formed by removing one element from <em>H</em>. Then we
            define the exchange-equivalence class relative to
            <span class="math">(\alpha, \beta)</span> as
          </p>
          <div class="math-block">
            S_&#123;\alpha,\beta&#125; = \&#123; (\rho_d^&#123;v^I&#125;(\alpha,\beta), \rho_d^&#123;v^I&#125;(\beta,\alpha)) \mid I \subseteq H^* \&#125;
          </div>
        </div>
      </div>

      <div class="formal-block formal-block-theorem">
        <div class="formal-block-title text-green-400">Theorem 2</div>
        <div class="formal-block-content">
          <p class="text-gray-300">
            Let
            <span class="math">A = A_0 \oplus A_1 \oplus A_2 \oplus A_3</span>
            be a diagonal exchange-invariant set and assume
            <span class="math">|A_i| = m_i</span>. Then there are
            exactly
          </p>
          <div class="math-block">
            L_t(m_0, m_1, m_2, m_3) = \sum_&#123;\substack&#123;I \subset \&#123;0,1,2,3\&#125; \\ \operatorname&#123;wt&#125;(I) = t&#125;&#125; \prod_&#123;i \in I&#125; \binom&#123;m_i&#125;&#123;2&#125; \prod_&#123;j \in \&#123;0,1,2,3\&#125; \setminus I&#125; m_j
          </div>
          <p class="text-gray-300">
            representative pairs different in exactly <em>t</em>
            diagonals, each defining a unique exchange-equivalence
            class of size
            <span class="math">2^&#123;t-1&#125;</span>.
          </p>
        </div>
      </div>

      <div class="formal-block formal-block-lemma">
        <div class="formal-block-title text-amber-400">Lemma 3</div>
        <div class="formal-block-content">
          <p class="text-gray-300">
            The number of distinct pairs of vectors in
            <span class="math">\mathbb&#123;F&#125;_2^n</span> whose
            difference has Hamming weight <em>t</em>, is given by
          </p>
          <div class="math-block">
            c(n,t) = \binom&#123;n&#125;&#123;t&#125; \cdot 2^&#123;n-1&#125;
          </div>
        </div>
      </div>

      <div class="formal-block formal-block-theorem">
        <div class="formal-block-title text-green-400">
          Theorem 3 (4-round exchange-difference relation)
        </div>
        <div class="formal-block-content">
          <p class="text-gray-300">
            Let
            <span class="math">\alpha, \beta \in \mathbb&#123;F&#125;_&#123;2^8&#125;^&#123;4 \times 4&#125;</span>
            and
            <span class="math">\alpha' = \rho_d^v(\alpha, \beta)</span>,
            <span class="math">\beta' = \rho_d^v(\beta, \alpha)</span>
            for any
            <span class="math">v \in \mathbb&#123;F&#125;_2^4</span>,
            then
          </p>
          <div class="math-block">
            \nu(R^4(\alpha) \oplus R^4(\beta)) = \nu(R^4(\alpha') \oplus R^4(\beta'))
          </div>
        </div>
      </div>

      <div class="formal-block formal-block-theorem">
        <div class="formal-block-title text-green-400">Theorem 4</div>
        <div class="formal-block-content">
          <p class="text-gray-300">
            Assume a pair of states
            <span class="math">\alpha</span> and
            <span class="math">\beta</span> with
            <span class="math">\operatorname&#123;wt&#125;(\nu(\alpha \oplus \beta)) = w_1</span>.
            Then
          </p>
          <div class="math-block">
            P(\operatorname&#123;wt&#125;(\nu(R(\alpha) \oplus R(\beta))) = w_2) = \binom&#123;4&#125;&#123;4 - w_2&#125; (2^&#123;-8&#125;)^&#123;w_1(4 - w_2)&#125;
          </div>
        </div>
      </div>

      <h3 id="sec-2.1" class="text-xl font-semibold mt-8 mb-3">
        2.1 Collision and Multicollision in a Set
      </h3>
      <p class="text-gray-300">
        The expected number of collision and multicollision in a set
        are computed in [Jou09]. Suppose <em>m</em> objects taken
        uniformly at random from a given set of size <em>N</em>. Then
        the expected number of collisions is
        <span class="math">\frac&#123;m(m-1)&#125;&#123;2N&#125;</span>.
        The expected number of multicollisions is:
      </p>
      <div class="math-block">
        s(m, N, l) = \frac&#123;\prod_&#123;i=1&#125;^&#123;l&#125; (m + 1 - i)&#125;&#123;l! \cdot N^&#123;l-1&#125;&#125;
      </div>
    </section>

    <!-- ============================================================ -->
    <!-- 3. WHEN COLUMN EXCHANGE EQUALS DIAGONAL EXCHANGE             -->
    <!-- ============================================================ -->

    <section id="sec-3" class="mb-10">
      <h2 class="text-2xl font-bold">
        3. When Column Exchange Equals Diagonal Exchange
      </h2>
      <p class="text-gray-300">
        In this section we describe the intersection of column
        exchange and diagonal exchange, i.e. the probabilistic case
        when exchange of some diagonals between a pair of plaintexts
        is equal to exchange of (possibly some other) diagonals after
        one round. We combine this with Theorem 3 to form a
        probabilistic version that instructs us how to construct a
        chosen-plaintext distinguisher for five rounds of AES.
      </p>

      <div class="formal-block formal-block-definition">
        <div class="formal-block-title text-blue-400">
          Definition 7
        </div>
        <div class="formal-block-content">
          <p class="text-gray-300">
            For a set
            <span class="math">I \subset \&#123;0,1,2,3\&#125;</span>,
            let
            <span class="math">D_I</span> denote the set of indices
            <span class="math">D_I = \&#123;(k, (k+i) \bmod 4) \mid 0 \le k &lt; 4, i \in I\&#125;</span>
            where
            <span class="math">(i,j) \in D_I</span> if the byte at
            index <span class="math">(i,j)</span> is activated by any
            of the diagonals indicated by <em>I</em>.
          </p>
        </div>
      </div>

      <div class="formal-block formal-block-definition">
        <div class="formal-block-title text-blue-400">
          Definition 8
        </div>
        <div class="formal-block-content">
          <p class="text-gray-300">
            For a
            <span class="math">J \subset \&#123;0,1,2,3\&#125;</span>,
            let
            <span class="math">C_J = \&#123;(k,i) \mid 0 \le k &lt; 4, i \in J\&#125;</span>
            denote the set of indices where the byte at position
            <span class="math">(i,j)</span> is activated by any of the
            columns indicated by <em>J</em>.
          </p>
        </div>
      </div>

      <p class="text-gray-300">
        It is easy to see that
        <span class="math">|D_I \cap C_J| = |I| \cdot |J|</span> and
        <span class="math">|D_I \cup C_J| = 4(|I| + |J|) - |I| \cdot |J|</span>.
      </p>

      <div class="formal-block formal-block-theorem">
        <div class="formal-block-title text-green-400">Theorem 5</div>
        <div class="formal-block-content">
          <p class="text-gray-300">
            Let
            <span class="math">I, J, K \subset \&#123;0,1,2,3\&#125;</span>
            and
            <span class="math">\alpha, \beta \in \mathbb&#123;F&#125;_&#123;2^8&#125;^&#123;4 \times 4&#125;</span>
            be two random states. Then the probability that exchanging
            columns <em>I</em> equals exchanging diagonals <em>J</em>
            when the difference is zero in columns <em>K</em>, is
          </p>
          <div class="math-block">
            P(|I|, |J|, |K|) = (2^&#123;-8&#125;)^&#123;4(|I|+|J|) - |K| \cdot |J| - 2|I| \cdot |J|&#125;
          </div>
        </div>
      </div>

      <div class="formal-block formal-block-theorem">
        <div class="formal-block-title text-green-400">Theorem 6</div>
        <div class="formal-block-content">
          <p class="text-gray-300">
            Let
            <span class="math">\alpha, \beta \in \mathbb&#123;F&#125;_&#123;2^8&#125;^&#123;4 \times 4&#125;</span>
            denote two plaintexts equal in
            <span class="math">|K|</span> diagonals and assume
            <span class="math">0 &lt; \operatorname&#123;wt&#125;(\nu(R^5(\alpha) \oplus R^5(\beta))) &lt; 4</span>.
            Then for a non-trivial choice of
            <span class="math">I \subset \&#123;0,1,2,3\&#125; \setminus K</span>
          </p>
          <div class="math-block">
            \nu(R^5(\alpha) \oplus R^5(\beta)) = \nu(R^5(\rho_d^&#123;v^I&#125;(\alpha, \beta)) \oplus R^5(\rho_d^&#123;v^I&#125;(\beta, \alpha)))
          </div>
          <p class="text-gray-300">
            holds with probability
          </p>
          <div class="math-block">
            P_5(|I|, |K|) = \sum_&#123;d=1&#125;^&#123;3&#125; \binom&#123;4&#125;&#123;d&#125; P(|I|, d, |K|)
          </div>
        </div>
      </div>

      <p class="text-gray-300">
        For instance, if
        <span class="math">|K| = 2</span> and
        <span class="math">|I| = 1</span>, the relation holds with
        probability
        <span class="math">P_5(1,2) \approx 2^&#123;-28.2&#125;</span>.
      </p>

      <div class="formal-block formal-block-theorem">
        <div class="formal-block-title text-green-400">Theorem 7</div>
        <div class="formal-block-content">
          <p class="text-gray-300">
            For a diagonal exchange-invariant set
            <span class="math">A = A_0 \oplus A_1 \oplus A_2 \oplus A_3</span>
            where
            <span class="math">|A_i| = m_i</span>, the expected
            number of combinations of exchange-equivalent pairs that
            also satisfy the 5-round relation is
          </p>
          <div class="math-block">
            G(m_1, m_2, m_3, m_4) = \sum_&#123;t=1&#125;^&#123;4&#125; L_t(m_1, m_2, m_3, m_4) \cdot \sum_&#123;j=1&#125;^&#123;t-1&#125; c(t-1, j) \cdot P_5(j, 4-t)
          </div>
        </div>
      </div>
    </section>

    <!-- ============================================================ -->
    <!-- 4. THE EXCHANGE ATTACK ON FIVE ROUNDS AES                    -->
    <!-- ============================================================ -->

    <section id="sec-4" class="mb-10">
      <h2 class="text-2xl font-bold">
        4. The Exchange Attack on Five Rounds AES
      </h2>
      <p class="text-gray-300">
        Theorem 6 can be used directly to show that AES limited to
        five full rounds is biased when plaintexts are closed under the
        action of diagonal exchange operations. For a random
        permutation
        <span class="math">f(x)</span>, the probability that both the
        original and exchanged ciphertext pairs satisfy the same
        column-zero pattern is
      </p>
      <div class="math-block">
        P_&#123;\text&#123;rand&#125;&#125; = \binom&#123;4&#125;&#123;d&#125; (2^&#123;32&#125;)^&#123;-(4-d)&#125; \cdot (2^&#123;32&#125;)^&#123;-(4-d)&#125;
      </div>
      <p class="text-gray-300">
        But for AES, by Theorem 6:
      </p>
      <div class="math-block">
        P_&#123;\text&#123;AES&#125;&#125; = P_&#123;\text&#123;first&#125;&#125; \cdot P_5(|I|, |K|)
      </div>
      <p class="text-gray-300">
        Setting
        <span class="math">|I| = 1</span>,
        <span class="math">|K| = 2</span> gives
        <span class="math">P_5(1,2) &gt; 2^&#123;-28.2&#125;</span>
        versus
        <span class="math">2^&#123;-32&#125;</span> for random. With
        <span class="math">m = 2^&#123;15&#125;</span>:
      </p>
      <div class="math-block">
        E_&#123;\text&#123;AES&#125;&#125; = G(m, m, 1, 1) \cdot 2^&#123;-30&#125; \approx 1
      </div>
      <div class="math-block">
        E_&#123;\text&#123;rand&#125;&#125; = H(m, m, 1, 1) \cdot 2^&#123;-62&#125; \approx 2^&#123;-4&#125;
      </div>
      <p class="text-gray-300">
        Thus, by encrypting
        <span class="math">|A| \approx 2^&#123;30&#125;</span>
        plaintexts from a diagonal exchange-invariant set, we
        distinguish AES from random.
      </p>

      <h3 id="sec-4.1" class="text-xl font-semibold mt-8 mb-3">
        4.1 Complexity of Distinguisher
      </h3>
      <p class="text-gray-300">
        The algorithm consists of two parts. In part 1, the adversary
        encrypts
        <span class="math">D = m^2 = 2^&#123;30&#125;</span>
        plaintexts and inserts indices into hash tables
        <span class="math">T_k</span>. The complexity is roughly
        <span class="math">C_&#123;\text&#123;part1&#125;&#125; \approx D</span>.
        For part 2, finding collisions:
      </p>
      <div class="math-block">
        C_&#123;\text&#123;part2&#125;&#125; = \frac&#123;4 \cdot C'_&#123;\text&#123;part2&#125;&#125;&#125;&#123;80&#125; \approx 2^&#123;25.7&#125;
      </div>
      <p class="text-gray-300">
        Hence, five rounds of AES can be distinguished with
        <span class="math">D = 2^&#123;30&#125;</span> chosen
        plaintexts and about the same computational complexity.
      </p>
    </section>

    <!-- ============================================================ -->
    <!-- 5. THE EXCHANGE ATTACK ON SIX ROUNDS AES                     -->
    <!-- ============================================================ -->

    <section id="sec-5" class="mb-10">
      <h2 class="text-2xl font-bold">
        5. The Exchange Attack on Six Rounds AES
      </h2>
      <p class="text-gray-300">
        In this section we present the first 6-round secret-key chosen
        plaintext distinguisher for AES. Assume the following two
        conditions:
      </p>
      <div class="math-block">
        \operatorname&#123;wt&#125;(\nu(R^5(p^i) \oplus R^5(p^j))) = 1
      </div>
      <div class="math-block">
        \operatorname&#123;wt&#125;(\nu(R^6(p^i) \oplus R^6(p^j))) = 1
      </div>
      <p class="text-gray-300">
        If we observe a ciphertext pair satisfying the second condition
        (probability
        <span class="math">P_&#123;R6&#125; = 2^&#123;-94&#125;</span>
        at random), then by Theorem 4 the first condition holds with
        probability
        <span class="math">P_&#123;R5&#125; = 2^&#123;-22&#125;</span>.
        By Theorem 6, the exchanged pair satisfies the same relation
        with probability
        <span class="math">P_5(3,1) \approx 2^&#123;-38&#125;</span>.
        The total probability that the exchanged pair also satisfies
        the ciphertext condition is
      </p>
      <div class="math-block">
        P_&#123;\text&#123;second&#125;&#125; = P_&#123;R5&#125; \cdot P_5(3,1) \cdot P_&#123;R6'&#125; = 2^&#123;-22&#125; \cdot 2^&#123;-38&#125; \cdot 2^&#123;-22&#125; = 2^&#123;-82&#125;
      </div>
      <p class="text-gray-300">
        Thus:
      </p>
      <div class="math-block">
        P_&#123;\text&#123;rand&#125;&#125; = 2^&#123;-94&#125; \cdot 2^&#123;-94&#125; = 2^&#123;-188&#125;
      </div>
      <div class="math-block">
        P_&#123;\text&#123;AES&#125;&#125; = 2^&#123;-94&#125; \cdot 2^&#123;-82&#125; = 2^&#123;-176&#125;
      </div>

      <div class="formal-block formal-block-theorem">
        <div class="formal-block-title text-green-400">Theorem 8</div>
        <div class="formal-block-content">
          <p class="text-gray-300">
            Let
            <span class="math">A = A_0 \oplus A_1 \oplus A_2 \oplus A_3</span>
            with
            <span class="math">|A_0| = |A_1| = |A_2| = 2^&#123;29.4&#125;</span>
            and
            <span class="math">|A_3| = 1</span> such that
            <span class="math">|A| = 2^&#123;88.2&#125;</span>. Then
          </p>
          <div class="math-block">
            E_&#123;\text&#123;AES&#125;&#125; = G(m, m, m, 1) \cdot 2^&#123;-44&#125; \cdot 2^&#123;-94&#125; \approx 1
          </div>
          <div class="math-block">
            E_&#123;\text&#123;rand&#125;&#125; = H(m, m, m, 1) \cdot 2^&#123;-94&#125; \cdot 2^&#123;-94&#125; \approx 2^&#123;-11&#125;
          </div>
        </div>
      </div>

      <h3 id="sec-5.1" class="text-xl font-semibold mt-8 mb-3">
        5.1 Distinguishing Attack Algorithm for Six Rounds
      </h3>
      <p class="text-gray-300">
        We pick three sets
        <span class="math">A_0, A_1, A_2</span>, each of size
        <span class="math">\approx 2^&#123;29.4&#125;</span>, to
        generate a diagonal exchange-invariant set of
        <span class="math">D = 2^&#123;88.2&#125;</span> plaintexts
        where the <em>i</em>-th diagonal is spanned by
        <span class="math">A_i</span> and the last diagonal is a
        random constant. The algorithm is the same as the 5-round
        distinguisher with changed parameters and collision condition.
      </p>

      <h3 id="sec-5.2" class="text-xl font-semibold mt-8 mb-3">
        5.2 Complexity of Distinguisher
      </h3>
      <p class="text-gray-300">
        The first part costs roughly
        <span class="math">C_&#123;\text&#123;part1&#125;&#125; \approx D</span>.
        For part 2, the expected complexity is
      </p>
      <div class="math-block">
        C_&#123;\text&#123;part2&#125;&#125; = \frac&#123;4 \cdot C'_&#123;\text&#123;part2&#125;&#125;&#125;&#123;96&#125; \approx 2^&#123;83.6&#125;
      </div>
      <p class="text-gray-300">
        The total complexity is dominated by
        <span class="math">D = 2^&#123;88.2&#125;</span> in data,
        memory, and computation.
      </p>
    </section>

    <!-- ============================================================ -->
    <!-- 6. CONCLUSION                                                -->
    <!-- ============================================================ -->

    <section id="sec-6" class="mb-10">
      <h2 class="text-2xl font-bold">6. Conclusion</h2>
      <p class="text-gray-300">
        In this paper we have introduced the first 6-round secret-key
        chosen-plaintext distinguisher for AES using a new type of
        attack called exchange-equivalence attacks. The distinguisher
        has data and computational complexity of only
        <span class="math">2^&#123;88.2&#125;</span> and can thus be
        viewed as a giant leap in the cryptanalysis of AES. All of our
        attacks can easily be turned into chosen ciphertext attacks on
        the inverted block cipher due to the inherent symmetry of the
        properties we are using. Our results are easily generalized to
        any SPN-like cipher, and in particular, we note that the
        theory can be generalized to extend attacks for more rounds for
        ciphers with slower diffusion (e.g. lightweight designs). We
        are confident that our results lead the way to further
        breakthroughs on ciphers such as AES.
      </p>
    </section>

    <!-- ============================================================ -->
    <!-- 7. ACKNOWLEDGMENTS                                           -->
    <!-- ============================================================ -->

    <section id="sec-7" class="mb-10">
      <h2 class="text-2xl font-bold">7. Acknowledgments</h2>
      <p class="text-gray-300">
        We thank the anonymous reviewers for their valuable comments
        and suggestions. This research was supported by the Norwegian
        Research Council.
      </p>
    </section>

    <!-- ============================================================ -->
    <!-- REFERENCES                                                   -->
    <!-- ============================================================ -->

    <section id="references" class="mb-10">
      <h2 class="text-2xl font-bold">References</h2>
      <ul class="space-y-2 text-gray-400 text-sm list-none">
        <li>
          <span class="text-gray-500">[BK00]</span>
          Biham, E., Keller, N.: Cryptanalysis of reduced variants of
          Rijndael. In: 3rd AES Conference. vol. 230 (2000)
        </li>
        <li>
          <span class="text-gray-500">[BDD+12]</span>
          Bouillaguet, C., Derbez, P., Dunkelman, O., Fouque, P.A.,
          Keller, N., Rijmen, V.: Low-data complexity attacks on AES.
          IEEE Transactions on Information Theory 58(11),
          7002&ndash;7017 (2012)
        </li>
        <li>
          <span class="text-gray-500">[DR07]</span>
          Daemen, J., Rijmen, V.: Plateau characteristics. IET
          Information Security 1, 11&ndash;17 (2007)
        </li>
        <li>
          <span class="text-gray-500">[DR02]</span>
          Daemen, J., Rijmen, V.: The design of Rijndael: AES the
          Advanced Encryption Standard. Springer (2002)
        </li>
        <li>
          <span class="text-gray-500">[DR06]</span>
          Daemen, J., Rijmen, V.: Understanding two-round differentials
          in AES. In: SCN 2006, pp. 78&ndash;94. Springer (2006)
        </li>
        <li>
          <span class="text-gray-500">[DF16]</span>
          Derbez, P., Fouque, P.A.: Automatic search of
          meet-in-the-middle and impossible differential attacks. In:
          CRYPTO 2016, pp. 157&ndash;184. Springer (2016)
        </li>
        <li>
          <span class="text-gray-500">[Gra18]</span>
          Grassi, L.: Mixture differential cryptanalysis: a new
          approach to distinguishers and attacks on round-reduced AES.
          IACR Trans. Symmetric Cryptol. 2018(2), 133&ndash;160 (2018)
          <a href="/papers/mixture-differential-aes-2017"
            class="text-blue-400 hover:text-blue-300"
          >[page on this site]</a>
        </li>
        <li>
          <span class="text-gray-500">[GRR16]</span>
          Grassi, L., Rechberger, C., R&oslash;njom, S.: Subspace
          trail cryptanalysis and its applications to AES. IACR Trans.
          Symmetric Cryptol. 2016(2), 192&ndash;225 (2016)
        </li>
        <li>
          <span class="text-gray-500">[GRR17]</span>
          Grassi, L., Rechberger, C., R&oslash;njom, S.: A new
          structural-differential property of 5-round AES. In:
          EUROCRYPT 2017, pp. 289&ndash;317. Springer (2017)
        </li>
        <li>
          <span class="text-gray-500">[GM16]</span>
          Gueron, S., Mouha, N.: Simpira v2: A family of efficient
          permutations using the AES round function. In: ASIACRYPT
          2016, pp. 95&ndash;125. Springer (2016)
        </li>
        <li>
          <span class="text-gray-500">[Jou09]</span>
          Joux, A.: Algorithmic Cryptanalysis. Chapman &amp; Hall/CRC,
          1st edn. (2009)
        </li>
        <li>
          <span class="text-gray-500">[KW02]</span>
          Knudsen, L.R., Wagner, D.: Integral cryptanalysis. In: FSE
          2002, pp. 112&ndash;127 (2002)
        </li>
        <li>
          <span class="text-gray-500">[Rij97]</span>
          Rijmen, V.: Cryptanalysis and design of iterated block
          ciphers. Doctoral Dissertation, K.U.Leuven (1997)
        </li>
        <li>
          <span class="text-gray-500">[RBH17]</span>
          R&oslash;njom, S., Bardeh, N.G., Helleseth, T.: Yoyo tricks
          with AES. In: ASIACRYPT 2017, pp. 217&ndash;243 (2017)
        </li>
        <li>
          <span class="text-gray-500">[SLG+16]</span>
          Sun, B., Liu, M., Guo, J., Qu, L., Rijmen, V.: New insights
          on AES-like SPN ciphers. In: CRYPTO 2016, pp. 605&ndash;624.
          Springer (2016)
        </li>
      </ul>
    </section>

  </article>
</BaseLayout>
