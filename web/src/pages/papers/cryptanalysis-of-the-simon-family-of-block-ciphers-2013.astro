---
import BaseLayout from '../../layouts/BaseLayout.astro';

const EPRINT_URL = 'https://eprint.iacr.org/2013/543';
const CRAWLER = 'mistral';
const CONVERTED_DATE = '2026-02-16';
const TITLE_HTML = 'Cryptanalysis of the SIMON Family of Block Ciphers';
const AUTHORS_HTML = 'Hoda A.  Alkhzaimi, Martin M.  Lauridsen';

const CONTENT = `    <p class="text-gray-300">Hoda A. Alkhzaimi and Martin M. Lauridsen</p>

    <p class="text-gray-300">DTU Compute</p>

    <p class="text-gray-300">Section for Cryptology\\<em>\\</em></p>

    <p class="text-gray-300">Department of Applied Mathematics and Computer Science</p>

    <p class="text-gray-300">Matematiktorvet, building 324</p>

    <p class="text-gray-300">{hoalk, mmeh}@dtu.dk</p>

    <p class="text-gray-300">Abstract. Recently, the U.S National Security Agency has published the specifications of two families of lightweight block ciphers, SIMON and SPECK, on ePrint [2]. The ciphers are developed with optimization towards both hardware and software in mind. While the specification paper discusses design requirements and performance of the presented lightweight ciphers thoroughly, no security assessment is given. This paper is a move towards filling that cryptanalysis gap for the SIMON family of ciphers. We present a series of observations on the presented construction that, in some cases, yield attacks, while in other cases may provide basis of further analysis by the cryptographic community. Specifically, we obtain attacks using classical- as well as truncated differentials. In the former case, we show how the smallest version of SIMON, Simon32/64, exhibits a strong differential effect.</p>

    <p class="text-gray-300">Keywords: lightweight, block cipher, Feistel, SIMON, differential cryptanalysis, impossible differentials, rotational cryptanalysis, weak keys</p>

    <p class="text-gray-300">Lightweight cryptography is a rapidly evolving and active area of research. It is driven by the need to provide security or cryptographic measures to different applications in pervasive, ubiquitous computing environments, which are widely used on resource-constrained devices. Examples of such, include mobile phones, smart cards, RFID tags and sensor networks.</p>

    <p class="text-gray-300">These lightweight cryptographic primitives are designed to be efficient, yet secure, when limited hardware resources are available. Consequently, the main motive for current efforts of constructing lightweight cryptographic primitives is to maintain a reasonable trade-off between security, efficient hardware performance and low overall cost, measured by a number of metrics. These metrics include, but are not limited to: area (in terms of gate equivalences), throughput, power/energy consumption and production cost. A number of lightweight hash functions, block ciphers and stream ciphers were developed by the research community for the purpose of obtaining a better trade-off without totally losing security. For example, lightweight block ciphers designs include, but are not limited to, HIGHT [15], ICEBERG [23], KATAN [7], KLEIN [13], LED [14], mCrypton [20], Piccolo [22], PRESENT [5], PRINCE [6], TWINE [24] and EPCBC [25].</p>

    <p class="text-gray-300">In July 2013, the NSA publicly joined these efforts by introducing the specifications of their own highly optimized lightweight block cipher families SIMON and SPECK. In comparison to other ciphers which are currently available in the field, these families are meant to have a better performance for both hardware and software platforms with respect to area needed for a given throughput, code size and memory usage.</p>

    <p class="text-gray-300">** The presented work is a result of a PhD summer school titled “Theoretical and Practical Topics in Resource-Efficient Cryptography” held in June 2013 at the Technical University of Denmark</p>

    <p class="text-gray-300">The specification document of the cipher highlights several points. First, despite the fact that the SIMON family is optimized for hardware platforms and SPECK is optimized for software platforms, both families can perform well in hardware <em>and</em> software. This means that both families can be used across the full spectrum of lightweight applications. Second, both families are meant to fill the need for secure, flexible and analyzable lightweight block ciphers.</p>

    <p class="text-gray-300">For the first point, the specification document <em>[2]</em> provides a lengthy description of the different performance results in hardware, for ASIC implementations, and in software, for 8-bit microcontrollers, for both SIMON and SPECK. Then, a comparison is made with lightweight implementations of KATAN <em>[7]</em>, KLEIN <em>[13]</em>, mCrypton <em>[20]</em>, Piccolo <em>[22]</em>, PRESENT <em>[5]</em>, TWINE <em>[24]</em>, EPCBC <em>[25]</em> and AES <em>[10]</em>. Another technical report by the NSA, prior to the specification release, presents numbers on performance <em>[1]</em>.</p>

    <p class="text-gray-300">For the second point, however, there are no specific cryptanalytic results nor analysis provided in the specification document, to support design rationale for either cipher family. This is with the exception of the mentioning that i) no related-key attacks are possible, and that ii) eliminating sliding properties in the key scheduling of SIMON has been considered.</p>

    <h4 id="sec-3" class="text-lg font-semibold mt-6">Contribution</h4>

    <p class="text-gray-300">This paper is a move toward providing an initial cryptanalytic research and results for the SIMON family of ciphers. A series of observations on the presented SIMON construction are made, some utilized into classical differential and truncated impossible differential attacks, while others may provide grounds for more analysis by the cryptographic community. The attacks that are presented follow simple chosen plaintext settings i.e. do not require chosen-ciphertext oracles or any known- chosen- or related-keys.</p>

    <p class="text-gray-300">The main contributions of this paper can be summarized in three points as follows and described in Table 1:</p>

    <ul class="list-disc list-inside space-y-1 text-gray-300 my-2 ml-4">

      <li>Differential attacks for reduced-round versions of all SIMON variants,</li>

      <li>Impossible differential attacks for reduced-round versions of most SIMON variants, and</li>

      <li>Observations regarding rotational cryptanalysis and weak key classes.</li>

    </ul>

    <h4 id="sec-4" class="text-lg font-semibold mt-6">Organization</h4>

    <p class="text-gray-300">This paper is organized into five main sections. Section 2 gives a compact description of the SIMON family of block ciphers, including key scheduling and cipher parameters. Section 3 discusses attacks using differential cryptanalysis, especially for Simon32/64. In Section 4 we present attacks on most variants of SIMON using impossible differentials arising from truncated differential analysis. In Section 5 we present further observations that have not led directly to attacks, but pose open and interesting research problems for further investigation. Finally, we conclude and propose additional further ideas for analysis of SIMON in Section 6.</p>

    <h2 id="sec-5" class="text-2xl font-bold">2 General Description of SIMON</h2>

    <p class="text-gray-300">SIMON is a family of lightweight block ciphers designed by the NSA with the aim of providing a cipher of an optimal hardware performance <em>[2]</em>. The design of SIMON is a classical Feistel scheme, operating on two <span class="math">n</span>-bit halves in each round, thus the general round block size is <span class="math">2n</span> bits. In the remainder of this paper, we use <span class="math">n</span> to refer to half the block size of the cipher, i.e. the size of the left and right branches, respectively. Each round of SIMON applies a non-linear, non-bijective hence non-invertible function <span class="math">F:\\mathbb{F}_{2}^{n}\\rightarrow\\mathbb{F}_{2}^{n}</span> to the left half of the state. The output of <span class="math">F</span> is added using XOR to the right half along with a round key, and the two halves are swapped. The function <span class="math">F</span> is defined as</p>

    <p class="text-gray-300"><span class="math">F(x)=((x\\lll 8)\\odot(x\\lll 1))\\oplus(x\\lll 2)</span></p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Cryptanalysis</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Cipher</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Rounds</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Data</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Memory</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Time</th>

          </tr>

        </thead>

        <tbody>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">Total</td>

            <td class="px-3 py-2 border-b border-gray-700">Attacked</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">Differential</td>

            <td class="px-3 py-2 border-b border-gray-700">Simon32/64</td>

            <td class="px-3 py-2 border-b border-gray-700">32</td>

            <td class="px-3 py-2 border-b border-gray-700">16</td>

            <td class="px-3 py-2 border-b border-gray-700">229.481</td>

            <td class="px-3 py-2 border-b border-gray-700">216</td>

            <td class="px-3 py-2 border-b border-gray-700">226.481</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">Simon48/72</td>

            <td class="px-3 py-2 border-b border-gray-700">36</td>

            <td class="px-3 py-2 border-b border-gray-700">18</td>

            <td class="px-3 py-2 border-b border-gray-700">246.423</td>

            <td class="px-3 py-2 border-b border-gray-700">224</td>

            <td class="px-3 py-2 border-b border-gray-700">243.253</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">Simon48/96</td>

            <td class="px-3 py-2 border-b border-gray-700">36</td>

            <td class="px-3 py-2 border-b border-gray-700">18</td>

            <td class="px-3 py-2 border-b border-gray-700">246.423</td>

            <td class="px-3 py-2 border-b border-gray-700">224</td>

            <td class="px-3 py-2 border-b border-gray-700">243.253</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">Simon64/96</td>

            <td class="px-3 py-2 border-b border-gray-700">42</td>

            <td class="px-3 py-2 border-b border-gray-700">24</td>

            <td class="px-3 py-2 border-b border-gray-700">262.012</td>

            <td class="px-3 py-2 border-b border-gray-700">232</td>

            <td class="px-3 py-2 border-b border-gray-700">258.427</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">Simon64/128</td>

            <td class="px-3 py-2 border-b border-gray-700">44</td>

            <td class="px-3 py-2 border-b border-gray-700">24</td>

            <td class="px-3 py-2 border-b border-gray-700">262.012</td>

            <td class="px-3 py-2 border-b border-gray-700">232</td>

            <td class="px-3 py-2 border-b border-gray-700">258.427</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">Simon96/92</td>

            <td class="px-3 py-2 border-b border-gray-700">52</td>

            <td class="px-3 py-2 border-b border-gray-700">29</td>

            <td class="px-3 py-2 border-b border-gray-700">287.532</td>

            <td class="px-3 py-2 border-b border-gray-700">248</td>

            <td class="px-3 py-2 border-b border-gray-700">283.674</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">Simon96/144</td>

            <td class="px-3 py-2 border-b border-gray-700">54</td>

            <td class="px-3 py-2 border-b border-gray-700">29</td>

            <td class="px-3 py-2 border-b border-gray-700">287.532</td>

            <td class="px-3 py-2 border-b border-gray-700">248</td>

            <td class="px-3 py-2 border-b border-gray-700">283.674</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">Simon128/128</td>

            <td class="px-3 py-2 border-b border-gray-700">68</td>

            <td class="px-3 py-2 border-b border-gray-700">40</td>

            <td class="px-3 py-2 border-b border-gray-700">2124.796</td>

            <td class="px-3 py-2 border-b border-gray-700">264</td>

            <td class="px-3 py-2 border-b border-gray-700">2120.474</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">Simon128/192</td>

            <td class="px-3 py-2 border-b border-gray-700">69</td>

            <td class="px-3 py-2 border-b border-gray-700">40</td>

            <td class="px-3 py-2 border-b border-gray-700">2124.796</td>

            <td class="px-3 py-2 border-b border-gray-700">264</td>

            <td class="px-3 py-2 border-b border-gray-700">2120.474</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">Simon128/256</td>

            <td class="px-3 py-2 border-b border-gray-700">72</td>

            <td class="px-3 py-2 border-b border-gray-700">40</td>

            <td class="px-3 py-2 border-b border-gray-700">2124.796</td>

            <td class="px-3 py-2 border-b border-gray-700">264</td>

            <td class="px-3 py-2 border-b border-gray-700">2120.474</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">Impossible</td>

            <td class="px-3 py-2 border-b border-gray-700">Simon32/64</td>

            <td class="px-3 py-2 border-b border-gray-700">32</td>

            <td class="px-3 py-2 border-b border-gray-700">14</td>

            <td class="px-3 py-2 border-b border-gray-700">233.291</td>

            <td class="px-3 py-2 border-b border-gray-700">229.203</td>

            <td class="px-3 py-2 border-b border-gray-700">244.183</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">Differential</td>

            <td class="px-3 py-2 border-b border-gray-700">Simon48/72</td>

            <td class="px-3 py-2 border-b border-gray-700">36</td>

            <td class="px-3 py-2 border-b border-gray-700">15</td>

            <td class="px-3 py-2 border-b border-gray-700">250.262</td>

            <td class="px-3 py-2 border-b border-gray-700">245.618</td>

            <td class="px-3 py-2 border-b border-gray-700">269.079</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">Simon48/96</td>

            <td class="px-3 py-2 border-b border-gray-700">36</td>

            <td class="px-3 py-2 border-b border-gray-700">15</td>

            <td class="px-3 py-2 border-b border-gray-700">250.262</td>

            <td class="px-3 py-2 border-b border-gray-700">245.618</td>

            <td class="px-3 py-2 border-b border-gray-700">269.079</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">Simon64/96</td>

            <td class="px-3 py-2 border-b border-gray-700">42</td>

            <td class="px-3 py-2 border-b border-gray-700">16</td>

            <td class="px-3 py-2 border-b border-gray-700">265.248</td>

            <td class="px-3 py-2 border-b border-gray-700">260.203</td>

            <td class="px-3 py-2 border-b border-gray-700">291.986</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">Simon64/128</td>

            <td class="px-3 py-2 border-b border-gray-700">44</td>

            <td class="px-3 py-2 border-b border-gray-700">16</td>

            <td class="px-3 py-2 border-b border-gray-700">265.248</td>

            <td class="px-3 py-2 border-b border-gray-700">260.203</td>

            <td class="px-3 py-2 border-b border-gray-700">291.986</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">Simon96/92</td>

            <td class="px-3 py-2 border-b border-gray-700">52</td>

            <td class="px-3 py-2 border-b border-gray-700">19</td>

            <td class="px-3 py-2 border-b border-gray-700">297.233</td>

            <td class="px-3 py-2 border-b border-gray-700">291.618</td>

            <td class="px-3 py-2 border-b border-gray-700">2139.738†</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">Simon96/144</td>

            <td class="px-3 py-2 border-b border-gray-700">54</td>

            <td class="px-3 py-2 border-b border-gray-700">19</td>

            <td class="px-3 py-2 border-b border-gray-700">297.233</td>

            <td class="px-3 py-2 border-b border-gray-700">291.618</td>

            <td class="px-3 py-2 border-b border-gray-700">2139.738</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">Simon128/128</td>

            <td class="px-3 py-2 border-b border-gray-700">68</td>

            <td class="px-3 py-2 border-b border-gray-700">22</td>

            <td class="px-3 py-2 border-b border-gray-700">2129.226</td>

            <td class="px-3 py-2 border-b border-gray-700">2123.203</td>

            <td class="px-3 py-2 border-b border-gray-700">2187.527†</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">Simon128/192</td>

            <td class="px-3 py-2 border-b border-gray-700">69</td>

            <td class="px-3 py-2 border-b border-gray-700">22</td>

            <td class="px-3 py-2 border-b border-gray-700">2129.226</td>

            <td class="px-3 py-2 border-b border-gray-700">2123.203</td>

            <td class="px-3 py-2 border-b border-gray-700">2187.527</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">Simon128/256</td>

            <td class="px-3 py-2 border-b border-gray-700">72</td>

            <td class="px-3 py-2 border-b border-gray-700">22</td>

            <td class="px-3 py-2 border-b border-gray-700">2129.226</td>

            <td class="px-3 py-2 border-b border-gray-700">2123.203</td>

            <td class="px-3 py-2 border-b border-gray-700">2187.527</td>

          </tr>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">Table 1: Summary of our cryptanalytic results on SIMON. Note, that entries with a  <span class="math">\\dagger</span>  in the complexity column indicate results which are worse than brute-force search. The parameters for impossible differentials are such, that the expected fraction of remaining keys after the attack is  <span class="math">1\\%</span> .</p>

    <p class="text-gray-300">where  <span class="math">x \\ll j</span>  denotes left rotation of  <span class="math">x</span>  by  <span class="math">j</span>  positions and  <span class="math">\\odot</span>  is binary AND. A single round of SIMON is depicted in Figure 1.</p>

    <p class="text-gray-300">!<a href="img-0.jpeg">img-0.jpeg</a> Fig. 1: The SIMON round function</p>

    <p class="text-gray-300">Variants of SIMON exist for different parameters of key size, block size and number of rounds. The name of each SIMON variant with its parameters are presented in Table 2.</p>

    <p class="text-gray-300">The key schedule of SIMON is described as a function that will operate on two, three or four  <span class="math">n</span> -bit word registers, depending on the size of the master key. It performs two rotations to the right by  <span class="math">x \\gg 3</span>  and  <span class="math">x \\gg 1</span>  and XOR the results together with a fixed constant  <span class="math">c</span>  and five constant</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Cipher</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Block size 2n</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Key words m</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Key size mn</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Rounds T</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Index to z j</th>

          </tr>

        </thead>

        <tbody>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">Simon32/64</td>

            <td class="px-3 py-2 border-b border-gray-700">32</td>

            <td class="px-3 py-2 border-b border-gray-700">4</td>

            <td class="px-3 py-2 border-b border-gray-700">64</td>

            <td class="px-3 py-2 border-b border-gray-700">32</td>

            <td class="px-3 py-2 border-b border-gray-700">0</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">Simon48/72</td>

            <td class="px-3 py-2 border-b border-gray-700">48</td>

            <td class="px-3 py-2 border-b border-gray-700">3</td>

            <td class="px-3 py-2 border-b border-gray-700">72</td>

            <td class="px-3 py-2 border-b border-gray-700">36</td>

            <td class="px-3 py-2 border-b border-gray-700">0</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">Simon48/96</td>

            <td class="px-3 py-2 border-b border-gray-700">48</td>

            <td class="px-3 py-2 border-b border-gray-700">4</td>

            <td class="px-3 py-2 border-b border-gray-700">96</td>

            <td class="px-3 py-2 border-b border-gray-700">36</td>

            <td class="px-3 py-2 border-b border-gray-700">1</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">Simon64/96</td>

            <td class="px-3 py-2 border-b border-gray-700">64</td>

            <td class="px-3 py-2 border-b border-gray-700">3</td>

            <td class="px-3 py-2 border-b border-gray-700">96</td>

            <td class="px-3 py-2 border-b border-gray-700">42</td>

            <td class="px-3 py-2 border-b border-gray-700">2</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">Simon64/128</td>

            <td class="px-3 py-2 border-b border-gray-700">64</td>

            <td class="px-3 py-2 border-b border-gray-700">4</td>

            <td class="px-3 py-2 border-b border-gray-700">128</td>

            <td class="px-3 py-2 border-b border-gray-700">44</td>

            <td class="px-3 py-2 border-b border-gray-700">3</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">Simon96/92</td>

            <td class="px-3 py-2 border-b border-gray-700">96</td>

            <td class="px-3 py-2 border-b border-gray-700">2</td>

            <td class="px-3 py-2 border-b border-gray-700">92</td>

            <td class="px-3 py-2 border-b border-gray-700">52</td>

            <td class="px-3 py-2 border-b border-gray-700">2</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">Simon96/144</td>

            <td class="px-3 py-2 border-b border-gray-700">96</td>

            <td class="px-3 py-2 border-b border-gray-700">3</td>

            <td class="px-3 py-2 border-b border-gray-700">144</td>

            <td class="px-3 py-2 border-b border-gray-700">54</td>

            <td class="px-3 py-2 border-b border-gray-700">3</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">Simon128/128</td>

            <td class="px-3 py-2 border-b border-gray-700">128</td>

            <td class="px-3 py-2 border-b border-gray-700">2</td>

            <td class="px-3 py-2 border-b border-gray-700">128</td>

            <td class="px-3 py-2 border-b border-gray-700">68</td>

            <td class="px-3 py-2 border-b border-gray-700">2</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">Simon128/192</td>

            <td class="px-3 py-2 border-b border-gray-700">128</td>

            <td class="px-3 py-2 border-b border-gray-700">3</td>

            <td class="px-3 py-2 border-b border-gray-700">192</td>

            <td class="px-3 py-2 border-b border-gray-700">69</td>

            <td class="px-3 py-2 border-b border-gray-700">3</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">Simon128/256</td>

            <td class="px-3 py-2 border-b border-gray-700">128</td>

            <td class="px-3 py-2 border-b border-gray-700">4</td>

            <td class="px-3 py-2 border-b border-gray-700">256</td>

            <td class="px-3 py-2 border-b border-gray-700">72</td>

            <td class="px-3 py-2 border-b border-gray-700">4</td>

          </tr>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">Table 2: Members of the SIMON family with their parameters</p>

    <p class="text-gray-300">sequences  <span class="math">z_{j}^{i}</span>  which are version-dependent. These constant sequences are obtained by using three  <span class="math">5 \\times 5</span>  matrices over  <span class="math">\\mathbb{F}_2</span> , and a linear feedback shift register where the first two are of period 31 and the last three are of period 62. The specification rationalizes the use of these constants as a mean of eliminating sliding properties and circular shift symmetries between the different rounds keys. Furthermore, they are used to provide cryptographic separation between different variants of SIMON that have the same block size, but with different key sizes.</p>

    <p class="text-gray-300">Figure 2 describes the general function of SIMON key scheduling. The  <span class="math">m</span>  master key words, each of  <span class="math">n</span>  bits where  <span class="math">m \\in \\{2,3,4\\}</span> , are used at the first iterations of key scheduling, and hence the first  <span class="math">mn</span>  round key bits equal the master key.</p>

    <p class="text-gray-300">Depending on  <span class="math">m</span> , the key schedule varies slightly, c.f. Figure 2. The value  <span class="math">c</span>  is a constant equal to  <span class="math">(2^n - 1) \\oplus 3</span> , i.e. a string of  <span class="math">n - 2</span>  ones and two zeroes on the least significant two bits. The value  <span class="math">z_j^i</span>  is the  <span class="math">i</span> th bit (from most significant to least significant, where  <span class="math">i</span>  is computed modulo  <span class="math">n</span> ) of  <span class="math">z_j</span> , where  <span class="math">z_j</span>  is from Table 3 and  <span class="math">j</span>  is a parameter of the cipher, c.f. Table 2.</p>

    <p class="text-gray-300">!<a href="img-1.jpeg">img-1.jpeg</a> (a)  <span class="math">m = 2</span>  key words</p>

    <p class="text-gray-300">!<a href="img-2.jpeg">img-2.jpeg</a> (b)  <span class="math">m = 3</span>  key words Fig. 2: The SIMON key schedule for cases  <span class="math">m \\in \\{2,3,4\\}</span> . The computation on round key  <span class="math">k_{i}</span>  depends on  <span class="math">k_{i-1}</span>  and  <span class="math">k_{i-m}</span> , and also  <span class="math">k_{i-m+1}</span>  in the case of  <span class="math">m = 4</span> .</p>

    <p class="text-gray-300">!<a href="img-3.jpeg">img-3.jpeg</a> (c)  <span class="math">m = 4</span>  key words</p>

    <p class="text-gray-300">Differential cryptanalysis is mainly a chosen plaintext attack that is considered one of the most utilized tools in achieving favourable attack results on different cryptographic primitives. It has been initially identified by the designers of Data Encryption Standard (DES) in [8] and was later</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">j</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">zj</th>

          </tr>

        </thead>

        <tbody>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">0</td>

            <td class="px-3 py-2 border-b border-gray-700">11111010001001010110000111001101111101000100101011000011100110</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">1</td>

            <td class="px-3 py-2 border-b border-gray-700">10001110111110010011000010110101000111011111001001100001011010</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">2</td>

            <td class="px-3 py-2 border-b border-gray-700">10101111011100000011010010011000101000010001111110010110110011</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">3</td>

            <td class="px-3 py-2 border-b border-gray-700">11011011101011000110010111100000010010001010011100110100001111</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">4</td>

            <td class="px-3 py-2 border-b border-gray-700">11010001111001101011011000100000010111000011001010010011101111</td>

          </tr>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">Table 3: The  <span class="math">z_{j}</span>  vectors used in the SIMON key schedule</p>

    <p class="text-gray-300">invented and published by Biham and Shamir in [4]. The key goal is to trace the input/output difference propagation through the cipher structure, for a specific number of rounds, and detect the non-random behaviour exhibited in the final output, with a certain success probability. The differential property can be utilized to recover the (parts of) a sub-key, typically the first or the last, in a reduced  <span class="math">r</span> -round version of the cipher. Several chosen plaintext pairs are used, in a combination with trying all candidates for the sub-key under attack, and the expected net result is that the correct sub-key is suggested more frequently than the wrong ones, allowing the attacker to tell which is correct.</p>

    <p class="text-gray-300">First, we discuss iterated differentials, i.e. differentials using the same input/output difference. For the SIMON family of block ciphers, we are interested in one of two properties of  <span class="math">F</span>  for constructing the iterated differentials. Firstly, we consider pairs of  <span class="math">n</span> -bit differences  <span class="math">(a,b)</span> , for which the combined probability  <span class="math">\\operatorname<em>{Pr}(a\\to b)\\cdot \\operatorname</em>{Pr}(b\\to a)</span>  is maximized. Here,  <span class="math">\\operatorname<em>{Pr}(a\\to b)</span>  denotes the probability that a difference  <span class="math">a</span>  goes to a difference  <span class="math">b</span>  over the function  <span class="math">F</span> , taken over all inputs. We refer to this as a type-1 iterated characteristic. Secondly, we may consider looking for a characteristic using a single difference  <span class="math">a</span> , for which  <span class="math">\\operatorname</em>{Pr}(a\\to a)</span>  is maximized. We refer to this as a type-2 iterated characteristic.</p>

    <p class="text-gray-300">For type-1 characteristics, we can construct a 6-round iterative characteristic, while for type-2 we get a similar 3-round characteristic. Both are shown in Figure 3.</p>

    <p class="text-gray-300">Difference Distribution Table For block ciphers using a Substitution Permutation Network (SPN) design structure, a common method for obtaining a non-linearity is to use parallel applications of small  <span class="math">b</span> -bit S-Boxes. In this case, the output difference on  <span class="math">b</span>  consecutive bits depends solely on the input difference on the corresponding  <span class="math">b</span>  bits. As such, a difference distribution table for the whole non-linear component can be derived directly from the corresponding table for the S-Box. For the function  <span class="math">F</span>  used in SIMON there is no S-Box, and in general a single bit of the output difference  <span class="math">\\Delta y</span>  depends on 2 bits of the input  <span class="math">x</span>  and 3 bits of the input difference  <span class="math">\\Delta x</span> , by the relation</p>

    <div class="my-4 text-center"><span class="math-block">\\Delta y _ {i} = x _ {i - 1} \\cdot \\Delta x _ {i - 8} \\oplus \\Delta x _ {i - 1} \\cdot x _ {i - 8} \\oplus \\Delta x _ {i - 1} \\cdot \\Delta x _ {i - 8} \\oplus \\Delta x _ {i - 2},</span></div>

    <p class="text-gray-300">where all indices are computed modulo  <span class="math">n</span> . As such, constructing the difference distribution table requires  <span class="math">O(2^{2n})</span>  memory and has the same complexity. Thus, for  <span class="math">n = 16</span> , this requires 8 GB of memory using an unsigned 16-bit data type for the entries.</p>

    <p class="text-gray-300">For  <span class="math">n = 16</span> , we construct the table exhaustively and determine the best pairs  <span class="math">(a, b)</span>  as above for the type-1 characteristic. The best pairs  <span class="math">(a, b)</span>  yield a probability</p>

    <div class="my-4 text-center"><span class="math-block">\\begin{array}{l} \\Pr (a \\rightarrow b) \\cdot \\Pr (b \\rightarrow a) = \\frac {2 5 6}{2 ^ {1 6}} \\cdot \\frac {2 0 4 8}{2 ^ {1 6}} \\\\ = 2 ^ {- 1 3}. \\\\ \\end{array}</span></div>

    <p class="text-gray-300">!<a href="img-4.jpeg">img-4.jpeg</a> (a) A 6-round iterated characteristic using two input/output relations Fig. 3: Type-1 and type-2 iterated differential characteristics for SIMON</p>

    <p class="text-gray-300">!<a href="img-5.jpeg">img-5.jpeg</a> (b) A 3-round iterated characteristic using a single input/output relation</p>

    <p class="text-gray-300">If we square this probability, we find that  <span class="math">2^{-26}</span>  is the probability of the 6-round type-1 characteristic shown in Figure 3, using those  <span class="math">(a,b)</span>  pairs. The pairs are listed in Table 4.</p>

    <p class="text-gray-300">As the type-1 characteristic uses only the difference  <span class="math">a</span>  in the input/output, we may instead think of it as a 6-round differential, where the difference  <span class="math">b</span>  can take on any possible value. As such, we can search for the best difference  <span class="math">a</span> , s.t.</p>

    <div class="my-4 text-center"><span class="math-block">\\sum_ {b \\in \\mathbb {F} _ {2} ^ {n}} \\Pr (a \\rightarrow b) \\cdot \\Pr (b \\rightarrow a)</span></div>

    <p class="text-gray-300">is maximized. Doing so, we find that for  <span class="math">n = 16</span>  there are four best such differences,  <span class="math">a \\in \\{1111, 2222, 4444, 8888\\}</span> .</p>

    <p class="text-gray-300">These represent 3-round differentials of probability  <span class="math">2^{-11.19}</span> , where we do not care about the intermediate differences, i.e. the type-2 characteristics considered as differentials. When putting two such differentials together, we get a 6-round differential of probability at least  <span class="math">2^{-2 \\cdot 11.19} = 2^{-22.38}</span>  which is similar to the type-1 characteristic considered as a differential, except that after 3 rounds we know the difference is  <span class="math">(a \\parallel 0)</span> .</p>

    <p class="text-gray-300">For  <span class="math">n &amp;gt; 16</span> , the memory and complexity required renders constructing the difference distribution table infeasible. However, a method by Dinur et al. which was presented at the Eurocrypt 2013 rump session [12] computes the diagonal of the difference distribution table using  <span class="math">O(2^n)</span>  memory and complexity. Thus, we can use this method to obtain results for  <span class="math">n = 24</span>  as well. The diagonal entries of the difference distribution table represent the iterative characteristics  <span class="math">a \\to a</span> .</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">a</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">b</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">log2(Pr(a→b))</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">log2(Pr(b→a))</th>

          </tr>

        </thead>

        <tbody>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">0045</td>

            <td class="px-3 py-2 border-b border-gray-700">051e</td>

            <td class="px-3 py-2 border-b border-gray-700">-5</td>

            <td class="px-3 py-2 border-b border-gray-700">-8</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">008a</td>

            <td class="px-3 py-2 border-b border-gray-700">0a3c</td>

            <td class="px-3 py-2 border-b border-gray-700">-5</td>

            <td class="px-3 py-2 border-b border-gray-700">-8</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">0114</td>

            <td class="px-3 py-2 border-b border-gray-700">1478</td>

            <td class="px-3 py-2 border-b border-gray-700">-5</td>

            <td class="px-3 py-2 border-b border-gray-700">-8</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">0228</td>

            <td class="px-3 py-2 border-b border-gray-700">28f0</td>

            <td class="px-3 py-2 border-b border-gray-700">-5</td>

            <td class="px-3 py-2 border-b border-gray-700">-8</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">028f</td>

            <td class="px-3 py-2 border-b border-gray-700">8022</td>

            <td class="px-3 py-2 border-b border-gray-700">-8</td>

            <td class="px-3 py-2 border-b border-gray-700">-5</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">0450</td>

            <td class="px-3 py-2 border-b border-gray-700">51e0</td>

            <td class="px-3 py-2 border-b border-gray-700">-5</td>

            <td class="px-3 py-2 border-b border-gray-700">-8</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">08a0</td>

            <td class="px-3 py-2 border-b border-gray-700">a3c0</td>

            <td class="px-3 py-2 border-b border-gray-700">-5</td>

            <td class="px-3 py-2 border-b border-gray-700">-8</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">1140</td>

            <td class="px-3 py-2 border-b border-gray-700">4781</td>

            <td class="px-3 py-2 border-b border-gray-700">-5</td>

            <td class="px-3 py-2 border-b border-gray-700">-8</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">1401</td>

            <td class="px-3 py-2 border-b border-gray-700">7814</td>

            <td class="px-3 py-2 border-b border-gray-700">-5</td>

            <td class="px-3 py-2 border-b border-gray-700">-8</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">1e05</td>

            <td class="px-3 py-2 border-b border-gray-700">4500</td>

            <td class="px-3 py-2 border-b border-gray-700">-8</td>

            <td class="px-3 py-2 border-b border-gray-700">-5</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">2280</td>

            <td class="px-3 py-2 border-b border-gray-700">8f02</td>

            <td class="px-3 py-2 border-b border-gray-700">-5</td>

            <td class="px-3 py-2 border-b border-gray-700">-8</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">2802</td>

            <td class="px-3 py-2 border-b border-gray-700">f028</td>

            <td class="px-3 py-2 border-b border-gray-700">-5</td>

            <td class="px-3 py-2 border-b border-gray-700">-8</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">3c0a</td>

            <td class="px-3 py-2 border-b border-gray-700">8a00</td>

            <td class="px-3 py-2 border-b border-gray-700">-8</td>

            <td class="px-3 py-2 border-b border-gray-700">-5</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">4011</td>

            <td class="px-3 py-2 border-b border-gray-700">8147</td>

            <td class="px-3 py-2 border-b border-gray-700">-5</td>

            <td class="px-3 py-2 border-b border-gray-700">-8</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">5004</td>

            <td class="px-3 py-2 border-b border-gray-700">e051</td>

            <td class="px-3 py-2 border-b border-gray-700">-5</td>

            <td class="px-3 py-2 border-b border-gray-700">-8</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">a008</td>

            <td class="px-3 py-2 border-b border-gray-700">c0a3</td>

            <td class="px-3 py-2 border-b border-gray-700">-5</td>

            <td class="px-3 py-2 border-b border-gray-700">-8</td>

          </tr>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">The algorithm uses a hash table  <span class="math">M</span>  which maps values  <span class="math">x \\oplus F(x)</span>  to a list holding the  <span class="math">x</span>  values giving this difference.  <span class="math">M</span>  is constructed by iterating over all  <span class="math">x \\in \\mathbb{F}_2^n</span> . After this, any pair of distinct  <span class="math">x, x&#x27;</span>  in the list associated with the same key in  <span class="math">M</span> , are values s.t.  <span class="math">x \\oplus F(x) = x&#x27; \\oplus F(x&#x27;)</span> , or in other words,  <span class="math">\\Delta = x \\oplus x&#x27;</span>  is the diagonal entry under consideration. However, to compute the actual differential probability, we must again iterate over all  <span class="math">x \\in \\mathbb{F}_2^n</span>  and check how many times  <span class="math">F(x) \\oplus F(x \\oplus \\Delta) = \\Delta</span> .</p>

    <p class="text-gray-300">For  <span class="math">n = 16</span>  and  <span class="math">n = 24</span> , we obtain a list of best diagonal differential probabilities, presented in Table 5.</p>

    <p class="text-gray-300">Table 4: Best possible  <span class="math">(a,b)</span>  pairs for type-1 differential characteristics obtained for Simon32/64</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">n</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">p</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Differences</th>

          </tr>

        </thead>

        <tbody>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">16</td>

            <td class="px-3 py-2 border-b border-gray-700">2-8</td>

            <td class="px-3 py-2 border-b border-gray-700">5555, aaaa, ac0e, 1d58, ab03, 581d, 3ab0, 6075, 5607, 0eac, b03a, 7560, c0ea, 03ab, eac0, 81d5, 0756, d581</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">24</td>

            <td class="px-3 py-2 border-b border-gray-700">2-12</td>

            <td class="px-3 py-2 border-b border-gray-700">555555, aaaaaa, 0e22ac, 1c4558, 388ab0, 711560, c45581, e22ac0, 88ab03, 115607, 22ac0e, 45581c, ab0388, b0388a, 560711, 8ab038...</td>

          </tr>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">Table 5: Best diagonal entries of the difference distribution table for  <span class="math">n \\in  \\{ {16},{24}\\}</span></p>

    <p class="text-gray-300">It is evident from Table 5 that already for  <span class="math">n = 16</span> ,  <span class="math">\\operatorname{Pr}(\\Delta \\to \\Delta)</span> , for some difference  <span class="math">\\Delta</span> , is very low, and will not lead to any good differential characteristic using this method. The table suggests that the best probability for a diagonal entry is  <span class="math">2^{-n/2}</span> . Thus, the probability paid for such characteristic would be too low, even for two iterations of the type-2 characteristic, as the number of plaintext pairs needed for the attack would exceed the possible number of plaintext pairs,  <span class="math">2^{2n}</span> .</p>

    <h3 id="sec-8" class="text-xl font-semibold mt-8">3.1 Input/Output Differences over <span class="math">\\boldsymbol{F}</span></h3>

    <p class="text-gray-300">For SIMON, consider an <span class="math">n</span>-bit input difference <span class="math">\\alpha=x\\oplus x^{\\prime}</span> to <span class="math">F</span> of Hamming weight one. As the <span class="math">\\oplus</span> operation is invariant with respect to rotation, say w.l.o.g. that <span class="math">\\alpha=(0\\cdots 01)</span>. Recall that <span class="math">F(x)</span> left rotates <span class="math">x</span> by eight and one positions respectively, applies binary AND to those two, and to the result of that XORs the left rotation of <span class="math">x</span> by two positions. Due to the rotation by two and the XOR, the output difference <span class="math">F(x)\\oplus F(x^{\\prime})</span> will, for this particular <span class="math">\\alpha</span>, have a ’1’ on position 2. Also, on positions 1 and 8. There <em>may</em> be a ’1’ in the output difference (in fact each case occurs, on both bits independently, with probability <span class="math">\\frac{1}{2}</span>). As the <span class="math">\\odot</span> operation is non-linear with respect to differences, this depends on the actual inputs <span class="math">x</span> and <span class="math">x^{\\prime}</span>. We may describe the output difference in truncated form as <span class="math">(0\\cdots 0<em>000001</em>0)</span>. Here, an asterisk denotes an unknown bit.</p>

    <p class="text-gray-300">This approach of determining a truncated mask captures all possible output differences can be generalized to arbitrary input differences, and each time we put an asterisk on a position we lose certainty about that particular bit of the output difference. Note, that this also provides a means of determining all possible output difference, given some input difference, which in general is very useful for differential analysis. We will use this observation in the following section, and when we consider impossible differentials in Section 4.</p>

    <h3 id="sec-9" class="text-xl font-semibold mt-8">3.2 Branch-and-Bound Approach to Differentials</h3>

    <p class="text-gray-300">Given a way of determining the possible output differences, along with their probabilities, when using a fixed input difference <span class="math">\\alpha</span>, one can think of a tree where each difference at reach round spawns several possible output differences.</p>

    <p class="text-gray-300">Besides fixing an input difference <span class="math">\\alpha</span>, we fix a number of rounds to <span class="math">r</span> for which we search for differentials. Starting with <span class="math">\\alpha</span>, we progress in a depth-first manner, searching through characteristics until we reach round <span class="math">r</span>. At that point, we add the characteristic probability to the output difference <span class="math">\\beta</span> in a lookup table. At the same time, we keep running score of the best seen output difference, for the fixed <span class="math">\\alpha</span>, in terms of differential probability.</p>

    <p class="text-gray-300">Using this approach gives us the best results on differential probabilities. Naturally, one can not hope to exhaustively try all input differences and still look through much of the tree. To that end, we maintain an array containing the best characteristic probability seen, for each level of tree, corresponding to each number of rounds <span class="math">1,\\ldots,r</span>. We bound the search at round <span class="math">i</span> by allowing it only to go to round <span class="math">i+1</span> if the computed characteristic probability for level <span class="math">i+1</span> is within some fraction away from the best observed probability, which is stored in the array. Otherwise, we cut off that part of the tree and backtrack to the previous round. The constant fraction used in the bounding, giving the best results, is determined experimentally for each variant of SIMON. Note, that this method of cutting off sub-trees helps keep the Hamming weight of the differences low. Furthermore, we considered only input differences of low Hamming weight, as these intuitively have less possible output differences in the beginning, which are also of low Hamming weight.</p>

    <p class="text-gray-300">As such, we can not claim to have found the best differentials for any of the variants, but our results certainly do provide lower bounds. A summary of the attack parameters and complexities can be found in Table 1.</p>

    <h3 id="sec-10" class="text-xl font-semibold mt-8">3.3 Differential Effect</h3>

    <p class="text-gray-300">Using the branch-and-bound method described in Section 3.2, we are able, due to the small block size of Simon32/64, for a given number of rounds of the cipher to determine lower bounds on the <em>Expected Differential Probability</em> (EDP), which is defined in the following way, c.f. <em>[11, 9]</em></p>

    <p class="text-gray-300"><span class="math">\\text{EDP}(\\alpha,\\beta)=2^{-n}\\sum_{k\\in\\mathbb{F}_{2}^{n}}\\text{DP}_{k}(\\alpha,\\beta),</span> (1)</p>

    <p class="text-gray-300">where</p>

    <p class="text-gray-300">where  <span class="math">\\mathrm{DP}_k(\\alpha, \\beta)</span>  is the differential probability for input difference  <span class="math">\\alpha</span>  and output difference  <span class="math">\\beta</span>  using key  <span class="math">k</span> .</p>

    <p class="text-gray-300">The 12-round differential leading to our 16-round differential attack on Simon32/64, as described in Table 1, is</p>

    <div class="my-4 text-center"><span class="math-block"></span></div>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\alpha \\rightarrow \\beta = (0 0 0 1 \\</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">0 0 0 0) \\rightarrow (0 1 0 0 \\</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">0 0 0 0),</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <div class="my-4 text-center"><span class="math-block"></span></div>

    <p class="text-gray-300">for which we found that  <span class="math">\\mathrm{EDP}(\\alpha, \\beta) &amp;gt; 2^{-29.481}</span> . The reason that the bound is not tight is twofold:</p>

    <ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">

      <li>Firstly, due to the pruning of branches during the search, we never consider a large portion of characteristics belonging to some differential</li>

      <li>Secondly, the search was, in some cases, stopped before considering all characteristics, even when using the pruning as just described, due to time limits.</li>

    </ol>

    <p class="text-gray-300">An interesting question we are able to answer using the presented search method, for this small version of SIMON, is how strong the differential effect is. That is, we can determine if the EDP is due to the contribution of a few (or even a single) characteristics of high probability, or rather is the result of clustering of many characteristics of lower probability.</p>

    <p class="text-gray-300">!<a href="img-6.jpeg">img-6.jpeg</a> (a) Number of characteristics with a given characteristic probability  <span class="math">p</span></p>

    <p class="text-gray-300">!<a href="img-7.jpeg">img-7.jpeg</a> (b) Total contribution to the EDP by characteristics of probability in  <span class="math">[p;2p]</span> Fig. 4: Account of the number of characteristics of a certain probability  <span class="math">p</span>  (left) and their accumulated probability (right). The first axis is determined as  <span class="math">\\lfloor \\log_2 p \\rfloor</span> .</p>

    <p class="text-gray-300">For the differential  <span class="math">\\alpha \\rightarrow \\beta</span>  of Equation (1), we keep track of the number of characteristics of probability  <span class="math">[p;2p]</span>  in this differential by mapping  <span class="math">\\lfloor \\log_2p\\rfloor</span>  to a counter. We note that the search, and hence the characteristic counting, is stopped at the same point as for differential search, i.e. when obtain the bound  <span class="math">\\mathrm{EDP}(\\alpha ,\\beta) &amp;gt; 2^{-29.481}</span> .</p>

    <p class="text-gray-300">The resulting distribution of the number of characteristics and their probabilities are shown in Figure 4a. Figure 4b shows a division of the characteristics of probability  <span class="math">[p;2p]</span>  on the first axis, and their total contribution to the EDP as the plotted value.</p>

    <p class="text-gray-300">Figure 4a shows a low frequency of characteristics of probability  <span class="math">2^{-43}</span>  to  <span class="math">2^{-36}</span> . In fact, we find just one characteristic of  <span class="math">\\lfloor \\log_2p\\rfloor = -36</span>  and four characteristics of  <span class="math">\\lfloor \\log_2p\\rfloor = -37</span> . While these few characteristics do provide an accumulated probability of  <span class="math">\\approx 2^{-36} + 4\\cdot 2^{-37}\\approx 2^{-34.42}</span> , the majority of the  <span class="math">\\mathrm{EDP}(\\alpha ,\\beta) &amp;gt; 2^{-29.481}</span> , is due to the vast number of characteristics of probability  <span class="math">p</span>  s.t.  <span class="math">\\lfloor \\log_2p\\rfloor \\in [-47; - 39]</span> . Note that there is only one characteristic of probability  <span class="math">2^{-36}</span> , which is a factor of  <span class="math">\\approx 2^{6.5}</span>  from the bound on  <span class="math">\\mathrm{EDP}(\\alpha ,\\beta)</span> . This might give us an indication, that the</p>

    <p class="text-gray-300">theoretical bound on the EDP, chosen initially by the designers, is based on a provable bound on the characteristic probability, which is close to the  <span class="math">2^{-36}</span>  for 12 rounds, as seen above.</p>

    <p class="text-gray-300">!<a href="img-8.jpeg">img-8.jpeg</a> Fig. 5: Total contribution to the EDP by characteristics of probability in  <span class="math">[p;2p]</span> , for every 12-round Simon32/64 differential found with  <span class="math">\\mathrm{EDP}(\\alpha ,\\beta) &amp;gt; 2^{-33}</span> . Each plot represents a single differential. Note that the plots for some differentials overlap, due to identical counts for the characteristic occurrences.</p>

    <p class="text-gray-300">In Figure 5, the same experiment is performed. However, characteristic probability frequencies for all differentials of  <span class="math">\\mathrm{EDP}(\\alpha ,\\beta) &amp;gt; 2^{-33}</span>  that we observe during our search, are collected. A total of 53 differentials were found, and in Figure 5, we clearly see the same large differential effect for all 53 cases.</p>

    <p class="text-gray-300">Based on this observation, we conclude that, at least for Simon32/64, there is a prominent clustering of characteristics of lower probability, i.e. a strong differential effect. This might lead to a better understanding of the constraints imposed by the designers of SIMON, especially for smaller block sizes, when considering security bounds against certain attacks such as a differential attack.</p>

    <p class="text-gray-300">Consider an  <span class="math">(r - 2)</span> -round differential property, where the desired input difference is of the form  <span class="math">(\\alpha \\parallel 0)</span> , i.e. an arbitrary non-zero difference on the left half of the input, and a zero difference on the right half.</p>

    <p class="text-gray-300">As the difference is zero on the right half of the input, the corresponding input difference to  <span class="math">F</span>  in the previous round is zero, and consequently the output difference of  <span class="math">F</span>  is too. As such, we can extend the  <span class="math">(r - 2)</span> -round property to an  <span class="math">(r - 1)</span> -round property by using the input difference  <span class="math">(0 \\parallel \\alpha)</span>  instead.</p>

    <p class="text-gray-300">Moreover, if we choose a plaintext  <span class="math">(x\\parallel y)</span> , and set  <span class="math">x^{\\prime} = x\\oplus \\alpha</span> , then we will suffer an overhead of two applications of  <span class="math">F</span> . As a result, we determine the second plaintext  <span class="math">(x^{\\prime}\\parallel y^{\\prime}) = (x\\oplus \\alpha \\parallel y\\oplus F(x)\\oplus F(x\\oplus \\alpha))</span> , such that the difference after one round becomes  <span class="math">(0\\parallel \\alpha)</span> . Thus, after two rounds the difference is  <span class="math">(\\alpha \\parallel 0)</span> . This extends the  <span class="math">(r - 2)</span> -round property to an  <span class="math">r</span> -round property without reducing the differential probability, but with the overhead of just two applications of  <span class="math">F</span> .</p>

    <p class="text-gray-300">When using a differential for key recovery, one would normally attack a reduced  <span class="math">r</span> -round version of the cipher using an  <span class="math">(r - 1)</span> -round differential. However, as the round key addition is performed after the application of  <span class="math">F</span>  in each round for SIMON, we will in fact do key recovery on an  <span class="math">r</span> -round version of SIMON by using an  <span class="math">(r - 2)</span> -round differential. We refer to Figure 6 in our explanation of the key recovery.</p>

    <p class="text-gray-300">!<a href="img-9.jpeg">img-9.jpeg</a> Fig. 6: Differential Key Recovery Attack on SIMON</p>

    <p class="text-gray-300">The key recovery works as follows. We assume that the output difference of the  <span class="math">(r - 2)</span> -round differential is  <span class="math">(\\alpha \\parallel 0)</span> . Furthermore, let an output ciphertext pair be  <span class="math">(c_{L} \\parallel c_{R})</span>  and  <span class="math">(c_{L}^{\\prime} \\parallel c_{R}^{\\prime})</span> , for which the corresponding input plaintext pair have a chosen difference dictated by the differential. We initialize a counter for each possible key guess  <span class="math">v</span>  to zeroes.</p>

    <p class="text-gray-300">As we can compute  <span class="math">F</span> , we may determine</p>

    <div class="my-4 text-center"><span class="math-block">u _ {R} \\oplus u _ {R} ^ {\\prime} = F (c _ {R}) \\oplus F (c _ {R} ^ {\\prime}) \\oplus c _ {L} \\oplus c _ {L} ^ {\\prime},</span></div>

    <p class="text-gray-300">and check if this difference matches the difference  <span class="math">\\alpha</span>  dictated by the differential. If this is the case, then the plaintext/ciphertext pair is assumed to follow the  <span class="math">(r - 2)</span> -round differential. By trying all possible values  <span class="math">v</span>  for the last round key, we may partially decrypt to obtain the actual pairs  <span class="math">(u_{L} \\parallel u_{R}), (u_{L}^{\\prime} \\parallel u_{R}^{\\prime})</span> . Again, as we can evaluate  <span class="math">F</span> , we can check if</p>

    <div class="my-4 text-center"><span class="math-block">F (u _ {R}) \\oplus F (u _ {R} ^ {\\prime}) \\oplus u _ {L} \\oplus u _ {L} ^ {\\prime}</span></div>

    <p class="text-gray-300">equals zero. If this is the case, then the current guess for  <span class="math">v</span>  was considered a candidate, and a counter for the key guess  <span class="math">v</span>  is incremented.</p>

    <p class="text-gray-300">The process above is repeated with about  <span class="math">\\frac{c}{p}</span>  chosen plaintext pairs, for some small constant  <span class="math">c</span> , where  <span class="math">p</span>  is the probability of the  <span class="math">(r - 2)</span> -round differential. In the end, a ranking of key candidates by their counter values provides the attacker with the most probable key guesses for the attacked last round key.</p>

    <p class="text-gray-300">The general complexity of the differential key recovery attacks can be expressed in terms of the following:</p>

    <ul class="list-disc list-inside space-y-1 text-gray-300 my-2 ml-4">

      <li>Data complexity which can be defined as the number of chosen plaintexts used in the attack</li>

    </ul>

    <ul class="list-disc list-inside space-y-1 text-gray-300 my-2 ml-4">

      <li>Time complexity is determined as the work effort, spent in partially decrypting the last round(s), in terms of encryption queries, i.e. the equivalence of <span class="math">r</span> rounds of encryption</li>

      <li>Memory used on average for given time complexity</li>

    </ul>

    <p class="text-gray-300">The data complexity of the classical differential attack can be expressed as <span class="math">\\frac{c}{P}</span>, where <span class="math">P</span> is the differential probability for <span class="math">r-1</span> rounds, and <span class="math">c</span> is a small constant. For the presented attack, it will be <span class="math">2^{29.481}</span> chosen pairs for 16 rounds of Simon32/64, as shown in Table 1. As for time complexity, it is defined by the number of total number of encryption queries achieved for all filtered pairs, using all possible key values:</p>

    <p class="text-gray-300"><span class="math">\\frac{c}{P}\\times\\gamma\\times 2^{k}\\times\\frac{2}{r},</span></p>

    <p class="text-gray-300">where <span class="math">r</span> is the number of rounds, <span class="math">k</span> is the number of key bits to be guessed, which are equal to <span class="math">n</span> for SIMON, and <span class="math">\\gamma</span> is the probability that a pair survives the filtering which is <span class="math">2^{-n}</span>. This will yield a time complexity of <span class="math">\\frac{2c}{cP}r</span> encryption query equivalents for SIMON variants. As for the memory needed for the key recovery attack in the presented cases, it will be the number of key guesses which is <span class="math">2^{n}</span> words of memory.</p>

    <h2 id="sec-14" class="text-2xl font-bold">4 Impossible Differential Attack</h2>

    <p class="text-gray-300">Impossible differential cryptanalysis was first mentioned in 1998 by Knudsen in his analysis of DEAL <em>[18]</em>, and further extended to an attack on IDEA by Biham et al. at FSE 1999 <em>[3]</em>. The approach combines two certain properties (two differentials with probability 1), one in the forward direction and one in the backward direction, and uses a resulting conflict when both directions are joined. This miss-in-the-middle approach is used to obtain an impossibility result. This can be utilized in a chosen-plaintext attack by requesting encryptions of plaintext pairs with a fixed difference, guessing key material and checking for the impossibility property to discard wrong guesses. In our case, the forward and backward differentials are truncated.</p>

    <p class="text-gray-300">Some impossible differentials rely on the round function <span class="math">F</span> being a permutation, a prominent example being the general 5-round property on Feistel schemes presented in <em>[18]</em>. However, the <span class="math">F</span> function of SIMON is not a bijection, and indeed the impossible differentials we present in the following do not rely on it being so.</p>

    <p class="text-gray-300">In Section 3.1, we saw how one can determine the possible output differences of the <span class="math">F</span> function of SIMON, using a fixed input difference, in the sense that we can determine the truncated output difference. We also saw, that all possible output differences are equiprobable. We are interested in investigating for how many rounds a particular input difference can go before we are uncertain about all output difference bits, i.e. before we have asterisks on all positions. Intuitively, using an input difference of Hamming weight one will be the best approach, as each active bit in the input difference gives rise to 1, 2 or 3 active bits in the output difference, ignoring the possibility of cancellations, which is less predictable. For <span class="math">n\\in\\{16,24,32\\}</span>, we exhaustively tried all possible input differences and saw that this was indeed the case. For <span class="math">n=16</span> and <span class="math">n=32</span>, there was another pattern of Hamming weight two, namely <span class="math">(0\\cdots 00101)</span> and any rotation of it, that covered equally many rounds in one direction. However, as there was no occurrence of both 0’es and 1’s in the last truncated difference, the resulting impossible differential would cover less rounds than when using a Hamming weight one input difference.</p>

    <p class="text-gray-300">Table 6 shows how the truncated differences progress over the rounds of SIMON for some block sizes. We refer to Appendix A for the rest of the cases. All progressions use the same input difference <span class="math">(0\\cdots 01\\parallel 0\\cdots 0)</span>. Other Hamming weight one input differences would yield a progression of truncated differences that are rotated correspondingly.</p>

    <p class="text-gray-300">|  32-bit block  |   |   |</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">---</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">---</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">---</th>

          </tr>

        </thead>

        <tbody>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">0</td>

            <td class="px-3 py-2 border-b border-gray-700">0000000000000001</td>

            <td class="px-3 py-2 border-b border-gray-700">0000000000000000</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">1</td>

            <td class="px-3 py-2 border-b border-gray-700">0000000+000001=0</td>

            <td class="px-3 py-2 border-b border-gray-700">000000000000001</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">2</td>

            <td class="px-3 py-2 border-b border-gray-700">00000+00001++0+</td>

            <td class="px-3 py-2 border-b border-gray-700">0000000+000001=0</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">3</td>

            <td class="px-3 py-2 border-b border-gray-700">000++0+01+++=0</td>

            <td class="px-3 py-2 border-b border-gray-700">00000++00001++0+</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">4</td>

            <td class="px-3 py-2 border-b border-gray-700">0++++++1+++=0+</td>

            <td class="px-3 py-2 border-b border-gray-700">000++0+01+++=0</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">5</td>

            <td class="px-3 py-2 border-b border-gray-700">++++++++++++++++</td>

            <td class="px-3 py-2 border-b border-gray-700">0++++++1+++=0+</td>

          </tr>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">(a) For  <span class="math">n = 16</span></p>

    <p class="text-gray-300">|  48-bit block  |   |   |</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">---</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">---</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">---</th>

          </tr>

        </thead>

        <tbody>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">0</td>

            <td class="px-3 py-2 border-b border-gray-700">000000000000000000000001</td>

            <td class="px-3 py-2 border-b border-gray-700">000000000000000000000001</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">1</td>

            <td class="px-3 py-2 border-b border-gray-700">000000000000000000000001</td>

            <td class="px-3 py-2 border-b border-gray-700">000000000000000000000001</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">2</td>

            <td class="px-3 py-2 border-b border-gray-700">0000000+000000+000001++01</td>

            <td class="px-3 py-2 border-b border-gray-700">000000000000000000000001</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">3</td>

            <td class="px-3 py-2 border-b border-gray-700">00000++00000++0+01+++0++</td>

            <td class="px-3 py-2 border-b border-gray-700">0000000+00000++00001++01</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">4</td>

            <td class="px-3 py-2 border-b border-gray-700">000++00+0++++++++++++++</td>

            <td class="px-3 py-2 border-b border-gray-700">00000++0000++00+01+++0++</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">5</td>

            <td class="px-3 py-2 border-b border-gray-700">0++++++++++++++++++++++++</td>

            <td class="px-3 py-2 border-b border-gray-700">000++00+0++++++++++++++</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">6</td>

            <td class="px-3 py-2 border-b border-gray-700">++++++++++++++++++++++++++</td>

            <td class="px-3 py-2 border-b border-gray-700">0++++++++++++++++++++++</td>

          </tr>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">(b) For  <span class="math">n = 24</span></p>

    <p class="text-gray-300">|  64-bit block  |   |   |</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">---</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">---</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">---</th>

          </tr>

        </thead>

        <tbody>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">0</td>

            <td class="px-3 py-2 border-b border-gray-700">000000000000000000000000000000001</td>

            <td class="px-3 py-2 border-b border-gray-700">00000000000000000000000000000000</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">1</td>

            <td class="px-3 py-2 border-b border-gray-700">000000000000000000000000000000001</td>

            <td class="px-3 py-2 border-b border-gray-700">00000000000000000000000000000000</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">2</td>

            <td class="px-3 py-2 border-b border-gray-700">0000000000000000000000000000000000000000</td>

            <td class="px-3 py-2 border-b border-gray-700">00000000000000000000000000000000</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">3</td>

            <td class="px-3 py-2 border-b border-gray-700">0000000+000000+000000+000000+000000</td>

            <td class="px-3 py-2 border-b border-gray-700">0000000000000000000000000000000</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">4</td>

            <td class="px-3 py-2 border-b border-gray-700">000000+000000+000000+000000</td>

            <td class="px-3 py-2 border-b border-gray-700">0000000+000000+000000+000000</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">5</td>

            <td class="px-3 py-2 border-b border-gray-700">000++00+00++++++++++++++++++++</td>

            <td class="px-3 py-2 border-b border-gray-700">000000+000000+000000+000000</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">6</td>

            <td class="px-3 py-2 border-b border-gray-700">0++++++++++++++++++++++++++</td>

            <td class="px-3 py-2 border-b border-gray-700">000++00+00++++++++++++++++++</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">7</td>

            <td class="px-3 py-2 border-b border-gray-700">++++++++++++++++++++++++++</td>

            <td class="px-3 py-2 border-b border-gray-700">0++++++++++++++++++++++++</td>

          </tr>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">(c) For  <span class="math">n = 32</span></p>

    <p class="text-gray-300">Table 6: Truncated differential pattern propagation for SIMON using word sizes  <span class="math">n \\in  \\{ {16},{24},{32}\\}</span>  , with an input difference  <span class="math">\\left( {0 \\cdots  {01} \\parallel  0 \\cdots  0}\\right)</span></p>

    <p class="text-gray-300">Taking the  <span class="math">n = 16</span>  case as an example, we see that after 5 rounds of SIMON, we have with probability 1 the truncated output difference</p>

    <div class="my-4 text-center"><span class="math-block">(* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *)</span></div>

    <p class="text-gray-300">By left rotating this right truncated difference by 7 or 9 positions, one of the 0's will be shifted to the position of the 1. Due to the symmetry of decryption and encryption of the Feistel scheme, we find that this provides us with two impossibility properties:</p>

    <p class="text-gray-300"><span class="math">\\operatorname{Pr}\\left((0001 \\parallel 0000) \\rightarrow (0001 \\ll 7 \\parallel 0000)\\right) = 0</span>  and</p>

    <p class="text-gray-300"><span class="math">\\operatorname{Pr}\\left((0001 \\parallel 0000) \\rightarrow (0001 \\ll 9 \\parallel 0000)\\right) = 0,</span></p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">where the impossible differential is over 10 rounds of SIMON. With this, we find two impossibility properties for each input difference of Hamming weight one, i.e.  <span class="math">2n</span>  in total. This property for the rotation by  <span class="math">q = 7</span>  is depicted in Figure 11 of Appendix A. In the further description of the attack, we denote by  <span class="math">Q</span>  the set of indices for such rotations of the output difference, relative to the input difference, and hence  $</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Q</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"><span class="math">  is the number of impossible differentials using one input difference. For example, for Simon32/64,  </span>Q = \\{7,9\\}$ .</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">Note that the attack described so far uses an input difference of the form  <span class="math">(\\alpha \\parallel 0)</span> . Thus, the impossible differentials described in this section can trivially be extended by two rounds on top of probability 1, as described in Section 3.4, yielding an extra 2 rounds attacked.</p>

    <p class="text-gray-300">Referring to Table 6, we see that for other values of  <span class="math">n</span> , we do not have both a 0 and 1 in the last truncated difference. Thus, we can not use this for obtaining an impossibility property, because we need to make a 0 overlap with a 1. We can, however, trace back to the last round where the truncated output difference on the right half contains a 1, and match this up with the last truncated output difference containing a 0. This sacrifice means the impossible differential covers less rounds.</p>

    <p class="text-gray-300">!<a href="img-10.jpeg">img-10.jpeg</a> Fig. 7: Key recovery attack with impossible differentials on SIMON</p>

    <h2 id="sec-15" class="text-2xl font-bold">4.1 Key Recovery</h2>

    <p class="text-gray-300">As it was described for key recovery using the standard differentials, we again encrypt for two rounds more than the property covers. Consider a pair of output ciphertexts <span class="math">(c_{L} \\parallel c_{R})</span> and <span class="math">(c_{L}^{\\prime} \\parallel c_{R}^{\\prime})</span>. The first filter in the recovery we can apply, is to test if</p>

    <div class="my-4 text-center"><span class="math-block">\\Gamma := F \\left(c _ {R}\\right) \\oplus F \\left(c _ {R} ^ {\\prime}\\right) \\oplus c _ {L} \\oplus c _ {L} ^ {\\prime} \\tag {2}</span></div>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">equals the right half of one of the $</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Q</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"><span class="math"> impossible differentials, i.e. if it equals some </span>\\alpha \\ll q, q \\in Q$.</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">If it does, we try all values <span class="math">v</span> of the last round key and partially decrypt for one round to obtain the 1-round decrypted pair <span class="math">(u_{L} \\parallel u_{R})</span> and <span class="math">(u_{L}&#x27; \\parallel u_{R}&#x27;)</span>. We may now test if</p>

    <div class="my-4 text-center"><span class="math-block">F \\left(u _ {R}\\right) \\oplus F \\left(u _ {R} ^ {\\prime}\\right) \\oplus u _ {L} \\oplus u _ {L} ^ {\\prime} \\tag {3}</span></div>

    <p class="text-gray-300">equals 0. If it does, then <span class="math">v</span> can be discarded forever as a possible last round key. The attack procedure is presented as Algorithm 1 and we refer to Figure 7 for an illustration of the attack.</p>

    <p class="text-gray-300">!<a href="img-11.jpeg">img-11.jpeg</a></p>

    <p class="text-gray-300">In the following, we give our analysis of the key recovery complexity for the impossible differential attack, in terms of data (which we define as the number of encryption oracle queries), memory and computational (time) complexity, given in terms of equivalent number of  <span class="math">r</span> -round encryption queries. During our analysis, we refer to the line numbers of Algorithm 1, as well as Equations (2) and (3).</p>

    <p class="text-gray-300">As the plaintexts of the basis  <span class="math">\\mathcal{M}</span>  of size  <span class="math">2^{\\ell}</span>  are queried once and stored in memory, the data and memory complexity for line 2 is  <span class="math">2^{\\ell}</span>  data and  <span class="math">2^{\\ell}</span>  memory. By choosing  <span class="math">\\mathcal{M}</span>  in a way that we avoid using a particular pair twice in the form of  <span class="math">(m,m&#x27;)</span>  and  <span class="math">(m&#x27;,m)</span> , the total number of plaintext pairs used for the attack is</p>

    <p class="text-gray-300"><span class="math">n\\cdot 2^{\\ell}</span></p>

    <p class="text-gray-300">where the factor  <span class="math">n</span>  comes from the possible rotations of the input difference  <span class="math">\\alpha = (0\\cdots 01) \\ll j, j = 0, \\ldots, n - 1</span> .</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">As the number of input differences we iterate over in line 3 is  <span class="math">n</span> , and  $</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\mathcal{M}</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">= 2^{\\ell}<span class="math"> , the number of  </span>m'<span class="math">  constructed and queried in lines 5 and 6 is  </span>n \\cdot 2^{\\ell}<span class="math"> . These  </span>m'<span class="math">  are used once and not stored in memory, hence the total memory complexity of the attack is  </span>2^{\\ell}<span class="math">  for storing  </span>\\mathcal{M}<span class="math"> , and the total data complexity is  </span>2^{\\ell} + n \\cdot 2^{\\ell} = (n + 1)2^{\\ell}$ .</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Expected Size of  <span class="math">\\kappa</span>  When using a particular plaintext pair  <span class="math">(m, m&#x27;)</span>  with corresponding ciphertext pair  <span class="math">(c, c&#x27;)</span>  in lines 5 through 16, we first check if the difference  <span class="math">\\Gamma</span>  matches one of the right halves of the  $</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Q</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"><span class="math">  impossible differences. Assuming that  </span>\\Gamma<span class="math">  is uniformly distributed with probability mass function  </span>2^{-n}$ , the probability of entering the if statement of line 8 is</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">$\\frac{</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Q</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">}{2^n}$</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">and as such, the expected number of pairs passing the filtering of Equation (2) is</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">$n2^{\\ell}\\cdot \\frac{</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Q</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">}{2^{n}}.$</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">Consider now a wrong guess <span class="math">v</span> for the key under attack. We know already that for the correct key, the probability of the <em>if statement</em> of line 12 being true is zero, due to the miss-in-the-middle property of the impossible differential attack. However, under the assumption that for a wrong key guess <span class="math">v</span>, the difference of Equation (3) is uniformly distributed, the probability of discarding a wrong key, using a single pair, is <span class="math">2^{-n}</span>, and thus the probability of not discarding it is</p>

    <p class="text-gray-300"><span class="math">(1-2^{-n}).</span></p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Assuming independency of the probabilities of discarding a wrong key, for each of the <span class="math">n2^{\\ell}</span> pairs, the expected number of remaining keys $</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\mathcal{K}</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">$ after using all pairs is</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">$\\mathbb{E}[</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\mathcal{K}</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">]=2^{n}\\left(1-2^{-n}\\right)^{n2^{\\ell}</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Q</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">2^{-n}}.$</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <h4 id="sec-17" class="text-lg font-semibold mt-6">Time Complexity</h4>

    <p class="text-gray-300">For every pair used in lines 9 through 15, i.e. those pairs satisfying <span class="math">\\Gamma\\in\\{\\alpha\\lll q\\mid q\\in Q\\}</span>, we must try as many keys as there are currently in <span class="math">\\mathcal{K}</span>. The fraction of the set <span class="math">\\mathcal{K}</span> which is not discarded by using a single such pair equals the probability that some pair does not discard some wrong key. This probability is computed as</p>

    <p class="text-gray-300"><span class="math">1-\\Pr\\left(\\text{wrong key </span>v<span class="math"> discarded by some pair}\\right)</span> <span class="math">=</span> <span class="math">1-\\Pr\\left(\\text{pair discards </span>v\\mid\\Gamma\\in\\{\\alpha\\lll q\\mid q\\in Q\\}<span class="math">}\\right)\\cdot\\Pr\\left(\\Gamma\\in\\{\\alpha\\lll q\\mid q\\in Q\\}\\right)</span></p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"><span class="math">=</span> $1-2^{-n}\\cdot\\frac{</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Q</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">}{2^{n}}$</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">As such, the expected number of 1-round partial decryptions we will do during the course of the attack, using <span class="math">n2^{\\ell}</span> pairs, is determined as</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">$2^{n}+2^{n}\\cdot\\left(1-\\frac{</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Q</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">}{2^{2n}}\\right)+2^{n}\\cdot\\left(1-\\frac{</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Q</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">}{2^{2n}}\\right)^{2}+\\cdots+2^{n}\\cdot\\left(1-\\frac{</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Q</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">}{2^{2n}}\\right)^{n2^{\\ell}-1}$</th>

          </tr>

        </thead>

        <tbody>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"><span class="math">=</span> $2^{n}\\cdot\\frac{1-\\left(1-\\frac{</td>

            <td class="px-3 py-2 border-b border-gray-700">Q</td>

            <td class="px-3 py-2 border-b border-gray-700">}{2^{2n}}\\right)^{n2^{\\ell}}}{1-\\left(1-\\frac{</td>

            <td class="px-3 py-2 border-b border-gray-700">Q</td>

            <td class="px-3 py-2 border-b border-gray-700">}{2^{2n}}\\right)}$</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"><span class="math">=</span> $2^{3n}\\cdot\\frac{1-\\left(1-\\frac{</td>

            <td class="px-3 py-2 border-b border-gray-700">Q</td>

            <td class="px-3 py-2 border-b border-gray-700">}{2^{2n}}\\right)^{n2^{\\ell}}}{</td>

            <td class="px-3 py-2 border-b border-gray-700">Q</td>

            <td class="px-3 py-2 border-b border-gray-700">}$ (4)</td>

          </tr>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">Evaluating this expression numerically is very computationally intensive for larger values of <span class="math">\\ell</span> and <span class="math">n</span>. For the numerator of Equation (4), we can use the fact that <span class="math">\\lim_{x\\to\\pm\\infty}\\left(1-\\frac{k}{x}\\right)^{x}=e^{-k}</span>. We write <span class="math">2^{\\ell}</span> as <span class="math">2^{\\ell}=c2^{2n}</span> for some constant <span class="math">c</span>. Then</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">$\\lim_{x\\to\\pm\\infty}2^{3n}\\cdot\\frac{1-\\left(1-\\frac{</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Q</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">}{2^{2n}}\\right)^{n2^{\\ell}}}{</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Q</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">}<span class="math"> </span>=2^{3n}\\cdot\\frac{1-e^{-</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Q</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">nc}}{</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Q</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">}$</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">We use the approximation of Equation (5), when computing Equation (4) is too intensive. For the attack, the time complexity is determined as the total effort spent in the 1-round partial decryption phase, converted to the equivalents of  <span class="math">r</span> -round encryption queries. This is done, since  <span class="math">2^n</span> <span class="math">r</span> -round encryption queries would be the effort required to brute-force the key. As such, the total complexity in terms of  <span class="math">r</span> -round encryptions equals the expression from either Equation (4) or (5), multiplied by  <span class="math">\\frac{2}{r}</span> . In Table 7 we present our results on key recovery attacks using impossible differentials, for all variants of SIMON, such that the expected number of remaining subkeys is  <span class="math">1\\%</span>  of the whole key space. We note that the complexities for some of the variants of SIMON are higher than brute-force effort, and hence is not considered an attack. However, as the complexities are independent of the master key size, we do have attacks on most variants.</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Cipher</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Rounds</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Q</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Pairs n2l</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Data 2l + n2l</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Memory 2l</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Time</th>

          </tr>

        </thead>

        <tbody>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">Total</td>

            <td class="px-3 py-2 border-b border-gray-700">Attacked</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">Simon32/64</td>

            <td class="px-3 py-2 border-b border-gray-700">32</td>

            <td class="px-3 py-2 border-b border-gray-700">14</td>

            <td class="px-3 py-2 border-b border-gray-700">2</td>

            <td class="px-3 py-2 border-b border-gray-700">233.203</td>

            <td class="px-3 py-2 border-b border-gray-700">233.291</td>

            <td class="px-3 py-2 border-b border-gray-700">229.203</td>

            <td class="px-3 py-2 border-b border-gray-700">244.183</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">Simon48/72</td>

            <td class="px-3 py-2 border-b border-gray-700">36</td>

            <td class="px-3 py-2 border-b border-gray-700">15</td>

            <td class="px-3 py-2 border-b border-gray-700">1</td>

            <td class="px-3 py-2 border-b border-gray-700">250.203</td>

            <td class="px-3 py-2 border-b border-gray-700">250.262</td>

            <td class="px-3 py-2 border-b border-gray-700">245.618</td>

            <td class="px-3 py-2 border-b border-gray-700">269.079†</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">Simon48/96</td>

            <td class="px-3 py-2 border-b border-gray-700">36</td>

            <td class="px-3 py-2 border-b border-gray-700">15</td>

            <td class="px-3 py-2 border-b border-gray-700">1</td>

            <td class="px-3 py-2 border-b border-gray-700">250.203</td>

            <td class="px-3 py-2 border-b border-gray-700">250.262</td>

            <td class="px-3 py-2 border-b border-gray-700">245.618</td>

            <td class="px-3 py-2 border-b border-gray-700">269.079†</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">Simon64/96</td>

            <td class="px-3 py-2 border-b border-gray-700">42</td>

            <td class="px-3 py-2 border-b border-gray-700">16</td>

            <td class="px-3 py-2 border-b border-gray-700">2</td>

            <td class="px-3 py-2 border-b border-gray-700">265.203</td>

            <td class="px-3 py-2 border-b border-gray-700">265.248</td>

            <td class="px-3 py-2 border-b border-gray-700">260.203</td>

            <td class="px-3 py-2 border-b border-gray-700">291.986†</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">Simon64/128</td>

            <td class="px-3 py-2 border-b border-gray-700">44</td>

            <td class="px-3 py-2 border-b border-gray-700">16</td>

            <td class="px-3 py-2 border-b border-gray-700">2</td>

            <td class="px-3 py-2 border-b border-gray-700">265.203</td>

            <td class="px-3 py-2 border-b border-gray-700">265.248</td>

            <td class="px-3 py-2 border-b border-gray-700">260.203</td>

            <td class="px-3 py-2 border-b border-gray-700">291.986†</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">Simon96/92</td>

            <td class="px-3 py-2 border-b border-gray-700">52</td>

            <td class="px-3 py-2 border-b border-gray-700">19</td>

            <td class="px-3 py-2 border-b border-gray-700">2</td>

            <td class="px-3 py-2 border-b border-gray-700">297.203</td>

            <td class="px-3 py-2 border-b border-gray-700">297.233</td>

            <td class="px-3 py-2 border-b border-gray-700">291.618</td>

            <td class="px-3 py-2 border-b border-gray-700">2139.738†</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">Simon96/144</td>

            <td class="px-3 py-2 border-b border-gray-700">54</td>

            <td class="px-3 py-2 border-b border-gray-700">19</td>

            <td class="px-3 py-2 border-b border-gray-700">2</td>

            <td class="px-3 py-2 border-b border-gray-700">297.203</td>

            <td class="px-3 py-2 border-b border-gray-700">297.233</td>

            <td class="px-3 py-2 border-b border-gray-700">291.618</td>

            <td class="px-3 py-2 border-b border-gray-700">2139.738†</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">Simon128/128</td>

            <td class="px-3 py-2 border-b border-gray-700">68</td>

            <td class="px-3 py-2 border-b border-gray-700">22</td>

            <td class="px-3 py-2 border-b border-gray-700">2</td>

            <td class="px-3 py-2 border-b border-gray-700">2129.203</td>

            <td class="px-3 py-2 border-b border-gray-700">2129.226</td>

            <td class="px-3 py-2 border-b border-gray-700">2123.203</td>

            <td class="px-3 py-2 border-b border-gray-700">2187.527†</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">Simon128/192</td>

            <td class="px-3 py-2 border-b border-gray-700">69</td>

            <td class="px-3 py-2 border-b border-gray-700">22</td>

            <td class="px-3 py-2 border-b border-gray-700">2</td>

            <td class="px-3 py-2 border-b border-gray-700">2129.203</td>

            <td class="px-3 py-2 border-b border-gray-700">2129.226</td>

            <td class="px-3 py-2 border-b border-gray-700">2123.203</td>

            <td class="px-3 py-2 border-b border-gray-700">2187.527†</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">Simon128/256</td>

            <td class="px-3 py-2 border-b border-gray-700">72</td>

            <td class="px-3 py-2 border-b border-gray-700">22</td>

            <td class="px-3 py-2 border-b border-gray-700">2</td>

            <td class="px-3 py-2 border-b border-gray-700">2129.203</td>

            <td class="px-3 py-2 border-b border-gray-700">2129.226</td>

            <td class="px-3 py-2 border-b border-gray-700">2123.203</td>

            <td class="px-3 py-2 border-b border-gray-700">2187.527†</td>

          </tr>

        </tbody>

      </table>

    </div>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Table 7: Results on key recovery attack on SIMON using  $</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Q</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\cdot n<span class="math">  impossible differentials. The number of pairs used,  </span>n2^{\\ell}<span class="math">  is determined such that the expected size of  </span>\\mathcal{K}<span class="math"> , i.e. the remaining key candidates, is  </span>1\\%<span class="math">  of the total subkey space  </span>2^{n}<span class="math"> . The complexities indicated with a  </span>\\dagger$  are computed using the approximation of Equation (5).</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">For the case  <span class="math">n = 16</span> , the block size is small enough that we may actually implement and verify the attack. Thus, we provide in [19] among other cryptanalytic functionalities, our  <span class="math">\\mathrm{C}++</span>  implementation of the key-recovery attack on 14 rounds of Simon32/64, using the 12-round impossible differential.</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">In Table 8, we present the results of 10 experimental runs, the time for each run and the size of the output  $</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\mathcal{K}</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"><span class="math"> , with its corresponding percentage of the full round key space. Figure 8 shows how the size of  </span></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\mathcal{K}</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">$  progressed over the course of the attack, when using difference rotation amounts on the input difference.</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">In this section we present other observations on SIMON, that currently have not led to immediate attacks, but are interesting topics for further analysis. Specifically, we consider SIMON from a rotational cryptanalysis perspective, and consider analysis of repeating patterns in the key schedule.</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Size of K</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Time (sec.)</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">% of 2n</th>

          </tr>

        </thead>

        <tbody>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">3805</td>

            <td class="px-3 py-2 border-b border-gray-700">1619</td>

            <td class="px-3 py-2 border-b border-gray-700">5.81</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">789</td>

            <td class="px-3 py-2 border-b border-gray-700">1636</td>

            <td class="px-3 py-2 border-b border-gray-700">1.20</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">2455</td>

            <td class="px-3 py-2 border-b border-gray-700">1655</td>

            <td class="px-3 py-2 border-b border-gray-700">3.75</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">607</td>

            <td class="px-3 py-2 border-b border-gray-700">1615</td>

            <td class="px-3 py-2 border-b border-gray-700">0.93</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">1600</td>

            <td class="px-3 py-2 border-b border-gray-700">1634</td>

            <td class="px-3 py-2 border-b border-gray-700">2.44</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">344</td>

            <td class="px-3 py-2 border-b border-gray-700">1152</td>

            <td class="px-3 py-2 border-b border-gray-700">0.52</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">1536</td>

            <td class="px-3 py-2 border-b border-gray-700">1190</td>

            <td class="px-3 py-2 border-b border-gray-700">2.34</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">2937</td>

            <td class="px-3 py-2 border-b border-gray-700">1172</td>

            <td class="px-3 py-2 border-b border-gray-700">4.48</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">3170</td>

            <td class="px-3 py-2 border-b border-gray-700">1268</td>

            <td class="px-3 py-2 border-b border-gray-700">4.84</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">5259</td>

            <td class="px-3 py-2 border-b border-gray-700">1207</td>

            <td class="px-3 py-2 border-b border-gray-700">8.02</td>

          </tr>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">Table 8: Results from key recovery experiments on Simon32/64, using the parameters of Table 7. Note, that half the tests were run during the night, where the server was under less load, hence the difference in the runtimes.</p>

    <p class="text-gray-300">!<a href="img-12.jpeg">img-12.jpeg</a></p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Fig. 8: Progression of the size of  $</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\mathcal{K}</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"><span class="math">  for the key recovery attack on Simon32/64 using the parameters of Table 7, as a function of the rotation amount on the input difference (input difference used is  </span>\\alpha = (0\\cdots 01) \\ll x, x = 0,\\ldots,n-1$ . The progressions are from the experimental results of Table 8.</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">For block ciphers using round functions built around the components</p>

    <ul class="list-disc list-inside space-y-1 text-gray-300 my-2 ml-4">

      <li>Addition modulo  <span class="math">2^{n} - 1</span> ,</li>

      <li>Rotation of binary strings and</li>

      <li>Exclusive-or,</li>

    </ul>

    <p class="text-gray-300">rotational cryptanalysis has proven efficient. Examples include cryptanalysis of Keccac by Morawiecki et al. [21] and a rotational rebound attack on Skein by Khovratovich et al. [17]. The basic idea is focused around constructing rotational pairs of words where one is the rotation of the other, for a certain rotation amount. The propagation of these pairs is traced throughout the different rounds of the primitive, knowing that rotational pairs will disclose information about specific key bits in every- or certain key words. It is worth noting that in [16], the authors state that systems with XORs and rotations can always be broken.</p>

    <p class="text-gray-300">While the SIMON family of block ciphers does not use modular addition, it does use  <span class="math">\\oplus</span>  and rotation. Thus, an interesting question is, for a random input  <span class="math">x</span>  to the round function  <span class="math">F</span> , what is the probability that</p>

    <div class="my-4 text-center"><span class="math-block">x = F (x) \\ll j, \\quad 0 \\leq j &amp;lt;   n.</span></div>

    <p class="text-gray-300">For  <span class="math">n \\in \\{16, 32\\}</span> , the answer is given by the Table 9. We see here, that for  <span class="math">j = n - 2</span>  we get the best probabilities which is  <span class="math">p_{16} = \\frac{2207}{2^{16}} \\approx 2^{-4.89}</span>  for  <span class="math">n = 16</span>  and  <span class="math">p_{32} = (p_{16})^2 \\approx 2^{-9.78}</span>  for  <span class="math">n = 32</span> . In Appendix B, we describe an observation in which we combine the rotational properties from</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">j</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">0</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">1</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">2</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">3</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">4</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">5</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">6</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">7</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">8</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">9</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">10</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">11</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">12</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">13</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">14</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">15</th>

          </tr>

        </thead>

        <tbody>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">Count</td>

            <td class="px-3 py-2 border-b border-gray-700">3</td>

            <td class="px-3 py-2 border-b border-gray-700">5</td>

            <td class="px-3 py-2 border-b border-gray-700">7</td>

            <td class="px-3 py-2 border-b border-gray-700">1</td>

            <td class="px-3 py-2 border-b border-gray-700">3</td>

            <td class="px-3 py-2 border-b border-gray-700">5</td>

            <td class="px-3 py-2 border-b border-gray-700">47</td>

            <td class="px-3 py-2 border-b border-gray-700">1</td>

            <td class="px-3 py-2 border-b border-gray-700">3</td>

            <td class="px-3 py-2 border-b border-gray-700">5</td>

            <td class="px-3 py-2 border-b border-gray-700">7</td>

            <td class="px-3 py-2 border-b border-gray-700">1</td>

            <td class="px-3 py-2 border-b border-gray-700">3</td>

            <td class="px-3 py-2 border-b border-gray-700">5</td>

            <td class="px-3 py-2 border-b border-gray-700">2207</td>

            <td class="px-3 py-2 border-b border-gray-700">1</td>

          </tr>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">(a)  <span class="math">n = 16</span></p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">j</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">0</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">1</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">2</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">3</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">4</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">5</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">6</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">7</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">8</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">9</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">10</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">11</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">12</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">13</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">14</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">15</th>

          </tr>

        </thead>

        <tbody>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">Count</td>

            <td class="px-3 py-2 border-b border-gray-700">3</td>

            <td class="px-3 py-2 border-b border-gray-700">5</td>

            <td class="px-3 py-2 border-b border-gray-700">7</td>

            <td class="px-3 py-2 border-b border-gray-700">1</td>

            <td class="px-3 py-2 border-b border-gray-700">3</td>

            <td class="px-3 py-2 border-b border-gray-700">5</td>

            <td class="px-3 py-2 border-b border-gray-700">47</td>

            <td class="px-3 py-2 border-b border-gray-700">1</td>

            <td class="px-3 py-2 border-b border-gray-700">3</td>

            <td class="px-3 py-2 border-b border-gray-700">5</td>

            <td class="px-3 py-2 border-b border-gray-700">7</td>

            <td class="px-3 py-2 border-b border-gray-700">1</td>

            <td class="px-3 py-2 border-b border-gray-700">3</td>

            <td class="px-3 py-2 border-b border-gray-700">5</td>

            <td class="px-3 py-2 border-b border-gray-700">8671</td>

            <td class="px-3 py-2 border-b border-gray-700">1</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">j</td>

            <td class="px-3 py-2 border-b border-gray-700">16</td>

            <td class="px-3 py-2 border-b border-gray-700">17</td>

            <td class="px-3 py-2 border-b border-gray-700">18</td>

            <td class="px-3 py-2 border-b border-gray-700">19</td>

            <td class="px-3 py-2 border-b border-gray-700">20</td>

            <td class="px-3 py-2 border-b border-gray-700">21</td>

            <td class="px-3 py-2 border-b border-gray-700">22</td>

            <td class="px-3 py-2 border-b border-gray-700">23</td>

            <td class="px-3 py-2 border-b border-gray-700">24</td>

            <td class="px-3 py-2 border-b border-gray-700">25</td>

            <td class="px-3 py-2 border-b border-gray-700">26</td>

            <td class="px-3 py-2 border-b border-gray-700">27</td>

            <td class="px-3 py-2 border-b border-gray-700">28</td>

            <td class="px-3 py-2 border-b border-gray-700">29</td>

            <td class="px-3 py-2 border-b border-gray-700">30</td>

            <td class="px-3 py-2 border-b border-gray-700">31</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">Count</td>

            <td class="px-3 py-2 border-b border-gray-700">3</td>

            <td class="px-3 py-2 border-b border-gray-700">5</td>

            <td class="px-3 py-2 border-b border-gray-700">7</td>

            <td class="px-3 py-2 border-b border-gray-700">1</td>

            <td class="px-3 py-2 border-b border-gray-700">3</td>

            <td class="px-3 py-2 border-b border-gray-700">5</td>

            <td class="px-3 py-2 border-b border-gray-700">47</td>

            <td class="px-3 py-2 border-b border-gray-700">1</td>

            <td class="px-3 py-2 border-b border-gray-700">3</td>

            <td class="px-3 py-2 border-b border-gray-700">5</td>

            <td class="px-3 py-2 border-b border-gray-700">7</td>

            <td class="px-3 py-2 border-b border-gray-700">1</td>

            <td class="px-3 py-2 border-b border-gray-700">3</td>

            <td class="px-3 py-2 border-b border-gray-700">5</td>

            <td class="px-3 py-2 border-b border-gray-700">4870847</td>

            <td class="px-3 py-2 border-b border-gray-700">1</td>

          </tr>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">(b)  <span class="math">n = 32</span></p>

    <p class="text-gray-300">Table 9: Rotational approximations to  <span class="math">x = F\\left( x\\right)  \\ll  j</span>  for  <span class="math">n \\in  \\{ {16},{32}\\} ,j = 0,\\ldots ,n - 1</span></p>

    <p class="text-gray-300">Table 9 with differential cryptanalysis.</p>

    <p class="text-gray-300">Another observation regarding rotational cryptanalysis is that the SIMON  <span class="math">F</span>  function is invariant under rotation, i.e.</p>

    <div class="my-4 text-center"><span class="math-block">\\forall x \\in \\mathbb {F} _ {2} ^ {n}, \\forall j = 0, \\dots , n - 1: F (x \\ll j) = F (x) \\ll j. \\tag {6}</span></div>

    <p class="text-gray-300">Consider a plaintext pair  <span class="math">m = (m_L \\parallel m_R)</span>  and</p>

    <div class="my-4 text-center"><span class="math-block">\\begin{array}{l} m ^ {\\prime} = \\left(m _ {L} ^ {\\prime} \\parallel m _ {R} ^ {\\prime}\\right) \\\\ = \\left(m _ {L} \\ll j \\parallel m _ {R} \\ll j\\right), \\\\ \\end{array}</span></div>

    <p class="text-gray-300">with corresponding ciphertexts  <span class="math">c = (c_{L} \\parallel c_{R})</span>  and  <span class="math">c&#x27; = (c_{L}&#x27; \\parallel c_{R}&#x27;)</span> . Assume that each round key  <span class="math">k_{i}&#x27;</span>  used to encrypt  <span class="math">m&#x27;</span>  equals  <span class="math">k_{i}</span>  left rotated by  <span class="math">j</span> , where  <span class="math">k_{i}</span>  are the round keys for encrypting  <span class="math">m</span> , i.e.</p>

    <div class="my-4 text-center"><span class="math-block">k _ {i} ^ {\\prime} = k _ {i} \\ll j, \\quad i = 0, \\dots , T - 1.</span></div>

    <p class="text-gray-300">In this case, a consequence of Equation (6) is, that</p>

    <div class="my-4 text-center"><span class="math-block">c _ {L} ^ {\\prime} = c _ {L} \\ll j, \\quad \\text {and}</span></div>

    <div class="my-4 text-center"><span class="math-block">c _ {R} ^ {\\prime} = c _ {R} \\ll j.</span></div>

    <p class="text-gray-300">To that end, we define the following problem.</p>

    <p class="text-gray-300">otational Related Key Problem</p>

    <p class="text-gray-300">Given a master key <span class="math">K</span> for a variant of the SIMON block cipher on <span class="math">m</span> key words of <span class="math">n</span> bit each, i.e. <span class="math">K\\in\\underbrace{\\mathbb{F}_{2}^{n}\\times\\cdots\\times F_{2}^{n}}_{m\\ \\text{times}}</span>, with associated round keys <span class="math">k_{i}</span>, <span class="math">i\\in\\{0,\\ldots,T-1\\}</span>, determine a related key <span class="math">K^{\\prime}\\in\\underbrace{\\mathbb{F}_{2}^{n}\\times\\cdots\\times F_{2}^{n}}_{m\\ \\text{times}}</span>, with <span class="math">K^{\\prime}\\neq K</span>, s.t. for the associated round keys <span class="math">k^{\\prime}_{i}</span>, it holds for all <span class="math">k^{\\prime}_{i}</span> that it is as close as possible (in some measure) to <span class="math">(k_{i}\\lll j)</span>, for some <span class="math">j=0,\\ldots,n-1</span>.</p>

    <p class="text-gray-300">While solving this problem to the point where it provides ground for a cryptographic attack seems hard, it poses an interesting problem. Fixing <span class="math">j=2</span>, we tried for different variants of SIMON to investigate the implications on the expanded round keys, of fixing the master key <span class="math">K^{\\prime}</span> to the rotation of <span class="math">K</span> by <span class="math">j</span> positions. Specifically, we generate a random <span class="math">K</span> and expand the round keys. We then define <span class="math">K^{\\prime}</span> as the rotated <span class="math">K</span>, and expand those round keys. The latter expanded round keys are rotated back by <span class="math">j</span> positions to the right, and we compute the length of their longest common subsequence. The result is presented in Figure 9. The figure shows how the length of the LCS rapidly converges, but whether different approaches work better is an open question.</p>

    <p class="text-gray-300">!<a href="img-13.jpeg">img-13.jpeg</a> Figure 9: Average longest common subsequence for round keys <span class="math">k_{i}</span> and <span class="math">k^{\\prime}_{i}</span>, where the master key relation is rotated by <span class="math">j=2</span> positions to the left in <span class="math">K^{\\prime}</span> compared to <span class="math">K</span></p>

    <h3 id="sec-21" class="text-xl font-semibold mt-8">5.2 Weak Keys</h3>

    <p class="text-gray-300">The heavy constant <span class="math">c</span> used in the SIMON key schedule ascertains that the weight of round keys quickly converge to an average of <span class="math">\\frac{n}{2}</span>. However, referring to the key schedule of Figure 2, and considering the case <span class="math">m\\neq 4</span>, if we can ensure that</p>

    <p class="text-gray-300"><span class="math">(k_{i-1}\\ggg 3)\\oplus(k_{i-1}\\ggg 4)</span></p>

    <p class="text-gray-300">cancels many bits of the constant <span class="math">c</span>, i.e.</p>

    <p class="text-gray-300"><span class="math">c\\oplus(k_{i-1}\\ggg 3)\\oplus(k_{i-1}\\ggg 4)</span> (7)</p>

    <p class="text-gray-300">has low Hamming weight, then for each of these bits, the round key <span class="math">k_{i}</span> will equal <span class="math">k_{i-m}</span>. When <span class="math">m=4</span>, the corresponding requirement becomes striving for a low Hamming weight in</p>

    <p class="text-gray-300"><span class="math">c\\oplus(k_{i-1}\\ggg 3)\\oplus k_{i-3}\\oplus(((k_{i-1}\\ggg 3)\\oplus k_{i-3})\\ggg 1).</span></p>

    <p class="text-gray-300">Focusing on the case  <span class="math">m \\in \\{2,3\\}</span> , i.e. (7), we see that the rotational difference in the XOR of  <span class="math">k_{i-1}</span>  is a single position. Thus, for any  <span class="math">j \\in \\{2,\\dots,n-1\\}</span>  ( <span class="math">j = 0</span>  being the least significant bit), we know that bit  <span class="math">j</span>  of  <span class="math">k_i</span>  will equal bit  <span class="math">j</span>  of  <span class="math">k_{i-m}</span>  if and only if bit  <span class="math">j+3</span>  and bit  <span class="math">j+4</span>  of  <span class="math">k_{i-1}</span>  are different. For  <span class="math">j = 1</span> , we need that bit 4 and 5 of  <span class="math">k_{i-1}</span>  are the same, and for  <span class="math">j = 0</span>  we need the XOR of bit 3 and 4 of  <span class="math">k_{i-1}</span>  to equal  <span class="math">z_j^i</span> . Note, that all indices are computed modulo  <span class="math">n</span> . Intuitively, for each pair of consecutive alternating bits of  <span class="math">k_{i-1}</span> , we have one bit of  <span class="math">k_i</span>  equal one bit of  <span class="math">k_{i-m}</span> .</p>

    <p class="text-gray-300">!<a href="img-14.jpeg">img-14.jpeg</a> Fig. 10: Round keys (one per row) using master key  <span class="math">(1010\\cdots 10\\parallel 1010\\cdots 10)</span>  for Simon128/128. A black square represents a 1, a white square 0.</p>

    <p class="text-gray-300">As such, an obvious experiment is to set  <span class="math">k_{i-1}</span>  equal to either (0101···01) or (1010···10). This implies that (7) will have 0's on the  <span class="math">n-2</span>  most significant bit positions. Consequently,  <span class="math">k_i</span>  will equal  <span class="math">k_{i-m}</span>  on those bits. If we thus choose to load all master key words with strings of this pattern, we expect that the pattern will repeat in some round keys. The resulting round keys for this experiment with the Simon128/128 cipher is depicted in Figure 10.</p>

    <p class="text-gray-300">While this observation does not suggest any weakness in the cipher itself, it is an open question whether (parts of) this round key pattern can be combined with a property exploiting it for some number of rounds, and weak key space. In particular, whether a trade-off can be defined between the following is still an open and interesting question:</p>

    <ul class="list-disc list-inside space-y-1 text-gray-300 my-2 ml-4">

      <li>The size of a weak key space where round keys repeat partially in a particular pattern,</li>

      <li>The extent of the key repetition, and</li>

      <li>The number of rounds where this exploitable property lasts</li>

    </ul>

    <p class="text-gray-300">In this work, we have considered the lightweight block cipher family SIMON from a cryptanalytic perspective. The specification paper provided by the NSA does not include any form of security assessment, and with our analysis we have taken the first step towards an openly available cryptanalysis of the cipher family SIMON, using various commonly applied cryptanalytic techniques as</p>

    <p class="text-gray-300">summarized in Table 1. All our cryptanalysis uses the simple assumption of a chosen plaintext setting, i.e. no chosen ciphertext oracle is required, nor is any known- chosen- or related-key settings used.</p>

    <p class="text-gray-300">We have determined iterative differentials for Simon32/64, and general differentials for all variants of SIMON, that yield differential attacks on reduced versions with at least half the total rounds of the cipher in all cases. This analysis provided the grounds for our best results. An interesting observation in Section 3.3 is that Simon32/64 exhibits a strong differential effect. This suggests that bounding the expected differential probability (EDP) by the expected maximum characteristic probability is not well-founded in this case.</p>

    <p class="text-gray-300">Furthermore, we considered using truncated differentials to construct impossible differentials over a number of rounds, which yielded attacks on reduced versions of most of the cipher variants, however not stronger than the ordinary differential attacks.</p>

    <p class="text-gray-300">Finally, we provided a number of other observations on the cipher structure with regards to rotational cryptanalysis and possible weak keys patterns. This may provide starting ground for future analysis in this direction.</p>

    <h4 id="sec-23" class="text-lg font-semibold mt-6">6.0.1 Open Question and Future Work</h4>

    <p class="text-gray-300">The analysis provided on SIMON variants has shed light on the differential properties of the cipher family. However, it is worth exploring the possibility of improving these differential/impossible differential attacks. Also, cryptanalysis with respect to higher-order differential attacks and meet-in-the-middle attacks would be interesting. In addition to that, it can be profitable to consider the effect of linear cryptanalysis on SIMON, in particular zero-correlation attacks. Furthermore, an analysis of the key schedule and whether one can obtain related-key properties that can be exploited in a combination with rotational cryptanalysis, is an interesting open question.</p>

    <h2 id="sec-24" class="text-2xl font-bold">7 Acknowledgement</h2>

    <p class="text-gray-300">The authors would like to thank Andrey Bogdanov, Christian Rechberger and Lars R. Knudsen for their helpful and constant remarks, guidance, explanations, discussions and reviews throughout this work. Also, we would like to thank Elias Yarrkov for discussing iterated differentials, and Tyge Tiessen for discussing differential properties of the SIMON <span class="math">F</span> function.</p>

    <h2 id="sec-25" class="text-2xl font-bold">References</h2>

    <ul class="list-disc list-inside space-y-1 text-gray-300 my-2 ml-4">

      <li>[1] Ray Beaulieu, Douglas Shors, Jason Smith, Stefan Treatman-Clark, Bryan Weeks, and Louis Wingers. Performance of the SIMON and SPECK Families of Lightweight Block Ciphers, 2012.</li>

      <li>[2] Ray Beaulieu, Douglas Shors, Jason Smith, Stefan Treatman-Clark, Bryan Weeks, and Louis Wingers. The SIMON and SPECK Families of Lightweight Block Ciphers. Cryptology ePrint Archive, Report 2013/404, 2013. http://eprint.iacr.org/.</li>

      <li>[3] Eli Biham, Alex Biryukov, and Adi Shamir. Miss in the Middle Attacks on IDEA and Khufu. In FSE, pages 124–138, 1999.</li>

      <li>[4] Eli Biham and Adi Shamir. Differential cryptanalysis of des-like cryptosystems. In AlfredJ. Menezes and ScottA. Vanstone, editors, Advances in Cryptology-CRYPT0’ 90, volume 537 of Lecture Notes in Computer Science, pages 2–21. Springer Berlin Heidelberg, 1991.</li>

      <li>[5] A. Bogdanov, L. R. Knudsen, G. Le, C. Paar, A. Poschmann, M. J. B. Robshaw, Y. Seurin, and C. Vikkelsoe. PRESENT: An Ultra-Lightweight Block Cipher. In the proceedings of CHES 2007. Springer, 2007.</li>

    </ul>

    <ul class="list-disc list-inside space-y-1 text-gray-300 my-2 ml-4">

      <li>[6] Julia Borghoff, Anne Canteaut, Tim Güneysu, ElifBilge Kavun, Miroslav Knezevic, LarsR. Knudsen, Gregor Leander, Ventzislav Nikov, Christof Paar, Christian Rechberger, Peter Rombouts, SørenS. Thomsen, and Tolga Yalçın. Prince – a low-latency block cipher for pervasive computing applications. In Xiaoyun Wang and Kazue Sako, editors, Advances in Cryptology – ASIACRYPT 2012, volume 7658 of Lecture Notes in Computer Science, pages 208–225. Springer Berlin Heidelberg, 2012.</li>

      <li>[7] Christophe Cannière, Orr Dunkelman, and Miroslav Knežević. KATAN and KTANTAN — A Family of Small and Efficient Hardware-Oriented Block Ciphers. In Christophe Clavier and Kris Gaj, editors, Cryptographic Hardware and Embedded Systems - CHES 2009, volume 5747 of Lecture Notes in Computer Science, pages 272–288. Springer Berlin Heidelberg, 2009.</li>

      <li>[8] D. Coppersmith. The Data Encryption Standard (DES) and its strength against attacks. IBM Journal of Research and Development, 38(3):243–250, 1994.</li>

      <li>[9] Joan Daemen, Mario Lamberger, Norbert Pramstaller, Vincent Rijmen, and Frederik Vercauteren. Computational aspects of the expected differential probability of 4-round aes and aes-like ciphers. Computing, 85(1-2):85–104, 2009.</li>

      <li>[10] Joan Daemen and Vincent Rijmen. The Block Cipher Rijndael. In Jean-Jacques Quisquater and Bruce Schneier, editors, Smart Card Research and Applications, volume 1820 of Lecture Notes in Computer Science, pages 277–284. Springer Berlin Heidelberg, 2000.</li>

      <li>[11] Joan Daemen and Vincent Rijmen. Probability distributions of correlation and differentials in block ciphers, 2005.</li>

      <li>[12] Itai Dinur, Orr Dunkelman, Nathan Keller, and Adi Shamir. How to Efficiently and Simultaneously Compute the Probabilities of All Iterative Characteristics. Eurocrypt 2013 Rump Session, 2013.</li>

      <li>[13] Zheng Gong, Svetla Nikova, and YeeWei Law. KLEIN: A New Family of Lightweight Block Ciphers. In Ari Juels and Christof Paar, editors, RFID. Security and Privacy, volume 7055 of Lecture Notes in Computer Science, pages 1–18. Springer Berlin Heidelberg.</li>

      <li>[14] Jian Guo, Thomas Peyrin, Axel Poschmann, and Matt Robshaw. The LED Block Cipher. In Bart Preneel and Tsuyoshi Takagi, editors, Cryptographic Hardware and Embedded Systems – CHES 2011, volume 6917 of Lecture Notes in Computer Science, pages 326–341. Springer Berlin Heidelberg, 2011.</li>

      <li>[15] Deukjo Hong, Jaechul Sung, Seokhie Hong, Jongin Lim, Sangjin Lee, Bon-Seok Koo, Changhoon Lee, Donghoon Chang, Jesang Lee, Kitae Jeong, Hyun Kim, Jongsung Kim, and Seongtaek Chee. HIGHT: A New Block Cipher Suitable for Low-Resource Device. In Louis Goubin and Mitsuru Matsui, editors, Cryptographic Hardware and Embedded Systems - CHES 2006, volume 4249 of Lecture Notes in Computer Science, pages 46–59. Springer Berlin Heidelberg, 2006.</li>

      <li>[16] Dmitry Khovratovich and Ivica Nikolic. Rotational Cryptanalysis of ARX. In Seokhie Hong and Tetsu Iwata, editors, FSE, volume 6147 of Lecture Notes in Computer Science, pages 333–346. Springer, 2010.</li>

      <li>[17] Dmitry Khovratovich, Ivica Nikolic, and Christian Rechberger. Rotational Rebound Attacks on Reduced Skein. In ASIACRYPT, pages 1–19, 2010.</li>

      <li>[18] Lars R. Knudsen. DEAL - A 128-bit Block Cipher, 1998.</li>

      <li>[19] Martin M. Lauridsen and Hoda A. Alkhzaimi. SIMON and SPECK cryptanalysis code repository. https://github.com/mmeh/simon-speck-cryptanalysis.</li>

      <li>[20] ChaeHoon Lim and Tymur Korkishko. mCrypton – A Lightweight Block Cipher for Security of Low-Cost RFID Tags and Sensors. In Joo-Seok Song, Taekyoung Kwon, and Moti Yung, editors, Information Security Applications, volume 3786 of Lecture Notes in Computer Science, pages 243–258. Springer Berlin Heidelberg, 2006.</li>

      <li>[21] Pawel Morawiecki, Josef Pieprzyk, and Marian Srebrny. Rotational cryptanalysis of round-reduced Keccak. Cryptology ePrint Archive, Report 2012/546, 2012. http://eprint.iacr.org/.</li>

      <li>[22] Kyoji Shibutani, Takanori Isobe, Harunaga Hiwatari, Atsushi Mitsuda, Toru Akishita, and Taizo Shirai. Piccolo: An Ultra-Lightweight Blockcipher. In Bart Preneel and Tsuyoshi Takagi, editors, Cryptographic Hardware and Embedded Systems – CHES 2011, volume 6917 of Lecture Notes in Computer Science, pages 342–357. Springer Berlin Heidelberg, 2011.</li>

      <li>[23] Francois-Xavier Standaert, Gilles Piret, Gael Rouvroy, Jean-Jacques Quisquater, and Jean-Didier Legat. ICEBERG : An Involutional Cipher Efficient for Block Encryption in Reconfigurable Hardware. In Bimal Roy and Willi Meier, editors, Fast Software Encryption, volume 3017 of Lecture Notes in Computer Science, pages 279–298. Springer Berlin Heidelberg, 2004.</li>

    </ul>

    <ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">

      <li>Tomoyasu Suzuki, Kazuhiko Minematsu, Sumio Morioka, and Eita Kobayashi. TWINE: A Lightweight Block Cipher for Multiple Platforms. In LarsR. Knudsen and Huapeng Wu, editors, Selected Areas in Cryptography, volume 7707 of Lecture Notes in Computer Science, pages 339-354. Springer Berlin Heidelberg, 2013.</li>

      <li>Huihui Yap, Khoongming Khoo, Axel Poschmann, and Matt Henricksen. EPCBC - A Block Cipher Suitable for Electronic Product Code Encryption. In Dongdai Lin, Gene Tsudik, and Xiaoyun Wang, editors, Cryptology and Network Security, volume 7092 of Lecture Notes in Computer Science, pages 76-97. Springer Berlin Heidelberg, 2011.</li>

    </ol>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Rounds</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">96-bit block</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

          </tr>

        </thead>

        <tbody>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">Left</td>

            <td class="px-3 py-2 border-b border-gray-700">Right</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">0</td>

            <td class="px-3 py-2 border-b border-gray-700">0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000</td>

            <td class="px-3 py-2 border-b border-gray-700">00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">1</td>

            <td class="px-3 py-2 border-b border-gray-700">000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000</td>

            <td class="px-3 py-2 border-b border-gray-700">00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">2</td>

            <td class="px-3 py-2 border-b border-gray-700">0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000</td>

            <td class="px-3 py-2 border-b border-gray-700">0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">3</td>

            <td class="px-3 py-2 border-b border-gray-700">00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000</td>

            <td class="px-3 py-2 border-b border-gray-700">000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">4</td>

            <td class="px-3 py-2 border-b border-gray-700">0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000</td>

            <td class="px-3 py-2 border-b border-gray-700">00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">5</td>

            <td class="px-3 py-2 border-b border-gray-700">0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000</td>

            <td class="px-3 py-2 border-b border-gray-700">0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">6</td>

            <td class="px-3 py-2 border-b border-gray-700">00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000</td>

            <td class="px-3 py-2 border-b border-gray-700">000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">7</td>

            <td class="px-3 py-2 border-b border-gray-700">000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000</td>

            <td class="px-3 py-2 border-b border-gray-700">0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">8</td>

            <td class="px-3 py-2 border-b border-gray-700">00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000</td>

            <td class="px-3 py-2 border-b border-gray-700">0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

          </tr>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">(b) For  <span class="math">n = 64</span></p>

    <p class="text-gray-300">Table 10: Truncated differential pattern propagation for SIMON using word sizes  <span class="math">n \\in \\{48,64\\}</span> , with an input difference  <span class="math">(0\\cdots 01)</span>  on the left half and a 0-difference on the right half</p>

    <p class="text-gray-300">Referring to Table 9, we saw that  <span class="math">\\operatorname{Pr}(x = F(x) \\ll j)</span>  is maximized when  <span class="math">j = 2</span> . This probability equals  <span class="math">\\operatorname{Pr}(F(x) = x \\gg 2)</span> . Now consider a plaintext pair  <span class="math">(m_L \\parallel m_R)</span>  and  <span class="math">(m_L&#x27; \\parallel m_R&#x27;)</span> .</p>

    <p class="text-gray-300">If  <span class="math">m_L&#x27; = m_R \\ll 2</span>  and  <span class="math">m_R&#x27; = m_L \\gg 2</span> , then in the first round, we have that  <span class="math">F(m_L) = m_L \\gg 2</span>  and  <span class="math">F(m_L&#x27;) = F(m_R \\ll 2) = m_R</span>  with a certain probability. If these are both fulfilled, then the difference on the left block after 1 round ends up being  <span class="math">(m_L \\gg 2) \\oplus m_R \\oplus k \\oplus (m_L \\gg 2) \\oplus m_R \\oplus k = 0</span> , and on the right block it will be  <span class="math">m_L \\oplus (m_R \\ll 2)</span> . As the input difference is 0 to  <span class="math">F</span>  in round 2, we find that the output difference on the left block is  <span class="math">m_L \\oplus (m_R \\ll 2)</span>  and a 0 difference on the right block, after 2 rounds.</p>

    <p class="text-gray-300">!<a href="img-15.jpeg">img-15.jpeg</a> Fig. 11: A 10-round impossible differential for Simon32/64. Tracing truncated output differences in respectively forward and backward directions give a contradiction on the right half truncated mask after 5 rounds, where a 0 overlaps a 1.</p>

    <p class="text-gray-300">Note, that the first observation above can be used in the beginning of the 6-round iterated differential described in Section 3 or the impossible differentials described in Section 4, as it yields an output difference of the form  <span class="math">(\\alpha \\parallel 0)</span> , which is exactly the starting point needed.</p>

    <p class="text-gray-300">However, compared to the generic extension by two rounds on top, described in Section 3.4, this approach is impaired in two ways:</p>

    <ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">

      <li>It has probability <span class="math">p&amp;lt;1</span>, and</li>

      <li>For a fixed required difference <span class="math">\\alpha</span>, the number of pairs obtainable is only <span class="math">2^{n}</span>, i.e. square root the number of pairs otherwise obtainable.</li>

    </ol>`;
---

<BaseLayout title="Cryptanalysis of the SIMON Family of Block Ciphers (2013/543)">
  <article class="max-w-4xl mx-auto article-prose">
    <nav class="mb-8">
      <a href="/papers" class="text-blue-400 hover:text-blue-300">
        &larr; Back to Papers
      </a>
    </nav>

    <header class="mb-12">
      <h1 class="text-3xl font-bold mb-4"
        set:html={TITLE_HTML} />
      <p class="text-gray-400 mb-2"
        set:html={AUTHORS_HTML} />
      <p class="text-gray-500 text-sm mb-4">
        2013 &middot; eprint 2013/543
      </p>
      <div class="flex gap-4 text-sm">
        <a
          href={EPRINT_URL}
          target="_blank"
          rel="noopener noreferrer"
          class="text-blue-400 hover:text-blue-300"
        >
          Paper (eprint) &rarr;
        </a>
      </div>
      <p class="mt-4 text-xs text-gray-500">
        All content below belongs to the original authors. This page
        reproduces the paper for educational purposes. Always
        <a
          href={EPRINT_URL}
          target="_blank"
          rel="noopener noreferrer"
          class="text-blue-400 hover:text-blue-300"
        >cite the original</a>.
      </p>
      <p class="mt-1 text-xs text-gray-600">
        Converted with: {CRAWLER} &middot; {CONVERTED_DATE}
      </p>
    </header>

    <Fragment set:html={CONTENT} />

  </article>
</BaseLayout>
