---
import BaseLayout from '../../layouts/BaseLayout.astro';

const EPRINT_URL = 'https://eprint.iacr.org/2022/342';
const CRAWLER = 'mistral';
const CONVERTED_DATE = '2026-02-16';
const TITLE_HTML = 'From Farfalle to Megafono via Ciminion: The PRF Hydra for MPC Applications';
const AUTHORS_HTML = 'Lorenzo Grassi, Morten Øygarden, Markus Schofnegger, Roman Walch';

const CONTENT = `    <p class="text-gray-300">From Farfalle to Megafono via Ciminion: The PRF Hydra for MPC Applications</p>

    <p class="text-gray-300">Full Version</p>

    <p class="text-gray-300">Lorenzo Grassi¹, Morten Øygarden², Markus Schofnegger³, and Roman Walch⁴,⁵,⁶</p>

    <p class="text-gray-300">¹ Radboud University Nijmegen (Nijmegen, The Netherlands) ² Simula UiB (Bergen, Norway) ³ Horizen Labs (Austin, United States) ⁴ Graz University of Technology (Graz, Austria) ⁵ Know-Center GmbH (Graz, Austria) ⁶ TACEO GmbH (Graz, Austria) lgrassi@science.ru.nl, morten.oygarden@simula.no, mschofnegger@horizenlabs.io, roman.walch@iaik.tugraz.at</p>

    <p class="text-gray-300">Abstract. The area of multi-party computation (MPC) has recently increased in popularity and number of use cases. At the current state of the art, Ciminion, a Farfalle-like cryptographic function, achieves the best performance in MPC applications involving symmetric primitives. However, it has a critical weakness. Its security highly relies on the independence of its subkeys, which is achieved by using an expensive key schedule. Many MPC use cases involving symmetric pseudo-random functions (PRFs) rely on secretly shared symmetric keys, and hence the expensive key schedule must also be computed in MPC. As a result, Ciminion's performance is significantly reduced in these use cases.</p>

    <p class="text-gray-300">In this paper we solve this problem. Following the approach introduced by Ciminion's designers, we present a novel primitive in symmetric cryptography called Megafono. Megafono is a keyed extendable PRF, expanding a fixed-length input to an arbitrary-length output. Similar to Farfalle, an initial keyed permutation is applied to the input, followed by an expansion layer, involving the parallel application of keyed ciphers. The main novelty regards the expansion of the intermediate/internal state for "free", by appending the sum of the internal states of the first permutation to its output. The combination of this and other modifications, together with the impossibility for the attacker to have access to the input state of the expansion layer, make Megafono very efficient in the target application.</p>

    <p class="text-gray-300">As a concrete example, we present the PRF Hydra, an instance of Megafono based on the HADES strategy and on generalized versions of the Lai-Massey scheme. Based on an extensive security analysis, we implement Hydra in an MPC framework. The results show that it outperforms all MPC-friendly schemes currently published in the literature.</p>

    <p class="text-gray-300">Keywords: Megafono – Hydra – Farfalle – Ciminion – MPC Applications</p>

    <p class="text-gray-300">1 Introduction</p>

    <p class="text-gray-300">Secure multi-party computation (MPC) allows several parties to jointly and securely compute a function on their combined private inputs. The correct output is computed and given to all parties (or a subset) while hiding the private inputs from other parties. In this work we focus on secret-sharing based MPC schemes, such as the popular SPDZ protocol <em>[25, 24]</em> or protocols based on Shamir’s secret sharing <em>[47]</em>. In these protocols private data is shared among all parties, such that each party receives a share which by itself does not contain any information about the initial data. When combined, however, the parties are able to reproduce the shared value. Further, the parties can use these shares to compute complex functions on the data which in turn produce shares of the output.</p>

    <p class="text-gray-300">MPC has been applied to many use cases, including privacy-preserving machine learning <em>[46]</em>, private set intersection <em>[40]</em>, truthful auctions <em>[14]</em>, and revocation in credential systems <em>[38]</em>. In the literature describing these use cases, data is often directly entered from and delivered to the respective parties. However, in practice this data often has to be transferred securely from/to third parties before it can be used in the MPC protocol. Moreover, in some applications, intermediate results of an MPC computation may need to be stored securely in a database. As described in <em>[35]</em>, one can use MPC-friendly pseudo-random functions (PRFs), i.e., PRFs designed to be efficient in MPC, to efficiently realize this secure data storage and data transfer by directly encrypting the data using a secret-shared symmetric key.</p>

    <p class="text-gray-300">Besides being used to securely transmit data in given MPC computations, these MPC-friendly PRFs can also be used as a building block to speed up many MPC applications, such as secure database join via an MPC evaluation of a PRF <em>[44]</em>, distributed data storage <em>[35]</em>, virtual hardware security modules, MPC-in-the-head based zero-knowledge proofs <em>[39]</em> and signatures <em>[17]</em>, oblivious TLS <em>[1]</em>, and many more. In all these use cases, the symmetric encryption key is shared among all participating parties. Consequently, if one has to apply a key schedule for a given PRF, one has to compute this key schedule at least once in MPC for every fresh symmetric key.</p>

    <p class="text-gray-300">To be MPC-friendly, a PRF should minimize the number of multiplications in the native field of the MPC protocol. At the current state of the art, Ciminion <em>[27]</em> is one of the most competitive schemes for PRF applications. Proposed at Eurocrypt’21, it is based on the Farfalle mode of operation <em>[10]</em>. However, as we are going to discuss in detail, Ciminion has a serious drawback: Its security heavily relies on the assumption that the subkeys are independent. For this requirement, the subkeys are generated via a sponge hash function <em>[11]</em> instantiated via an expensive permutation. As a result, in all (common) cases where the key is shared among the parties, the key schedule cannot be computed locally and needs to be evaluated in MPC. This leads to a significant increase in the multiplicative complexity of Ciminion. In this paper, we approach this problem in two steps. First, we propose Megafono, a new mode of operation inspired by</p>

    <p class="text-gray-300">!<a href="img-0.jpeg">img-0.jpeg</a> (a) The Farfalle construction.</p>

    <p class="text-gray-300">!<a href="img-1.jpeg">img-1.jpeg</a> (b) The Ciminion PRF. Fig. 1: Farfalle and Ciminion (notation adapted to the one used in this paper).</p>

    <p class="text-gray-300">Farfalle and Ciminion. <span class="math">^{8}</span>  It is designed to be competitive in all MPC applications. Secondly, we show how to instantiate it in an efficient way. The obtained PRF HYDRA is currently the most competitive MPC-friendly PRF in the literature.</p>

    <p class="text-gray-300">Traditional PRFs (e.g., AES, KECCAK) are not efficient in MPC settings. First, MPC applications usually work over a prime field  <span class="math">\\mathbb{F}_p</span>  for a large  <span class="math">p</span>  (e.g.,  <span class="math">p \\approx 2^{128}</span> ), while traditional cryptographic schemes are usually bit-/byte-oriented. Hence, a conversion between  <span class="math">\\mathbb{F}_{2^n}</span>  and  <span class="math">\\mathbb{F}_p</span>  must take place, which can impact the performance. Secondly, traditional schemes are designed to minimize their plain implementation cost, and therefore no particular focus is laid on minimizing specifically the number of nonlinear operations (e.g., AND gates).</p>

    <p class="text-gray-300">For these reasons, several MPC-friendly schemes over  <span class="math">\\mathbb{F}_q^p</span>  for  <span class="math">q = p^s</span>  and  <span class="math">t\\geq 1</span>  have been proposed in the literature, including LowMC [4], MiMC [3], GMiMC [2], HADEsMiMC [33], and Rescue [5]. All those schemes are block ciphers - hence, invertible - and they are often used in counter (CTR) mode. However, invertibility is not required in MPC applications, and a lower multiplicative complexity may be achieved by working with non-invertible functions, as recently shown by in [27]. In the following, we briefly discuss the Farfalle construction and the MPC-friendly primitive Ciminion based on it.</p>

    <p class="text-gray-300">Farfalle. Farfalle [10] is an efficiently parallelizable permutation-based construction of arbitrary input and output length, taking as input a key. As shown in Fig. 1a and recalled in Section 3, the Farfalle construction consists of a compression layer followed by an expansion layer. The compression layer produces</p>

    <p class="text-gray-300">a single accumulator value from the input data. A permutation is potentially applied to the obtained state. Then, the expansion layer transforms it into a tuple of (truncated) output blocks. Both the compression and expansion layers involve the secret key, and they are instantiated via a set of permutations (namely, <span class="math">\\mathcal{P}^{(c)},\\mathcal{P},\\mathcal{P}^{(e)}</span>) and rolling functions (<span class="math">\\mathcal{R}^{(c)}_{i},\\mathcal{R}^{(e)}_{i}</span>).</p>

    <h4 id="sec-2" class="text-lg font-semibold mt-6">Ciminion.</h4>

    <p class="text-gray-300">As shown with Ciminion in <em>[27]</em>, a modified version of Farfalle based on a Feistel scheme can be competitive for MPC protocols, an application which Farfalle’s designers did not consider. Following Fig. 1(b) and Section 3,</p>

    <ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">

      <li>compared to Farfalle, the compression phase is missing, a final truncation is applied, and the key addition is performed before <span class="math">\\mathcal{P}^{(e)}</span> is applied, and</li>

      <li>in contrast to MPC-friendly block ciphers, Ciminion is a <em>non-invertible</em> PRF. For encryption it is used as a stream cipher, where the input is defined as the concatenation of the secret key and a nonce.</li>

    </ol>

    <p class="text-gray-300">The main reason why Ciminion is currently the most competitive scheme in MPC protocols is related to one crucial feature of Farfalle, namely the possibility to instantiate its internal permutations with a smaller number of rounds compared to other design strategies. This is possible since the attacker does not have access to the internal states of the Farfalle construction. Hence, while the permutation <span class="math">\\mathcal{P}^{(c)}</span> is designed in order to behave like a pseudo-random permutation (PRP), the number of rounds of the permutation <span class="math">\\mathcal{P}^{(e)}</span> can be minimized and kept significantly lower for both security and good performance.</p>

    <p class="text-gray-300">Besides minimizing the number of nonlinear operations, Ciminion’s designers paid particular attention to the number of linear operations. Indeed, even though the main cost in MPC applications depends on the number of multiplications, other factors (e.g., the number of linear operations) affect efficiency as well.</p>

    <h3 id="sec-3" class="text-xl font-semibold mt-8">1.2 The Megafono Design Strategy</h3>

    <p class="text-gray-300">The main drawback of Ciminion is the expensive key schedule to generate subkeys that can be considered independent. This implies that Ciminion only excels in MPC applications where the key schedule can be precomputed for a given shared key, or in the (non-common) scenarios where the key is not shared among the parties. However, in the latter case, the party knowing the key can also compute Ciminion’s keystream directly in plain (i.e., without MPC) if the nonce and IV are public in a given use case (which is also true for any stream cipher).</p>

    <p class="text-gray-300">Clearly, the easiest solution is the removal of the nonlinear key schedule. However, by e.g. defining the subkey as an affine function of the master key, the security analysis of Ciminion does not hold anymore. As we discuss in detail in Section 4, this is a direct consequence of the Farfalle construction itself. Even if the attacker does not have any information about the internal states of Farfalle, they can exploit the fact that its outputs are generated from the same unknown input (namely, the output of <span class="math">\\mathcal{P}^{(c)}</span> and/or <span class="math">\\mathcal{P}</span>). Given these outputs and by exploiting the relations of the corresponding unknown inputs (which are related to</p>

    <p class="text-gray-300">the definition of the rolling function), the attacker can potentially find the key and break the scheme. For example, this strategy is exploited in the attacks on the Farfalle schemes Kravatte and Xoofff <em>[16, 20]</em>. In Ciminion, this problem is solved by including additions with independent secret subkeys in the application of the rolling function. In this way, the mentioned relation is unknown due to the presence of the key, and <span class="math">\\mathcal{P}^{(e)}</span> can be instantiated via an efficient permutation.</p>

    <p class="text-gray-300">We make the following three crucial changes in the Farfalle design strategy.</p>

    <ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">

      <li>First, we replace the permutation <span class="math">\\mathcal{P}^{(e)}</span> with a keyed permutation <span class="math">\\mathcal{C}_{k}</span>.</li>

      <li>Secondly, we expand the input of this keyed permutation. The second change aims to frustrate algebraic attacks, whose cost is related to both the degree and the number of variables of the nonlinear equation system representing the attacked scheme. In order to create new independent variables for “free” (i.e., without increasing the overall multiplicative complexity), we reuse the computations needed to evaluate <span class="math">\\mathcal{P}</span>. That is, we define the new variable as the sum of all the internal state of <span class="math">\\mathcal{P}</span>, and we conjecture that it is sufficiently independent of its output (details are provided in the following).</li>

      <li>Finally, we replace the truncation in Ciminion with a feed-forward operation, for avoiding to discard any randomness without any impact on the security.</li>

    </ol>

    <p class="text-gray-300">Our result is a new design strategy which we call Megafono.</p>

    <h3 id="sec-4" class="text-xl font-semibold mt-8">1.3 The PRF Hydra</h3>

    <p class="text-gray-300">Given the mode of operation, we instantiate it with two distinct permutations, one for the initial phase and one for the expansion phase. As in Ciminion, assuming the first keyed permutation behaves like a PRP and since the attacker does not know the internal states of Megafono, we choose a second permutation that is cheaper to evaluate in the MPC setting. In particular, while the first permutation is evaluated only once, the number of calls to the second permutation (and so the overall cost) is proportional to the output size.</p>

    <p class="text-gray-300">For minimizing the multiplicative complexity, we instantiate the round functions of the keyed permutations <span class="math">\\mathcal{C}_{k}</span> in the expansion part with quadratic functions. However, since no quadratic function is invertible over <span class="math">\\mathbb{F}_{p}</span>, we use them in a mode of operation that guarantees invertibility. We opted for the generalized Lai–Massey constructions similar to the ones recently proposed in <em>[34]</em>. Moreover, we show that the approach of using of high-degree power maps with low-degree inverses proposed in <em>Rescue</em> does not have any benefits in this scenario.</p>

    <p class="text-gray-300">We instantiate the first permutation <span class="math">\\mathcal{P}</span> via the Hades strategy <em>[33]</em>, which mixes rounds with full S-box layers and rounds with partial S-box layers. Similar to Neptune <em>[34]</em>, we use two different round functions, one for the internal part and one for the external one. We decided to instantiate the internal rounds with a Lai–Massey scheme, and the external ones with invertible power maps.</p>

    <p class="text-gray-300">The obtained PRF scheme called Hydra is presented in Section 5 and Section 6, and its security analysis is proposed in Section 7.</p>

    <p class="text-gray-300">!<a href="img-2.jpeg">img-2.jpeg</a> Fig. 2: Number of MPC multiplications of several designs over  <span class="math">\\mathbb{F}_p^t</span> , with  <span class="math">p \\approx 2^{128}</span>  and  <span class="math">t \\geq 2</span>  (security level of 128 bits).</p>

    <p class="text-gray-300">The performance of any MPC calculation scales with the number of nonlinear operations. In Figure 2 we compare the number of multiplications required to evaluate different PRFs for various plaintext sizes  <span class="math">t</span>  using secret shared keys. One can observe that HYDRA requires the smallest number of multiplications, with the difference growing further for larger sizes. The only PRF that is competitive to HYDRA is Ciminion, but only if the key schedule does not have to be computed, which happens if shared round keys can be reused from a previous computation. However, this implies that the key schedule was already computed once in MPC, requiring a significant amount of multiplications. HYDRA, on the other hand, does not require the computation of an expensive key schedule and also requires fewer multiplications than Ciminion without a key schedule for larger state sizes.</p>

    <p class="text-gray-300">In Section 8, we implement and compare the different PRFs in the MP-SPDZ [41] library and confirm the results expected from Figure 2. Indeed,</p>

    <p class="text-gray-300">(1) taking key schedules into account, HYDRA is five times faster than Ciminion for  <span class="math">t = 8</span> , which grows to a factor of 21 for  <span class="math">t = 128</span> , (2) without key schedules, Ciminion is only slightly faster than HYDRA for smaller  <span class="math">t</span> , until it gets surpassed by HYDRA for  <span class="math">t &amp;gt; 16</span> , showing that HYDRA is also competitive, even if the round keys are already present.</p>

    <p class="text-gray-300">Compared to all other benchmarked PRFs, HYDRA is significantly faster for any state size  <span class="math">t</span> . Furthermore, HYDRA requires the least amount of communication between the parties due to its small number of multiplications, giving it an advantage in low-bandwidth networks. As a result, we suggest to replace each of</p>

    <p class="text-gray-300">the benchmarked PRFs with Hydra in all their use cases, especially if a large number of words need to be encrypted.</p>

    <h3 id="sec-6" class="text-xl font-semibold mt-8">1.5 Notation</h3>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Throughout the paper, we work over a finite field <span class="math">\\mathbb{F}_{q}</span>, where <span class="math">q=p^{s}</span> for an odd prime number <span class="math">p</span> and an integer <span class="math">s\\geq 1</span> (when needed, we will also assume a fixed vector space isomorphism <span class="math">\\mathbb{F}_{p^{s}}\\cong\\mathbb{F}_{p}^{s}</span>). We use <span class="math">\\mathbb{F}_{q}^{n}</span>, for <span class="math">n\\geq 1</span>, to denote the <span class="math">n</span>-dimensional vector space over <span class="math">\\mathbb{F}_{q}</span>, and we use the notation <span class="math">\\mathbb{F}_{q}^{\\star}</span> to denote <span class="math">\\mathbb{F}_{q}</span> strings of arbitrary length. The $\\cdot\\></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\>\\cdot<span class="math"> operator denotes the concatenation of two elements. An element </span>x\\in\\mathbb{F}_{q}^{t}<span class="math"> is represented as </span>x=(x_{0},x_{1},\\ldots,x_{t-1})<span class="math">, where </span>x_{i}<span class="math"> denotes its </span>i<span class="math">-th entry. Given a matrix </span>M\\in\\mathbb{F}_{q}^{t\\times s}<span class="math">, we denote its entry in row </span>r<span class="math"> and column </span>c<span class="math"> either as </span>M_{r,c}<span class="math"> or </span>M[r,c]<span class="math">. We use the Fraktur font notation to denote a subspace of </span>\\mathbb{F}_{q}^{r}<span class="math">, while we sometimes use the calligraphic notation to emphasize functions. Given integers </span>a\\geq b\\geq 1<span class="math">, we define the truncation function </span>\\mathcal{T}_{a,b}:\\mathbb{F}_{q}^{a}\\to\\mathbb{F}_{q}^{b}<span class="math"> as </span>\\mathcal{T}_{a,b}(x_{0},\\ldots,x_{a-1})=(x_{0},\\ldots,x_{b-1})<span class="math">. Finally, for MPC, we describe that the value </span>x\\in\\mathbb{F}_{p}<span class="math"> is secret shared among all parties by </span>[x]$.</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <h2 id="sec-7" class="text-2xl font-bold">2 Symmetric Primitives for MPC Applications</h2>

    <p class="text-gray-300">Here we elaborate on why expensive key schedules are not desirable in many MPC use cases, and we discuss the cost metric in MPC protocols in more details.</p>

    <h3 id="sec-8" class="text-xl font-semibold mt-8">2.1 MPC Use Cases and Key Schedules</h3>

    <p class="text-gray-300">To highlight that expensive key schedules are not suitable for many scenarios, we describe the use cases discussed in <em>[27]</em> and <em>[35]</em> in greater detail. Concretely, we discuss the data transfer into and out of the MPC protocol, as well as using symmetric PRFs to securely store intermediate results during an MPC evaluation. In the latter case, the setting is the following: The parties want to suspend the MPC evaluation and continue at a later point. As discussed in <em>[35]</em>, the trivial solution for this problem is that each party encrypts its share of the data with a symmetric key and stores the encrypted share, e.g., at a cloud provider. The total storage overhead of this approach is a factor <span class="math">n</span> for <span class="math">n</span> MPC parties, since each party stores its encrypted shares of the data. Additionally, each party needs to memorize its symmetric key. The solution to reduce the storage overhead is to use a secret shared symmetric key (i.e., each party knows only a share of the key and the real symmetric key remains hidden), which can directly be sampled as part of the MPC protocol, and encrypt the data using MPC. The resulting ciphertexts cannot be decrypted by any party since no one knows the symmetric key, but can be used inside the MPC protocols at a later point to again create the shares of the data. This approach avoids the storage overhead of the data, and each party only has to memorize its share of the symmetric key which has the same size as the symmetric key itself. However, if the used PRF involves a key schedule, one also has to compute it in MPC for this use case. Other solutions</p>

    <p class="text-gray-300">either involve precomputing the round keys, or directly sampling random round keys in MPC instead of sampling a random symmetric key. These approaches require no storage overhead for the encrypted data, but each party needs to memorize its shares of the round keys. In Ciminion, the size of the round keys is equivalent to the size of the encrypted data (when using the same nonce for encrypting the full dataset), hence the whole protocol would be more efficient if each party would just memorize its shares of the dataset instead. Providing fewer round keys and using multiple nonces instead requires the recomputation of Ciminion’s initial permutation in MPC, decreasing its performance.</p>

    <p class="text-gray-300">Similar considerations also apply if the MPC parties are different from the actual data providers or if the output of the computation needs to be securely transferred to an external party. The solutions to both problems involve storing the dataset encrypted at some public place (e.g., in a cloud) alongside a public-key encryption of the shares of the symmetric key, such that only the intended recipient can get the shares. If the parties want to avoid expensive key schedules in MPC, they either have to provide shares of the round keys (which have the same size as the encrypted data in Ciminion), or provide fewer round keys alongside multiple nonces, decreasing the performance in MPC.</p>

    <h6 id="sec-9" class="text-base font-medium mt-4">Remark 1</h6>

    <p class="text-gray-300">In this paper, we focus on comparing MPC-friendly PRFs which are optimized for similar use cases as the ones discussed in this section, i.e., use cases which require fast MPC en-/decryption of large amounts of data. Hence, we do not focus on PRFs not defined over <span class="math">\\mathbb{F}_{p}</span> which are optimized for, e.g., Picnic-style signatures, such as LowMC <em>[4]</em>, Rain <em>[28]</em>, or weakPRF <em>[26]</em>.</p>

    <h3 id="sec-10" class="text-xl font-semibold mt-8">2.2 Cost Metric for MPC Applications</h3>

    <p class="text-gray-300">Modern MPC protocols such as SPDZ <em>[25, 24]</em> are usually split into a data-independent <em>offline phase</em> and a data-dependent <em>online phase</em>. In the offline phase, a bundle of shared correlated randomness is generated, most notably Beaver triples <em>[9]</em> of the form <span class="math">([a],[b],[a\\cdot b])</span>. This bundle is then used in the online phase to perform the actual computation on the private data.</p>

    <p class="text-gray-300">Roughly speaking, the performance scales with the number of nonlinear operations necessary to evaluate the symmetric primitives in the MPC protocol (sometimes we use the term “multiplication” to refer to the nonlinear operation). This is motivated by the fact that each multiplication requires one Beaver triple, which is computed in the offline phase, as well as one round of communication during the online phase (see Appendix D). In contrast, linear operations do not require any offline computations and can directly be applied to the shares without communication. Consequently, the number of multiplications is a decent first estimation of the cost metric in MPC, and MPC-friendly PRFs usually try to minimize this number. Whereas each multiplication requires communication between the parties, the depth directly defines the required number of communication rounds, since parallel multiplications can be processed in the same round. Thus, the depth should be low in high-latency networks. To summarize,</p>

    <ul class="list-disc list-inside space-y-1 text-gray-300 my-2 ml-4">

      <li>the cost of the offline phase of the MPC protocols directly scales with the number of required Beaver triples (i.e., multiplications), and</li>

      <li>the cost of the online phase scales with both the number of multiplications and the multiplicative depth.</li>

    </ul>

    <p class="text-gray-300">As a concrete example, in many MPC-friendly PRFs, such as HadesMiMC, MiMC, GMiMC, and <em>Rescue</em>, the nonlinear layer is instantiated with a power map <span class="math">R(x)=x^{d}</span> for <span class="math">d\\geq 2</span> over <span class="math">\\mathbb{F}_{q}</span>. Then, the cost per evaluation is</p>

    <p class="text-gray-300"><span class="math">\\#\\texttt{triples}=\\texttt{cost}_{d}:=\\mathrm{hw}(d)+\\lfloor\\log_{2}(d)\\rfloor-1\\,,\\qquad\\texttt{depth}_{\\mathrm{online}}=\\texttt{cost}_{d}\\,.</span> (1)</p>

    <p class="text-gray-300">Several algorithms to reduce the number of multiplications and communication rounds were developed in the literature. Here we discuss those relevant for our goals. They require random pairs <span class="math">[r],[r^{2}]</span>, and <span class="math">[r],[r^{-1}]</span>, which can be generated from Beaver triples in the offline phase (see Algorithm 2 and Algorithm 3).</p>

    <h4 id="sec-11" class="text-lg font-semibold mt-6">Decreasing the Number of Online Communication Rounds.</h4>

    <p class="text-gray-300">In the preferred case of <span class="math">d=3</span>, the cost is two Beaver triples and a depth of two. However, in <em>[35]</em> the authors propose a method to reduce the multiplicative depth by delegating the cubing operation to a random value in the offline phase. Hence, all cubings can be performed in parallel reducing the depth. This algorithm (see Algorithm 4) requires two triples, but only one online communication round.</p>

    <h4 id="sec-12" class="text-lg font-semibold mt-6">Special Case: <span class="math">R(x)=x^{1/d}</span>.</h4>

    <p class="text-gray-300">Optimizations can also be applied for the case <span class="math">R(x)=x^{d}</span> with very large <span class="math">d</span>. In <em>[5]</em>, the authors propose two different algorithms to evaluate <span class="math">R</span> (see Algorithm 5 and Algorithm 6), in which the cost of evaluating <span class="math">R(x)=x^{d}</span> can be reduced to the cost of evaluating <span class="math">R(x)=x^{1/d}</span> (plus an additional multiplication in the online phase) which requires significantly fewer multiplications if <span class="math">1/d</span> is smaller than <span class="math">d</span>. This is, for example, relevant when evaluating <em>Rescue</em> with its high-degree power maps in MPC. The algorithm works by delegating the <span class="math">1/d</span> power map evaluation to the offline phase, and evaluating the costly <span class="math">d</span> power map on a random value in plain. Furthermore, since the main MPC work (i.e., <span class="math">1/d</span>) is evaluated in the input-independent offline phase, all communication rounds can be parallelized, significantly reducing the multiplicative depth. Using these algorithms and <span class="math">\\texttt{cost}_{d}</span> from Eq. (1), the cost of evaluating <span class="math">x^{d}</span> in MPC is modified to the following, with a significantly smaller multiplicative depth and a smaller number of multiplications for large <span class="math">d</span>:</p>

    <p class="text-gray-300"><span class="math">\\#\\texttt{triples}=2+\\min\\left\\{\\texttt{cost}_{d},\\texttt{cost}_{1/d}\\right\\}\\,,\\qquad\\texttt{depth}_{\\mathrm{online}}=2.</span></p>

    <h2 id="sec-13" class="text-2xl font-bold">3 Starting Points of Megafono: Farfalle and Ciminion</h2>

    <p class="text-gray-300">Here we recall Farfalle and Ciminion, which are starting points for Megafono.</p>

    <p class="text-gray-300">Farfalle and  <span class="math">^{1/2 \\times}</span>  Farfalle. Farfalle is a keyed PRF proposed in [10] with inputs and outputs of arbitrary length. As shown in Fig. 1a, it has a compression layer and an expansion layer, each involving the parallel application of a permutation. For our goal, we focus only on the expansion phase, and introduce the term  <span class="math">^{1/2 \\times}</span>  Farfalle for a modified version of Farfalle that lacks the initial compression phase and only accepts input messages of a fixed size  <span class="math">n</span> .</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Let  <span class="math">\\mathbb{K} \\in \\mathbb{F}_q^\\kappa</span>  be the secret key for  <span class="math">\\kappa \\geq 1</span> .  <span class="math">^{1/2 \\times}</span>  Farfalle uses a key schedule  <span class="math">\\mathcal{K}: \\mathbb{F}_q^\\kappa \\to (\\mathbb{F}_q^n)^\\star</span>  for the subkeys used in the expansion phase, two unkeyed permutations  <span class="math">\\mathcal{P}, \\mathcal{P}^{(e)}: \\mathbb{F}_q^n \\to \\mathbb{F}_q^n</span> , and a rolling function  <span class="math">\\mathcal{R}: \\mathbb{F}_q^n \\to \\mathbb{F}_q^n</span> . We define  <span class="math">\\mathcal{R}_i</span>  as  <span class="math">\\mathcal{R}_i(y) = \\rho_i + \\mathcal{R} \\circ \\mathcal{R}_{i-1}(y)</span>  for each  <span class="math">i \\geq 1</span>  and  <span class="math">\\rho_i \\in \\mathbb{F}_q^n</span> , where we assume  <span class="math">\\mathcal{R}_0</span>  to be the identity function, i.e.,  <span class="math">\\mathcal{R}_0(y) = y</span> . Given an input  <span class="math">x \\in \\mathbb{F}_q</span> ,  <span class="math">^{1/2 \\times}</span>  Farfalle:  <span class="math">\\mathbb{F}_q^n \\to (\\mathbb{F}_q^n)^\\star</span>  operates as  <span class="math">^{1/2 \\times}</span>  Farfalle  $(x) = y_0</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">y_1</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">y_2</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\dots</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">y_j</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\dots<span class="math"> , where  </span>\\forall i \\geq 0: y_i := k_{i+1} + \\mathcal{P}^{(e)} (\\mathcal{R}_i (\\mathcal{P}(x + k_0)))$ .</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">From  <span class="math">^{1/2 \\times}</span>  Farfalle to Ciminion. Ciminion [27] is based on a modified version of  <span class="math">^{1/2 \\times}</span>  Farfalle over  <span class="math">\\mathbb{F}_q^n</span>  for a certain  <span class="math">n \\geq 2</span> . As shown in Fig. 1b, the main difference with respect to  <span class="math">^{1/2 \\times}</span>  Farfalle is the definition of the function  <span class="math">k + \\mathcal{P}^{(e)}</span> . In Farfalle/ <span class="math">^{1/2 \\times}</span>  Farfalle, the key addition is the last operation. In Ciminion,  <span class="math">k + \\mathcal{P}^{(e)}(x)</span>  is replaced by  <span class="math">\\mathcal{F}^{(e)}(x + k)</span>  for a non-invertible function  <span class="math">\\mathcal{F}^{(e)}</span>  instantiated via a truncated permutation, i.e.,  <span class="math">\\mathcal{F}^{(e)}(x + k) := \\mathcal{T}_{n,n&#x27;} \\circ \\mathcal{P}^{(e)}(x + k)</span>  for a certain  <span class="math">1 \\leq n&#x27; &amp;lt; n</span> . Moving the key inside the scheme prevents its cancellation when using the difference of two outputs.</p>

    <p class="text-gray-300">In Ciminion, the key schedule  <span class="math">\\mathcal{K}:\\mathbb{F}_q^\\kappa \\to (\\mathbb{F}_q^n)^\\star</span>  uses a sponge function [11] instantiated via the permutation  <span class="math">\\mathcal{P}</span> . We refer to [27, Section 2] for more details.</p>

    <p class="text-gray-300">Generating the subkeys of Ciminion via a sponge function and a strong permutation is expensive in terms of multiplications. This makes it inefficient in cases where the secret keys are shared among the parties, as discussed in Section 2.1. Another weakness of Ciminion is the final truncation. While it prevents an attacker from computing the inverse of the final permutations  <span class="math">\\mathcal{P}^{(e)}</span> , it is wasteful as it lowers the output of each iteration. To fix these issues, here we propose the Megafono strategy, based on the design strategy of Ciminion (and  <span class="math">^{1/2 \\times}</span>  Farfalle), but with some crucial modifications.</p>

    <p class="text-gray-300">Definition of Megafono. Let  <span class="math">n \\geq 1</span>  be an integer and let  <span class="math">\\mathbb{F}_q</span>  be a field, where  <span class="math">q = p^s</span>  for a prime integer  <span class="math">p \\geq 2</span>  and a positive integer  <span class="math">s \\geq 1</span> . Let  <span class="math">\\mathbb{K} \\in \\mathbb{F}_q^\\kappa</span>  be the secret key for  <span class="math">n \\geq \\kappa \\geq 1</span> . The ingredients of Megafono are</p>

    <ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">

      <li>a key schedule <span class="math">\\mathcal{K}:\\mathbb{F}_{q}^{n}\\to(\\mathbb{F}_{q}^{n})^{\\star}</span> for generating the subkeys, that is, <span class="math">\\mathcal{K}(\\mathtt{K})=(k_{0},k_{1},\\ldots,k_{i},\\ldots)</span> where <span class="math">k_{i}\\in\\mathbb{F}_{q}^{n}</span> for each <span class="math">i\\geq 0</span>,</li>

      <li>an iterated unkeyed permutation <span class="math">\\mathcal{P}:\\mathbb{F}_{q}^{n}\\to\\mathbb{F}_{q}^{n}</span> defined as</li>

    </ol>

    <p class="text-gray-300"><span class="math">\\mathcal{P}(x)=\\mathcal{P}_{r-1}\\circ\\ldots\\circ\\mathcal{P}_{1}\\circ\\mathcal{P}_{0}(x)</span> (2)</p>

    <p class="text-gray-300">for round permutations <span class="math">\\mathcal{P}_{0},\\mathcal{P}_{1},\\ldots,\\mathcal{P}_{r-1}</span> over <span class="math">\\mathbb{F}_{q}^{n}</span>,</p>

    <ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">

      <li>a (sum) function <span class="math">\\mathcal{S}:\\mathbb{F}_{q}^{n}\\to\\mathbb{F}_{q}^{n}</span> defined as</li>

    </ol>

    <p class="text-gray-300"><span class="math">\\mathcal{S}(x):=\\sum_{i=0}^{r-1}\\mathcal{P}_{i}\\circ\\ldots\\circ\\mathcal{P}_{1}\\circ\\mathcal{P}_{0}(x),</span> (3)</p>

    <ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">

      <li>a function <span class="math">\\mathcal{F}_{k}:\\mathbb{F}_{q}^{2n}\\to\\mathbb{F}_{q}^{2n}</span> defined as</li>

    </ol>

    <p class="text-gray-300"><span class="math">\\mathcal{F}_{k}(x):=\\mathcal{C}_{k}(x)+x,</span></p>

    <p class="text-gray-300">where <span class="math">\\mathcal{C}_{k}:\\mathbb{F}_{q}^{2n}\\to\\mathbb{F}_{q}^{2n}</span> is a block cipher for a secret key <span class="math">k\\in\\mathbb{F}_{q}^{2n}</span>, and</p>

    <ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">

      <li>a rolling function <span class="math">\\mathcal{R}:\\mathbb{F}_{q}^{2n}\\to\\mathbb{F}_{q}^{2n}</span>. For <span class="math">y,z\\in\\mathbb{F}^{n}</span>, we further define</li>

    </ol>

    <p class="text-gray-300"><span class="math">\\mathcal{R}_{i}(y,z):=\\varphi_{i}+\\mathcal{R}\\circ\\mathcal{R}_{i-1}(y,z)</span></p>

    <p class="text-gray-300">for <span class="math">i\\geq 1</span>, where <span class="math">\\varphi_{i}\\in\\mathbb{F}_{q}^{2n}</span> and <span class="math">\\mathcal{R}_{0}(y,z)=(y,z)</span>.</p>

    <p class="text-gray-300"><span class="math">\\textsc{Megafono}_{\\mathtt{K}}:\\mathbb{F}_{q}^{n}\\to(\\mathbb{F}_{q}^{n})^{\\star}</span> is a PRF that takes as input an element of <span class="math">\\mathbb{F}_{q}^{n}</span> and returns an output of a desired length, defined as</p>

    <p class="text-gray-300"><span class="math">\\textsc{Megafono}_{\\mathtt{K}}(x)\\coloneqq\\mathcal{F}_{k_{2}}(y,z)\\mid\\mid\\mathcal{F}_{k_{3}}(\\mathcal{R}_{1}(y,z))\\mid\\mid\\cdots\\mid\\mid\\mathcal{F}_{k_{i+2}}(\\mathcal{R}_{i}(y,z))\\mid\\mid\\cdots</span></p>

    <p class="text-gray-300">for <span class="math">i\\in\\mathbb{N}</span>, where <span class="math">y,z\\in\\mathbb{F}_{q}^{n}</span> are defined as</p>

    <p class="text-gray-300"><span class="math">y:=k_{1}+\\mathcal{P}(x+k_{0})\\qquad\\text{ and }\\qquad z:=\\mathcal{S}(x+k_{0})\\,.</span></p>

    <h6 id="sec-15" class="text-base font-medium mt-4">Remark 2.</h6>

    <p class="text-gray-300">The main goal of Megafono is a secure variant of Ciminion without a heavy key schedule and without relying on independent subkeys <span class="math">(k_{0},k_{1},\\ldots)</span>. For this reason, we only consider the case <span class="math">k=n</span> and <span class="math">\\mathcal{K}(\\mathtt{K})=(\\mathtt{K},\\ldots,\\mathtt{K},\\ldots)</span> in the following. Nevertheless, there may be applications in which a key schedule is acceptable, and hence we propose Megafono in its more general form.</p>

    <h6 id="sec-16" class="text-base font-medium mt-4">Remark 3.</h6>

    <p class="text-gray-300">The function <span class="math">\\mathcal{F}_{k}</span> is meant to play the role of <span class="math">\\mathcal{P}^{(e)}</span> (in the notation we have used to describe Farfalle and Ciminion). We use this notation to emphasize that the function is keyed and that we no longer require it to be a permutation.</p>

    <h3 id="sec-17" class="text-xl font-semibold mt-8">4.1 Rationale of Megafono</h3>

    <p class="text-gray-300">Following its structure, Megafono shares several characteristics with Ciminion and <span class="math">{}^{1/2\\times}</span>Farfalle. Indeed, many attacks on Farfalle (and Ciminion, <span class="math">{}^{1/2\\times}</span>Farfalle) discussed in <em>[10, Sect. 5]</em> also apply to Megafono. Here we focus on the differences, by explaining and motivating the criteria for designing Megafono.</p>

    <h4 id="sec-18" class="text-lg font-semibold mt-6">Expansion Phase.</h4>

    <p class="text-gray-300">We emphasize the following point which is crucial for understanding the design rationale of Megafono. As in <span class="math">{}^{1/2\\times}</span>Farfalle and Ciminion, the attacker has access to outputs <span class="math">w_{i}=\\mathcal{F}_{k}\\left(\\mathcal{R}_{i}(y,z)\\right)</span> for <span class="math">i\\geq 0</span> that depend on a <em>single common</em> unknown input <span class="math">(y,z)</span> (in addition to the key). By exploiting the relation among several inputs of <span class="math">\\mathcal{F}_{k}</span> and the knowledge of the corresponding outputs, the attacker can break the entire scheme. Examples of such attacks can be found in <em>[16, 20]</em>. In this scenario, one attack consists of solving the system of equations <span class="math">\\{w_{i}-\\mathcal{F}_{k}\\left(\\mathcal{R}_{i}(y,z)\\right)=0\\}_{i\\geq 0}</span> with Gröbner bases. We provide details in Section 7.4 and point out that the cost depends on several factors, including (i) the number of variables, (ii) the number of equations, (iii) the degree of the equations, and (iv) the considered representative of the system of equations.</p>

    <h4 id="sec-19" class="text-lg font-semibold mt-6">Even–Mansour Construction.</h4>

    <p class="text-gray-300">In Ciminion, the keyed permutation <span class="math">\\mathcal{P}</span> is chosen in order to resemble a PRP. Indeed, since <span class="math">\\mathcal{P}</span> is computed only once, it has little impact on the overall cost. Further, if <span class="math">\\mathcal{P}</span> resembles a PRP, it is unlikely that an attacker can create texts with a special structure at the input of <span class="math">\\mathcal{P}^{(e)}</span>. This allows for a simplified security analysis of the expansion phase, as it rules out attacks that require control of the inputs of <span class="math">\\mathcal{P}^{(e)}</span>.</p>

    <p class="text-gray-300">By performing a key addition before the expansion phase, the first part of the scheme becomes an Even–Mansour construction <em>[30]</em> of the form <span class="math">x\\mapsto\\mathtt{K}+\\mathcal{P}(x+\\mathtt{K})</span>. As proven in <em>[21, 29]</em>, an Even–Mansour scheme is indistinguishable from a random permutation up to <span class="math">q^{n/2}</span> queries for <span class="math">\\mathtt{K}\\in\\mathbb{F}_{q}^{n}</span>, assuming both the facts that (i) the unkeyed permutation <span class="math">\\mathcal{P}</span> behaves as a pseudo-random public permutation, and that (ii) the attacker knows both the inputs and outputs of the construction. Since <span class="math">n/2\\cdot\\log_{2}(q)</span> is higher than our security level, this allows us to make a security claim on a subcomponent of the entire scheme, and so to further simplify the overall security analysis.</p>

    <h4 id="sec-20" class="text-lg font-semibold mt-6">Keyed Permutation in the Expansion Phase.</h4>

    <p class="text-gray-300">In Farfalle, the final key addition is crucial against attacks inverting the final permutation <span class="math">\\mathcal{P}^{(e)}</span>. However, an attacker can cancel the influence of the key by using the differences of two outputs if the key schedule is linear. For example, assume that the key schedule for the expansion phase is the identity map (as in Farfalle), and let <span class="math">x</span> be the input of the expansion phase. Let <span class="math">y_{j}=\\mathtt{K}+\\mathcal{P}^{(e)}(\\mathcal{R}_{j}(x))</span> and <span class="math">y_{h}=\\mathtt{K}+\\mathcal{P}^{(e)}(\\mathcal{R}_{h}(x))</span> be two outputs of the expansion phase. Any difference of the form</p>

    <p class="text-gray-300"><span class="math">y_{j}-y_{h}=\\mathcal{P}^{(e)}(\\mathcal{R}_{j}(x))-\\mathcal{P}^{(e)}(\\mathcal{R}_{h}(x))</span> (4)</p>

    <p class="text-gray-300">results in a system of equations that is <em>independent of the key</em> or, equivalently, that depends only on the intermediate unknown state. This is an advantage when trying to solve the associated polynomial system with Gröbner bases.</p>

    <p class="text-gray-300">The key in Ciminion has been moved from the end of <span class="math">\\mathcal{P}^{(e)}</span> to the beginning, with the goal of preventing its cancellation by considering differences of the outputs. Inverting <span class="math">\\mathcal{P}^{(e)}</span> is instead prevented by introducing a final truncation, which has the side effect of reducing the output size and thus the throughput.</p>

    <p class="text-gray-300">Recently, in <em>[8]</em> the authors showed that moving the key inside of <span class="math">\\mathcal{P}^{(e)}</span> is actually <em>not</em> sufficient by itself for preventing the construction of a system of equations – similar to (Eq. (4)) – which is independent of the secret key. For this reason, instead of working with a permutation-based non-invertible function, we propose to instantiate the last permutation with a block cipher <span class="math">\\mathcal{C}_{k}</span>, defined as an iterated permutation with a key addition in each round. In this way, we achieve the advantages of both <span class="math">{}^{1/2\\times}</span>Farfalle and Ciminion. First, the output size of <span class="math">\\mathcal{C}_{k}</span> is equal to the input size and it is not possible to invert <span class="math">\\mathcal{C}_{k}</span> without guessing the key (as in <span class="math">{}^{1/2\\times}</span>Farfalle). Secondly, a carefully chosen <span class="math">\\mathcal{C}_{k}</span> will prevent the possibility to set up a system of equations for the expansion part that is independent of the key by considering differences of outputs (as in Ciminion).</p>

    <h5 id="sec-21" class="text-base font-semibold mt-4">Feed-Forward in Expansion Phase and Nonlinear Rolling Function.</h5>

    <p class="text-gray-300">The proposed changes in Megafono may allow new potential problems. Let <span class="math">v_{j}=\\mathcal{C}_{k}\\left(\\mathcal{R}_{j}(y,z)\\right)</span> and <span class="math">v_{l}=\\mathcal{C}_{k}\\left(\\mathcal{R}_{l}(y,z)\\right)</span> be two outputs of the expansion phase for a shared input <span class="math">(y,z)</span> and let <span class="math">\\mathcal{R}^{\\prime}_{j-l}</span> denote the function satisfying <span class="math">\\mathcal{R}^{\\prime}_{j-l}\\circ\\mathcal{R}_{l}(\\cdot)=\\mathcal{R}_{j}(\\cdot)</span> for <span class="math">j&gt;l</span>. Since <span class="math">\\mathcal{C}_{k}(\\cdot)</span> is invertible for each fixed <span class="math">k</span>, we have that</p>

    <p class="text-gray-300"><span class="math">\\forall j&gt;l:\\qquad\\mathcal{C}_{k}\\circ\\mathcal{R}^{\\prime}_{j-l}\\circ\\mathcal{C}^{-1}_{k}(v_{l})=v_{j}\\implies\\mathcal{R}^{\\prime}_{j-l}\\circ\\mathcal{C}^{-1}_{k}(v_{l})=\\mathcal{C}^{-1}_{k}(v_{j})\\,.</span></p>

    <p class="text-gray-300">That is, it is possible to set up a system of equations that depend on the keys only (equivalently, that do not depend on the internal unknown state <span class="math">(y,z)</span>). We therefore apply the feed-forward technique on the expansion phase, i.e., we work with <span class="math">(y,z)\\mapsto\\mathcal{F}_{k}(y,z):=\\mathcal{C}_{k}(y,z)+(y,z)</span>, which prevents this problem.</p>

    <p class="text-gray-300">Assume moreover that the functions <span class="math">\\mathcal{R}_{i}</span>, <span class="math">i\\geq 1</span> are linear. Given two outputs <span class="math">w_{j}=\\mathcal{F}_{k}\\left(\\mathcal{R}_{j}(y,z)\\right)</span> and <span class="math">w_{l}=\\mathcal{F}_{k}\\left(\\mathcal{R}_{l}(y,z)\\right)</span>,</p>

    <p class="text-gray-300"><span class="math">\\mathcal{R}^{\\prime}_{j-l}(w_{l})-w_{j}</span> <span class="math">=\\mathcal{R}^{\\prime}_{j-l}\\left(\\mathcal{F}_{k}\\left(\\mathcal{R}_{l}(y,z)\\right)\\right)-\\mathcal{F}_{k}\\left(\\mathcal{R}_{j}(y,z)\\right)</span> <span class="math">=\\mathcal{R}^{\\prime}_{j-l}\\left(\\mathcal{R}_{l}(y,z)+\\mathcal{C}_{k}\\left(\\mathcal{R}_{l}(y,z)\\right)\\right)-\\mathcal{R}_{j}(y,z)-\\mathcal{C}_{k}\\left(\\mathcal{R}_{j}(y,z)\\right)</span> <span class="math">=\\mathcal{R}^{\\prime}_{j-l}\\left(\\mathcal{R}_{l}(y,z)\\right)+\\mathcal{R}^{\\prime}_{j-l}\\left(\\mathcal{C}_{k}\\left(\\mathcal{R}_{l}(y,z)\\right)\\right)-\\mathcal{R}_{j}(y,z)-\\mathcal{C}_{k}\\left(\\mathcal{R}_{j}(y,z)\\right)</span> <span class="math">=\\mathcal{R}^{\\prime}_{j-l}\\left(\\mathcal{C}_{k}\\left(\\mathcal{R}_{l}(y,z)\\right)\\right)-\\mathcal{C}_{k}\\left(\\mathcal{R}_{j}(y,z)\\right)</span></p>

    <p class="text-gray-300">for each <span class="math">j,l</span> with <span class="math">j&gt;l</span>. Similar equations can be derived for affine <span class="math">\\mathcal{R}_{i}</span>. Even if we are not aware of any attack that exploits such an equality, we suggest to work with a nonlinear rolling function. We point out that using a nonlinear function is also suggested by Farfalle’s designers in order to frustrate meet-in-the-middle attacks in the expansion phase (see <em>[10, Sect. 5]</em> for more details).</p>

    <h5 id="sec-22" class="text-base font-semibold mt-4">Creating New Variables to Replace a Heavy Key Schedule.</h5>

    <p class="text-gray-300">Due to the structure of <span class="math">{}^{1/2\\times}</span>Farfalle and Ciminion, and under the assumption that <span class="math">\\mathcal{P}</span> behaves like a PRP, an attacker cannot control the inputs and outputs of the expansion phase. However, (meet-in-the-middle) attacks that require only the knowledge of the outputs of such an expansion phase are possible, because multiple outputs are created via a single <em>common</em> (unknown) input. The cost of such an attack depends on the number of involved variables and on the degree of the equations. We start by examining how Farfalle and Ciminion prevent such an attack.</p>

    <p class="text-gray-300">Farfalle has been proposed for achieving the best performances in software and/or hardware implementations. For this reason, the field considered in applications is typically <span class="math">\\mathbb{F}_{2}^{n}</span>, where <span class="math">n</span> is large (at least equal to the security level <span class="math">k</span>). This implies that a large number of variables is needed to model the scheme as a polynomial system, which prevents the attack previously described, even when working with a low-degree permutation <span class="math">\\mathcal{P}^{(e)}</span>. Depending on the details of the permutation, the number of variables could be minimized by working over an equivalent field <span class="math">\\mathbb{F}_{2^{l}}^{m}</span> where <span class="math">n=m\\cdot l</span>, without crucially affecting the overall degree of the equations that describe the scheme. For instance, 16 variables, as opposed to 128, are sufficient for describing AES, since all its internal operations (namely, the S-box, ShiftRows, and MixColumns) are naturally defined over <span class="math">\\mathbb{F}_{2^{8}}^{16}</span>. This is not the case for SHA-3/Keccak, for which only the nonlinear layer (defined as the concatenation of <span class="math">\\chi</span> functions) admits a natural description over <span class="math">\\mathbb{F}_{2^{5}}^{5,l}</span>. In general, this scenario can easily be prevented when working with weak-arranged SPN schemes <em>[18]</em> and/or unaligned SPN schemes <em>[15]</em>, for which this equivalent representation that minimizes the number of variables comes at the price of huge/prohibitive degrees of the corresponding functions.</p>

    <p class="text-gray-300">Ciminion has, on the other hand, been proposed for minimizing the multiplicative complexity in the natural representation of the scheme over <span class="math">\\mathbb{F}_{q}^{n}</span> for <em>large/huge</em> <span class="math">q</span> and <em>small</em> <span class="math">n</span>, namely, the opposite of Farfalle. Hence, in order to work with low-degree permutations <span class="math">\\mathcal{P}^{(e)}</span>, it is necessary to “artificially” increase the number of variables to prevent attacks. By using a heavy key schedule, one can guarantee that the algebraic relation between the keys <span class="math">k_{0},k_{1},k_{2},\\dots</span> is non-trivial, i.e., described by dense algebraic functions of high degree. Such a complex relation could not be exploited in an algebraic attack, and the attacker is then forced to treat the subkeys as independent variables. To summarize,</p>

    <ul class="list-disc list-inside space-y-1 text-gray-300 my-2 ml-4">

      <li>in Farfalle, the (MitM) attack on the expansion phase is prevented by working over a field <span class="math">\\mathbb{F}_{p}^{n}</span> for a small prime <span class="math">p</span> and a large integer <span class="math">n</span>, and</li>

      <li>in Ciminon, it is prevented by “artificially” increasing the number of variables, working with a heavy key schedule.</li>

    </ul>

    <p class="text-gray-300">None of the two approaches is suitable for our goal, since we mainly target applications over a field <span class="math">\\mathbb{F}_{p}^{n}</span> for a huge prime <span class="math">p</span> in which a heavy key schedule cannot be computed efficiently. For this reason, we propose to increase the number of variables “for free” by reusing the computation needed to evaluate <span class="math">\\mathcal{P}</span>. Since <span class="math">\\mathcal{P}</span> is instantiated as an iterated permutation in practical use cases, we can fabricate a new <span class="math">\\mathbb{F}_{q}^{n}</span> element by considering the sum of all internal states of <span class="math">\\mathcal{P}</span>. This corresponds to the definition of the function <span class="math">\\mathcal{S}</span> in Eq. (3). In this way, we can double the size of the internal state (and so, the number of variables) for free.</p>

    <p class="text-gray-300">In more detail, for a given input <span class="math">x\\in\\mathbb{F}_{q}^{n}</span>, let <span class="math">y\\in\\mathbb{F}_{q}^{n}</span> be the output <span class="math">\\mathtt{K}+\\mathcal{P}(x+\\mathtt{K})</span>, and let <span class="math">z\\in\\mathbb{F}_{q}^{n}</span> be the output <span class="math">\\mathcal{S}(x+\\mathtt{K})</span>. Then <span class="math">y</span> and <span class="math">z</span> are not independent, since <span class="math">z=\\mathcal{S}(\\mathcal{P}^{-1}(y-\\mathtt{K}))</span>. However, for proper choices of <span class="math">\\mathcal{P}</span> and <span class="math">\\mathcal{S}</span>, the relation between the two variables is too complex to be exploited in practice, exactly as</p>

    <p class="text-gray-300">in the case of the keys <span class="math">k_{0},k_{1},k_{2},\\dots</span> in Ciminion. As a result, the attacker is forced to consider both <span class="math">y</span> and <span class="math">z</span> as two independent variables, which is exactly our goal.</p>

    <h4 id="sec-23" class="text-lg font-semibold mt-6">Similar Techniques in the Literature</h4>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">For completeness, we mention that the idea of reusing internal states of an iterated function is not new in the literature. E.g., let <span class="math">E_{k}^{(r)}</span> be an iterated cipher of <span class="math">r\\geq 1</span> rounds. In <em>[45]</em>, the authors set up a PRF <span class="math">F</span> as the sum of the output of the iterated cipher after <span class="math">r</span> rounds and the output after <span class="math">s</span> rounds for <span class="math">s\\neq r</span>, that is, <span class="math">F(x)=E_{k}^{(r)}(x)+E_{k}^{(s)}(x)</span>. Later on, a similar approach has been exploited in the Fork design strategy <em>[6]</em>, which is an expanding invertible function defined as $x\\mapsto E_{\\hat{k}}^{(r_{0})}(E_{k}^{(s)}(x))\\</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">E_{\\hat{k}}^{(r_{1})}(E_{k}^{(s)}(x))$.</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <h3 id="sec-24" class="text-xl font-semibold mt-8">4.2 Modes of Use of Megafono</h3>

    <p class="text-gray-300">As in the case of Farfalle and Ciminion, Megafono can be used for key derivation and key-stream generation. It allows amortizing the computation of the key among different computations with the same initial master key K. Besides that, other possible use cases of Megafono are a wide block cipher, in which Megafono is used to instantiate the round function of a contracting Feistel scheme, and a (session-supporting) authenticated encryption scheme. Since these applications were also proposed for Farfalle, we do not describe them here, but refer to <em>[10, Sect. 4]</em> for further details.</p>

    <p class="text-gray-300">We conclude by pointing out the following. Megafono is designed to be competitive for applications that require a natural description over <span class="math">\\mathbb{F}_{q}^{n}</span>, where <span class="math">q</span> is a large prime of order at least <span class="math">2^{64}</span>. However, this does not mean that Megafono cannot be efficiently used in other applications, e.g., for designing schemes that aim to be competitive in software or hardware. From this point of view, the main difference with respect to Farfalle and Ciminion is the fact that Megafono requires two permutations with different domains, namely, <span class="math">\\mathbb{F}_{q}^{n}</span> and <span class="math">\\mathbb{F}_{q}^{2n}</span>. However, this is not a problem when e.g. considering the family of the SHA-3/Keccak permutations <em>[12]</em>, defined over <span class="math">\\mathbb{F}_{2}^{n}</span> for <span class="math">n=25\\cdot 2^{l}</span> for <span class="math">l\\in\\{0,1,\\dots,6\\}</span>. In this case it is possible to instantiate <span class="math">\\mathcal{P}</span> and <span class="math">\\mathcal{C}_{k}</span> with two unkeyed/keyed permutations defined over domains whose size differs by a factor of two. The resulting PRF based on Megafono would be similar to the PRF Kravatte based on Farfalle proposed in <em>[10, Sect. 7]</em>. (Proposing concrete round numbers for this version is beyond the scope of this paper. Rather, we leave the open problem to evaluate and compare the performances of the two PRFs for future work.)</p>

    <h2 id="sec-25" class="text-2xl font-bold">5 Specification of Hydra</h2>

    <h3 id="sec-26" class="text-xl font-semibold mt-8">5.1 The PRF Hydra</h3>

    <p class="text-gray-300">Let <span class="math">p&gt;2^{63}</span> (i.e., <span class="math">\\lceil\\log_{2}(p)\\rceil\\geq 64</span>) and let <span class="math">t\\geq 4</span> be the size of the output. The security level is denoted by <span class="math">\\kappa</span>, where <span class="math">2^{80}\\leq 2^{\\kappa}\\leq\\min\\{p^{2},2^{256}\\}</span>, and <span class="math">\\texttt{K}\\in\\mathbb{F}_{p}^{4}</span> is</p>

    <p class="text-gray-300">16 !<a href="img-3.jpeg">img-3.jpeg</a> Fig. 3: The HYDRA PRF (where <span class="math">r \\coloneqq R_{\\mathcal{I}} - 1</span> for aesthetic reasons).</p>

    <p class="text-gray-300">the master key. We assume that the data available to an attacker is limited to <span class="math">2^{40} \\leq 2^{n/2} \\leq \\min\\{p, 2^{128}\\}</span>. For a plaintext <span class="math">P \\in \\mathbb{F}_p^t</span>, the ciphertext is defined by</p>

    <div class="my-4 text-center"><span class="math-block"></span></div>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">C = \\operatorname {H Y D R A} ([ N</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\mathrm {I V} ]) + P,</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <div class="my-4 text-center"><span class="math-block"></span></div>

    <p class="text-gray-300">where <span class="math">\\mathrm{HYDRA}:\\mathbb{F}_p^4\\to \\mathbb{F}_p^t</span> is the HYDRA PRF, <span class="math">\\mathrm{IV}\\in \\mathbb{F}_p^3</span> is a fixed initial value and <span class="math">N\\in \\mathbb{F}_p</span> is a nonce (e.g., a counter).</p>

    <p class="text-gray-300">Hydra. An overview of HYDRA<span class="math">^{11}</span> is given in Fig. 3, where</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">(1) $y \\coloneqq \\mathsf{K} + \\mathcal{B}([N \\mid</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\mathrm{IV}</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">+ \\mathsf{K}) \\in \\mathbb{F}_p^4<span class="math"> for a certain permutation </span>\\mathcal{B}: \\mathbb{F}_p^4 \\to \\mathbb{F}_p^4$ defined in the following,</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">(3) <span class="math">\\mathcal{H}_{\\mathbb{K}}:\\mathbb{F}_p^8\\to \\mathbb{F}_p^8</span> is a keyed permutation defined in Section 5.4, and (4) the functions <span class="math">\\mathcal{R}_i: (\\mathbb{F}_p^4)^2 \\to \\mathbb{F}_p^8</span> are defined as</p>

    <div class="my-4 text-center"><span class="math-block">\\forall i \\geq 1: \\quad \\mathcal {R} _ {i} (y, z) := \\varphi_ {i} + \\mathcal {R} \\circ \\mathcal {R} _ {i - 1} (y, z), \\tag {5}</span></div>

    <p class="text-gray-300">where <span class="math">\\mathcal{R}_0(y,z) = (y,z)</span>, and where <span class="math">\\mathcal{R}:(\\mathbb{F}_p^4)^2\\to \\mathbb{F}_p^8</span> is the rolling function defined in Section 5.3, and <span class="math">\\varphi_{i}\\in \\mathbb{F}_{p}^{8}</span> are random constants.</p>

    <p class="text-gray-300">We give an algorithmic description of HYDRA in Algorithm 7.</p>

    <p class="text-gray-300"><span class="math">^{11}</span> The (Lernaean) Hydra is a mythological serpentine water monster with many heads. In our case, we can see <span class="math">\\mathcal{B}</span> as the body of the Hydra, and the multiple parallel permutations <span class="math">\\mathcal{H}_{\\mathbb{K}}</span> as its multiple heads.</p>

    <p class="text-gray-300">5.2 The Body of the Hydra: The Permutation <span class="math">\\mathcal{B}</span></p>

    <p class="text-gray-300">The permutation <span class="math">\\mathcal{B}:\\mathbb{F}_p^4\\to \\mathbb{F}_p^4</span> is defined as</p>

    <div class="my-4 text-center"><span class="math-block">\\mathcal {B} (x) = \\underbrace {\\mathcal {E} _ {5} \\circ \\cdots \\circ \\mathcal {E} _ {2}} _ {4 \\text { times}} \\circ \\underbrace {\\mathcal {I} _ {R _ {\\mathcal {I}} - 1} \\circ \\cdots \\circ \\mathcal {I} _ {0}} _ {R _ {\\mathcal {I}} \\text { times}} \\circ \\underbrace {\\mathcal {E} _ {1} \\circ \\mathcal {E} _ {0}} _ {2 \\text { times}} (M _ {\\mathcal {E}} \\times x), \\tag {6}</span></div>

    <p class="text-gray-300">where the external and internal rounds <span class="math">\\mathcal{E}_i, \\mathcal{I}_j: \\mathbb{F}_p^4 \\to \\mathbb{F}_p^4</span> are defined as</p>

    <div class="my-4 text-center"><span class="math-block">\\mathcal {E} _ {i} (\\cdot) = \\varphi^ {(\\mathcal {E}, i)} + M _ {\\mathcal {E}} \\times S _ {\\mathcal {E}} (\\cdot), \\qquad \\mathcal {I} _ {j} (\\cdot) = \\varphi^ {(\\mathcal {I}, j)} + M _ {\\mathcal {I}} \\times S _ {\\mathcal {I}} (\\cdot)</span></div>

    <p class="text-gray-300">for <span class="math">i\\in \\{0,1,\\ldots ,5\\}</span> and each <span class="math">j\\in \\{0,1,\\dots ,R_{\\mathcal{I}} - 1\\}</span>, where <span class="math">\\varphi^{(\\mathcal{E},i)},\\varphi^{(\\mathcal{I},j)}\\in \\mathbb{F}_p^4</span> are randomly chosen round constants (we refer to Appendix E for details on how we generate the pseudo-random constants).</p>

    <p class="text-gray-300">The Round Function <span class="math">\\mathcal{E}</span>. Let <span class="math">d \\geq 3</span> be the smallest odd integer such that <span class="math">\\gcd(d, p - 1) = 1</span>. The nonlinear layer <span class="math">S_{\\mathcal{E}}: \\mathbb{F}_p^4 \\to \\mathbb{F}_p^4</span> is defined as</p>

    <div class="my-4 text-center"><span class="math-block">S _ {\\mathcal {E}} (x _ {0}, x _ {1}, x _ {2}, x _ {3}) = (x _ {0} ^ {d}, x _ {1} ^ {d}, x _ {2} ^ {d}, x _ {3} ^ {d}).</span></div>

    <p class="text-gray-300">We require <span class="math">M_{\\mathcal{E}} \\in \\mathbb{F}_p^{4 \\times 4}</span> to be an MDS matrix and recommend an AES-like matrix such as <span class="math">\\operatorname{circ}(2,3,1,1)</span> or <span class="math">\\operatorname{circ}(3,2,1,1)</span>.</p>

    <p class="text-gray-300">The Round Function <span class="math">\\mathcal{I}</span>. The nonlinear layer <span class="math">S_{\\mathcal{I}}: \\mathbb{F}_p^4 \\to \\mathbb{F}_p^4</span> is defined as <span class="math">S_{\\mathcal{I}}(x_0, x_1, x_2, x_3) = (y_0, y_1, y_2, y_3)</span> where</p>

    <div class="my-4 text-center"><span class="math-block">y _ {l} = x _ {l} + \\left(\\left(\\sum_ {j = 0} ^ {3} (- 1) ^ {j} \\cdot x _ {j}\\right) ^ {2} + \\left(\\sum_ {j = 0} ^ {3} (- 1) ^ {\\lfloor j / 2 \\rfloor} \\cdot x _ {j}\\right)\\right) ^ {2} \\text { for } 0 \\leq l \\leq 3. \\tag {7}</span></div>

    <p class="text-gray-300">Note that the two vectors <span class="math">\\lambda^{(0)} \\coloneqq (1, -1, 1, -1), \\lambda^{(1)} \\coloneqq (1, 1, -1, -1) \\in \\mathbb{F}_p^4</span>, that define the coefficients in the sums of (7), are linearly independent and their entries sum to zero. This latter condition is needed to guarantee invertibility by Proposition 1. <span class="math">M_{\\mathcal{I}} \\in \\mathbb{F}_p^{4 \\times 4}</span> is an invertible matrix that satisfies the following conditions (which are justified in Appendix G.2):</p>

    <p class="text-gray-300">(a) for each <span class="math">i\\in \\{0,1\\}</span>: <span class="math">\\sum_{j = 0}^{3}\\lambda_{j}^{(i)}\\cdot \\left(\\sum_{l = 0}^{3}M_{\\mathcal{I}}[j,l]\\right)\\neq 0,</span> (b) for each <span class="math">i\\in \\{0,1\\}</span> and each <span class="math">j\\in \\{0,1,\\ldots ,3\\} : \\quad \\sum_{l = 0}^{3}\\lambda_{l}^{(i)}\\cdot M_{\\mathcal{I}}[l,j]\\neq 0,</span> and (c) its minimal polynomial is of maximum degree and irreducible (for preventing infinitely long subspace trails - see Appendix H for details).</p>

    <p class="text-gray-300">In particular, we suggest using an invertible matrix of the form</p>

    <div class="my-4 text-center"><span class="math-block">M _ {\\mathcal {I}} = \\left( \\begin{array}{c c c c} \\mu_ {0, 0} ^ {(\\mathcal {I})} &amp;amp; 1 &amp;amp; 1 &amp;amp; 1 \\\\ \\mu_ {1, 0} ^ {(\\mathcal {I})} &amp;amp; \\mu_ {1, 1} ^ {(\\mathcal {I})} &amp;amp; 1 &amp;amp; 1 \\\\ \\mu_ {2, 0} ^ {(\\mathcal {I})} &amp;amp; 1 &amp;amp; \\mu_ {2, 2} ^ {(\\mathcal {I})} &amp;amp; 1 \\\\ \\mu_ {3, 0} ^ {(\\mathcal {I})} &amp;amp; 1 &amp;amp; 1 &amp;amp; \\mu_ {3, 3} ^ {(\\mathcal {I})} \\end{array} \\right), \\tag {8}</span></div>

    <p class="text-gray-300">for which the conditions (a), (b), and (c) are satisfied (we suggest to use the tool given in Appendix H.1 in order to check that the condition (c) is satisfied).</p>

    <p class="text-gray-300">17</p>

    <p class="text-gray-300">5.3 The Rolling Function</p>

    <p class="text-gray-300">The rolling function <span class="math">\\mathcal{R}:\\left(\\mathbb{F}_{p}^{4}\\right)^{2}\\to\\mathbb{F}_{p}^{8}</span> is defined as <span class="math">\\mathcal{R}(y,z)=M_{\\mathcal{R}}\\times S_{\\mathcal{R}}(y,z)</span>, where a round constant is included in the definition of <span class="math">\\mathcal{R}_{i}</span> (Eq. (5)) and the nonlinear layer <span class="math">S_{\\mathcal{R}}</span> is defined as</p>

    <p class="text-gray-300"><span class="math">S_{\\mathcal{R}}(y_{0},y_{1},y_{2},y_{3},z_{0},z_{1},z_{2},z_{3})=(y_{0}+v,\\ldots,y_{3}+v,z_{0}+w,\\ldots,z_{3}+w),</span></p>

    <p class="text-gray-300">with <span class="math">v,w\\in\\mathbb{F}_{p}</span> defined as</p>

    <p class="text-gray-300"><span class="math">v=\\left(\\sum_{i=0}^{3}(-1)^{i}\\cdot y_{i}\\right)\\cdot\\left(\\sum_{i=0}^{3}(-1)^{\\lfloor\\frac{i}{2}\\rfloor}\\cdot z_{i}\\right),</span> <span class="math">w=\\left(\\sum_{i=0}^{3}(-1)^{i}\\cdot z_{i}\\right)\\cdot\\left(\\sum_{i=0}^{3}(-1)^{\\lfloor\\frac{i}{2}\\rfloor}\\cdot y_{i}\\right),</span> (9)</p>

    <p class="text-gray-300">and the linear layer <span class="math">M_{\\mathcal{R}}\\in\\mathbb{F}_{p}^{8\\times 8}</span> is defined as</p>

    <p class="text-gray-300">\\[ M_{\\mathcal{R}}=\\text{diag}(M_{\\mathcal{I}},M_{\\mathcal{I}})=\\begin{pmatrix}M_{\\mathcal{I}}&0^{4\\times 4}\\\\ 0^{4\\times 4}&M_{\\mathcal{I}}\\end{pmatrix}, \\]</p>

    <p class="text-gray-300">where <span class="math">M_{\\mathcal{I}}\\in\\mathbb{F}_{p}^{4\\times 4}</span> is the matrix just defined for the body’s internal rounds.</p>

    <h3 id="sec-27" class="text-xl font-semibold mt-8">5.4 The Heads of the Hydra: The Permutation <span class="math">\\mathcal{H}_{\\textsc{k}}</span></h3>

    <p class="text-gray-300">The keyed permutation <span class="math">\\mathcal{H}_{\\textsc{k}}:\\mathbb{F}_{p}^{8}\\to\\mathbb{F}_{p}^{8}</span> is defined as</p>

    <p class="text-gray-300"><span class="math">\\mathcal{H}_{\\textsc{k}}(y,z)=\\underbrace{\\textsc{k}^{\\prime}+\\mathcal{J}_{R_{\\mathcal{H}}-1}\\circ\\left(\\textsc{k}^{\\prime}+\\mathcal{J}_{R_{\\mathcal{H}}-2}\\right)\\circ\\ldots\\circ\\left(\\textsc{k}^{\\prime}+\\mathcal{J}_{1}\\right)\\circ\\left(\\textsc{k}^{\\prime}+\\mathcal{J}_{0}\\right)}_{R_{\\mathcal{H}}\\text{ times}}(y,z),</span></p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">where $\\textsc{k}^{\\prime}=\\textsc{k}\\</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\ (M_{\\mathcal{E}}\\times\\textsc{k})\\in\\mathbb{F}_{p}^{8}<span class="math">, and </span>\\mathcal{J}_{j}:\\mathbb{F}_{p}^{8}\\to\\mathbb{F}_{p}^{8}$ is defined as</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300"><span class="math">\\mathcal{J}_{i}(\\cdot)=\\varphi_{i}+M_{\\mathcal{J}}\\times S_{\\mathcal{J}}(\\cdot),</span></p>

    <p class="text-gray-300">where <span class="math">\\varphi_{i}\\in\\mathbb{F}_{p}^{8}</span> are random round constants for each <span class="math">i\\in\\{0,1,\\ldots,R_{\\mathcal{H}}-1\\}</span>. The nonlinear layer <span class="math">S_{\\mathcal{J}}(x_{0},x_{1},\\ldots,x_{7})=(y_{0},\\ldots,y_{7})</span> is defined by</p>

    <p class="text-gray-300"><span class="math">y_{l}=x_{l}+\\left(\\sum_{h=0}^{7}(-1)^{\\lfloor\\frac{h}{4}\\rfloor}\\cdot x_{h}\\right)^{2}\\text{ for }0\\leq l\\leq 7\\,.</span></p>

    <p class="text-gray-300">As in (7), we note that the coefficients in the sum, <span class="math">(1,1,1,1,-1,-1,-1,-1)</span>, sums to zero. <span class="math">M_{\\mathcal{J}}\\in\\mathbb{F}_{p}^{8\\times 8}</span> is an invertible matrix that fulfills similar conditions to (a), (b), and (c) described in Section 5.2, i.e., (a) <span class="math">\\sum_{h=0}^{7}(-1)^{h}\\cdot\\left(\\sum_{l=0}^{7}M_{\\mathcal{J}}[h,l]\\right)\\neq 0</span>, (b) <span class="math">\\sum_{l=0}^{7}(-1)^{l}\\cdot M_{\\mathcal{J}}[l,h]\\neq 0</span>, for <span class="math">h\\in\\{0,\\ldots,7\\}</span>, and (c) the minimal polynomial of <span class="math">M_{\\mathcal{J}}</span> is of maximum degree and irreducible (as detailed in Appendix H). We recommend that <span class="math">M_{\\mathcal{J}}</span> has a similar form to the matrix in Eq. (8) for eight rows and columns.</p>

    <p class="text-gray-300">5.5 Number of Rounds</p>

    <p class="text-gray-300">In order to provide <span class="math">\\kappa</span> bits of security and assuming a data limit of <span class="math">2^{\\kappa/2}</span>, the number of rounds for the functions <span class="math">\\mathcal{B}</span> and <span class="math">\\mathcal{H}_{\\mathtt{K}}</span> must be at least</p>

    <p class="text-gray-300"><span class="math">R_{\\mathcal{I}}=\\left\\lceil 1.125\\cdot\\left\\lceil\\max\\left\\{\\frac{\\kappa}{4}-\\log_{2}(d)+6,\\widehat{R_{\\mathcal{I}}}\\right\\}\\right\\rceil\\right\\rceil,\\quad R_{\\mathcal{H}}=\\left\\lceil 1.25\\cdot\\max\\left\\{24,2+R_{\\mathcal{H}}^{*}\\right\\}\\right\\rceil\\,,</span></p>

    <p class="text-gray-300">where <span class="math">\\widehat{R_{\\mathcal{I}}}</span> and <span class="math">R_{\\mathcal{H}}^{*}</span> are the minimum positive integers that satisfy Eq. (15) and Eq. (12), respectively. Note that we have added a security margin of <span class="math">12.5\\%</span> for <span class="math">\\mathcal{B}</span> and <span class="math">25\\%</span> for <span class="math">\\mathcal{H}_{\\mathtt{K}}</span>. In Appendix A, we provide a script that returns the number of rounds <span class="math">R_{\\mathcal{I}}</span> and <span class="math">R_{\\mathcal{H}}</span> for given <span class="math">p</span> and <span class="math">\\kappa</span>. For instance, with <span class="math">\\kappa=128</span>, we get <span class="math">R_{\\mathcal{I}}=42</span> and <span class="math">R_{\\mathcal{H}}=39</span>. A concrete instantiation of Hydra’s matrices for <span class="math">p=2^{127}+45</span> is given in in Appendix C.</p>

    <h4 id="sec-28" class="text-lg font-semibold mt-6">About Related-Key Attacks.</h4>

    <p class="text-gray-300">We do <em>not</em> claim security against related-key attacks, since the keys are randomly sampled in each computation, without any input or influence of a potential attacker. Thus, an attacker cannot know or choose any occurring relations between different keys. Indeed, since we focus on MPC protocols in a malicious setting with either honest or dishonest majority (e.g., SPDZ <em>[25, 24]</em>), any difference added to one shared key would be immediately detected by the other parties in the protocol. We also emphasize that the same assumption has been made in previous related works <em>[33, 27]</em>.</p>

    <h2 id="sec-29" class="text-2xl font-bold">6 Design Rationale of <span class="math">\\mathcal{B}</span>, <span class="math">\\mathcal{R}_{i}</span> and <span class="math">\\mathcal{H}_{\\mathtt{K}}</span></h2>

    <h3 id="sec-30" class="text-xl font-semibold mt-8">6.1 The Body <span class="math">\\mathcal{B}</span></h3>

    <h4 id="sec-31" class="text-lg font-semibold mt-6">The Hades Design Strategy.</h4>

    <p class="text-gray-300">For <span class="math">\\mathcal{B}</span>, we aim to retain the advantages of Hades <em>[33]</em>, in particular the security arguments against statistical attacks and the efficiency of the partial middle rounds. The Hades strategy is a way to design SPN schemes over <span class="math">\\mathbb{F}_{q}^{t}</span> in which rounds with <em>full S-box layers</em> are mixed with rounds with <em>partial S-box layers</em>. The external rounds with full S-box layers (<span class="math">t</span> S-boxes in each nonlinear layer) at the beginning and at the end of the construction provide security against statistical attacks. The rounds with partial S-box layers (<span class="math">t^{\\prime}&lt;t</span> S-boxes and <span class="math">t-t^{\\prime}</span> identity functions) in the middle of the construction are more efficient in settings such as MPC and help to prevent algebraic attacks. In all rounds, the linear layer is defined via the multiplication of an MDS matrix.</p>

    <p class="text-gray-300">This strategy has recently been pushed to its limit in Neptune <em>[34]</em>, a modified version of the sponge hash function Poseidon <em>[32]</em>. In such a case, instead of using the same matrix and the same S-box both for the external and the internal rounds, Neptune’s designers propose to use two different S-boxes and two different matrices for the external and internal rounds.</p>

    <h5 id="sec-32" class="text-base font-semibold mt-4">The External Rounds of <span class="math">\\mathcal{B}</span>.</h5>

    <p class="text-gray-300">As in Hades, Poseidon, and Neptune, we use the external rounds to provide security against statistical attacks. In the case of Hades and Poseidon, this is achieved by instantiating the external full rounds with power maps <span class="math">x\\mapsto x^{d}</span> for each of the <span class="math">t</span> words. We recall that this nonlinear layer requires <span class="math">t\\cdot(\\mathrm{hw}(d)+\\lfloor\\log_{2}(d)\\rfloor-1)</span> multiplications (see e.g. <em>[34]</em> for details).</p>

    <p class="text-gray-300">We adopt this approach for <span class="math">\\mathcal{B}</span>, using 2 external rounds at the beginning and <span class="math">2+2=4</span> external rounds at the end, where 2 rounds are included as a security margin against statistical attacks (see Appendix G.1 for more details). With respect to Hades and Poseidon, we do not impose that the number of external rounds at the beginning is equal to the number of external rounds at the end (even if we try to have a balance between them). Instead, we choose the number of external rounds to be even at each side in order to maximize the minimum number of active S-boxes from the wide-trail design strategy <em>[23]</em> (the minimum number of active S-boxes over two consecutive rounds is related to the branch number of the matrix that defines the linear layer).</p>

    <h5 id="sec-33" class="text-base font-semibold mt-4">The Internal Rounds of <span class="math">\\mathcal{B}</span>.</h5>

    <p class="text-gray-300">To minimize our primary cost metric (the number of multiplications over <span class="math">\\mathbb{F}_{p}</span>), we opt for using maps with degree <span class="math">2^{l}\\geq 2</span> which cost <span class="math">l\\geq 1</span> multiplications in the internal rounds. Indeed, let us compare the cost in terms of <span class="math">\\mathbb{F}_{p}</span> multiplications in order to reach a certain degree <span class="math">\\Delta</span> when using a round instantiated with the quadratic map <span class="math">x\\mapsto x^{2}</span>, with one instantiated via an invertible power map <span class="math">x\\mapsto x^{d}</span> with <span class="math">d\\geq 3</span>, for odd <span class="math">d</span>. Comparing the overall number of <span class="math">\\mathbb{F}_{p}</span> multiplications, the first option is the most competitive, since</p>

    <p class="text-gray-300"><span class="math">\\underbrace{\\left\\lceil\\log_{2}(\\Delta)\\right\\rceil=\\left\\lceil\\log_{d}(\\Delta)\\cdot\\log_{2}(d)\\right\\rceil}_{\\text{using }x\\mapsto x^{2}}\\leq\\underbrace{\\left\\lceil\\log_{d}(\\Delta)\\right\\rceil\\cdot(\\lfloor\\log_{2}(d)\\rfloor+\\mathrm{hw}(d)-1)}_{\\text{using }x\\mapsto x^{d}},</span></p>

    <p class="text-gray-300">where <span class="math">\\lceil\\log_{d}(\\Delta)\\cdot\\log_{2}(d)\\rceil\\leq\\lceil\\log_{d}(\\Delta)\\rceil\\cdot\\lceil\\log_{2}(d)\\rceil</span> and <span class="math">\\lfloor\\log_{2}(d)\\rfloor+\\mathrm{hw}(d)-1\\geq\\lfloor\\log_{2}(d)\\rfloor+1=\\lceil\\log_{2}(d)\\rceil</span>. For example, consider <span class="math">d=3,\\Delta=2^{128}</span>. With quadratic maps we need 128 <span class="math">\\mathbb{F}_{p}</span> multiplications to reach degree <span class="math">\\Delta</span>. In the second case, 162 <span class="math">\\mathbb{F}_{p}</span> multiplications are needed, requiring 27% more multiplications in total.</p>

    <h5 id="sec-34" class="text-base font-semibold mt-4">Nonlinear Layer.</h5>

    <p class="text-gray-300">However, <span class="math">x\\mapsto x^{2}</span> is not invertible, which may affect the security. Therefore, we use the quadratic map in a mode that preserves the invertibility, as in a Feistel or Lai–Massey construction <em>[43]</em>. The latter over <span class="math">\\mathbb{F}_{q}^{2}</span> is defined as <span class="math">(x,y)\\mapsto(x+F(x-y),y+F(x-y))</span>, where <span class="math">F:\\mathbb{F}_{q}\\to\\mathbb{F}_{q}</span>. Generalizations over <span class="math">\\mathbb{F}_{p}^{n}</span> have recently been proposed <em>[34]</em>, including one defined as <span class="math">(x_{0},x_{1},\\ldots,x_{n-1})\\mapsto(y_{0},y_{1},\\ldots,y_{n-1})</span>, where <span class="math">y_{i}=x_{i}+F\\left(\\sum_{j=0}^{n-1}(-1)^{j}\\cdot x_{j}\\right)</span> for <span class="math">i\\in\\{0,1,\\ldots,n-1\\}</span> and even <span class="math">n\\geq 3</span>. This can be further generalized as follows.</p>

    <h6 id="sec-35" class="text-base font-medium mt-4">Proposition 1.</h6>

    <p class="text-gray-300">Let <span class="math">q=p^{s}</span>, where <span class="math">p\\geq 3</span> is a prime and <span class="math">s</span> is a positive integer, and let <span class="math">n\\geq 2</span>. Given <span class="math">1\\leq l\\leq n-1</span>, let <span class="math">\\lambda_{0}^{(i)},\\lambda_{1}^{(i)},\\ldots,\\lambda_{n-1}^{(i)}\\in\\mathbb{F}_{q}</span> be such that <span class="math">\\sum_{j=0}^{n-1}\\lambda_{j}^{(i)}=0</span> for <span class="math">i\\in\\{0,1,\\ldots,l-1\\}</span>. Let <span class="math">F:\\mathbb{F}_{q}^{l}\\to\\mathbb{F}_{q}</span>. The Lai-Massey function</p>

    <p class="text-gray-300"><span class="math">\\mathcal{F}:\\mathbb{F}_{q}^{n}\\to\\mathbb{F}_{q}^{n}</span> defined as <span class="math">\\mathcal{F}(x_{0},\\ldots,x_{n-1})=(y_{0},\\ldots,y_{n-1})</span> is invertible when</p>

    <p class="text-gray-300"><span class="math">y_{h}=x_{h}+F\\left(\\sum_{j=0}^{n-1}\\lambda_{j}^{(0)}\\cdot x_{j},\\sum_{j=0}^{n-1}\\lambda_{j}^{(1)}\\cdot x_{j},\\ldots,\\sum_{j=0}^{n-1}\\lambda_{j}^{(l-1)}\\cdot x_{j}\\right),\\text{ for }0\\leq h\\leq n-1\\,.</span></p>

    <p class="text-gray-300">We provide the proof in Appendix F.1. No conditions are imposed on <span class="math">F</span>. Even if not strictly necessary, we choose <span class="math">\\{\\lambda_{j}^{(0)}\\}_{j=0}^{n-1},\\ldots,\\{\\lambda_{j}^{(l-1)}\\}_{j=0}^{n-1}</span> such that they are linearly independent. Since we require <span class="math">\\sum_{j=0}^{n-1}\\lambda_{j}^{(i)}=0</span> for <span class="math">i\\in\\{0,\\ldots,l-1\\}</span>, there can be at most <span class="math">l=n-1</span> linearly independent <span class="math">\\{\\lambda_{j}^{(i)}\\}</span>-vectors.</p>

    <p class="text-gray-300">To reduce the number of rounds and matrix multiplications, we chose a generalized Lai–Massey construction instantiated with a nonlinear function of degree 4 that can be computed with 2 multiplications only.</p>

    <h5 id="sec-36" class="text-base font-semibold mt-4">Linear Layer</h5>

    <p class="text-gray-300">The Lai–Massey construction allows for invariant subspaces <em>[48]</em>. Hence, it is crucial to choose the matrix <span class="math">M_{\\mathcal{I}}</span> in order to break them. For this goal, in Appendix H, we show how to adapt the analysis/tool proposed in <em>[36, 37]</em> for breaking arbitrarily long subspace trails for P-SPN schemes to the case of the generalized Lai–Massey constructions. In particular, based on <em>[36, Proposition 13]</em>, we show that this result can be always achieved by choosing a matrix for which the minimal polynomial is of maximum degree and irreducible.</p>

    <p class="text-gray-300">Moreover, the interpolation polynomial must be dense. Therefore, we require</p>

    <ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">

      <li>for <span class="math">i\\in\\{0,1,\\ldots,l-1\\}:\\quad\\sum_{j=0}^{n-1}\\lambda_{j}^{(i)}\\cdot\\left(\\sum_{k=0}^{n-1}M_{\\mathcal{I}}[j,k]\\right)\\neq 0</span>,</li>

      <li>for <span class="math">i\\in\\{0,1,\\ldots,l-1\\}</span> and <span class="math">j\\in\\{0,1,\\ldots,n-1\\}:\\quad\\sum_{k=0}^{n-1}\\lambda_{k}^{(i)}\\cdot M_{\\mathcal{I}}[k,j]\\neq 0</span>.</li>

    </ol>

    <p class="text-gray-300">We give further details on these two conditions in Appendix G.2.</p>

    <h3 id="sec-37" class="text-xl font-semibold mt-8">6.2 The Heads <span class="math">\\mathcal{H}_{\\mathtt{g}}</span></h3>

    <p class="text-gray-300">As in Farfalle and Ciminion, the attacker knows the outputs of the expansion phase of Megafono, but cannot choose them (to e.g. set up a chosen-ciphertext attack). By designing <span class="math">\\mathcal{B}</span> in order to resemble a PRP, the attacker cannot know or choose the inputs of <span class="math">\\mathcal{H}_{\\mathtt{g}}</span> (i.e., the output of <span class="math">\\mathcal{B}</span>). Further, it is not possible to choose inputs of <span class="math">\\mathcal{B}</span> which result in specific statistical/algebraic properties at the inputs of <span class="math">\\mathcal{H}_{\\mathtt{g}}</span>. This severely limits the range of attacks that may work at the expansion phase of Megafono, and so of Hydra.</p>

    <p class="text-gray-300">As a result, we find that the possible attacks are largely algebraic in nature, such as using Gröbner bases. The idea of this attack is to construct a system of equations that links the inputs and the outputs of <span class="math">\\mathcal{H}_{\\mathtt{g}}</span> in order to find the intermediate variables and the key. In our case, this corresponds to 12 variables: eight to represent the input and four variables related to the key. With this number of variables over such a large field (relative to the security level), we will see in Section 7.4 that it will not be necessary for <span class="math">\\mathcal{H}_{\\mathtt{g}}</span> to reach its maximal degree. Since <span class="math">\\mathcal{H}_{\\mathtt{g}}</span> is an iterated permutation, it is also possible to introduce new</p>

    <p class="text-gray-300">variables at the outputs of each round <span class="math">\\mathcal{J}_i</span> in order to reduce the overall cost of the Gröbner basis attack. In such a case, the cost of the attack depends on <span class="math">\\min\\{\\deg(\\mathcal{J}^{-1}),\\deg(\\mathcal{J})\\}</span>. Indeed, since we can work at round level, each round function <span class="math">y = \\mathcal{J}(x)</span> can be rewritten as <span class="math">\\mathcal{J}^{-1}(y) = x</span>, and the cost of the attack depends on the minimum degree among these equivalent representations.</p>

    <p class="text-gray-300">Therefore, we instantiate the round function of <span class="math">\\mathcal{H}_{\\mathbb{E}}</span> with a low-degree function, in particular a generalized Lai-Massey construction of degree 2 (where the matrix that defines the linear layer satisfies analogous condition to the ones given for <span class="math">M_{\\mathcal{I}}</span>). An alternative approach (used e.g. in Rescue) applies both high-degree and low-degree nonlinear power maps (recalled in Section 2.2). It is efficient in the MPC setting, and would prompt <span class="math">\\mathcal{H}_{\\mathbb{E}}</span> to quickly reach its maximal degree. However, since reaching the maximal degree will not be a primary concern of ours (due to the high number of variables), we opt for the former choice of round functions, which allows Hydra to be fast in the plain setting as well.</p>

    <h2 id="sec-38" class="text-2xl font-bold">6.3 The Rolling Functions <span class="math">\\mathcal{R}_i</span></h2>

    <p class="text-gray-300">Finally, we consider a nonlinear rolling function, as already done in Xooff [22] and Ciminion. This has multiple advantages, such as frustrating the meet-in-the-middle attacks on the expansion phase described in [16, 20] and previously recalled in Section 4.1, and destroying possible relation between consecutive outputs due to the feed-forward operation (see Section 4.1 for details).</p>

    <p class="text-gray-300">We work with a rolling function that is different from what is used in the heads, in order to break symmetry and e.g. avoid certain approaches such as slide attacks [13]. The following (generalized) result ensures the invertibility of the chosen rolling function.</p>

    <p class="text-gray-300"><strong>Proposition 2.</strong> Let <span class="math">n = 2 \\cdot n&#x27; \\geq 4</span>, with <span class="math">n&#x27; \\geq 2</span>, and <span class="math">\\{\\lambda_i, \\lambda_i&#x27;, \\varphi_i, \\varphi_i&#x27;\\}_{0 \\leq i \\leq n&#x27; - 1}</span> be a set of constants in <span class="math">\\mathbb{F}_p \\setminus \\{0\\}</span> satisfying <span class="math">\\sum_{i=0}^{n&#x27; - 1} \\lambda_i = \\sum_{i=0}^{n&#x27; - 1} \\lambda_i&#x27; = \\sum_{i=0}^{n&#x27; - 1} \\varphi_i&#x27; = 0</span>. Let furthermore <span class="math">G, H: \\mathbb{F}_p \\to \\mathbb{F}_p</span> be any <span class="math">\\mathbb{F}_p</span> functions. Then the function <span class="math">\\mathcal{F}</span> over <span class="math">\\mathbb{F}_p^n</span> defined as <span class="math">\\mathcal{F}(x_0, \\ldots, x_{n-1}) = (y_0, \\ldots, y_{n-1})</span> is invertible for</p>

    <div class="my-4 text-center"><span class="math-block">y _ {i} := \\left\\{ \\begin{array}{l l} x _ {i} + \\left(\\sum_ {j = n ^ {\\prime}} ^ {n - 1} \\varphi_ {j - n ^ {\\prime}} \\cdot x _ {j}\\right) \\cdot G \\left(\\sum_ {j = 0} ^ {n ^ {\\prime} - 1} \\lambda_ {j} \\cdot x _ {j}\\right) &amp;amp; \\text{if } i \\in \\{0, \\ldots , n ^ {\\prime} - 1 \\}, \\\\ x _ {i} + \\left(\\sum_ {j = 0} ^ {n ^ {\\prime} - 1} \\varphi_ {j} ^ {\\prime} \\cdot x _ {j}\\right) \\cdot H \\left(\\sum_ {j = n ^ {\\prime}} ^ {n - 1} \\lambda_ {j - n ^ {\\prime}} ^ {\\prime} \\cdot x _ {j}\\right) &amp;amp; \\text{if } i \\in \\{n ^ {\\prime}, \\ldots , n - 1 \\}. \\end{array} \\right.</span></div>

    <p class="text-gray-300">The proof is given in Appendix F.2. We impose that <span class="math">(\\lambda_0, \\dots, \\lambda_{n&#x27; - 1})</span>, <span class="math">(\\varphi_0&#x27;, \\dots, \\varphi_{n&#x27; - 1}&#x27;) \\in \\mathbb{F}_p^{n&#x27;}</span> and <span class="math">(\\varphi_0, \\dots, \\varphi_{n&#x27; - 1})</span>, <span class="math">(\\lambda_0&#x27;, \\dots, \\lambda_{n&#x27; - 1}&#x27;) \\in \\mathbb{F}_p^{n&#x27;}</span> are pairwise linearly independent, in order to guarantee that the variables <span class="math">v</span> and <span class="math">w</span> in Eq. (9) are independent (i.e., there is no <span class="math">\\omega \\in \\mathbb{F}_p</span> such that <span class="math">v = \\omega \\cdot w</span>) with high probability.</p>

    <p class="text-gray-300">As before, the matrix <span class="math">M_{\\mathcal{R}}</span> is chosen in order to break infinitely long invariant subspace trails. Since the constants that defined the (generalized) Lai-Massey functions (namely, <span class="math">(1, -1, 1, -1)</span> and <span class="math">(1, 1, -1, -1) \\in \\mathbb{F}_p^4</span>) are the same for the rolling function and for the body's internal rounds, we defined <span class="math">M_{\\mathcal{R}}</span> via <span class="math">M_{\\mathcal{I}}</span>.</p>

    <p class="text-gray-300">22</p>

    <p class="text-gray-300">7 Security Analysis</p>

    <p class="text-gray-300">Inspired by Ciminion, we choose the number of rounds such that <span class="math">x\\mapsto\\mathtt{K}+\\mathcal{B}(x+\\mathtt{K})</span> behaves like a PRP (where an attacker is free to choose its inputs and outputs) and no attack works on the expansion phase of Hydra. In the following, we motivate this choice and justify the number of rounds given in Section 5.5.</p>

    <h3 id="sec-39" class="text-xl font-semibold mt-8">7.1 Overview</h3>

    <h4 id="sec-40" class="text-lg font-semibold mt-6">Attacks on the Body.</h4>

    <p class="text-gray-300">Attacks taking into account the relations between the inputs and the outputs of Hydra are in general harder than the attacks taking into account the relations between the inputs and the outputs of <span class="math">\\mathcal{B}</span>. Hence, if an attacker is not able to break <span class="math">x\\mapsto\\mathtt{K}+\\mathcal{B}(x+\\mathtt{K})</span> if they have full control over the inputs and outputs, they cannot break Hydra by exploiting the relation of its inputs and outputs. Based on this fact, the chosen number of rounds guarantees that <span class="math">x\\mapsto\\mathtt{K}+\\mathcal{B}(x+\\mathtt{K})</span> resembles a PRP against attacks with a computational complexity of at most <span class="math">2^{\\kappa}</span> and with a data complexity of at most <span class="math">2^{\\kappa/2}</span>.</p>

    <p class="text-gray-300">We point out that this approach results in a very conservative choice for the number of rounds of <span class="math">\\mathcal{B}</span>. Indeed, in a realistic attack scenario the outputs of <span class="math">x\\mapsto\\mathtt{K}+\\mathcal{B}(x+\\mathtt{K})</span> are hidden by <span class="math">\\mathcal{H}_{\\mathtt{K}}</span>, and the overall design will still be secure if <span class="math">\\mathcal{B}</span> is instantiated with a smaller number of rounds. However, <span class="math">\\mathcal{B}</span> is computed only once, and the overall cost grows linearly with the number of computed heads <span class="math">\\mathcal{H}_{\\mathtt{K}}</span>. Hence, we find that the benefits of allowing us to simplify the security analysis of the heads outweighs this modest increase in computational cost.</p>

    <h4 id="sec-41" class="text-lg font-semibold mt-6">Attacks on the Heads.</h4>

    <p class="text-gray-300">In order to be competitive in MPC, we design <span class="math">\\mathcal{H}_{\\mathtt{K}}</span> such that Hydra is secure under the assumption that <span class="math">\\mathtt{K}+\\mathcal{B}(x+\\mathtt{K})</span> behaves like a PRP. In particular, the attacker only knows the outputs of the <span class="math">\\mathcal{H}_{\\mathtt{K}}</span> calls, and cannot choose any inputs with particular statistical or algebraic properties. Hence, the only possibility is to exploit the relations among the outputs of consecutive <span class="math">\\mathcal{H}_{\\mathtt{K}}</span> calls, which originate from the same (unknown) input <span class="math">y,z\\in\\mathbb{F}_{p}^{4}</span>. This can be used when constructing systems of polynomial equations from <span class="math">\\mathcal{H}_{\\mathtt{K}}</span>. Indeed, we will later see that the most competitive attacks are Gröbner basis ones.</p>

    <h3 id="sec-42" class="text-xl font-semibold mt-8">7.2 Security Analysis of <span class="math">\\mathcal{B}</span></h3>

    <p class="text-gray-300">Since <span class="math">\\mathcal{B}</span> is heavily based on the Hades construction, its security analysis is also similar. In particular, the external rounds of a Hades design provide security against statistical attacks. Since this part of <span class="math">\\mathcal{B}</span> is the same as in HadesMiMC, the security analysis proposed in <em>[33, Sect. 4.1 – 5.1]</em> also applies here. The internal rounds of <span class="math">\\mathcal{B}</span> are instantiated with a Lai–Massey scheme, while the internal rounds of HadesMiMC are instantiated with a partial SPN scheme. However, the security argument proposed for HadesMiMC in <em>[33, Sect. 4.2 – 5.2]</em> regarding algebraic attacks can be easily adapted to the case of <span class="math">\\mathcal{B}</span>.</p>

    <p class="text-gray-300">####</p>

    <p class="text-gray-300">We refer to Appendix G for more details. We point out that <span class="math">x\\mapsto\\mathtt{K}+\\mathcal{B}(x+\\mathtt{K})</span> is an Even–Mansour construction in which <span class="math">\\mathcal{B}</span> is independent of the key, while a key addition takes place among every round in HadesMiMC. This fact is taken care of in the analysis proposed in Appendix G, keeping in mind that the Even–Mansour construction cannot guarantee more than <span class="math">2\\cdot\\log_{2}(p)\\geq\\kappa</span> bits of security <em>[21, 29]</em> (this value is reached when <span class="math">\\mathcal{B}</span> resembles a PRP).</p>

    <p class="text-gray-300">Finally, in Appendix H we show how to choose the matrix that defines the linear layer of the internal rounds of <span class="math">\\mathcal{B}</span> in order to break the invariant subspace trails of the Lai–Massey scheme, by modifying the strategy proposed in <em>[36]</em> for the case of partial SPN schemes.</p>

    <h3 id="sec-43" class="text-xl font-semibold mt-8">7.3 Statistical and Invariant Subspace Attacks on <span class="math">\\mathcal{H}_{\\mathtt{K}}</span></h3>

    <p class="text-gray-300">It is infeasible for the attacker to choose inputs <span class="math">\\{x_{j}\\}_{j}</span> for <span class="math">\\mathcal{B}</span> such that the corresponding outputs <span class="math">\\{y_{j}\\}_{j}</span> satisfy certain statistical/algebraic properties, which makes it hard to mount statistical attacks on the heads <span class="math">\\mathcal{H}_{\\mathtt{K}}</span>. However, it is still desirable that <span class="math">\\mathcal{H}_{\\mathtt{K}}</span> has good statistical properties.</p>

    <p class="text-gray-300">To this end, the matrix <span class="math">M_{\\mathcal{J}}\\in\\mathbb{F}_{p}^{8\\times 8}</span> is chosen such that no (invariant) subspace trail and probability-1 truncated differential can cover more than 7 rounds (see Appendix H). Hence, the probability of each differential characteristic over <span class="math">R_{\\mathcal{H}}</span> rounds is at most <span class="math">p^{-\\lfloor R_{\\mathcal{H}}/8\\rfloor}</span>, since the maximum differential probability of <span class="math">S_{\\mathcal{J}}</span> is <span class="math">p^{-1}</span> (see Appendix I.1) and at least one <span class="math">S_{\\mathcal{J}}</span> function is active every 8 rounds. By choosing <span class="math">R_{\\mathcal{H}}\\geq 24</span>, the probability of each differential characteristic is at most <span class="math">p^{-3}\\leq 2^{-1.5\\kappa}</span>, which we conjecture to be sufficient for preventing differential and, more generally, other statistical attacks in the considered scenario.</p>

    <h3 id="sec-44" class="text-xl font-semibold mt-8">7.4 Algebraic and Gröbner Basis Attacks on <span class="math">\\mathcal{H}_{\\mathtt{K}}</span></h3>

    <p class="text-gray-300">It is not possible to mount an interpolation attack, since the input <span class="math">y</span>, <span class="math">z</span> is unknown and the polynomials associated with the various heads differ for each <span class="math">i</span>. Thus, the remainder of this section will be devoted to Gröbner basis attacks.</p>

    <p class="text-gray-300">Note that the variables <span class="math">y</span> and <span class="math">z</span> are clearly not independent, as they both depend on <span class="math">x</span>. Moreover, <span class="math">z</span> can be written as a function of <span class="math">y</span> (the converse does not hold, since the function that outputs <span class="math">z</span> is, in general, not invertible). However, these functions would be dense and reach maximum degree, which implies that the cost of an attack making use of them would be prohibitively expensive. Hence, we will treat <span class="math">y</span> and <span class="math">z</span> as independent variables in the following.</p>

    <h4 id="sec-45" class="text-lg font-semibold mt-6">Preliminaries: Gröbner Basis Attacks.</h4>

    <p class="text-gray-300">The most efficient methods for solving multivariate systems over large finite fields involve computing a Gröbner basis associated with the system. We refer to <em>[19]</em> for details on the underlying theory.</p>

    <p class="text-gray-300">Computing a Gröbner basis (in the grevlex order) is, in general, only one of the steps involved in solving a system of polynomials. In our setting, an attacker is able to set up an overdetermined polynomial system where a unique solution can be expected. In this case it is often possible to read the solution</p>

    <p class="text-gray-300">directly from the grevlex Gröbner basis, which is why we will solely focus on the step of computing said basis. There are no general complexity estimates for the running time of state-of-the-art Gröbner basis algorithms such as <span class="math">\\mathrm{F}_{4}</span> <em>[31]</em>. There is, however, an important class of polynomial systems, known as semi-regular (see <em>[7]</em> for a definition), that is well understood. For a semi-regular system the degree of the polynomials encountered in <span class="math">\\mathrm{F}_{4}</span> is expected to reach the degree of regularity <span class="math">D_{\\mathrm{reg}}</span>, which in this case can be defined as the index of the first non-positive coefficient in the series</p>

    <p class="text-gray-300"><span class="math">H(z)=\\frac{\\prod_{i=1}^{n_{e}}(1-z^{d_{i}})}{(1-z)^{n_{v}}},</span> (10)</p>

    <p class="text-gray-300">for <span class="math">n_{e}</span> polynomials in <span class="math">n_{v}</span> variables, where <span class="math">d_{i}</span> is the degree of the <span class="math">i</span>-th equation. The estimated complexity of computing a grevlex Gröbner basis is then</p>

    <p class="text-gray-300"><span class="math">\\mathcal{O}\\left(\\binom{D_{\\mathrm{reg}}+n_{v}}{n_{v}}^{\\omega}\\right),</span> (11)</p>

    <p class="text-gray-300">where <span class="math">2\\leq\\omega\\leq 3</span> is the linear algebra constant representing the cost of matrix multiplication and <span class="math">D_{\\mathrm{reg}}</span> the associated degree of regularity <em>[7]</em>.</p>

    <h4 id="sec-46" class="text-lg font-semibold mt-6">Gröbner Basis Attacks on <span class="math">\\mathcal{H}_{\\mathbb{R}}</span>.</h4>

    <p class="text-gray-300">There are many possible ways to represent a cryptographic construction as a system of multivariate polynomials, and this choice impacts the performance of the Gröbner basis algorithm. Note that the degree of <span class="math">\\mathcal{H}_{\\mathbb{R}}(\\mathcal{R}_{i}(y,z))</span> increases with <span class="math">i</span>, and it is therefore not possible to collect enough polynomials for solving by direct linearization at a relatively small degree, as discussed in Appendix G.2. Instead, we find that the most efficient attack includes only <span class="math">\\mathcal{H}_{\\mathbb{R}}(y,z)</span> and <span class="math">\\mathcal{H}_{\\mathbb{R}}(\\mathcal{R}_{1}(y,z))</span> in a representation that introduces new variables and equations for each round. While this increases the number of variables, it keeps the degree low, and allows exploitation of the small number of multiplications in each round. We outline our findings in the following, and we refer to Appendix I.2 for more details on the underlying arguments.</p>

    <p class="text-gray-300">The most promising intermediate modeling can be reduced to a system of <span class="math">2R_{\\mathcal{H}}+2</span> quadratic equations in <span class="math">2R_{\\mathcal{H}}-2</span> variables, where <span class="math">R_{\\mathcal{H}}</span> is the number of rounds in <span class="math">\\mathcal{H}_{\\mathbb{R}}</span>. Further analysis shows that the tested systems are semi-regular, and in particular that the degrees encountered in the <span class="math">\\mathrm{F}_{4}</span> algorithm are well-estimated by the series <span class="math">H(z)</span> in Eq. (10). Solving times are also comparable to that of solving randomly generated semi-regular systems with the same parameters. Still, the systems from <span class="math">\\mathcal{H}_{\\mathbb{R}}</span> are sparser than what can be expected from randomly generated systems. To ensure that this cannot be exploited, we add 2 extra rounds on top of this baseline. Hence, for a security level <span class="math">\\kappa</span> we follow Eq. (11) and define <span class="math">R_{\\mathcal{H}}^{<em>}=R_{\\mathcal{H}}^{</em>}(\\kappa)</span> to be the minimum positive integer such that</p>

    <p class="text-gray-300"><span class="math">\\binom{2R_{\\mathcal{H}}^{<em>}-2+D_{\\mathrm{reg}}}{2R_{\\mathcal{H}}^{</em>}-2}^{2}\\geq 2^{\\kappa}\\,,</span> (12)</p>

    <p class="text-gray-300">where <span class="math">D_{\\mathrm{reg}}</span> is computed from Eq. (10) using <span class="math">n_{e}=2R_{\\mathcal{H}}^{<em>}+2</span> and <span class="math">n_{v}=2R_{\\mathcal{H}}^{</em>}-2</span>. We claim that <span class="math">R_{\\mathcal{H}}^{*}(\\kappa)+2</span> is sufficient to provide <span class="math">\\kappa</span>-bit security against this attack.</p>

    <p class="text-gray-300">Table 1: Online and offline phase performance in MPC for several constructions with state sizes  <span class="math">t</span>  using a secret shared key. Prec is the number of precomputed elements (multiplication triples, squares, inverses). Depth describes the number of online communication rounds. The runtime is averaged over 200 runs.</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">t</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Cipher</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Rounds</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Offline</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Online</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Combined</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

          </tr>

        </thead>

        <tbody>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">Prec.</td>

            <td class="px-3 py-2 border-b border-gray-700">Time ms</td>

            <td class="px-3 py-2 border-b border-gray-700">Data MB</td>

            <td class="px-3 py-2 border-b border-gray-700">Depth</td>

            <td class="px-3 py-2 border-b border-gray-700">Time ms</td>

            <td class="px-3 py-2 border-b border-gray-700">Data kB</td>

            <td class="px-3 py-2 border-b border-gray-700">Time ms</td>

            <td class="px-3 py-2 border-b border-gray-700">Data MB</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">8</td>

            <td class="px-3 py-2 border-b border-gray-700">HYDRA</td>

            <td class="px-3 py-2 border-b border-gray-700">6, 42, 39</td>

            <td class="px-3 py-2 border-b border-gray-700">171</td>

            <td class="px-3 py-2 border-b border-gray-700">39.99</td>

            <td class="px-3 py-2 border-b border-gray-700">3.86</td>

            <td class="px-3 py-2 border-b border-gray-700">131</td>

            <td class="px-3 py-2 border-b border-gray-700">6.81</td>

            <td class="px-3 py-2 border-b border-gray-700">5.37</td>

            <td class="px-3 py-2 border-b border-gray-700">46.80</td>

            <td class="px-3 py-2 border-b border-gray-700">3.87</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">Ciminion</td>

            <td class="px-3 py-2 border-b border-gray-700">90, 14</td>

            <td class="px-3 py-2 border-b border-gray-700">867</td>

            <td class="px-3 py-2 border-b border-gray-700">227.47</td>

            <td class="px-3 py-2 border-b border-gray-700">19.55</td>

            <td class="px-3 py-2 border-b border-gray-700">735</td>

            <td class="px-3 py-2 border-b border-gray-700">21.81</td>

            <td class="px-3 py-2 border-b border-gray-700">28.02</td>

            <td class="px-3 py-2 border-b border-gray-700">249.29</td>

            <td class="px-3 py-2 border-b border-gray-700">19.58</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">HADESMiMC</td>

            <td class="px-3 py-2 border-b border-gray-700">6, 71</td>

            <td class="px-3 py-2 border-b border-gray-700">238</td>

            <td class="px-3 py-2 border-b border-gray-700">52.66</td>

            <td class="px-3 py-2 border-b border-gray-700">5.37</td>

            <td class="px-3 py-2 border-b border-gray-700">79</td>

            <td class="px-3 py-2 border-b border-gray-700">17.58</td>

            <td class="px-3 py-2 border-b border-gray-700">5.99</td>

            <td class="px-3 py-2 border-b border-gray-700">70.24</td>

            <td class="px-3 py-2 border-b border-gray-700">5.38</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">Rescue</td>

            <td class="px-3 py-2 border-b border-gray-700">10</td>

            <td class="px-3 py-2 border-b border-gray-700">960</td>

            <td class="px-3 py-2 border-b border-gray-700">254.80</td>

            <td class="px-3 py-2 border-b border-gray-700">21.65</td>

            <td class="px-3 py-2 border-b border-gray-700">33</td>

            <td class="px-3 py-2 border-b border-gray-700">12.65</td>

            <td class="px-3 py-2 border-b border-gray-700">23.32</td>

            <td class="px-3 py-2 border-b border-gray-700">267.45</td>

            <td class="px-3 py-2 border-b border-gray-700">21.68</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">32</td>

            <td class="px-3 py-2 border-b border-gray-700">HYDRA</td>

            <td class="px-3 py-2 border-b border-gray-700">6, 42, 39</td>

            <td class="px-3 py-2 border-b border-gray-700">294</td>

            <td class="px-3 py-2 border-b border-gray-700">72.67</td>

            <td class="px-3 py-2 border-b border-gray-700">6.63</td>

            <td class="px-3 py-2 border-b border-gray-700">134</td>

            <td class="px-3 py-2 border-b border-gray-700">13.36</td>

            <td class="px-3 py-2 border-b border-gray-700">9.69</td>

            <td class="px-3 py-2 border-b border-gray-700">86.03</td>

            <td class="px-3 py-2 border-b border-gray-700">6.64</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">Ciminion</td>

            <td class="px-3 py-2 border-b border-gray-700">90, 14</td>

            <td class="px-3 py-2 border-b border-gray-700">3207</td>

            <td class="px-3 py-2 border-b border-gray-700">910.11</td>

            <td class="px-3 py-2 border-b border-gray-700">72.30</td>

            <td class="px-3 py-2 border-b border-gray-700">2895</td>

            <td class="px-3 py-2 border-b border-gray-700">84.37</td>

            <td class="px-3 py-2 border-b border-gray-700">103.29</td>

            <td class="px-3 py-2 border-b border-gray-700">994.47</td>

            <td class="px-3 py-2 border-b border-gray-700">72.41</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">HADESMiMC</td>

            <td class="px-3 py-2 border-b border-gray-700">6, 71</td>

            <td class="px-3 py-2 border-b border-gray-700">526</td>

            <td class="px-3 py-2 border-b border-gray-700">137.49</td>

            <td class="px-3 py-2 border-b border-gray-700">11.87</td>

            <td class="px-3 py-2 border-b border-gray-700">79</td>

            <td class="px-3 py-2 border-b border-gray-700">225.86</td>

            <td class="px-3 py-2 border-b border-gray-700">13.29</td>

            <td class="px-3 py-2 border-b border-gray-700">363.35</td>

            <td class="px-3 py-2 border-b border-gray-700">11.88</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">Rescue</td>

            <td class="px-3 py-2 border-b border-gray-700">10</td>

            <td class="px-3 py-2 border-b border-gray-700">3840</td>

            <td class="px-3 py-2 border-b border-gray-700">1253.76</td>

            <td class="px-3 py-2 border-b border-gray-700">86.60</td>

            <td class="px-3 py-2 border-b border-gray-700">33</td>

            <td class="px-3 py-2 border-b border-gray-700">109.80</td>

            <td class="px-3 py-2 border-b border-gray-700">92.82</td>

            <td class="px-3 py-2 border-b border-gray-700">1363.56</td>

            <td class="px-3 py-2 border-b border-gray-700">86.70</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">64</td>

            <td class="px-3 py-2 border-b border-gray-700">HYDRA</td>

            <td class="px-3 py-2 border-b border-gray-700">6, 42, 39</td>

            <td class="px-3 py-2 border-b border-gray-700">458</td>

            <td class="px-3 py-2 border-b border-gray-700">119.07</td>

            <td class="px-3 py-2 border-b border-gray-700">10.33</td>

            <td class="px-3 py-2 border-b border-gray-700">138</td>

            <td class="px-3 py-2 border-b border-gray-700">20.57</td>

            <td class="px-3 py-2 border-b border-gray-700">15.45</td>

            <td class="px-3 py-2 border-b border-gray-700">139.64</td>

            <td class="px-3 py-2 border-b border-gray-700">10.35</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">Ciminion</td>

            <td class="px-3 py-2 border-b border-gray-700">90, 14</td>

            <td class="px-3 py-2 border-b border-gray-700">6327</td>

            <td class="px-3 py-2 border-b border-gray-700">2262.55</td>

            <td class="px-3 py-2 border-b border-gray-700">142.64</td>

            <td class="px-3 py-2 border-b border-gray-700">5775</td>

            <td class="px-3 py-2 border-b border-gray-700">178.66</td>

            <td class="px-3 py-2 border-b border-gray-700">203.64</td>

            <td class="px-3 py-2 border-b border-gray-700">2441.21</td>

            <td class="px-3 py-2 border-b border-gray-700">142.84</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">HADESMiMC</td>

            <td class="px-3 py-2 border-b border-gray-700">6, 71</td>

            <td class="px-3 py-2 border-b border-gray-700">910</td>

            <td class="px-3 py-2 border-b border-gray-700">251.44</td>

            <td class="px-3 py-2 border-b border-gray-700">20.53</td>

            <td class="px-3 py-2 border-b border-gray-700">79</td>

            <td class="px-3 py-2 border-b border-gray-700">899.55</td>

            <td class="px-3 py-2 border-b border-gray-700">23.02</td>

            <td class="px-3 py-2 border-b border-gray-700">1150.99</td>

            <td class="px-3 py-2 border-b border-gray-700">20.55</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">Rescue</td>

            <td class="px-3 py-2 border-b border-gray-700">10</td>

            <td class="px-3 py-2 border-b border-gray-700">7680</td>

            <td class="px-3 py-2 border-b border-gray-700">2851.56</td>

            <td class="px-3 py-2 border-b border-gray-700">173.20</td>

            <td class="px-3 py-2 border-b border-gray-700">33</td>

            <td class="px-3 py-2 border-b border-gray-700">402.34</td>

            <td class="px-3 py-2 border-b border-gray-700">185.50</td>

            <td class="px-3 py-2 border-b border-gray-700">3253.90</td>

            <td class="px-3 py-2 border-b border-gray-700">173.39</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">128</td>

            <td class="px-3 py-2 border-b border-gray-700">HYDRA</td>

            <td class="px-3 py-2 border-b border-gray-700">6, 42, 39</td>

            <td class="px-3 py-2 border-b border-gray-700">786</td>

            <td class="px-3 py-2 border-b border-gray-700">206.08</td>

            <td class="px-3 py-2 border-b border-gray-700">17.72</td>

            <td class="px-3 py-2 border-b border-gray-700">146</td>

            <td class="px-3 py-2 border-b border-gray-700">37.49</td>

            <td class="px-3 py-2 border-b border-gray-700">26.97</td>

            <td class="px-3 py-2 border-b border-gray-700">243.58</td>

            <td class="px-3 py-2 border-b border-gray-700">17.75</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">Ciminion</td>

            <td class="px-3 py-2 border-b border-gray-700">90, 14</td>

            <td class="px-3 py-2 border-b border-gray-700">12567</td>

            <td class="px-3 py-2 border-b border-gray-700">4854.43</td>

            <td class="px-3 py-2 border-b border-gray-700">283.32</td>

            <td class="px-3 py-2 border-b border-gray-700">11535</td>

            <td class="px-3 py-2 border-b border-gray-700">328.79</td>

            <td class="px-3 py-2 border-b border-gray-700">404.34</td>

            <td class="px-3 py-2 border-b border-gray-700">5183.22</td>

            <td class="px-3 py-2 border-b border-gray-700">283.72</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">HADESMiMC</td>

            <td class="px-3 py-2 border-b border-gray-700">6, 71</td>

            <td class="px-3 py-2 border-b border-gray-700">1678</td>

            <td class="px-3 py-2 border-b border-gray-700">463.59</td>

            <td class="px-3 py-2 border-b border-gray-700">37.85</td>

            <td class="px-3 py-2 border-b border-gray-700">79</td>

            <td class="px-3 py-2 border-b border-gray-700">4371.02</td>

            <td class="px-3 py-2 border-b border-gray-700">42.47</td>

            <td class="px-3 py-2 border-b border-gray-700">4834.61</td>

            <td class="px-3 py-2 border-b border-gray-700">37.89</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">Rescue</td>

            <td class="px-3 py-2 border-b border-gray-700">10</td>

            <td class="px-3 py-2 border-b border-gray-700">15360</td>

            <td class="px-3 py-2 border-b border-gray-700">5934.39</td>

            <td class="px-3 py-2 border-b border-gray-700">346.40</td>

            <td class="px-3 py-2 border-b border-gray-700">33</td>

            <td class="px-3 py-2 border-b border-gray-700">1549.16</td>

            <td class="px-3 py-2 border-b border-gray-700">370.84</td>

            <td class="px-3 py-2 border-b border-gray-700">7483.55</td>

            <td class="px-3 py-2 border-b border-gray-700">346.77</td>

          </tr>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">Concrete Example for  <span class="math">\\kappa = 128</span> . In this case we get  <span class="math">R_{\\mathcal{H}}^{<em>}(128) = 29</span> , which in turn yields  <span class="math">n_e = 60</span>  quadratic equations in  <span class="math">n_v = 56</span>  variables. By expanding the resulting series in Eq. (10), we get  <span class="math">D_{\\mathrm{reg}} = 23</span>  for this system, and the security estimate  <span class="math">\\binom{56+23}{56}^2 \\approx 2^{130.8}</span>  follows. Thus, we claim that  <span class="math">R_{\\mathcal{H}}^{</em>}(128) + 2 = 31</span>  is sufficient to provide 128-bit security against Gröbner basis attacks.</p>

    <p class="text-gray-300">In this section, we evaluate the performance of HYDRA compared to other PRFs in MPC use cases which assume a secret shared key. We implemented HYDRA and its competitors using the MP-SPDZ library [41] <span class="math">^{12}</span>  (version 0.2.8, files can be found in Appendix A) and benchmark it using SPDZ [25, 24] with the MAS-COT [42] offline phase protocol. Concretely, we benchmark a two-party setting in a simulated LAN network (1 Gbit/s and  <span class="math">\\ll 1</span>  ms average round-trip time) using a Xeon E5-2669v4 CPU (2.6 GHz), where each party is assigned only 1 core. SPDZ, and therefore all the PRFs, is instantiated using a 128-bit prime  <span class="math">p</span> , with  <span class="math">\\gcd(3, p - 1) = 1</span> , thus ensuring that  <span class="math">x \\mapsto x^3</span>  is a permutation, as required by HADESMiMC, Rescue, MiMC, GMiMC, and HYDRA. All PRFs are instantiated</p>

    <p class="text-gray-300">with <span class="math">\\kappa=128</span>. Hydra requires <span class="math">4\\cdot R_{\\mathcal{E}}\\cdot(\\mathrm{hw}(d)+\\lfloor\\log_{2}(d)\\rfloor-1)+2\\cdot R_{\\mathcal{I}}+(R_{\\mathcal{H}}+2)\\cdot\\lceil\\frac{t}{8}\\rceil-2</span> multiplications, hence <span class="math">130+41\\cdot\\lceil\\frac{t}{8}\\rceil</span> in this setting.</p>

    <p class="text-gray-300">We implemented all <span class="math">x^{3}</span> evaluations using the technique from <em>[35]</em> (see Algorithm 4), which requires one precomputed Beaver triple, one precomputed shared random square, and one online communication round. Furthermore, we implemented <span class="math">x^{1/3}</span> (as used in <em>Rescue</em>) using the technique described in <em>[5]</em> (see Algorithm 6). MP-SPDZ allows to precompute squares and inverses from Beaver triples in an additional communication round in the offline phase (see Section 2).</p>

    <p class="text-gray-300">In Table 1, we compare the performance of Hydra to some competitors when encrypting <span class="math">t</span> plaintext words, for a comparison with more PRFs we refer to Appendix J. We give concrete runtimes, as well as the amount of data transmitted by each party during the evaluation of the offline and online phases. Further, we give the combined number of triples, squares, and inverses which need to be created during the offline phase, as well as the total number of communication rounds (i.e., the depth of the PRF) in the online phase. In the offline phase only the required number of triples, squares, and inverses is precomputed.</p>

    <p class="text-gray-300">Table 1 shows that the offline phase dominates both the overall runtime and the total communication between the parties. Hydra always requires less precomputation than Ciminion, HadesMiMC, and <em>Rescue</em>, hence, it has a significantly more efficient offline phase with the advantage growing with <span class="math">t</span>. Looking at the online phase, Hydra is faster and requires less communication than its competitors, which is due to the smaller number of multiplications and the better plain performance. While Ciminion is slow due to the expensive key schedule, HadesMiMC requires many expensive MDS matrix multiplications (see Appendix K) and <em>Rescue</em> requires expensive <span class="math">x^{1/d}</span> evaluations.</p>

    <p class="text-gray-300">For the sake of completeness, in Table 2 we also compare the performance of Hydra to Ciminion and <em>Rescue</em> in the case in which the round keys are already present. Comparing Hydra to Ciminion without a key schedule, one can observe that Ciminion’s online phase is always faster. However, Hydra’s number of multiplications scales significantly better than Ciminion’s, hence, for larger state sizes (<span class="math">t\\geq 32</span>) Hydra has a faster offline phase performance, as well as less communication in the online phase.</p>

    <p class="text-gray-300">To summarize, our experiments show that Hydra is the most efficient PRF in both phases of the MPC protocols. Only if we discard the key schedules, Ciminion is competitive for small state sizes <span class="math">t&lt;32</span>. Thus, using Hydra leads to a significant performance improvement in MPC use cases, especially in high-throughput conditions. In applications, where the offline phase plays a minor role, e.g., when triples are continuously precomputed and rarely consumed, Hydra still leads to an performance advantage due to requiring less communication between the parties, however, the advantage will be smaller.</p>

    <p class="text-gray-300">Table 2: Online and offline phase performance in MPC for several constructions with state sizes  <span class="math">t</span>  using a secret shared key. Prec is the number of precomputed elements (multiplication triples, squares, inverses). Depth describes the number of online communication rounds. The runtime is averaged over 200 runs.</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">t</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Cipher</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Rounds</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Offline</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Online</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Combined</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

          </tr>

        </thead>

        <tbody>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">Prec.</td>

            <td class="px-3 py-2 border-b border-gray-700">Time ms</td>

            <td class="px-3 py-2 border-b border-gray-700">Data MB</td>

            <td class="px-3 py-2 border-b border-gray-700">Depth</td>

            <td class="px-3 py-2 border-b border-gray-700">Time ms</td>

            <td class="px-3 py-2 border-b border-gray-700">Data kB</td>

            <td class="px-3 py-2 border-b border-gray-700">Time ms</td>

            <td class="px-3 py-2 border-b border-gray-700">Data MB</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">8</td>

            <td class="px-3 py-2 border-b border-gray-700">HYDRA</td>

            <td class="px-3 py-2 border-b border-gray-700">6, 42, 39</td>

            <td class="px-3 py-2 border-b border-gray-700">171</td>

            <td class="px-3 py-2 border-b border-gray-700">39.99</td>

            <td class="px-3 py-2 border-b border-gray-700">3.86</td>

            <td class="px-3 py-2 border-b border-gray-700">131</td>

            <td class="px-3 py-2 border-b border-gray-700">6.81</td>

            <td class="px-3 py-2 border-b border-gray-700">5.37</td>

            <td class="px-3 py-2 border-b border-gray-700">46.80</td>

            <td class="px-3 py-2 border-b border-gray-700">3.87</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">Ciminion (No KS)a</td>

            <td class="px-3 py-2 border-b border-gray-700">90, 14</td>

            <td class="px-3 py-2 border-b border-gray-700">148</td>

            <td class="px-3 py-2 border-b border-gray-700">35.64</td>

            <td class="px-3 py-2 border-b border-gray-700">3.34</td>

            <td class="px-3 py-2 border-b border-gray-700">107</td>

            <td class="px-3 py-2 border-b border-gray-700">3.98</td>

            <td class="px-3 py-2 border-b border-gray-700">5.02</td>

            <td class="px-3 py-2 border-b border-gray-700">39.62</td>

            <td class="px-3 py-2 border-b border-gray-700">3.35</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">Rescue (No KS)a</td>

            <td class="px-3 py-2 border-b border-gray-700">10</td>

            <td class="px-3 py-2 border-b border-gray-700">480</td>

            <td class="px-3 py-2 border-b border-gray-700">129.47</td>

            <td class="px-3 py-2 border-b border-gray-700">10.83</td>

            <td class="px-3 py-2 border-b border-gray-700">33</td>

            <td class="px-3 py-2 border-b border-gray-700">6.95</td>

            <td class="px-3 py-2 border-b border-gray-700">11.80</td>

            <td class="px-3 py-2 border-b border-gray-700">136.42</td>

            <td class="px-3 py-2 border-b border-gray-700">10.84</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">32</td>

            <td class="px-3 py-2 border-b border-gray-700">HYDRA</td>

            <td class="px-3 py-2 border-b border-gray-700">6, 42, 39</td>

            <td class="px-3 py-2 border-b border-gray-700">294</td>

            <td class="px-3 py-2 border-b border-gray-700">72.67</td>

            <td class="px-3 py-2 border-b border-gray-700">6.63</td>

            <td class="px-3 py-2 border-b border-gray-700">134</td>

            <td class="px-3 py-2 border-b border-gray-700">13.36</td>

            <td class="px-3 py-2 border-b border-gray-700">9.69</td>

            <td class="px-3 py-2 border-b border-gray-700">86.03</td>

            <td class="px-3 py-2 border-b border-gray-700">6.64</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">Ciminion (No KS)a</td>

            <td class="px-3 py-2 border-b border-gray-700">90, 14</td>

            <td class="px-3 py-2 border-b border-gray-700">328</td>

            <td class="px-3 py-2 border-b border-gray-700">80.79</td>

            <td class="px-3 py-2 border-b border-gray-700">7.40</td>

            <td class="px-3 py-2 border-b border-gray-700">119</td>

            <td class="px-3 py-2 border-b border-gray-700">5.42</td>

            <td class="px-3 py-2 border-b border-gray-700">11.16</td>

            <td class="px-3 py-2 border-b border-gray-700">86.21</td>

            <td class="px-3 py-2 border-b border-gray-700">7.41</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">Rescue (No KS)a</td>

            <td class="px-3 py-2 border-b border-gray-700">10</td>

            <td class="px-3 py-2 border-b border-gray-700">1920</td>

            <td class="px-3 py-2 border-b border-gray-700">538.19</td>

            <td class="px-3 py-2 border-b border-gray-700">43.30</td>

            <td class="px-3 py-2 border-b border-gray-700">33</td>

            <td class="px-3 py-2 border-b border-gray-700">47.35</td>

            <td class="px-3 py-2 border-b border-gray-700">46.74</td>

            <td class="px-3 py-2 border-b border-gray-700">585.54</td>

            <td class="px-3 py-2 border-b border-gray-700">43.35</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">64</td>

            <td class="px-3 py-2 border-b border-gray-700">HYDRA</td>

            <td class="px-3 py-2 border-b border-gray-700">6, 42, 39</td>

            <td class="px-3 py-2 border-b border-gray-700">458</td>

            <td class="px-3 py-2 border-b border-gray-700">119.07</td>

            <td class="px-3 py-2 border-b border-gray-700">10.33</td>

            <td class="px-3 py-2 border-b border-gray-700">138</td>

            <td class="px-3 py-2 border-b border-gray-700">20.57</td>

            <td class="px-3 py-2 border-b border-gray-700">15.45</td>

            <td class="px-3 py-2 border-b border-gray-700">139.64</td>

            <td class="px-3 py-2 border-b border-gray-700">10.35</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">Ciminion (No KS)a</td>

            <td class="px-3 py-2 border-b border-gray-700">90, 14</td>

            <td class="px-3 py-2 border-b border-gray-700">568</td>

            <td class="px-3 py-2 border-b border-gray-700">154.38</td>

            <td class="px-3 py-2 border-b border-gray-700">12.81</td>

            <td class="px-3 py-2 border-b border-gray-700">135</td>

            <td class="px-3 py-2 border-b border-gray-700">8.05</td>

            <td class="px-3 py-2 border-b border-gray-700">19.35</td>

            <td class="px-3 py-2 border-b border-gray-700">162.42</td>

            <td class="px-3 py-2 border-b border-gray-700">12.83</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">Rescue (No KS)a</td>

            <td class="px-3 py-2 border-b border-gray-700">10</td>

            <td class="px-3 py-2 border-b border-gray-700">3840</td>

            <td class="px-3 py-2 border-b border-gray-700">1226.39</td>

            <td class="px-3 py-2 border-b border-gray-700">86.60</td>

            <td class="px-3 py-2 border-b border-gray-700">33</td>

            <td class="px-3 py-2 border-b border-gray-700">144.14</td>

            <td class="px-3 py-2 border-b border-gray-700">93.34</td>

            <td class="px-3 py-2 border-b border-gray-700">1370.53</td>

            <td class="px-3 py-2 border-b border-gray-700">86.70</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">128</td>

            <td class="px-3 py-2 border-b border-gray-700">HYDRA</td>

            <td class="px-3 py-2 border-b border-gray-700">6, 42, 39</td>

            <td class="px-3 py-2 border-b border-gray-700">786</td>

            <td class="px-3 py-2 border-b border-gray-700">206.08</td>

            <td class="px-3 py-2 border-b border-gray-700">17.72</td>

            <td class="px-3 py-2 border-b border-gray-700">146</td>

            <td class="px-3 py-2 border-b border-gray-700">37.49</td>

            <td class="px-3 py-2 border-b border-gray-700">26.97</td>

            <td class="px-3 py-2 border-b border-gray-700">243.58</td>

            <td class="px-3 py-2 border-b border-gray-700">17.75</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">Ciminion (No KS)a</td>

            <td class="px-3 py-2 border-b border-gray-700">90, 14</td>

            <td class="px-3 py-2 border-b border-gray-700">1048</td>

            <td class="px-3 py-2 border-b border-gray-700">274.90</td>

            <td class="px-3 py-2 border-b border-gray-700">23.63</td>

            <td class="px-3 py-2 border-b border-gray-700">167</td>

            <td class="px-3 py-2 border-b border-gray-700">10.70</td>

            <td class="px-3 py-2 border-b border-gray-700">35.74</td>

            <td class="px-3 py-2 border-b border-gray-700">285.60</td>

            <td class="px-3 py-2 border-b border-gray-700">23.67</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">Rescue (No KS)a</td>

            <td class="px-3 py-2 border-b border-gray-700">10</td>

            <td class="px-3 py-2 border-b border-gray-700">7680</td>

            <td class="px-3 py-2 border-b border-gray-700">2943.21</td>

            <td class="px-3 py-2 border-b border-gray-700">173.20</td>

            <td class="px-3 py-2 border-b border-gray-700">33</td>

            <td class="px-3 py-2 border-b border-gray-700">737.84</td>

            <td class="px-3 py-2 border-b border-gray-700">186.52</td>

            <td class="px-3 py-2 border-b border-gray-700">3681.05</td>

            <td class="px-3 py-2 border-b border-gray-700">173.39</td>

          </tr>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">a Assumes round keys are present, i.e., no key schedule computation in MPC.</p>

    <p class="text-gray-300">The Effect of the Network. The performance of MPC applications depends on the network speed. A lower bandwidth leads to a larger effect of the communication between the parties on the overall performance. Moreover, a longer round-trip time leads to larger contributions of the number of communication rounds. In the offline phase only shared correlated randomness is created, thus the network performance affects all PRFs in the same way. Consequently, if a PRF has a faster offline phase in the LAN setting, it is also faster in a slower network environment. The situation is different in the online phase: In fast networks, the online phase performance is mostly determined by the plain runtime. In a slower network, more time is spent waiting for the network to deliver packages. HYDRA has a small number of multiplications, hence a preferable offline phase in all networks. Further, it requires little communication in the online phase, making it suitable for low-bandwidth networks. However, it has a larger depth compared to HADESMiMC and Rescue, leading to worse runtimes in high-delay networks where runtime is dominated by round_trip_time  <span class="math">\\times</span>  depth. Ciminion's key schedule has a large depth and requires lots of communication between the parties (compare Data column in Table 1 and Table 2). Thus, Ciminion is only competitive in slow networks if the key schedule does not need to be computed. Overall, HYDRA has a good balance between a small number of multiplications, little communication, decent plain performance, and a reasonable depth, making it the preferred PRF for MPC applications in most network environments.</p>

    <p class="text-gray-300">Acknowledgments. Lorenzo Grassi is supported by the European Research Council under the ERC advanced grant agreement under grant ERC-2017-ADG Nr. 788980 ESCADA. Morten Øygarden has been funded by The Research Council of Norway through the project “qsIoT: Quantum safe cryptography for the Internet of Things”. Roman Walch is supported by the ”DDAI” COMET Module within the COMET – Competence Centers for Excellent Technologies Programme, funded by the Austrian Federal Ministry for Transport, Innovation and Technology (bmvit), the Austrian Federal Ministry for Digital and Economic Affairs (bmdw), the Austrian Research Promotion Agency (FFG), the province of Styria (SFG) and partners from industry and academia. The COMET Programme is managed by FFG.</p>

    <h2 id="sec-48" class="text-2xl font-bold">References</h2>

    <ul class="list-disc list-inside space-y-1 text-gray-300 my-2 ml-4">

      <li>[1] D. Abram, I. Damgård, P. Scholl, and S. Trieflinger. “Oblivious TLS via Multiparty Computation”. In: CT-RSA. Vol. 12704. LNCS. 2021, pp. 51–74.</li>

      <li>[2] M. R. Albrecht, L. Grassi, L. Perrin, S. Ramacher, C. Rechberger, D. Rotaru, A. Roy, and M. Schofnegger. “Feistel Structures for MPC, and More”. In: ESORICS. Vol. 11736. LNCS. 2019, pp. 151–171.</li>

      <li>[3] M. R. Albrecht, L. Grassi, C. Rechberger, A. Roy, and T. Tiessen. “MiMC: Efficient Encryption and Cryptographic Hashing with Minimal Multiplicative Complexity”. In: ASIACRYPT. Vol. 10031. LNCS. 2016, pp. 191–219.</li>

      <li>[4] M. R. Albrecht, C. Rechberger, T. Schneider, T. Tiessen, and M. Zohner. “Ciphers for MPC and FHE”. In: EUROCRYPT. Vol. 9056. LNCS. 2015, pp. 430–454.</li>

      <li>[5] A. Aly, T. Ashur, E. Ben-Sasson, S. Dhooghe, and A. Szepieniec. “Design of Symmetric-Key Primitives for Advanced Cryptographic Protocols”. In: IACR Trans. Symmetric Cryptol. 2020.3 (2020), pp. 1–45.</li>

      <li>[6] E. Andreeva, V. Lallemand, A. Purnal, R. Reyhanitabar, A. Roy, and D. Vizár. “Forkcipher: A New Primitive for Authenticated Encryption of Very Short Messages”. In: ASIACRYPT. Vol. 11922. LNCS. 2019, pp. 153–182.</li>

      <li>[7] M. Bardet, J.-C. Faugére, B. Salvy, and B.-Y. Yang. “Asymptotic behaviour of the degree of regularity of semi-regular polynomial systems”. In: Proc. of MEGA. Vol. 5. 2005.</li>

      <li>[8] A. Bariant, C. Bouvier, G. Leurent, and L. Perrin. “Algebraic Attacks against Some Arithmetization-Oriented Primitives”. In: IACR Trans. Symmetric Cryptol. 2022.3 (2022), pp. 73–101.</li>

      <li>[9] D. Beaver. “Efficient Multiparty Protocols Using Circuit Randomization”. In: CRYPTO. Vol. 576. LNCS. 1991, pp. 420–432.</li>

      <li>[10] G. Bertoni, J. Daemen, S. Hoffert, M. Peeters, G. V. Assche, and R. V. Keer. “Farfalle: parallel permutation-based cryptography”. In: IACR Trans. Symmetric Cryptol. 2017.4 (2017), pp. 1–38.</li>

      <li>[11] G. Bertoni, J. Daemen, M. Peeters, and G. Van Assche. “On the Indifferentiability of the Sponge Construction”. In: EUROCRYPT. Ed. by N. P. Smart. Vol. 4965. LNCS. 2008, pp. 181–197.</li>

      <li>[12] G. Bertoni, J. Daemen, M. Peeters, and G. Van Assche. The KECCAK reference. https://keccak.team/files/Keccak-reference-3.0.pdf. 2011.</li>

    </ul>

    <p class="text-gray-300">[13] A. Biryukov and D. A. Wagner. “Slide Attacks”. In: <em>Fast Software Encryption – FSE 1999</em>. Vol. 1636. LNCS. 1999, pp. 245–259.</p>

    <ul class="list-disc list-inside space-y-1 text-gray-300 my-2 ml-4">

      <li>[14] P. Bogetoft, I. Damgård, T. P. Jakobsen, K. Nielsen, J. Pagter, and T. Toft. “A Practical Implementation of Secure Auctions Based on Multiparty Integer Computation”. In: <em>Financial Cryptography</em>. Vol. 4107. LNCS. 2006, pp. 142–147.</li>

      <li>[15] N. Bordes, J. Daemen, D. Kuijsters, and G. V. Assche. “Thinking Outside the Superbox”. In: <em>CRYPTO</em>. Vol. 12827. LNCS. 2021, pp. 337–367.</li>

      <li>[16] C. Chaigneau, T. Fuhr, H. Gilbert, J. Guo, J. Jean, J.-R. Reinhard, and L. Song. “Key-Recovery Attacks on Full Kravatte”. In: <em>IACR Trans. Symmetric Cryptol.</em> 2018.1 (2018), pp. 5–28.</li>

      <li>[17] M. Chase, D. Derler, S. Goldfeder, C. Orlandi, S. Ramacher, C. Rechberger, D. Slamanig, and G. Zaverucha. “Post-Quantum Zero-Knowledge and Signatures from Symmetric-Key Primitives”. In: <em>CCS</em>. ACM, 2017, pp. 1825–1842.</li>

      <li>[18] C. Cid, L. Grassi, A. Gunsing, R. Lüftenegger, C. Rechberger, and M. Schofnegger. “Influence of the Linear Layer on the Algebraic Degree in SP-Networks”. In: <em>IACR Trans. Symmetric Cryptol.</em> 2022.1 (2022), pp. 110–137.</li>

      <li>[19] D. Cox, J. Little, and D. O’Shea. <em>Ideals, varieties, and algorithms: an introduction to computational algebraic geometry and commutative algebra</em>. Springer Science & Business Media, 2013.</li>

      <li>[20] T. Cui and L. Grassi. “Algebraic Key-Recovery Attacks on Reduced-Round Xoofff”. In: <em>SAC</em>. Vol. 12804. LNCS. 2020, pp. 171–197.</li>

      <li>[21] J. Daemen. “Limitations of the Even-Mansour Construction”. In: <em>ASIACRYPT</em>. Vol. 739. LNCS. 1991, pp. 495–498.</li>

      <li>[22] J. Daemen, S. Hoffert, G. V. Assche, and R. V. Keer. “The design of Xoodoo and Xoofff”. In: <em>IACR Trans. Symmetric Cryptol.</em> 2018.4 (2018), pp. 1–38.</li>

      <li>[23] J. Daemen and V. Rijmen. “The Wide Trail Design Strategy”. In: <em>Cryptography and Coding - IMA International Conference 2001</em>. Vol. 2260. LNCS. 2001, pp. 222–238.</li>

      <li>[24] I. Damgård, M. Keller, E. Larraia, V. Pastro, P. Scholl, and N. P. Smart. “Practical Covertly Secure MPC for Dishonest Majority - Or: Breaking the SPDZ Limits”. In: <em>ESORICS</em>. Vol. 8134. LNCS. 2013, pp. 1–18.</li>

      <li>[25] I. Damgård, V. Pastro, N. P. Smart, and S. Zakarias. “Multiparty Computation from Somewhat Homomorphic Encryption”. In: <em>CRYPTO</em>. Vol. 7417. LNCS. Springer, 2012, pp. 643–662.</li>

      <li>[26] I. Dinur, S. Goldfeder, T. Halevi, Y. Ishai, M. Kelkar, V. Sharma, and G. Zaverucha. “MPC-Friendly Symmetric Cryptography from Alternating Moduli: Candidates, Protocols, and Applications”. In: <em>CRYPTO</em>. Vol. 12828. LNCS. 2021, pp. 517–547.</li>

      <li>[27] C. Dobraunig, L. Grassi, A. Guinet, and D. Kuijsters. “Ciminion: Symmetric Encryption Based on Toffoli-Gates over Large Finite Fields”. In: <em>EUROCRYPT</em>. Vol. 12697. LNCS. 2021, pp. 3–34.</li>

      <li>[28] C. Dobraunig, D. Kales, C. Rechberger, M. Schofnegger, and G. Zaverucha. “Shorter Signatures Based on Tailor-Made Minimalist Symmetric-Key Crypto”. In: <em>IACR Cryptol. ePrint Arch.</em> (2021). Accepted at ACM CCS 2022.</li>

      <li>[29] O. Dunkelman, N. Keller, and A. Shamir. “Minimalism in Cryptography: The Even-Mansour Scheme Revisited”. In: <em>EUROCRYPT</em>. Vol. 7237. LNCS. 2012, pp. 336–354.</li>

      <li>[30] S. Even and Y. Mansour. “A Construction of a Cipher From a Single Pseudorandom Permutation”. In: <em>ASIACRYPT</em>. Vol. 739. LNCS. 1991, pp. 210–224.</li>

    </ul>

    <p class="text-gray-300">[31] J.-C. Faugére. “A new efficient algorithm for computing Gröbner bases (F_{4})”. In: Journal of pure and applied algebra 139.1-3 (1999), pp. 61–88.</p>

    <ul class="list-disc list-inside space-y-1 text-gray-300 my-2 ml-4">

      <li>[32] L. Grassi, D. Khovratovich, C. Rechberger, A. Roy, and M. Schofnegger. “Poseidon: A New Hash Function for Zero-Knowledge Proof Systems”. In: USENIX Security Symposium. USENIX Association, 2021.</li>

      <li>[33] L. Grassi, R. Lüftenegger, C. Rechberger, D. Rotaru, and M. Schofnegger. “On a Generalization of Substitution-Permutation Networks: The HADES Design Strategy”. In: EUROCRYPT. Vol. 12106. LNCS. 2020, pp. 674–704.</li>

      <li>[34] L. Grassi, S. Onofri, M. Pedicini, and L. Sozzi. “Invertible Quadratic Non-Linear Layers for MPC-/FHE-/ZK-Friendly Schemes over <span class="math">\\mathbb{F}_{p}^{n}</span>: Application to Poseidon”. In: IACR Trans. Symmetric Cryptol. 2022.3 (2022), pp. 20–72.</li>

      <li>[35] L. Grassi, C. Rechberger, D. Rotaru, P. Scholl, and N. P. Smart. “MPC-Friendly Symmetric Key Primitives”. In: CCS. ACM, 2016, pp. 430–443.</li>

      <li>[36] L. Grassi, C. Rechberger, and M. Schofnegger. “Proving Resistance Against Infinitely Long Subspace Trails: How to Choose the Linear Layer”. In: IACR Trans. Symmetric Cryptol. 2021.2 (2021), pp. 314–352.</li>

      <li>[37] C. Guo, F.-X. Standaert, W. Wang, X. Wang, and Y. Yu. “Provable Security of SP Networks with Partial Non-Linear Layers”. In: IACR Transactions on Symmetric Cryptology 2021.2 (2021), pp. 353–388.</li>

      <li>[38] L. Helminger, D. Kales, S. Ramacher, and R. Walch. “Multi-party Revocation in Sovrin: Performance through Distributed Trust”. In: CT-RSA. Vol. 12704. LNCS. Springer, 2021, pp. 527–551.</li>

      <li>[39] Y. Ishai, E. Kushilevitz, R. Ostrovsky, and A. Sahai. “Zero-knowledge from secure multiparty computation”. In: STOC. ACM, 2007, pp. 21–30.</li>

      <li>[40] D. Kales, C. Rechberger, T. Schneider, M. Senker, and C. Weinert. “Mobile Private Contact Discovery at Scale”. In: USENIX Security Symposium. USENIX Association, 2019, pp. 1447–1464.</li>

      <li>[41] M. Keller. “MP-SPDZ: A Versatile Framework for Multi-Party Computation”. In: CCS. ACM, 2020, pp. 1575–1590.</li>

      <li>[42] M. Keller, E. Orsini, and P. Scholl. “MASCOT: Faster Malicious Arithmetic Secure Computation with Oblivious Transfer”. In: CCS. ACM, 2016, pp. 830–842.</li>

      <li>[43] X. Lai and J. L. Massey. “A Proposal for a New Block Encryption Standard”. In: EUROCRYPT. Vol. 473. LNCS. 1990, pp. 389–404.</li>

      <li>[44] S. Laur, R. Talviste, and J. Willemson. “From Oblivious AES to Efficient and Secure Database Join in the Multiparty Setting”. In: ACNS. Vol. 7954. LNCS. 2013, pp. 84–101.</li>

      <li>[45] B. Mennink and S. Neves. “Optimal PRFs from Blockcipher Designs”. In: IACR Trans. Symmetric Cryptol. 2017.3 (2017), pp. 228–252.</li>

      <li>[46] P. Mohassel and Y. Zhang. “SecureML: A System for Scalable Privacy-Preserving Machine Learning”. In: IEEE Symposium on Security and Privacy. IEEE Computer Society, 2017, pp. 19–38.</li>

      <li>[47] A. Shamir. “How to Share a Secret”. In: Commun. ACM 22.11 (1979), pp. 612–613.</li>

      <li>[48] S. Vaudenay. “On the Lai-Massey Scheme”. In: ASIACRYPT. Vol. 1716. LNCS. 1999, pp. 8–19.</li>

    </ul>

    <p class="text-gray-300">SUPPLEMENTARY MATERIAL</p>

    <h2 id="sec-49" class="text-2xl font-bold">Appendix A Supplementary Files</h2>

    <p class="text-gray-300">In the repository</p>

    <p class="text-gray-300">https://extgit.iaik.tugraz.at/krypto/hydra</p>

    <p class="text-gray-300">we provide the following files as supplementary material.</p>

    <ul class="list-disc list-inside space-y-1 text-gray-300 my-2 ml-4">

      <li>MP-SPDZ: This folder contains the MP-SPDZ framework and cipher implementations used for benchmarking.</li>

      <li>calc_round_numbers.sage: This script calculates the number of rounds for a given security level <span class="math">\\kappa</span>.</li>

      <li>hydra.sage: This script contains the reference implementation of Hydra, written in sage.</li>

    </ul>

    <p class="text-gray-300">We refer to the Readme.md file in the repository for more information about the supplied files.</p>

    <h2 id="sec-50" class="text-2xl font-bold">Appendix B Megafono and Hydra Version 0</h2>

    <p class="text-gray-300">In the first version of this paper, Megafono and Hydra were different from the ones proposed in this current version. Here we list the main differences.</p>

    <h3 id="sec-51" class="text-xl font-semibold mt-8">About Megafono Version 0:</h3>

    <ul class="list-disc list-inside space-y-1 text-gray-300 my-2 ml-4">

      <li>in the first version, a final truncation-summation techniques was applied to the outputs of the expanding parts. We decided to replace it with a feed-forward operation both in order to avoid wasting encryption material and in order to increase the security with respect to guessing attacks;</li>

    </ul>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">- we apply the rolling function on the entire state $y\\</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">z<span class="math">, as opposed to only </span>z$. We also suggest to make use of a nonlinear rolling function;</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <ul class="list-disc list-inside space-y-1 text-gray-300 my-2 ml-4">

      <li>we re-formulated the security assumption of Megafono regarding the independence between <span class="math">y</span> and <span class="math">z</span>;</li>

      <li>we also added a discussion regarding the possibility to use Megafono for more traditional confidentiality/authenticity goals as a possible replacement of Farfalle.</li>

    </ul>

    <h3 id="sec-52" class="text-xl font-semibold mt-8">About Hydra Version 0:</h3>

    <ul class="list-disc list-inside space-y-1 text-gray-300 my-2 ml-4">

      <li>the main change regards the fact that we replaced the Amaryllises construction with power maps. We noticed that for the proposed design, the construction instantiated with the power maps has almost the same security and efficiency as the one instantiated with Amaryllises. Using power maps helps simplify the construction, and allows us to devote more space to discuss the design rationale. We point out that Amaryllises is discussed in <em>[9]</em> instead;</li>

    </ul>

    <ul class="list-disc list-inside space-y-1 text-gray-300 my-2 ml-4">

      <li>due to this change, the body of Hydra is almost equivalent to the cipher HadesMiMC. As a result, we can simplify the security analysis by re-using results from the HadesMiMC paper;</li>

      <li>we decided to instantiate <span class="math">\\mathcal{B}</span> with only 6 external rounds, and show that this is indeed sufficient for achieving security;</li>

      <li>we replaced the linear rolling function with a nonlinear one.</li>

    </ul>

    <p class="text-gray-300">We emphasize that we are currently not aware of any attack on Hydra Version 0.</p>

    <h2 id="sec-53" class="text-2xl font-bold">Appendix C Hydra Matrices for <span class="math">p=2^{127}+45</span></h2>

    <p class="text-gray-300">In this section we give concrete instantiations of the matrices used in the Hydra PRF which fulfill all conditions of Section 5 for <span class="math">\\mathbb{F}_{p}</span> with <span class="math">p=2^{127}+45</span>. More specifically, for this prime we instantiate the body of Hydra with the MDS matrix <span class="math">M_{\\mathcal{E}}</span> in the external rounds, where</p>

    <p class="text-gray-300">\\[ M_{\\mathcal{E}}=\\begin{pmatrix}3&2&1&1\\\\ 1&3&2&1\\\\ 1&1&3&2\\\\ 2&1&1&3\\end{pmatrix}, \\]</p>

    <p class="text-gray-300">the matrix <span class="math">M_{\\mathcal{I}}</span> in the internal rounds, where</p>

    <p class="text-gray-300">\\[ M_{\\mathcal{I}}=\\begin{pmatrix}1&1&1&1\\\\ 1&4&1&1\\\\ 3&1&3&1\\\\ 4&1&1&2\\end{pmatrix}, \\]</p>

    <p class="text-gray-300">and finally, the matrix <span class="math">M_{\\mathcal{J}}</span> in the heads of Hydra, where</p>

    <p class="text-gray-300">\\[ M_{\\mathcal{J}}=\\begin{pmatrix}3&1&1&1&1&1&1&1\\\\ 7&3&1&1&1&1&1&1\\\\ 4&1&4&1&1&1&1&1\\\\ 3&1&1&8&1&1&1&1\\\\ 7&1&1&1&7&1&1&1\\\\ 8&1&1&1&1&5&1&1\\\\ 5&1&1&1&1&1&2&1\\\\ 4&1&1&1&1&1&1&6\\end{pmatrix}. \\]</p>

    <h2 id="sec-54" class="text-2xl font-bold">Appendix D MPC Subprotocols</h2>

    <p class="text-gray-300">In this section, we restate well known MPC subprotocols, such as beaver multiplication (Algorithm 1), generating shared squares (Algorithm 2) and shared inverses (Algorithm 3) from Beaver triples, calculating <span class="math">[x]^{3}</span> (Algorithm 4), as well as two methods for calculating <span class="math">[x]^{d}</span> (Algorithm 5 and Algorithm 6).</p>

    <p class="text-gray-300">|  Algorithm 1: Beaver Multiplications [2].  |   |</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">---</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">---</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">|  Data: [x], [y]  |   |</p>

    <p class="text-gray-300">|  Result: [xy]  |   |</p>

    <p class="text-gray-300">|  // Offline Phase  |   |</p>

    <p class="text-gray-300">|  1 [a], [b], [ab] ← GenTriple()  |   |</p>

    <p class="text-gray-300">|  // Online Phase  |   |</p>

    <p class="text-gray-300">|  2 s ← Open([x] - [a])  |   |</p>

    <p class="text-gray-300">|  3 t ← Open([x] - [b])  |   |</p>

    <p class="text-gray-300">|  4 [xy] ← [ab] + [x] · t + [y] · s - s · t  |   |</p>

    <p class="text-gray-300">|  5 return [xy]  |   |</p>

    <p class="text-gray-300">|  Algorithm 2: Random square from Beaver triple.  |   |</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">---</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">---</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">|  Data: [a], [b], [ab]  |   |</p>

    <p class="text-gray-300">|  Result: [a], [a2]  |   |</p>

    <p class="text-gray-300">|  1 y ← Open([a] + [b])  |   |</p>

    <p class="text-gray-300">|  2 [a2] ← y · [a] - [ab]  |   |</p>

    <p class="text-gray-300">|  3 return [a], [a2]  |   |</p>

    <p class="text-gray-300">|  Algorithm 3: Random inverse from Beaver triple.  |   |</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">---</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">---</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">|  Data: [a], [b], [ab]  |   |</p>

    <p class="text-gray-300">|  Result: [a], [a-1]  |   |</p>

    <p class="text-gray-300">|  1 y ← Open([ab])  |   |</p>

    <p class="text-gray-300">|  2 if y = 0 then  |   |</p>

    <p class="text-gray-300">|  3 Abort.  |   |</p>

    <p class="text-gray-300">|  4 [a-1] ← [b] · y-1  |   |</p>

    <p class="text-gray-300">|  5 return [a], [a-1]  |   |</p>

    <p class="text-gray-300">|  Algorithm 4: Optimized [x]3 evaluation [12].  |   |</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">---</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">---</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">|  Data: [x]  |   |</p>

    <p class="text-gray-300">|  Result: [x3]  |   |</p>

    <p class="text-gray-300">|  // Offline Phase  |   |</p>

    <p class="text-gray-300">|  1 [a], [b], [ab] ← GenTriple()  |   |</p>

    <p class="text-gray-300">|  2 [r], [r2] ← GenSquare()  |   |</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">3 [r3] ← [r] · [r2]</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">// Using [a], [b], [ab]</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">|  // Online Phase  |   |</p>

    <p class="text-gray-300">|  4 y ← Open([x] - [r])  |   |</p>

    <p class="text-gray-300">|  5 [x3] = 3 · y · [r2] + 3 · y2 · [r] + y3 + [r3]  |   |</p>

    <p class="text-gray-300">|  6 return [xy]  |   |</p>

    <p class="text-gray-300">|  Algorithm 5: Forward method to calculate [x]d[1].  |   |</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">---</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">---</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">|  Data: [x]  |   |</p>

    <p class="text-gray-300">|  Result: [xd]  |   |</p>

    <p class="text-gray-300">|  // Offline Phase  |   |</p>

    <p class="text-gray-300">|  1 [a], [b], [ab] ← GenTriple()  |   |</p>

    <p class="text-gray-300">|  2 [r], [r-1] ← GenInv()  |   |</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">3 [r-d] ← Pow([r-1], d)</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">// Using multiple Beaver triples or squares</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">|  // Online Phase  |   |</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">4 y ← Open([x] · [r])</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">// Using [a], [b], [ab]</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">|  5 [xd] ← yd · [r-d]  |   |</p>

    <p class="text-gray-300">|  6 return [xd]  |   |</p>

    <p class="text-gray-300">|  Algorithm 6: Backwards method to calculate [x]d [1].  |   |</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">---</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">---</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">|  Data: [x]  |   |</p>

    <p class="text-gray-300">|  Result: [xd]  |   |</p>

    <p class="text-gray-300">|  // Offline Phase  |   |</p>

    <p class="text-gray-300">|  1 [a], [b], [ab] ← GenTriple()  |   |</p>

    <p class="text-gray-300">|  2 [r], [r-1] ← GenInv()  |   |</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">3 [r1/d] ← Pow([r], 1/d)</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">// Using multiple Beaver triples or squares</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">|  // Online Phase  |   |</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">4 y ← Open([x] · [r1/d])</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">// Using [a], [b], [ab]</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">|  5 [xd] ← yd · [r-1]  |   |</p>

    <p class="text-gray-300">|  6 return [xd]  |   |</p>

    <p class="text-gray-300">Pseudo Code. A pseudo code of HYDRA is proposed in Algorithm 7.</p>

    <p class="text-gray-300">Generation of Matrices and Constants. We pseudo-randomly generate all matrices and constants using Shake-128 [3] seeded with the string HYDRA and the used prime. Thereby, we use rejection sampling to sample field elements, and we reject and resample matrices and constants if they do not meet the requirements specified in this paper. We refer to our source code present in the supplementary material (Appendix A) for more details.</p>

    <p class="text-gray-300">Proof. As in a Lai-Massey construction, the invertibility follows from the fact that for  <span class="math">i \\in \\{0, 1, \\ldots, l - 1\\}</span></p>

    <div class="my-4 text-center"><span class="math-block">\\begin{array}{l} \\sum_ {h = 0} ^ {n - 1} \\lambda_ {h} ^ {(i)} \\cdot y _ {h} = \\sum_ {h = 0} ^ {n - 1} \\lambda_ {h} ^ {(i)} \\cdot \\left(x _ {h} + F \\left(\\sum_ {j = 0} ^ {n - 1} \\lambda_ {j} ^ {(1)} x _ {j}, \\sum_ {j = 0} ^ {n - 1} \\lambda_ {j} ^ {(2)} x _ {j}, \\dots , \\sum_ {j = 0} ^ {n - 1} \\lambda_ {j} ^ {(t)} x _ {j}\\right)\\right) \\\\ = \\sum_ {h = 0} ^ {n - 1} \\lambda_ {h} ^ {(i)} x _ {h} + \\underbrace {\\sum_ {h = 0} ^ {n - 1} \\lambda_ {h} ^ {(i)}} _ {= 0} \\cdot F \\left(\\sum_ {j = 0} ^ {n - 1} \\lambda_ {j} ^ {(1)} x _ {j}, \\sum_ {j = 0} ^ {n - 1} \\lambda_ {j} ^ {(2)} x _ {j}, \\ldots , \\sum_ {j = 0} ^ {n - 1} \\lambda_ {j} ^ {(t)} x _ {j}\\right) = \\sum_ {h = 0} ^ {n - 1} \\lambda_ {h} ^ {(i)} x _ {h}. \\\\ \\end{array}</span></div>

    <p class="text-gray-300">It follows that  <span class="math">x_{h} = y_{h} - F\\left(\\sum_{j=0}^{n-1} \\lambda_{j}^{(0)} \\cdot y_{j}, \\sum_{j=0}^{n-1} \\lambda_{j}^{(1)} \\cdot y_{j}, \\ldots, \\sum_{j=0}^{n-1} \\lambda_{j}^{(l-1)} \\cdot y_{j}\\right)</span>  for each  <span class="math">h \\in \\{0, 1, \\ldots, n-1\\}</span> .</p>

    <p class="text-gray-300">|  Algorithm 7: The HYDRA PRF.  |   |</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">---</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">---</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">|  Data: Prime integer p ≥ 263, 4 ≤ t ≤ 2n/2, N ∈ Fp, K ∈ Fp4.  |   |</p>

    <p class="text-gray-300">|  Result: h ∈ Fp4.  |   |</p>

    <p class="text-gray-300">|  1 Let t = 8 · t' + t'' for t', t'' ∈ N, where t'' = t mod 8.  |   |</p>

    <p class="text-gray-300">|  2 Let x, y, z ← 0 ∈ Fp4.  |   |</p>

    <p class="text-gray-300">|  // First step (computing B)  |   |</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">3 x ← Mε × (K + [N</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">IV]).</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">|  4 for i ← 0 to 1 do  |   |</p>

    <p class="text-gray-300">|  5 x ← εi(x).  |   |</p>

    <p class="text-gray-300">|  6 z ← z + x.  |   |</p>

    <p class="text-gray-300">|  7 for i ← 0 to Rτ - 1 do  |   |</p>

    <p class="text-gray-300">|  8 x ← Ii(x).  |   |</p>

    <p class="text-gray-300">|  9 z ← z + x.  |   |</p>

    <p class="text-gray-300">|  10 for i ← 2 to 5 do  |   |</p>

    <p class="text-gray-300">|  11 x ← εi(x).  |   |</p>

    <p class="text-gray-300">|  12 z ← z + x.  |   |</p>

    <p class="text-gray-300">|  13 y ← Ε7(x) + K.  |   |</p>

    <p class="text-gray-300">|  // Expansion step (using Hε)  |   |</p>

    <p class="text-gray-300">|  14 for i ← 0 to t' do  |   |</p>

    <p class="text-gray-300">|  15 hi ← Hε(Ri(y, z)).  |   |</p>

    <p class="text-gray-300">|  16 ht' ← T8,t''(ht').  |   |</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">17 return h := h0</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">h1</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">...</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">ht'-1</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">ht' ∈ Fp4.</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">Proof. We will show the invertibility of  <span class="math">\\mathcal{F}</span>  by constructing a pre-image for any given  <span class="math">(y_0, \\ldots, y_{n-1}) \\in \\mathbb{F}_q^n</span> . To this end, define</p>

    <div class="my-4 text-center"><span class="math-block">a = \\sum_ {i = 0} ^ {n ^ {\\prime} - 1} \\lambda_ {i} \\cdot y _ {i}, \\quad a ^ {\\prime} = G (a) \\qquad \\mathrm {a n d} \\qquad b = \\sum_ {i = n ^ {\\prime}} ^ {n - 1} \\lambda_ {i - n ^ {\\prime}} ^ {\\prime} \\cdot y _ {i}, \\quad b ^ {\\prime} = H (b),</span></div>

    <p class="text-gray-300">and consider the  <span class="math">n\\times n</span>  -matrix  <span class="math">M_{a,b} = \\left[ \\begin{array}{ll}I &amp;amp; A\\\\ B &amp;amp; I \\end{array} \\right]</span>  , where</p>

    <div class="my-4 text-center"><span class="math-block">A = a ^ {\\prime} \\cdot \\left[ \\begin{array}{c c c c} \\varphi_ {0} &amp;amp; \\varphi_ {1} &amp;amp; \\dots &amp;amp; \\varphi_ {n ^ {\\prime} - 1} \\\\ \\varphi_ {0} &amp;amp; \\varphi_ {1} &amp;amp; \\dots &amp;amp; \\varphi_ {n ^ {\\prime} - 1} \\\\ \\vdots &amp;amp; \\ddots &amp;amp; \\vdots \\\\ \\varphi_ {0} &amp;amp; \\varphi_ {1} &amp;amp; \\dots &amp;amp; \\varphi_ {n ^ {\\prime} - 1} \\end{array} \\right], \\qquad B = b ^ {\\prime} \\cdot \\left[ \\begin{array}{c c c c} \\varphi_ {0} ^ {\\prime} &amp;amp; \\varphi_ {1} ^ {\\prime} &amp;amp; \\dots &amp;amp; \\varphi_ {n ^ {\\prime} - 1} ^ {\\prime} \\\\ \\varphi_ {0} ^ {\\prime} &amp;amp; \\varphi_ {1} ^ {\\prime} &amp;amp; \\dots &amp;amp; \\varphi_ {n ^ {\\prime} - 1} ^ {\\prime} \\\\ \\vdots &amp;amp; \\ddots &amp;amp; \\vdots \\\\ \\varphi_ {0} ^ {\\prime} &amp;amp; \\varphi_ {1} ^ {\\prime} &amp;amp; \\dots &amp;amp; \\varphi_ {n ^ {\\prime} - 1} ^ {\\prime} \\end{array} \\right],</span></div>

    <p class="text-gray-300">and  <span class="math">I</span>  is the  <span class="math">n&#x27; \\times n&#x27;</span> -identity matrix. By Theorem 3 in [20], we have</p>

    <div class="my-4 text-center"><span class="math-block">\\det  (M _ {a, b}) = \\det  (I - B \\times A),</span></div>

    <p class="text-gray-300">and we can furthermore write</p>

    <div class="my-4 text-center"><span class="math-block">B \\times A = a ^ {\\prime} \\cdot b ^ {\\prime} \\cdot \\left(\\sum_ {j = 0} ^ {n ^ {\\prime} - 1} \\varphi_ {j} ^ {\\prime}\\right) \\cdot \\left[ \\begin{array}{c c c} \\varphi_ {0} \\varphi_ {1} \\dots \\varphi_ {n ^ {\\prime} - 1} \\\\ \\varphi_ {0} \\varphi_ {1} \\dots \\varphi_ {n ^ {\\prime} - 1} \\\\ \\vdots &amp;amp; \\ddots &amp;amp; \\vdots \\\\ \\varphi_ {0} \\varphi_ {1} \\dots \\varphi_ {n ^ {\\prime} - 1} \\end{array} \\right].</span></div>

    <p class="text-gray-300">The assumption  <span class="math">\\left(\\sum_{j=0}^{n&#x27; - 1} \\varphi_j&#x27;\\right) = 0</span>  ensures that  <span class="math">B \\times A</span>  is the zero matrix, and hence  <span class="math">\\operatorname{det}(M_{a,b}) = 1</span> . In particular,  <span class="math">M_{a,b}</span>  is invertible and there is a tuple  <span class="math">(x_0, \\ldots, x_{n-1}) \\in \\mathbb{F}_q^n</span>  satisfying</p>

    <div class="my-4 text-center"><span class="math-block">M _ {a, b} \\times (x _ {0}, \\dots , x _ {n - 1}) ^ {\\top} = (y _ {0}, \\dots , y _ {n - 1}) ^ {\\top}.</span></div>

    <p class="text-gray-300">In particular, we have that  <span class="math">(x_0,\\ldots ,x_{n - 1})</span>  is the pre-image of  <span class="math">(y_0,\\dots ,y_{n - 1})</span>  under  <span class="math">\\mathcal{F}</span> . Indeed, by construction of  <span class="math">M_{a,b}</span> , we only need to show that  <span class="math">a = \\sum_{i = 0}^{n^{\\prime} - 1}\\lambda_{i}\\cdot x_{i}</span>  and that  <span class="math">b = \\sum_{i = n^{\\prime}}^{n - 1}\\lambda_{i - n^{\\prime}}^{\\prime}\\cdot x_{i}</span> . In a manner similar to that of Appendix F.1, we get</p>

    <div class="my-4 text-center"><span class="math-block">a = \\sum_ {i = 0} ^ {n ^ {\\prime} - 1} \\lambda_ {i} \\cdot y _ {i} = \\sum_ {i = 0} ^ {n ^ {\\prime} - 1} \\lambda_ {i} \\cdot x _ {i} + a ^ {\\prime} \\cdot \\left(\\sum_ {j = n ^ {\\prime}} ^ {n - 1} \\varphi_ {j - n ^ {\\prime}} \\cdot x _ {j}\\right) \\underbrace {\\left(\\sum_ {k = 0} ^ {n ^ {\\prime} - 1} \\lambda_ {k}\\right)} _ {= 0} = \\sum_ {i = 0} ^ {n ^ {\\prime} - 1} \\lambda_ {i} \\cdot x _ {i}.</span></div>

    <p class="text-gray-300">The case of  <span class="math">b</span>  is identical, which completes the proof.</p>

    <h2 id="sec-59" class="text-2xl font-bold">G Details about the Security Analysis of  <span class="math">\\mathcal{B}</span></h2>

    <p class="text-gray-300">In this section, we assume the attacker knows both the inputs and outputs of  <span class="math">x \\mapsto \\mathbb{K} + \\mathcal{B}(x + \\mathbb{K})</span> . The aim is to determine a sufficient number of rounds to guarantee that  <span class="math">x \\mapsto \\mathbb{K} + \\mathcal{B}(x + \\mathbb{K})</span>  resembles a PRP against attacks with a computational complexity of at most  <span class="math">2^n</span> , and data complexity at most  <span class="math">2^{n/2}</span> .</p>

    <h2 id="sec-60" class="text-2xl font-bold">G.1 Statistical Attacks</h2>

    <p class="text-gray-300">The security of  <span class="math">\\mathcal{B}</span>  against statistical attacks as the differential one [5, 6], truncated differentials [16], and others, follows the security argument proposed for HADESMiMC and POSEIDON. Indeed, the external rounds of  <span class="math">\\mathcal{B}</span>  are the same as in HADESMiMC and POSEIDON, and the security argument of HADESMiMC and POSEIDON against statistical attacks depends on these external rounds only. In [10, Sect. 4 - 5], it is shown that the permutation</p>

    <div class="my-4 text-center"><span class="math-block">x \\mapsto \\underbrace {\\mathcal {E} _ {3} \\circ \\mathcal {E} _ {2}} _ {2 \\text {times}} \\circ \\mathcal {L} \\circ \\underbrace {\\mathcal {E} _ {1} \\circ \\mathcal {E} _ {0}} _ {2 \\text {times}} (\\cdot),</span></div>

    <p class="text-gray-300">where  <span class="math">\\mathcal{E}_i</span>  are the external rounds and  <span class="math">\\mathcal{L}:\\mathbb{F}_p^{4\\times 4}\\to \\mathbb{F}_p^4</span>  is an invertible linear layer that is secure against statistical attacks. Moreover, the security against statistical attacks does not decrease when replacing  <span class="math">\\mathcal{L}</span>  with an invertible nonlinear function (i.e., the internal rounds). Hence we refer to the analysis proposed in [10], from which we deduce that statistical attacks do not pose any threat to  <span class="math">\\mathcal{B}</span> .</p>

    <p class="text-gray-300">38</p>

    <p class="text-gray-300">G.2 Algebraic Attacks</p>

    <p class="text-gray-300">We mainly use the internal rounds of <span class="math">\\mathcal{B}</span> in order to gain security against algebraic attacks. First, we point out that no subspace trail <em>[18, 19, 11]</em> can cover an arbitrary number of rounds <span class="math">\\mathcal{I}</span>, due to the choice of the matrix <span class="math">M_{\\mathcal{I}}</span>, as explained in Appendix H. In there, we show how to adapt the analysis/tool proposed in <em>[13, 14]</em> for breaking arbitrarily long subspace trail for P-SPN schemes to the case of the generalized Lai–Massey constructions.</p>

    <h5 id="sec-61" class="text-base font-semibold mt-4">Density of the Algebraic Representation.</h5>

    <p class="text-gray-300">Algebraic attacks are especially efficient against schemes that have a simple algebraic structure in larger fields. It is well-known that many attacks, such as interpolation and Gröbner basis attacks, can exploit a sparse polynomial representation of the scheme. Consequently, it is important to study the density of these polynomials. We recall (see, e.g, Theorem 2.4 in <em>[8]</em>) that the number of possible monomials in a polynomial of degree <span class="math">D</span> in <span class="math">t</span> variables is</p>

    <p class="text-gray-300"><span class="math">N(d,t)\\coloneqq\\binom{t+D}{D}.</span> (13)</p>

    <p class="text-gray-300">The conditions (a) and (b) on <span class="math">M_{\\mathcal{I}}</span>, described in Section 5.2, are introduced to ensure that the density of the polynomials representing the scheme are close to this upper bound. We justify them in the following.</p>

    <h5 id="sec-62" class="text-base font-semibold mt-4">Conditions on the Linear Layer.</h5>

    <p class="text-gray-300">Let <span class="math">x\\in\\mathbb{F}_{p}^{t}</span> be the input of one round. By simple computation, the <span class="math">j</span>-th <span class="math">\\mathbb{F}_{p}</span>-output of the next round is</p>

    <p class="text-gray-300"><span class="math">y_{j}=\\sum_{l=0}^{t-1}M_{\\mathcal{I}}[j,l]\\cdot x_{l}+\\left(\\sum_{l=0}^{t-1}M_{\\mathcal{I}}[j,l]\\right)\\cdot G\\left(\\sum_{h=0}^{t-1}\\lambda_{h}\\cdot x_{h}\\right)</span></p>

    <p class="text-gray-300">for a certain (simplified) quadratic function <span class="math">G</span>, and where we omitted constant additions for simplicity. Let <span class="math">\\hat{y}=G\\left(\\sum_{h=0}^{t-1}\\lambda_{h}\\cdot x_{h}\\right)</span>. By applying the nonlinear <span class="math">S_{\\mathcal{I}}</span>, the <span class="math">i</span>-th <span class="math">\\mathbb{F}_{p}</span>-output is</p>

    <p class="text-gray-300"><span class="math">y_{i}+G\\left(\\sum_{h=0}^{t-1}\\lambda_{h}\\cdot\\left(\\sum_{l=0}^{t-1}M_{\\mathcal{I}}[h,l]\\cdot x_{l}+\\left(\\sum_{l=0}^{t-1}M_{\\mathcal{I}}[h,l]\\right)\\cdot\\hat{y}\\right)\\right)</span> <span class="math">=</span> <span class="math">y_{i}+G\\left(\\sum_{l=0}^{t-1}x_{l}\\cdot\\left(\\sum_{h=0}^{t-1}\\lambda_{h}\\cdot M_{\\mathcal{I}}[h,l]\\right)+\\hat{y}\\cdot\\sum_{h=0}^{t-1}\\lambda_{h}\\cdot\\left(\\sum_{l=0}^{t-1}M_{\\mathcal{I}}[h,l]\\right)\\right)\\,.</span></p>

    <p class="text-gray-300">Hence, the condition <span class="math">\\sum_{h=0}^{t-1}\\lambda_{h}\\cdot\\left(\\sum_{l=0}^{t-1}M_{\\mathcal{I}}[h,l]\\right)\\neq 0</span> is crucial in order to ensure the growth of the degree, while the conditions <span class="math">\\sum_{h=0}^{t-1}\\lambda_{h}\\cdot M_{\\mathcal{I}}[h,l]\\neq 0</span> for each <span class="math">l\\in\\{0,1,\\ldots,t-1\\}</span> ensure that the polynomial is not sparse.</p>

    <p class="text-gray-300">!<a href="img-4.jpeg">img-4.jpeg</a> Fig. 4: Comparison of the maximum number of monomials and the observed number of monomials in  <span class="math">\\mathcal{B}</span>  for the  <span class="math">\\mathcal{E}</span>  rounds.</p>

    <p class="text-gray-300">!<a href="img-5.jpeg">img-5.jpeg</a> Fig. 5: Comparison of the maximum number of monomials and the observed number of monomials in  <span class="math">\\mathcal{B}</span>  for the  <span class="math">\\mathcal{I}</span>  rounds.</p>

    <p class="text-gray-300">Forward Direction Density. For the external rounds  <span class="math">\\mathcal{E}</span> , our practical tests (Fig. 4) indicate that the maximum number of possible monomials is not reached at the  <span class="math">i</span> -th round. The growth in number of monomials is nevertheless strong, and the results seem to suggest that the discrepancy can be more than accounted for by including an additional round  <span class="math">\\mathcal{E}</span> . For the internal rounds  <span class="math">\\mathcal{I}</span> , the growth of the number of monomials is closer to the optimum, reaching its maximum in some of our tests (Fig. 5).</p>

    <p class="text-gray-300">Backward Direction Density. We note that the inverse of each  <span class="math">\\mathcal{E}</span>  round has a larger degree than the forward direction for small  <span class="math">d</span> , since  <span class="math">x \\mapsto x^{1/d}</span>  is used instead of  <span class="math">x \\mapsto x^d</span> . The polynomial is also more dense, and hence we conclude that an  <span class="math">\\mathcal{E}^{-1}</span>  round provides at least the degree and density of an  <span class="math">\\mathcal{E}</span>  round.</p>

    <p class="text-gray-300">Interpolation Attack. The goal of the interpolation attack [15] is to construct an interpolation polynomial that describes the function. The cost of setting up such an attack depends on the number of monomials in the interpolation polynomial, which can be estimated with the degree of the function. If the number of unknown monomials is sufficiently large, then it is not possible to construct the interpolation polynomial faster than using a brute-force attack. Roughly speaking, if the interpolation polynomial is dense and has a sufficiently high degree, this attack does not work.</p>

    <p class="text-gray-300">Let us consider a scenario in which only one input component is active and the others are fixed, that is, the polynomial depends only on a single variable. We make the following three conservative assumptions when estimating the degree growth for a MitM interpolation attack. Firstly, we only count one out of the two initial external rounds. This is to account for the fact that the external rounds do not produce dense polynomials of maximal degree, as observed in Fig. 4. Secondly, we arbitrarily discount 3 internal rounds in order to destroy possible relations existing between the coefficients of the monomials (due to the fact that the degree-4 function that defines the nonlinear layer is not generic, but has a particular structure). Thirdly, we expect that three external rounds are needed to prevent an attacker going in the backwards direction. Thus only one of the four final rounds will be counted toward our degree estimate. Since the data available for constructing the polynomial is restricted by <span class="math">2^{\\kappa/2}</span>, the number of internal rounds <span class="math">R_{\\mathcal{I}}</span> must satisfy</p>

    <p class="text-gray-300"><span class="math">4^{R_{\\mathcal{I}}-3}\\cdot d^{2}\\geq 2^{\\kappa/2}\\implies R_{\\mathcal{I}}\\geq\\frac{\\kappa}{4}-\\log_{2}(d)+3,</span></p>

    <p class="text-gray-300">where 4 and <span class="math">d\\geq 3</span> are the degrees of the internal and the external rounds respectively. Finally, we add an extra 3 rounds in order to destroy invariant subspaces of the Lai–Massey scheme, and hence estimate that</p>

    <p class="text-gray-300"><span class="math">R_{\\mathcal{I}}\\geq\\frac{\\kappa}{4}-\\log_{2}(d)+6</span> (14)</p>

    <p class="text-gray-300">rounds are necessary for preventing MitM interpolation attacks.</p>

    <h5 id="sec-63" class="text-base font-semibold mt-4">Higher-Order Differential Attack.</h5>

    <p class="text-gray-300">Given a vectorial Boolean function <span class="math">\\mathcal{F}</span> over <span class="math">\\mathbb{F}_{2}^{n}</span> of degree <span class="math">d</span>, the higher-order differential attack <em>[17, 16]</em> exploits that</p>

    <p class="text-gray-300"><span class="math">\\sum_{x\\in\\mathfrak{V}+v}x=\\sum_{x\\in\\mathfrak{V}+v}\\mathcal{F}(x)=0</span></p>

    <p class="text-gray-300">for each affine subspace <span class="math">\\mathfrak{V}+v\\subseteq\\mathbb{F}_{2}^{n}</span> of dimension strictly larger than <span class="math">d</span> (i.e., <span class="math">\\dim(\\mathfrak{V})\\geq d+1</span>). The corresponding attack in the case of a prime field <span class="math">\\mathbb{F}_{p}</span> has recently been proposed in <em>[4]</em>. Since this result is related to the degree of the polynomial that describes the permutation, we claim that the number of rounds necessary to guarantee security against the interpolation attack provides security against this attack as well.</p>

    <h5 id="sec-64" class="text-base font-semibold mt-4">Linearization Attack.</h5>

    <p class="text-gray-300">Many well-known techniques for solving multivariate polynomial systems of equations use linearization (see, e.g., <em>[7]</em>). Given a system of polynomial equations, the idea is to turn it into a system of linear equations by adding new variables that replace all the monomials in the system of degree larger than 1. The resulting linear system of equations can be solved using linear algebra if there are sufficiently many equations.</p>

    <p class="text-gray-300">Consider a system in <span class="math">t</span> unknowns of degree limited by <span class="math">D</span>, where the number of monomials, <span class="math">N(D,t)</span>, is given by Eq. (13). The attack has a computational cost</p>

    <p class="text-gray-300">of <span class="math">\\mathcal{O}(N(D,t)^{\\omega})</span> operations (for <span class="math">2&lt;\\omega\\leq 3</span>) and a memory cost of <span class="math">\\mathcal{O}(N(D,t)^{2})</span> to store the linear equations. Depending on parameter choices, the hybrid approach which combines exhaustive search with this approach may lead to a reduced cost. Guessing <span class="math">x&lt;t</span> variables leads to a complexity of</p>

    <p class="text-gray-300"><span class="math">\\mathcal{O}\\left(p^{x}\\cdot N(D,t-x)^{\\omega}\\right).</span></p>

    <p class="text-gray-300">For simplicity, we start by assuming that the attacker can collect enough (input, output) pairs to directly linearize a polynomial system representing <span class="math">\\mathcal{B}</span> with <span class="math">4</span> key variables. The degree <span class="math">D</span> is given by <span class="math">D=d^{2}\\cdot 4^{R_{\\mathcal{I}}-3}</span>, using the same assumptions as the analysis for the interpolation attack that yielded Eq. (14). Since <span class="math">2^{\\kappa}\\leq p^{2}</span>, it follows that the attack is not feasible if</p>

    <p class="text-gray-300">\\[ \\forall x\\in\\{0,1\\}:\\qquad p^{x}\\cdot\\left(\\begin{pmatrix}4-x+d^{2}\\cdot 4^{R_{\\mathcal{I}}-3}\\\\ 4-x\\end{pmatrix}\\right)^{2}\\geq 2^{\\kappa}\\,, \\]</p>

    <p class="text-gray-300">where we consider <span class="math">\\omega=2</span> and where we have <span class="math">4</span> variables (namely, the key). Let <span class="math">x^{\\prime}=4-x</span>. Note that</p>

    <p class="text-gray-300"><span class="math">p^{x}\\cdot\\left(\\begin{pmatrix}D+x^{\\prime}\\\\ x^{\\prime}\\end{pmatrix}\\right)^{2}\\geq p^{x}\\cdot\\left(\\frac{\\prod_{j=1}^{x^{\\prime}}(D+j)}{x^{\\prime}!}\\right)^{2}\\geq p^{x}\\cdot\\left(\\frac{(D+1)^{x^{\\prime}}}{{x^{\\prime}}^{x^{\\prime}}}\\right)^{2}\\geq p^{x}\\cdot\\left(\\frac{D}{x^{\\prime}}\\right)^{2\\cdot x^{\\prime}}</span></p>

    <p class="text-gray-300">where <span class="math">z^{z}\\geq z!</span> for each <span class="math">z\\geq 1</span>. Hence, this attack is prevented if</p>

    <p class="text-gray-300"><span class="math">R_{\\mathcal{I}}\\geq 4-\\log_{2}(d)+\\max_{x\\in\\{0,1\\}}\\frac{\\kappa-x\\cdot\\log_{2}(p)}{4\\cdot(4-x)}.</span> (15)</p>

    <p class="text-gray-300">Recalling the restriction <span class="math">4^{R_{\\mathcal{I}}-3}\\cdot d^{2}\\geq 2^{\\kappa/2}</span> discussed in the analysis for the interpolation attack, we note that it will, in practice, not be possible to linearize directly as assumed above. Rather, algorithms such as <em>[7]</em> must go to a higher degree, and linearize a larger system, making the lower bound in Eq. (15) extremely conservative for preventing attacks of this kind. Even when ignoring the issues of data complexity, we point out that the number of rounds necessary for preventing interpolation attacks are largely sufficient for preventing linearization strategies when <span class="math">\\kappa=\\log_{2}(p)</span>.</p>

    <h3 id="sec-65" class="text-xl font-semibold mt-8">G.3 Gröbner Basis Attack</h3>

    <p class="text-gray-300">Given a system of <span class="math">n_{e}</span> nonlinear equations in <span class="math">n_{v}</span> variables, a Gröbner basis allows to factorize this system of equations and find a solution (if it exists). We refer to Section 7.4 for more details. Here we limit ourselves to recall that the cost of this attack depends on the number of nonlinear equations, their degree, the number of variables, and on the particular representation of the studied system. Here we consider the two extreme cases: one in which the attacker only works with the input and the output of the permutation (i.e., no additional variables are introduced), and one in which the attacker introduces intermediate variables in every round.</p>

    <p class="text-gray-300">Inputs and Outputs.</p>

    <p class="text-gray-300">The polynomial system in this modeling is the same as described in Appendix G.2, i.e., 4 key variables with polynomials of degree <span class="math">d^{2}\\cdot 4^{R_{\\mathcal{I}}-3}</span>. The tools presented in Section 7.4 can be used for estimating how this attack performs depending on the number of equations the attacker has access to. Similar to what we described in Appendix G.2, this attack is optimized when it is possible to directly linearize the system, meaning that Eq. (15) provides a conservative lower bound on <span class="math">R_{\\mathcal{I}}</span> to prevent this strategy as well.</p>

    <h4 id="sec-66" class="text-lg font-semibold mt-6">Intermediate Variables.</h4>

    <p class="text-gray-300">For this strategy, we introduce additional variables in each round in order to reduce the overall degree growth. For simplicity we focus on a slightly modified permutation with only two external rounds: one at the beginning and one at the end. We emphasize that adding the remaining external rounds will not make the resulting equation system easier to solve.</p>

    <p class="text-gray-300">In our representation, we replace both sums in the Lai–Massey construction of each internal round by two new variables. More formally, let</p>

    <p class="text-gray-300"><span class="math">z_{i}^{(0)}=\\sum_{j=0}^{3}\\lambda_{j}^{(0)}\\cdot x_{j},\\quad z_{i}^{(1)}=\\sum_{j=0}^{3}\\lambda_{j}^{(1)}\\cdot x_{j},</span></p>

    <p class="text-gray-300">where <span class="math">z_{i}^{(0)},z_{i}^{(1)}</span> are two new variables introduced in the <span class="math">i</span>-th internal round. Using this approach, each internal round adds two degree-2 equations. Moreover, we use four variables for the key, and we introduce a layer of four new variables after the first external round (i.e., before starting with the internal rounds in our scenario) and after the last internal round (i.e., before the last external round in our scenario). Note that for the first internal round we can reuse the variables introduced after the first external round, and thus we do not need to add two new variables.</p>

    <p class="text-gray-300">In total, we have thus 4 variables for the key, <span class="math">2\\cdot 4=8</span> variables for the transitions between the external and internal rounds, and <span class="math">2(r-1)</span> variables for <span class="math">r</span> internal rounds. The number of equations is the same, and hence</p>

    <p class="text-gray-300"><span class="math">n_{e}=n_{v}=12+2(r-1).</span></p>

    <p class="text-gray-300">Of these equations, 8 are of degree <span class="math">d\\geq 3</span> and <span class="math">4+2(r-1)</span> are of degree 4.</p>

    <p class="text-gray-300">We implemented this modeling for an increasing number of <span class="math">r</span> intermediate rounds, and computed the associated grevlex Gröbner basis using the F_{4} algorithm on the same setup described in Appendix I.2. The results are presented in Table 3. Based on these results, we find it highly unlikely that the Gröbner basis approach will outperform the other methods we have investigated. For a rough comparison, consider the interpolation attack in Appendix G.2, which requires <span class="math">r\\gtrapprox\\kappa/4</span>. Thus, to outperform this attack, any algorithm with constant exponential growth will have to grow by at most a factor of 16 for any additional intermediate round. The growth we observe in our experiments seems to increase from this factor. Indeed, the running time when going from 1 to 2 internal rounds is increased by a factor of around 15.5, and the factor between</p>

    <p class="text-gray-300">Table 3: Running time (in seconds) for the  <span class="math">\\mathrm{F}_4</span>  algorithm on scaled down versions of  <span class="math">\\mathcal{B}</span>  over  <span class="math">\\mathbb{F}_{7741}</span> .  <span class="math">r</span>  denotes the number of internal rounds.</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">r</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">1</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">2</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">3</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">4</th>

          </tr>

        </thead>

        <tbody>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">Running Time (s)</td>

            <td class="px-3 py-2 border-b border-gray-700">28</td>

            <td class="px-3 py-2 border-b border-gray-700">433</td>

            <td class="px-3 py-2 border-b border-gray-700">18408</td>

            <td class="px-3 py-2 border-b border-gray-700">639614*</td>

          </tr>

        </tbody>

      </table>

    </div>

    <ul class="list-disc list-inside space-y-1 text-gray-300 my-2 ml-4">

      <li>The computation was not completed, but ran out of memory at the given time.</li>

    </ul>

    <p class="text-gray-300">2 and 3 rounds is 42.5. The factor between  <span class="math">r = 3</span> , and the data point where the computations for  <span class="math">r = 4</span>  ran out of memory is 34.7. This observation, along with the conservative choice of only including two external rounds in these tests, leads us to reasonably conjecture that the complexity of Gröbner basis attacks greatly exceeds the complexity of interpolation attacks.</p>

    <p class="text-gray-300">The conclusion does not change when the attacker covers 2 internal rounds for free by exploiting the invariant subspace of the Lai-Massey construction.</p>

    <p class="text-gray-300">As shown in [21], a weakness of the Lai-Massey construction is the possibility to choose a nonzero input difference such that the quadratic function in the  <span class="math">\\mathcal{I}</span>  rounds is not active. Here, we show how to choose the matrix  <span class="math">M_{\\mathcal{I}}</span>  in order to fix this problem.</p>

    <p class="text-gray-300">For reaching this goal, we follow the same strategy proposed for HADESMiMC in [13]. Instead of talking of differences, we deal with subspaces and we make use of the subspace trail notation introduced in [11].</p>

    <p class="text-gray-300">Definition 1 ((Invariant) Subspace Trail [18, 19, 11]). Let  <span class="math">\\mathcal{I}:\\mathbb{F}_p^t\\to \\mathbb{F}_p^t</span> . Let  <span class="math">(\\mathfrak{U}_0,\\ldots ,\\mathfrak{U}_r)</span>  denote a set of  <span class="math">r + 1</span>  subspaces with  <span class="math">\\dim (\\mathfrak{U}_i)\\leq \\dim (\\mathfrak{U}_{i + 1})</span> . If for each  <span class="math">i\\in \\{1,\\dots,r\\}</span>  and for each  <span class="math">a_{i}\\in \\mathbb{F}^{t}</span>  there exists  <span class="math">a_{i + 1}\\in \\mathbb{F}^t</span>  such that  <span class="math">\\mathcal{I}(\\mathfrak{U}_i + a_i)\\subseteq \\mathfrak{U}_{i + 1} + a_{i + 1}</span> , then  <span class="math">(\\mathfrak{U}_0,\\ldots ,\\mathfrak{U}_r)</span>  is a subspace trail of length  <span class="math">r</span> . If the subspace is invariant (that is,  <span class="math">\\mathfrak{U}_i = \\mathfrak{U}_j</span>  for each  <span class="math">i,j = 0,\\dots,r</span> ), the trail is called an invariant subspace trail.</p>

    <p class="text-gray-300">As in the case of HADESMiMC, the choice of the linear layer  <span class="math">M</span>  plays a crucial role for preventing subspace trails that can cover an arbitrary number of rounds. Here we focus on the general case where</p>

    <div class="my-4 text-center"><span class="math-block">y _ {i} = x _ {i} + F \\left(\\sum_ {j = 0} ^ {t - 1} \\lambda_ {j} ^ {(1)} \\cdot x _ {j}, \\sum_ {j = 0} ^ {t - 1} \\lambda_ {j} ^ {(2)} \\cdot x _ {j}, \\dots , \\sum_ {j = 0} ^ {t - 1} \\lambda_ {j} ^ {(s)} \\cdot x _ {j}\\right).</span></div>

    <p class="text-gray-300">We note that this includes both the nonlinear layer in  <span class="math">\\mathcal{I}</span>  of the  <span class="math">\\mathcal{B}</span>  permutation, defined over  <span class="math">\\mathbb{F}^4</span> , and the nonlinear layer in each of the rounds of the  <span class="math">\\mathcal{H}_{\\mathrm{g}}</span>  permutation, defined over  <span class="math">\\mathbb{F}^8</span> .</p>

    <p class="text-gray-300">For the follow-up, we recall the concept of infinitely long invariant/iterative subspace trails.</p>

    <p class="text-gray-300">|  Algorithm 8: Determining if a given matrix is potentially vulnerable to subspace trails in HYDRA.  |   |</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">---</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">---</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">|  Data: Matrix M ∈ Fp n×n, where n ∈ {4,8}.  |   |</p>

    <p class="text-gray-300">|  Result: False if there is a nonzero chance of vulnerability, True otherwise.  |   |</p>

    <p class="text-gray-300">|  1 l ← n.  |   |</p>

    <p class="text-gray-300">|  2 M' ← M.  |   |</p>

    <p class="text-gray-300">|  3 for i ← 0 to l do  |   |</p>

    <p class="text-gray-300">|  4 if deg(ΦM') < n or ΦM' is not irreducible then  |   |</p>

    <p class="text-gray-300">|  5 return False  |   |</p>

    <p class="text-gray-300">|  6 M' ← M × M'.  |   |</p>

    <p class="text-gray-300">|  7 return True  |   |</p>

    <p class="text-gray-300">Definition 2 (Infinitely Long Invariant/Iterative Subspace Trail [13]). Let  <span class="math">(\\mathfrak{V}_0, \\mathfrak{V}_1, \\ldots, \\mathfrak{V}_{l-1})</span>  be a constant-dimensional subspace trail for  <span class="math">l</span>  rounds. We call this subspace trail an infinitely long iterative subspace trail of period  <span class="math">l</span>  for the considered scheme if it repeats itself an arbitrary number of times, i.e., if</p>

    <div class="my-4 text-center"><span class="math-block">\\left(\\mathfrak {V} _ {0}, \\mathfrak {V} _ {1}, \\dots , \\mathfrak {V} _ {l - 1}, \\mathfrak {V} _ {0}, \\mathfrak {V} _ {1}, \\dots , \\mathfrak {V} _ {l - 1}, \\dots , \\mathfrak {V} _ {0}, \\mathfrak {V} _ {1}, \\dots , \\mathfrak {V} _ {l - 1}, \\dots\\right)</span></div>

    <p class="text-gray-300">is an infinitely long subspace trail.</p>

    <p class="text-gray-300">The existence of an infinitely long subspace trail relies on a matrix  <span class="math">M</span>  for which a nontrivial  <span class="math">M</span> -invariant subspace exists. Equivalently, a matrix  <span class="math">M</span>  for which no  <span class="math">M</span> -invariant subspace exists is considered secure. Therefore, we can reuse [13, Proposition 13], i.e., we determine if the minimal polynomial of a given  <span class="math">t \\times t</span>  matrix has maximum degree  <span class="math">t</span>  and is irreducible. If this is the case, no infinitely long subspace trails with inactive or active  <span class="math">F</span>  functions exist, and the same result can also be applied to  <span class="math">M_{\\mathcal{E}}</span>  in  <span class="math">\\mathcal{B}</span> . We refer to Algorithm 8 for the detailed approach. We limit ourselves to recall the definition of minimal polynomial.</p>

    <p class="text-gray-300">Definition 3. Let  <span class="math">M \\in \\mathbb{F}_p^{t \\times t}</span>  be an invertible matrix. The characteristic polynomial  <span class="math">\\varPsi \\in \\mathbb{F}_p[x]</span>  is defined as  <span class="math">\\varPsi(x) = \\operatorname*{det}(x \\cdot I - M)</span> . The minimal polynomial  <span class="math">\\varPhi \\in \\mathbb{F}_p[x]</span>  is the monic polynomial of minimal degree such that</p>

    <ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">

      <li><span class="math">\\varPhi(M)\\times v=0^{t}=(0,0,\\ldots,0)^{T}\\in\\mathbb{F}_{p}^{t}</span>  for each  <span class="math">v\\in \\mathbb{F}_p^t</span></li>

      <li>for each polynomial  <span class="math">P \\in \\mathbb{F}_p[x]</span>  that is annihilating (in the sense that  <span class="math">P(M) \\times v = 0^t</span>  as before for each  <span class="math">v \\in \\mathbb{F}_p^t</span> ),  <span class="math">\\varPhi</span>  divides  <span class="math">P</span> .</li>

    </ol>

    <p class="text-gray-300">This approach only provides a sufficient condition for ensuring that no invariant subspace exists. However, there may be matrices that do not satisfy it, but still provide security. We study this case in the following.</p>

    <p class="text-gray-300">H.2 Preventing Infinitely Long Subspace Trails</p>

    <p class="text-gray-300">As a starting point for our analysis, we first define the subspaces <span class="math">\\mathfrak{X}^{(i)}</span>.</p>

    <h6 id="sec-69" class="text-base font-medium mt-4">Definition 4.</h6>

    <p class="text-gray-300">For <span class="math">i\\geq 0</span> and <span class="math">t\\geq 2</span>, let <span class="math">\\mathfrak{X}^{(i)}\\subseteq\\mathbb{F}_{p}^{t}</span> be the subspace defined as</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"><span class="math">\\mathfrak{X}^{(i)}</span> $=\\left\\{x\\in\\mathbb{F}_{p}^{t}\\left</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\sum_{l=0}^{t-1}\\left(\\lambda_{l}^{(h)}\\cdot\\left(M^{j}\\times x\\right)_{l}\\right)=0\\in\\mathbb{F}^{t}\\text{ for each }j\\leq i,0\\leq h\\leq s\\right.\\right\\}$</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">Moreover, let <span class="math">I</span> be the largest <span class="math">i\\geq t-1</span> such that <span class="math">1\\leq\\dim(\\mathfrak{X}^{(i)})\\leq t-1</span> (that is, <span class="math">\\dim(\\mathfrak{X}^{(I)})\\geq 1</span> and <span class="math">\\dim(\\mathfrak{X}^{(I+1)})=0</span>).</p>

    <p class="text-gray-300">By taking a pair of texts in the same coset of <span class="math">\\mathfrak{X}^{(i)}</span>, the first <span class="math">i</span> rounds are essentially linear, since the input difference of <span class="math">F</span> is always zero. Depending on <span class="math">M</span>, this behavior may repeat for an arbitrary number of rounds, and our goal is to avoid this by choosing <span class="math">M</span> properly.</p>

    <h4 id="sec-70" class="text-lg font-semibold mt-6">Inactive <span class="math">F</span> Function.</h4>

    <p class="text-gray-300">We will first focus on the case where <span class="math">F</span> is not active (i.e., the input differences are always zero). This corresponds to the case in which the inputs of <span class="math">F</span> are elements of <span class="math">\\mathfrak{X}^{(i)}</span> for a certain <span class="math">i</span>. Working as in <em>[13]</em>, we derive the following result.</p>

    <h6 id="sec-71" class="text-base font-medium mt-4">Proposition 3.</h6>

    <p class="text-gray-300">A subspace <span class="math">\\mathfrak{I}\\subset\\mathbb{F}_{p}^{t}</span> defines an infinitely long subspace trail with inactive <span class="math">F</span> if and only if <span class="math">\\mathfrak{I}\\subseteq\\mathfrak{X}^{(0)}</span> and <span class="math">M\\times\\mathfrak{I}=\\mathfrak{I}</span>.</p>

    <h6 id="sec-72" class="text-base font-medium mt-4">Proof.</h6>

    <p class="text-gray-300">Clearly, a subspace <span class="math">\\mathfrak{I}\\subseteq\\mathfrak{X}^{(0)}</span> fulfilling <span class="math">M\\times\\mathfrak{I}=\\mathfrak{I}</span> generates an infinitely long invariant subspace trail with inactive <span class="math">F</span> functions, since this function is inactive in the first round and then <span class="math">\\mathfrak{I}</span> is repeated infinitely.</p>

    <p class="text-gray-300">Next, we show that, given an infinitely long invariant subspace trail <span class="math">\\mathfrak{I}</span> with inactive <span class="math">F</span> functions, it must satisfy <span class="math">\\mathfrak{I}\\subseteq\\mathfrak{X}^{(0)}</span> and <span class="math">M\\times\\mathfrak{I}=\\mathfrak{I}</span>. Indeed, <span class="math">\\mathfrak{I}\\subseteq\\mathfrak{X}^{(0)}</span>, otherwise <span class="math">F</span> would be active in the first round. Moreover, <span class="math">\\mathfrak{I}</span> is invariant if and only if <span class="math">M\\times\\mathfrak{I}=\\mathfrak{I}</span>. The result follows immediately.</p>

    <p class="text-gray-300">It remains to show that the nonexistence of infinitely long invariant subspace trails implies the nonexistence of infinitely long iterative subspace trails. For this purpose, we prove that if an infinitely long iterative subspace trail with inactive <span class="math">F</span> functions exists, then an invariant one exists as well. Let <span class="math">\\{\\mathfrak{I},M\\cdot\\mathfrak{I},M^{2}\\cdot\\mathfrak{I},\\ldots,M^{l-1}\\cdot\\mathfrak{I}\\}</span> be an <span class="math">l</span>-round iterative subspace trail. Let <span class="math">\\mathfrak{I}^{\\prime}:=\\langle\\mathfrak{I},M\\cdot\\mathfrak{I},M^{2}\\cdot\\mathfrak{I},\\ldots,M^{l-1}\\cdot\\mathfrak{I}\\rangle</span>. By definition, <span class="math">\\mathfrak{I}^{\\prime}</span> generates an invariant subspace. Moreover, it is a non-trivial subspace of <span class="math">\\mathbb{F}_{p}^{t}</span> (that is, <span class="math">\\mathfrak{I}^{\\prime}\\subset\\mathbb{F}_{p}^{t}</span>) since on such a subspace <span class="math">F</span> is never active by assumption. ∎</p>

    <p class="text-gray-300">Finding a Subspace Trail. In order to prevent all invariant subspace trails with inactive <span class="math">F</span> functions, it is thus sufficient to determine that the condition <span class="math">\\mathfrak{I} = M \\times \\mathfrak{I}</span> is never reached for a proper subspace <span class="math">\\mathfrak{I} \\subseteq \\mathfrak{X}^{(0)}</span>. This is the case if <span class="math">\\dim (\\mathfrak{I} \\cap (M \\times \\mathfrak{I})) \\leq \\dim (\\mathfrak{I}) - 1</span>, which means that the dimension of <span class="math">\\mathfrak{I}</span> exceeds the dimension of <span class="math">\\mathfrak{I} \\cap (M \\times \\mathfrak{I})</span>. Further, note that an iterative subspace trail of the form <span class="math">\\{\\mathfrak{I}, M \\cdot \\mathfrak{I}, M^2 \\cdot \\mathfrak{I}, \\ldots, M^{l-1} \\cdot \\mathfrak{I}\\}</span> does not exist either in this case, since otherwise <span class="math">\\mathfrak{U} = M \\times \\mathfrak{U}</span> for <span class="math">\\mathfrak{U} = \\langle \\mathfrak{I}, M \\cdot \\mathfrak{I}, M^2 \\cdot \\mathfrak{I}, \\ldots, M^{l-1} \\cdot \\mathfrak{I} \\rangle \\subseteq \\mathfrak{X}^{(0)} \\Rightarrow \\dim (\\mathfrak{U}) &amp;lt; t</span>, where <span class="math">l \\in \\mathbb{N}</span> denotes the period of the iterative subspace trail.</p>

    <p class="text-gray-300">Active <span class="math">F</span> Function. In order to provide security, we must also consider infinitely long subspace trails in which the input difference of the <span class="math">F</span> function is nonzero. If such a subspace exists, it would be possible to skip the middle rounds without increasing the degree, which reduces the resistance against algebraic attacks.</p>

    <p class="text-gray-300">To give a concrete example, consider again the case <span class="math">t = 4</span>, where <span class="math">\\lambda_0 = \\lambda_2 = 1</span> and <span class="math">\\lambda_1 = \\lambda_3 = -1</span>. Moreover, let</p>

    <div class="my-4 text-center"><span class="math-block">M_{\\mathcal{I}} = \\begin{pmatrix} \\mu_0 &amp;amp; 1 &amp;amp; 1 &amp;amp; 1 \\\\ 1 &amp;amp; \\mu_1 &amp;amp; 1 &amp;amp; 1 \\\\ 1 &amp;amp; 1 &amp;amp; \\mu_1 &amp;amp; 1 \\\\ 1 &amp;amp; 1 &amp;amp; 1 &amp;amp; \\mu_1 \\end{pmatrix}</span></div>

    <p class="text-gray-300">for <span class="math">\\mu_0, \\mu_1 \\in \\mathbb{F}_p</span>. The two-dimensional subspace <span class="math">\\mathfrak{I} = \\langle (1,0,0,0), (0,1,1,1) \\rangle \\subseteq \\mathbb{F}_p^4</span> generates an infinitely long invariant subspace trail in which <span class="math">F</span> is active. Indeed, given <span class="math">(x,y,y,y) \\in \\mathfrak{I}</span>, note that the input of <span class="math">F</span> is <span class="math">(x - y, x - y, x - y, x - y)</span>, which is in general not equal to zero.</p>

    <p class="text-gray-300">In the following, we give a necessary condition that, if satisfied, guarantees that no infinitely long invariant subspace trail with active <span class="math">F</span> functions exists.</p>

    <p class="text-gray-300">Proposition 4. If a subspace <span class="math">\\mathfrak{I} \\subset \\mathbb{F}_p^t</span> defines an infinitely long invariant subspace trail with active <span class="math">F</span> functions, then</p>

    <div class="my-4 text-center"><span class="math-block">\\langle (1, 1, \\dots, 1) \\rangle \\subseteq \\mathfrak{I}.</span></div>

    <p class="text-gray-300">Proof. Let <span class="math">\\mathfrak{I}</span> be an invariant subspace trail. For each <span class="math">x \\in \\mathfrak{I}</span>,</p>

    <div class="my-4 text-center"><span class="math-block">M \\times (x_0 + F(x_0, \\dots, x_{t-1}), x_1 + F(x_0, \\dots, x_{t-1}), \\dots, x_{t-1} + F(x_0, \\dots, x_{t-1}))^T \\in \\mathfrak{I},</span></div>

    <p class="text-gray-300">or equivalently <span class="math">M \\times x + F(x_0, \\ldots, x_{t-1}) \\cdot M \\times (1, 1, \\ldots, 1)^T \\in \\mathfrak{I}</span>, i.e.,</p>

    <div class="my-4 text-center"><span class="math-block">M \\times \\mathfrak{I} + \\langle M \\times (1, 1, \\dots, 1)^T \\rangle = \\mathfrak{I} \\quad \\Longrightarrow \\quad M \\times (\\mathfrak{I} + \\langle (1, 1, \\dots, 1)^T \\rangle) = \\mathfrak{I}</span></div>

    <p class="text-gray-300">where <span class="math">M</span> is invertible. Since <span class="math">\\mathfrak{I}</span> is an invariant subspace, we have that</p>

    <div class="my-4 text-center"><span class="math-block">\\dim \\left(M \\times (\\mathfrak{I} + \\langle (1, 1, \\dots, 1)^T \\rangle)\\right) = \\dim \\left(\\mathfrak{I} + \\langle (1, 1, \\dots, 1)^T \\rangle\\right) = \\dim (\\mathfrak{I}),</span></div>

    <p class="text-gray-300">and hence <span class="math">\\langle (1,1,\\ldots,1)^T \\rangle \\subseteq \\mathfrak{I}</span>.</p>

    <p class="text-gray-300">Finding a Subspace Trail. We can determine the existence of infinitely long subspace trails in the case of active <span class="math">F</span> functions with a simple method. First, we start with the subspace <span class="math">\\mathfrak{I}_0 = \\langle (1,\\ldots ,1)\\rangle</span>. If <span class="math">\\mathfrak{I}_0 = M\\times \\mathfrak{I}_0</span>, <span class="math">\\mathfrak{I}_0</span> generates such a subspace trail and <span class="math">M</span> is vulnerable. If <span class="math">\\mathfrak{I}_0\\neq M\\times \\mathfrak{I}_0</span>, we define <span class="math">\\mathfrak{I}_1 = \\langle \\mathfrak{I}_0,M\\times \\mathfrak{I}_0\\rangle</span> and again determine if <span class="math">\\mathfrak{I}_1 = M\\times \\mathfrak{I}_1</span>. Note that, since <span class="math">\\mathfrak{I}_0\\neq M\\times \\mathfrak{I}_0</span> and <span class="math">M</span> is nonzero, <span class="math">\\dim (\\mathfrak{I}_1) &amp;gt; \\dim (\\mathfrak{I}_0)</span>. Eventually, we will either reach full dimension or an invariant subspace. If the largest possible dimension <span class="math">t</span> is reached, no infinitely long invariant subspace trail for active <span class="math">F</span> functions exists.</p>

    <h2 id="sec-73" class="text-2xl font-bold">I Details about the Security Analysis of <span class="math">\\mathcal{H}_{\\mathbb{K}}</span></h2>

    <h3 id="sec-74" class="text-xl font-semibold mt-8">I.1 Maximum Differential Probability of a Generalized Lai-Massey Construction</h3>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"><strong>Lemma 1.</strong> Let <span class="math">t \\geq 2</span>. Let <span class="math">\\omega_0, \\omega_1, \\omega_2, \\ldots, \\omega_{t-1} \\in \\mathbb{F}_p \\setminus \\{0\\}</span> where <span class="math">\\sum_{h=0}^{t-1} \\omega_h = 0</span>. Let <span class="math">S&#x27;&#x27;: \\mathbb{F}_p^t \\to \\mathbb{F}_p^t</span> be defined as $S''(x_0, x_1, \\ldots, x_{t-1}) = y_0 \\</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">y_1\\</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\ldots \\</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">y_{t-1}$ where</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <div class="my-4 text-center"><span class="math-block">\\forall l \\in \\{0, 1, \\dots , t - 1 \\}: \\quad y _ {l} = x _ {l} + \\left(\\sum_ {h = 0} ^ {t - 1} \\omega_ {h} \\cdot x _ {h}\\right) ^ {2}.</span></div>

    <p class="text-gray-300">Then, for each <span class="math">\\Delta_I,\\Delta_O\\in \\mathbb{F}_p^t</span></p>

    <div class="my-4 text-center"><span class="math-block">\\operatorname {Prob}(\\Delta_{I}\\to \\Delta_{O}) = \\left\\{ \\begin{array}{ll}p^{-1} &amp;amp; \\text{if}\\quad \\Delta_{O}[0] = \\Delta_{O}[1] = \\dots = \\Delta_{O}[t - 1](\\neq 0)\\\\ 0 &amp;amp; \\text{otherwise} \\end{array} \\right..</span></div>

    <p class="text-gray-300"><strong>Proof.</strong> We count the number of solutions <span class="math">x \\in \\mathbb{F}_p^t</span> of <span class="math">S&#x27;&#x27;(x + \\Delta_I) - S&#x27;&#x27;(x) = \\Delta_O</span>, that is, of</p>

    <div class="my-4 text-center"><span class="math-block">\\left(\\sum_ {h = 0} ^ {t - 1} \\omega_ {h} \\cdot \\left(x _ {h} + \\Delta_ {I} [ l ]\\right)\\right) ^ {2} - \\left(\\sum_ {h = 0} ^ {t - 1} \\omega_ {h} \\cdot x _ {h}\\right) ^ {2} = \\Delta_ {O} [ l ]</span></div>

    <p class="text-gray-300">for each <span class="math">l \\in \\{0,1,\\ldots ,t - 1\\}</span>. First of all, such system of equations admits solution(s) only if <span class="math">\\Delta_O[l] = \\Delta_O[j]</span> for each <span class="math">l,j \\in \\{0,1,\\dots ,t - 1\\}</span>. Secondly, it is not hard to check that each one of the equations in the system is linear in <span class="math">x_0,x_1,\\ldots ,x_{t - 1}</span>. Hence, the number of solutions is at most <span class="math">p^{t - 1}</span> (<span class="math">t - 1</span> variables are free to take any possible value, while the remaining one is fixed), which implies that <span class="math">\\operatorname{Prob}(\\Delta_I \\to \\Delta_O) \\leq \\frac{p^{t - 1}}{p^t} = p^{-1}</span>.</p>

    <p class="text-gray-300">□</p>

    <p class="text-gray-300">We emphasize that the previous result can be easily generalized to the case in which the quadratic function is replaced by a generic degree-<span class="math">d</span> function. In such a case, its maximum differential probability is <span class="math">(d - 1) / p</span>.</p>

    <p class="text-gray-300">48</p>

    <h3 id="sec-75" class="text-xl font-semibold mt-8">I.2 Details About Gröbner Basis Attacks Against <span class="math">\\mathcal{H}_{\\mathtt{R}}</span></h3>

    <p class="text-gray-300">This appendix focuses on Gröbner basis attacks against <span class="math">\\mathcal{H}_{\\mathtt{R}}</span>. We start by briefly discussing the case where we only keep the 12 initial variables <span class="math">y,z</span> and <span class="math">K</span>, before we consider in greater detail the case where the intermediate rounds of <span class="math">\\mathcal{H}_{\\mathtt{R}}</span> are modeled with extra variables and equations. The final output of Hydra is assumed to be known in all scenarios.</p>

    <h4 id="sec-76" class="text-lg font-semibold mt-6">Polynomial System with Initial Variables</h4>

    <p class="text-gray-300">We make two observations on <span class="math">\\mathcal{H}_{\\mathtt{R}}(y,z)</span>, as described in Section 5.4. Firstly, the initial round <span class="math">\\mathcal{J}_{0}</span> only affects <span class="math">y</span> and <span class="math">z</span>. Secondly, <span class="math">\\mathcal{J}_{i}</span> includes only a single multiplication. Thus we can, after taking suitable linear combinations, write the output of <span class="math">\\mathcal{H}_{\\mathtt{R}}(y,z)</span> as one polynomial in degree <span class="math">2^{R_{\\mathcal{H}}}</span>, and seven polynomials of degree <span class="math">2^{R_{\\mathcal{H}}-1}</span>. Upon generalizing this second point, we find that we can further write <span class="math">\\mathcal{H}_{\\mathtt{R}}(y,z)</span> out as eight polynomials; one in degree <span class="math">2^{R_{\\mathcal{H}}}</span>, one in degree <span class="math">2^{R_{\\mathcal{H}}-1}</span>, and so on, all the way down to degree <span class="math">2^{R_{\\mathcal{H}}-7}</span>. Moreover, this maximal degree will only be in the eight variables from <span class="math">y</span> and <span class="math">z</span> (the <span class="math">K</span>-variables will only appear in monomials of smaller degree, due to the first observation). A similar statement holds for successive heads, <span class="math">\\mathcal{H}_{\\mathtt{R}}\\left(\\mathcal{R}_{i}(y,z)\\right)</span>, with each degree multiplied by a factor <span class="math">2^{i}</span>. Hence, while an attacker can use more output to sample more polynomials, the degree of these polynomials increases exponentially, thus limiting their use in the polynomial solving process. As noted in Section 7.3, we already require <span class="math">R_{\\mathcal{H}}\\geq 24</span> (and we typically require an even greater number due to Eq. (12)). At these magnitudes, we find that modeling with only the initial variables will simply not be competitive when compared to other attack approaches.</p>

    <h4 id="sec-77" class="text-lg font-semibold mt-6">Setup and Reduction of the Intermediate Variable Polynomial System</h4>

    <p class="text-gray-300">Each head <span class="math">\\mathcal{H}_{\\mathtt{R}}</span> included in this modeling now increases the number of variables, so the attacker wants to include as few of them as possible. On the other hand, as <span class="math">\\mathcal{H}_{\\mathtt{R}}</span> depends on the 12 unknown field elements comprising <span class="math">y,z</span> and <span class="math">K</span>, at least two heads are needed to construct an (over-)determined polynomial system. Thus, we choose to set up the system of equations using <span class="math">\\mathcal{H}_{\\mathtt{R}}(y,z)</span> and <span class="math">\\mathcal{H}_{\\mathtt{R}}\\left(\\mathcal{R}_{1}(y,z)\\right)</span>.</p>

    <p class="text-gray-300">Since there is only a single squaring repeated in <span class="math">S_{\\mathcal{J}}</span>, we can, after taking suitable linear combinations, model each intermediate round <span class="math">\\mathcal{J}_{j}</span> with one quadratic equation and seven linear equations, in eight new variables. Similarly, the rolling function <span class="math">\\mathcal{R}_{1}</span> can be modeled using two quadratic equations and six linear equations in eight new variables. The 16 output elements of <span class="math">\\mathcal{H}_{\\mathtt{R}}(y,z)</span> and <span class="math">\\mathcal{H}_{\\mathtt{R}}\\left(\\mathcal{R}_{1}(y,z)\\right)</span> are assumed known, and twelve variables are used for the input <span class="math">y,z</span> and <span class="math">K</span>. We use the linear equations in the system to eliminate variables. Further 16 variables can be eliminated using the known output. Assuming these relations are linear independent, we can reduce to a smaller system of <span class="math">2r+2</span> quadratic equations in <span class="math">2r-2</span> variables, where <span class="math">r</span> is the number of rounds. This is indeed the case we have observed in all our experiments.</p>

    <h4 id="sec-78" class="text-lg font-semibold mt-6">Practical Tests</h4>

    <p class="text-gray-300">We have tested the difficulty of computing a grevlex Gröbner basis for the reduced systems described above, with a varying number of rounds</p>

    <p class="text-gray-300">Table 4: Running time (in seconds) and step degrees in the  <span class="math">\\mathrm{F}_4</span>  algorithm when solving polynomial systems from HYDRA over  <span class="math">\\mathbb{F}_{7741}</span> .</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">r</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Step Degrees</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Total Time</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Time Max Step</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Time Random</th>

          </tr>

        </thead>

        <tbody>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">6</td>

            <td class="px-3 py-2 border-b border-gray-700">2345</td>

            <td class="px-3 py-2 border-b border-gray-700">0.1</td>

            <td class="px-3 py-2 border-b border-gray-700">0.1</td>

            <td class="px-3 py-2 border-b border-gray-700">0.1</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">7</td>

            <td class="px-3 py-2 border-b border-gray-700">234555</td>

            <td class="px-3 py-2 border-b border-gray-700">0.9</td>

            <td class="px-3 py-2 border-b border-gray-700">0.4</td>

            <td class="px-3 py-2 border-b border-gray-700">0.5</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">8</td>

            <td class="px-3 py-2 border-b border-gray-700">234566</td>

            <td class="px-3 py-2 border-b border-gray-700">13.4</td>

            <td class="px-3 py-2 border-b border-gray-700">7.3</td>

            <td class="px-3 py-2 border-b border-gray-700">8.8</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">9</td>

            <td class="px-3 py-2 border-b border-gray-700">2345676</td>

            <td class="px-3 py-2 border-b border-gray-700">293.8</td>

            <td class="px-3 py-2 border-b border-gray-700">198.4</td>

            <td class="px-3 py-2 border-b border-gray-700">229.2</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">10</td>

            <td class="px-3 py-2 border-b border-gray-700">23456786</td>

            <td class="px-3 py-2 border-b border-gray-700">8799.5</td>

            <td class="px-3 py-2 border-b border-gray-700">6250.7</td>

            <td class="px-3 py-2 border-b border-gray-700">7740.8</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">11</td>

            <td class="px-3 py-2 border-b border-gray-700">234567888</td>

            <td class="px-3 py-2 border-b border-gray-700">229606.8</td>

            <td class="px-3 py-2 border-b border-gray-700">89768.6</td>

            <td class="px-3 py-2 border-b border-gray-700">209272.9</td>

          </tr>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300"><span class="math">r</span> , over  <span class="math">\\mathbb{F}_{7741}</span> . The tests have been performed running the  <span class="math">\\mathrm{F}_4</span>  algorithm implemented in the computer algebra system MAGMA V2.22-6, on  <span class="math">72 \\times \\operatorname{Intel}(\\mathbb{R})</span>  Xeon(R) CPU E5-2699 v3 @ 2.30GHz, with 252 GiB RAM.</p>

    <p class="text-gray-300">The results are presented in Table 4. 'Step Degrees' lists the degree of the polynomials associated with each step. The maximal step, i.e., the most costly step in terms of running time, is underlined. We find that all tested cases behave like quadratic semi-regular systems of  <span class="math">2r + 2</span>  polynomials in  <span class="math">2r - 2</span>  variables. In particular, the degree of the maximal step coincides with the degree of regularity (as described in Section 7.4) for such systems. We present the total running time of  <span class="math">\\mathrm{F}_4</span> , as well as the time spent at the maximal step, to give an impression of how the problem scales as  <span class="math">r</span>  increases. For comparison, we also include the running time for random quadratic systems of  <span class="math">2r + 2</span>  polynomials in  <span class="math">2r - 2</span>  variables (i.e., the coefficients of all possible monomials up to degree two is a random element of  <span class="math">\\mathbb{F}_p</span> ), with a unique solution. Random systems are believed to be semi-regular with high probability (and they indeed turned out to be so in our tests), and the practical hardness of solving them has been studied in cryptographic solving challenges[14] [22]. In our tests, the step degrees for the random systems coincide with the associated systems from HYDRA, yet the time for solving the former systems are consistently smaller.</p>

    <p class="text-gray-300">Finally, we point out that the unique solution can be directly read from the grevlex Gröbner basis in all our experiments. Hence, there is no need for any further steps in the solving process.</p>

    <p class="text-gray-300">Adding 2 Extra Rounds Due to the above results, we conclude that the Gröbner basis attack against  <span class="math">\\mathcal{H}_{\\mathbb{K}}</span>  is comparable to that of solving a semi-regular system with  <span class="math">2r + 2</span>  quadratic polynomials in  <span class="math">2r - 2</span>  variables. However, we note that not all polynomials in our modeling will contain every variable, which adds a certain structure that an attacker might be able to use when reducing the matrices encountered in  <span class="math">\\mathrm{F}_4</span> . To account for this property, we add two extra rounds on top of this baseline (in addition to the conservative choice of using  <span class="math">\\omega = 2</span>  for the linear algebra constant).</p>

    <p class="text-gray-300">J Full MPC Benchmarks</p>

    <p class="text-gray-300">In Table 5 and Table 6, we give the full MPC benchmarks. Compared to Table 1, we additionally compare Hydra to GMiMC_{erf} and MiMC-CTR and give benchmarks for more state sizes <span class="math">t</span>. Looking at MiMC, one can observe, that it has a fast online phase performance, but it requires significantly more data transmission between the parties. Furthermore, its large number of multiplications also leads to an expensive offline phase. GMiMC, on the other hand, has a decent performance for very small <span class="math">t</span>, but its number of rounds does not scale well with larger state sizes. Consequently, our benchmark show that it is somewhat competitive for <span class="math">t=8</span>, but its runtime and data transmission explodes with larger <span class="math">t</span>. In any case, Hydra has the faster offline phase performance and also a comparable online phase performance with less data communication compared to MiMC and GMiMC, with the advantage of Hydra growing with the state size <span class="math">t</span>.</p>

    <h2 id="sec-79" class="text-2xl font-bold">Appendix K Effect of the linear layer</h2>

    <p class="text-gray-300">In Section 8, we noted that HadesMiMC has a slow online phase performance when evaluated in a LAN setting due to having many MDS matrix multiplications with bad plain performance. To highlight this effect, we compare Hydra and HadesMiMC (with and without its linear key schedule) to a (insecure) version of HadesMiMC (dubbed HadesMiMC-circ) for which we replaced the random MDS matrices with the matrix <span class="math">M=\\text{circ}(2,1,1,\\ldots,1)</span>. The corresponding matrix-vector multiplications can purely be implemented using additions. In Table 7 one can observe that this change, as expected, has no effect on the offline phase performance and the communication between the parties. However, the runtime of the online phase became significantly faster and is now twice as fast as the online phase of Hydra. However, combining both phases, one can observe that Hydra still leads to faster runtimes and less communication due to overall having less multiplications, with larger state sizes further increasing the advantage of Hydra.</p>

    <p class="text-gray-300">Table 5: Online and offline phase performance in MPC for several constructions with state sizes  <span class="math">t</span>  using a secret shared key. Prec is the number of precomputed elements (multiplication triples, squares, inverses). Depth describes the number of online communication rounds. The runtime is averaged over 200 runs. Bold values are best values with key schedules, Italic the best without.</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Cipher</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Rounds</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Prec.</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Offline Time ms</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Data MB</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Online Depth</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Time ms</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Data kB</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Combined Time ms</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Data MB</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">|  t=8:  |   |   |   |   |   |   |   |   |   |</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">HYDRA</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">6, 42, 39</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">171</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">39.99</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">3.86</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">131</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">6.81</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">5.37</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">46.80</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">3.87</th>

          </tr>

        </thead>

        <tbody>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">Ciminion</td>

            <td class="px-3 py-2 border-b border-gray-700">90, 14</td>

            <td class="px-3 py-2 border-b border-gray-700">867</td>

            <td class="px-3 py-2 border-b border-gray-700">227.47</td>

            <td class="px-3 py-2 border-b border-gray-700">19.55</td>

            <td class="px-3 py-2 border-b border-gray-700">735</td>

            <td class="px-3 py-2 border-b border-gray-700">21.81</td>

            <td class="px-3 py-2 border-b border-gray-700">28.02</td>

            <td class="px-3 py-2 border-b border-gray-700">249.29</td>

            <td class="px-3 py-2 border-b border-gray-700">19.58</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">HADESMiMC</td>

            <td class="px-3 py-2 border-b border-gray-700">6, 71</td>

            <td class="px-3 py-2 border-b border-gray-700">238</td>

            <td class="px-3 py-2 border-b border-gray-700">52.66</td>

            <td class="px-3 py-2 border-b border-gray-700">5.37</td>

            <td class="px-3 py-2 border-b border-gray-700">79</td>

            <td class="px-3 py-2 border-b border-gray-700">17.58</td>

            <td class="px-3 py-2 border-b border-gray-700">5.99</td>

            <td class="px-3 py-2 border-b border-gray-700">70.24</td>

            <td class="px-3 py-2 border-b border-gray-700">5.38</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">Rescue (No KS)a</td>

            <td class="px-3 py-2 border-b border-gray-700">10</td>

            <td class="px-3 py-2 border-b border-gray-700">480</td>

            <td class="px-3 py-2 border-b border-gray-700">129.47</td>

            <td class="px-3 py-2 border-b border-gray-700">10.83</td>

            <td class="px-3 py-2 border-b border-gray-700">33</td>

            <td class="px-3 py-2 border-b border-gray-700">6.95</td>

            <td class="px-3 py-2 border-b border-gray-700">11.80</td>

            <td class="px-3 py-2 border-b border-gray-700">136.42</td>

            <td class="px-3 py-2 border-b border-gray-700">10.84</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">Rescue</td>

            <td class="px-3 py-2 border-b border-gray-700">10</td>

            <td class="px-3 py-2 border-b border-gray-700">960</td>

            <td class="px-3 py-2 border-b border-gray-700">254.80</td>

            <td class="px-3 py-2 border-b border-gray-700">21.65</td>

            <td class="px-3 py-2 border-b border-gray-700">33</td>

            <td class="px-3 py-2 border-b border-gray-700">12.65</td>

            <td class="px-3 py-2 border-b border-gray-700">23.32</td>

            <td class="px-3 py-2 border-b border-gray-700">267.45</td>

            <td class="px-3 py-2 border-b border-gray-700">21.68</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">GMiMC</td>

            <td class="px-3 py-2 border-b border-gray-700">177</td>

            <td class="px-3 py-2 border-b border-gray-700">354</td>

            <td class="px-3 py-2 border-b border-gray-700">92.78</td>

            <td class="px-3 py-2 border-b border-gray-700">7.99</td>

            <td class="px-3 py-2 border-b border-gray-700">179</td>

            <td class="px-3 py-2 border-b border-gray-700">5.96</td>

            <td class="px-3 py-2 border-b border-gray-700">8.78</td>

            <td class="px-3 py-2 border-b border-gray-700">98.74</td>

            <td class="px-3 py-2 border-b border-gray-700">8.00</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">MiMC</td>

            <td class="px-3 py-2 border-b border-gray-700">81</td>

            <td class="px-3 py-2 border-b border-gray-700">1296</td>

            <td class="px-3 py-2 border-b border-gray-700">372.63</td>

            <td class="px-3 py-2 border-b border-gray-700">29.23</td>

            <td class="px-3 py-2 border-b border-gray-700">83</td>

            <td class="px-3 py-2 border-b border-gray-700">6.28</td>

            <td class="px-3 py-2 border-b border-gray-700">31.38</td>

            <td class="px-3 py-2 border-b border-gray-700">378.91</td>

            <td class="px-3 py-2 border-b border-gray-700">29.26</td>

          </tr>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">|  t=16:  |   |   |   |   |   |   |   |   |   |</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">HYDRA</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">6, 42, 39</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">212</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">52.72</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">4.78</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">132</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">9.87</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">6.81</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">62.59</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">4.79</th>

          </tr>

        </thead>

        <tbody>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">Ciminion</td>

            <td class="px-3 py-2 border-b border-gray-700">90, 14</td>

            <td class="px-3 py-2 border-b border-gray-700">1647</td>

            <td class="px-3 py-2 border-b border-gray-700">458.36</td>

            <td class="px-3 py-2 border-b border-gray-700">37.13</td>

            <td class="px-3 py-2 border-b border-gray-700">1455</td>

            <td class="px-3 py-2 border-b border-gray-700">49.75</td>

            <td class="px-3 py-2 border-b border-gray-700">53.11</td>

            <td class="px-3 py-2 border-b border-gray-700">508.11</td>

            <td class="px-3 py-2 border-b border-gray-700">37.19</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">HADESMiMC</td>

            <td class="px-3 py-2 border-b border-gray-700">6, 71</td>

            <td class="px-3 py-2 border-b border-gray-700">334</td>

            <td class="px-3 py-2 border-b border-gray-700">84.86</td>

            <td class="px-3 py-2 border-b border-gray-700">7.54</td>

            <td class="px-3 py-2 border-b border-gray-700">79</td>

            <td class="px-3 py-2 border-b border-gray-700">69.08</td>

            <td class="px-3 py-2 border-b border-gray-700">8.42</td>

            <td class="px-3 py-2 border-b border-gray-700">153.95</td>

            <td class="px-3 py-2 border-b border-gray-700">7.55</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">Rescue (No KS)a</td>

            <td class="px-3 py-2 border-b border-gray-700">10</td>

            <td class="px-3 py-2 border-b border-gray-700">960</td>

            <td class="px-3 py-2 border-b border-gray-700">263.58</td>

            <td class="px-3 py-2 border-b border-gray-700">21.65</td>

            <td class="px-3 py-2 border-b border-gray-700">33</td>

            <td class="px-3 py-2 border-b border-gray-700">18.80</td>

            <td class="px-3 py-2 border-b border-gray-700">23.45</td>

            <td class="px-3 py-2 border-b border-gray-700">282.38</td>

            <td class="px-3 py-2 border-b border-gray-700">21.68</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">Rescue</td>

            <td class="px-3 py-2 border-b border-gray-700">10</td>

            <td class="px-3 py-2 border-b border-gray-700">1920</td>

            <td class="px-3 py-2 border-b border-gray-700">531.54</td>

            <td class="px-3 py-2 border-b border-gray-700">43.30</td>

            <td class="px-3 py-2 border-b border-gray-700">33</td>

            <td class="px-3 py-2 border-b border-gray-700">38.68</td>

            <td class="px-3 py-2 border-b border-gray-700">46.49</td>

            <td class="px-3 py-2 border-b border-gray-700">570.21</td>

            <td class="px-3 py-2 border-b border-gray-700">43.35</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">GMiMC</td>

            <td class="px-3 py-2 border-b border-gray-700">546</td>

            <td class="px-3 py-2 border-b border-gray-700">1092</td>

            <td class="px-3 py-2 border-b border-gray-700">292.14</td>

            <td class="px-3 py-2 border-b border-gray-700">24.63</td>

            <td class="px-3 py-2 border-b border-gray-700">548</td>

            <td class="px-3 py-2 border-b border-gray-700">15.81</td>

            <td class="px-3 py-2 border-b border-gray-700">26.62</td>

            <td class="px-3 py-2 border-b border-gray-700">307.96</td>

            <td class="px-3 py-2 border-b border-gray-700">24.66</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">MiMC</td>

            <td class="px-3 py-2 border-b border-gray-700">81</td>

            <td class="px-3 py-2 border-b border-gray-700">2592</td>

            <td class="px-3 py-2 border-b border-gray-700">770.12</td>

            <td class="px-3 py-2 border-b border-gray-700">58.46</td>

            <td class="px-3 py-2 border-b border-gray-700">83</td>

            <td class="px-3 py-2 border-b border-gray-700">6.21</td>

            <td class="px-3 py-2 border-b border-gray-700">62.62</td>

            <td class="px-3 py-2 border-b border-gray-700">776.33</td>

            <td class="px-3 py-2 border-b border-gray-700">58.52</td>

          </tr>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">|  t=32:  |   |   |   |   |   |   |   |   |   |</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">HYDRA</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">6, 42, 39</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">294</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">72.67</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">6.63</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">134</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">13.36</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">9.69</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">86.03</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">6.64</th>

          </tr>

        </thead>

        <tbody>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">Ciminion</td>

            <td class="px-3 py-2 border-b border-gray-700">90, 14</td>

            <td class="px-3 py-2 border-b border-gray-700">3207</td>

            <td class="px-3 py-2 border-b border-gray-700">910.11</td>

            <td class="px-3 py-2 border-b border-gray-700">72.30</td>

            <td class="px-3 py-2 border-b border-gray-700">2895</td>

            <td class="px-3 py-2 border-b border-gray-700">84.37</td>

            <td class="px-3 py-2 border-b border-gray-700">103.29</td>

            <td class="px-3 py-2 border-b border-gray-700">994.47</td>

            <td class="px-3 py-2 border-b border-gray-700">72.41</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">HADESMiMC</td>

            <td class="px-3 py-2 border-b border-gray-700">6, 71</td>

            <td class="px-3 py-2 border-b border-gray-700">526</td>

            <td class="px-3 py-2 border-b border-gray-700">137.49</td>

            <td class="px-3 py-2 border-b border-gray-700">11.87</td>

            <td class="px-3 py-2 border-b border-gray-700">79</td>

            <td class="px-3 py-2 border-b border-gray-700">225.86</td>

            <td class="px-3 py-2 border-b border-gray-700">13.29</td>

            <td class="px-3 py-2 border-b border-gray-700">363.35</td>

            <td class="px-3 py-2 border-b border-gray-700">11.88</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">Rescue (No KS)a</td>

            <td class="px-3 py-2 border-b border-gray-700">10</td>

            <td class="px-3 py-2 border-b border-gray-700">1920</td>

            <td class="px-3 py-2 border-b border-gray-700">538.19</td>

            <td class="px-3 py-2 border-b border-gray-700">43.30</td>

            <td class="px-3 py-2 border-b border-gray-700">33</td>

            <td class="px-3 py-2 border-b border-gray-700">47.35</td>

            <td class="px-3 py-2 border-b border-gray-700">46.74</td>

            <td class="px-3 py-2 border-b border-gray-700">585.54</td>

            <td class="px-3 py-2 border-b border-gray-700">43.35</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">Rescue</td>

            <td class="px-3 py-2 border-b border-gray-700">10</td>

            <td class="px-3 py-2 border-b border-gray-700">3840</td>

            <td class="px-3 py-2 border-b border-gray-700">1253.76</td>

            <td class="px-3 py-2 border-b border-gray-700">86.60</td>

            <td class="px-3 py-2 border-b border-gray-700">33</td>

            <td class="px-3 py-2 border-b border-gray-700">109.80</td>

            <td class="px-3 py-2 border-b border-gray-700">92.82</td>

            <td class="px-3 py-2 border-b border-gray-700">1363.56</td>

            <td class="px-3 py-2 border-b border-gray-700">86.70</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">GMiMC</td>

            <td class="px-3 py-2 border-b border-gray-700">2114</td>

            <td class="px-3 py-2 border-b border-gray-700">4228</td>

            <td class="px-3 py-2 border-b border-gray-700">1424.02</td>

            <td class="px-3 py-2 border-b border-gray-700">95.35</td>

            <td class="px-3 py-2 border-b border-gray-700">2116</td>

            <td class="px-3 py-2 border-b border-gray-700">57.97</td>

            <td class="px-3 py-2 border-b border-gray-700">102.14</td>

            <td class="px-3 py-2 border-b border-gray-700">1481.99</td>

            <td class="px-3 py-2 border-b border-gray-700">95.46</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">MiMC</td>

            <td class="px-3 py-2 border-b border-gray-700">81</td>

            <td class="px-3 py-2 border-b border-gray-700">5184</td>

            <td class="px-3 py-2 border-b border-gray-700">1713.06</td>

            <td class="px-3 py-2 border-b border-gray-700">116.91</td>

            <td class="px-3 py-2 border-b border-gray-700">83</td>

            <td class="px-3 py-2 border-b border-gray-700">13.77</td>

            <td class="px-3 py-2 border-b border-gray-700">125.08</td>

            <td class="px-3 py-2 border-b border-gray-700">1726.83</td>

            <td class="px-3 py-2 border-b border-gray-700">117.04</td>

          </tr>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">a Assumes round keys are present, i.e., no key schedule computation in MPC.</p>

    <p class="text-gray-300">Table 6: Online and offline phase performance in MPC for several constructions with state sizes  <span class="math">t</span>  using a secret shared key. Prec is the number of precomputed elements (multiplication triples, squares, inverses). Depth describes the number of online communication rounds. The runtime is averaged over 200 runs. Bold values are best values with key schedules, Italic the best without.</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Cipher</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Rounds</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Prec.</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Offline Time ms</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Data MB</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Depth</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Online Time ms</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Data kB</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Combined Time ms</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Data MB</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">|  t = 64:  |   |   |   |   |   |   |   |   |   |</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">HYDRA</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">6, 42, 39</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">458</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">119.07</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">10.33</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">138</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">20.57</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">15.45</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">139.64</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">10.35</th>

          </tr>

        </thead>

        <tbody>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">Ciminion</td>

            <td class="px-3 py-2 border-b border-gray-700">90, 14</td>

            <td class="px-3 py-2 border-b border-gray-700">6327</td>

            <td class="px-3 py-2 border-b border-gray-700">2262.55</td>

            <td class="px-3 py-2 border-b border-gray-700">142.64</td>

            <td class="px-3 py-2 border-b border-gray-700">5775</td>

            <td class="px-3 py-2 border-b border-gray-700">178.66</td>

            <td class="px-3 py-2 border-b border-gray-700">203.64</td>

            <td class="px-3 py-2 border-b border-gray-700">2441.21</td>

            <td class="px-3 py-2 border-b border-gray-700">142.84</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">HADESMiMC</td>

            <td class="px-3 py-2 border-b border-gray-700">6, 71</td>

            <td class="px-3 py-2 border-b border-gray-700">910</td>

            <td class="px-3 py-2 border-b border-gray-700">251.44</td>

            <td class="px-3 py-2 border-b border-gray-700">20.53</td>

            <td class="px-3 py-2 border-b border-gray-700">79</td>

            <td class="px-3 py-2 border-b border-gray-700">899.55</td>

            <td class="px-3 py-2 border-b border-gray-700">23.02</td>

            <td class="px-3 py-2 border-b border-gray-700">1150.99</td>

            <td class="px-3 py-2 border-b border-gray-700">20.55</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">Rescue (No KS)a</td>

            <td class="px-3 py-2 border-b border-gray-700">10</td>

            <td class="px-3 py-2 border-b border-gray-700">3840</td>

            <td class="px-3 py-2 border-b border-gray-700">1226.39</td>

            <td class="px-3 py-2 border-b border-gray-700">86.60</td>

            <td class="px-3 py-2 border-b border-gray-700">33</td>

            <td class="px-3 py-2 border-b border-gray-700">144.14</td>

            <td class="px-3 py-2 border-b border-gray-700">93.34</td>

            <td class="px-3 py-2 border-b border-gray-700">1370.53</td>

            <td class="px-3 py-2 border-b border-gray-700">86.70</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">Rescue</td>

            <td class="px-3 py-2 border-b border-gray-700">10</td>

            <td class="px-3 py-2 border-b border-gray-700">7680</td>

            <td class="px-3 py-2 border-b border-gray-700">2851.56</td>

            <td class="px-3 py-2 border-b border-gray-700">173.20</td>

            <td class="px-3 py-2 border-b border-gray-700">33</td>

            <td class="px-3 py-2 border-b border-gray-700">402.34</td>

            <td class="px-3 py-2 border-b border-gray-700">185.50</td>

            <td class="px-3 py-2 border-b border-gray-700">3253.90</td>

            <td class="px-3 py-2 border-b border-gray-700">173.39</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">GMiMC</td>

            <td class="px-3 py-2 border-b border-gray-700">8322</td>

            <td class="px-3 py-2 border-b border-gray-700">16644</td>

            <td class="px-3 py-2 border-b border-gray-700">6253.29</td>

            <td class="px-3 py-2 border-b border-gray-700">375.36</td>

            <td class="px-3 py-2 border-b border-gray-700">8324</td>

            <td class="px-3 py-2 border-b border-gray-700">255.78</td>

            <td class="px-3 py-2 border-b border-gray-700">400.63</td>

            <td class="px-3 py-2 border-b border-gray-700">6509.07</td>

            <td class="px-3 py-2 border-b border-gray-700">375.76</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">MiMC</td>

            <td class="px-3 py-2 border-b border-gray-700">81</td>

            <td class="px-3 py-2 border-b border-gray-700">10368</td>

            <td class="px-3 py-2 border-b border-gray-700">4060.68</td>

            <td class="px-3 py-2 border-b border-gray-700">233.82</td>

            <td class="px-3 py-2 border-b border-gray-700">83</td>

            <td class="px-3 py-2 border-b border-gray-700">23.71</td>

            <td class="px-3 py-2 border-b border-gray-700">250.01</td>

            <td class="px-3 py-2 border-b border-gray-700">4084.39</td>

            <td class="px-3 py-2 border-b border-gray-700">234.07</td>

          </tr>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">|  t = 96:  |   |   |   |   |   |   |   |   |   |</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">HYDRA</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">6, 42, 39</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">622</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">172.42</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">14.03</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">142</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">33.99</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">21.21</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">206.40</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">14.05</th>

          </tr>

        </thead>

        <tbody>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">Ciminion</td>

            <td class="px-3 py-2 border-b border-gray-700">90, 14</td>

            <td class="px-3 py-2 border-b border-gray-700">9447</td>

            <td class="px-3 py-2 border-b border-gray-700">3693.60</td>

            <td class="px-3 py-2 border-b border-gray-700">212.98</td>

            <td class="px-3 py-2 border-b border-gray-700">8655</td>

            <td class="px-3 py-2 border-b border-gray-700">257.04</td>

            <td class="px-3 py-2 border-b border-gray-700">303.99</td>

            <td class="px-3 py-2 border-b border-gray-700">3950.64</td>

            <td class="px-3 py-2 border-b border-gray-700">213.28</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">HADESMiMC</td>

            <td class="px-3 py-2 border-b border-gray-700">6, 71</td>

            <td class="px-3 py-2 border-b border-gray-700">1294</td>

            <td class="px-3 py-2 border-b border-gray-700">344.34</td>

            <td class="px-3 py-2 border-b border-gray-700">29.19</td>

            <td class="px-3 py-2 border-b border-gray-700">79</td>

            <td class="px-3 py-2 border-b border-gray-700">2114.35</td>

            <td class="px-3 py-2 border-b border-gray-700">32.74</td>

            <td class="px-3 py-2 border-b border-gray-700">2458.69</td>

            <td class="px-3 py-2 border-b border-gray-700">29.22</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">Rescue (No KS)a</td>

            <td class="px-3 py-2 border-b border-gray-700">10</td>

            <td class="px-3 py-2 border-b border-gray-700">5760</td>

            <td class="px-3 py-2 border-b border-gray-700">2011.83</td>

            <td class="px-3 py-2 border-b border-gray-700">129.90</td>

            <td class="px-3 py-2 border-b border-gray-700">33</td>

            <td class="px-3 py-2 border-b border-gray-700">303.15</td>

            <td class="px-3 py-2 border-b border-gray-700">139.93</td>

            <td class="px-3 py-2 border-b border-gray-700">2314.98</td>

            <td class="px-3 py-2 border-b border-gray-700">130.04</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">Rescue</td>

            <td class="px-3 py-2 border-b border-gray-700">10</td>

            <td class="px-3 py-2 border-b border-gray-700">11520</td>

            <td class="px-3 py-2 border-b border-gray-700">4457.93</td>

            <td class="px-3 py-2 border-b border-gray-700">259.80</td>

            <td class="px-3 py-2 border-b border-gray-700">33</td>

            <td class="px-3 py-2 border-b border-gray-700">803.78</td>

            <td class="px-3 py-2 border-b border-gray-700">278.17</td>

            <td class="px-3 py-2 border-b border-gray-700">5261.71</td>

            <td class="px-3 py-2 border-b border-gray-700">260.08</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">GMiMC</td>

            <td class="px-3 py-2 border-b border-gray-700">18626</td>

            <td class="px-3 py-2 border-b border-gray-700">37252</td>

            <td class="px-3 py-2 border-b border-gray-700">12907.70</td>

            <td class="px-3 py-2 border-b border-gray-700">840.11</td>

            <td class="px-3 py-2 border-b border-gray-700">18628</td>

            <td class="px-3 py-2 border-b border-gray-700">547.09</td>

            <td class="px-3 py-2 border-b border-gray-700">895.74</td>

            <td class="px-3 py-2 border-b border-gray-700">13454.79</td>

            <td class="px-3 py-2 border-b border-gray-700">841.01</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">MiMC</td>

            <td class="px-3 py-2 border-b border-gray-700">81</td>

            <td class="px-3 py-2 border-b border-gray-700">15552</td>

            <td class="px-3 py-2 border-b border-gray-700">5771.92</td>

            <td class="px-3 py-2 border-b border-gray-700">350.73</td>

            <td class="px-3 py-2 border-b border-gray-700">83</td>

            <td class="px-3 py-2 border-b border-gray-700">27.49</td>

            <td class="px-3 py-2 border-b border-gray-700">374.94</td>

            <td class="px-3 py-2 border-b border-gray-700">5799.41</td>

            <td class="px-3 py-2 border-b border-gray-700">351.11</td>

          </tr>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">|  t = 128:  |   |   |   |   |   |   |   |   |   |</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">HYDRA</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">6, 42, 39</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">786</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">206.08</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">17.72</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">146</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">37.49</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">26.97</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">243.58</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">17.75</th>

          </tr>

        </thead>

        <tbody>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">Ciminion</td>

            <td class="px-3 py-2 border-b border-gray-700">90, 14</td>

            <td class="px-3 py-2 border-b border-gray-700">12567</td>

            <td class="px-3 py-2 border-b border-gray-700">4854.43</td>

            <td class="px-3 py-2 border-b border-gray-700">283.32</td>

            <td class="px-3 py-2 border-b border-gray-700">11535</td>

            <td class="px-3 py-2 border-b border-gray-700">328.79</td>

            <td class="px-3 py-2 border-b border-gray-700">404.34</td>

            <td class="px-3 py-2 border-b border-gray-700">5183.22</td>

            <td class="px-3 py-2 border-b border-gray-700">283.72</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">HADESMiMC</td>

            <td class="px-3 py-2 border-b border-gray-700">6, 71</td>

            <td class="px-3 py-2 border-b border-gray-700">1678</td>

            <td class="px-3 py-2 border-b border-gray-700">463.59</td>

            <td class="px-3 py-2 border-b border-gray-700">37.85</td>

            <td class="px-3 py-2 border-b border-gray-700">79</td>

            <td class="px-3 py-2 border-b border-gray-700">4371.02</td>

            <td class="px-3 py-2 border-b border-gray-700">42.47</td>

            <td class="px-3 py-2 border-b border-gray-700">4834.61</td>

            <td class="px-3 py-2 border-b border-gray-700">37.89</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">Rescue (No KS)a</td>

            <td class="px-3 py-2 border-b border-gray-700">10</td>

            <td class="px-3 py-2 border-b border-gray-700">7680</td>

            <td class="px-3 py-2 border-b border-gray-700">2943.21</td>

            <td class="px-3 py-2 border-b border-gray-700">173.20</td>

            <td class="px-3 py-2 border-b border-gray-700">33</td>

            <td class="px-3 py-2 border-b border-gray-700">737.84</td>

            <td class="px-3 py-2 border-b border-gray-700">186.52</td>

            <td class="px-3 py-2 border-b border-gray-700">3681.05</td>

            <td class="px-3 py-2 border-b border-gray-700">173.39</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">Rescue</td>

            <td class="px-3 py-2 border-b border-gray-700">10</td>

            <td class="px-3 py-2 border-b border-gray-700">15360</td>

            <td class="px-3 py-2 border-b border-gray-700">5934.39</td>

            <td class="px-3 py-2 border-b border-gray-700">346.40</td>

            <td class="px-3 py-2 border-b border-gray-700">33</td>

            <td class="px-3 py-2 border-b border-gray-700">1549.16</td>

            <td class="px-3 py-2 border-b border-gray-700">370.84</td>

            <td class="px-3 py-2 border-b border-gray-700">7483.55</td>

            <td class="px-3 py-2 border-b border-gray-700">346.77</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">GMiMC</td>

            <td class="px-3 py-2 border-b border-gray-700">33026</td>

            <td class="px-3 py-2 border-b border-gray-700">66052</td>

            <td class="px-3 py-2 border-b border-gray-700">23295.70</td>

            <td class="px-3 py-2 border-b border-gray-700">1489.61</td>

            <td class="px-3 py-2 border-b border-gray-700">33028</td>

            <td class="px-3 py-2 border-b border-gray-700">955.50</td>

            <td class="px-3 py-2 border-b border-gray-700">1587.45</td>

            <td class="px-3 py-2 border-b border-gray-700">24251.20</td>

            <td class="px-3 py-2 border-b border-gray-700">1491.20</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">MiMC</td>

            <td class="px-3 py-2 border-b border-gray-700">81</td>

            <td class="px-3 py-2 border-b border-gray-700">20736</td>

            <td class="px-3 py-2 border-b border-gray-700">7588.20</td>

            <td class="px-3 py-2 border-b border-gray-700">467.64</td>

            <td class="px-3 py-2 border-b border-gray-700">83</td>

            <td class="px-3 py-2 border-b border-gray-700">35.43</td>

            <td class="px-3 py-2 border-b border-gray-700">499.86</td>

            <td class="px-3 py-2 border-b border-gray-700">7623.63</td>

            <td class="px-3 py-2 border-b border-gray-700">468.14</td>

          </tr>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">a Assumes round keys are present, i.e., no key schedule computation in MPC.</p>

    <p class="text-gray-300">Table 7: Online and offline phase performance in MPC for several constructions with state sizes  <span class="math">t</span>  using a secret shared key. Prec is the number of precomputed elements (multiplication triples, squares, inverses). Depth describes the number of online communication rounds. The runtime is averaged over 200 runs. Bold values are best values with key schedules, Italic the best without.</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Cipher</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Rounds</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Offline</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Online</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Combined</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

          </tr>

        </thead>

        <tbody>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">Prec.</td>

            <td class="px-3 py-2 border-b border-gray-700">Time ms</td>

            <td class="px-3 py-2 border-b border-gray-700">Data MB</td>

            <td class="px-3 py-2 border-b border-gray-700">Depth</td>

            <td class="px-3 py-2 border-b border-gray-700">Time ms</td>

            <td class="px-3 py-2 border-b border-gray-700">Data kB</td>

            <td class="px-3 py-2 border-b border-gray-700">Time ms</td>

            <td class="px-3 py-2 border-b border-gray-700">Data MB</td>

          </tr>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">|  t=8:  |   |   |   |   |   |   |   |   |   |</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">HYDRA</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">6, 42, 39</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">171</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">39.99</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">3.86</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">131</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">6.81</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">5.37</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">46.80</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">3.87</th>

          </tr>

        </thead>

        <tbody>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">HADESMiMC</td>

            <td class="px-3 py-2 border-b border-gray-700">6, 71</td>

            <td class="px-3 py-2 border-b border-gray-700">238</td>

            <td class="px-3 py-2 border-b border-gray-700">52.66</td>

            <td class="px-3 py-2 border-b border-gray-700">5.37</td>

            <td class="px-3 py-2 border-b border-gray-700">79</td>

            <td class="px-3 py-2 border-b border-gray-700">17.58</td>

            <td class="px-3 py-2 border-b border-gray-700">5.99</td>

            <td class="px-3 py-2 border-b border-gray-700">70.24</td>

            <td class="px-3 py-2 border-b border-gray-700">5.38</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">HADESMiMC-circ (No KS)a</td>

            <td class="px-3 py-2 border-b border-gray-700">6, 71</td>

            <td class="px-3 py-2 border-b border-gray-700">238</td>

            <td class="px-3 py-2 border-b border-gray-700">51.06</td>

            <td class="px-3 py-2 border-b border-gray-700">5.37</td>

            <td class="px-3 py-2 border-b border-gray-700">79</td>

            <td class="px-3 py-2 border-b border-gray-700">3.57</td>

            <td class="px-3 py-2 border-b border-gray-700">5.99</td>

            <td class="px-3 py-2 border-b border-gray-700">54.62</td>

            <td class="px-3 py-2 border-b border-gray-700">5.38</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">HADESMiMC-circ</td>

            <td class="px-3 py-2 border-b border-gray-700">6, 71</td>

            <td class="px-3 py-2 border-b border-gray-700">238</td>

            <td class="px-3 py-2 border-b border-gray-700">55.10</td>

            <td class="px-3 py-2 border-b border-gray-700">5.37</td>

            <td class="px-3 py-2 border-b border-gray-700">79</td>

            <td class="px-3 py-2 border-b border-gray-700">3.82</td>

            <td class="px-3 py-2 border-b border-gray-700">5.99</td>

            <td class="px-3 py-2 border-b border-gray-700">58.92</td>

            <td class="px-3 py-2 border-b border-gray-700">5.38</td>

          </tr>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">|  t=16:  |   |   |   |   |   |   |   |   |   |</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">HYDRA</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">6, 42, 39</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">212</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">52.72</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">4.78</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">132</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">9.87</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">6.81</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">62.59</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">4.79</th>

          </tr>

        </thead>

        <tbody>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">HADESMiMC</td>

            <td class="px-3 py-2 border-b border-gray-700">6, 71</td>

            <td class="px-3 py-2 border-b border-gray-700">334</td>

            <td class="px-3 py-2 border-b border-gray-700">84.86</td>

            <td class="px-3 py-2 border-b border-gray-700">7.54</td>

            <td class="px-3 py-2 border-b border-gray-700">79</td>

            <td class="px-3 py-2 border-b border-gray-700">69.08</td>

            <td class="px-3 py-2 border-b border-gray-700">8.42</td>

            <td class="px-3 py-2 border-b border-gray-700">153.95</td>

            <td class="px-3 py-2 border-b border-gray-700">7.55</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">HADESMiMC-circ (No KS)a</td>

            <td class="px-3 py-2 border-b border-gray-700">6, 71</td>

            <td class="px-3 py-2 border-b border-gray-700">334</td>

            <td class="px-3 py-2 border-b border-gray-700">89.95</td>

            <td class="px-3 py-2 border-b border-gray-700">7.54</td>

            <td class="px-3 py-2 border-b border-gray-700">79</td>

            <td class="px-3 py-2 border-b border-gray-700">5.84</td>

            <td class="px-3 py-2 border-b border-gray-700">8.42</td>

            <td class="px-3 py-2 border-b border-gray-700">105.99</td>

            <td class="px-3 py-2 border-b border-gray-700">7.55</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">HADESMiMC-circ</td>

            <td class="px-3 py-2 border-b border-gray-700">6, 71</td>

            <td class="px-3 py-2 border-b border-gray-700">334</td>

            <td class="px-3 py-2 border-b border-gray-700">83.93</td>

            <td class="px-3 py-2 border-b border-gray-700">7.54</td>

            <td class="px-3 py-2 border-b border-gray-700">79</td>

            <td class="px-3 py-2 border-b border-gray-700">6.06</td>

            <td class="px-3 py-2 border-b border-gray-700">8.42</td>

            <td class="px-3 py-2 border-b border-gray-700">99.78</td>

            <td class="px-3 py-2 border-b border-gray-700">7.55</td>

          </tr>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">|  t=32:  |   |   |   |   |   |   |   |   |   |</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">HYDRA</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">6, 42, 39</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">294</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">72.67</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">6.63</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">134</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">13.36</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">9.69</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">86.03</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">6.64</th>

          </tr>

        </thead>

        <tbody>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">HADESMiMC</td>

            <td class="px-3 py-2 border-b border-gray-700">6, 71</td>

            <td class="px-3 py-2 border-b border-gray-700">526</td>

            <td class="px-3 py-2 border-b border-gray-700">137.49</td>

            <td class="px-3 py-2 border-b border-gray-700">11.87</td>

            <td class="px-3 py-2 border-b border-gray-700">79</td>

            <td class="px-3 py-2 border-b border-gray-700">225.86</td>

            <td class="px-3 py-2 border-b border-gray-700">13.29</td>

            <td class="px-3 py-2 border-b border-gray-700">363.35</td>

            <td class="px-3 py-2 border-b border-gray-700">11.88</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">HADESMiMC-circ (No KS)a</td>

            <td class="px-3 py-2 border-b border-gray-700">6, 71</td>

            <td class="px-3 py-2 border-b border-gray-700">526</td>

            <td class="px-3 py-2 border-b border-gray-700">137.72</td>

            <td class="px-3 py-2 border-b border-gray-700">11.87</td>

            <td class="px-3 py-2 border-b border-gray-700">79</td>

            <td class="px-3 py-2 border-b border-gray-700">6.14</td>

            <td class="px-3 py-2 border-b border-gray-700">13.29</td>

            <td class="px-3 py-2 border-b border-gray-700">144.86</td>

            <td class="px-3 py-2 border-b border-gray-700">11.88</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">HADESMiMC-circ</td>

            <td class="px-3 py-2 border-b border-gray-700">6, 71</td>

            <td class="px-3 py-2 border-b border-gray-700">526</td>

            <td class="px-3 py-2 border-b border-gray-700">138.15</td>

            <td class="px-3 py-2 border-b border-gray-700">11.87</td>

            <td class="px-3 py-2 border-b border-gray-700">79</td>

            <td class="px-3 py-2 border-b border-gray-700">6.70</td>

            <td class="px-3 py-2 border-b border-gray-700">13.29</td>

            <td class="px-3 py-2 border-b border-gray-700">144.85</td>

            <td class="px-3 py-2 border-b border-gray-700">11.88</td>

          </tr>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">|  t=64:  |   |   |   |   |   |   |   |   |   |</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">HYDRA</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">6, 42, 39</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">458</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">119.07</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">10.33</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">138</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">20.57</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">15.45</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">139.64</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">10.35</th>

          </tr>

        </thead>

        <tbody>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">HADESMiMC</td>

            <td class="px-3 py-2 border-b border-gray-700">6, 71</td>

            <td class="px-3 py-2 border-b border-gray-700">910</td>

            <td class="px-3 py-2 border-b border-gray-700">251.44</td>

            <td class="px-3 py-2 border-b border-gray-700">20.53</td>

            <td class="px-3 py-2 border-b border-gray-700">79</td>

            <td class="px-3 py-2 border-b border-gray-700">899.55</td>

            <td class="px-3 py-2 border-b border-gray-700">23.02</td>

            <td class="px-3 py-2 border-b border-gray-700">1150.99</td>

            <td class="px-3 py-2 border-b border-gray-700">20.55</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">HADESMiMC-circ (No KS)a</td>

            <td class="px-3 py-2 border-b border-gray-700">6, 71</td>

            <td class="px-3 py-2 border-b border-gray-700">910</td>

            <td class="px-3 py-2 border-b border-gray-700">242.01</td>

            <td class="px-3 py-2 border-b border-gray-700">20.53</td>

            <td class="px-3 py-2 border-b border-gray-700">79</td>

            <td class="px-3 py-2 border-b border-gray-700">11.40</td>

            <td class="px-3 py-2 border-b border-gray-700">23.02</td>

            <td class="px-3 py-2 border-b border-gray-700">253.51</td>

            <td class="px-3 py-2 border-b border-gray-700">20.55</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">HADESMiMC-circ</td>

            <td class="px-3 py-2 border-b border-gray-700">6, 71</td>

            <td class="px-3 py-2 border-b border-gray-700">910</td>

            <td class="px-3 py-2 border-b border-gray-700">244.90</td>

            <td class="px-3 py-2 border-b border-gray-700">20.53</td>

            <td class="px-3 py-2 border-b border-gray-700">79</td>

            <td class="px-3 py-2 border-b border-gray-700">11.53</td>

            <td class="px-3 py-2 border-b border-gray-700">23.02</td>

            <td class="px-3 py-2 border-b border-gray-700">256.33</td>

            <td class="px-3 py-2 border-b border-gray-700">20.55</td>

          </tr>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">|  t=128:  |   |   |   |   |   |   |   |   |   |</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">HYDRA</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">6, 42, 39</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">786</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">206.08</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">17.72</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">146</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">37.49</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">26.97</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">243.58</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">17.75</th>

          </tr>

        </thead>

        <tbody>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">HADESMiMC</td>

            <td class="px-3 py-2 border-b border-gray-700">6, 71</td>

            <td class="px-3 py-2 border-b border-gray-700">1678</td>

            <td class="px-3 py-2 border-b border-gray-700">463.59</td>

            <td class="px-3 py-2 border-b border-gray-700">37.85</td>

            <td class="px-3 py-2 border-b border-gray-700">79</td>

            <td class="px-3 py-2 border-b border-gray-700">4371.02</td>

            <td class="px-3 py-2 border-b border-gray-700">42.47</td>

            <td class="px-3 py-2 border-b border-gray-700">4834.61</td>

            <td class="px-3 py-2 border-b border-gray-700">37.89</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">HADESMiMC-circ (No KS)a</td>

            <td class="px-3 py-2 border-b border-gray-700">6, 71</td>

            <td class="px-3 py-2 border-b border-gray-700">1678</td>

            <td class="px-3 py-2 border-b border-gray-700">477.78</td>

            <td class="px-3 py-2 border-b border-gray-700">37.85</td>

            <td class="px-3 py-2 border-b border-gray-700">79</td>

            <td class="px-3 py-2 border-b border-gray-700">21.48</td>

            <td class="px-3 py-2 border-b border-gray-700">42.47</td>

            <td class="px-3 py-2 border-b border-gray-700">505.26</td>

            <td class="px-3 py-2 border-b border-gray-700">37.89</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">HADESMiMC-circ</td>

            <td class="px-3 py-2 border-b border-gray-700">6, 71</td>

            <td class="px-3 py-2 border-b border-gray-700">1678</td>

            <td class="px-3 py-2 border-b border-gray-700">463.89</td>

            <td class="px-3 py-2 border-b border-gray-700">37.85</td>

            <td class="px-3 py-2 border-b border-gray-700">79</td>

            <td class="px-3 py-2 border-b border-gray-700">21.83</td>

            <td class="px-3 py-2 border-b border-gray-700">42.47</td>

            <td class="px-3 py-2 border-b border-gray-700">485.72</td>

            <td class="px-3 py-2 border-b border-gray-700">37.89</td>

          </tr>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">a Assumes round keys are present, i.e., no key schedule computation in MPC.</p>

    <p class="text-gray-300">References for Supplementary Material</p>

    <h2 id="sec-80" class="text-2xl font-bold">References for Supplementary Material</h2>

    <ul class="list-disc list-inside space-y-1 text-gray-300 my-2 ml-4">

      <li>[1] A. Aly, T. Ashur, E. Ben-Sasson, S. Dhooghe, and A. Szepieniec. “Design of Symmetric-Key Primitives for Advanced Cryptographic Protocols”. In: IACR Trans. Symmetric Cryptol. 2020.3 (2020), pp. 1–45.</li>

      <li>[2] D. Beaver. “Efficient Multiparty Protocols Using Circuit Randomization”. In: CRYPTO. Vol. 576. LNCS. 1991, pp. 420–432.</li>

      <li>[3] G. Bertoni, J. Daemen, M. Peeters, and G. Van Assche. The KECCAK reference. https://keccak.team/files/Keccak-reference-3.0.pdf. 2011.</li>

      <li>[4] T. Beyne, A. Canteaut, I. Dinur, M. Eichlseder, G. Leander, G. Leurent, M. Naya-Plasencia, L. Perrin, Y. Sasaki, Y. Todo, and F. Wiemer. “Out of Oddity - New Cryptanalytic Techniques Against Symmetric Primitives Optimized for Integrity Proof Systems”. In: CRYPTO. Vol. 12172. LNCS. 2020, pp. 299–328.</li>

      <li>[5] E. Biham and A. Shamir. “Differential Cryptanalysis of DES-like Cryptosystems”. In: CRYPTO. Vol. 537. LNCS. 1990, pp. 2–21.</li>

      <li>[6] E. Biham and A. Shamir. Differential Cryptanalysis of the Data Encryption Standard. Springer, 1993.</li>

      <li>[7] N. Courtois, A. Klimov, J. Patarin, and A. Shamir. “Efficient algorithms for solving overdefined systems of multivariate polynomial equations”. In: International Conference on the Theory and Applications of Cryptographic Techniques. Springer. 2000, pp. 392–407.</li>

      <li>[8] J. Ding, A. Petzoldt, and D. S. Schmidt. Multivariate Public Key Cryptosystems. https://doi.org/10.1007/978-1-0716-0987-3. Springer, 2020.</li>

      <li>[9] L. Grassi. “On Generalizations of the Lai-Massey Scheme: the Blooming of Amaryllises”. In: IACR Cryptol. ePrint Arch. (2022), p. 1245.</li>

      <li>[10] L. Grassi, R. Lüftenegger, C. Rechberger, D. Rotaru, and M. Schofnegger. “On a Generalization of Substitution-Permutation Networks: The HADES Design Strategy”. In: EUROCRYPT. Vol. 12106. LNCS. 2020, pp. 674–704.</li>

      <li>[11] L. Grassi, C. Rechberger, and S. Rønjom. “Subspace Trail Cryptanalysis and its Applications to AES”. In: IACR Trans. Symmetric Cryptol. 2016.2 (2017), pp. 192–225.</li>

      <li>[12] L. Grassi, C. Rechberger, D. Rotaru, P. Scholl, and N. P. Smart. “MPC-Friendly Symmetric Key Primitives”. In: CCS. ACM, 2016, pp. 430–443.</li>

      <li>[13] L. Grassi, C. Rechberger, and M. Schofnegger. “Proving Resistance Against Infinitely Long Subspace Trails: How to Choose the Linear Layer”. In: IACR Trans. Symmetric Cryptol. 2021.2 (2021), pp. 314–352.</li>

      <li>[14] C. Guo, F.-X. Standaert, W. Wang, X. Wang, and Y. Yu. “Provable Security of SP Networks with Partial Non-Linear Layers”. In: IACR Transactions on Symmetric Cryptology 2021.2 (2021), pp. 353–388.</li>

      <li>[15] T. Jakobsen and L. R. Knudsen. “The Interpolation Attack on Block Ciphers”. In: FSE. Vol. 1267. LNCS. 1997, pp. 28–40.</li>

      <li>[16] L. R. Knudsen. “Truncated and Higher Order Differentials”. In: FSE. Vol. 1008. LNCS. 1994, pp. 196–211.</li>

      <li>[17] X. Lai. “Higher Order Derivatives and Differential Cryptanalysis”. In: Communications and Cryptography: Two Sides of One Tapestry. Springer US, 1994, pp. 227–233.</li>

      <li>[18] G. Leander, M. A. Abdelraheem, H. AlKhzaimi, and E. Zenner. “A Cryptanalysis of PRINTcipher: The Invariant Subspace Attack”. In: CRYPTO. Vol. 6841. LNCS. 2011, pp. 206–221.</li>

    </ul>

    <ul class="list-disc list-inside space-y-1 text-gray-300 my-2 ml-4">

      <li>[19] G. Leander, B. Minaud, and S. Rønjom. “A Generic Approach to Invariant Subspace Attacks: Cryptanalysis of Robin, iSCREAM and Zorro”. In: EURO-CRYPT. Vol. 9056. LNCS. 2015, pp. 254–283.</li>

      <li>[20] J. R. Silvester. “Determinants of block matrices”. In: The Mathematical Gazette 84.501 (2000), pp. 460–467.</li>

      <li>[21] S. Vaudenay. “On the Lai-Massey Scheme”. In: ASIACRYPT. Vol. 1716. LNCS. 1999, pp. 8–19.</li>

      <li>[22] T. Yasuda, X. Dahan, Y.-J. Huang, T. Takagi, and K. Sakurai. “MQ challenge: hardness evaluation of solving multivariate quadratic problems”. In: (2015).</li>

    </ul>`;
---

<BaseLayout title="From Farfalle to Megafono via Ciminion: The PRF Hydra for MP... (2022/342)">
  <article class="max-w-4xl mx-auto article-prose">
    <nav class="mb-8">
      <a href="/papers" class="text-blue-400 hover:text-blue-300">
        &larr; Back to Papers
      </a>
    </nav>

    <header class="mb-12">
      <h1 class="text-3xl font-bold mb-4"
        set:html={TITLE_HTML} />
      <p class="text-gray-400 mb-2"
        set:html={AUTHORS_HTML} />
      <p class="text-gray-500 text-sm mb-4">
        2022 &middot; eprint 2022/342
      </p>
      <div class="flex gap-4 text-sm">
        <a
          href={EPRINT_URL}
          target="_blank"
          rel="noopener noreferrer"
          class="text-blue-400 hover:text-blue-300"
        >
          Paper (eprint) &rarr;
        </a>
      </div>
      <p class="mt-4 text-xs text-gray-500">
        All content below belongs to the original authors. This page
        reproduces the paper for educational purposes. Always
        <a
          href={EPRINT_URL}
          target="_blank"
          rel="noopener noreferrer"
          class="text-blue-400 hover:text-blue-300"
        >cite the original</a>.
      </p>
      <p class="mt-1 text-xs text-gray-600">
        Converted with: {CRAWLER} &middot; {CONVERTED_DATE}
      </p>
    </header>

    <Fragment set:html={CONTENT} />

  </article>
</BaseLayout>
