---
import BaseLayout from '../../layouts/BaseLayout.astro';
import PaperDisclaimer from '../../components/PaperDisclaimer.astro';
import PaperHistory from '../../components/PaperHistory.astro';

const EPRINT_URL = 'https://eprint.iacr.org/2019/622';
const CRAWLER = 'marker';
const CONVERTED_DATE = '2026-02-16';
const TITLE_HTML = 'Extended Truncated-differential Distinguishers on Round-reduced AES';
const AUTHORS_HTML = 'Zhenzhen Bao, Jian Guo, Eik List';

const CONTENT = `    <section id="abstract" class="mb-10">
      <h2 class="text-2xl font-bold">Abstract</h2>
      <p class="text-gray-300">Distinguishers on round-reduced AES have attracted considerable attention in the recent years. While the number of rounds covered in key-recovery attacks did not increase, subspace, yoyo, mixture-differential, and multiple-of-n cryptanalysis advanced the understanding of the properties of the cipher.
For substitution-permutation networks, integral attacks are a suitable target for extension since they usually end after a linear layer sums several subcomponents. Based on results by Patarin, Chen et al. already observed that the expected number of collisions for a sum of permutations differs slightly from that for a random primitive. Though, their target remained lightweight primitives.
The present work illustrates how the well-known integral distinguisher on three-round AES resembles a sum of PRPs and can be extended to truncated-differential distinguishers over 4 and 5 rounds. In contrast to previous distinguishers by Grassi et al., our approach allows to prepend a round that starts from a diagonal subspace. We demonstrate how the prepended round can be used for key recovery with a new differential key-recovery attack on six-round AES. Moreover, we show how the prepended round can also be integrated to form a six-round distinguisher. For all distinguishers and the key-recovery attack, our results are supported by implementations with Cid et al.&#x27;s established Small-AES version. While the distinguishers do not threaten the security of the AES, they try to shed more light on its properties.</p>
      <p class="text-gray-300"><strong>Keywords:</strong> cryptanalysis &middot; block cipher &middot; AES</p>
    </section>

    <section id="app-a" class="mb-10">
      <h2 class="text-2xl font-bold">A Alternative S-boxes</h2>

    <p class="text-gray-300">Inspired by the experiments from [GR18, GR19], we conducted further studies with variants of Small-AES that employed different four-bit S-boxes. Often, we considered six additional S-boxes: three real-world ciphers PRESENT [BKL <span class="math">^+</span> 07], PRINCE [BCG <span class="math">^+</span> 12], and PRIDE [ADK <span class="math">^+</span> 14], as well as three artificial constructions called Toy-6, Toy-8, and Toy-10 from [GR19]. For the sake of self-containment, the details of those S-boxes and their differential spectra are listed in Table 5. The S-box of Small-AES had been constructed in a similar manner as that of the AES, whereas the real-world examples had been selected for security and lightweight properties. The S-boxes of PRINCE and PRIDE contain one-dimensional linear structures. In this context, the x in Toy-x denotes the differential uniformity of an artificial S-box, i.e., the maximal number of pairs occurring for some differential.</p>

      <h3 id="app-b.1" class="text-xl font-semibold mt-8"><strong>B.1</strong> Five-round Multiple-of-Eight Property</h3>

    <p class="text-gray-300">Consider the five-round distinguisher from Setting (2), which takes pairs of plaintexts from  <span class="math">\\delta</span> -sets of a diagonal. This section shows briefly that this setting preserves the multiple-of-eight property of the full-diagonal distinguisher.</p>

    <p class="text-gray-300">We define a cell-mixing function  <span class="math">\\rho: \\mathbb{F}_2^m \\times \\mathbb{F}_{2^b}^m \\times \\mathbb{F}_{2^b}^m \\to \\mathbb{F}_{2^b}^m</span>  similar to that in [RBH17]. Moreover, we define  <span class="math">\\delta: \\mathbb{F}_2 \\times \\mathbb{F}_2^b \\times \\mathbb{F}_2^b \\to \\mathbb{F}_2^b</span> . Let  <span class="math">X = (X[0], \\dots X[m-1]) \\in \\mathbb{F}_2^m</span>  be a vector of m bits,  <span class="math">P_i, P_j \\in \\mathbb{F}_{2^b}^m</span>  be two arbitrary elements. Then, the mixture  <span class="math">P = \\rho(X, P_i, P_j)</span></p>

    <p class="text-gray-300"></p>

    <div class="overflow-x-auto my-4">
      <table class="min-w-full text-sm text-gray-300">
        <thead>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"></th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"><span class="math">S(\\mathtt{x})</span></th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"></th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"></th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"></th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">Differential spectra <span class="math">p_m</span></th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"></th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"></th>
        </thead>
        <tbody>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">x</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">0 1 2 3</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">4 5 6 7</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">89ab</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">c d e f</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">0 2 4 6 8 10</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Small-AES</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">6 b 5 4</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">2 e 7 a</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">9 d f c</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">3 1 0 8</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">120/225 90/225 15/225</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">PRESENT</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">c 5 6 b</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">9 0 a d</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">3 e f 8</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">4712</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">129/225 <span class="math">72/225</span> <span class="math">24/225</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">PRINCE</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">b f 3 2</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1 5 e 9</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">2 7 a c</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">e 5 d 4</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">120/225 \\ 90/225 \\ 15/225</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">PRIDE</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">0 4 8 f</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">4 5 6 7</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">8 9 a b</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">b d 6 3</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">129/225 <span class="math">72/225</span> <span class="math">24/225</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Toy-6</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1 3 6 4</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">2 5 9 a</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">0 f 7 e</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">c b d 8</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">125/225 <span class="math">81/225</span> <span class="math">18/225</span> <span class="math">1/225</span> &mdash; &mdash;</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Toy-8</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1 3 6 4</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">2 5 a c</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">0 f 7 8</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">e b d 9</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">130/225 \\ 74/225 \\ 18/225 \\ 2/225 \\ 1/225</span> &mdash;</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Toy-10</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">6 4 c 5</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">0 7 2 e</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1 f 3 d</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">8 a 9 b</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">140/225 \\ 60/225 \\ 17/225 \\ 7/225 \\ - \\ 1/225</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
        </tbody>
      </table>
    </div>

    <p class="text-gray-300">Table 5: Properties of the employed S-boxes and differential spectra.</p>

    <p class="text-gray-300">    <img src="_page_39_Figure_4.jpeg" alt="" class="my-4 max-w-full" />
</p>

    <p class="text-gray-300">Figure 10: Left: A pair that maps a single-byte difference to a four-byte difference  <span class="math">\\Delta S^1</span>  through the first round. If this pair produces a desired difference after almost five rounds, then, there exist seven further mixture pairs (e.g., one is depicted <strong>right</strong>) of the variables after the first round that have the same difference  <span class="math">\\Delta S^1</span> . Thus, they must have had the same difference before MixColumns, and therefore must also stem from &delta;-sets of the first diagonal.</p>

    <p class="text-gray-300">according to X is defined as</p>

    <p class="text-gray-300"><span class="math">$\\begin{split} \\delta(X[k], P^i[k], P^j[k]) &amp;\\stackrel{\\text{def}}{=} \\begin{cases} P^i[k] &amp; \\text{if } X = 0, \\\\ P^j[k] &amp; \\text{otherwise,} \\end{cases} \\\\ \\rho(X, P^i, P^j) &amp;\\stackrel{\\text{def}}{=} \\left( \\delta(X[0], P^i[0], P^j[0]), \\dots, \\delta(X[m-1], P^i[m-1], P^j[m-1]) \\right). \\end{split}</span>$</p>

    <p class="text-gray-300">We slightly abuse the notation, by interpreting AES states as inputs as elements of  <span class="math">\\mathbb{F}_{2^b}^{16}</span> . Moreover, we consider also non-full states but also columns or diagonals.</p>

    <p class="text-gray-300"><strong>Theorem 4.</strong> Let  <span class="math">\\mathcal{I}, \\mathcal{J} \\subset \\{0,1,2,3\\}</span>  and assume  <span class="math">|\\mathcal{I}| = |\\mathcal{J}| = 1</span> . Fix two cell indices  <span class="math">k \\in \\{0,\\ldots,15\\}</span> . Given a diagonal space  <span class="math">\\mathcal{D}_{\\mathcal{I}}</span>  and constants  <span class="math">A \\in \\mathbb{F}_{2^b}^{4\\times 4}</span> . Let  <span class="math">\\mathcal{P}</span>  denote the set of all plaintexts in a single-diagonal coset  <span class="math">P^i \\in \\mathcal{D}_{\\mathcal{I}} \\oplus A</span> , for  <span class="math">0 \\leq i &lt; 2^{4b}</span> . Let  <span class="math">\\mathcal{C}</span>  denote the set of their corresponding ciphertexts after almost five rounds without the final MixColumns operation containing  <span class="math">C^i = C^i = \\mathsf{MC}^{-1}(\\mathsf{R}^4(P^i))</span> , for  <span class="math">0 \\leq i &lt; 2^{4b}</span> . Then, the number of distinct pairs  <span class="math">(C^i, C^j)</span>  for  <span class="math">0 \\leq i &lt; j &lt; 2^{4b}</span>  such that  <span class="math">P^i \\oplus P^j</span>  differ only in a single byte and  <span class="math">(C^i \\oplus C^j)[k] = 0</span>  is a multiple of eight, i.e.,  <span class="math">\\exists N&#x27; \\in \\mathbb{N}</span>  such that</p>

    <p class="text-gray-300"><span class="math">$\\mathsf{C} \\stackrel{\\mathrm{def}}{=} \\left| \\left\\{ 0 \\leq i &lt; j &lt; 2^{4b} : P^i \\oplus P^j \\in \\mathcal{D}_{\\mathcal{I}} \\cap \\mathcal{C}_{\\mathcal{J}} \\wedge (C^i \\oplus C^j)[k] = 0 \\right\\} \\right| = 8 \\cdot N&#x27; \\,.</span>$</p>

    <p class="text-gray-300"><em>Proof.</em> Let  <span class="math">P^i</span>  and  <span class="math">P^j</span>  denote two plaintexts from a  <span class="math">\\delta</span> -set, i.e., that differ only in a single cell. W.l.o.g., we assume that they differ only in their first cell,  <span class="math">P^i[0] \\neq P^j[0]</span> . Let  <span class="math">S^i</span>  and  <span class="math">S^j</span>  denote their corresponding states after the first round, respectively.  <span class="math">P^i</span>  and  <span class="math">P^j</span>  are encrypted to  <span class="math">S^i</span>  and  <span class="math">S^j</span>  through one round, and differ in four variables due to the</p>

    <p class="text-gray-300">branch number of MixColumns. We let  <span class="math">(a_0,b_0,c_0,d_0)\\in\\mathbb{F}_{2^b}^4</span>  denote the variables of the first column of  <span class="math">S^i</span>  and  <span class="math">(a_1,b_1,c_1,d_1)\\in\\mathbb{F}_{2^b}^4</span>  denote those of  <span class="math">S^j</span> , as before. For this purpose, we also denote  <span class="math">S^i=S^{0000}</span>  and  <span class="math">S^j=S^{1111}</span> .</p>

    <p class="text-gray-300">In general, let  <span class="math">I=(i_0,i_1,i_2,i_3)\\in\\mathbb{F}_2^4</span> . We define  <span class="math">S^I=\\rho(I,S^i,S^j)</span> . For example,  <span class="math">(S^{0001},S^{1110})</span>  is a mixture of  <span class="math">(S^{0000},S^{1111})</span> , which also differs only in the same column, in the sense that the leftmost column of  <span class="math">S^{0001}</span>  consists of the values  <span class="math">(a_0,b_0,c_0,d_1)</span> , and that of  <span class="math">S^{1110}</span>  of  <span class="math">(a_1,b_1,c_1,d_0)</span> . All other columns are equal in them and equal with the corresponding columns of  <span class="math">S^{0000}</span>  and  <span class="math">S^{1111}</span> ). We extend the definitions in the natural manner to</p>

    <p class="text-gray-300"><span class="math">$(S^{0010},S^{1101}),(S^{0011},S^{1100}),(S^{0100},S^{1011}),\\\\(S^{0101},S^{1010}),(S^{0110},S^{1001}),(S^{0111},S^{1000}).</span>$</p>

    <p class="text-gray-300">Note that for each of those eight mixtures, the difference between their pair after the first round is the same. Since  <span class="math">\\mathsf{SR}^{-1} \\circ \\mathsf{MC}^{-1} \\circ \\mathsf{AK}[K^1]</span>  is linear, this means that their difference  <span class="math">S^{i_0i_1i_2i_3}_{\\mathsf{SB}} \\oplus S^{i&#x27;_0i&#x27;_1i&#x27;_2i&#x27;_3}_{\\mathsf{SB}}</span>  is the same for each pair. Since  <span class="math">S^{0000}_{\\mathsf{SB}} \\oplus S^{1111}_{\\mathsf{SB}}</span>  is active in a single (the first) cell, so is each pair of all other seven mixtures. Hence, they are all guaranteed to be in  <span class="math">\\delta</span> -sets. Since  <span class="math">\\mathsf{AK}[K^0] \\circ \\mathsf{SB}^{-1}</span>  is a permutation, they are guaranteed to be sixteen distinct texts. Though, note that the values  <span class="math">S^1</span>  differ in less than four bytes between each text of each pair. Thus, each of the eight pairs in a mixture is produced by a <strong>different</strong>  <span class="math">\\delta</span> -set</p>

    <p class="text-gray-300">It remains to show that if one pair of an eight-tuple of mixtures has an inactive diagonal after three rounds, the other seven mixture pairs also have. We denote by  <span class="math">C^i</span>  the encryption of  <span class="math">P^i</span>  after four rounds of AES without the final MixColumns operation. Assume,  <span class="math">C_{0000}</span>  and  <span class="math">C_{1111}</span>  lie in the coset of an inverse-diagonal space  <span class="math">\\mathcal{ID}_{\\mathcal{I}}</span> , for  <span class="math">\\mathcal{I} \\subset \\{0,1,2,3\\}</span>  and  <span class="math">|\\mathcal{I}| &lt; 4</span> . Then, the differences of the seven further pairs</p>

    <p class="text-gray-300"><span class="math">$(C_{0001} \\oplus C_{1110}), (C_{0010} \\oplus C_{1101}), (C_{0011} \\oplus C_{1100}), (C_{0100} \\oplus C_{1011}), (C_{0101} \\oplus C_{1010}), (C_{0110} \\oplus C_{1001}), (C_{0111} \\oplus C_{1011})</span>$</p>

    <p class="text-gray-300">lie also in  <span class="math">\\mathcal{ID}_{\\mathcal{I}}</span> . Though, this is exactly the well-known multiple-of-eight property that has already been shown by Grassi et al. in [GRR17]. Therefore, the multiple-of-eight property of our distinguisher in Setting (2) follows.</p>

      <h3 id="app-b.2" class="text-xl font-semibold mt-8">B.2 Four-round Multiple-of-32 Property for Small-AES</h3>

    <p class="text-gray-300">Consider the four-round distinguisher in Setting (2), which takes pairs of plaintexts from  <span class="math">\\delta</span> -sets of a diagonal. This section outlines briefly that the distinguisher in this setting possesses a multiple-of-32 property.</p>

    <p class="text-gray-300">Note the peaked plots that represent the experimental distribution in Setting (2) in Figure 15. Those peaks (can only) indicate that the number of collisions are a multiple of 32, e.g., the first ten random keys and  <span class="math">\\delta</span> -sets for the Small-AES yield the sequence of collisions: (123 456, 123 040, 120 512, 120 736, 123 744, 121 504, 122 368, 120 896, 123 136, 123 808). This phenomenon repeated for the other S-boxes as well, though, not for the AES with eight-bit S-boxes. 32 is also the largest power of two, e.g., the number of collisions is no multiple of 64 in general.</p>

    <p class="text-gray-300">Clearly, the number of collisions has to be a multiple of eight since our four-round distinguisher can be seen as a subset of the five-round distinguisher that we studied in Section B.1. Our five-round distinguisher itself inherited that property from the well-known multiple-of-eight distinguisher by Grassi and Rechberger [GRR17]. Given that the other S-boxes yield similar results, we conjecture that there exists an additional multiple-of-four property for the AES when operating with four-bit S-boxes. Thus, we state the following claim, but cannot prove it at the moment.</p>

    <p class="text-gray-300">Claim. Let  <span class="math">\\mathcal{I}, \\mathcal{J} \\subset \\{0, 1, 2, 3\\}</span>  and assume  <span class="math">|\\mathcal{I}| = |\\mathcal{J}| = 1</span> . Fix a cell index  <span class="math">k \\in \\{0, \\dots, 15\\}</span> . Given a coset of  <span class="math">\\mathcal{D}_{\\mathcal{I}}</span>  containing all  <span class="math">2^{4b}</span>  plaintexts of a diagonal and their corresponding ciphertexts after four rounds  <span class="math">(P^i, C^i)</span>  with  <span class="math">i \\in \\{0, \\dots, 2^{4b} - 1\\}</span>  and  <span class="math">C^i = \\mathsf{MC}^{-1}(\\mathsf{R}^4(P^i))</span> , that is after four rounds of AES with the final MixColumns operation omitted. Then, the number of distinct pairs  <span class="math">(C^i, C^j)</span>  for  <span class="math">i \\neq j</span>  and  <span class="math">0 \\leq i &lt; j &lt; 2^{4b}</span>  such that  <span class="math">P^i \\oplus P^j</span>  differ only in a single byte and  <span class="math">(C^i \\oplus C^j)[k] = 0</span>  is a multiple of 32, i.e.,  <span class="math">\\exists N&#x27; \\in \\mathbb{N}</span>  such that</p>

    <p class="text-gray-300"><span class="math">$\\mathsf{C} \\stackrel{\\mathrm{def}}{=} \\left| \\left\\{ 0 \\leq i &lt; j &lt; 2^{4b} : P^i \\oplus P^j \\in \\mathcal{D}_{\\mathcal{I}} \\cap \\mathcal{C}_{\\mathcal{J}} \\wedge (C^i \\oplus C^j)[k] = 0 \\right\\} \\right| = 32 \\cdot N&#x27; \\,.</span>$</p>

    <p class="text-gray-300"><strong>Four-round Distinguisher.</strong> It is straight-forward to formulate a distinguisher from the multiple-of-32 property with the following steps:</p>

    <ul class="list-disc list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li><ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li>Initialize  <span class="math">16 \\times 16</span>  collision counters  <span class="math">X_{i,j}</span>  for each byte and each value.</li>
    </ol></li>
      <li><ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li>Collect a structure S of  <span class="math">2^{16}</span>  texts that iterate over all  <span class="math">\\delta</span> -sets of a diagonal, e.g., using texts from  <span class="math">\\mathcal{D}_{\\{0\\}} \\oplus A</span>  for arbitrary  <span class="math">A \\in \\mathbb{F}_{2^4}^{4 \\times 4}</span> , and leave the remaining bytes constants. Query the plaintexts of a structure and ask for their ciphertexts.</li>
    </ol></li>
      <li><ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li>For each ciphertext, invert the final MixColumns operations to get the states  <span class="math">S^{4,SR}</span> . Increment its value j for Byte i, for  <span class="math">i \\in \\{0, \\ldots, 15\\}</span> , in  <span class="math">X_{i,j}</span> .</li>
    </ol></li>
      <li><ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li>For each byte  <span class="math">i \\in \\{0, \\dots, 15\\}</span> , test if  <span class="math">(\\sum_{j=0}^{15} {X_{i,j} \\choose 2}) \\mod 32 = 0</span> . If yes, return &quot;real&quot;; return &quot;random&quot; otherwise.</li>
    </ol></li>
    </ul>

    <p class="text-gray-300"><strong>Complexity.</strong> The distinguisher requires  <span class="math">2^{16}</span>  chosen plaintexts,  <span class="math">2^{16}</span>  encryptions and  <span class="math">2^{16} \\cdot 16 = 2^{20}</span>  memory accesses. The success probability is one for the real construction; the probability is  <span class="math">(2^{-5})^{16} = 2^{-80}</span>  to wrongly identify a random permutation as the real four-round Small-AES. The memory is negligible, 256 16-bit values or  <span class="math">2^6</span>  states of memory plus some constant overhead suffices.</p>

    <p class="text-gray-300">Alternative MixColumns Matrices. We further tested whether the multiple-of-k property depends on the employed MixColumns matrix. We denote circulant matrices by the elements of their topmost row  <span class="math">\\operatorname{circ}(a_1,\\ldots,a_m)</span> , e.g., the MixColumns matrix can be described as  <span class="math">\\operatorname{circ}(2,3,1,1)</span> . We employed variants of Small-AES with alternative MixColumns matrices and for comparison with different S-box:</p>

    <ul class="list-disc list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li>Small-AES with its original S-box and the circulant matrix generated by circ(1,3,2,2). This is also an MDS matrix.</li>
      <li>Small-AES with its original S-box and the matrix generated by circ(0,1,1,1) from Midori, which is not MDS.</li>
      <li>Small-AES with the S-box of PRESENT and the circulant matrix generated by circ(1,3,2,2).</li>
      <li>Small-AES with the S-box of PRESENT and the matrix circ(0, 1, 1, 1).</li>
    </ul>

    <p class="text-gray-300">All other components remained unchanged. Table 6 visualizes our results and compares the result with the original matrix. It illustrates that the multiple-of-k property depends strongly on the employed MixColumns matrix; the variants with the Midori matrix yielded even a multiple-of-16 384 property. The variance differs greatly as a direct consequence.</p>

    <p class="text-gray-300"><strong>Table 6:</strong> Means, standard deviations, and maximal k for multiple-of-k for the number of collisions in at least one anti-diagonal after four rounds of 100 000 experiments with random key each of  <span class="math">2^{16}</span>  texts from a full single-diagonal space. k is the maximum factor.</p>

    <div class="overflow-x-auto my-4">
      <table class="min-w-full text-sm text-gray-300">
        <thead>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">S-box</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">MC Matrix</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"><span class="math">\\mu</span></th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">&sigma;</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">k</th>
        </thead>
        <tbody>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Small-AES</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">circ(2, 3, 1, 1)</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">122 921.676</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1 329.731</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">2^{5}</span></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Small-AES</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">circ(1,3,2,2)</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">122946.734</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1347.866</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">2^5</span></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Small-AES</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">circ(0,1,1,1)</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">123980.022</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">47151.760</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">2^{14}</span></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">PRESENT</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">circ(2, 3, 1, 1)</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">122 908.033</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1 209.539</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">2^5</span></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">PRESENT</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">circ(1,3,2,2)</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">122911.852</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1226.596</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">2^5</span></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">PRESENT</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">circ(\\mathtt{0},\\mathtt{1},\\mathtt{1},\\mathtt{1})</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">124763.341</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">47429.148</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">2^{14}</span></td>
          </tr>
        </tbody>
      </table>
    </div>

    <p class="text-gray-300">Let  <span class="math">\\mathcal{S}</span>  be a structure that iterates over all  <span class="math">2^{16}</span>  values of one diagonal space of Small-AES and fixes all other cells to a constant. Then, after four rounds, the number of pairs that collide in any fixed byte is a multiple of four. This implies that, after five rounds without the final MixColumns operation (or inverted), the number of pairs that collide in any fixed byte is a multiple of four. This property is absent in the real AES with eight-bit S-boxes; it seems independent, however, from the S-box. It has been found also when using e.g., in variants of Small-AES with the S-boxes of PRESENT or Toy-10.</p>

    <p class="text-gray-300">Five-round Distinguisher. The distinguisher is depicted in Figure 11.</p>

    <p class="text-gray-300"><strong>Steps.</strong> The steps of our distinguisher are as follows:</p>

    <ul class="list-disc list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li><ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li>Initialize  <span class="math">16 \\times 16</span>  collision counters  <span class="math">X_{i,j}</span>  for each byte and each value.</li>
    </ol></li>
      <li><ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li>Collect a structure S of  <span class="math">2^{16}</span>  texts that iterate over all values in four cells of a diagonal, e.g., using texts from  <span class="math">\\mathcal{D}_{\\{0\\}} \\oplus A</span>  for arbitrary  <span class="math">A \\in \\mathbb{F}_{2^4}^{4 \\times 4}</span> , and leave the remaining bytes constants. Query the plaintexts of a structure and ask for their ciphertexts.</li>
    </ol></li>
      <li><ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li>For each ciphertext, invert the final MixColumns operations to get the states  <span class="math">S^{5,SR}</span> . Increment its value j for Byte i, for  <span class="math">i \\in \\{0, \\ldots, 15\\}</span> , in  <span class="math">X_{i,j}</span> .</li>
    </ol></li>
      <li><ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li>For each byte  <span class="math">i \\in \\{0, \\dots, 15\\}</span> , test if  <span class="math">(\\sum_{j=0}^{15} {X_{i,j} \\choose 2}) \\mod 4 = 0</span> . If yes, return real; return random otherwise.</li>
    </ol></li>
    </ul>

    <p class="text-gray-300"><strong>Complexity.</strong> The distinguisher requires  <span class="math">2^{16}</span>  chosen plaintexts,  <span class="math">2^{16}</span>  encryptions and  <span class="math">2^{16} \\cdot 16 = 2^{20}</span>  memory accesses. The success probability is one for the real construction; the probability is  <span class="math">(2^{-2})^{16} = 2^{-32}</span>  to wrongly identify a random permutation as the real fiveround Small-AES. The memory is negligible, 256 16-bit values or  <span class="math">2^6</span>  states of memory plus some constant overhead suffices.</p>

      <h3 id="app-b.4" class="text-xl font-semibold mt-8">B.4 Multiple-of-four Key-recovery Attack on Six-round Small-AES</h3>

    <p class="text-gray-300">The five-round distinguisher can be extended to a six-round key-recovery attack in a straight-forward manner.</p>

    <p class="text-gray-300"><strong>Steps.</strong> The steps are as follows:</p>

    <p class="text-gray-300">    <img src="_page_43_Figure_2.jpeg" alt="" class="my-4 max-w-full" />
</p>

    <p class="text-gray-300">Figure 11: Multiple-of-four distinguisher on five-round Small-AES (left), and the key-recovery attack on six rounds (right).</p>

    <ul class="list-disc list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li><ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li>Initialize  <span class="math">4 \\cdot 2^{16} \\cdot 16 \\times 16</span>  collision counters  <span class="math">X_{i,j}</span>  for each candidate of  <span class="math">K^6[0,7,10,13]</span> ,  <span class="math">K^6[3,4,9,14]</span> ,  <span class="math">K^6[2,7,8,13]</span> ,  <span class="math">K^6[1,6,11,12]</span> , each byte, and each byte value. Initialize four lists  <span class="math">\\mathcal{K}_{\\ell}</span> , for  <span class="math">\\ell \\in \\{0,1,2,3\\}</span> .</li>
    </ol></li>
      <li><ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li>Collect a structure  <span class="math">\\mathcal{S}</span>  of  <span class="math">2^{16}</span>  texts that iterate over all values in four cells of a diagonal, e.g., using texts from  <span class="math">\\mathcal{D}_{\\{0\\}} \\oplus A</span>  for arbitrary  <span class="math">A \\in \\mathbb{F}_{2^4}^{4 \\times 4}</span> , and leave the remaining bytes constants. Query the plaintexts of a structure and ask for their ciphertexts.</li>
    </ol></li>
      <li><ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li>For each candidate of  <span class="math">K^6[0, 7, 10, 13]</span> :</li>
    </ol>

    <ul class="list-disc list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li>3.1 For each ciphertext, decrypt to the state  <span class="math">\\widehat{S}^{5,\\mathsf{SR}}[0,1,2,3]</span>  and increment its value j for Byte i, for  <span class="math">i \\in \\{0,\\ldots,15\\}</span> , in  <span class="math">X_{i,j}</span> .</li>
      <li>3.2 For each counter, test if  <span class="math">\\binom{X_{i,j}}{2} \\mod 4 = 0</span> , for  <span class="math">i \\in \\{0,1,2,3\\}</span> . If yes, add the surviving inverse-diagonal key candidate to list  <span class="math">\\mathcal{K}_0</span> .</li>
      <li>3.3 Repeat the same procedure for the other inverse diagonals of  <span class="math">K^6</span>  and add the surviving lists  <span class="math">\\mathcal{K}_{\\ell}</span>  for the corresponding values of  <span class="math">\\ell</span> .</li>
    </ul></li>
      <li><ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li>Test the remaining key candidates.</li>
    </ol></li>
    </ul>

    <p class="text-gray-300"><strong>Complexity.</strong> The distinguisher requires  <span class="math">2^{16}</span>  chosen plaintexts,  <span class="math">2^{16}</span>  encryptions, and  <span class="math">2^{16} \\cdot 2^{16} \\cdot 4 \\cdot \\frac{1}{4} \\cdot \\frac{1}{6}</span>  decryptions of one column through one of six rounds for each of four anti-diagonal key candidate and each of  <span class="math">2^{16}</span>  texts. This yields  <span class="math">2^{29.415}</span>  encryption equivalents. Each value of each inverse diagonal of the key has a chance of  <span class="math">2^{16} \\cdot (2^{-2})^4 = 2^{-8}</span>  to survive. Thus, we can expect about  <span class="math">2^{4\\cdot 8} = 2^{32}</span>  key candidates that can be tested with an exhaustive</p>

    <p class="text-gray-300">    <img src="_page_44_Figure_2.jpeg" alt="" class="my-4 max-w-full" />
</p>

    <p class="text-gray-300"><strong>Figure 12:</strong> Distribution of the number of collisions in the first byte after five rounds in both settings, with the final MixColumns operation omitted. Both distributions used 100 000 random keys and counted the collisions from  <span class="math">2^{14}</span>   <span class="math">\\delta</span> -sets per key that were independent in Setting (1) or the  <span class="math">2^{14}</span>   <span class="math">\\delta</span> -sets from  <span class="math">\\mathcal{D}_{\\{0\\}}</span> . Thin lines are fitted normal distributions, thick lines the best fitted distributions.</p>

    <p class="text-gray-300">    <img src="_page_44_Figure_4.jpeg" alt="" class="my-4 max-w-full" />
</p>

    <p class="text-gray-300"><strong>Figure 13:</strong> Distribution of the number of collisions in the first byte after five rounds taking all  <span class="math">\\binom{2^{16}}{2}</span>  pairs from a single plaintext diagonal. All distributions used 100 000 random keys and counted the collisions for one diagonal per key. Thin lines are fitted normal distributions, thick lines the best fitted distributions.</p>

    <p class="text-gray-300">search. Thus, the computational complexity is upper bounded by  <span class="math">2^{32} + 2^{29.415} \\simeq 2^{32.223}</span>  Encryptions. The attack needs  <span class="math">4 \\cdot 2^{16} \\cdot 16 \\cdot 16 = 2^{26}</span>  memory accesses. The memory is  <span class="math">4 \\cdot 2^{16} \\cdot 16 \\cdot 16 = 2^{26}</span>  64-bit values or states, and  <span class="math">4 \\cdot 2^8 = 2^{10}</span>  values for the key candidates. We note that the time complexity of the attack can be decreased further with the meet-in-the-middle technique by Sasaki and Wang [SW12] that was adapted by Bar-On et al. to attacks on final-round AES [BODK+18] to about  <span class="math">2^{16} \\cdot 2 \\cdot 2^8 \\simeq 2^{25}</span>  last-round decryptions. However, the property is the relevant thing in this section, and we provide a distinguisher and key-recovery attack only for the sake of completeness.</p>

    <p class="text-gray-300">This section shows Theorem 2 in Setting (2). It is rooted on the existing rigorous study by Grassi and Rechberger [GR18] of the number of solutions for the transition of pairs in a mixed space  <span class="math">\\mathcal{M}_{\\{k\\}}</span>  to a diagonal space  <span class="math">\\mathcal{D}_{\\mathcal{J}}</span>  with  <span class="math">\\mathcal{J} \\subset \\{0,1,2,3\\}</span>  and  <span class="math">|\\mathcal{J}| = 3</span> .</p>

    <p class="text-gray-300"><strong>Notation.</strong> The subspace notation does not always express easily that certain cells are zero or not. Therefore, we can adapt the notation by [RBH17]. Though, we use the active-byte pattern, whereas the work by [RBH17] employs the zero-byte pattern convention. We decide for the former only since it is more intuitive that the hamming weight represents the number of active cells from our point of view.</p>

    <p class="text-gray-300">We use bit vectors  <span class="math">\\mathbf{u}=(u_0,u_1,u_2,u_3)</span>  and  <span class="math">\\mathbf{v}=(v_0,v_1,v_2,v_3)</span>  with  <span class="math">\\mathbf{u},\\mathbf{v}\\in\\mathbb{F}_2^4</span>  to represent the active-byte patterns of a column or diagonal. For a column or diagonal vector  <span class="math">\\mathbf{x}=(x_0,x_1,x_2,x_3)\\in\\mathbb{F}_{2^8}^4</span> , we further define the function  <span class="math">\\rho:\\mathbb{F}_{2^8}^4\\to\\mathbb{F}_2^4</span>  to map  <span class="math">\\mathbf{x}</span>  to its active-byte pattern:  <span class="math">\\mathbf{u}=(u_0,u_1,u_2,u_3)=\\rho((x_0,x_1,x_2,x_3)),</span>  where  <span class="math">u_i=1</span>  iff  <span class="math">x_i</span>  is active and 0 otherwise. For a state  <span class="math">S\\in\\mathbb{F}_{2^8}^{4\\times 4}</span> , we define  <span class="math">\\nu:\\mathbb{F}_{2^8}^{4\\times 4}\\to\\mathbb{F}_2^{4\\times 4}</span>  to produce its active-column pattern:</p>

    <p class="text-gray-300"><span class="math">$\\nu(S) \\stackrel{\\text{def}}{=} (\\rho(S_0), \\rho(S_1), \\rho(S_2), \\rho(S_3)).</span>$</p>

    <p class="text-gray-300">Thus, we search for all pairs  <span class="math">\\mathbf{u} \\xrightarrow{\\mathsf{R}} \\mathbf{v}</span>  with  <span class="math">\\mathsf{wt}(\\mathbf{u}) &gt; 1</span>  and  <span class="math">\\mathsf{wt}(\\mathbf{v}) = 4</span> . Below, we briefly restate Theorem 2 for readability.</p>

    <p class="text-gray-300"><strong>Theorem 2.</strong> Let  <span class="math">\\mathcal{X} = \\{X^i \\in \\mathbb{F}_{2^8}^{4 \\times 4}\\}</span> , for  <span class="math">0 \\leq i &lt; 2^{32}</span> , denote a set of all texts in a coset  <span class="math">\\mathcal{M}_{\\{k\\}} \\oplus A</span>  for some  <span class="math">A \\in \\mathbb{F}_{2^8}^{4 \\times 4}</span> ,  <span class="math">A \\in \\mathcal{X}^{\\perp}</span> , where all columns are active. Let  <span class="math">\\mathcal{Y} = \\{Y^i \\in \\mathbb{F}_{2^8}^{4 \\times 4} : Y^i = \\mathsf{R}(X^i)\\}</span> ,  <span class="math">0 \\leq i &lt; 2^{32}</span> , denote the set of corresponding outputs after one round of AES. Let Y be a random variable for the number of different unordered ciphertext pairs  <span class="math">(Y^i, Y^j)</span>  s. t.  <span class="math">Y^i, Y^j \\in \\mathcal{D}_{\\mathcal{J}} \\oplus B</span> , for some  <span class="math">B \\in \\mathbb{F}_{2^8}^{4 \\times 4}</span> ,  <span class="math">\\mathcal{J} \\subset \\{0, 1, 2, 3\\}</span> , and  <span class="math">|\\mathcal{J}| = 3</span> . Then, under the assumption of the uniform distribution of non-trivial solutions of differential transitions through the S-box,</p>

    <p class="text-gray-300"><span class="math">$\\Pr\\left[\\mathcal{M}_{\\{k\\}} \\oplus A \\xrightarrow{\\mathsf{R}} \\mathcal{D}_{\\mathcal{J}} \\oplus B\\right] \\simeq 2^{-30} + 2^{-51.985}</span>$
.</p>

    <p class="text-gray-300">The analysis of Theorem 2 employs two Lemmas. Lemma 1 reconsiders the number of solutions, Lemma 2 the fraction of solutions that start from a single active byte.</p>

    <p class="text-gray-300"><strong>Lemma 1.</strong> Under the assumption of the uniform distribution of non-trivial solutions of differential transitions through the S-box, the number of solutions from a mixed space with no equal generating variables is approximately  <span class="math">2\\,114\\,125\\,822.5 \\simeq 2^{30.977}</span> .</p>

    <p class="text-gray-300"><em>Proof.</em> The proof of Lemma 1 is given from the third case of the proof of Theorem 2 by Grassi and Rechberger [GR19, Sect. 5.3.3]. We restate it only for the sake of completeness. In the following, we consider  <span class="math">\\mathcal{J}=\\{1,2,3\\}</span>  as the set of active diagonals after the round, or  <span class="math">\\ell=0</span>  as the index of the zero-difference diagonal after the round. the cases for other values of  <span class="math">\\ell</span>  are analogous. We denote  <span class="math">X^1, X^2 \\in \\mathcal{M}_{\\{k\\}} \\oplus A</span> . Then, there exist  <span class="math">x^i, y^i, z^i, w^i \\in \\mathbb{F}_{2^8}</span> , for  <span class="math">1 \\leq i \\leq 2</span> , s. t.</p>

    <p class="text-gray-300"><span class="math">$X^i = \\begin{bmatrix} 2x^i &amp; w^i &amp; z^i &amp; 3y^i \\\\ x^i &amp; w^i &amp; 3z^i &amp; 2y^i \\\\ x^i &amp; 3w^i &amp; 2z^i &amp; y^i \\\\ 3x^i &amp; 2w^i &amp; z^i &amp; y^i \\end{bmatrix} \\oplus A \\,.</span>$</p>

    <p class="text-gray-300">In the context here, all variables are distinct, i.e.  <span class="math">x^1 \\neq x^2</span> ,  <span class="math">y^1 \\neq y^2</span> ,  <span class="math">z^1 \\neq z^2</span> , and  <span class="math">w^1 \\neq w^2</span> . Let  <span class="math">\\Delta Y = Y^1 \\oplus Y^2</span> . We consider the following four equations:</p>

    <p class="text-gray-300"><span class="math">$\\Delta Y[0] = \\bigoplus_{i=1}^{2} 2S \\left(2x^{i} \\oplus A[0]\\right) \\oplus 3S \\left(w^{i} \\oplus A[5]\\right) \\oplus S \\left(2z^{i} \\oplus A[10]\\right) \\oplus S \\left(y^{i} \\oplus A[15]\\right) = 0</span>$</p>

    <p class="text-gray-300"><span class="math">$(14)</span>$</p>

    <p class="text-gray-300"><span class="math">$\\Delta Y[5] = \\bigoplus_{i=1}^{2} S \\left(w^{i} \\oplus A[4]\\right) \\oplus 2S \\left(3z^{i} \\oplus A[9]\\right) \\oplus 3S \\left(y^{i} \\oplus A[14]\\right) \\oplus S \\left(3x^{i} \\oplus A[3]\\right) = 0</span>$</p>

    <p class="text-gray-300"><span class="math">$\\Delta Y[10] = \\bigoplus_{i=1}^{2} S \\left(z^{i} \\oplus A[8]\\right) \\oplus S \\left(2y^{i} \\oplus A[13]\\right) \\oplus 2S \\left(x^{i} \\oplus A[2]\\right) \\oplus 3S \\left(2w^{i} \\oplus A[7]\\right) = 0</span>$</p>

    <p class="text-gray-300"><span class="math">$\\Delta Y[15] = \\bigoplus_{i=1}^{2} 3S \\left(3y^{i} \\oplus A[12]\\right) \\oplus S \\left(x^{i} \\oplus A[1]\\right) \\oplus S \\left(3w^{i} \\oplus A[6]\\right) \\oplus 2S \\left(z^{i} \\oplus A[11]\\right) = 0.</span>$</p>

    <p class="text-gray-300">All four equations possess a form of</p>

    <p class="text-gray-300"><span class="math">$\\bigoplus_{i=1}^{2} A \\cdot S\\left(B \\cdot x^{i} \\oplus b\\right) \\oplus C \\cdot S\\left(D \\cdot w^{i} \\oplus d\\right) \\oplus E \\cdot S\\left(F \\cdot z^{i} \\oplus f\\right) \\oplus G \\cdot S\\left(H \\cdot y^{i} \\oplus h\\right) = 0.</span>$</p>

    <p class="text-gray-300">We rewrite  <span class="math">\\widehat{x}=B\\cdot x^i\\oplus b</span> ,  <span class="math">\\widehat{w}=D\\cdot w^i\\oplus d</span> ,  <span class="math">\\widehat{z}=F\\cdot z^i\\oplus f</span> , and  <span class="math">\\widehat{y}=H\\cdot y^i\\oplus h</span> . We denote the input differences between the variable pairs as  <span class="math">\\Delta^x_I=x^1\\oplus x^2</span> , and  <span class="math">\\Delta^y_I=y^1\\oplus y^2</span> ,  <span class="math">\\Delta^z_I=z^1\\oplus z^2</span> , and  <span class="math">\\Delta^w_I=w^1\\oplus w^2</span> . We can reformulate the equation systems to</p>

    <p class="text-gray-300">
<span class="math">$\\begin{split} S\\left(\\widehat{x}\\right) \\oplus S\\left(\\widehat{x} \\oplus \\Delta_{I}^{x}\\right) &amp;= \\Delta_{O}^{x} \\\\ S\\left(\\widehat{w}\\right) \\oplus S\\left(\\widehat{w} \\oplus \\Delta_{I}^{w}\\right) &amp;= \\Delta_{O}^{w} \\\\ S\\left(\\widehat{z}\\right) \\oplus S\\left(\\widehat{z} \\oplus \\Delta_{I}^{z}\\right) &amp;= \\Delta_{O}^{z} \\\\ S\\left(\\widehat{y}\\right) \\oplus S\\left(\\widehat{y} \\oplus \\Delta_{I}^{y}\\right) &amp;= \\Delta_{O}^{y} \\end{split}</span>$</p>

    <p class="text-gray-300">From  <span class="math">\\Delta_I^x</span> ,  <span class="math">\\Delta_I^w</span> ,  <span class="math">\\Delta_I^z</span> ,  <span class="math">\\Delta_I^y \\neq 0</span> , it follows that  <span class="math">\\Delta_O^x</span> ,  <span class="math">\\Delta_O^w</span> ,  <span class="math">\\Delta_O^z</span> ,  <span class="math">\\Delta_O^y \\neq 0</span> . Moreover, one variable is defined from the equation system of the others as</p>

    <p class="text-gray-300"><span class="math">$\\Delta_O^y = G^{-1} \\cdot (A \\cdot \\Delta_O^x \\oplus C \\cdot \\Delta_O^w \\oplus E \\cdot \\Delta_O^z) \\ .</span>$</p>

    <p class="text-gray-300">Since they cannot be zero, there exist in total  <span class="math">255^3</span>  solutions for  <span class="math">\\Delta_O^x</span> ,  <span class="math">\\Delta_O^w</span> ,  <span class="math">\\Delta_O^z</span> . Though, having fixed  <span class="math">\\Delta_O^x</span> ,  <span class="math">255 \\cdot 254</span>  pairs  <span class="math">\\Delta_O^w</span> ,  <span class="math">\\Delta_O^z</span>  solutions would lead to  <span class="math">\\Delta_O^y = 0</span> . So, there are  <span class="math">255^3 - 255 \\cdot 254</span>  possible tuples  <span class="math">(\\Delta_O^x, \\Delta_O^w, \\Delta_O^z, \\Delta_O^y)</span> . The next step is to obtain the number of different non-trivial solutions  <span class="math">[(x^1, y^1, z^1, w^1), (x^2, y^2, z^2, w^2)]</span>  to the four equations from Equation (14). For  <span class="math">\\Delta_I, \\Delta_O \\in \\mathbb{F}_2^8</span> , we denote the number of solutions by</p>

    <p class="text-gray-300"><span class="math">$\\delta_S(\\Delta_I, \\Delta_O) \\stackrel{\\text{def}}{=} |\\{x \\in \\mathbb{F}_2^n : S(x) \\oplus S(x \\oplus \\Delta_I) = \\Delta_O\\}| .</span>$</p>

    <p class="text-gray-300">Independently of the S-box details, the expected number of solutions x for arbitrary non-zero input-output differences  <span class="math">(\\Delta_I, \\Delta_O)</span>  is simply the mean over all non-zero columns or rows in the DDT:</p>

    <p class="text-gray-300"><span class="math">$\\mathbb{E}\\left[\\delta_S(\\Delta_I, \\Delta_O)\\right] = \\frac{256}{255}.</span>$</p>

    <p class="text-gray-300">Given a fixed  <span class="math">\\Delta_I</span> , the average number of solutions for one equation is 256/255. There exist 255 values of  <span class="math">\\Delta_I</span> , and four pairs  <span class="math">(\\Delta_I^x, \\Delta_O^x), \\ldots, (\\Delta_I^y, \\Delta_O^y)</span> , which yields</p>

    <p class="text-gray-300"><span class="math">$\\left(255 \\cdot \\frac{256}{255}\\right)^4 = 2^{32}</span>$</p>

    <p class="text-gray-300"></p>

    <p class="text-gray-300">solutions of values  <span class="math">(x^1,y^1,z^1,w^1), (x^2,y^2,z^2,w^2)</span>  for fixed differences  <span class="math">(\\Delta_I^x,\\Delta_I^y,\\Delta_I^z,\\Delta_I^w)</span>  on average. To prevent double counting solutions  <span class="math">[(x^1,y^1,z^1,w^1),(x^2,y^2,z^2,w^2)]</span>  and  <span class="math">[(x^2,y^2,z^2,w^2),(x^1,y^1,z^1,w^1)]</span> , we employ a partial order, e.g., require that  <span class="math">w^1 &lt; w^2</span> . The total number of different solutions  <span class="math">(x^1,y^1,z^1,w^1),(x^2,y^2,z^2,w^2)</span> , for the order  <span class="math">w^1 &lt; w^2</span> , to the four Equations 14 is then given by</p>

    <p class="text-gray-300"><span class="math">$\\frac{1}{2} \\cdot \\left(255^3 - 255 \\cdot 254\\right) \\cdot \\left(255 \\cdot \\frac{256}{255}\\right)^4 = \\left(255^3 - 255 \\cdot 254\\right) \\cdot 2^{31}.</span>$</p>

    <p class="text-gray-300">So, we have the number of solutions for one (arbitrary equation) of the four equations in Equation 14. Next, we have to determine the probability that the solutions for the remaining three equations match the fixed equation. Fix  <span class="math">[(x^1, y^1, z^1, w^1), (x^2, y^2, z^2, w^2)]</span>  for the first equation. Consider a second equation  <span class="math">[(\\hat{x}^1, \\hat{y}^1, \\hat{z}^1, \\hat{w}^1), (\\hat{x}^2, \\hat{y}^2, \\hat{z}^2, \\hat{w}^2)]</span> . The probability that  <span class="math">(x^1, y^1, z^1, w^1) = (\\hat{x}^1, \\hat{y}^1, \\hat{z}^1, \\hat{w}^1)</span>  is</p>

    <p class="text-gray-300"><span class="math">$\\left(\\frac{1}{256}\\right)^4</span>$
.</p>

    <p class="text-gray-300">Having fixed  <span class="math">(x^1,\\,y^1,\\,z^1,\\,w^1)</span> , there remain only 255 possible values for  <span class="math">x^2</span>  and  <span class="math">\\widehat{x}^2</span>  since they must be distinct. So, the probability that  <span class="math">(x^2,\\,y^2,\\,z^2,\\,w^2)=(\\widehat{x}^2,\\,\\widehat{y}^2,\\,\\widehat{z}^2,\\,\\widehat{w}^2)</span>  is  <span class="math">1/255^4</span> . The same can apply if  <span class="math">(x^1,\\,y^1,\\,z^1,\\,w^1)=(\\widehat{x}^2,\\,\\widehat{y}^2,\\,\\widehat{z}^2,\\,\\widehat{w}^2)</span>  and  <span class="math">(x^2,\\,y^2,\\,z^2,\\,w^2)=(\\widehat{x}^1,\\,\\widehat{y}^1,\\,\\widehat{z}^1,\\,\\widehat{w}^1)</span> . So, there are two ways to combine each pair of equations. Thus, the probability that two equations are equal is</p>

    <p class="text-gray-300"><span class="math">$2 \\cdot \\left(\\frac{1}{256}\\right)^4 \\cdot \\left(\\frac{1}{255}\\right)^4. \\tag{15}</span>$</p>

    <p class="text-gray-300">We obtain that</p>

    <p class="text-gray-300"><span class="math">$\\left( \\left( 255^3 - 255 \\cdot 254 \\right) \\cdot 2^{31} \\right)^4 \\cdot \\left( 2 \\cdot \\left( \\frac{1}{256} \\right)^4 \\cdot \\left( \\frac{1}{255} \\right)^4 \\right)^3 \\simeq 2114125822.5 \\simeq 2^{30.977}, \\quad (16)</span>$</p>

    <p class="text-gray-300">which yields the claim of Lemma 1.</p>

    <p class="text-gray-300">Equation (16) uses all pairs that come from a mixed space  <span class="math">\\mathcal{M}_{\\{k\\}}</span>  with four different variables. Clearly, such a mixed space must have resulted from a diagonal space  <span class="math">\\mathcal{D}_{\\{k\\}}</span>  two rounds earlier. Here, we do not consider all pairs from the diagonal space  <span class="math">\\mathcal{D}_{\\{k\\}}</span> . Among the  <span class="math">\\binom{2^{32}}{2}</span>  pairs from a full diagonal space, we restrict our focus on  <span class="math">\\delta</span> -sets. Assume, we consider all  <span class="math">\\delta</span> -sets from a diagonal space. This yields  <span class="math">2^{24} \\cdot 4 \\delta</span> -sets, each of which contains  <span class="math">\\binom{2^8}{2}</span>  pairs. We have to determine the fraction of solutions that is covered by the  <span class="math">\\delta</span> -sets. For this purpose, we have to count the number of pairs that translate from a single active diagonal to a mixed space with two restrictions: (1) their plaintext pairs have come from a diagonal space, and (2) their mixed space after two rounds has four active columns, which implies that after the first round, all bytes in Column k are active.</p>

    <p class="text-gray-300"><strong>Lemma 2.</strong> Let  <span class="math">\\mathcal{X} = \\{X^i \\in \\mathbb{F}_{2^8}^{4 \\times 4}\\}</span> , for  <span class="math">0 \\leq i &lt; 2^{32}</span> , denote a set of all texts in a coset  <span class="math">\\mathcal{D}_{\\{k\\}} \\oplus A</span>  for some  <span class="math">A \\in \\mathbb{F}_{2^8}^{4 \\times 4}</span> . Then, the fraction of pairs  <span class="math">X^i, X^j</span>  whose difference  <span class="math">\\Delta X^{i,j}</span>  lies in  <span class="math">\\mathcal{C}_{\\{c\\}} \\cap \\mathcal{D}_{\\{k\\}}</span> , for any  <span class="math">c \\in \\{0,1,2,3\\}</span> , among all pairs in  <span class="math">\\mathcal{X}</span> , is  <span class="math">4/255^3</span> .</p>

    <p class="text-gray-300">Proof of Lemma 2. Table 7 lists the number of differences that follow the transitions from  <span class="math">\\mathbf{u} \\stackrel{\\mathsf{R}}{\\to} \\mathbf{v}</span> . The rightmost column of that table lists all input differences that lead to four active bytes in  <span class="math">\\mathcal{C}_{\\{k\\}}</span>  after the first round. In sum, there are  <span class="math">2^{55^4}</span>  such differences. In total, there are  <span class="math">2^{32}-1</span>  differences. So, from  <span class="math">2^{32}\\cdot(2^{32}-1)/2</span>  pairs, we can multiply each entry in Table 7 by  <span class="math">2^{32}/2=2^{31}</span>  to obtain the number of pairs with such a difference in a</p>

    <div class="overflow-x-auto my-4">
      <table class="min-w-full text-sm text-gray-300">
        <thead>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"></th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"><span class="math">wt(\\mathbf{v})</span></th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"></th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"></th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"></th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"></th>
        </thead>
        <tbody>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">wt(\\mathbf{u})</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">2</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">3</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">4</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">_</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">\\binom{4}{1}\\binom{4}{4}255</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">2</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">_</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">\\binom{4}{2}\\binom{4}{3}255</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">\\binom{4}{2}\\binom{4}{4}64005</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">3</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">_</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">\\binom{4}{3}\\binom{4}{2}255</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">\\binom{4}{3}\\binom{4}{3}64005</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">\\binom{4}{3}\\binom{4}{4}16323825</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">4</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">\\binom{4}{4}\\binom{4}{1}255</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">\\binom{4}{4}\\binom{4}{2}64005</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">\\binom{4}{4}\\binom{4}{3}16323825</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">\\binom{4}{4}\\binom{4}{4}4</span> 162 570 275</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">\\sum</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">\\binom{4}{1} \\cdot 255</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">\\binom{4}{2} \\cdot 255^2</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">\\binom{4}{3} \\cdot 255^3</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">\\binom{4}{4} \\cdot 255^4</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
        </tbody>
      </table>
    </div>

    <p class="text-gray-300"><strong>Table 7:</strong> Number of differences that translate from a diagonal vector  <span class="math">\\mathbf{x}</span>  with active-byte pattern  <span class="math">\\mathbf{u}</span>  to a column vector  <span class="math">\\mathbf{y}</span>  with active-byte pattern  <span class="math">\\mathbf{v}</span>  through one round of the AES, depending on the weight of  <span class="math">\\mathbf{u}</span>  and  <span class="math">\\mathbf{v}</span> .</p>

    <p class="text-gray-300">diagonal. We obtain that a diagonal contains  <span class="math">4 \\cdot 2^{24} \\cdot {2^8 \\choose 2}</span>  pairs in  <span class="math">\\delta</span> -sets that differ in a single plaintext byte. This is a fraction of</p>

    <p class="text-gray-300"><span class="math">$\\frac{\\binom{4}{1}\\binom{4}{4} \\cdot 255 \\cdot 2^{31}}{255^4 \\cdot 2^{31}} = \\frac{4}{255^3}</span>$</p>

    <p class="text-gray-300">pairs, which yields the claim in Lemma 2.</p>

    <p class="text-gray-300">It remains to combine the results of Lemma 1 and 2 to show Theorem 2.</p>

    <p class="text-gray-300">Proof of Theorem 2. A diagonal space has  <span class="math">2\\,114\\,125\\,822.5</span>  solutions, on average, when we consider pairs generated from a mixed space with four pair-wise different variables  <span class="math">x^1 \\neq x^2</span> ,  <span class="math">y^1 \\neq y^2</span> ,  <span class="math">w^1 \\neq w^2</span> ,  <span class="math">z^1 \\neq z^2</span>  after two rounds. Among all the pairs with four pair-wise different variables, our expectation distinguisher considers a fraction of  <span class="math">4/255^3</span>  of the pairs, namely only those that were mapped from a diagonal space of one active plaintext byte among to a column of four active bytes after the first round. Thus, we have on average</p>

    <p class="text-gray-300"><span class="math">$2\\,114\\,125\\,822.5 \\cdot \\frac{4}{255^3} \\simeq 510.000123</span>$</p>

    <p class="text-gray-300">solutions if we consider all interesting pairs among a diagonal space of  <span class="math">2^{32}</span>  plaintexts. There exist  <span class="math">4 \\cdot 2^{24} \\cdot \\binom{2^8}{2}</span>  such pairs in such a diagonal space. Thus, we obtain a probability of</p>

    <p class="text-gray-300"><span class="math">$\\frac{2\\,114\\,125\\,822.5\\cdot\\frac{4}{255^3}}{4\\cdot 2^{24}\\cdot {2^8\\choose 2}}\\simeq 2^{-32}+2^{-53.9831}\\,.</span>$</p>

    <p class="text-gray-300">Since there are four diagonals, the probability to have one inactive diagonal after three rounds is on average</p>

    <p class="text-gray-300"><span class="math">$p_{\\mathsf{AES}} \\simeq 1 - \\left(1 - \\left(2^{-32} + 2^{-53.9831}\\right)\\right)^4 \\simeq 2^{-30} + 2^{-51.98515} \\,.</span>$</p>

    <p class="text-gray-300">This yields the claim of our five-round distinguisher.</p>

      <h3 id="app-c.2" class="text-xl font-semibold mt-8">C.2 Expectation of The Four-round Distinguisher</h3>

    <p class="text-gray-300">This section shows Theorem 1 in Setting (2). We restate it below for readability. Our goal in the remainder is to obtain an approximate for the probability p for the transition of the third round, under the condition that all columns after two rounds are active.</p>

    <p class="text-gray-300"><strong>Theorem 1.</strong> Let  <span class="math">\\mathcal{X}=\\{X^i\\in\\mathbb{F}_{2^8}^{4\\times 4}\\}</span> , for  <span class="math">0\\leq i&lt;2^{32}</span> , denote a set of all texts in a coset  <span class="math">\\mathcal{M}_{\\{k\\}}\\oplus A</span>  for some  <span class="math">A\\in\\mathbb{F}_{2^8}^{4\\times 4},\\ A\\in\\mathcal{X}^\\perp</span> , where all columns are active. Let  <span class="math">\\mathcal{Y}=\\{Y^i\\in\\mathbb{F}_{2^8}^{4\\times 4}:Y^i=\\mathsf{R}(X^i)\\},\\ 0\\leq i&lt;2^{32}</span> , denote the set of corresponding outputs after one round of AES. Let Y be a random variable for the number of different ciphertext pairs  <span class="math">(Y^i,Y^j)</span>  s. t.  <span class="math">Y^i,Y^j\\in\\mathcal{D}_{\\mathcal{J}}\\cap\\mathcal{C}_{\\{c\\}}\\oplus A&#x27;</span> , for some  <span class="math">A&#x27;\\in\\mathbb{F}_{2^8}^{4\\times 4},\\ \\mathcal{J}\\subset\\{0,1,2,3\\},\\ |\\mathcal{J}|=3</span> , and  <span class="math">c\\in\\{0,1,2,3\\}</span> . Then, under the assumption of the uniform distribution of non-trivial solutions of S-box differential transitions in Equation (6),</p>

    <p class="text-gray-300"><span class="math">$\\Pr\\left[\\mathcal{M}_{\\{k\\}} \\oplus A \\xrightarrow{\\mathsf{R}} \\mathcal{D}_{\\mathcal{J}} \\cap \\mathcal{C}_{\\{c\\}} \\oplus A&#x27;\\right] \\simeq 2^{-8} + 2^{-31.983}.</span>$</p>

    <p class="text-gray-300">Note that the analysis of Theorem 1 is a simpler variant of the proof strategy of our five-round distinguisher. To show Theorem 1, we employ two Lemmas. Lemma 3 reconsiders the number of solutions, Lemma 2 provides us with the fraction of solutions that start from a single active byte.</p>

    <p class="text-gray-300"><strong>Lemma 3.</strong> Under the assumption of the uniform distribution of non-trivial solutions of S-box differential transitions, the number of solutions from a mixed space with no equal generating variables is approximately  <span class="math">2^{54.9774}</span> .</p>

    <p class="text-gray-300"><em>Proof.</em> Again, we can prove Lemma 3 from adapting the third case of the proof of Theorem 2 by Grassi and Rechberger [GR19, Sect. 5.3.3]. Let  <span class="math">\\mathcal{J}=\\{1,2,3\\}</span>  as the set of active diagonals after the round, and let  <span class="math">\\ell=0</span>  and c=0; the cases for other values of  <span class="math">\\ell</span>  and c are analogous. We denote  <span class="math">X^1,X^2\\in\\mathcal{M}_{\\{k\\}}\\oplus A</span> . Then, there exist  <span class="math">x^i,y^i,z^i,w^i\\in\\mathbb{F}_{2^8}</span> , for  <span class="math">1\\leq i\\leq 2</span> , s. t.</p>

    <p class="text-gray-300"><span class="math">$X^i = \\begin{bmatrix} 2x^i &amp; w^i &amp; z^i &amp; 3y^i \\\\ x^i &amp; w^i &amp; 3z^i &amp; 2y^i \\\\ x^i &amp; 3w^i &amp; 2z^i &amp; y^i \\\\ 3x^i &amp; 2w^i &amp; z^i &amp; y^i \\end{bmatrix} \\oplus A \\,.</span>$</p>

    <p class="text-gray-300">All variables are distinct, i.e.  <span class="math">x^1 \\neq x^2</span> ,  <span class="math">y^1 \\neq y^2</span> ,  <span class="math">z^1 \\neq z^2</span> , and  <span class="math">w^1 \\neq w^2</span> . We consider the following equation:</p>

    <p class="text-gray-300"><span class="math">$\\Delta Y[0] = \\bigoplus_{i=1}^{2} 2S\\left(2x^{i} \\oplus A[0]\\right) \\oplus 3S\\left(w^{i} \\oplus A[5]\\right) \\oplus S\\left(2z^{i} \\oplus A[10]\\right) \\oplus S\\left(y^{i} \\oplus A[15]\\right) = 0,</span>$</p>

    <p class="text-gray-300"><span class="math">$(17)</span>$</p>

    <p class="text-gray-300">which can be generalized to</p>

    <p class="text-gray-300"><span class="math">$\\bigoplus_{i=1}^{2} A \\cdot S\\left(\\widehat{x}\\right) \\oplus C \\cdot S\\left(\\widehat{w}\\right) \\oplus E \\cdot S\\left(\\widehat{z}\\right) \\oplus G \\cdot S\\left(\\widehat{y}\\right) = 0.</span>$</p>

    <p class="text-gray-300">We denote the input differences between the variable pairs as  <span class="math">\\Delta_I^x = x^1 \\oplus x^2</span> , and  <span class="math">\\Delta_I^y = y^1 \\oplus y^2</span> ,  <span class="math">\\Delta_I^z = z^1 \\oplus z^2</span> , and  <span class="math">\\Delta_I^w = w^1 \\oplus w^2</span> . We can reformulate the equation systems to</p>

    <p class="text-gray-300"><span class="math">$S(\\widehat{x}) \\oplus S(\\widehat{x} \\oplus \\Delta_{I}^{x}) = \\Delta_{O}^{x}</span>$</p>

    <p class="text-gray-300"><span class="math">$S(\\widehat{w}) \\oplus S(\\widehat{w} \\oplus \\Delta_{I}^{w}) = \\Delta_{O}^{w}</span>$</p>

    <p class="text-gray-300"><span class="math">$S(\\widehat{z}) \\oplus S(\\widehat{z} \\oplus \\Delta_{I}^{z}) = \\Delta_{O}^{z}</span>$</p>

    <p class="text-gray-300"><span class="math">$S(\\widehat{y}) \\oplus S(\\widehat{y} \\oplus \\Delta_{I}^{y}) = \\Delta_{O}^{y}.</span>$</p>

    <p class="text-gray-300">From  <span class="math">\\Delta_I^x</span> ,  <span class="math">\\Delta_I^w</span> ,  <span class="math">\\Delta_I^z</span> ,  <span class="math">\\Delta_I^y \\neq 0</span> , it follows that  <span class="math">\\Delta_O^x</span> ,  <span class="math">\\Delta_O^w</span> ,  <span class="math">\\Delta_O^z</span> ,  <span class="math">\\Delta_O^y \\neq 0</span> . Moreover, one variable is defined from the equation system of the others as</p>

    <p class="text-gray-300"><span class="math">$\\Delta_O^y = G^{-1} \\cdot (A \\cdot \\Delta_O^x \\oplus C \\cdot \\Delta_O^w \\oplus E \\cdot \\Delta_O^z) \\ .</span>$</p>

    <p class="text-gray-300">Again, there exist  <span class="math">255^3</span>  solutions for  <span class="math">\\Delta_O^x</span> ,  <span class="math">\\Delta_O^w</span> ,  <span class="math">\\Delta_O^z</span> . Though, having fixed  <span class="math">\\Delta_O^x</span> ,  <span class="math">255 \\cdot 254</span>  pairs  <span class="math">\\Delta_O^w</span> ,  <span class="math">\\Delta_O^z</span>  solutions would lead to  <span class="math">\\Delta_O^y = 0</span> . So, there are  <span class="math">255^3 - 255 \\cdot 254</span>  possible tuples  <span class="math">(\\Delta_O^x, \\Delta_O^w, \\Delta_O^z, \\Delta_O^y)</span> . Given a fixed  <span class="math">\\Delta_I</span> , the average number of solutions for one equation is 256/255. There exist 255 values of  <span class="math">\\Delta_I</span> , and four pairs  <span class="math">(\\Delta_I^x, \\Delta_O^x)</span> , ...,  <span class="math">(\\Delta_I^y, \\Delta_O^y)</span> , which yields</p>

    <p class="text-gray-300"><span class="math">$\\left(255 \\cdot \\frac{256}{255}\\right)^4 = 2^{32}</span>$</p>

    <p class="text-gray-300">solutions of values  <span class="math">(x^1,y^1,z^1,w^1),(x^2,y^2,z^2,w^2)</span>  for fixed differences  <span class="math">(\\Delta_I^x,\\Delta_I^y,\\Delta_I^z,\\Delta_I^w)</span>  on average. To prevent double counting solutions  <span class="math">[(x^1,y^1,z^1,w^1),(x^2,y^2,z^2,w^2)]</span>  and  <span class="math">[(x^2,y^2,z^2,w^2),(x^1,y^1,z^1,w^1)]</span> , we employ a partial order, e.g., require that  <span class="math">w^1&lt; w^2</span> . The total number of different solutions  <span class="math">(x^1,y^1,z^1,w^1),(x^2,y^2,z^2,w^2)</span> , for the order  <span class="math">w^1&lt; w^2</span> , to the four Equations 14 is then given by</p>

    <p class="text-gray-300"><span class="math">$\\frac{1}{2} \\cdot \\left(255^3 - 255 \\cdot 254\\right) \\cdot \\left(255 \\cdot \\frac{256}{255}\\right)^4 = \\left(255^3 - 255 \\cdot 254\\right) \\cdot 2^{31} \\tag{18}</span>$</p>

    <p class="text-gray-300"><span class="math">$= 35469139157975040 \\simeq 2^{54.9774} \\,. \\tag{19}</span>$</p>

    <p class="text-gray-300"></p>

    <p class="text-gray-300">which yields the claim of Lemma 3.</p>

    <p class="text-gray-300">Equation (18) uses all pairs that come from a mixed space  <span class="math">\\mathcal{M}_{\\{k\\}}</span>  with four different variables. Such a mixed space must have resulted from a diagonal space  <span class="math">\\mathcal{D}_{\\{k\\}}</span>  two rounds earlier. Here, we do not consider all pairs from the diagonal space  <span class="math">\\mathcal{D}_{\\{k\\}}</span> . Among the  <span class="math">\\binom{2^{3^2}}{2}</span>  pairs from a full diagonal space, we restrict our focus on  <span class="math">\\delta</span> -sets. Assume, we consider all  <span class="math">\\delta</span> -sets from a diagonal space. Then, Lemma 2 showed that the fraction of pairs  <span class="math">X^i, X^j</span>  whose difference  <span class="math">\\Delta X^{i,j}</span>  lies in  <span class="math">\\mathcal{C}_{\\{c\\}} \\cap \\mathcal{D}_{\\{k\\}}</span> , for any  <span class="math">c \\in \\{0,1,2,3\\}</span> , among all pairs in  <span class="math">\\mathcal{X}</span> , is  <span class="math">4/255^3</span> . This yields  <span class="math">2^{2^4} \\cdot 4</span>   <span class="math">\\delta</span> -sets, each of which contains  <span class="math">\\binom{2^8}{2}</span>  pairs.</p>

    <p class="text-gray-300">Proof of Theorem 1. A diagonal space has  <span class="math">(255^3-255\\cdot254)\\cdot2^{31}</span>  solutions when we consider pairs generated from a mixed space with four pair-wise different variables  <span class="math">x^1\\neq x^2</span> ,  <span class="math">y^1\\neq y^2</span> ,  <span class="math">w^1\\neq w^2</span> ,  <span class="math">z^1\\neq z^2</span>  after two rounds. Among all the pairs with four pair-wise different variables, our expectation distinguisher considers a fraction of  <span class="math">4/255^3</span>  of the pairs, namely only those that were mapped from a diagonal space of one active plaintext byte among to a column of four active bytes after the first round. Among a diagonal space of  <span class="math">2^{32}</span>  plaintexts, there exist  <span class="math">4\\cdot2^{24}\\cdot\\binom{2^8}{2}</span>  such pairs in such a diagonal space. Thus, we obtain a probability of</p>

    <p class="text-gray-300"><span class="math">$\\frac{35469139157975040 \\cdot \\frac{4}{255^3}}{4 \\cdot 2^{24} \\cdot {2^8 \\choose 2}} \\simeq 2^{-8} + 2^{-31.983} \\, .</span>$</p>

    <p class="text-gray-300">which yields the claim of our four-round distinguisher.</p>

      <h3 id="app-d.1" class="text-xl font-semibold mt-8">D.1 Variance of The Five-round Distinguisher</h3>

      <h4 id="app-d.1.1" class="text-lg font-semibold mt-6">D.1.1 Recap of the Variance from [GR19]</h4>

    <p class="text-gray-300">Grassi and Rechberger [GR19] considered all pairs in a diagonal space  <span class="math">\\mathcal{D}_{\\mathcal{I}}</span>  to an inverse-diagonal space after five rounds. They showed that their distribution of collisions could be modeled by the sum of three binomial distributions. Let Y be the random variable for</p>

    <p class="text-gray-300">the number of collisions after five rounds. Then, the probability of k collisions from N trials follows</p>

    <p class="text-gray-300"><span class="math">$\\Pr\\left[\\mathsf{Y} = k\\right] = \\begin{cases} 0 &amp; \\text{if } k \\bmod 8 \\not\\equiv 0 \\\\ \\sum_{k_3, k_{10}, k_{17} \\in \\mathcal{K}_N} \\left(\\prod_{i \\in \\{3, 10, 17\\}} \\binom{N_i}{k_i} \\cdot (p_i)^{k_i} \\cdot (1 - p_i)^{N_i - k_i}\\right) &amp; \\text{otherwise,} \\end{cases}</span>$</p>

    <p class="text-gray-300">where</p>

    <p class="text-gray-300"><span class="math">$K_N \\stackrel{\\text{def}}{=} \\left\\{ (k_3, k_{10}, k_{17}) \\in \\mathbb{N}^3 \\left| 0 \\le k_i \\le N_i \\wedge 2^3 \\cdot k_3 + 2^{10} \\cdot k_{10} + 2^{17} \\cdot k_{17} = k \\right. \\right\\} ,</span>$</p>

    <p class="text-gray-300">and</p>

    <p class="text-gray-300"><span class="math">$N_3 = 1 \\cdot 2^{28} \\cdot 255^4</span>$
<span class="math">p_3 = 2^{-32} + 2^{-53.983}</span>
<span class="math">N_{10} = 4 \\cdot 2^{21} \\cdot 255^3</span>   <span class="math">p_{10} = 2^{-32} - 2^{-45.989}</span>
<span class="math">N_{17} = 6 \\cdot 2^{14} \\cdot 255^2</span>   <span class="math">p_{17} = 2^{-32} + 2^{-37.986}</span></p>

    <p class="text-gray-300">Note that, in contrast to  <span class="math">p_i</span>  and  <span class="math">N_i</span> , the tuples  <span class="math">(k_3, k_{10}, \\text{ and } k_{17})</span>  are no single values but can take potentially many combinations</p>

    <p class="text-gray-300">Or said easier: the distribution of the number of a fixed single anti-diagonal collisions after five-round AES from a diagonal space Y is described by</p>

    <p class="text-gray-300"><span class="math">$\\Pr\\left[\\mathsf{Y}\\right] = 2^{3} \\cdot \\mathsf{X}_{3} + 2^{10} \\cdot \\mathsf{X}_{10} + 2^{17} \\cdot \\mathsf{X}_{17} \\,,</span>$</p>

    <p class="text-gray-300">where  <span class="math">X_i \\sim \\mathcal{B}(N_i, p_i)</span>  are binomial distributions for  <span class="math">i \\in \\{3, 10, 17\\}</span> . The factors  <span class="math">2^3</span> ,  <span class="math">2^{10}</span> , and  <span class="math">2^{17}</span>  represent the number of pairs in the input space that follow this distribution. They correspond to the pairs with four, three, and two (in that order) different generating variables in the expectation proof.</p>

    <p class="text-gray-300">[GR19] determined the variance  <span class="math">\\mathsf{Var}\\left[\\mathsf{Y}\\right]</span>  as</p>

    <p class="text-gray-300"><span class="math">$\\mathsf{Var}\\left[\\mathsf{Y}\\right] \\stackrel{\\mathrm{def}}{=} \\mathsf{Var}\\left[2^3 \\cdot \\mathsf{X}_3\\right] + \\mathsf{Var}\\left[2^{10} \\cdot \\mathsf{X}_{10}\\right] + \\mathsf{Var}\\left[2^{17} \\cdot \\mathsf{X}_{17}\\right] \\, .</span>$</p>

    <p class="text-gray-300">Since  <span class="math">Var[\\alpha \\cdot X] = \\alpha^2 \\cdot Var[X]</span>  holds for any constant  <span class="math">\\alpha</span> , it followed that</p>

    <p class="text-gray-300"><span class="math">$\\begin{split} \\mathsf{Var}\\left[\\mathsf{Y}\\right] &amp;= (2^3)^2 \\cdot \\mathsf{Var}\\left[\\mathsf{X}_3\\right] + (2^{10})^2 \\cdot \\mathsf{Var}\\left[\\mathsf{X}_{10}\\right] + (2^{17})^2 \\cdot \\mathsf{Var}\\left[\\mathsf{X}_{17}\\right] \\\\ &amp;= 2^6 \\cdot (N_3 \\cdot p_3 \\cdot (1-p_3)) + 2^{20} \\cdot (N_{10} \\cdot p_{10} \\cdot (1-p_{10})) + 2^{34} \\cdot (N_{17} \\cdot p_{17} \\cdot (1-p_{17})) \\;. \\end{split}</span>$</p>

    <p class="text-gray-300">[GR19] employed a full diagonal space with up to four active bytes in the input. To obtain a zero-difference diagonal after three rounds (i.e., at most three active bytes per column), they needed at least two active bytes per column, i.e., at least two active bytes after the first round. Under other output restrictions, the sum would also contain another term  <span class="math">X_{24}</span>  for the number of pairs with a single different generating variable.</p>

      <h4 id="app-d.1.2" class="text-lg font-semibold mt-6">D.1.2 Variance of Our Five-round Distinguisher</h4>

    <p class="text-gray-300">The five-round distinguisher in this work does not employ a full diagonal space but starts from a single active byte. Therefore, all pairs after one round are guaranteed to have four active bytes and four different generating variables. In the following, we derive the variance for both settings.</p>

    <p class="text-gray-300"><strong>Setting (2).</strong> Here, we claim that the probability distribution of collisions of a single inverse diagonal after five rounds is given by</p>

    <p class="text-gray-300"><span class="math">$\\Pr[\\mathsf{Y} = k] = \\begin{cases} 0 &amp; \\text{if } k \\bmod 8 \\not\\equiv 0 \\\\ \\binom{N_3}{k_3} \\cdot (p_3)^{k_3} \\cdot (1 - p_3)^{N_3 - k_3} &amp; \\text{otherwise.} \\end{cases}</span>$</p>

    <p class="text-gray-300">So, we obtain actually one of the three sub-cases from [GR19]. We can determine the variance as</p>

    <p class="text-gray-300"><span class="math">$\\begin{split} \\mathsf{Var}\\left[\\mathsf{Y}\\right] &amp;= (2^3)^2 \\cdot \\mathsf{Var}\\left[\\mathsf{X}_3\\right] = 2^6 \\cdot \\left(N_3 \\cdot p_3 \\cdot (1-p_3)\\right) \\\\ &amp;= 2^6 \\cdot \\frac{4 \\cdot 255 \\cdot 2^{31}}{8} \\cdot \\left(2^{-30} + 2^{-51.985} - 2^{-61.415}\\right) \\cdot \\left(1 - \\left(2^{-30} + 2^{-51.985} - 2^{-61.415}\\right)\\right) \\\\ &amp;\\simeq 4\\,080\\,. \\end{split}</span>$</p>

    <p class="text-gray-300">Note that the variance of a random binomial distribution is given by</p>

    <p class="text-gray-300"><span class="math">$\\begin{split} \\operatorname{Var}\\left[\\mathbf{Y}\\right] &amp;= N \\cdot p \\cdot (1-p) \\\\ &amp;= 4 \\cdot 2^{24} \\cdot \\binom{2^8}{2} \\cdot \\left(2^{-30} - 2^{-61.415}\\right) \\cdot \\left(1 - \\left(2^{-30} - 2^{-61.415}\\right)\\right) \\\\ &amp;\\simeq 509.999 \\ldots \\simeq 510 \\,. \\end{split}</span>$</p>

    <p class="text-gray-300">So, the variance is about eight times higher in Setting <a href="#page-11-3">(2).</a></p>

    <p class="text-gray-300"><strong>Setting <a href="#page-11-0">(1).</a></strong> This setting does not have the strong multiple-of-eight relation, The distribution after <em>N</em> trials follows approximately a binomial distribution:</p>

    <p class="text-gray-300"><span class="math">$\\Pr\\left[\\mathsf{Y} = k\\right] = \\binom{N}{k} \\cdot p^k \\cdot (1-p)^{N-k}.</span>$</p>

    <p class="text-gray-300">We can determine the variance as</p>

    <p class="text-gray-300"><span class="math">$\\begin{aligned} \\mathsf{Var}\\left[\\mathsf{Y}\\right] &amp;= N \\cdot p \\cdot (1-p) \\\\ &amp;= 4 \\cdot 2^{24} \\cdot \\binom{2^8}{2} \\cdot \\left(2^{-30} + 2^{-51.985} - 2^{-61.415}\\right) \\cdot \\left(1 - \\left(2^{-30} + 2^{-51.985} - 2^{-61.415}\\right)\\right) \\\\ &amp;\\simeq 510.000122 \\ldots . \\end{aligned}</span>$</p>

    <p class="text-gray-300">So, the variance is marginally higher than that for a random permutation.</p>

      <h4 id="app-d.1.3" class="text-lg font-semibold mt-6"><strong>D.1.3 Variance of Our Five-round Distinguisher for Small-AES</strong></h4>

    <p class="text-gray-300">For Small-AES, we derive the variance similarly.</p>

    <p class="text-gray-300"><strong>Setting <a href="#page-11-3">(2).</a></strong> Here, we can determine the variance as</p>

    <p class="text-gray-300"><span class="math">$\\begin{split} \\mathsf{Var}\\left[\\mathsf{Y}\\right] &amp;= (2^3)^2 \\cdot \\mathsf{Var}\\left[\\mathsf{X}_3\\right] = 2^6 \\cdot \\left(N_3 \\cdot p_3 \\cdot (1-p_3)\\right) \\\\ &amp;= 2^6 \\cdot \\frac{4 \\cdot 15 \\cdot 2^{15}}{8} \\cdot \\left(2^{-14} + 2^{-23.748} - 2^{-29.415}\\right) \\cdot \\left(1 - \\left(2^{-14} + 2^{-23.748} - 2^{-29.415}\\right)\\right) \\\\ &amp;\\simeq 961.094 \\simeq 2^{9.9085} \\,. \\end{split}</span>$</p>

    <p class="text-gray-300">Note that the variance of a random binomial distribution is given by</p>

    <p class="text-gray-300"><span class="math">$\\begin{split} \\mathsf{Var}\\left[\\mathsf{Y}\\right] &amp;= N \\cdot p \\cdot (1-p) \\\\ &amp;= 4 \\cdot 2^{12} \\cdot \\binom{2^4}{2} \\cdot \\left(2^{-14} - 2^{-29.415}\\right) \\cdot \\left(1 - \\left(2^{-14} - 2^{-29.415}\\right)\\right) \\\\ &amp;\\simeq 119.9899\\ldots \\simeq 2^{6.907} \\,. \\end{split}</span>$</p>

    <p class="text-gray-300">So, the variance is again about eight times higher in the Setting <a href="#page-11-3">(2).</a></p>

    <div class="overflow-x-auto my-4">
      <table class="min-w-full text-sm text-gray-300">
        <thead>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"></th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">Setting (1)</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">Setting (2)</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"></th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"></th>
        </thead>
        <tbody>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Construction</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Theory</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Experiments</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Theory</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Experiments</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">&pi;</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">509.999</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">&ndash;</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">509.999</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">&ndash;</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">AES</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">510.000</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">&ndash;</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">4 080.000</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">&ndash;</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">&pi;</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">119.9899</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">&ndash;</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">119.9899</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">&ndash;</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Small-AES</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">120.130</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">119.601</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">961.094</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1 388.735</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">PRESENT S-box</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">120.130</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">118.796</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">961.094</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1 375.978</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">PRINCE S-box</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">120.130</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">120.299</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">961.094</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1 370.575</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">PRIDE S-box</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">120.130</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">119.996</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">961.094</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1 391.445</td>
          </tr>
        </tbody>
      </table>
    </div>

    <p class="text-gray-300"><strong>Table 8:</strong> Summary of the variances for our five-round distinguisher. <em>&pi;</em> = random permutation. Exp. = experiments from 100 000 random keys with 2<sup>14</sup> <em>&delta;</em>-sets each.</p>

    <p class="text-gray-300"><strong>Setting <a href="#page-11-0">(1).</a></strong> Again, this setting lacks the multiple-of-eight relation, and the distribution of collisions after <em>N</em> trials follows roughly a binomial distribution:</p>

    <p class="text-gray-300"><span class="math">$\\Pr\\left[\\mathsf{Y} = k\\right] = \\binom{N}{k} \\cdot p^k \\cdot (1-p)^{N-k}.</span>$</p>

    <p class="text-gray-300">We can determine the variance as</p>

    <p class="text-gray-300"><span class="math">$\\begin{split} \\operatorname{Var}\\left[\\mathbf{Y}\\right] &amp;= N \\cdot p \\cdot (1-p) \\\\ &amp;= 4 \\cdot 2^{12} \\cdot \\binom{2^4}{2} \\cdot \\left(2^{-14} + 2^{-23.748} - 2^{-29.415}\\right) \\cdot \\left(1 - \\left(2^{-14} + 2^{-23.748} - 2^{-29.415}\\right)\\right) \\\\ &amp;\\simeq 120.1295\\ldots \\simeq 2^{6.908} \\,. \\end{split}</span>$</p>

    <p class="text-gray-300">So, the variance in Setting <a href="#page-11-0">(1)</a> is again marginally higher than that for a random permutation.</p>

      <h4 id="app-d.1.4" class="text-lg font-semibold mt-6"><strong>D.1.4 Experimental Verification of the Variance of Our Five-round Distinguisher for Small-AES</strong></h4>

    <p class="text-gray-300">We verified the variance experimentally for Small-AES. We chose 100 000 random keys. For Setting <a href="#page-11-0">(1),</a> we chose 2<sup>14</sup> random independent <em>&delta;</em>-sets per key, which matches the number of <em>&delta;</em>-sets in a diagonal of Setting <a href="#page-11-3">(2).</a> For each such experiment, we counted the number of collisions in at least one of the inverse diagonals after five rounds without the final MixColumns operation. Figure <a href="#page-54-0">14</a> visualizes the distributions for both settings.</p>

      <h4 id="app-d.1.5" class="text-lg font-semibold mt-6"><strong>D.1.5 Discussion</strong></h4>

    <p class="text-gray-300">As a result, we conclude that there has to be another property in Small-AES beyond the multiple-of-eight property that yields the observable deviation. In Setting <a href="#page-11-3">(2),</a> the variance differs significantly from our expectation. One could expect that it roughly is eight times higher than the variance in Setting <a href="#page-11-0">(1)</a> due to the multiple-of-eight property. Though, for Small-AES, it is only roughly 11<em>.</em>4 times larger as outlined in Table <a href="#page-57-1">9,</a> i.e., roughly 12 times larger than the variance of Setting <a href="#page-11-0">(1).</a> The reason for this gap is still unknown.</p>

    <p class="text-gray-300">The variance of the four-round distinguisher can be derived similarly as for our five-round distinguisher.</p>

    <p class="text-gray-300">    <img src="_page_54_Figure_2.jpeg" alt="" class="my-4 max-w-full" />
</p>

    <p class="text-gray-300">Figure 14: Distribution of the number of collisions in the first cell after five rounds in both settings, with the final MixColumns operation omitted. Both distributions used 100 000 random keys and counted the collisions from  <span class="math">2^{14}</span>   <span class="math">\\delta</span> -sets per key that were independent in Setting (1) or the  <span class="math">2^{14}</span>   <span class="math">\\delta</span> -sets from  <span class="math">\\mathcal{D}_{\\{0\\}}</span> . Thin lines are fitted normal distributions, thick lines the best fitted distributions.</p>

      <h4 id="app-d.2.1" class="text-lg font-semibold mt-6">D.2.1 Variance of Our Four-round Distinguisher for The AES</h4>

    <p class="text-gray-300"><strong>Setting (2).</strong> Here, we claim that the probability distribution of collisions of a single inverse diagonal after five rounds is given by</p>

    <p class="text-gray-300"><span class="math">$\\Pr[\\mathsf{Y} = k] = \\begin{cases} 0 &amp; \\text{if } k \\bmod 8 \\not\\equiv 0 \\\\ \\binom{N_3}{k_3} \\cdot (p_3)^{k_3} \\cdot (1 - p_3)^{N_3 - k_3} &amp; \\text{otherwise.} \\end{cases}</span>$</p>

    <p class="text-gray-300">So, we obtain actually one of the three sub-cases from [GR19]. We can determine the variance as</p>

    <p class="text-gray-300"><span class="math">$\\begin{split} \\mathsf{Var}\\left[\\mathsf{Y}\\right] &amp;= (2^3)^2 \\cdot \\mathsf{Var}\\left[\\mathsf{X}_3\\right] = 2^6 \\cdot \\left(N_3 \\cdot p_3 \\cdot (1-p_3)\\right) \\\\ &amp;= 2^6 \\cdot \\frac{4 \\cdot 255 \\cdot 2^{31}}{8} \\cdot \\left(2^{-8} + 2^{-31.983}\\right) \\cdot \\left(1 - \\left(2^{-8} + 2^{-31.983}\\right)\\right) \\\\ &amp;\\simeq 68\\,183\\,658\\,496.108 \\simeq 2^{35.9887} \\,. \\end{split}</span>$</p>

    <p class="text-gray-300">Note that the variance of a random binomial distribution is given by</p>

    <p class="text-gray-300"><span class="math">$\\begin{split} \\operatorname{Var}\\left[\\mathbf{Y}\\right] &amp;= N \\cdot p \\cdot (1-p) \\\\ &amp;= 4 \\cdot 2^{24} \\cdot \\binom{2^8}{2} \\cdot \\left(2^{-8}\\right) \\cdot \\left(1-\\left(2^{-8}\\right)\\right) \\end{split}</span>$</p>

    <p class="text-gray-300"><span class="math">$\\simeq 8522956800 \\simeq 2^{32.9887} \\,.</span>$</p>

    <p class="text-gray-300">So, the variance should be about eight times higher in Setting <a href="#page-11-3">(2).</a></p>

      <h4 id="app-d.2.2" class="text-lg font-semibold mt-6"><strong>D.2.2 Variance of Our Four-round Distinguisher for Small-AES</strong></h4>

    <p class="text-gray-300">For Small-AES, we derive the variance similarly. However, due to the multiple-of-32 property, we have a different computation. We define <em>p</em>5, X<sup>5</sup> and <em>N</em><sup>5</sup> similar as <em>p</em>3, X<sup>3</sup> and <em>N</em><sup>3</sup> before.</p>

    <p class="text-gray-300"><strong>Setting <a href="#page-11-3">(2).</a></strong> Here, we can determine the variance as</p>

    <p class="text-gray-300"><span class="math">$\\begin{split} \\mathsf{Var}\\left[\\mathsf{Y}\\right] &amp;= (2^5)^2 \\cdot \\mathsf{Var}\\left[\\mathsf{X}_5\\right] = 2^{10} \\cdot \\left(N_5 \\cdot p_5 \\cdot (1-p_5)\\right) \\\\ &amp;= 2^{10} \\cdot \\frac{4 \\cdot 15 \\cdot 2^{15}}{32} \\cdot \\left(2^{-4} + 2^{-15.721}\\right) \\cdot \\left(1 - \\left(2^{-4} + 2^{-15.721}\\right)\\right) \\\\ &amp;\\simeq 3\\,687\\,419.195 \\simeq 2^{21.8142}\\,. \\end{split}</span>$</p>

    <p class="text-gray-300">Note that the variance of a random binomial distribution is given by</p>

    <p class="text-gray-300"><span class="math">$\\begin{split} \\mathsf{Var}\\left[\\mathsf{Y}\\right] &amp;= N \\cdot p \\cdot (1-p) \\\\ &amp;= 4 \\cdot 2^{12} \\cdot \\binom{2^4}{2} \\cdot \\left(2^{-4} - 2^{-64.093}\\right) \\cdot \\left(1 - \\left(2^{-4} - 2^{-64.093}\\right)\\right) \\\\ &amp;\\simeq 115\\,200 \\simeq 2^{16.8138} \\,. \\end{split}</span>$</p>

    <p class="text-gray-300">So, the variance should be about 32 times higher in the Setting <a href="#page-11-3">(2).</a></p>

    <p class="text-gray-300"><strong>Setting <a href="#page-11-0">(1).</a></strong> Again, this setting lacks the multiple-of-32 relation, and the distribution of collisions after <em>N</em> trials follows roughly a binomial distribution:</p>

    <p class="text-gray-300"><span class="math">$\\Pr\\left[\\mathsf{Y} = k\\right] = \\binom{N}{k} \\cdot p^k \\cdot (1 - p)^{N - k}.</span>$</p>

    <p class="text-gray-300">We can determine the variance as</p>

    <p class="text-gray-300"><span class="math">$\\begin{split} \\operatorname{Var}\\left[\\mathbf{Y}\\right] &amp;= N \\cdot p \\cdot (1-p) \\\\ &amp;= 4 \\cdot 2^{12} \\cdot \\binom{2^4}{2} \\cdot \\left(2^{-4} + 2^{-15.721}\\right) \\cdot \\left(1 - \\left(2^{-4} + 2^{-15.721}\\right)\\right) \\\\ &amp;\\simeq 115\\,231.850\\ldots \\simeq 2^{16.8142}\\,. \\end{split}</span>$</p>

    <p class="text-gray-300">So, the variance in Setting <a href="#page-11-0">(1)</a> is again marginally higher than that for a random permutation.</p>

      <h4 id="app-d.2.3" class="text-lg font-semibold mt-6"><strong>D.2.3 Experimental Verification of the Variance of Our Four-round Distinguisher for Small-AES</strong></h4>

    <p class="text-gray-300">We verified the variance experimentally for Small-AES. We chose 100 000 random keys. For Setting <a href="#page-11-0">(1),</a> we chose 2<sup>14</sup> random independent <em>&delta;</em>-sets per key, which matches the number of <em>&delta;</em>-sets in a diagonal of Setting <a href="#page-11-3">(2).</a> For each such experiment, we counted the number of collisions in the first byte after four rounds without the final MixColumns operation. Figure <a href="#page-56-0">15</a> visualizes the distributions for both settings.</p>

    <p class="text-gray-300">    <img src="_page_56_Figure_2.jpeg" alt="" class="my-4 max-w-full" />
</p>

    <p class="text-gray-300">Figure 15: Distribution of the number of collisions in the first cell after four rounds in both settings, with the final MixColumns operation omitted. Both distributions used 100 000 random keys and counted the collisions from  <span class="math">2^{14}</span>   <span class="math">\\delta</span> -sets per key that were independent in Setting (1) or the  <span class="math">2^{14}</span>   <span class="math">\\delta</span> -sets from  <span class="math">\\mathcal{D}_{\\{0\\}}</span> . Thin lines are fitted normal distributions, thick lines the best fitted distributions.</p>

      <h4 id="app-d.2.4" class="text-lg font-semibold mt-6">D.2.4 Discussion</h4>

    <p class="text-gray-300">In Setting (2), the variance differs significantly from our expectation. First, one can expect that it roughly is 32 times higher than the variance in Setting (1) due to the multiple-of-32 property. From the experiments, we observed the multiple-of-32 property in Section B.2. However, the variance of Small-AES in Setting (2) can then be expected to be roughly a 32 times the variance of Setting (1). Though, for Small-AES, it is only roughly 15.4 times larger as outlined in Table 9, i.e., roughly 16 times larger than the variance of Setting (1). The reason for this gap is still unknown.</p>

    <p class="text-gray-300">For the five-round distinguisher, the tested S-boxes behaved quite similarly. For the four-round distinguisher, they differ hugely, e.g., the variance for Small-AES with the S-box of PRESENT has a factor of 12.7 instead of roughly 16, and that of PRIDE a factor of roughly 40.9. It is equally unknown which properties cause those S-boxes to possess such huge differences.</p>

    <p class="text-gray-300">We conjecture that the multiple-of-four property behaves in a multiplicative fashion in the four-round distinguisher and in an additive fashion in our five-round distinguisher. This means, instead of 16-tuples of texts that form a multiple-of-eight property, the property builds 64-tuples texts that yield the multiple-of-32 property. So, it is included in the multiple-of-eight tuples. For the five-round distinguisher, we conjecture that the property behaves additively, i.e., there exist 16-tuples of texts that yield the multiple-of-eight</p>

    <div class="overflow-x-auto my-4">
      <table class="min-w-full text-sm text-gray-300">
        <thead>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"></th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"></th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">Setting (1)</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"></th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">Setting (2)</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"></th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"></th>
        </thead>
        <tbody>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Construction</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Theory</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Experiments</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Theory</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Experiments</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">&pi;</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">32.9887<br>2</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">&ndash;</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">232.9887</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">&ndash;</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">AES</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">32.9887<br>2</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">&ndash;</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">35.9887<br>2</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">&ndash;</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">&pi;</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">115 200</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">&ndash;</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">115 200</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">&ndash;</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Small-AES</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">115 231.850</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">115 080.346</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">3 687 419.195 1 768 183.658</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">PRESENT S-box</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">115 231.850</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">116 507.699</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">3 687 419.195 1 462 985.130</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">PRINCE S-box</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">115 231.850</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">115 049.655</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">3 687 419.195 1 886 523.688</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">PRIDE S-box</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">115 231.850</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">114 859.203</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">3 687 419.195 4 709 431.259</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
        </tbody>
      </table>
    </div>

    <p class="text-gray-300"><strong>Table 9:</strong> Summary of the variances for our four-round distinguisher. RP = random permutation. Exp. = experiments from 100 000 random keys with 2<sup>14</sup> <em>&delta;</em>-sets each.</p>

    <p class="text-gray-300">property and separate 8-tuples that yield an additional multiple-of-four property that is hidden but notable in the variance. It is imaginable that the same property causes the five-round multiple-of-four distinguisher in Appendix <a href="#page-42-1">B.3.</a></p>

    <p class="text-gray-300">Recall Equation <a href="#page-14-1">(10)</a> that consisted of eight key-dependent variables for <em>i</em> 6= <em>j</em>:</p>

    <p class="text-gray-300"><span class="math">$2S(2S(2x_i \\oplus K^1[0]) \\oplus K^2[0]) \\oplus 3S(S(3x_i \\oplus K^1[1]) \\oplus K^2[5])</span>$</p>

    <p class="text-gray-300"><span class="math">$\\oplus S(2S(x_i \\oplus K^1[2]) \\oplus K^2[10]) \\oplus S(S(x_i \\oplus K^1[3]) \\oplus K^2[15])</span>$</p>

    <p class="text-gray-300"><span class="math">$= 2S(2S(2x_j \\oplus K^1[0]) \\oplus K^2[0]) \\oplus 3S(S(3x_j \\oplus K^1[1]) \\oplus K^2[5])</span>$</p>

    <p class="text-gray-300"><span class="math">$\\oplus S(2S(x_j \\oplus K^1[2]) \\oplus K^2[10]) \\oplus S(S(x_j \\oplus K^1[3]) \\oplus K^2[15]).</span>$</p>

    <p class="text-gray-300">For different in- or output positions, the equations differ naturally. In all cases, however, we have eight cells as degrees of freedom, i.e., 2<sup>32</sup> possible values of keys and plaintexts. For simplicity, we denote them as <em>&kappa;</em> 1 [0<em>..</em>3]<em>, &kappa;</em><sup>2</sup> [0<em>..</em>3] in all cases. For each value of the eight <em>&kappa;</em> 1 [0<em>..</em>3]<em>, &kappa;</em><sup>2</sup> [0<em>..</em>3], we compute the equation over all 2<sup>4</sup> values of <em>x<sup>i</sup></em> , form their 2 4 2 pairs, and count the number of collisions. For an ideal permutation, we would expect</p>

    <p class="text-gray-300"><span class="math">$\\begin{split} \\mu_{\\mathsf{rand}} &amp;= (2^4)^8 \\cdot \\binom{2^4}{2} \\cdot (2^{-4} - 2^{-64.093}) \\simeq 32\\,212\\,254\\,719.999\\dots \\text{ and} \\\\ \\sigma_{\\mathsf{rand}} &amp;\\simeq 173\\,778.563, \\end{split}</span>$</p>

    <p class="text-gray-300">whereas we would expect for Small-AES in theory &ndash; that is, without an influence of the indices from the MixColumns matrix or the S-box:</p>

    <p class="text-gray-300"><span class="math">$\\mu_{\\text{Small-AES}} = (2^4)^8 \\cdot {2^4 \\choose 2} \\cdot (2^{-4} + 2^{-15.792}) \\simeq 32\\,221\\,796\\,920.671\\dots</span>$
and  <span class="math">\\sigma_{\\text{Small-AES}} \\simeq 173\\,802.580.</span></p>

    <p class="text-gray-300"><strong>Implementation.</strong> In practice, the influences the of S-box and MixColumns matrix cause deviations that are predictable by the 16 &times; 16 cell-dependent equations. We implemented the system for Small-AES with its original and six alternative S-boxes. The results are</p>

    <p class="text-gray-300"></p>

    <div class="overflow-x-auto my-4">
      <table class="min-w-full text-sm text-gray-300">
        <thead>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"><b>(0</b> )</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">(4)</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">(8)</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">(12)</th>
        </thead>
        <tbody>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">0 4 8 12</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">12 0 4 8</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">8 12 0 4</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">4 8 12 0</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1 5 9 13</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">13 1 5 9</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">9 13 1 5</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">5 9 13 1</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">2 6 1014</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">14 2 6 10</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1014 2 6</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">6 1014 2</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">3 7 11 15</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">15 3 7 11</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">11 15 3 7</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">7 11 15 3</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><b>(1)</b></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><b>(5</b> )</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">(9)</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><b>(13)</b></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">15 3 7 11</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">11 15 3 7</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">7 11 15 3</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">3 7 11 15</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">12 0 4 8</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">8 12 0 4</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">4 8 12 0</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">0 4 8 12</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">13 1 5 9</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">9 13 1 5</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">5 9 13 1</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1 5 9 13</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">14 2 6 10</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">101426</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">6 1014 2</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">2 6 1014</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><b>(2</b> )</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">(6)</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">(10)</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">(14)</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">(2)<br>1014 2 6</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">(6)<br>6 1014 2</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">(10)<br>2 6 1014</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">(14)<br>14 2 6 10</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1014 2 6</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">6 10 14 2</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">2 6 1014</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">14 2 6 10</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1014 2 6<br>11 <b>15</b> 3 7</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">6 10 14 2<br>7 11 15 3</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">2 6 10 14<br>3 7 11 15</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">14 2 6 10<br>15 3 7 11</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1014 2 6<br>11 <b>15</b> 3 7<br>8 12 0 4</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">6 1014 2<br>7 1115 3<br>4 8 12 0</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">2 6 10 14<br>3 7 11 15<br>0 4 8 12</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">14 2 6 10<br>15 3 7 11<br>12 0 4 8</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1014 2 6<br>1115 3 7<br>8 12 0 4<br>9 13 1 5</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">6 10 14 2<br>7 11 15 3<br>4 8 12 0<br>5 9 13 1</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">2 6 1014<br>3 7 11 <mark>15</mark><br>0 4 8 12<br>1 5 9 13</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">14 2 6 10<br>15 3 7 11<br>12 0 4 8<br>13 1 5 9</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1014 2 6<br>1115 3 7<br>8 12 0 4<br>9 13 1 5</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">6 1014 2<br>7 1115 3<br>4 8 12 0<br>5 9 13 1</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">2 6 1014<br>3 7 11 <mark>15</mark><br>0 4 8 12<br>1 5 9 13<br>(11)</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">14 2 6 10<br>15 3 7 11<br>12 0 4 8<br>13 1 5 9<br>(15)</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1014 2 6<br>1115 3 7<br>8 12 0 4<br>9 13 1 5<br>(3)<br>5 9 13 1</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">6 1014 2<br>7 1115 3<br>4 8 12 0<br>5 9 13 1<br>(7)<br>1 5 9 13</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">2 6 1014<br>3 7 1115<br>0 4 8 12<br>1 5 9 13<br>(11)<br>13 1 5 9</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">14 2 6 10<br>15 3 7 11<br>12 0 4 8<br>13 1 5 9<br>(15)<br>9 13 1 5</td>
          </tr>
        </tbody>
      </table>
    </div>

    <p class="text-gray-300">Figure 16: Permutations of numbers of solutions for each input byte, where the bold index in parentheses refers to the position of the  <span class="math">\\delta</span> -sets in the plaintext,  <span class="math">i_{in}</span> , and the position in the small squares the index of the output (colliding) cell  <span class="math">i_{out}</span> . The blue cells are exemplary for the position  <span class="math">(i_{in}, i_{out}) = (0, 15)</span> , the best distinguisher for Small-AES.</p>

    <p class="text-gray-300">provided in Figure 17. For each S-box, we obtained distinct values for each output cell. The numbers of solutions in each row are permutations of each other with strong regularity. More precisely, the numbers of solutions repeat as shown by equal indices in Figure 16. This means, the first row of the left part of Figure 17 corresponds to the top-left of Figure 16. For  <span class="math">i_{\\rm in}=0</span> , the position  <span class="math">i_{\\rm out}=15</span>  yields the highest number of collisions,  <span class="math">32\\,239\\,747\\,072</span> . For  <span class="math">i_{\\rm in}=1</span> , this value repeats at index  <span class="math">i_{\\rm out}=0</span> ; for  <span class="math">i_{\\rm in}=2</span> , this value repeats at index  <span class="math">i_{\\rm out}=5</span> ; and for  <span class="math">i_{\\rm in}=3</span> , this value repeats at index  <span class="math">i_{\\rm out}=10</span> . This corresponds to the darkest cells in the left part of Figure 17. The situation is the same for the distinguisher with alternative S-boxes, e.g., compare to that of PRESENT, in the right part of Figure 17.</p>

    <p class="text-gray-300"><strong>Practical Verification.</strong> We implemented the position-dependent four-round distinguisher also for Small-AES with its original S-box, and with the PRESENT S-box to verify our approach. Figure 18 illustrates the average means from our experiments with  <span class="math">2^{23}</span>   <span class="math">\\delta</span> -sets for Small-AES on the left, in terms of the deviation from the theoretical mean of a pseudo-random permutation 62 914 600 in multiples of its standard deviation of  <span class="math">\\sigma \\simeq 7931</span> . Therefore, we consider the trail from input nibble 1 to output nibble 15 for our distinguisher for Small-AES. The corresponding figure for the PRP possessed about  <span class="math">\\pm 0.6\\sigma</span>  as the highest deviation. One can observe that the figures are close to our theoretical prediction.</p>

    <p class="text-gray-300">One can further observe significant deviations between the combinations. Recall that the range of  <span class="math">[-\\sigma..+\\sigma]</span>  yields no obvious distinguisher. In contrast, the range of  <span class="math">[+2\\sigma..+4\\sigma]</span>  yields roughly the theoretically expected distinguisher. Interestingly, the majority of combinations yield distinguishers for Small-AES. More detailed, for each input index, a single output index possesses a mean close to the pseudorandom value, and two further indices are mostly in the range of  <span class="math">[+\\sigma..+2\\sigma]</span> . All further combinations give higher means. One combination per input index peaked particularly with a derivation of about  <span class="math">+7\\sigma</span> .</p>

      <h3 id="app-e.2" class="text-xl font-semibold mt-8">E.2 Index Dependencies of The Five-round Distinguisher</h3>

    <p class="text-gray-300">Again, we emphasize that our assumptions approximate the structures of AES and Small-AES. For consistency, we iterated again over the cell at index 1 in the plaintexts in Setting (1) in our distinguisher on five rounds. Since our distinguisher starts again from a single cell, we expect weaker deviations due to the additional round compared to our</p>

    <p class="text-gray-300">    <img src="_page_59_Figure_2.jpeg" alt="" class="my-4 max-w-full" />
</p>

    <p class="text-gray-300">Figure 17: Theoretical index-dependent means from the equation system for our four-round distinguisher with the S-box of Small-AES and that of PRESENT, in multiples of  <span class="math">|\\mu_{\\text{Small-AES}} - \\mu_{\\text{rand}}|</span>  deviations from the mean of the PRP. Each cell represents the mean of the result for the active input cell in the plaintexts (y-axis) and the tested inactive cell (x-axis) after four rounds without the final MixColumns operation. Darker color (ignorant of sign) imply better distinguishers.</p>

    <p class="text-gray-300">four-round distinguisher and due to the fact that it considers four cells after three full rounds at a time. Figure 19 presents our preliminary results. One can observe that all choices for the active input cell yield distinguishers that are at least  <span class="math">2.2\\sigma</span>  above the mean of the PRP, with peaks at  <span class="math">4.9\\sigma</span> .</p>

    <p class="text-gray-300">Alternative S-boxes. The results for our four-round distinguisher from Section 4 for Small-AES in Table 3 ( <span class="math">\\mu=62\\,967\\,244</span> ,  <span class="math">\\sigma\\simeq7\\,030</span> ) deviate significantly from the theoretical prediction ( <span class="math">\\mu=62\\,933\\,200</span> ,  <span class="math">\\sigma\\simeq7\\,681</span> ). The deviation is as large as 6.85 standard-deviation units, in the sense that Small-AES appears to yield a considerably better distinguisher than anticipated. The naturally arising question is which reasons cause this phenomenon. In the beginning, we aimed to search for additional internal properties due to the AES. For each S-box, we employed again  <span class="math">2^{23}</span>  independent  <span class="math">\\delta</span> -sets. Surprisingly, our results indicate that the employed S-box can produce tremendous biases, both positively and negatively. Our results are listed in Table 10 and illustrated in Figure 20. In summary:</p>

    <ul class="list-disc list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li>The three real-world S-boxes show lower, but a noticeable distance to the random permutation. While PRESENT and PRINCE are below the prediction, the distance to the pseudo-random permutation is significant (1.85 and 1.92 standard-deviation units of the theoretical prediction for Small-AES).</li>
      <li>Two out of three toy S-boxes, Toy-8 and Toy-10, behave close to random (-0.02 and -0.09 standard-deviation units) and do not yield a distinguisher for the employed amount of data.</li>
      <li>The Toy-6 S-box strongly deviates from all others by having a significantly lower mean than the random permutation and all others (-2.86 standard-deviation units).</li>
    </ul>

    <p class="text-gray-300"><strong>Alternative S-boxes and Index Dependencies.</strong> The index pattern depends also strongly on the employed S-box. For comparison, the right side of Figure 18 shows the corresponding input-output pattern for Small-AES with the S-box of PRESENT. It differs strongly</p>

    <p class="text-gray-300">    <img src="_page_60_Figure_2.jpeg" alt="" class="my-4 max-w-full" />
</p>

    <p class="text-gray-300">Figure 18: Experimental index-dependent means from 50 experiments (random keys and  <span class="math">2^{23}</span>  &delta;-sets) on Small-AES with (right) its original S-box and (left) the PRESENT S-box. Values are multiplies of  <span class="math">\\sigma</span>  deviations from the mean of the PRP. The cell positions x, y represent the active plaintext cell (y-axis) and the tested ciphertext cell (x-axis) after four rounds without the final MixColumns operation.</p>

    <p class="text-gray-300">    <img src="_page_60_Figure_4.jpeg" alt="" class="my-4 max-w-full" />
</p>

    <p class="text-gray-300"><strong>Figure 19:</strong> Average means of five experiments with random keys and  <span class="math">2^{30}</span>   <span class="math">\\delta</span> -sets for our five-round distinguisher with Small-AES in  <span class="math">\\times \\sigma</span>  deviations from the mean of the PRP. Each cell represents the result for the active input cell in the plaintexts.</p>

    <p class="text-gray-300">from that of Small-AES with its original S-box. In general, the obtained means are lower and the peaks lower. All input positions have in common that there exist two to three output cells for each that input-cell position with means of  <span class="math">[4.5\\sigma..5.5\\sigma]</span> , i.e., strong distinguishers. Moreover, almost each input position (except two and five) share equally usable distinguishers with means of  <span class="math">[-2\\sigma..-3\\sigma]</span>  below the mean of the PRP.</p>

    <p class="text-gray-300">Figure 21 shows the details also for the S-boxes of PRINCE, PRIDE, Toy-6, Toy-8, and Toy-10. The considerably higher number of dark spots in the representations of the latter three illustrate the strong effect of the S-box for both positive and negative biases.</p>

    <p class="text-gray-300"><strong>S-box Properties.</strong> The question remains which S-box properties cause the deviations. We tested also particularly well-suited S-boxes: the 16 affine-equivalent representatives of optimal S-boxes from [LP07] with respect to differential and linear cryptanalysis. Moreover, we also considered the 10 representatives of platinum S-boxes with minimal CardD1 (number of 1-bit-to-1-bit differentials with non-zero probability) and CardL1 (number of 1-bit-to-1-bit linear approximations) from [ZBRL15].</p>

    <p class="text-gray-300">To compare the S-boxes, we chose a metric that captures the average absolute deviation of each output cell to the theoretically expected number of collisions  <span class="math">p_{\\mathsf{Small-AES}}</span>  for our four-round distinguisher. So, we used the Euclidean distance for this purpose. For an S-box  <span class="math">S: \\mathbb{F}_2^4 \\to \\mathbb{F}_2^4</span> , let  <span class="math">D_S</span>  denote our distance,  <span class="math">\\mathsf{X}_{i_{\\mathsf{out}}}^S</span>  the number of collisions from plaintext  <span class="math">\\delta</span> -sets that iterate over Cell  <span class="math">i_{\\mathsf{in}} = 0</span>  and count the number of pairs that collide in Cell  <span class="math">i_{\\mathsf{out}}</span>  after four rounds without the final MixColumns operation. Moreover, let  <span class="math">\\mathbb{E}\\left[\\mathsf{X}\\right] \\simeq 32\\,221\\,796\\,921</span>  denote the expected number of collisions. Note that the multi-set</p>

    <p class="text-gray-300">    <img src="_page_61_Figure_2.jpeg" alt="" class="my-4 max-w-full" />
</p>

    <p class="text-gray-300"><strong>Figure 20:</strong> Distribution of means from 100 experiments with random keys for our four-round distinguisher on variants of Small-AES with different S-boxes. Each experiment used 2<sup>23</sup> independent <em>&delta;</em>-sets.</p>

    <p class="text-gray-300">    <img src="_page_62_Figure_2.jpeg" alt="" class="my-4 max-w-full" />
</p>

    <p class="text-gray-300"><strong>Figure 21:</strong> Theoretical index-dependent means from the equation system for our four-round distinguisher with different S-boxes, in &times;|<em>p</em>Small-AES &minus; <em>p</em>rand| deviations from the mean of the PRP. Each cell represents the result for the active input cell in the plaintexts (<strong>y</strong>-axis) and the tested inactive cell (<strong>x</strong>-axis) after four rounds without the final MixColumns operation. Darker colors (ignorant of sign) imply better distinguishers.</p>

    <p class="text-gray-300"><strong>Table 10:</strong> Results of the four-round distinguisher on Small-AES with different S-boxes and 100 random keys. Speck-64-96 has been used as PRP. Difference = to the theoretical value;  <span class="math">\\mathbf{DP}_{\\text{max}}</span>  = the maximal number of pairs for a differential through the S-box; Var = variance; hom. = homogeneous;  <span class="math">\\sqrt{-}</span>  = yes/no.</p>

    <div class="overflow-x-auto my-4">
      <table class="min-w-full text-sm text-gray-300">
        <thead>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"></th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"></th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"></th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">Difference</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">e to Theory</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"></th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"></th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"></th>
        </thead>
        <tbody>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Instance</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">\\mu</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">\\sigma</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">\\pi</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Small-AES</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">DU</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Var</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Hom.</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Theory</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">62 914 000.</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">7680.</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-19200.</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">PRP</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">62915004.</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">7820.</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">+1004.</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-18196.</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Theory</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">62 933 200.</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">7681.</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">+19 200.</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">_</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Small-AES</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">62 967 244.</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">7 030.</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">+53244.</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">+34044.</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">4</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">344/225</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">\\checkmark</span></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">PRESENT</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">62 928 210.</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">8 321.</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">+14210.</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-4990.</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">4</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">416/225</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">PRINCE</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">62928742.</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">8 387.</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">+14742.</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-4458.</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">4</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">344/225</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">PRIDE</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">62940902.</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">7761.</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">+26902.</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">+7682.</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">4</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">416/225</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">_</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Toy-6</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">62892051.</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">8 151.</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-21949.</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-41148.</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">6</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">392/225</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Toy-8</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">62913848.</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">7443.</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-152.</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-19352.</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">8</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">464/225</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">_</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Toy-10</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">62913322.</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">7779.</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-678.</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-19878.</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">10</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">608/225</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-</td>
          </tr>
        </tbody>
      </table>
    </div>

    <p class="text-gray-300"><span class="math">\\{\\mathsf{X}^S_{i_\\mathsf{out}}\\}_{0 \\leq i_\\mathsf{out} \\leq 15}</span>  is invariant for different values of  <span class="math">i_\\mathsf{in}</span> . Then</p>

    <p class="text-gray-300"><span class="math">$D_{S} \\stackrel{\\text{def}}{=} \\sqrt{\\sum_{i_{\\text{out}}=0}^{15} \\left| \\mathsf{X}_{i_{\\text{out}}}^{S} - \\mathbb{E}\\left[\\mathsf{X}\\right] \\right|^{2}}</span>$</p>

    <p class="text-gray-300">    <img src="_page_63_Figure_6.jpeg" alt="" class="my-4 max-w-full" />
</p>

    <p class="text-gray-300"><strong>Figure 22:</strong> Correlation of  <span class="math">D_S</span> , i.e., the squared distance to the expected number of collisions over all output-cell positions and the variance of our tested S-boxes.</p>

    <p class="text-gray-300">We tested whether the distances are correlated with particular S-box properties. Grassi and Rechberger [GR19] already suggested that their five-round distinguisher on the AES would be related to the variance of the S-box. Therefore, the correlation of the  <span class="math">D_S</span>  measure to the S-box would be interesting, which could be evaluated by the Pearson correlation coefficient  <span class="math">\\rho</span> . We determined its r-value and p-value; Recall that for two random variables</p>

    <p class="text-gray-300">X and Y:</p>

    <p class="text-gray-300"><span class="math">$\\rho_{X,Y} \\stackrel{\\text{def}}{=} \\frac{\\text{cov}(X,Y)}{\\sigma_X \\cdot \\sigma_Y},</span>$</p>

    <p class="text-gray-300">where  <span class="math">\\operatorname{cov}(\\mathsf{X},\\mathsf{Y}) =^{\\operatorname{def}} \\mathbb{E}\\left[(\\mathsf{X} - \\mu_\\mathsf{X}) \\cdot (\\mathsf{Y} - \\mu_\\mathsf{Y})\\right]</span>  is the covariance of X and Y. We obtained  <span class="math">(r,p) \\simeq (0.812, 1.637 \\cdot 10^{-13})</span> , i.e., a high correlation of 0.812; the <em>p</em>-value denotes a very small probability that our results were observed but would be uncorrelated. The relationship is depicted in Figure 22. S-boxes with low variances are considerably closer to the expected numbers of collisions. The highest deviations were observed for the random S-boxes  <span class="math">S_{17}</span>  and  <span class="math">S_3</span>  as well as for Toy-10, whose variances were the highest 656, 608, and 608. Though, several S-boxes with a low variance of 416/256 (e.g. that of PRIDE) had considerably large values of  <span class="math">D_S</span> . As a result, the variance is related, though, does not fully explain the quality of an S-box. We further observed that the ten S-boxes (nine optimal S-boxes 3&ndash;7, 10&ndash;13, and the Small-AES S-box) whose autocorrelation-table entries  <span class="math">a_{i,j}</span> , for i,j&gt;0 consisted of only values  <span class="math">\\pm 8</span>  and contained no  <span class="math">\\pm 16</span> , (which implied the minimal variance of 344/256) all had low values of  <span class="math">D_S</span> . This implied the absence of linear structures.</p>

    <p class="text-gray-300"><strong>Table 11:</strong> S-box properties, in ascending order by  <span class="math">D_S</span> . DU = differential uniformity, lin. = linearity, NL = nonlinearity, LS = linear structures.</p>

    <div class="overflow-x-auto my-4">
      <table class="min-w-full text-sm text-gray-300">
        <thead>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">Name</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">Sbox</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"><span class="math">D_S</span></th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">Var.</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">DU</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">Lin.</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">NL</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">LS</th>
        </thead>
        <tbody>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Optimal-06</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">[0 1 2 13 4 7 15 6 8 12 11 9 10 14 5 3]</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">20440130</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">344.00</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">4</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">8</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">4</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">_</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Optimal-04</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">[0 1 2 13 4 7 15 6 8 12 9 11 10 14 5 3]</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">22521284</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">344.00</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">4</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">8</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">4</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">_</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Optimal-03</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">[0121347156812531014119]</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">22706595</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">344.00</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">4</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">8</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">4</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Optimal-11</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">[0121347156814111059123]</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">23218095</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">344.00</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">4</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">8</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">4</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">{\\bf Optimal \\text{-} 07}</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">[0121347156812141110935]</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">24444860</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">344.00</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">4</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">8</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">4</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Small-AES</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">[6 11 5 4 2 14 7 10 9 13 15 12 3 1 0 8]</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">24893844</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">344.00</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">4</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">8</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">4</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">_</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Platinum-05</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">[0134117149261035811512]</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">26272446</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">416.00</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">4</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">8</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">4</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">&#10003;</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Optimal-12</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">[0 1 2 13 4 7 15 6 8 14 11 10 9 3 12 5]</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">27188316</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">344.00</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">4</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">8</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">4</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">_</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Platinum-02</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">[0129761152311414138105]</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">27800383</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">416.00</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">4</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">8</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">4</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">&#10003;</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Random-06</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">[1240796133514810215111]</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">28205615</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">344.00</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">6</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">12</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">2</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">\\checkmark</span></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">:</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Random-02</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">[8411105121326159147310]</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">73193659</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">512.00</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">6</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">12</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">2</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><b>&radic;</b></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">PRIDE</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">[0481515149271012111363]</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">79057073</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">416.00</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">4</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">8</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">4</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">&#10003;</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Random-17</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">[11 14 13 8 2 7 12 6 5 0 4 15 10 9 3 1]</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">111443494</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">656.00</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">8</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">16</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">0</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">&#10003;</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Random-03</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">[7 1 5 10 4 11 12 3 13 8 9 15 14 2 0 6]</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">179623034</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">608.00</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">8</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">16</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">0</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">\\checkmark</span></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Toy-10</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">[6412507214115313810911]</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">192390502</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">608.00</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">10</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">12</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">2</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">\\checkmark</span></td>
          </tr>
        </tbody>
      </table>
    </div>

    <p class="text-gray-300">The Heys-Liu Integral Distinguisher on BSPN. In 2014, Heys [Hey14] conducted a similar analysis BSPN [YTH96], a byte-wise variant of the involutional SPN of [HT96]. BSPN transforms a vector of eight bytes through SubBytes, a mixing layer, and AddRoundKeys, similar to the AES and with the same S-box, but with a mixing layer that multiplies the state with the circulant matrix  <span class="math">o(0,1,\\ldots,1)</span> . The round function of BSPN is therefore simpler and a similar integral as for the AES applies. Heys and Liu studied a probabilistic extension of the three-round integral. More precisely, they studied the probability of obtaining a zero sum in the individual bytes after three rounds that naturally allows them to be traced through the subsequent round. In contrast to our approach, they studied the probability that the sum of an entire  <span class="math">\\delta</span> -set of 256 texts is zero with a probability significantly deviating from random.</p>

    <p class="text-gray-300"></p>

    <div class="overflow-x-auto my-4">
      <table class="min-w-full text-sm text-gray-300">
        <thead>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">(a) Mean and standard deviation of the Heys-Liu experiments adapted to four rounds of Small-AES with</th>
        </thead>
        <tbody>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">100 experiments with random keys.</td>
          </tr>
        </tbody>
      </table>
    </div>

    <div class="overflow-x-auto my-4">
      <table class="min-w-full text-sm text-gray-300">
        <thead>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"></th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">Random perr</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">nutation</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">Small-AES</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"></th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"></th>
        </thead>
        <tbody>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">\\delta</span> -sets <span class="math">s</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">\\mu</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">\\sigma</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">\\mu</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">\\sigma</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">24</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1 048 573.120</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">964.778</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1 049 134.150</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1 079.363</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">26</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">4194297.190</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">2182.769</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">4196155.600</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">2382.283</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">28</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">16776997.485</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">3808.268</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">16785415.790</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">5787.742</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">30</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">67109083.490</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">8 114.173</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">67143877.360</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">16479.876</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
        </tbody>
      </table>
    </div>

    <p class="text-gray-300">    <img src="_page_65_Figure_4.jpeg" alt="" class="my-4 max-w-full" />
</p>

    <p class="text-gray-300"><strong>Figure 23:</strong> Results of the Heys-Liu experiments adapted to four rounds of Small-AES with 100 experiments with random keys.</p>

    <p class="text-gray-300"><strong>Adaption to Small-AES.</strong> Inspired by their approach, we conducted a similar study for round-reduced AES. Since we expected the result to be inapplicable for the AES, we considered Small-AES instead. More precisely, we employed 100 random keys and  <span class="math">2^s</span>   <span class="math">\\delta</span> -sets that iterated over all  <span class="math">2^4</span>  values of the first input byte for each. We counted the number of times that we obtained a zero sum in the first output byte after almost four rounds, i.e., without the final MixColumns operation. Our results are illustrated in Figure 23 for  <span class="math">s \\in \\{28, 30\\}</span> ; detailed means and standard deviations are provided for those as well as for  <span class="math">s \\in \\{24, 26\\}</span>  in Table 23a.</p>

    <p class="text-gray-300"><strong>Interpretation.</strong> We see considerable differences in the distribution starting from s=28, although still a broad overlap of both distributions. For s=30, the different distributions become apparent. From our point of view, the distinguisher is a consequence of ours, but significantly more sophisticated to explore. We leave its more detailed foundations as interesting future work.</p>

    </section>
`;
---

<BaseLayout title="Extended Truncated-differential Distinguishers on Round-redu... (2019/622)">
  <article class="max-w-4xl mx-auto article-prose">
    <nav class="mb-8">
      <a href="/papers" class="text-blue-400 hover:text-blue-300">
        &larr; Back to Papers
      </a>
    </nav>

    <header class="mb-12">
      <h1 class="text-3xl font-bold mb-4"
        set:html={TITLE_HTML} />
      <p class="text-gray-400 mb-2"
        set:html={AUTHORS_HTML} />
      <p class="text-gray-500 text-sm mb-4">
        2019 &middot; eprint 2019/622
      </p>
      <div class="flex gap-4 text-sm">
        <a
          href={EPRINT_URL}
          target="_blank"
          rel="noopener noreferrer"
          class="text-blue-400 hover:text-blue-300"
        >
          Paper (eprint) &rarr;
        </a>
      </div>
      <PaperDisclaimer eprintUrl={EPRINT_URL} />
      <p class="mt-1 text-xs text-gray-600">
        Converted with: {CRAWLER} &middot; {CONVERTED_DATE}
      </p>
    </header>

    <nav id="toc" class="mb-10 p-6 rounded-lg" style="background: rgba(255,255,255,0.03); border: 1px solid rgba(255,255,255,0.06);">
      <h2 class="text-lg font-bold mb-4">Table of Contents</h2>
      <ol class="space-y-1 text-sm text-gray-300
        list-decimal list-inside">
        <li>
          <a href="#sec-1" class="hover:text-white">Introduction</a>
          <ol class="ml-6 mt-1 space-y-1 list-decimal
            list-inside text-gray-400">
            <li><a href="#sec-1.1" class="hover:text-white">Distinguishers on Round-reduced AES</a></li>
            <li><a href="#sec-1.2" class="hover:text-white">Key-independent Distinguishers on Round-reduced AES</a></li>
            <li><a href="#sec-1.3" class="hover:text-white">From Integral to Truncated-differential Distinguishers</a></li>
          </ol>
        </li>
        <li>
          <a href="#sec-2" class="hover:text-white">Preliminaries</a>
          <ol class="ml-6 mt-1 space-y-1 list-decimal
            list-inside text-gray-400">
            <li><a href="#sec-2.1" class="hover:text-white">Distinguishers for Sums of Permutations</a></li>
            <li><a href="#sec-2.2" class="hover:text-white">The AES-128 and Its Subspaces</a></li>
            <li><a href="#sec-2.3" class="hover:text-white">S-box Properties</a></li>
            <li><a href="#sec-2.4" class="hover:text-white">Known Integral Distinguishers on Round-reduced AES</a></li>
          </ol>
        </li>
        <li><a href="#sec-3" class="hover:text-white">Statistical Framework</a></li>
        <li>
          <a href="#sec-4" class="hover:text-white">Four-round Truncated-differential Distinguisher</a>
          <ol class="ml-6 mt-1 space-y-1 list-decimal
            list-inside text-gray-400">
            <li><a href="#sec-4.1" class="hover:text-white">Adapting Patarin&#x27;s Setting to Three-round AES</a></li>
            <li><a href="#sec-4.2" class="hover:text-white">Theoretical Analysis</a></li>
            <li><a href="#sec-4.3" class="hover:text-white">Index Dependencies of The Four-round Distinguisher</a></li>
            <li><a href="#sec-4.4" class="hover:text-white">Verification</a></li>
          </ol>
        </li>
        <li>
          <a href="#sec-5" class="hover:text-white">Five-round Truncated-differential Distinguisher</a>
          <ol class="ml-6 mt-1 space-y-1 list-decimal
            list-inside text-gray-400">
            <li><a href="#sec-5.1" class="hover:text-white">Setting</a></li>
            <li><a href="#sec-5.2" class="hover:text-white">Theoretical Analysis</a></li>
            <li><a href="#sec-5.3" class="hover:text-white">Verification</a></li>
          </ol>
        </li>
        <li>
          <a href="#sec-6" class="hover:text-white">Six-round Key-recovery Attack</a>
          <ol class="ml-6 mt-1 space-y-1 list-decimal
            list-inside text-gray-400">
            <li><a href="#sec-6.1" class="hover:text-white">Relations between Success Probability, Advantage and Data</a></li>
            <li><a href="#sec-6.2" class="hover:text-white">Experimental Verification</a></li>
          </ol>
        </li>
        <li><a href="#sec-7" class="hover:text-white">Six-round Truncated-differential Distinguisher</a></li>
        <li><a href="#sec-8" class="hover:text-white">Discussion and Conclusion</a></li>
      </ol>
      <p class="text-xs text-gray-500 mt-4 mb-1 font-semibold">
        Appendices
      </p>
      <ol class="space-y-1 text-sm text-gray-400
        list-[upper-alpha] list-inside">
        <li><a href="#app-a" class="hover:text-white">Alternative S-boxes</a></li>
        <li>
          <a href="#app-b" class="hover:text-white">Multiple-of-n Properties</a>
          <ol class="ml-6 mt-1 space-y-1 list-decimal
            list-inside text-gray-400">
            <li><a href="#app-b.1" class="hover:text-white">Five-round Multiple-of-Eight Property</a></li>
            <li><a href="#app-b.2" class="hover:text-white">Four-round Multiple-of-32 Property for Small-AES</a></li>
            <li><a href="#app-b.3" class="hover:text-white">Multiple-of-four Distinguisher on Five-round Small-AES</a></li>
            <li><a href="#app-b.4" class="hover:text-white">Multiple-of-four Key-recovery Attack on Six-round Small-AES</a></li>
          </ol>
        </li>
        <li>
          <a href="#app-c" class="hover:text-white">Expectation of The Distinguishers</a>
          <ol class="ml-6 mt-1 space-y-1 list-decimal
            list-inside text-gray-400">
            <li><a href="#app-c.1" class="hover:text-white">Expectation of The Five-round Distinguisher</a></li>
            <li><a href="#app-c.2" class="hover:text-white">Expectation of The Four-round Distinguisher</a></li>
          </ol>
        </li>
        <li>
          <a href="#app-d" class="hover:text-white">Variance of The Distinguishers</a>
          <ol class="ml-6 mt-1 space-y-1 list-decimal
            list-inside text-gray-400">
            <li><a href="#app-d.1" class="hover:text-white">Variance of The Five-round Distinguisher</a></li>
            <li><a href="#app-d.1.1" class="hover:text-white">Recap of the Variance from [GR19]</a></li>
            <li><a href="#app-d.1.2" class="hover:text-white">Variance of Our Five-round Distinguisher</a></li>
            <li><a href="#app-d.1.3" class="hover:text-white">Variance of Our Five-round Distinguisher for Small-AES</a></li>
            <li><a href="#app-d.1.4" class="hover:text-white">Experimental Verification of the Variance of Our Five-round Distinguisher for Small-AES</a></li>
            <li><a href="#app-d.1.5" class="hover:text-white">Discussion</a></li>
            <li><a href="#app-d.2" class="hover:text-white">Variance of The Four-round Distinguisher</a></li>
            <li><a href="#app-d.2.1" class="hover:text-white">Variance of Our Four-round Distinguisher for The AES</a></li>
            <li><a href="#app-d.2.2" class="hover:text-white">Variance of Our Four-round Distinguisher for Small-AES</a></li>
            <li><a href="#app-d.2.3" class="hover:text-white">Experimental Verification of the Variance of Our Four-round Distinguisher for Small-AES</a></li>
            <li><a href="#app-d.2.4" class="hover:text-white">Discussion</a></li>
          </ol>
        </li>
        <li>
          <a href="#app-e" class="hover:text-white">Index Dependencies for Small-AES</a>
          <ol class="ml-6 mt-1 space-y-1 list-decimal
            list-inside text-gray-400">
            <li><a href="#app-e.1" class="hover:text-white">Index Dependencies of The Four-round Distinguisher</a></li>
            <li><a href="#app-e.2" class="hover:text-white">Index Dependencies of The Five-round Distinguisher</a></li>
          </ol>
        </li>
        <li><a href="#app-f" class="hover:text-white">S-box Dependencies of The Four-round Distinguisher for Variants of Small-AES</a></li>
        <li><a href="#app-g" class="hover:text-white">Adapted Heys-Liu Probabilistic Integral Distinguisher on Four-round Small-AES</a></li>
      </ol>
      <p class="text-xs text-gray-500 mt-4 mb-1 font-semibold">
        Additional
      </p>
      <ul class="space-y-1 text-sm text-gray-400
        list-disc list-inside">
        <li><a href="#references" class="hover:text-white">References</a></li>
      </ul>
    </nav>


    <Fragment set:html={CONTENT} />

    <PaperHistory slug="extended-truncated-differential-distinguishers-on-round-2019" />
  </article>
</BaseLayout>
