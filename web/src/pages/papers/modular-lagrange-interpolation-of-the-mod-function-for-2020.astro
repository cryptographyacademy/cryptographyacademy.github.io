---
import BaseLayout from '../../layouts/BaseLayout.astro';

const EPRINT_URL = 'https://eprint.iacr.org/2020/1355';
const CRAWLER = 'mistral';
const CONVERTED_DATE = '2026-02-16';
const TITLE_HTML = 'Modular Lagrange Interpolation of the Mod Function for Bootstrapping of Approximate HE';
const AUTHORS_HTML = 'Charanjit S.  Jutla, Nathan Manohar';

const CONTENT = `    <p class="text-gray-300">Charanjit S. Jutla IBM T. J. Watson Research Center Nathan Manohar UCLA</p>

    <h6 id="sec-2" class="text-base font-medium mt-4">Abstract</h6>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">We introduce a novel variant of Lagrange interpolation called modular Lagrange interpolation that allows us to obtain and prove error bounds for explicit low-degree polynomial approximations of a function on a union of equally-spaced small intervals even if the function overall is not continuous. We apply our technique to the mod function and obtain explicit low-degree polynomial approximations with small error. In particular, for every <span class="math">k</span> and <span class="math">N&amp;gt;&amp;gt;k</span>, we construct low-degree polynomials that approximate <span class="math">f(x)\\,=\\,x\\bmod N</span>, for $</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">f(x)</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\leq 1<span class="math"> and </span></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">x</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\leq kN<span class="math">, to within </span>\\operatorname{O}(1/N)<span class="math"> additive approximation. For </span>k=O(\\log N)<span class="math">, the result is generalized to give </span>\\operatorname{O}(d)<span class="math">-degree polynomial approximations to within </span>\\operatorname{O}(N^{-d})<span class="math"> error for any </span>d\\geq 1$. Literature in approximation theory allows for arbitrary precision polynomial approximation of only smooth functions, whereas the mod function is only piecewise linear.</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">These polynomials can be used in bootstrapping for approximate homomorphic encryption, which requires computing the mod function near multiples of the modulus. Our work bypasses the fundamental error of approximation in prior works caused by first approximating the mod function by a scaled sine function. We implement the bootstrapping of HEAAN using our polynomials and profile various parameter settings. For example, we demonstrate bootstrapping that can achieve 67 bit message precision, larger than the precision of a double variable, whereas the most advanced prior work was only capable of up to 40 bit message precision.</p>

    <h2 id="sec-3" class="text-2xl font-bold">1 Introduction</h2>

    <p class="text-gray-300">Polynomial interpolation is a fundamental problem in mathematics. It is well known that given <span class="math">n+1</span> distinct points <span class="math">x_{0},x_{1},\\ldots,x_{n}</span> and their corresponding values <span class="math">y_{0},y_{1},\\ldots,y_{n}</span>, there is a unique polynomial <span class="math">p(x)</span> of degree at most <span class="math">n</span> such that <span class="math">p(x_{i})=y_{i}</span> for all <span class="math">i\\in\\{0,1,\\ldots,n\\}</span>. Using Lagrange interpolation, it is possible to easily determine this unique polynomial <span class="math">p(x)</span>. Polynomial interpolation’s utility goes beyond finding polynomials that pass through points in</p>

    <p class="text-gray-300">a dataset. Suppose we are given some arbitrary smooth function  <span class="math">f(x)</span>  on a contiguous interval. Then, using Lagrange interpolation, we can hope to find a low-degree polynomial that is a good approximation of  <span class="math">f</span>  on this interval. This immediately raises two questions: 1) How many points should we use for interpolation? and 2) How should these points be chosen?</p>

    <p class="text-gray-300">It is well-known that Lagrange interpolation of even a smooth function (on a contiguous interval) where the interpolation points are chosen as equally spaced points leads to bad approximations (see e.g. [5]). This is known as the "Runge phenomenon", and a more technical explanation can be found in Section 3. However, it is also known that such smooth functions can be asymptotically approximated with high precision if the density of the points in the contiguous interval, say  <span class="math">[-1,1]</span> , is proportional to  <span class="math">(1 - x^{2})^{-1/2}</span>  (that is, the density of points is higher near the edges of the interval, see e.g. [11, 5]). A common choice of points are the Chebyshev nodes or roots of the  <span class="math">n</span> th Chebyshev polynomial  <span class="math">T_{n}(x)</span> , which asymptotically satisfy this density function, which we will refer to as the Chebyshev density function. These lie in the interval  <span class="math">[-1,1]</span>  and are defined by the formula</p>

    <div class="my-4 text-center"><span class="math-block">x _ {j} = \\cos \\left(\\pi \\frac {2 (j + 1)}{2 n}\\right)</span></div>

    <p class="text-gray-300">for  <span class="math">j = 0,1,\\ldots ,n - 1</span> . Figure 1 shows the function  <span class="math">\\sin (\\pi x)</span>  on the interval  <span class="math">[-1,1]</span>  with points chosen according to the above formula for  <span class="math">n = 25</span>  and 50. For an arbitrary interval  <span class="math">[a,b]</span> , one can simply scale the distribution of points on  <span class="math">[-1,1]</span>  to this interval.</p>

    <p class="text-gray-300">!<a href="img-0.jpeg">img-0.jpeg</a> (a) 25 Chebyshev points</p>

    <p class="text-gray-300">!<a href="img-1.jpeg">img-1.jpeg</a> (b) 50 Chebyshev points Figure 1: Plots of  <span class="math">\\sin (\\pi x)</span>  on  <span class="math">[-1,1]</span>  with Chebyshev points.</p>

    <p class="text-gray-300">In fact, for a polynomial  <span class="math">f(x)</span>  that is  <span class="math">n + 1</span>  times differentiable on an interval  <span class="math">[a,b]</span> , the polynomial  <span class="math">p_n</span>  of degree  <span class="math">\\leq n</span>  obtained via Lagrange interpolation at  <span class="math">n + 1</span>  distinct points</p>

    <p class="text-gray-300"><span class="math">t_{0},t_{1},\\ldots,t_{n}\\in[a,b]</span> will have error at any point <span class="math">x\\in[a,b]</span> given by the formula</p>

    <p class="text-gray-300"><span class="math">f(x)-p_{n}(x)=\\frac{f^{(n+1)}(\\psi_{x})}{(n+1)!}\\cdot\\prod_{i=0}^{n}(x-t_{i}),</span></p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">where <span class="math">\\psi_{x}</span> is some point in <span class="math">[a,b]</span> depending on <span class="math">x</span>. Since determining <span class="math">\\psi_{x}</span> is difficult, error analysis typically proceeds by upper bounding <span class="math">f^{(n+1)}(\\cdot)</span> on <span class="math">[a,b]</span> and then bounding $</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\prod_{i=0}^{n}(x-t_{i})</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"><span class="math">. It is known that setting the </span>t_{i}<span class="math">’s as the Chebyshev nodes scaled to </span>[a,b]$ minimizes this latter quantity. Thus, for a single contiguous interval, it is known how to obtain a good low-degree polynomial approximation and prove a good bound on the error. Algorithmic search methods that determine the minimax polynomial approximation of a continuous function on a closed interval are also well-studied, e.g. the Remez Algorithm <em>[21]</em>. However, in this work we will focus on constructive methods as that leads to better understanding of the tradeoffs in target applications. This is discussed in more detail in Section 9.</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">In this work, we ask a related question, motivated by its applications to cryptography. Suppose we have many far apart, equally spaced, (contiguous) intervals and a piecewise smooth function <span class="math">f</span> on these intervals, such that <span class="math">f</span> is not continuous on a single closed interval <em>containing</em> these set of intervals. Is it possible to obtain a low-degree polynomial that approximates <span class="math">f</span> well, restricted to the set of small intervals?</p>

    <p class="text-gray-300">We show how to achieve the above and prove good error bounds for bounded piecewise linear (or low-degree) functions using a new technique that we call <em>modular Lagrange interpolation</em>. If we simply tried to apply standard Lagrange interpolation, we would immediately run into problems trying to prove an error bound, since the Lagrange interpolation theorem requires the function to be <span class="math">n+1</span> times differentiable, but the piece-wise smooth function is not continuous (or even necessarily defined) on a closed interval that contains these intervals. A common approach in previous works has been to approximate the piecewise linear function with a continuous function such as the sine function. But, this limits the approximation possible due to the error inherent in the continuous approximation. However, as discussed above, on a <em>single</em> interval, we know how to use Lagrange interpolation to find a low-degree polynomial approximation. Modular Lagrange interpolation refers to the method of “combining” these low-degree polynomials that work well on one specific interval into a single low-degree polynomial that simultaneously approximates the function well on <em>all</em> intervals. Crucial to the modular Lagrange interpolation technique is that the construction allows one to prove good error bounds. We remark that it is <em>not</em> equivalent to Lagrange interpolation on judiciously picked points in the intervals, e.g. those approximating the Chebyshev density function. However, our “combiners” will mimic the Chebyshev density function. The combiners behave similarly to Lagrange basis polynomials, which have the “delta function” property meaning that they evaluate to one at a specific point and to zero at all other points. However, the combiners must</p>

    <p class="text-gray-300">still approximate this delta function by a low-degree polynomial over intervals that are small but not negligible. To keep the degree small, we leverage the trade-off between the number of unit-sized intervals <span class="math">k</span> and the size <span class="math">N</span> separating these intervals, and a strategy similar to the Chebyshev density function works well to avoid the Runge phenomenon.</p>

    <p class="text-gray-300">While this strategy of making the “combiners” similar to Chebyshev-weighted Lagrange basis polynomials works well for simple approximations, to get approximations of <span class="math">\\mathrm{O}(N^{-c})</span> (for <span class="math">c&gt;1</span>) we must use a more advanced application of Lagrange interpolation, which approximates the function in each interval by at least <span class="math">(c+1)</span> points, and the combiners now depend on each such point rather than just the whole interval. A more technical introduction to modular Lagrange interpolation is given in Section 3.</p>

    <h3 id="sec-4" class="text-xl font-semibold mt-8">1.1 Application to Cryptography</h3>

    <p class="text-gray-300">The problem of finding a single low-degree polynomial approximation to a piece-wise function over many intervals is a natural math question and interesting in its own right. However, it turns out that this problem also has a major application to cryptography with regards to FHE bootstrapping, which we will now describe.</p>

    <p class="text-gray-300">The work of <em>[9, 8]</em> presented a new homomorphic encryption (HE) scheme for approximate arithmetic (called the CKKS HE scheme) over real/complex numbers. The CKKS HE scheme was considerably more efficient than other schemes for evaluating arithmetic circuits and leveraged properties of approximate arithmetic to achieve these efficiency gains. It has found many applications, among them privacy-preserving machine learning and secure genome analysis (see <em>[15, 20, 4, 17, 23, 16]</em> for some examples). However, the initial CKKS HE scheme lacked a bootstrapping procedure, and, thus, it was not a <em>fully</em> homomorphic encryption (FHE) scheme. This was remedied when <em>[7]</em> introduced the first bootstrapping procedure for the CKKS HE scheme, which followed the general template introduced by Gentry <em>[12]</em> of evaluating the decryption circuit homomorphically. The challenge here is that the decryption procedure for CKKS requires computing the mod function, which is not easily representable via an arithmetic circuit. In fact, the mod function modulo <span class="math">q</span> on the interval <span class="math">[-Kq,Kq]</span> for some integer <span class="math">K</span> is not even a continuous function. However, <em>[7]</em> made the clever observation that in the CKKS HE scheme, we have an upper bound <span class="math">m</span> on the size of the message, which can be made much smaller than <span class="math">q</span>. In this situation, we actually only need to be able to compute the mod function on points in <span class="math">[-Kq,Kq]</span> that are a distance at most <span class="math">m</span> from a multiple of <span class="math">q</span>. In this case, the mod function is periodic with period <span class="math">q</span> and is linear on each of the small intervals around a multiple of <span class="math">q</span>. Figure 2 shows the mod function along with the small intervals for approximation.</p>

    <p class="text-gray-300">The work of <em>[7]</em> observed that the mod function <span class="math">[t]_{q}</span> on these intervals can be approximated</p>

    <p class="text-gray-300">!<a href="img-2.jpeg">img-2.jpeg</a> Figure 2: The mod function with modulus  <span class="math">q = 10</span> . The solid red lines represent the small intervals on which we need to approximate.</p>

    <p class="text-gray-300">via a scaled sine function  <span class="math">S(t) = \\frac{q}{2\\pi}\\sin \\left(\\frac{2\\pi t}{q}\\right)</span> . This approximation introduces an inherent error that depends on the message upper bound  <span class="math">m</span> . Let  <span class="math">\\epsilon</span>  denote the ratio  <span class="math">\\frac{m}{q}</span> . Then, it can be shown that</p>

    <div class="my-4 text-center"><span class="math-block"></span></div>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">[ t ] _ {q} - S (t)</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\leq \\frac {2 \\pi^ {2}}{3} q \\epsilon^ {3}.</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <div class="my-4 text-center"><span class="math-block"></span></div>

    <p class="text-gray-300">If  <span class="math">\\epsilon</span>  is small enough, then this error can be sufficiently small for use in bootstrapping provided that  <span class="math">S(t)</span>  can be well-approximated by a low degree polynomial. The work of [7] along with several followup works [6, 14, 18] proceeded to provide methods of approximating this scaled sine function (or scaled cosine function in the case of [14] and scaled sine/cosine and inverse sine in the case of [18]) by a low-degree polynomial, which can then be plugged into the bootstrapping procedure of [7]. However, due to the inherent error between the mod function  <span class="math">[t]_q</span>  and the scaled sine function  <span class="math">S(t)</span> , this approach has a "fundamental error" that will occur regardless of how  <span class="math">S(t)</span>  is approximated. One of the problems with this is that in order for the error to be  <span class="math">O(1)</span>  (and, therefore, not destroy the message),  <span class="math">m</span>  must be  <span class="math">O(q^{2/3})</span> . This means that we must begin bootstrapping while the size of the encrypted message is considerably smaller than  <span class="math">q</span> , which is a source of inefficiency in the bootstrapping procedure, particularly in applications that require high precision. Compounding this problem is the fact that for large  <span class="math">q</span> , the size of the coefficients of the approximation of  <span class="math">S(t)</span>  grow. This requires the basis polynomials to be computed to higher precision and affects the stability of the computation, where the errors introduced by the approximate arithmetic are amplified due to the large</p>

    <p class="text-gray-300">coefficients. As a consequence, arbitrarily high-precision bootstrapping for CKKS is unknown.</p>

    <p class="text-gray-300">The reason obtaining high-precision bootstrapping for CKKS is important is that one of the main applications for CKKS is privacy-preserving machine learning. However, many ML algorithms require high precision computation in order to converge. This may be especially true during the learning phase of neural networks, which involves back propagation and integer division by private integers. Additional nonlinear steps involve pooling functions, threshold functions, etc. Moreover, due to their high depth, computing these ML algorithms homomorphically without bootstrapping is infeasible. Thus, for privacy-preserving ML applications, high-precision bootstrapping is required.</p>

    <p class="text-gray-300">Finding polynomial approximations of the mod function with error smaller than the “fundamental error” (by directly approximating the mod function instead of first approximating it via a scaled sine function) is one of the main ways one can hope to obtain high-precision bootstrapping for approximate homomorphic encryption. Finding such a method was explicitly posed as an open problem in <em>[14]</em>, which stated that they believe “finding another approximation of <span class="math">[\\cdot]_{q}</span> operation … can be a new breakthrough of improving the bootstrapping.”</p>

    <h3 id="sec-5" class="text-xl font-semibold mt-8">1.2 This Work</h3>

    <p class="text-gray-300">In this work, we introduce a method called modular Lagrange interpolation that can be used to obtain explicit low-degree polynomials that are provably good approximations of the mod function on small intervals around multiples of <span class="math">q</span>, exactly what is required for bootstrapping for approximate homomorphic encryption. Moreover, by avoiding approximating the mod function by a scaled sine function, our approximation does not inherently have a flat error associated with this approximation, and we are able to obtain more accurate approximations. Furthermore, we can explicitly upper bound the size of the coefficients of the polynomial in the Chebyshev polynomial basis, which is the preferred basis as it leads to a more stable calculation. The size of the coefficients in the Chebyshev polynomial basis directly affects the precision required for computing the approximating polynomial itself. This is the first work to give a comprehensive and robust solution to approximating the mod function by even bounding the size of the Chebyshev polynomial coefficients</p>

    <p class="text-gray-300">In particular, we give a degree sixty-three polynomial that approximates the mod function to <span class="math">\\mathrm{O}(N^{-1})</span> on intervals of size one, modulo <span class="math">N</span>. The constants hide the dependence on the number of intervals <span class="math">k</span>, but we show that these polynomials work well for <span class="math">k=12</span>, a common parameter setting of current HE schemes, with <span class="math">N=10^{6}</span>. We generalize this result to obtain <span class="math">\\mathrm{O}(N^{-d})</span> error-approximation for any <span class="math">d\\geq 1</span>, with <span class="math">\\mathrm{O}(d)</span>-degree polynomials. For <span class="math">d=4</span>, we get a polynomial of degree <span class="math">127</span> with an approximation error of <span class="math">2^{-72}</span>, which improves upon the fundamental error of <span class="math">2^{-57}</span> associated with the sine approximation found in previous approaches.</p>

    <p class="text-gray-300">A degree 127 polynomial can be computed by a circuit with multiplicative depth 7 and having low-depth is crucial, as it affects the HE-levels consumed during bootstrapping. For <span class="math">k=12</span>, polynomials that work well for smaller <span class="math">N</span>, i.e. <span class="math">N\\geq 128</span>, are shown with degree sixty-nine. Similarly, the result generalizes to O(<span class="math">N^{-d}</span>) error-approximation for any <span class="math">d\\geq 1</span>. Once again, we find that setting <span class="math">d=4</span> is sufficient to obtain an approximation error of <span class="math">2^{-22}</span>, which improves upon the fundamental error of <span class="math">2^{-18}</span> associated with the sine approximation. This degree 159 polynomial can be computed by a circuit with multiplicative depth 8. Even better approximations can be found in Tables 1 through 4 in Section 9.</p>

    <p class="text-gray-300">We implement and report CKKS bootstrapping using our polynomials and demonstrate that they enable high-precision bootstrapping for a variety of parameter settings. For example, our bootstrapping achieves 67 bit message precision, larger than the precision of a double variable, whereas prior work was only capable of up to 40 bit message precision. Our full bootstrapping results can be found in Table 6.</p>

    <h3 id="sec-6" class="text-xl font-semibold mt-8">1.3 Organization</h3>

    <p class="text-gray-300">In Section 2, we provide some background on Lagrange interpolation and the Chebyshev basis polynomials and show lemmas that will be useful in proving error bounds. In Section 3, we introduce our modular Lagrange interpolation for the mod function by considering the simpler setting of only 3 intervals. In Section 4, we increase the number of intervals to be parameterized by <span class="math">k</span> and show an <span class="math">O(1/N)</span>-approximation for large <span class="math">N</span>. In Section 5, we show a more general method that leads to <span class="math">O(N^{-d})</span> approximations for each <span class="math">d\\geq 1</span>. In Section 6, we show how to obtain <span class="math">O(N^{-d})</span> approximations for small <span class="math">N</span> (<span class="math">\\approx 100</span>). In Section 7, we provide an upper bound on the magnitude of coefficients of our polynomials in the Chebyshev basis. In Section 8, we show that using standard error analysis for Lagrange interpolation cannot lead to as good of error bounds as modular Lagrange interpolation. In Section 9, we describe the application to bootstrapping for approximate homomorphic encryption in more detail and evaluate the performance of our polynomials for typical parameter settings. In Section 10, we give our implementation results for CKKS bootstrapping using our polynomials for a variety of parameter settings and show that they enable high-precision bootstrapping. In Section 11, we discuss how to apply modular Lagrange interpolation to functions other than the mod function.</p>

    <h2 id="sec-7" class="text-2xl font-bold">2 Preliminaries</h2>

    <p class="text-gray-300">For integers <span class="math">a,b</span>, we use the notation <span class="math">[a..b]</span> to represent the set <span class="math">\\{a,a+1,\\ldots,b\\}</span>. For reals <span class="math">a,b</span>, the notation <span class="math">[a,b]</span> will represent the usual closed interval.</p>

    <p class="text-gray-300">We recall some background on Lagrange interpolation and relevant lemmas that will be useful when proving error bounds.</p>

    <h3 id="sec-8" class="text-xl font-semibold mt-8">2.1 Lagrange Interpolation</h3>

    <p class="text-gray-300">Given <span class="math">m+1</span> distinct points <span class="math">t_{0},...,t_{m}</span>, the <span class="math">j</span>th Lagrange basis polynomial <span class="math">\\ell^{(m)}_{j}(\\mathbf{x})</span> is given by</p>

    <p class="text-gray-300"><span class="math">\\ell^{(m)}_{j;t_{0},...,t_{m}}(\\mathbf{x})\\stackrel{{\\scriptstyle\\triangle}}{{=}}\\prod_{i\\in[0..m]\\setminus\\{j\\}}\\frac{\\mathbf{x}-t_{i}}{t_{j}-t_{i}}</span> (1)</p>

    <p class="text-gray-300">When <span class="math">m</span> is clear from context, we drop the superscript. Similarly, when <span class="math">t_{0},...,t_{m}</span> is clear from context, we drop these from the subscript. When <span class="math">t_{0},...,t_{m}</span> are collectively referred to as a set <span class="math">\\mathcal{S}</span>, we also abuse notation and write, for any <span class="math">z\\in\\mathcal{S}</span>,</p>

    <p class="text-gray-300"><span class="math">\\ell^{(m)}_{z;\\mathcal{S}}(\\mathbf{x})\\stackrel{{\\scriptstyle\\triangle}}{{=}}\\prod_{t\\in\\mathcal{S}\\setminus\\{z\\}}\\frac{\\mathbf{x}-t}{z-t}</span> (2)</p>

    <p class="text-gray-300">The Lagrange interpolation theorem states that for any polynomial <span class="math">f(\\mathbf{x})</span> (over a unique factorization domain) of degree <span class="math">m</span></p>

    <p class="text-gray-300"><span class="math">f(\\mathbf{x})=\\sum_{j\\in[0..m]}f(t_{j})*\\ell^{(m)}_{j}(\\mathbf{x}).</span></p>

    <p class="text-gray-300">Using the Lagrange interpolation theorem, we can prove the following lemma 2, which will be useful later in proving our error bounds. We start by proving a simpler version of the lemma.</p>

    <h6 id="sec-9" class="text-base font-medium mt-4">Lemma 1</h6>

    <p class="text-gray-300">Let <span class="math">R</span> be a unique-factorization domain. If <span class="math">m\\geq 1</span>, then for any distinct <span class="math">t_{0},...,t_{m}</span> in <span class="math">R</span>, <span class="math">\\sum_{j\\in[0..m]}(\\mathbf{x}-t_{j})*\\ell^{(m)}_{j;t_{0},...,t_{m}}(\\mathbf{x})</span> is identically zero.</p>

    <p class="text-gray-300">Proof: This follows from the fact that</p>

    <p class="text-gray-300"><span class="math">\\sum_{j\\in[0..m]}(\\mathbf{x}-t_{j})<em>\\ell^{(m)}_{j;t_{0},...,t_{m}}(\\mathbf{x})</span> <span class="math">=\\mathbf{x}</em>\\sum_{j\\in[0..m]}\\ell^{(m)}_{j}(\\mathbf{x})-\\sum_{j\\in[0..m]}t_{j}<em>\\ell^{(m)}_{j}(\\mathbf{x})</span> <span class="math">=\\mathbf{x}</em>1-\\mathbf{x}=\\,0,</span></p>

    <p class="text-gray-300">where we use the Lagrange interpolation theorem twice, as both <span class="math">1</span> and <span class="math">\\mathbf{x}</span> are polynomials of degree <span class="math">\\leq m</span>. <span class="math">\\square</span></p>

    <p class="text-gray-300">The above lemma generalizes as follows.</p>

    <p class="text-gray-300">Lemma 2 Let <span class="math">R</span> be a unique-factorization domain. Let <span class="math">F(\\mathbf{x},\\mathbf{y})</span> be a bivariate polynomial (over <span class="math">R</span>) of degree <span class="math">m&#x27;</span> in <span class="math">\\mathbf{y}</span> and with a factor <span class="math">(\\mathbf{x} - \\mathbf{y})</span>. In other words <span class="math">F(\\mathbf{x},\\mathbf{y})</span> can be written as</p>

    <div class="my-4 text-center"><span class="math-block">F (\\mathbf {x}, \\mathbf {y}) = (\\mathbf {x} - \\mathbf {y}) * \\sum_ {k \\in [ 0.. m ^ {\\prime} - 1 ]} a _ {k} (\\mathbf {x}) \\mathbf {y} ^ {k}</span></div>

    <p class="text-gray-300">where <span class="math">a_{k}(\\mathbf{x})</span> are polynomials (over <span class="math">R</span>) in <span class="math">\\mathbf{x}</span>. If <span class="math">m&#x27; \\leq m</span>, then for any distinct <span class="math">t_0, \\ldots, t_m</span> in <span class="math">R</span>, <span class="math">\\sum_{j \\in [0..m]} F(\\mathbf{x}, t_j) * \\ell_{j; t_0, \\ldots, t_m}^{(m)}(\\mathbf{x})</span> is identically zero.</p>

    <p class="text-gray-300">Proof: We have</p>

    <div class="my-4 text-center"><span class="math-block">\\begin{array}{l} \\sum_ {j \\in [ 0.. m ]} F (\\mathbf {x}, t _ {j}) * \\ell_ {j; t _ {0}, \\dots , t _ {m}} ^ {(m)} (\\mathbf {x}) \\\\ = \\sum_ {j \\in [ 0.. m ]} (\\mathbf {x} - t _ {j}) * \\ell_ {j} ^ {(m)} (\\mathbf {x}) * \\sum_ {k \\in [ 0.. m ^ {\\prime} - 1 ]} a _ {k} (\\mathbf {x}) t _ {j} ^ {k} \\\\ = \\sum_ {k \\in [ 0.. m ^ {\\prime} - 1 ]} a _ {k} (\\mathbf {x}) * \\sum_ {j \\in [ 0.. m ]} (\\mathbf {x} - t _ {j}) * \\ell_ {j} ^ {(m)} (\\mathbf {x}) * t _ {j} ^ {k} \\\\ = \\sum_ {k \\in [ 0.. m ^ {\\prime} - 1 ]} a _ {k} (\\mathbf {x}) * \\left[ \\mathbf {x} * \\sum_ {j \\in [ 0.. m ]} \\ell_ {j} ^ {(m)} (\\mathbf {x}) * t _ {j} ^ {k} - \\sum_ {j \\in [ 0.. m ]} \\ell_ {j} ^ {(m)} (\\mathbf {x}) * t _ {j} ^ {k + 1} \\right] \\\\ = \\sum_ {k \\in [ 0.. m ^ {\\prime} - 1 ]} a _ {k} (\\mathbf {x}) * [ \\mathbf {x} * \\mathbf {x} ^ {k} - \\mathbf {x} ^ {k + 1} ] \\\\ = 0 \\\\ \\end{array}</span></div>

    <p class="text-gray-300">where the second last equality follows by Lagrange interpolation theorem, recalling that <span class="math">m&#x27; \\leq m</span>.</p>

    <p class="text-gray-300">The following is a well-known bound on the error of polynomial interpolation on an interval <span class="math">[a,b]</span>.</p>

    <p class="text-gray-300">Theorem 3 (Polynomial Interpolation) Let <span class="math">f</span> be an <span class="math">n + 1</span> times differentiable function on <span class="math">[a, b]</span> and <span class="math">p_n</span> be a polynomial of degree <span class="math">\\leq n</span> that interpolates <span class="math">f</span> at <span class="math">n + 1</span> distinct points <span class="math">t_0, t_1, \\ldots, t_n \\in [a, b]</span>, meaning <span class="math">p_n(t_i) = f(t_i)</span> for all <span class="math">0 \\leq i \\leq n</span>. Then, for each <span class="math">t \\in [a, b]</span>, there exists a point <span class="math">\\psi_t \\in [a, b]</span> such that</p>

    <div class="my-4 text-center"><span class="math-block">f (t) - p _ {n} (t) = \\frac {f ^ {(n + 1)} (\\psi_ {t})}{(n + 1) !} \\cdot \\prod_ {i = 0} ^ {n} (t - t _ {i}).</span></div>

    <p class="text-gray-300">10</p>

    <h2 id="sec-10" class="text-2xl font-bold">2.2 Chebyshev Basis Polynomials and Nodes</h2>

    <p class="text-gray-300">Instead of the standard polynomial basis <span class="math">\\{1, \\mathbf{x}, \\mathbf{x}^2, \\ldots\\}</span>, one can instead work with the Chebyshev basis <span class="math">\\{T_0(\\mathbf{x}), T_1(\\mathbf{x}), T_2(\\mathbf{x}), \\ldots\\}</span>. The Chebyshev basis polynomials mimic the double-angle cosine formula. We have <span class="math">e^{i\\mathbf{X}} = \\cos \\mathbf{x} + i\\sin \\mathbf{x}</span>, and hence <span class="math">e^{2i\\mathbf{X}} = \\cos 2\\mathbf{x} + i\\sin 2\\mathbf{x} = (e^{i\\mathbf{X}})^2 = \\cos^2\\mathbf{x} - \\sin^2\\mathbf{x} + 2i\\sin \\mathbf{x}\\cos \\mathbf{x}</span>. The real part of this is the same as <span class="math">2\\cos^2\\mathbf{x} - 1</span>. In general, <span class="math">\\operatorname{Re}(e^{ni\\mathbf{X}}) = \\cos (n\\mathbf{x})</span> and <span class="math">\\operatorname{Im}(e^{ni\\mathbf{X}}) = \\sin (n\\mathbf{x})</span>. The <span class="math">n</span>-th Chebyshev basis polynomial <span class="math">T_{n}(\\mathbf{x})</span> is defined to be <span class="math">\\cos (n\\arccos (\\mathbf{x}))</span>. Thus, <span class="math">T_{0}(\\mathbf{x}) = 1</span>, <span class="math">T_{1}(\\mathbf{x}) = \\mathbf{x}</span>, <span class="math">T_{2}(\\mathbf{x}) = 2x^{2} - 1</span>, and so on. Inductively we have, <span class="math">T_{2n}(\\mathbf{x}) = 2T_{n}(\\mathbf{x})^{2} - 1</span> and <span class="math">T_{2n + 1}(\\mathbf{x}) = 2\\mathbf{x}T_{2n}(\\mathbf{x}) - T_{2n - 1}(\\mathbf{x})</span>. The Chebyshev basis polynomials form an orthogonal basis under the following inner product.</p>

    <div class="my-4 text-center"><span class="math-block">\\langle T _ {i}, T _ {j} \\rangle = \\sum_ {k = 0} ^ {\\mathrm {D} - 1} T _ {i} (\\mathbf {x} _ {k}) T _ {j} (\\mathbf {x} _ {k}) = \\left\\{ \\begin{array}{l l} 0 &amp;amp; \\text {if } i \\neq j \\text{ and } i, j &amp;lt; \\mathrm {D} \\\\ \\mathrm {D} &amp;amp; \\text {if } i = j = 0 \\\\ \\frac {\\mathrm {D}}{2} &amp;amp; \\text {if } i = j \\neq 0 \\text{ and } i &amp;lt; \\mathrm {D} \\end{array} \\right.</span></div>

    <p class="text-gray-300">where <span class="math">\\mathbf{x}_k</span> are Chebyshev nodes (roots) of <span class="math">T_{\\mathrm{D}}(\\mathbf{x})</span>, i.e.</p>

    <div class="my-4 text-center"><span class="math-block">\\mathbf {x} _ {k} = \\cos \\left(\\pi \\frac {2 k + 1}{2 \\mathrm {D}}\\right) \\text{ for } k = 0, 1, \\dots , \\mathrm {D} - 1.</span></div>

    <p class="text-gray-300">The orthogonality relation is proved using trigonometric identities (see e.g. [10] or see [24] for an alternate proof).</p>

    <p class="text-gray-300">Polynomials expressed in the Chebyshev basis also have the nice property that the Chebyshev basis polynomials always evaluate to within <span class="math">-1</span> and <span class="math">1</span> on the interval <span class="math">[-1,1]</span> (just like the standard polynomial basis). For numerical stability of evaluation, it is well known that using the Chebyshev basis polynomials leads to smaller coefficients, which determines required precision of evaluation of the basis polynomials.</p>

    <h2 id="sec-11" class="text-2xl font-bold">3 Good Polynomial Approximation of the Mod Function</h2>

    <p class="text-gray-300">In this section, we describe modular Lagrange interpolation and show how to obtain a good polynomial approximation of the mod function on small intervals in the simpler case where we only care about 3 intervals. Let the three intervals be the intervals of size one centered at <span class="math">-N</span>, 0, and <span class="math">N</span>, with <span class="math">N &amp;gt;&amp;gt; 1^{1}</span>. More precisely, the three intervals are <span class="math">-N + [-1/2, 1/2]</span>, <span class="math">[-1/2, 1/2]</span>, and <span class="math">N + [-1/2, 1/2]</span>. For any <span class="math">d \\geq 1</span>, consider <span class="math">d + 1</span> (possibly equally-spaced) points in each of the three intervals. For each <span class="math">\\ell \\in \\{-1, 0, 1\\}</span>, define <span class="math">S_{\\ell}</span> to be the set containing the <span class="math">d + 1</span> points in the <span class="math">\\ell</span>-th interval. We will let <span class="math">\\mathcal{S}</span> stand for the union of these sets, i.e. <span class="math">S_{-1} \\cup S_0 \\cup S_1</span>.</p>

    <p class="text-gray-300">Let <span class="math">f_{N}</span> be the mod function modulo <span class="math">N</span>. In other words, <span class="math">f_{N}(z) = z - \\ell N</span> for <span class="math">z</span> in the <span class="math">\\ell</span>-th interval.</p>

    <p class="text-gray-300">For any <span class="math">c \\geq 1</span>, define the polynomial <span class="math">g_{c,d}</span> (of degree <span class="math">3d + 2c</span>) as</p>

    <div class="my-4 text-center"><span class="math-block">g_{c,d}(\\mathbf{x}) = \\sum_{\\ell \\in \\{-1,0,1\\}} \\sum_{z \\in S_{\\ell}} f_{N}(z) * \\left(\\prod_{w \\in S_{\\ell} \\setminus \\{z\\}} \\frac{\\mathbf{x} - w}{z - w}\\right) * \\prod_{\\substack{\\ell&#x27; \\in \\{-1,0,1\\} \\\\ \\ell&#x27; \\neq \\ell}} \\left(\\frac{\\mathbf{x} - \\ell&#x27; N}{z - \\ell&#x27; N}\\right)^{d + c} \\tag{3}</span></div>

    <p class="text-gray-300">Observe that if <span class="math">c</span> is set to one, then <span class="math">g_{d,1}(\\mathbf{x})</span> is almost the degree <span class="math">3d + 2</span> polynomial that is the Lagrange interpolation of <span class="math">f_{N}(\\mathbf{x})</span> at the <span class="math">3(d + 1)</span> points <span class="math">\\mathcal{S}</span>. This follows since <span class="math">g_{d,1}(\\mathbf{x})</span> can then be written as</p>

    <div class="my-4 text-center"><span class="math-block">\\begin{aligned} g_{d,1}(\\mathbf{x}) &amp;amp;= \\sum_{\\ell \\in \\{-1,0,1\\}} \\sum_{z \\in S_{\\ell}} f_{N}(z) * \\left(\\prod_{w \\in S_{\\ell} \\setminus \\{z\\}} \\frac{\\mathbf{x} - w}{z - w}\\right) * \\prod_{\\substack{\\ell&#x27; \\in \\{-1,0,1\\} \\\\ \\ell&#x27; \\neq \\ell}} \\left(\\frac{\\mathbf{x} - \\ell&#x27; N}{z - \\ell&#x27; N}\\right)^{d + 1} \\\\ &amp;amp;= \\sum_{\\ell \\in \\{-1,0,1\\}} \\sum_{z \\in S_{\\ell}} f_{N}(z) * \\left(\\prod_{w \\in S_{\\ell} \\setminus \\{z\\}} \\frac{\\mathbf{x} - w}{z - w}\\right) * \\prod_{\\substack{\\ell&#x27; \\in \\{-1,0,1\\} \\\\ \\ell&#x27; \\neq \\ell}} \\prod_{w \\in S_{\\ell&#x27;}} \\left(\\frac{\\mathbf{x} - \\ell&#x27; N}{z - \\ell&#x27; N}\\right) \\\\ \\approx \\sum_{\\ell \\in \\{-1,0,1\\}} \\sum_{z \\in S_{\\ell}} f_{N}(z) * \\left(\\prod_{w \\in S_{\\ell} \\setminus \\{z\\}} \\frac{\\mathbf{x} - w}{z - w}\\right) * \\prod_{\\substack{\\ell&#x27; \\in \\{-1,0,1\\} \\\\ \\ell&#x27; \\neq \\ell}} \\prod_{w \\in S_{\\ell&#x27;}} \\left(\\frac{\\mathbf{x} - w}{z - w}\\right) \\tag{4} \\\\ = \\sum_{z \\in \\mathcal{S}} f_{N}(z) * \\left(\\prod_{w \\in \\mathcal{S} \\backslash \\{z\\}} \\frac{\\mathbf{x} - w}{z - w}\\right). \\tag{5} \\end{aligned}</span></div>

    <p class="text-gray-300">Note, the last expression (5) is the degree <span class="math">3d + 2</span> polynomial that is the Lagrange interpolation of <span class="math">f_{N}(\\mathbf{x})</span> at the <span class="math">3(d + 1)</span> points <span class="math">\\mathcal{S}</span>. Observe that the difference from <span class="math">g_{d,1}</span> is that when adding in the term for Lagrange interpolation with respect to some <span class="math">z</span>, for points <span class="math">w</span> that are not in the same interval as <span class="math">z</span>, we consider the ratio <span class="math">\\frac{\\mathbf{x} - \\ell&#x27; N}{z - \\ell&#x27; N}</span> instead of <span class="math">\\frac{\\mathbf{x} - w}{z - w}</span> (that is, we replace <span class="math">w</span> with the central point <span class="math">\\ell&#x27; N</span> of the interval that <span class="math">w</span> is in). The reason for this alteration is that, as we will soon discuss, <span class="math">c</span> will not be a constant, and will be required to depend on <span class="math">\\ell&#x27;</span>. In particular, <span class="math">c</span> can be much larger than <span class="math">d</span>, and hence more than the number of points chosen in each interval. Experiments we have conducted show that low-degree Lagrange interpolation on points chosen in the intervals, even mimicking an overall Chebyshev density, does not lead to good approximation, and especially so when we are seeking approximations of error <span class="math">\\mathrm{O}(N^{-c})</span>, for</p>

    <p class="text-gray-300">11</p>

    <p class="text-gray-300"><span class="math">c&gt;1</span>. Moreover, the standard error analysis also does not produce good bounds. See Section 8 for a lower bound on the standard error analysis for low-degree Lagrange interpolation.</p>

    <p class="text-gray-300">We will refer to the above interpolation <span class="math">g_{d,c}(\\mathbf{x})</span>, as well as its slight variations that we will consider later, as the modular Lagrange interpolation of the <span class="math">3(d+1)</span> points.</p>

    <p class="text-gray-300">It is easy to see that for <span class="math">\\mathbf{x}\\in S_{\\ell}</span> (<span class="math">\\ell\\in\\{-1,0,1\\}</span>), the summand in the definition of <span class="math">g_{d,1}(\\mathbf{x})</span> corresponding to <span class="math">\\ell</span> is still equal to <span class="math">f_{N}(\\mathbf{x})</span> (as in Lagrange interpolation). However, the other summands are no longer zero. Nevertheless, we will show that the other summands are close to zero. Thus, in this simple case, modular-Lagrange interpolation is almost the polynomial interpolation of the <span class="math">3(d+1)</span> points. We now discuss, why keeping <span class="math">c</span> constant does not lead to a good approximation, especially when the number of intervals is increased to more than three. To this end, we first discuss why Lagrange interpolation of a smooth function is a bad approximation if the points are chosen equally-spaced.</p>

    <p class="text-gray-300">The contributions of the denominator in the Lagrange interpolation (5) are known as the barycentric weights, i.e. for each <span class="math">z\\in\\mathcal{S}</span>, the barycentric weight is</p>

    <p class="text-gray-300"><span class="math">\\mathrm{w}_{z}=\\frac{1}{\\prod_{w\\in\\mathcal{S}\\setminus z}(z-w)}.</span></p>

    <p class="text-gray-300">When interpolating a smooth function over a contiguous interval, if the interpolation points, e.g. <span class="math">\\mathcal{S}</span> above, are chosen equally spaced then the barycentric weights are lopsided. In particular, they are larger near the center (when <span class="math">z\\in\\mathcal{S}</span> is near the center of the contiguous interval) compared to at the edges (when <span class="math">z\\in\\mathcal{S}</span> is near the edge of the contiguous interval) by a factor of <span class="math">2^{d}</span>, where <span class="math">d</span> is the number of points. Now, the evaluation of the Lagrange interpolation (5) at <span class="math">\\mathbf{x}</span> near the edge, and in particular near a point <span class="math">z^{\\prime}\\in\\mathcal{S}</span> near the edge, is supposed to approximate <span class="math">f(\\mathbf{x})</span> (which for a smooth function should be close to <span class="math">f(z^{\\prime})</span>). Indeed, the summand in (5) corresponding to <span class="math">(z=)\\,z^{\\prime}</span> is close to <span class="math">f(z^{\\prime})</span>. Additional error in the approximation comes from the other summands, i.e. for <span class="math">z\\neq z^{\\prime}</span>. This error, for any <span class="math">z\\neq z^{\\prime}</span>, is proportional to the product of <span class="math">\\mathrm{w}_{z}</span> and <span class="math">\\prod_{w\\in S,w\\neq z}(\\mathbf{x}-w)</span>, the latter being more or less independent of <span class="math">z</span>. Also, this latter product is large when <span class="math">\\mathbf{x}</span> is near the edge, as compared to when it is near the center. Since the barycentric weights are large when <span class="math">z</span> is near the center, this then implies that the summand corresponding to <span class="math">z</span> near the center, for <span class="math">\\mathbf{x}</span> near the edge, has a significantly larger error. This is in contrast to the error for <span class="math">\\mathbf{x}</span> near the center, and any <span class="math">z</span>, whether near the center or near the edge. The reader may wonder if the different summands may have opposing signs and some cancellation of error may ensue. While there is some such cancellation, the overall lopsided error accumulation continues to hold. This is known as the “Runge phenomenon”. To get a good approximation to the smooth function, the points are therefore chosen using the Chebyshev density function.</p>

    <p class="text-gray-300">In the modular-Lagrange interpolation above, the barycentric weights can be defined as (for</p>

    <p class="text-gray-300">!<a href="img-3.jpeg">img-3.jpeg</a> Figure 3: The barycentric weights  <span class="math">\\mathbf{w}_z</span>  for the point set [-12..12].</p>

    <p class="text-gray-300"><span class="math">z\\in S_{\\ell})</span></p>

    <div class="my-4 text-center"><span class="math-block">\\mathrm {w} _ {z} = \\frac {1}{\\prod_ {\\substack {w \\in S _ {\\ell} \\setminus z \\\\ \\ell^ {\\prime} \\neq \\ell}} (z - w) * \\prod_ {\\substack {\\ell^ {\\prime} \\in \\{- 1 , 0 , 1 \\} \\\\ \\ell^ {\\prime} \\neq \\ell}} (z - \\ell^ {\\prime} N) ^ {d + 1}}</span></div>

    <p class="text-gray-300">With  <span class="math">N &amp;gt;&amp;gt; 1</span> , these are almost the same as the original barycentric weights, and hence the lopsided nature of these weights continues to hold, especially when there are many more intervals than the simple case of three intervals we have considered so far. Thus, instead of keeping  <span class="math">c</span>  constant as in definition (3), we will make it vary with the interval number, with larger values for intervals at the edges. The idea is similar to choosing points for Lagrange interpolation with density proportional to  <span class="math">(1 - x^2)^{-1/2}</span> ; however, the rate at which  <span class="math">c</span>  increases, especially at the edges, will be less drastic as we also capitalize on both the intervals being tiny compared to  <span class="math">N</span>  as well as the number of intervals being small. Thus, we will be able to keep the degree of the polynomial reasonably low.</p>

    <p class="text-gray-300">If one is satisfied with  <span class="math">O(1 / N)</span> -error approximation, then there is an even simpler polynomial than  <span class="math">g_{d,c}(\\mathbf{x})</span>  given above. Moreover, the analysis is also considerably simpler. So, in this section, we first define this simpler polynomial, but generalized to  <span class="math">2k + 1</span>  intervals, and prove approximation bounds for it. In later sections, we will define polynomials that are generalizations of definition (3) and give better approximations with error  <span class="math">O(N^{-d})</span> , for any  <span class="math">d &amp;gt; 1</span> .</p>

    <p class="text-gray-300">For the simpler polynomial, it suffices to take  <span class="math">d = c = 1</span>  and also remove the dependence on  <span class="math">z</span>  in the multiplicative term with power  <span class="math">(d + c)</span>  in definition (3).</p>

    <p class="text-gray-300">Let the <span class="math">(2k + 1)</span> intervals be <span class="math">-kN + [-1/2, 1/2]</span> to <span class="math">kN + [-1/2, 1/2]</span>. For each integer <span class="math">\\ell \\in \\{-k, -k + 1, \\ldots, k\\}</span>, consider <span class="math">(d + 1 =)2</span> distinct points <span class="math">S_{\\ell} = \\{z_0^{\\ell}, z_1^{\\ell}\\}</span> in each of the <span class="math">(2k + 1)</span> intervals. In particular, <span class="math">z_i^{\\ell} = \\ell <em> N + i/2</span> for <span class="math">i \\in [0..1]</span>. In other words, <span class="math">S_{\\ell} = \\{\\ell </em> N, \\ell * N + 1/2\\}</span>.</p>

    <p class="text-gray-300">We will now define a polynomial of degree <span class="math">(4k + 1) + \\nu</span>, that approximates the mod function on these intervals. The value <span class="math">\\nu</span> is defined below. Recall, the mod function <span class="math">f</span> is defined as <span class="math">f_{N}(\\mathbf{x}) = \\mathbf{x} - \\ell N</span> for all <span class="math">\\mathbf{x} \\in \\ell N + [-1/2, 1/2]</span>.</p>

    <p class="text-gray-300">Let <span class="math">\\mathcal{L} = \\{-k, -k + 1, \\ldots, k\\}</span>. Define</p>

    <div class="my-4 text-center"><span class="math-block">\\hat {g} (\\mathbf {x}) = \\sum_ {\\ell \\in \\mathcal {L}} \\sum_ {z \\in S _ {\\ell}} f _ {N} (z) * \\prod_ {w \\in S _ {\\ell} \\backslash \\{z \\}} \\frac {\\mathbf {x} - w}{z - w} * \\prod_ {\\substack {\\ell^ {\\prime} \\in \\mathcal {L} \\\\ \\ell^ {\\prime} \\neq \\ell}} \\left(\\frac {\\mathbf {x} - \\ell^ {\\prime} N}{(\\ell - \\ell^ {\\prime}) N}\\right) ^ {2 + p (\\ell^ {\\prime})} \\tag{6}</span></div>

    <p class="text-gray-300">where <span class="math">p(\\ell^{\\prime})</span> is defined as</p>

    <div class="my-4 text-center"><span class="math-block"></span></div>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">p (\\ell^ {\\prime}) = \\left\\{ \\begin{array}{l l} 0 &amp; \\mathrm {f o r}</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\ell^ {\\prime}</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\leq \\lfloor k / 2 \\rfloor \\\\ 1 &amp; \\mathrm {f o r} \\lfloor (1 1 / 1 2) * k \\rfloor \\geq</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\ell^ {\\prime}</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">&gt; \\lfloor k / 2 \\rfloor \\\\ 2 &amp; \\mathrm {f o r}</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\ell^ {\\prime}</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">&gt; \\lfloor (1 1 / 1 2) * k \\rfloor \\end{array} \\right.</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <div class="my-4 text-center"><span class="math-block"></span></div>

    <p class="text-gray-300">With Lagrange interpolation on each <span class="math">S_{\\ell}</span>, the above definition (6) simplifies to</p>

    <div class="my-4 text-center"><span class="math-block">\\hat {g} (\\mathbf {x}) = \\sum_ {\\ell \\in \\mathcal {L}} (\\mathbf {x} - \\ell N) * \\prod_ {\\substack {\\ell^ {\\prime} \\in \\mathcal {L} \\\\ \\ell^ {\\prime} \\neq \\ell}} \\left(\\frac {\\mathbf {x} - \\ell^ {\\prime} N}{(\\ell - \\ell^ {\\prime}) N}\\right) ^ {2 + p (\\ell^ {\\prime})} \\tag{7}</span></div>

    <p class="text-gray-300">The value <span class="math">\\pmb{\\nu}</span> is defined to be the sum of <span class="math">p(\\ell&#x27;)</span> over all <span class="math">\\ell&#x27; \\in \\mathcal{L}</span>. With the above definition of <span class="math">p(\\ell&#x27;)</span>, <span class="math">\\pmb{\\nu} = 4<em>k - 2</em>\\lfloor k / 2\\rfloor -2<em>\\lfloor 11 / 12</em>k\\rfloor</span>. If <span class="math">k</span> is a multiple of 12, then the degree of <span class="math">\\hat{g}</span> is <span class="math">\\frac{31}{6}k + 1</span> <span class="math">(= 4k + 1 + \\pmb{\\nu})</span>. It is not difficult to check that <span class="math">\\hat{g}</span> is an odd polynomial, i.e. <span class="math">\\hat{g}(-\\mathbf{x}) = -\\hat{g}(\\mathbf{x})</span>. We make <span class="math">k</span> a multiple of 12 since <span class="math">k = 12</span> is a typical parameter setting that results in bootstrapping for approximate homomorphic encryption. By defining <span class="math">p(\\ell&#x27;)</span> with 12 in the denominator and setting <span class="math">k</span> to be a multiple of 12, we make the analysis simpler by ensuring that the values in the definition of <span class="math">p(\\ell&#x27;)</span> are all integers. This can easily be generalized to arbitrary values of <span class="math">k</span>.</p>

    <p class="text-gray-300">We will show that <span class="math">\\hat{g}(\\mathbf{x})</span> is a good approximation to the mod function via two lemmas. First, Lemma 4 shows that the error between the summand corresponding to the interval that <span class="math">\\mathbf{x}</span> is in and the mod function is small. Then, Lemma 5 shows that the summand corresponding to the interval that <span class="math">\\mathbf{x}</span> is not in is close to 0. Combining Lemmas 4 and 5, we immediately arrive at Theorem 6, which shows that <span class="math">\\hat{g}(\\mathbf{x})</span> approximates the mod function well on all the intervals.</p>

    <p class="text-gray-300">14</p>

    <p class="text-gray-300">Lemma 4 For <span class="math">N &amp;gt; k</span>, for every <span class="math">\\ell \\in [-k..k]</span>, if <span class="math">\\mathbf{x}</span> is in the <span class="math">\\ell</span>-th interval, then</p>

    <div class="my-4 text-center"><span class="math-block"></span></div>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\left</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">f _ {N} (\\mathbf {x}) - f _ {N} (\\mathbf {x}) * \\prod_ {\\ell^ {\\prime} \\in \\mathcal {L} \\atop \\ell^ {\\prime} \\neq \\ell} \\left(\\frac {\\mathbf {x} - \\ell^ {\\prime} N}{(\\ell - \\ell^ {\\prime}) N}\\right) ^ {2 + p (\\ell^ {\\prime})} \\right</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\leq \\frac {2 <em> \\ln (e </em> k)}{N} + \\frac {2 * k ^ {2}}{N ^ {2}}</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <div class="my-4 text-center"><span class="math-block"></span></div>

    <p class="text-gray-300">Lemma 5 For <span class="math">N &amp;gt; k</span>, and <span class="math">k</span> a multiple of 12, for every <span class="math">t \\in [-k..k]</span> and <span class="math">\\mathbf{x}</span> in the <span class="math">t</span>-th interval,</p>

    <div class="my-4 text-center"><span class="math-block"></span></div>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\left</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\sum_ {\\ell \\in \\mathcal {L} \\atop \\ell \\neq t} (\\mathbf {x} - \\ell N) * \\prod_ {\\ell^ {\\prime} \\in \\mathcal {L} \\atop \\ell^ {\\prime} \\neq \\ell} \\left(\\frac {\\mathbf {x} - \\ell^ {\\prime} N}{\\ell N - \\ell^ {\\prime} N}\\right) ^ {2 + p (\\ell^ {\\prime})} \\right</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\leq</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <div class="my-4 text-center"><span class="math-block"></span></div>

    <div class="my-4 text-center"><span class="math-block">\\frac {1}{2} * \\ln (e * k) * \\max \\left\\{0. 9 2 4 * k ^ {\\frac {1}{2}} * \\frac {1 . 1 2 2 1 ^ {k}}{N}, 0. 0 9 8 * k ^ {\\frac {3}{2}} * \\frac {3 . 8 1 ^ {k}}{N ^ {2}}, 0. 0 1 4 * k ^ {2} * \\frac {9 . 8 1 3 ^ {k}}{N ^ {3}} \\right\\}</span></div>

    <p class="text-gray-300">A brief proof sketch of Lemma 5 follows below in section 4.1. The detailed proofs of Lemmas 4 and 5 can be found in Supplementary Material B and C, respectively. Combining the above lemmas gives the following theorem.</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Theorem 6 For <span class="math">N &amp;gt; k</span>, and for <span class="math">k</span> a multiple of 12, for the mod function <span class="math">f_{N}(\\cdot)</span>, for any <span class="math">\\mathbf{x}</span> such that $</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\mathbf{x} - t*N</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\leq 1/2<span class="math"> with </span>t \\in \\{-k, -k + 1, \\ldots, k\\}$, we have</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <div class="my-4 text-center"><span class="math-block"></span></div>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\hat {g} (\\mathbf {x}) - f _ {N} (\\mathbf {x})</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">&lt;   N ^ {- 1} <em> \\left(2 </em> \\ln (e <em> k) + \\frac {2 </em> k ^ {2}}{N} + \\right.</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <div class="my-4 text-center"><span class="math-block"></span></div>

    <div class="my-4 text-center"><span class="math-block">\\left. 0. 4 6 2 * \\ln (e * k) * \\sqrt {k} * 1. 1 2 2 1 ^ {k} * \\max \\left\\{1, 0. 1 0 6 * k * \\frac {3 . 4 ^ {k}}{N}, 0. 0 1 5 * k ^ {\\frac {3}{2}} * \\frac {8 . 7 4 5 ^ {k}}{N ^ {2}} \\right\\}\\right)</span></div>

    <p class="text-gray-300">Focusing on the typical parameter setting <span class="math">k = 12</span>, we obtain the following corollary.</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Corollary 7 For the mod function <span class="math">f_{N}(\\cdot)</span>, for <span class="math">k = 12</span>, <span class="math">N &amp;gt; 12</span>, for any <span class="math">\\mathbf{x}</span> such that $</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\mathbf{x} - t*N</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\leq 1/2<span class="math"> with </span>t \\in \\{-k, -k + 1, \\ldots, k\\}<span class="math">, we have that </span>\\hat{g}<span class="math"> is an odd polynomial with </span>\\deg(\\hat{g}) = 63$, and</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <div class="my-4 text-center"><span class="math-block"></span></div>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\hat {g} (\\mathbf {x}) - f _ {N} (\\mathbf {x})</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">&lt;   N ^ {- 1} <em> \\left(7 + \\frac {3 0 0}{N} + 2 2. 3 </em> \\max \\{1, \\frac {3 . 0 3 <em> 1 0 ^ {6}}{N}, \\frac {1 . 2 5 </em> 1 0 ^ {1 1}}{N ^ {2}} \\}\\right)</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <div class="my-4 text-center"><span class="math-block"></span></div>

    <p class="text-gray-300">With <span class="math">N \\geq 10^6</span>, we get the following corollary.</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Corollary 8 For the mod function <span class="math">f_{N}(\\cdot)</span>, for <span class="math">k = 12</span>, <span class="math">N \\geq 10^{6}</span>, for any <span class="math">\\mathbf{x}</span> such that $</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\mathbf{x} - t*N</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\leq 1/2<span class="math"> with </span>t \\in \\{-k, -k + 1, \\ldots, k\\}<span class="math">, we have that </span>\\hat{g}<span class="math"> is an odd polynomial with </span>\\deg(\\hat{g}) = 63$, and</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <div class="my-4 text-center"><span class="math-block"></span></div>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\hat {g} (\\mathbf {x}) - f _ {N} (\\mathbf {x})</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">&lt;   7 5 / N</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <div class="my-4 text-center"><span class="math-block"></span></div>

    <p class="text-gray-300">Remark.</p>

    <p class="text-gray-300">If we want good bounds for <span class="math">N\\approx 100</span> with the degree of <span class="math">\\hat{g}</span> only marginally higher than 63, then we need a more complicated definition of <span class="math">\\hat{g}</span> (in particular, <span class="math">p(\\ell^{\\prime})</span>), which we describe in a later section (Section 6).</p>

    <h3 id="sec-13" class="text-xl font-semibold mt-8">4.1 Proof Sketch of Lemma 5</h3>

    <p class="text-gray-300">While the detailed proof of Lemma 5 can be found in Supplementary Material C, we give a brief sketch of the proof here. We start by analyzing, for every <span class="math">t,\\ell\\in[-k..k]</span>, <span class="math">t\\neq\\ell</span>, and <span class="math">\\mathbf{x}</span> in the <span class="math">t</span>-th interval (writing <span class="math">\\mathbf{x}=\\mathbf{x}^{\\prime}+tN</span>), the quantity</p>

    <p class="text-gray-300"><span class="math">(\\mathbf{x}-\\ell N)<em>\\prod_{\\ell^{\\prime}\\in\\mathcal{L}\\atop\\ell^{\\prime}\\neq\\ell}\\bigg{(}\\frac{\\mathbf{x}-\\ell^{\\prime}N}{\\ell N-\\ell^{\\prime}N}\\bigg{)}^{2}=(\\mathbf{x}^{\\prime}+(t-\\ell)N)</em>\\prod_{\\ell^{\\prime}\\in\\mathcal{L}\\atop\\ell^{\\prime}\\neq\\ell}\\bigg{(}\\frac{\\mathbf{x}^{\\prime}+(t-\\ell^{\\prime})N}{(\\ell-\\ell^{\\prime})N}\\bigg{)}^{2}</span></p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">i.e. when <span class="math">p(\\ell^{\\prime})</span> is removed from the exponent. Since $</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\mathbf{x}^{\\prime}</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\leq 1/2<span class="math"> and </span>N>>1$, the absolute value of the above is approximately</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">$</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">(t-\\ell)</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">N*\\bigg{(}\\frac{1/2}{</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\ell-t</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">N}\\bigg{)}^{2}*\\prod_{\\ell^{\\prime}\\in\\mathcal{L}\\atop\\ell^{\\prime}\\neq\\ell\\atop\\ell^{\\prime}\\neq t}\\bigg{(}\\frac{</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">t-\\ell^{\\prime}</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">}{</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\ell-\\ell^{\\prime}</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">}\\bigg{)}^{2}=\\frac{1/4}{</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\ell-t</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">N}*\\prod_{\\ell^{\\prime}\\in\\mathcal{L}\\atop\\ell^{\\prime}\\neq\\ell\\atop\\ell^{\\prime}\\neq t}\\bigg{(}\\frac{</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">t-\\ell^{\\prime}</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">}{</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\ell-\\ell^{\\prime}</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">}\\bigg{)}^{2}.$</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">When <span class="math">t=k</span> and <span class="math">\\ell=0</span>, the denominator in the big product is close to <span class="math">(k!k!)^{2}</span>, whereas the numerator is close to <span class="math">(2k!)^{2}</span>, making the product about <span class="math">(2k!/k!k!)^{2}</span>, which is well approximated by <span class="math">2^{4k}</span>. Even with <span class="math">N\\approx 2^{20}</span>, this then leads to an error of <span class="math">2^{48-20}</span>, for <span class="math">k=12</span>. Note however, if <span class="math">t=1</span> and <span class="math">\\ell=0</span>, then the product is close to 1, and we get an error of about <span class="math">1/N</span>. This is indeed the lopsided barycentric weight problem, also known as the Runge phenomenon, described earlier. So, to correct this phenomenon, we add more weights in the exponent for larger $</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\ell^{\\prime}</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"><span class="math">, and this is the function </span>p(\\ell^{\\prime})<span class="math">. For example, since </span>p(k)=2<span class="math">, then the above expression for </span>t=k$ will now be close to</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">$</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">(k-\\ell)</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">N*\\bigg{(}\\frac{1/2}{</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\ell-k</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">N}\\bigg{)}^{2+2}*\\prod_{\\ell^{\\prime}\\in\\mathcal{L}\\atop\\ell^{\\prime}\\neq\\ell\\atop\\ell^{\\prime}\\neq t}\\bigg{(}\\frac{</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">k-\\ell^{\\prime}</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">}{</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\ell-\\ell^{\\prime}</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">}\\bigg{)}^{2+p(\\ell^{\\prime})}$</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">If the big product at <span class="math">\\ell=0</span> remained as before, i.e. <span class="math">(2k!/k!k!)^{2}\\approx 2^{4k}</span>, then the above quantity is now approximately <span class="math">2^{4k}/N^{3}</span>. With <span class="math">k=12</span> and <span class="math">N=2^{20}</span>, this quantity is less than 1. However, the big product is not exactly <span class="math">(2k!/k!k!)^{2}</span> anymore, because of the <span class="math">p(\\ell^{\\prime})</span> in the exponent. However, using good upper and lower bounds on the factorial function, we can upper bound</p>

    <p class="text-gray-300">this quantity by about <span class="math">10^{k}</span>, which is even better than the previous <span class="math">2^{4k}=16^{k}</span>. It is possible that this product changes for the worse for other values of <span class="math">t</span> and <span class="math">\\ell</span>. However, we can show that this quantity behaves in a fairly smooth fashion, with only one local minimum and one local maximum as <span class="math">t</span> varies from <span class="math">0</span> to <span class="math">k</span> (while <span class="math">\\ell</span> is kept fixed at <span class="math">0</span>). The quantity is also lower bounded by <span class="math">1</span>, and, thus, the upper bound also holds for any <span class="math">\\ell</span>.</p>

    <p class="text-gray-300">When <span class="math">k</span> is fixed, such as <span class="math">k=12</span>, one can also explicitly calculate all possible <span class="math">12*25</span> values of the above product, say, conveniently using a computer. However, since we can prove a general bound for arbitrary <span class="math">k</span>, we state the result in general terms, since other or future applications may require larger <span class="math">k</span>, say for enhanced security. However, we do report this computer-assisted bound in Appendix C.2, which shows an improvement of a factor of ten from the more general analysis. We also take this computer-assisted approach in Section 6 where more complicated <span class="math">p(\\cdot)</span> functions are considered.</p>

    <h2 id="sec-14" class="text-2xl font-bold">5 General Case: Obtaining an O(<span class="math">N^{-d}</span>)-error Upper Bound</h2>

    <p class="text-gray-300">In this section, we give a modular Lagrange interpolation that leads to an approximation of the mod function with error <span class="math">O(N^{-d})</span> for each <span class="math">d\\geq 1</span>. As opposed to the interpolation in Section 4, specifically definition (6), where the second product was independent of <span class="math">z</span>, to get the improved bound we must have the second product depend on <span class="math">z</span>, similar to that in (3).</p>

    <p class="text-gray-300">Let <span class="math">\\mathcal{L}=\\{-k,-k+1,\\ldots,k\\}</span>. Let the <span class="math">2k+1</span> intervals be <span class="math">\\ell N+[-1/2,+1/2]</span> for <span class="math">\\ell\\in L</span>. For each <span class="math">\\ell\\in L</span>, consider <span class="math">d+1</span> distinct points <span class="math">S_{\\ell}=\\{z_{0}^{\\ell},...,z_{d}^{\\ell}\\}</span> in each of the <span class="math">(2k+1)</span> intervals (chosen symmetrically around <span class="math">\\ell N</span>).</p>

    <p class="text-gray-300">With the aim of obtaining a polynomial approximation of the mod function with error O(<span class="math">N^{-d}</span>) for every <span class="math">d\\geq 1</span>, we now define polynomials of degree O(<span class="math">kd</span>). The mod function <span class="math">f_{N}</span> is defined as <span class="math">f_{N}(\\mathbf{x})=\\mathbf{x}-\\ell N</span> for all <span class="math">\\mathbf{x}\\in[\\ell N-1/2,\\ell N+1/2]</span>.</p>

    <p class="text-gray-300">For any <span class="math">b,d\\geq 1</span> and <span class="math">c\\geq 0</span>, let</p>

    <p class="text-gray-300"><span class="math">g_{b,c,d}(\\mathbf{x})=\\sum_{\\ell\\in\\mathcal{L}}\\sum_{z\\in S_{\\ell}}f_{N}(z)<em>\\prod_{w\\in S_{\\ell}\\setminus\\{z\\}}\\frac{\\mathbf{x}-w}{z-w}</em>\\prod_{\\ell^{\\prime}\\in\\mathcal{L}\\atop\\ell^{\\prime}\\neq\\ell}\\left(\\frac{\\mathbf{x}-\\ell^{\\prime}N}{z-\\ell^{\\prime}N}\\right)^{d+c+b*p(\\ell^{\\prime})}</span> (8)</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">where <span class="math">p(\\ell^{\\prime})</span> is defined as before in Section 4. When <span class="math">b=\\lceil d/2\\rceil</span> and <span class="math">d+c=2b</span>, we refer to the polynomial simply as <span class="math">g_{d}(\\mathbf{x})</span>. Since the points <span class="math">S_{\\ell}</span> are chosen symmetrically around <span class="math">\\ell N</span>, and the intervals are also symmetric around zero, and further $p(\\ell^{\\prime})=p(</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\ell^{\\prime}</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">)<span class="math">, it is an easy exercise to check that </span>g_{b,c,d}(\\mathbf{x})<span class="math"> is an odd function, i.e. </span>g_{b,c,d}(-\\mathbf{x})=-g_{b,c,d}(\\mathbf{x})$.</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">Note that the degree of the polynomial <span class="math">g_{d}(\\mathbf{x})</span> is <span class="math">d+b<em>(4k+\\boldsymbol{\\nu})</span>, where the value <span class="math">\\boldsymbol{\\nu}</span> is defined to be the sum of <span class="math">p(\\ell^{\\prime})</span> over all <span class="math">\\ell^{\\prime}\\in\\mathcal{L}</span>. Let <span class="math">\\mathsf{m}=b</em>(4k+\\boldsymbol{\\nu})</span>.</p>

    <p class="text-gray-300">##</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Theorem 9 For the mod function <span class="math">f_{N}(\\cdot)</span>, for any <span class="math">d &amp;gt; 0</span>, <span class="math">N &amp;gt; 0.22 <em> k </em> 3.4^{k}</span> and <span class="math">N &amp;gt; (\\mathfrak{m} + d + 1) / (d + 1)</span>, <span class="math">k \\geq 12</span> and <span class="math">k</span> a multiple of twelve, for any <span class="math">\\mathbf{x}</span> such that $</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\mathbf{x} - t * N</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\leq 1/2<span class="math"> with </span>t \\in \\{-k, -k + 1, \\ldots, k\\}$, we have</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">$$ \\begin{array}{l}</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\left</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">g_{2d}(\\mathbf{x}) - f_{N}(\\mathbf{x}) \\right</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">&lt; N^{-2d} <em> 2^{2d} </em> \\left(1 + \\frac{e \\mathfrak{m}}{d}\\right)^{2d} + \\\\</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">N^{-2d} <em> \\left(4k </em> N + (4d + 6) <em> (33 </em> k^{2})^{d}\\right) <em> \\left(\\sqrt{k} </em> 1.1221^{k} / 2\\right)^{d} \\end{array} $$</p>

    <p class="text-gray-300">and</p>

    <p class="text-gray-300">$$ \\begin{array}{l}</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\left</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">g_{2d+1}(\\mathbf{x}) - f_{N}(\\mathbf{x}) \\right</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">&lt; N^{-2d-1} <em> 2^{2d+1} </em> \\left(1 + \\frac{2e \\mathfrak{m}}{2d+1}\\right)^{2d+1} + \\\\</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">N^{-2d-1} <em> \\left(4k + (4d + 10) </em> (33 <em> k^{2})^{d+1} / N\\right) </em> \\left(\\sqrt{k} * 1.1221^{k} / 2\\right)^{d+1} \\end{array} $$</p>

    <p class="text-gray-300">The proof of this theorem is similar to the proof of Theorem 6, but now it uses the more advanced Lagrange interpolation lemma 2. The detailed proof can be found in Supplementary Material D.</p>

    <p class="text-gray-300">Note that a small calculation shows that, for <span class="math">k \\geq 12</span>, <span class="math">(17k^{2+1/2}1.1221^k) &amp;lt; (.22 <em> k </em> 3.4^k)^{1/4}</span>, hence the above is upper bounded by <span class="math">N^{-2d}(N <em> N^{d/4} + (4d + 10)N^{d/4})</span>, which in turn is upper bounded by <span class="math">(4d + 10) </em> N^{-7/4d+1}</span>. Thus, if <span class="math">N</span> is exponential in <span class="math">2k + 1</span>, more precisely <span class="math">N &amp;gt; e^{2k+1} &amp;gt; 0.22 <em> k </em> 3.4^k</span>, then the density of the points need not grow as drastically as <span class="math">(1 - x^2)^{-1/2}</span>, and the error can still approach zero, asymptotically as <span class="math">N^{-(7/4)*d+1}</span>, with degree at most <span class="math">3(d+1)k</span>. Note that the above is referring to the weights of <span class="math">p(\\ell&#x27;)</span> for modular Lagrange interpolation, and not the number of points per interval as in standard Lagrange interpolation.</p>

    <h2 id="sec-15" class="text-2xl font-bold">6 Enhanced Interpolation for Small <span class="math">N</span></h2>

    <p class="text-gray-300">While the modular Lagrange interpolation defined in Section 4 works well for large <span class="math">N</span>, and in particular <span class="math">N \\geq 10^6</span>, to get a good approximation that works for smaller <span class="math">N</span>, e.g. <span class="math">N \\approx 100</span>, we need to make the <span class="math">p(\\ell&#x27;)</span> function rise faster with <span class="math">\\ell&#x27;</span>. Thus, we can define a new modular Lagrange interpolation with the following <span class="math">p(\\ell&#x27;)</span> function to get a better approximation.</p>

    <p class="text-gray-300">$$ p(\\ell') = \\left\\{ \\begin{array}{l l}</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">0 &amp; \\text{for }</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\ell'</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\leq \\lfloor k/2 \\rfloor \\\\</th>

          </tr>

        </thead>

        <tbody>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">2 &amp; \\text{for } \\lfloor (11/12) * k \\rfloor \\geq</td>

            <td class="px-3 py-2 border-b border-gray-700">\\ell'</td>

            <td class="px-3 py-2 border-b border-gray-700">&gt; \\lfloor (10/12) * k \\rfloor \\\\</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">4 &amp; \\text{for }</td>

            <td class="px-3 py-2 border-b border-gray-700">\\ell'</td>

            <td class="px-3 py-2 border-b border-gray-700">&gt; \\lfloor 11/12 * k \\rfloor</td>

          </tr>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">\\end{array} \\right. $$</p>

    <p class="text-gray-300">A theorem bounding the approximation-error similar to Theorem 6 can be proven, but the case analysis is proportionately more complicated. Instead, we will restrict ourselves to <span class="math">k=12</span>, and then a proof can be given by explicitly calculating (say, using a computer) the ratios <span class="math">P_{t}/P_{\\ell}</span> for all <span class="math">t,\\ell\\in[-12..12]</span>.</p>

    <h6 id="sec-16" class="text-base font-medium mt-4">Theorem 10</h6>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">For the mod function <span class="math">f_{N}(\\cdot)</span>, for <span class="math">k=12</span>, <span class="math">N&gt;12</span>, for any <span class="math">\\mathbf{x}</span> such that $</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\mathbf{x}-t*N</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\leq 1/2<span class="math"> with </span>t\\in\\{-k,-k+1,\\ldots,k\\}<span class="math">, we have that </span>\\hat{g}<span class="math"> defined in (6) using above </span>p(\\ell^{\\prime})<span class="math"> is an odd polynomial with </span>\\text{deg}(\\hat{g})=69$, and</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">$</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\hat{g}(\\mathbf{x})-f_{N}(\\mathbf{x})</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"><\\frac{1}{N}<em>\\left(\\frac{1}{4}+\\frac{3.5}{N}+\\frac{144}{N^{2}}\\right)</em>\\left(2+\\text{ max }\\{1,\\frac{60}{N},\\frac{2919}{N^{2}},\\frac{1.23*10^{7}}{N^{4}}\\}\\right)$</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">The proof along with pseudocode can be found in Supplementary Material E.</p>

    <p class="text-gray-300">To get approximation error of <span class="math">O(N^{-d})</span>, we generalize the above definition of <span class="math">\\hat{g}</span> as in Section 5. We define a polynomial of degree <span class="math">(25<em>d+24</em>c+20*b)</span>, for <span class="math">b,d\\geq 1</span> and <span class="math">c\\geq 0</span>, as in (8). When <span class="math">b=\\lceil d/2\\rceil</span> and <span class="math">d+c=2b</span>, we just write <span class="math">g_{b,c,d}(\\mathbf{x})</span> as <span class="math">g_{d}(\\mathbf{x})</span>.</p>

    <p class="text-gray-300">We have the following upper bound on the approximation-error of <span class="math">g_{d}(\\mathbf{x})</span>.</p>

    <h6 id="sec-17" class="text-base font-medium mt-4">Theorem 11</h6>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">For the mod function <span class="math">f_{N}(\\cdot)</span>, for any <span class="math">d&gt;0</span>, <span class="math">b=\\lceil d/2\\rceil</span>, <span class="math">k=12</span>, and <span class="math">N&gt;60</span>, for any <span class="math">\\mathbf{x}</span> such that $</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\mathbf{x}-t*N</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\leq 1/2<span class="math"> with </span>t\\in\\{-k,-k+1,\\ldots,k\\}<span class="math">, we have for </span>g_{d}<span class="math"> defined in (8) using above </span>p(\\ell^{\\prime})$,</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">$</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">g_{d}(\\mathbf{x})-f_{N}(\\mathbf{x})</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\leq N^{-d}<em>(744)^{d}+\\left(24</em>N+1+(2d+3)<em>(2310)^{d}\\right)</em>N^{-2b}$</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">The proof of Theorem 11 in Appendix E.1 is a generalization of the proof of Theorem 10 and is analogous to the proof of Theorem 9 generalizing Theorem 6. While the theorem as stated would only give useful bounds for <span class="math">N&gt;2310</span>, the number <span class="math">2310</span> above was obtained by a very loose analysis. As experiments described in Section 9 show, for <span class="math">N=1024</span>, the polynomials described have maximum error close to <span class="math">N^{-2/3*d}</span> for <span class="math">d=3..9</span>.</p>

    <h2 id="sec-18" class="text-2xl font-bold">7 Upper Bounding the Coefficients in the Chebyshev Basis</h2>

    <p class="text-gray-300">The modular Lagrange interpolation as described previously is in the usual polynomial basis <span class="math">\\{1,\\mathbf{x},\\mathbf{x}^{2},\\ldots\\}</span>. However, for the stability of evaluation of this polynomial at points in the various intervals, it is better to first transform the polynomial into the Chebyshev basis. The transformed polynomial will be referred to as the Chebyshev transform. Recall that polynomials expressed in the Chebyshev basis also have the nice property that the Chebyshev basis</p>

    <p class="text-gray-300">polynomials always evaluate to within <span class="math">-1</span> and <span class="math">1</span> on the interval <span class="math">[-1,1]</span>, and hence the precision to which these basis values need to be calculated is dictated by the magnitude of the coefficients of the Chebyshev transform.</p>

    <p class="text-gray-300">The Chebyshev transform of <span class="math">f(\\mathbf{x})</span> of degree <span class="math">\\textsc{d}</span> is then given by <span class="math">\\{a_{\\ell}\\}_{\\ell\\in[0..\\textsc{d}]}</span> such that <span class="math">f(\\mathbf{x})=\\sum_{\\ell=0}^{\\textsc{d}}a_{\\ell}*T_{\\ell}(\\mathbf{x})</span>. Using the orthogonality relations of the Chebyshev basis polynomials (see Section 2), we can obtain</p>

    <p class="text-gray-300"><span class="math">a_{\\ell}=\\frac{\\langle T_{\\ell},f\\rangle}{\\langle T_{\\ell},T_{\\ell}\\rangle}.</span></p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Moreover, by Cauchy-Schwartz inequality, for each <span class="math">\\ell</span>, $</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">a_{\\ell}</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">^{2}\\leq\\langle f,f\\rangle/(\\textsc{d}/2)<span class="math">. Thus, the coefficients of the Chebyshev transform (of </span>f<span class="math">) are upper bounded by a fraction of the </span>\\textsc{L}_{2}<span class="math">-norm of </span>f<span class="math"> evaluated at the Chebyshev nodes, which then is at most two times the max-norm of </span>f<span class="math">. While Theorem 6 and other similar theorems bound </span>\\hat{g}<span class="math"> (more precisely, the difference from the mod function) on the specified small intervals, here we need the max-norm of </span>\\hat{g}<span class="math"> at the Chebyshev nodes, or more conservatively, at any point in </span>[-kN-1/2,kN+1/2]<span class="math"> (this range being normalized to be </span>[-1,1]<span class="math"> before obtaining the Chebyshev transform). So, we now estimate the maximum value of </span>\\hat{g}(\\mathbf{x})<span class="math"> for any </span>\\mathbf{x}\\in[-kN-1/2,kN+1/2]<span class="math">. In the proof of Lemma 5, while bounding (13) by (15), now instead of </span>\\mathbf{x}^{\\prime}<span class="math"> being small, i.e. </span></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\mathbf{x}^{\\prime}</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\leq 1/2<span class="math">, we now have that </span></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\mathbf{x}^{\\prime}</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"><N/2<span class="math">. Thus, in (15), the factor </span>\\mathbf{x}^{\\prime 2+p(t)}*N^{-1-p(t)}<span class="math"> now becomes </span>N<span class="math">. Thus, we get the following upper bound on absolute value of each coefficient </span>a_{\\ell}<span class="math"> (for all </span>\\ell\\in\\{0,\\dots,\\textsc{d}\\}$) of Chebyshev transform of (6):</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300"><span class="math">(\\frac{31}{6}k+1)<em>0.5</em>\\ln(e<em>k)</em></span> <span class="math">\\max\\left\\{0.924<em>k^{\\frac{1}{2}}</em>1.1221^{k}<em>N,\\,0.098</em>k^{\\frac{3}{2}}<em>3.81^{k}</em>N,\\,0.014<em>k^{2}</em>9.813^{k}*N\\right\\},</span></p>

    <p class="text-gray-300">which is easily seen to be less than <span class="math">0.007<em>(\\frac{31}{6}k+1)</em>\\ln(e<em>k)</em>k^{2}<em>9.813^{k}</em>N.</span> A simple calculation shows that for <span class="math">k=12</span>, <span class="math">N=10^{6}</span>, this value is <span class="math">1.8*10^{20}</span>.</p>

    <p class="text-gray-300">Similarly, we get the following upper bound on absolute value of each coefficient <span class="math">a_{\\ell}</span> (for all <span class="math">\\ell\\in\\{0,\\dots,\\textsc{d}\\}</span>) of Chebyshev transform of polynomials of Section 6: <span class="math">69<em>N</em>1.23*10^{7}</span>, which for <span class="math">N=2^{10}</span> (and <span class="math">k</span> set to <span class="math">12</span>), is about <span class="math">10^{12}</span>.</p>

    <p class="text-gray-300">The size of the coefficients of the Chebyshev transform is important as one can round these coefficients to be integers (or to the nearest decimal upto which approximation-error is sought), and then the Chebyshev basis polynomials (which take values in <span class="math">[-1,1]</span>) need to be computed to a precision which is same as the precision of the rounded coefficients.</p>

    <p class="text-gray-300">##</p>

    <p class="text-gray-300">8 Lower Bound on Standard Error Analysis for Lagrange Interpolation</p>

    <p class="text-gray-300">In this section, we provide an argument that using standard Lagrange interpolation as in <em>[14]</em> to approximate the mod function on multiple small intervals cannot be improved to obtain as good of error bounds as our modular Lagrange interpolation when using the standard error analysis for Lagrange interpolation. They had the clever idea of using Lagrange interpolation, but instead of picking the points for interpolation via the Chebyshev method (which would end up picking points over the entire space), they only picked points inside the small intervals on which we wish to approximate the mod function. The points in each interval were picked according to the Chebyshev method, and the number of points to pick inside each interval was determined via a greedy algorithm. We will show that it is not possible to allocate numbers of points to these small interval and then pick points inside these small intervals and obtain error bounds that match our modular Lagrange interpolation using the standard error analysis.</p>

    <p class="text-gray-300">We note that standard Lagrange interpolation can only be applied to a continuous function. Thus, in <em>[14]</em>, they first approximate the mod function <span class="math">[t]_{q}</span> by a scaled sine function. We will ignore the inherent error associated with approximating the mod function by the scaled sine function and, instead, focus on the error that occurs when the scaled sine function is approximated by a degree <span class="math">n</span> polynomial. We show that even this error cannot be as good as our bounds using standard Lagrange interpolation using the standard error analysis. We defer this section to Supplementary Material F.</p>

    <h2 id="sec-19" class="text-2xl font-bold">9 Application to Bootstrapping for Approximate HE</h2>

    <p class="text-gray-300">In Section 1.1, we explained that approximating the mod function on small intervals around the modulus is a necessary step in bootstrapping for approximate homomorphic encryption (CKKS). In this section, we will briefly overview the bootstrapping procedure for the CKKS-FHE scheme introduced in <em>[7]</em> and explain how our modular Lagrange interpolation leads to explicit polynomials that enable high-precision bootstrapping. We evaluate the performance of our polynomials for various typical settings of parameters and find that they bypass the fundamental error introduced by approximating the mod function with a scaled sine function even for low-degree polynomials computable in depth 7 or 8.</p>

    <p class="text-gray-300">###</p>

    <h4 id="sec-20" class="text-lg font-semibold mt-6">Notation and Necessary Preliminaries:</h4>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Let <span class="math">M</span> be a power of 2 and <span class="math">\\Phi_{M}(X)=X^{N}+1</span> be the <span class="math">M</span>th cyclotomic polynomial of degree <span class="math">N=M/2</span>. Let <span class="math">\\mathcal{R}=\\mathbb{Z}[X]/\\Phi_{M}(X)</span>. For an integer <span class="math">q</span>, let <span class="math">\\mathcal{R}_{q}=\\mathbb{Z}_{q}[X]/\\Phi_{M}(X)</span>. Using the canonical embedding <span class="math">\\sigma</span>, it is possible to map an element <span class="math">m(X)\\in\\mathcal{R}</span> into <span class="math">\\mathbb{C}^{N}</span> by evaluating <span class="math">m(X)</span> at the <span class="math">M</span>th primitive roots of unity. Using the same canonical embedding, it is also possible to define an isometric ring isomorphism between <span class="math">\\mathcal{S}=\\mathbb{R}[X]/\\Phi_{M}(X)</span> and <span class="math">\\mathbb{C}^{N/2}</span>, where for an element <span class="math">m(X)\\in\\mathcal{S}</span>, it has the canonical embedding norm $</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">m</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">_{\\infty}^{\\mathsf{can}}=</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\sigma(m)</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">_{\\infty}$.</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <h4 id="sec-21" class="text-lg font-semibold mt-6">Overview of the CKKS-FHE Scheme:</h4>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">The CKKS-FHE scheme <em>[9]</em> is an FHE scheme for approximate arithmetic over real/complex numbers. Its security is based on the ring-LWE (RLWE) assumption. The message space of the scheme is polynomials <span class="math">m(X)</span> in <span class="math">\\mathcal{R}</span> with $</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">m</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">_{\\infty}^{\\mathsf{can}}<q/2<span class="math"> for a prime </span>q<span class="math">. Using the canonical embedding and appropriate scaling, one can map a vector in </span>\\mathbb{C}^{N/2}<span class="math"> of fixed precision into </span>\\mathcal{R}<span class="math">. The fact that canonical embedding induces an isometric ring isomorphism between </span>\\mathcal{S}<span class="math"> and </span>\\mathbb{C}^{N/2}<span class="math"> implies that operations on the message space </span>\\mathcal{R}<span class="math"> map to the same operations performed coordinate-wise on </span>\\mathbb{C}^{N/2}<span class="math">. Thus, the CKKS-FHE scheme supports packing </span>N/2<span class="math"> complex numbers into a single plaintext and operating on them in single instruction multiple data (SIMD) manner. Please refer to <em>[9]</em> for more details on this encoding procedure. We will refer to </span>m(X)\\in\\mathcal{R}<span class="math"> as the plaintext/message and the corresponding vector in </span>\\mathbb{C}^{N/2}$ as the plaintext “slots.”</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">A ciphertext ct encrypting a message <span class="math">m\\in\\mathcal{R}</span> is an element of <span class="math">\\mathcal{R}_{q_{\\ell}}^{2}</span> for some <span class="math">\\ell\\in\\{0,\\ldots,L\\}</span>. <span class="math">\\ell</span> refers to the “level” of the ciphertext. In <em>[9]</em>, <span class="math">q_{\\ell}=p^{\\ell}<em>q</span> for primes <span class="math">p</span> and <span class="math">q</span>. However, <span class="math">q_{\\ell}</span> can be set in other ways (such as via an RNS basis </em>[8]*). The decryption structure is <span class="math">\\langle\\mathsf{ct},\\mathsf{sk}\\rangle\\bmod q_{\\ell}=m+e</span> for some small error <span class="math">e\\in\\mathcal{R}</span>. Observe that there is no way to remove <span class="math">e</span> and some of the least significant bits of <span class="math">m</span> are unrecoverable. A fresh ciphertext is generated at the highest level <span class="math">L</span>. Homomorphic operations increase the magnitude of the error and the message and one must apply a rescaling procedure or modular reduction to bring a ciphertext to a lower level to continue homomorphic computation. Eventually, a ciphertext is at the lowest level (an element of <span class="math">\\mathcal{R}_{q}^{2}</span>), and no further operations can be performed.</p>

    <h4 id="sec-22" class="text-lg font-semibold mt-6">Bootstrapping Procedure for CKKS-FHE:</h4>

    <p class="text-gray-300"><em>[7]</em> introduced the first bootstrapping procedure for the CKKS-FHE scheme. Subsequent works <em>[6, 13, 14]</em> improved various aspects of bootstrapping, but the overall procedure remains the same. The goal is to take a ciphertext at the lowest level and bring it up to a higher level so that homomorphic computation can continue. Thus, given a ciphertext ct at the lowest level, we want to obtain another ciphertext ct^{′} such that</p>

    <p class="text-gray-300"><span class="math">\\langle\\mathsf{ct},\\mathsf{sk}\\rangle\\bmod q\\approx\\langle\\mathsf{ct}^{\\prime},\\mathsf{sk}\\rangle\\bmod q_{\\ell}</span></p>

    <p class="text-gray-300">for some <span class="math">\\ell&gt;1</span>. For simplicity in the following, we will include the starting decryption error in the message <span class="math">m</span>. That is, we will assume that <span class="math">\\langle\\mathsf{ct},\\mathsf{sk}\\rangle\\bmod q=m</span>.</p>

    <p class="text-gray-300">Bootstrapping is done via the following sequence of steps:</p>

    <ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">

      <li>Modulus Raising: By simply considering <span class="math">\\mathsf{ct}</span> as a ciphertext at the highest level, it follows that <span class="math">\\langle\\mathsf{ct},\\mathsf{sk}\\rangle\\bmod q_{L}=qI+m</span> for some <span class="math">I\\in\\mathcal{R}</span>.</li>

      <li>Coefficients to Slots: We need to perform the modular reduction on the polynomial coefficients of <span class="math">t=qI+m</span>. However, recall that homomorphic computations evaluate coordinate-wise on the plaintext “slots,” not the polynomial coefficients. Thus, we need to transform our ciphertext so that the polynomial coefficients are in the “slots.” This can be done by evaluating a linear transformation homomorphically.</li>

      <li>Compute the Mod Function: We need a procedure to compute/approximate the mod function homomorphically. This is a significant challenge since we can only compute arithmetic operations homomorphically.</li>

      <li>Slots to Coefficients: Finally, we need to undo the coefficients to slots step. This can be done by homomorphically evaluating the inverse of the previous linear transform.</li>

    </ol>

    <p class="text-gray-300">Observe that if we can approximate the mod function, then the above procedure will give us a <span class="math">\\mathsf{ct}^{\\prime}</span> at some higher level <span class="math">\\ell</span> that decrypts to <span class="math">m+e</span> for some small error <span class="math">e</span>. Since we are dealing with approximate arithmetic, this error from bootstrapping can be absorbed into the other errors that occur during approximate arithmetic and homomorphic evaluation.</p>

    <h5 id="sec-23" class="text-base font-semibold mt-4">Prior Approaches to Approximating the Mod Function:</h5>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">We can upper bound $</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">I</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"><K<span class="math"> for some integer </span>K<span class="math"> (a typical value is </span>K=12<span class="math">) so that we only need to approximate the mod function on the interval </span>[-Kq-m,Kq+m]<span class="math">, where we have overloaded notation to make </span>m$ an upper bound on the size of the message for consistency of notation with prior works. However, finding a good polynomial approximation for the mod function on this interval is difficult since it is not even a continuous function.</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">As described in the introduction, <em>[7]</em> observed that if <span class="math">m</span> is sufficiently small, then the mod function <span class="math">[t]_{q}</span> can be approximated by the scaled sine function <span class="math">S(t)=\\frac{q}{2\\pi}\\sin\\left(\\frac{2\\pi t}{q}\\right)</span>. This approximation introduces a “fundamental error” of <span class="math">\\frac{2\\pi^{2}}{3}q\\epsilon^{3}</span>, where <span class="math">\\epsilon=m/q</span>. Thus, to obtain</p>

    <p class="text-gray-300"><span class="math">O(1)</span> error, we require <span class="math">m=O(q^{2/3})</span>, meaning that we must begin bootstrapping prior to <span class="math">m</span> becoming too large.</p>

    <p class="text-gray-300">The work <em>[7]</em> then proceeded by approximating <span class="math">S(t)</span> using a Taylor expansion to degree <span class="math">O(Kq)</span> so that the error of approximation with <span class="math">S(t)</span> is about the same as the error between <span class="math">S(t)</span> and <span class="math">[t]_{q}</span>. Since they are approximating a scaled sine function, they are able to use double-angle formulas for sine to reduce the computational cost of evaluating the approximation polynomial by first approximating a scaled-down version <span class="math">\\sin\\left(\\frac{2\\pi t}{2^{r}\\ast q}\\right)</span> to a degree <span class="math">d_{0}=O(1)</span> and then using this approximation to approximate <span class="math">S(t)</span>. The required setting of <span class="math">r</span> is <span class="math">O(\\log Kq)</span> and so the multiplicative depth (alternatively, the ciphertext levels consumed) remains the same.</p>

    <p class="text-gray-300">The work <em>[6]</em> improved upon this method by instead using Chebyshev interpolation to approximate <span class="math">S(t)</span>, which lowered the error of approximation and the required degree. In Chebyshev interpolation, instead of working with the polynomial basis <span class="math">\\{1,x,x^{2},\\ldots\\}</span>, one works with the Chebyshev basis <span class="math">\\{T_{0}(x),T_{1}(x)</span>, <span class="math">T_{2}(x),\\ldots\\}</span> and uses the Chebyshev nodes as points for interpolation. Approximating <span class="math">S(t)</span> via Chebyshev interpolation <span class="math">p_{n}(t)</span> of degree <span class="math">\\leq n</span> gives an error of</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">$</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">S(t)-p_{n}(t)</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\leq qK^{n+1}\\frac{\\pi^{n}}{(n+1)!}.$</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">Observe that the above error does not depend on <span class="math">\\epsilon</span> (that is, it is a good approximation on the entire space <span class="math">[-Kq,Kq]</span> and does not utilize the fact that we only need a good approximation close to multiples of <span class="math">q</span>). However, for a typical parameter setting <span class="math">K=12</span>, this error bound only improves on the trivial bound of <span class="math">q</span> for degree <span class="math">n\\geq 98</span>.</p>

    <p class="text-gray-300">The work <em>[14]</em> improved on the approximation of the scaled sine function by leveraging the fact that we only care that our approximation is good near multiples of <span class="math">q</span>. To do this, <em>[14]</em> uses Chebyshev interpolation on the union of these small intervals instead of the entire space <span class="math">[-Kq,Kq]</span>. Implicit in this, they consider the ratio between the maximum size of a message and <span class="math">q</span>. This procedure allows them to reduce the degree of the polynomial required for approximation and allows the error of approximation to depend on the ratio <span class="math">\\epsilon=m/q</span>. For approximating the scaled sine function on <span class="math">2K+1</span> intervals near multiples of <span class="math">q</span> (near <span class="math">-Kq,\\ldots,Kq</span>), the error of approximation in any particular interval is <span class="math">O\\left(\\epsilon^{d}\\right)</span>, where <span class="math">d</span> is the number of points chosen for Chebyshev interpolation in that interval. However, due to the constants hidden in the big-O notation (which can depend exponentially on <span class="math">K</span>), choosing the same number of points for Chebyshev interpolation in all intervals does not give the best approximation, and the authors choose <span class="math">d</span> for each interval via a greedy algorithm.</p>

    <p class="text-gray-300">The above approaches all require first approximating <span class="math">[t]_{q}</span> via a scaled sine function, and, therefore, will always at least have error <span class="math">\\frac{2\\pi^{2}}{3}q\\epsilon^{3}</span>. If we want to have a smaller error, it is</p>

    <p class="text-gray-300">necessary to use a different method that avoids the scaled sine function. A pair of recent works by the same authors <em>[19, 18]</em> attempt to avoid the scaled sine function by instead trying to find the optimal minimax polynomial of a fixed degree that approximates the mod function via algorithmic search. <em>[19]</em> uses L2-norm minimization and <em>[18]</em> uses a variant of the Remez algorithm <em>[21]</em> to obtain an approximation to the optimal minimax polynomial of a given degree that approximates the modular reduction function on the union of intervals containing points close to multiples of <span class="math">q</span>. However, in both of these works, the polynomial is found via algorithmic search. Moreover, the degree of the polynomial is fixed a priori before any approximation is computed. Without any bounds showing trade-offs between the polynomial degree, size of the coefficients, and the error of approximation, it is hard to develop strategies for picking the degree. Unfortunately, as observed by <em>[18]</em>, the size of the coefficients of these polynomials are too large to enable high-precision bootstrapping. By using a composition of sine/cosine and the inverse sine function, <em>[18]</em> are able to improve on <em>[14]</em>, but their bootstrapping is only capable of up to 40 bit message precision.</p>

    <h4 id="sec-24" class="text-lg font-semibold mt-6">Our Approach to Approximating the Mod Function:</h4>

    <p class="text-gray-300">In contrast to the above approaches, using modular Lagrange interpolation, we give explicit low-degree polynomials that directly approximate the mod function on intervals around multiples of the modulus to arbitrarily small error. We are able to formally prove error bounds for our polynomials and bounds on the magnitudes of the coefficients in the Chebyshev basis. Our approach avoids the “fundamental error” associated with using the scaled sine function as an intermediate approximation, and, therefore, the restriction that <span class="math">m=O(q^{2/3})</span> is removed. Moreover, the size of the coefficients of our polynomials are sufficiently small, so the Chebyshev basis polynomials are capable of being evaluated homomorphically to the required precision during bootstrapping. As we demonstrate in Section 10, this enables high-precision bootstrapping, which was previously unknown.</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">In previous sections, the <span class="math">p(\\ell^{\\prime})</span> function weighting the various intervals was chosen with the setting <span class="math">K=12</span> in mind. However, our approach is general, and for a different value of <span class="math">K</span>, one could define an appropriate <span class="math">p(\\ell^{\\prime})</span> function to obtain good approximations. Our polynomials are defined in terms of a modulus <span class="math">N</span> and intervals of length 1. Thus, to evaluate <span class="math">[t]_{q}</span> for bootstrapping, where <span class="math">t=qI+m^{\\prime}</span> for some $</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">m^{\\prime}</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"><m<span class="math"> and </span></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">I</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"><K<span class="math">, one would first compute </span>\\frac{t}{2m}=\\frac{q}{2m}I+\\frac{m^{\\prime}}{2m}<span class="math">. Setting </span>N=\\frac{q}{2m}<span class="math"> and evaluating the appropriate polynomial gives an approximation to </span>\\frac{m^{\\prime}}{2m}<span class="math">, which can then be multiplied by </span>2m<span class="math"> to obtain an approximation of </span>m^{\\prime}$ as desired.</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">Tables 1, 2, 3, and 4 show experimental results of implementations of polynomials obtained using Macaulay2 for various settings of <span class="math">m/q=\\epsilon</span>. For all polynomials, we set <span class="math">c=0</span> since experimental results show that this performs best. Consistent with prior works, we set <span class="math">K=12</span></p>

    <p class="text-gray-300">Table 1: Polynomials for  <span class="math">m / q = 2^{-7}</span></p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Degree</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Points/Interval (d+1)</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">b</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">c</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Depth</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Precision†</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Error††</th>

          </tr>

        </thead>

        <tbody>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">69</td>

            <td class="px-3 py-2 border-b border-gray-700">3</td>

            <td class="px-3 py-2 border-b border-gray-700">1</td>

            <td class="px-3 py-2 border-b border-gray-700">0</td>

            <td class="px-3 py-2 border-b border-gray-700">7</td>

            <td class="px-3 py-2 border-b border-gray-700">30 bits</td>

            <td class="px-3 py-2 border-b border-gray-700">2-11</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">89</td>

            <td class="px-3 py-2 border-b border-gray-700">3</td>

            <td class="px-3 py-2 border-b border-gray-700">2</td>

            <td class="px-3 py-2 border-b border-gray-700">0</td>

            <td class="px-3 py-2 border-b border-gray-700">7</td>

            <td class="px-3 py-2 border-b border-gray-700">20 bits</td>

            <td class="px-3 py-2 border-b border-gray-700">2-12</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">115</td>

            <td class="px-3 py-2 border-b border-gray-700">4</td>

            <td class="px-3 py-2 border-b border-gray-700">2</td>

            <td class="px-3 py-2 border-b border-gray-700">0</td>

            <td class="px-3 py-2 border-b border-gray-700">7</td>

            <td class="px-3 py-2 border-b border-gray-700">37 bits</td>

            <td class="px-3 py-2 border-b border-gray-700">2-15</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">139</td>

            <td class="px-3 py-2 border-b border-gray-700">5</td>

            <td class="px-3 py-2 border-b border-gray-700">2</td>

            <td class="px-3 py-2 border-b border-gray-700">0</td>

            <td class="px-3 py-2 border-b border-gray-700">8</td>

            <td class="px-3 py-2 border-b border-gray-700">39 bits</td>

            <td class="px-3 py-2 border-b border-gray-700">2-21</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">159</td>

            <td class="px-3 py-2 border-b border-gray-700">5</td>

            <td class="px-3 py-2 border-b border-gray-700">3</td>

            <td class="px-3 py-2 border-b border-gray-700">0</td>

            <td class="px-3 py-2 border-b border-gray-700">8</td>

            <td class="px-3 py-2 border-b border-gray-700">40 bits</td>

            <td class="px-3 py-2 border-b border-gray-700">2-22</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">185</td>

            <td class="px-3 py-2 border-b border-gray-700">6</td>

            <td class="px-3 py-2 border-b border-gray-700">3</td>

            <td class="px-3 py-2 border-b border-gray-700">0</td>

            <td class="px-3 py-2 border-b border-gray-700">8</td>

            <td class="px-3 py-2 border-b border-gray-700">60 bits</td>

            <td class="px-3 py-2 border-b border-gray-700">2-26</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">229</td>

            <td class="px-3 py-2 border-b border-gray-700">7</td>

            <td class="px-3 py-2 border-b border-gray-700">4</td>

            <td class="px-3 py-2 border-b border-gray-700">0</td>

            <td class="px-3 py-2 border-b border-gray-700">8</td>

            <td class="px-3 py-2 border-b border-gray-700">63 bits</td>

            <td class="px-3 py-2 border-b border-gray-700">2-30</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">255</td>

            <td class="px-3 py-2 border-b border-gray-700">8</td>

            <td class="px-3 py-2 border-b border-gray-700">4</td>

            <td class="px-3 py-2 border-b border-gray-700">0</td>

            <td class="px-3 py-2 border-b border-gray-700">8</td>

            <td class="px-3 py-2 border-b border-gray-700">83 bits</td>

            <td class="px-3 py-2 border-b border-gray-700">2-34</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">299</td>

            <td class="px-3 py-2 border-b border-gray-700">9</td>

            <td class="px-3 py-2 border-b border-gray-700">5</td>

            <td class="px-3 py-2 border-b border-gray-700">0</td>

            <td class="px-3 py-2 border-b border-gray-700">9</td>

            <td class="px-3 py-2 border-b border-gray-700">83 bits</td>

            <td class="px-3 py-2 border-b border-gray-700">2-37</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">325</td>

            <td class="px-3 py-2 border-b border-gray-700">10</td>

            <td class="px-3 py-2 border-b border-gray-700">5</td>

            <td class="px-3 py-2 border-b border-gray-700">0</td>

            <td class="px-3 py-2 border-b border-gray-700">9</td>

            <td class="px-3 py-2 border-b border-gray-700">107 bits</td>

            <td class="px-3 py-2 border-b border-gray-700">2-37</td>

          </tr>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">† This is the precision at which the Chebyshev polynomials need to be evaluated. The error is relative to  <span class="math">q</span>  in line with earlier conventions.</p>

    <p class="text-gray-300">Table 2: Polynomials for  <span class="math">m / q = 2^{-10}</span></p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Degree</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Points/Interval (d+1)</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">b</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">c</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Depth</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Precision</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Error</th>

          </tr>

        </thead>

        <tbody>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">69</td>

            <td class="px-3 py-2 border-b border-gray-700">3</td>

            <td class="px-3 py-2 border-b border-gray-700">1</td>

            <td class="px-3 py-2 border-b border-gray-700">0</td>

            <td class="px-3 py-2 border-b border-gray-700">7</td>

            <td class="px-3 py-2 border-b border-gray-700">37 bits</td>

            <td class="px-3 py-2 border-b border-gray-700">2-17</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">115</td>

            <td class="px-3 py-2 border-b border-gray-700">4</td>

            <td class="px-3 py-2 border-b border-gray-700">2</td>

            <td class="px-3 py-2 border-b border-gray-700">0</td>

            <td class="px-3 py-2 border-b border-gray-700">7</td>

            <td class="px-3 py-2 border-b border-gray-700">40 bits</td>

            <td class="px-3 py-2 border-b border-gray-700">2-24</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">139</td>

            <td class="px-3 py-2 border-b border-gray-700">5</td>

            <td class="px-3 py-2 border-b border-gray-700">2</td>

            <td class="px-3 py-2 border-b border-gray-700">0</td>

            <td class="px-3 py-2 border-b border-gray-700">8</td>

            <td class="px-3 py-2 border-b border-gray-700">67 bits</td>

            <td class="px-3 py-2 border-b border-gray-700">2-34</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">185</td>

            <td class="px-3 py-2 border-b border-gray-700">6</td>

            <td class="px-3 py-2 border-b border-gray-700">3</td>

            <td class="px-3 py-2 border-b border-gray-700">0</td>

            <td class="px-3 py-2 border-b border-gray-700">8</td>

            <td class="px-3 py-2 border-b border-gray-700">73 bits</td>

            <td class="px-3 py-2 border-b border-gray-700">2-40</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">209</td>

            <td class="px-3 py-2 border-b border-gray-700">7</td>

            <td class="px-3 py-2 border-b border-gray-700">3</td>

            <td class="px-3 py-2 border-b border-gray-700">0</td>

            <td class="px-3 py-2 border-b border-gray-700">8</td>

            <td class="px-3 py-2 border-b border-gray-700">97 bits</td>

            <td class="px-3 py-2 border-b border-gray-700">2-49</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">255</td>

            <td class="px-3 py-2 border-b border-gray-700">8</td>

            <td class="px-3 py-2 border-b border-gray-700">4</td>

            <td class="px-3 py-2 border-b border-gray-700">0</td>

            <td class="px-3 py-2 border-b border-gray-700">8</td>

            <td class="px-3 py-2 border-b border-gray-700">103 bits</td>

            <td class="px-3 py-2 border-b border-gray-700">2-57</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">279</td>

            <td class="px-3 py-2 border-b border-gray-700">9</td>

            <td class="px-3 py-2 border-b border-gray-700">4</td>

            <td class="px-3 py-2 border-b border-gray-700">0</td>

            <td class="px-3 py-2 border-b border-gray-700">9</td>

            <td class="px-3 py-2 border-b border-gray-700">127 bits</td>

            <td class="px-3 py-2 border-b border-gray-700">2-65</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">325</td>

            <td class="px-3 py-2 border-b border-gray-700">10</td>

            <td class="px-3 py-2 border-b border-gray-700">5</td>

            <td class="px-3 py-2 border-b border-gray-700">0</td>

            <td class="px-3 py-2 border-b border-gray-700">9</td>

            <td class="px-3 py-2 border-b border-gray-700">133 bits</td>

            <td class="px-3 py-2 border-b border-gray-700">2-72</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">349</td>

            <td class="px-3 py-2 border-b border-gray-700">11</td>

            <td class="px-3 py-2 border-b border-gray-700">5</td>

            <td class="px-3 py-2 border-b border-gray-700">0</td>

            <td class="px-3 py-2 border-b border-gray-700">9</td>

            <td class="px-3 py-2 border-b border-gray-700">155 bits</td>

            <td class="px-3 py-2 border-b border-gray-700">2-90</td>

          </tr>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">Table 3: Polynomials for  <span class="math">m / q = 2^{-15}</span></p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Degree</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Points/Interval (d+1)</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">b</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">c</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Depth</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Precision</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Error</th>

          </tr>

        </thead>

        <tbody>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">63</td>

            <td class="px-3 py-2 border-b border-gray-700">3</td>

            <td class="px-3 py-2 border-b border-gray-700">1</td>

            <td class="px-3 py-2 border-b border-gray-700">0</td>

            <td class="px-3 py-2 border-b border-gray-700">6</td>

            <td class="px-3 py-2 border-b border-gray-700">50 bits</td>

            <td class="px-3 py-2 border-b border-gray-700">2-22</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">77</td>

            <td class="px-3 py-2 border-b border-gray-700">3</td>

            <td class="px-3 py-2 border-b border-gray-700">2</td>

            <td class="px-3 py-2 border-b border-gray-700">0</td>

            <td class="px-3 py-2 border-b border-gray-700">7</td>

            <td class="px-3 py-2 border-b border-gray-700">50 bits</td>

            <td class="px-3 py-2 border-b border-gray-700">2-28</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">103</td>

            <td class="px-3 py-2 border-b border-gray-700">4</td>

            <td class="px-3 py-2 border-b border-gray-700">2</td>

            <td class="px-3 py-2 border-b border-gray-700">0</td>

            <td class="px-3 py-2 border-b border-gray-700">7</td>

            <td class="px-3 py-2 border-b border-gray-700">83 bits</td>

            <td class="px-3 py-2 border-b border-gray-700">2-40</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">141</td>

            <td class="px-3 py-2 border-b border-gray-700">5</td>

            <td class="px-3 py-2 border-b border-gray-700">3</td>

            <td class="px-3 py-2 border-b border-gray-700">0</td>

            <td class="px-3 py-2 border-b border-gray-700">8</td>

            <td class="px-3 py-2 border-b border-gray-700">103 bits</td>

            <td class="px-3 py-2 border-b border-gray-700">2-56</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">167</td>

            <td class="px-3 py-2 border-b border-gray-700">6</td>

            <td class="px-3 py-2 border-b border-gray-700">3</td>

            <td class="px-3 py-2 border-b border-gray-700">0</td>

            <td class="px-3 py-2 border-b border-gray-700">8</td>

            <td class="px-3 py-2 border-b border-gray-700">130 bits</td>

            <td class="px-3 py-2 border-b border-gray-700">2-65</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">205</td>

            <td class="px-3 py-2 border-b border-gray-700">7</td>

            <td class="px-3 py-2 border-b border-gray-700">4</td>

            <td class="px-3 py-2 border-b border-gray-700">0</td>

            <td class="px-3 py-2 border-b border-gray-700">8</td>

            <td class="px-3 py-2 border-b border-gray-700">153 bits</td>

            <td class="px-3 py-2 border-b border-gray-700">2-81</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">231</td>

            <td class="px-3 py-2 border-b border-gray-700">8</td>

            <td class="px-3 py-2 border-b border-gray-700">4</td>

            <td class="px-3 py-2 border-b border-gray-700">0</td>

            <td class="px-3 py-2 border-b border-gray-700">8</td>

            <td class="px-3 py-2 border-b border-gray-700">177 bits</td>

            <td class="px-3 py-2 border-b border-gray-700">2-86</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">269</td>

            <td class="px-3 py-2 border-b border-gray-700">9</td>

            <td class="px-3 py-2 border-b border-gray-700">5</td>

            <td class="px-3 py-2 border-b border-gray-700">0</td>

            <td class="px-3 py-2 border-b border-gray-700">9</td>

            <td class="px-3 py-2 border-b border-gray-700">203 bits</td>

            <td class="px-3 py-2 border-b border-gray-700">2-105</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">295</td>

            <td class="px-3 py-2 border-b border-gray-700">10</td>

            <td class="px-3 py-2 border-b border-gray-700">5</td>

            <td class="px-3 py-2 border-b border-gray-700">0</td>

            <td class="px-3 py-2 border-b border-gray-700">9</td>

            <td class="px-3 py-2 border-b border-gray-700">220 bits</td>

            <td class="px-3 py-2 border-b border-gray-700">2-107</td>

          </tr>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">Table 4: Polynomials for  <span class="math">m / q = 2^{-20}</span></p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Degree</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Points/Interval (d+1)</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">b</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">c</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Depth</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Precision</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Error</th>

          </tr>

        </thead>

        <tbody>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">63</td>

            <td class="px-3 py-2 border-b border-gray-700">3</td>

            <td class="px-3 py-2 border-b border-gray-700">1</td>

            <td class="px-3 py-2 border-b border-gray-700">0</td>

            <td class="px-3 py-2 border-b border-gray-700">6</td>

            <td class="px-3 py-2 border-b border-gray-700">67 bits</td>

            <td class="px-3 py-2 border-b border-gray-700">2-36</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">103</td>

            <td class="px-3 py-2 border-b border-gray-700">4</td>

            <td class="px-3 py-2 border-b border-gray-700">2</td>

            <td class="px-3 py-2 border-b border-gray-700">0</td>

            <td class="px-3 py-2 border-b border-gray-700">7</td>

            <td class="px-3 py-2 border-b border-gray-700">93 bits</td>

            <td class="px-3 py-2 border-b border-gray-700">2-55</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">127</td>

            <td class="px-3 py-2 border-b border-gray-700">5</td>

            <td class="px-3 py-2 border-b border-gray-700">2</td>

            <td class="px-3 py-2 border-b border-gray-700">0</td>

            <td class="px-3 py-2 border-b border-gray-700">7</td>

            <td class="px-3 py-2 border-b border-gray-700">127 bits</td>

            <td class="px-3 py-2 border-b border-gray-700">2-72</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">167</td>

            <td class="px-3 py-2 border-b border-gray-700">6</td>

            <td class="px-3 py-2 border-b border-gray-700">3</td>

            <td class="px-3 py-2 border-b border-gray-700">0</td>

            <td class="px-3 py-2 border-b border-gray-700">8</td>

            <td class="px-3 py-2 border-b border-gray-700">153 bits</td>

            <td class="px-3 py-2 border-b border-gray-700">2-92</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">191</td>

            <td class="px-3 py-2 border-b border-gray-700">7</td>

            <td class="px-3 py-2 border-b border-gray-700">3</td>

            <td class="px-3 py-2 border-b border-gray-700">0</td>

            <td class="px-3 py-2 border-b border-gray-700">8</td>

            <td class="px-3 py-2 border-b border-gray-700">187 bits</td>

            <td class="px-3 py-2 border-b border-gray-700">2-106</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">231</td>

            <td class="px-3 py-2 border-b border-gray-700">8</td>

            <td class="px-3 py-2 border-b border-gray-700">4</td>

            <td class="px-3 py-2 border-b border-gray-700">0</td>

            <td class="px-3 py-2 border-b border-gray-700">8</td>

            <td class="px-3 py-2 border-b border-gray-700">213 bits</td>

            <td class="px-3 py-2 border-b border-gray-700">2-129</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">255</td>

            <td class="px-3 py-2 border-b border-gray-700">9</td>

            <td class="px-3 py-2 border-b border-gray-700">4</td>

            <td class="px-3 py-2 border-b border-gray-700">0</td>

            <td class="px-3 py-2 border-b border-gray-700">8</td>

            <td class="px-3 py-2 border-b border-gray-700">247 bits</td>

            <td class="px-3 py-2 border-b border-gray-700">2-140</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">295</td>

            <td class="px-3 py-2 border-b border-gray-700">10</td>

            <td class="px-3 py-2 border-b border-gray-700">5</td>

            <td class="px-3 py-2 border-b border-gray-700">0</td>

            <td class="px-3 py-2 border-b border-gray-700">9</td>

            <td class="px-3 py-2 border-b border-gray-700">277 bits</td>

            <td class="px-3 py-2 border-b border-gray-700">2-166</td>

          </tr>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">Table 5: Fundamental Error Between the Scaled Sine and Mod Functions</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">m/q</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Error</th>

          </tr>

        </thead>

        <tbody>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">2-7</td>

            <td class="px-3 py-2 border-b border-gray-700">2-18</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">2-10</td>

            <td class="px-3 py-2 border-b border-gray-700">2-27</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">2-15</td>

            <td class="px-3 py-2 border-b border-gray-700">2-42</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">2-20</td>

            <td class="px-3 py-2 border-b border-gray-700">2-57</td>

          </tr>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">and evaluate the scaled down mod function that takes an input in a small interval <span class="math">[I-\\epsilon,I+\\epsilon]</span> for <span class="math">I\\in\\{-K,\\ldots,K\\}</span>. The precision refers to the number of bits of precision we need to evaluate the Chebyshev basis polynomials in order to obtain the best error. The polynomials in Tables 1 and 2 were obtained using the enhanced interpolation from Section 6, while the polynomials in Tables 3 and 4 are from Section 5 (Section 4 for the degree 63 polynomials). Table 5 shows the fundamental error between the scaled sine function and the mod function for various settings of <span class="math">m/q</span>. We observe that once we take <span class="math">d+1=5</span> points per interval (and set <span class="math">b</span> to 2 or 3), our polynomials have smaller error than this fundamental error by many orders of magnitude. This gain is only increased as we increase the number of points per interval. These polynomials are computable in depth 7 for <span class="math">m/q=2^{-20}</span> and in depth 8 for <span class="math">m/q=2^{-7},2^{-10},2^{-15}</span>. If one is willing to use a depth 8 circuit for <span class="math">m/q=2^{-20}</span> or a depth 9 circuit for <span class="math">m/q=2^{-7},2^{-10},2^{-15}</span>, then the error decreases even further.</p>

    <h2 id="sec-25" class="text-2xl font-bold">10 Implementation</h2>

    <p class="text-gray-300">To demonstrate the applicability of our polynomials to high precision bootstrapping for approximate homomorphic encryption, we updated the bootstrapping procedure of the HEAAN library <em>[1]</em> to utilize our polynomials during the “Compute the Mod Function” step (see Section 9). Additionally, we updated HEAAN to use the quadmath library, since we wanted to achieve bootstrapping error smaller than the precision of a double. We ran our implementation using a PC with an AMD Ryzen 5 3600 3.6 GHz Six-Core CPU.</p>

    <p class="text-gray-300">Table 6 gives our bootstrapping results for various settings of parameters. As before, <span class="math">\\epsilon</span> represents the ratio <span class="math">m/q</span>, where <span class="math">m</span> is an upper bound on the size of the message (including any errors associated from the approximate arithmetic and prior homomorphic operations) and <span class="math">q</span> is the size of the modulus prior to bootstrapping. <span class="math">q_{L}</span> denotes the modulus of the largest level, which is the modulus of a fresh ciphertext prior to any homomorphic operations. <span class="math">N</span> denotes the ring dimension, which we increase as <span class="math">q_{L}</span> increases to maintain 128-bit security <em>[2, 3]</em>. All of our results were obtained using 8 slots. We observe that we could have utilized <span class="math">N/4</span> slots (out of a possible <span class="math">N/2</span>) without affecting the running time of the “Compute the Mod Function” step that we updated in the bootstrapping procedure since the (up to) <span class="math">N/2</span> coefficients of the message polynomial could fit into the slots of a single ciphertext. However, we opted to use a fixed number of slots since the runtimes of the “Coefficients To Slots” and the “Slots to Coefficients” steps in the bootstrapping procedure (which we did not modify) scale with the number of slots and would perform poorly if the number is too large. <span class="math">q_{\\ell^{\\prime}}</span> denotes the</p>

    <p class="text-gray-300">Table 6: High-Precision Bootstrapping Results</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Gap - log2ε</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Input Precision† log2m</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Modulus (Fresh) log2qL</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Ring Dim. N</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Degree of poly</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Depth of poly</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Modulus (After) log2qρ</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Error (Bootstrap) βbs</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Output Precision</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Runtime†† (secs)</th>

          </tr>

        </thead>

        <tbody>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">7</td>

            <td class="px-3 py-2 border-b border-gray-700">21</td>

            <td class="px-3 py-2 border-b border-gray-700">1200</td>

            <td class="px-3 py-2 border-b border-gray-700">216</td>

            <td class="px-3 py-2 border-b border-gray-700">139</td>

            <td class="px-3 py-2 border-b border-gray-700">8</td>

            <td class="px-3 py-2 border-b border-gray-700">519</td>

            <td class="px-3 py-2 border-b border-gray-700">2-14</td>

            <td class="px-3 py-2 border-b border-gray-700">13</td>

            <td class="px-3 py-2 border-b border-gray-700">75</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">10</td>

            <td class="px-3 py-2 border-b border-gray-700">30</td>

            <td class="px-3 py-2 border-b border-gray-700">1600</td>

            <td class="px-3 py-2 border-b border-gray-700">216</td>

            <td class="px-3 py-2 border-b border-gray-700">139</td>

            <td class="px-3 py-2 border-b border-gray-700">8</td>

            <td class="px-3 py-2 border-b border-gray-700">665</td>

            <td class="px-3 py-2 border-b border-gray-700">2-24</td>

            <td class="px-3 py-2 border-b border-gray-700">23</td>

            <td class="px-3 py-2 border-b border-gray-700">114</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">10</td>

            <td class="px-3 py-2 border-b border-gray-700">43</td>

            <td class="px-3 py-2 border-b border-gray-700">2400</td>

            <td class="px-3 py-2 border-b border-gray-700">217</td>

            <td class="px-3 py-2 border-b border-gray-700">209</td>

            <td class="px-3 py-2 border-b border-gray-700">8</td>

            <td class="px-3 py-2 border-b border-gray-700">1148</td>

            <td class="px-3 py-2 border-b border-gray-700">2-37</td>

            <td class="px-3 py-2 border-b border-gray-700">36</td>

            <td class="px-3 py-2 border-b border-gray-700">613</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">10</td>

            <td class="px-3 py-2 border-b border-gray-700">63</td>

            <td class="px-3 py-2 border-b border-gray-700">2400</td>

            <td class="px-3 py-2 border-b border-gray-700">217</td>

            <td class="px-3 py-2 border-b border-gray-700">279</td>

            <td class="px-3 py-2 border-b border-gray-700">9</td>

            <td class="px-3 py-2 border-b border-gray-700">603</td>

            <td class="px-3 py-2 border-b border-gray-700">2-55</td>

            <td class="px-3 py-2 border-b border-gray-700">54</td>

            <td class="px-3 py-2 border-b border-gray-700">693</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">10</td>

            <td class="px-3 py-2 border-b border-gray-700">50</td>

            <td class="px-3 py-2 border-b border-gray-700">3000</td>

            <td class="px-3 py-2 border-b border-gray-700">217</td>

            <td class="px-3 py-2 border-b border-gray-700">349</td>

            <td class="px-3 py-2 border-b border-gray-700">9</td>

            <td class="px-3 py-2 border-b border-gray-700">1274</td>

            <td class="px-3 py-2 border-b border-gray-700">2-46</td>

            <td class="px-3 py-2 border-b border-gray-700">45</td>

            <td class="px-3 py-2 border-b border-gray-700">1244</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">10</td>

            <td class="px-3 py-2 border-b border-gray-700">70</td>

            <td class="px-3 py-2 border-b border-gray-700">3000</td>

            <td class="px-3 py-2 border-b border-gray-700">217</td>

            <td class="px-3 py-2 border-b border-gray-700">349</td>

            <td class="px-3 py-2 border-b border-gray-700">9</td>

            <td class="px-3 py-2 border-b border-gray-700">1002</td>

            <td class="px-3 py-2 border-b border-gray-700">2-58</td>

            <td class="px-3 py-2 border-b border-gray-700">57</td>

            <td class="px-3 py-2 border-b border-gray-700">1206</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">10</td>

            <td class="px-3 py-2 border-b border-gray-700">90</td>

            <td class="px-3 py-2 border-b border-gray-700">3000</td>

            <td class="px-3 py-2 border-b border-gray-700">217</td>

            <td class="px-3 py-2 border-b border-gray-700">349</td>

            <td class="px-3 py-2 border-b border-gray-700">9</td>

            <td class="px-3 py-2 border-b border-gray-700">720</td>

            <td class="px-3 py-2 border-b border-gray-700">2-68</td>

            <td class="px-3 py-2 border-b border-gray-700">67</td>

            <td class="px-3 py-2 border-b border-gray-700">1071</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">15</td>

            <td class="px-3 py-2 border-b border-gray-700">30</td>

            <td class="px-3 py-2 border-b border-gray-700">1600</td>

            <td class="px-3 py-2 border-b border-gray-700">216</td>

            <td class="px-3 py-2 border-b border-gray-700">103</td>

            <td class="px-3 py-2 border-b border-gray-700">7</td>

            <td class="px-3 py-2 border-b border-gray-700">627</td>

            <td class="px-3 py-2 border-b border-gray-700">2-25</td>

            <td class="px-3 py-2 border-b border-gray-700">24</td>

            <td class="px-3 py-2 border-b border-gray-700">85</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">15</td>

            <td class="px-3 py-2 border-b border-gray-700">58</td>

            <td class="px-3 py-2 border-b border-gray-700">2400</td>

            <td class="px-3 py-2 border-b border-gray-700">217</td>

            <td class="px-3 py-2 border-b border-gray-700">167</td>

            <td class="px-3 py-2 border-b border-gray-700">8</td>

            <td class="px-3 py-2 border-b border-gray-700">708</td>

            <td class="px-3 py-2 border-b border-gray-700">2-53</td>

            <td class="px-3 py-2 border-b border-gray-700">52</td>

            <td class="px-3 py-2 border-b border-gray-700">494</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">20</td>

            <td class="px-3 py-2 border-b border-gray-700">20</td>

            <td class="px-3 py-2 border-b border-gray-700">1200</td>

            <td class="px-3 py-2 border-b border-gray-700">216</td>

            <td class="px-3 py-2 border-b border-gray-700">63</td>

            <td class="px-3 py-2 border-b border-gray-700">6</td>

            <td class="px-3 py-2 border-b border-gray-700">393</td>

            <td class="px-3 py-2 border-b border-gray-700">2-15</td>

            <td class="px-3 py-2 border-b border-gray-700">14</td>

            <td class="px-3 py-2 border-b border-gray-700">40</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">20</td>

            <td class="px-3 py-2 border-b border-gray-700">20</td>

            <td class="px-3 py-2 border-b border-gray-700">1600</td>

            <td class="px-3 py-2 border-b border-gray-700">216</td>

            <td class="px-3 py-2 border-b border-gray-700">63</td>

            <td class="px-3 py-2 border-b border-gray-700">6</td>

            <td class="px-3 py-2 border-b border-gray-700">793</td>

            <td class="px-3 py-2 border-b border-gray-700">2-15</td>

            <td class="px-3 py-2 border-b border-gray-700">14</td>

            <td class="px-3 py-2 border-b border-gray-700">63</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">20</td>

            <td class="px-3 py-2 border-b border-gray-700">20</td>

            <td class="px-3 py-2 border-b border-gray-700">3600</td>

            <td class="px-3 py-2 border-b border-gray-700">218</td>

            <td class="px-3 py-2 border-b border-gray-700">63</td>

            <td class="px-3 py-2 border-b border-gray-700">6</td>

            <td class="px-3 py-2 border-b border-gray-700">2791</td>

            <td class="px-3 py-2 border-b border-gray-700">2-15</td>

            <td class="px-3 py-2 border-b border-gray-700">14</td>

            <td class="px-3 py-2 border-b border-gray-700">949</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">20</td>

            <td class="px-3 py-2 border-b border-gray-700">56</td>

            <td class="px-3 py-2 border-b border-gray-700">2400</td>

            <td class="px-3 py-2 border-b border-gray-700">217</td>

            <td class="px-3 py-2 border-b border-gray-700">127</td>

            <td class="px-3 py-2 border-b border-gray-700">7</td>

            <td class="px-3 py-2 border-b border-gray-700">806</td>

            <td class="px-3 py-2 border-b border-gray-700">2-51</td>

            <td class="px-3 py-2 border-b border-gray-700">50</td>

            <td class="px-3 py-2 border-b border-gray-700">411</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">20</td>

            <td class="px-3 py-2 border-b border-gray-700">76</td>

            <td class="px-3 py-2 border-b border-gray-700">3000</td>

            <td class="px-3 py-2 border-b border-gray-700">217</td>

            <td class="px-3 py-2 border-b border-gray-700">167</td>

            <td class="px-3 py-2 border-b border-gray-700">8</td>

            <td class="px-3 py-2 border-b border-gray-700">752</td>

            <td class="px-3 py-2 border-b border-gray-700">2-64</td>

            <td class="px-3 py-2 border-b border-gray-700">63</td>

            <td class="px-3 py-2 border-b border-gray-700">640</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">20</td>

            <td class="px-3 py-2 border-b border-gray-700">76</td>

            <td class="px-3 py-2 border-b border-gray-700">3600</td>

            <td class="px-3 py-2 border-b border-gray-700">218</td>

            <td class="px-3 py-2 border-b border-gray-700">167</td>

            <td class="px-3 py-2 border-b border-gray-700">8</td>

            <td class="px-3 py-2 border-b border-gray-700">1351</td>

            <td class="px-3 py-2 border-b border-gray-700">2-64</td>

            <td class="px-3 py-2 border-b border-gray-700">63</td>

            <td class="px-3 py-2 border-b border-gray-700">1893</td>

          </tr>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">† The modulus  <span class="math">q_{\\ell}</span>  of the ciphertext prior to bootstrapping is  <span class="math">m / \\epsilon</span> . The number of bits of  <span class="math">q_{\\ell}</span>  is the sum of the first two entries in a row in the table. †† Includes runtime of “Coefficients to Slots” and “Slots to Coefficients” steps. Number of slots fixed to be 8 so that the “Compute the Mod Function” step dominates runtime. Results reported are from a 3.6 GHz six-core AMD CPU using quadmath, NTL and GMP software libraries.</p>

    <p class="text-gray-300">modulus of the ciphertext after bootstrapping. The reported error is the decryption error after performing bootstrapping⁴. We see that our polynomials are capable of achieving high precision bootstrapping, with the resulting message precision as large as 67 bits, larger even than the precision of a double variable. Prior to our work, the highest precision bootstrapping of CKKS was the recent work of [18] which could achieve a resulting message precision of up to 40 bits. Thus, we view our result as a substantial improvement for bootstrapping in settings where high precision is required, such as the inference step of a convolution neural network or even the learning stage of the neural network. As mentioned earlier, since CKKS is for approximate arithmetic, it is only possible to have unlimited computation for stable computations that do not lose precision. However, even such stable computations lose precision in early stages prior to convergence. Thus, it is important to begin such computations with high precision and, later, one can switch to smaller precision during the stable regime.</p>

    <h2 id="sec-26" class="text-2xl font-bold">11 Modular Lagrange Interpolation Beyond the Mod Function</h2>

    <p class="text-gray-300">The techniques developed in earlier sections also apply to other bounded piecewise smooth functions, especially of low-degree. However, many times, a more judicious algebraic manipulation can lead to a smaller degree or better approximation interpolation. For example, for <span class="math">x \\in \\ell N + [-1/2, 1/2]</span>, <span class="math">\\ell \\in [-k..k]</span>, define <span class="math">I(x)</span> to be <span class="math">\\ell</span>. Then the mod function <span class="math">f_{N}(x)</span> on these intervals can be written as <span class="math">x - I(x)*N</span>. and <span class="math">I(x) = (x - f_{N}(x)) / N</span>. Thus, an <span class="math">\\mathrm{O}(N^{-1})</span>-approximation <span class="math">g(x)</span> of <span class="math">f_{N}(x)</span> gives us a <span class="math">\\mathrm{O}(N^{-2})</span> approximation of <span class="math">I(x)</span>, as <span class="math">(x - g(x)) / N</span>. This is not surprising, as a linear function already approximates <span class="math">I(x)</span> to <span class="math">\\mathrm{O}(N^{-1})</span> and, thus, the modular interpolation is likely to give a much better approximation, i.e. an <span class="math">\\mathrm{O}(N^{-2})</span>-approximation, whereas the bounds in Theorem 6 only give <span class="math">\\mathrm{O}(N^{-1})</span>.</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">We have the following generalization of Theorem 9. Let <span class="math">\\{f_{\\ell}\\}_{\\ell \\in [-k..k]}</span> be a set of functions each of degree <span class="math">s</span>, with $</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">f_{\\ell}(\\mathbf{x})</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"><span class="math"> bounded by </span>B<span class="math"> when </span>\\mathbf{x}<span class="math"> is in the </span>\\ell<span class="math">-th interval </span>\\ell N + [-1/2, 1/2]<span class="math">. Define, for </span>b, d \\geq 1<span class="math">, and </span>c \\geq 0$,</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <div class="my-4 text-center"><span class="math-block">g _ {b, c, d} (\\mathbf {x}) = \\sum_ {\\ell \\in \\mathcal {L}} \\sum_ {z \\in S _ {\\ell}} f _ {\\ell} (z) * \\prod_ {w \\in S _ {\\ell} \\backslash \\{z \\}} \\frac {\\mathbf {x} - w}{z - w} * \\prod_ {\\substack {\\ell^ {\\prime} \\in \\mathcal {L} \\\\ \\ell^ {\\prime} \\neq \\ell}} \\left(\\frac {\\mathbf {x} - \\ell^ {\\prime} N}{z - \\ell^ {\\prime} N}\\right) ^ {d + c + b * p (\\ell^ {\\prime})} \\tag{9}</span></div>

    <p class="text-gray-300">where <span class="math">p(\\ell&#x27;)</span> is defined as before in Section 4. When <span class="math">b = \\lceil d / 2 \\rceil</span> and <span class="math">d + c = 2b</span>, we refer to the polynomial simply as <span class="math">g_d(\\mathbf{x})</span>.</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">⁴ In other words, if the decryption before bootstrapping would have resulted in message slot value <span class="math">m</span>, then the decryption after bootstrapping would result in a message slot value <span class="math">m&#x27;</span> such that $</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">m' - m</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\leq \\beta_{\\mathrm{bs}}</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">m</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"><span class="math">. Thus, the resulting precision of </span>m'<span class="math"> is </span>-\\log_2 \\beta_{\\mathrm{bs}} - 1$ bits.</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <h6 id="sec-27" class="text-base font-medium mt-4">Theorem 12</h6>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">For any <span class="math">k,d&gt;0</span>, <span class="math">N&gt;0.22<em>k</em>3.4^{k}</span> and <span class="math">N&gt;(\\mathsf{m}+d+1)/(d+1)</span>, <span class="math">k\\geq 12</span>, and <span class="math">k</span> a multiple of twelve, for any <span class="math">\\mathbf{x}</span> such that $</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\mathbf{x}-\\ell N</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\leq 1/2<span class="math"> with </span>\\ell\\in\\{-k,-k+1,\\ldots,k\\}$, we have</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">$</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">g_{2d}(\\mathbf{x})-f_{\\ell}(\\mathbf{x})</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"><N^{-2d+s}<em>B</em>2^{2d}*\\left(1+\\frac{e\\mathsf{m}}{d}\\right)^{2d}+$</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300"><span class="math">N^{-2d+s}<em>\\left(4k</em>N+(4d+6)<em>(33</em>k^{2})^{d}\\right)<em>\\left(\\sqrt{k}</em>1.1221^{k}/2\\right)^{d}</span></p>

    <p class="text-gray-300">and</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">$</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">g_{2d+1}(\\mathbf{x})-f_{\\ell}(\\mathbf{x})</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"><N^{-2d-1+s}<em>B</em>2^{2d+1}*\\left(1+\\frac{2e\\mathsf{m}}{2d+1}\\right)^{2d+1}+$</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300"><span class="math">N^{-2d-1+s}<em>\\left(4k+(4d+10)</em>(33<em>k^{2})^{d+1}/N\\right)</em>\\left(\\sqrt{k}*1.1221^{k}/2\\right)^{d+1}</span></p>

    <h2 id="sec-28" class="text-2xl font-bold">12 Conclusion</h2>

    <p class="text-gray-300">In this work, we introduced a novel technique called modular Lagrange interpolation that allows one to find low-degree polynomial approximations of a function on the union of small intervals even if the function is not continuous. By using modular Lagrange interpolation, we are able to prove explicit error bounds on these polynomials. We demonstrated the efficacy of our technique by constructing explicit low-degree polynomials that approximate the mod function well on intervals around the modulus. These polynomials have major applications to bootstrapping for approximate homomorphic encryption and allow us to bypass the fundamental error of approximation inherent in prior works which first used a scaled sine function to approximate the mod function on these intervals. We implemented the bootstrapping of HEAAN using our polynomials and gave performance results for various parameter settings. We found that our polynomials enable high-precision bootstrapping and, as an example, achieved bootstrapping with 67 bit message precision. Further improvements to the floating point precision of the CKKS embedding in implementations can lead to even higher precision with our techniques.</p>

    <h2 id="sec-29" class="text-2xl font-bold">References</h2>

    <ul class="list-disc list-inside space-y-1 text-gray-300 my-2 ml-4">

      <li>[1] Heaan, https://github.com/snucrypto/HEAAN 10</li>

      <li>[2] Albrecht, M.R.: On dual lattice attacks against small-secret lwe and parameter choices in helib and seal. In: Coron, J.S., Nielsen, J.B. (eds.) Advances in Cryptology – EUROCRYPT 2017. pp. 103–129. Springer International Publishing, Cham (2017) 10</li>

    </ul>

    <p class="text-gray-300">-</p>

    <ul class="list-disc list-inside space-y-1 text-gray-300 my-2 ml-4">

      <li>[3] Albrecht, M.R., Player, R., Scott, S.: On the concrete hardness of learning with errors. J. Math. Cryptol. 9(3), 169–203 (2015), http://www.degruyter.com/view/j/jmc.2015.9. issue-3/jmc-2015-0016/jmc-2015-0016.xml 10</li>

      <li>[4] Bergamaschi, F., Halevi, S., Halevi, T.T., Hunt, H.: Homomorphic training of 30,000 logistic regression models. In: Deng, R.H., Gauthier-Umaña, V., Ochoa, M., Yung, M. (eds.) Applied Cryptography and Network Security. pp. 592–611. Springer International Publishing, Cham (2019) 1.1</li>

      <li>[5] Berrut, J.P., Trefethen, L.N.: Barycentric lagrange interpolation. SIAM Review 46, No. 3, 501–517 (2004) 1</li>

      <li>[6] Chen, H., Chillotti, I., Song, Y.: Improved bootstrapping for approximate homomorphic encryption. In: EUROCRYPT. pp. 34–54 (2019) 1.1, 9, 9</li>

      <li>[7] Cheon, J., Han, K., Kim, A., Kim, M., Song, Y.: Bootstrapping for approximate homomorphic encryption. In: EUROCRYPT. pp. 360–384 (01 2018) 1.1, 1.1, 9, 9, 9</li>

      <li>[8] Cheon, J.H., Han, K., Kim, A., Kim, M., Song, Y.: A full rns variant of approximate homomorphic encryption. In: Selected Areas in Cryptography – SAC 2018 (2018) 1.1, 9</li>

      <li>[9] Cheon, J.H., Kim, A., Kim, M., Song, Y.: Homomorphic encryption for arithmetic of approximate numbers. In: ASIACRYPT (2017) 1.1, 9</li>

      <li>[10] Fike, C.: Computer evaluation of mathematical functions. Princeton Hall (1968) 2.2</li>

      <li>[11] Fornberg, B.: A practical guide to pseudospectral methods. Cambridge univ. Press (1996) 1</li>

      <li>[12] Gentry, C.: Fully homomorphic encryption using ideal lattices. In: STOC. pp. 169–178 (2009) 1.1</li>

      <li>[13] Han, K., Hhan, M., Cheon, J.H.: Improved homomorphic discrete fourier transforms and fhe bootstrapping. IEEE Access 7, 57361–57370 (2019) 9</li>

      <li>[14] Han, K., Ki, D.: Better bootstrapping for approximate homomorphic encryption. In: Jarecki, S. (ed.) Topics in Cryptology – CT-RSA 2020. pp. 364–390. Springer International Publishing, Cham (2020) 1.1, 8, 2, 9, 9</li>

      <li>[15] Kim, A., Song, Y., Kim, M., Lee, K., Cheon, J.H.: Logistic regression model training based on the approximate homomorphic encryption. BMC Medical Genomics 11(4), 83 (2018), https://doi.org/10.1186/s12920-018-0401-7 1.1</li>

    </ul>

    <p class="text-gray-300">[16] Kim, M., Harmanci, A., Bossuat, J.P., Carpov, S., Cheon, J., Chilotti, I., Cho, W., Froelicher, D., Gama, N., Georgieva, M., Hong, S., Hubaux, J.P., Kim, D., Lauter, K., Ma, Y., Ohno-Machado, L., Sofia, H., Son, Y., Song, Y., Jiang, X.: Ultra-fast homomorphic encryption models enable secure outsourcing of genotype imputation. bioRxiv (2020) 1.1</p>

    <ul class="list-disc list-inside space-y-1 text-gray-300 my-2 ml-4">

      <li>[17] Kim, M., Song, Y., Wang, S., Xia, Y., Jiang, X.: Secure logistic regression based on homomorphic encryption: Design and evaluation. JMIR Med Inform 6(2), e19 (Apr 2018), http://www.ncbi.nlm.nih.gov/pubmed/29666041 1.1</li>

      <li>[18] Lee, J., Lee, E., Lee, Y., Kim, Y., No, J.: High-precision bootstrapping of rns-ckks homomorphic encryption using optimal minimax polynomial approximation and inverse sine function. IACR Cryptol. ePrint Arch. 2020, 552 (2020) 1.1, 9, 10</li>

      <li>[19] Lee, Y., Lee, J., Kim, Y., No, J.: Near-optimal polynomial for modulus reduction using l2-norm for approximate homomorphic encryption. IEEE Access 8, 144321–144330 (2020) 9</li>

      <li>[20] Masters, O., Hunt, H., Steffinlongo, E., Crawford, J., Bergamaschi, F., Rosa, M.E.D., Quini, C.C., Alves, C.T., de Souza, F., Ferreira, D.G.: Towards a homomorphic machine learning big data pipeline for the financial services sector. In: RWC (2020) 1.1</li>

      <li>[21] Remez, E., G.: Sur la determination des polynomes d’approximation de degre’ donnee’. Comm. of the Kharkov Math. Soc. 10(196), 41–63 (1934) 1, 9</li>

      <li>[22] Robbins, H.: A remark on stirling’s formula. The American Mathematical Monthly 62(1), 26–29 (Jan 1955) C</li>

      <li>[23] Sav, S., Pyrgelis, A., Troncoso-Pastoriza, J.R., Froelicher, D., Bossuat, J.P., Sousa, J.S., Hubaux, J.P.: Poseidon: Privacy-preserving federated neural network learning (2020) 1.1</li>

      <li>[24] Strang, G.: The discrete cosine transform. SIAM Review 41, No. 1, 135–147 (2004) 2.2</li>

    </ul>

    <h2 id="sec-30" class="text-2xl font-bold">Supplementary Material</h2>

    <h2 id="sec-31" class="text-2xl font-bold">Appendix A Upper Bound on Lagrange Basis Polynomial</h2>

    <p class="text-gray-300">In this section, we will determine an upper bound on the absolute value of the Lagrange basis polynomials <span class="math">\\ell^{(m)}_{j;t_{0},\\ldots,t_{m}}(\\mathbf{x})</span> when <span class="math">t_{0},\\ldots,t_{m}</span> are evenly spaced points in the closed interval <span class="math">[-1/2,1/2]</span> and <span class="math">\\mathbf{x}\\in[-1/2,1/2]</span>. We can write these points as <span class="math">t_{i}=\\frac{i}{m}-\\frac{1}{2}</span> for <span class="math">i\\in\\{0,\\ldots,m\\}</span>.</p>

    <p class="text-gray-300">First, we will consider the denominator of <span class="math">\\ell^{(m)}_{j;t_{0},\\ldots,t_{m}}(\\mathbf{x})</span>, which is independent of <span class="math">\\mathbf{x}</span>. For the <span class="math">j</span>th Lagrange basis polynomial, the denominator is given by</p>

    <p class="text-gray-300"><span class="math">\\prod_{i\\in\\{0,\\ldots,m\\}\\setminus\\{j\\}}t_{j}-t_{i}.</span></p>

    <p class="text-gray-300">The term <span class="math">t_{j}-t_{i}=\\frac{j-i}{m}</span>. Thus, the absolute value of the denominator can be written as</p>

    <p class="text-gray-300"><span class="math">\\frac{j!(m-j)!}{m^{m}}.</span></p>

    <p class="text-gray-300">Now, we will consider the numerator. For the <span class="math">j</span>th Lagrange basis polynomial, the numerator can be written as</p>

    <p class="text-gray-300"><span class="math">\\prod_{i\\in\\{0,\\ldots,m\\}\\setminus\\{j\\}}\\mathbf{x}-t_{i}=\\prod_{i\\in\\{0,\\ldots,m\\}\\setminus\\{j\\}}\\mathbf{x}-\\left(\\frac{i}{m}-\\frac{1}{2}\\right)</span></p>

    <p class="text-gray-300">for <span class="math">\\mathbf{x}\\in[-1/2,1/2]</span>. Setting <span class="math">\\mathbf{y}=\\mathbf{x}+\\frac{1}{2}</span>, we have</p>

    <p class="text-gray-300"><span class="math">\\prod_{i\\in\\{0,\\ldots,m\\}\\setminus\\{j\\}}\\mathbf{y}-\\frac{i}{m}</span></p>

    <p class="text-gray-300">for <span class="math">\\mathbf{y}\\in[0,1]</span>. Consider the <span class="math">m+1</span> points <span class="math">0,\\frac{1}{m},\\frac{2}{m},\\ldots,1</span>. The maximum possible value of the numerator occurs when <span class="math">\\mathbf{y}</span> is set to maximize the product of the distances between <span class="math">\\mathbf{y}</span> and all but one these points. First, we observe that for any fixed <span class="math">\\mathbf{y}</span>, the value is maximized when we exclude the point closest to <span class="math">\\mathbf{y}</span>. Having done this, we observe that the maximum occurs when <span class="math">\\mathbf{y}=1</span> and we remove the point <span class="math">1</span>. This follows from the fact that the nearest point is <span class="math">\\frac{1}{m}</span> away, which is the maximum possible. The second nearest point is <span class="math">\\frac{2}{m}</span> away, which, again, is the maximum possible and so forth. Thus, the maximum absolute value of the numerator can be bounded by <span class="math">\\frac{m!}{m^{m}}</span>. Dividing the numerator and denominator, we arrive at the bound</p>

    <p class="text-gray-300"><span class="math">\\frac{m!}{j!(m-j)!}=\\binom{m}{j}</span></p>

    <p class="text-gray-300">for the <span class="math">j</span>th Lagrange basis polynomial.</p>

    <p class="text-gray-300">##</p>

    <p class="text-gray-300">B Proof of Lemma 4</p>

    <p class="text-gray-300">For any <span class="math">\\ell \\in [-k..k]</span>, and <span class="math">\\mathbf{x} \\in [-1/2 + \\ell N, +1/2 + \\ell N]</span>,</p>

    <div class="my-4 text-center"><span class="math-block">\\begin{aligned} \\sum_{z \\in S_{\\ell}} f_{N}(z) * \\left(\\prod_{w \\in S_{\\ell} \\setminus \\{z\\}} \\frac{\\mathbf{x} - w}{z - w}\\right) * \\prod_{\\substack{\\ell&#x27; \\in \\mathcal{L} \\\\ \\ell&#x27; \\neq \\ell}} \\left(\\frac{\\mathbf{x} - \\ell&#x27; N}{(\\ell - \\ell&#x27;) N}\\right)^{2 + p(\\ell&#x27;)} \\\\ = \\prod_{\\substack{\\ell&#x27; \\in \\mathcal{L} \\\\ \\ell&#x27; \\neq \\ell}} \\left(\\frac{\\mathbf{x} - \\ell&#x27; N}{(\\ell - \\ell&#x27;) N}\\right)^{2 + p(\\ell&#x27;)} * \\sum_{z \\in S_{\\ell}} f_{N}(z) * \\left(\\prod_{w \\in S_{\\ell} \\setminus \\{z\\}} \\frac{\\mathbf{x} - w}{z - w}\\right) \\\\ = (\\mathbf{x} - \\ell N) * \\prod_{\\substack{\\ell&#x27; \\in \\mathcal{L} \\\\ \\ell&#x27; \\neq \\ell}} \\left(\\frac{\\mathbf{x} - \\ell&#x27; N}{(\\ell - \\ell&#x27;) N}\\right)^{2 + p(\\ell&#x27;)} \\\\ = (\\mathbf{x} - \\ell N) * \\prod_{\\substack{\\ell&#x27; \\in \\mathcal{L} \\\\ \\ell&#x27; \\neq \\ell}} \\left(1 - (\\mathbf{x} - \\ell N) / ((\\ell&#x27; - \\ell) N)\\right)^{2 + p(\\ell&#x27;)} \\\\ = \\mathbf{x}&#x27; * \\prod_{\\substack{\\ell&#x27; \\in \\mathcal{L} \\\\ \\ell&#x27; \\neq \\ell}} \\left(1 - \\mathbf{x}&#x27; / ((\\ell&#x27; - \\ell) N)\\right)^{2 + p(\\ell&#x27;)} \\tag{10} \\end{aligned}</span></div>

    <p class="text-gray-300">where we let <span class="math">\\mathbf{x}&#x27;</span> stand for <span class="math">(\\mathbf{x} - \\ell N)</span>. If <span class="math">\\ell</span> is zero, then the big product above can be simplified, by noting that <span class="math">p(\\ell&#x27;) = p(-\\ell&#x27;)</span>, to</p>

    <div class="my-4 text-center"><span class="math-block">\\prod_{\\ell&#x27; \\in [1..k]} \\left(1 - (\\mathbf{x})^2 / (\\ell&#x27; N)^2\\right)^{2 + p(\\ell&#x27;}</span></div>

    <p class="text-gray-300">When <span class="math">\\ell \\neq 0</span>, we can still try to pairoff <span class="math">(\\ell&#x27; - \\ell)</span> around <span class="math">\\ell</span> as much as possible, but we must address the slight complication due to <span class="math">p(\\ell&#x27;)</span>. So, define <span class="math">\\mathcal{L}^{(1)}</span> to be subset of <span class="math">\\mathcal{L}</span> where <span class="math">p(\\ell&#x27;) \\geq 1</span>, and similarly <span class="math">\\mathcal{L}^{(2)}</span> to be subset of <span class="math">\\mathcal{L}</span> where <span class="math">p(\\ell&#x27;) \\geq 2</span>. Then, we have</p>

    <div class="my-4 text-center"><span class="math-block">\\begin{aligned} \\prod_{\\substack{\\ell&#x27; \\in \\mathcal{L} \\\\ \\ell&#x27; \\neq \\ell}} \\left(1 - \\mathbf{x}&#x27; / ((\\ell&#x27; - \\ell) N)\\right)^{2 + p(\\ell&#x27;)} \\\\ = \\prod_{\\substack{\\ell&#x27; \\in \\mathcal{L} \\\\ \\ell&#x27; \\neq \\ell}} \\left(1 - \\frac{\\mathbf{x}&#x27;}{(\\ell&#x27; - \\ell) N}\\right)^2 * \\prod_{\\substack{\\ell&#x27; \\in \\mathcal{L}^{(1)} \\\\ \\ell&#x27; \\neq \\ell}} \\left(1 - \\frac{\\mathbf{x}&#x27;}{(\\ell&#x27; - \\ell) N}\\right) * \\prod_{\\substack{\\ell&#x27; \\in \\mathcal{L}^{(2)} \\\\ \\ell&#x27; \\neq \\ell}} \\left(1 - \\frac{\\mathbf{x}&#x27;}{(\\ell&#x27; - \\ell) N}\\right) \\end{aligned}</span></div>

    <p class="text-gray-300">Since, the above is one plus or minus other terms involving <span class="math">\\mathbf{x}&#x27; / N</span>, it follows that the quantity (10) differs from <span class="math">f_{N}(\\mathbf{x}) = \\mathbf{x}&#x27;</span> (with <span class="math">\\mathbf{x}</span> in the <span class="math">\\ell</span>-th interval) in absolute value by at most</p>

    <div class="my-4 text-center"><span class="math-block"></span></div>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\frac {1}{2} * \\left(- 1 + \\prod_ {\\substack {\\ell^ {\\prime} \\in \\mathcal {L} \\\\ \\ell^ {\\prime} \\neq \\ell}} \\left(1 + \\frac {</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\mathbf {x} ^ {\\prime}</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">}{</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\ell^ {\\prime} - \\ell</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"><em> N}\\right) ^ {2} </em> \\prod_ {\\substack {\\ell^ {\\prime} \\in \\mathcal {L} ^ {(1)} \\\\ \\ell^ {\\prime} \\neq \\ell}} \\left(1 + \\frac {</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\mathbf {x} ^ {\\prime}</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">}{</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\ell^ {\\prime} - \\ell</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"><em> N}\\right) </em> \\prod_ {\\substack {\\ell^ {\\prime} \\in \\mathcal {L} ^ {(2)} \\\\ \\ell^ {\\prime} \\neq \\ell}} \\left(1 + \\frac {</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\mathbf {x} ^ {\\prime}</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">}{</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\ell^ {\\prime} - \\ell</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">* N}\\right)\\right) \\tag{11}</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <div class="my-4 text-center"><span class="math-block"></span></div>

    <p class="text-gray-300">Focusing just on one of these products we have, and assuming <span class="math">N &amp;gt; k</span>,</p>

    <p class="text-gray-300">$$ \\begin{array}{l}</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\prod_{\\substack{\\ell^{\\prime}\\in \\mathcal{L}\\\\ \\ell^{\\prime}\\neq \\ell}}\\left(1 + \\frac{</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\mathbf{x}^{\\prime}</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">}{</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\ell^{\\prime} - \\ell</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">*N}\\right) \\\\</th>

          </tr>

        </thead>

        <tbody>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">\\leq \\left(1 + \\sum_{i \\in [1..k]} \\frac{</td>

            <td class="px-3 py-2 border-b border-gray-700">\\mathbf{x}^{\\prime}</td>

            <td class="px-3 py-2 border-b border-gray-700">}{i * N} + \\sum_{j \\in [2..k]} \\binom{k}{j} \\left(\\frac{</td>

            <td class="px-3 py-2 border-b border-gray-700">\\mathbf{x}^{\\prime}</td>

            <td class="px-3 py-2 border-b border-gray-700">}{N}\\right)^{j}\\right)^{2} \\\\</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">\\leq \\left(1 + \\ln (e k) * \\frac {</td>

            <td class="px-3 py-2 border-b border-gray-700">\\mathbf {x} ^ {\\prime}</td>

            <td class="px-3 py-2 border-b border-gray-700">}{N} + \\sum_ {j \\in [ 2.. k ]} k ^ {j} * \\left(\\frac {</td>

            <td class="px-3 py-2 border-b border-gray-700">\\mathbf {x} ^ {\\prime}</td>

            <td class="px-3 py-2 border-b border-gray-700">}{N}\\right) ^ {j}\\right) ^ {2} \\\\</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">\\leq \\left(1 + \\ln (e k) * \\frac {</td>

            <td class="px-3 py-2 border-b border-gray-700">\\mathbf {x} ^ {\\prime}</td>

            <td class="px-3 py-2 border-b border-gray-700">}{N} + \\sum_ {j \\in [ 2.. k ]} \\left(\\frac {</td>

            <td class="px-3 py-2 border-b border-gray-700">\\mathbf {x} ^ {\\prime}</td>

            <td class="px-3 py-2 border-b border-gray-700">* k}{N}\\right) ^ {j}\\right) ^ {2} \\\\</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">\\leq \\left(1 + \\ln (e k) * \\frac {</td>

            <td class="px-3 py-2 border-b border-gray-700">\\mathbf {x} ^ {\\prime}</td>

            <td class="px-3 py-2 border-b border-gray-700">}{N} + \\left(\\frac {</td>

            <td class="px-3 py-2 border-b border-gray-700">\\mathbf {x} ^ {\\prime}</td>

            <td class="px-3 py-2 border-b border-gray-700"><em> k}{N}\\right) ^ {2} </em> \\frac {1}{1 -</td>

            <td class="px-3 py-2 border-b border-gray-700">\\mathbf {x} ^ {\\prime}</td>

            <td class="px-3 py-2 border-b border-gray-700">* k / N}\\right) ^ {2} \\\\</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">\\leq \\left(1 + 2 <em> \\ln (e k) </em> \\frac {</td>

            <td class="px-3 py-2 border-b border-gray-700">\\mathbf {x} ^ {\\prime}</td>

            <td class="px-3 py-2 border-b border-gray-700">}{N} + 4 * \\left(\\frac {</td>

            <td class="px-3 py-2 border-b border-gray-700">\\mathbf {x} ^ {\\prime}</td>

            <td class="px-3 py-2 border-b border-gray-700">* k}{N}\\right) ^ {2}\\right) \\\\</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">\\leq \\left(1 + 2 <em> \\ln (e k) </em> \\frac {</td>

            <td class="px-3 py-2 border-b border-gray-700">\\mathbf {x} ^ {\\prime}</td>

            <td class="px-3 py-2 border-b border-gray-700">}{N} + \\frac {k ^ {2}}{N ^ {2}}\\right) \\tag{12}</td>

          </tr>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">\\end{array} $$</p>

    <p class="text-gray-300">Thus, using (11), it follows that the quantity (10) differs from <span class="math">f_{N}(\\mathbf{x}) = \\mathbf{x}^{\\prime}</span> (with <span class="math">\\mathbf{x}</span> in the <span class="math">\\ell</span>-th interval) in absolute value by at most</p>

    <div class="my-4 text-center"><span class="math-block">\\frac {2 * \\ln (e k)}{N} + \\frac {2 k ^ {2}}{N ^ {2}}</span></div>

    <h2 id="sec-32" class="text-2xl font-bold">C Proof of Lemma 5</h2>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Proof: With $</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\mathbf{x} - tN</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\leq 1/2<span class="math"> for </span>t \\in \\{-k, -k + 1, \\ldots, k\\}<span class="math">, we now analyze the other summands (i.e. </span>\\ell \\neq t<span class="math">) of (7). Let </span>\\mathbf{x} = \\mathbf{x}' + tN<span class="math">, with </span></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\mathbf{x}'</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\leq 1/2<span class="math">. We have (recalling </span>\\ell \\neq t$),</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <div class="my-4 text-center"><span class="math-block">\\begin{array}{l} \\sum_ {z \\in S _ {\\ell}} f _ {N} (z) * \\prod_ {w \\in S _ {\\ell} \\backslash \\{z \\}} \\frac {\\mathbf {x} ^ {\\prime} + t * N - w}{z - w} * \\prod_ {\\substack {\\ell^ {\\prime} \\in \\mathcal {L} \\\\ \\ell^ {\\prime} \\neq \\ell}} \\left(\\frac {\\mathbf {x} ^ {\\prime} + t * N - \\ell^ {\\prime} N}{\\ell N - \\ell^ {\\prime} N}\\right) ^ {2 + p (\\ell^ {\\prime})} \\\\ = \\left(\\mathbf {x} ^ {\\prime} - (\\ell - t) N\\right) * \\prod_ {\\substack {\\ell^ {\\prime} \\in \\mathcal {L} \\\\ \\ell^ {\\prime} \\neq \\ell}} \\left(\\frac {\\mathbf {x} ^ {\\prime} - (\\ell^ {\\prime} - t) N}{(\\ell - \\ell^ {\\prime}) N}\\right) ^ {2 + p \\left(\\ell^ {\\prime}\\right)} \\tag{13} \\\\ \\end{array}</span></div>

    <p class="text-gray-300">For <span class="math">N &amp;gt;&amp;gt; 1</span>, the absolute value of the above is upper bounded by approximately</p>

    <div class="my-4 text-center"><span class="math-block"></span></div>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\left(\\mathbf {x} ^ {\\prime}\\right) ^ {2 + p (t)} <em> N ^ {- 1 - p (t)} </em> \\left</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">t - \\ell \\right</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">^ {- 1 - p (t)} * \\prod_ {\\substack {\\ell^ {\\prime} \\in \\mathcal {L} \\\\ \\ell^ {\\prime} \\neq \\ell \\\\ \\ell^ {\\prime} \\neq t}} \\left(\\frac {\\left</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\ell^ {\\prime} - t \\right</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">}{\\left</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\ell^ {\\prime} - \\ell \\right</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">}\\right) ^ {2 + p \\left(\\ell^ {\\prime}\\right)} \\tag{14}</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <div class="my-4 text-center"><span class="math-block"></span></div>

    <p class="text-gray-300">We can be more precise and use (10), (11) and (12) to get that expression 13 is upper bounded by</p>

    <div class="my-4 text-center"><span class="math-block"></span></div>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\left(\\mathbf {x} ^ {\\prime}\\right) ^ {2 + p (t)} <em> \\left(1 + 4 </em> \\frac {\\ln (e k)}{N} + \\frac {4 k ^ {2}}{N ^ {2}}\\right) <em> N ^ {- 1 - p (t)} </em> \\left</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">t - \\ell \\right</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">^ {- 1 - p (t)} * \\prod_ {\\substack {\\ell^ {\\prime} \\in \\mathcal {L} \\\\ \\ell^ {\\prime} \\neq \\ell \\\\ \\ell^ {\\prime} \\neq t}} \\left(\\frac {\\left</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\ell^ {\\prime} - t \\right</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">}{\\left</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\ell^ {\\prime} - \\ell \\right</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">}\\right) ^ {2 + p \\left(\\ell^ {\\prime}\\right)} \\tag{15}</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <div class="my-4 text-center"><span class="math-block"></span></div>

    <p class="text-gray-300">We now upper bound this quantity for different values of <span class="math">t</span> and <span class="math">\\ell</span>. Along the way, we will show that the denominator above is smallest when <span class="math">\\ell</span> is zero. We will split the analysis according to the three cases depending on the value of <span class="math">p(t)</span>. So, we first consider <span class="math">t \\leq k/2</span>, where <span class="math">p(t) = 0</span>. In this case the above quantity has factor <span class="math">N^{-1}</span>, i.e., has no additional negative powers of <span class="math">N</span>.</p>

    <p class="text-gray-300">37</p>

    <p class="text-gray-300">Thus, we would like to prove that, for <span class="math">\\ell = 0</span> and <span class="math">t \\leq k/2</span>, the following quantity is small:</p>

    <p class="text-gray-300">$$ \\begin{array}{l}</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">t - \\ell</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">^ {- 1 - p (t)} * \\prod_ {\\substack {\\ell^ {\\prime} \\in \\mathcal {L} \\\\ \\ell^ {\\prime} \\neq \\ell \\\\ \\ell^ {\\prime} \\neq t}} \\left(\\frac {</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\ell^ {\\prime} - t</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">}{</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\ell^ {\\prime} - \\ell</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">}\\right) ^ {2 + p (\\ell^ {\\prime})} \\\\</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">\\end{array} $$</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">where $P_{i} = \\prod_{\\ell^{\\prime}\\in \\mathcal{L},\\ell^{\\prime}\\neq i}</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\ell^{\\prime} - i</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">^{2 + p(\\ell^{\\prime})}$.</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">Consider the following sequence of integers: <span class="math">a_0 = 0</span>, <span class="math">a_1 = \\lfloor k / 2 \\rfloor</span>, <span class="math">a_2 = \\lfloor (11 / 12) <em> k \\rfloor</span>, and <span class="math">a_3 = k</span>. Since, we assume that <span class="math">k</span> is a multiple of 12, <span class="math">a_1 = k / 2</span> and <span class="math">a_2 = (11 / 12) </em> k</span>. Then, <span class="math">p(\\ell&#x27;) = k</span> for integers <span class="math">\\ell&#x27;</span> in the range <span class="math">[a_k + 1..a_{k+1}]</span>, for all <span class="math">k \\in [0..2]</span>. Also, <span class="math">p(a_0) = 0</span>. Thus, for <span class="math">i \\leq a_1</span>,</p>

    <div class="my-4 text-center"><span class="math-block">P _ {i} = \\left(\\left(a _ {3} - i\\right)! \\left(a _ {3} + i\\right)!\\right) ^ {4} * \\left(\\left(a _ {1} - i\\right)! \\left(a _ {1} + i\\right)!\\right) ^ {- 1} * \\left(\\left(a _ {2} - i\\right)! \\left(a _ {2} + i\\right)!\\right) ^ {- 1},</span></div>

    <p class="text-gray-300">and for <span class="math">a_1 &amp;lt; i \\leq a_2</span>,</p>

    <div class="my-4 text-center"><span class="math-block">P _ {i} = \\left(\\left(a _ {3} - i\\right)! \\left(a _ {3} + i\\right)!\\right) ^ {4} * \\left(\\left(a _ {1} + i\\right)! / \\left(i - a _ {1}\\right)!\\right) ^ {- 1} * \\left(\\left(a _ {2} - i\\right)! \\left(a _ {2} + i\\right)!\\right) ^ {- 1},</span></div>

    <p class="text-gray-300">and for <span class="math">a_2 &amp;lt; i \\leq a_3 = k</span>,</p>

    <div class="my-4 text-center"><span class="math-block">P _ {i} = \\left(\\left(a _ {3} - i\\right)! \\left(a _ {3} + i\\right)!\\right) ^ {4} * \\left(\\left(a _ {1} + i\\right)! / \\left(i - a _ {1}\\right)!\\right) ^ {- 1} * \\left(\\left(a _ {2} + i\\right)! / \\left(i - a _ {2}\\right)!\\right) ^ {- 1}.</span></div>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">In Lemma 13 below we show that for all $</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\ell</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\leq k<span class="math"> and all </span></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">t</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\leq k/2$, we have</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <div class="my-4 text-center"><span class="math-block">P _ {t} / P _ {\\ell} &amp;lt; 0. 9 2 4 * \\sqrt {k} * (1. 1 2 2 1) ^ {k},</span></div>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">and, for all $</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\ell</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\leq k<span class="math"> and all </span></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">t</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\leq 11/12 * k$, we have</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <div class="my-4 text-center"><span class="math-block">P _ {t} / P _ {\\ell} &amp;lt; 0. 0 9 8 * \\sqrt {k ^ {3}} * (3. 8 1) ^ {k},</span></div>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">and, for all $</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\ell</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\leq k<span class="math"> and all </span></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">t</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\leq k$, we have</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <div class="my-4 text-center"><span class="math-block">P _ {t} / P _ {\\ell} &amp;lt; e * 0. 0 0 5 1 * k ^ {2} * (9. 8 1 3) ^ {k} \\leq 0. 0 1 4 * k ^ {2} * 9. 8 1 3 ^ {k}.</span></div>

    <p class="text-gray-300">Thus, in definition 6 of <span class="math">\\hat{g}(\\mathbf{x})</span>, using 15, and well-known bound on harmonic series, and assuming <span class="math">N &amp;gt; \\max\\{k, 80<em>\\ln(ek)\\}</span>, we have for all <span class="math">t \\in \\mathcal{L}</span>, and for all <span class="math">\\mathbf{x} \\in [-1/2 + t</em>N, 1/2 + t*N]</span>,</p>

    <p class="text-gray-300">$$ \\begin{array}{l}</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\left</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\sum_ {\\substack {\\ell \\in \\mathcal {L} \\\\ \\ell \\neq t}} \\sum_ {z \\in S _ {\\ell}} f _ {N} (z) <em> \\prod_ {w \\in S _ {\\ell} \\backslash \\{z \\}} \\frac {\\mathbf {x} - w}{z - w} </em> \\prod_ {\\substack {\\ell^ {\\prime} \\in \\mathcal {L} \\\\ \\ell^ {\\prime} \\neq \\ell}} \\left(\\frac {\\mathbf {x} - \\ell^ {\\prime} N}{z - \\ell^ {\\prime} N}\\right) ^ {2 d + p \\left(\\ell^ {\\prime}\\right)} \\right</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\tag{17} \\\\</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">\\leq (1 / 4) <em> 1. 1 </em> 2 <em> \\ln (e k) </em> \\max  \\{0. 9 <em> k ^ {\\frac {1}{2}} </em> \\frac {1 . 1 2 2 1 ^ {k}}{N}, 0. 2 4 <em> k ^ {\\frac {3}{2}} </em> \\frac {3 . 8 1 ^ {k}}{N ^ {2}}, 0. 0 1 4 <em> k ^ {2} </em> \\frac {9 . 8 1 3 ^ {k}}{N ^ {3}} \\} \\\\ \\end{array} $$</p>

    <p class="text-gray-300">∎</p>

    <h6 id="sec-33" class="text-base font-medium mt-4">Lemma 13</h6>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">For <span class="math">k</span> a multiple of twelve, and <span class="math">k\\geq 12</span>, for all $</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\ell</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\leq k<span class="math"> and all </span></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">t</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\leq k/2$, we have</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300"><span class="math">P_{t}/P_{\\ell}&lt;0.924<em>\\sqrt{k}</em>(1.1221)^{k},</span></p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">and, for all $</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\ell</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\leq k<span class="math"> and all </span></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">t</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\leq 11/12*k$, we have</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300"><span class="math">P_{t}/P_{\\ell}&lt;0.098<em>\\sqrt{k^{3}}</em>(3.81)^{k},</span></p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">and, for all $</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\ell</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\leq k<span class="math"> and all </span></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">t</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\leq k$, we have</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300"><span class="math">P_{t}/P_{\\ell}&lt;e<em>0.0051</em>k^{2}<em>(9.813)^{k}\\leq 0.014</em>k^{2}*9.813^{k}.</span></p>

    <p class="text-gray-300">Proof: We will prove the lemma by upper bounding <span class="math">P_{t}/P_{0}</span> in each of the three regions. Along the way, we will also prove that <span class="math">P_{t}/P_{0}</span> is lower bounded by one, for all <span class="math">t</span>, <span class="math">0\\leq t\\leq k</span>. We first focus on <span class="math">t\\leq a_{1}=k/2</span>. Then,</p>

    <p class="text-gray-300"><span class="math">\\frac{P_{t}}{P_{0}}</span> <span class="math">=\\left(\\frac{(a_{3}-t)!(a_{3}+t)!}{a_{3}!a_{3}!}\\right)^{4}<em>\\left(\\frac{(a_{1}-t)!(a_{1}+t)!}{a_{1}!a_{1}!}\\right)^{-1}</em>\\left(\\frac{(a_{2}-t)!(a_{2}+t)!}{a_{2}!a_{2}!}\\right)^{-1}</span> <span class="math">=\\left(\\frac{(a_{3}-t)!(a_{3}+t)!}{a_{3}!a_{3}!}\\right)^{4}<em>\\frac{a_{1}!a_{1}!}{(a_{1}-t)!(a_{1}+t)!}</em>\\frac{a_{2}!a_{2}!}{(a_{2}-t)!(a_{2}+t)!},</span></p>

    <p class="text-gray-300">To upper bound this quantity, we will use Robbins inequalities <em>[22]</em>, which are explicit bound versions of Sterling’s approximation of the factorial function.</p>

    <p class="text-gray-300"><span class="math">\\sqrt{2\\pi}~{}n^{n+\\frac{1}{2}}e^{-n}e^{\\frac{1}{12n+1}}&lt;n!&lt;\\sqrt{2\\pi}~{}n^{n+\\frac{1}{2}}e^{-n}e^{\\frac{1}{12n}}.</span> (18)</p>

    <p class="text-gray-300">Using the fact that <span class="math">t\\leq k/2</span>, we get</p>

    <p class="text-gray-300"><span class="math">\\frac{P_{t}}{P_{0}}\\leq e^{\\frac{12}{12\\cdot 1}}<em>\\left(\\frac{((k+t)(k-t))^{4}}{k^{8}}</em>\\frac{a_{1}^{2}}{(a_{1}-t)(a_{1}+t)}<em>\\frac{a_{2}^{2}}{(a_{2}-t)(a_{2}+t)}\\right)^{1/2}</em></span> (19) <span class="math">\\left(\\frac{((k-t)^{k-t}(k+t)^{k+t})^{4}}{(a_{1}-t)^{a_{1}-t}(a_{1}+t)^{a_{1}+t}<em>(a_{2}-t)^{a_{2}-t}(a_{2}+t)^{a_{2}+t}}\\right)</em>\\left(\\frac{k^{8k}}{a_{1}^{2a_{1}}*a_{2}^{2a_{2}}}\\right)^{-1}</span> (20)</p>

    <p class="text-gray-300">Writing the second factor in (19) as <span class="math">C_{t}</span> and the quantity (20) as <span class="math">Q_{t}</span>, the above inequality can be written as</p>

    <p class="text-gray-300"><span class="math">\\frac{P_{t}}{P_{0}}\\leq C_{t}*Q_{t}</span> (21)</p>

    <p class="text-gray-300">The same inequalities (18) also yield</p>

    <div class="my-4 text-center"><span class="math-block">\\frac {P _ {t}}{P _ {0}} \\geq e ^ {\\frac {1 2}{1 2 \\cdot 1 + 1}} * C _ {t} * Q _ {t} \\tag {22}</span></div>

    <p class="text-gray-300">For <span class="math">t = a_1 = k / 2</span> In section C.1, we show that <span class="math">1 \\leq C_t \\leq 0.34\\sqrt{k}</span>. As for <span class="math">Q_t</span>, we have</p>

    <div class="my-4 text-center"><span class="math-block">\\begin{array}{l} Q _ {t} = \\left(\\frac {((k - t) ^ {k - t} (k + t) ^ {k + t}) ^ {4} * (a _ {1}) ^ {2 a _ {1}} (a _ {2}) ^ {2 a _ {2}}}{(a _ {1} - t) ^ {a _ {1} - t} (a _ {1} + t) ^ {a _ {1} + t} * (a _ {2} - t) ^ {a _ {2} - t} (a _ {2} + t) ^ {a _ {2} + t} * k ^ {8 k}}\\right) \\\\ = \\left(\\frac {((1 - \\tau) ^ {k - t} (1 + \\tau) ^ {k + t}) ^ {4}}{(\\alpha_ {1} - \\tau) ^ {a _ {1} - t} (\\alpha_ {1} + \\tau) ^ {a _ {1} + t} * (\\alpha_ {2} - \\tau) ^ {a _ {2} - t} (\\alpha_ {2} + \\tau) ^ {a _ {2} + t}} * (\\alpha_ {1}) ^ {2 a _ {1}} * (\\alpha_ {2}) ^ {2 a _ {2}}\\right) \\\\ = \\left(\\frac {\\left((1 - \\tau^ {2}) \\left(\\frac {1 + \\tau}{1 - \\tau}\\right) ^ {\\tau}\\right) ^ {4}}{\\left(\\alpha_ {1} ^ {2} - \\tau^ {2}\\right) ^ {\\alpha_ {1}} \\left(\\frac {\\alpha_ {1} + \\tau}{\\alpha_ {1} - \\tau}\\right) ^ {\\tau} * \\left(\\alpha_ {2} ^ {2} - \\tau^ {2}\\right) ^ {\\alpha_ {2}} \\left(\\frac {\\alpha_ {2} + \\tau}{\\alpha_ {2} - \\tau}\\right) ^ {\\tau}} * \\left(\\alpha_ {1}\\right) ^ {2 \\alpha_ {1}} * \\left(\\alpha_ {2}\\right) ^ {2 \\alpha_ {2}}\\right) ^ {k}, \\tag {23} \\\\ \\end{array}</span></div>

    <p class="text-gray-300">where <span class="math">\\alpha_{1} = a_{1} / k = 1 / 2</span> and <span class="math">\\alpha_{2} = a_{2} / k = 11 / 12</span>. In order to find the value of <span class="math">\\tau</span>, <span class="math">0 &amp;lt; \\tau \\leq 1 / 2</span>, where the above quantity is maximized, we take the derivative of the logarithm of the above quantity (23) w.r.t. <span class="math">\\tau</span>, using the fact that</p>

    <div class="my-4 text-center"><span class="math-block">\\frac {d}{d t} \\left(a * \\log (a ^ {2} - t ^ {2}) + t * \\log \\left(\\frac {a + t}{a - t}\\right)\\right) = \\log \\left(\\frac {a + t}{a - t}\\right).</span></div>

    <p class="text-gray-300">The required derivative (w.r.t. <span class="math">\\tau</span>) is then</p>

    <div class="my-4 text-center"><span class="math-block">k * \\left(4 * \\log \\left(\\frac {1 + \\tau}{1 - \\tau}\\right) - \\log \\left(\\frac {\\alpha_ {1} + \\tau}{\\alpha_ {1} - \\tau}\\right) - \\log \\left(\\frac {\\alpha_ {2} + \\tau}{\\alpha_ {2} - \\tau}\\right)\\right)</span></div>

    <p class="text-gray-300">Thus, the derivative is zero at roots of</p>

    <div class="my-4 text-center"><span class="math-block">\\begin{array}{l} (1 + \\tau) ^ {4} (\\alpha_ {1} - \\tau) (\\alpha_ {2} - \\tau) - (1 - \\tau) ^ {4} (\\alpha_ {1} + \\tau) (\\alpha_ {2} + \\tau) \\\\ = \\tau * (1 2 4 * \\tau^ {4} - 1 2 8 * \\tau^ {2} + 2 0) \\\\ \\end{array}</span></div>

    <p class="text-gray-300">Thus, the roots are <span class="math">0</span>, <span class="math">\\pm \\sqrt{(16 \\pm 10\\sqrt{1.01}) / 31}</span>. Other than zero, the only root in the region <span class="math">[0,1/2]</span> is <span class="math">\\sqrt{(16 - 10\\sqrt{1.01}) / 31}</span> which is approximately 0.438109. It is not difficult to check that this value of <span class="math">\\tau</span> makes a local maxima of (23). Using this value of <span class="math">\\tau</span> in (23), we get that for <span class="math">t \\leq k/2</span>,</p>

    <div class="my-4 text-center"><span class="math-block">Q _ {t} &amp;lt;   (1. 1 2 2 1) ^ {k}</span></div>

    <p class="text-gray-300">Since, the above had a single maxima at <span class="math">\\tau</span> is <span class="math">0.438109</span>, one can also calculate this expression at <span class="math">\\tau=1/2</span>. In that case, the expression has declined to <span class="math">(1.067)^{k}</span>. Thus, <span class="math">Q_{t}</span> is lower bounded in this region by <span class="math">1</span> (i.e. its value at <span class="math">t=0</span>).</p>

    <p class="text-gray-300">Hence, for <span class="math">t&gt;0</span>,</p>

    <p class="text-gray-300"><span class="math">1\\leq P_{t}/P_{0}\\leq e<em>0.34\\sqrt{k}</em>(1.1221)^{k}</span></p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Thus, for all $</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\ell</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\leq k/2<span class="math"> and all </span></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">t</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\leq k/2$, we have</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300"><span class="math">P_{t}/P_{\\ell}&lt;0.34<em>\\sqrt{k}</em>e*(1.1221)^{k}</span></p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">In the region $a_{1}\\leq</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">t</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\leq a_{2}$, we have</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300"><span class="math">\\frac{P_{t}}{P_{0}}\\leq e<em>\\left(\\frac{((k+t)(k-t))^{4}}{k^{8}}</em>\\frac{a_{1}^{2}(t-a_{1})}{(a_{1}+t)}<em>\\frac{a_{2}^{2}}{(a_{2}-t)(a_{2}+t)}\\right)^{1/2}</em></span> (24) <span class="math">\\left(\\frac{((k-t)^{k-t}(k+t)^{k+t})^{4}}{(t-a_{1})^{a_{1}-t}(a_{1}+t)^{a_{1}+t}<em>(a_{2}-t)^{a_{2}-t}(a_{2}+t)^{a_{2}+t}}\\right)</em>\\left(\\frac{k^{8k}}{a_{1}^{2a_{1}}*a_{2}^{2a_{2}}}\\right)^{-1}</span> (25)</p>

    <p class="text-gray-300">Writing the second factor in (24) as <span class="math">C_{t}^{(1)}</span> and the quantity in (25) as <span class="math">Q_{t}^{(1)}</span>, we can write the above as (in the region <span class="math">a_{1}\\leq t\\leq a_{2}</span>)</p>

    <p class="text-gray-300"><span class="math">C_{t}^{(1)}<em>Q_{t}^{(1)}\\leq\\frac{P_{t}}{P_{0}}\\leq e</em>C_{t}^{(1)}*Q_{t}^{(1)}</span> (26)</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Using the same techniques as above, one can show that in the region $a_{1}\\leq</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">t</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\leq a_{2}<span class="math">, the above expression (23) (but, with </span>(1/2-\\tau)<span class="math"> now replaced by </span>(\\tau-1/2)<span class="math">) has a (single) local minima at </span>\\tau=0.5335<span class="math"> (where the value is </span>(1.0285)^{k}<span class="math">, which is more than </span>Q_{0}\\,(=\\,1)<span class="math">), and attains its maximum value at </span></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">t</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">=(0.916644)<em>k<span class="math"> of </span>(3.81)^{k}<span class="math"> . Moreover, at </span>\\tau=8/12<span class="math">, its value is </span>1.256<span class="math">. As for </span>C_{t}^{(1)}<span class="math">, we show in Section C.1 that for </span>a_{1}\\leq t\\leq 8/12<span class="math">, </span>0.26</em>\\sqrt{k}\\leq C_{t}^{(1)}\\leq 0.036<em>\\sqrt{k^{3}}<span class="math">, and for </span>8/12\\leq t\\leq 11/12<span class="math">, </span>0.011</em>k\\leq C_{t}^{(1)}\\leq 0.036*\\sqrt{k^{3}}$.</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">Thus, in this region (<span class="math">a_{1}\\leq t\\leq a_{2}</span>), the upper bound is given by</p>

    <p class="text-gray-300"><span class="math">P_{t}/P_{0}\\leq e<em>0.036\\sqrt{k^{3}}</em>3.81^{k}.</span></p>

    <p class="text-gray-300">As for the lower bound, we have for <span class="math">a_{1}\\leq t\\leq 8/12</span>,</p>

    <p class="text-gray-300"><span class="math">0.26<em>\\sqrt{k}</em>1.0285^{k}\\leq P_{t}/P_{0},</span></p>

    <p class="text-gray-300">and for <span class="math">8/12\\leq t\\leq 11/12</span>,</p>

    <p class="text-gray-300"><span class="math">0.011<em>k</em>1.256^{k}\\leq P_{t}/P_{0}.</span></p>

    <p class="text-gray-300">Now, for <span class="math">k \\geq 12</span>, both these lower bounds are more than 1, and hence in this entire region <span class="math">P_t / P_0 &amp;gt; 1</span>.</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Thus, for all $</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\ell</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\leq 11/12 * k<span class="math"> and all </span></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">t</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\leq k/2$, we have</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <div class="my-4 text-center"><span class="math-block">P_t / P_\\ell &amp;lt; e * 0.34 * \\sqrt{k} * (1.1221)^k \\leq 0.924 * \\sqrt{k} * (1.1221)^k,</span></div>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">and, for all $</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\ell</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\leq 11/12 * k<span class="math"> and all </span></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">t</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\leq 11/12 * k$, we have</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <div class="my-4 text-center"><span class="math-block">P_t / P_\\ell &amp;lt; 0.098 * \\sqrt{k^3} * (3.81)^k.</span></div>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Next, in the region $a_2 \\leq</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">t</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\leq a_3$, we have</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <div class="my-4 text-center"><span class="math-block">\\begin{aligned} \\frac{P_t}{P_0} &amp;amp;\\leq e * \\left( \\frac{((k + t)(k - t))^4}{k^8} * \\frac{a_1^2(t - a_1)}{(a_1 + t)} * \\frac{a_2^2(t - a_2)}{(a_2 + t)} \\right)^{1/2} * \\\\ \\left( \\frac{((k - t)^{k - t}(k + t)^{k + t})^4}{(t - a_1)^{a_1 - t}(a_1 + t)^{a_1 + t} * (t - a_2)^{a_2 - t}(a_2 + t)^{a_2 + t}} \\right) * \\left( \\frac{k^{8k}}{a_1^{2a_1} * a_2^{2a_2}} \\right)^{-1} \\tag{27} \\end{aligned}</span></div>

    <p class="text-gray-300">Writing the second factor in (27) as <span class="math">C_t^{(2)}</span> and the quantity in (28) as <span class="math">Q_t^{(2)}</span>, we can write the above as (in the region <span class="math">a_2 \\leq t \\leq a_3</span>)</p>

    <div class="my-4 text-center"><span class="math-block">e^{\\frac{8}{12k + 1} + \\frac{4}{13}} * C_t^{(2)} * Q_t^{(2)} \\leq \\frac{P_t}{P_0} \\leq e * C_t^{(2)} * Q_t^{(2)} \\tag{29}</span></div>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Using the same techniques as above, the above expression (23) (but, now additionally <span class="math">(11/12 - \\tau)</span> replaced by <span class="math">(\\tau - 11/12)</span>) is strictly increasing, attaining its maximum value at $</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">t</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">= k<span class="math"> of </span>(9.813)^k<span class="math">. Moreover, in Section C.1 we show that in this region, </span>0.7 / \\sqrt{k} \\leq C_t^{(2)} \\leq 0.0051 <em> k^2<span class="math">. Thus, in this region </span>P_t / P_0 &gt; e^{\\frac{8}{12k + 1} + \\frac{4}{13}} </em> 0.7 / \\sqrt{k} * 3.81^k<span class="math"> which is greater than 1 (for </span>k \\geq 12$).</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Thus, for all $</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\ell</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\leq k<span class="math"> and all </span></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">t</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\leq k/2$, we have</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <div class="my-4 text-center"><span class="math-block">P_t / P_\\ell &amp;lt; 0.924 * \\sqrt{k} * (1.1221)^k,</span></div>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">and, for all $</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\ell</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\leq k<span class="math"> and all </span></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">t</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\leq 11/12 * k$, we have</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <div class="my-4 text-center"><span class="math-block">P_t / P_\\ell &amp;lt; 0.098 * \\sqrt{k^3} * (3.81)^k,</span></div>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">and, for all $</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\ell</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\leq k<span class="math"> and all </span></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">t</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\leq k$, we have</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <div class="my-4 text-center"><span class="math-block">P_t / P_\\ell &amp;lt; e * 0.0051 * k^2 * (9.813)^k \\leq 0.014 * k^2 * (9.813)^k.</span></div>

    <p class="text-gray-300">□</p>

    <p class="text-gray-300">C.1 Analysis of <span class="math">C_t</span>, <span class="math">C_t^{(1)}</span> and <span class="math">C_t^{(2)}</span></p>

    <p class="text-gray-300"><span class="math">C_t</span>: Recall, for <span class="math">0 \\leq t \\leq a_1 = k/2</span>, we defined</p>

    <div class="my-4 text-center"><span class="math-block">C_t = \\left( \\frac{((k + t)(k - t))^4}{k^8} * \\frac{a_1^2}{(a_1 - t)(a_1 + t)} * \\frac{a_2^2}{(a_2 - t)(a_2 + t)} \\right)^{1/2}</span></div>

    <p class="text-gray-300">Robbin's bounds (18) only apply for <span class="math">n \\geq 1</span>, and for <span class="math">n = 0</span>, we have <span class="math">n! = 1</span>. Thus, <span class="math">C_t</span> is more correctly defined as follows⁵.</p>

    <div class="my-4 text-center"><span class="math-block">C_t = \\left( \\frac{((k + t)(k - t))^4}{k^8} * \\frac{a_1^2}{\\mu(a_1 - t) * (a_1 + t)} * \\frac{a_2^2}{(a_2 - t)(a_2 + t)} \\right)^{1/2}</span></div>

    <p class="text-gray-300">where <span class="math">\\mu(x) = x</span> for <span class="math">x \\geq 1</span>, and <span class="math">\\mu(x) = 1</span> for <span class="math">x &amp;lt; 1</span>. Now, at the boundaries we have <span class="math">C_0 = 1</span> and <span class="math">C_{a_1} = C_{k/2} = ((3/4)^4 <em> (1/4)k </em> 1 / (1 - (6/11)^2))^{1/2} = 0.34 <em> \\sqrt{k}</span>. For the intermediate region, one can calculate that the roots of the derivative of <span class="math">C_t</span> lie outside this intermediate region. Thus, for <span class="math">k \\geq 12</span>, the minimum value of <span class="math">C_t</span> is 1 and the maximum value is <span class="math">0.34 </em> \\sqrt{k}</span>.</p>

    <p class="text-gray-300"><span class="math">C_t^{(1)}</span>: We have, for <span class="math">t</span> such that <span class="math">k/2 = a_1 \\leq t \\leq a_2 = 11/12 * k</span>,</p>

    <div class="my-4 text-center"><span class="math-block">C_t^{(1)} = \\left( \\frac{((k + t)(k - t))^4}{k^8} * \\frac{a_1^2 * \\mu(t - a_1)}{(a_1 + t)} * \\frac{a_2^2}{\\mu(a_2 - t) * (a_2 + t)} \\right)^{1/2}.</span></div>

    <p class="text-gray-300">Again, at the boundaries we have, <span class="math">C_{k/2}^{(1)} = 0.34 * \\sqrt{k}</span>, and</p>

    <div class="my-4 text-center"><span class="math-block">\\begin{array}{l} C_{11/12*k}^{(1)} = \\left( (1 - (11/12)^2)^4 * (1/4) * \\frac{11/12 - 1/2}{11/12 + 1/2} * \\frac{k^3}{k} * \\frac{(11/12)^2 * k}{11/12 + 11/12} \\right)^{1/2} \\\\ = 0.005 * k^{3/2} \\end{array}</span></div>

    <p class="text-gray-300">In the intermediate region, instead of computing the roots of the derivative of <span class="math">C_t^{(1)}</span>, we compute the extremum of both the numerator and the denominator to bound <span class="math">C_t^{(1)}</span>. The derivative of the numerator has a root at <span class="math">t = 0.623 * k</span>, whereas the derivative of the denominator has no root in the region. At <span class="math">t = 0.623k</span>, the numerator is <span class="math">(0.00357k^{13})^{1/2}</span>, which is a local maxima. For <span class="math">k \\geq 12</span>, the denominator has minimum value at <span class="math">t = a_2</span>,</p>

    <p class="text-gray-300">⁵ No such correction is required in the definition of <span class="math">Q_t</span>, as it is well known that limit of <span class="math">n^n</span>, as <span class="math">n</span> tends to 0, is one.</p>

    <p class="text-gray-300">which is <span class="math">((a_{2}+1/2)<em>(a_{2}+a_{2})k^{10})^{1/2}</span>. Thus, <span class="math">C_{t}^{(1)}</span> is upper bounded in the intermediate region by <span class="math">0.036</em>k^{3/2}</span>. Note that for <span class="math">k\\geq 12</span>, <span class="math">0.036<em>k&gt;0.34</span>. Thus, the maximum value in the whole region is upper bounded by <span class="math">0.036</em>k^{3/2}</span>.</p>

    <p class="text-gray-300">The minimum value is lower bounded by splitting the region into two parts: (a) from <span class="math">a_{1}</span> to <span class="math">10/12<em>k</span>, and (b) from <span class="math">8/12</em>k</span> to <span class="math">a_{2}</span>. In each region, the minimum is lower bounded by taking the ratio of the minimum of the numerator and the maximum of the denominator. Note, that the numerator has a single local extremum (maxima) at <span class="math">0.623*k</span>, and hence the minimum of the numerator in both regions is at the boundaries.</p>

    <ul class="list-disc list-inside space-y-1 text-gray-300 my-2 ml-4">

      <li>At <span class="math">t=11/12<em>k</span>, the numerator is <span class="math">(5.7</em>10^{-5}*k^{13})^{1/2}</span>.</li>

      <li>At <span class="math">t=8/12<em>k</span>, the numerator is <span class="math">(0.0033</em>k^{13})^{1/2}</span>. Thus, the minimum of the numerator in region (b) is at <span class="math">t=11/12*k</span>.</li>

      <li>At <span class="math">t=k/2</span>, the numerator is <span class="math">((0.0665/k)<em>k^{13})^{1/2}</span>. Since, for <span class="math">k\\geq 12</span>, <span class="math">0.0033</em>k=0.04</span>, in region (a) the numerator is lower bounded by <span class="math">((0.04/k)*k^{13})^{1/2}</span></li>

    </ul>

    <p class="text-gray-300">Again, since the denominator’s derivative has no zeroes in the entire region, it is a strictly decreasing function for <span class="math">k\\geq 12</span>. At <span class="math">t=8/12<em>k</span>, the denominator is <span class="math">(0.462</em>k^{11})^{1/2}</span>. At <span class="math">t=k/2</span>, the denominator is <span class="math">(0.59*k^{11})^{1/2}</span>.</p>

    <p class="text-gray-300">Thus, the minimum is lower bounded in region (a) by <span class="math">0.26<em>\\sqrt{k}</span>. And the minimum is lower bounded in region (b) by <span class="math">0.011</em>k</span>.</p>

    <p class="text-gray-300">To summarize, for <span class="math">a_{1}\\leq t\\leq 8/12</span>,</p>

    <p class="text-gray-300"><span class="math">0.011<em>k\\leq C_{t}^{(1)}\\leq 0.036</em>\\sqrt{k^{3}},</span></p>

    <p class="text-gray-300">and for <span class="math">8/12\\leq t\\leq a_{2}</span>,</p>

    <p class="text-gray-300"><span class="math">0.26<em>\\sqrt{k}\\leq C_{t}^{(1)}\\leq 0.036</em>\\sqrt{k^{3}}.</span></p>

    <p class="text-gray-300"><span class="math">C_{t}^{(2)}</span>: We have, for <span class="math">t</span> such that <span class="math">11/12*k=a_{2}\\leq t\\leq a_{3}=k</span>,</p>

    <p class="text-gray-300"><span class="math">C_{t}^{(2)}=\\left(\\frac{((k+t)\\mu(k-t))^{4}}{k^{8}}<em>\\frac{a_{1}^{2}</em>\\mu(t-a_{1})}{(a_{1}+t)}<em>\\frac{a_{2}^{2}</em>\\mu(t-a_{2})}{(a_{2}+t)}\\right)^{1/2}.</span></p>

    <p class="text-gray-300">Again, at the boundaries we have, <span class="math">C_{11/12<em>k}^{(2)}=\\ 0.005</em>k^{3/2}</span>, and <span class="math">C_{k}^{(2)}=((2k)^{4}/k^{8}<em>k^{2}/12</em>(11/12)^{2}k^{2}*(1/23))^{1/2}=0.221</span>.</p>

    <p class="text-gray-300">Since, <span class="math">k\\geq 12</span>, the numerator is upper bounded in the region by <span class="math">((2k)^{4}<em>(k/12)^{4}</em>k^{3}/8<em>(11/12)^{2}k^{2}</em>(k/12))^{1/2}</span>. The denominator is lower bounded by <span class="math">(k^{8}<em>(17/12)</em>k<em>k^{3}/8</em>(1/23))^{1/2}=0.005*k^{3/2}</span>.</p>

    <p class="text-gray-300"><span class="math">(22/12)<em>k)^{1/2}</span>. Thus, <span class="math">C_t^{(2)}</span> is upper bounded by <span class="math">.0051</em>k^2</span>. Similarly, it is lower bounded by <span class="math">(((1+11/12)k)^4<em>k^3/8</em>(11/12)^2<em>k^2)^{1/2}</span> divided by <span class="math">(k^8</em>(3/2)<em>k</em>(23/12<em>k))^{1/2}</span>, which is <span class="math">0.7</em>k^{-1/2}</span>. Since, this is less than 0.221 for <span class="math">k \\geq 12</span>, we have, for <span class="math">a_2 \\leq t \\leq a_3</span>,</p>

    <div class="my-4 text-center"><span class="math-block">0.7/\\sqrt{k} \\leq C_t^{(2)} \\leq .0051*k^2</span></div>

    <h2 id="sec-34" class="text-2xl font-bold">C.2 Alternate Computer Assisted Proof for <span class="math">k = 12</span></h2>

    <p class="text-gray-300">When <span class="math">k</span> is fixed, for example <span class="math">k = 12</span>, we can compute all possible <span class="math">12*25</span> possibilities in (15). The computer-assisted proof leads to the following upper bound.</p>

    <p class="text-gray-300">For <span class="math">N &amp;gt; k</span>, and <span class="math">k = 12</span>, for every <span class="math">t \\in [-k..k]</span> and <span class="math">\\mathbf{x}</span> in the <span class="math">t</span>-th interval,</p>

    <div class="my-4 text-center"><span class="math-block"></span></div>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\left</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\sum_{\\substack{\\ell \\in \\mathcal{L}\\\\ \\ell \\neq t}}(\\mathbf{x} - \\ell N)*\\prod_{\\substack{\\ell^{\\prime}\\in \\mathcal{L}\\\\ \\ell^{\\prime}\\neq \\ell}}\\left(\\frac{\\mathbf{x} - \\ell^{\\prime}N}{\\ell N - \\ell^{\\prime}N}\\right)^{2 + p(\\ell^{\\prime})} \\right</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\leq</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <div class="my-4 text-center"><span class="math-block"></span></div>

    <div class="my-4 text-center"><span class="math-block">N^{-1}*\\frac{1}{2}*\\ln (e*k)*1.622*\\max \\left\\{1,\\frac{4.5*10^5}{N},\\frac{1.68*10^9}{N^2}\\right\\}</span></div>

    <h2 id="sec-35" class="text-2xl font-bold">D Proof of General Case Theorem</h2>

    <p class="text-gray-300"><strong>Proof:</strong> (of Theorem 9)</p>

    <p class="text-gray-300">In this section we prove the counterpart of Lemma 4 for the general case. In the next subsection we prove the counterpart of Lemma 5 for the general case.</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Let's analyze the <span class="math">\\ell</span>-th summand in <span class="math">g_{b,c,d}(\\mathbf{x})</span> defined in (8), assuming $</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\mathbf{x} - \\ell N</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\leq 1/2<span class="math"> (and noting </span>z \\in S_{\\ell}<span class="math"> implies </span></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\mathbf{x} - z</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\leq 1<span class="math">, and writing </span>\\mathbf{x}'<span class="math"> for </span>(\\mathbf{x} - \\ell N)<span class="math"> and </span>z'<span class="math"> for </span>(z - \\ell N)$)</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <div class="my-4 text-center"><span class="math-block">\\sum_{z \\in S_{\\ell}} f_N(z) * \\left(\\prod_{w \\in S_{\\ell} \\setminus \\{z\\}} \\frac{\\mathbf{x} - w}{z - w}\\right) * \\prod_{\\substack{\\ell&#x27; \\in \\mathcal{L} \\\\ \\ell&#x27; \\neq \\ell}} \\left(1 + \\frac{\\mathbf{x}&#x27; - z&#x27;}{z&#x27; + (\\ell - \\ell&#x27;)N}\\right)^{d + c + b * p \\ell&#x27;} \\tag{30}</span></div>

    <p class="text-gray-300">Focusing on the second product we have</p>

    <div class="my-4 text-center"><span class="math-block">\\prod_{\\substack{\\ell^{\\prime}\\in \\mathcal{L}\\\\ \\ell^{\\prime}\\neq \\ell}}\\left(1 + \\frac{\\mathbf{x}^{\\prime} - z^{\\prime}}{z^{\\prime} + (\\ell - \\ell^{\\prime})N}\\right)^{d + c + b*p\\ell^{\\prime})}</span></div>

    <div class="my-4 text-center"><span class="math-block">\\prod_{\\substack{\\ell^{\\prime}\\in \\mathcal{L}\\\\ \\ell^{\\prime}\\neq \\ell}}\\left(1 + \\frac{z^{\\prime} - \\mathbf{x}^{\\prime}}{(\\ell^{\\prime} - \\ell)N(1 - z^{\\prime} / ((\\ell - \\ell^{\\prime})N)}\\right)^{d + c + b*p\\ell^{\\prime})}</span></div>

    <div class="my-4 text-center"><span class="math-block">\\prod_ {\\substack {\\ell^ {\\prime} \\in \\mathcal {L} \\\\ \\ell^ {\\prime} \\neq \\ell}} \\left(1 + \\frac {\\left(z ^ {\\prime} - \\mathbf {x} ^ {\\prime}\\right)}{\\left(\\ell^ {\\prime} - \\ell\\right) N} * \\left(1 - z ^ {\\prime} / \\left(\\left(\\ell - \\ell^ {\\prime}\\right) N\\right)\\right) ^ {- 1}\\right) ^ {d + c + b * p \\ell^ {\\prime})} \\tag{31}</span></div>

    <p class="text-gray-300">Since <span class="math">f_{N}(z) = 0</span>, for <span class="math">z&#x27; = z - \\ell N = 0</span>, we can exclude such <span class="math">z</span> from the sum in (30), and then the power series expansion of <span class="math">(1 - z&#x27; / ((\\ell - \\ell&#x27;)N))^{-1}</span> is convergent. So, suppose the above (31) is</p>

    <div class="my-4 text-center"><span class="math-block">1 + \\sum_{i &amp;gt; 0} \\sum_{j \\geq 0} a_{i,j} (z ^ {\\prime} - \\mathbf {x} ^ {\\prime}) ^ {i} * (z ^ {\\prime}) ^ {j} * N ^ {- i - j}</span></div>

    <p class="text-gray-300">Then, (30) can be written as</p>

    <div class="my-4 text-center"><span class="math-block">\\begin{aligned} &amp;amp; \\sum_{z \\in S_{\\ell}} f_{N}(z) * \\left(\\prod_{w \\in S_{\\ell} \\setminus \\{z\\}} \\frac{\\mathbf{x} - w}{z - w}\\right) * \\left(1 + \\sum_{i &amp;gt; 0} \\sum_{j \\geq 0} a_{i,j} (z^{\\prime} - \\mathbf{x}^{\\prime})^{i} * (z^{\\prime})^{j} * N^{-i - j}\\right) \\\\ &amp;amp; = \\sum_{z \\in S_{\\ell}} f_{N}(z) * \\left(\\prod_{w \\in S_{\\ell} \\setminus \\{z\\}} \\frac{\\mathbf{x} - w}{z - w}\\right) * \\left(1 + \\sum_{i &amp;gt; 0} \\sum_{j \\geq 0, i + j \\geq d} a_{i,j} (z^{\\prime} - \\mathbf{x}^{\\prime})^{i} * (z^{\\prime})^{j} * N^{-i - j}\\right) \\\\ &amp;amp; = (\\mathbf{x} - \\ell N) + \\sum_{z \\in S_{\\ell}} f_{N}(z) * \\left(\\prod_{w \\in S_{\\ell} \\setminus \\{z\\}} \\frac{\\mathbf{x} - w}{z - w}\\right) * \\sum_{i &amp;gt; 0} \\sum_{j \\geq 0, i + j \\geq d} a_{i,j} (z^{\\prime} - \\mathbf{x}^{\\prime})^{i} * (z^{\\prime})^{j} * N^{-i - j}, \\end{aligned}</span></div>

    <p class="text-gray-300">where the first equality follows from Lemma 2, and the second by Lagrange interpolation over</p>

    <p class="text-gray-300">46</p>

    <p class="text-gray-300"><span class="math">S_{\\ell}</span>. Now, consider the following alternate expression (instead of (31))</p>

    <div class="my-4 text-center"><span class="math-block">\\begin{array}{l} \\prod_{\\substack{\\ell^{\\prime}\\in \\mathcal{L}\\\\ \\ell^{\\prime}\\neq \\ell}}\\left(1 + \\frac{z^{\\prime} - \\mathbf{x}^{\\prime}}{N}*(1 - z^{\\prime} / N)^{-1}\\right)^{d + c + b*p\\ell^{\\prime})} \\\\ = \\left(1 + \\frac{z^{\\prime} - \\mathbf{x}^{\\prime}}{N} * (1 - z^{\\prime} / N)^{-1}\\right)^{(d + c)*2k + b*\\sum_{\\ell^{\\prime}\\neq\\ell}p(\\ell^{\\prime})} \\\\ = 1 + \\sum_{i &amp;gt; 0}\\sum_{j\\geq 0}b_{i,j}(z^{\\prime} - \\mathbf{x}^{\\prime})^{i}*(z^{\\prime})^{j}*N^{-i - j} \\end{array}</span></div>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">for some <span class="math">b_{i,j}</span>. Since $</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">(\\ell - \\ell')</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\geq 1<span class="math">, it follows that for all </span>i, j<span class="math">, </span></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">b_{i,j}</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\geq</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">a_{i,j}</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"><span class="math">. Then (30) differs from </span>(\\mathbf{x} - \\ell N)$ in absolute value by at most</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">$$ \\begin{array}{l}</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\sum_{z \\in S_{\\ell}}</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">f_{N}(z)</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">* \\left</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\prod_{w \\in S_{\\ell} \\setminus \\{z\\}} \\frac{\\mathbf{x} - w}{z - w} \\right</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">* \\sum_{i &gt; 0} \\sum_{j \\geq 0, i + j \\geq d}</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">a_{i,j}</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">*</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">z^{\\prime} - \\mathbf{x}^{\\prime}</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">^{i} *</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">z^{\\prime}</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">^{j} * N^{-i - j} \\\\</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">\\end{array} $$</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Now, $</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">b_{i,j}</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"><span class="math"> is itself upper bounded by (let </span>\\mathfrak{m} = (d + c)<em>2k + b</em>\\pmb{\\nu} \\geq d$)</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <div class="my-4 text-center"><span class="math-block">\\binom{\\mathfrak{m}}{i} \\binom{i - 1 + j}{j}</span></div>

    <p class="text-gray-300">Thus, we have the following inequalities</p>

    <p class="text-gray-300">$$ \\begin{array}{l}</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\sum_{i &gt; 0} \\sum_{j \\geq 0, i + j \\geq d}</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">b_{i,j}</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">*</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">z' - \\mathbf{x}'</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">^i *</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">z'</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">^j * N^{-i-j} \\\\</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">\\leq \\sum_{\\mathbf{m} \\geq i &gt; 0} \\sum_{j \\geq 0, i + j \\geq d} \\binom{\\mathbf{m}}{i} \\binom{i - 1 + j}{j} <em> 2^{-j} </em> N^{-i-j} \\\\ = \\sum_{j \\geq 0} \\sum_{\\mathbf{m} \\geq i &gt; 0, i + j \\geq d} \\binom{\\mathbf{m}}{i} \\binom{i - 1 + j}{j} <em> 2^{-j} </em> N^{-i-j} \\\\ = \\sum_{j \\geq 0} \\sum_{\\mathbf{m} + j \\geq i + j &gt; j, i + j \\geq d} \\binom{\\mathbf{m}}{i} \\binom{i - 1 + j}{j} <em> 2^{-j} </em> N^{-i-j} \\\\ = \\sum_{j \\geq 0} \\sum_{\\mathbf{m} + j \\geq i &gt; j, i \\geq d} \\binom{\\mathbf{m}}{i - j} \\binom{i - 1}{j} <em> 2^{-j} </em> N^{-i} \\\\ = \\sum_{i \\geq d} N^{-i} <em> \\sum_{\\mathbf{m} + j \\geq i &gt; j \\geq 0} \\binom{\\mathbf{m}}{i - j} \\binom{i - 1}{j} </em> 2^{-j} \\\\ \\leq \\sum_{i \\geq d} N^{-i} <em> \\sum_{\\mathbf{m} + j \\geq i &gt; j \\geq 0} \\frac{(\\mathbf{m})^{i - j}}{(i - j)!} \\binom{i}{j} </em> 2^{-j} \\\\ \\leq \\sum_{i \\geq d} N^{-i} <em> \\sum_{i \\geq j \\geq 0} \\frac{(\\mathbf{m})^{i - j}}{(i - j)!} </em> 2^{i - j} \\\\ \\leq \\sum_{i \\geq d} N^{-i} <em> \\sum_{i \\geq j \\geq 0} \\frac{j!}{i!} </em> \\binom{i}{j} <em> (2\\mathbf{m})^{i - j} \\\\ \\leq \\sum_{i \\geq d} N^{-i} </em> \\sum_{i \\geq j \\geq 0} \\binom{i}{j} <em> \\binom{e}{i}^{i-j} </em> (2\\mathbf{m})^{i-j} \\\\ \\leq \\sum_{i \\geq d} N^{-i} <em> \\left(1 + \\frac{2 e \\mathbf{m}}{i}\\right)^i \\leq \\sum_{i \\geq d} N^{-i} </em> \\left(1 + \\frac{2 e \\mathbf{m}}{d}\\right)^i \\\\ \\leq N^{-d} <em> \\left(1 + \\frac{2 e \\mathbf{m}}{d}\\right)^d \\sum_{i \\geq 0} N^{-i} </em> \\left(1 + \\frac{2 e \\mathbf{m}}{d}\\right)^i \\\\ \\leq 2 <em> N^{-d} </em> \\left(1 + \\frac{2 e \\mathbf{m}}{d}\\right)^d \\\\ \\end{array} $$</p>

    <p class="text-gray-300">Thus, using (32), and the upper bound on Lagrange basis polynomials (see Section A), we</p>

    <p class="text-gray-300">48</p>

    <p class="text-gray-300">have that (30) differs from <span class="math">(\\mathbf{x} - \\ell N)</span> in absolute value by at most</p>

    <div class="my-4 text-center"><span class="math-block">(d + 1) * 2 ^ {d} * N ^ {- d} * \\left(1 + \\frac {2 e \\mathfrak {m}}{d}\\right) ^ {d}, \\tag {33}</span></div>

    <p class="text-gray-300">where <span class="math">\\mathfrak{m} = (d + c)<em>2k + b</em>\\pmb{\\nu}</span>. This proves the counterpart of Lemma 4 for the general case.</p>

    <h2 id="sec-36" class="text-2xl font-bold">D.1 General Upper Bound on <span class="math">\\mathbf{x}</span> in another interval</h2>

    <p class="text-gray-300">In this subsection we prove the counterpart of Lemma 5 for the general case. For this part of the prove, we will assume that <span class="math">d + c = 2b</span>, as that makes the proof simpler.</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Let <span class="math">\\mathbf{x}</span> be in the <span class="math">t</span>-th interval, $</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\mathbf{x} - t*N</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">&lt; 1/2<span class="math">, and let </span>\\ell \\neq t<span class="math">, for </span>t,\\ell \\in \\mathcal{L}$. Let</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <div class="my-4 text-center"><span class="math-block">R_{\\ell}(\\mathbf{x})\\triangleq \\prod_{\\substack{\\ell^{\\prime}\\in \\mathcal{L}\\\\ \\ell^{\\prime}\\neq \\ell}}\\left(\\frac{\\mathbf{x} - \\ell^{\\prime}N}{(\\ell - \\ell^{\\prime})N}\\right)^{d + c + b*p(\\ell^{\\prime})},</span></div>

    <p class="text-gray-300">and</p>

    <div class="my-4 text-center"><span class="math-block">L _ {\\ell , z} (\\mathbf {x}) \\triangleq f _ {N} (z) * \\prod_ {w \\in S _ {\\ell} \\backslash \\{z \\}} \\frac {\\mathbf {x} - w}{z - w}.</span></div>

    <p class="text-gray-300">Then, for <span class="math">z \\in S_{\\ell}</span>, writing <span class="math">z = z&#x27; + \\ell N</span>,</p>

    <div class="my-4 text-center"><span class="math-block">\\begin{array}{l} \\sum_{z\\in S_{\\ell}}f_{N}(z)*\\prod_{w\\in S_{\\ell}\\backslash \\{z\\}}\\frac{\\mathbf{x} - w}{z - w} * \\prod_{\\substack{\\ell^{\\prime}\\in \\mathcal{L}\\\\ \\ell^{\\prime}\\neq \\ell}}\\left(\\frac{\\mathbf{x} - \\ell^{\\prime}N}{z^{\\prime} + (\\ell - \\ell^{\\prime})N}\\right)^{d + c + b*p(\\ell^{\\prime})} \\\\ = R_{\\ell}(\\mathbf{x})*\\sum_{z\\in S_{\\ell}}L_{\\ell ,z}(\\mathbf{x})*\\prod_{\\substack{\\ell^{\\prime}\\in \\mathcal{L}\\\\ \\ell^{\\prime}\\neq \\ell}}\\left(\\frac{1}{1 + z^{\\prime} / ((\\ell - \\ell^{\\prime})N)}\\right)^{d + c + b*p(\\ell^{\\prime})} \\\\ = R _ {\\ell} (\\mathbf {x}) * \\left((\\mathbf {x} - \\ell N) + \\sum_ {z \\in S _ {\\ell}} L _ {\\ell , z} (\\mathbf {x}) * \\left(- 1 + \\prod_ {\\substack {\\ell^ {\\prime} \\in \\mathcal {L} \\\\ \\ell^ {\\prime} \\neq \\ell}} \\left(\\frac {1}{1 + z ^ {\\prime} / ((\\ell - \\ell^ {\\prime}) N)}\\right) ^ {d + c + b * p (\\ell^ {\\prime})}\\right)\\right) \\tag{34} \\\\ \\end{array}</span></div>

    <p class="text-gray-300">where the last equality follows by Lagrange interpolation of <span class="math">(\\mathbf{x} - \\ell N)</span>.</p>

    <p class="text-gray-300">Now consider the second summand inside the big parenthesis:</p>

    <div class="my-4 text-center"><span class="math-block">\\sum_{z\\in S_{\\ell}}L_{\\ell ,z}(\\mathbf{x})*\\left(-1 + \\prod_{\\substack{\\ell^{\\prime}\\in \\mathcal{L}\\\\ \\ell^{\\prime}\\neq \\ell}}\\left(1 + z^{\\prime} / ((\\ell -\\ell^{\\prime})N)\\right)^{-(d + c + b*p(\\ell^{\\prime}))}\\right)</span></div>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Since <span class="math">f_{N}(\\ell N) = 0</span>, in the above sum we can exclude <span class="math">z</span> such that <span class="math">z = \\ell N</span>, i.e. <span class="math">z&#x27; = 0</span>. Moreover, $</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">z'</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">/ N &lt; 1<span class="math">, and hence the power series of the big product above is convergent. Suppose the power series of the above product is </span>1 + \\sum_{i &gt; 0} a_i * (z' / N)^i$, then the absolute value of above can be written as</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">$$ \\begin{aligned}</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\left</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\sum_{z \\in S_{\\ell}} L_{\\ell, z}(\\mathbf{x}) <em> \\sum_{i &gt; 0} a_{i} </em> (z' / N)^{i} \\right</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\\\</th>

          </tr>

        </thead>

        <tbody>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">\\leq \\sum_{d &gt; i &gt; 0}</td>

            <td class="px-3 py-2 border-b border-gray-700">a_{i}</td>

            <td class="px-3 py-2 border-b border-gray-700">*</td>

            <td class="px-3 py-2 border-b border-gray-700">\\mathbf{x} - \\ell N</td>

            <td class="px-3 py-2 border-b border-gray-700">^{i} * N^{-i} + \\sum_{z \\in S_{\\ell}}</td>

            <td class="px-3 py-2 border-b border-gray-700">L_{\\ell, z}(\\mathbf{x})</td>

            <td class="px-3 py-2 border-b border-gray-700">* \\sum_{i \\geq d}</td>

            <td class="px-3 py-2 border-b border-gray-700">a_{i}</td>

            <td class="px-3 py-2 border-b border-gray-700">*</td>

            <td class="px-3 py-2 border-b border-gray-700">z' / N</td>

            <td class="px-3 py-2 border-b border-gray-700">^{i} \\tag{35}</td>

          </tr>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">\\end{aligned} $$</p>

    <p class="text-gray-300">Now, consider an alternate expression, where <span class="math">\\mathfrak{m} = (d + c) <em> 2k + b </em> \\nu \\geq d</span>,</p>

    <div class="my-4 text-center"><span class="math-block">\\sum_{z \\in S_{\\ell}} L_{\\ell, z}(\\mathbf{x}) * \\left(-1 + \\prod_{\\substack{\\ell&#x27; \\in \\mathcal{L} \\\\ \\ell&#x27; \\neq \\ell}} \\left(1 - z&#x27; / N\\right)^{-(d + c + b * p(\\ell&#x27;))}\\right) = \\sum_{z \\in S_{\\ell}} L_{\\ell, z}(\\mathbf{x}) * \\left(-1 + \\left(1 - z&#x27; / N\\right)^{-m}\\right)</span></div>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">and let the convergent power series of the second factor above be <span class="math">\\sum_{i &amp;gt; 0} b_i * (z&#x27; / N)^i</span>. Note for every <span class="math">i</span>, <span class="math">b_i \\geq 0</span>. Indeed, <span class="math">b_i = \\binom{\\mathfrak{m} + i - 1}{\\mathfrak{m}}</span>. Also, for each <span class="math">i</span>, $b_i =</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">b_i</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\geq</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">a_i</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"><span class="math">, as </span></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\ell - \\ell'</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\geq 1$.</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">50</p>

    <p class="text-gray-300">Thus, (35) is upper bounded as follows, for <span class="math">N &amp;gt; \\frac{\\mathfrak{m} + d + 1}{(d + 1)}</span>,</p>

    <p class="text-gray-300">$$ \\begin{aligned}</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\sum_{d &gt; i &gt; 0}</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">a_i</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">*</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\mathbf{x} - \\ell N</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">^i * N^{-i} + \\sum_{z \\in S_\\ell}</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">L_{\\ell, z}(\\mathbf{x})</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">* \\sum_{i \\geq d}</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">a_i</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">*</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">z' / N</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">^i \\\\</th>

          </tr>

        </thead>

        <tbody>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">\\leq \\sum_{d &gt; i &gt; 0} b_i *</td>

            <td class="px-3 py-2 border-b border-gray-700">1 + (t - \\ell)N</td>

            <td class="px-3 py-2 border-b border-gray-700">^i <em> N^{-i} + 2^d </em></td>

            <td class="px-3 py-2 border-b border-gray-700">1 + (t - \\ell)N</td>

            <td class="px-3 py-2 border-b border-gray-700">^d <em> \\sum_{i \\geq d} b_i </em></td>

            <td class="px-3 py-2 border-b border-gray-700">z' / N</td>

            <td class="px-3 py-2 border-b border-gray-700">^i \\\\</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">\\leq \\sum_{d &gt; i &gt; 0} \\binom{\\mathfrak{m} + i - 1}{\\mathfrak{m}} *</td>

            <td class="px-3 py-2 border-b border-gray-700">N^{-1} + (t - \\ell)</td>

            <td class="px-3 py-2 border-b border-gray-700">^i + (d + 1) <em> 2^d </em></td>

            <td class="px-3 py-2 border-b border-gray-700">1 + (t - \\ell)N</td>

            <td class="px-3 py-2 border-b border-gray-700">^d <em> \\sum_{i \\geq d} N^{-i} </em> \\binom{\\mathfrak{m} + i - 1}{\\mathfrak{m}} * 2^{-i} \\\\</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">\\leq \\sum_{d &gt; i &gt; 0} \\binom{\\mathfrak{m} + i - 1}{i - 1} *</td>

            <td class="px-3 py-2 border-b border-gray-700">N^{-1} + (t - \\ell)</td>

            <td class="px-3 py-2 border-b border-gray-700">^i + (d + 1) *</td>

            <td class="px-3 py-2 border-b border-gray-700">N^{-1} + (t - \\ell)</td>

            <td class="px-3 py-2 border-b border-gray-700">^d <em> \\sum_{i \\geq 0} N^{-i} </em> \\binom{\\mathfrak{m} + d + i - 1}{\\mathfrak{m}} * 2^{-i} \\\\</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">\\leq \\binom{\\mathfrak{m} + d - 2}{d - 2} * \\sum_{d &gt; i &gt; 0}</td>

            <td class="px-3 py-2 border-b border-gray-700">N^{-1} + (t - \\ell)</td>

            <td class="px-3 py-2 border-b border-gray-700">^i \\\\</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">+ (d + 1) *</td>

            <td class="px-3 py-2 border-b border-gray-700">N^{-1} + (t - \\ell)</td>

            <td class="px-3 py-2 border-b border-gray-700">^d <em> \\sum_{i \\geq 0} (2N)^{-i} </em> \\binom{\\mathfrak{m} + d}{\\mathfrak{m}} * \\left(\\frac{\\mathfrak{m} + d + 1}{d + 1}\\right)^{i - 1} \\\\</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">\\leq \\binom{\\mathfrak{m} + d - 2}{d - 2} *</td>

            <td class="px-3 py-2 border-b border-gray-700">N^{-1} + (t - \\ell)</td>

            <td class="px-3 py-2 border-b border-gray-700">^d + (d + 1) *</td>

            <td class="px-3 py-2 border-b border-gray-700">N^{-1} + (t - \\ell)</td>

            <td class="px-3 py-2 border-b border-gray-700">^d <em> \\binom{\\mathfrak{m} + d}{\\mathfrak{m}} </em> \\frac{1}{1 - \\frac{\\mathfrak{m} + d + 1}{(d + 1)*2N}} \\\\</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">\\leq (2d + 3) *</td>

            <td class="px-3 py-2 border-b border-gray-700">N^{-1} + (t - \\ell)</td>

            <td class="px-3 py-2 border-b border-gray-700">^d * \\binom{\\mathfrak{m} + d}{\\mathfrak{m}} \\\\</td>

          </tr>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">\\leq (2d + 3) <em> (2k + 1)^d </em> \\binom{\\mathfrak{m} + d}{d} \\end{aligned} $$</p>

    <p class="text-gray-300">where we used bounds on Lagrange basis polynomials from Section A and the following inequality (which is easily proved by induction on <span class="math">i \\geq 0</span>), for <span class="math">\\mathfrak{m} \\geq s</span>,</p>

    <div class="my-4 text-center"><span class="math-block">\\binom{\\mathfrak{m} + i}{s} \\leq \\left(\\frac{\\mathfrak{m} + 1}{\\mathfrak{m} + 1 - s}\\right)^i * \\binom{\\mathfrak{m}}{s}.</span></div>

    <p class="text-gray-300">Thus, 34 is upper bounded by</p>

    <p class="text-gray-300">$$ \\begin{aligned}</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">R_{\\ell}(\\mathbf{x})</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"><em> \\left((\\mathbf{x} - \\ell N) + (2d + 3) </em> (2k + 1)^d * \\binom{\\mathfrak{m} + d}{d}\\right) \\\\</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">\\end{aligned} $$</p>

    <p class="text-gray-300">Now, <span class="math">R_{\\ell}(\\mathbf{x})</span> is same as 13 in proof of Lemma 5. So, it is bounded similarly as follows, by writing <span class="math">\\mathbf{x} = \\mathbf{x}&#x27; + tN</span>, and recalling <span class="math">t \\neq \\ell</span>,</p>

    <div class="my-4 text-center"><span class="math-block">R_{\\ell}(\\mathbf{x}) = \\prod_{\\substack{\\ell^{\\prime}\\in \\mathcal{L}\\\\ \\ell^{\\prime}\\neq \\ell}}\\left(\\frac{\\mathbf{x} - \\ell^{\\prime}N}{(\\ell - \\ell^{\\prime})N}\\right)^{d + c + b*p(\\ell^{\\prime})} = \\left(\\frac{\\mathbf{x}^{\\prime}}{(\\ell - t)N}\\right)^{d + c + b*p(t)}*\\prod_{\\substack{\\ell^{\\prime}\\in \\mathcal{L}\\\\ \\ell^{\\prime}\\neq \\ell \\\\ \\ell^{\\prime}\\neq t}}\\left(\\frac{\\mathbf{x} - \\ell^{\\prime}N}{(\\ell - \\ell^{\\prime})N}\\right)^{d + c + b*p(\\ell^{\\prime})} = \\left(\\frac{\\mathbf{x}^{\\prime}}{(\\ell - t)N}\\right)^{d + c + b*p(t)}*\\prod_{\\substack{\\ell^{\\prime}\\in \\mathcal{L}\\\\ \\ell^{\\prime}\\neq \\ell \\\\ \\ell^{\\prime}\\neq t}}\\left(\\frac{(t - \\ell^{\\prime})N}{(\\ell - \\ell^{\\prime})N}\\right)^{d + c + b*p(\\ell^{\\prime})}*\\prod_{\\substack{\\ell^{\\prime}\\in \\mathcal{L}\\\\ \\ell^{\\prime}\\neq \\ell \\\\ \\ell^{\\prime}\\neq t}}\\left(\\frac{\\mathbf{x}^{\\prime} + (t - \\ell^{\\prime})N}{(t - \\ell^{\\prime})N}\\right)^{d + c + b*p(\\ell^{\\prime})} \\tag{37}</span></div>

    <p class="text-gray-300">Now, we upper bound the third product as in Lemma 4, and the second product as in Lemma 5. Here we will assume that <span class="math">d + c = 2b</span>, as that makes the proof simpler. Starting with the third product, just as in the proof of Lemma 4 (even though one factor is missing now, namely <span class="math">\\ell&#x27; = t</span>)</p>

    <div class="my-4 text-center"><span class="math-block">\\prod_{\\substack{\\ell^{\\prime}\\in \\mathcal{L}\\\\ \\ell^{\\prime}\\neq \\ell \\\\ \\ell^{\\prime}\\neq t}}\\left(\\frac{\\mathbf{x}^{\\prime} + (t - \\ell^{\\prime})N}{(t - \\ell^{\\prime})N}\\right)^{b(2 + *p(\\ell&#x27;))}\\leq \\left(1 + \\frac{4*\\ln(ek)}{N} +\\frac{4k^{2}}{N^{2}}\\right)^{b} \\tag{38}</span></div>

    <p class="text-gray-300">For the first two products above, following proof of Lemma 5, and in particular (16), we have</p>

    <p class="text-gray-300">$$ \\left(\\frac{\\mathbf{x}^{\\prime}}{(\\ell - t)N}\\right)^{2d + d<em>p(t)}</em>\\prod_{\\substack{\\ell^{\\prime}\\in \\mathcal{L}\\\\ \\ell^{\\prime}\\neq \\ell \\\\ \\ell^{\\prime}\\neq t}}\\left(\\frac{(t - \\ell^{\\prime})N}{(\\ell - \\ell^{\\prime})N}\\right)^{2b + b*p(\\ell^{\\prime})}</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\leq (1 / 2)^{2b + b*p(t)}\\left(\\frac{1}{</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\ell - t</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">N}\\right)^{2b + b<em>p(\\ell)}</em>\\left(\\frac{P_{t}}{P_{\\ell}}\\right)^{b}</th>

          </tr>

        </thead>

        <tbody>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">\\leq (2</td>

            <td class="px-3 py-2 border-b border-gray-700">l - t</td>

            <td class="px-3 py-2 border-b border-gray-700">N)^{-2b}<em>\\left(\\max \\{0.9</em>k^{\\frac{1}{2}}<em>1.1221^{k},0.24</em>k^{\\frac{3}{2}}<em>\\frac{3.81^{k}}{N},0.014</em>k^{2}*\\frac{9.813^{k}}{N^{2}}\\}\\right)^{b}</td>

          </tr>

        </tbody>

      </table>

    </div>

    <div class="my-4 text-center"><span class="math-block"></span></div>

    <p class="text-gray-300">Thus, <span class="math">R_{\\ell}(\\mathbf{x})</span> is upper bounded by</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">$\\left(\\frac{1+\\frac{4*\\ln(ek)}{N}+\\frac{4k^{2}}{N^{2}}}{4</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">l-t</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">^{2}N^{2}}\\right)^{b}<em>\\left(\\ \\max\\{0.9</em>k^{\\frac{1}{2}}<em>1.1221^{k},0.24</em>k^{\\frac{3}{2}}<em>\\frac{3.81^{k}}{N},0.014</em>k^{2}*\\frac{9.813^{k}}{N^{2}}\\}\\right)^{b}$</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">Thus, using (36) we have that (34) is upper bounded by</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">$\\left(2k<em>N+1+(2d+3)</em>((2k+1)<em>e</em>(\\mathsf{m}+d)/d)^{d}\\right)<em>\\left(\\frac{1+\\frac{4</em>\\ln(ek)}{N}+\\frac{4k^{2}}{N^{2}}}{4</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">l-t</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">^{2}N^{2}}\\right)^{b}*$</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300"><span class="math">\\left(\\ \\max\\{0.9<em>k^{\\frac{1}{2}}</em>1.1221^{k},0.24<em>k^{\\frac{3}{2}}</em>\\frac{3.81^{k}}{N},0.014<em>k^{2}</em>\\frac{9.813^{k}}{N^{2}}\\}\\right)^{b}</span></p>

    <p class="text-gray-300">This completes the proof of the counterpart of Lemma 5 for the general case. ∎</p>

    <p class="text-gray-300">To simplify the presentation of the above result, note that</p>

    <p class="text-gray-300"><span class="math">\\max\\{0.9<em>k^{\\frac{1}{2}}</em>1.1221^{k},0.24<em>k^{\\frac{3}{2}}</em>\\frac{3.81^{k}}{N},0.014<em>k^{2}</em>\\frac{9.813^{k}}{N^{2}}</span> <span class="math">=0.9<em>\\sqrt{k}</em>1.1221^{k}<em>\\max\\left\\{1,\\;0.22</em>k<em>\\frac{3.4^{k}}{N},\\;0.015</em>k^{\\frac{3}{2}}*\\frac{8.745^{k}}{N^{2}}\\right\\}</span></p>

    <p class="text-gray-300">Thus, if we assume <span class="math">N&gt;0.22<em>k</em>3.4^{k}</span>, <span class="math">k\\geq 12</span>, <span class="math">b=\\lceil d/2\\rceil</span>, and also noting that <span class="math">\\mathsf{m}=b*(4k+\\boldsymbol{\\nu})</span>, the above upper bound simplifies to</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">$\\left(2k<em>N+(2d+3)</em>(33<em>k^{2})^{d}\\right)</em>\\left(\\frac{\\sqrt{k}*1.1221^{k}}{2</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">l-t</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">^{2}N^{2}}\\right)^{b}$</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Combining with the upper bound (33), we have that for the mod function <span class="math">f_{N}(\\cdot)</span>, for any <span class="math">d&gt;0</span>, <span class="math">N&gt;0.22<em>k</em>3.4^{k}</span>, <span class="math">k\\geq 12</span>, <span class="math">k</span> a multiple of twelve, for any <span class="math">\\mathbf{x}</span> such that $</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\mathbf{x}-t*N</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\leq 1/2<span class="math"> with </span>t\\in\\{-k,-k+1,\\ldots,k\\}$, we have</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">$</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">g_{2d}(\\mathbf{x})-f_{N}(\\mathbf{x})</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"><2^{2d}<em>N^{-2d}</em>\\left(1+\\frac{2e\\mathsf{m}}{2d}\\right)^{2d}+$</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300"><span class="math">N^{-2d}<em>\\left(4k</em>N+(4d+6)<em>(33</em>k^{2})^{d}\\right)<em>\\left(\\sqrt{k}</em>1.1221^{k}/2\\right)^{d}</span></p>

    <p class="text-gray-300">and</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">$</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">g_{2d+1}(\\mathbf{x})-f_{N}(\\mathbf{x})</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"><2^{2d+1}<em>N^{-2d-1}</em>\\left(1+\\frac{2e\\mathsf{m}}{2d+1}\\right)^{2d+1}+$</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300"><span class="math">N^{-2d-1}<em>\\left(4k+(4d+10)</em>(33<em>k^{2})^{d+1}/N\\right)</em>\\left(\\sqrt{k}*1.1221^{k}/2\\right)^{d+1}</span></p>

    <p class="text-gray-300">E Proof of Theorem 10 for Small <span class="math">N</span></p>

    <p class="text-gray-300">Proof: (of Theorem 10)</p>

    <p class="text-gray-300">The proof that</p>

    <div class="my-4 text-center"><span class="math-block">\\sum_{z \\in S_{\\ell}} f_N(z) * \\left(\\prod_{w \\in S_{\\ell} \\setminus \\{z\\}} \\frac{\\mathbf{x} - w}{z - w}\\right) * \\prod_{\\substack{\\ell&#x27; \\in \\mathcal{L} \\\\ \\ell&#x27; \\neq \\ell}} \\left(\\frac{\\mathbf{x} - \\ell&#x27; N}{(\\ell - \\ell&#x27;) N}\\right)^{2 + p(\\ell&#x27;)} \\tag{39}</span></div>

    <p class="text-gray-300">differs from <span class="math">f_N(\\mathbf{x}) = \\mathbf{x}&#x27;</span> (with <span class="math">\\mathbf{x}</span> in the <span class="math">\\ell</span>-th interval) in absolute value by at most <span class="math">\\frac{2*\\ln(ek)}{N} + \\frac{2k^2}{N^2}</span> (now with <span class="math">k = 12</span>), remains the same as the proof of Lemma 4.</p>

    <p class="text-gray-300">The proof of a lemma similar to Lemma 5 is also similar except for the bounds on <span class="math">P_t / P_\\ell</span>, for <span class="math">t, \\ell \\in [-12..12]</span>.</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Just as in the proof of Lemma 5, we have similar to (15) (recalling, $</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\mathbf{x} - tN</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\leq 1/2<span class="math"> for </span>t \\in \\{-k..k\\}<span class="math">, </span>t \\neq \\ell<span class="math">, and </span>\\mathbf{x} = \\mathbf{x}' + tN<span class="math">, and now </span>k = 12$)</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">$$ \\begin{aligned} \\sum_{z \\in S_{\\ell}} f_N(z) <em> \\prod_{w \\in S_{\\ell} \\setminus \\{z\\}} \\frac{\\mathbf{x}' + t </em> N - w}{z - w} <em> \\prod_{\\substack{\\ell' \\in \\mathcal{L} \\\\ \\ell' \\neq \\ell}} \\left(\\frac{\\mathbf{x}' + t </em> N - \\ell' N}{\\ell N - \\ell' N}\\right)^{2 + p(\\ell')} \\\\</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\leq \\frac{1}{4} <em> \\left(1 + 4 </em> \\frac{\\ln(ek)}{N} + \\frac{4k^2}{N^2}\\right) <em> N^{-1 - p(\\ell, t)} </em></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">t - \\ell</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">^{-1 - p(t)} * \\prod_{\\substack{\\ell' \\in \\mathcal{L} \\\\ \\ell' \\neq \\ell \\\\ \\ell' \\neq t}} \\left(\\frac{</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\ell' - t</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">}{</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\ell' - \\ell</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">}\\right)^{2 + p(\\ell')} \\tag{40}</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">\\end{aligned} $$</p>

    <p class="text-gray-300">For each of <span class="math">m = 0..4</span>, for all <span class="math">t</span> such that <span class="math">p(t) = m</span>, we can calculate the upper bound on</p>

    <div class="my-4 text-center"><span class="math-block"></span></div>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\Gamma_{m} \\triangleq</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">t - \\ell</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">^{-1 - p(t)} * \\prod_{\\substack{\\ell' \\in \\mathcal{L} \\\\ \\ell' \\neq \\ell \\\\ \\ell' \\neq t}} \\left(\\frac{</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\ell' - t</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">}{</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\ell' - \\ell</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">}\\right)^{2 + p(\\ell^{\\prime})}</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <div class="my-4 text-center"><span class="math-block"></span></div>

    <p class="text-gray-300">A simple computer program (given at the end of this section) shows that <span class="math">\\Gamma_0 \\leq 1</span>, <span class="math">\\Gamma_1 \\leq 60</span>, <span class="math">\\Gamma_2 \\leq 2919</span> and <span class="math">\\Gamma_4 \\leq 1.23 * 10^7</span>. Note <span class="math">\\Gamma_3</span> is undefined. Thus,</p>

    <div class="my-4 text-center"><span class="math-block">\\begin{aligned} \\sum_{z \\in S_{\\ell}} f_N(z) * \\prod_{w \\in S_{\\ell} \\setminus \\{z\\}} \\frac{\\mathbf{x}&#x27; + t * N - w}{z - w} * \\prod_{\\substack{\\ell&#x27; \\in \\mathcal{L} \\\\ \\ell&#x27; \\neq \\ell}} \\left(\\frac{\\mathbf{x}&#x27; + t * N - \\ell&#x27; N}{\\ell N - \\ell&#x27; N}\\right)^{2 + p(\\ell&#x27;)} \\\\ \\leq N^{-1} * \\left(\\frac{1}{4} + \\frac{3.5}{N} + \\frac{144}{N^2}\\right) * \\max \\left\\{1, \\frac{60}{N}, \\frac{2919}{N^2}, \\frac{1.23 * 10^7}{N^4} \\right\\} \\tag{41} \\end{aligned}</span></div>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Combining (39) and (41) we have For the mod function <span class="math">f_{N}(\\cdot)</span>, for <span class="math">k = 12</span>, <span class="math">N \\geq 320</span>, for any <span class="math">\\mathbf{x}</span> such that $</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\mathbf{x} - t*N</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\leq 1/2<span class="math"> with </span>t \\in \\{-k, -k + 1, \\ldots, k\\}<span class="math">, we have that </span>\\hat{g}<span class="math"> defined in (6) is an odd polynomial with </span>\\deg(\\hat{g}) = 69$, and</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <div class="my-4 text-center"><span class="math-block"></span></div>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\hat {g} (\\mathbf {x}) - f _ {N} (\\mathbf {x})</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">&lt;   \\frac {1}{N} <em> \\left(\\frac {1}{4} + \\frac {3 . 5}{N} + \\frac {1 4 4}{N ^ {2}}\\right) </em> \\left(2 + \\max \\left\\{1, \\frac {6 0}{N}, \\frac {2 9 1 9}{N ^ {2}}, \\frac {1 . 2 3 * 1 0 ^ {7}}{N ^ {4}} \\right\\}\\right)</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <div class="my-4 text-center"><span class="math-block"></span></div>

    <p class="text-gray-300">□</p>

    <p class="text-gray-300">Below we provide the computer program written in the language Macaulay 2 to upper bound the various <span class="math">\\Gamma</span>.</p>

    <pre><code class="language-matlab">k=12;
for i from 0 to 4 do gamma_(i) =0;
for t from 0 to k do (
plt = 0;
if (t &amp;gt; 6) then plt = plt +1;
if (t &amp;gt; 10) then plt = plt +1;
if (t &amp;gt; 11) then plt = plt +2;
p_t = plt;
);
for ell from -k to k do (
for t from 0 to k do (
f = 1;
for ellp from -1*k to k do (
absl = abs(ellp);
if ((ellp !=ell) and (ellp !=t)) then (
f = f * (abs(ellp - t)/abs(ellp-ell))^(2+p_(absl));
);
)
if (f &amp;gt; gamma_(p_t)) then gamma_(p_t) = f;
);
)
for i from 0 to 4 do
&amp;lt;&amp;lt; &quot;max Gamma at &quot; &amp;lt;&amp;lt; i &amp;lt;&amp;lt; &quot; is &quot; &amp;lt;&amp;lt; toRR(32,gamma_(i)) &amp;lt;&amp;lt; &quot;\\n&quot;;</code></pre>

    <p class="text-gray-300">55</p>

    <p class="text-gray-300">E.1 General Case</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Following the proof in section D, we also have in the general case that the mod function <span class="math">f_{N}(\\cdot)</span>, for any <span class="math">d &amp;gt; 0</span>, <span class="math">b = \\lceil d / 2 \\rceil</span>, <span class="math">N &amp;gt; 60</span>, <span class="math">k = 12</span>, for any <span class="math">\\mathbf{x}</span> such that $</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\mathbf{x} - t*N</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\leq 1/2<span class="math"> with </span>t \\in \\{-k, -k + 1, \\ldots, k\\}$, we have</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">$$ \\begin{aligned}</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">g _ {d} (\\mathbf {x}) - f _ {N} (\\mathbf {x})</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">&amp; \\leq 2 ^ {d} <em> N ^ {- d} </em> \\left(1 + \\frac {2 e \\mathfrak {m}}{d}\\right) ^ {d} + \\\\</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">&amp; \\quad \\left(\\max  \\left\\{1, \\frac {6 0}{N}, \\frac {2 9 1 9}{N ^ {2}}, \\frac {1 . 2 3 <em> 1 0 ^ {7}}{N ^ {4}} \\right\\}\\right) ^ {b} \\\\ &amp; \\leq 2 ^ {d} </em> N ^ {- d} <em> (3 7 2 b / d) ^ {d} + \\left(2 4 </em> N + 1 + (2 d + 3) <em> (2 3 1 0) ^ {d}\\right) </em> N ^ {- 2 b} \\end{aligned} $$</p>

    <p class="text-gray-300">F Lower Bound on the Standard Error Analysis for Lagrange Interpolation (cont'd)</p>

    <p class="text-gray-300">Recall the following well-known theorem regarding the error of polynomial interpolation from Section 2.</p>

    <p class="text-gray-300">Theorem 14 (Polynomial Interpolation) Let <span class="math">f</span> be an <span class="math">n + 1</span> times differentiable function on <span class="math">[a, b]</span> and <span class="math">p_n</span> be a polynomial of degree <span class="math">\\leq n</span> that interpolates <span class="math">f</span> at <span class="math">n + 1</span> distinct points <span class="math">t_0, t_1, \\ldots, t_n \\in [a, b]</span>, meaning <span class="math">p_n(t_i) = f(t_i)</span> for all <span class="math">0 \\leq i \\leq n</span>. Then, for each <span class="math">t \\in [a, b]</span>, there exists a point <span class="math">\\psi_t \\in [a, b]</span> such that</p>

    <div class="my-4 text-center"><span class="math-block">f (t) - p _ {n} (t) = \\frac {f ^ {(n + 1)} (\\psi_ {t})}{(n + 1) !} \\cdot \\prod_ {i = 0} ^ {n} (t - t _ {i}).</span></div>

    <p class="text-gray-300">Error analysis for Lagrange interpolation proceeds by upper bounding <span class="math">f^{(n + 1)}(\\cdot)</span> on <span class="math">[a,b]</span> and then bounding <span class="math">\\prod_{i = 0}^{n}(t - t_i)</span>. We are interested in approximating</p>

    <div class="my-4 text-center"><span class="math-block">S (t) = \\sin (2 \\pi k t)</span></div>

    <p class="text-gray-300">on the <span class="math">2k + 1</span> intervals of width <span class="math">2\\epsilon /k</span> centered at <span class="math">(1 / k)*[-k,\\ldots ,k]</span>. Observe that since <span class="math">\\sin x</span> and <span class="math">\\cos x</span> lie between <span class="math">-1</span> and <span class="math">1</span>, we can bound</p>

    <div class="my-4 text-center"><span class="math-block"></span></div>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">S ^ {(n + 1)} (\\psi_ {t})</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\leq (2 \\pi k) ^ {n + 1}</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <div class="my-4 text-center"><span class="math-block"></span></div>

    <p class="text-gray-300">for any <span class="math">\\psi_t</span>. So the error analysis will be able to bound the error between <span class="math">S(t)</span> and the polynomial <span class="math">p_n(t)</span> by</p>

    <div class="my-4 text-center"><span class="math-block"></span></div>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">S(t) - p_n(t)</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\leq \\frac{(2\\pi k)^{n+1} \\cdot}{(n+1)!} \\cdot \\left</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\prod_{i=0}^{n} (t - t_i) \\right</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">.</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <div class="my-4 text-center"><span class="math-block"></span></div>

    <p class="text-gray-300">We will now show that no matter how the <span class="math">t_i</span>'s are chosen in these small intervals<span class="math">^6</span>, the resulting error bound will be worse than that obtained via modular Lagrange interpolation.</p>

    <p class="text-gray-300">Let <span class="math">d_i</span> be the number of points for interpolation chosen in the interval centered at <span class="math">i/k</span> for <span class="math">i \\in \\{-k, \\dots, k\\}</span>. Then, the points in the <span class="math">i</span>th interval can be written as <span class="math">t_{i,j} = i/k + \\delta_{i,j}</span> for <span class="math">\\delta_{i,j} \\in [-\\epsilon/k, \\epsilon/k]</span> and <span class="math">1 \\leq j \\leq d_i</span>. It follows that <span class="math">n + 1 = \\sum_{-k}^{k} d_i</span>. Consider an arbitrary point <span class="math">t_\\ell = \\ell/k + \\delta</span> in the interval centered around <span class="math">\\ell/k</span>. Then,</p>

    <p class="text-gray-300">$$ \\begin{aligned}</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\left</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\prod_{i=-k}^{k} \\prod_{j=1}^{d_i} (t_\\ell - t_{i,j}) \\right</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">&amp;= \\prod_{i=-k}^{k} \\prod_{j=1}^{d_i}</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">(\\ell/k - i/k + \\delta - \\delta_{i,j})</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\\\</th>

          </tr>

        </thead>

        <tbody>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">&amp;\\geq \\left( \\frac{\\epsilon}{k <em> d_\\ell} \\right)^{d_\\ell} \\left( \\prod_{i=-k, i \\neq \\ell}^{k} \\prod_{j=1}^{d_i} (1/k) </em> (</td>

            <td class="px-3 py-2 border-b border-gray-700">\\ell - i</td>

            <td class="px-3 py-2 border-b border-gray-700">- 2\\epsilon) \\right)</td>

          </tr>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">\\end{aligned} $$</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">for the worst-case <span class="math">\\delta \\in [-\\epsilon/k, \\epsilon/k]</span> when <span class="math">d_\\ell \\geq 1</span>. Considering only the highest order in <span class="math">\\epsilon</span> error term, we will approximate $(</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\ell - i</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">- 2\\epsilon)<span class="math"> with </span></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\ell - i</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">$.</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">To obtain an <span class="math">O(\\epsilon^2)</span> approximation (consistent with our <span class="math">O(1/N)</span> approximation), we must set <span class="math">d_i \\geq 2</span> for all <span class="math">i</span>. However, if we set <span class="math">d_i \\geq 3</span>, then we exceed the degree of our <span class="math">O(1/N)</span> approximation in Section 4. Let <span class="math">w(i)</span> be a function that represents the number of points beyond 2 that are in the <span class="math">i</span>th interval. That is, <span class="math">w(i) = d_i - 2</span>. Let <span class="math">\\pmb{\\nu} = \\sum_{i=-k}^{k} w(i)</span>. Thus, <span class="math">n + 1 = 2 * (2k + 1) + \\pmb{\\nu}</span>. Then, for a worst-case interval <span class="math">\\ell</span> (one where <span class="math">d_\\ell = 2</span>), the above error approximation gives</p>

    <div class="my-4 text-center"><span class="math-block"></span></div>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\frac{(2\\pi)^{n+1}}{(n+1)!} <em> \\left( \\frac{\\epsilon}{2} \\right)^2 </em> \\left( \\prod_{i=-k, i \\neq \\ell}^{k} (</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\ell - i</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">)^2 \\right) * \\left( \\prod_{i=-k, i \\neq \\ell}^{k} (</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\ell - i</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">)^{w(i)} \\right).</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <div class="my-4 text-center"><span class="math-block"></span></div>

    <p class="text-gray-300"><span class="math">^6</span>One could consider taking points not inside these intervals, but this can be seen to be suboptimal if the number of points is even. Since approximations to the mod function are odd polynomials, the number of points chosen for interpolation will be even.</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Since $\\left(\\prod_{i=-k,i\\neq\\ell}^{k}(</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\ell-i</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">)^{2}\\right)<span class="math"> is minimized when </span>\\ell=0<span class="math"> and increases as </span></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\ell</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"><span class="math"> increases, a reasonable assumption to minimize the error across all intervals is that </span>w(i)<span class="math"> is an increasing function with </span></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">i</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"><span class="math"> and is symmetric (</span>w(i)=w(-i)<span class="math">). Let </span>\\alpha<span class="math"> denote the largest </span></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">i</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"><span class="math"> for which </span>w(i)=0$. Then, the error in the 0th interval can be bounded by</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300"><span class="math">\\frac{(2\\pi)^{4k+2+\\boldsymbol{\\nu}}}{(4k+2+\\boldsymbol{\\nu})!}<em>\\left(\\frac{\\epsilon}{2}\\right)^{2}</em>(k!)^{4}<em>\\left(\\frac{k!}{\\alpha!}\\right)^{2}</em>(\\alpha+1)^{\\boldsymbol{\\nu}-2(k-\\alpha)}</span> <span class="math">\\geq\\frac{(2\\pi)^{4k+2+\\boldsymbol{\\nu}}}{(4k+2+\\boldsymbol{\\nu})^{2+\\boldsymbol{\\nu}}}<em>\\left(\\frac{\\epsilon}{2}\\right)^{2}</em>\\frac{(k!)^{4}}{(4k)!}<em>\\left(\\frac{k!}{\\alpha!}\\right)^{2}</em>(\\alpha+1)^{\\boldsymbol{\\nu}-2(k-\\alpha)}</span> <span class="math">\\approx\\frac{(2\\pi)^{4k+2+\\boldsymbol{\\nu}}}{(4k+2+\\boldsymbol{\\nu})^{2+\\boldsymbol{\\nu}}}<em>\\left(\\frac{\\epsilon}{2}\\right)^{2}</em>\\frac{1}{4^{4k}}<em>\\left(\\frac{k!}{\\alpha!}\\right)^{2}</em>(\\alpha+1)^{\\boldsymbol{\\nu}-2(k-\\alpha)}</span> <span class="math">=\\epsilon^{2}<em>\\frac{\\pi^{4k+2+\\boldsymbol{\\nu}}}{2^{4k-\\boldsymbol{\\nu}}</em>(4k+2+\\boldsymbol{\\nu})^{2+\\boldsymbol{\\nu}}}<em>\\left(\\frac{k!}{\\alpha!}\\right)^{2}</em>(\\alpha+1)^{\\boldsymbol{\\nu}-2(k-\\alpha)}</span></p>

    <p class="text-gray-300">When <span class="math">k</span> is a multiple of 12, we give polynomials in Section 4 with <span class="math">\\boldsymbol{\\nu}=14(k/12)</span>. Thus, the minimum possible value of <span class="math">\\alpha</span> is <span class="math">k-7(k/12)=5(k/12)</span>. The lower bound then becomes</p>

    <p class="text-gray-300"><span class="math">\\epsilon^{2}<em>\\frac{\\pi^{(31k/6)+2}}{2^{(17k/6)}</em>((31k/6)+2)^{2+7(k/6)}}*\\left(\\frac{k!}{(5k/12)!}\\right)^{2}.</span></p>

    <p class="text-gray-300">For <span class="math">k=12</span>, this gives a lower bound of <span class="math">769137\\epsilon^{2}</span>. For comparison, we obtained a bound of <span class="math">75\\epsilon^{2}</span>. Note that this lower bound only focused on the error for the 0th interval, and this error is already larger than the error of our polynomials.</p>

    <h2 id="sec-37" class="text-2xl font-bold">Appendix G Explicit Polynomials</h2>

    <p class="text-gray-300">In this section, we give some explicit polynomials for approximating the mod function obtained via modular Lagrange interpolation. The following (odd) polynomials are listed with the constant term first and the highest degree term last.</p>

    <p class="text-gray-300">Suppose <span class="math">q=N<em>M</span>, where <span class="math">M</span> is the maximum size of the message <span class="math">m</span>, and the input <span class="math">x</span> is of the form <span class="math">I</em>q+m</span>, for <span class="math">I\\in[-12..12]</span>. Then, the input <span class="math">x</span> should be first normalized by dividing by <span class="math">12q+1</span>, so as to be evaluated by Chebyshev polynomials. Call the normalized input <span class="math">x^{\\prime}</span>. Next, the various (odd) Chebyshev basis polynomials <span class="math">T_{2j+1}</span>, with <span class="math">1\\leq 2j+1\\leq\\textsc{d}</span>, should be evaluated on <span class="math">x^{\\prime}</span> upto the prescribed precision. Here, d is the degree of the polynomial. The result, which approximates <span class="math">m</span>, is <span class="math">\\sum_{j=0}^{(\\textsc{d}-1)/2}a_{2j+1}*T_{2j+1}</span>.</p>

    <h2 id="sec-38" class="text-2xl font-bold">Appendix</h2>

    <p class="text-gray-300">Polynomial for  <span class="math">N = 1024</span> ,  <span class="math">d = 7</span> ,  <span class="math">c = 0</span> ,  <span class="math">b = 3</span> , max-error  <span class="math">= 2^{-49}</span>  (additive to  <span class="math">m / q</span> ), degree  <span class="math">D = 209</span> , precision required for Cheby polys: 109 bits, for message space of precision 43 bits (i.e.  <span class="math">\\log M</span> ). (the following odd polynomial is listed with the constant term first and the highest degree term last):</p>

    <p class="text-gray-300">0, 1168086454234386721728786093, 0, 857343731807213129276527371, 0, 321577746951483724417855166, 0, -292231639690436254023249313, 0, -817558357077948111433871545, 0, -1115078287892665095295847460, 0, -1110902683997716285124711721, 0, -815466383301985986929060172, 0, -318118048203314366189979744, 0, 240336163193778344064042767, 0, 708546663412296489590609529, 0, 966802652802823190347418980, 0, 958410990971409284025257086, 0, 701859806234615738681506707, 0, 281315417920828815838724026, 0, -180619100645381391833095478,</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">0,</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">-559074895353411112211879488,</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">0,</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">-761193870352871464575970113,</th>

          </tr>

        </thead>

        <tbody>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">0,</td>

            <td class="px-3 py-2 border-b border-gray-700">-748961547193141244456643106,</td>

            <td class="px-3 py-2 border-b border-gray-700">0,</td>

            <td class="px-3 py-2 border-b border-gray-700">-545019098411792243865207141,</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">0,</td>

            <td class="px-3 py-2 border-b border-gray-700">-221182605886666986588184985,</td>

            <td class="px-3 py-2 border-b border-gray-700">0,</td>

            <td class="px-3 py-2 border-b border-gray-700">125631214744033173329756970,</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">0,</td>

            <td class="px-3 py-2 border-b border-gray-700">402176605497046862164911192,</td>

            <td class="px-3 py-2 border-b border-gray-700">0,</td>

            <td class="px-3 py-2 border-b border-gray-700">543822384945637454963785227,</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">0,</td>

            <td class="px-3 py-2 border-b border-gray-700">529041122166502663418034057,</td>

            <td class="px-3 py-2 border-b border-gray-700">0,</td>

            <td class="px-3 py-2 border-b border-gray-700">380454231175936390963182110,</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">0,</td>

            <td class="px-3 py-2 border-b border-gray-700">153583874550410836778346038,</td>

            <td class="px-3 py-2 border-b border-gray-700">0,</td>

            <td class="px-3 py-2 border-b border-gray-700">-82158926416441517047319102,</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">0,</td>

            <td class="px-3 py-2 border-b border-gray-700">-264016877090445503291895215,</td>

            <td class="px-3 py-2 border-b border-gray-700">0,</td>

            <td class="px-3 py-2 border-b border-gray-700">-352017418757438912124391674,</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">0,</td>

            <td class="px-3 py-2 border-b border-gray-700">-336726247305874507782050670,</td>

            <td class="px-3 py-2 border-b border-gray-700">0,</td>

            <td class="px-3 py-2 border-b border-gray-700">-237542040580981854329586741,</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">0,</td>

            <td class="px-3 py-2 border-b border-gray-700">-93285861002735563557789426,</td>

            <td class="px-3 py-2 border-b border-gray-700">0,</td>

            <td class="px-3 py-2 border-b border-gray-700">51203641438492931279476695,</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">0,</td>

            <td class="px-3 py-2 border-b border-gray-700">158138557109275412094214802,</td>

            <td class="px-3 py-2 border-b border-gray-700">0,</td>

            <td class="px-3 py-2 border-b border-gray-700">205902506436761190012091838,</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">0,</td>

            <td class="px-3 py-2 border-b border-gray-700">192272901361176496521724271,</td>

            <td class="px-3 py-2 border-b border-gray-700">0,</td>

            <td class="px-3 py-2 border-b border-gray-700">131771332034736267678084566,</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">0,</td>

            <td class="px-3 py-2 border-b border-gray-700">48836718997887305615420090,</td>

            <td class="px-3 py-2 border-b border-gray-700">0,</td>

            <td class="px-3 py-2 border-b border-gray-700">-30567669476018418201737430,</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">0,</td>

            <td class="px-3 py-2 border-b border-gray-700">-86288586492669414092635654,</td>

            <td class="px-3 py-2 border-b border-gray-700">0,</td>

            <td class="px-3 py-2 border-b border-gray-700">-108382466605506825823721887,</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">0,</td>

            <td class="px-3 py-2 border-b border-gray-700">-97870349385353469283431522,</td>

            <td class="px-3 py-2 border-b border-gray-700">0,</td>

            <td class="px-3 py-2 border-b border-gray-700">-64308240709636355867793447,</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">0,</td>

            <td class="px-3 py-2 border-b border-gray-700">-21461468941244398795157840,</td>

            <td class="px-3 py-2 border-b border-gray-700">0,</td>

            <td class="px-3 py-2 border-b border-gray-700">17326592921743672239788373,</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">0,</td>

            <td class="px-3 py-2 border-b border-gray-700">42700061643388303938158218,</td>

            <td class="px-3 py-2 border-b border-gray-700">0,</td>

            <td class="px-3 py-2 border-b border-gray-700">50996981335404100973959652,</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">0,</td>

            <td class="px-3 py-2 border-b border-gray-700">43999901398812509501638598,</td>

            <td class="px-3 py-2 border-b border-gray-700">0,</td>

            <td class="px-3 py-2 border-b border-gray-700">27218306023500888628165559,</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">0,</td>

            <td class="px-3 py-2 border-b border-gray-700">7511351204331858459027720,</td>

            <td class="px-3 py-2 border-b border-gray-700">0,</td>

            <td class="px-3 py-2 border-b border-gray-700">-9124894335827475847590487,</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">0,</td>

            <td class="px-3 py-2 border-b border-gray-700">-19011264986878466920308735,</td>

            <td class="px-3 py-2 border-b border-gray-700">0,</td>

            <td class="px-3 py-2 border-b border-gray-700">-21240027011005272177515640,</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">0,</td>

            <td class="px-3 py-2 border-b border-gray-700">-17235488182308094169059958,</td>

            <td class="px-3 py-2 border-b border-gray-700">0,</td>

            <td class="px-3 py-2 border-b border-gray-700">-9762047684096432167581061,</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">0,</td>

            <td class="px-3 py-2 border-b border-gray-700">-1801405931639871012067336,</td>

            <td class="px-3 py-2 border-b border-gray-700">0,</td>

            <td class="px-3 py-2 border-b border-gray-700">4343202668899288644999705,</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">0,</td>

            <td class="px-3 py-2 border-b border-gray-700">7513256624328692928829408,</td>

            <td class="px-3 py-2 border-b border-gray-700">0,</td>

            <td class="px-3 py-2 border-b border-gray-700">7707337571415601635186575,</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">0,</td>

            <td class="px-3 py-2 border-b border-gray-700">5756436611224478681862020,</td>

            <td class="px-3 py-2 border-b border-gray-700">0,</td>

            <td class="px-3 py-2 border-b border-gray-700">2848796879491757763177843,</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">0,</td>

            <td class="px-3 py-2 border-b border-gray-700">85869737980867178544936,</td>

            <td class="px-3 py-2 border-b border-gray-700">0,</td>

            <td class="px-3 py-2 border-b border-gray-700">-1808098547283706804642313,</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">0,</td>

            <td class="px-3 py-2 border-b border-gray-700">-2580773528142545311733665,</td>

            <td class="px-3 py-2 border-b border-gray-700">0,</td>

            <td class="px-3 py-2 border-b border-gray-700">-2379644644727334869970039,</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">0,</td>

            <td class="px-3 py-2 border-b border-gray-700">-1584099449739462886296632,</td>

            <td class="px-3 py-2 border-b border-gray-700">0,</td>

            <td class="px-3 py-2 border-b border-gray-700">-620801233570437909456226,</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">0,</td>

            <td class="px-3 py-2 border-b border-gray-700">177002015939962120138178,</td>

            <td class="px-3 py-2 border-b border-gray-700">0,</td>

            <td class="px-3 py-2 border-b border-gray-700">637322616908069820961416,</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">0,</td>

            <td class="px-3 py-2 border-b border-gray-700">746708447295636591621208,</td>

            <td class="px-3 py-2 border-b border-gray-700">0,</td>

            <td class="px-3 py-2 border-b border-gray-700">600320533243730473229437,</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">0,</td>

            <td class="px-3 py-2 border-b border-gray-700">335551277339171148995831,</td>

            <td class="px-3 py-2 border-b border-gray-700">0,</td>

            <td class="px-3 py-2 border-b border-gray-700">75303469471198484934870,</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">0,</td>

            <td class="px-3 py-2 border-b border-gray-700">-104484715159419839814631,</td>

            <td class="px-3 py-2 border-b border-gray-700">0,</td>

            <td class="px-3 py-2 border-b border-gray-700">-181085471349235784144282,</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">0,</td>

            <td class="px-3 py-2 border-b border-gray-700">-172186740047558875429158,</td>

            <td class="px-3 py-2 border-b border-gray-700">0,</td>

            <td class="px-3 py-2 border-b border-gray-700">-114989546962237138479380,</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">0,</td>

            <td class="px-3 py-2 border-b border-gray-700">-46933405878291066774262,</td>

            <td class="px-3 py-2 border-b border-gray-700">0,</td>

            <td class="px-3 py-2 border-b border-gray-700">6278911197203248699968,</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">0,</td>

            <td class="px-3 py-2 border-b border-gray-700">34210824196182898522253,</td>

            <td class="px-3 py-2 border-b border-gray-700">0,</td>

            <td class="px-3 py-2 border-b border-gray-700">38872665499010244728055,</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">0,</td>

            <td class="px-3 py-2 border-b border-gray-700">28960040671209758802896,</td>

            <td class="px-3 py-2 border-b border-gray-700">0,</td>

            <td class="px-3 py-2 border-b border-gray-700">14214605200094274586116,</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">0,</td>

            <td class="px-3 py-2 border-b border-gray-700">1734974669062679927928,</td>

            <td class="px-3 py-2 border-b border-gray-700">0,</td>

            <td class="px-3 py-2 border-b border-gray-700">-5301450813792947532094,</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">0,</td>

            <td class="px-3 py-2 border-b border-gray-700">-7037641220180290308568,</td>

            <td class="px-3 py-2 border-b border-gray-700">0,</td>

            <td class="px-3 py-2 border-b border-gray-700">-5423997599405783363784,</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">0,</td>

            <td class="px-3 py-2 border-b border-gray-700">-2702130219676810140085,</td>

            <td class="px-3 py-2 border-b border-gray-700">0,</td>

            <td class="px-3 py-2 border-b border-gray-700">-440520134223430783698,</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">0,</td>

            <td class="px-3 py-2 border-b border-gray-700">745852086848961038498,</td>

            <td class="px-3 py-2 border-b border-gray-700">0,</td>

            <td class="px-3 py-2 border-b border-gray-700">975349130781356798319,</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">0,</td>

            <td class="px-3 py-2 border-b border-gray-700">687152308562330003311,</td>

            <td class="px-3 py-2 border-b border-gray-700">0,</td>

            <td class="px-3 py-2 border-b border-gray-700">294829853406611648652,</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">0,</td>

            <td class="px-3 py-2 border-b border-gray-700">23932836640143372608,</td>

            <td class="px-3 py-2 border-b border-gray-700">600,</td>

            <td class="px-3 py-2 border-b border-gray-700">-83474940988996328415,</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">0,</td>

            <td class="px-3 py-2 border-b border-gray-700">-83385665165129747914,</td>

            <td class="px-3 py-2 border-b border-gray-700">0,</td>

            <td class="px-3 py-2 border-b border-gray-700">-46136189137266827627,</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">0,</td>

            <td class="px-3 py-2 border-b border-gray-700">-14190050009111049552,</td>

            <td class="px-3 py-2 border-b border-gray-700">0,</td>

            <td class="px-3 py-2 border-b border-gray-700">932967800085450602,</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">0,</td>

            <td class="px-3 py-2 border-b border-gray-700">4059717598672962384,</td>

            <td class="px-3 py-2 border-b border-gray-700">0,</td>

            <td class="px-3 py-2 border-b border-gray-700">2677340276445438938,</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">0,</td>

            <td class="px-3 py-2 border-b border-gray-700">1049770524170609837,</td>

            <td class="px-3 py-2 border-b border-gray-700">0,</td>

            <td class="px-3 py-2 border-b border-gray-700">256678428266378497,</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">0,</td>

            <td class="px-3 py-2 border-b border-gray-700">31549863120212428.</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

          </tr>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">Polynomial for  <span class="math">N = 2^{20}</span> ,  <span class="math">d = 3, c = 0, b = 1</span> , max-error  <span class="math">= 2^{-36}</span>  (additive to  <span class="math">m / q</span> ), degree  <span class="math">D = 63</span> , precision required for Cheby polys: 145 bits, for message space of precision 20 bits (i.e.  <span class="math">\\log M</span> ). (the following odd polynomial is listed with the constant term first and the highest degree term last):</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">0,</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">-1018138773718856523,</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">0,</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">-792255707788299537,</th>

          </tr>

        </thead>

        <tbody>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">0,</td>

            <td class="px-3 py-2 border-b border-gray-700">-398036457380237928,</td>

            <td class="px-3 py-2 border-b border-gray-700">0,</td>

            <td class="px-3 py-2 border-b border-gray-700">65464815475745761,</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">0,</td>

            <td class="px-3 py-2 border-b border-gray-700">485190908761807690,</td>

            <td class="px-3 py-2 border-b border-gray-700">0,</td>

            <td class="px-3 py-2 border-b border-gray-700">765021604222736345,</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">0,</td>

            <td class="px-3 py-2 border-b border-gray-700">850929892529953988,</td>

            <td class="px-3 py-2 border-b border-gray-700">0,</td>

            <td class="px-3 py-2 border-b border-gray-700">742813330658976390,</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">0,</td>

            <td class="px-3 py-2 border-b border-gray-700">489822309534211986,</td>

            <td class="px-3 py-2 border-b border-gray-700">0,</td>

            <td class="px-3 py-2 border-b border-gray-700">171645897353125137,</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">0,</td>

            <td class="px-3 py-2 border-b border-gray-700">-127102284142356358,</td>

            <td class="px-3 py-2 border-b border-gray-700">0,</td>

            <td class="px-3 py-2 border-b border-gray-700">-340499429680023172,</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">0,</td>

            <td class="px-3 py-2 border-b border-gray-700">-435817908378521076,</td>

            <td class="px-3 py-2 border-b border-gray-700">0,</td>

            <td class="px-3 py-2 border-b border-gray-700">-416018785796205163,</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">0,</td>

            <td class="px-3 py-2 border-b border-gray-700">-311821255067144991,</td>

            <td class="px-3 py-2 border-b border-gray-700">0,</td>

            <td class="px-3 py-2 border-b border-gray-700">-167840365987534680,</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">0,</td>

            <td class="px-3 py-2 border-b border-gray-700">-27972299265682149,</td>

            <td class="px-3 py-2 border-b border-gray-700">0,</td>

            <td class="px-3 py-2 border-b border-gray-700">75830917899224394,</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">0,</td>

            <td class="px-3 py-2 border-b border-gray-700">129111891480935373,</td>

            <td class="px-3 py-2 border-b border-gray-700">0,</td>

            <td class="px-3 py-2 border-b border-gray-700">134457712479775307,</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">0,</td>

            <td class="px-3 py-2 border-b border-gray-700">106377864700523206,</td>

            <td class="px-3 py-2 border-b border-gray-700">0,</td>

            <td class="px-3 py-2 border-b border-gray-700">63925757517659405,</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">0,</td>

            <td class="px-3 py-2 border-b border-gray-700">23779346922819549,</td>

            <td class="px-3 py-2 border-b border-gray-700">0,</td>

            <td class="px-3 py-2 border-b border-gray-700">-4084115434202789,</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">0,</td>

            <td class="px-3 py-2 border-b border-gray-700">-17254849720858790,</td>

            <td class="px-3 py-2 border-b border-gray-700">0,</td>

            <td class="px-3 py-2 border-b border-gray-700">-18883394301970980,</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">0,</td>

            <td class="px-3 py-2 border-b border-gray-700">-14376926743580044,</td>

            <td class="px-3 py-2 border-b border-gray-700">0,</td>

            <td class="px-3 py-2 border-b border-gray-700">-8506558748904986,</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">0,</td>

            <td class="px-3 py-2 border-b border-gray-700">-3962809189252832,</td>

            <td class="px-3 py-2 border-b border-gray-700">0,</td>

            <td class="px-3 py-2 border-b border-gray-700">-1406881258274829,</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">0,</td>

            <td class="px-3 py-2 border-b border-gray-700">-347428595975786,</td>

            <td class="px-3 py-2 border-b border-gray-700">0,</td>

            <td class="px-3 py-2 border-b border-gray-700">-46018339611917.</td>

          </tr>

        </tbody>

      </table>

    </div>`;
---

<BaseLayout title="Modular Lagrange Interpolation of the Mod Function for Boots... (2020/1355)">
  <article class="max-w-4xl mx-auto article-prose">
    <nav class="mb-8">
      <a href="/papers" class="text-blue-400 hover:text-blue-300">
        &larr; Back to Papers
      </a>
    </nav>

    <header class="mb-12">
      <h1 class="text-3xl font-bold mb-4"
        set:html={TITLE_HTML} />
      <p class="text-gray-400 mb-2"
        set:html={AUTHORS_HTML} />
      <p class="text-gray-500 text-sm mb-4">
        2020 &middot; eprint 2020/1355
      </p>
      <div class="flex gap-4 text-sm">
        <a
          href={EPRINT_URL}
          target="_blank"
          rel="noopener noreferrer"
          class="text-blue-400 hover:text-blue-300"
        >
          Paper (eprint) &rarr;
        </a>
      </div>
      <p class="mt-4 text-xs text-gray-500">
        All content below belongs to the original authors. This page
        reproduces the paper for educational purposes. Always
        <a
          href={EPRINT_URL}
          target="_blank"
          rel="noopener noreferrer"
          class="text-blue-400 hover:text-blue-300"
        >cite the original</a>.
      </p>
      <p class="mt-1 text-xs text-gray-600">
        Converted with: {CRAWLER} &middot; {CONVERTED_DATE}
      </p>
    </header>

    <Fragment set:html={CONTENT} />

  </article>
</BaseLayout>
