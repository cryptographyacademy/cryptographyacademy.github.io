---
import BaseLayout from '../../layouts/BaseLayout.astro';
import PaperDisclaimer from '../../components/PaperDisclaimer.astro';
import PaperHistory from '../../components/PaperHistory.astro';

const EPRINT_URL = 'https://eprint.iacr.org/2019/1107';
const CRAWLER = 'marker';
const CONVERTED_DATE = '2026-02-13';
---

<BaseLayout title="HADES (2019/1107)">
  <article class="max-w-4xl mx-auto article-prose">
    <nav class="mb-8">
      <a href="/papers" class="text-blue-400 hover:text-blue-300">
        &larr; Back to Papers
      </a>
    </nav>

    <!-- ============================================================ -->
    <!-- HEADER                                                       -->
    <!-- ============================================================ -->

    <header class="mb-12">
      <h1 class="text-3xl font-bold mb-4">
        On a Generalization of Substitution-Permutation Networks:
        The HADES Design Strategy
      </h1>
      <p class="text-gray-400 mb-2">
        Lorenzo Grassi, Reinhard Luftenegger, Christian
        Rechberger, Dragos Rotaru, Markus Schofnegger
      </p>
      <p class="text-gray-500 text-sm mb-4">
        2019 &middot; Updated Version &middot; eprint 2019/1107
      </p>
      <div class="flex gap-4 text-sm">
        <a
          href={EPRINT_URL}
          target="_blank"
          rel="noopener noreferrer"
          class="text-blue-400 hover:text-blue-300"
        >
          Paper (eprint) &rarr;
        </a>
      </div>
      <PaperDisclaimer eprintUrl={EPRINT_URL} />
      <p class="mt-1 text-xs text-gray-600">Converted with: {CRAWLER} &middot; {CONVERTED_DATE}</p>
    </header>

    <!-- ============================================================ -->
    <!-- TABLE OF CONTENTS                                            -->
    <!-- ============================================================ -->

    <nav id="toc" class="mb-10 p-6 rounded-lg"
      style="background: rgba(255,255,255,0.03);
             border: 1px solid rgba(255,255,255,0.06);">
      <h2 class="text-lg font-bold mb-4">Table of Contents</h2>
      <ol class="space-y-1 text-sm text-gray-300
        list-decimal list-inside">
        <li>
          <a href="#abstract"
            class="hover:text-white">Abstract</a>
        </li>
        <li>
          <a href="#sec-1"
            class="hover:text-white">Introduction</a>
          <ol class="ml-6 mt-1 space-y-1 list-decimal
            list-inside text-gray-400">
            <li>
              <a href="#sec-1.1"
                class="hover:text-white">
                The Big Caveat: Security Analysis of P-SPNs</a>
            </li>
            <li>
              <a href="#sec-1.2"
                class="hover:text-white">
                The Idea in a Nutshell &ndash; The HADES Strategy</a>
            </li>
            <li>
              <a href="#sec-1.3"
                class="hover:text-white">
                Related Work &ndash; Designs with Different Round
                Functions</a>
            </li>
            <li>
              <a href="#sec-1.4"
                class="hover:text-white">
                HadesMiMC: Concrete Instantiations for MPC
                Applications</a>
            </li>
          </ol>
        </li>
        <li>
          <a href="#sec-2"
            class="hover:text-white">
            Description of the HADES Strategy</a>
        </li>
        <li>
          <a href="#sec-3"
            class="hover:text-white">
            The Keyed Permutation HadesMiMC</a>
          <ol class="ml-6 mt-1 space-y-1 list-decimal
            list-inside text-gray-400">
            <li>
              <a href="#sec-3.1"
                class="hover:text-white">
                Specification of HadesMiMC</a>
            </li>
            <li>
              <a href="#sec-3.2"
                class="hover:text-white">
                Design Considerations: Reviving &ldquo;Old&rdquo;
                Design Ideas</a>
            </li>
          </ol>
        </li>
        <li>
          <a href="#sec-4"
            class="hover:text-white">Security Analysis</a>
          <ol class="ml-6 mt-1 space-y-1 list-decimal
            list-inside text-gray-400">
            <li>
              <a href="#sec-4.1"
                class="hover:text-white">
                Main Points of Our Cryptanalysis Results</a>
            </li>
            <li>
              <a href="#sec-4.2"
                class="hover:text-white">
                Statistical Attacks</a>
            </li>
            <li>
              <a href="#sec-4.3"
                class="hover:text-white">
                Algebraic Attacks</a>
            </li>
          </ol>
        </li>
        <li>
          <a href="#sec-5"
            class="hover:text-white">
            Security Analysis for MPC</a>
          <ol class="ml-6 mt-1 space-y-1 list-decimal
            list-inside text-gray-400">
            <li>
              <a href="#sec-5.1"
                class="hover:text-white">
                Statistical Attacks (MPC)</a>
            </li>
            <li>
              <a href="#sec-5.2"
                class="hover:text-white">
                Algebraic Attacks (MPC)</a>
            </li>
          </ol>
        </li>
        <li>
          <a href="#sec-6"
            class="hover:text-white">
            Number of Rounds: Security and Efficiency</a>
          <ol class="ml-6 mt-1 space-y-1 list-decimal
            list-inside text-gray-400">
            <li>
              <a href="#sec-6.1"
                class="hover:text-white">
                Efficiency in the Case of MPC Applications</a>
            </li>
            <li>
              <a href="#sec-6.2"
                class="hover:text-white">
                Best Ratio Between R_F and R_P</a>
            </li>
            <li>
              <a href="#sec-6.3"
                class="hover:text-white">
                Concrete Round Numbers of HadesMiMC</a>
            </li>
          </ol>
        </li>
        <li>
          <a href="#sec-7"
            class="hover:text-white">MPC Applications</a>
        </li>
        <li>
          <a href="#sec-8"
            class="hover:text-white">
            Concluding Remarks</a>
        </li>
      </ol>
      <p class="text-xs text-gray-500 mt-4 mb-1 font-semibold">
        Appendices
      </p>
      <ol class="space-y-1 text-sm text-gray-400
        list-[upper-alpha] list-inside">
        <li>
          <a href="#app-a"
            class="hover:text-white">Concrete Instantiations</a>
        </li>
        <li>
          <a href="#app-b"
            class="hover:text-white">MDS Matrix Construction</a>
        </li>
        <li>
          <a href="#app-c"
            class="hover:text-white">Efficient Implementation</a>
        </li>
        <li>
          <a href="#app-d"
            class="hover:text-white">
            Statistical Attacks on HadesMiMC &ndash; Details</a>
        </li>
        <li>
          <a href="#app-e"
            class="hover:text-white">
            Algebraic Attacks &ndash; Details</a>
        </li>
        <li>
          <a href="#app-f"
            class="hover:text-white">
            Comparison: HadesMiMC with
            S-Box(x) = <span class="math">x^&#123;-1&#125;</span></a>
        </li>
        <li>
          <a href="#app-g"
            class="hover:text-white">
            <span class="math">\text&#123;GMiMC&#125;_&#123;\text&#123;erf&#125;&#125;</span> for MPC Applications</a>
        </li>
      </ol>
      <p class="text-xs text-gray-500 mt-4 mb-1 font-semibold">
        Additional
      </p>
      <ul class="space-y-1 text-sm text-gray-400 list-disc
        list-inside">
        <li>
          <a href="#references"
            class="hover:text-white">References</a>
        </li>
      </ul>
    </nav>

    <!-- ============================================================ -->
    <!-- ABSTRACT                                                     -->
    <!-- ============================================================ -->

    <section id="abstract" class="mb-10">
      <h2 class="text-2xl font-bold">Abstract</h2>
      <p class="text-gray-300">
        Keyed and unkeyed cryptographic permutations often iterate
        simple round functions. Substitution-permutation networks
        (SPNs) are an approach that is popular since the mid 1990s.
        One of the new directions in the design of these round
        functions is to reduce the substitution (S-Box) layer from a
        full one to a partial one, uniformly distributed over all the
        rounds. LowMC and Zorro are examples of this approach.
      </p>
      <p class="text-gray-300">
        A relevant freedom in the design space is to allow for a
        highly nonuniform distribution of S-Boxes. However, choosing
        rounds that are so different from each other is very rarely
        done, as it makes security analysis and implementation much
        harder.
      </p>
      <p class="text-gray-300">
        We develop the design strategy Hades and an analysis
        framework for it, which despite this increased complexity
        allows for security arguments against many classes of
        attacks, similar to earlier simpler SPNs. The framework
        builds upon the wide trail design strategy, and it
        additionally allows for security arguments against algebraic
        attacks, which are much more of a concern when algebraically
        simple S-Boxes are used.
      </p>
      <p class="text-gray-300">
        Subsequently, this is put into practice by concrete instances
        and benchmarks for a use case that generally benefits from a
        smaller number of S-Boxes and showcases the diversity of
        design options we support: A candidate cipher natively
        working with objects in
        <span class="math">\text&#123;GF&#125;(p)</span>, for securing
        data transfers with distributed databases using secure
        multiparty computation (MPC). Compared to the currently
        fastest design MiMC, we observe significant improvements in
        online bandwidth requirements and throughput with a
        simultaneous reduction of preprocessing effort, while having
        a comparable online latency.
      </p>

      <p class="text-gray-300">
        <strong>Keywords:</strong> Hades Strategy &ndash;
        Cryptographic Permutations &ndash; Secure Multiparty
        Computation (MPC)
      </p>

      <h3 class="text-lg font-semibold mt-6">Updated Version</h3>
      <p class="text-gray-300">
        This updated version differs from the one appeared at
        Eurocrypt 2020 mainly for the following reasons:
        (1)&nbsp;a different linear layer matrix that prevents
        infinitely long subspace trails for rounds with partial
        S-Box layers,
        (2)&nbsp;a generic S-Box replacing the cube S-Box
        <span class="math">S(x) = x^3</span> with
        <span class="math">S(x) = x^\alpha</span> where
        <span class="math">\alpha \geq 3</span> is the smallest
        integer such that
        <span class="math">\gcd(p-1, \alpha) = 1</span>, and
        (3)&nbsp;updated cryptanalysis incorporating recently
        published attacks.
      </p>
    </section>

    <!-- ============================================================ -->
    <!-- 1. INTRODUCTION                                              -->
    <!-- ============================================================ -->

    <section id="sec-1" class="mb-10">
      <h2 class="text-2xl font-bold">1. Introduction</h2>
      <p class="text-gray-300">
        Starting out with a layer of local substitution boxes
        (S-Boxes), combining it with a global permutation box
        (sometimes merely wires, sometimes affine transformations),
        and iterating such a round a number of times is a major
        design approach in symmetric cryptography. The resulting
        constructions are often referred to as
        substitution-permutation networks (SPNs) and are used to
        instantiate block ciphers, permutations, pseudo-random
        functions (PRFs), one-way functions, hash functions, and
        various other constructions. The approach can be traced back
        to Shannon's confusion-diffusion paradigm. There is a
        considerable amount of efficient designs that exploit this
        design strategy, including Rijndael/AES [DR02] which is
        perhaps the most important one.
      </p>
      <p class="text-gray-300">
        Driven by various new application areas and settings, a
        variation of the SPN approach &ndash; the so-called partial
        substitution-permutation network (P-SPN) &ndash; has been
        proposed and investigated on the practical side [5,30]. The
        idea is to replace parts of the substitution layer with an
        identity mapping, leading to substantial practical
        advantages. A big caveat of this approach is that existing
        elegant approaches to rule out large classes of attacks via
        the so-called wide trail strategy [DR01] are no longer
        applicable and have to be replaced by more ad-hoc
        approaches.
      </p>
      <p class="text-gray-300">
        <strong>Our Contribution in a Nutshell.</strong> We propose
        a new generalization of SPNs, which we call the
        &ldquo;Hades&rdquo; approach. It (1st) restores the ability
        to apply the elegant wide trail strategy to rule out
        important classes of attacks, (2nd) is accompanied with a
        broad framework to rule out various other attack vectors for
        many relevant instantiation possibilities, and (3rd) is
        demonstrated to result in even better implementation
        characteristics in the same application domains P-SPNs have
        been introduced for.
      </p>
      <p class="text-gray-300 text-sm italic">
        Referring to the figure of the S-Box layout and the bident
        shape, if one highlights the S-Boxes per round, the obtained
        picture resembles a &ldquo;bident&rdquo;. In classical
        mythology, the bident is a weapon associated with Hades, the
        ruler of the underworld.
      </p>
      <p class="text-gray-300 text-sm italic">
        [Figure 1: SP-Networks and Generalizations (P-SPNs and
        Hades) &ndash; illustrates the progression from full SPN to
        partial SPN to the HADES approach, where the first and last
        rounds use full S-Box layers and the middle rounds use
        partial S-Box layers.]
      </p>

      <!-- 1.1 -->
      <h3 id="sec-1.1" class="text-xl font-semibold mt-8">
        1.1 The Big Caveat: Security Analysis of P-SPNs
      </h3>
      <p class="text-gray-300">
        The wide trail strategy cannot guarantee security against
        all attacks in the literature. As a concrete example,
        algebraic attacks that exploit the low degree of the
        encryption or decryption function &ndash; like the
        interpolation attack [JK97] or the higher-order differential
        one [Knu94] &ndash; are (almost) independent of the linear
        layer used in the round transformation, which is the crucial
        point of such a design strategy. In other words, especially
        in the case of a low-degree S-Box, the wide trail strategy
        is not sufficient by itself, and it must be combined with
        something else to guarantee security against all known
        attacks.
      </p>
      <p class="text-gray-300">
        Moreover, the &ldquo;hidden&rdquo; assumption of such a
        strategy is that each round contains a full S-Box layer.
        Even if this is a well accepted practice, there are various
        applications/contexts in which non-linear operations are
        much less expensive than linear ones, including masking and
        practical applications of secure multi-party computation
        (MPC), fully homomorphic encryption (FHE), and
        zero-knowledge proofs (ZK).
      </p>
      <p class="text-gray-300">
        <strong>How Risky are Partial SP Networks?</strong> The wide
        trail strategy and tools that were developed in order to
        formally prove the security of block ciphers against
        standard differential and linear cryptanalysis do not apply
        to partial SP networks such as Zorro. Even though the
        authors of Zorro came up with a dedicated approach to show
        security, this turned out to be insufficient, as Wang
        et al. [WWGY14] found iterative differential and linear
        characteristics that were missed by the heuristic and used
        them to break full Zorro.
      </p>
      <p class="text-gray-300">
        Similarly, the authors of LowMC chose the number of rounds
        to guarantee that no differential/linear characteristic can
        cover the whole cipher with non-negligible probability.
        However, they do not provide such strong security arguments
        against other attack vectors including algebraic attacks.
        As a result, the security of earlier versions of LowMC
        against algebraic attacks was found to be lower than
        expected [25,27], and full key-recovery attacks on LowMC
        have been set up.
      </p>

      <!-- 1.2 -->
      <h3 id="sec-1.2" class="text-xl font-semibold mt-8">
        1.2 The Idea in a Nutshell &ndash; The HADES Strategy
      </h3>
      <p class="text-gray-300">
        Summarizing the current situation: The wide trail strategy
        is appealing due to its simplicity, but limited to
        differential and linear attacks, and does not work with
        partial S-Box layers. Additionally, when S-Boxes are chosen
        to have a low degree, other attack vectors are more relevant
        anyhow. Designs of this type, like Zorro and LowMC, require
        a lot of ad-hoc analysis.
      </p>
      <p class="text-gray-300">
        To address this issue we propose to start with a classical
        wide trail design, i.e., with a full S-Box layer (outer
        layer), and then add a part with full and/or partial S-Box
        layers in the middle. Even without the middle part, the
        outer layer in itself is supposed to give arguments against
        differential and linear attacks in exactly the same way the
        wide trail strategy does. At the same time, arguments
        against low-degree attacks can be obtained working on the
        middle layer. Since algebraic attacks exploit the small
        degree of the encryption/decryption function, the main role
        of this middle part is to achieve a high degree, with
        perhaps only few (e.g., one) S-Boxes per round.
      </p>
      <p class="text-gray-300">
        Depending on the cost metric of the target application one
        has in mind (e.g., minimizing the total number of non-linear
        operations), we show that the best solution is to choose the
        optimal ratio between the number of rounds with full S-Box
        layers and with partial S-Box layers in order to achieve
        both security and performance. We refer to this high-level
        approach as the &ldquo;Hades&rdquo; strategy.
      </p>

      <!-- 1.3 -->
      <h3 id="sec-1.3" class="text-xl font-semibold mt-8">
        1.3 Related Work &ndash; Designs with Different Round
        Functions
      </h3>
      <p class="text-gray-300">
        Almost all designs for block ciphers and permutations use
        round functions that are very similar, differing often only
        in round constants which break symmetries to prevent slide
        attacks. Notable exceptions include the AES finalist MARS,
        the lightweight cipher PRINCE [BCG+12] and the cipher Rescue
        [AAB+19], recently proposed for ZK-STARK proof systems and MPC
        applications. MARS has whitening rounds with a different
        structure than the inner rounds. PRINCE rounds differ in
        that the latter half of the rounds is essentially the
        inverse of the first half, with a special middle round.
        Similar to PRINCE, each round of Rescue is composed of two
        steps, which are respectively a non-linear S-Box layer and
        its inverse. We also mention the cases of LowMC [ARS+15] and
        Rasta [DEG+18], for which different (independent and random)
        linear layers are used in each round. In none of these
        cases, however, the amount of non-linearity, and hence
        their cryptographic strength, differs over the rounds.
      </p>

      <!-- 1.4 -->
      <h3 id="sec-1.4" class="text-xl font-semibold mt-8">
        1.4 HadesMiMC: Concrete Instantiations for MPC Applications
      </h3>
      <p class="text-gray-300">
        <strong>MPC.</strong> There is a large application area
        around secure multi-party computation. The setting is a
        secret-sharing-based MPC system where data is often shared
        as elements of a finite field
        <span class="math">\mathbb&#123;F&#125;_p</span> for large
        <span class="math">p</span>. In order to get data securely
        in and out of such a system, an efficient solution can be to
        directly evaluate a symmetric primitive within the MPC
        system. &ldquo;Traditional&rdquo; PRFs such as AES are not
        efficient in this setting, since they are built for
        computational engines which work over data types that do not
        easily match the operations possible in the MPC engine.
      </p>
      <p class="text-gray-300">
        <strong>Concrete Instances.</strong> For our concrete
        instantiations of HadesMiMC, we borrow ideas from the
        pre-predecessor of AES, namely SHARK [RDP+96], an SPN design
        with a single large MDS layer covering the whole internal
        state. Concretely specified instances, both full and toy
        versions, together with their reference implementation, test
        vectors, and helper scripts are available online.
      </p>
      <p class="text-gray-300">
        When benchmarking our new design HadesMiMC for MPC
        applications, we observe significant improvements in online
        bandwidth requirements and throughput with a simultaneous
        reduction of preprocessing effort with respect to MiMC and
        Rescue, while having a comparable online latency. A variant
        of HadesMiMC has been proposed [GKR+19] for use cases of
        efficient proof systems like STARKs, SNARKs and
        Bulletproofs, for which they outperform competing designs,
        often by a large margin.
      </p>
    </section>

    <!-- ============================================================ -->
    <!-- 2. DESCRIPTION OF THE HADES STRATEGY                        -->
    <!-- ============================================================ -->

    <section id="sec-2" class="mb-10">
      <h2 class="text-2xl font-bold">
        2. Description of the HADES Strategy
      </h2>
      <p class="text-gray-300">
        Block ciphers and cryptographic permutations are typically
        designed by iterating an efficiently implementable round
        function many times. In general, the same round function is
        iterated enough times to make sure that any symmetries and
        structural properties vanish. In our case, instead of
        considering the same non-linear layer for all rounds, we
        propose to consider a variable number of S-Boxes per round.
      </p>
      <p class="text-gray-300">
        Each round of a cipher based on Hades is composed of three
        steps:
      </p>
      <ol class="list-decimal list-inside text-gray-300 ml-4">
        <li>
          <strong>Add Round Key</strong> denoted by
          <span class="math">\textrm&#123;ARK&#125;(\cdot)</span>;
        </li>
        <li>
          <strong>SubWords</strong> denoted by
          <span class="math">\textrm&#123;S-Box&#125;(\cdot)</span>;
        </li>
        <li>
          <strong>MixLayer</strong> denoted by
          <span class="math">M(\cdot)</span>.
        </li>
      </ol>
      <p class="text-gray-300">
        A final round key addition is then performed, and the final
        MixLayer operation can be omitted:
      </p>
      <div class="math-block">
        \underbrace&#123;\textrm&#123;ARK&#125; \to \textrm&#123;S-Box&#125; \to M&#125;_&#123;\text&#123;1st round&#125;&#125; \to \cdots \to \underbrace&#123;\textrm&#123;ARK&#125; \to \textrm&#123;S-Box&#125; \to M&#125;_&#123;(R-1)\text&#123;-th round&#125;&#125; \to \underbrace&#123;\textrm&#123;ARK&#125; \to \textrm&#123;S-Box&#125;&#125;_&#123;R\text&#123;-th round&#125;&#125; \to \textrm&#123;ARK&#125;
      </div>
      <p class="text-gray-300">
        The crucial property of HADES is that the number of S-Boxes
        per round is not the same for every round:
      </p>
      <ul class="list-disc list-inside text-gray-300 ml-4">
        <li>
          A certain number of rounds denoted by
          <span class="math">R_F</span> has a
          <strong>full S-Box layer</strong>, i.e.,
          <span class="math">t</span> S-Box functions;
        </li>
        <li>
          A certain number of rounds denoted by
          <span class="math">R_P</span> has a
          <strong>partial S-Box layer</strong>, i.e.,
          <span class="math">1 \le s &lt; t</span> S-Boxes and
          <span class="math">(t - s)</span> identity functions.
        </li>
      </ul>
      <p class="text-gray-300">
        In the following, we only consider the case
        <span class="math">s = 1</span>, that is,
        <span class="math">R_P</span> rounds have a single S-Box
        per round and
        <span class="math">t - 1</span> identity functions.
      </p>
      <p class="text-gray-300">
        In more detail, assume
        <span class="math">R_F = 2 \cdot R_f</span> is an even
        number. Then:
      </p>
      <ul class="list-disc list-inside text-gray-300 ml-4">
        <li>
          the first <span class="math">R_f</span> rounds have a
          full S-Box layer,
        </li>
        <li>
          the middle <span class="math">R_P</span> rounds have a
          partial S-Box layer (i.e., 1 S-Box per round),
        </li>
        <li>
          the last <span class="math">R_f</span> rounds have a
          full S-Box layer.
        </li>
      </ul>
      <p class="text-gray-300">
        Note that the rounds with a partial S-Box layer are
        &ldquo;masked&rdquo; by the rounds with a full S-Box layer,
        which means that an attacker should not (directly) take
        advantage of the rounds with a partial S-Box layer.
      </p>
      <p class="text-gray-300 text-sm italic">
        [Figure 2: Construction of Hades &ndash; shows the three
        zones: first
        <span class="math">R_f</span> full rounds, middle
        <span class="math">R_P</span> partial rounds, and last
        <span class="math">R_f</span> full rounds, with the final
        matrix multiplication optionally omitted.]
      </p>

      <h3 class="text-lg font-semibold mt-6">
        Crucial Points of the HADES Strategy
      </h3>
      <p class="text-gray-300">
        In the HADES design,
        <span class="math">R_f^&#123;\text&#123;stat&#125;&#125;</span>
        rounds with full S-Box layers situated at the beginning and
        the end provide security arguments against statistical
        attacks, yielding a total of
        <span class="math">R_F^&#123;\text&#123;stat&#125;&#125; = 2 \cdot R_f^&#123;\text&#123;stat&#125;&#125;</span>
        rounds with full S-Box layers. They are sufficient to apply
        the wide trail strategy, even without the middle rounds with
        partial S-Box layers. Moreover, the choice to have the same
        number of rounds at the beginning and the end aims to
        provide the same security with respect to chosen-plaintext
        and chosen-ciphertext attacks.
      </p>
      <p class="text-gray-300">
        Security against all algebraic attacks is achieved working
        both with rounds
        <span class="math">R_F = R_F^&#123;\text&#123;stat&#125;&#125; + R_F'</span>
        with full S-Box layers and rounds
        <span class="math">R_P \geq 0</span>
        with partial S-Box layers. Even if one S-Box per round is
        potentially sufficient to increase the degree, other factors
        can have a crucial impact on the cost of an algebraic attack
        (e.g., a Grobner basis attack also depends on the number of
        non-linear equations and variables).
      </p>
      <p class="text-gray-300">
        Another crucial point regards the possibility to choose
        among several possible combinations of rounds
        <span class="math">(R_F, R_P)</span> that provide the
        <em>same</em> security level. One can potentially decrease
        (resp. increase) the number of rounds with partial S-Box
        layers and add (resp. remove) rounds with full S-Box layers
        without affecting the security level. This freedom allows to
        choose the best combination that minimizes a given cost
        metric.
      </p>
    </section>

    <!-- ============================================================ -->
    <!-- 3. THE KEYED PERMUTATION HADESMIMC                          -->
    <!-- ============================================================ -->

    <section id="sec-3" class="mb-10">
      <h2 class="text-2xl font-bold">
        3. The Keyed Permutation HadesMiMC
      </h2>
      <p class="text-gray-300">
        HadesMiMC is a construction for cryptographic permutations
        based on the strategy just proposed. It is obtained by
        applying the HADES strategy to the cipher SHARK [RDP+96]
        proposed by Rijmen et al. in 1996 and based on the wide
        trail strategy. Our design works with texts of
        <span class="math">t \geq 2</span> words in
        <span class="math">(\mathbb&#123;F&#125;_p, +, \times)</span>,
        where <span class="math">p</span> is a prime of size
        <span class="math">p \approx 2^n \geq 11</span> and where
        <span class="math">+</span> and
        <span class="math">\times</span> are the addition and
        multiplication in
        <span class="math">\mathbb&#123;F&#125;_p</span>. In the
        following,
        <span class="math">N</span> denotes
        <span class="math">N := \lceil \log_2 p \rceil \cdot t</span>.
      </p>

      <!-- 3.1 -->
      <h3 id="sec-3.1" class="text-xl font-semibold mt-8">
        3.1 Specification of HadesMiMC
      </h3>
      <p class="text-gray-300">
        Each round
        <span class="math">R_k(\cdot): (\mathbb&#123;F&#125;_p)^t \to (\mathbb&#123;F&#125;_p)^t</span>
        of HadesMiMC is defined as:
      </p>
      <div class="math-block">
        R_k(\cdot) = k + M \times \mathcal&#123;S&#125;(\cdot)
      </div>
      <p class="text-gray-300">
        where
        <span class="math">k \in (\mathbb&#123;F&#125;_p)^t</span>
        is the secret subkey,
        <span class="math">M \in (\mathbb&#123;F&#125;_p)^&#123;t \times t&#125;</span>
        is an invertible matrix that defines the linear layer,
        <span class="math">\mathcal&#123;S&#125;(\cdot)</span> is the
        S-Box layer, defined as
        <span class="math">\mathcal&#123;S&#125; = [S(\cdot), \ldots, S(\cdot)]</span>
        for rounds with full S-Box layers and as
        <span class="math">\mathcal&#123;S&#125; = [S(\cdot), I(\cdot), \ldots, I(\cdot)]</span>
        for rounds with partial S-Box layers.
      </p>
      <p class="text-gray-300">
        The number of rounds
        <span class="math">R = 2 \cdot R_f + R_P</span> depends on
        the choice of the S-Box and of the parameters
        <span class="math">p</span> and
        <span class="math">t</span>. The non-linear S-Box is defined
        as the <em>power map</em>:
      </p>
      <div class="math-block">
        \textrm&#123;S-Box&#125;(x) = x^\alpha
      </div>
      <p class="text-gray-300">
        where
        <span class="math">\alpha \geq 3</span> is the smallest
        integer such that
        <span class="math">\gcd(p - 1, \alpha) = 1</span> (e.g.,
        <span class="math">\alpha = 3</span> if
        <span class="math">\gcd(p-1, 3) = 1</span>, or
        <span class="math">\alpha = 5</span> if
        <span class="math">\gcd(p-1, 3) \neq 1</span> and
        <span class="math">\gcd(p-1, 5) = 1</span>). As in SHARK,
        the MixLayer is defined by a multiplication with a fixed
        <span class="math">t \times t</span> MDS matrix.
      </p>

      <h4 class="text-lg font-semibold mt-6">
        About the MDS Matrix
      </h4>
      <p class="text-gray-300">
        A <span class="math">t \times t</span> MDS matrix
        <span class="math">M</span> with elements in
        <span class="math">\text&#123;GF&#125;(p)</span> exists if the
        condition
        <span class="math">2t + 1 \le p</span> is satisfied. For
        our concrete instantiations, we use Cauchy matrices, and we
        note that not every Cauchy matrix provides the same level of
        security.
      </p>

      <div class="formal-block formal-block-definition">
        <div class="formal-block-title text-blue-400">
          Definition 1 (Subspace Trail)
        </div>
        <div class="formal-block-content">
          <p class="text-gray-300">
            [GRR16] Let
            <span class="math">(U_1, \ldots, U_&#123;r+1&#125;)</span>
            denote a set of
            <span class="math">r + 1</span> subspaces with
            <span class="math">\dim(U_i) \le \dim(U_&#123;i+1&#125;)</span>.
            If for each
            <span class="math">i \in \&#123;1, \ldots, r\&#125;</span>
            and for each
            <span class="math">a_i</span> there exists
            <span class="math">a_&#123;i+1&#125; \in U_&#123;i+1&#125;^c</span>
            (namely, the complementary subspace of
            <span class="math">U_&#123;i+1&#125;</span>) such that
          </p>
          <div class="math-block">
            R^&#123;(i)&#125;(\mathcal&#123;U&#125;_i + a_i) \subseteq \mathcal&#123;U&#125;_&#123;i+1&#125; + a_&#123;i+1&#125;
          </div>
          <p class="text-gray-300">
            then
            <span class="math">(\mathcal&#123;U&#125;_1, \ldots, \mathcal&#123;U&#125;_&#123;r+1&#125;)</span>
            is a <em>subspace trail</em> of length
            <span class="math">r</span>. If all the previous
            relations hold with equality, the trail is called a
            constant-dimensional subspace trail. If the subspace is
            invariant (namely,
            <span class="math">\mathcal&#123;U&#125;_i = \mathcal&#123;U&#125;_&#123;i+1&#125;</span>),
            the subspace trail is called invariant.
          </p>
        </div>
      </div>

      <p class="text-gray-300">
        We assume that the MDS matrix prevents the possibility to
        set up infinitely long subspace trails (either invariant or
        iterative and either with active S-Boxes or with inactive
        S-Boxes) for the rounds with partial S-Box layers. Hence,
        the MDS matrix must guarantee that the longest subspace
        trail with inactive S-Boxes can cover at most
        <span class="math">t - 1</span> rounds. For each
        <span class="math">i \geq 1</span>, we define
        <span class="math">\mathcal&#123;S&#125;^i</span> as:
      </p>
      <div class="math-block">
        \mathcal&#123;S&#125;^i := \&#123; x \in \mathbb&#123;F&#125;^t \mid \forall j \le i - 1 : (M^j \cdot x)[0] = 0 \in \mathbb&#123;F&#125; \&#125;
      </div>
      <p class="text-gray-300">
        where <span class="math">x[0]</span> denotes the first
        word of <span class="math">x</span> and
        <span class="math">M^j = M \cdot \cdots \cdot M</span> for
        <span class="math">j \geq 1</span> and
        <span class="math">M^0 = I</span>. It is not hard to check
        that
        <span class="math">\&#123;\mathcal&#123;S&#125;^i, M \cdot \mathcal&#123;S&#125;^i, \ldots, M^&#123;i-1&#125; \cdot \mathcal&#123;S&#125;^i\&#125;</span>
        forms a subspace trail for
        <span class="math">i</span> partial rounds with inactive
        S-Boxes.
      </p>

      <h4 class="text-lg font-semibold mt-6">
        Security Level and Key Schedule
      </h4>
      <p class="text-gray-300">
        We define two security levels, respectively
        <span class="math">\kappa = \log_2(p) \cdot t \approx N</span>
        and
        <span class="math">\kappa = \log_2(p) \approx n</span>.
      </p>
      <p class="text-gray-300">
        <strong>Case
        <span class="math">\kappa \approx N</span>:</strong> Let
        <span class="math">k \in (\mathbb&#123;F&#125;_p)^t</span> be
        the secret key. The <span class="math">i</span>-th round
        key for <span class="math">i \geq 1</span> is defined by
        a linear key schedule as:
      </p>
      <div class="math-block">
        \forall i = 1, \ldots, R: \quad k^&#123;(i)&#125; := \hat&#123;M&#125; \cdot k^&#123;(i-1)&#125; + RC^&#123;(i)&#125;
      </div>
      <p class="text-gray-300">
        where
        <span class="math">RC^&#123;(i)&#125; \neq 0</span> are random
        round constants and
        <span class="math">\hat&#123;M&#125;</span> is an MDS matrix. We
        require that
        <span class="math">\hat&#123;M&#125;^i</span> has no zero
        coefficient for
        <span class="math">1 \le i \le R</span>.
      </p>
      <p class="text-gray-300">
        <strong>Case
        <span class="math">\kappa \approx n</span> (for MPC
        Applications):</strong> Let
        <span class="math">k' \in \mathbb&#123;F&#125;_p</span> be the
        secret key. We define the subkeys as:
      </p>
      <div class="math-block">
        \forall i = 0, \ldots, R: \quad k^&#123;(i)&#125; = \underbrace&#123;[k', k', \ldots, k']&#125;_&#123;t \text&#123; times&#125;&#125; \oplus RC^&#123;(i)&#125;
      </div>

      <!-- 3.2 -->
      <h3 id="sec-3.2" class="text-xl font-semibold mt-8">
        3.2 Design Considerations: Reviving &ldquo;Old&rdquo;
        Design Ideas
      </h3>
      <p class="text-gray-300">
        <strong>Why SHARK Among Many Others?</strong> Since in our
        practical applications the cost of linear operations is much
        lower than the cost of non-linear ones, we decided to focus
        on the most efficient linear layer (from the security point
        of view), namely the one that provides the fastest diffusion
        at word level. This corresponds to a linear layer defined as
        a multiplication with an MDS matrix that involves the entire
        state, which is exactly the case for SHARK.
      </p>
      <p class="text-gray-300">
        <strong>Choosing the S-Box.</strong> The choice to consider
        a power map S-Box among many other non-linear permutations
        is motivated by the following considerations: (1) since
        there are no quadratic permutation polynomials over
        <span class="math">\mathbb&#123;F&#125;_p</span>, the cube S-Box
        requires the smallest number of non-linear operations
        (namely, two) and at the same time offers high security
        against statistical attacks; (2) an S-Box with a higher
        degree allows to reach the maximum degree faster, hence a
        smaller number of rounds is potentially sufficient to
        provide security, but the total number of non-linear
        operations does not change significantly.
      </p>
    </section>

    <!-- ============================================================ -->
    <!-- 4. SECURITY ANALYSIS                                        -->
    <!-- ============================================================ -->

    <section id="sec-4" class="mb-10">
      <h2 class="text-2xl font-bold">4. Security Analysis</h2>
      <p class="text-gray-300">
        It is paramount for a new design to present a concrete
        security analysis. We provide an in-depth analysis of the
        security of the HadesMiMC family of block ciphers. Since we
        cannot ensure that a cipher is secure against all possible
        attacks, the best option of determining its security is to
        ensure that it is secure against all known attacks.
      </p>
      <p class="text-gray-300">
        The crucial points of our security analysis are:
      </p>
      <ul class="list-disc list-inside text-gray-300 ml-4">
        <li>
          Security against statistical attacks is obtained
          exploiting the wide trail strategy by using
          <span class="math">R_F^&#123;\text&#123;stat&#125;&#125; = 2 \cdot R_f^&#123;\text&#123;stat&#125;&#125;</span>
          rounds with full S-Box layers.
        </li>
        <li>
          The combination of both rounds
          <span class="math">R_F</span> with full S-Box layers
          and/or rounds <span class="math">R_P \geq 0</span> with
          partial S-Box layers provide security against all other
          possible attacks.
        </li>
      </ul>

      <!-- 4.1 -->
      <h3 id="sec-4.1" class="text-xl font-semibold mt-8">
        4.1 Main Points of Our Cryptanalysis Results
      </h3>
      <p class="text-gray-300">
        <strong>Number of Rounds.</strong> Given the number of
        rounds of a distinguisher which is independent of the key,
        we add at least 2 rounds with full S-Box layers to prevent
        key-guessing attacks. This is motivated by the fact that it
        is not possible to skip more than a single round with a full
        S-Box layer without guessing the entire key.
      </p>
      <p class="text-gray-300">
        <strong>Statistical Attacks.</strong> Assuming
        <span class="math">p \geq (\alpha - 1)^2</span>, at least
        6 rounds with full S-Box layers are needed to protect
        HadesMiMC against all statistical attacks (differential,
        linear, truncated/impossible differential, boomerang, etc.).
        Depending on <span class="math">p</span> and
        <span class="math">t</span>, in some cases 10 rounds are
        necessary.
      </p>
      <p class="text-gray-300">
        <strong>Algebraic Attacks.</strong> Algebraic attacks exploit
        mainly the low degree of the encryption/decryption function.
      </p>
      <p class="text-gray-300">
        <em>Interpolation Attack:</em> The goal is to construct the
        polynomial that describes the function. The attack
        complexity is approximately
        <span class="math">\mathcal&#123;O&#125;(d^t)</span>, where
        <span class="math">d</span> is the degree after
        <span class="math">r</span> rounds. Since
        <span class="math">d = \alpha^r</span>,
        <span class="math">\log_\alpha(p) + \log_\alpha(t)</span>
        rounds with partial S-Box layers are necessary.
      </p>
      <p class="text-gray-300">
        <em>Grobner Basis Attack:</em> One tries to solve a system
        of non-linear equations that describe the cipher. The cost
        depends on the degree of the equations, but also on the
        number of equations and variables. When working with rounds
        with full S-Box layers, the attack complexity is
        approximately
        <span class="math">\mathcal&#123;O&#125;((d/t)^t)</span>.
      </p>
      <p class="text-gray-300">
        <em>Higher-Order Differential Attack:</em> This exploits the
        property that given a function of algebraic degree
        <span class="math">\delta</span>, the sum over all elements
        of a subspace of dimension
        <span class="math">\geq \delta + 1</span> is zero. Since
        the only subspaces of
        <span class="math">\mathbb&#123;F&#125;_p</span> are
        <span class="math">\&#123;0\&#125;</span> and
        <span class="math">\mathbb&#123;F&#125;_p</span>, this attack is
        less powerful in
        <span class="math">\mathbb&#123;F&#125;_p^t</span> than over
        binary fields.
      </p>

      <!-- 4.2 -->
      <h3 id="sec-4.2" class="text-xl font-semibold mt-8">
        4.2 Statistical Attacks &ndash; Security Level:
        <span class="math">\kappa = N</span>
      </h3>
      <p class="text-gray-300">
        <strong>Differential Cryptanalysis.</strong> The differential
        probability of the power function
        <span class="math">f(x) = x^\alpha</span> is bounded above
        by
        <span class="math">(\alpha - 1)/|\mathbb&#123;F&#125;_p| = (\alpha - 1)/p</span>.
        We compute the minimum number of rounds with full S-Box
        layers that guarantee each characteristic has probability at
        most
        <span class="math">p^&#123;-2t&#125; \approx 2^&#123;-2N&#125;</span>.
        We consider a &ldquo;weaker&rdquo; cipher:
      </p>
      <div class="math-block">
        R^&#123;R_f&#125; \circ L \circ R^&#123;R_f&#125;(\cdot)
      </div>
      <p class="text-gray-300">
        where <span class="math">L</span> is an invertible linear
        layer and <span class="math">R(\cdot)</span> is a round with
        a full S-Box layer. We show that this weaker cipher is
        secure against differential cryptanalysis for:
      </p>
      <div class="math-block">
        R_F^&#123;\text&#123;stat&#125;&#125; = \begin&#123;cases&#125; 6 & \text&#123;if &#125; p \geq (\alpha - 1)^&#123;t+1&#125; \\ 10 & \text&#123;otherwise&#125; \end&#123;cases&#125;
      </div>
      <p class="text-gray-300">
        The minimum number of active S-Boxes of the weaker cipher
        <span class="math">R^&#123;r'&#125; \circ L \circ R^r(\cdot)</span>
        is at least:
      </p>
      <div class="math-block">
        (\lfloor r'/2 \rfloor + \lfloor r/2 \rfloor) \times (t + 1) + (r' \bmod 2) + (r \bmod 2)
      </div>
      <p class="text-gray-300">
        A detailed security analysis against other statistical
        attacks (linear, truncated and impossible differential,
        meet-in-the-middle, integral, boomerang, multiple-of-n,
        mixture differential, invariant subspace, and biclique
        cryptanalysis) is provided in Appendix D. All these attacks
        do not outperform the differential attack.
      </p>

      <!-- 4.3 -->
      <h3 id="sec-4.3" class="text-xl font-semibold mt-8">
        4.3 Algebraic Attacks &ndash; Security Level:
        <span class="math">\kappa = N</span>
      </h3>
      <p class="text-gray-300">
        <strong>Interpolation Attack.</strong> Considering
        HadesMiMC, the degree of each word after
        <span class="math">r</span> rounds is roughly approximated
        by <span class="math">\alpha^r</span>. A rough estimation
        for the number of monomials of the interpolation polynomial
        (and so of the attack complexity) is given by
        <span class="math">(\alpha^&#123;r-1&#125; + 1)^t \geq \alpha^&#123;(r-1) \cdot t&#125;</span>.
        The total number of rounds <span class="math">R</span>
        must satisfy:
      </p>
      <div class="math-block">
        R = R_P + R_F \geq R^&#123;\text&#123;inter&#125;&#125;(N, t) \equiv 5 + \lceil \log_\alpha(p) \rceil + \lceil \log_\alpha(t) \rceil
      </div>

      <p class="text-gray-300">
        <strong>Grobner Basis Attack.</strong> We provide three
        different strategies:
      </p>
      <p class="text-gray-300">
        <em>First Strategy:</em> Using
        <span class="math">t</span> variables and
        <span class="math">t</span> equations per pair, the
        required number of rounds satisfies:
      </p>
      <div class="math-block">
        R \geq \lceil \log_\alpha(p)/2 \rceil + \lceil \log_\alpha(t) \rceil + 2
      </div>

      <p class="text-gray-300">
        <em>Second Strategy:</em> Adding intermediate variables in
        each round. For rounds with a partial S-Box layer, only one
        intermediate variable is needed. The condition becomes:
      </p>
      <div class="math-block">
        R_F \cdot t + R_P \geq \left\lceil \frac&#123;N&#125;&#123;2 \cdot \log_2(\alpha^\alpha / (\alpha - 1)^&#123;\alpha - 1&#125;)&#125; \right\rceil + \left\lceil \frac&#123;t&#125;&#123;2&#125; \right\rceil + 1
      </div>

      <p class="text-gray-300">
        <em>Third Strategy:</em> A combination of the previous two.
        Using
        <span class="math">2t</span> variables for full rounds and
        adding intermediate variables for partial rounds gives the
        condition:
      </p>
      <div class="math-block">
        R_F \geq 2 + \left\lceil \log_\alpha(2) \cdot \left(\frac&#123;N&#125;&#123;2t + R_P&#125; + 2 \cdot \log_2(t + R_P) - 2 \cdot \log_2(t)\right) \right\rceil
      </div>

      <p class="text-gray-300">
        <strong>Conclusion.</strong> HadesMiMC can be considered
        secure against Grobner basis attacks if
        <span class="math">R_F</span> and
        <span class="math">R_P</span> satisfy all three conditions
        simultaneously.
      </p>

      <p class="text-gray-300">
        <strong>Higher-Order Differential Attack.</strong> Since the
        only subspaces of
        <span class="math">\mathbb&#123;F&#125;_p</span> are
        <span class="math">\&#123;0\&#125;</span> and
        <span class="math">\mathbb&#123;F&#125;_p</span>, the biggest
        subspace of
        <span class="math">(\mathbb&#123;F&#125;_p)^t</span> has
        dimension <span class="math">t</span>, in contrast to the
        biggest subspace of
        <span class="math">(\mathbb&#123;F&#125;_&#123;2^n&#125;)^t</span>
        which has dimension
        <span class="math">n \cdot t = N</span>. The number of
        rounds necessary to guarantee security against the
        interpolation attack provides security against this attack
        as well.
      </p>
    </section>

    <!-- ============================================================ -->
    <!-- 5. SECURITY ANALYSIS FOR MPC                                -->
    <!-- ============================================================ -->

    <section id="sec-5" class="mb-10">
      <h2 class="text-2xl font-bold">
        5. Security Analysis for MPC:
        <span class="math">\kappa = n</span> and Data
        <span class="math">\leq p^&#123;1/2&#125;</span>
      </h2>
      <p class="text-gray-300">
        In this section, we adjust our security arguments to provide
        a security level of only
        <span class="math">\log_2(p) \approx n</span> bits (instead
        of <span class="math">N</span> bits). At the same time, we
        only allow an attacker to use
        <span class="math">p^&#123;1/2&#125;</span> data.
      </p>

      <!-- 5.1 -->
      <h3 id="sec-5.1" class="text-xl font-semibold mt-8">
        5.1 Statistical Attacks
      </h3>
      <p class="text-gray-300">
        <strong>Differential Attack.</strong> We assume the cipher
        is secure if every characteristic has probability smaller
        than
        <span class="math">p^&#123;-2&#125;</span>. Working with the
        weaker cipher, it follows that
        <span class="math">R_f = 2</span> rounds with full S-Box
        layers are sufficient. However, since
        <span class="math">R_F = 2</span> full rounds would not
        lead to 2 consecutive full rounds in our design, we add
        additional rounds. Finally, we add two more rounds to
        prevent differential attacks with key guessing and conclude
        that
        <span class="math">R_F \geq R_F^&#123;\text&#123;stat&#125;&#125; = 6</span>
        rounds are needed.
      </p>

      <!-- 5.2 -->
      <h3 id="sec-5.2" class="text-xl font-semibold mt-8">
        5.2 Algebraic Attacks
      </h3>
      <p class="text-gray-300">
        <strong>Interpolation Attack.</strong> By choosing plaintexts
        with just one active word, the interpolation polynomial
        depends on a single variable. Since the data complexity is
        limited to
        <span class="math">\sqrt&#123;p&#125;</span>, we require:
      </p>
      <div class="math-block">
        R_F + R_P \geq R^&#123;\text&#123;inter&#125;&#125;(p, t) \equiv 4 + \left\lceil \frac&#123;\log_\alpha(p)&#125;&#123;2&#125; \right\rceil + \lceil \log_\alpha(t) \rceil
      </div>

      <p class="text-gray-300">
        <strong>GCD and Grobner Basis Attack.</strong> The cost of
        the GCD computation is approximated by
        <span class="math">\mathcal&#123;O&#125;(d \log_2^2 d)</span>,
        where <span class="math">d \approx \alpha^&#123;r-1&#125;</span>.
        The total number of rounds must satisfy:
      </p>
      <div class="math-block">
        R_F + R_P \geq R^&#123;\text&#123;GCD&#125;&#125;(p, t) \equiv 4 + \lceil \log_\alpha(p) \rceil - \lfloor 2 \log_\alpha(\log_2(p)) \rfloor
      </div>
    </section>

    <!-- ============================================================ -->
    <!-- 6. NUMBER OF ROUNDS: SECURITY AND EFFICIENCY                -->
    <!-- ============================================================ -->

    <section id="sec-6" class="mb-10">
      <h2 class="text-2xl font-bold">
        6. Number of Rounds: Security and Efficiency
      </h2>
      <p class="text-gray-300">
        The design goal of HadesMiMC is to offer a cipher optimized
        for schemes whose performance critically depends on the
        MULTdepth/ANDdepth, the number of MULTs/ANDs, or the number
        of MULTs/ANDs per bit.
      </p>
      <p class="text-gray-300">
        <strong>Security.</strong> HadesMiMC with security level
        <span class="math">\kappa = N</span> is secure iff:
      </p>
      <div class="math-block">
        \begin&#123;cases&#125;
        R_F \geq \max\&#123; R_F^&#123;\text&#123;stat&#125;&#125;;\; R^&#123;\text&#123;3rd-Grob&#125;&#125;(p, t, R_P) \&#125; \\
        R_P + R_F \geq \Psi^&#123;(1)&#125;(p,t) = R^&#123;\text&#123;inter&#125;&#125;(p,t) \\
        R_P + t \cdot R_F \geq \Psi^&#123;(t)&#125;(p,t) = R^&#123;\text&#123;2nd-Grob&#125;&#125;(p,t)
        \end&#123;cases&#125;
      </div>
      <p class="text-gray-300">
        <strong>Several Combinations of
        <span class="math">(R_F, R_P)</span> for the Same Security
        Level.</strong> One of the strengths of our design is the
        freedom to choose the ratio between
        <span class="math">R_F</span> and
        <span class="math">R_P</span> without affecting the security
        level. For each given
        <span class="math">p</span> and
        <span class="math">t</span>, the designer has the freedom to
        choose among several combinations that guarantee the same
        security in order to minimize the cost metric.
      </p>

      <!-- 6.1 -->
      <h3 id="sec-6.1" class="text-xl font-semibold mt-8">
        6.1 Efficiency in the Case of MPC Applications
      </h3>
      <p class="text-gray-300">
        Consider a generic scenario where the main goal is to
        minimize the total number of non-linear operations and/or
        the depth. The metric is given by:
      </p>
      <div class="math-block">
        \gamma \times (\text&#123;number of S-Boxes&#125;) + (1 - \gamma) \times (\text&#123;depth&#125;) = R_F \times [1 + \gamma \cdot (t - 1)] + R_P
      </div>
      <p class="text-gray-300">
        for different values of a parameter
        <span class="math">\gamma</span>, where
        <span class="math">0 \leq \gamma \leq 1</span>. Note that
        <span class="math">\gamma = 1</span> and
        <span class="math">\gamma = 0</span> correspond to
        minimizing the total number of S-Boxes and the depth,
        respectively.
      </p>

      <!-- 6.2 -->
      <h3 id="sec-6.2" class="text-xl font-semibold mt-8">
        6.2 Best Ratio Between
        <span class="math">R_F</span> and
        <span class="math">R_P</span> &ndash; MPC Application
      </h3>
      <p class="text-gray-300">
        <strong>Security.</strong> HadesMiMC with
        <span class="math">\kappa = n</span> is secure if:
      </p>
      <div class="math-block">
        \begin&#123;cases&#125;
        R_F \geq R_F^&#123;\text&#123;stat&#125;&#125; \\
        R_P + R_F \geq \Psi(p, t) \equiv \max\&#123;R^&#123;\text&#123;GCD&#125;&#125;(p,t);\; R^&#123;\text&#123;inter&#125;&#125;(p,t)\&#125;
        \end&#123;cases&#125;
      </div>
      <p class="text-gray-300">
        <strong>Efficiency &ndash; Best Combination
        <span class="math">(R_F, R_P)</span>.</strong> For each
        <span class="math">\gamma</span>, the cost metric is always
        minimized by choosing the smallest possible
        <span class="math">R_F</span> (namely,
        <span class="math">R_F = R_F^&#123;\text&#123;stat&#125;&#125;</span>).
      </p>

      <!-- 6.3 -->
      <h3 id="sec-6.3" class="text-xl font-semibold mt-8">
        6.3 Concrete Round Numbers of HadesMiMC
      </h3>
      <p class="text-gray-300">
        Based on the security analysis, we present some example
        round numbers of HadesMiMC for different security levels
        and/or applications, using
        <span class="math">\alpha = 3</span> (the cube S-Box):
      </p>
      <div class="overflow-x-auto my-4">
        <table class="w-full text-sm">
          <thead>
            <tr class="border-b border-gray-700 text-left">
              <th class="py-2 pr-4">Text Size
                <span class="math">\log_2(p) \times t</span></th>
              <th class="py-2 pr-4">Security
                <span class="math">\kappa</span></th>
              <th class="py-2 pr-4">S-Box Size
                <span class="math">(\log_2 p)</span></th>
              <th class="py-2 pr-4"><span class="math">t</span></th>
              <th class="py-2 pr-4">
                <span class="math">R_F</span></th>
              <th class="py-2 pr-4">
                <span class="math">R_P</span></th>
            </tr>
          </thead>
          <tbody class="text-gray-300">
            <tr class="border-b border-gray-800">
              <td class="py-2 pr-4">128</td>
              <td class="py-2 pr-4">128</td>
              <td class="py-2 pr-4">8</td>
              <td class="py-2 pr-4">16</td>
              <td class="py-2 pr-4">10</td>
              <td class="py-2 pr-4">4</td>
            </tr>
            <tr class="border-b border-gray-800">
              <td class="py-2 pr-4">128</td>
              <td class="py-2 pr-4">128</td>
              <td class="py-2 pr-4">16</td>
              <td class="py-2 pr-4">8</td>
              <td class="py-2 pr-4">8</td>
              <td class="py-2 pr-4">10</td>
            </tr>
            <tr class="border-b border-gray-800">
              <td class="py-2 pr-4">256</td>
              <td class="py-2 pr-4">128</td>
              <td class="py-2 pr-4">128</td>
              <td class="py-2 pr-4">2</td>
              <td class="py-2 pr-4">6</td>
              <td class="py-2 pr-4">71</td>
            </tr>
            <tr class="border-b border-gray-800">
              <td class="py-2 pr-4">256</td>
              <td class="py-2 pr-4">256</td>
              <td class="py-2 pr-4">128</td>
              <td class="py-2 pr-4">2</td>
              <td class="py-2 pr-4">12</td>
              <td class="py-2 pr-4">76</td>
            </tr>
            <tr class="border-b border-gray-800">
              <td class="py-2 pr-4">512</td>
              <td class="py-2 pr-4">128</td>
              <td class="py-2 pr-4">128</td>
              <td class="py-2 pr-4">4</td>
              <td class="py-2 pr-4">6</td>
              <td class="py-2 pr-4">71</td>
            </tr>
            <tr class="border-b border-gray-800">
              <td class="py-2 pr-4">1024</td>
              <td class="py-2 pr-4">128</td>
              <td class="py-2 pr-4">128</td>
              <td class="py-2 pr-4">8</td>
              <td class="py-2 pr-4">6</td>
              <td class="py-2 pr-4">71</td>
            </tr>
            <tr class="border-b border-gray-800">
              <td class="py-2 pr-4">32</td>
              <td class="py-2 pr-4">32</td>
              <td class="py-2 pr-4">8</td>
              <td class="py-2 pr-4">4</td>
              <td class="py-2 pr-4">6</td>
              <td class="py-2 pr-4">7</td>
            </tr>
          </tbody>
        </table>
      </div>
      <p class="text-gray-300 text-sm">
        Table 1: A range of different parameter sets for HadesMiMC
        (based on the cube S-Box,
        <span class="math">\alpha = 3</span>) offering different
        trade-offs. The security level
        <span class="math">\kappa = \log_2(p)</span> case provides
        security only if the data used for the attack is smaller
        than
        <span class="math">p^&#123;1/2&#125;</span>.
      </p>
      <p class="text-gray-300">
        <strong>Reduced and Toy Versions.</strong> In order to
        facilitate third-party cryptanalysis and estimate the
        security margin, reduced-round variants need to be
        considered. We encourage studying reduced-round variants
        where the symmetry around the middle is kept.
      </p>
    </section>

    <!-- ============================================================ -->
    <!-- 7. MPC APPLICATIONS                                         -->
    <!-- ============================================================ -->

    <section id="sec-7" class="mb-10">
      <h2 class="text-2xl font-bold">7. MPC Applications</h2>
      <p class="text-gray-300">
        For MPC applications, we evaluated the HadesMiMC cipher
        (based on the cube S-Box) using the SPDZ framework [KSS13]
        within a prime field
        <span class="math">\mathbb&#123;F&#125;_p</span>.
      </p>
      <p class="text-gray-300">
        <strong>Preliminaries.</strong> In the following, we denote
        by <span class="math">[x]</span> a sharing of
        <span class="math">x</span>. The process of parties
        reconstructing <span class="math">x</span> is called an
        <em>opening</em>. A protocol is split into two steps: an
        input-independent preprocessing phase where parties generate
        random Beaver triples
        <span class="math">[a] = [b] \cdot [c]</span>, and an
        input-dependent online phase where parties share their
        inputs and use the triples.
      </p>
      <p class="text-gray-300">
        To evaluate a block cipher in this setting, both the key
        <span class="math">[k]</span> and the message
        <span class="math">[m]</span> are secretly shared. To
        compute the S-Box, the trivial way is to perform
        <span class="math">[x^2] \leftarrow [x] \cdot [x]</span>
        and then
        <span class="math">[x^3] \leftarrow [x^2] \cdot [x]</span>
        using two triples.
      </p>
      <p class="text-gray-300">
        <strong>Experiment Results.</strong> Our design is better in
        all metrics for
        <span class="math">t = 2</span> compared to all other block
        ciphers. In terms of runtime throughput, HadesMiMC
        outperforms all existing work from
        <span class="math">t = 2</span> and the gap increases by a
        factor of four for <span class="math">t = 64</span> when
        comparing with <span class="math">\text&#123;GMiMC&#125;_&#123;\text&#123;erf&#125;&#125;</span>.
      </p>
      <div class="overflow-x-auto my-4">
        <table class="w-full text-sm">
          <thead>
            <tr class="border-b border-gray-700 text-left">
              <th class="py-2 pr-4">Cipher</th>
              <th class="py-2 pr-4">Text Size</th>
              <th class="py-2 pr-4">MPC Rounds</th>
              <th class="py-2 pr-4">Online Lat. (ms)</th>
              <th class="py-2 pr-4">Runtime
                <span class="math">\mathbb&#123;F&#125;_p</span>/s</th>
            </tr>
          </thead>
          <tbody class="text-gray-300">
            <tr class="border-b border-gray-800">
              <td class="py-2 pr-4">Rescue</td>
              <td class="py-2 pr-4">256</td>
              <td class="py-2 pr-4">98</td>
              <td class="py-2 pr-4">5.54</td>
              <td class="py-2 pr-4">70</td>
            </tr>
            <tr class="border-b border-gray-800">
              <td class="py-2 pr-4">MiMC</td>
              <td class="py-2 pr-4">256</td>
              <td class="py-2 pr-4">73</td>
              <td class="py-2 pr-4">3.53</td>
              <td class="py-2 pr-4">192</td>
            </tr>
            <tr class="border-b border-gray-800">
              <td class="py-2 pr-4"><span class="math">\text&#123;GMiMC&#125;_&#123;\text&#123;erf&#125;&#125;</span></td>
              <td class="py-2 pr-4">256</td>
              <td class="py-2 pr-4">146</td>
              <td class="py-2 pr-4">7.50</td>
              <td class="py-2 pr-4">137</td>
            </tr>
            <tr class="border-b border-gray-800">
              <td class="py-2 pr-4">HadesMiMC</td>
              <td class="py-2 pr-4">256</td>
              <td class="py-2 pr-4">78</td>
              <td class="py-2 pr-4">3.85</td>
              <td class="py-2 pr-4">261</td>
            </tr>
            <tr class="border-b border-gray-800">
              <td class="py-2 pr-4">Rescue</td>
              <td class="py-2 pr-4">1024</td>
              <td class="py-2 pr-4">32</td>
              <td class="py-2 pr-4">0.59</td>
              <td class="py-2 pr-4">137</td>
            </tr>
            <tr class="border-b border-gray-800">
              <td class="py-2 pr-4">MiMC</td>
              <td class="py-2 pr-4">1024</td>
              <td class="py-2 pr-4">73</td>
              <td class="py-2 pr-4">1.08</td>
              <td class="py-2 pr-4">192</td>
            </tr>
            <tr class="border-b border-gray-800">
              <td class="py-2 pr-4"><span class="math">\text&#123;GMiMC&#125;_&#123;\text&#123;erf&#125;&#125;</span></td>
              <td class="py-2 pr-4">1024</td>
              <td class="py-2 pr-4">158</td>
              <td class="py-2 pr-4">1.98</td>
              <td class="py-2 pr-4">271</td>
            </tr>
            <tr class="border-b border-gray-800">
              <td class="py-2 pr-4">HadesMiMC</td>
              <td class="py-2 pr-4">1024</td>
              <td class="py-2 pr-4">78</td>
              <td class="py-2 pr-4">0.98</td>
              <td class="py-2 pr-4">1045</td>
            </tr>
            <tr class="border-b border-gray-800">
              <td class="py-2 pr-4">Rescue</td>
              <td class="py-2 pr-4">8192</td>
              <td class="py-2 pr-4">32</td>
              <td class="py-2 pr-4">0.31</td>
              <td class="py-2 pr-4">283</td>
            </tr>
            <tr class="border-b border-gray-800">
              <td class="py-2 pr-4">MiMC</td>
              <td class="py-2 pr-4">8192</td>
              <td class="py-2 pr-4">73</td>
              <td class="py-2 pr-4">0.20</td>
              <td class="py-2 pr-4">192</td>
            </tr>
            <tr class="border-b border-gray-800">
              <td class="py-2 pr-4"><span class="math">\text&#123;GMiMC&#125;_&#123;\text&#123;erf&#125;&#125;</span></td>
              <td class="py-2 pr-4">8192</td>
              <td class="py-2 pr-4">323</td>
              <td class="py-2 pr-4">0.50</td>
              <td class="py-2 pr-4">550</td>
            </tr>
            <tr class="border-b border-gray-800">
              <td class="py-2 pr-4">HadesMiMC</td>
              <td class="py-2 pr-4">8192</td>
              <td class="py-2 pr-4">78</td>
              <td class="py-2 pr-4">0.11</td>
              <td class="py-2 pr-4">2189</td>
            </tr>
          </tbody>
        </table>
      </div>
      <p class="text-gray-300 text-sm">
        Table 2 (excerpt): Two-party costs for Rescue,
        <span class="math">\text&#123;MiMC&#125;^t</span>, <span class="math">\text&#123;GMiMC&#125;_&#123;\text&#123;erf&#125;&#125;</span> and HadesMiMC over a
        10Gb/s LAN. Runtime column represents the entire protocol
        execution, including preprocessing.
      </p>
    </section>

    <!-- ============================================================ -->
    <!-- 8. CONCLUDING REMARKS                                       -->
    <!-- ============================================================ -->

    <section id="sec-8" class="mb-10">
      <h2 class="text-2xl font-bold">
        8. Concluding Remarks: Possible Variants for Future Works
      </h2>
      <p class="text-gray-300">
        In this paper, we proposed the HADES design strategy, based
        on the idea of mixing rounds with full S-Box layers and
        partial S-Box layers in an SPN scheme with the goal to
        achieve security and at the same time good performance in
        all applications where the cost is proportional to the
        number of non-linear operations. As a concrete cipher, we
        proposed HadesMiMC, obtained by applying the HADES strategy
        to (a modified version of) the block cipher SHARK defined
        over
        <span class="math">\mathbb&#123;F&#125;_p^t</span> for a prime
        <span class="math">p</span>.
      </p>
      <p class="text-gray-300">
        As future work, it could be interesting to define ciphers
        based on the HADES strategy over
        <span class="math">\mathbb&#123;F&#125;_&#123;2^n&#125;^t</span> or over
        <span class="math">\mathbb&#123;F&#125;_&#123;p^n&#125;^t</span>. We
        also point out that it is possible to define cryptographic
        key-less permutations using the strategy proposed here (it
        is sufficient to take HadesMiMC and fix the key to some
        public value).
      </p>
      <p class="text-gray-300">
        <strong>Acknowledgements.</strong> The authors thank the
        anonymous reviewers for their valuable comments and
        suggestions. L. Grassi has been supported by IOV42.
        D. Rotaru has been supported in part by DARPA and SSC
        Pacific under contract No. N66001-15-C-4070, by ODNI/IARPA
        via Contract No. 2019-1902070006 and by the CyberSecurity
        Research Flanders with reference number VR20192203.
      </p>
    </section>

    <!-- ============================================================ -->
    <!-- APPENDIX A: CONCRETE INSTANTIATIONS                         -->
    <!-- ============================================================ -->

    <section id="app-a" class="mb-10">
      <h2 class="text-2xl font-bold">
        Appendix A: Concrete Instantiations
      </h2>
      <p class="text-gray-300">
        Here we specify how we generate pseudo-random bits, the
        round constants, and the MDS matrices for the linear layer.
        All values are given in hexadecimal notation. The MDS
        matrices are Cauchy matrices.
      </p>
      <p class="text-gray-300">
        <strong>Pseudo-Random Number Generator.</strong> All
        pseudo-random numbers are generated using the Grain LFSR
        [HJM07] in a self-shrinking mode:
      </p>
      <ol class="list-decimal list-inside text-gray-300 ml-4">
        <li>
          Initialize the state with 80 bits
          <span class="math">b_0, b_1, \ldots, b_&#123;79&#125;</span>:
          <span class="math">b_0, b_1</span> are fixed to
          <span class="math">0\text&#123;x&#125;1</span>;
          <span class="math">b_i</span> for
          <span class="math">6 \leq i \leq 17</span> are the
          binary representation of
          <span class="math">n</span>;
          <span class="math">b_i</span> for
          <span class="math">18 \leq i \leq 29</span> are the
          binary representation of
          <span class="math">t</span>;
          <span class="math">b_i</span> for
          <span class="math">30 \leq i \leq 39</span> represent
          <span class="math">R_F</span>;
          <span class="math">b_i</span> for
          <span class="math">40 \leq i \leq 49</span> represent
          <span class="math">R_P</span>;
          <span class="math">b_i</span> for
          <span class="math">50 \leq i \leq 79</span> are set to 1.
        </li>
        <li>
          Update bits using
          <span class="math">b_&#123;i+80&#125; = b_&#123;i+62&#125; \oplus b_&#123;i+51&#125; \oplus b_&#123;i+38&#125; \oplus b_&#123;i+23&#125; \oplus b_&#123;i+13&#125; \oplus b_i</span>.
        </li>
        <li>Discard the first 160 bits.</li>
        <li>
          Evaluate bits in pairs: If the first bit is 1, output the
          second bit. If it is 0, discard the second bit.
        </li>
      </ol>
      <p class="text-gray-300">
        <strong>Round Constants.</strong> Simply use the
        pseudo-random number generator. All numbers are generated
        starting from the most significant bit.
      </p>
      <p class="text-gray-300">
        <strong>MDS Matrices.</strong> All MDS matrices are Cauchy
        matrices, generated using the algorithms in [GRS20]. The
        method is: (1) randomly select pairwise distinct
        <span class="math">\&#123;x_i\&#125;_&#123;i=1&#125;^t</span> and
        <span class="math">\&#123;y_i\&#125;_&#123;i=1&#125;^t</span> where
        <span class="math">x_i + y_j \neq 0</span>;
        (2) determine if the matrix is secure using the tools in
        [GRS20]; (3) repeat until a secure matrix is found.
      </p>
    </section>

    <!-- ============================================================ -->
    <!-- APPENDIX B: MDS MATRIX CONSTRUCTION                         -->
    <!-- ============================================================ -->

    <section id="app-b" class="mb-10">
      <h2 class="text-2xl font-bold">
        Appendix B: MDS Matrix Construction
      </h2>
      <p class="text-gray-300">
        Here we recall several ways to construct an MDS matrix.
      </p>
      <p class="text-gray-300">
        <strong>Cauchy Matrix [YMT97].</strong> Let
        <span class="math">x_i, y_i \in \mathbb&#123;F&#125;_p</span>
        for <span class="math">i = 1, \ldots, t</span> such that
        <span class="math">x_i \neq x_j</span>,
        <span class="math">y_i \neq y_j</span> for
        <span class="math">i \neq j</span> and
        <span class="math">x_i + y_j \neq 0</span>. Let
        <span class="math">A</span> be the Cauchy matrix defined by:
      </p>
      <div class="math-block">
        a_&#123;i,j&#125; = \frac&#123;1&#125;&#123;x_i + y_j&#125;
      </div>
      <p class="text-gray-300">
        It follows that <span class="math">A</span> is MDS.
      </p>
      <p class="text-gray-300">
        <strong>Sequential Matrix [60,61].</strong> Let
        <span class="math">\beta</span> be a generator for
        <span class="math">\mathbb&#123;F&#125;_p</span>. Define the
        companion matrix <span class="math">S</span> from the
        generator polynomial and let
        <span class="math">A = S^t</span>. It is possible to prove
        that <span class="math">A</span> is an MDS matrix.
      </p>
      <p class="text-gray-300">
        <strong>Vandermonde Matrix [LF04].</strong> Let
        <span class="math">A</span> and <span class="math">B</span>
        be two Vandermonde matrices with
        <span class="math">a_i \neq b_j</span>. Then
        <span class="math">M = A \times B^&#123;-1&#125;</span> is an
        MDS matrix.
      </p>
    </section>

    <!-- ============================================================ -->
    <!-- APPENDIX C: EFFICIENT IMPLEMENTATION                        -->
    <!-- ============================================================ -->

    <section id="app-c" class="mb-10">
      <h2 class="text-2xl font-bold">
        Appendix C: Efficient Implementation
      </h2>
      <p class="text-gray-300">
        Like for LowMC, the fact that the non-linear layer is
        partial in
        <span class="math">R_P</span> rounds can be used to reduce
        the amount of operations required in each of these rounds.
      </p>
      <p class="text-gray-300">
        <strong>Round Constants.</strong> In the description of an
        SPN, it is possible to swap the order of the linear layer
        and the round key addition as both operations are linear.
        Working in this way for all round keys, we end up with an
        equivalent representation in which round keys are only
        added to the output of the S-Boxes apart from one whitening
        key. The optimized representation only requires
        <span class="math">t \cdot \log_2 p \cdot (R_F + 1) + \log_2 p \cdot R_P</span>,
        potentially greatly reducing the amount of needed memory.
      </p>
      <p class="text-gray-300">
        <strong>Linear Layer.</strong> Focusing on rounds with a
        single S-Box, let <span class="math">M</span> be the
        <span class="math">t \times t</span> MDS matrix. We can
        decompose it as:
      </p>
      <div class="math-block">
        M = \underbrace&#123;\begin&#123;bmatrix&#125; 1 & 0 \\ 0 & \hat&#123;M&#125; \end&#123;bmatrix&#125;&#125;_&#123;M'&#125; \times \underbrace&#123;\begin&#123;bmatrix&#125; M_&#123;0,0&#125; & v \\ \hat&#123;w&#125; & I \end&#123;bmatrix&#125;&#125;_&#123;M''&#125;
      </div>
      <p class="text-gray-300">
        where <span class="math">\hat&#123;M&#125;</span> is a
        <span class="math">(t-1) \times (t-1)</span> MDS matrix,
        <span class="math">\hat&#123;w&#125; = \hat&#123;M&#125;^&#123;-1&#125; \times w</span>,
        and <span class="math">I</span> is the identity matrix.
        Each linear part in the
        <span class="math">R_P</span> rounds is then defined by a
        multiplication with the sparse matrix
        <span class="math">M''</span>.
      </p>
    </section>

    <!-- ============================================================ -->
    <!-- APPENDIX D: STATISTICAL ATTACKS DETAILS                     -->
    <!-- ============================================================ -->

    <section id="app-d" class="mb-10">
      <h2 class="text-2xl font-bold">
        Appendix D: Statistical Attacks on HadesMiMC &ndash;
        Details
      </h2>

      <h3 class="text-xl font-semibold mt-6">
        D.1 Linear Cryptanalysis
      </h3>
      <p class="text-gray-300">
        Similar to differential attacks, linear attacks [Mat93] pose
        no threat to the HadesMiMC family instantiated with the
        same number of rounds previously defined for classical
        differential cryptanalysis. The maximum square correlation
        of the cubic function is limited to
        <span class="math">2/p</span>, offering one of the best
        possible resistances against linear cryptanalysis.
      </p>

      <h3 class="text-xl font-semibold mt-6">
        D.2 Truncated Differentials
      </h3>
      <p class="text-gray-300">
        Working on the &ldquo;weaker&rdquo; cipher and focusing on
        active/passive bytes, there exist several differentials
        with probability 1 for at most 1 round. Due to the next
        S-Box layer, no probability-one truncated differential
        covers more than a single round. We conjecture that 4
        rounds with full S-Box layers are secure against truncated
        differential attacks, and 6 rounds with full S-Box layers
        including key-guessing protection.
      </p>

      <h3 class="text-xl font-semibold mt-6">
        D.3 Differential Meet-in-the-Middle Attack
      </h3>
      <p class="text-gray-300">
        Due to the classical and truncated differential analysis
        (together with the fact that 1-round HadesMiMC provides
        full diffusion), we argue that the number of rounds
        sufficient for differential security is also sufficient
        against MitM attacks.
      </p>

      <h3 class="text-xl font-semibold mt-6">
        D.4 Impossible Differential
      </h3>
      <p class="text-gray-300">
        The longest impossible differential (independent of S-Box
        details) only spans 2 rounds. As a result, 6 rounds with
        full S-Box layers make HadesMiMC secure against this
        attack.
      </p>

      <h3 class="text-xl font-semibold mt-6">
        D.5 Boomerang Attack
      </h3>
      <p class="text-gray-300">
        Exploiting the analysis proposed before, 6 rounds with
        full S-Boxes are sufficient to ensure that no good
        boomerang exists.
      </p>

      <h3 class="text-xl font-semibold mt-6">
        D.6 Multiple-of-n and Mixture Differential Cryptanalysis
      </h3>
      <p class="text-gray-300">
        Regarding HadesMiMC, it is possible to set up such
        distinguishers on 2 rounds only. As a result, 6 rounds
        with full S-Box layers make HadesMiMC secure against
        these attacks.
      </p>

      <h3 class="text-xl font-semibold mt-6">
        D.7 Invariant Subspace Attack
      </h3>
      <p class="text-gray-300">
        For rounds with full S-Box layers, random round constants
        provide good protection. For rounds with partial S-Box
        layers, it is always possible to construct a subspace trail
        for at most <span class="math">t - 1</span> rounds. Due to
        the assumption on the MDS matrix, it is not possible to
        cover more than <span class="math">t - 1</span> rounds.
      </p>

      <h3 class="text-xl font-semibold mt-6">
        D.8 Integral/Square Attack
      </h3>
      <p class="text-gray-300">
        It is possible to set up an integral distinguisher over two
        rounds of HadesMiMC. As a result, 6 rounds with full S-Box
        layers make HadesMiMC secure against this attack.
      </p>

      <h3 class="text-xl font-semibold mt-6">
        D.9 Biclique Cryptanalysis
      </h3>
      <p class="text-gray-300">
        Since we do not think that improving the exhaustive search
        by a small factor will turn into a serious vulnerability,
        HadesMiMC is not designed to resist biclique cryptanalysis
        with small improvement.
      </p>
    </section>

    <!-- ============================================================ -->
    <!-- APPENDIX E: ALGEBRAIC ATTACKS DETAILS                       -->
    <!-- ============================================================ -->

    <section id="app-e" class="mb-10">
      <h2 class="text-2xl font-bold">
        Appendix E: Algebraic Attacks &ndash; Details
      </h2>

      <h3 class="text-xl font-semibold mt-6">
        E.1 Interpolation Attack and Dense Polynomial
      </h3>

      <div class="formal-block formal-block-lemma">
        <div class="formal-block-title text-amber-400">
          Lemma 1 (Dense Polynomial)
        </div>
        <div class="formal-block-content">
          <p class="text-gray-300">
            After
            <span class="math">\lceil \log_3(p-1) \rceil + \lceil \log_3(t) \rceil</span>
            rounds all monomials in the encryption polynomial do
            occur. Furthermore, it is the minimum number of rounds
            with this property.
          </p>
        </div>
      </div>

      <p class="text-gray-300">
        <em>Proof.</em> After one round the encryption polynomial
        is of the form
        <span class="math">\sum_&#123;i=0&#125;^2 a_&#123;0,i&#125; X_0^&#123;3-i&#125; + \ldots + \sum_&#123;i=0&#125;^2 a_&#123;t-1,i&#125; X_&#123;t-1&#125;^&#123;3-i&#125; + a</span>.
        In order to reach the maximum degree
        <span class="math">p - 1</span> in one variable, the number
        of rounds <span class="math">r</span> has to satisfy
        <span class="math">3^r \geq p - 1</span>. It takes at
        least
        <span class="math">\lceil \log_3(t) \rceil</span> more
        rounds until all
        <span class="math">t</span> variables are exhausted.
      </p>

      <h3 class="text-xl font-semibold mt-6">
        E.2 GCD Attack
      </h3>
      <p class="text-gray-300">
        In the GCD attack [AGR+16], given more than one known (plaintext,
        ciphertext) pair, one constructs their polynomial
        representations and computes their polynomial GCD to recover
        a multiple of the key. The complexity for finding the GCD
        of two polynomials of degree
        <span class="math">d</span> is
        <span class="math">\mathcal&#123;O&#125;(d \log_2^2 d)</span>. The
        total number of rounds must satisfy:
      </p>
      <div class="math-block">
        R_P + R_F \geq R^&#123;\text&#123;GCD&#125;&#125;(p, t) \equiv 4 + \lceil \log_\alpha p \rceil - \lfloor 2 \log_\alpha(\log_2 p) \rfloor
      </div>

      <h3 class="text-xl font-semibold mt-6">
        E.3 Grobner Basis Attack &ndash; Details
      </h3>
      <p class="text-gray-300">
        Three strategies are presented in detail, including the
        first strategy exploiting the &ldquo;invariant&rdquo;
        subspace
        <span class="math">\mathcal&#123;S&#125;</span>, the second
        strategy with intermediate variables, and the third strategy
        combining the previous two. The analysis also considers the
        full-data case and a special case with
        <span class="math">R_P = 0</span>.
      </p>

      <h3 class="text-xl font-semibold mt-6">
        E.4 Grobner Basis Attack:
        <span class="math">\kappa = n</span> and Data
        <span class="math">\leq p^&#123;1/2&#125;</span>
      </h3>
      <p class="text-gray-300">
        The details of the Grobner Basis Attack in the MPC
        application scenario show that it does not outperform the
        GCD attack. The first strategy requires:
      </p>
      <div class="math-block">
        R_F + R_P \geq 2 + \left\lceil \frac&#123;\log_\alpha(p)&#125;&#123;2&#125; \right\rceil
      </div>
      <p class="text-gray-300">
        The second strategy gives a condition of the form:
      </p>
      <div class="math-block">
        R \geq 2 + \frac&#123;\log_2(p)&#125;&#123;2 \cdot \log_2(\alpha^\alpha / (\alpha - 1)^&#123;\alpha - 1&#125;)&#125;
      </div>
    </section>

    <!-- ============================================================ -->
    <!-- APPENDIX F: COMPARISON WITH INVERSE S-BOX                   -->
    <!-- ============================================================ -->

    <section id="app-f" class="mb-10">
      <h2 class="text-2xl font-bold">
        Appendix F: Comparison: HadesMiMC with
        S-Box(x) = <span class="math">x^&#123;-1&#125;</span>
      </h2>
      <p class="text-gray-300">
        HadesMiMC can be instantiated by an S-Box with a higher
        degree than 3. Here we analyze the number of rounds
        necessary to provide security against algebraic attacks with
        <span class="math">\textrm&#123;S-Box&#125;(x) = x^&#123;-1&#125;</span>.
      </p>
      <p class="text-gray-300">
        <strong>Main Result.</strong> For the cube case, one needs
        approximately:
      </p>
      <div class="math-block">
        R_P + R_F \geq 3 + \log_3(p) + \log_3(t)
      </div>
      <p class="text-gray-300">
        while for the inverse case:
      </p>
      <div class="math-block">
        R_P + \log_2(t) \cdot R_F \geq 2 + 2 \cdot \log_2(p)
      </div>
      <p class="text-gray-300">
        The number of rounds for the cube and inverse cases are
        close when <span class="math">t</span> is not much bigger
        than <span class="math">\log_2(p)</span>. Moreover, the
        total number of non-linear operations is in general much
        bigger for the inverse than for the cube case. In
        conclusion, it seems there is no advantage to use an S-Box
        different than the cube one when aiming to minimize the
        total number of non-linear operations.
      </p>
      <p class="text-gray-300">
        <strong>Interpolation Attack &ndash; Details.</strong> The
        inverse S-Box <span class="math">f(x) = x^&#123;-1&#125;</span>
        has different behavior depending on whether a full or
        partial S-Box layer is used: for a full S-Box layer it
        behaves as a function of algebraic degree
        <span class="math">t</span> (the number of words) from the
        interpolation perspective, while for a partial S-Box layer
        it behaves as degree 2. This means the choice between
        partial or full S-Box layers also depends on the details
        of the S-Box.
      </p>
    </section>

    <!-- ============================================================ -->
    <!-- APPENDIX G: GMIMC FOR MPC                                   -->
    <!-- ============================================================ -->

    <section id="app-g" class="mb-10">
      <h2 class="text-2xl font-bold">
        Appendix G: <span class="math">\text&#123;GMiMC&#125;_&#123;\text&#123;erf&#125;&#125;</span> for MPC Applications
      </h2>
      <p class="text-gray-300">
        We adapt the security analysis of
        <span class="math">\text&#123;GMiMC&#125;_&#123;\text&#123;erf&#125;&#125;</span> [AGP+19] for the case where
        <span class="math">\kappa = n</span> and the attacker can
        use at most
        <span class="math">\leq 2^&#123;n/2&#125;</span> chosen texts.
        The minimum number of rounds necessary is given by:
      </p>
      <div class="math-block">
        \max\&#123; 2 \cdot \lceil \log_3(p) \rceil - 4 \cdot \lfloor \log_3(\log_2 p) \rfloor + 2t - 2;\; t + 3 \&#125;
      </div>
      <p class="text-gray-300">
        <strong>Key Schedule.</strong> Bonnetain [Bon19] presented an
        attack on Feistel-MiMC and univariate GMiMC that relies
        only on their weak key schedules and is independent of the
        round function and the number of rounds. A change of the
        key schedule should be sufficient to restore security.
      </p>
      <p class="text-gray-300">
        <strong>Statistical Attacks.</strong>
        <span class="math">5t + 3</span> rounds are sufficient to
        provide security against statistical attacks.
      </p>
      <p class="text-gray-300">
        <strong>Algebraic Attacks.</strong> The GCD attack requires
        <span class="math">2 \cdot \lceil \log_3(p) \rceil - 4 \cdot \lfloor \log_3(\log_2 p) \rfloor + 2t - 2</span>
        rounds. The interpolation attack requires
        <span class="math">\lceil \log_3(p) \rceil + 2t + 4</span>
        rounds.
      </p>
    </section>

    <!-- ============================================================ -->
    <!-- REFERENCES                                                  -->
    <!-- ============================================================ -->

    <section id="references" class="mb-10">
      <h2 class="text-2xl font-bold">References</h2>
      <ul class="text-sm text-gray-400 space-y-2 list-none">
        <li>
          <span class="text-gray-500">[AAB+19]</span>
          Aly, Ashur, Ben-Sasson, Dhooghe, Szepieniec.
          <em>Design of Symmetric-Key Primitives for Advanced
          Cryptographic Protocols</em>.
          <a href="https://eprint.iacr.org/2019/426"
            target="_blank" rel="noopener noreferrer"
          >eprint 2019/426</a>.
        </li>
        <li>
          <span class="text-gray-500">[ACG+19]</span>
          Albrecht, Cid, Grassi, Khovratovich, Luftenegger,
          Rechberger, Schofnegger.
          <em>Algebraic Cryptanalysis of STARK-Friendly Designs:
          Application to MARVELlous and MiMC</em>.
          ASIACRYPT 2019, LNCS 11923.
        </li>
        <li>
          <span class="text-gray-500">[AD18]</span>
          Ashur, Dhooghe.
          <em>MARVELlous: a STARK-Friendly Family of
          Cryptographic Primitives</em>.
          eprint 2018/1098.
        </li>
        <li>
          <span class="text-gray-500">[AGP+19]</span>
          Albrecht, Grassi, Perrin, Ramacher, Rechberger,
          Rotaru, Roy, Schofnegger.
          <em>Feistel Structures for MPC, and More</em>.
          ESORICS 2019, LNCS 11736.
          <a href="/papers/feistel-structures-mpc-2019"
            class="text-blue-400 hover:text-blue-300"
          >[page on this site]</a>
        </li>
        <li>
          <span class="text-gray-500">[AGR+16]</span>
          Albrecht, Grassi, Rechberger, Roy, Tiessen.
          <em>MiMC: Efficient Encryption and Cryptographic Hashing
          with Minimal Multiplicative Complexity</em>.
          ASIACRYPT 2016, LNCS 10031.
        </li>
        <li>
          <span class="text-gray-500">[AMMR18]</span>
          Agrawal, Mohassel, Mukherjee, Rindal.
          <em>DiSE: Distributed Symmetric-key Encryption</em>.
          CCS 2018, pp. 1993-2010.
        </li>
        <li>
          <span class="text-gray-500">[ARS+15]</span>
          Albrecht, Rechberger, Schneider, Tiessen, Zohner.
          <em>Ciphers for MPC and FHE</em>.
          EUROCRYPT 2015, LNCS 9056.
        </li>
        <li>
          <span class="text-gray-500">[BBS99]</span>
          Biham, Biryukov, Shamir.
          <em>Cryptanalysis of Skipjack Reduced to 31 Rounds Using
          Impossible Differentials</em>.
          EUROCRYPT 1999, LNCS 1592.
        </li>
        <li>
          <span class="text-gray-500">[BCD+20]</span>
          Beyne, Canteaut, Dinur, Eichlseder, Leander,
          Leurent, Naya-Plasencia, Perrin, Sasaki, Todo, Wiemer.
          <em>Out of Oddity &mdash; New Cryptanalytic Techniques
          against Symmetric Primitives Optimized for Integrity
          Proof Systems</em>.
          <a href="https://eprint.iacr.org/2020/188"
            target="_blank" rel="noopener noreferrer"
          >eprint 2020/188</a>, CRYPTO 2020.
          <a href="/papers/out-of-oddity-2020"
            class="text-blue-400 hover:text-blue-300"
          >[page on this site]</a>
        </li>
        <li>
          <span class="text-gray-500">[BCG+12]</span>
          Borghoff, Canteaut, Guneysu et al.
          <em>PRINCE &ndash; A Low-Latency Block Cipher for
          Pervasive Computing Applications</em>.
          ASIACRYPT 2012, LNCS 7658.
        </li>
        <li>
          <span class="text-gray-500">[BCLR17]</span>
          Beierle, Canteaut, Leander, Rotella.
          <em>Proving Resistance Against Invariant Attacks: How to
          Choose the Round Constants</em>.
          CRYPTO 2017, LNCS 10402.
        </li>
        <li>
          <span class="text-gray-500">[BDD+15]</span>
          Bar-On, Dinur, Dunkelman, Lallemand, Keller, Tsaban.
          <em>Cryptanalysis of SP Networks with Partial Non-Linear
          Layers</em>.
          EUROCRYPT 2015, LNCS 9056.
        </li>
        <li>
          <span class="text-gray-500">[BFP09]</span>
          Bettale, Faugere, Perret.
          <em>Hybrid approach for solving multivariate systems over
          finite fields</em>.
          Journal of Mathematical Cryptology 3(3), 2009.
        </li>
        <li>
          <span class="text-gray-500">[BKR11]</span>
          Bogdanov, Khovratovich, Rechberger.
          <em>Biclique Cryptanalysis of the Full AES</em>.
          ASIACRYPT 2011, LNCS 7073.
        </li>
        <li>
          <span class="text-gray-500">[Bon19]</span>
          Bonnetain.
          <em>Collisions on Feistel-MiMC and univariate
          GMiMC</em>.
          <a href="https://eprint.iacr.org/2019/951"
            target="_blank" rel="noopener noreferrer"
          >eprint 2019/951</a>.
          <a href="/papers/collisions-feistel-mimc-2019"
            class="text-blue-400 hover:text-blue-300"
          >[page on this site]</a>
        </li>
        <li>
          <span class="text-gray-500">[BS91]</span>
          Biham, Shamir.
          <em>Differential Cryptanalysis of DES-like
          Cryptosystems</em>.
          Journal of Cryptology 4(1), 1991.
        </li>
        <li>
          <span class="text-gray-500">[Buc06]</span>
          Buchberger.
          <em>An algorithm for finding the basis elements of the
          residue class ring of a zero dimensional polynomial
          ideal</em>.
          Journal of Symbolic Computation 41, 2006.
        </li>
        <li>
          <span class="text-gray-500">[CDK+18]</span>
          Cogliati, Dodis, Katz, Lee, Steinberger,
          Thiruvengadam, Zhang.
          <em>Provable Security of (Tweakable) Block Ciphers Based
          on Substitution-Permutation Networks</em>.
          CRYPTO 2018, LNCS 10991.
        </li>
        <li>
          <span class="text-gray-500">[CLO97]</span>
          Cox, Little, O'Shea.
          <em>Ideals, varieties, and algorithms</em>.
          Springer, 1997.
        </li>
        <li>
          <span class="text-gray-500">[DEG+18]</span>
          Dobraunig, Eichlseder, Grassi, Lallemand, Leander,
          List, Mendel, Rechberger.
          <em>Rasta: A Cipher with Low ANDdepth and Few ANDs per
          Bit</em>.
          CRYPTO 2018, LNCS 10991.
        </li>
        <li>
          <span class="text-gray-500">[DEM15]</span>
          Dobraunig, Eichlseder, Mendel.
          <em>Higher-Order Cryptanalysis of LowMC</em>.
          ICISC 2015, LNCS 9558.
        </li>
        <li>
          <span class="text-gray-500">[DKR97]</span>
          Daemen, Knudsen, Rijmen.
          <em>The Block Cipher Square</em>.
          FSE 1997, LNCS 1267.
        </li>
        <li>
          <span class="text-gray-500">[DLMW15]</span>
          Dinur, Liu, Meier, Wang.
          <em>Optimized Interpolation Attacks on LowMC</em>.
          ASIACRYPT 2015, LNCS 9453.
        </li>
        <li>
          <span class="text-gray-500">[DR01]</span>
          Daemen, Rijmen.
          <em>The Wide Trail Design Strategy</em>.
          IMA 2001, LNCS 2260.
        </li>
        <li>
          <span class="text-gray-500">[DR02]</span>
          Daemen, Rijmen.
          <em>The Design of Rijndael: AES &ndash; The Advanced
          Encryption Standard</em>.
          Springer, 2002.
        </li>
        <li>
          <span class="text-gray-500">[EGL+20]</span>
          Eichlseder, Grassi, Luftenegger, Oygarden,
          Rechberger, Schofnegger, Wang.
          <em>An Algebraic Attack on Ciphers with Low-Degree Round
          Functions: Application to Full MiMC</em>.
          IACR ePrint 2020/182.
        </li>
        <li>
          <span class="text-gray-500">[GGNS13]</span>
          Gerard, Grosso, Naya-Plasencia, Standaert.
          <em>Block Ciphers That Are Easier to Mask: How Far Can
          We Go?</em>
          CHES 2013, LNCS 8086.
        </li>
        <li>
          <span class="text-gray-500">[GKR+19]</span>
          Grassi, Khovratovich, Roy, Rechberger, Schofnegger.
          <em>Poseidon: A New Hash Function for Zero-Knowledge
          Proof Systems</em>.
          <a href="https://eprint.iacr.org/2019/458"
            target="_blank" rel="noopener noreferrer"
          >eprint 2019/458</a>.
          <a href="/papers/poseidon-2019"
            class="text-blue-400 hover:text-blue-300"
          >[page on this site]</a>
        </li>
        <li>
          <span class="text-gray-500">[Gra18]</span>
          Grassi.
          <em>Mixture Differential Cryptanalysis: a New Approach
          to Distinguishers and Attacks on round-reduced AES</em>.
          IACR Trans. Symmetric Cryptol. 2018(2).
          <a href="/papers/mixture-differential-aes-2017"
            class="text-blue-400 hover:text-blue-300"
          >[page on this site]</a>
        </li>
        <li>
          <span class="text-gray-500">[GRR16]</span>
          Grassi, Rechberger, Ronjom.
          <em>Subspace Trail Cryptanalysis and its Applications to
          AES</em>.
          IACR Trans. Symmetric Cryptol. 2016(2).
        </li>
        <li>
          <span class="text-gray-500">[GRS20]</span>
          Grassi, Rechberger, Schofnegger.
          <em>Weak linear layers in word-oriented partial SPN and
          hades-like ciphers</em>.
          <a href="https://eprint.iacr.org/2020/500"
            target="_blank" rel="noopener noreferrer"
          >eprint 2020/500</a>.
          <a href="/papers/subspace-trails-2020"
            class="text-blue-400 hover:text-blue-300"
          >[page on this site]</a>
        </li>
        <li>
          <span class="text-gray-500">[HJM07]</span>
          Hell, Johansson, Meier.
          <em>Grain: a stream cipher for constrained
          environments</em>.
          IJWMC 2(1), 2007.
        </li>
        <li>
          <span class="text-gray-500">[JK97]</span>
          Jakobsen, Knudsen.
          <em>The Interpolation Attack on Block Ciphers</em>.
          FSE 1997, LNCS 1267.
        </li>
        <li>
          <span class="text-gray-500">[Knu94]</span>
          Knudsen.
          <em>Truncated and Higher Order Differentials</em>.
          FSE 1994, LNCS 1008.
        </li>
        <li>
          <span class="text-gray-500">[KR20]</span>
          Keller, Rosemarin.
          <em>Mind the Middle Layer: The HADES Design Strategy
          Revisited</em>.
          <a href="https://eprint.iacr.org/2020/179"
            target="_blank" rel="noopener noreferrer"
          >eprint 2020/179</a>.
          <a href="/papers/hades-revisited-2020"
            class="text-blue-400 hover:text-blue-300"
          >[page on this site]</a>
        </li>
        <li>
          <span class="text-gray-500">[KSS13]</span>
          Keller, Scholl, Smart.
          <em>An architecture for practical actively secure MPC
          with dishonest majority</em>.
          CCS 2013.
        </li>
        <li>
          <span class="text-gray-500">[LAAZ11]</span>
          Leander, Abdelraheem, AlKhzaimi, Zenner.
          <em>A Cryptanalysis of PRINTcipher: The Invariant
          Subspace Attack</em>.
          CRYPTO 2011, LNCS 6841.
        </li>
        <li>
          <span class="text-gray-500">[LF04]</span>
          Lacan, Fimes.
          <em>Systematic MDS Erasure Codes Based on Vandermonde
          Matrices</em>.
          IEEE Communications Letters 8(9), 2004,
          pp. 570&ndash;572.
        </li>
        <li>
          <span class="text-gray-500">[Mat93]</span>
          Matsui.
          <em>Linear Cryptanalysis Method for DES Cipher</em>.
          EUROCRYPT 1993, LNCS 765.
        </li>
        <li>
          <span class="text-gray-500">[MV15]</span>
          Miles, Viola.
          <em>Substitution-Permutation Networks, Pseudorandom
          Functions, and Natural Proofs</em>.
          JACM 62(6), 2015.
        </li>
        <li>
          <span class="text-gray-500">[RDP+96]</span>
          Rijmen, Daemen, Preneel, Bosselaers, Win.
          <em>The Cipher SHARK</em>.
          FSE 1996, LNCS 1039.
        </li>
        <li>
          <span class="text-gray-500">[RST18]</span>
          Rechberger, Soleimany, Tiessen.
          <em>Cryptanalysis of Low-Data Instances of Full
          LowMCv2</em>.
          IACR Trans. Symmetric Cryptol. 2018(3).
        </li>
        <li>
          <span class="text-gray-500">[Wag99]</span>
          Wagner.
          <em>The Boomerang Attack</em>.
          FSE 1999, LNCS 1636.
        </li>
        <li>
          <span class="text-gray-500">[WWGY14]</span>
          Wang, Wu, Guo, Yu.
          <em>Differential Cryptanalysis and Linear Distinguisher
          of Full-Round Zorro</em>.
          ACNS 2014, LNCS 8479.
        </li>
        <li>
          <span class="text-gray-500">[YMT97]</span>
          Youssef, Mister, Tavares.
          <em>On the Design of Linear Transformations for
          Substitution Permutation Encryption Networks</em>.
          School of Computer Science, Carleton University, 1997,
          pp. 40&ndash;48.
        </li>
      </ul>
    </section>

    <PaperHistory slug="hades-2019" />
  </article>
</BaseLayout>
