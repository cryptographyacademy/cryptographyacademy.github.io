---
import BaseLayout from '../../layouts/BaseLayout.astro';

const EPRINT_URL = 'https://eprint.iacr.org/2013/713';
const CRAWLER = 'mistral';
const CONVERTED_DATE = '2026-02-16';
const TITLE_HTML = 'Cryptanalysis of Zorro';
const AUTHORS_HTML = 'Jian Guo, Ivica Nikolic, Thomas Peyrin, Lei Wang';

const CONTENT = `    <p class="text-gray-300">Jian Guo Ivica Nikolić Thomas Peyrin Lei Wang</p>

    <h6 id="sec-2" class="text-base font-medium mt-4">Abstract</h6>

    <p class="text-gray-300">At CHES 2013 was presented a new block cipher called Zorro. Although it uses only 4 S-boxes per round, the designers showed the resistance of the cipher against various attacks, and concluded the cipher has a large security margin. In this paper, we give a key recovery attack on the full cipher in the single-key model that works for <span class="math">2^{64}</span> out of <span class="math">2^{128}</span> keys. Our analysis is based precisely on the fact that the non-linear layer has only 4 S-boxes. We exploit this twice in a two-stage attack: first, we show that Zorro has an equivalent description that does not have constants in the rounds, and then, we launch an internal differential attack on the newly described cipher. With computer verifications we confirm the correctness of the analysis. Our attack is the first to use internal differentials for block ciphers, thus we adapt Daemen’s attack on Even-Mansour construction to the case of internal differentials (instead of differentials), which allows us to recovery to full key.</p>

    <p class="text-gray-300">This work provides as well insights on alternative descriptions of general Zorro-type ciphers (incomplete non-linear layers), the importance of well chosen constants, and the advantages of Daemen’s attack.</p>

    <h6 id="sec-3" class="text-base font-medium mt-4">Keywords:</h6>

    <p class="text-gray-300">Zorro, cryptanalysis, block cipher, internal differentials</p>

    <h2 id="sec-4" class="text-2xl font-bold">1 Introduction</h2>

    <p class="text-gray-300">The Advanced Encryption Standard (AES) is the current de facto block cipher standard, known for its elegant and simple design, high security, and efficiency. More than a decade ago, these features motivated NIST to chose the cipher as a standard, and even now, most of the design decisions of AES are considered optimal from the point of view of both efficiency and security. The advances in the field of cryptography, however, suggest that some peculiar details of the design can be improved. One research direction emerged after the discovery of the related-key attacks on AES-192 and AES-256 <em>[2, 1]</em>, and to make the cipher secure in the related-key model, patches of the key schedule were proposed <em>[3, 13]</em>. Another line of research focuses on countermeasures for preventing side-channel attacks on the cipher, and investigates tweaks of the non-linear operations in the cipher that lead to efficient masking methods.</p>

    <p class="text-gray-300">In this paper, we analyze the security of the block cipher Zorro published at CHES’13 <em>[7]</em>, designed by Gérard, Grosso, Naya-Plasencia, and Standaert, and proposed to improve the side-channel resistance of AES. The main tweak introduced by Zorro is in the non-linear layer (SubBytes) of AES, and includes defining a new S-box and reducing the application of the S-box per round, from 16 to only 4. The remaining tweaks include increasing the number of rounds from 10 to 24, reordering the round transformations, moving the constants from the key schedule to the rounds, and simplifying the key schedule by adding the master key only after each 4 rounds (as in the block cipher LED-64 <em>[8]</em>).</p>

    <p class="text-gray-300">How risky is the new design? A round of Zorro is very similar to a round of AES, except that is has only 4 S-boxes. Thus the 24-round Zorro compared to the 10-round AES, has 40% less non-linear operations, but 140% more linear. This tradeoff does not provide an actual proof of security and therefore in the submission paper the designers address the main security concerns and give an extensive analysis of Zorro. They stress that, due to</p>

    <p class="text-gray-300">the intended use of the cipher, related-key attacks are of no interest. In the single-key model they require full 128-bit security and thus provide rigorous analysis against various attacks: differential, linear, meet-in-the-middle, impossible differential, etc. Interestingly, due to the modified SubBytes, the designers cannot use the simple bounds on number of active S-boxes in linear and differential characteristics, and instead, they come up with a dedicated approach, and successfully prove that no characteristic suitable for attacks exists on more then 14-16 rounds of Zorro. The best found attacks, in both the secret and the open key models, reach only 12 rounds, which allows the designers to conclude that the 24-round Zorro has comfortable security margin.</p>

    <p class="text-gray-300">Our contribution. We present a key-recovery attack on the full 24-round cipher in the single-key model that works for a fraction of the keys (for <span class="math">2^{64}</span> keys out of <span class="math">2^{128}</span> possible). Our attack model and the results of the analysis are similar to Leander et al. <em>[11]</em> attack published at CRYPTO’11 on the lightweight cipher PRINTcipher <em>[10]</em>: both are single-key attacks on the full ciphers under the weak-key assumption. However, the attack techniques are completely different. Our attack is based on the idea of redefining the block cipher and then launching internal differential attack <em>[14]</em> – these two steps can be achieved only due to the new S-box layer.</p>

    <p class="text-gray-300">We show a surprising feature of Zorro: the cipher has another, equivalent description, with constants added not in the rounds, but to the keys. We obtain the new description first for a single step (defined as four rounds), and then for the whole cipher. For the step, we put side by side four rounds with and without constants, and show that a specifically chosen difference at the input of these two steps, deterministically propagates to another difference at the output. The 16 bytes of the input difference are the solution of a linear system of 16 equations – each equation corresponds to one condition on an intermediate byte difference, imposed by one of the 16 S-boxes contained in a step. It means that one step described as in Zorro, can be seen as a step that has no constants in the rounds, if we add one value to the input and one at the output of the step (the values are indeed the above input and the output differences, and are constant). We elevate this new description to the whole cipher, by merging two consecutive values and moving them to the key (which now becomes a subkey) that is added between the steps.</p>

    <p class="text-gray-300">By the new description, a round of Zorro has no constants, thus same as a round of AES or any other cipher with three arbitrarily defined S-box, ShiftRows, MixColumns, maintains the following property: if at the input of the round the two halves (the first two columns and the last two columns) of the state are equal, then they will be equal at the output as well. We model this property as internal differential characteristic <em>[14]</em> that holds with probability 1, and try to extended it to as many rounds as possible. But after each four rounds (a step) we have the addition of a subkey, which may or may not permit the free flow of the characteristic. Thus we use three different strategies to pass the steps: in the first, we use the above probability 1 internal differential characteristic, in the second, lower probability characteristic, and in the third we apply a special technique, inspired by the attacks of Mendel et al. <em>[12]</em> on the cipher LED <em>[8]</em>, and based on Daemen’s attack <em>[4]</em> on Even-Mansour construction <em>[6]</em>. In optimal complexity attacks, it is beneficial to have more steps passed using the probability 1 characteristic, thus to achieve two such steps, we focus on the case when the secret key is chosen uniformly at random from a set of <span class="math">2^{64}</span> keys, and provide key recovery attack on the full cipher in <span class="math">2^{54.3}</span> time, data, and memory. We extensively verify the attack on a computer: in <span class="math">2^{28.5}</span> time produce inputs conforming to the 20-round characteristic used in the attack, test and confirm the idea based on the Daemen’s attack, and launch the whole attack on reduced-size Zorro-like cipher.</p>

    <p class="text-gray-300">!<a href="img-0.jpeg">img-0.jpeg</a> Fig. 1. A graphical view of Zorro. The cipher uses 6 steps (denoted as  <span class="math">Q_0, \\ldots, Q_5</span> ) of 4 rounds each. The rounds differ only in the constants that are added to the state.</p>

    <p class="text-gray-300">The block cipher Zorro has 128-bit key and 128-bit state. The cipher has 24 rounds divided into 6 steps of 4 rounds each. The steps do not use the key, and Zorro does not have a key schedule. Instead, before each step the master key is bitwisely added to the state, and the same addition is done after the last step. In Zorro, as in AES, the state is regarded as  <span class="math">4 \\times 4</span>  matrix of bytes, and one round consists of four distinct transformations:  <span class="math">SB^{<em>}</span> ,  <span class="math">AC</span> ,  <span class="math">SR</span> ,  <span class="math">MC</span> . The first transformation  <span class="math">SB^{</em>}</span>  is the S-box layer (as SubBytes in AES) and consists of applying the same S-box to the bytes of the first row only. Next,  <span class="math">AC</span>  is addition of round constants - in round  <span class="math">i</span> , the four constants  <span class="math">(i, i, i, i &amp;lt;&amp;lt; 3)</span>  are added to the four bytes of the top row. Finally, the last two transformations,  <span class="math">SR</span>  and  <span class="math">MC</span> , are the AES's ShiftRows and MixColumns.</p>

    <p class="text-gray-300">We omit the definition of the S-box used in Zorro (it is different from the one of AES), and refer the interested reader to [7].</p>

    <p class="text-gray-300">The designers analyze the cipher against various attacks and their approach follows the standard routine of providing the required initial trust in the security of the cipher. This routine consists of analyzing the cipher against all attacks that might threaten the security.</p>

    <p class="text-gray-300">The evaluation, however, lacks the analysis against one particular attack technique: internal differentials[14]. Unlike differential analysis which follows the propagation of a difference between two states, internal differentials follow the propagation of a difference between the two halves of the state. If the state transformations in the two halves are (almost) identical, then the attacker can construct an internal differential characteristic. One simple approach to prevent internal differentials is to use different constants in the two halves. In fact, this is the case of Zorro: in each round  <span class="math">i</span> , in the first half the constants  <span class="math">i, i</span>  are used, while in the second  <span class="math">i, i \\ll 3</span> . Therefore, it seems that Zorro, along with the rest of the ciphers that use different constants in the halves, easily resists this type of attack.</p>

    <p class="text-gray-300">But what happens if there are no such constants? Let us focus on one round of Zorro, where the transformation AC is removed, and the two halves of the state are equal. Then:</p>

    <p class="text-gray-300">!<a href="img-1.jpeg">img-1.jpeg</a></p>

    <p class="text-gray-300">Therefore, after one round, we end up with a state that again has two equal halves. By elevating the above property to the whole cipher, we obtain that if the plaintext and the key have two equal halves, then the ciphertext will have as well two equal halves. This is</p>

    <p class="text-gray-300">to say that the internal differential characteristic with no difference in the plaintext, in the key, and in the ciphertext, has probability  <span class="math">1^1</span> .</p>

    <p class="text-gray-300">The above characteristic looks attractive for attacks, but the round constants (the transformation AC) should prevent such characteristics. However, Zorro has an equivalent description that has no constants in the rounds. To explain how to obtain such description, let us focus on one step of Zorro. Assume we are dealing with the  <span class="math">j</span> -th step denoted as  <span class="math">Q_{j}</span>  (then the six steps of Zorro are  <span class="math">Q_{0}, \\ldots, Q_{5}</span> ) composed of four rounds. This step is a public permutation, i.e. we do not take the key additions as part of the step. In parallel to  <span class="math">Q_{j}</span>  we put the public permutation  <span class="math">Q</span> , composed of the same four rounds, but with round constants removed <span class="math">^{2}</span> . Our analysis shows that there is a relation between  <span class="math">Q_{j}</span>  and  <span class="math">Q</span>  (see Fig. 2), described in the following lemma:</p>

    <p class="text-gray-300">Lemma 1. For any  <span class="math">j = 0, \\ldots, 5</span> , and a plaintext  <span class="math">P</span> , it holds:</p>

    <div class="my-4 text-center"><span class="math-block">Q _ {j} (P) = Q (P \\oplus \\nu_ {j}) \\oplus \\mu_ {j},</span></div>

    <p class="text-gray-300">where  <span class="math">\\nu_{j},\\mu_{j}</span>  are two 128-bit values that depend on the round constants used in  <span class="math">Q_{j}</span> .</p>

    <p class="text-gray-300">Proof. Let  <span class="math">X</span>  be the input to  <span class="math">Q_{j}</span> , and  <span class="math">Y = X \\oplus D</span>  be the input to  <span class="math">Q</span> , that is, the inputs are related by the difference  <span class="math">D</span> . We propagate  <span class="math">D</span>  through four rounds, and show how to define  <span class="math">D</span>  such that for any choice of  <span class="math">X</span> , the difference  <span class="math">Q_{j}(X) \\oplus Q(X \\oplus D)</span>  is constant (equals  <span class="math">\\mu_{j}</span> ). It means we want to find a differential characteristic on four rounds, with input difference  <span class="math">D</span> , that holds with probability 1. This can be achieved only when there is no difference in the bytes at the input of the non-linear operations. Such operations are the four S-boxes applied to the four bytes of the top row in each of the four rounds. Therefore we have conditions on 16 bytes (4 S-boxes × 4 rounds). Note, if there is no difference coming into the S-boxes, as the rest of the round transformations are linear, the above 16 conditions can be expressed as a linear system of equations in the 16 unknown bytes of  <span class="math">D</span> . Let us obtain the system. Let  <span class="math">d_{i,j}, i = 1, \\ldots, 4, j = 1, \\ldots, 4</span>  be the byte in the  <span class="math">i</span> -th row,  <span class="math">j</span> -th</p>

    <p class="text-gray-300">!<a href="img-2.jpeg">img-2.jpeg</a> Fig. 2. The equivalent definitions of the step  <span class="math">Q_{j}</span>  of Zorro.</p>

    <p class="text-gray-300">column of  <span class="math">D</span> , and  <span class="math">c_{j}^{i}, i = 1, \\ldots, 4, j = 1, \\ldots, 4</span>  be the constant used in the  <span class="math">i</span> -th round of the  <span class="math">j</span> -th byte in the top row. Recall that the round transformations follow the sequence  <span class="math">SB^{<em>}, AC, SR, MC</span> . As the round starts with  <span class="math">SB^{</em>}</span> , and we want no difference in the bytes of the top row, the four conditions in the first round result in</p>

    <div class="my-4 text-center"><span class="math-block">d _ {1, 1} = 0, d _ {1, 2} = 0, d _ {1, 3} = 0, d _ {1, 4} = 0.</span></div>

    <p class="text-gray-300">The remaining transformations of the round are linear</p>

    <div class="my-4 text-center"><span class="math-block">\\left( \\begin{array}{cccccc} 0 &amp;amp; 0 &amp;amp; 0 &amp;amp; 0 \\\\ d_{2,1} &amp;amp; d_{2,2} &amp;amp; d_{2,3} &amp;amp; d_{2,4} \\\\ d_{3,1} &amp;amp; d_{3,2} &amp;amp; d_{3,3} &amp;amp; d_{3,4} \\\\ d_{4,1} &amp;amp; d_{4,2} &amp;amp; d_{4,3} &amp;amp; d_{4,4} \\end{array} \\right) \\xrightarrow{AC} \\left( \\begin{array}{cccccc} c_{1}^{1} &amp;amp; c_{2}^{1} &amp;amp; c_{3}^{1} &amp;amp; c_{4}^{1} \\\\ d_{2,1} &amp;amp; d_{2,2} &amp;amp; d_{2,3} &amp;amp; d_{2,4} \\\\ d_{3,1} &amp;amp; d_{3,2} &amp;amp; d_{3,3} &amp;amp; d_{3,4} \\\\ d_{4,1} &amp;amp; d_{4,2} &amp;amp; d_{4,3} &amp;amp; d_{4,4} \\end{array} \\right) \\xrightarrow{SR} \\left( \\begin{array}{cccccc} c_{1}^{1} &amp;amp; c_{2}^{1} &amp;amp; c_{3}^{1} &amp;amp; c_{4}^{1} \\\\ d_{2,2} &amp;amp; d_{2,3} &amp;amp; d_{2,4} &amp;amp; d_{2,1} \\\\ d_{3,3} &amp;amp; d_{3,4} &amp;amp; d_{3,1} &amp;amp; d_{3,2} \\\\ d_{4,4} &amp;amp; d_{4,1} &amp;amp; d_{4,2} &amp;amp; d_{4,3} \\end{array} \\right) \\xrightarrow{MC}</span></div>

    <div class="my-4 text-center"><span class="math-block">\\left( \\begin{array}{cccccc} 2c_{1}^{1} + 3d_{2,2} + d_{3,3} + d_{4,4} &amp;amp; 2c_{2}^{1} + 3d_{2,3} + d_{3,4} + d_{4,1} &amp;amp; 2c_{3}^{1} + 3d_{2,4} + d_{3,1} + d_{4,2} &amp;amp; 2c_{4}^{1} + 3d_{2,1} + d_{3,2} + d_{4,3} \\\\ c_{1}^{1} + 2d_{2,2} + 3d_{3,3} + d_{4,4} &amp;amp; c_{2}^{1} + 2d_{2,3} + 3d_{3,4} + d_{4,1} &amp;amp; c_{3}^{1} + 2d_{2,4} + 3d_{3,1} + d_{4,2} &amp;amp; c_{4}^{1} + 2d_{2,1} + 3d_{3,2} + d_{4,3} \\\\ c_{1}^{1} + d_{2,2} + 2d_{3,3} + 3d_{4,4} &amp;amp; c_{2}^{1} + d_{2,3} + 2d_{3,4} + 3d_{4,1} &amp;amp; c_{3}^{1} + d_{2,4} + 2d_{3,1} + 3d_{4,2} &amp;amp; c_{4}^{1} + d_{2,1} + 2d_{3,2} + 3d_{4,3} \\\\ 2c_{1}^{1} + d_{2,2} + d_{3,3} + 2d_{4,4} &amp;amp; 2c_{2}^{1} + d_{2,3} + d_{3,4} + 2d_{4,1} &amp;amp; 2c_{3}^{1} + d_{2,4} + d_{3,1} + 2d_{4,2} &amp;amp; 2c_{4}^{1} + d_{2,1} + d_{3,2} + 2d_{4,3} \\end{array} \\right).</span></div>

    <p class="text-gray-300">As the output of the first round is the input to the second, the conditions for the top row in the second round are</p>

    <div class="my-4 text-center"><span class="math-block">3d_{2,2} + d_{3,3} + d_{4,4} = 2c_{1}^{1},</span></div>

    <div class="my-4 text-center"><span class="math-block">3d_{2,3} + d_{3,4} + d_{4,1} = 2c_{2}^{1},</span></div>

    <div class="my-4 text-center"><span class="math-block">3d_{2,4} + d_{3,1} + d_{4,2} = 2c_{3}^{1},</span></div>

    <div class="my-4 text-center"><span class="math-block">3d_{2,1} + d_{3,2} + d_{4,3} = 2c_{4}^{1}.</span></div>

    <p class="text-gray-300">Following this approach, we can obtain as well the remaining 8 equations from the third and the fourth rounds. The system of 12 equations in 12 unknown bytes of <span class="math">D</span> (all but the one of the top row) has the form <span class="math">A \\cdot \\tilde{D} = b</span>, with</p>

    <div class="my-4 text-center"><span class="math-block">A = \\left( \\begin{array}{cccccccc} 0 &amp;amp; 0 &amp;amp; 0 &amp;amp; 3 &amp;amp; 0 &amp;amp; 0 &amp;amp; 1 &amp;amp; 0 &amp;amp; 0 &amp;amp; 1 &amp;amp; 0 &amp;amp; 0 \\\\ 3 &amp;amp; 0 &amp;amp; 0 &amp;amp; 0 &amp;amp; 0 &amp;amp; 0 &amp;amp; 0 &amp;amp; 1 &amp;amp; 0 &amp;amp; 0 &amp;amp; 1 &amp;amp; 0 \\\\ 0 &amp;amp; 3 &amp;amp; 0 &amp;amp; 0 &amp;amp; 1 &amp;amp; 0 &amp;amp; 0 &amp;amp; 0 &amp;amp; 0 &amp;amp; 0 &amp;amp; 0 &amp;amp; 1 \\\\ 0 &amp;amp; 0 &amp;amp; 3 &amp;amp; 0 &amp;amp; 0 &amp;amp; 1 &amp;amp; 0 &amp;amp; 0 &amp;amp; 1 &amp;amp; 0 &amp;amp; 0 &amp;amp; 0 \\\\ 1 &amp;amp; 1 &amp;amp; 6 &amp;amp; 0 &amp;amp; 2 &amp;amp; 5 &amp;amp; 0 &amp;amp; 1 &amp;amp; 3 &amp;amp; 0 &amp;amp; 2 &amp;amp; 3 \\\\ 0 &amp;amp; 1 &amp;amp; 1 &amp;amp; 6 &amp;amp; 1 &amp;amp; 2 &amp;amp; 5 &amp;amp; 0 &amp;amp; 3 &amp;amp; 3 &amp;amp; 0 &amp;amp; 2 \\\\ 6 &amp;amp; 0 &amp;amp; 1 &amp;amp; 1 &amp;amp; 0 &amp;amp; 1 &amp;amp; 2 &amp;amp; 5 &amp;amp; 2 &amp;amp; 3 &amp;amp; 3 &amp;amp; 0 \\\\ 1 &amp;amp; 6 &amp;amp; 0 &amp;amp; 1 &amp;amp; 5 &amp;amp; 0 &amp;amp; 1 &amp;amp; 2 &amp;amp; 0 &amp;amp; 2 &amp;amp; 3 &amp;amp; 3 \\\\ 7 &amp;amp; 14 &amp;amp; 2 &amp;amp; 3 &amp;amp; 8 &amp;amp; 1 &amp;amp; 4 &amp;amp; 9 &amp;amp; 5 &amp;amp; 1 &amp;amp; 14 &amp;amp; 2 \\\\ 3 &amp;amp; 7 &amp;amp; 14 &amp;amp; 2 &amp;amp; 9 &amp;amp; 8 &amp;amp; 1 &amp;amp; 4 &amp;amp; 2 &amp;amp; 5 &amp;amp; 1 &amp;amp; 14 \\\\ 2 &amp;amp; 3 &amp;amp; 7 &amp;amp; 14 &amp;amp; 4 &amp;amp; 9 &amp;amp; 8 &amp;amp; 1 &amp;amp; 14 &amp;amp; 2 &amp;amp; 5 &amp;amp; 1 \\\\ 14 &amp;amp; 2 &amp;amp; 3 &amp;amp; 7 &amp;amp; 1 &amp;amp; 4 &amp;amp; 9 &amp;amp; 8 &amp;amp; 1 &amp;amp; 14 &amp;amp; 2 &amp;amp; 5 \\end{array} \\right), \\qquad \\tilde{D} = \\left( \\begin{array}{c} d_{2,1} \\\\ d_{2,2} \\\\ d_{2,3} \\\\ d_{2,4} \\\\ d_{3,1} \\\\ d_{3,2} \\\\ d_{3,3} \\\\ d_{3,4} \\\\ d_{4,1} \\\\ d_{4,2} \\\\ d_{4,3} \\\\ d_{4,4} \\end{array} \\right), \\qquad b = \\left( \\begin{array}{c} 2c_{1}^{1} \\\\ 2c_{2}^{1} \\\\ 2c_{3}^{1} \\\\ 2c_{4}^{1} \\\\ 3c_{1}^{2} \\\\ 3c_{2}^{2} \\\\ 3c_{3}^{2} \\\\ 3c_{4}^{2} \\\\ 5c_{1}^{3} \\\\ 5c_{2}^{3} \\\\ 5c_{3}^{3} \\\\ 5c_{4}^{3} \\end{array} \\right)</span></div>

    <p class="text-gray-300">The matrix <span class="math">A</span> is non-singular, thus for any choice of <span class="math">b</span>, exists a unique solution <span class="math">\\tilde{D}</span>. The 12 bytes of <span class="math">\\tilde{D}</span> are in fact the last three rows of <span class="math">\\nu_{j}</span>, while the first row is composed of zero bytes. The constants used in the fourth round do not have impact on the value of <span class="math">\\nu_{j}</span>, however they determine the value of <span class="math">\\mu_{j}</span>. The precise values of <span class="math">\\nu_{j}, \\mu_{j}</span> are given in Appendix A.</p>

    <p class="text-gray-300">Remark 1. To show that one step of Zorro must have active S-boxes, in the submission paper [7] (Section 4.2 and Appendix I) was given an algorithm that in <span class="math">2^{32}</span> time checks exhaustively all possible high probability characteristics. Our above approach used in the proof of the lemma provides the same result much faster. A 4-round differential characteristic has no active S-boxes only when the system <span class="math">A \\cdot \\tilde{D} = b</span> has a trivial solution. Since <span class="math">b</span> is a zero vector (unlike in the lemma where we compare <span class="math">Q_{j}</span> and <span class="math">Q</span>, in the case of differential characteristics we compare <span class="math">Q_{j}</span> with <span class="math">Q_{j}</span>, thus there is no difference between the constants and <span class="math">b</span> is a zero vector), the only solution is trivial. Non-trivial solutions can be obtained if we allow one S-box to be active - then the (new) system is underdefined (11 equations</p>

    <p class="text-gray-300">with 12 unknowns <span class="math">^3</span> ). It means we can have differential characteristic  <span class="math">\\varDelta_I\\xrightarrow{2^{-4.67}}\\varDelta_O</span>  on one step, and thus related-key differential characteristic on the full cipher with  <span class="math">2^{-28}</span>  and key difference  <span class="math">\\varDelta_I\\oplus\\varDelta_0</span> . We do not pursue this research direction more extensively, as there is no claim of related-key resistance of Zorro.</p>

    <p class="text-gray-300">Remark 2. Obviously, for any choice of the constants used in the four rounds, we can find appropriate  <span class="math">\\nu</span>  and  <span class="math">\\mu</span> . Moreover, a step has an equivalent description even when in each round, the number of constants and their position is chosen arbitrary, i.e. it is not mandatory to have four constants added to the bytes of the top row.</p>

    <p class="text-gray-300">From the lemma it follows that we can replace each  <span class="math">Q_{j}</span>  with  <span class="math">Q</span> , if we add  <span class="math">\\nu_{j}</span>  to the input and  <span class="math">\\mu_{j}</span>  to the output. Let us combine the consecutive constants,  <span class="math">\\mu_{j-1}</span>  from the output of the previous step and  <span class="math">\\nu_{j}</span>  from the input to the next step, into one:</p>

    <div class="my-4 text-center"><span class="math-block">\\tau_ {j} = \\mu_ {j - 1} \\oplus \\nu_ {j}, j = 0, \\dots , 6,</span></div>

    <p class="text-gray-300">where  <span class="math">\\mu_{-1} = \\nu_6 = 0</span> . Then, Zorro can be described as (see Fig. 3):</p>

    <p class="text-gray-300"><span class="math">Z o r r o_{K}(P) = Q_{5}(Q_{4}(Q_{3}(Q_{2}(Q_{1}(Q_{0}(K\\oplus P)\\oplus K)\\oplus K)\\oplus K)\\oplus K)\\oplus K)\\oplus K) =</span></p>

    <p class="text-gray-300"><span class="math">Q(Q(Q(Q(Q(P\\oplus K\\oplus \\tau_0)\\oplus K\\oplus \\tau_1)\\oplus K\\oplus \\tau_2)\\oplus K\\oplus \\tau_3)\\oplus K\\oplus \\tau_4)\\oplus K\\oplus \\tau_5)\\oplus K\\oplus \\tau_6.</span></p>

    <p class="text-gray-300">As a result of the equivalent description, it follows that the 6 steps are identical as they</p>

    <p class="text-gray-300">!<a href="img-3.jpeg">img-3.jpeg</a></p>

    <p class="text-gray-300">!<a href="img-4.jpeg">img-4.jpeg</a></p>

    <p class="text-gray-300">!<a href="img-5.jpeg">img-5.jpeg</a> Fig. 3. The equivalent definitions of Zorro. At the top is the standard definition provided by the designers. At the bottom is our equivalent definition.</p>

    <p class="text-gray-300">do not have addition of constants, and only the subkeys  <span class="math">K \\oplus \\tau_{j}</span>  are different.</p>

    <p class="text-gray-300">In the sequel we analyze Zorro given with the new description, and present an internal differential attack on the cipher. With  <span class="math">\\Delta(X)</span>  we denote the 8-byte internal difference of the 16-byte state  <span class="math">X</span> :</p>

    <p class="text-gray-300">\\[ X=\\begin{pmatrix}x_{1,1}&x_{1,2}&x_{1,3}&x_{1,4}\\\\ x_{2,1}&x_{2,2}&x_{2,3}&x_{2,4}\\\\ x_{3,1}&x_{3,2}&x_{3,3}&x_{3,4}\\\\ x_{4,1}&x_{4,2}&x_{4,3}&x_{4,4}\\end{pmatrix},\\qquad\\Delta(X)=\\begin{pmatrix}x_{1,1}\\oplus x_{1,3}&x_{1,2}\\oplus x_{1,4}\\\\ x_{2,1}\\oplus x_{2,3}&x_{2,2}\\oplus x_{2,4}\\\\ x_{3,1}\\oplus x_{3,3}&x_{3,2}\\oplus x_{3,4}\\\\ x_{4,1}\\oplus x_{4,3}&x_{4,2}\\oplus x_{4,4}\\end{pmatrix}. \\]</p>

    <p class="text-gray-300">In the case when the internal difference in all 8 bytes is zero, we write simply 0, instead of the full form.</p>

    <h2 id="sec-7" class="text-2xl font-bold">4 Techniques to Attack One Step of Zorro</h2>

    <p class="text-gray-300">Before presenting the actual attack, let us explore our options for attacking a single step <span class="math">Q</span> of Zorro. We focus on three techniques, denoted as inactive, active, and Daemen, based on internal differentials.</p>

    <h3 id="sec-8" class="text-xl font-semibold mt-8">4.1 Characteristic with probability 1 [inactive step]</h3>

    <p class="text-gray-300">The best way to attack one step is to use the internal differential characteristic <span class="math">0\\to 0</span> that has no input and no output difference, as input with two equal halves always results in an output with two equal halves. This characteristic holds with probability 1, and it is the only such high probability characteristic. The step where this characteristic is used, is called an inactive step.</p>

    <h3 id="sec-9" class="text-xl font-semibold mt-8">4.2 Characteristic with active S-boxes [active step]</h3>

    <p class="text-gray-300">The second option is to use characteristic with input difference <span class="math">\\alpha\\neq 0</span>, that in four rounds of the step goes through active S-boxes. The maximal number of active S-boxes in any step characteristic is only 8 – this comes from the fact that we work with half states, and in each round only the top row (that consists of two bytes), goes through S-boxes. Hence, an internal differential characteristic on one step, with an arbitrary input difference <span class="math">\\alpha</span>, has at most 8 active S-boxes and a probability of at least <span class="math">2^{-8\\cdot 7}=2^{-56}</span>.</p>

    <p class="text-gray-300">It is important, however, for any starting <span class="math">\\alpha</span> to find the best (highest probability) characteristic on one step and thus reduce the complexity of the attack. We search for the best characteristic by branching on the active S-boxes. That is, we build a search tree, the root being the input difference <span class="math">\\alpha</span>, propagate the difference, and each time we have an S-box with input byte difference, we try all possible output differences – on average, there are <span class="math">2^{6.67}</span> differences. To speed up the search method which in the worse case requires <span class="math">2^{6.67\\cdot 8}\\approx 2^{53}</span> time, we use heuristic based on the probability of the previously found characteristics and the current number of active S-boxes in the branch of the tree.</p>

    <h3 id="sec-10" class="text-xl font-semibold mt-8">4.3 Daemen’s attack on Even-Mansour [Daemen step]</h3>

    <p class="text-gray-300">The last step (only!) can be attacked with a technique that resembles Daemen’s attack <em>[4]</em> on the Even-Mansour construction <em>[6]</em>. This technique has two main advantages: 1) it can be applied even when the characteristic for the previous steps has a probability only slightly higher than <span class="math">2^{-n}</span>, where <span class="math">n</span> is the size of the key space, and 2) it recovers the key that is added to the output of the step.</p>

    <p class="text-gray-300">First, let us recall the Even-Mansour (EM) construction and the proposed attack by Daemen. The EM construction <span class="math">E_{K_{1},K_{2}}(P)</span> is a cipher with <span class="math">n</span>-bit state and <span class="math">2n</span>-bit key <span class="math">K_{1},K_{2}</span>, based upon a public permutation <span class="math">Q</span>, and defined as <span class="math">E_{K_{1},K_{2}}(P)=Q(P\\oplus K_{1})\\oplus K_{2}</span>. Daemen’s attack on this cipher requires <span class="math">2^{n/2}</span> time and data, and works as follows:</p>

    <ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">

      <li>Fix a random <span class="math">n</span>-bit value <span class="math">\\Delta</span>.</li>

      <li>For <span class="math">2^{n/2}</span> randomly generated pairs <span class="math">(V_{1},V_{2}=V_{1}\\oplus\\Delta)</span>, obtain the corresponding pairs of outputs <span class="math">(W_{1},W_{2})=(Q(V_{1}),Q(V_{2}))</span>, and store in a table <span class="math">T</span> the entries <span class="math">(W_{1}\\oplus W_{2},V_{1},W_{1})</span>.</li>

      <li>For <span class="math">2^{n/2}</span> randomly generated pairs of plaintexts <span class="math">(P_{1},P_{2}=P_{1}\\oplus\\Delta)</span>, ask the corresponding pairs of ciphertexts <span class="math">(C_{1},C_{2})=(E_{K_{1},K_{2}}(P_{1}),E_{K_{1},K_{2}}(P_{2}))</span>, and check if for any pair the difference in the ciphertexts <span class="math">C_{1}\\oplus C_{2}</span> coincides with some difference <span class="math">W_{1}\\oplus W_{2}</span> of the entries stored in <span class="math">T</span>. If so, then guess the keys: <span class="math">K_{1}=P_{1}\\oplus V_{1},K_{2}=W_{1}\\oplus C_{1}</span>.</li>

    </ol>

    <p class="text-gray-300">The key idea that characterizes the attack and makes it valid is the fact that when <span class="math">Q</span> is a random permutation, for each output difference <span class="math">\\nabla</span> on average there is only one good input pair <span class="math">(V_{1},V_{1}\\oplus\\Delta)</span>. As <span class="math">\\Delta</span> is fixed and the key <span class="math">K_{1}</span> is bitwisely added to the plaintext, one only has to be sure that some of <span class="math">P_{1}\\oplus K_{1}</span> will collide with some <span class="math">V_{1}</span> – then the related plaintext <span class="math">P_{2}=P_{1}\\oplus\\Delta</span> after the addition of <span class="math">K_{1}</span> will result in the second <span class="math">V_{2}=V_{1}\\oplus\\Delta</span>. The collision space is <span class="math">n</span> bits, therefore any <span class="math">0\\leq t\\leq n</span>, <span class="math">2^{n-t}</span> pairs of plaintext and <span class="math">2^{t}</span> pairs of inputs to <span class="math">Q</span>, will result in a collision. After the collision, the output of <span class="math">Q</span> must coincide with the precomputed entry from the table (due to the above key idea), and therefore, the ciphertext difference is used to detect the collision and to recover the two keys.</p>

    <p class="text-gray-300">Let us adapt Daemen’s attack to the case of internal differences (instead of differences between states). Assume we have a construction <span class="math">E_{K}(P)</span> defined as <span class="math">E_{K}(P)=Q(P\\oplus(K\\oplus a))\\oplus(K\\oplus b)</span>, that is, we have a single key <span class="math">K</span>, and the two subkeys are produced by adding the constants <span class="math">a,b</span> to the key <span class="math">K</span>. Obviously this construction resembles Zorro’s step permutation <span class="math">Q</span> with two subkeys added at the beginning and at the end. Assume further that we know the internal difference <span class="math">\\kappa</span> of the key <span class="math">K</span>, i.e. <span class="math">\\Delta(K)=\\kappa</span>. Then we launch the following key recovery attack:</p>

    <ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">

      <li>Fix a random <span class="math">\\frac{n}{2}</span>-bit value <span class="math">\\delta</span>.</li>

      <li>For <span class="math">2^{n/4}</span> randomly generated inputs <span class="math">V</span> with internal difference <span class="math">\\Delta(V)=\\delta</span>, obtain the corresponding outputs <span class="math">W=Q(V)</span>, and store in a table <span class="math">T</span> the entries <span class="math">(\\Delta(W),W)</span>.</li>

      <li>For <span class="math">2^{n/4}</span> randomly generated plaintexts <span class="math">P</span> with internal difference <span class="math">\\Delta(P)=\\delta\\oplus\\kappa\\oplus\\Delta(a)</span> ask the corresponding ciphertexts <span class="math">C=E_{K}(P)</span>, and check if for some ciphertext <span class="math">C</span>, the internal difference <span class="math">\\Delta(C)\\oplus\\kappa\\oplus\\Delta(b)</span> coincides with some difference <span class="math">\\Delta(W)</span> of the entries stored in <span class="math">T</span>. If so, then guess the key: <span class="math">K=W\\oplus C\\oplus b</span>.</li>

    </ol>

    <p class="text-gray-300">In the above case the collisions space is only <span class="math">\\frac{n}{2}</span> bits. The way we generate the plaintexts assures that after the addition of the first subkey <span class="math">K\\oplus a</span> to the plaintext <span class="math">P</span>, the internal difference of the resulting state is <span class="math">\\Delta(P)\\oplus\\Delta(K)\\oplus\\Delta(a)=(\\delta\\oplus\\kappa\\oplus\\Delta(a))\\oplus\\kappa\\oplus\\Delta(a)=\\delta</span>. As we have <span class="math">2^{n/4}</span> randomly chosen values <span class="math">V</span> at step 2, <span class="math">2^{n/4}</span> values <span class="math">P</span> at step 3, and the collision space is <span class="math">\\frac{n}{2}</span> bits, a collision will occur with a high probability. Thus at the output of <span class="math">Q</span>, the internal difference will become <span class="math">\\Delta(W)</span>, and after the second key addition, it will become <span class="math">\\Delta(W)\\oplus\\kappa\\oplus\\Delta(b)</span>.</p>

    <p class="text-gray-300">We note that the attack works for any chosen <span class="math">\\delta</span>. Moreover, even when the value of the plaintext is unknown (but has the predefined internal difference), we can still recover the key – Daemen’s classical attack requires the knowledge of the plaintext only because EM uses two different keys, whereas our scheme has only one key, which can be recovered from the ciphertext. Finally, as in Daemen’s attack, the tradeoff of <span class="math">2^{\\frac{n}{2}-t}</span> plaintexts, and</p>

    <p class="text-gray-300"><span class="math">2^{t}</span>  offline entries for  <span class="math">T</span> , leads to an attack with  <span class="math">\\max(2^{\\frac{n}{2} - t}, 2^{t})</span>  time,  <span class="math">2^{\\frac{n}{2} - t}</span>  data, and  <span class="math">2^{t}</span>  memory.</p>

    <p class="text-gray-300">Daemen's attack requires the permutation to be random, but in Zorro, the step  <span class="math">Q</span>  is not random as for any input internal difference  <span class="math">\\delta</span> , exists a characteristic with probability of at least  <span class="math">2^{-56}</span> . For the attack, this means that there will be false positives for the key guesses - if  <span class="math">\\Delta(C) \\oplus \\kappa \\oplus \\Delta(b)</span>  coincides with some  <span class="math">\\Delta(W)</span> , the key is not necessarily  <span class="math">W \\oplus C \\oplus b</span> . Nevertheless, on average the number of false positives does not change - more false positives per  <span class="math">\\Delta(W)</span> , but lower number of different  <span class="math">\\Delta(W)</span> . Hence the complexity of attack stays the same (if there is a collision on  <span class="math">P \\oplus K \\oplus a</span>  and  <span class="math">V</span>  then the output of  <span class="math">Q</span>  must be in the table), and the key still can be recovered.</p>

    <p class="text-gray-300">When  <span class="math">Q</span>  is not random, in the offline stage of the attack (during the creation of the table  <span class="math">T</span> ), we might get collisions on the output difference, i.e. several different  <span class="math">V_{1}, V_{2}, \\ldots, V_{j}</span>  produce the same output internal difference, i.e.  <span class="math">\\Delta(Q(V_{1})) = \\Delta(Q(V_{2})) = \\ldots = \\Delta(Q(V_{j}))</span> . We do not discard such values, but store all of them in the table, i.e. we threat them as if they were different (as in the case of random  <span class="math">Q</span> ). When for a ciphertext  <span class="math">C</span> , the condition  <span class="math">\\Delta(C) \\oplus \\kappa \\oplus \\Delta(b) = \\Delta(W)</span>  holds, we guess the key  <span class="math">K = W_{j} \\oplus C \\oplus b</span> , for all  <span class="math">W_{j}, \\Delta(W_{j}) = \\Delta(W)</span>  stored in the table. This means that even when  <span class="math">Q</span>  is not random, the complexity of the attack stays the same.</p>

    <p class="text-gray-300">Our attack on the full, 6-step Zorro is based on internal differentials. We use a high probability internal differential characteristic on 5 steps, and append an additional step, to obtain 6-step key recovery attack. The 5 steps of the characteristic are passed with inactive and active techniques, while in the last step we apply Daemen. A high level view of the step-by-step attack is active-active-inactive-inactive-active-Daemen.</p>

    <p class="text-gray-300">Before we present the attack, let us clarify the decision of choosing the above 6-step strategy. First, note that Daemen must be used in the last step as only then this technique can recover the secret key. As a result, for the remaining 5 steps we need to build an internal differential characteristic, based either on inactive or on active. As inactive step in comparison to active step, has probability 1, to maximize the probability of the whole 5-step characteristic (and thus reduce the complexity of the attack), we want to use as many inactive steps as possible. Two consecutive steps can be inactive only if there is no internal difference in the subkey that is added between the steps. For example, if we use inactive in the first two steps of Zorro (see Fig .4), then the internal difference of the subkey  <span class="math">K \\oplus \\tau_{1}</span>  should be zero, that is  <span class="math">\\Delta(K) = \\Delta(\\tau_{1})</span> . Hence by focusing on  <span class="math">2^{64}</span></p>

    <p class="text-gray-300">!<a href="img-6.jpeg">img-6.jpeg</a> Fig. 4. The inactive-inactive characteristic for the first two steps, when  <span class="math">\\Delta(K) = \\Delta(\\tau_1)</span> .</p>

    <p class="text-gray-300">(out of  <span class="math">2^{128}</span> ) keys that have this specific internal difference, we can always apply inactive in two consecutive steps. However, extending it to three steps is not possible as then we need to limit the keys to both  <span class="math">\\Delta(K) = \\Delta(\\tau_1)</span>  and  <span class="math">\\Delta(K) = \\Delta(\\tau_2)</span> , which is an empty</p>

    <p class="text-gray-300">!<a href="img-7.jpeg">img-7.jpeg</a> Fig. 5. The individual step techniques used in the single-key attack on Zorro. The non-zero values  <span class="math">\\alpha, \\lambda, \\eta, \\xi, \\psi, \\omega, \\gamma</span>  are the internal differences of the state and are given in Appendix B. The internal difference of  <span class="math">K \\oplus \\tau_3</span>  is zero.</p>

    <p class="text-gray-300">set. Furthermore, having non-consecutive inactive steps does not give an advantage as well. For example, if we use inactive in steps 1 and 2 as before, but also in step 4, i.e. inactive-inactive-active-inactive, then the characteristic in step 3 may have a probability as low as  <span class="math">0^7</span> . Therefore, we can have only two inactive steps, and they have to be consecutive. We choose these steps to be 2 and 3, as the other combinations lead to characteristics with lower probabilities.</p>

    <p class="text-gray-300">Now we are ready to present the attack. We only note that in the 5-step characteristic  <span class="math">\\alpha \\rightarrow \\gamma</span> , where  <span class="math">\\alpha</span>  is the internal difference at the input of the first step and  <span class="math">\\gamma</span>  is the difference at the input of the last step, holds with probability  <span class="math">2^{-44.5}</span> , and the active steps were found with an automatic search method (similar to the method described in Sec. 4.2). The attack based on this characteristic is as follows:</p>

    <ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">

      <li>For  <span class="math">2^{54.25}</span>  randomly generated inputs  <span class="math">V</span>  with internal difference  <span class="math">\\gamma</span> , obtain the corresponding outputs  <span class="math">W = Q(V)</span> , and store in a table  <span class="math">T</span>  the entries  <span class="math">(\\Delta(W), W)</span> .</li>

      <li>For  <span class="math">2^{54.25}</span>  randomly generated plaintexts  <span class="math">P</span>  with internal difference  <span class="math">\\alpha \\oplus \\Delta(\\tau_3) \\oplus \\Delta(\\tau_0)</span>  ask for the corresponding ciphertexts  <span class="math">C</span> , and check if for some ciphertext  <span class="math">C</span> , the internal difference  <span class="math">\\Delta(C) \\oplus \\Delta(\\tau_3) \\oplus \\Delta(\\tau_6)</span>  coincides with some differences  <span class="math">\\Delta(W)</span>  of the entries stored in  <span class="math">T</span> . For all such entries  <span class="math">(\\Delta(W), W)</span> , guess the key:  <span class="math">K = W \\oplus C \\oplus \\tau_6</span> .</li>

    </ol>

    <p class="text-gray-300">Among  <span class="math">2^{54.25}</span>  plaintexts,  <span class="math">2^{9.75}</span>  will have the required internal difference  <span class="math">\\gamma</span>  at the input of step 6, and matched against  <span class="math">2^{54.25}</span>  precomputed entries from  <span class="math">T</span> , one will result in a collision, and thus the key can be recovered. We note that there will be around  <span class="math">2^{54.25 + 54.25 - 64} = 2^{44.5}</span>  false positives for the key guesses, but the wrong keys can be discarded by checking them on another pair of plaintext-ciphertext. Therefore, the complexity to recover the full key that belongs to the class of  <span class="math">2^{64}</span>  keys with internal difference  <span class="math">\\Delta(\\tau_3)</span> , is  <span class="math">2^{54.25}</span>  time, data, and memory. The amount of data can be reduced in a tradeoff for memory and higher complexity.</p>

    <p class="text-gray-300">Computer verification. We have implemented and tested the attack details on a computer. The complexity of  <span class="math">2^{54.25}</span>  is too high to launch the attack as a whole, but the two separated parts, the characteristic active-active-inactive-inactive-active for the first five steps, and Daemen's attack on the last step, can be checked. In addition, we have tested the attack on a reduced-size Zorro.</p>

    <p class="text-gray-300">To confirm the characteristic is valid, we have produced examples of key, plaintext, and corresponding ciphertext, that have internal differences as specified by the characteristic.</p>

    <p class="text-gray-300">The examples of such tuples are given in Appendix C, and were produced by finding a state that follows the characteristic in step 4, and then randomizing the key and checking if the resulting internal difference in the plaintext is as required – the complexity of finding a single tuple is <span class="math">2^{28.5}</span>.</p>

    <p class="text-gray-300">We have tested Daemen in step 6 with subkeys <span class="math">K \\oplus \\tau_5, K \\oplus \\tau_6</span>, and with input internal difference as the one of the attack, that is, <span class="math">\\gamma \\oplus \\Delta(\\tau_3) \\oplus \\Delta(\\tau_5)</span>. In the first experiment, we used <span class="math">2^{30}</span> offline entries, and were able to find the key after <span class="math">2^{31.1}</span> encryptions, whereas the expected time complexity was <span class="math">2^{34}</span>. In the second experiment, we wanted to confirm that the non-randomness of <span class="math">Q</span> has no impact on the time complexity of the attack. We reduced the state size to 64 bits (discarded the first two rows in the plaintext, the key, and the ciphertext) and used <span class="math">2^{28}</span> offline entries in <span class="math">T</span>. There were around <span class="math">2^{27.87}</span> different <span class="math">\\Delta(W)</span> in the table, hence on average around 1.1 per <span class="math">\\Delta(W)</span>. The key was recovered after <span class="math">9 = 2^{3.2}</span> encryptions, with no false positives, whereas the expected time is <span class="math">16 = 2^4</span> encryptions.</p>

    <p class="text-gray-300">The whole attack idea was tested on a reduced-size Zorro, where the bytes were replaced with 4-bit nibbles. This type of cipher is very similar to LED-64, thus we tweaked LED-64 to mimic Zorro: we removed the S-boxes from all but the first row, removed the constants from the rounds, and added random constants to the subkeys. Then, in a inactive-inactive-active-Daemen attack<span class="math">^{8}</span>, we chose an arbitrary differential characteristic<span class="math">^{9}</span> to the for the active step that holds with probability <span class="math">2^{-23}</span>, created <span class="math">2^{27}</span> entries for the table <span class="math">T</span>, and after encrypting around <span class="math">2^{26.5}</span> plaintexts (the expected time/data is <span class="math">2^{28}</span>), recover the key.</p>

    <p class="text-gray-300">These experiments confirm the correctness of our attack to a large extent.</p>

    <h2 id="sec-12" class="text-2xl font-bold">6 Lessons Learned</h2>

    <p class="text-gray-300">We can investigate possible tweaks that stop our attack, but this is trivial – the S-box should be applied to bytes that belong to different rows. Then in the internal differential characteristic each round can have 4 active S-boxes (instead of only 2), and thus much lower probability. As the generic complexity is only <span class="math">2^{64}</span>, characteristics on higher number of rounds will be avoided. Instead of proposing other similar tweaks for Zorro, we find it far more important to share our insights that we have obtained during the cryptanalysis and the lessons we have learned, as they will be helpful to both designers and cryptanalysts.</p>

    <p class="text-gray-300">Zorro is the first cipher that uses incomplete S-box layer, where not all the bytes go through S-boxes, but we may expect more such designs to appear. As we have seen, this type of constructions can be redefined – the initial constants can be removed from the rounds and related constants added outside. Such definition (or dual description) can provide better insight of the security. For example, even if we apply the above tweak to Zorro, the cipher would still permit redefinition and thus it can be seen as cipher with 6 equal steps and 7 subkeys <span class="math">K \\oplus \\tilde{\\tau}_0, \\ldots, K \\oplus \\tilde{\\tau}_6</span>. This construction is weaker than the SEM construction of Dunkelman et al. [5], as it is a particular instance of SEM. Therefore, an attack generic not to SEM (as pointed out by the designers), but to the instance of SEM, could penetrate more than three steps. The redefinition depends on the number of S-boxes used per round. In Zorro, the freedom of 16 input bytes, coincided with the 16 conditions on the bytes that go through S-box in one step, and thus the related constants could be merged and put as a part of the subkey. Increasing the step to five rounds seems an easy</p>

    <p class="text-gray-300"><span class="math">^{8}</span> For a randomly chosen constants, 6-step attack is not always possible. We took inactive-inactive-active-Daemen as is completely reflects our attack idea: use two consecutive inactive, add as many active as possible (in this case only one), and append Daemen step at the end.</p>

    <p class="text-gray-300"><span class="math">^{9}</span> A characteristic with a lower probability was chosen on purpose to mimic the <span class="math">2^{-44.5}</span> characteristic used in the attack on the original Zorro.</p>

    <p class="text-gray-300">way to prevented this, but then the designers should be careful and make sure that the related constants after four rounds go through S-boxes in the additional fifth round, and hence the redefinition holds only with some probability. Even then, it may be beneficial for the attacker to pay the probability to have the redefinition, thus the designers should take into account this outcome.</p>

    <p class="text-gray-300">Let us focus now on the round constants used in Zorro. From Remark 2 it follows that the constants always can be put outside of the step and added to the subkeys. Hence, one step can always be inactive, and two consecutive steps can be inactive when the key has predefined internal difference. Furthermore, an additional step can always be passed as the probability of the internal differential characteristic in one step is at least <span class="math">2^{-56}</span>. Finally, we can add one more step where we use Daemen, and launch inactive-inactive-active-Daemen attack. Therefore, for any choice of the constants, we can attack 4-step Zorro-like cipher. The constants, however, have a significant impact on extending the attack beyond 4 steps. We have discovered this, when we tried to find the best one-step characteristic that has randomly chosen input difference – unsurprisingly, on average such characteristic has around 4 active S-boxes. On the other hand, the constants used in Zorro are not random (in round <span class="math">i</span>, they are <span class="math">i,i,i,i\\lll 3</span>), and it is due to them that the 5-step characteristic used in the attack has a high probability. Therefore, <em>2/3 of rounds in the cipher are weak due to the above generic attack, but the last 1/3 failed due to the bad choice of the constants</em>. This means that, although it is tempting to use constants that are possibly cheap to implement, their choice is still sensitive to certain attacks, and the mere use of making all rounds different should not be seen as the only requirement of the round constants. Instead, they should be evaluated against internal differential attacks and even against slide attacks, which surprisingly might work if exists a high probability slide differential characteristic.</p>

    <p class="text-gray-300">Finally, let us take another look at Daemen’s attack used as a part of larger attack such as ours on Zorro, or Mendel et al.’s on LED-64 – we call this application <em>Daemen’s key filtration (DKF)</em>, as this technique allows to recover the last subkey, by filtering the ciphertexts with a particular difference (either internal difference as in our case, or standard difference as in the case of Mendel et al.). <em>The only requirement of DKF is that the probability of the characteristic before the last public permutation (round or step, with no subkeys) does not exceed <span class="math">2^{-n}</span></em>. Thus any differential characteristic can be extended for an additional round at the end, as long as its probability is above <span class="math">2^{-n}</span>. Take for instance, the well known property of AES that any 4-round characteristic has at least 25 active S-boxes and thus at most <span class="math">2^{-150}</span> probability. It means we cannot use characteristic on 4 rounds for an attack, but when we switch to 3-round characteristic (with configuration of 4-1-4 active S-boxes, and a probability of at least <span class="math">2^{-9\\cdot 7}=2^{-63}&gt;2^{-128}</span>), extended with an additional round of DKF (where it is irrelevant that the characteristic has 16 active S-boxes), we have a key recovery on 4-round AES based on differentials. The impact of DKF is even stronger in ciphers such as LED and Zorro, where the last public permutation consists of several rounds grouped into a step – the whole last step can be skipped if the characteristic on the previous steps is with higher probability. Thus when analyzing the resistance of the cipher against differentials, we should keep in mind that a differential attack is at least on one step longer than the best characteristic. In the case of Zorro, it is not excluded the existence of a characteristic on 12 rounds (as the probability has not yet reached <span class="math">2^{-128}</span>), thus a 16-round attack based on classical differential analysis may be possible.</p>

    <p class="text-gray-300">Acknowledgements</p>

    <p class="text-gray-300">The authors would like to thank François-Xavier Standaert for helpful comments and discussions. The work in this paper is supported by the Singapore National Research Foundation Fellowship 2012 (NRF-NRFF2012-06).</p>

    <h2 id="sec-13" class="text-2xl font-bold">References</h2>

    <ul class="list-disc list-inside space-y-1 text-gray-300 my-2 ml-4">

      <li>[1] A. Biryukov and D. Khovratovich. Related-key cryptanalysis of the full AES-192 and AES-256. In M. Matsui, editor, ASIACRYPT, volume 5912 of Lecture Notes in Computer Science, pages 1–18. Springer, 2009.</li>

      <li>[2] A. Biryukov, D. Khovratovich, and I. Nikolic. Distinguisher and related-key attack on the full AES-256. In S. Halevi, editor, CRYPTO, volume 5677 of Lecture Notes in Computer Science, pages 231–249. Springer, 2009.</li>

      <li>[3] J. Choy, A. Zhang, K. Khoo, M. Henricksen, and A. Poschmann. AES variants secure against related-key differential and boomerang attacks. In C. A. Ardagna and J. Zhou, editors, WISTP, volume 6633 of Lecture Notes in Computer Science, pages 191–207. Springer, 2011.</li>

      <li>[4] J. Daemen. Limitations of the Even-Mansour construction. In Imai et al. <em>[9]</em>, pages 495–498.</li>

      <li>[5] O. Dunkelman, N. Keller, and A. Shamir. Minimalism in cryptography: The Even-Mansour scheme revisited. In D. Pointcheval and T. Johansson, editors, EUROCRYPT, volume 7237 of Lecture Notes in Computer Science, pages 336–354. Springer, 2012.</li>

      <li>[6] S. Even and Y. Mansour. A construction of a cioher from a single pseudorandom permutation. In Imai et al. <em>[9]</em>, pages 210–224.</li>

      <li>[7] B. Gérard, V. Grosso, M. Naya-Plasencia, and F.-X. Standaert. Block ciphers that are easier to mask: How far can we go? In G. Bertoni and J.-S. Coron, editors, CHES, volume 8086 of Lecture Notes in Computer Science, pages 383–399. Springer, 2013.</li>

      <li>[8] J. Guo, T. Peyrin, A. Poschmann, and M. J. B. Robshaw. The LED block cipher. In B. Preneel and T. Takagi, editors, CHES, volume 6917 of Lecture Notes in Computer Science, pages 326–341. Springer, 2011.</li>

      <li>[9] H. Imai, R. L. Rivest, and T. Matsumoto, editors. Advances in Cryptology - ASIACRYPT ’91, International Conference on the Theory and Applications of Cryptology, Fujiyoshida, Japan, November 11-14, 1991, Proceedings, volume 739 of Lecture Notes in Computer Science. Springer, 1993.</li>

      <li>[10] L. R. Knudsen, G. Leander, A. Poschmann, and M. J. B. Robshaw. PRINTcipher: A block cipher for ic-printing. In S. Mangard and F.-X. Standaert, editors, CHES, volume 6225 of Lecture Notes in Computer Science, pages 16–32. Springer, 2010.</li>

      <li>[11] G. Leander, M. A. Abdelraheem, H. AlKhzaimi, and E. Zenner. A cryptanalysis of PRINTcipher: The invariant subspace attack. In P. Rogaway, editor, CRYPTO, volume 6841 of Lecture Notes in Computer Science, pages 206–221. Springer, 2011.</li>

      <li>[12] F. Mendel, V. Rijmen, D. Toz, and K. Varici. Differential analysis of the LED block cipher. In X. Wang and K. Sako, editors, ASIACRYPT, volume 7658 of Lecture Notes in Computer Science, pages 190–207. Springer, 2012.</li>

      <li>[13] I. Nikolic. Tweaking AES. In A. Biryukov, G. Gong, and D. R. Stinson, editors, Selected Areas in Cryptography, volume 6544 of Lecture Notes in Computer Science, pages 198–210. Springer, 2010.</li>

      <li>[14] T. Peyrin. Improved differential attacks for ECHO and Grøstl. In T. Rabin, editor, CRYPTO, volume 6223 of Lecture Notes in Computer Science, pages 370–392. Springer, 2010.</li>

    </ul>

    <p class="text-gray-300">Table 1. The values of the constants  <span class="math">{\\nu }_{i},{\\mu }_{i},{\\tau }_{i}</span>  .</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">ν0</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">τ0=ν0</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

          </tr>

        </thead>

        <tbody>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">00</td>

            <td class="px-3 py-2 border-b border-gray-700">00</td>

            <td class="px-3 py-2 border-b border-gray-700">00</td>

            <td class="px-3 py-2 border-b border-gray-700">00</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">00</td>

            <td class="px-3 py-2 border-b border-gray-700">00</td>

            <td class="px-3 py-2 border-b border-gray-700">00</td>

            <td class="px-3 py-2 border-b border-gray-700">00</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">99</td>

            <td class="px-3 py-2 border-b border-gray-700">b4</td>

            <td class="px-3 py-2 border-b border-gray-700">bd</td>

            <td class="px-3 py-2 border-b border-gray-700">80</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">99</td>

            <td class="px-3 py-2 border-b border-gray-700">b4</td>

            <td class="px-3 py-2 border-b border-gray-700">bd</td>

            <td class="px-3 py-2 border-b border-gray-700">80</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">c2</td>

            <td class="px-3 py-2 border-b border-gray-700">a6</td>

            <td class="px-3 py-2 border-b border-gray-700">b2</td>

            <td class="px-3 py-2 border-b border-gray-700">5f</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">c2</td>

            <td class="px-3 py-2 border-b border-gray-700">a6</td>

            <td class="px-3 py-2 border-b border-gray-700">b2</td>

            <td class="px-3 py-2 border-b border-gray-700">5f</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">7a</td>

            <td class="px-3 py-2 border-b border-gray-700">29</td>

            <td class="px-3 py-2 border-b border-gray-700">ef</td>

            <td class="px-3 py-2 border-b border-gray-700">05</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">7a</td>

            <td class="px-3 py-2 border-b border-gray-700">29</td>

            <td class="px-3 py-2 border-b border-gray-700">ef</td>

            <td class="px-3 py-2 border-b border-gray-700">05</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">ν1</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">μ0</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">τ1=μ0 ⊕ ν1</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">00</td>

            <td class="px-3 py-2 border-b border-gray-700">00</td>

            <td class="px-3 py-2 border-b border-gray-700">00</td>

            <td class="px-3 py-2 border-b border-gray-700">00</td>

            <td class="px-3 py-2 border-b border-gray-700">02</td>

            <td class="px-3 py-2 border-b border-gray-700">58</td>

            <td class="px-3 py-2 border-b border-gray-700">02</td>

            <td class="px-3 py-2 border-b border-gray-700">4a</td>

            <td class="px-3 py-2 border-b border-gray-700">02</td>

            <td class="px-3 py-2 border-b border-gray-700">58</td>

            <td class="px-3 py-2 border-b border-gray-700">02</td>

            <td class="px-3 py-2 border-b border-gray-700">4a</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">ef</td>

            <td class="px-3 py-2 border-b border-gray-700">ab</td>

            <td class="px-3 py-2 border-b border-gray-700">7d</td>

            <td class="px-3 py-2 border-b border-gray-700">16</td>

            <td class="px-3 py-2 border-b border-gray-700">8f</td>

            <td class="px-3 py-2 border-b border-gray-700">70</td>

            <td class="px-3 py-2 border-b border-gray-700">f8</td>

            <td class="px-3 py-2 border-b border-gray-700">4d</td>

            <td class="px-3 py-2 border-b border-gray-700">60</td>

            <td class="px-3 py-2 border-b border-gray-700">db</td>

            <td class="px-3 py-2 border-b border-gray-700">85</td>

            <td class="px-3 py-2 border-b border-gray-700">5b</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">93</td>

            <td class="px-3 py-2 border-b border-gray-700">58</td>

            <td class="px-3 py-2 border-b border-gray-700">b8</td>

            <td class="px-3 py-2 border-b border-gray-700">c5</td>

            <td class="px-3 py-2 border-b border-gray-700">8c</td>

            <td class="px-3 py-2 border-b border-gray-700">bb</td>

            <td class="px-3 py-2 border-b border-gray-700">b4</td>

            <td class="px-3 py-2 border-b border-gray-700">3c</td>

            <td class="px-3 py-2 border-b border-gray-700">1f</td>

            <td class="px-3 py-2 border-b border-gray-700">e3</td>

            <td class="px-3 py-2 border-b border-gray-700">0c</td>

            <td class="px-3 py-2 border-b border-gray-700">f9</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">9f</td>

            <td class="px-3 py-2 border-b border-gray-700">8a</td>

            <td class="px-3 py-2 border-b border-gray-700">e7</td>

            <td class="px-3 py-2 border-b border-gray-700">7d</td>

            <td class="px-3 py-2 border-b border-gray-700">f6</td>

            <td class="px-3 py-2 border-b border-gray-700">ec</td>

            <td class="px-3 py-2 border-b border-gray-700">4e</td>

            <td class="px-3 py-2 border-b border-gray-700">93</td>

            <td class="px-3 py-2 border-b border-gray-700">69</td>

            <td class="px-3 py-2 border-b border-gray-700">66</td>

            <td class="px-3 py-2 border-b border-gray-700">a9</td>

            <td class="px-3 py-2 border-b border-gray-700">ee</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">ν2</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">μ1</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">τ2=μ1 ⊕ ν2</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">00</td>

            <td class="px-3 py-2 border-b border-gray-700">00</td>

            <td class="px-3 py-2 border-b border-gray-700">00</td>

            <td class="px-3 py-2 border-b border-gray-700">00</td>

            <td class="px-3 py-2 border-b border-gray-700">3d</td>

            <td class="px-3 py-2 border-b border-gray-700">e8</td>

            <td class="px-3 py-2 border-b border-gray-700">3d</td>

            <td class="px-3 py-2 border-b border-gray-700">c1</td>

            <td class="px-3 py-2 border-b border-gray-700">3d</td>

            <td class="px-3 py-2 border-b border-gray-700">e8</td>

            <td class="px-3 py-2 border-b border-gray-700">3d</td>

            <td class="px-3 py-2 border-b border-gray-700">c1</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">75</td>

            <td class="px-3 py-2 border-b border-gray-700">8a</td>

            <td class="px-3 py-2 border-b border-gray-700">26</td>

            <td class="px-3 py-2 border-b border-gray-700">b7</td>

            <td class="px-3 py-2 border-b border-gray-700">3a</td>

            <td class="px-3 py-2 border-b border-gray-700">6b</td>

            <td class="px-3 py-2 border-b border-gray-700">c0</td>

            <td class="px-3 py-2 border-b border-gray-700">df</td>

            <td class="px-3 py-2 border-b border-gray-700">4f</td>

            <td class="px-3 py-2 border-b border-gray-700">e1</td>

            <td class="px-3 py-2 border-b border-gray-700">e6</td>

            <td class="px-3 py-2 border-b border-gray-700">68</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">60</td>

            <td class="px-3 py-2 border-b border-gray-700">41</td>

            <td class="px-3 py-2 border-b border-gray-700">a6</td>

            <td class="px-3 py-2 border-b border-gray-700">70</td>

            <td class="px-3 py-2 border-b border-gray-700">40</td>

            <td class="px-3 py-2 border-b border-gray-700">3b</td>

            <td class="px-3 py-2 border-b border-gray-700">b3</td>

            <td class="px-3 py-2 border-b border-gray-700">73</td>

            <td class="px-3 py-2 border-b border-gray-700">20</td>

            <td class="px-3 py-2 border-b border-gray-700">7a</td>

            <td class="px-3 py-2 border-b border-gray-700">15</td>

            <td class="px-3 py-2 border-b border-gray-700">03</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">ab</td>

            <td class="px-3 py-2 border-b border-gray-700">74</td>

            <td class="px-3 py-2 border-b border-gray-700">ff</td>

            <td class="px-3 py-2 border-b border-gray-700">f5</td>

            <td class="px-3 py-2 border-b border-gray-700">8e</td>

            <td class="px-3 py-2 border-b border-gray-700">79</td>

            <td class="px-3 py-2 border-b border-gray-700">70</td>

            <td class="px-3 py-2 border-b border-gray-700">4d</td>

            <td class="px-3 py-2 border-b border-gray-700">25</td>

            <td class="px-3 py-2 border-b border-gray-700">0d</td>

            <td class="px-3 py-2 border-b border-gray-700">8f</td>

            <td class="px-3 py-2 border-b border-gray-700">b8</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">ν3</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">μ2</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">τ3=μ2 ⊕ ν3</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">00</td>

            <td class="px-3 py-2 border-b border-gray-700">00</td>

            <td class="px-3 py-2 border-b border-gray-700">00</td>

            <td class="px-3 py-2 border-b border-gray-700">00</td>

            <td class="px-3 py-2 border-b border-gray-700">7c</td>

            <td class="px-3 py-2 border-b border-gray-700">23</td>

            <td class="px-3 py-2 border-b border-gray-700">7c</td>

            <td class="px-3 py-2 border-b border-gray-700">47</td>

            <td class="px-3 py-2 border-b border-gray-700">7c</td>

            <td class="px-3 py-2 border-b border-gray-700">23</td>

            <td class="px-3 py-2 border-b border-gray-700">7c</td>

            <td class="px-3 py-2 border-b border-gray-700">47</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">03</td>

            <td class="px-3 py-2 border-b border-gray-700">95</td>

            <td class="px-3 py-2 border-b border-gray-700">e6</td>

            <td class="px-3 py-2 border-b border-gray-700">21</td>

            <td class="px-3 py-2 border-b border-gray-700">fe</td>

            <td class="px-3 py-2 border-b border-gray-700">46</td>

            <td class="px-3 py-2 border-b border-gray-700">88</td>

            <td class="px-3 py-2 border-b border-gray-700">72</td>

            <td class="px-3 py-2 border-b border-gray-700">fd</td>

            <td class="px-3 py-2 border-b border-gray-700">d3</td>

            <td class="px-3 py-2 border-b border-gray-700">6e</td>

            <td class="px-3 py-2 border-b border-gray-700">53</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">31</td>

            <td class="px-3 py-2 border-b border-gray-700">bf</td>

            <td class="px-3 py-2 border-b border-gray-700">ac</td>

            <td class="px-3 py-2 border-b border-gray-700">ea</td>

            <td class="px-3 py-2 border-b border-gray-700">0f</td>

            <td class="px-3 py-2 border-b border-gray-700">a0</td>

            <td class="px-3 py-2 border-b border-gray-700">ba</td>

            <td class="px-3 py-2 border-b border-gray-700">a2</td>

            <td class="px-3 py-2 border-b border-gray-700">3e</td>

            <td class="px-3 py-2 border-b border-gray-700">1f</td>

            <td class="px-3 py-2 border-b border-gray-700">16</td>

            <td class="px-3 py-2 border-b border-gray-700">48</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">4e</td>

            <td class="px-3 py-2 border-b border-gray-700">d7</td>

            <td class="px-3 py-2 border-b border-gray-700">f7</td>

            <td class="px-3 py-2 border-b border-gray-700">8d</td>

            <td class="px-3 py-2 border-b border-gray-700">06</td>

            <td class="px-3 py-2 border-b border-gray-700">dd</td>

            <td class="px-3 py-2 border-b border-gray-700">32</td>

            <td class="px-3 py-2 border-b border-gray-700">34</td>

            <td class="px-3 py-2 border-b border-gray-700">48</td>

            <td class="px-3 py-2 border-b border-gray-700">0a</td>

            <td class="px-3 py-2 border-b border-gray-700">c5</td>

            <td class="px-3 py-2 border-b border-gray-700">b9</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">ν4</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">μ3</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">τ4=μ3 ⊕ ν4</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">00</td>

            <td class="px-3 py-2 border-b border-gray-700">00</td>

            <td class="px-3 py-2 border-b border-gray-700">00</td>

            <td class="px-3 py-2 border-b border-gray-700">00</td>

            <td class="px-3 py-2 border-b border-gray-700">43</td>

            <td class="px-3 py-2 border-b border-gray-700">93</td>

            <td class="px-3 py-2 border-b border-gray-700">43</td>

            <td class="px-3 py-2 border-b border-gray-700">cc</td>

            <td class="px-3 py-2 border-b border-gray-700">43</td>

            <td class="px-3 py-2 border-b border-gray-700">93</td>

            <td class="px-3 py-2 border-b border-gray-700">43</td>

            <td class="px-3 py-2 border-b border-gray-700">cc</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">5a</td>

            <td class="px-3 py-2 border-b border-gray-700">c8</td>

            <td class="px-3 py-2 border-b border-gray-700">90</td>

            <td class="px-3 py-2 border-b border-gray-700">ee</td>

            <td class="px-3 py-2 border-b border-gray-700">4b</td>

            <td class="px-3 py-2 border-b border-gray-700">5d</td>

            <td class="px-3 py-2 border-b border-gray-700">b0</td>

            <td class="px-3 py-2 border-b border-gray-700">e0</td>

            <td class="px-3 py-2 border-b border-gray-700">11</td>

            <td class="px-3 py-2 border-b border-gray-700">95</td>

            <td class="px-3 py-2 border-b border-gray-700">20</td>

            <td class="px-3 py-2 border-b border-gray-700">0e</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">9d</td>

            <td class="px-3 py-2 border-b border-gray-700">73</td>

            <td class="px-3 py-2 border-b border-gray-700">9a</td>

            <td class="px-3 py-2 border-b border-gray-700">01</td>

            <td class="px-3 py-2 border-b border-gray-700">c3</td>

            <td class="px-3 py-2 border-b border-gray-700">20</td>

            <td class="px-3 py-2 border-b border-gray-700">bd</td>

            <td class="px-3 py-2 border-b border-gray-700">ed</td>

            <td class="px-3 py-2 border-b border-gray-700">5e</td>

            <td class="px-3 py-2 border-b border-gray-700">53</td>

            <td class="px-3 py-2 border-b border-gray-700">27</td>

            <td class="px-3 py-2 border-b border-gray-700">ec</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">c3</td>

            <td class="px-3 py-2 border-b border-gray-700">93</td>

            <td class="px-3 py-2 border-b border-gray-700">cf</td>

            <td class="px-3 py-2 border-b border-gray-700">fe</td>

            <td class="px-3 py-2 border-b border-gray-700">7e</td>

            <td class="px-3 py-2 border-b border-gray-700">48</td>

            <td class="px-3 py-2 border-b border-gray-700">0c</td>

            <td class="px-3 py-2 border-b border-gray-700">ea</td>

            <td class="px-3 py-2 border-b border-gray-700">bd</td>

            <td class="px-3 py-2 border-b border-gray-700">db</td>

            <td class="px-3 py-2 border-b border-gray-700">c3</td>

            <td class="px-3 py-2 border-b border-gray-700">14</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">ν5</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">μ4</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">τ5=μ4 ⊕ ν5</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">00</td>

            <td class="px-3 py-2 border-b border-gray-700">00</td>

            <td class="px-3 py-2 border-b border-gray-700">00</td>

            <td class="px-3 py-2 border-b border-gray-700">00</td>

            <td class="px-3 py-2 border-b border-gray-700">fe</td>

            <td class="px-3 py-2 border-b border-gray-700">ae</td>

            <td class="px-3 py-2 border-b border-gray-700">fe</td>

            <td class="px-3 py-2 border-b border-gray-700">50</td>

            <td class="px-3 py-2 border-b border-gray-700">fe</td>

            <td class="px-3 py-2 border-b border-gray-700">ae</td>

            <td class="px-3 py-2 border-b border-gray-700">fe</td>

            <td class="px-3 py-2 border-b border-gray-700">50</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">2c</td>

            <td class="px-3 py-2 border-b border-gray-700">d7</td>

            <td class="px-3 py-2 border-b border-gray-700">50</td>

            <td class="px-3 py-2 border-b border-gray-700">78</td>

            <td class="px-3 py-2 border-b border-gray-700">6d</td>

            <td class="px-3 py-2 border-b border-gray-700">1c</td>

            <td class="px-3 py-2 border-b border-gray-700">18</td>

            <td class="px-3 py-2 border-b border-gray-700">33</td>

            <td class="px-3 py-2 border-b border-gray-700">41</td>

            <td class="px-3 py-2 border-b border-gray-700">cb</td>

            <td class="px-3 py-2 border-b border-gray-700">48</td>

            <td class="px-3 py-2 border-b border-gray-700">4b</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">cc</td>

            <td class="px-3 py-2 border-b border-gray-700">8d</td>

            <td class="px-3 py-2 border-b border-gray-700">90</td>

            <td class="px-3 py-2 border-b border-gray-700">9b</td>

            <td class="px-3 py-2 border-b border-gray-700">91</td>

            <td class="px-3 py-2 border-b border-gray-700">8d</td>

            <td class="px-3 py-2 border-b border-gray-700">a8</td>

            <td class="px-3 py-2 border-b border-gray-700">1b</td>

            <td class="px-3 py-2 border-b border-gray-700">5d</td>

            <td class="px-3 py-2 border-b border-gray-700">00</td>

            <td class="px-3 py-2 border-b border-gray-700">38</td>

            <td class="px-3 py-2 border-b border-gray-700">80</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">26</td>

            <td class="px-3 py-2 border-b border-gray-700">30</td>

            <td class="px-3 py-2 border-b border-gray-700">c7</td>

            <td class="px-3 py-2 border-b border-gray-700">86</td>

            <td class="px-3 py-2 border-b border-gray-700">0d</td>

            <td class="px-3 py-2 border-b border-gray-700">8e</td>

            <td class="px-3 py-2 border-b border-gray-700">b6</td>

            <td class="px-3 py-2 border-b border-gray-700">c6</td>

            <td class="px-3 py-2 border-b border-gray-700">2b</td>

            <td class="px-3 py-2 border-b border-gray-700">be</td>

            <td class="px-3 py-2 border-b border-gray-700">71</td>

            <td class="px-3 py-2 border-b border-gray-700">40</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">μ5</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">τ6=μ5</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">c1</td>

            <td class="px-3 py-2 border-b border-gray-700">1e</td>

            <td class="px-3 py-2 border-b border-gray-700">c1</td>

            <td class="px-3 py-2 border-b border-gray-700">db</td>

            <td class="px-3 py-2 border-b border-gray-700">c1</td>

            <td class="px-3 py-2 border-b border-gray-700">1e</td>

            <td class="px-3 py-2 border-b border-gray-700">c1</td>

            <td class="px-3 py-2 border-b border-gray-700">db</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">d8</td>

            <td class="px-3 py-2 border-b border-gray-700">07</td>

            <td class="px-3 py-2 border-b border-gray-700">20</td>

            <td class="px-3 py-2 border-b border-gray-700">a1</td>

            <td class="px-3 py-2 border-b border-gray-700">d8</td>

            <td class="px-3 py-2 border-b border-gray-700">07</td>

            <td class="px-3 py-2 border-b border-gray-700">20</td>

            <td class="px-3 py-2 border-b border-gray-700">a1</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">5d</td>

            <td class="px-3 py-2 border-b border-gray-700">0d</td>

            <td class="px-3 py-2 border-b border-gray-700">af</td>

            <td class="px-3 py-2 border-b border-gray-700">54</td>

            <td class="px-3 py-2 border-b border-gray-700">5d</td>

            <td class="px-3 py-2 border-b border-gray-700">0d</td>

            <td class="px-3 py-2 border-b border-gray-700">af</td>

            <td class="px-3 py-2 border-b border-gray-700">54</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">75</td>

            <td class="px-3 py-2 border-b border-gray-700">1b</td>

            <td class="px-3 py-2 border-b border-gray-700">88</td>

            <td class="px-3 py-2 border-b border-gray-700">18</td>

            <td class="px-3 py-2 border-b border-gray-700">75</td>

            <td class="px-3 py-2 border-b border-gray-700">1b</td>

            <td class="px-3 py-2 border-b border-gray-700">88</td>

            <td class="px-3 py-2 border-b border-gray-700">18</td>

          </tr>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">The internal differences of the constants  <span class="math">\\tau_{i}, i = 0, \\ldots, 6</span>  are:</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">00 00 24 34 70 f9 95 2c</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">,</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">00 12 e5 80 13 1a c0 88</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">,</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">00 29 a9 89 35 79 aa b5</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">,</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">00 64 93 80 28 57 8d b3</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">,</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">00 5f 31 9b 79 bf 7e cf</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">,</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">00 fe 09 80 65 80 5a fe</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">,</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">00 c5 f8 a6 f2 59 fd 03</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">The internal difference in the master key  <span class="math">K</span>  is  <span class="math">\\varDelta(K)=\\varDelta(\\tau_3)</span> . Therefore, the differences in the 7 subkeys  <span class="math">K\\oplus \\tau_{i}</span>  are:</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">00 64 b7 b4 58 ae 18 9f</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">,</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">00 76 76 00 3b 4d 4d 3b</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">,</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">00 4d 3a 09 1d 2e 27 06</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">,</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">00 00 00 00 00 00 00 00</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">,</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">00 3b a2 1b 51 e8 f3 7c</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">,</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">00 9a 9a 00 4d d7 d7 4d</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">,</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">00 a1 6b 26 da 0e 70 b0</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">The 5-step characteristic is:</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">00 64 14 0a f4 96 de ea</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">⊕Δ(τ0)⊕Δ(τ3)</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">00 00 a3 be ac 38 c6 75</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">1R→</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">00 00 fd d3 62 82 f8 0c</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">1R→</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">00 66 17 84 03 f1 a9 94</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">2-5.4/1R→</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">00 e8 82 46 25 c7 b4 ef</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">2-4.66/1R→</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">00 fd 0c 7d 26 54 a6 a1</th>

          </tr>

        </thead>

        <tbody>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">00 fd 0c 7d 26 54 a6 a1</td>

            <td class="px-3 py-2 border-b border-gray-700">⊕Δ(τ1)⊕Δ(τ3)</td>

            <td class="px-3 py-2 border-b border-gray-700">00 8b 7a 7d 1d 19 eb 9a</td>

            <td class="px-3 py-2 border-b border-gray-700">2-6/1R→</td>

            <td class="px-3 py-2 border-b border-gray-700">00 24 47 18 f2 42 4f da</td>

            <td class="px-3 py-2 border-b border-gray-700">2-5.4/1R→</td>

            <td class="px-3 py-2 border-b border-gray-700">00 00 e7 65 92 70 45 3d</td>

            <td class="px-3 py-2 border-b border-gray-700">1R→</td>

            <td class="px-3 py-2 border-b border-gray-700">00 07 5a 00 1d c8 8d 1d</td>

            <td class="px-3 py-2 border-b border-gray-700">2-7/1R→</td>

            <td class="px-3 py-2 border-b border-gray-700">00 4d 3a 09 1d 2e 27 06</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">00 4d 3a 09 1d 2e 27 06</td>

            <td class="px-3 py-2 border-b border-gray-700">⊕Δ(τ2)⊕Δ(τ3)</td>

            <td class="px-3 py-2 border-b border-gray-700">00 00 00 00 00 00 00 00</td>

            <td class="px-3 py-2 border-b border-gray-700">1R→</td>

            <td class="px-3 py-2 border-b border-gray-700">00 00 00 00 00 00 00 00</td>

            <td class="px-3 py-2 border-b border-gray-700">1R→</td>

            <td class="px-3 py-2 border-b border-gray-700">00 00 00 00 00 00 00 00</td>

            <td class="px-3 py-2 border-b border-gray-700">1R→</td>

            <td class="px-3 py-2 border-b border-gray-700">00 00 00 00 00 00 00 00</td>

            <td class="px-3 py-2 border-b border-gray-700">1R→</td>

            <td class="px-3 py-2 border-b border-gray-700">00 00 00 00 00 00 00 00</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">00 00 00 00 00 00 00 00</td>

            <td class="px-3 py-2 border-b border-gray-700">⊕Δ(τ3)⊕Δ(τ3)</td>

            <td class="px-3 py-2 border-b border-gray-700">00 00 00 00 00 00 00 00</td>

            <td class="px-3 py-2 border-b border-gray-700">1R→</td>

            <td class="px-3 py-2 border-b border-gray-700">00 00 00 00 00 00 00 00</td>

            <td class="px-3 py-2 border-b border-gray-700">1R→</td>

            <td class="px-3 py-2 border-b border-gray-700">00 00 00 00 00 00 00 00</td>

            <td class="px-3 py-2 border-b border-gray-700">1R→</td>

            <td class="px-3 py-2 border-b border-gray-700">00 00 00 00 00 00 00 00</td>

            <td class="px-3 py-2 border-b border-gray-700">1R→</td>

            <td class="px-3 py-2 border-b border-gray-700">00 00 00 00 00 00 00 00</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">00 00 00 00 00 00 00 00</td>

            <td class="px-3 py-2 border-b border-gray-700">⊕Δ(τ4)⊕Δ(τ3)</td>

            <td class="px-3 py-2 border-b border-gray-700">00 3b a2 1b 51 e8 f3 7c</td>

            <td class="px-3 py-2 border-b border-gray-700">2-6/1R→</td>

            <td class="px-3 py-2 border-b border-gray-700">00 c9 b9 15 3d fd b2 02</td>

            <td class="px-3 py-2 border-b border-gray-700">2-5/1R→</td>

            <td class="px-3 py-2 border-b border-gray-700">00 7a 6f 38 69 6a 2c 21</td>

            <td class="px-3 py-2 border-b border-gray-700">2-5/1R→</td>

            <td class="px-3 py-2 border-b border-gray-700">00 00 ea ba 89 39 13 5c</td>

            <td class="px-3 py-2 border-b border-gray-700">1R→</td>

            <td class="px-3 py-2 border-b border-gray-700">00 0f b3 97 57 ad 8b f5</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">00 0f b3 97 57 ad 8b f5</td>

            <td class="px-3 py-2 border-b border-gray-700">⊕Δ(τ5)⊕Δ(τ3)</td>

            <td class="px-3 py-2 border-b border-gray-700">00 95 29 97 1a 7a 5c b8</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

          </tr>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">Table 2. Examples of tuples (plaintext, key, ciphertext) that follow the 5-step characteristic.  <span class="math">\\Delta</span>  stands for internal difference.</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Example 1</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Example 2</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Example 3</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Δ</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

          </tr>

        </thead>

        <tbody>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">Plaintext</td>

            <td class="px-3 py-2 border-b border-gray-700">4e</td>

            <td class="px-3 py-2 border-b border-gray-700">dc</td>

            <td class="px-3 py-2 border-b border-gray-700">4e</td>

            <td class="px-3 py-2 border-b border-gray-700">b8</td>

            <td class="px-3 py-2 border-b border-gray-700">f5</td>

            <td class="px-3 py-2 border-b border-gray-700">de</td>

            <td class="px-3 py-2 border-b border-gray-700">f5</td>

            <td class="px-3 py-2 border-b border-gray-700">ba</td>

            <td class="px-3 py-2 border-b border-gray-700">24</td>

            <td class="px-3 py-2 border-b border-gray-700">0e</td>

            <td class="px-3 py-2 border-b border-gray-700">24</td>

            <td class="px-3 py-2 border-b border-gray-700">6a</td>

            <td class="px-3 py-2 border-b border-gray-700">00</td>

            <td class="px-3 py-2 border-b border-gray-700">64</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">45</td>

            <td class="px-3 py-2 border-b border-gray-700">df</td>

            <td class="px-3 py-2 border-b border-gray-700">51</td>

            <td class="px-3 py-2 border-b border-gray-700">d5</td>

            <td class="px-3 py-2 border-b border-gray-700">62</td>

            <td class="px-3 py-2 border-b border-gray-700">db</td>

            <td class="px-3 py-2 border-b border-gray-700">76</td>

            <td class="px-3 py-2 border-b border-gray-700">d1</td>

            <td class="px-3 py-2 border-b border-gray-700">13</td>

            <td class="px-3 py-2 border-b border-gray-700">5a</td>

            <td class="px-3 py-2 border-b border-gray-700">07</td>

            <td class="px-3 py-2 border-b border-gray-700">50</td>

            <td class="px-3 py-2 border-b border-gray-700">14</td>

            <td class="px-3 py-2 border-b border-gray-700">0a</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">f3</td>

            <td class="px-3 py-2 border-b border-gray-700">fa</td>

            <td class="px-3 py-2 border-b border-gray-700">07</td>

            <td class="px-3 py-2 border-b border-gray-700">6c</td>

            <td class="px-3 py-2 border-b border-gray-700">57</td>

            <td class="px-3 py-2 border-b border-gray-700">3b</td>

            <td class="px-3 py-2 border-b border-gray-700">a3</td>

            <td class="px-3 py-2 border-b border-gray-700">ad</td>

            <td class="px-3 py-2 border-b border-gray-700">3d</td>

            <td class="px-3 py-2 border-b border-gray-700">bd</td>

            <td class="px-3 py-2 border-b border-gray-700">c9</td>

            <td class="px-3 py-2 border-b border-gray-700">2b</td>

            <td class="px-3 py-2 border-b border-gray-700">f4</td>

            <td class="px-3 py-2 border-b border-gray-700">96</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">a8</td>

            <td class="px-3 py-2 border-b border-gray-700">d5</td>

            <td class="px-3 py-2 border-b border-gray-700">76</td>

            <td class="px-3 py-2 border-b border-gray-700">3f</td>

            <td class="px-3 py-2 border-b border-gray-700">4a</td>

            <td class="px-3 py-2 border-b border-gray-700">a7</td>

            <td class="px-3 py-2 border-b border-gray-700">94</td>

            <td class="px-3 py-2 border-b border-gray-700">4d</td>

            <td class="px-3 py-2 border-b border-gray-700">95</td>

            <td class="px-3 py-2 border-b border-gray-700">e6</td>

            <td class="px-3 py-2 border-b border-gray-700">4b</td>

            <td class="px-3 py-2 border-b border-gray-700">0c</td>

            <td class="px-3 py-2 border-b border-gray-700">de</td>

            <td class="px-3 py-2 border-b border-gray-700">ea</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">Key</td>

            <td class="px-3 py-2 border-b border-gray-700">fe</td>

            <td class="px-3 py-2 border-b border-gray-700">e8</td>

            <td class="px-3 py-2 border-b border-gray-700">fe</td>

            <td class="px-3 py-2 border-b border-gray-700">8c</td>

            <td class="px-3 py-2 border-b border-gray-700">56</td>

            <td class="px-3 py-2 border-b border-gray-700">65</td>

            <td class="px-3 py-2 border-b border-gray-700">56</td>

            <td class="px-3 py-2 border-b border-gray-700">01</td>

            <td class="px-3 py-2 border-b border-gray-700">fc</td>

            <td class="px-3 py-2 border-b border-gray-700">c8</td>

            <td class="px-3 py-2 border-b border-gray-700">fc</td>

            <td class="px-3 py-2 border-b border-gray-700">ac</td>

            <td class="px-3 py-2 border-b border-gray-700">00</td>

            <td class="px-3 py-2 border-b border-gray-700">64</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">59</td>

            <td class="px-3 py-2 border-b border-gray-700">40</td>

            <td class="px-3 py-2 border-b border-gray-700">ca</td>

            <td class="px-3 py-2 border-b border-gray-700">c0</td>

            <td class="px-3 py-2 border-b border-gray-700">5c</td>

            <td class="px-3 py-2 border-b border-gray-700">e8</td>

            <td class="px-3 py-2 border-b border-gray-700">cf</td>

            <td class="px-3 py-2 border-b border-gray-700">68</td>

            <td class="px-3 py-2 border-b border-gray-700">8b</td>

            <td class="px-3 py-2 border-b border-gray-700">be</td>

            <td class="px-3 py-2 border-b border-gray-700">18</td>

            <td class="px-3 py-2 border-b border-gray-700">3e</td>

            <td class="px-3 py-2 border-b border-gray-700">93</td>

            <td class="px-3 py-2 border-b border-gray-700">80</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">51</td>

            <td class="px-3 py-2 border-b border-gray-700">d9</td>

            <td class="px-3 py-2 border-b border-gray-700">79</td>

            <td class="px-3 py-2 border-b border-gray-700">8e</td>

            <td class="px-3 py-2 border-b border-gray-700">72</td>

            <td class="px-3 py-2 border-b border-gray-700">1d</td>

            <td class="px-3 py-2 border-b border-gray-700">5a</td>

            <td class="px-3 py-2 border-b border-gray-700">4a</td>

            <td class="px-3 py-2 border-b border-gray-700">03</td>

            <td class="px-3 py-2 border-b border-gray-700">85</td>

            <td class="px-3 py-2 border-b border-gray-700">2b</td>

            <td class="px-3 py-2 border-b border-gray-700">d2</td>

            <td class="px-3 py-2 border-b border-gray-700">28</td>

            <td class="px-3 py-2 border-b border-gray-700">57</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">c5</td>

            <td class="px-3 py-2 border-b border-gray-700">e4</td>

            <td class="px-3 py-2 border-b border-gray-700">48</td>

            <td class="px-3 py-2 border-b border-gray-700">57</td>

            <td class="px-3 py-2 border-b border-gray-700">b1</td>

            <td class="px-3 py-2 border-b border-gray-700">ee</td>

            <td class="px-3 py-2 border-b border-gray-700">3c</td>

            <td class="px-3 py-2 border-b border-gray-700">5d</td>

            <td class="px-3 py-2 border-b border-gray-700">8d</td>

            <td class="px-3 py-2 border-b border-gray-700">4d</td>

            <td class="px-3 py-2 border-b border-gray-700">00</td>

            <td class="px-3 py-2 border-b border-gray-700">fe</td>

            <td class="px-3 py-2 border-b border-gray-700">8d</td>

            <td class="px-3 py-2 border-b border-gray-700">b3</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">Ciphertext</td>

            <td class="px-3 py-2 border-b border-gray-700">03</td>

            <td class="px-3 py-2 border-b border-gray-700">1b</td>

            <td class="px-3 py-2 border-b border-gray-700">03</td>

            <td class="px-3 py-2 border-b border-gray-700">8e</td>

            <td class="px-3 py-2 border-b border-gray-700">68</td>

            <td class="px-3 py-2 border-b border-gray-700">81</td>

            <td class="px-3 py-2 border-b border-gray-700">68</td>

            <td class="px-3 py-2 border-b border-gray-700">14</td>

            <td class="px-3 py-2 border-b border-gray-700">b8</td>

            <td class="px-3 py-2 border-b border-gray-700">97</td>

            <td class="px-3 py-2 border-b border-gray-700">b8</td>

            <td class="px-3 py-2 border-b border-gray-700">02</td>

            <td class="px-3 py-2 border-b border-gray-700">00</td>

            <td class="px-3 py-2 border-b border-gray-700">95</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">60</td>

            <td class="px-3 py-2 border-b border-gray-700">8e</td>

            <td class="px-3 py-2 border-b border-gray-700">49</td>

            <td class="px-3 py-2 border-b border-gray-700">19</td>

            <td class="px-3 py-2 border-b border-gray-700">15</td>

            <td class="px-3 py-2 border-b border-gray-700">c2</td>

            <td class="px-3 py-2 border-b border-gray-700">3c</td>

            <td class="px-3 py-2 border-b border-gray-700">55</td>

            <td class="px-3 py-2 border-b border-gray-700">e5</td>

            <td class="px-3 py-2 border-b border-gray-700">3b</td>

            <td class="px-3 py-2 border-b border-gray-700">cc</td>

            <td class="px-3 py-2 border-b border-gray-700">ac</td>

            <td class="px-3 py-2 border-b border-gray-700">29</td>

            <td class="px-3 py-2 border-b border-gray-700">97</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">2b</td>

            <td class="px-3 py-2 border-b border-gray-700">72</td>

            <td class="px-3 py-2 border-b border-gray-700">31</td>

            <td class="px-3 py-2 border-b border-gray-700">08</td>

            <td class="px-3 py-2 border-b border-gray-700">15</td>

            <td class="px-3 py-2 border-b border-gray-700">07</td>

            <td class="px-3 py-2 border-b border-gray-700">0f</td>

            <td class="px-3 py-2 border-b border-gray-700">7d</td>

            <td class="px-3 py-2 border-b border-gray-700">9b</td>

            <td class="px-3 py-2 border-b border-gray-700">d5</td>

            <td class="px-3 py-2 border-b border-gray-700">81</td>

            <td class="px-3 py-2 border-b border-gray-700">af</td>

            <td class="px-3 py-2 border-b border-gray-700">1a</td>

            <td class="px-3 py-2 border-b border-gray-700">7a</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">16</td>

            <td class="px-3 py-2 border-b border-gray-700">03</td>

            <td class="px-3 py-2 border-b border-gray-700">4a</td>

            <td class="px-3 py-2 border-b border-gray-700">bb</td>

            <td class="px-3 py-2 border-b border-gray-700">6b</td>

            <td class="px-3 py-2 border-b border-gray-700">4e</td>

            <td class="px-3 py-2 border-b border-gray-700">37</td>

            <td class="px-3 py-2 border-b border-gray-700">f6</td>

            <td class="px-3 py-2 border-b border-gray-700">f6</td>

            <td class="px-3 py-2 border-b border-gray-700">64</td>

            <td class="px-3 py-2 border-b border-gray-700">aa</td>

            <td class="px-3 py-2 border-b border-gray-700">dc</td>

            <td class="px-3 py-2 border-b border-gray-700">5c</td>

            <td class="px-3 py-2 border-b border-gray-700">b8</td>

          </tr>

        </tbody>

      </table>

    </div>`;
---

<BaseLayout title="Cryptanalysis of Zorro (2013/713)">
  <article class="max-w-4xl mx-auto article-prose">
    <nav class="mb-8">
      <a href="/papers" class="text-blue-400 hover:text-blue-300">
        &larr; Back to Papers
      </a>
    </nav>

    <header class="mb-12">
      <h1 class="text-3xl font-bold mb-4"
        set:html={TITLE_HTML} />
      <p class="text-gray-400 mb-2"
        set:html={AUTHORS_HTML} />
      <p class="text-gray-500 text-sm mb-4">
        2013 &middot; eprint 2013/713
      </p>
      <div class="flex gap-4 text-sm">
        <a
          href={EPRINT_URL}
          target="_blank"
          rel="noopener noreferrer"
          class="text-blue-400 hover:text-blue-300"
        >
          Paper (eprint) &rarr;
        </a>
      </div>
      <p class="mt-4 text-xs text-gray-500">
        All content below belongs to the original authors. This page
        reproduces the paper for educational purposes. Always
        <a
          href={EPRINT_URL}
          target="_blank"
          rel="noopener noreferrer"
          class="text-blue-400 hover:text-blue-300"
        >cite the original</a>.
      </p>
      <p class="mt-1 text-xs text-gray-600">
        Converted with: {CRAWLER} &middot; {CONVERTED_DATE}
      </p>
    </header>

    <Fragment set:html={CONTENT} />

  </article>
</BaseLayout>
