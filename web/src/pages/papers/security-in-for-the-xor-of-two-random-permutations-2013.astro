---
import BaseLayout from '../../layouts/BaseLayout.astro';
import PaperDisclaimer from '../../components/PaperDisclaimer.astro';
import PaperHistory from '../../components/PaperHistory.astro';

const EPRINT_URL = 'https://eprint.iacr.org/2013/368';
const CRAWLER = 'marker';
const CONVERTED_DATE = '2026-02-18';
const TITLE_HTML = 'Security in $O(2^n)$ for the Xor of Two Random Permutations';
const AUTHORS_HTML = 'Unknown authors';

const CONTENT = `    <p class="text-gray-300">Jacques Patarin Université de Versailles 45 avenue des Etats-Unis 78035 Versailles Cedex - France</p>

    <h4 id="sec-1" class="text-lg font-semibold mt-6">Abstract</h4>

    <p class="text-gray-300">Xoring two permutations is a very simple way to construct pseudorandom functions from pseudorandom permutations. In [13], it is proved that we have security against CPA-2 attacks when  <span class="math">m \\ll O(2^n)</span> , where m is the number of queries and n is the number of bits of the inputs and outputs of the bijections. In this paper, we will obtain similar (but slightly different) results by using the &quot;standard H technique&quot; instead of the &quot; <span class="math">H_{\\sigma}</span>  technique&quot;. It will be interesting to compare the two techniques, their similarities and the differences between the proofs and the results.</p>

    <p class="text-gray-300"><strong>Key words:</strong> Pseudorandom functions, pseudorandom permutations, security beyond the birth-day bound, Luby-Rackoff backwards.</p>

    <h4 id="sec-2" class="text-lg font-semibold mt-6">1 Introduction</h4>

    <p class="text-gray-300">The problem of converting pseudorandom permutations (PRP) into pseudorandom functions (PRF) named &quot;Luby-Rackoff backwards&quot; was first considered in [3]. This problem is obvious if we are interested in an asymptotical polynomial versus non polynomial security model (since a PRP is then a PRF), but not if we are interested in achieving more optimal and concrete security bounds. More precisely, the loss of security when regarding a PRP as a PRF comes from the &quot;birthday attack&quot; which can distinguish a random permutation from a random function of n bits to n bits, in  <span class="math">2^{\\frac{n}{2}}</span>  operations and  <span class="math">2^{\\frac{n}{2}}</span>  queries. Therefore different ways to build PRF from PRP with a security above  <span class="math">2^{\\frac{n}{2}}</span>  and by performing very few computations have been suggested (see [2, 3, 4, 6]). One of the simplest way is simply to Xor k independent pseudorandom permutations, for example with k=2. In [6] (Theorem 2 p.474), it has been proved, with a simple proof, that the Xor of k independent PRP gives a PRF with security at least in  <span class="math">O(2^{\\frac{k}{k+1}n})</span> . (For k=2 this gives  <span class="math">O(2^{\\frac{2}{3}n})</span> ). In [2], a much more complex strategy (based on Azuma inequality and Chernoff bounds) is presented. It is claimed that with this strategy we may prove that the Xor of two PRP gives a PRF with security at least in  <span class="math">O(2^n/n^{\\frac{2}{3}})</span>  and at most in  <span class="math">O(2^n)</span> , which is much better than the birthday bound in  <span class="math">O(2^{\\frac{n}{2}})</span> . However the authors of [2] present a very general framework of proof and they do not give every</p>

    <p class="text-gray-300">details for this result. For example, page 9 they wrote &quot;we give only a very brief summary of how this works&quot;, and page 10 they introduce O functions that are not easy to express explicitly. In this paper we will use a completely different proof strategy, based on the &quot;standard H technique&quot; (see Section 3 below), simple counting arguments and induction. This paper is self contained. It is nevertheless interesting to compare this paper with [13] where similar (but slightly different results, as we will explain) are obtained by using the  <span class="math">H_{\\sigma}</span>  technique instead of the standard H technique.</p>

    <p class="text-gray-300"><strong>Related Problems.</strong> In [14] the best know attacks on the Xor of k random permutations are studied in various scenarios. For k = 2 the bound obtained are near our security bounds. In [7] attacks on the Xor of two <strong>public</strong> permutations are studied (i.e. indifferentiability instead of indistinguishibility).</p>

    <h4 id="sec-3" class="text-lg font-semibold mt-6">Part I</h4>

    <h3 id="sec-4" class="text-xl font-semibold mt-8">2 Notation and Aim of this paper</h3>

    <p class="text-gray-300">In all this paper we will denote  <span class="math">I_n = \\{0,1\\}^n</span> .  <span class="math">F_n</span>  will be the set of all applications from  <span class="math">I_n</span>  to  <span class="math">I_n</span> , and  <span class="math">B_n</span>  will be the set of all permutations from  <span class="math">I_n</span>  to  <span class="math">I_n</span> . Therefore  <span class="math">|I_n| = 2^n</span> ,  <span class="math">|F_n| = 2^{n \\cdot 2^n}</span>  and  <span class="math">|B_n| = (2^n)!</span> .  <span class="math">x \\in_R A</span>  means that x is randomly chosen in A with a uniform distribution.</p>

    <p class="text-gray-300">The aim of this paper is to prove the theorem below, with an explicit O function (to be determined).</p>

    <p class="text-gray-300"><strong>Theorem 1</strong> For all CPA-2 (Adaptive chosen plaintext attack)  <span class="math">\\phi</span>  on a function G of  <span class="math">F_n</span>  with m chosen plaintext, we have:  <span class="math">\\operatorname{Adv}_{\\phi}^{\\operatorname{PRF}} \\leq O(\\frac{m}{2^n})</span>  where  <span class="math">\\operatorname{Adv}_{\\phi}^{\\operatorname{PRF}}</span>  denotes the advantage to distinguish  <span class="math">f \\oplus g</span> , with  <span class="math">f, g \\in_R B_n</span>  from  <span class="math">h \\in_R F_n</span> .</p>

    <p class="text-gray-300">This theorem says that there is no way (with an adaptive chosen plaintext attack) to distinguish with a good probability  <span class="math">f \\oplus g</span>  when  <span class="math">f, g \\in_R B_n</span>  from  <span class="math">h \\in_R F_n</span>  when  <span class="math">m \\ll 2^n</span>  (and this even if we have access to infinite computing power, as long as we have access to only m queries). Therefore, it implies that the number  <span class="math">\\lambda</span>  of computations to distinguish  <span class="math">f \\oplus g</span>  with  <span class="math">f, g \\in_R B_n</span>  from  <span class="math">h \\in_R F_n</span>  satisfies:  <span class="math">\\lambda \\geq O(2^n)</span> . We say also that there is no generic CPA-2 attack with less than  <span class="math">O(2^n)</span>  computations for this problem, or that the security obtained is greater than or equal to  <span class="math">O(2^n)</span> . Since we know (for example from [2] or [14]) that there is an attack in  <span class="math">O(2^n)</span> , Theorem 1 also says that  <span class="math">O(2^n)</span>  is the exact security bound for this problem.</p>

    <p class="text-gray-300">Let  <span class="math">a = (a_i, 1 \\le i \\le m)</span>  be m pairwise distinct values of  <span class="math">I_n</span> .</p>

    <p class="text-gray-300">Let  <span class="math">b = (b_i, 1 \\le i \\le m)</span>  be m values of  <span class="math">I_n</span>  (not necessarily distinct). • We will denote by H(a, b), or by H(b) since we will see that H(a, b) does</p>

    <p class="text-gray-300">• We will denote by H(a,b), or by H(b) since we will see that H(a,b) does not depend on a, the number of  <span class="math">(f,g) \\in B_n^2</span>  such that:  <span class="math">\\forall i, 1 \\leq i \\leq m, (f \\oplus g)(a_i) = b_i</span> . Often we will denote H(b) by</p>

    <p class="text-gray-300"><span class="math">H_m</span>  for simplicity (but H(b) depends on b).</p>

    <h4 id="sec-5" class="text-lg font-semibold mt-6">Introducing h instead of H</h4>

    <ul class="list-disc list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li>We will denote by h(b), or simply by  <span class="math">h_m</span>  for simplicity (but h depends on b) the number of sequences  <span class="math">x_i</span> ,  <span class="math">1 \\le i \\le m</span> ,  <span class="math">x_i \\in I_n</span> , such that:    <ul class="list-disc list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li><ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li>The  <span class="math">x_i</span>  are pairwise distinct,  <span class="math">1 \\le i \\le m</span> .</li>
    </ol></li>
      <li><ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li>The  <span class="math">x_i \\oplus b_i</span>  are pairwise distinct,  <span class="math">1 \\le i \\le m</span> .</li>
    </ol></li>
    </ul></li>
    </ul>

    <h4 id="sec-6" class="text-lg font-semibold mt-6">Theorem 2 We have</h4>

    <p class="text-gray-300"><span class="math">$H(a,b) = h(b) \\cdot \\frac{|B_n|^2}{(2^n(2^n-1)\\dots(2^n-m+1))^2}</span>$</p>

    <p class="text-gray-300">(and therefore H(a,b) does not depend on a, i.e. does not depend on the pairwise distinct values  <span class="math">a_i</span> ,  <span class="math">1 \\le i \\le m</span> ).</p>

    <p class="text-gray-300"><strong>Proof.</strong> When the  <span class="math">x_i</span>  are fixed, f and g are fixed on exactly m pairwise distinct points by  <span class="math">\\forall i, 1 \\le i \\le m</span> ,  <span class="math">f(a_i) = x_i</span>  and  <span class="math">g(a_i) = b_i \\oplus x_i</span> .</p>

    <p class="text-gray-300"><strong>Theorem 3</strong>  <span class="math">h_m</span>  is the number of  <span class="math">(P_1, P_2, \\dots, P_m, Q_1, \\dots, Q_m) \\in I_n^{2m}</span>  such that</p>

    <ul class="list-disc list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li><ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li>The  <span class="math">P_i</span>  are pairwise distinct (i.e.  <span class="math">i \\neq j \\Rightarrow P_i \\neq P_i</span> ).</li>
    </ol></li>
      <li><ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li>The  <span class="math">Q_i</span>  are pairwise distinct (i.e.  <span class="math">i \\neq j \\Rightarrow Q_i \\neq Q_i</span> ).</li>
    </ol></li>
      <li><span class="math">3. \\ \\forall i, \\ 1 \\leq i \\leq m, \\ P_i \\oplus Q_i = b_i.</span></li>
    </ul>

    <p class="text-gray-300"><strong>Proof.</strong> Since  <span class="math">Q_i</span>  is fixed when  <span class="math">P_i</span>  is fixed, Theorem 3 is obvious from the definition of  <span class="math">h_m</span> , i.e. just take  <span class="math">P_i = x_i</span>  and  <span class="math">Q_i = x_i \\oplus b_i</span> .</p>

    <p class="text-gray-300">We will denote by  <span class="math">\\tilde{h_m}</span>  the average of  <span class="math">h_m</span>  when  <span class="math">b \\in_R I_n^m</span> .</p>

    <h4 id="sec-7" class="text-lg font-semibold mt-6">Theorem 4</h4>

    <p class="text-gray-300"><span class="math">$\\tilde{h_m} = \\frac{(2^n(2^n - 1)\\dots(2^n - m + 1))^2}{2^{nm}}</span>$</p>

    <p class="text-gray-300"><strong>Proof.</strong> Let  <span class="math">b = (b_1, \\ldots, b_n)</span> , and  <span class="math">x = (x_1, \\ldots, x_n)</span> . For  <span class="math">x \\in I_n^m</span> , let</p>

    <p class="text-gray-300"><span class="math">$\\delta_x = 1 \\Leftrightarrow \\left\\{ \\begin{array}{ll} \\text{The } x_i \\text{ are pairwise distinct}, &amp; 1 \\leq i \\leq m \\\\ \\text{The } x_i \\oplus b_i \\text{ are pairwise distinct}, &amp; 1 \\leq i \\leq m \\end{array} \\right.</span>$</p>

    <p class="text-gray-300">and  <span class="math">\\delta_x = 0 \\Leftrightarrow \\delta_x \\neq 1</span> . Let  <span class="math">J_n^m</span>  be the set of all sequences  <span class="math">x_i</span>  such that all the  <span class="math">x_i</span>  are pairwise distinct,  <span class="math">1 \\leq i \\leq m</span> . Then  <span class="math">|J_n^m| = 2^n(2^n - 1) \\dots (2^n - m + 1)</span>  and  <span class="math">N = \\sum_{x \\in J_n^m} \\delta_x</span> . So we have  <span class="math">E(h) = \\sum_{x \\in J_n^m} E(\\delta_x)</span> . For  <span class="math">x \\in J_n^m</span> ,</p>

    <p class="text-gray-300"><span class="math">$E(\\delta_x) = Pr_{b \\in_R I_n^m}</span>$
(All the  <span class="math">x_i \\oplus b_i</span>  are pairwise distinct) =  <span class="math">\\frac{2^n (2^n - 1) \\dots (2^n - m + 1)}{2^{nm}}</span></p>

    <p class="text-gray-300">Therefore</p>

    <p class="text-gray-300"><span class="math">$E(h) = |J_n^m| \\cdot \\frac{2^n (2^n - 1) \\dots (2^n - m + 1)}{2^{nm}} = \\frac{(2^n (2^n - 1) \\dots (2^n - m + 1))^2}{2^{nm}}</span>$</p>

    <p class="text-gray-300">as expected.</p>

    <p class="text-gray-300">We will denote by  <span class="math">Adv_m</span>  the best Advantage that we can get in CPA-2 with m queries when we try to distinguish  <span class="math">f \\oplus g</span> , with  <span class="math">f, g \\in_R B_n</span>  from  <span class="math">h \\in_R F_n</span> . As we will see now, there is a very deep connection between  <span class="math">Adv_m</span>  and the coefficients  <span class="math">h_m</span> . More precisely:</p>

    <p class="text-gray-300"><strong>Theorem 5</strong> An exact formula for Adv.</p>

    <p class="text-gray-300">Let  <span class="math">F = \\{(b_1, \\ldots, b_m) \\in I_n^m \\text{ such that: } h(b_1, \\ldots, b_m) \\geq \\tilde{h_m}\\}</span> . Then:</p>

    <p class="text-gray-300"><span class="math">$Adv_{m} = \\frac{1}{2 \\cdot [2^{n}(2^{n}-1)...(2^{n}-m+1)]^{2}} \\sum_{b_{1},...,b_{m} \\in I_{n}} |h_{m} - \\tilde{h_{m}}|</span>$</p>

    <p class="text-gray-300"><span class="math">$= \\frac{1}{2 \\cdot 2^{nm}} \\sum_{b_{1},...,b_{m} \\in I_{n}} |\\frac{h_{m}}{h_{m}} - 1|</span>$</p>

    <p class="text-gray-300"><span class="math">$= \\frac{1}{2^{nm}} \\sum_{b_{1},...,b_{m} \\in F} (\\frac{h_{m}}{h_{m}} - 1)</span>$</p>

    <p class="text-gray-300"><span class="math">$= \\frac{1}{2^{nm}} \\sum_{b_{1},...,b_{m} \\in I_{n} \\setminus F} (1 - \\frac{h_{m}}{h_{m}})</span>$</p>

    <p class="text-gray-300"><strong>Proof.</strong> We have seen above that the choice of the pairwise distinct values  <span class="math">a_i</span>  has no influence. Therefore, here the best CPA-2 is this one denoted by  <span class="math">\\phi</span>  ( <span class="math">\\phi</span>  is also the best KPA attack): choose m pairwise distinct values  <span class="math">a_1, \\ldots, a_m</span> ,</p>

    <p class="text-gray-300"><span class="math">\\forall i, 1 \\leq i \\leq m</span> , ask for  <span class="math">f(a_i) = b_i</span>  and now</p>

    <ul class="list-disc list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li>If  <span class="math">H(b_1, \\ldots, b_m) \\geq \\tilde{H_m}</span>  output 1.</li>
      <li>If  <span class="math">H(b_1, \\ldots, b_m) &lt; \\tilde{H_m}</span>  output 0.</li>
    </ul>

    <p class="text-gray-300">Here  <span class="math">\\tilde{H_m}</span>  denotes the average of  <span class="math">H(b_1,\\ldots,b_m)</span>  when  <span class="math">(b_1,\\ldots,b_m)\\in I_n^m</span> , i.e.  <span class="math">\\tilde{H_m}=\\frac{|B_n|^2}{2^{nm}}</span> . Let  <span class="math">p_1^*</span>  be the probability that  <span class="math">\\phi</span>  outputs 1 when  <span class="math">f\\in_R F_n</span> .  <span class="math">p_1^*</span>  is also the probability that  <span class="math">H(b_1,\\ldots,b_m)\\geq \\tilde{H}_m</span>  when  <span class="math">(b_1,\\ldots,b_m)\\in_R I_n^m</span> . Therefore  <span class="math">p_1^*=\\frac{|F|}{2^{nm}}</span> . Let  <span class="math">p_1</span>  be the probability that  <span class="math">\\phi</span>  outputs 1 when  <span class="math">f=g\\oplus h</span>  with  <span class="math">(g,h)\\in_R B_n^2</span> . Then:  <span class="math">Adv=Adv(\\phi)=|p_1-p_1^*|</span> .  <span class="math">p_1=\\sum_{(b_1,\\ldots,b_m)\\in F}\\frac{H(b_1,\\ldots,b_m)}{|B_n|^2}</span> . We know that  <span class="math">H_m=\\frac{h_m|B_n|^2}{[2^n(2^n-1)\\ldots(2^n-m+1)]^2}</span>  (cf (3.2)). Therefore,</p>

    <p class="text-gray-300"><span class="math">$p_1 - p_1^* = \\sum_{b_1, \\dots, b_m \\in F} \\left( \\frac{h_m(b_1, \\dots, b_m)}{[2^n(2^n - 1) \\dots (2^n - m + 1)]^2} - \\frac{1}{2^{nm}} \\right)</span>$</p>

    <p class="text-gray-300"><span class="math">$p_1 - p_1^* = \\sum_{b_1, \\dots b_m \\in F} (\\frac{h_m - \\tilde{h_m}}{[2^n(2^n - 1)\\dots(2^n - m + 1)]^2})</span>$</p>

    <p class="text-gray-300">Therefore from Theorem 4:</p>

    <p class="text-gray-300"><span class="math">$Adv_m = p_1 - p_1^* = \\frac{1}{2^{nm}} \\sum_{b_1, \\dots b_m \\in F} (\\frac{h_m}{\\tilde{h_m}} - 1)</span>$</p>

    <p class="text-gray-300">Now from  <span class="math">\\frac{1}{2^{nm}} \\sum_{b_1,...b_m \\in F} h_m = \\frac{\\tilde{h_m}}{2}</span> , we obtain the other equality of Theorem 5.</p>

    <p class="text-gray-300">As a direct corollary of this Theorem 5 we get:</p>

    <p class="text-gray-300"><strong>Theorem 6</strong> (&quot;Standard H technique theorem&quot;)</p>

    <p class="text-gray-300">Let  <span class="math">\\alpha</span>  and  <span class="math">\\beta</span>  be real numbers,  <span class="math">\\alpha &gt; 0</span>  and  <span class="math">\\beta &gt; 0</span> . Let  <span class="math">\\mathcal{E}</span>  be a subset of  <span class="math">I_n^m</span>  such that  <span class="math">|\\mathcal{E}| \\ge (1-\\beta) \\cdot 2^{nm}</span> . If</p>

    <ul class="list-disc list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li><ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li>For all sequences  <span class="math">b_i</span> ,  <span class="math">1 \\le i \\le m</span>  of  <span class="math">\\mathcal{E}</span>  we have  <span class="math">h_m(b) \\ge \\tilde{h_m}(1 \\alpha)</span> . Then</li>
    </ol></li>
      <li><ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li><span class="math">Adv_m \\leq \\alpha + \\beta</span> .</li>
    </ol></li>
    </ul>

    <h4 id="sec-8" class="text-lg font-semibold mt-6"><strong>Proof</strong> From Theorem 5</h4>

    <p class="text-gray-300"><span class="math">$Adv_m = \\frac{1}{2^{nm}} \\sum_{b_1, \\dots, b_m \\in I_n \\setminus F} \\left(1 - \\frac{h_m}{\\tilde{h_m}}\\right)</span>$</p>

    <p class="text-gray-300"><span class="math">I_n \\setminus F \\subset (I_n \\setminus E) \\cup (E \\setminus F)</span> , so</p>

    <p class="text-gray-300"><span class="math">$Adv_m \\le \\frac{1}{2^{nm}} (\\beta \\cdot 2^{nm} + \\alpha \\cdot 2^{nm}) \\le \\alpha + \\beta</span>$</p>

    <p class="text-gray-300">as claimed.  <span class="math">\\Box</span></p>

    <p class="text-gray-300">Theorem 4 and theorem 5 show the proof strategy that we will follow in this paper: we will study and evaluate the values  <span class="math">h_m</span> , and try to show that &quot;most of the time&quot;  <span class="math">h_m \\stackrel{&gt;}{\\sim} \\tilde{h_m}</span>  where  <span class="math">a \\stackrel{&gt;}{\\sim} b</span>  means  <span class="math">a \\geq b</span>  or  <span class="math">a \\simeq b</span> .</p>

    <h4 id="sec-9" class="text-lg font-semibold mt-6">Remarks</h4>

    <ul class="list-disc list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li><ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li>In [13] a slightly different strategy is used, by studying  <span class="math">\\sigma(h_m)</span> , the standard deviation on the  <span class="math">h_m</span>  values.</li>
    </ol></li>
      <li><ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li>Theorem 4 and theorem 5 are specific of this problem. However Theorem 6 is a very classical &quot;coefficient H theorem&quot; and can also be proved independently of Theorem 5 with more general conditions (see for example [13, 12]).</li>
    </ol></li>
    </ul>

    <ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li>The probability to distinguish is  <span class="math">\\frac{1}{2} + Adv \\cdot \\frac{1}{2}</span> , as usual.</li>
    </ol>

    <p class="text-gray-300"><strong>Theorem 7</strong>  <span class="math">(H_{worse\\ case}\\ theorem)</span></p>

    <p class="text-gray-300">Let  <span class="math">\\alpha \\geq 0</span> . If</p>

    <ul class="list-disc list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li><ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li>For all sequences  <span class="math">b_i</span> ,  <span class="math">1 \\leq b_i \\leq m</span> , of  <span class="math">I_n^m</span>  we have  <span class="math">h_m(b) \\geq \\tilde{h_m}(1-\\alpha)</span></li>
    </ol></li>
      <li><ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li><span class="math">Adv_m \\leq \\alpha</span> .</li>
    </ol></li>
    </ul>

    <p class="text-gray-300"><strong>Proof.</strong> This follows immediately from Theorem 6 with  <span class="math">\\beta = 0</span> .</p>

    <h4 id="sec-10" class="text-lg font-semibold mt-6">Part II</h4>

    <p class="text-gray-300">Let  <span class="math">\\epsilon \\geq 0</span> . From Theorem 7, (i.e. coefficients H technique) we know that if for all  <span class="math">b_1, \\ldots, b_{\\alpha} \\in I_n</span>  we have  <span class="math">h_{\\alpha}(b_1, b_2, \\ldots, b_{\\alpha}) \\geq \\tilde{h}_{\\alpha}(1 - \\epsilon)</span> , then:  <span class="math">Avd^{PRF} \\leq 2\\epsilon</span>  (where  <span class="math">Avd^{PRF}</span>  is as before the advantage</p>

    <p class="text-gray-300">to distinguish  <span class="math">f \\oplus g</span>  with  <span class="math">f, g \\in_R B_n</span>  from  <span class="math">h \\in_R F_n</span>  with a CPA-2 attack). Therefore we want to study  <span class="math">\\frac{h\\alpha}{h\\alpha}</span> .</p>

    <p class="text-gray-300"><span class="math">$\\tilde{h}_{\\alpha+1} = \\tilde{h}_{\\alpha} \\frac{(2^n - \\alpha)^2}{2^n}</span>$</p>

    <p class="text-gray-300"><span class="math">$\\tilde{h}_{\\alpha+1} = \\tilde{h}_{\\alpha} (2^n - 2\\alpha + \\frac{\\alpha^2}{2^n}) \\quad (4.1)</span>$</p>

    <p class="text-gray-300">Now we want to evaluate  <span class="math">h_{\\alpha+1}</span>  from  <span class="math">h_{\\alpha}</span>  and compare the result with (4.1). In  <span class="math">h_{\\alpha+1}</span> , we have:</p>

    <ul class="list-disc list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li><ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li>The previous conditions on  <span class="math">h_{\\alpha}</span> .</li>
    </ol></li>
      <li><ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li>Two new variables  <span class="math">P_{\\alpha+1}</span>  and  <span class="math">Q_{\\alpha+1}</span> .</li>
    </ol></li>
      <li><ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li>One more equation  <span class="math">P_{\\alpha+1} \\oplus Q_{\\alpha+1} = b_{\\alpha+1}</span> . We call X this equation.</li>
    </ol></li>
      <li><ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li><span class="math">2\\alpha</span>  new non equalities:  <span class="math">P_{\\alpha+1} \\neq P_i</span> ,  <span class="math">\\forall i, 1 \\leq i \\leq \\alpha</span> , and  <span class="math">Q_{\\alpha+1} \\neq Q_i</span> ,  <span class="math">\\forall i, 1 \\leq i \\leq \\alpha</span> . We will denote by  <span class="math">\\beta_1, \\beta_2, \\ldots, \\beta_{2\\alpha}</span> , the  <span class="math">2\\alpha</span>  equalities that should not be satisfied here (for example  <span class="math">P_{\\alpha+1} = P_1</span> ).</li>
    </ol></li>
    </ul>

    <p class="text-gray-300">Let  <span class="math">B_i = \\{(P_1, P_2, \\dots, P_{\\alpha+1}, Q_1, Q_2, \\dots, Q_{\\alpha+1}) \\in I_n^{2\\alpha+2} \\text{ that satisfy the conditions on } h_\\alpha,</span>  the equation X, and the equalitity  <span class="math">\\beta_i\\}</span> . We have</p>

    <p class="text-gray-300"><span class="math">$h_{\\alpha+1} = 2^n h_{\\alpha} - |\\cup_{i=1}^{2\\alpha} B_i|</span>$</p>

    <p class="text-gray-300">Moreover, since 3 equalities  <span class="math">\\beta_i</span>  are necessarily not compatible with the conditions on  <span class="math">h_{\\alpha}</span> , we have:</p>

    <p class="text-gray-300"><span class="math">$h_{\\alpha+1} = 2^n h_{\\alpha} - \\sum_{i=1}^{2\\alpha} |B_i| + \\sum_{i &lt; j} |B_i \\cap B_j| \\quad (4.2)</span>$</p>

    <p class="text-gray-300">• X + 1 equations.</p>

    <p class="text-gray-300">We have  <span class="math">|B_i| = h_{\\alpha}</span>  (since X and  <span class="math">\\beta_i</span>  will fix  <span class="math">P_{\\alpha+1}</span>  and  <span class="math">Q_{\\alpha+1}</span> ), and  <span class="math">-\\sum_{i=1}^{2\\alpha} |B_i| = -2\\alpha h_{\\alpha}</span> .</p>

    <p class="text-gray-300">• X + 2 equations.</p>

    <p class="text-gray-300">X is :  <span class="math">P_{\\alpha+1} \\oplus Q_{\\alpha+1} = b_{\\alpha+1}</span> . To be compatible with the conditions on  <span class="math">h_{\\alpha}</span>  the 2 new equalities should be of the type:  <span class="math">P_{\\alpha+1} = P_i</span>  and  <span class="math">Q_{\\alpha+1} = Q_j</span> , with  <span class="math">i \\leq \\alpha</span>  and  <span class="math">j \\leq \\alpha</span> . Therefore  <span class="math">P_i \\oplus Q_j = b_{\\alpha+1}</span> . We will denote by  <span class="math">h&#x27;_{\\alpha}(b_1, \\ldots, b_{\\alpha})(i, j)</span>  or simply by  <span class="math">h&#x27;_{\\alpha}(i, j)</span>  for simplicity, the number of  <span class="math">(P_1, \\ldots, P_{\\alpha}, Q_1, \\ldots, Q_{\\alpha}) \\in I_n^{2\\alpha}</span>  such that</p>

    <ul class="list-disc list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li><ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li>We have the conditions on  <span class="math">h_{\\alpha}</span>  (i.e. the  <span class="math">P_i</span>  are pairwise distinct, the  <span class="math">Q_i</span>  are pairwise distinct, and  <span class="math">\\forall i, 1 \\leq i \\leq \\alpha, P_i \\oplus Q_i = b_i</span> ).</li>
    </ol></li>
      <li><ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li><span class="math">P_i \\oplus Q_j = b_{\\alpha+1}</span>  (this is one more affine equality).</li>
    </ol></li>
    </ul>

    <p class="text-gray-300">Then:</p>

    <p class="text-gray-300"><span class="math">$\\sum_{1 \\le i &lt; j \\le 2\\alpha} |B_i \\cap B_j| = \\sum_{i=1}^{\\alpha} \\sum_{j=1}^{\\alpha} h&#x27;_{\\alpha}(i,j)</span>$</p>

    <p class="text-gray-300">(there, unlike (4.2), we can have i = j because they do not come from the same  <span class="math">\\beta_i</span> ). From (4.2), we get:</p>

    <p class="text-gray-300"><span class="math">$h_{\\alpha+1} = (2^n - 2\\alpha)h_{\\alpha} + \\sum_{i=1}^{\\alpha} \\sum_{j=1}^{\\alpha} h&#x27;_{\\alpha}(i,j)</span>$
(4.3)</p>

    <p class="text-gray-300">Let  <span class="math">M = \\{i, 1 \\leq i \\leq \\alpha, b_i = b_{\\alpha+1}\\}</span> . Let Y(i,j) be the equation added in  <span class="math">h&#x27;_{\\alpha}</span>  (i.e. Y(i,j) is  <span class="math">P_i \\oplus Q_j = b_{\\alpha+1}</span> ). If  <span class="math">i \\in M</span> , then  <span class="math">h&#x27;_{\\alpha}(i,i) = h_{\\alpha}</span> , and if  <span class="math">i \\notin M</span> , then  <span class="math">h&#x27;_{\\alpha}(i,i) = 0</span> . (This is because Y(i,i) is  <span class="math">P_i \\oplus Q_i = b_{\\alpha+1}</span>  and we have  <span class="math">P_i \\oplus Q_i = b_i</span> ). Moreover, if  <span class="math">i \\in M</span> , then  <span class="math">\\forall j, 1 \\leq j \\leq \\alpha, j \\neq i</span> , we have  <span class="math">h&#x27;_{\\alpha}(i,j) = 0</span> , and  <span class="math">h&#x27;_{\\alpha}(j,i) = 0</span>  (*).</p>

    <p class="text-gray-300">(Proof: This is because Y(i,j) is  <span class="math">P_i \\oplus Q_j = b_{\\alpha+1}</span> . Moreover  <span class="math">b_{\\alpha+1} = b_i</span> , since  <span class="math">i \\in M</span> , and  <span class="math">P_i \\oplus Q_i = b_i</span> . So we would have  <span class="math">Q_i = Q_j</span> . Similarly, Y(j,i) is  <span class="math">P_j \\oplus Q_i = b_{\\alpha+1} = b_i</span>  and from  <span class="math">P_i \\oplus Q_i = b_i</span> , we would have  <span class="math">P_j = P_i</span> ). Therefore, from these results and (4.3), we have obtained:</p>

    <p class="text-gray-300">Theorem 8 (&quot;Orange equations&quot;)</p>

    <p class="text-gray-300">With  <span class="math">M = \\{i, 1 \\le i \\le \\alpha, b_i = b_{\\alpha+1}\\}</span> , we have:</p>

    <p class="text-gray-300"><span class="math">$h_{\\alpha+1} = (2^n - 2\\alpha + |M|)h_{\\alpha} + \\sum_{i \\notin M} \\sum_{j \\notin M, j \\neq i} h&#x27;_{\\alpha}(i,j)</span>$</p>

    <p class="text-gray-300"><strong>Theorem 9</strong> (&quot;Stabilization formula for  <span class="math">h_{\\alpha+1}</span> &quot;)</p>

    <p class="text-gray-300"><span class="math">$\\sum_{b_{\\alpha+1} \\in I_n} h_{\\alpha+1} = (2^n - \\alpha)^2 h_{\\alpha}</span>$</p>

    <p class="text-gray-300"><strong>Proof.</strong> This comes immediately from the fact that in  <span class="math">h_{\\alpha+1}</span>  we have  <span class="math">P_{\\alpha+1}</span>  and  <span class="math">Q_{\\alpha+1}</span>  as new variables, with  <span class="math">P_{\\alpha+1} \\notin \\{P_1, \\dots, P_{\\alpha}\\}</span>  and  <span class="math">Q_{\\alpha+1} \\notin \\{Q_1, \\dots, Q_{\\alpha}\\}</span> .</p>

    <p class="text-gray-300"><strong>Theorem 10</strong> (&quot;Stabilization formula for  <span class="math">h&#x27;_{\\alpha}</span> &quot;)  <span class="math">\\forall i, j, i \\neq j, \\sum_{b_{\\alpha+1} \\notin \\{b_i, b_j\\}} h&#x27;_{\\alpha}(i, j) = h_{\\alpha}</span> .</p>

    <p class="text-gray-300"><strong>Proof.</strong> Theorem 10 follows immediately from (*) above (just before Theorem 8).</p>

    <p class="text-gray-300">First Approximation: Security in  <span class="math">O(\\frac{m^3}{2^{2n}})</span></p>

    <p class="text-gray-300">From (4.2) we have:  <span class="math">h_{\\alpha+1} \\geq (2^n - 2\\alpha)h_{\\alpha}</span> . Then from (4.1)</p>

    <p class="text-gray-300"><span class="math">$\\frac{h_{\\alpha+1}}{\\tilde{h}_{\\alpha+1}} = \\frac{h_{\\alpha}}{\\tilde{h}_{\\alpha}} \\frac{(2^n - 2\\alpha)}{2^n - 2\\alpha + \\frac{\\alpha^2}{2^n}}</span>$</p>

    <p class="text-gray-300"><span class="math">$\\frac{h_{\\alpha+1}}{\\tilde{h}_{\\alpha+1}} = \\frac{h_{\\alpha}}{\\tilde{h}_{\\alpha}} \\left( 1 - \\frac{\\frac{\\alpha^2}{2^n}}{2^n - 2\\alpha + \\frac{\\alpha^2}{2^n}} \\right)</span>$</p>

    <p class="text-gray-300">Now since  <span class="math">h_1 = 2^n</span>  and  <span class="math">\\tilde{h}_1 = 2^n</span> ,</p>

    <p class="text-gray-300"><span class="math">$h_{\\alpha} \\ge \\tilde{h}_{\\alpha} \\left( 1 - \\frac{\\alpha^2}{2^{2n} - 2\\alpha \\cdot 2^n + \\alpha^2} \\right)^{\\alpha}</span>$</p>

    <p class="text-gray-300">First step result:</p>

    <p class="text-gray-300"><span class="math">$h_{\\alpha} \\ge \\tilde{h}_{\\alpha} \\left( 1 - \\frac{\\alpha^3}{2^{2n} - 2\\alpha \\cdot 2^n + \\alpha^2} \\right) \\quad (4.4)</span>$</p>

    <p class="text-gray-300">Therefore (from Theorem 7):</p>

    <h4 id="sec-11" class="text-lg font-semibold mt-6">Theorem 11</h4>

    <p class="text-gray-300"><span class="math">$Adv_{\\alpha}^{PRF} \\le \\frac{\\alpha^3}{2^{2n} - 2\\alpha \\cdot 2^n + \\alpha^2} \\quad (4.5)</span>$</p>

    <p class="text-gray-300">(and the probability to distinguish is  <span class="math">\\frac{1}{2} + \\frac{1}{2} \\cdot Adv_m</span>  as usual).</p>

    <p class="text-gray-300">We have proved security in  <span class="math">O(\\frac{\\alpha^3}{2^{2n}})</span> .</p>

    <p class="text-gray-300"><strong>Remark.</strong> the fact that we have so far proved security when  <span class="math">\\alpha \\ll 2^{\\frac{2n}{3}}</span>  is not very impressive compared with we have previously obtained with the  <span class="math">H_{\\sigma}</span>  technique (i.e. with the  <span class="math">\\lambda_{\\alpha}</span>  values). However, the fact that  <span class="math">Adv^{PRF}</span>  decreases in  <span class="math">2^{2n}</span>  when  <span class="math">\\alpha</span>  is fixed is interesting.</p>

    <p class="text-gray-300"><strong>Lemma 1</strong> (Simple Approximation of  <span class="math">h&#x27;_{\\alpha}</span> ) If  <span class="math">i \\notin M</span> ,  <span class="math">j \\notin M</span> , and  <span class="math">i \\neq j</span> , we always have:</p>

    <p class="text-gray-300"><span class="math">$\\frac{h_{\\alpha}}{2^n}(1-\\frac{4\\alpha}{2^n}) \\le h&#x27;_{\\alpha}(i,j) \\le \\frac{h_{\\alpha}}{2^n(1-\\frac{4\\alpha}{2^n})}</span>$</p>

    <p class="text-gray-300"><strong>Proof.</strong> Without loss of generality, just by changing the order of the indices, we can assume that  <span class="math">i = \\alpha - 1</span>  and  <span class="math">j = \\alpha</span> , i.e. that the new equation Y is:  <span class="math">P_{\\alpha-1} \\oplus Q_{\\alpha} = b_{\\alpha+1}</span> . We will now evaluate  <span class="math">h_{\\alpha}</span>  and  <span class="math">h&#x27;_{\\alpha}</span>  from  <span class="math">h_{\\alpha-2}</span> . When we go from  <span class="math">h_{\\alpha-2}</span>  to  <span class="math">h_{\\alpha}</span> , we have 4 new variables  <span class="math">P_{\\alpha}, Q_{\\alpha}, P_{\\alpha-1}, Q_{\\alpha-1}</span>  such that  <span class="math">P_{\\alpha} \\oplus Q_{\\alpha} = b_{\\alpha}</span> ,  <span class="math">P_{\\alpha-1} \\oplus Q_{\\alpha-1} = b_{\\alpha-1}</span> ,</p>

    <p class="text-gray-300"><span class="math">\\forall i, 1 \\le i \\le \\alpha - 2, P_{\\alpha - 1} \\ne P_i</span></p>

    <p class="text-gray-300"><span class="math">\\forall i, 1 \\leq i \\leq \\alpha - 2, \\ Q_{\\alpha - 1} \\neq Q_i</span></p>

    <p class="text-gray-300"><span class="math">\\forall i, 1 \\leq i \\leq \\alpha - 1, P_{\\alpha} \\neq P_i</span></p>

    <p class="text-gray-300"><span class="math">\\forall i, 1 \\leq i \\leq \\alpha - 1, \\ Q_{\\alpha} \\neq Q_i</span></p>

    <p class="text-gray-300">For  <span class="math">P_{\\alpha-1}</span> , we have between  <span class="math">2^n-(\\alpha-2)</span>  and  <span class="math">2^n-2(\\alpha-2)</span>  possibilities. Now, when  <span class="math">P_{\\alpha-1}</span>  is fixed, for  <span class="math">P_{\\alpha}</span> , we have between  <span class="math">2^n-(\\alpha-1)</span>  and  <span class="math">2^n-2(\\alpha-1)</span>  possibilities. Therefore:</p>

    <p class="text-gray-300"><span class="math">$(2^{n} - 2(\\alpha - 1))(2^{n} - 2(\\alpha - 2))h_{\\alpha - 2} \\le h_{\\alpha} \\le (2^{n} - (\\alpha - 1))(2^{n} - (\\alpha - 2))h_{\\alpha - 2}</span>$</p>

    <p class="text-gray-300">So</p>

    <p class="text-gray-300"><span class="math">$(2^{2n} - 4\\alpha \\cdot 2^n)h_{\\alpha - 2} \\le h_{\\alpha} \\le 2^{2n}h_{\\alpha - 2} \\quad (5.1)</span>$</p>

    <p class="text-gray-300">Similarly, when we go from  <span class="math">h_{\\alpha-2}</span>  to  <span class="math">h&#x27;_{\\alpha}</span> , we have 4 new variables  <span class="math">P_{\\alpha}, Q_{\\alpha}, P_{\\alpha-1}, Q_{\\alpha-1}</span>  such that:  <span class="math">P_{\\alpha} \\oplus Q_{\\alpha} = b_{\\alpha}, \\ P_{\\alpha-1} \\oplus Q_{\\alpha-1} = b_{\\alpha-1}, \\ P_{\\alpha-1} \\oplus Q_{\\alpha} = b_{\\alpha+1}, \\ \\text{and} \\ \\forall i, 1 \\leq i \\leq \\alpha-2 : \\ P_{\\alpha-1} \\neq P_i, \\ Q_{\\alpha-1} \\neq Q_i, \\ P_{\\alpha} \\neq P_i, \\ \\text{and} \\ Q_{\\alpha} \\neq Q_i.</span>  (we necessarily have  <span class="math">P_{\\alpha} \\neq P_{\\alpha-1}</span>  and  <span class="math">Q_{\\alpha} \\neq Q_{\\alpha-1}</span>  since  <span class="math">P_{\\alpha} \\oplus P_{\\alpha-1} = p_{\\alpha} \\oplus p_{\\alpha+1}</span>  and  <span class="math">P_{\\alpha} \\oplus P_{\\alpha-1} = p_{\\alpha} \\oplus p_{\\alpha+1}</span>  and these values are  <span class="math">P_{\\alpha} \\oplus P_{\\alpha-1} = p_{\\alpha} \\oplus p_{\\alpha+1}</span>  and  <span class="math">P_{\\alpha} \\oplus P_{\\alpha-1} = p_{\\alpha} \\oplus p_{\\alpha+1}</span>  and  <span class="math">P_{\\alpha} \\oplus P_{\\alpha-1} = p_{\\alpha} \\oplus p_{\\alpha+1}</span>  and  <span class="math">P_{\\alpha} \\oplus P_{\\alpha-1} = p_{\\alpha} \\oplus p_{\\alpha+1}</span>  and  <span class="math">P_{\\alpha} \\oplus P_{\\alpha-1} = p_{\\alpha} \\oplus p_{\\alpha+1}</span>  and  <span class="math">P_{\\alpha} \\oplus P_{\\alpha-1} = p_{\\alpha} \\oplus p_{\\alpha+1}</span>  and  <span class="math">P_{\\alpha} \\oplus P_{\\alpha-1} = p_{\\alpha} \\oplus p_{\\alpha+1}</span>  and  <span class="math">P_{\\alpha} \\oplus P_{\\alpha-1} = p_{\\alpha} \\oplus p_{\\alpha+1}</span>  and  <span class="math">P_{\\alpha} \\oplus P_{\\alpha-1} = p_{\\alpha} \\oplus p_{\\alpha+1}</span>  and  <span class="math">P_{\\alpha} \\oplus P_{\\alpha-1} = p_{\\alpha} \\oplus p_{\\alpha+1}</span>  and  <span class="math">P_{\\alpha} \\oplus P_{\\alpha-1} = p_{\\alpha} \\oplus p_{\\alpha+1}</span>  and  <span class="math">P_{\\alpha} \\oplus P_{\\alpha-1} = p_{\\alpha} \\oplus p_{\\alpha+1}</span>  and  <span class="math">P_{\\alpha} \\oplus P_{\\alpha-1} = p_{\\alpha} \\oplus p_{\\alpha+1}</span>  and  <span class="math">P_{\\alpha} \\oplus P_{\\alpha-1} = p_{\\alpha} \\oplus p_{\\alpha+1}</span>  and  <span class="math">P_{\\alpha} \\oplus P_{\\alpha-1} = p_{\\alpha} \\oplus p_{\\alpha+1}</span>  and  <span class="math">P_{\\alpha} \\oplus P_{\\alpha-1} = p_{\\alpha} \\oplus p_{\\alpha+1}</span>  and  <span class="math">P_{\\alpha} \\oplus P_{\\alpha-1} = p_{\\alpha} \\oplus p_{\\alpha+1}</span>  and  <span class="math">P_{\\alpha} \\oplus P_{\\alpha-1} = p_{\\alpha} \\oplus p_{\\alpha+1}</span>  and  <span class="math">P_{\\alpha} \\oplus P_{\\alpha-1} = p_{\\alpha} \\oplus p_{\\alpha+1}</span>  and  <span class="math">P_{\\alpha} \\oplus P_{\\alpha-1} = p_{\\alpha} \\oplus p_{\\alpha+1}</span>  and  <span class="math">P_{\\alpha} \\oplus P_{\\alpha-1} = p_{\\alpha} \\oplus p_{\\alpha+1}</span>  and  <span class="math">P_{\\alpha} \\oplus P_{\\alpha-1} = p_{\\alpha} \\oplus p_{\\alpha+1}</span>  and  <span class="math">P_{\\alpha} \\oplus P_{\\alpha-1} \\oplus p_{\\alpha} \\oplus p_{\\alpha+1}</span>  and  <span class="math">P_{\\alpha} \\oplus P_{\\alpha-1} \\oplus p_{\\alpha} \\oplus p_{\\alpha+1}</span>  and  <span class="math">P_{\\alpha} \\oplus P_{\\alpha-1} \\oplus p_{\\alpha} \\oplus p_{\\alpha+1}</span>  and  <span class="math">P_{\\alpha} \\oplus P_{\\alpha-1} \\oplus p_{\\alpha} \\oplus p_{\\alpha+1}</span>  and  <span class="math">P_{\\alpha} \\oplus P_{\\alpha-1} \\oplus p_{\\alpha+1}</span>  and  <span class="math">P_{\\alpha} \\oplus P_{\\alpha-1} \\oplus p_{\\alpha} \\oplus p_{\\alpha+1}</span>  and  <span class="math">P_{\\alpha} \\oplus P_{\\alpha-1} \\oplus p_{\\alpha} \\oplus p_{\\alpha+1}</span>  and  <span class="math">P_{\\alpha} \\oplus P_{\\alpha-1} \\oplus p_{\\alpha} \\oplus p_{\\alpha+1}</span>  and  <span class="math">P_{\\alpha} \\oplus P_{\\alpha-1} \\oplus p_{\\alpha+1}</span></p>

    <p class="text-gray-300">Therefore, for  <span class="math">P_{\\alpha}</span>  we have between  <span class="math">2^{n}-(\\alpha-2)</span>  and  <span class="math">2^{n}-4(\\alpha-2)</span>  possibilities.</p>

    <p class="text-gray-300"><span class="math">$(2^n - 4(\\alpha - 2))h_{\\alpha - 2} \\le h_{\\alpha} \\le (2^n - (\\alpha - 2))h_{\\alpha - 2}</span>$
(5.2)</p>

    <p class="text-gray-300">From (5.1) and (5.2), we obtain lemma 1, as claimed.</p>

    <p class="text-gray-300"><strong>Lemma 2</strong> (A simple way to get ride of |M|) If  <span class="math">\\alpha \\leq \\frac{2^n}{6}</span> , then there exists a value  <span class="math">h&#x27;_{\\alpha}</span>  such that:</p>

    <p class="text-gray-300"><span class="math">$h_{\\alpha+1} \\ge (2^n - 2\\alpha)h_{\\alpha} + \\alpha(\\alpha - 1)h&#x27;_{\\alpha}</span>$</p>

    <p class="text-gray-300">(The condition  <span class="math">\\alpha \\leq \\frac{2^n}{6}</span>  could be improved with further analysis).</p>

    <p class="text-gray-300"><strong>Proof of Lemma 2.</strong> From Theorem 8, we have:</p>

    <p class="text-gray-300"><span class="math">$h_{\\alpha+1} \\ge (2^n - 2\\alpha + |M|)h_{\\alpha} + [(\\alpha - |M|)(\\alpha - |M|) - \\alpha]h&#x27;_{\\alpha}</span>$</p>

    <p class="text-gray-300">So a sufficient condition for  <span class="math">h_{\\alpha+1} \\geq (2^n-2\\alpha)h_{\\alpha} + [\\alpha^2-\\alpha]h&#x27;_{\\alpha}</span>  is to have  <span class="math">|M|h_{\\alpha} \\geq (2\\alpha|M|-|M|^2)h&#x27;_{\\alpha}</span>  (*). From Lemma 1, we have  <span class="math">h&#x27;_{\\alpha} \\leq \\frac{h_{\\alpha}}{2^n(1-\\frac{4\\alpha}{2^n})}</span> . Therefore a sufficient condition for (*) is to have:  <span class="math">2^n-4\\alpha \\geq 2\\alpha-|M|</span>  i.e.  <span class="math">\\alpha \\leq \\frac{2^n+|M|}{6}</span> . This condition is satisfied if  <span class="math">\\alpha \\leq \\frac{2^n}{6}</span>  as claimed.</p>

    <p class="text-gray-300">Security in  <span class="math">O(\\frac{m^2}{2^{2n}} + \\frac{m^4}{2^{3n}})</span></p>

    <p class="text-gray-300">From Theorem 8 and Lemma 1, we have:</p>

    <p class="text-gray-300"><span class="math">$h_{\\alpha+1} \\ge (2^n - 2\\alpha + |M|)h_{\\alpha} + [(\\alpha - |M|)(\\alpha - |M|) - \\alpha]\\frac{h_{\\alpha}}{2^n}(1 - \\frac{4\\alpha}{2^n})</span>$</p>

    <p class="text-gray-300"><span class="math">$h_{\\alpha+1} \\ge (2^n - 2\\alpha + |M| + \\frac{\\alpha^2 - 2|M|\\alpha + |M|^2 - \\alpha}{2^n})h_\\alpha - \\frac{4\\alpha^3}{2^{2n}}h_\\alpha</span>$</p>

    <p class="text-gray-300">We have</p>

    <p class="text-gray-300"><span class="math">$|M| + \\frac{-2|M|\\alpha + |M|^2}{2^n} \\ge 0 \\Leftrightarrow \\alpha \\le \\frac{2^n + |M|}{2}</span>$</p>

    <p class="text-gray-300">We will assume that  <span class="math">\\alpha \\leq \\frac{2^n}{2}</span>  (this condition could be improved with further analysis). Then</p>

    <p class="text-gray-300"><span class="math">$h_{\\alpha+1} \\ge (2^n - 2\\alpha + \\frac{\\alpha^2 - \\alpha}{2^n} - \\frac{4\\alpha^3}{2^{2n}})h_{\\alpha}</span>$</p>

    <p class="text-gray-300"><strong>Remark.</strong> We can also get this directly from Lemma 2 and Lemma 1 but with  <span class="math">\\alpha \\leq \\frac{2^n}{6}</span>  instead of  <span class="math">\\alpha \\leq \\frac{2^n}{2}</span></p>

    <p class="text-gray-300"><span class="math">$\\frac{h_{\\alpha+1}}{\\tilde{h}_{\\alpha+1}} \\ge \\frac{2^n - 2\\alpha + \\frac{\\alpha^2 - \\alpha}{2^n} - \\frac{4\\alpha^3}{2^{2n}}}{2^n - 2\\alpha + \\frac{\\alpha^2}{2^n}} \\frac{h_{\\alpha}}{\\tilde{h}_{\\alpha}}</span>$</p>

    <p class="text-gray-300"><span class="math">$\\frac{h_{\\alpha+1}}{\\tilde{h}_{\\alpha+1}} \\ge \\left(1 - \\frac{\\alpha}{(2^n - \\alpha)^2} - \\frac{4\\alpha^3}{2^n(2^n - \\alpha)^2}\\right) \\frac{h_\\alpha}{\\tilde{h}_\\alpha}</span>$</p>

    <p class="text-gray-300">Therefore</p>

    <p class="text-gray-300"><span class="math">$h_{\\alpha} \\ge \\left(1 - \\frac{\\alpha}{(2^n - \\alpha)^2} - \\frac{4\\alpha^3}{2^n (2^n - \\alpha)^2}\\right)^{\\alpha} \\tilde{h_{\\alpha}}</span>$</p>

    <p class="text-gray-300">Second Step result:</p>

    <p class="text-gray-300"><span class="math">$h_{\\alpha} \\ge (1 - \\frac{\\alpha^2}{(2^n - \\alpha)^2} - \\frac{4\\alpha^4}{2^n (2^n - \\alpha)^2}) \\tilde{h_{\\alpha}}</span>$
(5.3)</p>

    <p class="text-gray-300">Now from (5.3) we have for all CPA-2 attacks with m queries:</p>

    <p class="text-gray-300"><span class="math">$Adv^{PRF} \\le \\frac{m^2}{(2^n - m)^2} + \\frac{4m^4}{2^n(2^n - m)^2}</span>$
(5.4)</p>

    <p class="text-gray-300">(here we do not need to say &quot;when  <span class="math">m \\leq \\frac{2^n}{2}</span> &quot; since for larger m, this value is larger than 1).</p>

    <p class="text-gray-300"><strong>Remark</strong> (5.4) gives security in  <span class="math">O(\\frac{m^2}{2^{2n}} + \\frac{m^4}{2^{3n}})</span>  with m queries as wanted in this section. In (5.4), we have two terms. The first term in  <span class="math">\\frac{m^2}{2^{2n}}</span>  is consistent with the fact that when m=2 for example we know that we must have a term in  <span class="math">2^{2n}</span>  (see Appendix A: the value for the advantage with 2 queries is exactly  <span class="math">\\frac{1}{2^n(2^n-1)}</span> ). The second term gives security only when  <span class="math">m \\ll 2^{\\frac{3n}{4}}</span>  and we will see in the next sections how to improve this term.</p>

    <p class="text-gray-300"><strong>Theorem 12</strong> (&quot;first purple equations&quot;):</p>

    <p class="text-gray-300"><span class="math">$h&#x27;_{\\alpha+1} = h_\\alpha + (-2\\alpha + 2 + \\nu + \\xi + \\mu)h&#x27;_\\alpha + \\sum_{(i,j) \\in \\mathcal{N}} h&#x27;&#x27;_\\alpha</span>$</p>

    <p class="text-gray-300">with</p>

    <ul class="list-disc list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li><span class="math">\\mathcal{N} = \\{(i, j), i \\neq j, 2 \\leq i \\leq \\alpha, 2 \\leq j \\leq \\alpha, \\text{ such that none of the 4 equalities } \\mathcal{S} \\text{ are satisfied} \\}</span> The  <span class="math">\\mathcal{S}</span>  equalities are    <ul class="list-disc list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li><span class="math">b_{\\alpha+1} = b_{j}</span> .</li>
      <li><span class="math">b_{\\alpha+2}=b_j.</span></li>
      <li><span class="math">b_{\\alpha+1}=b_i.</span></li>
      <li><span class="math">. b_1 \\oplus b_{\\alpha+1} \\oplus b_{\\alpha+2} \\oplus b_i = 0.</span></li>
    </ul></li>
      <li><span class="math">\\mu</span>  is the number of i,  <span class="math">2 \\le i \\le \\alpha</span> ,  <span class="math">b_{\\alpha+1} = b_i</span> .</li>
      <li><span class="math">\\xi</span>  is the number of i,  <span class="math">2 \\le i \\le \\alpha</span> ,  <span class="math">b_{\\alpha+2} = b_i</span> .</li>
      <li><span class="math">\\nu</span>  is the number of i,  <span class="math">2 \\le i \\le \\alpha</span> ,  <span class="math">b_1 \\oplus b_{\\alpha+1} \\oplus b_{\\alpha+2} \\oplus b_i = 0</span> .</li>
    </ul>

    <p class="text-gray-300"><strong>Proof.</strong> We have that  <span class="math">h&#x27;_{\\alpha+1}</span>  is the number of  <span class="math">P_1, \\ldots, P_{\\alpha+1}, Q_1, \\ldots, Q_{\\alpha+1}</span>  such that:</p>

    <ul class="list-disc list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li><ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li>The  <span class="math">P_i</span>  values are pairwise distinct.</li>
    </ol></li>
      <li><ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li>The  <span class="math">Q_i</span>  values are pairwise distinct.</li>
    </ol></li>
      <li><ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li>We have all the equalities of  <span class="math">h_{\\alpha+1}</span> :  <span class="math">P_1 \\oplus Q_1 = b_1, \\dots, P_{\\alpha+1} \\oplus Q_{\\alpha+1} = b_{\\alpha+1}</span> .</li>
    </ol></li>
      <li><ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li>We have the extra equation X:  <span class="math">Q_{\\alpha+1} \\oplus P_1 = b_{\\alpha+2}</span> , with  <span class="math">b_{\\alpha+1} \\neq b_{\\alpha+2}</span>  (in order to have  <span class="math">P_{\\alpha+1} \\neq P_1</span> ) and  <span class="math">b_1 \\neq b_{\\alpha+2}</span>  (in order to have  <span class="math">Q_{\\alpha+1} \\neq Q_1</span> ).  <span class="math">\\forall i, 1 \\leq i \\leq 2\\alpha</span> , we define by  <span class="math">B_i&#x27;</span>  the set of all  <span class="math">(P_1, \\ldots, P_{\\alpha+1}, Q_1, \\ldots, Q_{\\alpha+1})</span>  that satisfy:</li>
    </ol>

    <ul class="list-disc list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li>(a) All the conditions  <span class="math">h_{\\alpha}</span> .</li>
    </ul></li>
      <li><p class="text-gray-300">(b) The equation X.</p></li>
      <li><p class="text-gray-300">(c) The equation  <span class="math">P_{\\alpha+1} \\oplus Q_{\\alpha+1} = b_{\\alpha+1}</span> .</p></li>
      <li><p class="text-gray-300">(d) The equation  <span class="math">\\beta_i</span>  (these equations have been defined in section 4, for example  <span class="math">\\beta_1</span>  is  <span class="math">P_{\\alpha+1}=P_1,\\ \\beta_2</span>  is  <span class="math">P_{\\alpha+1}=P_2,\\ \\ldots,\\ \\beta_\\alpha</span>  is  <span class="math">P_{\\alpha+1}=P_\\alpha,\\ \\beta_{\\alpha+1}</span>  is  <span class="math">Q_{\\alpha+1}=Q_1,\\ \\ldots,\\</span> and  <span class="math">\\beta_{2\\alpha}</span>  is  <span class="math">Q_{\\alpha+1}=Q_\\alpha)</span> .</p></li>
    </ul>

    <p class="text-gray-300">In  <span class="math">h&#x27;_{\\alpha+1}</span>  we have 2 new variables  <span class="math">P_{\\alpha+1}</span>  and  <span class="math">Q_{\\alpha+1}</span> . These variables are fixed by:</p>

    <p class="text-gray-300"><span class="math">$\\left\\{ \\begin{array}{l} P_{\\alpha+1} \\oplus Q_{\\alpha+1} = b_{\\alpha+1} \\\\ X: Q_{\\alpha+1} \\oplus P_1 = b_{\\alpha+2} \\end{array} \\right.</span>$</p>

    <p class="text-gray-300">We have:</p>

    <p class="text-gray-300"><span class="math">$h&#x27;_{\\alpha+1} = h_{\\alpha} - |\\bigcup_{\\substack{i=2\\\\i\\neq\\alpha+1}}^{2\\alpha} B&#x27;_i|</span>$</p>

    <p class="text-gray-300">(here i=1 is excluded since  <span class="math">P_{\\alpha+1} \\neq P_1</span>  and similarly  <span class="math">i=\\alpha+1</span>  is excluded since  <span class="math">Q_{\\alpha+1} \\neq Q_1</span> ).</p>

    <p class="text-gray-300">    <img src="_page_10_Figure_8.jpeg" alt="" class="my-4 max-w-full" />
</p>

    <p class="text-gray-300">Figure 1: &quot;6-point figure&quot; for  <span class="math">X + (1 \\text{ equation } P_{\\alpha+1} = P_i)</span> .</p>

    <p class="text-gray-300">Since 3 equations  <span class="math">\\beta_i</span>  are not compatible with the conditions  <span class="math">h_{\\alpha}</span> , we have:</p>

    <p class="text-gray-300"><span class="math">$h&#x27;_{\\alpha+1} = h_{\\alpha} - \\sum_{\\substack{i=2\\\\i \\neq \\alpha+1}}^{2\\alpha} |B&#x27;_{i}| + \\sum_{i=2}^{\\alpha} \\sum_{j=\\alpha+2}^{2\\alpha} |B&#x27;_{i} \\cap B&#x27;_{j}|</span>$</p>

    <h4 id="sec-12" class="text-lg font-semibold mt-6">X+1 equation</h4>

    <p class="text-gray-300">We want to evaluate  <span class="math">|B&#x27;_i|</span> . These values are denoted as a value  <span class="math">h&#x27;_{\\alpha}</span>  (since we have one more equation than in  <span class="math">h_{\\alpha}</span> ), except when  <span class="math">|B&#x27;_i| = 0</span> .</p>

    <p class="text-gray-300">Case 1. If  <span class="math">\\beta_i</span>  is  <span class="math">P_{\\alpha+1} = P_i</span>   <span class="math">(2 \\le i \\le \\alpha)</span>  we will have  <span class="math">|B&#x27;_i| = 0</span>  if  <span class="math">\\beta_i</span>  generates a collision on  <span class="math">Q_i</span> , this means here the collision  <span class="math">Q_i = Q_1</span>  (see Figure 1).</p>

    <p class="text-gray-300"><span class="math">P_{\\alpha+1} = P_i</span>  means  <span class="math">P_1 = P_i \\oplus b_{\\alpha+1} \\oplus b_{\\alpha+2}</span> .</p>

    <p class="text-gray-300"><span class="math">Q_i = Q_1</span>  means  <span class="math">b_i = b_1 \\oplus b_{\\alpha+1} \\oplus b_{\\alpha+2}</span>  ( <span class="math">\\nu</span>  values i are like this).</p>

    <p class="text-gray-300"><strong>Remark.</strong>  <span class="math">Q_i \\neq Q_{\\alpha+1}</span>  (unlike  <span class="math">Q_i \\neq Q_1</span> ) is not one of the conditions of  <span class="math">B_i&#x27;</span> . (We want to evaluate  <span class="math">h&#x27;_{\\alpha+1}</span>  from solutions  <span class="math">h_{\\alpha}</span>  and in  <span class="math">h_{\\alpha}</span>  we do not have the variables  <span class="math">P_{\\alpha+1}</span>  and  <span class="math">Q_{\\alpha+1}</span> ). Here  <span class="math">Q_i = Q_{\\alpha+1}</span>  means  <span class="math">b_i = b_{\\alpha+1}</span> , and we have  <span class="math">\\mu</span>  values i like this but we do not need this here.</p>

    <p class="text-gray-300">Case 2. If  <span class="math">\\beta_j</span>  is  <span class="math">Q_{\\alpha+1} = Q_i</span>   <span class="math">(2 \\le i \\le \\alpha, j = \\alpha + i)</span>  we will have  <span class="math">|B&#x27;_i| = 0</span>  if  <span class="math">\\beta_j</span>  generates a collision  <span class="math">P_i = P_1</span> .</p>

    <p class="text-gray-300"><span class="math">Q_{\\alpha+1} = Q_i</span>  means  <span class="math">P_1 = P_i \\oplus b_i \\oplus b_{\\alpha+2}</span></p>

    <p class="text-gray-300"><span class="math">P_i = P_1</span>  means  <span class="math">b_i = b_{\\alpha+2}</span>  ( <span class="math">\\xi</span>  values i are like this).</p>

    <p class="text-gray-300"><strong>Remark.</strong>  <span class="math">P_i \\neq P_{\\alpha+1}</span>  (unlike  <span class="math">P_i \\neq P_1</span> ) is not one of the conditions of  <span class="math">B_i&#x27;</span> . (We want to evaluate  <span class="math">h&#x27;_{\\alpha+1}</span>  from solutions  <span class="math">h_{\\alpha}</span>  and in  <span class="math">h_{\\alpha}</span>  we do not have the variables  <span class="math">P_{\\alpha+1}</span>  and  <span class="math">Q_{\\alpha+1}</span> ). Here  <span class="math">P_i = P_{\\alpha+1}</span>  means  <span class="math">b_i = b_{\\alpha+1}</span> , and we have  <span class="math">\\mu</span>  values i like this, but we do not need this here.</p>

    <p class="text-gray-300">From Case 1 and Case 2, we have:</p>

    <p class="text-gray-300"><span class="math">$\\sum_{\\substack{i=2\\\\i\\neq\\alpha+1}}^{2\\alpha} |B_i&#x27;| = (2\\alpha - 2 - \\xi - \\nu)h_\\alpha&#x27;</span>$</p>

    <p class="text-gray-300">(Remember:  <span class="math">h&#x27;_{\\alpha}</span>  is generally not a constant, but, as we will see, all the values  <span class="math">h&#x27;_{\\alpha}</span>  will have about the same value).</p>

    <h4 id="sec-13" class="text-lg font-semibold mt-6">X+2 equations</h4>

    <p class="text-gray-300">We want to evaluate here  <span class="math">|B&#x27;_i \\cap B&#x27;_j|</span> . These values are denoted as a value  <span class="math">h&#x27;&#x27;_{\\alpha}</span>  (since we have two more equations than in  <span class="math">h_{\\alpha}</span> ), except when these two equations are not compatible with the conditions  <span class="math">h_{\\alpha}</span>  (because they generate a collision  <span class="math">P_i = P_j</span>  or  <span class="math">Q_i = Q_j</span> ,  <span class="math">i \\neq j</span> ) or when these two equations are not independent (and create a term in  <span class="math">h&#x27;_{\\alpha}</span> ).</p>

    <p class="text-gray-300">    <img src="_page_11_Figure_12.jpeg" alt="" class="my-4 max-w-full" />
</p>

    <p class="text-gray-300">Figure 2: &quot;8-point figure&quot; for X + 2 equations</p>

    <h4 id="sec-14" class="text-lg font-semibold mt-6">Case 1.</h4>

    <p class="text-gray-300">The two equations  <span class="math">P_{\\alpha+1} = P_i</span>  and  <span class="math">Q_{\\alpha+1} = Q_j</span>  are not independent and create a term in  <span class="math">h&#x27;_{\\alpha}</span> . This implies that i = j (because if  <span class="math">i \\neq j</span>  then  <span class="math">Q_i</span>  and  <span class="math">Q_j</span>  are not connected by  <span class="math">P_{\\alpha+1} = P_i</span> ) and then  <span class="math">Q_i = Q_{\\alpha+1}</span>  means  <span class="math">b_i = b_{\\alpha+1}</span>  as seen in the section X+1 equation above. Therefore, we have here a term in  <span class="math">\\mu h&#x27;_{\\alpha}</span> . If i = j and  <span class="math">b_i \\neq b_{\\alpha+1}</span>  then  <span class="math">Q_{\\alpha+1} \\neq Q_j</span> . Therefore we will now assume (in Case 2) that  <span class="math">i \\neq j</span> .</p>

    <h4 id="sec-15" class="text-lg font-semibold mt-6">Case 2.</h4>

    <p class="text-gray-300"><span class="math">i \\neq j</span>  and the two equations  <span class="math">P_{\\alpha+1} = P_i</span>  and  <span class="math">Q_{\\alpha+1} = Q_j</span>  generate a collision. We have seen in the section X+1 equation that from  <span class="math">P_{\\alpha+1} = P_i</span> ,</p>

    <p class="text-gray-300"><span class="math">Q_i = Q_1</span>  means  <span class="math">b_i = b_1 \\oplus b_{\\alpha+1} \\oplus b_{\\alpha+2}</span>  ( <span class="math">\\nu</span>  values)</p>

    <p class="text-gray-300"><span class="math">(Q_i = Q_{\\alpha+1} \\text{ means } b_i = b_{\\alpha+1}, \\mu \\text{ values, this will occur below on } Q_i = Q_j)</span>  and from  <span class="math">Q_{\\alpha+1} = Q_j</span> ,</p>

    <p class="text-gray-300"><span class="math">P_j = P_1</span>  means  <span class="math">b_j = b_{\\alpha+2}</span>  ( <span class="math">\\xi</span>  values)</p>

    <p class="text-gray-300"><span class="math">(P_j = P_{\\alpha+1} \\text{ means } b_j = b_{\\alpha+1}, \\mu \\text{ values, this will occur below on } P_i = P_j)</span></p>

    <p class="text-gray-300">Moreover:  <span class="math">P_i = P_j</span>  means here  <span class="math">b_j = b_{\\alpha+1}</span>  (the same as  <span class="math">P_j = P_{\\alpha+1}</span>  since we have  <span class="math">P_{\\alpha+1} = P_i</span> )</p>

    <p class="text-gray-300"><span class="math">Q_i = Q_j</span>  means here  <span class="math">b_i = b_{\\alpha+1}</span>  (the same as  <span class="math">Q_i = Q_{\\alpha+1}</span>  since we have  <span class="math">Q_{\\alpha+1} = Q_j</span> ).</p>

    <p class="text-gray-300">With the definitions of  <span class="math">\\mathcal{N}</span>  and  <span class="math">\\mathcal{S}</span>  given above and from Case 1 and Case 2, we see that</p>

    <p class="text-gray-300"><span class="math">$\\sum_{i=2}^{\\alpha} \\sum_{j=\\alpha+2}^{2\\alpha} |B_i&#x27; \\cap B_j&#x27;| = \\mu h_\\alpha&#x27; + \\sum_{(i,j) \\in \\mathcal{N}} h_\\alpha&#x27;&#x27;</span>$</p>

    <p class="text-gray-300">Therefore</p>

    <p class="text-gray-300"><span class="math">$h&#x27;_{\\alpha+1} = h_{\\alpha} + (-2\\alpha + 2 + \\nu + \\xi + \\mu)h&#x27;_{\\alpha} + \\sum_{(i,j) \\in \\mathcal{N}} h&#x27;&#x27;_{\\alpha}</span>$</p>

    <p class="text-gray-300">as claimed.</p>

    <h4 id="sec-16" class="text-lg font-semibold mt-6">Example</h4>

    <p class="text-gray-300">Let compute  <span class="math">h_3&#x27;</span>  when  <span class="math">b_2 = b_3</span>  is the only exceptional relation on the  <span class="math">b_i</span>  values. We have:  <span class="math">P_1 \\oplus Q_1 = b_1</span> ,  <span class="math">P_2 \\oplus Q_2 = b_2</span> ,  <span class="math">P_3 \\oplus Q_3 = b_3 = b_2</span>  and  <span class="math">X : Q_3 \\oplus P_1 = b_4</span> . Here  <span class="math">\\alpha = 2</span> ,  <span class="math">\\mu = 1</span> ,  <span class="math">\\nu = \\xi = 0</span> . Theorem 12 gives:</p>

    <p class="text-gray-300"><span class="math">$h_3&#x27; = h_2 + (-4 + 2 + 1)h_2&#x27; + \\sum_{(i,j) \\in \\mathcal{N}} h_2&#x27;&#x27;</span>$</p>

    <p class="text-gray-300">Since  <span class="math">h_2&#x27;&#x27; = 0</span>  (because all the variables are already linked in  <span class="math">h_2&#x27;</span> ) and since  <span class="math">h_2&#x27; = 2^n</span>  and  <span class="math">h_2 = 2^n(2^n - 2)</span>  (because  <span class="math">b_1 \\neq b_2</span> ), this gives:  <span class="math">h_3&#x27; = 2^n(2^n - 2) - 2^n = 2^n(2^n - 3)</span> . This value can also be verified directly.</p>

    <p class="text-gray-300">It is also interesting to see how the proof of Theorem 12 proceeds on this example.</p>

    <p class="text-gray-300">We have:</p>

    <p class="text-gray-300"><span class="math">\\beta_1: P_3 = P_1</span>  (impossible since  <span class="math">b_2 \\neq b_4</span> )</p>

    <p class="text-gray-300"><span class="math">\\beta_2 : P_3 = P_2</span></p>

    <p class="text-gray-300"><span class="math">\\beta_3: Q_3 = Q_1</span>  (impossible since  <span class="math">b_1 \\neq b_4</span> )</p>

    <p class="text-gray-300"><span class="math">\\beta_4: Q_3 = Q_2</span></p>

    <p class="text-gray-300">In  <span class="math">h_3&#x27;</span>  we have 2 new variables  <span class="math">P_3</span>  and  <span class="math">Q_3</span> . These variables are fixed from  <span class="math">P_1</span> ; however all the solutions for  <span class="math">h_2</span>  do not necessary give a solution  <span class="math">h_3&#x27;</span>  since in  <span class="math">h_3&#x27;</span>  we must have  <span class="math">P_3 \\neq P_2</span>  and  <span class="math">Q_3 \\neq Q_2</span> . More precisely:  <span class="math">h_3&#x27; = h_2 - |B_2&#x27; \\cup B_4&#x27;|</span> . This gives:</p>

    <p class="text-gray-300"><span class="math">$h_3&#x27; = h_2 - |B_2&#x27;| - |B_4&#x27;| + |B_2&#x27; \\cap B_4&#x27;|</span>$</p>

    <p class="text-gray-300">    <img src="_page_13_Figure_0.jpeg" alt="" class="my-4 max-w-full" />
</p>

    <p class="text-gray-300">Figure 3: Computation of  <span class="math">h&#x27;_3</span>  from  <span class="math">h_2</span>  on this example.</p>

    <p class="text-gray-300">We have:  <span class="math">|B_2&#x27;|=h_3&#x27;=2^n</span>  because  <span class="math">P_3=P_2</span>  do not generate  <span class="math">Q_2=Q_1</span>  (since  <span class="math">b_1\\neq b_4</span> ). Similarly  <span class="math">|B_4&#x27;|=h_3&#x27;=2^n</span> . Moreover  <span class="math">|B_2&#x27;\\cap B_4&#x27;|=2^n</span>  since here  <span class="math">P_3=P_2\\Leftrightarrow Q_3=Q_2</span>  (since  <span class="math">b_2=b_3</span> ). Therefore  <span class="math">h_3&#x27;=2^n(2^n-2)-2^n=2^n(2^n-3)</span> .</p>

    <p class="text-gray-300"><strong>Theorem 13</strong> With the same notation of Theorem 12, we have:</p>

    <p class="text-gray-300"><span class="math">$|\\mathcal{N}| = (\\alpha - 1)(\\alpha - 2) - (\\alpha - 2)(2\\mu + \\nu + \\xi) + \\mu(\\mu - 1) + \\mu\\xi + \\nu\\xi + \\xi(\\nu - \\epsilon_1)</span>$</p>

    <p class="text-gray-300">with</p>

    <p class="text-gray-300"><span class="math">$\\epsilon_1 = 1 \\Leftrightarrow b_1 = b_{\\alpha+1}</span>$</p>

    <p class="text-gray-300">and</p>

    <p class="text-gray-300"><span class="math">$\\epsilon_1 = 0 \\Leftrightarrow b_1 \\neq b_{\\alpha+1}</span>$</p>

    <p class="text-gray-300"><strong>Proof.</strong>  <span class="math">\\mathcal{N}</span>  is the set of all (i,j),  <span class="math">i \\neq j</span> ,  <span class="math">2 \\leq i \\leq \\alpha</span> ,  <span class="math">2 \\leq j \\leq \\alpha</span>  such that we have none of these 4 equalities:</p>

    <p class="text-gray-300"><span class="math">b_i = b_{\\alpha+1}</span>  (1) ( <span class="math">\\mu</span>  values)</p>

    <p class="text-gray-300"><span class="math">b_i = b_1 \\oplus b_{\\alpha+1} \\oplus b_{\\alpha+2}</span>  (2) ( <span class="math">\\nu</span>  values)</p>

    <p class="text-gray-300"><span class="math">b_i = b_{\\alpha+1}</span>  (3) ( <span class="math">\\mu</span>  values)</p>

    <p class="text-gray-300"><span class="math">b_i = b_{\\alpha+2}</span>  (4) ( <span class="math">\\xi</span>  values)</p>

    <ul class="list-disc list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li>(1) and (2) are not compatible since  <span class="math">b_1 \\neq b_{\\alpha+2}</span></li>
      <li>(3) and (4) are not compatible since  <span class="math">b_{\\alpha+1} \\neq b_{\\alpha+2}</span></li>
    </ul>

    <p class="text-gray-300">We have  <span class="math">(\\alpha - 1)(\\alpha - 2)</span>  values (i, j),  <span class="math">i \\neq j</span> ,  <span class="math">2 \\leq i \\leq \\alpha</span> ,  <span class="math">2 \\leq j \\leq \\alpha</span> . We have  <span class="math">(\\mu + \\nu)(\\alpha - 2)</span>  values (i, j) such that i satisfies (1) or (2) and  <span class="math">j \\neq i</span> . We have  <span class="math">(\\mu + \\xi)(\\alpha - 2)</span>  values (i, j) such that j satisfies (3) or (4) and  <span class="math">j \\neq i</span> . Therefore</p>

    <p class="text-gray-300"><span class="math">$|\\mathcal{N}| = (\\alpha - 1)(\\alpha - 2) - (\\mu + \\nu)(\\alpha - 2) - (\\mu + \\xi)(\\alpha - 2) + |\\mathcal{P}|</span>$</p>

    <p class="text-gray-300">where  <span class="math">\\mathcal{P} = \\{(i, j) \\text{ such that } i \\text{ satisfies (1) or (2), and } j \\text{ satisfies (3) or (4)} \\}</span></p>

    <p class="text-gray-300">(1) and (3): we have  <span class="math">\\mu(\\mu-1)</span>  values.</p>

    <ul class="list-disc list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li>(1) and (4): we have  <span class="math">\\mu.\\xi</span>  values  <span class="math">(i \\neq j \\text{ since } b_{\\alpha+1} \\neq b_{\\alpha+2})</span> .</li>
      <li>(2) and (3): we have  <span class="math">\\nu\\xi</span>  values (because  <span class="math">b_1 \\neq b_{\\alpha+2}</span> ).</li>
    </ul>

    <p class="text-gray-300">(2) and (4):
<span class="math">$\\begin{cases} b_i = b_1 \\oplus b_{\\alpha+1} \\oplus b_{\\alpha+2} \\ (\\nu \\text{ values}) \\\\ b_j = b_{\\alpha+2} \\ (\\xi \\text{ values}) \\end{cases}</span>$
We must have  <span class="math">i \\neq j</span> . However  <span class="math">i = j</span>  gives  <span class="math">b_1 = b_{\\alpha+1}</span> .</p>

    <p class="text-gray-300">Case 1.  <span class="math">b_1 = b_{\\alpha+1}</span> . Then for (2) and (4) we have  <span class="math">\\nu \\xi</span>  possibilities.</p>

    <p class="text-gray-300">Case 2.  <span class="math">b_1 = b_{\\alpha+1}</span> . Then  <span class="math">\\xi = \\nu</span>  and for (2) and (4) we have  <span class="math">\\xi(\\nu - 1)</span>  possibilities. Therefore</p>

    <p class="text-gray-300"><span class="math">$|\\mathcal{N}| = (\\alpha - 1)(\\alpha - 2) - (\\alpha - 2)(2\\mu + \\nu + \\xi) + \\mu(\\mu - 1) + \\mu\\xi + \\nu\\xi + \\xi(\\nu - \\epsilon_1)</span>$</p>

    <p class="text-gray-300">as claimed.</p>

    <h3 id="sec-17" class="text-xl font-semibold mt-8">A simple variant of the schemes with only one permutation</h3>

    <p class="text-gray-300">Instead of  <span class="math">G = f_1 \\oplus f_2, f_1, f_2 \\in_R B_n</span> , we can study  <span class="math">G&#x27;(x) = f(x||0) \\oplus f(x||1)</span> , with  <span class="math">f \\in_R B_n</span>  and  <span class="math">x \\in I_{n-1}</span> . This variant was already introduced in [2] and it is for this that in [2] p.9 the security in  <span class="math">\\frac{m}{2^n} + O(n)(\\frac{m}{2^n})^{3/2}</span>  is presented. In fact, from a theoretical point of view, this variant G' is very similar to G, and it is possible to prove that our analysis can be modified to obtain a similar proof of security for G'.</p>

    <p class="text-gray-300">I have conjectured this property:</p>

    <p class="text-gray-300"><span class="math">$\\forall f \\in F_n</span>$
, if  <span class="math">\\bigoplus_{x \\in I_n} f(x) = 0</span> , then  <span class="math">\\exists (g,h) \\in B_n^2</span> , such that  <span class="math">f = g \\oplus h</span> .</p>

    <p class="text-gray-300">Just one day after this paper was put on eprint, J.F. Dillon pointed to us that in fact this was proved by Marshall Hall Jr in 1952 in [5]. We thank him a lot for this information. (This property was proved again independently in 1979 in [15]).</p>

    <p class="text-gray-300">A new conjecture. However I conjecture a stronger property. Conjecture:</p>

    <p class="text-gray-300"><span class="math">$\\forall f \\in F_n</span>$
, if  <span class="math">\\bigoplus_{x \\in I_n} f(x) = 0</span> , then the number  <span class="math">H</span>  of  <span class="math">(g,h) \\in B_n^2</span> ,</p>

    <p class="text-gray-300">such that
<span class="math">$f = g \\oplus h</span>$
satisfies  <span class="math">H \\ge \\frac{|B_n|^2}{2^{n2^n}}</span> .</p>

    <p class="text-gray-300">Variant: I also conjecture that this property is true in any group, not only with Xor.</p>

    <p class="text-gray-300"><strong>Remark:</strong> in this paper, I have proved weaker results involving m equations with  <span class="math">m \\ll O(2^n)</span> instead of all the  <span class="math">2^n</span>  equations. These weaker results were sufficient for the cryptographic security wanted.</p>

    <h3 id="sec-18" class="text-xl font-semibold mt-8">9 Conclusion</h3>

    <p class="text-gray-300">The results in this paper improve our understanding of the PRF-security of the Xor of two random permutations. More precisely in this paper we have proved that the Adaptive Chosen Plaintext security for this problem is in O(2&lt;sup&gt;n&lt;/sup&gt; ), and we have obtained an explicit O function. These results belong to the field of finding security proofs for cryptographic designs above the &quot;birthday bound&quot;. (In [1, 8, 10], some results &quot;above the birthday bound&quot; on completely different cryptographic designs are also given). Since building PRF from PRP has many practical applications,we believe that these results are of real interest both from a theoretical point of view and a practical point of view. Our proofs need a few pages, so are a bit hard to read, but the results obtained are very easy to use and the mathematics used are elementary (essentially combinatorial and induction arguments). Moreover, we have proved (in Section 5) that this cryptographic problem of security is directly related to a very simple to describe and purely combinatorial problem. We have obtained this transformation by using the &quot;H&lt;sup&gt;σ&lt;/sup&gt; technique&quot;, i.e. combining the &quot;coefficient H technique&quot; of [?, 10] and a specific computation of the standard deviation of H. (In a way, from a cryptographic point of view, this is maybe the most important result, and all the analysis after Section 5 can be seen as combinatorial mathematics and not cryptography anymore). It is also interesting to notice that in our proof with have proceeded with &quot;necessary and sufficient&quot; conditions, i.e. that the H&lt;sup&gt;σ&lt;/sup&gt; property that we proved is exactly equivalent to the cryptographic property that we wanted. Moreover, as we have seen, less strong results of security are quickly obtained.</p>

    <h3 id="sec-19" class="text-xl font-semibold mt-8">References</h3>

    <ul class="list-disc list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li><p class="text-gray-300">[1] William Aiello and Ramarathnam Venkatesan. Foiling Birthday Attacks in Length-Doubling Transformations - Benes: A Non-Reversible Alternative to Feistel. In Ueli M. Maurer, editor, Advances in Cryptology – EUROCRYPT '96, volume 1070 of Lecture Notes in Computer Science, pages 307–320. Springer-Verlag, 1996.</p></li>
      <li><p class="text-gray-300">[2] Mihir Bellare and Russell Impagliazzo. A Tool for Obtaining Tighter Security Analyses of Pseudorandom Function Based Constructions, with Applications to PRP to PRF Conversion. ePrint Archive 1999/024: Listing for 1999.</p></li>
      <li><p class="text-gray-300">[3] Mihir Bellare, Ted Krovetz, and Phillip Rogaway. Luby-Rackoff Backwards: Increasing Security by Making Block Ciphers Non-invertible. In Kaisa Nyberg, editor, Advances in cryptology – EUROCRYPT 1998, volume 1403 of Lecture Notes in Computer Science, pages 266–280. Springer-Verlag, 1998.</p></li>
      <li><p class="text-gray-300">[4] Chris Hall, David Wagner, John Kelsey, and Bruce Schneier. Building PRFs from PRPs. In Hugo Krawczyk, editor, Advances in Cryptology – CRYPTO 1998, volume 1462 of Lecture Notes in Computer Science, pages 370–389. Springer-Verlag, 1998.</p></li>
      <li><p class="text-gray-300">[5] Marshall Hall Jr. A Combinatorial Problem on Abelian Groups. Proceedings of the Americal Mathematical Society, 3(4):584–587, 1952.</p></li>
      <li><p class="text-gray-300">[6] Stefan Lucks. The Sum of PRPs Is a Secure PRF. In Bart Preneel, editor, Advances in Cryptology – EUROCRYPT 2000, volume 1807 of Lecture Notes in Computer Science, pages 470–487. Springer-Verlag, 2000.</p></li>
      <li><p class="text-gray-300">[7] Avradip Mandal, Jacques Patarin, and Val´erie Nachef. Indifferentiability beyond the Birthday Bound for the Xor of Two Public Random Permutations. In Guang Gong and Kishan Chand Gupta, editors, Progress in Cryptology – INDOCRYPT 2010, volume 6948 of Lecture Notes in Computer Science, pages 69–81. Springer-Verlag, 2010.</p></li>
      <li><p class="text-gray-300">[8] Ueli Maurer and Krzysztof Pietrzak. The Security of Many-Round Luby-Rackoff Pseudo-Random Permutations. In Eli Biham, editor, Advances in Cryptology – EUROCRYPT 2003, volume 2656 of Lecture Notes in Computer Science, pages 544–561. Springer-Verlag, 2003.</p></li>
      <li><p class="text-gray-300">[9] Jacques Patarin. Introduction to Mirror Theory: Analysis of Systems of Linear Equalities and Linear Non Equalitites for Cryptography. Cryptology ePrint archive: 2010/287: Listing for 2010.</p></li>
      <li><p class="text-gray-300">[10] Jacques Patarin. Luby-Rackoff: 7 Rounds are Enough for 2n(1−) Security. In Dan Boneh, editor, Advances in Cryptology – CRYPTO 2003, volume 2729 of Lecture Notes in Computer Science, pages 513–529. Springer-Verlag, 2003.</p></li>
      <li><p class="text-gray-300">[11] Jacques Patarin. On linear systems of equations with distinct variables and Small block size. In Dongho Wan and Seungjoo Kim, editors, ICISC 2005, volume 3935 of Lecture Notes in Computer Science, pages 299–321. Springer-Verlag, 2006.</p></li>
      <li><p class="text-gray-300">[12] Jacques Patarin. The coefficients H technique. In Roberto Avanzi, Liam Keliher, and Francesco Sica, editors, SAC 2008, volume 5381 of Lecture Notes in Computer Science, pages 328–345. Springer-Verlag, 2008.</p></li>
      <li><p class="text-gray-300">[13] Jacques Patarin. A Proof of Security in O(2&lt;sup&gt;n&lt;/sup&gt; ) for the Xor of Two Random Permutations . In Reihaneh Safavi-Naini, editor, ICITS 2008, volume 5155 of Lecture Notes in Computer Science, pages 232–248. Springer-Verlag, 2008. An extended version is also on eprint.</p></li>
      <li><p class="text-gray-300">[14] Jacques Patarin. Generic Attacks for the Xor of k Random Permutations. In Michael J. Jacobson Jr., Michael E. Locasto, Payman Mohassel, and Reihaneh Safavi-Naini, editors, ACNS 2013, volume 7954 of Lecture Notes in Computer Science, pages 154–169. Springer-Verlag, 2013.</p></li>
      <li><p class="text-gray-300">[15] F. Salzborn and G. Szekeres. A Problem in Combinatorial Group Theory. Ars Combinatoria, 7:3–5, 1979.</p></li>
      <li><p class="text-gray-300">[16] Emmanuel Volte, Jacques Patarin, and Val´erie Nachef. Mirror Theory: Theorems and Conjectures. Applicaitons to Cryptography. Available from the authors.</p></li>
    </ul>

    <p class="text-gray-300">As examples, we present here the exact values for h&lt;sup&gt;m&lt;/sup&gt; and h 0 &lt;sup&gt;m&lt;/sup&gt; when m = 1, 2 or 3. The values that we will obtain are summarized in Table 1.</p>

    <p class="text-gray-300">(∗) h 0 &lt;sup&gt;3&lt;/sup&gt; denotes the condition h&lt;sup&gt;3&lt;/sup&gt; plus X : P&lt;sup&gt;1&lt;/sup&gt; ⊕ Q&lt;sup&gt;3&lt;/sup&gt; = b&lt;sup&gt;4&lt;/sup&gt; with b&lt;sup&gt;1&lt;/sup&gt; 6= b&lt;sup&gt;4&lt;/sup&gt; and b&lt;sup&gt;3&lt;/sup&gt; 6= b4. E denotes these 4 equalities: b&lt;sup&gt;2&lt;/sup&gt; = b3, b&lt;sup&gt;2&lt;/sup&gt; = b&lt;sup&gt;1&lt;/sup&gt; ⊕ b&lt;sup&gt;3&lt;/sup&gt; ⊕ b4, b&lt;sup&gt;2&lt;/sup&gt; = b&lt;sup&gt;4&lt;/sup&gt; and b&lt;sup&gt;1&lt;/sup&gt; = b2.</p>

    <p class="text-gray-300">Table 1: Summary of the results on  <span class="math">h_m</span>  for m = 1, 2, 3</p>

    <p class="text-gray-300">Table 1: Summary of the results on
<span class="math">$h_m</span>$
for  <span class="math">m = 1, 2, 3</span></p>

    <p class="text-gray-300">• If  <span class="math">b_1 \\neq b_2</span> :
<span class="math">$h_2 = 2^n(2^n - 2)</span>$
• If  <span class="math">b_1 = b_2</span> :
<span class="math">$h_2 = 2^n(2^n - 1)</span>$
• If  <span class="math">b_1 = b_2</span> :
<span class="math">$h_2 = 2^n(2^n - 1)</span>$
• If  <span class="math">b_1 = b_2 \\neq b_3</span> :
<span class="math">$h_3 = 2^n(2^{2n} - 5.2^n + 6)</span>$
• If  <span class="math">b_1 = b_2 = b_3</span> :
<span class="math">$h_3 = 2^n(2^{2n} - 3.2^n + 2)</span>$
• If we have no equality in  <span class="math">\\mathcal{E}</span>  (*):
<span class="math">$h_3&#x27; = 2^n(2^n - 3)</span>$
• If we have 2 equalities in  <span class="math">\\mathcal{E}</span> :
<span class="math">$h_3&#x27; = 2^n(2^n - 2)</span>$
• If  <span class="math">\\mathbf{e}</span>  have 2 equalities in  <span class="math">\\mathcal{E}</span> :
<span class="math">$h_3&#x27; = 2^n(2^n - 2)</span>$
• If  <span class="math">\\mathbf{e}</span>  have  <span class="math">\\mathbf{e}</span>  and  <span class="math">\\mathbf{e}</span>  in  <span class="math">\\mathcal{E}</span> :
<span class="math">$h_3&#x27; = 2^n(2^n - 2)</span>$
• If  <span class="math">\\mathbf{e}</span>  have  <span class="math">\\mathbf{e}</span>  and  <span class="math">\\mathbf{e}</span>  in  <span class="math">\\mathcal{E}</span> :
<span class="math">$h_3&#x27; = 2^n(2^n - 2)</span>$
• If  <span class="math">\\mathbf{e}</span>  have  <span class="math">\\mathbf{e}</span>  and  <span class="math">\\mathbf{e}</span>  in  <span class="math">\\mathcal{E}</span> :
<span class="math">$h_3&#x27; = 2^n(2^n - 2)</span>$
• If  <span class="math">\\mathbf{e}</span>  have  <span class="math">\\mathbf{e}</span>  and  <span class="math">\\mathbf{e}</span>  in  <span class="math">\\mathcal{E}</span> :
<span class="math">$h_3&#x27; = 2^n(2^n - 2)</span>$
• If  <span class="math">\\mathbf{e}</span>  have  <span class="math">\\mathbf{e}</span>  and  <span class="math">\\mathbf{e}</span>  in  <span class="math">\\mathcal{E}</span> :
<span class="math">$h_3&#x27; = 2^n(2^n - 2)</span>$
• If  <span class="math">\\mathbf{e}</span>  have  <span class="math">\\mathbf{e}</span>  and  <span class="math">\\mathbf{e}</span>  in  <span class="math">\\mathcal{E}</span> :
<span class="math">$h_3&#x27; = 2^n(2^n - 2)</span>$
• If  <span class="math">\\mathbf{e}</span>  have  <span class="math">\\mathbf{e}</span>  and  <span class="math">\\mathbf{e}</span>  in  <span class="math">\\mathcal{E}</span> :
<span class="math">$h_3&#x27; = 2^n(2^n - 2)</span>$
• If  <span class="math">\\mathbf{e}</span>  have  <span class="math">\\mathbf{e}</span>  and  <span class="math">\\mathbf{e}</span>  in  <span class="math">\\mathcal{E}</span> :
<span class="math">$\\mathbf{e}</span>$
have  <span class="math">\\mathbf{e}</span>  and  <span class="math">\\mathbf{e}</span>  in  <span class="math">\\mathcal{E}</span> :
<span class="math">$\\mathbf{e}</span>$
have  <span class="math">\\mathbf{e}</span>  and  <span class="math">\\mathbf{e}</span>  in  <span class="math">\\mathcal{E}</span> :
<span class="math">$\\mathbf{e}</span>$
have  <span class="math">\\mathbf{e}</span>  and  <span class="math">\\mathbf{e}</span>  in  <span class="math">\\mathcal{E}</span> :
<span class="math">$\\mathbf{e}</span>$
have  <span class="math">\\mathbf{e}</span>  and  <span class="math">\\mathbf{e}</span>  in  <span class="math">\\mathcal{E}</span> :
<span class="math">$\\mathbf{e}</span>$
have  <span class="math">\\mathbf{e}</span>  and  <span class="math">\\mathbf{e}</span>  in  <span class="math">\\mathcal{E}</span> :
<span class="math">$\\mathbf{e}</span>$
have  <span class="math">\\mathbf{e}</span>  and  <span class="math">\\mathbf{e}</span>  in  <span class="math">\\mathcal{E}</span> :
<span class="math">$\\mathbf{e}</span>$
have  <span class="math">\\mathbf{e}</span>  and  <span class="math">\\mathbf{e}</span>  in  <span class="math">\\mathcal{E}</span> :
<span class="math">$\\mathbf{e}</span>$
have  <span class="math">\\mathbf{e}</span>  and  <span class="math">\\mathbf{e}</span>  in  <span class="math">\\mathcal{E}</span> :
<span class="math">$\\mathbf{e}</span>$
have  <span class="math">\\mathbf{e}</span>  and  <span class="math">\\mathbf{e}</span>  in  <span class="math">\\mathcal{E}</span> :
<span class="math">$\\mathbf{e}</span>$
have  <span class="math">\\mathbf{e}</span>  and  <span class="math">\\mathbf{e}</span>  in  <span class="math">\\mathcal{E}</span> :
<span class="math">$\\mathbf{e}</span>$
have  <span class="math">\\mathbf{e}</span>  and  <span class="math">\\mathbf{e}</span>  in  <span class="math">\\mathcal{E}</span> :
<span class="math">$\\mathbf{e}</span>$
have  <span class="math">\\mathbf{e}</span>  and  <span class="math">\\mathbf{e}</span>  in  <span class="math">\\mathcal{E}</span> :
<span class="math">$\\mathbf{e}</span>$
have  <span class="math">\\mathbf{e}</span>  and  <span class="math">\\mathbf{e}</span>  in  <span class="math">\\mathcal{E}</span> :
<span class="math">$\\mathbf{e}</span>$
have  <span class="math">\\mathbf{e}</span>  and  <span class="math">\\mathbf{e}</span>  in  <span class="math">\\mathcal{E}</span> :
<span class="math">$\\mathbf{e}</span>$
have  <span class="math">\\mathbf{e}</span>  and  <span class="math">\\mathbf{e}</span>  in  <span class="math">\\mathcal{E}</span> :
<span class="math">$\\mathbf{e}</span>$
have  <span class="math">\\mathbf{e}</span>  and  <span class="math">\\mathbf{e}</span>  in  <span class="math">\\mathcal{E}</span> :
<span class="math">$\\mathbf{e}</span>$
have  <span class="math">\\mathbf{e}</span>  and  <span class="math">\\mathbf{e}</span>  in  <span class="math">\\mathcal{E}</span> :
<span class="math">$\\mathbf{e}</span>$
have  <span class="math">\\mathbf{e}</span>  and  <span class="math">\\mathbf{e}</span>  in  <span class="math">\\mathcal{E}</span> :
<span class="math">$\\mathbf{e}</span>$
have  <span class="math">\\mathbf{e}</span>  and  <span class="math">\\mathbf{e}</span>  in  <span class="math">\\mathcal{E}</span> :
<span class="math">$\\mathbf{e}</span>$
have  <span class="math">\\mathbf{e}</span>  in  <span class="math">\\mathcal{E}</span>  in  <span class="math">\\mathcal{E}</span>  in  <span class="math">\\mathcal{E}</span>  in  <span class="math">\\mathcal{E}</span>  in  <span class="math">\\mathcal{E}</span>  in  <span class="math">\\mathcal{E}</span>  in  <span class="math">\\mathcal{E}</span>  in  <span class="math">\\mathcal{E}</span>  in  <span class="math">\\mathcal{E}</span>  in  <span class="math">\\mathcal{E}</span>  in  <span class="math">\\mathcal{E}</span>  in  <span class="math">\\mathcal{E}</span>  in  <span class="math">\\mathcal{E}</span>  in  <span class="math">\\mathcal{E}</span>  in  <span class="math">\\mathcal{E}</span>  in  <span class="math">\\mathcal{E}</span>  in  <span class="math">\\mathcal{E}</span>  in  <span class="math">\\mathcal{E}</span>  in  <span class="math">\\mathcal{E}</span>  in  <span class="math">\\mathcal{E}</span>  in  <span class="math">\\mathcal{E}</span>  in  <span class="math">\\mathcal{E}</span>  in  <span class="math">\\mathcal{E}</span>  in  <span class="math">\\mathcal{E}</span>  in  <span class="math">\\mathcal{E}</span>  in</p>

    <p class="text-gray-300">From  <span class="math">h_m</span>  we get the exact value for  <span class="math">Adv_m</span>  by using Theorem 5 (and Theorem 4 to get the value of  <span class="math">h_m</span> ).</p>

    <h4 id="sec-20" class="text-lg font-semibold mt-6">A.1m=1</h4>

    <p class="text-gray-300">By definition,  <span class="math">h_1</span>  is the number of  <span class="math">P_1, Q_1 \\in I_n</span>  such that  <span class="math">P_1 \\oplus Q_1 = b_1</span> . Therefore,  <span class="math">h_1 = 2^n</span> . Now from  <span class="math">Adv_1 = \\frac{1}{2^{2n}} \\sum_{b_1 \\in I_n} |h_1 - h_1|</span>  and  <span class="math">h_1 = 2^n</span> , we get:  <span class="math">Adv_1 = 0</span> .</p>

    <h4 id="sec-21" class="text-lg font-semibold mt-6"><span class="math">\\mathbf{A.2}</span> m=2</h4>

    <p class="text-gray-300">By definition,  <span class="math">h_2</span>  is the number of  <span class="math">P_1, P_2, Q_1, Q_2 \\in I_n</span>  such that:  <span class="math">P_1 \\neq P_2, Q_1 \\neq Q_2, P_1 \\oplus Q_1 = b_1</span> and  <span class="math">P_2 \\oplus Q_2 = b_2</span> . We have  <span class="math">Q_1 \\neq Q_2 \\Leftrightarrow P_1 \\oplus P_2 \\neq b_1 \\oplus b_2</span> .</p>

    <p class="text-gray-300">Case 1.  <span class="math">b_1 \\neq b_2</span> . Then  <span class="math">h_2 = 2^n(2^n - 2)</span>  (because for  <span class="math">P_1</span>  we have  <span class="math">2^n</span>  possibilities, and then for  <span class="math">P_2</span> , we have  <span class="math">2^n - 2</span>  possibilities).</p>

    <p class="text-gray-300">Case 2.  <span class="math">b_1 = b_2</span> . Then  <span class="math">h_2 = 2^n(2^n - 1)</span>  (because for  <span class="math">P_1</span>  we have  <span class="math">2^n</span>  possibilities, and then for  <span class="math">P_2</span> , we have  <span class="math">2^n - 1</span>  possibilities).</p>

    <p class="text-gray-300">Now from  <span class="math">Adv_2 = \\frac{1}{2 \\cdot [2^n(2^n-1)]^2} \\sum_{b_1,b_2 \\in I_n} |h_2 - \\tilde{h_2}|</span>  and  <span class="math">\\tilde{h_2} = \\frac{[2^n(2^n-1)]^2}{2^{2n}} = (2^n-1)^2</span> , we get:  <span class="math">Adv_2 = \\frac{1}{2} \\frac{1}{2^n} \\frac{1}{2^n} \\frac{1}{2^n} \\frac{1}{2^n} \\frac{1}{2^n} \\frac{1}{2^n} \\frac{1}{2^n} \\frac{1}{2^n} \\frac{1}{2^n} \\frac{1}{2^n} \\frac{1}{2^n} \\frac{1}{2^n} \\frac{1}{2^n} \\frac{1}{2^n} \\frac{1}{2^n} \\frac{1}{2^n} \\frac{1}{2^n} \\frac{1}{2^n} \\frac{1}{2^n} \\frac{1}{2^n} \\frac{1}{2^n} \\frac{1}{2^n} \\frac{1}{2^n} \\frac{1}{2^n} \\frac{1}{2^n} \\frac{1}{2^n} \\frac{1}{2^n} \\frac{1}{2^n} \\frac{1}{2^n} \\frac{1}{2^n} \\frac{1}{2^n} \\frac{1}{2^n} \\frac{1}{2^n} \\frac{1}{2^n} \\frac{1}{2^n} \\frac{1}{2^n} \\frac{1}{2^n} \\frac{1}{2^n} \\frac{1}{2^n} \\frac{1}{2^n} \\frac{1}{2^n} \\frac{1}{2^n} \\frac{1}{2^n} \\frac{1}{2^n} \\frac{1}{2^n} \\frac{1}{2^n} \\frac{1}{2^n} \\frac{1}{2^n} \\frac{1}{2^n} \\frac{1}{2^n} \\frac{1}{2^n} \\frac{1}{2^n} \\frac{1}{2^n} \\frac{1}{2^n} \\frac{1}{2^n} \\frac{1}{2^n} \\frac{1}{2^n} \\frac{1}{2^n} \\frac{1}{2^n} \\frac{1}{2^n} \\frac{1}{2^n} \\frac{1}{2^n} \\frac{1}{2^n} \\frac{1}{2^n} \\frac{1}{2^n} \\frac{1}{2^n} \\frac{1}{2^n} \\frac{1}{2^n} \\frac{1}{2^n} \\frac{1}{2^n} \\frac{1}{2^n} \\frac{1}{2^n} \\frac{1}{2^n} \\frac{1}{2^n} \\frac{1}{2^n} \\frac{1}{2^n} \\frac{1}{2^n} \\frac{1}{2^n} \\frac{1}{2^n} \\frac{1}{2^n} \\frac{1}{2^n} \\frac{1}{2^n} \\frac{1}{2^n} \\frac{1}{2^n} \\frac{1}{2^n} \\frac{1}{2^n} \\frac{1}{2^n} \\frac{1}{2^n} \\frac{1}{2^n} \\frac{1}{2^n} \\frac{1}{2^n} \\frac{1}{2^n} \\frac{1}{2^n} \\frac{1}{2^n} \\frac{1}{2^n} \\frac{1}{2^n} \\frac{1}{2^n} \\frac{1}{2^n} \\frac{1}{2^n} \\frac{1}{2^n} \\frac{1}{2^n} \\frac{1}{2^n} \\frac{1}{2^n} \\frac{1}{2^n} \\frac{1}{2^n} \\frac{1}{2^n} \\frac{1}{2^n} \\frac{1}{2^n} \\frac{1}{2^n} \\frac{1}{2^n} \\frac{1}{2^n} \\frac{1}{2^n} \\frac{1}{2^n} \\frac{1}{2^n} \\frac{1}{2^n} \\frac{1}{2^n} \\frac{1}{2^n} \\frac{1}{2^n} \\frac{1}{2^n} \\frac{1}{2^n} \\frac{1}{2^n} \\frac{1}{2^n} \\frac{1}{2^n} \\frac{1}{2^n} \\frac{1}{2^n} \\frac{1}{2^n} \\frac{1}{2^n} \\frac{1}{2^n} \\frac{1}{2^n} \\frac{1}{2^n} \\frac{1}{2^n} \\frac{1}{2^n} \\frac{1}{2^n} \\frac{1}{2^n} \\frac{1}{2^n} \\frac{1}{2^n} \\frac{1}{2^n} \\frac{1}{2^n} \\frac{1}{2^n} \\frac{1}{2^n} \\frac{1}{2^n} \\frac{1}{2^n} \\frac{1}{2^n} \\frac{1}{2^n} \\frac{1}{2^n} \\frac{1}{2^n} \\frac{1}{2^n} \\frac{1}{2^n} \\frac{1}{2^n} \\frac{1}{2^n} \\frac{1}{2^n} \\frac{1}{2^n} \\frac{1}{2^n} \\frac{1}{2^n} \\frac{1}{2^n} \\frac{1}{2^n} \\frac{1}{2^n} \\frac{1}{2^n} \\frac{1}{2^n} \\frac{1}{2^n} \\frac{1}{2^n} \\frac{1}{2^n} \\frac{1}{2^n} \\frac{1}{2^n} \\frac{1}{2^n} \\frac{1}{2^n} \\frac{1}{2^n} \\frac{1}{2^n} \\frac{1}{2^n} \\frac{1}{2^n} \\frac{1}{2^n} \\frac{1}{2^n} \\frac{1}{2^n} \\frac{1}{2^n} \\frac{1}{2^n} \\frac{1}{2^n} \\frac{1}{2^n} \\frac{1}{2^n} \\frac{1}{2^n} \\frac{1}{2^n} \\frac{1}{2^n} \\frac{1}{2^n} \\frac{1}{2^n} \\frac{1}{2^n} \\frac{1}{2^n} \\frac{1}{2^n} \\frac{1}{2^n} \\frac{1}{2^n} \\frac{1}{2^n}</span>  <span class="math">\\frac{1}{2^n(2^n-1)} \\simeq \\frac{1}{2^{2n}}</span> .</p>

    <h4 id="sec-22" class="text-lg font-semibold mt-6">Standard deviation for m=2</h4>

    <p class="text-gray-300">Les  <span class="math">\\sigma</span>  be the standard deviation of  <span class="math">h_2</span>  when  <span class="math">b_1, b_2 \\in_R I_n</span> .  <span class="math">\\sigma = \\sqrt{V(h_2)} = \\sqrt{E(h_2 - \\tilde{h_2})^2}</span> . Let  <span class="math">\\sigma&#x27;</span>  be the average deviation of  <span class="math">h_2</span>  when  <span class="math">b_1, b_2 \\in_R I_n</span> .  <span class="math">\\sigma&#x27; = E(|h_2 - \\tilde{h_2}|)</span> .</p>

    <p class="text-gray-300"><span class="math">$V(h_2) = \\frac{1}{2^{2n}} [2^n (2^n - 1)^2 + 2^n (2^n - 1)] = 2^n - 1</span>$</p>

    <p class="text-gray-300">Therefore  <span class="math">\\sigma = \\sqrt{2^n - 1} \\simeq \\frac{\\tilde{h_2}}{2^{1.5n}}</span> .</p>

    <p class="text-gray-300"><span class="math">$\\sigma&#x27; = \\frac{1}{2^{2n}} [2^n (2^n - 1) + 2^n (2^n - 1).1]</span>$</p>

    <p class="text-gray-300">Therefore  <span class="math">\\sigma&#x27; = \\frac{2(2^n-1)}{2^n} \\simeq \\frac{2\\tilde{h_2}}{2^{2n}}</span> . We see that here  <span class="math">\\sigma&#x27; \\simeq \\frac{2\\sigma}{\\sqrt{2^n}}</span> .</p>

    <p class="text-gray-300">So  <span class="math">\\sigma</span>  is much larger than  <span class="math">\\sigma&#x27;</span>  when n is large. This is one of the reasons that explains that when m is fixed and small the approximation of Adv obtained by Bienaymé-Tchebichev from  <span class="math">\\sigma</span>  (used in [13]) gives when m is fixed and small only  <span class="math">Adv \\leq O(\\frac{1}{2^n})</span>  while the real Advantage is in  <span class="math">O(\\frac{1}{2^{2n}})</span> .</p>

    <h4 id="sec-23" class="text-lg font-semibold mt-6"><strong>A.3</strong> m = 3</h4>

    <p class="text-gray-300">In section 4 we have sen that (orange equation):</p>

    <p class="text-gray-300"><span class="math">$h_{\\alpha+1} = (2^n - 2\\alpha + |M|)h_{\\alpha} + \\sum_{i \\notin M} \\sum_{j \\notin M, j \\neq i} h&#x27;_{\\alpha}(i,j)</span>$</p>

    <p class="text-gray-300">with  <span class="math">M = \\{i, 1 \\le i \\le \\alpha, b_i = b_{\\alpha+1}\\}.</span></p>

    <p class="text-gray-300">With  <span class="math">\\alpha = 2</span> , this formula will give us  <span class="math">h_3</span>  from  <span class="math">h_2</span>  and  <span class="math">h&#x27;_2</span> .</p>

    <p class="text-gray-300"><span class="math">M = \\{i, 1 \\le i \\le 2, b_i = b_3\\}.</span></p>

    <p class="text-gray-300">Case 1.  <span class="math">b_1, b_2, b_3</span>  are pairwise distinct. Then |M| = 0 and  <span class="math">h_3 = (2^n - 4)h_2 + 2h&#x27;_2</span> .  <span class="math">h_3 = (2^n - 4).2^n.(2^n - 2) + 2.2^n</span> .</p>

    <p class="text-gray-300"><span class="math">h_3 = 2^n(2^{2n} - 6.2^n + 10)</span>  and since  <span class="math">\\tilde{h_3} = \\frac{[2^n(2^n-1)(2^n-2)]^2}{2^{3n}} = 2^{3n} - 6.2^{2n} + 13.2^n - 12 + \\frac{4}{2^n}</span> , we have  <span class="math">h_3 - \\tilde{h_3} = -3.2^n + 12 - \\frac{4}{2^n}</span> . Therefore, when  <span class="math">n \\ge 2</span> , we have  <span class="math">h_3 &lt; \\tilde{h_3}</span>  in this case 1 (and without loss of generality, we can assume  <span class="math">n \\ge 2</span>  since for n = 1 we have only two values in  <span class="math">I_n</span>  but here the number m of queries is m = 3).</p>

    <p class="text-gray-300">Case 2. We have  <span class="math">b_1 = b_3 \\neq b_2</span> . Then |M| = 1,  <span class="math">h_3 = (2^n - 3)h_2</span> ,  <span class="math">h_3 = (2^n - 3).2^n(2^n - 2)</span> ,  <span class="math">h_3 = 2^n(2^{2n} - 5.2^n + 6)</span> . Here  <span class="math">h_3 - \\tilde{h_3} = 2^{2n} - 7.2^n + 12 - \\frac{4}{2^n} = (2^n - 2)(2^n - 5 + \\frac{2}{2^n})</span> . Therefore, when  <span class="math">n \\geq 3</span> , we have  <span class="math">h_3 &gt; \\tilde{h_3}</span> , and when n = 3, we have  <span class="math">h_3 &lt; \\tilde{h_3}</span> .</p>

    <p class="text-gray-300">Case 2 bis. We can check that when  <span class="math">b_1 = b_2 \\neq b_3</span>  we obtain the same value (this is obvious by symmetry of the hypothesis but not obvious from the orange equation).</p>

    <p class="text-gray-300">Here |M| = 0 and  <span class="math">h_3 = (2^n - 4)h_2 + 2h_2&#x27;</span> .</p>

    <p class="text-gray-300"><span class="math">h_3 = (2^n - 4).2, (2^n - 1) + 2.2^n</span></p>

    <p class="text-gray-300"><span class="math">h_3 = 2^n (2^{2n} - 5.2^n + 6)</span>  as in Case 2.</p>

    <p class="text-gray-300">Case 3.  <span class="math">b_1 = b_2 = b_3</span> . Here |M| = 2 and  <span class="math">h_3 = (2^n - 2)h_2 = (2^n - 2)2^n(2^n - 1)</span>  So  <span class="math">h_3 = 2^n(2^{2n} - 3.2^n + 2)</span>  and  <span class="math">h_3 - \\tilde{h_3} = 3.2^{2n} - 11.2^n + 12 - \\frac{4}{2^n}</span>  and it is easy to see that this is always  <span class="math">\\geq 0</span>  if  <span class="math">n \\geq 0</span> . (We can also say that we have</p>

    <p class="text-gray-300"><span class="math">$h_3 \\ge \\tilde{h_3} \\Leftrightarrow 2^n (2^n - 1)(2^n - 2) \\ge \\frac{[2^n (2^n - 1)(2^n - 2)]^2}{2^{3n}}</span>$</p>

    <p class="text-gray-300"><span class="math">\\Leftrightarrow 2^{2n} \\ge (2^n - 1)(2^n - 2)</span></p>

    <p class="text-gray-300">since  <span class="math">n \\ge 2</span>  since we have m=3 queries). Therefore  <span class="math">h_3</span>  is always  <span class="math">\\ge \\tilde{h_3}</span>  in Case 3. Finally, from</p>

    <p class="text-gray-300"><span class="math">$Adv_3 = \\frac{1}{2 \\cdot [2^n (2^n - 1)(2^n - 2)]^2} \\sum_{b_1, b_2, b_3 \\in I_n} |h_3 - \\tilde{h_3}|</span>$</p>

    <p class="text-gray-300">or from</p>

    <p class="text-gray-300"><span class="math">$Adv_3 = \\frac{1}{[2^n(2^n - 1)(2^n - 2)]^2} \\sum_{b_1, b_2, b_3/h_3 &lt; \\tilde{h}_3} (\\tilde{h}_3 - h_3)</span>$</p>

    <p class="text-gray-300">we obtain, if  <span class="math">n \\geq 3</span></p>

    <p class="text-gray-300"><span class="math">$Adv_3 = \\frac{1}{[2^n(2^n - 1)(2^n - 2)]^2} 2^n (2^n - 1)(2^n - 2)(3 \\cdot 2^n - 12 + \\frac{4}{2^n})</span>$
<span class="math">$Adv_3 = \\frac{1}{2^{2n}(2^n - 1)(2^n - 2)} (3 \\cdot 2^{2n} - 12 \\cdot 2^n + 4) \\simeq \\frac{3}{2^{2n}}</span>$</p>

    <p class="text-gray-300">We did not need the value  <span class="math">h&#x27;_3</span>  to compute  <span class="math">h_3</span> . However these values are directly given from section 6: &quot;first purple equations&quot;.</p>

    <p class="text-gray-300">With  <span class="math">\\alpha = 2</span> ,  <span class="math">h_2&#x27;&#x27; = 0</span> ,  <span class="math">X : P_1 \\oplus Q_3 = b_4</span> ,  <span class="math">b_4 \\neq b_1</span> ,  <span class="math">b_4 \\neq b_3</span> , we get  <span class="math">h_3&#x27; = h_2 + (-2 + \\mu + \\xi + \\nu) \\cdot 2^n</span> , with  <span class="math">\\mu = 1</span>  if  <span class="math">b_3 = b_2</span> ,  <span class="math">\\xi = 1</span>  if  <span class="math">b_4 = b_2</span>  and  <span class="math">\\nu = 1</span>  if  <span class="math">b_1 \\oplus b_2 \\oplus b_3 \\oplus b_4 = 0</span> .</p>

    <h4 id="sec-24" class="text-lg font-semibold mt-6">The stabilization formulas</h4>

    <p class="text-gray-300">We can check these values with the &quot;Stabilization formulas&quot; (i.e. Theorem 9 and Theorem 10).</p>

    <p class="text-gray-300">The stabilization formula for  <span class="math">h_3</span>  is:</p>

    <p class="text-gray-300"><span class="math">$\\sum_{b_3 \\in I_n} h_3 = (2^n - 2)^2 h_2</span>$</p>

    <ul class="list-disc list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li>If  <span class="math">b_1 \\neq b_2</span> , this gives:  <span class="math">(2^n 2) \\cdot 2^n (2^{2n} 6 \\cdot 2^n + 10) + 2 \\cdot 2^n (2^{2n} 5 \\cdot 2^n + 6) = (2^n 2)^2 \\cdot 2^n (2^n 2)</span> . If  <span class="math">b_1 = b_2</span> , this gives:  <span class="math">(2^n 1) \\cdot 2^n (2^{2n} 5 \\cdot 2^n + 6) + (2^{2n} 3 \\cdot 2^n + 2) = (2^n 2)^2 \\cdot 2^n (2^n 1)</span> .</li>
    </ul>

    <p class="text-gray-300">The stabilization formula for  <span class="math">h&#x27;_3</span>  is:</p>

    <p class="text-gray-300"><span class="math">$\\sum_{b_4 \\notin \\{b_1, b_3\\}} h_3&#x27; = h_3 \\quad \\text{(since } X \\text{ is } P_1 \\oplus Q_3 = b_4\\text{)}</span>$</p>

    <p class="text-gray-300">There are 4 special values for  <span class="math">b_4</span> :  <span class="math">b_1, b_2, b_3</span>  and  <span class="math">b_1 \\oplus b_2 \\oplus b_3</span>  ( <span class="math">h&#x27;_3 = 0</span>  if  <span class="math">b_4 = b_1</span>  or  <span class="math">b_4 = b_3</span> ).</p>

    <ul class="list-disc list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li>If  <span class="math">b_1, b_2, b_3</span>  are pairwise distinct, this gives:  <span class="math">(2^n 4) \\cdot 2^n (2^n 4) + 2 \\cdot 2^n (2^n 3) = 2^n (2^{2n} 6 \\cdot 2^n + 10)</span> .</li>
      <li>If  <span class="math">b_1 = b_2 \\neq b_3</span> , this gives:  <span class="math">(2^n 2) \\cdot 2^n (2^n 3) = 2^n (2^{2n} 5 \\cdot 2^n + 6)</span> .</li>
      <li>If  <span class="math">b_1 = b_2 = b_3</span> , this gives:  <span class="math">(2^n 1) \\cdot 2^n (2^n 2) = 2^n (2^{2n} 3 \\cdot 2^n + 2)</span> .</li>
    </ul>

    <h4 id="sec-25" class="text-lg font-semibold mt-6">В Example of unusual values for <span class="math">h_m</span></h4>

    <p class="text-gray-300"><span class="math">h_m</span> ; or more precisely,  <span class="math">h_m(b)</span> , is the number of  <span class="math">(P_1, P_2, \\dots, P_m, Q_1, \\dots, Q_m) \\in I_n^{2m}</span>  such that</p>

    <ul class="list-disc list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li><ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li>The  <span class="math">P_i</span>  are pairwise distinct.</li>
    </ol></li>
      <li><ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li>The  <span class="math">Q_i</span>  are pairwise distinct.</li>
    </ol></li>
      <li><ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li><span class="math">\\forall i, 1 \\leq i \\leq m, P_i \\oplus Q_i = b_i</span> .</li>
    </ol></li>
    </ul>

    <p class="text-gray-300">The average value of  <span class="math">h_m</span> , when  <span class="math">(b_1, \\ldots, b_m) \\in I_n^m</span>  is:</p>

    <p class="text-gray-300"><span class="math">$\\tilde{h_m} = \\frac{(2^n(2^n - 1)\\dots(2^n - m + 1))^2}{2^{nm}}</span>$
(cf Theorem 4)</p>

    <p class="text-gray-300"><strong>Theorem 14</strong> When  <span class="math">b_i</span>  is a constant, i.e.  <span class="math">\\forall i, 1 \\leq i \\leq m, b_i = b_1</span> , we have:</p>

    <p class="text-gray-300"><span class="math">$h_m = 2^n(2^n - 1)\\dots(2^n - m + 1)</span>$</p>

    <p class="text-gray-300"><strong>Proof.</strong> We have to choose the  <span class="math">P_i</span>  pairwise distinct, and then the values  <span class="math">Q_i</span>  are fixed and pairwise distinct by:  <span class="math">\\forall i, 1 \\leq i \\leq m, Q_i = b_1 \\oplus P_i</span> .</p>

    <p class="text-gray-300">This value  <span class="math">2^n(2^n-1)\\dots(2^n-m+1)</span>  is the maximum possible value for  <span class="math">h_m</span> , since when  <span class="math">P_1,\\dots,P_m</span>  are fixed, there is at most one possibility for  <span class="math">Q_1,\\dots,Q_m</span> .</p>

    <p class="text-gray-300"><strong>Remark.</strong> Il is conjectured that the minimum value for  <span class="math">h_m</span>  is obtained when the values  <span class="math">b_1, \\ldots, b_m</span>  are pairwise distinct. When m is small (for example  <span class="math">m \\leq \\sqrt{2^n}</span> ), this is proven, but when  <span class="math">m = 2^n</span>  for example, no proof of this conjecture is known.</p>

    <p class="text-gray-300">From the results above, when  <span class="math">b_i</span>  is a constant, we have:</p>

    <p class="text-gray-300"><span class="math">$h_m/\\tilde{h_m} = \\frac{2^{nm}}{2^n(2^n - 1)\\dots(2^n - m + 1)} = \\frac{1}{(1 - \\frac{1}{2^n})(1 - \\frac{2}{2^n})\\dots(1 - \\frac{m-1}{2^n})}</span>$</p>

    <p class="text-gray-300">It is easy to see that this expression can tend to infinity when m is large and  <span class="math">\\sqrt{2^n} \\ll m \\leq 2^n</span>  (by taking the log of  <span class="math">h_m/\\tilde{h_m}</span>  for example). Therefore, we see that  <span class="math">h_m/\\tilde{h_m}</span>  is not bounded in general. Unlike this result,  <span class="math">h_m</span>  is generally  <span class="math">\\geq \\tilde{h_m}(1-\\epsilon)</span>  where  <span class="math">\\epsilon</span>  is small (see the results of this paper, when  <span class="math">m \\ll 2^{\\frac{2n}{3}}</span>  for example).</p>

    <p class="text-gray-300">    <img src="_page_20_Figure_10.jpeg" alt="" class="my-4 max-w-full" />
</p>

    <p class="text-gray-300">Figure 4: The different values  <span class="math">h_m</span></p>

    <p class="text-gray-300">Figure 4 illustrate these results. (This figure is a classical figure in &quot;Mirror Theory&quot;, i.e. it appears often when we deal with sets of linear equalities and linear non equalities).</p>

    <p class="text-gray-300">It is also interesting to notice that very large values  <span class="math">h_m</span>  exist, but do not occur often, and that very large values  <span class="math">h_m</span>  will affect more the standard deviation  <span class="math">\\sigma(h_m)</span>  of  <span class="math">h_m</span>  than the average deviation  <span class="math">\\sigma&#x27;(h_m)</span>  of  <span class="math">h_m</span> .  <span class="math">(\\sigma(h_m) = \\sqrt{E(h - h_m)^2}</span>  and  <span class="math">\\sigma&#x27;(h_m) = E(|h - h_m|)</span> .</p>

    <h3 id="sec-26" class="text-xl font-semibold mt-8">C Summary of our notation and of our General Proof Strategy</h3>

    <p class="text-gray-300">In this Appendix C we will summarize the proof strategy and the main notations used in this paper.</p>

    <ul class="list-disc list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li>m and n are two integers.  <span class="math">I_n = \\{0,1\\}^n</span> . (From a cryptographic point of view, m will be the number of queries, and n is the number of bits of the inputs and outputs of each query).</li>
      <li><span class="math">H_m</span>  (cf section 3) denotes the number of  <span class="math">(f,g) \\in B_n^2</span>  such that  <span class="math">\\forall i, 1 \\leq i \\leq m, (f \\oplus g)(a_i) = b_i</span> .  <span class="math">H_m</span>  is a compact notation for  <span class="math">H_m(b_1, b_2, \\ldots, b_m)</span> .</li>
      <li><span class="math">h_m</span>  (cf section 3) denotes the number of  <span class="math">(P_1, P_2, \\dots, P_m, Q_1, Q_2, \\dots, Q_m) \\in I_n^{2m}</span>  such that: the  <span class="math">P_i</span>  are pairwise distinct, the  <span class="math">Q_i</span>  are pairwise distinct, and:  <span class="math">\\forall i, 1 \\leq i \\leq m, P_i \\oplus Q_i = b_i</span> .  <span class="math">h_m</span>  is a compact notation for  <span class="math">h_m(b_1, b_2, \\dots, b_m)</span> . ( <span class="math">H_m</span>  and  <span class="math">h_m</span>  are equal up to a multiplicative constant:  <span class="math">H_m = h_m \\cdot \\frac{|B_n|^2}{(2^n(2^n-1)\\dots(2^n-m+1))^2}</span> , cf Theorem 2 of section 3).</li>
      <li><span class="math">\\tilde{h}_m</span>  denotes  <span class="math">\\frac{(2^n(2^n-1)...(2^n-m+1))^2}{2^{nm}}</span> .  <span class="math">\\tilde{h}_m</span>  is the average value of  <span class="math">h_m</span>  when  <span class="math">b \\in_R I_n^m</span> .</li>
    </ul>

    <p class="text-gray-300">Our aim is to prove that: when  <span class="math">m \\ll 2^n</span>  then for most values b,  <span class="math">h_m \\gtrsim \\tilde{h}_m</span>  (C1)(where  <span class="math">a \\gtrsim b</span>  means  <span class="math">a \\geq b</span>  or  <span class="math">a \\simeq b</span> ), because then, from Theorem 6 (standard &quot;H technique theorem&quot;) we will get CPA-2 security. In fact we will often prove a stronger property: that: when  <span class="math">m \\ll 2^n</span>  then for all values b,  <span class="math">h_m \\gtrsim \\tilde{h}_m</span>  (C2).</p>

    <p class="text-gray-300">In order to prove (C1) or (C2), we proceed in this paper with what we call the &quot;usual proof strategy in Mirror Theory&quot; or the &quot;colored proof strategy&quot;. (&quot;Mirror Theory&quot; is the theory that analyses the number of solutions of sets of affine equalities (=) and affine non equalities  <span class="math">(\\neq)</span>  in finite fields). Essentially the two main ideas of this &quot;colored proof strategy&quot; are:</p>

    <ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li>To compare  <span class="math">\\frac{h_{\\alpha+1}}{h_{\\alpha}}</span>  with  <span class="math">\\frac{\\tilde{h}_{\\alpha+1}}{\\tilde{h}_{\\alpha}}</span>  and to use</li>
    </ol>

    <p class="text-gray-300"><span class="math">$h_{\\alpha} = \\frac{h_{\\alpha}}{h_{\\alpha-1}} \\cdot \\frac{h_{\\alpha-1}}{h_{\\alpha-2}} \\cdot \\frac{h_{\\alpha-2}}{h_{\\alpha-3}} \\dots \\frac{h_2}{h_1} h_1</span>$</p>

    <p class="text-gray-300">instead of studying  <span class="math">h_{\\alpha}</span>  globally.</p>

    <ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li>To look carefully if the affine equations that will appear in the analysis of  <span class="math">\\frac{h_{\\alpha+1}}{h_{\\alpha}}</span>  are independent, consequences, or in contradiction with the linear equalities in  <span class="math">h_{\\alpha}</span> .</li>
    </ol>

    <p class="text-gray-300">More precisely, here, with  <span class="math">h_{\\alpha}</span>  values, this &quot;colored proof strategy&quot; is this one:</p>

    <ul class="list-disc list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li><ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li>We get an equation (called the &quot;orange equation&quot;) that evaluates  <span class="math">h_{\\alpha+1}</span>  from  <span class="math">h_{\\alpha}</span>  and  <span class="math">h&#x27;_{\\alpha}</span>  where  <span class="math">h&#x27;_{\\alpha}(X)</span>  denotes the number of solutions that satisfy the conditions  <span class="math">h_{\\alpha}</span>  plus one equation X:  <span class="math">Q_{\\alpha+1} \\oplus P_1 = b_{\\alpha+1}</span> , when this equation X is linearly independent with the non equalities of  <span class="math">h_{\\alpha}</span> .  <span class="math">h&#x27;_{\\alpha}</span>  denotes any such value  <span class="math">h&#x27;_{\\alpha}(X)</span> . This was done in section 4 of this paper.</li>
    </ol></li>
      <li><ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li>We get an equation (called the &quot;first purple equation&quot;) that evaluates  <span class="math">h&#x27;_{\\alpha}</span>  from  <span class="math">h_{\\alpha-1}</span> ,  <span class="math">h&#x27;_{\\alpha-1}</span>  and  <span class="math">h&#x27;&#x27;_{\\alpha-1}</span>  (where in  <span class="math">h&#x27;&#x27;_{\\alpha-1}</span>  we have introduced two extra and independent affine equations from the  <span class="math">\\lambda_{\\alpha-1}</span>  conditions). This was done in section 6 of this paper.</li>
    </ol></li>
      <li><ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li>We get the equations (called &quot;all purple equations&quot;) that evaluate  <span class="math">h_{\\alpha}^{(d)}</span>  from  <span class="math">h_{\\alpha-1}^{(d-1)}</span> ,  <span class="math">h_{\\alpha-1}^{(d)}</span> , and  <span class="math">h_{\\alpha-1}^{(d+1)}</span> , (where in  <span class="math">h_{\\alpha-1}^{(d)}</span> , we have introduced d extra and independent affine equations from the  <span class="math">h_{\\alpha-1}</span>  equations).</li>
    </ol></li>
    </ul>

    <p class="text-gray-300">Figure 5: General view of the &quot;colored proof strategy&quot; used in this paper</p>

    <p class="text-gray-300">    <img src="_page_22_Figure_1.jpeg" alt="" class="my-4 max-w-full" />
</p>

    <ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li>Now, from these evaluations we are able to compare  <span class="math">\\frac{h_{\\alpha+1}}{h_{\\alpha}}</span>  with  <span class="math">\\frac{h_{\\alpha+1}}{\\tilde{h}_{\\alpha}}</span>  and therefore  <span class="math">h_{\\alpha}</span>  from  <span class="math">h_{\\alpha}</span> .</li>
    </ol>

    <h4 id="sec-27" class="text-lg font-semibold mt-6">About my Conjecture on <span class="math">H_{2^n}</span> D</h4>

    <p class="text-gray-300">In [5] in 1952 (and independently in [15] in 1979) it was proved that:</p>

    <p class="text-gray-300"><span class="math">$\\forall f \\in F_n</span>$
, if  <span class="math">\\bigoplus_{x \\in I_n} f(x) = 0</span> , then  <span class="math">\\exists (g,h) \\in B_n^2</span>  such that  <span class="math">f = g \\oplus h</span></p>

    <p class="text-gray-300">([5] was pointed to me by J.F. Dillon).</p>

    <h4 id="sec-28" class="text-lg font-semibold mt-6">A new conjecture</h4>

    <p class="text-gray-300">Since 2008, I conjectured a stronger property.</p>

    <p class="text-gray-300">Conjecture:  <span class="math">\\forall f \\in F_n</span> , if  <span class="math">\\bigoplus_{x \\in I_n} f(x) = 0</span> , then the number H of  <span class="math">(g,h) \\in B_n^2</span>  such that  <span class="math">f = g \\oplus h</span> satisfies  <span class="math">H \\ge \\frac{|B_n|^2}{2^{n \\cdot 2^n}}</span> .</p>

    <p class="text-gray-300">Variant: I also conjectures that this property is true in any group (commutative or not), not only with Xor.</p>

    <p class="text-gray-300">In this paper I have proved results involving m equations with  <span class="math">m \\ll O(2^n)</span>  instead of all the  <span class="math">2^n</span> equations. These results were sufficient for the cryptographic security wanted (cf Figure 6).</p>

    <p class="text-gray-300">    <img src="_page_22_Figure_12.jpeg" alt="" class="my-4 max-w-full" />
</p>

    <p class="text-gray-300">Figure 6: The different cases for the values m</p>

    <p class="text-gray-300">Zone 1: (i.e. &quot;below the birthday bound&quot;): when  <span class="math">1 \\le m \\ll \\sqrt{2^n}</span> .</p>

    <p class="text-gray-300">Zone 2: (i.e. the cryptographic zone &quot;above the birthday bound&quot;): when  <span class="math">\\sqrt{2^n} \\leq m \\leq \\frac{2^n}{3}</span> : the properties of this zone are the main subject of this paper.</p>

    <p class="text-gray-300">Zone 3:  <span class="math">\\frac{2^n}{3} \\le m \\le 2^n - 1</span> : this zone was not studied carefully in this paper. Our proof technique may also give some results in this zone, but this was not studied.</p>

    <p class="text-gray-300">Zone 4:  <span class="math">m = 2^n - 1</span>  and  <span class="math">m = 2^n</span> : the zone of the new conjecture, and of [5] and [13].</p>

    <h4 id="sec-29" class="text-lg font-semibold mt-6"><strong>Equivalent Conjectures</strong></h4>

    <p class="text-gray-300">Let  <span class="math">\\tilde{H}_{\\alpha} = \\frac{|B_n|^2}{2^{n\\alpha}}</span>  be the average value of  <span class="math">H_{\\alpha}</span> .</p>

    <p class="text-gray-300"><strong>Theorem 15</strong> The new conjecture given above is equivalent to each of these (not proved properties):</p>

    <ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li><p class="text-gray-300"><span class="math">$\\forall f \\in F_n, if \\bigoplus_{x \\in I_n} f(x) = 0, then H_{2^n}(f) \\ge \\frac{|B_n|^2}{2^{n \\cdot 2^n}} (= \\tilde{H}_{2^n})</span>$</p></li>
      <li><p class="text-gray-300"><span class="math">$\\forall f \\in F_n, \\ H_{2^n-1}(f) \\ge \\frac{\\tilde{H}_{2^n-1}}{2^n} \\left( = \\frac{|B_n|^2}{2^{n\\cdot 2^n}} \\right)</span>$</p></li>
      <li><p class="text-gray-300"><span class="math">$\\forall f \\in F_n, \\ \\forall \\alpha, \\ 1 \\le \\alpha \\le 2^n - 1, \\ H_{\\alpha}(f) \\ge \\frac{\\tilde{H}_{\\alpha}}{2^n}</span>$</p></li>
      <li><p class="text-gray-300"><span class="math">$\\forall \\alpha, 1 \\leq \\alpha \\leq 2^n - 1, \\forall b_1, \\dots, b_\\alpha, h_\\alpha(b_1, \\dots, b_\\alpha) \\geq \\frac{\\tilde{h}_\\alpha}{2^n}</span>$</p></li>
    </ol>

    <h4 id="sec-30" class="text-lg font-semibold mt-6">Proof of Theorem 15.</h4>

    <ul class="list-disc list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li>(1) is the conjecture given above.</li>
      <li><span class="math">\\tilde{H}_{2^n-1} = \\frac{\\tilde{H}_{2^n}}{2^n}</span>  and if  <span class="math">\\bigoplus_{x \\in I_n} f(x) = 0</span>  then the last value of f is fixed when all the other values of f are given, and therefore if  <span class="math">\\bigoplus_{x \\in I_n} f(x) = 0</span> , then  <span class="math">H_{2^n}(f) = H_{2^n-1}(f)</span> . So  <span class="math">(1) \\Leftrightarrow (2)</span> .</li>
      <li>(3)  <span class="math">\\Rightarrow</span>  (2) is obvious (just take  <span class="math">\\alpha = 2^n 1</span> ).</li>
      <li>Let assume that (2) is true. Then  <span class="math">\\forall \\alpha, 1 \\leq \\alpha \\leq 2^n 1, \\forall f \\in F_n</span> ,</li>
    </ul>

    <p class="text-gray-300"><span class="math">$H_{\\alpha}(f) = \\sum_{b_{\\alpha+1},\\dots,b_{2^{n}-1}} [\\text{Number of } (g,h) \\in B_{n}^{2} \\, / \\, g \\oplus h = f&#x27;]</span>$</p>

    <p class="text-gray-300">where
<span class="math">$\\forall i, 1 \\leq i \\leq \\alpha, f&#x27;(a_i) = f(a_i)</span>$
and  <span class="math">\\forall i, \\alpha + 1 \\leq i \\leq 2^n - 1, f&#x27;(a_i) = b_i</span> .
So from (2):  <span class="math">H_{\\alpha} \\geq (2^n)^{2^n - \\alpha - 1} \\frac{\\tilde{H}_{2^n - 2}}{2^n} = \\frac{2^{n \\cdot 2^n}}{2^n \\cdot 2^{\\alpha n}} \\cdot \\frac{|B_n|^2}{2^{n \\cdot 2^n}} = \\frac{\\tilde{H}_{\\alpha}}{2^n}</span> . Therefore (2)  <span class="math">\\Rightarrow</span>  (3).</p>

    <p class="text-gray-300">• Finally since  <span class="math">H_{\\alpha} = h_{\\alpha} \\cdot \\frac{|B_n|^2}{[2^n(2^n-1)...(2^n-\\alpha)]^2}</span> , we have: (3)  <span class="math">\\Leftrightarrow</span>  (4)</p>

    <p class="text-gray-300"><strong>Remark 1.</strong> The coefficient  <span class="math">2^n</span>  in (3) looks a bit artificial, and even stronger properties may be true (as suggested by our simulations done in [16]).</p>

    <p class="text-gray-300"><strong>Remark 2.</strong> If we compare the conjecture above with the results of section 6, we see that:</p>

    <ul class="list-disc list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li>. Section 6 is stronger when  <span class="math">m \\ll 2^{\\frac{3n}{4}}</span>  since it shows that  <span class="math">H_{\\alpha} \\simeq \\tilde{H}_{\\alpha}</span>  (instead of  <span class="math">\\geq \\frac{\\tilde{H}_{\\alpha}}{2^n}</span> ). . The conjecture is stronger when  <span class="math">m \\gg 2^{\\frac{3n}{4}}</span>  since  <span class="math">H_{\\alpha} \\geq \\frac{\\tilde{H}_{\\alpha}}{2^n}</span>  implies that  <span class="math">H_{\\alpha} \\neq 0</span>  for example.</li>
    </ul>

`;
---

<BaseLayout title="Security in $O(2^n)$ for the Xor of Two Random Permutations (2013/368)">
  <article class="max-w-4xl mx-auto article-prose">
    <nav class="mb-8">
      <a href="/papers" class="text-blue-400 hover:text-blue-300">
        &larr; Back to Papers
      </a>
    </nav>

    <header class="mb-12">
      <h1 class="text-3xl font-bold mb-4"
        set:html={TITLE_HTML} />
      <p class="text-gray-400 mb-2"
        set:html={AUTHORS_HTML} />
      <p class="text-gray-500 text-sm mb-4">
        2013 &middot; eprint 2013/368
      </p>
      <div class="flex gap-4 text-sm">
        <a
          href={EPRINT_URL}
          target="_blank"
          rel="noopener noreferrer"
          class="text-blue-400 hover:text-blue-300"
        >
          Paper (eprint) &rarr;
        </a>
      </div>
      <PaperDisclaimer eprintUrl={EPRINT_URL} />
      <p class="mt-1 text-xs text-gray-600">
        Converted with: {CRAWLER} &middot; {CONVERTED_DATE}
      </p>
    </header>

    <Fragment set:html={CONTENT} />

    <PaperHistory slug="security-in-for-the-xor-of-two-random-permutations-2013" />
  </article>
</BaseLayout>
