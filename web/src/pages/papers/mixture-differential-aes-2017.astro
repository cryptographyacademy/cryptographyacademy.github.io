---
import BaseLayout from '../../layouts/BaseLayout.astro';

const EPRINT_URL = 'https://eprint.iacr.org/2017/832';
const CRAWLER = 'marker';
---

<BaseLayout
  title="Mixture Differential Cryptanalysis on AES (2017/832)"
>
  <article class="max-w-4xl mx-auto article-prose">
    <nav class="mb-8">
      <a href="/papers" class="text-blue-400 hover:text-blue-300">
        &larr; Back to Papers
      </a>
    </nav>

    <!-- ============================================================ -->
    <!-- HEADER                                                       -->
    <!-- ============================================================ -->

    <header class="mb-12">
      <h1 class="text-3xl font-bold mb-4">
        Mixture Differential Cryptanalysis and Structural Truncated
        Differential Attacks on Round-Reduced AES
      </h1>
      <p class="text-gray-400 mb-2">Lorenzo Grassi</p>
      <p class="text-gray-500 text-sm mb-4">
        2017 &middot; Full Version &middot; eprint 2017/832
      </p>
      <div class="flex gap-4 text-sm">
        <a
          href={EPRINT_URL}
          target="_blank"
          rel="noopener noreferrer"
          class="text-blue-400 hover:text-blue-300"
        >
          Paper (eprint) &rarr;
        </a>
      </div>
      <p class="mt-4 text-xs text-gray-500">
        All content below belongs to the original authors. This page
        reproduces the paper for educational purposes. Always
        <a
          href={EPRINT_URL}
          target="_blank"
          rel="noopener noreferrer"
          class="text-blue-400 hover:text-blue-300"
        >cite the original</a>.
      </p>
      <p class="mt-1 text-xs text-gray-600">Converted with: {CRAWLER}</p>
    </header>

    <!-- ============================================================ -->
    <!-- TABLE OF CONTENTS                                            -->
    <!-- ============================================================ -->

    <nav
      id="toc"
      class="mb-10 p-6 rounded-lg"
      style="background: rgba(255,255,255,0.03);
             border: 1px solid rgba(255,255,255,0.06);"
    >
      <h2 class="text-lg font-bold mb-4">Table of Contents</h2>
      <ol
        class="space-y-1 text-sm text-gray-300
          list-decimal list-inside"
      >
        <li>
          <a href="#abstract" class="hover:text-white">Abstract</a>
        </li>
        <li>
          <a href="#sec-1" class="hover:text-white">Introduction</a>
          <ol
            class="ml-6 mt-1 space-y-1 list-decimal
              list-inside text-gray-400"
          >
            <li>
              <a href="#sec-1.1" class="hover:text-white"
                >Related Work</a
              >
            </li>
            <li>
              <a href="#sec-1.2" class="hover:text-white"
                >Our Contribution</a
              >
            </li>
          </ol>
        </li>
        <li>
          <a href="#sec-2" class="hover:text-white"
            >Preliminary &ndash; Description of AES</a
          >
        </li>
        <li>
          <a href="#sec-3" class="hover:text-white"
            >Subspace Trails</a
          >
          <ol
            class="ml-6 mt-1 space-y-1 list-decimal
              list-inside text-gray-400"
          >
            <li>
              <a href="#sec-3.1" class="hover:text-white"
                >Subspace Trails of AES</a
              >
            </li>
            <li>
              <a href="#sec-3.2" class="hover:text-white"
                >Intersections of Subspaces and Useful
                Probabilities</a
              >
            </li>
          </ol>
        </li>
        <li>
          <a href="#sec-4" class="hover:text-white"
            >&ldquo;Multiple-of-8&rdquo; Secret-Key Distinguisher
            for 5-round AES</a
          >
        </li>
        <li>
          <a href="#sec-5" class="hover:text-white"
            >New 4-round Secret-Key Distinguisher for AES</a
          >
          <ol
            class="ml-6 mt-1 space-y-1 list-decimal
              list-inside text-gray-400"
          >
            <li>
              <a href="#sec-5.1" class="hover:text-white"
                >Mixture Differential Distinguisher for 4-round
                AES</a
              >
            </li>
            <li>
              <a href="#sec-5.2" class="hover:text-white"
                >Generic Mixture Differential Distinguishers for
                4-round AES</a
              >
            </li>
            <li>
              <a href="#sec-5.3" class="hover:text-white"
                >Comparison with Other 4-round Secret-Key
                Distinguishers</a
              >
            </li>
          </ol>
        </li>
        <li>
          <a href="#sec-6" class="hover:text-white"
            >New Key-Recovery Attack on 5-round AES</a
          >
          <ol
            class="ml-6 mt-1 space-y-1 list-decimal
              list-inside text-gray-400"
          >
            <li>
              <a href="#sec-6.1" class="hover:text-white"
                >Data and Computational Costs</a
              >
            </li>
            <li>
              <a href="#sec-6.2" class="hover:text-white"
                >Practical Verification</a
              >
            </li>
          </ol>
        </li>
        <li>
          <a href="#sec-7" class="hover:text-white"
            >A New 5-round Secret-Key Distinguisher for AES</a
          >
          <ol
            class="ml-6 mt-1 space-y-1 list-decimal
              list-inside text-gray-400"
          >
            <li>
              <a href="#sec-7.1" class="hover:text-white"
                >5-round Probabilistic Mixture Differential
                Secret-Key Distinguisher</a
              >
            </li>
            <li>
              <a href="#sec-7.2" class="hover:text-white"
                >Data and Computational Complexity</a
              >
            </li>
            <li>
              <a href="#sec-7.3" class="hover:text-white"
                >Practical Verification on Small Scale AES</a
              >
            </li>
          </ol>
        </li>
        <li>
          <a href="#sec-8" class="hover:text-white"
            >Key-Recovery Attack on 6 Rounds of AES-128</a
          >
        </li>
        <li>
          <a href="#sec-9" class="hover:text-white"
            >Other Secret-Key Distinguishers for 5-round AES</a
          >
          <ol
            class="ml-6 mt-1 space-y-1 list-decimal
              list-inside text-gray-400"
          >
            <li>
              <a href="#sec-9.1" class="hover:text-white"
                >Threshold Mixture Differential Secret-Key
                Distinguisher</a
              >
            </li>
            <li>
              <a href="#sec-9.2" class="hover:text-white"
                >Impossible Mixture Differential Secret-Key
                Distinguisher</a
              >
            </li>
          </ol>
        </li>
        <li>
          <a href="#references" class="hover:text-white"
            >References</a
          >
        </li>
        <li>
          <a href="#app-a" class="hover:text-white"
            >Appendix A: Proof &ndash; Probabilities of
            Sect.&nbsp;3.2</a
          >
        </li>
        <li>
          <a href="#app-b" class="hover:text-white"
            >Appendix B: 4-round Distinguisher &ndash; Details</a
          >
        </li>
        <li>
          <a href="#app-c" class="hover:text-white"
            >Appendix C: Variants of the 5-round Distinguisher</a
          >
        </li>
        <li>
          <a href="#app-d" class="hover:text-white"
            >Appendix D: Other Variants of the 5-round
            Distinguisher</a
          >
        </li>
        <li>
          <a href="#app-e" class="hover:text-white"
            >Appendix E: Different Implementation of the
            Distinguisher</a
          >
        </li>
        <li>
          <a href="#app-f" class="hover:text-white"
            >Appendix F: Integral Attack on 5-round AES</a
          >
        </li>
      </ol>
    </nav>

    <!-- ============================================================ -->
    <!-- ABSTRACT                                                     -->
    <!-- ============================================================ -->

    <section id="abstract" class="mb-12">
      <h2 class="text-2xl font-bold mb-4">Abstract</h2>
      <p class="text-gray-300">
        At Eurocrypt 2017 the first secret-key distinguisher for
        5-round AES &ndash; based on the &ldquo;multiple-of-8&rdquo;
        property &ndash; has been presented. Although it allows to
        distinguish a random permutation from an AES-like one, it
        seems rather hard to implement a key-recovery attack different
        than brute-force like using such a distinguisher.
      </p>
      <p class="text-gray-300 mt-4">
        In this paper we introduce
        <em>Mixture Differential Cryptanalysis</em> on round-reduced
        AES-like ciphers, a way to translate the (complex)
        &ldquo;multiple-of-8&rdquo; 5-round distinguisher into a
        simpler and more convenient one (though, on a smaller number
        of rounds). Given a pair of chosen plaintexts, the idea is to
        construct new pairs of plaintexts by <em>mixing</em> the
        generating variables of the original pair of plaintexts. Here
        we theoretically prove that for 4-round AES the corresponding
        ciphertexts of the original pair of plaintexts lie in a
        particular subspace if and only if the corresponding pairs of
        ciphertexts of the new pairs of plaintexts have the same
        property. Such secret-key distinguisher &ndash; which is
        independent of the secret-key, of the details of the S-Box
        and of the MixColumns matrix (except for the branch number
        equal to 5) &ndash; can be used as starting point to set up
        new key-recovery attacks on round-reduced AES.
      </p>
      <p class="text-gray-300 mt-4">
        As a second contribution, we show how to combine this new
        4-round distinguisher with a modified version of a truncated
        differential distinguisher in order to set up new 5-round
        distinguishers, that exploit properties which are independent
        of the secret key, of the details of the S-Box and of the
        MixColumns matrix.
      </p>
      <p class="text-gray-300 mt-4">
        Even if such 5-round distinguishers have higher complexity
        than e.g. the &ldquo;multiple-of-8&rdquo; one present in the
        literature, one of them can be used as starting point to set
        up the <em>first</em> key-recovery attack on 6-round AES that
        exploits <em>directly</em> a 5-round secret-key
        distinguisher.
      </p>
      <p class="text-gray-300 mt-4">
        <strong>Keywords:</strong> AES &middot; Secret-Key
        Distinguisher &middot; Key-Recovery Attack &middot; Mixture
        Differential Cryptanalysis &middot; Truncated Differential
        &middot; Subspace Trail Cryptanalysis
      </p>
    </section>

    <!-- ============================================================ -->
    <!-- 1. INTRODUCTION                                              -->
    <!-- ============================================================ -->

    <section id="sec-1" class="mb-12">
      <h2 class="text-2xl font-bold mb-4">1 &ensp; Introduction</h2>

      <p class="text-gray-300">
        Block ciphers are certainly among the most important
        cryptographic primitives. They are designed by iterating an
        efficiently implementable round function many times in the
        hope that the resulting composition behaves like a randomly
        drawn permutation.
      </p>

      <p class="text-gray-300 mt-4">
        One of the most important tools that a cryptanalyst has at
        hand when trying to evaluate the security of ciphers or hash
        functions is &ndash; without doubt &ndash; differential
        cryptanalysis. Since its conception by Biham and Shamir
        [BS90,&nbsp;BS91], it has been successfully applied in many
        cases.
      </p>

      <p class="text-gray-300 mt-4">
        The methodology of differential cryptanalysis has been
        extended several times with a number of attack vectors, most
        importantly truncated differentials [Knu95], impossible
        differentials [Knu98,&nbsp;BBS99], higher-order differentials
        [Knu95], boomerang attacks [Wag99] and differential-linear
        attacks [LH94].
      </p>

      <p class="text-gray-300 mt-4">
        With today&rsquo;s knowledge, designing a secure block cipher
        is a problem that is largely considered solved. Especially
        with the AES we have at hand a very well analyzed and studied
        cipher that, after more than 20 years of investigation still
        withstands all cryptanalytic attacks. However, new results on
        the AES still appear regularly, especially within the last
        couple of years (e.g. polytopic cryptanalysis [Tie16],
        &ldquo;multiple-of-8&rdquo; distinguisher [GRR17a] and yoyo
        distinguisher [RBH17]).
      </p>

      <p class="text-gray-300 mt-4">
        The &ldquo;multiple-of-8&rdquo; distinguisher [GRR17a]
        proposed at Eurocrypt 2017 by Grassi, Rechberger and
        R&oslash;njom is the first 5-round secret-key distinguisher
        for AES that exploits a property which is independent of the
        secret key and of the details of the S-Box. This
        distinguisher is based on a new structural property for up to
        5 rounds of AES: by appropriate choices of a number of input
        pairs it is possible to make sure that the number of times
        that the difference of the resulting output pairs lie in a
        particular subspace is <em>always</em> a multiple of 8. This
        distinguisher allows to distinguish an AES permutation from a
        random one with a success probability greater than 99% using
        <span class="math">2^&#123;32&#125;</span> chosen texts and a
        computational cost of
        <span class="math">2^&#123;35.6&#125;</span> look-ups.
      </p>

      <p class="text-gray-300 mt-4">
        In this paper we introduce
        <em>mixture differential cryptanalysis</em> on round-reduced
        AES-like ciphers, a way to translate the (complex)
        &ldquo;multiple-of-8&rdquo; 5-round distinguisher [GRR17a]
        into a simpler and more convenient one (though, on a smaller
        number of rounds). As we are going to show, such new proposed
        technique leads to a new distinguisher and key-recovery
        attacks on 4- and 5-round AES (respectively) with data and
        computational complexity similar to other attacks in
        literature.
      </p>

      <!-- 1.1 Related Work -->
      <h3 id="sec-1.1" class="text-xl font-semibold mt-8 mb-3">
        1.1 &ensp; Related Work
      </h3>

      <p class="text-gray-300">
        To the best of our knowledge, the concept of mixture
        differential cryptanalysis is new and has not been used in
        cryptanalysis before.
      </p>

      <p class="text-gray-300 mt-4">
        <strong>Differential Attacks.</strong> Differential attacks
        [BS90] exploit the fact that couples of plaintexts with
        certain differences yield other differences in the
        corresponding ciphertexts with a non-uniform probability
        distribution. The resulting pair of differences is called a
        <em>differential</em>.
      </p>

      <p class="text-gray-300 mt-4">
        <strong>Recent Results.</strong> Recently, new differential
        distinguishers have been proposed in the literature, precisely
        the polytopic cryptanalysis [Tie16] at Eurocrypt 2016 and the
        yoyo distinguisher on SPN constructions [RBH17] at Asiacrypt
        2017, which present an important difference with respect to
        the previously recalled attacks. Instead of working on each
        couple of two (plaintext, ciphertext) pairs independently of
        the others as in the previous scenario, in these cases the
        attacker works on the relations that hold among the couples of
        pairs of texts.
      </p>

      <!-- Table 1 -->
      <div class="my-6 overflow-x-auto">
        <p class="text-sm text-gray-400 mb-2">
          <strong>Table 1:</strong>
          <em
            >Secret-Key Distinguishers for round-reduced AES.</em
          >
        </p>
        <table class="w-full text-sm">
          <thead>
            <tr class="border-b border-gray-600">
              <th class="text-left py-2 px-2">Property</th>
              <th class="text-left py-2 px-2">Rounds</th>
              <th class="text-left py-2 px-2">Data</th>
              <th class="text-left py-2 px-2">Cost</th>
              <th class="text-left py-2 px-2">Ref.</th>
            </tr>
          </thead>
          <tbody class="text-gray-300">
            <tr class="border-b border-gray-700">
              <td class="py-1 px-2">Yoyo Game</td>
              <td class="py-1 px-2">4</td>
              <td class="py-1 px-2">2 CP + 2 ACC</td>
              <td class="py-1 px-2">2 XOR</td>
              <td class="py-1 px-2">[RBH17]</td>
            </tr>
            <tr class="border-b border-gray-700">
              <td class="py-1 px-2">Impossible Diff.</td>
              <td class="py-1 px-2">4</td>
              <td class="py-1 px-2">
                <span class="math">2^&#123;16.25&#125;</span> CP
              </td>
              <td class="py-1 px-2">
                <span class="math"
                  >\approx 2^&#123;16&#125;</span
                >
                E
              </td>
              <td class="py-1 px-2">[BK01]</td>
            </tr>
            <tr
              class="border-b border-gray-700 font-semibold"
            >
              <td class="py-1 px-2">Mixture Diff.</td>
              <td class="py-1 px-2">4</td>
              <td class="py-1 px-2">
                <span class="math">2^&#123;17&#125;</span> CP
              </td>
              <td class="py-1 px-2">
                <span class="math"
                  >\approx 2^&#123;16.75&#125;</span
                >
                E
              </td>
              <td class="py-1 px-2">Sect. 5</td>
            </tr>
            <tr class="border-b border-gray-700">
              <td class="py-1 px-2">Integral</td>
              <td class="py-1 px-2">4</td>
              <td class="py-1 px-2">
                <span class="math">2^&#123;32&#125;</span> CP
              </td>
              <td class="py-1 px-2">
                <span class="math">2^&#123;32&#125;</span> XOR
              </td>
              <td class="py-1 px-2">[DKR97]</td>
            </tr>
            <tr class="border-b border-gray-700">
              <td class="py-1 px-2">Multiple-of-8</td>
              <td class="py-1 px-2">4</td>
              <td class="py-1 px-2">
                <span class="math">2^&#123;33&#125;</span> CP
              </td>
              <td class="py-1 px-2">
                <span class="math"
                  >\approx 2^&#123;33.7&#125;</span
                >
                E
              </td>
              <td class="py-1 px-2">[GRR17a]</td>
            </tr>
            <tr class="border-b border-gray-700">
              <td class="py-1 px-2">Yoyo</td>
              <td class="py-1 px-2">5</td>
              <td class="py-1 px-2">
                <span class="math"
                  >12 \text&#123; CP&#125; + 2^&#123;5.8&#125;</span
                >
                ACC
              </td>
              <td class="py-1 px-2">
                <span class="math"
                  >2^&#123;24.8&#125;</span
                >
                XOR
              </td>
              <td class="py-1 px-2">[RBH17]</td>
            </tr>
            <tr class="border-b border-gray-700">
              <td class="py-1 px-2">Multiple-of-8</td>
              <td class="py-1 px-2">5</td>
              <td class="py-1 px-2">
                <span class="math">2^&#123;32&#125;</span> CP
              </td>
              <td class="py-1 px-2">
                <span class="math"
                  >\approx 2^&#123;29&#125;</span
                >
                E
              </td>
              <td class="py-1 px-2">[GRR17a]</td>
            </tr>
            <tr
              class="border-b border-gray-700 font-semibold"
            >
              <td class="py-1 px-2">Prob. Mix. Diff.</td>
              <td class="py-1 px-2">5</td>
              <td class="py-1 px-2">
                <span class="math">2^&#123;52&#125;</span> CP
              </td>
              <td class="py-1 px-2">
                <span class="math"
                  >\approx 2^&#123;64.9&#125;</span
                >
                E
              </td>
              <td class="py-1 px-2">Sect. 7</td>
            </tr>
          </tbody>
        </table>
      </div>

      <!-- 1.2 Our Contribution -->
      <h3 id="sec-1.2" class="text-xl font-semibold mt-8 mb-3">
        1.2 &ensp; Our Contribution
      </h3>

      <h4 class="text-lg font-semibold mt-4 mb-2">
        &ldquo;Mixture Differential Cryptanalysis&rdquo; on 4-round
        AES
      </h4>

      <p class="text-gray-300">
        As first contribution, in this paper we present
        &ldquo;mixture differential cryptanalysis&rdquo; on 4-round
        AES. Given plaintexts in the same coset of a subspace
        <span class="math">\mathcal&#123;C&#125;</span>, the attacker
        first divides the couples of two (plaintext, ciphertext) pairs
        into sets of
        <span class="math">N \geq 2</span>
        <em>non-independent</em> couples. These sets are defined such
        that particular relationships (that involve differential and
        linear relationships) hold among the plaintexts of the couples
        that belong to the same set.
      </p>

      <p class="text-gray-300 mt-4">
        Such sets have the property that the two ciphertexts of a
        certain couple belong to the same coset of a particular
        subspace
        <span class="math">\mathcal&#123;M&#125;</span> if and only if
        the two ciphertexts of all the other couples in that set have
        the same property. Since this last event can occur for a
        random permutation, it is possible to distinguish 4-round AES
        from a random permutation.
      </p>

      <h4 class="text-lg font-semibold mt-6 mb-2">
        Properties exploited by the new proposed 5-round Secret-Key
        Distinguishers
      </h4>

      <p class="text-gray-300">
        Using the previous 4-round distinguisher as starting point,
        the paper presents three different properties that can be
        exploited to distinguish 5-round AES from a random
        permutation:
      </p>
      <ul class="list-disc list-inside text-gray-300 mt-2 space-y-2">
        <li>
          <strong>Probabilistic Mixture Differential:</strong> the
          number of sets for which two ciphertexts of at least one
          couple belong to the same coset of
          <span class="math">\mathcal&#123;M&#125;</span> is (a
          little) lower for 5-round AES than for a random permutation
          (Sect.&nbsp;7).
        </li>
        <li>
          <strong>Threshold Mixture Differential:</strong> the number
          of sets for which the number of qualifying couples exceeds a
          threshold
          <span class="math">Z \in \mathbb&#123;N&#125;</span> is
          higher for 5-round AES than for a random permutation
          (Sect.&nbsp;9.1).
        </li>
        <li>
          <strong>Impossible Mixture Differential:</strong> for
          5-round AES there exists at least one set for which no
          couple has ciphertexts in the same coset of
          <span class="math">\mathcal&#123;M&#125;</span>; for a
          random permutation every set has at least one qualifying
          couple (Sect.&nbsp;9.2).
        </li>
      </ul>

      <!-- Table 2 -->
      <div class="my-6 overflow-x-auto">
        <p class="text-sm text-gray-400 mb-2">
          <strong>Table 2:</strong>
          <em>Comparison of Attacks on round-reduced AES-128.</em>
        </p>
        <table class="w-full text-sm">
          <thead>
            <tr class="border-b border-gray-600">
              <th class="text-left py-2 px-2">Attack</th>
              <th class="text-left py-2 px-2">Rounds</th>
              <th class="text-left py-2 px-2">Data</th>
              <th class="text-left py-2 px-2">Computation</th>
              <th class="text-left py-2 px-2">RDist</th>
              <th class="text-left py-2 px-2">Ref.</th>
            </tr>
          </thead>
          <tbody class="text-gray-300">
            <tr class="border-b border-gray-700">
              <td class="py-1 px-2">MitM</td>
              <td class="py-1 px-2">5</td>
              <td class="py-1 px-2">8 CP</td>
              <td class="py-1 px-2">
                <span class="math">2^&#123;64&#125;</span>
              </td>
              <td class="py-1 px-2">&ndash;</td>
              <td class="py-1 px-2">[Der13]</td>
            </tr>
            <tr class="border-b border-gray-700">
              <td class="py-1 px-2">Partial Sum</td>
              <td class="py-1 px-2">5</td>
              <td class="py-1 px-2">
                <span class="math">2^&#123;8&#125;</span> CP
              </td>
              <td class="py-1 px-2">
                <span class="math">2^&#123;38&#125;</span>
              </td>
              <td class="py-1 px-2">4</td>
              <td class="py-1 px-2">[Tun12]</td>
            </tr>
            <tr
              class="border-b border-gray-700 font-semibold"
            >
              <td class="py-1 px-2">Mixture Diff.</td>
              <td class="py-1 px-2">5</td>
              <td class="py-1 px-2">
                <span class="math"
                  >2^&#123;33.6&#125;</span
                >
                CP
              </td>
              <td class="py-1 px-2">
                <span class="math"
                  >2^&#123;33.3&#125;</span
                >
              </td>
              <td class="py-1 px-2">4</td>
              <td class="py-1 px-2">Sect.&nbsp;6</td>
            </tr>
            <tr class="border-b border-gray-700">
              <td class="py-1 px-2">Partial Sum</td>
              <td class="py-1 px-2">6</td>
              <td class="py-1 px-2">
                <span class="math">2^&#123;32&#125;</span> CP
              </td>
              <td class="py-1 px-2">
                <span class="math">2^&#123;42&#125;</span>
              </td>
              <td class="py-1 px-2">4</td>
              <td class="py-1 px-2">[Tun12]</td>
            </tr>
            <tr
              class="border-b border-gray-700 font-semibold"
            >
              <td class="py-1 px-2">Prob. Mix Diff.</td>
              <td class="py-1 px-2">6</td>
              <td class="py-1 px-2">
                <span class="math"
                  >2^&#123;72.8&#125;</span
                >
                CP
              </td>
              <td class="py-1 px-2">
                <span class="math"
                  >2^&#123;105&#125;</span
                >
              </td>
              <td class="py-1 px-2">5</td>
              <td class="py-1 px-2">Sect.&nbsp;8</td>
            </tr>
          </tbody>
        </table>
      </div>
    </section>

    <!-- ============================================================ -->
    <!-- 2. PRELIMINARY                                               -->
    <!-- ============================================================ -->

    <section id="sec-2" class="mb-12">
      <h2 class="text-2xl font-bold mb-4">
        2 &ensp; Preliminary &ndash; Description of AES
      </h2>
      <p class="text-gray-300">
        The Advanced Encryption Standard [DR02] is a
        Substitution-Permutation network that supports key sizes of
        128, 192 and 256 bits. The 128-bit plaintext initializes the
        internal state represented by a
        <span class="math">4 \times 4</span> matrix of bytes seen as
        values in the finite field
        <span class="math"
          >\mathbb&#123;F&#125;_&#123;256&#125;</span
        >, defined using the irreducible polynomial
        <span class="math"
          >x^8 + x^4 + x^3 + x + 1</span
        >. Depending on the version of AES,
        <span class="math">N_r</span> rounds are applied to the
        state:
        <span class="math">N_r = 10</span> for AES-128,
        <span class="math">N_r = 12</span> for AES-192 and
        <span class="math">N_r = 14</span> for AES-256. An AES round
        applies four operations to the state matrix:
      </p>
      <ul class="list-disc list-inside text-gray-300 mt-3 space-y-2">
        <li>
          <strong>SubBytes (S-Box)</strong> &ndash; applying the same
          8-bit to 8-bit invertible S-Box 16 times in parallel on
          each byte of the state;
        </li>
        <li>
          <strong>ShiftRows (SR)</strong> &ndash; cyclic shift of each
          row (<span class="math">i</span>-th row is shifted by
          <span class="math">i</span> bytes to the left);
        </li>
        <li>
          <strong>MixColumns (MC)</strong> &ndash; multiplication of
          each column by a constant
          <span class="math">4 \times 4</span> invertible matrix over
          <span class="math"
            >GF(2^&#123;8&#125;)</span
          >;
        </li>
        <li>
          <strong>AddRoundKey (ARK)</strong> &ndash; XORing the state
          with a 128-bit subkey.
        </li>
      </ul>
      <p class="text-gray-300 mt-4">
        One round of AES can be described as
        <span class="math"
          >R(x) = K \oplus MC \circ SR \circ
          \text&#123;S-Box&#125;(x)</span
        >. In the first round an additional AddRoundKey operation
        (using a whitening key) is applied, and in the last round the
        MixColumns operation is omitted.
      </p>
    </section>

    <!-- ============================================================ -->
    <!-- 3. SUBSPACE TRAILS                                           -->
    <!-- ============================================================ -->

    <section id="sec-3" class="mb-12">
      <h2 class="text-2xl font-bold mb-4">
        3 &ensp; Subspace Trails
      </h2>

      <div class="formal-block formal-block-definition">
        <p class="font-semibold text-blue-400 mb-2">
          Definition 1 (Subspace Trail).
        </p>
        <p class="text-gray-300">
          Let
          <span class="math"
            >(V_1, V_2, \ldots, V_&#123;r+1&#125;)</span
          >
          denote a set of
          <span class="math">r+1</span> subspaces with
          <span class="math"
            >\dim(V_i) \leq \dim(V_&#123;i+1&#125;)</span
          >. If for each
          <span class="math">i = 1, \ldots, r</span> and for each
          <span class="math">a_i</span>, there exist
          <span class="math">a_&#123;i+1&#125;</span> such that
          <span class="math"
            >F(V_i \oplus a_i) \subseteq V_&#123;i+1&#125; \oplus
            a_&#123;i+1&#125;</span
          >, then
          <span class="math"
            >(V_1, V_2, \ldots, V_&#123;r+1&#125;)</span
          >
          is a <em>subspace trail</em> of length
          <span class="math">r</span> for the function
          <span class="math">F</span>. If all the previous relations
          hold with equality, the trail is called a
          <em>constant-dimensional subspace trail</em>.
        </p>
      </div>

      <h3 id="sec-3.1" class="text-xl font-semibold mt-8 mb-3">
        3.1 &ensp; Subspace Trails of AES
      </h3>

      <p class="text-gray-300">
        Here we recall the subspace trails of AES presented in
        [GRR17b], working with vectors and vector spaces over
        <span class="math"
          >\mathbb&#123;F&#125;_&#123;2^8&#125;^&#123;4 \times
          4&#125;</span
        >.
      </p>

      <div class="formal-block formal-block-definition">
        <p class="font-semibold text-blue-400 mb-2">
          Definition 2 (Column Spaces).
        </p>
        <p class="text-gray-300">
          The column spaces
          <span class="math">\mathcal&#123;C&#125;_i</span> are
          defined as
          <span class="math"
            >\mathcal&#123;C&#125;_i = \langle e_&#123;0,i&#125;,
            e_&#123;1,i&#125;, e_&#123;2,i&#125;,
            e_&#123;3,i&#125; \rangle</span
          >.
        </p>
      </div>

      <div class="formal-block formal-block-definition">
        <p class="font-semibold text-blue-400 mb-2">
          Definition 3 (Diagonal and Inverse-Diagonal Spaces).
        </p>
        <p class="text-gray-300">
          The diagonal spaces
          <span class="math">\mathcal&#123;D&#125;_i</span> and the
          inverse-diagonal spaces
          <span class="math"
            >\mathcal&#123;I&#125;\mathcal&#123;D&#125;_i</span
          >
          are defined as
          <span class="math"
            >\mathcal&#123;D&#125;_i =
            SR^&#123;-1&#125;(\mathcal&#123;C&#125;_i)</span
          >
          and
          <span class="math"
            >\mathcal&#123;I&#125;\mathcal&#123;D&#125;_i =
            SR(\mathcal&#123;C&#125;_i)</span
          >.
        </p>
      </div>

      <div class="formal-block formal-block-definition">
        <p class="font-semibold text-blue-400 mb-2">
          Definition 4 (Mixed Spaces).
        </p>
        <p class="text-gray-300">
          The <span class="math">i</span>-th mixed spaces
          <span class="math">\mathcal&#123;M&#125;_i</span> are
          defined as
          <span class="math"
            >\mathcal&#123;M&#125;_i =
            MC(\mathcal&#123;I&#125;\mathcal&#123;D&#125;_i)</span
          >.
        </p>
      </div>

      <div class="formal-block formal-block-definition">
        <p class="font-semibold text-blue-400 mb-2">
          Definition 5.
        </p>
        <p class="text-gray-300">
          For
          <span class="math"
            >I \subseteq \&#123;0, 1, 2, 3\&#125;</span
          >, the combined subspaces are defined as:
        </p>
        <div class="math-block">
          \mathcal&#123;C&#125;_I = \bigoplus_&#123;i \in I&#125;
          \mathcal&#123;C&#125;_i, \quad \mathcal&#123;D&#125;_I =
          \bigoplus_&#123;i \in I&#125;
          \mathcal&#123;D&#125;_i, \quad
          \mathcal&#123;I&#125;\mathcal&#123;D&#125;_I =
          \bigoplus_&#123;i \in I&#125;
          \mathcal&#123;I&#125;\mathcal&#123;D&#125;_i, \quad
          \mathcal&#123;M&#125;_I = \bigoplus_&#123;i \in I&#125;
          \mathcal&#123;M&#125;_i
        </div>
      </div>

      <div class="formal-block formal-block-theorem">
        <p class="font-semibold text-green-400 mb-2">
          Theorem 1 ([GRR17b]).
        </p>
        <p class="text-gray-300">
          For each
          <span class="math">I</span> and for each
          <span class="math"
            >a \in \mathcal&#123;D&#125;_I^&#123;\perp&#125;</span
          >, there exist unique
          <span class="math"
            >b \in \mathcal&#123;C&#125;_I^&#123;\perp&#125;</span
          >
          and
          <span class="math"
            >c \in \mathcal&#123;M&#125;_I^&#123;\perp&#125;</span
          >
          (which depend on
          <span class="math">a</span> and on the secret key
          <span class="math">k</span>) such that
        </p>
        <div class="math-block">
          R^&#123;2&#125;(\mathcal&#123;D&#125;_I \oplus a) =
          R(\mathcal&#123;C&#125;_I \oplus b) =
          \mathcal&#123;M&#125;_I \oplus c
        </div>
      </div>

      <div class="formal-block formal-block-lemma">
        <p class="font-semibold text-amber-400 mb-2">
          Lemma 1 ([GRR17b]).
        </p>
        <p class="text-gray-300">
          For all
          <span class="math">x, y</span> and for all
          <span class="math"
            >I \subseteq \&#123;0, 1, 2, 3\&#125;</span
          >:
        </p>
        <div class="math-block">
          \Pr(R^&#123;2&#125;(x) \oplus R^&#123;2&#125;(y) \in
          \mathcal&#123;M&#125;_I \mid x \oplus y \in
          \mathcal&#123;D&#125;_I) = 1
        </div>
      </div>

      <h3 id="sec-3.2" class="text-xl font-semibold mt-8 mb-3">
        3.2 &ensp; Intersections of Subspaces and Useful
        Probabilities
      </h3>

      <p class="text-gray-300">
        The probability
        <span class="math">p_&#123;|I|&#125;</span> that a random
        element
        <span class="math">x</span> belongs to the subspace
        <span class="math">\mathcal&#123;M&#125;_I</span> for a
        certain
        <span class="math"
          >I \subseteq \&#123;0,1,2,3\&#125;</span
        >
        with
        <span class="math">|I| = l</span> fixed is well approximated
        by:
      </p>
      <div class="math-block">
        p_&#123;|I|&#125; = (-1)^&#123;|I|&#125; \cdot
        \sum_&#123;i=4-|I|&#125;^&#123;3&#125; (-1)^i \cdot
        c_&#123;|I|,i&#125; \cdot \binom&#123;4&#125;&#123;i&#125;
        \cdot 2^&#123;-32 \cdot i&#125;
      </div>
      <p class="text-gray-300 mt-2">
        where
        <span class="math">c_&#123;2,3&#125; = 3</span> and
        <span class="math"
          >c_&#123;|I|,i&#125; = 1</span
        >
        for
        <span class="math"
          >\&#123;|I|, i\&#125; \neq \&#123;2, 3\&#125;</span
        >.
      </p>
    </section>

    <!-- ============================================================ -->
    <!-- 4. MULTIPLE-OF-8 DISTINGUISHER                               -->
    <!-- ============================================================ -->

    <section id="sec-4" class="mb-12">
      <h2 class="text-2xl font-bold mb-4">
        4 &ensp; &ldquo;Multiple-of-8&rdquo; Secret-Key Distinguisher
        for 5-round AES
      </h2>

      <p class="text-gray-300">
        The 5-round AES distinguisher proposed in [GRR17a] exploits
        the fact that the number of different pairs of ciphertexts
        that belong to the same coset of
        <span class="math">\mathcal&#123;M&#125;_J</span> for a fixed
        <span class="math">J</span> is always a multiple of 8 with
        probability 1 independently of the secret key, of the details
        of the S-Box and of the MixColumns matrix.
      </p>

      <div class="formal-block formal-block-theorem">
        <p class="font-semibold text-green-400 mb-2">
          Theorem 2 ([GRR17a]).
        </p>
        <p class="text-gray-300">
          Let
          <span class="math">\mathcal&#123;M&#125;_I</span> and
          <span class="math">\mathcal&#123;D&#125;_J</span> be the
          subspaces defined as before for certain fixed
          <span class="math">I</span> and
          <span class="math">J</span> with
          <span class="math">1 \leq |I| \leq 3</span>. Given an
          arbitrary coset of
          <span class="math">\mathcal&#123;M&#125;_I</span>, the
          number
          <span class="math">n</span> of different pairs of
          ciphertexts
          <span class="math"
            >(c^i, c^j)</span
          >
          for
          <span class="math">i \neq j</span> such that
          <span class="math"
            >c^i \oplus c^j \in \mathcal&#123;D&#125;_J</span
          >
          is always a multiple of 8 with prob.&nbsp;1.
        </p>
      </div>

      <div class="formal-block formal-block-lemma">
        <p class="font-semibold text-amber-400 mb-2">
          Lemma 2.
        </p>
        <p class="text-gray-300">
          Let
          <span class="math">p</span> and
          <span class="math">q</span> be two different elements in
          <span class="math"
            >\mathcal&#123;M&#125;_I \oplus a</span
          >
          for
          <span class="math">|I| = 1</span>, with
          <span class="math"
            >p \equiv (p^0, p^1, p^2, p^3)</span
          >
          and
          <span class="math"
            >q \equiv (q^0, q^1, q^2, q^3)</span
          >, such that
          <span class="math"
            >p^i \neq q^i</span
          >
          for each
          <span class="math">i = 0, \ldots, 3</span>. Independently
          of the secret key, of the details of the S-Box and of the
          MixColumns matrix,
          <span class="math">R(p)</span> and
          <span class="math">R(q)</span> belong to the same coset of
          <span class="math">\mathcal&#123;D&#125;_J</span> if and
          only if the pairs of texts generated by the following
          combinations of variables have the same property:
        </p>
        <div class="math-block">
          (p^0, p^1, q^2, q^3) \text&#123; and &#125; (q^0, q^1,
          p^2, p^3); \quad (p^0, q^1, p^2, q^3) \text&#123; and
          &#125; (q^0, p^1, q^2, p^3); \quad \ldots
        </div>
      </div>
    </section>

    <!-- ============================================================ -->
    <!-- 5. NEW 4-ROUND DISTINGUISHER                                 -->
    <!-- ============================================================ -->

    <section id="sec-5" class="mb-12">
      <h2 class="text-2xl font-bold mb-4">
        5 &ensp; New 4-round Secret-Key Distinguisher for AES
      </h2>

      <h3 id="sec-5.1" class="text-xl font-semibold mt-6 mb-3">
        5.1 &ensp; Mixture Differential Distinguisher for 4-round AES
      </h3>

      <div class="formal-block formal-block-lemma">
        <p class="font-semibold text-amber-400 mb-2">
          Lemma 4 (Mixture Differential Distinguisher).
        </p>
        <p class="text-gray-300">
          Given the subspace
          <span class="math"
            >\mathcal&#123;C&#125;_0 \cap
            \mathcal&#123;D&#125;_&#123;0,3&#125; \equiv \langle
            e_&#123;0,0&#125;, e_&#123;1,0&#125; \rangle \subseteq
            \mathcal&#123;C&#125;_0</span
          >, consider two plaintexts
          <span class="math"
            >p^1</span
          >
          and
          <span class="math"
            >p^2</span
          >
          in the same coset
          <span class="math"
            >(\mathcal&#123;C&#125;_0 \cap
            \mathcal&#123;D&#125;_&#123;0,3&#125;) \oplus a</span
          >
          generated by
          <span class="math"
            >p^1 \equiv (z^1, w^1)</span
          >
          and
          <span class="math"
            >p^2 \equiv (z^2, w^2)</span
          >. Let
          <span class="math"
            >\hat&#123;p&#125;^1 \equiv (z^1, w^2)</span
          >
          and
          <span class="math"
            >\hat&#123;p&#125;^2 \equiv (z^2, w^1)</span
          >. The following event:
        </p>
        <div class="math-block">
          R^4(p^1) \oplus R^4(p^2) \in \mathcal&#123;M&#125;_J
          \quad\text&#123;if and only if&#125;\quad
          R^4(\hat&#123;p&#125;^1) \oplus
          R^4(\hat&#123;p&#125;^2) \in \mathcal&#123;M&#125;_J
        </div>
        <p class="text-gray-300 mt-2">
          holds with prob.&nbsp;1 for 4-round AES, independently of
          the secret key, of the details of the S-Box and of the
          MixColumns matrix (except for the branch number equal to 5).
        </p>
      </div>

      <p class="text-gray-300 mt-4">
        The proof uses the &ldquo;super-Sbox&rdquo; notation
        introduced in [DR06]:
        <span class="math"
          >\text&#123;super-Sbox&#125;(\cdot) =
          \text&#123;S-Box&#125; \circ ARK \circ MC \circ
          \text&#123;S-Box&#125;(\cdot)</span
        >. Since each column of the ShiftRows output depends on
        different and independent variables, since the super-Sbox
        works independently on each column and since the XOR-sum is
        commutative, the thesis follows.
      </p>

      <p class="text-gray-300 mt-4">
        <strong>Data Cost.</strong> The distinguisher requires
        <span class="math">2^&#123;17&#125;</span> chosen plaintexts
        (2 cosets of
        <span class="math"
          >\mathcal&#123;C&#125;_0 \cap
          \mathcal&#123;D&#125;_&#123;0,3&#125;</span
        >). The computational cost is approximately
        <span class="math"
          >2^&#123;23.09&#125;</span
        >
        table look-ups, or approximately
        <span class="math"
          >2^&#123;16.75&#125;</span
        >
        four-round encryptions.
      </p>

      <h3 id="sec-5.2" class="text-xl font-semibold mt-8 mb-3">
        5.2 &ensp; Generic Mixture Differential Distinguishers for
        4-round AES
      </h3>

      <div class="formal-block formal-block-theorem">
        <p class="font-semibold text-green-400 mb-2">
          Theorem 3.
        </p>
        <p class="text-gray-300">
          Given two plaintexts
          <span class="math"
            >p^1 \equiv (z^1, w^1)</span
          >
          and
          <span class="math"
            >p^2 \equiv (z^2, w^2)</span
          >
          in the same coset of
          <span class="math"
            >\mathcal&#123;C&#125;_0 \cap
            \mathcal&#123;D&#125;_&#123;0,3&#125;</span
          >, and two other plaintexts
          <span class="math"
            >\tilde&#123;p&#125;^1, \tilde&#123;p&#125;^2 \in
            \mathcal&#123;C&#125;_0 \oplus a</span
          >
          generated by
          <span class="math"
            >\tilde&#123;p&#125;^1 \equiv (z^1, w^1, x, y)</span
          >,
          <span class="math"
            >\tilde&#123;p&#125;^2 \equiv (z^2, w^2, x, y)</span
          >
          or
          <span class="math"
            >\tilde&#123;p&#125;^1 \equiv (z^1, w^2, x, y)</span
          >,
          <span class="math"
            >\tilde&#123;p&#125;^2 \equiv (z^2, w^1, x, y)</span
          >
          where
          <span class="math"
            >x, y \in
            \mathbb&#123;F&#125;_&#123;2^8&#125;</span
          >
          are arbitrary. Then the event
          <span class="math"
            >R^4(p^1) \oplus R^4(p^2) \in
            \mathcal&#123;M&#125;_J</span
          >
          if and only if
          <span class="math"
            >R^4(\tilde&#123;p&#125;^1) \oplus
            R^4(\tilde&#123;p&#125;^2) \in
            \mathcal&#123;M&#125;_J</span
          >
          holds with prob.&nbsp;1 for 4-round AES.
        </p>
      </div>

      <div class="formal-block formal-block-theorem">
        <p class="font-semibold text-green-400 mb-2">
          Theorem 4.
        </p>
        <p class="text-gray-300">
          Given two plaintexts with <em>all different</em> generating
          variables
          <span class="math"
            >p^1 \equiv (x^1, y^1, z^1, w^1)</span
          >
          and
          <span class="math"
            >p^2 \equiv (x^2, y^2, z^2, w^2)</span
          >
          in a coset of
          <span class="math">\mathcal&#123;C&#125;_0</span>, the
          mixture differential property holds for all 7 additional
          pairs generated by different combinations of their
          generating variables.
        </p>
      </div>

      <h3 id="sec-5.3" class="text-xl font-semibold mt-8 mb-3">
        5.3 &ensp; Comparison with Other 4-round Secret-Key
        Distinguishers
      </h3>

      <p class="text-gray-300">
        The paper compares the mixture differential distinguisher with
        existing 4-round distinguishers:
      </p>
      <ul class="list-disc list-inside text-gray-300 mt-2 space-y-2">
        <li>
          <strong>Impossible Differential:</strong> exploits
          <span class="math"
            >\mathcal&#123;M&#125;_I \cap
            \mathcal&#123;D&#125;_J = \&#123;0\&#125;</span
          >
          for
          <span class="math">|I| + |J| \leq 4</span>, which does not
          apply here since the paper works with
          <span class="math">|I| + |J| \geq 5</span>.
        </li>
        <li>
          <strong>Truncated Differential:</strong> works on single
          couples independently; the mixture differential works on
          sets of non-independent couples.
        </li>
        <li>
          <strong>Polytopic Cryptanalysis:</strong> considers
          interdependencies in sets of couples with one plaintext in
          common; the mixture differential exploits generating
          variable relationships.
        </li>
        <li>
          <strong>&ldquo;Multiple-of-8&rdquo;:</strong> the mixture
          differential has lower data/computational costs
          (<span class="math">2^&#123;17&#125;</span> vs
          <span class="math">2^&#123;33&#125;</span> CP).
        </li>
        <li>
          <strong>Yoyo Distinguisher:</strong> similar in spirit but
          requires adaptive chosen ciphertexts; the mixture
          differential uses only chosen plaintexts.
        </li>
      </ul>
    </section>

    <!-- ============================================================ -->
    <!-- 6. KEY-RECOVERY ATTACK ON 5-ROUND AES                       -->
    <!-- ============================================================ -->

    <section id="sec-6" class="mb-12">
      <h2 class="text-2xl font-bold mb-4">
        6 &ensp; New Key-Recovery Attack on 5-round AES
      </h2>

      <p class="text-gray-300">
        The 4-round distinguisher from Theorem&nbsp;4 can be used to
        set up a key-recovery attack on 5-round AES. Given plaintexts
        in the same coset of
        <span class="math">\mathcal&#123;D&#125;_0</span>, the
        attacker guesses 4 bytes of the first diagonal of the secret
        key
        <span class="math"
          >k_&#123;i,i&#125;</span
        >
        for each
        <span class="math">i \in \&#123;0,1,2,3\&#125;</span>,
        partially computes one round, and exploits the mixture
        differential distinguisher: for the right key the property
        must be satisfied; for wrong keys the behavior is that of a
        random permutation (wrong-key randomization hypothesis).
      </p>

      <h3 id="sec-6.1" class="text-xl font-semibold mt-6 mb-3">
        6.1 &ensp; Data and Computational Costs
      </h3>
      <p class="text-gray-300">
        The attack requires
        <span class="math"
          >2^&#123;33.6&#125;</span
        >
        chosen plaintexts and has a computational cost of
        <span class="math"
          >2^&#123;33.28&#125;</span
        >
        five-round encryptions. The probability that at least one
        wrong key passes the test is approximately
        <span class="math"
          >2^&#123;-192&#125;</span
        >, so a single couple of texts (together with two additional
        generated couples) is sufficient to discard all wrong key
        candidates.
      </p>

      <h3 id="sec-6.2" class="text-xl font-semibold mt-6 mb-3">
        6.2 &ensp; Practical Verification
      </h3>
      <p class="text-gray-300">
        The attack has been practically verified on the small scale
        AES [CMR05]. A single coset of a diagonal space is largely
        sufficient to find one diagonal of the key. The practical
        computational cost matches the theoretical prediction of
        <span class="math"
          >2^&#123;21.5&#125;</span
        >
        table look-ups for the small scale case.
      </p>
    </section>

    <!-- ============================================================ -->
    <!-- 7. NEW 5-ROUND DISTINGUISHER                                 -->
    <!-- ============================================================ -->

    <section id="sec-7" class="mb-12">
      <h2 class="text-2xl font-bold mb-4">
        7 &ensp; A New 5-round Secret-Key Distinguisher for AES
      </h2>

      <h3 id="sec-7.1" class="text-xl font-semibold mt-6 mb-3">
        7.1 &ensp; 5-round Probabilistic Mixture Differential
        Secret-Key Distinguisher
      </h3>

      <p class="text-gray-300">
        Consider
        <span class="math">2^&#123;32&#125;</span> chosen plaintexts
        with one active column (a coset of
        <span class="math">\mathcal&#123;C&#125;_0</span>) and the
        corresponding ciphertexts after 5 rounds. For each pair
        <span class="math"
          >(x_0, x_1), (y_0, y_1) \in
          \mathbb&#123;F&#125;_&#123;2^8&#125;^2</span
        >
        with
        <span class="math">x_0 \neq y_0</span> and
        <span class="math">x_1 \neq y_1</span>, define sets
        <span class="math"
          >\mathcal&#123;S&#125;^&#123;0,1&#125;_&#123;(x_0,x_1),(y_0,y_1)&#125;</span
        >
        of couples of plaintexts where the generating variables are
        &ldquo;mixed.&rdquo;
      </p>

      <p class="text-gray-300 mt-4">
        The key result: the probability that a set
        <span class="math">\mathcal&#123;S&#125;</span> contains at
        least one couple whose ciphertexts belong to the same coset of
        <span class="math">\mathcal&#123;M&#125;_J</span> for
        <span class="math">|J| = 3</span> differs between AES and a
        random permutation:
      </p>
      <div class="math-block">
        p_&#123;\text&#123;AES&#125;&#125; \simeq 2^&#123;-13&#125; -
        524287 \cdot 2^&#123;-46&#125; - 22370411853 \cdot
        2^&#123;-77&#125; + \cdots
      </div>
      <div class="math-block">
        p_&#123;\text&#123;rand&#125;&#125; \simeq
        2^&#123;-13&#125; - 524287 \cdot 2^&#123;-46&#125; +
        45812722347 \cdot 2^&#123;-77&#125; + \cdots
      </div>
      <p class="text-gray-300 mt-2">
        The distinguisher requires
        <span class="math"
          >n \geq 2^&#123;71.243&#125;</span
        >
        sets to achieve 95% success probability.
      </p>

      <h3 id="sec-7.2" class="text-xl font-semibold mt-8 mb-3">
        7.2 &ensp; Data and Computational Complexity
      </h3>
      <p class="text-gray-300">
        <strong>Data Cost.</strong> Approximately
        <span class="math"
          >2^&#123;70.67&#125;</span
        >
        chosen plaintexts (in
        <span class="math"
          >2^&#123;38.669&#125;</span
        >
        initial cosets of
        <span class="math">\mathcal&#123;C&#125;_I</span> for
        <span class="math">|I| = 1</span>). A variant (App.&nbsp;C.2)
        requires only
        <span class="math">2^&#123;52&#125;</span> chosen plaintexts
        in a single coset of
        <span class="math">\mathcal&#123;C&#125;_I</span> for
        <span class="math">|I| = 2</span>.
      </p>
      <p class="text-gray-300 mt-4">
        <strong>Computational Cost.</strong> Approximately
        <span class="math"
          >2^&#123;77.73&#125;</span
        >
        table look-ups (equivalently
        <span class="math"
          >2^&#123;71.1&#125;</span
        >
        five-round encryptions). The variant requires
        <span class="math"
          >2^&#123;71.5&#125;</span
        >
        table look-ups (equivalently
        <span class="math"
          >2^&#123;64.9&#125;</span
        >
        five-round encryptions).
      </p>

      <h3 id="sec-7.3" class="text-xl font-semibold mt-8 mb-3">
        7.3 &ensp; Practical Verification on Small Scale AES
      </h3>
      <p class="text-gray-300">
        Using
        <span class="math">2^&#123;16&#125;</span> different initial
        cosets of
        <span class="math">\mathcal&#123;C&#125;_0</span> on small
        scale AES, the theoretical and practical numbers of qualifying
        sets match closely:
      </p>
      <div class="math-block">
        n_&#123;\text&#123;rand&#125;&#125;^T \simeq 2658.27, \quad
        n_&#123;\text&#123;rand&#125;&#125;^P \simeq 2658.23, \quad
        n_&#123;\text&#123;AES&#125;&#125;^T \simeq 2657.69, \quad
        n_&#123;\text&#123;AES&#125;&#125;^P \simeq 2657.65
      </div>
      <p class="text-gray-300 mt-2">
        confirming that the number of qualifying sets for AES is lower
        than for the random case, as predicted.
      </p>
    </section>

    <!-- ============================================================ -->
    <!-- 8. KEY-RECOVERY ATTACK ON 6 ROUNDS                           -->
    <!-- ============================================================ -->

    <section id="sec-8" class="mb-12">
      <h2 class="text-2xl font-bold mb-4">
        8 &ensp; Key-Recovery Attack on 6 Rounds of AES-128
      </h2>

      <p class="text-gray-300">
        Using the 5-round probabilistic mixture differential
        distinguisher as starting point, this is the
        <em>first</em> key-recovery attack on 6 rounds of AES that
        exploits a 5-round secret-key distinguisher. The strategy is
        similar to linear and differential cryptanalysis: start with
        cosets of
        <span class="math">\mathcal&#123;D&#125;_I</span>, guess 4
        bytes of the key, and count the number of qualifying sets
        <span class="math">\mathcal&#123;S&#125;</span>. The count is
        minimum for the right key.
      </p>

      <p class="text-gray-300 mt-4">
        For a wrongly guessed key, the probability that a set
        satisfies the property is:
      </p>
      <div class="math-block">
        p_&#123;\text&#123;AES&#125;&#125;^&#123;\text&#123;WrongKey&#125;&#125;
        = 2^&#123;-13&#125; - 524287 \cdot 2^&#123;-46&#125; +
        45812722347 \cdot 2^&#123;-77&#125; + \cdots
      </div>
      <p class="text-gray-300 mt-2">
        which is approximately equal to the random case and higher
        than the right-key probability.
      </p>

      <p class="text-gray-300 mt-4">
        <strong>Data Cost:</strong>
        <span class="math"
          >2^&#123;72.77&#125;</span
        >
        chosen plaintexts.
        <strong>Computational Cost:</strong>
        <span class="math"
          >2^&#123;104.93&#125;</span
        >
        six-round encryptions (finding one diagonal of the key costs
        <span class="math"
          >2^&#123;104.92&#125;</span
        >; remaining bytes found by brute force).
      </p>
    </section>

    <!-- ============================================================ -->
    <!-- 9. OTHER SECRET-KEY DISTINGUISHERS                           -->
    <!-- ============================================================ -->

    <section id="sec-9" class="mb-12">
      <h2 class="text-2xl font-bold mb-4">
        9 &ensp; Other Secret-Key Distinguishers for 5-round AES
      </h2>

      <h3 id="sec-9.1" class="text-xl font-semibold mt-6 mb-3">
        9.1 &ensp; Threshold Mixture Differential Secret-Key
        Distinguisher
      </h3>

      <p class="text-gray-300">
        This distinguisher uses sets
        <span class="math"
          >\mathcal&#123;Z&#125;_&#123;(\mathbf&#123;x&#125;,
          \mathbf&#123;y&#125;)&#125;</span
        >
        of
        <span class="math">2^&#123;65&#125;</span> couples. One
        counts the number of sets for which the number of couples
        whose ciphertexts belong to the same coset of
        <span class="math">\mathcal&#123;M&#125;_I</span> for
        <span class="math">|I| = 2</span> exceeds a threshold
        <span class="math"
          >Z = 3 \cdot 2^&#123;18&#125; = 786432</span
        >.
      </p>
      <ul class="list-disc list-inside text-gray-300 mt-2 space-y-2">
        <li>
          For 5-round AES: the number of qualifying sets is on average
          higher than
          <span class="math">2^&#123;16&#125;</span>.
        </li>
        <li>
          For a random permutation: the number of qualifying sets is
          on average lower than
          <span class="math"
            >2^&#123;11.415&#125;</span
          >.
        </li>
      </ul>
      <p class="text-gray-300 mt-4">
        <strong>Costs:</strong>
        <span class="math">2^&#123;89&#125;</span> chosen plaintexts,
        <span class="math"
          >2^&#123;98.1&#125;</span
        >
        table look-ups (equivalently
        <span class="math"
          >2^&#123;91.5&#125;</span
        >
        five-round encryptions).
      </p>

      <h3 id="sec-9.2" class="text-xl font-semibold mt-8 mb-3">
        9.2 &ensp; Impossible Mixture Differential Secret-Key
        Distinguisher
      </h3>

      <p class="text-gray-300">
        This distinguisher uses sets
        <span class="math"
          >\mathcal&#123;Q&#125;_&#123;(\mathbf&#123;x&#125;,
          \mathbf&#123;y&#125;)&#125;</span
        >
        of
        <span class="math">2^&#123;39&#125;</span> couples, with all
        possible combinations of 16 generating variables. One checks
        if there exists at least one set for which the two ciphertexts
        of <em>each</em> couple do not belong to the same coset of
        <span class="math">\mathcal&#123;M&#125;_I</span> for
        <span class="math">|I| = 3</span>.
      </p>
      <ul class="list-disc list-inside text-gray-300 mt-2 space-y-2">
        <li>
          For 5-round AES: at least one qualifying set exists with
          probability
          <span class="math"
            >\approx 99.9995\%</span
          >.
        </li>
        <li>
          For a random permutation: for each set there exists at least
          one couple with ciphertexts in the same coset of
          <span class="math">\mathcal&#123;M&#125;_I</span> (with
          probability close to 1).
        </li>
      </ul>
      <p class="text-gray-300 mt-4">
        <strong>Costs:</strong>
        <span class="math">2^&#123;82&#125;</span> chosen plaintexts,
        <span class="math"
          >2^&#123;97.8&#125;</span
        >
        table look-ups (equivalently
        <span class="math"
          >2^&#123;91.1&#125;</span
        >
        five-round encryptions).
      </p>
    </section>

    <!-- ============================================================ -->
    <!-- REFERENCES                                                   -->
    <!-- ============================================================ -->

    <section id="references" class="mb-12">
      <h2 class="text-2xl font-bold mb-4">References</h2>
      <ol class="list-none space-y-2 text-sm text-gray-400">
        <li>
          [BBS99] Biham, Biryukov, Shamir. Cryptanalysis of Skipjack
          Reduced to 31 Rounds Using Impossible Differentials.
          EUROCRYPT 1999.
        </li>
        <li>
          [BEK16] Bay, Ersoy, Karako&ccedil;. Universal Forgery and
          Key Recovery Attacks on ELmD. ASIACRYPT 2016.
        </li>
        <li>
          [BG11] Blondeau, G&eacute;rard. Multiple Differential
          Cryptanalysis: Theory and Practice. FSE 2011.
        </li>
        <li>
          [BK01] Biham, Keller. Cryptanalysis of Reduced Variants of
          Rijndael. 2001.
        </li>
        <li>
          [BKR11] Bogdanov, Khovratovich, Rechberger. Biclique
          Cryptanalysis of the Full AES. ASIACRYPT 2011.
        </li>
        <li>
          [BLN17] Blondeau, Leander, Nyberg. Differential-Linear
          Cryptanalysis Revisited. J. Cryptology 30(3), 2017.
        </li>
        <li>
          [BODK+18] Bar-On, Dunkelman, Keller, Ronen, Shamir.
          Improved Key-Recovery Attacks on AES. CRYPTO 2018.
        </li>
        <li>
          [BS90] Biham, Shamir. Differential Cryptanalysis of
          DES-like Cryptosystems. CRYPTO 1990.
        </li>
        <li>
          [BS91] Biham, Shamir. Differential Cryptanalysis of
          DES-like Cryptosystems. J. Cryptology 4(1), 1991.
        </li>
        <li>
          [CMR05] Cid, Murphy, Robshaw. Small Scale Variants of the
          AES. FSE 2005.
        </li>
        <li>
          [Der13] Derbez. Meet-in-the-middle attacks on AES. PhD
          Thesis, ENS Paris, 2013.
        </li>
        <li>
          [DF13] Derbez, Fouque. Exhausting Demirci-Sel&ccedil;uk
          Meet-in-the-Middle Attacks Against Reduced-Round AES. FSE
          2013.
        </li>
        <li>
          [DKR97] Daemen, Knudsen, Rijmen. The Block Cipher Square.
          FSE 1997.
        </li>
        <li>
          [DR02] Daemen, Rijmen. The Design of Rijndael: AES.
          Springer, 2002.
        </li>
        <li>
          [DR06] Daemen, Rijmen. Understanding Two-Round Differentials
          in AES. SCN 2006.
        </li>
        <li>
          [GR18] Grassi, Rechberger. New Rigorous Analysis of
          Truncated Differentials for 5-round AES. ePrint 2018/182.
          <a href="/papers/truncated-diff-diagonal-aes-2018" class="text-blue-400 hover:text-blue-300">[page on this site]</a>
        </li>
        <li>
          [GRR17a] Grassi, Rechberger, R&oslash;njom. A New
          Structural-Differential Property of 5-Round AES. EUROCRYPT
          2017.
        </li>
        <li>
          [GRR17b] Grassi, Rechberger, R&oslash;njom. Subspace Trail
          Cryptanalysis and its Applications to AES. IACR ToSC
          2016(2), 2017.
        </li>
        <li>
          [Knu95] Knudsen. Truncated and Higher Order Differentials.
          FSE 1994.
        </li>
        <li>
          [Knu98] Knudsen. DEAL &ndash; a 128-bit block cipher.
          Technical Report, 1998.
        </li>
        <li>
          [LH94] Langford, Hellman. Differential-Linear Cryptanalysis.
          CRYPTO 1994.
        </li>
        <li>
          [Mat94] Matsui. Linear Cryptanalysis Method for DES Cipher.
          EUROCRYPT 1993.
        </li>
        <li>
          [RBH17] R&oslash;njom, Bardeh, Helleseth. Yoyo Tricks with
          AES. ASIACRYPT 2017.
        </li>
        <li>
          [Tie16] Tiessen. Polytopic Cryptanalysis. EUROCRYPT 2016.
        </li>
        <li>
          [Tun12] Tunstall. Improved &ldquo;Partial Sums&rdquo;-based
          Square Attack on AES. SECRYPT 2012.
        </li>
        <li>
          [Wag99] Wagner. The Boomerang Attack. FSE 1999.
        </li>
      </ol>
    </section>

    <!-- ============================================================ -->
    <!-- APPENDIX A                                                   -->
    <!-- ============================================================ -->

    <section id="app-a" class="mb-12">
      <h2 class="text-2xl font-bold mb-4">
        Appendix A &ensp; Proof &ndash; Probabilities of
        Sect.&nbsp;3.2
      </h2>

      <p class="text-gray-300">
        This appendix proves the probability formulas used throughout
        the paper, using the inclusion-exclusion principle and the
        property that
        <span class="math"
          >\mathcal&#123;M&#125;_I \cap \mathcal&#123;M&#125;_J =
          \mathcal&#123;M&#125;_&#123;I \cap J&#125;</span
        >.
      </p>

      <h3 class="text-xl font-semibold mt-6 mb-3">
        A.1 &ensp; Number of Pairs with
        <span class="math">n</span> Equal Generating Variables
      </h3>
      <p class="text-gray-300">
        Given texts in the same coset of
        <span class="math">\mathcal&#123;C&#125;_I</span> for
        <span class="math"
          >I \subseteq \&#123;0,1,2,3\&#125;</span
        >, the number of couples with
        <span class="math">n</span> equal generating variables in
        <span class="math"
          >(\mathbb&#123;F&#125;_&#123;2^8&#125;)^&#123;|I|&#125;</span
        >
        is:
      </p>
      <div class="math-block">
        \binom&#123;4&#125;&#123;n&#125; \cdot
        2^&#123;32 \cdot |I| - 1&#125; \cdot
        (2^&#123;8 \cdot |I|&#125; - 1)^&#123;4-n&#125;
      </div>

      <h3 class="text-xl font-semibold mt-6 mb-3">
        A.2 &ensp; Discussion about the Given Approximations
      </h3>
      <p class="text-gray-300">
        All probabilities in Sect.&nbsp;3.2 are &ldquo;sufficiently
        good&rdquo; approximations assuming the elements are uniformly
        distributed. The appendix provides detailed discussion of
        error terms and the assumption&rsquo;s validity.
      </p>
    </section>

    <!-- ============================================================ -->
    <!-- APPENDIX B                                                   -->
    <!-- ============================================================ -->

    <section id="app-b" class="mb-12">
      <h2 class="text-2xl font-bold mb-4">
        Appendix B &ensp; 4-round Secret-Key Distinguisher for AES
        &ndash; Details
      </h2>
      <p class="text-gray-300">
        This appendix gives full details of the computational cost of
        the 4-round distinguisher (Sect.&nbsp;5). The key
        optimization is to re-order ciphertexts with respect to a
        partial order
        <span class="math">\preceq</span> and work only on
        consecutive texts. The total cost is
        <span class="math"
          >2^&#123;23.09&#125;</span
        >
        table look-ups, or approximately
        <span class="math"
          >2^&#123;16.75&#125;</span
        >
        four-round encryptions, with memory cost of
        <span class="math">2^&#123;23&#125;</span> bytes.
      </p>
    </section>

    <!-- ============================================================ -->
    <!-- APPENDIX C                                                   -->
    <!-- ============================================================ -->

    <section id="app-c" class="mb-12">
      <h2 class="text-2xl font-bold mb-4">
        Appendix C &ensp; Variants of the 5-round AES Secret-Key
        Distinguisher of Sect.&nbsp;7
      </h2>

      <p class="text-gray-300">
        <strong>C.1 First Variant:</strong> Uses sets
        <span class="math"
          >\mathcal&#123;T&#125;^3_&#123;(x_0,x_1,x_2),(y_0,y_1,y_2)&#125;</span
        >
        with 3 different generating variables and
        <span class="math">2^&#123;10&#125;</span> couples per set.
        Requires
        <span class="math"
          >2^&#123;77.263&#125;</span
        >
        CP and
        <span class="math"
          >2^&#123;85.61&#125;</span
        >
        five-round encryptions.
      </p>

      <p class="text-gray-300 mt-4">
        <strong>C.2 Second Variant (Most Competitive):</strong>
        Uses
        <span class="math">2^&#123;64&#125;</span> chosen plaintexts
        in a coset of
        <span class="math"
          >\mathcal&#123;C&#125;_&#123;0,1&#125;</span
        >
        with
        <span class="math">2^&#123;18&#125;</span> couples per set.
        Requires only
        <span class="math">2^&#123;52&#125;</span> CP and
        <span class="math"
          >2^&#123;64.86&#125;</span
        >
        five-round encryptions. However, it cannot be used for a
        key-recovery attack on 6-round AES.
      </p>

      <p class="text-gray-300 mt-4">
        <strong
          >C.3 Key-Recovery Attack on 6-round AES with
          <span class="math">|I| = 2</span>:</strong
        >
        Using cosets of
        <span class="math">\mathcal&#123;D&#125;_I</span> with
        <span class="math">|I| = 2</span> requires guessing
        <span class="math">2^&#123;64&#125;</span> key bits, leading
        to a total cost of
        <span class="math"
          >2^&#123;176.2&#125;</span
        >
        six-round encryptions &ndash; much higher than brute force.
      </p>
    </section>

    <!-- ============================================================ -->
    <!-- APPENDIX D                                                   -->
    <!-- ============================================================ -->

    <section id="app-d" class="mb-12">
      <h2 class="text-2xl font-bold mb-4">
        Appendix D &ensp; Other Variants of the 5-round AES
        Secret-Key Distinguisher
      </h2>

      <p class="text-gray-300">
        <strong>D.1 Variant with All Different Variables:</strong>
        Uses sets where all 4 generating variables differ, giving 8
        couples per set. Requires
        <span class="math"
          >n \geq 2^&#123;113.84&#125;</span
        >
        sets. Data cost:
        <span class="math"
          >2^&#123;85.84&#125;</span
        >
        CP (or
        <span class="math">2^&#123;59&#125;</span> CP using cosets of
        <span class="math">\mathcal&#123;C&#125;_I</span> for
        <span class="math">|I| = 2</span>). Computational cost:
        <span class="math"
          >\approx 2^&#123;107.2&#125;</span
        >
        five-round encryptions.
      </p>

      <p class="text-gray-300 mt-4">
        <strong>D.2 Key-Recovery Attack on 6-round AES</strong>
        can also be set up from this variant with
        <span class="math"
          >|p_&#123;\text&#123;AES&#125;&#125;^&#123;\text&#123;WrongKey&#125;&#125;
          - p_&#123;\text&#123;AES&#125;&#125;| \simeq
          2^&#123;-69.2&#125;</span
        >.
      </p>

      <p class="text-gray-300 mt-4">
        <strong>D.3 Practical Verification:</strong>
        Verified on small scale AES with
        <span class="math">2^&#123;23&#125;</span> initial cosets.
        Theoretical and practical values match closely, confirming the
        distinguisher.
      </p>
    </section>

    <!-- ============================================================ -->
    <!-- APPENDIX E                                                   -->
    <!-- ============================================================ -->

    <section id="app-e" class="mb-12">
      <h2 class="text-2xl font-bold mb-4">
        Appendix E &ensp; Different Implementation of the 5-round
        Distinguisher
      </h2>

      <p class="text-gray-300">
        Defines a partial order
        <span class="math">\sqsubseteq</span> that involves
        <em>both</em> plaintexts and ciphertexts, ensuring that pairs
        belonging to the same coset of
        <span class="math">\mathcal&#123;M&#125;_J</span> (for
        ciphertexts) and
        <span class="math"
          >\mathcal&#123;C&#125;_0 \cap
          \mathcal&#123;D&#125;_I</span
        >
        (for plaintexts) are consecutive in the ordering. This
        eliminates the need to explicitly check the plaintext
        condition in some cases, improving the implementation of
        distinguishers in Sect.&nbsp;9.1 and App.&nbsp;C.2 (though
        it does not affect the overall asymptotic cost of the
        Sect.&nbsp;7 distinguisher).
      </p>
    </section>

    <!-- ============================================================ -->
    <!-- APPENDIX F                                                   -->
    <!-- ============================================================ -->

    <section id="app-f" class="mb-12">
      <h2 class="text-2xl font-bold mb-4">
        Appendix F &ensp; Integral Attack on 5-round AES
      </h2>

      <p class="text-gray-300">
        Recalls and improves the integral attack on 5-round AES.
        Given
        <span class="math">2^&#123;32&#125;</span> chosen plaintexts
        in a coset of
        <span class="math">\mathcal&#123;D&#125;_I</span>, the
        XOR-sum of ciphertexts after 4 rounds is zero:
      </p>
      <div class="math-block">
        \bigoplus_&#123;p^i \in \mathcal&#123;D&#125;_I \oplus a&#125;
        R^4(p^i) = 0
      </div>

      <p class="text-gray-300 mt-4">
        <strong>Improved Attack:</strong> By recording the parity of
        each byte value in a
        <span class="math">2^8</span>-bit hash table, the cost per
        guessed key byte reduces from
        <span class="math">2^&#123;32&#125;</span> to
        <span class="math">2^8</span> S-Box operations. Total cost:
        <span class="math">2^&#123;32&#125;</span> CP,
        <span class="math">2^&#123;32&#125;</span> memory look-ups
        (<span class="math"
          >\approx 2^&#123;25.4&#125;</span
        >
        five-round encryptions), and
        <span class="math">2^&#123;12&#125;</span> bits of memory.
      </p>
    </section>
  </article>
</BaseLayout>
