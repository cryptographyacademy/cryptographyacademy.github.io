---
import BaseLayout from '../../layouts/BaseLayout.astro';

const EPRINT_URL = 'https://eprint.iacr.org/2019/951';
---

<BaseLayout title="Collisions on Feistel-MiMC and GMiMC (2019/951)">
  <article class="max-w-4xl mx-auto article-prose">
    <nav class="mb-8">
      <a href="/papers" class="text-blue-400 hover:text-blue-300">
        &larr; Back to Papers
      </a>
    </nav>

    <!-- ============================================================ -->
    <!-- HEADER                                                       -->
    <!-- ============================================================ -->

    <header class="mb-12">
      <h1 class="text-3xl font-bold mb-4">
        Collisions on Feistel-MiMC and Univariate GMiMC
      </h1>
      <p class="text-gray-400 mb-2">
        Xavier Bonnetain
      </p>
      <p class="text-gray-500 text-sm mb-4">
        2019 &middot; Full Version &middot; eprint 2019/951
      </p>
      <div class="flex gap-4 text-sm">
        <a
          href={EPRINT_URL}
          target="_blank"
          rel="noopener noreferrer"
          class="text-blue-400 hover:text-blue-300"
        >
          Paper (eprint) &rarr;
        </a>
      </div>
      <p class="mt-4 text-xs text-gray-500">
        All content below belongs to the original authors. This page
        reproduces the paper for educational purposes. Always
        <a
          href={EPRINT_URL}
          target="_blank"
          rel="noopener noreferrer"
          class="text-blue-400 hover:text-blue-300"
        >cite the original</a>.
      </p>
    </header>

    <!-- ============================================================ -->
    <!-- TABLE OF CONTENTS                                            -->
    <!-- ============================================================ -->

    <nav id="toc" class="mb-10 p-6 rounded-lg"
      style="background: rgba(255,255,255,0.03);
             border: 1px solid rgba(255,255,255,0.06);">
      <h2 class="text-lg font-bold mb-4">Table of Contents</h2>
      <ol class="space-y-1 text-sm text-gray-300
        list-decimal list-inside">
        <li>
          <a href="#abstract"
            class="hover:text-white">Abstract</a>
        </li>
        <li>
          <a href="#sec-1"
            class="hover:text-white">Description of the Ciphers</a>
          <ol class="ml-6 mt-1 space-y-1 list-decimal
            list-inside text-gray-400">
            <li>
              <a href="#sec-1.1"
                class="hover:text-white">
                MiMC-2<span class="math">n/n</span></a>
            </li>
            <li>
              <a href="#sec-1.2"
                class="hover:text-white">GMiMC</a>
            </li>
          </ol>
        </li>
        <li>
          <a href="#sec-2"
            class="hover:text-white">Attacks</a>
          <ol class="ml-6 mt-1 space-y-1 list-decimal
            list-inside text-gray-400">
            <li>
              <a href="#sec-2.1"
                class="hover:text-white">
                Attack on MiMC-2<span class="math">n/n</span></a>
            </li>
            <li>
              <a href="#sec-2.2"
                class="hover:text-white">Attacks on GMiMC</a>
            </li>
            <li>
              <a href="#sec-2.3"
                class="hover:text-white">
                Variants in Large Characteristics</a>
            </li>
            <li>
              <a href="#sec-2.4"
                class="hover:text-white">Quantum Attacks</a>
            </li>
          </ol>
        </li>
        <li>
          <a href="#sec-3"
            class="hover:text-white">Conclusion</a>
        </li>
      </ol>
      <p class="text-xs text-gray-500 mt-4 mb-1 font-semibold">
        Additional
      </p>
      <ul class="space-y-1 text-sm text-gray-400 list-disc
        list-inside">
        <li>
          <a href="#acknowledgements"
            class="hover:text-white">Acknowledgements</a>
        </li>
        <li>
          <a href="#references"
            class="hover:text-white">References</a>
        </li>
      </ul>
    </nav>

    <!-- ============================================================ -->
    <!-- ABSTRACT                                                     -->
    <!-- ============================================================ -->

    <section id="abstract" class="mb-10">
      <h2 class="text-2xl font-bold">Abstract</h2>
      <p class="text-gray-300">
        MiMC and GMiMC are families of MPC-friendly block ciphers and
        hash functions. In this note, we show that the block ciphers
        MiMC-2<span class="math">n/n</span> (or Feistel-MiMC) and
        univariate GMiMC are vulnerable to an attack which allows a key
        recovery in <span class="math">2^&#123;n/2&#125;</span>
        operations. This attack, which is reminiscent of a slide attack,
        only relies on their weak key schedules, and is independent of
        the round function
        (<span class="math">x^3</span> here) and the number of rounds.
      </p>
      <p class="text-gray-300">
        <strong>Keywords:</strong> MiMC, MPC, symmetric cryptanalysis
      </p>
    </section>

    <!-- ============================================================ -->
    <!-- 1. DESCRIPTION OF THE CIPHERS                                -->
    <!-- ============================================================ -->

    <section id="sec-1" class="mb-10">
      <h2 class="text-2xl font-bold">
        1. Description of the Ciphers
      </h2>

      <h3 id="sec-1.1" class="text-xl font-semibold mt-8 mb-3">
        1.1 MiMC-2<span class="math">n/n</span>
      </h3>
      <p class="text-gray-300">
        MiMC-2<span class="math">n/n</span> [Alb+16] is a
        <span class="math">2n</span>-bit block size,
        <span class="math">n</span>-bit key block cipher. It claimed
        <span class="math">n</span> bits of security. Its round
        function can be written as
      </p>
      <div class="math-block">
        R_k^i(x_L, x_R) = x_R \oplus (x_L \oplus k \oplus c_i)^3,\; x_L
      </div>

      <h3 id="sec-1.2" class="text-xl font-semibold mt-8 mb-3">
        1.2 GMiMC
      </h3>
      <p class="text-gray-300">
        GMiMC [Alb+19] generalizes the
        MiMC-2<span class="math">n/n</span> construction to generalized
        Feistels. Two key schedules are proposed. The univariate key
        schedule uses a fixed key for each round, while the multivariate
        key schedule uses <span class="math">t</span> initial keys and
        updates the round keys. Their claimed security corresponds to
        the number of bits of the key. Four generalized Feistel
        constructions are proposed:
      </p>

      <p class="text-gray-300">
        <strong>GMiMC-crf.</strong> GMiMC-crf has
        <span class="math">t</span> branches and adds a function of
        <span class="math">t - 1</span> branches on one branch. The
        round function is
      </p>
      <div class="math-block">
        R_k^i(x_1, \ldots, x_t) = x_2, \ldots, x_t,\; x_1 \oplus \left(\bigoplus_&#123;j=2&#125;^&#123;t&#125; x_j \oplus k \oplus c_i\right)^3
      </div>

      <p class="text-gray-300">
        <strong>GMiMC-erf.</strong> GMiMC-erf has
        <span class="math">t</span> branches, and adds a function of
        one branch on all the others. The round function is
      </p>
      <div class="math-block">
        R_k^i(x_1, \ldots, x_t) = x_2 \oplus (x_1 \oplus k \oplus c_i)^3, \ldots, x_t \oplus (x_1 \oplus k \oplus c_i)^3,\; x_1
      </div>

      <p class="text-gray-300">
        <strong>GMiMC-Nyb.</strong> GMiMC-Nyb has
        <span class="math">2t</span> branches, and adds a function of
        each odd branch to the next branch. The round function is
      </p>
      <div class="math-block">
        R_k^i(x_1, \ldots, x_&#123;2t&#125;) = x_2 \oplus (x_1 \oplus k \oplus c_&#123;ti&#125;)^3,\; x_3,\; x_4 \oplus (x_3 \oplus k \oplus c_&#123;ti+1&#125;)^3, \ldots, x_&#123;2t&#125; \oplus (x_&#123;2t-1&#125; \oplus k \oplus c_&#123;ti+t-1&#125;)^3,\; x_1
      </div>

      <p class="text-gray-300">
        <strong>GMiMC-mrf.</strong> GMiMC-mrf is a generalization of the
        previous construction with a permutation of the branches that
        changes for each round.
      </p>
    </section>

    <!-- ============================================================ -->
    <!-- 2. ATTACKS                                                   -->
    <!-- ============================================================ -->

    <section id="sec-2" class="mb-10">
      <h2 class="text-2xl font-bold">2. Attacks</h2>

      <h3 id="sec-2.1" class="text-xl font-semibold mt-8 mb-3">
        2.1 Attack on MiMC-2<span class="math">n/n</span>
      </h3>
      <p class="text-gray-300">
        The attack relies on an invariant property of the round
        function, and can be seen as a slight generalization of a slide
        attack presented in [BNPS19]. The invariant property is
        described below.
      </p>

      <div class="formal-block formal-block-lemma">
        <div class="formal-block-title text-amber-400">Lemma 1</div>
        <div class="formal-block-content">
          <p class="text-gray-300">
            Let <span class="math">R_k^i</span> be the round function
            of MiMC-2<span class="math">n/n</span> with the key
            <span class="math">k</span> for round
            <span class="math">i</span>. Then for all
            <span class="math">x, y, k, i</span>,
          </p>
          <div class="math-block">
            R_k^i(x, y) \oplus (k, k) = R_0^i(x \oplus k, y \oplus k)
          </div>
        </div>
      </div>

      <p class="text-gray-300">
        <em>Proof.</em>
      </p>
      <div class="math-block">
        R_0^i(x \oplus k, y \oplus k) = (y \oplus k \oplus (x \oplus k \oplus c_i)^3,\; x \oplus k) = (y \oplus (x \oplus k \oplus c_i)^3,\; x) \oplus (k, k) = R_k^i(x, y) \oplus (k, k)
      </div>

      <div class="formal-block formal-block-theorem">
        <div class="formal-block-title text-green-400">Theorem 1</div>
        <div class="formal-block-content">
          <p class="text-gray-300">
            Let <span class="math">E_k</span> be
            MiMC-2<span class="math">n/n</span> with the key
            <span class="math">k</span>. Then, for all
            <span class="math">x, y, k</span>,
          </p>
          <div class="math-block">
            E_k(x, y) \oplus (k, k) = E_0(x \oplus k, y \oplus k)
          </div>
        </div>
      </div>

      <p class="text-gray-300">
        <em>Proof.</em> By induction over the number of rounds. The
        base case is Lemma 1. If the property holds after
        <span class="math">i - 1</span> rounds, then
      </p>
      <div class="math-block">
        (R_k^&#123;i-1&#125; \circ R_k^&#123;i-2&#125; \cdots \circ R_k^1)(x, y) \oplus (k, k) = (R_0^&#123;i-1&#125; \circ R_0^&#123;i-2&#125; \cdots \circ R_0^1)(x \oplus k, y \oplus k)
      </div>

      <p class="text-gray-300">
        By Lemma 1,
      </p>
      <div class="math-block">
        \begin&#123;aligned&#125;
        &amp;(R_0^i \circ R_0^&#123;i-1&#125; \cdots \circ R_0^1)(x \oplus k, y \oplus k) \\
        &amp;= R_0^i\bigl((R_0^&#123;i-1&#125; \circ R_0^&#123;i-2&#125; \cdots \circ R_0^1)(x \oplus k, y \oplus k)\bigr) \\
        &amp;= R_0^i\bigl((R_k^&#123;i-1&#125; \circ R_k^&#123;i-2&#125; \cdots \circ R_k^1)(x, y) \oplus (k, k)\bigr) \\
        &amp;= (R_k^i \circ R_k^&#123;i-1&#125; \cdots \circ R_k^1)(x, y) \oplus (k, k)
        \end&#123;aligned&#125;
      </div>

      <div class="formal-block formal-block-theorem">
        <div class="formal-block-title text-green-400">Corollary 1</div>
        <div class="formal-block-content">
          <p class="text-gray-300">
            Let <span class="math">E_k</span> be
            MiMC-2<span class="math">n/n</span> with the key
            <span class="math">k</span>. Let
            <span class="math">f(x) = E_k(x, x) \oplus (x, x)</span>
            and
            <span class="math">g(x) = E_0(x, x) \oplus (x, x)</span>.
            Then
            <span class="math">f(x) = g(x \oplus k)</span>.
          </p>
        </div>
      </div>

      <p class="text-gray-300">
        <em>Proof.</em>
      </p>
      <div class="math-block">
        g(x \oplus k) = E_0(x \oplus k, x \oplus k) \oplus (x \oplus k, x \oplus k) = E_k(x, x) \oplus (k, k) \oplus (x \oplus k, x \oplus k)
      </div>
      <div class="math-block">
        = E_k(x, x) \oplus (x, x) = f(x)
      </div>

      <p class="text-gray-300">
        <strong>Key recovery.</strong> The key recovery simply consists
        in looking for a collision between
        <span class="math">f</span> and
        <span class="math">g</span> from Corollary 1, which can be done
        in time <span class="math">2^&#123;n/2&#125;</span> as the two
        functions have an <span class="math">n</span>-bit input. This
        contradicts the claim of <span class="math">n</span> bits of
        security of MiMC-2<span class="math">n/n</span>.
      </p>

      <p class="text-gray-300">
        <strong>Hash function.</strong> MiMC can be used keyless as a
        permutation for a sponge-based hash function. As there is no
        key in this construction, it is unclear how Theorem 1 could be
        used to attack the hash function.
      </p>

      <h3 id="sec-2.2" class="text-xl font-semibold mt-8 mb-3">
        2.2 Attacks on GMiMC
      </h3>
      <p class="text-gray-300">
        In most cases, the same property can be found in univariate
        GMiMC, that is,
        <span class="math">E_k(x_1, \ldots, x_t) \oplus (k, \ldots, k) = E_0(x_1 \oplus k, \ldots, x_t \oplus k)</span>,
        which allows applying the same attack as in the
        MiMC-2<span class="math">n/n</span> case.
      </p>

      <p class="text-gray-300">
        <strong>GMiMC-Nyb and GMiMC-mrf.</strong> One round of
        GMiMC-Nyb and GMiMC-mrf can be seen, up to a permutation of
        the branches, as <span class="math">t</span> Feistel in
        parallel. Hence, the property holds.
      </p>

      <p class="text-gray-300">
        <strong>GMiMC-erf.</strong> The added function only depends on
        one input branch, hence the property also holds.
      </p>

      <p class="text-gray-300">
        <strong>GMiMC-crf.</strong> The function is slightly different
        in that case, as it depends on more than one branch. For the
        property to hold, we must have that
      </p>
      <div class="math-block">
        \left(\left(\bigoplus_&#123;j=2&#125;^&#123;t&#125; x_j\right) \oplus k \oplus c_i\right)^3 = \left(\bigoplus_&#123;j=2&#125;^&#123;t&#125; (x_j \oplus k) \oplus c_i\right)^3
      </div>
      <p class="text-gray-300">
        Hence, the property holds only if
        <span class="math">t</span> is even.
      </p>

      <h3 id="sec-2.3" class="text-xl font-semibold mt-8 mb-3">
        2.3 Variants in Large Characteristics
      </h3>
      <p class="text-gray-300">
        MiMC and GMiMC can also be defined over a finite field of
        large characteristic. In that case, the property we have is
        <span class="math">E_k(x_1, \ldots, x_t) + (k, \ldots, k) = E_0(x_1 + k, \ldots, x_t + k)</span>,
        and the same attack can be applied. The only exception is
        GMiMC-crf, where we need to have
        <span class="math">k + k = 0</span> for the property to hold.
      </p>

      <h3 id="sec-2.4" class="text-xl font-semibold mt-8 mb-3">
        2.4 Quantum Attacks
      </h3>
      <p class="text-gray-300">
        The collision property corresponds to a hidden period, and as
        such, permits a key recovery in
        <span class="math">O(n)</span> quantum queries. With a
        restriction to classical queries, these attacks happen to be in
        a form suitable for the offline Simon&rsquo;s algorithm
        [Bon+19], which allows making a key recovery in
        <span class="math">O(2^&#123;n/3&#125;)</span> classical
        queries and quantum time.
      </p>
    </section>

    <!-- ============================================================ -->
    <!-- 3. CONCLUSION                                                -->
    <!-- ============================================================ -->

    <section id="sec-3" class="mb-10">
      <h2 class="text-2xl font-bold">3. Conclusion</h2>
      <p class="text-gray-300">
        We have shown that MiMC-2<span class="math">n/n</span> and all
        the versions of univariate GMiMC except some instances of
        GMiMC-crf are vulnerable to a collision attack. More generally,
        this demonstrates that using round constants is not enough for a
        key schedule to secure a Feistel or generalized Feistel
        construction.
      </p>
      <p class="text-gray-300">
        This attack does not appear to be applicable to the other MiMC
        construction, MiMC-<span class="math">n/n</span>, nor to the
        hash functions based on any version of MiMC or GMiMC.
      </p>
    </section>

    <!-- ============================================================ -->
    <!-- ACKNOWLEDGEMENTS                                             -->
    <!-- ============================================================ -->

    <section id="acknowledgements" class="mb-10">
      <h2 class="text-2xl font-bold">Acknowledgements</h2>
      <p class="text-gray-300">
        The author would like to thank Chaoyun Li for his presentation
        of MiMC and for suggesting to apply the attack to GMiMC. The
        author would also like to thank the authors of MiMC and GMiMC
        for their comments and discussions on this result. This project
        has received funding from the European Research Council (ERC)
        under the European Union&rsquo;s Horizon 2020 research and
        innovation programme (grant agreement no. 714294 &ndash;
        acronym QUASYModo).
      </p>
    </section>

    <!-- ============================================================ -->
    <!-- REFERENCES                                                   -->
    <!-- ============================================================ -->

    <section id="references" class="mb-10">
      <h2 class="text-2xl font-bold">References</h2>
      <ol class="list-decimal list-inside space-y-2 text-gray-400
        text-sm">
        <li>
          [Alb+16] Martin R. Albrecht et al. &ldquo;MiMC: Efficient
          Encryption and Cryptographic Hashing with Minimal
          Multiplicative Complexity&rdquo;. In: <em>ASIACRYPT 2016,
          Part I</em>. Ed. by Jung Hee Cheon and Tsuyoshi Takagi.
          Vol. 10031. LNCS. Springer, Heidelberg, Dec. 2016,
          pp. 191&ndash;219. doi:
          <a
            href="https://doi.org/10.1007/978-3-662-53887-6_7"
            target="_blank"
            rel="noopener noreferrer"
            class="text-blue-400 hover:text-blue-300"
          >10.1007/978-3-662-53887-6_7</a>.
        </li>
        <li>
          [Alb+19] Martin R. Albrecht et al. &ldquo;Feistel Structures
          for MPC, and More&rdquo;. In: <em>ESORICS 2019</em>. 2019.
        </li>
        <li>
          [BNPS19] Xavier Bonnetain, Mar&iacute;a Naya-Plasencia, and
          Andr&eacute; Schrottenloher. &ldquo;On Quantum Slide
          Attacks&rdquo;. In: <em>SAC 2019</em>. Ed. by Kenneth G.
          Paterson and Douglas Stebila. LNCS. Springer, Heidelberg,
          Aug. 2019.
        </li>
        <li>
          [Bon+19] Xavier Bonnetain et al. &ldquo;Quantum Attacks
          without Superposition Queries: the Offline Simon
          Algorithm&rdquo;. In: <em>ASIACRYPT 2019</em>. Ed. by Steven
          Galbraith and Shiho Moriai. LNCS. Springer, Heidelberg,
          Dec. 2019. url:
          <a
            href="https://eprint.iacr.org/2019/614"
            target="_blank"
            rel="noopener noreferrer"
            class="text-blue-400 hover:text-blue-300"
          >eprint.iacr.org/2019/614</a>.
        </li>
      </ol>
    </section>

  </article>
</BaseLayout>
