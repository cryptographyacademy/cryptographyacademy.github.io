---
import BaseLayout from '../../layouts/BaseLayout.astro';
import PaperDisclaimer from '../../components/PaperDisclaimer.astro';
import PaperHistory from '../../components/PaperHistory.astro';

const EPRINT_URL = 'https://eprint.iacr.org/2020/820';
const CRAWLER = 'marker';
const CONVERTED_DATE = '2026-02-16';
const TITLE_HTML = 'On the security of the Rescue hash function';
const AUTHORS_HTML = 'Tim Beyne, Anne Canteaut, Gregor Leander, Mar&iacute;a Naya-Plasencia, L&eacute;o Perrin, Friedrich Wiemer';

const CONTENT = `    <section id="abstract" class="mb-10">
      <h2 class="text-2xl font-bold">Abstract</h2>
      <p class="text-gray-300">In this report, we cryptanalyse the Rescue hash function. In particular, we look at linear and differential cryptanalysis of Rescue, how multiplicative subgroups are propagated by the round function and at rebound attacks. Overall, we do not find any direct threat to the security of Rescue.</p>
      <p class="text-gray-300"><strong>Keywords:</strong> Rescue &middot; Algebraic optimised &middot; Linear Cryptanalysis &middot; Differential Cryptanalysis &middot; Multiplicative Subgroups &middot; Rebound Attacks</p>
    </section>

      <h4 id="sec-4.1.1" class="text-lg font-semibold mt-6"><strong>4.1.1 Two-round MEDP</strong></h4>

    <p class="text-gray-300">A first result is that the classical upper bound on the MEDP from <a href="#page-30-10">[11]</a> and <a href="#page-30-11">[7,</a> Section B.2] can be adapted to fields of any characteristic and to the case where the two S-box layers are different (but here with the same differential uniformity).</p>

    <p class="text-gray-300">This result, applied to the case of Rescue over F<em><sup>p</sup></em> leads to the following.</p>

    <p class="text-gray-300"><strong>Proposition 5.</strong> The MEDP of two rounds of Rescue operating on F <em>m <sup>p</sup></em> with an S-box layer with differential uniformity <em>&delta;</em>(<em>S</em>) and an MDS linear layer satisfies</p>

    <p class="text-gray-300"><span class="math">$\\mathsf{MEDP}_2 \\leqslant \\left(\\frac{\\delta(S)}{p}\\right)^m\\,.</span>$</p>

    <p class="text-gray-300">In the specific case of Rescue, the S-box has differential uniformity 2, which leads to</p>

    <p class="text-gray-300"><span class="math">$\\mathsf{MEDP}_2 \\leqslant \\left(\\frac{2}{p}\\right)^m</span>$
.</p>

    <p class="text-gray-300">However, the MEDP is the highest probability of a differential, among all differentials averaged over the round key (or round constant). This may be very different from the maximal differential probability with a fixed key.</p>

    <p class="text-gray-300">We can try to compute the probability of the differentials of minimal weight, as in <a href="#page-30-9">[5]</a>. However, the same technique based on linear algebra does not work at all, since the values satisfying a differential for the S-box do not form an F<em>p</em>-linear space here, while they form an F2-linear space in characteristic 2. Instead we look at fixed-key differentials experimentally next.</p>

      <h4 id="sec-4.1.2" class="text-lg font-semibold mt-6"><strong>4.1.2 Differential unformity distributions for two rounds and toy sizes</strong></h4>

    <p class="text-gray-300">The MDS matrices used here are given in Table <a href="#page-10-0">1,</a> the distributions of the differential uniformity, see Table <a href="#page-11-0">2,</a> are discussed in the following paragraphs.</p>

    <p class="text-gray-300"><em>p</em> <strong>= 11 and</strong> <em>m</em> <strong>= 3.</strong> The two-round MEDP is equal to 7<em>.</em>36 &times; 11&minus;<sup>3</sup> , which is close to the upper bound of Proposition <a href="#page-9-1">5.</a> However, for all values of the key, the differential uniformity is higher than the <em>p <sup>m</sup></em> MEDP, as shown in the top part of Table <a href="#page-11-0">2.</a></p>

    <p class="text-gray-300">The highest differential uniformity (41) is obtained for the all-zero key, for which some simple symmetries affect the result. For instance, in this case,</p>

    <p class="text-gray-300"><span class="math">$E(\\lambda x_0, \\dots, \\lambda x_{m-1}) = \\lambda E(x_0, \\dots, x_{m-1}), \\quad \\forall \\lambda \\in \\mathbb{F}_p^*</span>$</p>

    <p class="text-gray-300">It follows that,</p>

    <p class="text-gray-300"><span class="math">$E(x+a) - E(x) = E(a)</span>$</p>

    <p class="text-gray-300">has at least <em>p</em> solutions: 0, <em>a</em>, and all inputs (<em>&lambda;a</em>0<em>, . . . , &lambda;am</em>&minus;1).</p>

    <p class="text-gray-300"><em>p</em> <strong>= 17 and</strong> <em>m</em> <strong>= 3.</strong> The differential uniformities obtained for the different values of the key are given in the middle part of Table <a href="#page-11-0">2.</a> Again the two-round MEDP is very close to the upper bound: it equals 7<em>.</em>59 &times; 17<sup>&minus;</sup><sup>3</sup> .</p>

    <p class="text-gray-300">Again, the highest value of the differential uniformity is obtained for the all-zero key only. And the differential uniformity is always higher that the MEDP &times; <em>p m</em>.</p>

    <p class="text-gray-300"><em>p</em> <strong>= 41 and</strong> <em>m</em> <strong>= 2.</strong> The distribution for the differential uniformity when the round key varies is given in the bottom part of Table <a href="#page-11-0">2.</a></p>

      <h4 id="sec-4.1.3" class="text-lg font-semibold mt-6"><strong>4.1.3 Analysis of some minimal-weight differentials</strong></h4>

    <p class="text-gray-300">We now focus on the case where the S-box is defined by <em>d</em> = 3. The following proposition shows that, for any MDS matrix, there always exist round keys such that two rounds have differential uniformity at least <em>p</em>. It is based on the analysis of the number of inputs satisfying some differentials of minimal weight.</p>

    <p class="text-gray-300"><strong>Proposition 6.</strong> Let <em>M</em> denote the MDS matrix and (<em>K</em>0<em>, . . . , Km</em>&minus;1) &isin; F <em>m p</em> the round key. For all round-keys such that (<em>K</em>0<em>, . . . , Km</em>&minus;1) or</p>

    <p class="text-gray-300"><span class="math">$M^{-1} \\begin{pmatrix} K_0 \\\\ \\dots \\\\ K_{m-1} \\end{pmatrix}</span>$</p>

    <p class="text-gray-300">has weight at most (<em>m</em> &minus; 1), the function corresponding to two rounds of Rescue has differential uniformity at least <em>p</em>.</p>

    <p class="text-gray-300">Moreover, for all round-keys such that both (<em>K</em>0<em>, . . . , Km</em>&minus;1) and</p>

    <p class="text-gray-300"><span class="math">$M^{-1} \\begin{pmatrix} K_0 \\\\ \\dots \\\\ K_{m-1} \\end{pmatrix}</span>$</p>

    <p class="text-gray-300">have weight <em>m</em>, all differentials of weight (<em>m</em> + 1) such that either the input difference or the difference after the second S-box layer has weight 1 are satisfied for at most 2 <em><sup>m</sup></em>+2 inputs.</p>

    <p class="text-gray-300">Proof. Let us consider two rounds of Rescue without the last linear layer, which does not influence the differential uniformity. Let us first focus on differentials such that the input difference has weight 1. The case of an output difference with weight 1 is similar by using that the inverse of the two rounds (without the last linear layer)</p>

    <p class="text-gray-300">Table 1: MDS matrices for some toy parameters used to compute the differential uniformity distributions over two rounds.</p>

    <p class="text-gray-300"><span class="math">$(p,m) \\qquad (11,3) \\qquad (17,3) \\qquad (41,2)</span>$</p>

    <p class="text-gray-300"><span class="math">$M \\qquad \\begin{pmatrix} 7 &amp; 3 &amp; 10 \\\\ 2 &amp; 6 &amp; 7 \\\\ 1 &amp; 7 &amp; 4 \\end{pmatrix} \\qquad \\begin{pmatrix} 6 &amp; 1 &amp; 7 \\\\ 13 &amp; 9 &amp; 3 \\\\ 11 &amp; 10 &amp; 16 \\end{pmatrix} \\qquad \\begin{pmatrix} 24 &amp; 15 \\\\ 15 &amp; 37 \\end{pmatrix}</span>$</p>

    <div class="overflow-x-auto my-4">
      <table class="min-w-full text-sm text-gray-300">
        <thead>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">&delta;</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">10</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">11</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">21</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">30</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">41</th>
        </thead>
        <tbody>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">#keys</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">190</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">330</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">780</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">30</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">&delta;</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">13</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">17</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">33</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">35</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">37</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">#keys</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1680</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">2400</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">816</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">16</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">&delta;</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">8</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">9</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">10</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">41</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">#keys</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">320</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1120</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">80</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">161</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
        </tbody>
      </table>
    </div>

    <p class="text-gray-300">Table 2: Differential uniformity for Rescue with <em>p</em> = 11 and <em>m</em> = 3 (top), <em>p</em> = 17 and <em>m</em> = 3 (middle), and <em>p</em> = 41 and <em>m</em> = 2 (bottom) for all possible values of the round key.</p>

    <p class="text-gray-300">with matrix <em>M</em> and key <em>K</em> is equal to the encryption function with matrix <em>M</em><sup>&minus;</sup><sup>1</sup> and key <em>M</em><sup>&minus;</sup><sup>1</sup><em>K</em>.</p>

    <p class="text-gray-300">Also, without loss of generality, we will assume that the active element in the input difference is the last one, i. e., the input difference has the form (0<em>, . . . ,</em> 0<em>, &alpha;</em>), <em>&alpha;</em> &isin; F<em>p</em>. Let (<em>&beta;</em>0<em>, . . . , &beta;m</em>&minus;1) denote the output difference. Obviously, the difference after the first S-box layer has the form (0<em>, . . . ,</em> 0<em>, &lambda;</em>), and the difference after the linear layer is (<em>a</em>0<em>,m</em>&minus;1<em>&lambda;, . . . , am</em>&minus;1<em>,m</em>&minus;1<em>&lambda;</em>) where <em>ai,j</em> denote the entries of <em>M</em>, 0 6 <em>i, j &lt; m</em>. We then consider an input satisfying this differential and denote by (<em>c</em>0<em>, . . . , cm</em>&minus;2<em>, z</em>) its image after the first S-box layer. Then, this value satisfies the differential if and only if there exists <em>&lambda;</em> &isin; F &lowast; <em>p</em> such that</p>

    <p class="text-gray-300"><span class="math">$(z+\\lambda)^3 - z^3 = \\alpha</span>$</p>

    <p class="text-gray-300"><span class="math">$(a_{0,m-1}z + a_{0,m-1}\\lambda + \\gamma_0)^3 - (a_{0,m-1}z + \\gamma_0)^3 = \\beta_0</span>$</p>

    <p class="text-gray-300"><span class="math">$(a_{1,m-1}z + a_{1,m-1}\\lambda + \\gamma_1)^3 - (a_{1,m-1}z + \\gamma_1)^3 = \\beta_1</span>$</p>

    <p class="text-gray-300"><span class="math">$\\cdots</span>$</p>

    <p class="text-gray-300"><span class="math">$(a_{m-1,m-1}z + a_{m-1,m-1}\\lambda + \\gamma_{m-1})^3 - (a_{m-1,m-1}z + \\gamma_{m-1})^3 = \\beta_{m-1}</span>$</p>

    <p class="text-gray-300">where <em>&gamma;<sup>i</sup></em> = P<em>t</em>&minus;<sup>2</sup> <em><sup>j</sup></em>=0 <em>ai,j c<sup>j</sup></em> + <em>K<sup>i</sup></em> . Each equation corresponding to an S-box in the second S-box layer can then be rewritten as</p>

    <p class="text-gray-300"><span class="math">$(z + \\lambda + \\gamma_i&#x27;)^3 - (z + \\gamma_i&#x27;)^3 = \\beta_i&#x27;</span>$</p>

    <p class="text-gray-300">where</p>

    <p class="text-gray-300"><span class="math">$\\beta_i&#x27; = \\beta_i (a_{i,m-1})^{-3} \\quad \\text{and} \\quad \\gamma_i&#x27; = a_{i,m-1}^{-1} \\left( \\sum_{j=0}^{m-2} a_{i,j} c_j + K_i \\right) \\; .</span>$</p>

    <p class="text-gray-300">We now need to count the number of tuples (<em>c</em>0<em>, . . . , cm</em>&minus;2<em>, z, &lambda;</em>) satisfying this system of (<em>m</em> + 1) non-trivial equations.</p>

    <p class="text-gray-300">&bull; A first particular case is when all <em>&gamma;</em> 0 <em><sup>i</sup></em> = 0, which means that the left-hand terms of all these equations are the same. Then, the system has solutions only if the right-hand terms are equal, i. e.</p>

    <p class="text-gray-300"><span class="math">$\\alpha = \\beta_0&#x27; = \\ldots = \\beta_{t-1}&#x27;.</span>$</p>

    <p class="text-gray-300">In this case, all the <em>p</em> pairs (<em>z, &lambda;</em>) such that (<em>z</em> + <em>&lambda;</em>) <sup>3</sup> &minus; <em>z</em> <sup>3</sup> = <em>&alpha;</em> satisfy the system. The fact that all <em>&gamma;</em> 0 <em><sup>i</sup></em> = 0 is equivalent to</p>

    <p class="text-gray-300"><span class="math">$K_i = -\\sum_{j=0}^{m-2} a_{i,j} c_j , \\quad \\forall 0 \\leqslant i &lt; m</span>$</p>

    <p class="text-gray-300">or equivalently</p>

    <p class="text-gray-300"><span class="math">$\\begin{pmatrix} K_0 \\\\ \\dots \\\\ K_{t-1} \\end{pmatrix} = -M \\begin{pmatrix} c_0 \\\\ \\dots \\\\ c_{t-2} \\\\ 0 \\end{pmatrix}</span>$</p>

    <p class="text-gray-300">This condition means that <em>M</em><sup>&minus;</sup><sup>1</sup><em>K</em> has a zero in its last position. And for each such key, (<em>c</em>0<em>, . . . , cm</em>&minus;2) is uniquely determined, which means that the differential is satisfied by exactly <em>p</em> inputs.</p>

    <p class="text-gray-300">&bull; Let us now assume that <em>&gamma;</em> 0 <em>i</em> 6= 0 for at least one integer 0 6 <em>i &lt; m</em>. Then <em>z</em> and <em>&lambda;</em> are solutions of the two equations</p>

    <p class="text-gray-300"><span class="math">$3\\lambda z^2 + 3\\lambda^2 z + \\lambda^3 = \\alpha</span>$
<span class="math">$3\\lambda (z + \\gamma_i&#x27;)^2 + 3\\lambda^2 (z + \\gamma_i&#x27;) + \\lambda^3 = \\beta_i&#x27;.</span>$</p>

    <p class="text-gray-300">The difference between the second equation and the first one corresponds to</p>

    <p class="text-gray-300">
<span class="math">$6\\gamma_i&#x27;\\lambda z = \\beta_i&#x27; - \\alpha - 3\\lambda^2 \\gamma_i&#x27; - 3\\lambda(\\gamma_i&#x27;)^2 \\tag{1}</span>$</p>

    <p class="text-gray-300">that is</p>

    <p class="text-gray-300">
<span class="math">$z = \\frac{\\beta_i&#x27; - \\alpha}{6\\gamma_i&#x27;\\lambda} - \\frac{1}{2}\\lambda - \\frac{1}{2}\\gamma_i&#x27;. \\tag{2}</span>$</p>

    <p class="text-gray-300">By replacing <em>z</em> by this value in the first equation of the system, we get</p>

    <p class="text-gray-300"><span class="math">$\\left( \\frac{\\beta_i&#x27; - \\alpha}{6\\gamma_i&#x27; \\lambda} + \\frac{1}{2}\\lambda - \\frac{1}{2}\\gamma_i&#x27; \\right)^3 - \\left( \\frac{\\beta_i&#x27; - \\alpha}{6\\gamma_i \\lambda} - \\frac{1}{2}\\lambda - \\frac{1}{2}\\gamma_i&#x27; \\right)^3 = \\alpha .</span>$</p>

    <p class="text-gray-300">By expanding this relation, we get</p>

    <p class="text-gray-300"><span class="math">$\\frac{1}{4}\\lambda^3 + \\frac{3(\\gamma_i&#x27;)^2}{4} + \\frac{\\beta_i&#x27; - \\alpha}{2} + \\frac{(\\beta_i&#x27; - \\alpha)^2}{12(\\gamma_i&#x27;)^2\\lambda} = \\alpha</span>$</p>

    <p class="text-gray-300">which is an equation of degree 4 in <em>&lambda;</em> and has then at most 4 solutions. For each such solution <em>&lambda;</em>, the corresponding value of <em>z</em> is uniquely determined by Eq. <a href="#page-12-0">(2)</a>. Now, for each (<em>&lambda;, z</em>), the nonzero <em>&gamma;</em> 0 <em><sup>j</sup></em> has to satisfy a quadratic equation of the form Eq. <a href="#page-12-1">(1)</a>, implying that it can take at most two values. For each (<em>&lambda;, z</em>), there are then a total of at most 2 <em><sup>m</sup></em> values of (<em>&gamma;</em> 0 0 <em>, . . . , &gamma;</em><sup>0</sup> <em>m</em>&minus;1 ), leading to the same number of values for (<em>c</em>0<em>, . . . , cm</em>&minus;2). Therefore, the total number of values satisfying the differential is at most 2 <em>m</em>+2 .</p>

    <p class="text-gray-300">Now, by changing the position of the active S-box within the first S-box layer, we get that the differential has <em>p</em> solutions when the <em>M</em><sup>&minus;</sup><sup>1</sup><em>K</em> has weight strictly less than <em>m</em>. When exchanging the role of the input and output differences, the same condition applies to <em>M</em>(<em>M</em><sup>&minus;</sup><sup>1</sup><em>K</em>) = <em>K</em>.</p>

    <p class="text-gray-300">Listing <a href="#page-31-1">1</a> gives SageMath code to check this property for a given set of round constants and a given MDS matrix. It is worth observing that the existence of round keys for which two rounds have differential uniformity <em>p</em> comes from the fact that the two S-box layers use two S-boxes which are the inverse of each other. When the second S-box layer also uses <em>x</em> 1<em>/</em>3 , it seems that the highest differential uniformity is always lower than <em>p</em>. For instance, for <em>p</em> = 41 and <em>m</em> = 2, it is at most equal to 10.</p>

    <div class="overflow-x-auto my-4">
      <table class="min-w-full text-sm text-gray-300">
        <thead>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">&delta;</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">6</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">7</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">8</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">9</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">10</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">11</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">12</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">17</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">18</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">19</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">20</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">21</th>
        </thead>
        <tbody>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">nb</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">2748</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">51217</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">25458</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">3736</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">303</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">36</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">3</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">0</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">2</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">16</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">%</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">3.3</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">61.3</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">30.5</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">4.5</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">0.4</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">0.04</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">_</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">_</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">_</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">_</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">0.02</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">_</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">nb</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">2519</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">50199</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">26167</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">4139</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">405</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">54</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">3</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">0</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">33</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">0</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">%</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">3</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">60.1</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">31.3</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">4.9</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">0.5</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">0.06</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">_</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">_</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">_</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">0.04</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">_</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">_</td>
          </tr>
        </tbody>
      </table>
    </div>

    <p class="text-gray-300">Table 3: Distributions of differential uniformity for four rounds, p=17, m=2, and all keys starting with  <span class="math">K_0=(7,8)</span>  (top) and  <span class="math">K_0=(3,8)</span>  (bottom). The gray colored columns denote differential uniformities greater than or equal to p.</p>

      <h3 id="sec-4.2" class="text-xl font-semibold mt-8">4.2 Four-round differentials and weak round-keys</h3>

    <p class="text-gray-300">In the following, we consider several rounds with independent round-keys (i. e., we do not use the key-schedule defined for the Rescue block cipher or the round-constant generation process used in the StarkWare challenges to generate the round-keys).</p>

    <p class="text-gray-300">Simulation results for m=2 show that there is a small proportion of round keys for which the differential uniformity of four rounds exceeds p. For instance, for p=17, m=2 and the MDS matrix</p>

    <p class="text-gray-300"><span class="math">$\\left(\\begin{array}{cc} 16 &amp; 12 \\\\ 6 &amp; 11 \\end{array}\\right),\\,</span>$</p>

    <p class="text-gray-300">we performed an exhaustive search for all keys  <span class="math">(K_1,K_2)</span>  used in the second and third rounds, for two fixed values of the first-round key  <span class="math">K_0</span> , namely  <span class="math">K_0=(7,8)</span>  and  <span class="math">K_0=(3,8)</span> . We then find the distributions for the differential uniformity of the four-round function given in Table 3.</p>

    <p class="text-gray-300">The differential uniformity of the four-round function then seems to follow the expected distribution and takes its value in the range [6-11], except for a small proportion of keys for which it is much higher than expected. Similar results are obtained for p=41, where we obtain a few keys for which the differential uniformity exceeds 41.</p>

    <p class="text-gray-300">We then try to understand whether this fact is due to the use of weak MDS matrices, or whether weak round keys exist for any choice of the MDS matrix.</p>

    <p class="text-gray-300">We here exhibit round-key sequences for which four rounds have always differential uniformity at least p. Such round keys exist for any choice of the MDS layer and independently of the exponent chosen for the power permutation used in the S-box. This property originates from the fact that the S-box is a monomial permutation.</p>

    <p class="text-gray-300">In the following, we denote by  <span class="math">G_{r,d}</span>  the function corresponding to r rounds of encryption without the last linear layer, where the S-box used in the first S-box layer is  <span class="math">x^d</span> . We first show that the multiplication of all inputs by  <span class="math">\\lambda \\in \\mathbb{F}_p</span>  may be preserved by two rounds of encryption when the key does not have weight m.</p>

    <p class="text-gray-300"><strong>Proposition 7.</strong> (Two-round multiplicative property) Let  <span class="math">G_{2,d}</span>  be two rounds of Rescue operating on  <span class="math">\\mathbb{F}_p^m</span>  and let  <span class="math">(K_0,\\ldots,K_{m-1})</span>  denote the round-key. Let  <span class="math">\\alpha\\in\\mathbb{F}_p^m</span>  and S denote the support of</p>

    <p class="text-gray-300"><span class="math">$M\\begin{pmatrix} \\alpha_0^d \\\\ \\dots \\\\ \\alpha_{m-1}^d \\end{pmatrix}</span>$
.</p>

    <p class="text-gray-300">Then, for any key such that  <span class="math">K_i = 0</span>  for all  <span class="math">i \\in S</span> , there exists  <span class="math">\\beta \\in \\mathbb{F}_p^m</span>  with  <span class="math">\\mathsf{Supp}(\\beta) = S</span>  such that, for all  <span class="math">\\lambda \\in \\mathbb{F}_p</span> ,</p>

    <p class="text-gray-300"><span class="math">$G_{2,d}(\\lambda \\alpha_0, \\dots, \\lambda \\alpha_{m-1}) - G(0, \\dots, 0) = (\\lambda \\beta_0, \\dots, \\lambda \\beta_{m-1})</span>$
.</p>

    <p class="text-gray-300"><em>Proof.</em> Let  <span class="math">(y_0, \\ldots, y_{m-1})</span>  denote the image of  <span class="math">(\\lambda \\alpha_0, \\ldots, \\lambda \\alpha_{m-1})</span>  after the key addition. We have that</p>

    <p class="text-gray-300"><span class="math">$y_i = \\lambda^d \\sum_{j=0}^{m-1} a_{i,j} \\alpha_j^d + K_i, \\quad \\forall 0 \\leqslant i &lt; m.</span>$</p>

    <p class="text-gray-300">If  <span class="math">i \\notin S</span> ,  <span class="math">\\sum_{j=0}^{m-1} a_{i,j} \\alpha_j^d = 0</span>  by definition of S. Then,  <span class="math">y_i = K_i</span> . If  <span class="math">i \\in S</span> ,  <span class="math">K_i = 0</span> , implying that  <span class="math">y_i = \\lambda^d \\delta_i</span>  for some constant  <span class="math">\\delta_i</span> . It follows that  <span class="math">z = G_{2,d}(\\lambda \\alpha_0, \\ldots, \\lambda \\alpha_{m-1})</span>  satisfies</p>

    <p class="text-gray-300"><span class="math">$z_i = \\begin{cases} K_i^{1/d} &amp; \\text{if } i \\notin S \\\\ \\lambda \\delta_i^{1/d} &amp; \\text{if } i \\in S \\end{cases}.</span>$</p>

    <p class="text-gray-300">Let  <span class="math">\\beta_i = \\delta_i^{1/d}</span>  for  <span class="math">i \\in S</span>  and  <span class="math">\\beta_i = 0</span>  for  <span class="math">i \\notin S</span> . Then, we have that</p>

    <p class="text-gray-300"><span class="math">$G_{2,d}(\\lambda \\alpha_0, \\dots, \\lambda \\alpha_{m-1}) - G(0, \\dots, 0) = (\\lambda \\beta_0, \\dots, \\lambda \\beta_{m-1})</span>$
.</p>

    <p class="text-gray-300">It is worth noticing that the proposition proves the property only for keys of weight strictly less than m, and that a non-trivial value  <span class="math">\\alpha</span>  can be found for any such key. As an easy corollary (which does not help for the 4-round property), we observe that such a multiplicative property may propagate over three rounds.</p>

    <p class="text-gray-300"><strong>Corollary 1.</strong> (Three-round multiplicative property) Let  <span class="math">G_{3,d}</span>  be three rounds of Rescue operating on  <span class="math">\\mathbb{F}_p^m</span>  and let  <span class="math">K_r = (K_{r,0}, \\ldots, K_{r,m-1})</span>  denote the key at round r. Let  <span class="math">\\alpha \\in \\mathbb{F}_p^m</span>  and S denote the support of</p>

    <p class="text-gray-300"><span class="math">$M\\begin{pmatrix} \\alpha_0^d \\\\ \\dots \\\\ \\alpha_{m-1}^d \\end{pmatrix}</span>$
.</p>

    <p class="text-gray-300">Then, for any  <span class="math">K_0</span>  such that  <span class="math">K_{0,i}=0</span>  for all  <span class="math">i\\in S</span> , there exist  <span class="math">K_1</span>  and  <span class="math">\\beta\\in\\mathbb{F}_p^m</span>  such that, for all  <span class="math">\\lambda\\in\\mathbb{F}_p</span> ,</p>

    <p class="text-gray-300"><span class="math">$G_{3,d}(\\lambda \\alpha) = \\lambda^d \\beta</span>$
.</p>

    <p class="text-gray-300"><em>Proof.</em> Let  <span class="math">(x_0,\\ldots,x_{m-1})</span>  denote the image of  <span class="math">(\\lambda\\alpha_0,\\ldots,\\lambda\\alpha_{m-1})</span>  under  <span class="math">G_{2,d}</span> . Then, as proved in the previous proposition, there exists  <span class="math">\\delta\\in\\mathbb{F}_p^m</span>  such that</p>

    <p class="text-gray-300"><span class="math">$x_i = \\begin{cases} K_{0,i}^{1/d} &amp; \\text{if } i \\notin S \\\\ \\lambda \\delta_i &amp; \\text{if } i \\in S \\end{cases}</span>$</p>

    <p class="text-gray-300">for some constants  <span class="math">\\delta_i, i \\in S</span> . Let  <span class="math">(z_0, \\dots, z_{m-1})</span>  denote the corresponding value after the addition of  <span class="math">K_1</span> . Then</p>

    <p class="text-gray-300"><span class="math">$z_i = \\lambda \\sum_{j \\in S} a_{i,j} \\delta_j + \\sum_{j \\notin S} a_{i,j} K_{0,j}^{1/d} + K_{1,i}</span>$
.</p>

    <p class="text-gray-300">Then, for the round key  <span class="math">K_1</span>  defined by</p>

    <p class="text-gray-300"><span class="math">$K_{1,i} = -\\sum_{j \\notin S} a_{i,j} K_{0,j}^{1/d} ,</span>$</p>

    <p class="text-gray-300">we have that, for any i,  <span class="math">z_i = \\lambda \\gamma_i</span>  for some constant  <span class="math">\\gamma_i</span> . It follows that the i-th coordinate of  <span class="math">G_{3,d}(\\lambda \\alpha_0, \\ldots, \\lambda \\alpha_{m-1})</span>  equals  <span class="math">\\lambda^d \\gamma_i^d</span> .</p>

    <p class="text-gray-300">Now, we focus on another multiplicative property over three rounds, resulting from Proposition 7 which can be used for exhibiting 4-round differentials.</p>

    <p class="text-gray-300"><strong>Lemma 1.</strong> Let  <span class="math">G_{3,d}</span>  be three rounds of Rescue operating on  <span class="math">\\mathbb{F}_p^m</span>  and let  <span class="math">K_r = (K_{r,0},\\ldots,K_{r,m-1})</span>  denote the key at round r. Let  <span class="math">\\alpha \\in \\mathbb{F}_p^m</span>  and S denote the support of</p>

    <p class="text-gray-300"><span class="math">$M\\begin{pmatrix} \\alpha_0^d \\\\ \\dots \\\\ \\alpha_{m-1}^d \\end{pmatrix} .</span>$</p>

    <p class="text-gray-300">Then, for any  <span class="math">K_0</span>  such that  <span class="math">K_{0,i}=0</span>  for all  <span class="math">i\\in S</span>  and for any  <span class="math">\\lambda_0\\in\\mathbb{F}_p</span>  there exist  <span class="math">K_1</span>  and  <span class="math">\\beta\\in\\mathbb{F}_p^m</span>  such that, for all  <span class="math">\\lambda\\in\\mathbb{F}_p</span> ,</p>

    <p class="text-gray-300"><span class="math">$G_{3,d}(\\lambda\\alpha) - G_{3,d}(0,\\ldots,0) = \\left[ (\\lambda + \\lambda_0)^d - \\lambda_0^d \\right] \\beta</span>$
.</p>

    <p class="text-gray-300"><em>Proof.</em> We denote by z the image of  <span class="math">\\lambda \\alpha</span>  after the addition of the second round-key  <span class="math">K_1</span> . As observed in the previous proof,</p>

    <p class="text-gray-300"><span class="math">$z_i = \\lambda \\sum_{j \\in S} a_{i,j} \\delta_j + \\sum_{j \\notin S} a_{i,j} K_{0,j}^{1/d} + K_{1,i}</span>$
.</p>

    <p class="text-gray-300">Then, by choosing</p>

    <p class="text-gray-300"><span class="math">$K_{1,i} = \\lambda_0 \\sum_{j \\in S} a_{i,j} \\delta_j - \\sum_{j \\notin S} a_{i,j} K_{0,j}^{1/d}, \\quad \\forall i</span>$</p>

    <p class="text-gray-300">we get</p>

    <p class="text-gray-300"><span class="math">$z_i = (\\lambda + \\lambda_0) \\sum_{j \\in S} a_{i,j} \\delta_j .</span>$</p>

    <p class="text-gray-300">It follows that the <em>i</em>-th coordinate of  <span class="math">G_{3,d}(\\lambda \\alpha)</span>  is</p>

    <p class="text-gray-300"><span class="math">$(\\lambda + \\lambda_0)^d \\left( \\sum_{j \\in S} a_{i,j} \\delta_j \\right)^d .</span>$</p>

    <p class="text-gray-300">Then, the <em>i</em>-coordinate of  <span class="math">G_{3,d}(\\lambda \\alpha) - G(0,\\ldots,0)</span>  is</p>

    <p class="text-gray-300"><span class="math">$((\\lambda + \\lambda_0)^d - \\lambda_0^d)\\beta_i</span>$
with  <span class="math">\\beta_i = \\left(\\sum_{j \\in S} a_{i,j}\\delta_j\\right)^d</span> .</p>

    <p class="text-gray-300">Now, for obtaining a differential satisfied for p inputs when the keys satisfy the conditions exhibited in Lemma 1, we only have to exhibit a difference  <span class="math">\\delta \\in \\mathbb{F}_p^m</span>  and a set of inputs of the form  <span class="math">(x_0 + \\mu \\delta, \\mu \\in \\mathbb{F}_p)</span>  which are transformed after a single round into values of the form  <span class="math">\\{(\\mu^{1/d} - \\mu_0^{1/d})\\alpha, \\mu \\in \\mathbb{F}_p\\}</span>  for some  <span class="math">\\alpha \\in \\mathbb{F}_p^m</span>  and some  <span class="math">\\mu_0 \\in \\mathbb{F}_p</span> .</p>

    <p class="text-gray-300"><strong>Proposition 8.</strong> (Four-round multiplicative property) Let  <span class="math">G_{4,1/d}</span>  be four rounds of Rescue operating on  <span class="math">\\mathbb{F}_p^m</span>  and let  <span class="math">K_r</span>  denote the key at round r.</p>

    <p class="text-gray-300">Then, for any  <span class="math">K_0</span> , there is at least one  <span class="math">(K_1,K_2)</span>  such that there exist  <span class="math">x\\in\\mathbb{F}_p^m</span> ,  <span class="math">\\delta\\in\\mathbb{F}_p^m</span>  with  <span class="math">\\mathrm{wt}(\\delta)=1</span>  and  <span class="math">\\beta\\in\\mathbb{F}_p^m</span>  for which</p>

    <p class="text-gray-300"><span class="math">$G_{4.1/d}(x + \\mu \\delta) - G_{4.1/d}(x) = \\mu \\beta</span>$
.</p>

    <p class="text-gray-300">It follows that, for these keys, the differential  <span class="math">(\\delta, \\beta)</span>  is satisfied by at least p inputs, namely all  <span class="math">x + \\mu \\delta, \\mu \\in \\mathbb{F}_p</span> .</p>

    <p class="text-gray-300"><em>Proof.</em> Let  <span class="math">\\delta \\in \\mathbb{F}_p^m</span>  of weight 1 and  <span class="math">\\ell</span>  denote the nonzero position of  <span class="math">\\delta</span> . Let  <span class="math">x \\in \\mathbb{F}_p^m</span>  such that  <span class="math">x_{\\ell} = 0</span> . We denote by y the image of  <span class="math">x + \\mu \\delta</span>  after the first round. Then we have</p>

    <p class="text-gray-300"><span class="math">$y_i = \\sum_{j \\neq \\ell} a_{i,j} x_j^{1/d} + a_{i,\\ell} \\mu^{1/d} \\delta_{\\ell}^{1/d} + K_{0,i}</span>$
.</p>

    <p class="text-gray-300">If we choose x,  <span class="math">\\mu_0</span>  and  <span class="math">\\delta_\\ell</span>  such that</p>

    <p class="text-gray-300"><span class="math">$\\begin{pmatrix} x_0^{1/d} \\\\ x_1^{1/d} \\\\ \\dots \\\\ \\mu_0^{1/d} \\delta_\\ell^{1/d} \\\\ x_{m-1}^{1/d} \\end{pmatrix} = -M^{-1} \\begin{pmatrix} K_{0,0} \\\\ K_{0,1} \\\\ \\dots \\\\ K_{0,m-2} \\\\ K_{0,m-1} \\end{pmatrix} ,</span>$</p>

    <p class="text-gray-300">we obtain that, for all i,  <span class="math">0 \\le i &lt; m</span> ,</p>

    <p class="text-gray-300"><span class="math">$y_i = a_{i,\\ell} \\delta_{\\ell}^{1/d} \\lambda</span>$
where  <span class="math">\\lambda = (\\mu^{1/d} - \\mu_0^{1/d})</span> .</p>

    <p class="text-gray-300">Then, for these choices of x,  <span class="math">\\delta</span>  and  <span class="math">\\mu_0</span> , we have that the image of  <span class="math">(x + \\mu \\delta)</span>  for  <span class="math">\\mu \\in \\mathbb{F}_p</span>  by</p>

    <p class="text-gray-300">the first round can be written as  <span class="math">(\\mu^{1/d} - \\mu_0^{1/d})\\alpha</span>  for  <span class="math">\\alpha = (a_{0,\\ell}\\delta_\\ell^{1/d}, \\dots, a_{m-1,\\ell}\\delta_\\ell^{1/d})</span> . From Lemma 1 applied with  <span class="math">\\lambda_0 = \\mu_0^{1/d}</span> , we deduce that, if  <span class="math">K_1</span>  vanishes on the support of</p>

    <p class="text-gray-300"><span class="math">$M\\begin{pmatrix} \\alpha_0^d \\\\ \\dots \\\\ \\alpha_{m-1}^d \\end{pmatrix}</span>$
,</p>

    <p class="text-gray-300">there exist  <span class="math">K_2</span>  and  <span class="math">\\beta</span>  such that, for all  <span class="math">\\mu \\in \\mathbb{F}_p</span> ,</p>

    <p class="text-gray-300"><span class="math">$G_{4,1/d}(x + \\mu \\delta) = G_{3,d}(\\lambda \\alpha)</span>$</p>

    <p class="text-gray-300">=  <span class="math">G_{3,d}(0, \\dots, 0) + [(\\lambda + \\lambda_0)^d - \\lambda_0^d] \\beta</span>
=  <span class="math">G_{3,d}(0, \\dots, 0) + [\\mu - \\mu_0] \\beta</span> .</p>

    <p class="text-gray-300">Using that  <span class="math">G_{4,1/d}(x) = G_{3,d}(0,\\ldots,0) - \\mu_0\\beta</span> , we deduce that</p>

    <p class="text-gray-300"><span class="math">$G_{4.1/d}(x + \\mu \\delta) - G_{4.1/d}(x) = \\mu \\beta</span>$
.</p>

    <p class="text-gray-300">Moreover, it follows that, for any  <span class="math">\\mu \\in \\mathbb{F}_n</span> ,</p>

    <p class="text-gray-300"><span class="math">$G_{4,1/d}(x + (\\mu + 1)\\delta) - G_{4,1/d}(x + \\mu\\delta) = G_{4,1/d}(x) + (\\mu + 1)\\beta - G_{4,1/d}(x) - \\mu\\beta</span>$
<span class="math">$= \\beta,</span>$</p>

    <p class="text-gray-300">implying that the equation</p>

    <p class="text-gray-300"><span class="math">$G_{4,1/d}(X+\\delta) - G_{4,1/d}(X) = \\beta</span>$</p>

    <p class="text-gray-300">has at least p solutions.</p>

    <p class="text-gray-300">We now explicitly exhibit a set of keys for which a differential as exhibited in Proposition 8 exists.</p>

    <p class="text-gray-300"><strong>Corollary 2.</strong> Let  <span class="math">M^{[d]}</span>  denote the matrix whose entries at Position (i, j) correspond to  <span class="math">a_{i,j}^d</span> . Let  <span class="math">K_1 \\in \\mathbb{F}_p^m</span>  such that  <span class="math">K_1</span>  vanishes on the support of a column of  <span class="math">(MM^{[d]})</span> . Then, for all  <span class="math">K_0 \\in \\mathbb{F}_p^m</span> , there exists  <span class="math">K_2 \\in \\mathbb{F}_p^m</span>  such that  <span class="math">G_{4,1/d}</span>  with round keys  <span class="math">(K_0,K_1,K_2)</span> has differential uniformity at least p.</p>

    <p class="text-gray-300">Proof. From the proof of the previous proposition, we know that there exists <em>K</em><sup>2</sup> such that a differential with input difference <em>&delta;</em> is satisfied for at least <em>p</em> values as soon as <em>K</em><sup>1</sup> vanished on the support of</p>

    <p class="text-gray-300"><span class="math">$M\\begin{pmatrix} \\alpha_0^d \\\\ \\dots \\\\ \\alpha_{m-1}^d \\end{pmatrix} ,</span>$</p>

    <p class="text-gray-300">where <em>&alpha;</em> = (<em>a</em>0*,<code>&delta;* 1*/d </code> , . . . , am<em>&minus;1</em>,<code>&delta;* 1*/d </code>* ) and {<em>\`</em>} = Supp(<em>&delta;</em>). The support of this vector then corresponds to the support of</p>

    <p class="text-gray-300"><span class="math">$M\\begin{pmatrix} a_{0,\\ell}^d \\\\ \\dots \\\\ a_{m-1,\\ell}^d \\end{pmatrix}</span>$</p>

    <p class="text-gray-300">which is the column of Index <em>\`</em> of the matrix <em>MM</em>[<em>d</em>] .</p>

    <p class="text-gray-300">Then, the fact that the property holds only when <em>K</em><sup>1</sup> is the all-zero key or for some other keys depends on the choice of <em>M</em>. For instance, for <em>p</em> = 41, <em>t</em> = 2 and</p>

    <p class="text-gray-300"><span class="math">$M=\\begin{pmatrix} 24 &amp; 15 \\\\ 15 &amp; 37 \\end{pmatrix}</span>$
, we have that  <span class="math">MM^{[3]}=\\begin{pmatrix} 35 &amp; 8 \\\\ 12 &amp; 0 \\end{pmatrix}</span>  .</p>

    <p class="text-gray-300">This implies that there are some nonzero <em>K</em><sup>1</sup> for which 4 rounds of Rescue have differential uniformity at least <em>p</em>.</p>

    <p class="text-gray-300">For the matrix generated as in the StarkWare challenge, i. e.</p>

    <p class="text-gray-300"><span class="math">$M=\\begin{pmatrix} 35 &amp; 27 \\\\ 5 &amp; 10 \\end{pmatrix}</span>$
, we have  <span class="math">MM^{[3]}=\\begin{pmatrix} 16 &amp; 4 \\\\ 6 &amp; 11 \\end{pmatrix}</span>  ,</p>

    <p class="text-gray-300">which means that the previous results only apply when <em>K</em><sup>1</sup> = 0.</p>

    <p class="text-gray-300">An important point is that experiments show that there exist some other keys with a similar behavior than those exhibited in the previous corollary. For instance, in our simulation with <em>p</em> = 17, <em>MM</em>[3] has no zero entry, which implies that the keys we exhibited are such that <em>K</em><sup>1</sup> = 0, while we observe a similar behavior for other keys.</p>

    <p class="text-gray-300">In order to experimentally assess the security of Rescue, we will compute the differential uniformity of multiple instances of the block cipher as implemented by its authors.<a href="#page-17-1">2</a> An advantage of a study of the block cipher is that it allows more freedom in the choice of the round constants (those being replaced by the key) while ensuring that those are generated in an a priori cryptographically sound way.</p>

    <p class="text-gray-300">Our aims are then as follows:</p>

    <ul class="list-disc list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li><ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li>analyse whether the behaviours identified in above part of the section can occur with a strong round constant derivation procedure (as provided by the key schedule of the Rescue block cipher), and</li>
    </ol></li>
      <li><ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li>analyse the number of rounds needed to reach the differential uniformity of a random permutation operating on the same set.</li>
    </ol></li>
    </ul>

    <p class="text-gray-300"><sup>2</sup><a href="https://github.com/KULeuven-COSIC/Marvellous/blob/master/instance_generator.sage" target="_blank" rel="noopener noreferrer">https://github.com/KULeuven-COSIC/Marvellous/blob/master/instance\\_generator.sage</a></p>

    <p class="text-gray-300">The implementation of the Rescue block cipher takes both the prime <em>p</em> and the number <em>m</em> of S-boxes as parameters. It thus provides a good proxy to investigate the properties of many small-scale Rescue variants. Our only modification to the original source code are:</p>

    <ul class="list-disc list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li>the removal of the assertion ensuring a sufficient security level, and</li>
      <li>a modification of the main encryption loop to allow us to choose the number of steps rather than the number of rounds.</li>
    </ul>

    <p class="text-gray-300">We first establish a &quot;base-line&quot; of what should be expected from a random permutation in Section <a href="#page-18-0">4.3.1</a> using theoretical arguments that we confirm experimentally. Then, we present our experimental results on small-scale and round-reduced Rescue in Section <a href="#page-19-0">4.3.2.</a> In particular, we confirm that the undesirable effects presented above, while very unlikely, can unfortunately be compatible with an a priori sound round constant derivation procedure.</p>

      <h4 id="sec-4.3.1" class="text-lg font-semibold mt-6"><strong>4.3.1 On the Differential Uniformity of Random Permutations</strong></h4>

    <p class="text-gray-300">The distribution of the coefficients in the DDT of a permutation defined in F <em>n</em> 2 is well known, it has for instance been studied in <a href="#page-30-12">[14,</a> <a href="#page-30-13">6]</a>. Each coefficient in the DDT can be approximated by a random variable, all of them being independent and identically distributed. They follow a Poisson distribution with parameter 2 <sup>&minus;</sup><sup>1</sup> and the expected value of the maximum coefficient is 2<em>n</em>.</p>

    <p class="text-gray-300">However, due to their much rarer relevance, differences defined in arbitrary groups different from (F <em>n</em> 2 <em>,</em> +) have received less attention. To the best of our knowledge, the only paper that deals with such quantities is <a href="#page-30-14">[10]</a>. While its authors consider differentials for the modular addition, they unfortunately focus on Z<em>/</em>2 <em><sup>n</sup></em>Z, which is not the type of ring we consider. Nevertheless, their main result is that the DDT coefficients of a permutation in such a ring act like independent and identically distributed random variables that follow a Poisson distribution with parameter 1.</p>

    <p class="text-gray-300">The following proposition shows that the situation is the same in the case of F<em><sup>p</sup></em> = Z<em>/p</em>Z.</p>

    <p class="text-gray-300"><strong>Proposition 9.</strong> Let <em>F</em> be <sup>a</sup> permutation on (F<em>p</em>) <em><sup>m</sup></em> picked uniformly at random from the corresponding set, where <em>p</em> is prime. The DDT coefficients of <em>F</em> that correspond to non-zero input differences can all be accurately modeled as (<em>p <sup>m</sup></em> &minus; 1)<sup>2</sup><em>/</em>2 independent and identically distributed variables following <sup>a</sup> Poisson distribution with parameter 1.</p>

    <p class="text-gray-300">Proof. This proposition follows simply from modeling &#8710;<em>aF</em> as a random function of (F<em>p</em>) <em><sup>m</sup></em> and from remarking that &#8710;<em>aF</em>(<em>x</em>) = &minus;&#8710;&minus;<em>aF</em>(<em>x</em> + <em>a</em>), meaning that entries (<em>a, b</em>) and (&minus;<em>a,</em> &minus;<em>b</em>) are the same.</p>

    <p class="text-gray-300">A consequence of this proposition is that the maximum coefficient of the DDT is the maximum out of about (<em>p <sup>m</sup></em> &minus; 1)<sup>2</sup><em>/</em>2 Poisson variables. We thus conjecture that the bound established in <a href="#page-30-14">[10]</a> is easily adapted in (F<em>p</em>) <em><sup>m</sup></em> as follows.</p>

    <p class="text-gray-300"><strong>Conjecture 1.</strong> The probability that the differential uniformity of <sup>a</sup> permutation of (F<em>p</em>) <em><sup>m</sup></em> is upper bounded by</p>

    <p class="text-gray-300"><span class="math">$B(p,m) = \\frac{2\\log\\left(\\frac{(p^m - 1)^2}{2}\\right)}{\\log\\left(\\log\\left(\\frac{(p^m - 1)^2}{2}\\right)\\right)}</span>$</p>

    <p class="text-gray-300">converges to <sup>1</sup> as <em>p</em> increases, where log is the Naperian logarithm.</p>

    <p class="text-gray-300">This conjecture is all the more plausible in light of the experimental results we present below.</p>

    <p class="text-gray-300"><strong>Poisson Distribution.</strong> To verify that the Poisson distribution is indeed the one followed by the coefficients of the DDT of a random permutation, we have computed the differential spectra of multiple permutations picked uniformly at random for <em>m</em> = 2 and for various values of <em>p</em>. The result is given in Fig. <a href="#page-19-1">2.</a></p>

    <p class="text-gray-300">    <img src="_page_19_Figure_4.jpeg" alt="" class="my-4 max-w-full" />
</p>

    <p class="text-gray-300">Figure 2: Distribution of the DDT coefficients of some permutations picked uniformly at random.</p>

    <p class="text-gray-300">As we can see, even for small values of <em>p</em>, the coefficients do behave like independent and identically distributed random variables following a Poisson distribution with parameter 1.</p>

    <p class="text-gray-300"><strong>Distribution of the differential uniformity.</strong> We have generated 100 permutations of (F<em>p</em>) <sup>2</sup> where <em>p</em> takes each prime value between 2 <sup>3</sup> and 2 <sup>5</sup> &minus; 1, and 20 for each prime between 2 <sup>5</sup> and 2 <sup>6</sup> &minus; 1. The results are given in Table <a href="#page-20-0">4,</a> where the bound from Conjecture <a href="#page-18-1">1</a> is also given. As we can see, the bound holds for all but a small number of instances. In fact there is no exception in our set for the highest value of <em>p</em> considered, namely <em>p</em> = 31. Furthermore, it seems like this bound is a good approximation for the expected value of the differential uniformity: the differential uniformity is indeed under it, but not far.</p>

      <h4 id="sec-4.3.2" class="text-lg font-semibold mt-6"><strong>4.3.2 Experimental Results on Many Instances of Rescue</strong></h4>

    <p class="text-gray-300">In order to compare Rescue instances, we generated several instances and computed their differential uniformity. For <em>p &lt;</em> 31, we have considered all possible values for the master key. For 31 6 <em>p</em> 6 61, the computation time was too high and we instead investigated 20 different master keys for each. For each instances considered, we computed the differential uniformity for 1 through 5 rounds. In each graph, to each instances corresponds a partially transparent line whose color corresponds to <em>p</em>. This allows us to track how the differential uniformity evolves through the rounds.</p>

    <p class="text-gray-300">First, Fig. <a href="#page-20-1">3</a> presents the differential uniformity as a function of the number of rounds. For clarity, <em>p &lt;</em> 32 and <em>p &gt;</em> 32 are on two different graphs.</p>

    <div class="overflow-x-auto my-4">
      <table class="min-w-full text-sm text-gray-300">
        <thead>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"># permutations with a given u</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"></th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"></th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"></th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"></th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"></th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"></th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"></th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"></th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"></th>
        </thead>
        <tbody>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">p</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">5</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">6</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">7</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">8</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">9</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">10</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">11</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">12</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">B(p, 2)</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">11</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">50</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">42</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">6</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">&ndash;</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">&ndash;</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">&ndash;</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">8.13</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">13</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">&ndash;</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">36</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">50</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">10</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">4</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">&ndash;</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">&ndash;</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">&ndash;</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">8.47</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">17</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">&ndash;</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">3</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">56</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">34</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">6</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">&ndash;</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">&ndash;</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">9.00</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">19</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">&ndash;</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">&ndash;</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">55</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">40</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">3</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">2</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">&ndash;</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">&ndash;</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">9.21</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">23</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">&ndash;</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">&ndash;</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">27</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">59</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">13</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">&ndash;</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">&ndash;</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">9.58</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">29</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">&ndash;</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">&ndash;</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">4</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">57</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">38</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">&ndash;</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">10.03</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">31</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">&ndash;</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">&ndash;</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">&ndash;</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">61</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">35</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">4</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">&ndash;</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">&ndash;</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">10.16</td>
          </tr>
        </tbody>
      </table>
    </div>

    <p class="text-gray-300">Table 4: The differential uniformity of random permutations of (F<em>p</em>) 2 .</p>

    <p class="text-gray-300">    <img src="_page_20_Figure_4.jpeg" alt="" class="my-4 max-w-full" />
</p>

    <p class="text-gray-300">    <img src="_page_20_Figure_5.jpeg" alt="" class="my-4 max-w-full" />
</p>

    <p class="text-gray-300">Figure 3: The evolution of the differential uniformity of several Rescue instances through their rounds, divided by <em>p</em>.</p>

    <p class="text-gray-300">As we can see, the value of the exponent <em>d</em> has a significant influence on the value of the differential uniformity for the first round which can sometimes still be observed in the second one. Furthermore, there are many instances for which the ratio <em>u/p</em> is at least equal to 1 at the end of the second round, which is coherent with the results presented above.</p>

    <p class="text-gray-300">Three more observations can be made from Fig. <a href="#page-20-2">3a.</a></p>

    <ul class="list-disc list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li>First, the ratio <em>u/p</em> in the last rounds (4 and 5) decreases with <em>p</em>. This is coherent with Conjecture <a href="#page-18-1">1</a> which states that the differential uniformity increases slower than log(<em>p <sup>m</sup></em>).</li>
      <li>Second, for <em>p</em> = 11, there is an instance for which the differential uniformity does not change and remains equal to <em>p</em> during rounds 2 and 3. While this could be a side effect of the small value <em>p</em>, the fact that the values obtained are exactly equal to <em>p</em> is intriguing.</li>
      <li>Finally, we have found one instance for <em>p</em> = 13 for which the differential uniformity decreases as expected for the first 3 rounds but then increases substantially at the 4th to reach a value just under 1<em>.</em>5<em>p</em>. This highlights that the behaviour identified above is unfortunately compatible with a strong round constant generation. Still, such an event remains very unlikely as we have only found one such instance, and for one of the smallest values of <em>p</em>.</li>
    </ul>

    <p class="text-gray-300">To better put into perspective this instance, we have plotted the differential uni-</p>

    <p class="text-gray-300">    <img src="_page_21_Figure_2.jpeg" alt="" class="my-4 max-w-full" />
</p>

    <p class="text-gray-300">Figure 4: The evolution of the differential uniformity of several Rescue instances through their rounds, divided by <em>B</em>(<em>p, m</em>).</p>

    <p class="text-gray-300">formity of all our instances in the same graph in Fig. <a href="#page-21-1">4.</a> In order to remove the contribution of <em>p</em> and <em>m</em> from each result, we have divided <em>u</em> by <em>B</em>(<em>p, m</em>), where <em>B</em> is the bound from Conjecture <a href="#page-18-1">1.</a> Finally, we have removed the first round from this picture.</p>

    <p class="text-gray-300">As we can see, the differential uniformity at rounds 4 and 5 narrows down around a single value as <em>p</em> increases. It is good news: it means that 4 rounds are sufficient to break down all differential distinguishers in the majority of the cases. On the other hand, this pictures highlights the oddity of the behaviour of the lone instance for <em>p</em> = 13 that increases its differential uniformity at round 4.</p>

    <p class="text-gray-300">Remark 1. Our analysis in this section has relied on the key schedule of the Rescue block cipher to give us a larger data set while retaining a sound round constant generation &ndash; that is in fact endorsed by the designers of Rescue. Along with the rest of this report, it highlights the importance of having a strong round constant derivation method.</p>

    <p class="text-gray-300">We note that the generation method for the round constants of the hash function could allow related-cipher attacks: if Rescue is superseded by Rescue2 at some point in the future then these hash function would share some round constants at different positions. We would then recommend enforcing some separation between the name and the index, e.g. by hashing Rescue_0 and Rescue2_0 to obtain the first round constant of Rescue and of a hypothetical updated design Rescue2.</p>

    <p class="text-gray-300">The idea of this analysis, or attack vector, is to trace how cosets of multiplicative subgroups get mapped to other cosets through the encryption process. This can be seen as a multiplicative variant of linear cryptanalysis in the case of a subgroup of codimension 2. We first describe the idea and fix the notation. Next, we investigate how those multiplicative structures are affected by the separate parts of the round function, i. e. the linear layer, the S-box, and the key-addition. Finally, we focus on the most interesting case of what we call a diagonal subgroup, a structure closely related to one-dimensional subspaces. We show that it is in principle possible to maliciously choose round constants that would lead to a significant non-random behaviour for any key even using the heavy key-scheduling of Rescue.</p>

    <p class="text-gray-300">Let  <span class="math">U \\subseteq \\mathbb{F}_p^*</span>  be a multiplicative subgroup of  <span class="math">\\mathbb{F}_p^*</span>  of order  <span class="math">q \\mid p-1</span> . The cosets of U are U, gU,  <span class="math">g^2U</span> , ...,  <span class="math">g^{s-1}U</span> , where  <span class="math">s = \\frac{p-1}{q}</span>  and g is a generator of  <span class="math">\\mathbb{F}_p^*</span> . We extend such a subgroup of  <span class="math">U \\subseteq \\mathbb{F}_p^*</span>  to</p>

    <p class="text-gray-300"><span class="math">$U^{\\otimes m} = U \\times \\dots \\times U \\subseteq \\left(\\mathbb{F}_p^*\\right)^m</span>$</p>

    <p class="text-gray-300">by the component wise multiplication. Cosets of  <span class="math">U^{\\otimes m}</span>  are specified as  <span class="math">\\alpha U^{\\otimes m}</span>  with  <span class="math">\\alpha \\in \\left(\\mathbb{F}_{p}^{*}\\right)^{m}</span>  and</p>

    <p class="text-gray-300"><span class="math">$\\alpha U^{\\otimes m} = \\alpha_1 U \\times \\alpha_2 U \\times \\cdots \\times \\alpha_m U .</span>$</p>

    <p class="text-gray-300">We define, for a function  <span class="math">F:\\mathbb{F}_p^m \\to \\mathbb{F}_p^m</span> , the counters</p>

    <p class="text-gray-300"><span class="math">$c_F(\\alpha, \\beta) = |\\{x \\in \\alpha U^{\\otimes m} \\mid F(x) \\in \\beta U^{\\otimes m}\\}|</span>$</p>

    <p class="text-gray-300">which correspond, up to scaling, to the probability of an element in  <span class="math">\\alpha U^{\\otimes m}</span>  being mapped to the coset  <span class="math">\\beta U^{\\otimes m}</span>  by F. We arrange all those counters in a transition matrix</p>

    <p class="text-gray-300"><span class="math">$M_F = (c_F(\\alpha, \\beta))_{\\alpha, \\beta}</span>$</p>

    <p class="text-gray-300">For a function that is composed of two (or more) parts, one can try to approximate the transition matrix  <span class="math">M_{F_2 \\circ F_1}</span>  by multiplying the (scaled) matrices of  <span class="math">F_1</span>  and  <span class="math">F_2</span> , that is we could assume</p>

    <p class="text-gray-300"><span class="math">$\\frac{1}{|U|}M_{F_2 \\circ F_1} \\approx \\frac{1}{|U|}M_{F_2} \\times \\frac{1}{|U|}M_{F_1}</span>$</p>

    <p class="text-gray-300">under some standard randomization assumptions.</p>

    <p class="text-gray-300">With this in mind, we start to elaborate on the transitions matrices for the parts of the round function of Rescue. As we will see, in particular the constant addition results in a very balanced matrix, most notably in the case s=2, i. e. the case of squares and non-squares, this matrix is, up to a constant, uniform.</p>

      <h3 id="sec-5.2" class="text-xl font-semibold mt-8">5.2 The Effect of the Round Operations</h3>

      <h4 id="sec-5.2.1" class="text-lg font-semibold mt-6">5.2.1 S-box Layer</h4>

    <p class="text-gray-300">The S-box  <span class="math">S: \\mathbb{F}_p \\to \\mathbb{F}_p</span>  is a permutation of the form  <span class="math">x \\mapsto x^d</span> . As the S-box layer  <span class="math">S^{\\otimes m}</span>  does not mix the separate words, we get</p>

    <p class="text-gray-300"><span class="math">$c_{S^{\\otimes m}}(\\alpha,\\beta) = \\prod_{i} c_{S}(\\alpha_{i},\\beta_{i})</span>$</p>

    <p class="text-gray-300">Moreover, as  <span class="math">S(\\alpha_i U) = \\alpha_i^d U^d = \\alpha_i^d U</span> , it holds that</p>

    <p class="text-gray-300"><span class="math">$c_{S^{\\otimes m}}(\\alpha,\\beta) = \\begin{cases} |U|^m &amp; \\text{if } \\beta \\in \\alpha^d U^{\\otimes m} \\\\ 0 &amp; \\text{otherwise} \\end{cases}</span>$</p>

    <p class="text-gray-300">Thus, the S-box layer only permutes the cosets. In other words, the probability that an input from a specific coset  <span class="math">\\alpha U</span>  is mapped by the S-box to another specific coset  <span class="math">\\beta U</span>  is either one or zero. This is the main reason why studying this transition is not completely hopeless.</p>

      <h4 id="sec-5.2.2" class="text-lg font-semibold mt-6"><strong>5.2.2</strong> Constant addition by k</h4>

    <p class="text-gray-300">Similar to above, given a constant  <span class="math">k \\in \\mathbb{F}_p^m</span>  denote by</p>

    <p class="text-gray-300"><span class="math">$c_k(\\alpha, \\beta) := |\\{x \\in \\alpha U^{\\otimes m} \\mid x + k \\in \\beta U^{\\otimes m}\\}|,</span>$</p>

    <p class="text-gray-300">the transition from one coset to another when adding k to each element. Again, as the addition is defined word wise as well, we get</p>

    <p class="text-gray-300"><span class="math">$c_k(\\alpha, \\beta) = \\prod_i c_{k_i}(\\alpha_i, \\beta_i)</span>$</p>

    <p class="text-gray-300">and for this reason focus on the case m=1 for now.</p>

    <p class="text-gray-300">Given  <span class="math">\\alpha_1, \\beta_1 \\in \\mathbb{F}_p</span>  the counter</p>

    <p class="text-gray-300"><span class="math">$c_k(\\alpha_1, \\beta_1)</span>$</p>

    <p class="text-gray-300">corresponds, up to a factor of  <span class="math">s^2</span>  to the number of solutions</p>

    <p class="text-gray-300"><span class="math">$(x,y) \\in (\\mathbb{F}_p^*)^2</span>$</p>

    <p class="text-gray-300">for the equation</p>

    <p class="text-gray-300">
<span class="math">$\\alpha_1 x^s + k = \\beta_1 y^s \\ . \\tag{3}</span>$</p>

    <p class="text-gray-300">Dividing this by k (in the case  <span class="math">k \\neq 0</span> ) we see that</p>

    <p class="text-gray-300"><span class="math">$c_k(\\alpha_1, \\beta_1) = c_1\\left(\\frac{\\alpha_1}{k}, \\frac{\\beta_1}{k}\\right)</span>$</p>

    <p class="text-gray-300">thus addition by any non-zero constant behaves like addition by  <span class="math">1\\ \\mathrm{up}</span>  to a permutations of the cosets.</p>

    <p class="text-gray-300">Further, the number of solutions to Eq. (3), or rather the counters  <span class="math">c_k</span> , is also known as the <em>cyclotomic number of order</em> s.</p>

    <p class="text-gray-300">For s=2, that is the case of U being the squares in  <span class="math">\\mathbb{F}_p</span>  and gU the non-squares, the cyclotomic numbers are known and depend on if -1 is a square or not. In the first case,  <span class="math">-1 \\in U</span>  resp.  <span class="math">\\frac{p-1}{2}</span>  is even,</p>

    <p class="text-gray-300"><span class="math">$c_k(\\alpha,\\beta) = \\begin{cases} \\frac{p-5}{4} &amp; \\text{if } \\alpha,k \\in U \\\\ \\frac{p-1}{4} &amp; \\text{otherwise} \\end{cases},</span>$</p>

    <p class="text-gray-300">and in the second case,  <span class="math">-1 \\in gU</span>  resp.  <span class="math">\\frac{p-1}{2}</span>  is odd,</p>

    <p class="text-gray-300"><span class="math">$c_k(\\alpha,\\beta) = \\begin{cases} \\frac{p+1}{4} &amp; \\text{if } \\alpha \\in gU \\text{ and } k \\in U \\\\ \\frac{p-3}{4} &amp; \\text{otherwise} \\end{cases}.</span>$</p>

    <p class="text-gray-300">For s&gt;2 we are not aware of any exact results and it seems only classical estimates on the number of solutions are available. In particular it holds that the number N of solutions of Eq. (3) fulfills</p>

    <p class="text-gray-300"><span class="math">$|N - (p+1)| \\leqslant 2s^2 \\sqrt{p} \\,, \\tag{4}</span>$</p>

    <p class="text-gray-300">where we ignore the at most s points at infinity for simplicity. Furthermore, ignoring minor terms, this implies that</p>

    <p class="text-gray-300"><span class="math">$\\left| c_k(\\alpha, \\beta) - \\frac{|U|}{s} \\right| \\leqslant 2\\sqrt{p} \\ .</span>$</p>

    <p class="text-gray-300">Thus, for large subgroups of magnitude p, this implies a rather uniform distribution of the counters. For small subgroups, however, of size  <span class="math">\\sqrt{p}</span>  and less, this bound turns completely trivial. Limited experiments showed that the actual values behave better than the bound suggests. However, improving this bounds seems to be a rather difficult task.</p>

      <h4 id="sec-5.2.3" class="text-lg font-semibold mt-6">5.2.3 Matrix Multiplication</h4>

    <p class="text-gray-300">First experimental results show that multiplying with a matrix results in rather uniform matrices. However, it is obvious that the numbers are far from random and in particular, all counters have a remarkable common factor, as the next proposition shows.</p>

    <p class="text-gray-300"><strong>Proposition 10.</strong> With the notation from above, let</p>

    <p class="text-gray-300"><span class="math">$L: \\mathbb{F}_p \\to \\mathbb{F}_p</span>$</p>

    <p class="text-gray-300">be a linear mapping, then</p>

    <p class="text-gray-300"><span class="math">$|U| \\mid c_L(\\alpha, \\beta)</span>$
,</p>

    <p class="text-gray-300">that is all transition counters are divisible by the size of U.</p>

    <p class="text-gray-300"><em>Proof.</em> Consider an element  <span class="math">x \\in \\alpha U^{\\otimes m}</span>  such that  <span class="math">L(x) \\in \\beta U^{\\otimes m}</span> . Furthermore, let a be an arbitrary element in U. Then</p>

    <p class="text-gray-300"><span class="math">$ax \\in a\\alpha U^{\\otimes m} = \\alpha U^{\\otimes m}</span>$</p>

    <p class="text-gray-300">as  <span class="math">a \\in U</span>  and</p>

    <p class="text-gray-300"><span class="math">$L(ax) = aL(x) \\in a\\beta U^{\\otimes m} = \\beta U^{\\otimes m}</span>$</p>

    <p class="text-gray-300">as all those elements are disjoint, elements contributions to  <span class="math">c_L(\\alpha, \\beta)</span>  always come in bundles of |U| elements.</p>

    <p class="text-gray-300">The last observation on the matrix multiplication also motivates to consider a different set of subgroups and their cosets. Namely for a subgroup  <span class="math">U \\subseteq \\mathbb{F}_p^*</span>  we define</p>

    <p class="text-gray-300"><span class="math">$\\mathcal{D}(U) := \\{(a, \\dots, a) \\mid a \\in U\\} \\subseteq (\\mathbb{F}_p^*)^m.</span>$</p>

    <p class="text-gray-300">Those spaces can be thought of diagonals, hence the notation  <span class="math">\\mathcal{D}</span> . This is not only a multiplicative group but also, up to the all-zero vector, a one-dimensional subspace. Different to the direct product of subgroups considered before, those diagonal subgroups and their cosets behave nicely for both the linear layer and the S-boxes. Indeed, for both cases, the transition matrices are permutation matrices. Again, the key-addition destroys this behaviour with very high probability in general. However, using the close relation to a one-dimensional subspace, it is possible to design weak variants by maliciously choosing the constants. Let us consider the easiest case of  <span class="math">U = \\mathbb{F}_p^*</span>  entirely. Let us fix an arbitrary vector  <span class="math">\\alpha \\in (\\mathbb{F}_p^*)^m</span>  and constants  <span class="math">k = \\alpha</span> . Then the coset of  <span class="math">\\mathcal{D}(\\mathbb{F}_p^*)</span>  given by</p>

    <p class="text-gray-300"><span class="math">$\\alpha \\mathcal{D}(\\mathbb{F}_n^*) = \\{\\alpha_1 a, \\alpha_2 a, \\dots, \\alpha_m a\\}</span>$</p>

    <p class="text-gray-300">is mapped to itself by adding the key as for  <span class="math">a \\in \\mathbb{F}_p^*</span>  we have</p>

    <p class="text-gray-300"><span class="math">$a\\alpha + k = a\\alpha + \\alpha = (a+1)\\alpha</span>$
.</p>

    <p class="text-gray-300">Then the S-box layer (or its inverse respectively) and the linear layer are going to map this to  <span class="math">\\mathcal{D}(\\mathbb{F}_p^*)</span>  with</p>

    <p class="text-gray-300"><span class="math">$\\beta = L(\\alpha_1^d, \\dots, \\alpha_m^d) .</span>$</p>

    <p class="text-gray-300">If now the round constants for the second round are chosen as  <span class="math">\\beta</span>  this continues for the second round. More general, choosing round constants/keys of the form</p>

    <p class="text-gray-300"><span class="math">$k^{(i+1)} = L\\left(S\\left(k^{(i)}\\right)\\right)</span>$</p>

    <p class="text-gray-300">leads to this diagonal subgroup being mapped to a fixed coset. Interestingly, this is very close, up to the round constants, to the actual key schedule. Thus, this can be reformulated as the existence of round constants such that there exists a key-independent function  <span class="math">f: \\mathbb{F}_p^* \\to \\mathbb{F}_p^*</span></p>

    <p class="text-gray-300"><span class="math">$E_k(ak) = f(a)E_k(k),</span>$</p>

    <p class="text-gray-300">for all  <span class="math">a \\in \\mathbb{F}_p</span> , all keys  <span class="math">k \\in (\\mathbb{F}_p^*)</span> , a rather intriguing and unusual property.</p>

    <p class="text-gray-300">Luckily, it can be argued that almost any other choice of constants seems to be destroying this property very quickly and results in a very uniform distribution with just one key addition.</p>

    <p class="text-gray-300">Rebound attacks are a common tool used for studying the security of hash functions. This technique introduced in [13], with many follow-up works published in the last few years, can allow to efficiently find solutions for a certain differential path by merging partial middle solutions, that are enforced by first choosing differences and next filling in the values that make the difference transitions possible.</p>

    <p class="text-gray-300">The differential paths considered in these kinds of attacks are often truncated and need to verify two obvious conditions for being interesting: 1) having a good probability of having associated solutions and 2) can be solved with a rebound-like technique in less time than it would cost finding the input/output properties with queries. They are often used for finding collisions, (semi-) free start collisions or distinguishers.</p>

    <p class="text-gray-300">In this section, we first propose a semi-free start collision on 3 rounds of the permutation, that will serve as an example of the techniques on Rescue. Next, we discuss how could this be extended to reach 1 more round generating an output near-collision (or partial collision), though not in the wanted part of the output. For this, we would have to take into account some properties of the S-box S. Finally, we discuss how could these analyses be applied for generic parameters and we provide a bound for the highest number of rounds that could be reached in each case.</p>

      <h3 id="sec-6.1" class="text-xl font-semibold mt-8">6.1 Example collision attack on 3 rounds</h3>

    <p class="text-gray-300">We describe here how to build a semi-free start collision (a collision where the value of the capacity is chosen, and the difference is introduced in the message part, that is a collision on the permutation that does not consider differences in the capacity) with a cost of  <span class="math">2^{n/2}</span>  versus  <span class="math">2^{2n}</span> , which would be the generic cost of generating a collision on 4n bits (from an initial state with 4n bits without difference, due to birthday distinguishers).</p>

    <p class="text-gray-300">For illustrating our example we consider the following parameters m=12, n=125 and a capacity c=4. The number of active words in the state at round #i is denoted by  <span class="math">N_i</span> . We know that if i is even,  <span class="math">N_i=N_{i+1}</span> , as S does not change it. If i is odd, we can right  <span class="math">N_i+N_{i+1}\\geqslant (m+1)</span>  as the considered matrix is MDS. We will consider the path represented in Fig. 5. The number of expected solutions for such a path is</p>

    <p class="text-gray-300"><span class="math">$2^{mn}2^{N_0n}2^{-(m-N_2)n}2^{-(m-N_4)n}2^{-(m-N_6)n} = 2^{(N_0+N_2+N_4+N_6-2m)n}</span>$</p>

    <p class="text-gray-300">We consider the biggest  <span class="math">N_0</span>  and  <span class="math">N_6</span>  that still allow generating collisions on the capacity part, as this will allow reducing the complexity:  <span class="math">N_0 = N_6 = m - c = 8</span> . We</p>

    <p class="text-gray-300">consider the minimal value for  <span class="math">N_2+N_4=N_3+N_4</span> , that is m+1, as this allows to have enough solutions while it reduces the cost of the middle merging phases and provides a more efficient procedure (it is trivial that the less determined parts in the partial solutions, the cheaper it will be to find an overall solution). The minimal value for each is  <span class="math">m-N_0+1=5</span> , and for the sake of simplicity, in the figure, we have chosen  <span class="math">N_2=5</span>  and  <span class="math">N_4=8</span> , that are compatible with the values of  <span class="math">N_0</span>  and  <span class="math">N_6</span> . This gives a number of solutions of  <span class="math">2^{(N_0+N_2+N_4+N_6-2m)n}=2^{(m+1-2c)n}=2^{5n}</span> .</p>

    <p class="text-gray-300">    <img src="_page_26_Figure_3.jpeg" alt="" class="my-4 max-w-full" />
</p>

    <p class="text-gray-300">Figure 5: 3-round collision path.  <span class="math">M_i</span>  represents the matrix plus constant addition of round i</p>

    <p class="text-gray-300">Let us point out that the number of possible differences for the middle transition through  <span class="math">M_2</span>  is  <span class="math">2^{(N_3-m+N_4)n}=2^n</span> . As there are  <span class="math">2^{5n}</span>  overall solutions, we can expect for each fixed middle difference in  <span class="math">N_3</span>  and  <span class="math">N_4</span>  that  <span class="math">2^{4n}</span>  associated values will give a good solution.</p>

    <p class="text-gray-300">Before explaining the procedure for obtaining a solution in  <span class="math">2^{n/2}</span> , we have to build a list  <span class="math">L_1</span>  containing  <span class="math">2^x</span>  good differences verifying the differential path through  <span class="math">M_1</span>  (where x is bounded by n, as was the case for the middle differences). We do the same with a list  <span class="math">L_2</span> , containing  <span class="math">2^y</span>  good differences verifying the path through  <span class="math">M_3</span> . Here y is bounded by  <span class="math">2^{4n}</span> .</p>

    <p class="text-gray-300">The procedure is then the following:</p>

    <ul class="list-disc list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li><ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li>Choose a fixed difference for the middle part for states #3 and #4.</li>
    </ol></li>
      <li><ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li>For each of the  <span class="math">2^x</span>  elements in  <span class="math">L_1</span> , check if transition 1 between the difference in #2 and the difference in #3 is possible through  <span class="math">S^{-1}</span> . This happens with a probability of about  <span class="math">2^{-N_2}</span> , and when it occurs, there are on average  <span class="math">2^{N_2}</span>  values that make it possible. We keep in  <span class="math">L_1</span>  the differences that can verify transition 1, as well as all the possible values making this transition possible. That is good differences verifying the path from #2 to #4, plus the good values in #3 that make transition 1 possible. While  <span class="math">x &gt; N_2</span> , the size of the final list will also be around  <span class="math">2^x = 2^{x-N_2+N_2}</span> .</li>
    </ol></li>
      <li><ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li>We do the same with each of the  <span class="math">2^y</span>  elements in  <span class="math">L_2</span> , transforming  <span class="math">L_2</span>  into a list of differences and values that verify the truncated differences from state #3 to</li>
    </ol></li>
    </ul>

    <p class="text-gray-300">state #6 and with associated values in #4 that allow for a correct transition 2. While <em>y &gt; N</em>5, the final size of <em>L</em><sup>2</sup> will still be on average of size 2 <em>y</em> .</p>

    <ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li>The probability of having a good match between the elements in <em>L</em><sup>1</sup> and the elements in <em>L</em><sup>2</sup> that represents a possible correct full state is 2 (<em>m</em>&minus;<em>N</em>3&minus;<em>N</em>4)<em><sup>n</sup></em> = 2<sup>&minus;</sup><em>n</em>. This match can be efficiently found between both lists as it is represented by a linear equation between the values in #3 and the values in #4. If 2 <em><sup>x</sup></em>+<em><sup>y</sup></em> = 2<em><sup>n</sup></em>, we will find with good probability a match that represents a solution for the whole path.</li>
    </ol>

    <p class="text-gray-300">The cost of this procedure is 2 <em><sup>x</sup></em> + 2<em><sup>y</sup></em> . If we choose 2 <em><sup>x</sup></em> = 2<em><sup>y</sup></em> = 2<em>n/</em><sup>2</sup> <em>,</em> we obtain an optimal overall cost of 2 <em>n/</em>2 .</p>

    <p class="text-gray-300">This collision attack can be trivially extended into a distinguisher on 4 rounds with the same complexity by adding one round in the end. The difference at state #8 would belong to a subspace of size 2 (<em>m</em>&minus;4)<em>n</em>, which would have a complexity of 2 <sup>2</sup><em><sup>n</sup></em> for a random permutation.</p>

    <p class="text-gray-300">The first question is: can we extend this one further round generating a collision without exploiting additional properties of the S-box? We first discuss how this does not seem possible.</p>

    <p class="text-gray-300">The next question is: which kind of properties could be exploited to extend it? We propose a property that, with a different MDS matrix, would allow extending the previous collision attack one round into a different type of near collision, and we discuss how this cannot be extended to further rounds without any new ideas.</p>

      <h4 id="sec-6.2.1" class="text-lg font-semibold mt-6"><strong>6.2.1 Limit of the previous attack</strong></h4>

    <p class="text-gray-300">The probability of finding a match in the middle once the differences were fixed in the previous example was 2 <sup>&minus;</sup><em>n</em>, the number of S-boxes transitions determined in transition 1 plus the ones in transition 2 is 5 + 8 = 13, and so the probability of these transitions to be compatible is of 2 <em><sup>n</sup></em>(12&minus;13) = 2&minus;<em>n</em>. This probability is directly associated with the final complexity, as it determines the number of combinations of partial solutions that we have to generate.</p>

    <p class="text-gray-300">If we add one more round to the previous path we obtain that the number of solutions will be:</p>

    <p class="text-gray-300"><span class="math">$2^{mn}2^{N_0n}2^{-(m-N_2)n}2^{-(m-N_4)n}2^{-(m-N_6)n}2^{-(m-N_8)n} = 2^{(N_0+N_2+N_4+N_6+N_8-3m)n}.</span>$</p>

    <p class="text-gray-300">The relations that have to be verified here are: <em>N<sup>i</sup></em> + <em>N<sup>i</sup></em>+2 &gt; <em>m</em> + 1. If, as in the previous section, we try to keep the number of active S-boxes to the minimum to have an efficient procedure of finding solutions, we would have 2 <sup>&minus;</sup>2<em><sup>n</sup></em> solutions, less than 1. For being able to expect more than one solution, we have to increase the number of active S-boxes, and this will reduce the probability of the matching in the middle. We need to have at least <em>N</em><sup>0</sup> + <em>N</em><sup>2</sup> + <em>N</em><sup>4</sup> + <em>N</em><sup>6</sup> = 2<em>m</em> + 4 while keeping <em>N</em><sup>8</sup> = <em>N</em><sup>0</sup> = <em>m</em> &minus; <em>c</em>. All the combinations are going to be equivalent. For the sake of simplicity let us consider <em>N</em><sup>6</sup> = <em>c</em> + 1, <em>N</em><sup>4</sup> = <em>m</em> &minus; <em>c</em> and <em>N</em><sup>2</sup> = <em>c</em> + 3. In this case, if we consider the middle in the same place as the previous section, between states #3 and #4, the matching in the middle probability would become 2 <sup>&minus;</sup>3<em><sup>n</sup></em> (instead of 2 <sup>&minus;</sup><em>n</em>), and we would have an additional probability of satisfying the correct values for the third transition, with 2 <em><sup>c</sup></em>+1 word values already fixed, of 2 <sup>&minus;</sup>(<em>c</em>+1)<em>n</em>. Finding solutions for this path then will</p>

    <p class="text-gray-300">always have a worse complexity than the complexity of the generic attack, given by the birthday bound that costs 2 <em>c/</em>2<em>n</em>. <a href="#page-28-0">3</a></p>

    <p class="text-gray-300">To find options for extending the rebound analysis by one round we studied exploiting an outbound part for the final round that ensured a property being verified without needing to fix the full values of the related S-boxes in #6. This could be done in part with the following property of <em>S</em> when considering a weaker matrix that partially conserves truncated paths within the words, as it is the case of the AES matrix.</p>

      <h4 id="sec-6.2.2" class="text-lg font-semibold mt-6"><strong>6.2.2 Property of the S-box</strong> <em>S</em></h4>

    <p class="text-gray-300">If we consider two values, <em>X</em> and <em>Y</em> , with a &#8710; = <em>X</em> &minus; <em>Y</em> such that its most significant non-zero bit is at position <em>M</em>. Both <em>X</em> and <em>Y</em> also have their <em>n</em> &minus; <em>N</em> most significant bits to zero (it is obvious that <em>N &gt; M</em>). In this case, <em>S</em>(<em>X</em>) &minus; <em>S</em>(<em>Y</em> ) has the (<em>n</em> &minus; 2<em>N</em> &minus; <em>M</em>) most significant bits to 0.</p>

    <p class="text-gray-300">Let us see now how, if the MDS matrix maintains this sort of property, as is the case of the MDS matrix used in AES, the last round could be added for a near-collision attack.</p>

      <h4 id="sec-6.2.3" class="text-lg font-semibold mt-6"><strong>6.2.3 Exploiting the property and limits</strong></h4>

    <p class="text-gray-300">Let us recall here that in this part we consider a weaker matrix than the one proposed in Rescue.</p>

    <p class="text-gray-300">In Fig. <a href="#page-29-1">6</a> we represent an idea of how the previous property could be used to build a partial collision on one more round, that is 4 rounds. Even though the collision is not in the capacity now, but on the <em>n</em><sup>0</sup> most significant bits of the <em>m</em> words at the output of the permutations, if complexity is smaller than that of obtaining this for a random permutation, the property of colliding in a large part of the state (when starting with an input with also a big part with no difference, otherwise it would be trivial) is stronger than other distinguishers and might be easier to exploit in further attacks.</p>

    <p class="text-gray-300">The order of <em>S</em> and <em>S</em> <sup>&minus;</sup><sup>1</sup> has been altered in our example, as the aim would be to have a probability one for the differential transition from #6 to #8.</p>

    <p class="text-gray-300">This partial collision can not be extended by one round into a distinguisher as we did in the previous section, as the output difference would enter now all the S-boxes of the next round.</p>

    <p class="text-gray-300">The number of solutions (computed from #6, as it is easier) of such a path would be:</p>

    <p class="text-gray-300"><span class="math">$2^{(m-N_6)n+N_6(N+M)-(m-N_5)M-(m-N_3)n-(m-N_1)n}</span>$</p>

    <p class="text-gray-300"><span class="math">$=2^{M(N_5+N_6)+N_6N+n(N_1+N_3)-n(N_6+m)-mM}</span>$</p>

    <p class="text-gray-300">The minimal value of <em>N</em><sup>5</sup> + <em>N</em><sup>6</sup> and of <em>N</em><sup>1</sup> + <em>N</em><sup>3</sup> is <em>m</em> + 1, which as we saw in the previous section it is interesting for having a better probability in the middle, so the number of solutions is bounded by:</p>

    <p class="text-gray-300"><span class="math">$2^{M(m+1)+N_6N+n(m+1)-n(N_6+m)-mM} \\geqslant 2^{M+n+N_6(N-n)}</span>$</p>

    <p class="text-gray-300">Depending on the value of <em>N</em>6, we obtain a relation for <em>M</em> and <em>N</em> that will allow having enough solutions on the path with better middle probability: So while <em>M</em> +</p>

    <p class="text-gray-300"><sup>3</sup>without mentioning the difficulty of finding solutions for the path without fixing a difference to an arbitrary value, that is harder when the number of solutions is small.</p>

    <p class="text-gray-300">    <img src="_page_29_Picture_2.jpeg" alt="" class="my-4 max-w-full" />
</p>

    <p class="text-gray-300">Figure 6: 4-round distinguisher path.  <span class="math">M_i&#x27;</span>  represents the modified matrix plus constant addition of round i. The order of S and  <span class="math">S^{-1}</span>  has been altered in order to be able to exploit the property. The active parts of the words are colored in blue</p>

    <p class="text-gray-300"><span class="math">N_6N&gt;n(N_6-1)</span>  we can always expect solutions (to have the final property verified we need N&lt; n/2 and M&lt; n-2N).</p>

    <p class="text-gray-300">If we did not use this property but instead fix the differences and values in #7 and compute backwards to #6, this would imply fewer solutions, as N would be equal to 0, and a higher cost of the final solution, as the size of the values to meet probabilistically in #6 would be bigger: instead of  <span class="math">N_6(n-N)</span> , it would be  <span class="math">N_6n</span> .</p>

    <p class="text-gray-300">As can be seen in Fig. 6, the size of the output collision is M'm=(n-2N-M)m due to the property from S. From the generic birthday complexity, we will have a partial collision attack if the cost of our attack is smaller than  <span class="math">\\min\\{2^{nc/2},2^{(n-2N-M)m}\\}</span> . We could adapt the previous procedure to build an attack in 4 rounds of this setting, and improve the list merging phases for ensuring at least the value of one chunk of zeros final the final merge. The complexity in all the cases is going to be very close to the generic attack.</p>

    <p class="text-gray-300">Even in configurations where this attack might work, we see no way of extending it even one more round.</p>

      <h3 id="sec-6.3" class="text-xl font-semibold mt-8">6.3 Conclusion</h3>

    <p class="text-gray-300">The best collision attacks we could find on Rescue reach 3 rounds with a complexity of  <span class="math">2^{n/2}</span> . We proposed a potential extension of the attack by one round for a modified MDS matrix and an inverted order of the S-box layers. This extension is based on a property of the S-box. The matrix property needed for potentially extending the 3-round collision attack into a 4-round one is not satisfied by the matrices proposed for Rescue.</p>

    <p class="text-gray-300">Based on our present understanding, it does not seem probable that any such attacks could reach 5 rounds. Thus, the security margin with respect to rebound-type attacks seems really big.</p>

    <ul class="list-disc list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li>[1] Abdelrahaman Aly et al. Design of Symmetric-Key Primitives for Advanced Cryptographic Protocols. Cryptology ePrint Archive, Report 2019/426. <a href="https://eprint.iacr.org/2019/426" target="_blank" rel="noopener noreferrer">https:</a> <a href="https://eprint.iacr.org/2019/426" target="_blank" rel="noopener noreferrer">//eprint.iacr.org/2019/426</a>. 2019.</li>
      <li>[2] Thomas Baigneres, Jacques Stern, and Serge Vaudenay. &quot;Linear cryptanalysis of non binary ciphers&quot;. In: International Workshop on Selected Areas in Cryptography. Springer. 2007, pp. 184&ndash;211.</li>
      <li>[3] Tim Beyne. &quot;Linear Cryptanalysis in the Weak Key Model&quot;. KU Leuven, 2019.</li>
      <li>[4] David Cox, John Little, and Donal OShea. Ideals, varieties, and algorithms: an introduction to computational algebraic geometry and commutative algebra. Springer Science &amp; Business Media, 2013.</li>
      <li>[5] Joan Daemen and Vincent Rijmen. &quot;Plateau characteristics&quot;. In: IET Information Security 1.1 (2007), pp. 11&ndash;17.</li>
      <li>[6] Joan Daemen and Vincent Rijmen. Probability distributions of Correlation and Differentials in Block Ciphers. Cryptology ePrint Archive, Report 2005/212. <a href="http://eprint.iacr.org/2005/212" target="_blank" rel="noopener noreferrer">http://eprint.iacr.org/2005/212</a>. 2005.</li>
      <li>[7] Joan Daemen and Vincent Rijmen. The Design of Rijndael: AES - The Advanced Encryption Standard. Information Security and Cryptography. Springer, 2002.</li>
      <li>[8] Joan Daemen and Vincent Rijmen. &quot;Understanding Two-Round Differentials in AES&quot;. In: SCN 06. Ed. by Roberto De Prisco and Moti Yung. Vol. 4116. LNCS. Springer, Heidelberg, Sept. 2006, pp. 78&ndash;94. doi: <a href="https://doi.org/10.1007/11832072_6" target="_blank" rel="noopener noreferrer">10.1007/11832072\\_6</a>.</li>
      <li>[9] Pierre Deligne. &quot;La conjecture de Weil : I&quot;. In: Publications Math&eacute;matiques de l'IH&Eacute;S 43 (1974), pp. 273&ndash;307. url: <a href="http://eudml.org/doc/103930" target="_blank" rel="noopener noreferrer">http://eudml.org/doc/103930</a>.</li>
      <li>[10] Philip Hawkes and Luke O'Connor. &quot;XOR and Non-XOR Differential Probabilities&quot;. In: EUROCRYPT'99. Ed. by Jacques Stern. Vol. 1592. LNCS. Springer, Heidelberg, May 1999, pp. 272&ndash;285. doi: <a href="https://doi.org/10.1007/3-540-48910-X_19" target="_blank" rel="noopener noreferrer">10.1007/3-540-48910-X\\_19</a>.</li>
      <li>[11] Seokhie Hong et al. &quot;Provable Security against Differential and Linear Cryptanalysis for the SPN Structure&quot;. In: FSE 2000. Ed. by Bruce Schneier. Vol. 1978. LNCS. Springer, Heidelberg, Apr. 2001, pp. 273&ndash;283. doi: <a href="https://doi.org/10.1007/3-540-44706-7_19" target="_blank" rel="noopener noreferrer">10.1007/3-540-</a> <a href="https://doi.org/10.1007/3-540-44706-7_19" target="_blank" rel="noopener noreferrer">44706-7\\_19</a>.</li>
      <li>[12] Nicholas M Katz. &quot;Estimates for singular exponential sums&quot;. In: International Mathematics Research Notices 1999.16 (1999), pp. 875&ndash;899.</li>
      <li>[13] Florian Mendel et al. &quot;The Rebound Attack: Cryptanalysis of Reduced Whirlpool and Gr&oslash;stl&quot;. In: FSE 2009. Ed. by Orr Dunkelman. Vol. 5665. LNCS. Springer, Heidelberg, Feb. 2009, pp. 260&ndash;276. doi: <a href="https://doi.org/10.1007/978-3-642-03317-9_16" target="_blank" rel="noopener noreferrer">10.1007/978-3-642-03317-9\\_16</a>.</li>
      <li>[14] Luke O'Connor. &quot;On the Distribution of Characteristics in Bijective Mappings&quot;. In: EUROCRYPT'93. Ed. by Tor Helleseth. Vol. 765. LNCS. Springer, Heidelberg, May 1994, pp. 360&ndash;370. doi: <a href="https://doi.org/10.1007/3-540-48285-7_31" target="_blank" rel="noopener noreferrer">10.1007/3-540-48285-7\\_31</a>.</li>
      <li>[15] Antonio Rojas Le&oacute;n. &quot;General Estimates for Exponential Sums&quot;. PhD thesis. Princeton University, 2004.</li>
      <li>[16] Andr&eacute; Weil. &quot;On some exponential sums&quot;. In: Proceedings of the National Academy of Sciences of the United States of America 34.5 (1948), p. 204.</li>
    </ul>

    <p class="text-gray-300"><strong>return</strong> True</p>

    <pre><code class="language-text">Listing 1: &quot;Check Round Constants&quot;
1 load ( &quot; rescue_constants . py&quot; )
3
4 def check_round_constants ( rcs=ROUND_CONSTANTS, mds=MDS_MATRIX, p=PRIME) :
5 &quot;&quot;&quot;
6 check minimal&minus;weight d i f feren t ia l s
7
8 returns true , i f no rc in rcs f u l f i l l s (wt( rc ) &lt; m AND wt(MDS^&minus;1 rc ) &lt; m) ,
9 i . e . the condition for two rounds of Rescue having d i f f e r en t ia l uniformity
10 of at least p
11
12 INPUT:
13
14 &minus; rcs : l i s t of l i s t of integer ; should contain ( r+1) round constants ,
15 where each round constant i s a l i s t of m integers /GF(p) elements
16 &minus; mds: MDS matrix used for the l inear layer . Either a l i s t of l i s t s ,
17 or a SageMath matrix object of dimension m x m.
18 &minus; p : the prime
19 &quot;&quot;&quot;
20 mds = matrix (GF(p ) , mds)
21 m = len( rcs [0 ] )
22
23 for i , rc in enumerate( rcs ) :
24 rc = vector (GF(p ) , rc )
25 wt_rc = len( rc . coe f f ic ien t s ( ) )
26 wt_mdsrc = len ( (mds. inverse ( ) * rc ) . coe f f ic ien t s ( ) )
27 i f (wt_rc &lt; m) or (wt_mdsrc &lt; m) :
28 print ( &quot; rc_%d = %s fa i led check : &quot; % ( i , rc ) )
29 print ( &quot;wt( rc_%d) = %d&quot; % ( i , wt_rc ) )
30 print ( &quot;wt(MDS^&minus;1 * rc_%d) = %d&quot; % ( i , wt_mdsrc ) )
31 return False
</code></pre>

`;
---

<BaseLayout title="On the security of the Rescue hash function (2020/820)">
  <article class="max-w-4xl mx-auto article-prose">
    <nav class="mb-8">
      <a href="/papers" class="text-blue-400 hover:text-blue-300">
        &larr; Back to Papers
      </a>
    </nav>

    <header class="mb-12">
      <h1 class="text-3xl font-bold mb-4"
        set:html={TITLE_HTML} />
      <p class="text-gray-400 mb-2"
        set:html={AUTHORS_HTML} />
      <p class="text-gray-500 text-sm mb-4">
        2020 &middot; eprint 2020/820
      </p>
      <div class="flex gap-4 text-sm">
        <a
          href={EPRINT_URL}
          target="_blank"
          rel="noopener noreferrer"
          class="text-blue-400 hover:text-blue-300"
        >
          Paper (eprint) &rarr;
        </a>
      </div>
      <PaperDisclaimer eprintUrl={EPRINT_URL} />
      <p class="mt-1 text-xs text-gray-600">
        Converted with: {CRAWLER} &middot; {CONVERTED_DATE}
      </p>
    </header>

    <nav id="toc" class="mb-10 p-6 rounded-lg" style="background: rgba(255,255,255,0.03); border: 1px solid rgba(255,255,255,0.06);">
      <h2 class="text-lg font-bold mb-4">Table of Contents</h2>
      <ol class="space-y-1 text-sm text-gray-300
        list-decimal list-inside">
        <li>
          <a href="#sec-1" class="hover:text-white">Summary of the results</a>
          <ol class="ml-6 mt-1 space-y-1 list-decimal
            list-inside text-gray-400">
            <li><a href="#sec-1.1" class="hover:text-white">Steps vs Rounds</a></li>
          </ol>
        </li>
        <li><a href="#sec-2" class="hover:text-white">The Rescue hash function</a></li>
        <li>
          <a href="#sec-3" class="hover:text-white">Linear Cryptanalysis</a>
          <ol class="ml-6 mt-1 space-y-1 list-decimal
            list-inside text-gray-400">
            <li><a href="#sec-3.1" class="hover:text-white">Upper Bounds for Linear Trails</a></li>
            <li><a href="#sec-3.2" class="hover:text-white">Upper Bounds for Four Rounds</a></li>
          </ol>
        </li>
        <li>
          <a href="#sec-4" class="hover:text-white">Differential Cryptanalysis</a>
          <ol class="ml-6 mt-1 space-y-1 list-decimal
            list-inside text-gray-400">
            <li><a href="#sec-4.1" class="hover:text-white">Two-round differentials</a></li>
            <li><a href="#sec-4.1.1" class="hover:text-white">Two-round MEDP</a></li>
            <li><a href="#sec-4.1.2" class="hover:text-white">Differential unformity distributions for two rounds and toy sizes</a></li>
            <li><a href="#sec-4.1.3" class="hover:text-white">Analysis of some minimal-weight differentials</a></li>
            <li><a href="#sec-4.2" class="hover:text-white">Four-round differentials and weak round-keys</a></li>
            <li><a href="#sec-4.3" class="hover:text-white">More Experimental Results</a></li>
            <li><a href="#sec-4.3.1" class="hover:text-white">On the Differential Uniformity of Random Permutations</a></li>
            <li><a href="#sec-4.3.2" class="hover:text-white">Experimental Results on Many Instances of Rescue</a></li>
          </ol>
        </li>
        <li>
          <a href="#sec-5" class="hover:text-white">Multiplicative Subgroups Analysis</a>
          <ol class="ml-6 mt-1 space-y-1 list-decimal
            list-inside text-gray-400">
            <li><a href="#sec-5.1" class="hover:text-white">The Setup</a></li>
            <li><a href="#sec-5.2" class="hover:text-white">The Effect of the Round Operations</a></li>
            <li><a href="#sec-5.2.1" class="hover:text-white">S-box Layer</a></li>
            <li><a href="#sec-5.2.2" class="hover:text-white">Constant addition by k</a></li>
            <li><a href="#sec-5.2.3" class="hover:text-white">Matrix Multiplication</a></li>
            <li><a href="#sec-5.3" class="hover:text-white">Diagonal Subgroups</a></li>
          </ol>
        </li>
        <li>
          <a href="#sec-6" class="hover:text-white">Rebound attacks for finding collisions</a>
          <ol class="ml-6 mt-1 space-y-1 list-decimal
            list-inside text-gray-400">
            <li><a href="#sec-6.1" class="hover:text-white">Example collision attack on 3 rounds</a></li>
            <li><a href="#sec-6.2" class="hover:text-white">Extension to 4 rounds</a></li>
            <li><a href="#sec-6.2.1" class="hover:text-white">Limit of the previous attack</a></li>
            <li><a href="#sec-6.2.2" class="hover:text-white">Property of the S-box S</a></li>
            <li><a href="#sec-6.2.3" class="hover:text-white">Exploiting the property and limits</a></li>
            <li><a href="#sec-6.3" class="hover:text-white">Conclusion</a></li>
          </ol>
        </li>
      </ol>
      <p class="text-xs text-gray-500 mt-4 mb-1 font-semibold">
        Appendices
      </p>
      <ol class="space-y-1 text-sm text-gray-400
        list-[upper-alpha] list-inside">
        <li><a href="#app-a" class="hover:text-white">Appendix</a></li>
      </ol>
      <p class="text-xs text-gray-500 mt-4 mb-1 font-semibold">
        Additional
      </p>
      <ul class="space-y-1 text-sm text-gray-400
        list-disc list-inside">
        <li><a href="#references" class="hover:text-white">References</a></li>
      </ul>
    </nav>


    <Fragment set:html={CONTENT} />

    <PaperHistory slug="on-the-security-of-the-rescue-hash-function-2020" />
  </article>
</BaseLayout>
