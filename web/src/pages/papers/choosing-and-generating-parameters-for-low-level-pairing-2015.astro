---
import BaseLayout from '../../layouts/BaseLayout.astro';

const EPRINT_URL = 'https://eprint.iacr.org/2015/1212';
const CRAWLER = 'mistral';
const CONVERTED_DATE = '2026-02-16';
const TITLE_HTML = 'Choosing and generating parameters for low level pairing implementation on BN curves';
const AUTHORS_HTML = 'Sylvain Duquesne, Nadia El Mrabet, Safia Haloui, Franck Rondepierre';

const CONTENT = `    <p class="text-gray-300">S. Duquesne, N. El Mrabet, S. Haloui, F. Rondepierre</p>

    <h6 id="sec-2" class="text-base font-medium mt-4">Abstract</h6>

    <p class="text-gray-300">Many hardware and software pairing implementations can be found in the literature and some pairing friendly parameters are given. However, depending on the situation, it could be useful to generate other nice parameters (e.g. resistance to subgroup attacks, larger security levels, database of pairing friendly curves). The main purpose of this paper is to describe explicitly and exhaustively what should be done to generate the best possible parameters and to make the best choices depending on the implementation context (in terms of pairing algorithm, ways to build the tower field, <span class="math">\\mathbb{F}_{p^{12}}</span> arithmetic, groups involved and their generators, system of coordinates).</p>

    <p class="text-gray-300">We focus on low level implementations, assuming that <span class="math">\\mathbb{F}_{p}</span> additions have a significant cost compared to other <span class="math">\\mathbb{F}_{p}</span> operations. However, the results obtained are still valid in the case where <span class="math">\\mathbb{F}_{p}</span> additions can be neglected. We also explain why the best choice for the polynomials defining the tower field <span class="math">\\mathbb{F}_{p^{12}}</span> is only depending on the value of the BN parameter <span class="math">u</span> modulo small integers like <span class="math">12</span> as a nice application of old elementary arithmetic results. Moreover, we use this opportunity to give some new improvements on <span class="math">\\mathbb{F}_{p^{12}}</span> arithmetic (in a pairing context) in terms of <span class="math">\\mathbb{F}_{p}</span>-addition allowing to save around <span class="math">10\\%</span> of them depending on the context.</p>

    <h2 id="sec-3" class="text-2xl font-bold">1 Introduction</h2>

    <p class="text-gray-300">Pairing based cryptography has now many practical applications such as short signature schemes <em>[12]</em>, identity based cryptography <em>[10]</em> or broadcast encryption <em>[11]</em>. Because of recent attacks on the discrete logarithm problem in small characteristic finite fields <em>[30, 4]</em>, it is now clear that prime base fields should be used to define pairing friendly elliptic curves. Many implementations, both hardware and software can be found in the literature and some pairing friendly parameters are given. For example, at the 128-bit security level, the parameters given in <em>[44]</em> are almost always used because they have many good properties, in particular in terms of efficiency. However, depending on the situation, it could be useful to generate other nice parameters (e.g. resistance to subgroup attacks <em>[38, 5]</em>, larger (or smaller) security levels, database of pairing friendly curves).</p>

    <p class="text-gray-300">This paper deals only with the case of BN curves because they are undoubtedly the best choice at the 128-bit security level, which is the most used today and in the near future, but also because they have many nice properties (e.g. maximal degree twists) that make them interesting even for higher security levels.</p>

    <p class="text-gray-300">The main purpose of this paper is to describe explicitly and exhaustively what should be done to generate the best possible parameters and to make the best choices depending on the implementation context. We focus on low level implementation (mainly hardware but also assembly language), assuming that <span class="math">\\mathbb{F}_p</span> additions have a significant cost compared to other <span class="math">\\mathbb{F}_p</span> operations, whereas they are usually neglected in the literature. However, the results obtained are still valid in the case where <span class="math">\\mathbb{F}_p</span> additions can be neglected. Most of the content of this paper already lies in the literature or in existing implementations but, even if it is not our initial purpose, we also give some new ideas to minimize the number of <span class="math">\\mathbb{F}_p</span> additions during the pairing computation. We also explain why the best choice for the polynomials defining the tower field <span class="math">\\mathbb{F}_{p^{12}}</span> is only depending on the value of the BN parameter <span class="math">u</span> modulo small integers like 12.</p>

    <p class="text-gray-300">The paper is organized as follows. In Section 2 we recall how the optimal Ate pairing on BN curves is computed. In Section 3 we present the different options to build <span class="math">\\mathbb{F}_{p^{12}}</span> and how to implement the basic operations. This includes the choice of the defining polynomials in terms of <span class="math">u</span>, the choice of the tower structure and the choice of the algorithms for basic arithmetic, depending on the relative cost of <span class="math">\\mathbb{F}_p</span> operations. In Section 4 we explain how to choose the BN parameter <span class="math">u</span>. Sections 5 and 6 are devoted to the choices inherent to the curve (coefficients, generators, system of coordinates). Finally, in Section 7 we recall the other algorithms that must be used for efficient implementation and adapt them to our context and to the results obtained in the previous sections.</p>

    <p class="text-gray-300">The following notations for <span class="math">\\mathbb{F}_{p^t}</span> arithmetic will be used:</p>

    <ul class="list-disc list-inside space-y-1 text-gray-300 my-2 ml-4">

      <li><span class="math">\\mathbf{A}_i</span> denotes an addition and <span class="math">\\mathbf{A}&#x27;_i</span> denotes a multiplication by 2,</li>

      <li><span class="math">\\mathbf{M}_i</span> denotes a multiplication (<span class="math">\\mathbf{M}_i^M</span> if the method <span class="math">M</span> is used),</li>

      <li><span class="math">\\mathbf{sM}_i</span> denotes a sparse multiplication,</li>

      <li><span class="math">\\mathbf{m}_{i,c}</span> denotes a multiplication by a constant <span class="math">c</span>,</li>

      <li><span class="math">\\mathbf{S}_i</span> denotes a squaring (<span class="math">\\mathbf{S}_i^M</span> if the method <span class="math">M</span> is used),</li>

      <li><span class="math">\\mathbf{I}_i</span> denotes an inversion.</li>

    </ul>

    <p class="text-gray-300">2</p>

    <h2 id="sec-5" class="text-2xl font-bold">2.1 BN curves</h2>

    <p class="text-gray-300">A Barreto-Naehrig (BN) curve [8] is an elliptic curve <span class="math">E</span> over a finite field <span class="math">\\mathbb{F}_p</span>, <span class="math">p \\geq 5</span>, with order <span class="math">r = \\# E(\\mathbb{F}_p)</span>, such that <span class="math">p</span> and <span class="math">r</span> are prime numbers given by</p>

    <div class="my-4 text-center"><span class="math-block">p = 36u^4 + 36u^3 + 24u^2 + 6u + 1,</span></div>

    <div class="my-4 text-center"><span class="math-block">r = 36u^4 + 36u^3 + 18u^2 + 6u + 1,</span></div>

    <p class="text-gray-300">for some <span class="math">u</span> in <span class="math">\\mathbb{Z}</span>. It has an equation of the form</p>

    <div class="my-4 text-center"><span class="math-block">y^2 = x^3 + b,</span></div>

    <p class="text-gray-300">where <span class="math">b \\in \\mathbb{F}_p^*</span>. Its neutral element is denoted by <span class="math">O_E</span>.</p>

    <p class="text-gray-300">BN curves have been designed to have an embedding degree equal to 12. This makes them particularly appropriate for the 128-bit security level. Indeed, a prime <span class="math">p</span> of size 256 bits leads to a BN curve whose group order is roughly 256 bits together with pairings taking values in <span class="math">\\mathbb{F}_{p^{12}}^*</span>, which is a 3072-bit multiplicative group. According to the NIST recommendations [45], both groups involved are matching the 128-bit security level. By the way, BN curves at this security level have been the object of numerous recent publications ([21, 2, 14, 24, 43, 27, 53]).</p>

    <p class="text-gray-300">Finally, BN curves always have degree 6 twists. If <span class="math">\\xi</span> is an element which is neither a square nor a cube in <span class="math">\\mathbb{F}_{p^2}</span>, the twisted curve <span class="math">E&#x27;</span> of <span class="math">E</span> is defined over <span class="math">\\mathbb{F}_{p^2}</span> by the equation</p>

    <div class="my-4 text-center"><span class="math-block">E&#x27;: y^2 = x^3 + b&#x27;,</span></div>

    <p class="text-gray-300">with <span class="math">b&#x27; = b / \\xi</span> or <span class="math">b&#x27; = b\\xi</span>. In order to simplify the computations, the element <span class="math">\\xi</span> should also be used to represent <span class="math">\\mathbb{F}_{p^{12}}</span> as a degree 6 extension of <span class="math">\\mathbb{F}_{p^2}</span> (<span class="math">\\mathbb{F}_{p^{12}} = \\mathbb{F}_{p^2}[\\gamma]</span> with <span class="math">\\gamma^6 = \\xi</span>) [21], [37]. In this paper, we deal only with the case <span class="math">b&#x27; = b / \\xi</span> as usually done in the literature but <span class="math">b&#x27; = b / \\xi^5</span> can be also used with a very small additional cost [27].</p>

    <h2 id="sec-6" class="text-2xl font-bold">2.2 Optimal Ate pairing</h2>

    <p class="text-gray-300">Let <span class="math">a</span> be an integer and <span class="math">Q \\neq O_E</span> be a point on <span class="math">E</span>. We denote by <span class="math">f_{a,Q}</span> the normalized function on the curve with divisor</p>

    <div class="my-4 text-center"><span class="math-block">\\operatorname{div}(f_{a,Q}) = a[Q] - [aQ] - (a - 1)[O_E].</span></div>

    <p class="text-gray-300">Such functions are the core of all known pairings. They are computed thanks to the Miller loop (described in Section 2.3), which is an adaptation of the classical scalar multiplication algorithm. For example, the (reduced) Tate pairing is defined by</p>

    <div class="my-4 text-center"><span class="math-block">e_T(P, Q) = f_{r,P}(Q)^{\\frac{p^{12} - 1}{r}}.</span></div>

    <p class="text-gray-300">There are many variants of the Tate pairing allowing to use a smaller value of <span class="math">a</span> in order to shorten the length of the Miller loop ([6, 29, 28, 39, 36, 54]). It has been proven in [54] that the shortest possible loop has length <span class="math">r / \\varphi(12) = r / 4</span> and that this length is reached by the so-called optimal Ate pairing.</p>

    <p class="text-gray-300">Let <span class="math">\\pi(x, y) = (x^p, y^p)</span> be the Frobenius map on the curve. If <span class="math">P</span> is a rational point on <span class="math">E</span> and <span class="math">Q</span> is a point in <span class="math">E\\left(\\mathbb{F}_{p^{12}}\\right)</span> which is in the <span class="math">p</span>-eigenspace of <span class="math">\\pi</span>, the optimal Ate pairing [43] can be defined by</p>

    <div class="my-4 text-center"><span class="math-block">a_{opt}(Q, P) = \\left(f_{v, Q}(P). \\ell_{v Q, \\pi(Q)}(P). \\ell_{v Q + \\pi(Q), - \\pi^{2}(Q)}(P)\\right)^{\\frac{p^{12} - 1}{r}},</span></div>

    <p class="text-gray-300">where <span class="math">v = 6u + 2</span> and <span class="math">\\ell_{A,B}</span> is the normalized line function arising in the sum of the points <span class="math">A</span> and <span class="math">B</span>.</p>

    <p class="text-gray-300">In this study, we are only considering this pairing because it makes no doubt that it is currently the most efficient for BN curves, but the same work can be easily done with other pairings. The computation of the optimal Ate pairing is done in four steps:</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">1. A Miller loop to compute $f_{</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">v</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">,Q}(P)$. The algorithmic choices for this step are discussed in Section 2.3.</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">

      <li>If <span class="math">v &amp;lt; 0</span>, the result <span class="math">f</span> of the Miller loop must be inverted to recover <span class="math">f_{v,Q}(P)</span>. Such an inversion is potentially expensive but thanks to the final exponentiation, <span class="math">f^{-1}</span> can be replaced by <span class="math">f^{p^6}</span> [2] which is nothing but the conjugation in <span class="math">\\mathbb{F}_{p^{12}} / \\mathbb{F}_{p^6}</span>, thus it is for free.</li>

      <li>Two line computations, <span class="math">\\ell_{vQ,\\pi (Q)}(P)</span> and <span class="math">\\ell_{vQ + \\pi (Q), - \\pi^2 (Q)}(P)</span> which are nothing but extra addition steps of the Miller loop.</li>

      <li>A final exponentiation to the power of <span class="math">\\frac{p^{12} - 1}{r}</span>. The algorithmic choices for this step are discussed in Section 2.4.</li>

    </ol>

    <p class="text-gray-300">Since BN curves have twists of order 6, a twisted version of the optimal Ate pairing allows to take <span class="math">Q</span> in <span class="math">E&#x27;(\\mathbb{F}_{p^2})</span>. Using the isomorphism between the curve and its twist, the point <span class="math">Q</span> in our definition of the optimal Ate pairing can then be chosen of the form <span class="math">(x_Q\\gamma^2,y_Q\\gamma^3)\\in E(\\mathbb{F}_{p^{12}})</span>, where <span class="math">x_{Q},y_{Q}\\in \\mathbb{F}_{p^{2}}</span> <span class="math">(x_{Q},y_{Q})\\in E&#x27;(\\mathbb{F}_{p^{2}})</span>. This means that elliptic curve operations lie in <span class="math">\\mathbb{F}_{p^2}</span> instead of <span class="math">\\mathbb{F}_{p^{12}}</span> (but the result remains in <span class="math">\\mathbb{F}_{p^{12}}</span>). Of course, this makes computations easier, but this also allows denominator elimination as in [7] because all the factors lying in a proper subfield of <span class="math">\\mathbb{F}_{p^{12}}</span> (as <span class="math">\\mathbb{F}_{p^2}</span>) are wiped out by the final exponentiation.</p>

    <h2 id="sec-7" class="text-2xl font-bold">2.3 The Miller loop</h2>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">The first step of the pairing computation evaluates $f_{</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">v</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">,Q}(P)<span class="math"> thanks to the Miller algorithm presented in Algorithm 1 and introduced in [40]. It is based on the double and add scheme used for the computation of </span></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">v</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Q<span class="math"> by evaluating at </span>P$ the</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">lines occurring in the doubling and addition steps of this computation. More precisely, it is based on Miller's formula given in the following Lemma, which can be proven by considering divisors.</p>

    <p class="text-gray-300">Lemma 1. For all  <span class="math">a, b \\in \\mathbb{Z}</span> ,  <span class="math">Q</span>  a point of  <span class="math">E</span> , we have</p>

    <div class="my-4 text-center"><span class="math-block">f _ {a + b, Q} = f _ {a, Q} f _ {b, Q} \\frac {\\ell_ {a Q , b Q}}{v _ {(a + b) Q}}</span></div>

    <p class="text-gray-300">where  <span class="math">\\ell_{aQ,bQ}</span>  is the equation of the line passing through the points  <span class="math">aQ</span>  and  <span class="math">bQ</span>  and  <span class="math">v_{(a + b)Q}</span>  is the equation of the vertical line passing through the point  <span class="math">(a + b)Q</span> .</p>

    <p class="text-gray-300">Remark 1. In the case of the optimal Ate pairing, the point  <span class="math">Q</span>  comes from the twisted curve. Hence its  <span class="math">x</span> -coordinate lies in a proper subfield of  <span class="math">\\mathbb{F}_{p^{12}}</span>  and  <span class="math">p \\in E(\\mathbb{F}_p)</span>  so that  <span class="math">v_{(a + b)Q}(P)</span>  also lies in a proper subfield of  <span class="math">\\mathbb{F}_{p^{12}}</span>  and then is wiped out by the final exponentiation. This is known as the denominator elimination optimisation [33]. Then we do not take  <span class="math">v_{(a + b)Q}</span>  into consideration in the following.</p>

    <p class="text-gray-300">Miller's algorithm makes use of Lemma 1 with  <span class="math">b = a</span>  (for doubling steps) or  <span class="math">b = 1</span>  (for addition steps) and is described by the pseudocode in Algorithm 1 assuming Remark 1.</p>

    <p class="text-gray-300">Algorithm 1: Miller(P, Q, a) Data:  <span class="math">a = (a_{n}\\dots a_{0})_{2},</span> <span class="math">P\\in E(\\mathbb{F}_p)</span> <span class="math">Q\\in E(\\mathbb{F}_{p^{12}})</span>  having its  <span class="math">x</span>  -coordinate in a proper subfield of  <span class="math">\\mathbb{F}_{p^{12}}</span>  Result:  <span class="math">\\lambda f_{a,Q}(P)\\in \\mathbb{F}_{p^{12}}^{*}</span>  with  <span class="math">\\lambda</span>  in a proper subfield of  <span class="math">\\mathbb{F}_{p^{12}}</span> <span class="math">T\\gets Q</span>  . <span class="math">f\\gets 1</span>  . for  <span class="math">i = n - 1</span>  to O do <span class="math">f\\gets f^2\\times \\ell_{T,T}(P);</span> <span class="math">T\\gets 2T</span>  . if  <span class="math">a_i = 1</span>  then <span class="math">f\\gets f\\times \\ell_{T,Q}(P);</span> <span class="math">T\\gets T + Q</span>  . end end return  <span class="math">f</span></p>

    <p class="text-gray-300">Several choices are possible for the system of coordinates in order to perform the operations over the elliptic curve during the Miller loop. We discuss them in Section 6.</p>

    <p class="text-gray-300">Since the Miller algorithm is based on the double and add algorithm, it is natural to try to improve it by using advanced exponentiation techniques like the sliding window method [17, Algo 9.10] or the NAF representation [17, Algo 9.14]. However, the interest is limited in practice for two reasons:</p>

    <ul class="list-disc list-inside space-y-1 text-gray-300 my-2 ml-4">

      <li>In the context of pairing based cryptography, the exponent is not a secret. Then it is usually chosen sparse so these advanced exponentiation methods are useless.</li>

      <li>Such methods involve operations like <span class="math">T \\leftarrow T + 3Q</span>. We need to compute <span class="math">f \\leftarrow f \\times f_{3,Q} \\times \\ell_{T,3Q}</span> to obtain the corresponding function. Of course, <span class="math">f_{3,Q}</span> can be precomputed but such a step requires an additional <span class="math">\\mathbb{F}_{p^{12}}</span> multiplication which is the most consuming operation in Algorithm 1.</li>

    </ul>

    <p class="text-gray-300">The only interesting case is a signed binary representation of the exponent (i.e. a 2-NAF) because it can help to find a sparse exponent. In this case, the subtraction step of Algorithm 1 is involving an additional division by the vertical line passing through <span class="math">Q</span> and <span class="math">-Q</span> which could be expensive, but fortunately it is wiped out by the final exponentiation if <span class="math">Q</span> comes from the twisted curve.</p>

    <h2 id="sec-8" class="text-2xl font-bold">2.4 The final exponentiation</h2>

    <p class="text-gray-300">As proposed in [33, 50] the cost of the final exponentiation can be reduced thanks to the integer factorization</p>

    <div class="my-4 text-center"><span class="math-block">\\frac{p^{12} - 1}{r} = \\left(p^6 - 1\\right) \\left(p^2 + 1\\right) \\left(\\frac{p^4 - p^2 + 1}{r}\\right).</span></div>

    <p class="text-gray-300">Since <span class="math">p</span> is the characteristic of <span class="math">\\mathbb{F}_{p^{12}}</span>, it is easy to compute the <span class="math">p^{\\mathrm{th}}</span>-power of any element in <span class="math">\\mathbb{F}_{p^{12}}</span>. More details about these Frobenius computations can be found in Section 7.1. Powering to the <span class="math">(p^6 - 1)(p^2 + 1)</span> is then called the easy part of the final exponentiation, even if an expensive inversion in <span class="math">\\mathbb{F}_{p^{12}}</span> is required.</p>

    <p class="text-gray-300">Powering to the <span class="math">\\frac{p^4 - p^2 + 1}{r}</span> is called the hard part of the final exponentiation. For this computation, the exponent is usually developed in base <span class="math">p</span> in order to use again cheap Frobenius computations ([49, 21, 50, 13, 23]), and the cost is around three times the cost of an exponentiation by <span class="math">u</span>.</p>

    <p class="text-gray-300">Moreover, as <span class="math">f</span> has been raised to the power of <span class="math">(p^6 - 1)(p^2 + 1)</span>, it has order dividing <span class="math">p^4 - p^2 + 1</span>. Then, as noticed in [26], it lies in the cyclotomic group <span class="math">G_{\\Phi_6}(\\mathbb{F}_{p^2})</span>. This has two important consequences for the efficiency of the computation:</p>

    <ul class="list-disc list-inside space-y-1 text-gray-300 my-2 ml-4">

      <li>Squaring is less expensive than a classical squaring in <span class="math">\\mathbb{F}_{p^{12}}</span> [26, 31] (more details are given in Section 7.2),</li>

      <li>Inversion is the same operation as raising to the power <span class="math">p^6</span>, which is nothing but the conjugation in <span class="math">\\mathbb{F}_{p^{12}} / \\mathbb{F}_{p^6}</span>, thus it is for free [49, 52].</li>

    </ul>

    <p class="text-gray-300">The most popular way to perform this hard part uses the following addition chain [50]:</p>

    <div class="my-4 text-center"><span class="math-block">f^{\\frac{p^4 - p^2 + 1}{r}} = y_0 y_1^2 y_2^6 y_3^{12} y_4^{18} y_5^{30} y_6^{36},</span></div>

    <p class="text-gray-300">where <span class="math">y_{0}=f^{p}f^{p^{2}}f^{p^{3}},\\quad y_{1}=\\frac{1}{f},\\quad y_{2}=\\left(f^{u^{2}}\\right)^{p^{2}},\\quad y_{3}=(f^{u})^{p},</span> <span class="math">y_{4}=\\frac{\\left(f^{u^{2}}\\right)^{p}}{f^{u}},\\quad y_{5}=\\frac{1}{f^{u^{2}}},\\quad y_{6}=\\frac{\\left(f^{u^{3}}\\right)^{p}}{f^{u^{3}}}.</span></p>

    <p class="text-gray-300">The cost of this method is <span class="math">13\\mathbf{M}_{12},4\\mathbf{S}_{12}</span> and 7 Frobenius maps in addition to the cost of 3 exponentiations by <span class="math">u</span>. The method given in <em>[13]</em> is slightly more efficient but computes a power of the optimal Ate pairing. The main drawback of these methods is that they are memory consuming (up to 4Ko), which can be annoying in restricted environments. Some variants of these methods optimized in terms of memory consumption are given in <em>[23]</em>.</p>

    <h2 id="sec-9" class="text-2xl font-bold">3 Choosing the finite fields and their arithmetic</h2>

    <h3 id="sec-10" class="text-xl font-semibold mt-8">3.1 <span class="math">\\mathbb{F}_{p}</span> arithmetic</h3>

    <p class="text-gray-300">In this paper, we assume that the basic operations in <span class="math">\\mathbb{F}_{p}</span> (additions, subtractions, multiplications) are already implemented. This multiple precision arithmetic is usually performed by combining the schoolbook method or the Karatsuba method <em>[32]</em> and the Montgomery reduction <em>[42]</em> or the Barrett reduction <em>[9]</em>.</p>

    <p class="text-gray-300">In the case where <span class="math">p</span> is taken to be a generalized Mersene prime <em>[51, 15]</em>, the field operations can be sped-up by exploiting the particular shape of <span class="math">p</span>. However, no general method to produce ordinary pairing-friendly elliptic curves with such <span class="math">p</span> is known, and moreover, using low weight primes could introduce weakness in pairing based cryptosystems <em>[48]</em>.</p>

    <p class="text-gray-300">As an alternative, several authors (e.g. <em>[22]</em>, <em>[14]</em>) proposed to use the Residue Number Systems (RNS) for pairing computation (an integer <span class="math">a</span> modulo <span class="math">p</span> is represented by <span class="math">(a_{1},\\ldots,a_{n})</span>, where <span class="math">a_{i}=a\\mod m_{i}</span>, for some well-chosen coprime integers <span class="math">m_{1},\\ldots,m_{n}</span>). The RNS allows a rather low cost for additions and multiplications, but on the other hand, the reduction step is expensive, so it is recommended to accumulate several operations before performing a reduction (this is called lazy reduction), which requires some extra memory.</p>

    <p class="text-gray-300">Anyway, the method used for <span class="math">\\mathbb{F}_{p}</span> arithmetic does not have direct consequences on the choices to be made for extension field or elliptic curve arithmetic. The only important criterion is the relative cost between the <span class="math">\\mathbb{F}_{p}</span> operations (<span class="math">\\mathbf{A}_{1}</span>, <span class="math">\\mathbf{A^{\\prime}}_{1}</span>, <span class="math">\\mathbf{M}_{1}</span>, <span class="math">\\mathbf{S}_{1}</span>, <span class="math">\\mathbf{I}_{1}</span>). One of the main purpose of this paper is to discuss the available choices depending on these ratios. We plan to cover most of the possible practical situations, so that we make the following assumptions:</p>

    <ul class="list-disc list-inside space-y-1 text-gray-300 my-2 ml-4">

      <li>Addition can be relatively expensive (<span class="math">\\mathbf{A}_{1}&lt;0.5\\mathbf{M}_{1}</span>). They are often neglected in theoretical studies but this should not be the case for real life implementations, especially in low level implementation where the most</li>

    </ul>

    <p class="text-gray-300">common ratios at the 128-bit security level are between 0.2 and 0.3 <em>[47, 25]</em>, but also in software implementation (for example, the ratio is 0.17 in the Microsoft ECC library <em>[46]</em> at the 128-bit security level). Therefore, the number of <span class="math">\\mathbb{F}_{p}</span> additions involved in extension field arithmetic must be taken into account and may have an influence on the choices to be made.</p>

    <ul class="list-disc list-inside space-y-1 text-gray-300 my-2 ml-4">

      <li>In order to stay in the most general case, we chose to use distinct symbols to denote an addition (<span class="math">\\mathbf{A}_{1}</span>) and a doubling (<span class="math">\\mathbf{A^{\\prime}}_{1}</span>). However, notice that we usually have <span class="math">\\mathbf{A^{\\prime}}_{1}=\\mathbf{A}_{1}</span>.</li>

      <li>If a specific algorithm for squaring is implemented, then <span class="math">\\mathbf{S}_{1}</span> is usually assumed to be <span class="math">0.8\\mathbf{M}_{1}</span>, else, a square is computed by doing a multiplication and <span class="math">\\mathbf{S}_{1}=\\mathbf{M}_{1}</span>.</li>

    </ul>

    <h3 id="sec-11" class="text-xl font-semibold mt-8">3.2 Arithmetic of <span class="math">\\mathbb{F}_{p^{2i}}/\\mathbb{F}_{p^{i}}</span></h3>

    <p class="text-gray-300">In theory, any irreducible quadratic polynomial can be used to build <span class="math">\\mathbb{F}_{p^{2i}}</span> over <span class="math">\\mathbb{F}_{p^{i}}</span>, but non-zero coefficients of this polynomial imply extra operations for <span class="math">\\mathbb{F}_{p^{2i}}</span> arithmetic. Therefore, <span class="math">\\mathbb{F}_{p^{2i}}</span> is usually built with a polynomial of the form <span class="math">X^{2}-\\mu</span>, where <span class="math">\\mu</span> is not a square in <span class="math">\\mathbb{F}_{p^{i}}</span>.</p>

    <p class="text-gray-300"><span class="math">\\mathbb{F}_{p^{2i}}=\\mathbb{F}_{p^{i}}[\\alpha]\\text{ with }\\alpha^{2}=\\mu.</span></p>

    <h4 id="sec-12" class="text-lg font-semibold mt-6">3.2.1 <span class="math">\\mathbb{F}_{p^{2i}}</span> addition</h4>

    <p class="text-gray-300">Whatever the choice for building <span class="math">\\mathbb{F}_{p^{2i}}</span>, an addition (resp. a multiplication by 2) always requires 2 <span class="math">\\mathbb{F}_{p^{i}}</span> additions (resp. multiplications by 2). In any case</p>

    <p class="text-gray-300"><span class="math">\\mathbf{A}_{2i}=2\\mathbf{A}_{i}\\text{ and }\\mathbf{A^{\\prime}}_{2i}=2\\mathbf{A^{\\prime}}_{i}.</span></p>

    <h4 id="sec-13" class="text-lg font-semibold mt-6">3.2.2 <span class="math">\\mathbb{F}_{p^{2i}}</span> multiplication</h4>

    <p class="text-gray-300">We will consider only two methods since the other methods do not reduce the overall complexity, independently of the relative cost of <span class="math">\\mathbb{F}_{p^{i}}</span> operations.</p>

    <h5 id="sec-14" class="text-base font-semibold mt-4">Schoolbook method.</h5>

    <p class="text-gray-300">The method computes as follows:</p>

    <p class="text-gray-300"><span class="math">(x_{0}+x_{1}\\alpha)(y_{0}+y_{1}\\alpha)=x_{0}y_{0}+\\mu x_{1}y_{1}+(x_{0}y_{1}+x_{1}y_{0})\\alpha</span></p>

    <p class="text-gray-300">and requires <span class="math">\\mathbf{M}_{2i}^{20}=4\\mathbf{M}_{i}+\\mathbf{m}_{i,\\mu}+2\\mathbf{A}_{i}</span>.</p>

    <h5 id="sec-15" class="text-base font-semibold mt-4">Karatsuba method.</h5>

    <p class="text-gray-300">The method is a standard variant of the schoolbook method. The evaluation is performed as follows:</p>

    <p class="text-gray-300"><span class="math">(x_{0}+x_{1}\\alpha)(y_{0}+y_{1}\\alpha)=x_{0}y_{0}+\\mu x_{1}y_{1}+((x_{0}+x_{1})(y_{0}+y_{1})-x_{0}y_{0}-x_{1}y_{1})\\alpha</span></p>

    <p class="text-gray-300">and requires <span class="math">\\mathbf{M}_{2i}^{K}=3\\mathbf{M}_{i}+\\mathbf{m}_{i,\\mu}+5\\mathbf{A}_{i}</span>.</p>

    <p class="text-gray-300">#####</p>

    <p class="text-gray-300">Remark 2.</p>

    <p class="text-gray-300">The schoolbook method should be preferred to the Karatsuba method when <span class="math">3\\mathbf{A}_{i} &amp;gt; \\mathbf{M}_{i}</span>.</p>

    <h2 id="sec-16" class="text-2xl font-bold">3.2.3 <span class="math">\\mathbb{F}_{p^{2i}}</span> squaring</h2>

    <p class="text-gray-300">In this case, we will additionally consider the complex method.</p>

    <p class="text-gray-300"><strong>Schoolbook method.</strong> In the squaring case, we get</p>

    <div class="my-4 text-center"><span class="math-block">(x_0 + x_1 \\alpha)^2 = x_0^2 + \\mu x_1^2 + 2 x_0 x_1 \\alpha</span></div>

    <p class="text-gray-300">which requires <span class="math">\\mathbf{S}_{2i}^{\\mathrm{op}} = \\mathbf{M}_i + 2\\mathbf{S}_i + \\mathbf{m}_{i,\\mu} + \\mathbf{A}_i + \\mathbf{A}&#x27;_i</span>.</p>

    <p class="text-gray-300"><strong>Karatsuba method.</strong> In the squaring case, we get</p>

    <div class="my-4 text-center"><span class="math-block">(x_0 + x_1 \\alpha)^2 = x_0^2 + \\mu x_1^2 + ((x_0 + x_1)^2 - x_0^2 - x_1^2) \\alpha</span></div>

    <p class="text-gray-300">which requires <span class="math">\\mathbf{S}_{2i}^{\\mathrm{e}} = 3\\mathbf{S}_i + \\mathbf{m}_{i,\\mu} + 4\\mathbf{A}_i</span>.</p>

    <p class="text-gray-300"><strong>Complex method.</strong> The method is particularly efficient if <span class="math">\\mu = -1</span>, which explains its name. It computes as follows:</p>

    <div class="my-4 text-center"><span class="math-block">(x_0 + x_1 \\alpha)^2 = (x_0 + \\mu x_1)(x_0 + x_1) - (\\mu + 1) x_0 x_1 + 2 x_0 x_1 \\alpha</span></div>

    <p class="text-gray-300">and requires <span class="math">\\mathbf{S}_{2i}^{\\mathrm{c}} = 2\\mathbf{M}_i + \\mathbf{m}_{i,\\mu} + \\mathbf{m}_{i,\\mu+1} + 3\\mathbf{A}_i + \\mathbf{A}&#x27;_i</span>.</p>

    <p class="text-gray-300"><strong>Remark 3.</strong> Determining which method is the best is not as easy as for multiplication in the general case because it depends on both the relative cost of <span class="math">\\mathbf{M}_i</span> and <span class="math">\\mathbf{A}_i</span> and of <span class="math">\\mathbf{M}_i</span> and <span class="math">\\mathbf{S}_i</span>. We postpone this question to Section 3.5 which discusses specific choices of <span class="math">\\mu</span>.</p>

    <h2 id="sec-17" class="text-2xl font-bold">3.2.4 <span class="math">\\mathbb{F}_{p^{2i}}</span> inversion</h2>

    <p class="text-gray-300">The <span class="math">\\mathbb{F}_{p^{2i}}</span> inversion is classically done thanks to the norm of an element</p>

    <div class="my-4 text-center"><span class="math-block">N = (x_0 + x_1 \\alpha)(x_0 - x_1 \\alpha) = x_0^2 - \\mu x_1^2 \\in \\mathbb{F}_p.</span></div>

    <p class="text-gray-300">We easily get the inverse of <span class="math">x_0 + x_1 \\alpha</span> as <span class="math">\\frac{x_0}{N} - \\frac{x_1}{N} \\alpha</span>. This way of computing an inverse in <span class="math">\\mathbb{F}_{p^{2i}}</span> requires</p>

    <div class="my-4 text-center"><span class="math-block">\\mathbf{I}_{2i} = \\mathbf{I}_i + 2\\mathbf{M}_i + 2\\mathbf{S}_i + \\mathbf{A}_i + \\mathbf{m}_{i,\\mu}.</span></div>

    <h2 id="sec-18" class="text-2xl font-bold">3.3 Arithmetic of <span class="math">\\mathbb{F}_{p^{3i}} / \\mathbb{F}_{p^i}</span></h2>

    <p class="text-gray-300">As in Section 3.2, it is preferable to choose a sparse polynomial to minimize the cost of <span class="math">\\mathbb{F}_{p^{3i}}</span> arithmetic. Thus, <span class="math">\\mathbb{F}_{p^{3i}}</span> is built as <span class="math">\\mathbb{F}_{p^i}[\\alpha]</span>, where <span class="math">\\alpha^3 = \\xi</span> for some <span class="math">\\xi</span> in <span class="math">\\mathbb{F}_{p^i}</span>. Of course, <span class="math">\\mathbb{F}_{p^{3i}}</span> arithmetic will involve some multiplications by <span class="math">\\xi</span>, so that <span class="math">\\xi</span> must be chosen carefully.</p>

    <p class="text-gray-300">10</p>

    <h2 id="sec-19" class="text-2xl font-bold">3.3.1  <span class="math">\\mathbb{F}_{p^{3i}}</span>  addition</h2>

    <p class="text-gray-300">Whatever the choice for building  <span class="math">\\mathbb{F}_{p^{3i}}</span> , an addition (resp. a multiplication by 2) always requires  <span class="math">3\\mathbb{F}_{p^i}</span>  additions (resp. multiplications by 2). So in any case</p>

    <div class="my-4 text-center"><span class="math-block">\\mathbf {A} _ {3 i} = 3 \\mathbf {A} _ {i} \\text{ and } \\mathbf {A} _ {3 i} ^ {\\prime} = 3 \\mathbf {A} _ {i} ^ {\\prime}.</span></div>

    <h2 id="sec-20" class="text-2xl font-bold">3.3.2  <span class="math">\\mathbb{F}_{p^{3i}}</span>  multiplication</h2>

    <p class="text-gray-300">Again, we give only the schoolbook and the Karatsuba methods because other methods (like Toom-Cook) require too many additions (and divisions by 2 or 3), which is contradictory with our assumptions (additions are not so negligible on real world devices).</p>

    <p class="text-gray-300"><strong>Schoolbook method.</strong> The method uses the following equality</p>

    <p class="text-gray-300">$$ \\begin{array}{l} (x _ {0} + x _ {1} \\alpha + x _ {2} \\alpha^ {2}) (y _ {0} + y _ {1} \\alpha + y _ {0} \\alpha^ {2}) = x _ {0} y _ {0} + \\xi (x _ {1} y _ {2} + x _ {2} y _ {1}) \\\\</p>

    <ul class="list-disc list-inside space-y-1 text-gray-300 my-2 ml-4">

      <li>\\left[ x _ {0} y _ {1} + x _ {1} y _ {0} + \\xi x _ {2} y _ {2} \\right] \\alpha \\\\</li>

      <li>\\left[ x _ {0} y _ {2} + y _ {2} x _ {0} + x _ {1} y _ {1} \\right] \\alpha^ {2}</li>

    </ul>

    <p class="text-gray-300">\\end{array} $$</p>

    <p class="text-gray-300">and requires  <span class="math">\\mathbf{M}_{3i}^{\\sigma i} = 9\\mathbf{M}_i + 2\\mathbf{m}_{i,\\xi} + 6\\mathbf{A}_i</span></p>

    <p class="text-gray-300"><strong>Karatsuba method.</strong> As in the case of quadratic extensions, the method allows to compute sums of products like  <span class="math">x_{1}y_{2} + x_{2}y_{1}</span>  with only one multiplication, assuming that  <span class="math">x_{1}y_{1}</span>  and  <span class="math">x_{2}y_{2}</span>  are already computed. The equality in the cubic case is</p>

    <p class="text-gray-300">$$ \\begin{array}{l} (x _ {0} + x _ {1} \\alpha + x _ {2} \\alpha^ {2}) (y _ {0} + y _ {1} \\alpha + y _ {2} \\alpha^ {2}) = x _ {0} y _ {0} + \\xi ((x _ {1} + x _ {2}) (y _ {1} + y _ {2}) - x _ {1} y _ {1} - x _ {2} y _ {2}) \\\\</p>

    <ul class="list-disc list-inside space-y-1 text-gray-300 my-2 ml-4">

      <li>\\left[ \\left(x _ {0} + x _ {1}\\right) \\left(y _ {0} + y _ {1}\\right) - x _ {0} y _ {0} - x _ {1} y _ {1} + \\xi x _ {2} y _ {2} \\right] \\alpha \\\\</li>

      <li>\\left[ \\left(x _ {0} + x _ {2}\\right) \\left(y _ {0} + y _ {2}\\right) - x _ {0} y _ {0} - x _ {2} y _ {2} + x _ {1} y _ {1} \\right] \\alpha^ {2}</li>

    </ul>

    <p class="text-gray-300">\\end{array} $$</p>

    <p class="text-gray-300">This means that  <span class="math">2\\mathbf{M}_i + \\mathbf{A}_i</span>  is replaced by  <span class="math">\\mathbf{M}_i + 4\\mathbf{A}_i</span>  three times. As in the case of quadratic extensions, the Karatsuba method then becomes interesting when  <span class="math">\\mathbf{M}_i \\geq 3\\mathbf{A}_i</span>  and requires  <span class="math">\\mathbf{M}_{3i}^n = 6\\mathbf{M}_i + 15\\mathbf{A}_i + 2\\mathbf{m}_{i,\\xi}</span> .</p>

    <p class="text-gray-300">We will also use in the following the Karatsuba method when one of the operands is sparse. If two coefficients are zero, the Karatsuba method has no interest but it can be used if one coefficient, say  <span class="math">y_{2}</span> , is zero. In this case, we have</p>

    <p class="text-gray-300">$$ \\begin{array}{l} (x _ {0} + x _ {1} \\alpha + x _ {2} \\alpha^ {2}) (y _ {0} + y _ {1} \\alpha) = x _ {0} y _ {0} + \\xi x _ {2} y _ {1} \\\\</p>

    <ul class="list-disc list-inside space-y-1 text-gray-300 my-2 ml-4">

      <li>\\left[ \\left(x _ {0} + x _ {1}\\right) \\left(y _ {0} + y _ {1}\\right) - x _ {0} y _ {0} - x _ {1} y _ {1} \\right] \\alpha \\\\</li>

      <li>\\left[ x _ {2} y _ {0} + x _ {1} y _ {1} \\right] \\alpha^ {2}</li>

    </ul>

    <p class="text-gray-300">\\end{array} $$</p>

    <p class="text-gray-300">which requires  <span class="math">\\mathbf{sM}_{3i}^{K} = 5\\mathbf{M}_{i} + 6\\mathbf{A}_{i} + \\mathbf{m}_{i,\\xi}</span></p>

    <p class="text-gray-300">3.3.3 Squaring</p>

    <p class="text-gray-300">The Schoolbook and Karatsuba squarings are deduced from the multiplication.</p>

    <p class="text-gray-300"><strong>Schoolbook method.</strong> The method uses the equality</p>

    <div class="my-4 text-center"><span class="math-block">(x_0 + x_1 \\alpha + x_2 \\alpha^2)^2 = x_0^2 + 2\\xi x_1 x_2 + \\left[ 2x_0 x_1 + \\xi x_2^2 \\right] \\alpha + \\left[ x_1^2 + 2x_0 x_2 \\right] \\alpha^2.</span></div>

    <p class="text-gray-300">Note that if we first compute <span class="math">2x_1</span>, only 2 multiplications by 2 are necessary to evaluate this formula, so the cost is <span class="math">\\mathbf{S}_{3i}^{\\mathcal{H}} = 3\\mathbf{M}_i + 3\\mathbf{S}_i + 3\\mathbf{A}_i + 2\\mathbf{A}&#x27;_i + 2\\mathbf{m}_{i,\\xi}</span>.</p>

    <p class="text-gray-300"><strong>Karatsuba Method.</strong> The method computes the double products involved in the schoolbook squaring using</p>

    <div class="my-4 text-center"><span class="math-block">2x_0 x_1 = (x_0 + x_1)^2 - x_0^2 - x_1^2.</span></div>

    <p class="text-gray-300">The complexity becomes <span class="math">\\mathbf{S}_{3i}^p = 6\\mathbf{S}_i + 12\\mathbf{A}_i + 2\\mathbf{m}_{i,\\xi}</span>.</p>

    <p class="text-gray-300"><strong>Chung-Hasan Method.</strong> We can also use the Chung-Hasan method [16] for squaring in degree 3 extensions. There are several variants but the most interesting in our context is to compute the term in <span class="math">\\alpha^2</span> in the schoolbook method using the formula</p>

    <div class="my-4 text-center"><span class="math-block">x_1^2 + 2x_0 x_2 = (x_0 + x_1 + x_2)^2 - (2x_0 x_1 + 2x_1 x_2 + x_0^2 + x_2^2).</span></div>

    <p class="text-gray-300">Computing this term requires <span class="math">\\mathbf{S}_i + 6\\mathbf{A}_i</span> instead of <span class="math">\\mathbf{M}_i + \\mathbf{S}_i + \\mathbf{A}_i + \\mathbf{A}&#x27;_i</span>, so the overall complexity is <span class="math">\\mathbf{S}_{3i}^{\\mathcal{H}} = 2\\mathbf{M}_i + 3\\mathbf{S}_i + 8\\mathbf{A}_i + \\mathbf{A}&#x27;_i + 2\\mathbf{m}_{i,\\xi}</span>.</p>

    <h2 id="sec-21" class="text-2xl font-bold">3.4 Building <span class="math">\\mathbb{F}_{p^{12}}</span></h2>

    <p class="text-gray-300">In this section, we discuss the ways to build the extension tower <span class="math">\\mathbb{F}_{p^{12}}</span> for pairings on BN curves. All the ways to build <span class="math">\\mathbb{F}_{p^{12}}</span> are mathematically equivalent. However, we will use this extension in the specific case of pairings on BN curves, which implies some constraints in order to allow other improvements for pairing computation.</p>

    <ul class="list-disc list-inside space-y-1 text-gray-300 my-2 ml-4">

      <li>As explained in Section 2.2, <span class="math">\\mathbb{F}_{p^{12}}</span> must be built as an extension of <span class="math">\\mathbb{F}_{p^2}</span> because of the use of a sextic twist. Indeed, the twisted curve is defined over <span class="math">\\mathbb{F}_{p^2}</span>.</li>

      <li><span class="math">\\mathbb{F}_{p^{12}}</span> must be built over <span class="math">\\mathbb{F}_{p^2}</span> with a polynomial <span class="math">X^6 - \\xi</span> where <span class="math">\\xi</span>, which is neither a square nor a cube, is the element used to define the twisted curve. This allows the line involved in the Miller algorithm to be a sparse element of <span class="math">\\mathbb{F}_{p^{12}}</span> (see Section 6 for more details).</li>

    </ul>

    <p class="text-gray-300">Then, <span class="math">\\mathbb{F}_{p^{12}}</span> should be built</p>

    <ul class="list-disc list-inside space-y-1 text-gray-300 my-2 ml-4">

      <li>Case 2, 2, 3: as a cubic extension of a quadratic extension of <span class="math">\\mathbb{F}_{p^2}</span>,</li>

    </ul>

    <p class="text-gray-300">11</p>

    <ul class="list-disc list-inside space-y-1 text-gray-300 my-2 ml-4">

      <li>Case <span class="math">2,3,2</span>: as a quadratic extension of a cubic extension of <span class="math">\\mathbb{F}_{p^{2}}</span>,</li>

      <li>Case <span class="math">2,6</span>: as a sextic extension of <span class="math">\\mathbb{F}_{p^{2}}</span>.</li>

    </ul>

    <p class="text-gray-300">The latter case is proved to be less efficient <em>[20]</em>, so we will only consider here the first two ones. In any case, we have</p>

    <p class="text-gray-300"><span class="math">\\mathbb{F}_{p^{12}}=\\mathbb{F}_{p^{2}}[\\gamma]\\text{ with }\\gamma^{6}=\\xi\\in\\mathbb{F}_{p^{2}}.</span></p>

    <p class="text-gray-300">In the case <span class="math">2,2,3</span>, we will use <span class="math">\\beta=\\gamma^{3}</span> to define <span class="math">\\mathbb{F}_{p^{4}}</span> and in the case <span class="math">2,3,2</span>, we will use <span class="math">\\beta=\\gamma^{2}</span> to define <span class="math">\\mathbb{F}_{p^{6}}</span>. These cases are studied in detail in Sections 3.6 and 3.7.</p>

    <p class="text-gray-300">Of course, <span class="math">\\xi</span> must be carefully chosen, since <span class="math">\\mathbb{F}_{p^{12}}</span> arithmetic will involve multiplications by <span class="math">\\xi</span> or <span class="math">\\beta</span>; this is the purpose of Section 3.8. But let us first give more details on the choice of <span class="math">\\mathbb{F}_{p^{2}}</span> and its arithmetic.</p>

    <h3 id="sec-22" class="text-xl font-semibold mt-8">3.5 Choice of <span class="math">\\mathbb{F}_{p^{2}}</span> and its arithmetic</h3>

    <p class="text-gray-300">As explained in Section 3.2, <span class="math">\\mathbb{F}_{p^{2}}</span> is built thanks to an element <span class="math">\\mu</span> which is not a square in <span class="math">\\mathbb{F}_{p}</span> so that</p>

    <p class="text-gray-300"><span class="math">\\mathbb{F}_{p^{2}}=\\mathbb{F}_{p}[\\alpha]\\text{ with }\\alpha^{2}=\\mu.</span></p>

    <p class="text-gray-300">According to Remark 2, the Karatsuba method for <span class="math">\\mathbb{F}_{p^{2}}</span> multiplication is better when <span class="math">\\mathbf{A}_{1}&lt;\\frac{1}{3}\\mathbf{M}_{1}</span>.</p>

    <p class="text-gray-300">Determining the best squaring algorithm is less simple. Let us first compare the schoolbook and the Karatsuba method. The difference between the complexities is <span class="math">\\mathbf{M}_{1}-\\mathbf{S}_{1}+\\mathbf{A^{\\prime}}_{1}-3\\mathbf{A}_{1}</span>. Assuming that <span class="math">\\mathbf{S}_{1}=\\mathbf{M}_{1}</span>, this difference becomes <span class="math">\\mathbf{A^{\\prime}}_{1}-3\\mathbf{A}_{1}</span> which is always negative. This means that the schoolbook method is always better. Assuming that <span class="math">\\mathbf{S}_{1}=0.8\\mathbf{M}_{1}</span>, the difference becomes <span class="math">0.2\\mathbf{M}_{1}+\\mathbf{A^{\\prime}}_{1}-3\\mathbf{A}_{1}</span> which is negative if <span class="math">\\mathbf{A}_{1}\\geq 0.1\\mathbf{M}_{1}</span> (and even less if <span class="math">\\mathbf{A^{\\prime}}_{1}</span> is assumed to be cheaper than <span class="math">\\mathbf{A}_{1}</span>). Thus the schoolbook method is also better in this case, unless if the addition in <span class="math">\\mathbb{F}_{p}</span> is really very efficient (<span class="math">\\mathbf{A}_{1}&lt;0.1\\mathbf{M}_{1}</span>). We then assume that the Karatsuba method for <span class="math">\\mathbb{F}_{p^{2}}</span> squaring has no (or very few) interest.</p>

    <p class="text-gray-300">Let us now compare the Schoolbook method and the complex method. In this case, the difference between the complexities is <span class="math">2\\mathbf{S}_{1}-\\mathbf{M}_{1}-2\\mathbf{A}_{1}-\\mathbf{m}_{1,\\mu+1}</span>. This means that the schoolbook method is generally better if <span class="math">\\mu</span> is randomly chosen (<span class="math">\\mathbf{m}_{1,\\mu+1}=\\mathbf{M}_{1}</span>). If <span class="math">\\mu</span> is chosen to be a small number, the conclusion is depending on this choice (more precisely on the cost of the multiplication by <span class="math">\\mu+1</span>). The choice of <span class="math">\\mu</span> is the object of Section 3.5.1.</p>

    <h4 id="sec-23" class="text-lg font-semibold mt-6">3.5.1 Choice of <span class="math">\\mu</span> and consequences on <span class="math">u</span></h4>

    <p class="text-gray-300">We focus on multiplications and squarings in <span class="math">\\mathbb{F}_{p^{2}}</span> because other operations such as inversions or additions are rare or independent of the choice of <span class="math">\\mu</span>. In order to have the best arithmetic, <span class="math">\\mu</span> must be chosen such that <span class="math">\\mathbf{m}_{1,\\mu}</span> and <span class="math">\\mathbf{m}_{1,\\mu+1}</span> are</p>

    <p class="text-gray-300">as cheap as possible. Since <span class="math">\\mu</span> has to be a non-square in <span class="math">\\mathbb{F}_p</span>, 0 and 1 must be avoided and the best choice is <span class="math">\\mu = -1</span>. If this choice is not possible, <span class="math">\\mu = \\pm 2</span> is also a good choice. Other choices are possible, even if they are of course more expensive. Let us now give more details on which values of <span class="math">\\mu</span> should be used to define <span class="math">\\mathbb{F}_{p^2}</span>, depending on <span class="math">u</span>. Further justifications are given in Appendix A.</p>

    <p class="text-gray-300"><strong>The case</strong> <span class="math">\\mathbb{F}_{p^2} = \\mathbb{F}_p[\\mathbf{i}]</span>. If <span class="math">\\mu = -1</span>, then <span class="math">\\mathbb{F}_{p^2}</span> can be seen as an analogue of the complex field and in this case <span class="math">\\alpha</span> is usually denoted by <span class="math">\\mathbf{i}</span>. In this situation, <span class="math">\\mathbf{m}_{1,\\mu}</span> and <span class="math">\\mathbf{m}_{1,\\mu + 1}</span> are both for free, but one can do even better because the complex method for squaring becomes</p>

    <div class="my-4 text-center"><span class="math-block">(a _ {0} + a _ {1} \\mathbf {i}) ^ {2} = (a _ {0} - a _ {1}) (a _ {0} + a _ {1}) + 2 a _ {0} a _ {1} \\mathbf {i}</span></div>

    <p class="text-gray-300">and requires <span class="math">2\\mathbf{M}_1 + 2\\mathbf{A}_1 + \\mathbf{A}&#x27;_1</span> which is faster than schoolbook or Karatsuba method in any case.</p>

    <p class="text-gray-300">Choosing <span class="math">\\mu = -1</span> is possible if and only if <span class="math">-1</span> is not a square in <span class="math">\\mathbb{F}_p</span>, which is equivalent to take <span class="math">u</span> odd, as proved in Proposition 1 of Appendix A.</p>

    <p class="text-gray-300"><strong>The case</strong> <span class="math">\\mathbb{F}_{p^2} = \\mathbb{F}_p[\\sqrt{-2}]</span>. In this case, <span class="math">\\mathbf{m}_{1,\\mu} = \\mathbf{A}&#x27;_1</span> and <span class="math">\\mathbf{m}_{1,\\mu + 1} = 0</span>. The complex method for computing a square in <span class="math">\\mathbb{F}_{p^2}</span> then requires <span class="math">2\\mathbf{M}_1 + 3\\mathbf{A}_1 + 2\\mathbf{A}&#x27;_1</span> whereas the schoolbook method needs <span class="math">\\mathbf{M}_1 + 2\\mathbf{S}_1 + \\mathbf{A}_1 + 2\\mathbf{A}&#x27;_1</span>. The difference between the complexities is <span class="math">2\\mathbf{S}_1 - \\mathbf{M}_1 - 2\\mathbf{A}_1</span>. The complex method is then always better if <span class="math">\\mathbf{S}_1 = \\mathbf{M}_1</span>. If <span class="math">\\mathbf{S}_1 = 0.8\\mathbf{M}_1</span>, the schoolbook method is better only if <span class="math">\\mathbf{A}_1 &amp;gt; 0.3\\mathbf{M}_1</span>.</p>

    <p class="text-gray-300">According to Proposition 1 of Appendix A, choosing <span class="math">\\mu = -2</span> is possible if and only if <span class="math">u = 1</span> or 2 modulo 4. However, if <span class="math">u = 1</span> modulo 4, choosing <span class="math">\\mu = -1</span> is more appropriate in terms of efficiency.</p>

    <p class="text-gray-300"><strong>The case</strong> <span class="math">\\mathbb{F}_{p^2} = \\mathbb{F}_p[\\sqrt{-5}]</span>. In this case, <span class="math">\\mathbf{m}_{1,\\mu} = 2\\mathbf{A}&#x27;_1 + \\mathbf{A}_1</span> and <span class="math">\\mathbf{m}_{1,\\mu + 1} = 2\\mathbf{A}&#x27;_1</span>. However, the complex method can be rewritten in a more efficient way</p>

    <div class="my-4 text-center"><span class="math-block">(a _ {0} + a _ {1} \\alpha) ^ {2} = (a _ {0} + a _ {1} + 2 a _ {1} ^ {\\prime}) (a _ {0} + a _ {1}) + 2 a _ {0} a _ {1} ^ {\\prime} + a _ {0} a _ {1} ^ {\\prime} \\alpha \\text{ with } a _ {1} ^ {\\prime} = 2 a _ {1}</span></div>

    <p class="text-gray-300">and then requires <span class="math">2\\mathbf{M}_1 + 4\\mathbf{A}_1 + 2\\mathbf{A}&#x27;_1</span> which is almost as good as the case <span class="math">\\mu = -2</span> and better than the schoolbook method (except if <span class="math">\\mathbf{A}&#x27;_1</span> is very small compared to <span class="math">\\mathbf{A}_1</span> and <span class="math">\\mathbf{S}_1 = 0.8\\mathbf{M}_1</span>).</p>

    <p class="text-gray-300">If <span class="math">u</span> is odd, it is better to choose <span class="math">\\mu = -1</span>, and if <span class="math">u = 2</span> modulo 4 it is better to choose <span class="math">\\mu = \\pm 2</span>, so we assume that <span class="math">u = 0</span> modulo 4. In this case, according to Proposition 1 of Appendix A, 5 and -5 are squares together when <span class="math">u = 0</span> or 4 modulo 5. Therefore, <span class="math">\\mu = -5</span> should be chosen when <span class="math">u = 8, 12</span> or 16 modulo 20.</p>

    <p class="text-gray-300">13</p>

    <ul class="list-disc list-inside space-y-1 text-gray-300 my-2 ml-4">

      <li>If  <span class="math">\\mu = -1</span>  and  <span class="math">\\mu = -2</span>  cannot be chosen to build  <span class="math">\\mathbb{F}_{p^2}</span> , then 2 cannot be chosen either. Moreover, choosing  <span class="math">\\mu = 2</span>  instead of  <span class="math">-2</span>  is less efficient for the complex method since  <span class="math">\\mu + 1 = 3</span>  instead of  <span class="math">-1</span> . Therefore, choosing  <span class="math">\\mu = 2</span>  has no interest.</li>

      <li>The same remark holds for  <span class="math">\\mu = 5</span> .</li>

      <li>The case  <span class="math">\\mu = 3</span>  is interesting at first glance because the complexity of the complex method is as good as when  <span class="math">\\mu = -2</span> . However, this choice can be done if and only if  <span class="math">u</span>  is odd, and in this case, choosing  <span class="math">\\mu = -1</span>  is more appropriate in terms of efficiency.</li>

      <li>Since  <span class="math">p = 1</span>  modulo 3 for BN primes,  <span class="math">-3</span>  is always a square in  <span class="math">\\mathbb{F}_p</span> , so it cannot be chosen to build  <span class="math">\\mathbb{F}_{p^2}</span> .</li>

    </ul>

    <p class="text-gray-300">Finally, the only interesting small values for  <span class="math">\\mu</span>  are  <span class="math">-1, -2</span>  and  <span class="math">-5</span>  and one of them can be used whenever  <span class="math">u \\neq 0</span>  or 4 modulo 20.</p>

    <p class="text-gray-300">We saw that we trivially have  <span class="math">\\mathbf{A}_2 = 2\\mathbf{A}_1</span>  and  <span class="math">\\mathbf{A}&#x27;_2 = 2\\mathbf{A}&#x27;_1</span>  whatever the choice made to build  <span class="math">\\mathbb{F}_{p^2}</span> . The situation is more complicated for  <span class="math">\\mathbf{M}_2</span>  and  <span class="math">\\mathbf{S}_2</span> ; it is summarized in Tables 1 and 2. In these tables SB, K and  <span class="math">\\mathbb{C}</span>  denote the method used.</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Assuming A1  0.33M1</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Assuming A1 > 0.33M1</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Condition</th>

          </tr>

        </thead>

        <tbody>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">-1</td>

            <td class="px-3 py-2 border-b border-gray-700">3M1 + 5A1 (K)</td>

            <td class="px-3 py-2 border-b border-gray-700">4M1 + 2A1 (SB)</td>

            <td class="px-3 py-2 border-b border-gray-700">u = 1 mod 2</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">-2</td>

            <td class="px-3 py-2 border-b border-gray-700">3M1 + 5A1 + A'1 (K)</td>

            <td class="px-3 py-2 border-b border-gray-700">4M1 + 2A1 + A'1 (SB)</td>

            <td class="px-3 py-2 border-b border-gray-700">u = 2 mod 4</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">-5</td>

            <td class="px-3 py-2 border-b border-gray-700">3M1 + 6A1 + 2A'1 (K)</td>

            <td class="px-3 py-2 border-b border-gray-700">4M1 + 3A1 + 2A'1 (SB)</td>

            <td class="px-3 py-2 border-b border-gray-700">u = 8, 12, 16 mod 20</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">any</td>

            <td class="px-3 py-2 border-b border-gray-700">4M1 + 5A1 (K)</td>

            <td class="px-3 py-2 border-b border-gray-700">5M1 + 2A1 (SB)</td>

            <td class="px-3 py-2 border-b border-gray-700">u = 0, 4 mod 20</td>

          </tr>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">Table 1: Complexities of  <span class="math">{\\mathbf{M}}_{2}</span>  depending on the way to build  <span class="math">{\\mathbb{F}}_{p}{}^{2}</span></p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Assuming S1 = M1 or S1 = 0.8M1, A1  0.3M1</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Assuming S1 = 0.8M1, A1 > 0.3M1</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Condition</th>

          </tr>

        </thead>

        <tbody>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">-1</td>

            <td class="px-3 py-2 border-b border-gray-700">2M1 + 2A1 + A'1 (C)</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">u = 1 mod 2</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">-2</td>

            <td class="px-3 py-2 border-b border-gray-700">2M1 + 3A1 + 2A'1 (C)</td>

            <td class="px-3 py-2 border-b border-gray-700">M1 + 2S1 + A1 + 2A'1 (SB)</td>

            <td class="px-3 py-2 border-b border-gray-700">u = 2 mod 4</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">-5</td>

            <td class="px-3 py-2 border-b border-gray-700">2M1 + 4A1 + 2A'1 (C)</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">u = 8, 12, 16 mod 20</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">any</td>

            <td class="px-3 py-2 border-b border-gray-700">2M1 + 2S1 + A1 + A'1 (SB)</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">u = 0, 4 mod 20</td>

          </tr>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">Table 2: Complexities of  <span class="math">{\\mathbf{S}}_{2}</span>  depending on the way to build  <span class="math">{\\mathbb{F}}_{p}{}^{2}</span></p>

    <p class="text-gray-300">Remark 4. The influence of the relative cost of  <span class="math">\\mathbf{A}&#x27;_1</span>  compared to  <span class="math">\\mathbf{A}_1</span>  is small and even negligible, even if  <span class="math">-2</span>  is chosen to define  <span class="math">\\mathbb{F}_{p^2}</span></p>

    <p class="text-gray-300">Thanks to Tables 1 and 2, it is easy to choose the best algorithm for  <span class="math">\\mathbb{F}_{p^2}</span>  multiplication and squaring depending on the context (relative cost of  <span class="math">\\mathbb{F}_p</span>  operations, choice of  <span class="math">u</span> ).</p>

    <h3 id="sec-26" class="text-xl font-semibold mt-8">3.6 Choice of <span class="math">\\mathbb{F}_{p^{12}}</span> arithmetic in the case <span class="math">2,3,2</span></h3>

    <p class="text-gray-300">We assume that <span class="math">\\mathbb{F}_{p^{12}}</span> is built over <span class="math">\\mathbb{F}_{p^{2}}</span> via <span class="math">\\mathbb{F}_{p^{6}}</span>, using some <span class="math">\\xi</span> which is neither a square nor a cube in <span class="math">\\mathbb{F}_{p^{2}}</span>:</p>

    <p class="text-gray-300"><span class="math">\\mathbb{F}_{p^{6}}=\\mathbb{F}_{p^{2}}[\\beta]\\text{ where }\\beta^{3}=\\xi\\text{ and }\\mathbb{F}_{p^{12}}=\\mathbb{F}_{p^{6}}[\\gamma]\\text{ with }\\gamma^{2}=\\beta.</span></p>

    <h4 id="sec-27" class="text-lg font-semibold mt-6">3.6.1 <span class="math">\\mathbb{F}_{p^{6}}</span> arithmetic</h4>

    <p class="text-gray-300">We saw in Section 3.3.2 that the Karatsuba method becomes interesting when <span class="math">\\mathbf{M}_{2}\\geq 3\\mathbf{A}_{2}</span>. Regarding Table 1, this condition is clearly always satisfied. Therefore, the Karatsuba method should always be used for <span class="math">\\mathbb{F}_{p^{6}}/\\mathbb{F}_{p^{2}}</span> multiplications and</p>

    <p class="text-gray-300"><span class="math">\\mathbf{M}_{6}=6\\mathbf{M}_{2}+15\\mathbf{A}_{2}+2\\mathbf{m}_{2,\\xi}.</span></p>

    <p class="text-gray-300">It is also easy to study the difference between the complexities of the schoolbook, the Karastuba and the Chung-Hasan methods and to conclude that the latter is better in each case of Tables 1 and 2. Therefore, the Chung-Hasan method should always be use for <span class="math">\\mathbb{F}_{p^{6}}/\\mathbb{F}_{p^{2}}</span> squaring so</p>

    <p class="text-gray-300"><span class="math">\\mathbf{S}_{6}=2\\mathbf{M}_{2}+3\\mathbf{S}_{2}+8\\mathbf{A}_{2}+\\mathbf{A^{\\prime}}_{2}+2\\mathbf{m}_{2,\\xi}.</span></p>

    <h4 id="sec-28" class="text-lg font-semibold mt-6">3.6.2 <span class="math">\\mathbb{F}_{p^{12}}</span> arithmetic</h4>

    <p class="text-gray-300">We obviously have <span class="math">\\mathbf{A}_{12}=2\\mathbf{A}_{6}=12\\mathbf{A}_{1}</span> and <span class="math">\\mathbf{A^{\\prime}}_{12}=2\\mathbf{A^{\\prime}}_{6}=12\\mathbf{A^{\\prime}}_{1}</span>.</p>

    <h5 id="sec-29" class="text-base font-semibold mt-4"><span class="math">\\mathbb{F}_{p^{12}}</span> multiplication.</h5>

    <p class="text-gray-300">According to Section 3.2, the Karatsuba method is better than the schoolbook method when <span class="math">3\\mathbf{A}_{6}&lt;\\mathbf{M}_{6}</span>, which is obviously always the case according to 3.6.1. The <span class="math">\\mathbb{F}_{p^{6}}</span> multiplication by <span class="math">\\beta</span> involved in Karatsuba formulas is given by</p>

    <p class="text-gray-300"><span class="math">\\left(b_{0}+b_{1}\\beta+b_{2}\\beta^{2}\\right)\\beta=\\xi b_{2}+b_{0}\\beta+b_{1}\\beta^{2},</span></p>

    <p class="text-gray-300">thus <span class="math">\\mathbf{m}_{6,\\beta}=\\mathbf{m}_{2,\\xi}</span>. Finally, the Karatsuba method should always be used for <span class="math">\\mathbb{F}_{p^{12}}/\\mathbb{F}_{p^{6}}</span> multiplications and</p>

    <p class="text-gray-300"><span class="math">\\mathbf{M}_{12}=18\\mathbf{M}_{2}+60\\mathbf{A}_{2}+7\\mathbf{m}_{2,\\xi}.</span></p>

    <h5 id="sec-30" class="text-base font-semibold mt-4"><span class="math">\\mathbb{F}_{p^{12}}</span> sparse multiplication.</h5>

    <p class="text-gray-300">During the Miller loop for the optimal Ate pairing, one of the operands (the line <span class="math">\\ell</span>) is sparse but the conclusion remains the same: the Karatsuba method should be preferred for multiplications at all levels, assuming that at least two coefficients are non-zero. More precisely, as explained in Section 6, <span class="math">\\ell</span> is of the form <span class="math">b_{0}+b_{1}\\gamma+b_{3}\\gamma^{3}</span>, where <span class="math">b_{i}\\in\\mathbb{F}_{p^{2}}</span>. With our notations, it can be written <span class="math">\\ell=b_{0}+(b_{1}+b_{3}\\beta)\\gamma</span>. The Karatsuba multiplication in <span class="math">\\mathbb{F}_{p^{12}}</span> between <span class="math">\\ell</span> and <span class="math">c_{0}+c_{1}\\gamma</span> is given by</p>

    <p class="text-gray-300"><span class="math">b_{0}c_{0}+(b_{1}+b_{3}\\beta)c_{1}\\beta+\\left(\\left(b_{0}+b_{1}+b_{3}\\beta\\right)(c_{0}+c_{1})-b_{0}c_{0}-\\left(b_{1}+b_{3}\\beta\\right)c_{1}\\right)</span> (1)</p>

    <p class="text-gray-300">and requires</p>

    <ul class="list-disc list-inside space-y-1 text-gray-300 my-2 ml-4">

      <li>one multiplication of <span class="math">c_0 \\in \\mathbb{F}_{p^6}</span> by <span class="math">b_0 \\in \\mathbb{F}_{p^2}</span> which trivially costs <span class="math">3\\mathbf{M}_2</span>,</li>

      <li>one multiplication of <span class="math">c_1 \\in \\mathbb{F}_{p^6}</span> by <span class="math">b_1 + b_3\\beta</span>. It is done thanks to the sparse Karatsuba multiplication given in Section 3.3 and costs <span class="math">5\\mathbf{M}_2 + 6\\mathbf{A}_2 + \\mathbf{m}_{2,\\xi}</span>,</li>

      <li><span class="math">4\\mathbf{A}_2</span> to compute <span class="math">b_0 + b_1</span> and <span class="math">c_0 + c_1</span>,</li>

      <li>one multiplication of <span class="math">c_0 + c_1</span> by <span class="math">b_0 + b_1 + b_3\\beta</span> which is the same as the one of <span class="math">c_1</span> by <span class="math">b_1 + b_3\\beta</span>,</li>

      <li>one <span class="math">\\mathbf{m}_{6,\\beta} = \\mathbf{m}_{2,\\xi}</span> and <span class="math">3\\mathbf{A}_6</span> to compute the final result.</li>

    </ul>

    <p class="text-gray-300">Hence a <span class="math">\\mathbb{F}_{p^{12}}</span> sparse multiplication requires</p>

    <div class="my-4 text-center"><span class="math-block">\\mathbf{s M}_{12} = 13\\mathbf{M}_2 + 25\\mathbf{A}_2 + 3\\mathbf{m}_{2,\\xi}.</span></div>

    <p class="text-gray-300"><span class="math">\\mathbb{F}_{p^{12}}</span> squaring. Let us now compare the schoolbook and the Karatsuba methods for squaring in <span class="math">\\mathbb{F}_{p^{12}} / \\mathbb{F}_{p^6}</span>. Using the complexities obtained for <span class="math">\\mathbf{M}_6</span> and <span class="math">\\mathbf{S}_6</span> in 3.6.1, the difference between the complexities is</p>

    <div class="my-4 text-center"><span class="math-block">\\mathbf{S}_{12}^{\\kappa} - \\mathbf{S}_{12}^{\\infty} = 3\\mathbf{S}_2 - 4\\mathbf{M}_2 + 2\\mathbf{A}_2 - 2\\mathbf{A}_2&#x27; + \\mathbf{m}_{2,\\xi}.</span></div>

    <p class="text-gray-300">Using Tables 1 and 2, we can easily verify that this difference is negative in all the cases we have considered even if <span class="math">\\mathbf{m}_{2,\\xi} = \\mathbf{M}_2</span> (which is obviously the worst case for <span class="math">\\mathbf{m}_{2,\\xi}</span>). Therefore, the schoolbook method should not be used.</p>

    <p class="text-gray-300">We have now to compare the Karatsuba and the complex methods for squaring in <span class="math">\\mathbb{F}_{p^{12}} / \\mathbb{F}_{p^6}</span>. Using the complexities obtained for <span class="math">\\mathbf{M}_6</span> and <span class="math">\\mathbf{S}_6</span> in 3.6.1 and assuming that <span class="math">\\mathbf{m}_{6,\\beta + 1} = \\mathbf{A}_6 + \\mathbf{m}_{6,\\beta} = \\mathbf{A}_6 + \\mathbf{m}_{2,\\xi}</span>, the difference between the complexities is</p>

    <div class="my-4 text-center"><span class="math-block">\\Delta = \\mathbf{S}_{12}^{\\kappa} - \\mathbf{S}_{12}^{c} = 9\\mathbf{S}_2 - 6\\mathbf{M}_2 - 6\\mathbf{A}_2 + \\mathbf{m}_{2,\\xi}</span></div>

    <p class="text-gray-300">The sign of <span class="math">\\Delta</span> depends on the value of <span class="math">\\mu</span>. Again, we do not give all the details but thanks to Tables 1 and 2, we can determine that</p>

    <ul class="list-disc list-inside space-y-1 text-gray-300 my-2 ml-4">

      <li>The Karatsuba method should be used if <span class="math">\\mu = -1, -5</span> and if <span class="math">\\mu = -2</span> with <span class="math">\\mathbf{A}_1 \\leq 0.33\\mathbf{M}_1</span> or <span class="math">\\mathbf{S}_1 = 0.8\\mathbf{M}_1</span> and in this case</li>

    </ul>

    <div class="my-4 text-center"><span class="math-block">\\mathbf{S}_{12} = 6\\mathbf{M}_2 + 9\\mathbf{S}_2 + 36\\mathbf{A}_2 + 3\\mathbf{A}_2&#x27; + 7\\mathbf{m}_{2,\\xi}.</span></div>

    <ul class="list-disc list-inside space-y-1 text-gray-300 my-2 ml-4">

      <li>The complex method should be used if <span class="math">\\mu</span> is not small and if <span class="math">\\mu = -2</span> with <span class="math">\\mathbf{A}_1 &amp;gt; 0.33\\mathbf{M}_1</span> and <span class="math">\\mathbf{S}_1 = \\mathbf{M}_1</span> and in this case</li>

    </ul>

    <div class="my-4 text-center"><span class="math-block">\\mathbf{S}_{12} = 12\\mathbf{M}_2 + 42\\mathbf{A}_2 + 3\\mathbf{A}_2&#x27; + 6\\mathbf{m}_{2,\\xi}.</span></div>

    <h2 id="sec-31" class="text-2xl font-bold">3.7 Choice of <span class="math">\\mathbb{F}_{p^{12}}</span> arithmetic in the case 2, 2, 3</h2>

    <p class="text-gray-300">We assume that <span class="math">\\mathbb{F}_{p^{12}}</span> is built over <span class="math">\\mathbb{F}_{p^2}</span> via <span class="math">\\mathbb{F}_{p^4}</span>, using some <span class="math">\\xi</span> which is neither a square nor a cube in <span class="math">\\mathbb{F}_{p^2}</span>:</p>

    <div class="my-4 text-center"><span class="math-block">\\mathbb{F}_{p^4} = \\mathbb{F}_{p^2}[\\beta] \\text{ where } \\beta^2 = \\xi \\text{ and } \\mathbb{F}_{p^{12}} = \\mathbb{F}_{p^4}[\\gamma] \\text{ with } \\gamma^3 = \\beta.</span></div>

    <p class="text-gray-300">We saw in Section 3.2.2 that the Karatsuba method becomes interesting when  <span class="math">\\mathbf{M}_2 \\geq 3\\mathbf{A}_2 = 6\\mathbf{A}_1</span> . Regarding Table 1, this condition is clearly always satisfied.</p>

    <p class="text-gray-300">Therefore, the Karatsuba method should always be used for  <span class="math">\\mathbb{F}_{p^4} / \\mathbb{F}_{p^2}</span>  multiplications and</p>

    <div class="my-4 text-center"><span class="math-block">\\mathbf {M} _ {4} = 3 \\mathbf {M} _ {2} + 5 \\mathbf {A} _ {2} + \\mathbf {m} _ {2, \\xi}.</span></div>

    <p class="text-gray-300">Concerning the squaring, all the methods are close in terms of complexity. We do not give details here, but thanks to Tables 1 and 2, we can decide which method is preferable to use, depending on the context. The Karatsuba method is usually the best and this is summarized in Table 3.</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">condition</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">method</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">complexity</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">|  assuming A1  0.33M1  |   |   |   |</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">-1, -2 or -5 any</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">K C</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">3S2 + m2, + 4A2 2M2 + m2, + m2,+1 + 3A2 + A'2</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">|  assuming A1 > 0.33M1  |   |   |   |</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">-1 or -5</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">K</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">3S2 + m2, + 4A2</th>

          </tr>

        </thead>

        <tbody>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">any</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">SB</td>

            <td class="px-3 py-2 border-b border-gray-700">M2 + 2S2 + m2, + A2 + A'2</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">-2 or any</td>

            <td class="px-3 py-2 border-b border-gray-700">S1 = M1</td>

            <td class="px-3 py-2 border-b border-gray-700">C</td>

            <td class="px-3 py-2 border-b border-gray-700">2M2 + m2, + m2,+1 + 3A2 + A'2</td>

          </tr>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">Table 3: Complexities of  <span class="math">{\\mathbf{S}}_{4}</span>  depending on the context</p>

    <p class="text-gray-300">We also have  <span class="math">\\mathbf{A}_{12} = 12\\mathbf{A}_1</span>  and  <span class="math">\\mathbf{A}&#x27;_{12}12\\mathbf{A}&#x27;_1</span>  in this case.</p>

    <p class="text-gray-300"><span class="math">\\mathbb{F}_{p^{12}}</span>  multiplication. According to Section 3.3, the Karatsuba method is better than the schoolbook method for multiplications in  <span class="math">\\mathbb{F}_{p^{12}} / \\mathbb{F}_{p^4}</span>  when  <span class="math">3\\mathbf{A}_4 &amp;lt; \\mathbf{M}_4</span> , which is obviously always the case according to Section 3.7.1. The  <span class="math">\\mathbb{F}_{p^4}</span>  multiplication by  <span class="math">\\beta</span>  involved in Karatsuba formulas is given by</p>

    <div class="my-4 text-center"><span class="math-block">\\left(b _ {0} + b _ {1} \\beta\\right) \\beta = \\xi b _ {1} + b _ {0} \\beta ,</span></div>

    <p class="text-gray-300">thus  <span class="math">\\mathbf{m}_{4,\\beta} = \\mathbf{m}_{2,\\xi}</span> . Therefore, the Karatsuba method should always be used for  <span class="math">\\mathbb{F}_{p^{12}} / \\mathbb{F}_{p^4}</span>  multiplications and</p>

    <div class="my-4 text-center"><span class="math-block">\\mathbf {M} _ {1 2} = 1 8 \\mathbf {M} _ {2} + 6 0 \\mathbf {A} _ {2} + 8 \\mathbf {m} _ {2, \\xi}.</span></div>

    <p class="text-gray-300"><span class="math">\\mathbb{F}_{p^{12}}</span>  sparse multiplication. Again, the Karatsuba method should be preferred for multiplications at all levels when one of the operands is sparse. With our notations, the sparse element involved in the Miller loop can be written</p>

    <p class="text-gray-300"><span class="math">\\ell=b_{0}+b_{3}\\beta+b_{1}\\gamma</span>. We use the sparse Karatsuba multiplication given in Section 3.3 to compute the product of <span class="math">\\ell</span> and <span class="math">c_{0}+c_{1}\\gamma+c_{2}\\gamma^{2}\\in\\mathbb{F}_{p^{12}}</span></p>

    <p class="text-gray-300"><span class="math">(c_{0}+c_{1}\\gamma+c_{2}\\gamma^{2})((b_{0}+b_{3}\\beta)+b_{1}\\gamma)</span> <span class="math">=c_{0}(b_{0}+b_{3}\\beta)+\\beta c_{2}b_{1}</span> <span class="math">+[(c_{0}+c_{1})(b_{0}+b_{3}\\beta+b_{1})-c_{0}(b_{0}+b_{3}\\beta)-c_{1}b_{1}]\\gamma</span> <span class="math">+[c_{2}(b_{0}+b_{3}\\beta)+c_{1}b_{1}]\\gamma^{2}</span> (2)</p>

    <p class="text-gray-300">It requires</p>

    <ul class="list-disc list-inside space-y-1 text-gray-300 my-2 ml-4">

      <li>Two multiplications of <span class="math">c_{1}</span> (or <span class="math">c_{2})\\in\\mathbb{F}_{p^{4}}</span> by <span class="math">b_{1}\\in\\mathbb{F}_{p^{2}}</span> which trivially cost <span class="math">2\\mathbf{M}_{2}</span> each.</li>

      <li>Three <span class="math">\\mathbb{F}_{p^{4}}</span> multiplications which are done thanks to the Karatsuba method and cost <span class="math">3\\mathbf{M}_{2}+5\\mathbf{A}_{2}+\\mathbf{m}_{2,\\xi}</span>.</li>

      <li><span class="math">3\\mathbf{A}_{2}</span> to compute <span class="math">b_{0}+b_{1}</span> and <span class="math">c_{0}+c_{1}</span>.</li>

      <li>One <span class="math">\\mathbf{m}_{4,\\beta}=\\mathbf{m}_{2,\\xi}</span> and <span class="math">4\\mathbf{A}_{4}</span> to compute the final result.</li>

    </ul>

    <p class="text-gray-300">Hence a <span class="math">\\mathbb{F}_{p^{12}}</span> sparse multiplication requires</p>

    <p class="text-gray-300"><span class="math">\\mathbf{sM}_{12}=13\\mathbf{M}_{2}+26\\mathbf{A}_{2}+4\\mathbf{m}_{2,\\xi}.</span></p>

    <h4 id="sec-34" class="text-lg font-semibold mt-6"><span class="math">\\mathbb{F}_{p^{12}}</span> squaring.</h4>

    <p class="text-gray-300">We do not give details here because it would be repetitive after previous sections but it is easy to study the difference between the complexities of the schoolbook, the Karastuba and the Chung-Hasan methods and to conclude that the latter is always better. Therefore, the Chung-Hasan method should always be used for <span class="math">\\mathbb{F}_{p^{12}}/\\mathbb{F}_{p^{4}}</span> squaring and</p>

    <p class="text-gray-300"><span class="math">\\mathbf{S}_{12}=3\\mathbf{S}_{4}+6\\mathbf{M}_{2}+26\\mathbf{A}_{2}+2\\mathbf{A^{\\prime}}_{2}+4\\mathbf{m}_{2,\\xi}.</span></p>

    <h3 id="sec-35" class="text-xl font-semibold mt-8">3.8 Choice of <span class="math">\\xi</span> and consequences on <span class="math">u</span></h3>

    <p class="text-gray-300">The choice of <span class="math">\\xi</span> has no consequence on the way of choosing the arithmetic of <span class="math">\\mathbb{F}_{p^{12}}</span>, but it must be done such that multiplication by <span class="math">\\xi</span> is as efficient as possible. However, the choice of <span class="math">\\xi</span> has less influence on <span class="math">\\mathbf{M}_{12}</span> and <span class="math">\\mathbf{S}_{12}</span> complexities than the choice of <span class="math">\\mu</span>. So an efficient <span class="math">\\mu</span> should be chosen in priority.</p>

    <p class="text-gray-300">The most natural choice is <span class="math">\\xi=\\alpha</span>, so that a multiplication by <span class="math">\\xi</span> in <span class="math">\\mathbb{F}_{p^{2}}</span> is</p>

    <p class="text-gray-300"><span class="math">(a_{0}+a_{1}\\alpha)\\xi=\\mu a_{1}+a_{0}\\alpha</span></p>

    <p class="text-gray-300">and thus <span class="math">\\mathbf{m}_{2,\\xi}=\\mathbf{m}_{1,\\mu}</span>. It means that <span class="math">\\mu</span> must be neither a fourth power nor a cube in <span class="math">\\mathbb{F}_{p}</span>. If <span class="math">p\\equiv 1\\pmod{6}</span>, which is always the case for a BN prime, such a <span class="math">\\mu</span> always exists.</p>

    <p class="text-gray-300">In practice, it is easy to find one by trial and error, by factoring <span class="math">x^{12}-\\mu</span> modulo <span class="math">p</span> until finding an irreducible polynomial. However, the obtained value is</p>

    <p class="text-gray-300">not necessarily optimal for <span class="math">\\mathbb{F}_{p^2}</span> arithmetic and <span class="math">\\mu</span> should be chosen in priority to define <span class="math">\\mathbb{F}_{p^2}</span> as efficiently as possible. For example, the best choice for <span class="math">\\mathbb{F}_{p^2}</span> is <span class="math">\\mu = -1</span> but it is obviously always a cube. Then, if <span class="math">\\mu</span> is already fixed to define <span class="math">\\mathbb{F}_{p^2}</span> and is a cube, <span class="math">\\xi</span> must be chosen as an element of <span class="math">\\mathbb{F}_{p^2}</span> with small coefficients. At first glance, the best choices are <span class="math">\\xi = 2</span> and <span class="math">\\xi = 1 + \\alpha</span>. However, as proved in Corollary 1 of Appendix A, 2 (as any other element of <span class="math">\\mathbb{F}_p</span>) is always a square in <span class="math">\\mathbb{F}_{p^2}</span>, so it cannot be chosen to define <span class="math">\\mathbb{F}_{p^{12}}</span>. Other choices can be made as <span class="math">2 + \\alpha</span> but they are of course less interesting in terms of efficiency.</p>

    <p class="text-gray-300"><strong>Remark 5.</strong> The condition to choose <span class="math">\\xi</span> is that it is neither a square nor a cube in <span class="math">\\mathbb{F}_{p^2}</span>. Since <span class="math">-1</span> is always a square and a cube in <span class="math">\\mathbb{F}_{p^2}</span>, there is no interest to consider the sign of <span class="math">\\xi</span>. In the same way, there is no interest to consider the conjugates of <span class="math">\\xi</span> because they are squares and cubes at the same times as <span class="math">\\xi</span>.</p>

    <p class="text-gray-300">Let us now precise the possible choices for <span class="math">\\xi</span> depending on the choice of <span class="math">\\mu</span> and their consequences on the choice of the parameter <span class="math">u</span>. We will use the following proposition which is proved in Appendix A:</p>

    <p class="text-gray-300"><strong>Proposition 3.</strong> Let <span class="math">p</span> be an odd prime number which is equal to 1 modulo 3 (this is always the case for BN primes). Then an element is a square (resp. a cube) in <span class="math">\\mathbb{F}_{p^2}</span> if and only if its norm is a square (resp. a cube) in <span class="math">\\mathbb{F}_p</span>.</p>

    <h2 id="sec-36" class="text-2xl font-bold">3.8.1 The case <span class="math">\\mu = -1</span></h2>

    <p class="text-gray-300">In this case, the smallest complexity for <span class="math">\\mathbf{m}_{2,\\xi}</span> is reached by <span class="math">\\xi = 1 + \\mathbf{i}</span> and equals <span class="math">2\\mathbf{A}_1</span> since</p>

    <div class="my-4 text-center"><span class="math-block">(1 + \\mathbf {i}) (a _ {0} + a _ {1} \\mathbf {i}) = a _ {0} - a _ {1} + (a _ {0} + a _ {1}) \\mathbf {i}.</span></div>

    <p class="text-gray-300">Let us now study the conditions on <span class="math">u</span> ensuring that <span class="math">1 + \\mathbf{i}</span> is neither a square nor a cube in <span class="math">\\mathbb{F}_{p^2}</span>.</p>

    <p class="text-gray-300"><strong>Theorem 1.</strong> Let <span class="math">p = 36u^4 + 36u^3 + 24u^2 + 6u + 1</span> be a BN prime with <span class="math">u</span> odd (thus <span class="math">\\mathbb{F}_{p^2}</span> can be defined by <span class="math">\\mathbf{i} = \\sqrt{-1}</span>). Then <span class="math">1 + \\mathbf{i}</span> is neither a square nor a cube in <span class="math">\\mathbb{F}_{p^2}</span> if and only if <span class="math">u = 7</span> or 11 modulo 12. In this case, <span class="math">\\mathbb{F}_{p^{12}}</span> can be defined over <span class="math">\\mathbb{F}_{p^2}</span> by a sixth root of <span class="math">1 + \\mathbf{i}</span>.</p>

    <p class="text-gray-300"><strong>Proof.</strong> By Proposition 3, <span class="math">1 + \\mathbf{i}</span> is a square (resp. a cube) in <span class="math">\\mathbb{F}_{p^2}</span> if and only if <span class="math">2 = N_{\\mathbb{F}_{p^2} / \\mathbb{F}_p}(1 + \\mathbf{i})</span> is a square (resp. a cube) in <span class="math">\\mathbb{F}_p</span>.</p>

    <ul class="list-disc list-inside space-y-1 text-gray-300 my-2 ml-4">

      <li>According to Proposition 1 of Appendix A, 2 is a square in <span class="math">\\mathbb{F}_p</span> if and only if <span class="math">u = 0</span> or 1 modulo 4. Thus, in our situation, <span class="math">1 + \\mathbf{i}</span> is not a square in <span class="math">\\mathbb{F}_{p^2}</span> if and only if <span class="math">u = 3</span> modulo 4.</li>

      <li>In the same way, <span class="math">1 + \\mathbf{i}</span> is not a cube if and only if 2 is not a cube which means, according to Proposition 2 of Appendix A, that <span class="math">u \\neq 0 \\mod 3</span>. Thus <span class="math">1 + \\mathbf{i}</span> is not a cube if and only if <span class="math">u = 1</span> or 5 modulo 6.</li>

    </ul>

    <p class="text-gray-300">Combining these two congruences ends the proof. <span class="math">\\square</span></p>

    <p class="text-gray-300">19</p>

    <p class="text-gray-300">If <span class="math">1 + \\mathbf{i}</span> cannot be chosen, <span class="math">\\xi</span> should be sought in the form <span class="math">a + \\mathbf{i}b</span> with <span class="math">a &amp;gt; b &amp;gt; 0</span> and can be chosen if and only if <span class="math">a^2 + b^2 = N_{\\mathbb{F}_{p^2} / \\mathbb{F}_p}(a + \\mathbf{i}b)</span> is neither a square nor a cube in <span class="math">\\mathbb{F}_p</span>. The next candidate in terms of efficiency is <span class="math">\\xi = 2 + \\mathbf{i}</span> for which <span class="math">\\mathbf{m}_{2,\\xi} = 2\\mathbf{A}_1 + 2\\mathbf{A}&#x27;_1</span> and whose norm is 5. Combining the condition ensuring that 5 is neither a square nor a cube given in Appendix A and the fact that <span class="math">u \\neq 7</span> or 11 modulo 12 (otherwise <span class="math">\\xi = 1 + \\mathbf{i}</span> can be chosen), we get that <span class="math">2 + \\mathbf{i}</span> should be chosen to define <span class="math">\\mathbb{F}_{p^{12}}</span> if <span class="math">u = 1,3,13,27,33,37,41</span> or 57 modulo 60 but not in the 12 remaining cases (<span class="math">u = 5,9,15,17,21,25,29,39,45,49,51</span> or 53 modulo 60). In 3 of these cases (<span class="math">u = 17,39</span> and 53 modulo 60), one can choose <span class="math">3 + \\mathbf{i}</span>, whose norm is 10. Of course, this study can be easily continued with "larger" values of <span class="math">\\xi</span> (<span class="math">4 + \\mathbf{i},3 + 2\\mathbf{i},...</span>) to be able to deal with the 9 remaining cases. But the interest is limited here and the reader can easily do it by himself if necessary.</p>

    <h2 id="sec-37" class="text-2xl font-bold">3.8.2 The case <span class="math">\\mu = -2</span></h2>

    <p class="text-gray-300">Taking in account the results from Section 3.5, this choice should be made only when <span class="math">-1</span> cannot be chosen to build <span class="math">\\mathbb{F}_{p^2}</span>, that is, when <span class="math">u = 2</span> modulo 4 (<span class="math">-1</span> is a square and <span class="math">-2</span> is not a square). In this case, the smallest complexity for <span class="math">\\mathbf{m}_{2,\\xi}</span> is reached by <span class="math">\\xi = \\alpha = \\sqrt{-2}</span>. Let us now study the conditions on <span class="math">u</span> ensuring that <span class="math">\\sqrt{-2}</span> is neither a square nor a cube in <span class="math">\\mathbb{F}_{p^2}</span>.</p>

    <p class="text-gray-300"><strong>Theorem 2.</strong> Let <span class="math">p = 36u^4 + 36u^3 + 24u^2 + 6u + 1</span> be a BN prime with <span class="math">u = 2</span> modulo 4 (thus <span class="math">\\mathbb{F}_{p^2}</span> can be defined by <span class="math">\\sqrt{-2}</span> but not by <span class="math">\\sqrt{-1}</span>). Then <span class="math">\\alpha = \\sqrt{-2}</span> is neither a square nor a cube in <span class="math">\\mathbb{F}_{p^2}</span> if and only if <span class="math">u = 2</span> or 10 modulo 12. In this case, <span class="math">\\mathbb{F}_{p^{12}}</span> can be defined over <span class="math">\\mathbb{F}_{p^2}</span> by a sixth root of <span class="math">\\alpha</span>.</p>

    <p class="text-gray-300"><strong>Proof.</strong></p>

    <ul class="list-disc list-inside space-y-1 text-gray-300 my-2 ml-4">

      <li>Since <span class="math">-1</span> is a square and <span class="math">-2</span> is not, <span class="math">N_{\\mathbb{F}_{p^2} / \\mathbb{F}_p}(\\alpha) = 2</span> is never a square in <span class="math">\\mathbb{F}_p</span> and thus, by 3, <span class="math">\\alpha</span> is never a square in <span class="math">\\mathbb{F}_{p^2}</span>. Note that this proof is not specific to the case <span class="math">\\mu = -2</span>; it is only using the fact that <span class="math">-1</span> is a square in <span class="math">\\mathbb{F}_p</span> and <span class="math">\\mu</span> is not.</li>

      <li>Since <span class="math">-1</span> is a cube, <span class="math">\\alpha</span> is a cube in <span class="math">\\mathbb{F}_{p^2}</span> if and only if <span class="math">2 = -N_{\\mathbb{F}_{p^2} / \\mathbb{F}_p}(\\alpha)</span> is a cube in <span class="math">\\mathbb{F}_p</span>. According to Proposition 2 of Appendix A, 2, and thus <span class="math">\\alpha</span>, is not a cube if and only if <span class="math">u = 1</span> or 2 modulo 3. Taking in account that <span class="math">-1</span> is a square and <span class="math">-2</span> is not a square, this last condition can be rewritten <span class="math">u = 2</span> or 10 modulo 12.</li>

    </ul>

    <p class="text-gray-300"></p>

    <p class="text-gray-300">The next interesting candidate is <span class="math">\\xi = 1 + \\alpha</span> but it cannot be chosen since its norm equals 3 which is always a square in <span class="math">\\mathbb{F}_p</span> in the remaining case (<span class="math">u = 6</span> modulo 12). The situation is better if <span class="math">\\xi = 2 + \\alpha</span> whose norm is 6. Indeed, since 2 is not a square and 3 is always a square, 6 is never a square in <span class="math">\\mathbb{F}_p</span>. Moreover, since it was not possible to choose <span class="math">\\xi = \\alpha</span>, 2 is a cube in <span class="math">\\mathbb{F}_p</span> and thus 6 is not a cube in <span class="math">\\mathbb{F}_p</span> if and only if 3 is not a cube in <span class="math">\\mathbb{F}_p</span>. According to Proposition 2 of</p>

    <p class="text-gray-300">20</p>

    <p class="text-gray-300">Appendix A,  <span class="math">\\xi = 2 + \\alpha</span>  can then be chosen if  <span class="math">u = 6</span>  or 30 modulo 36. In this case  <span class="math">\\mathbf{m}_{2,\\xi} = 2\\mathbf{A}_1 + 2\\mathbf{A}&#x27;_1</span> . Again, this study can be easily continued by the interested reader with "larger" values of  <span class="math">\\xi</span>  like  <span class="math">3 + \\alpha</span>  to deal with the last remaining case ( <span class="math">u = 18</span>  modulo 36).</p>

    <p class="text-gray-300">Again, taking in account the results from Section 3.5, this case should be considered only if  <span class="math">u = 8,12</span>  or 16 modulo 20  <span class="math">(-1,\\pm 2</span>  are squares and  <span class="math">\\pm 5</span>  are not). The smallest complexity for  <span class="math">\\mathbf{m}_{2,\\xi}</span>  is reached by  <span class="math">\\xi = \\alpha = \\sqrt{-5}</span> . Let us study the conditions on  <span class="math">u</span>  ensuring that  <span class="math">\\sqrt{-5}</span>  is neither a square nor a cube in  <span class="math">\\mathbb{F}_{p^2}</span> .</p>

    <p class="text-gray-300">Theorem 3. Let  <span class="math">p = 36u^4 + 36u^3 + 24u^2 + 6u + 1</span>  be a BN prime with  <span class="math">u = 8, 12</span>  or 16 modulo 20. Then  <span class="math">\\alpha = \\sqrt{-5}</span>  is neither a square nor a cube in  <span class="math">\\mathbb{F}_{p^2}</span>  if and only if  <span class="math">u = 12, 16, 28, 48, 52, 56</span>  modulo 60. In this case,  <span class="math">\\mathbb{F}_{p^{12}}</span>  can be defined over  <span class="math">\\mathbb{F}_{p^2}</span>  by a sixth root of  <span class="math">\\alpha</span> .</p>

    <p class="text-gray-300">Proof. Similarly to the proof of Theorem 2, we prove that  <span class="math">\\alpha</span>  is never a square in  <span class="math">\\mathbb{F}_{p^2}</span> . Moreover,  <span class="math">\\alpha</span>  is a cube in  <span class="math">\\mathbb{F}_{p^2}</span>  if and only if  <span class="math">5 = -N_{\\mathbb{F}_{p^2} / \\mathbb{F}_p}(\\alpha)</span>  is a cube in  <span class="math">\\mathbb{F}_p</span> . Proposition 2 of Appendix A gives a condition ensuring that 5, and thus  <span class="math">\\alpha</span> , is not a cube and allows to conclude.</p>

    <p class="text-gray-300">The next interesting candidate is  <span class="math">\\xi = 1 + \\alpha</span>  but it cannot be chosen since its norm equals 6 which is always a square in this case. The situation is the same for  <span class="math">2 + \\alpha</span>  since its norm is 9. The "smallest" usable candidates are  <span class="math">1 + 2\\alpha</span>  and  <span class="math">3 + \\alpha</span>  whose norms are respectively 21 and 14. This will give conditions on  <span class="math">u</span>  modulo 7 but we leave it to the interested reader, since there are very few concerned cases ( <span class="math">u = 8, 32</span>  or 36 modulo 60) and the cost of  <span class="math">\\mathbf{m}_{2,\\xi}</span>  becomes high.</p>

    <p class="text-gray-300">Finally, we gave almost all the best choices for  <span class="math">\\xi</span> , depending on the value of  <span class="math">u</span> . This is summarized in Table 4.</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Value of u modulo</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">m2,</th>

          </tr>

        </thead>

        <tbody>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">4</td>

            <td class="px-3 py-2 border-b border-gray-700">12</td>

            <td class="px-3 py-2 border-b border-gray-700">20</td>

            <td class="px-3 py-2 border-b border-gray-700">36</td>

            <td class="px-3 py-2 border-b border-gray-700">60</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">-1</td>

            <td class="px-3 py-2 border-b border-gray-700">1,3</td>

            <td class="px-3 py-2 border-b border-gray-700">7,11</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">1+i</td>

            <td class="px-3 py-2 border-b border-gray-700">2A1</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">1,3,5,9</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">1,3,13,27,33,37,41,57</td>

            <td class="px-3 py-2 border-b border-gray-700">2+i</td>

            <td class="px-3 py-2 border-b border-gray-700">2A1+2A'1</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">17,39,53</td>

            <td class="px-3 py-2 border-b border-gray-700">3+i</td>

            <td class="px-3 py-2 border-b border-gray-700">4A1+2A'1</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">5,9,15,21,25,29,45,49,51</td>

            <td class="px-3 py-2 border-b border-gray-700">-</td>

            <td class="px-3 py-2 border-b border-gray-700">-</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">-2</td>

            <td class="px-3 py-2 border-b border-gray-700">2</td>

            <td class="px-3 py-2 border-b border-gray-700">2,10</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">-2</td>

            <td class="px-3 py-2 border-b border-gray-700">A'1</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">6</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">6,30</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">2+-2</td>

            <td class="px-3 py-2 border-b border-gray-700">2A1+2A'1</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">18</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">-</td>

            <td class="px-3 py-2 border-b border-gray-700">-</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">-5</td>

            <td class="px-3 py-2 border-b border-gray-700">0</td>

            <td class="px-3 py-2 border-b border-gray-700">0,4,8</td>

            <td class="px-3 py-2 border-b border-gray-700">8,12,16</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">12,16,28,48,52,56</td>

            <td class="px-3 py-2 border-b border-gray-700">-5</td>

            <td class="px-3 py-2 border-b border-gray-700">A1+2A'1</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">8,32,36</td>

            <td class="px-3 py-2 border-b border-gray-700">-</td>

            <td class="px-3 py-2 border-b border-gray-700">-</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">any</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">0,4</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">M1</td>

          </tr>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">Table 4: Best choices of  <span class="math">\\mu</span>  and  <span class="math">\\xi</span>  in terms of  <span class="math">u</span></p>

    <h3 id="sec-40" class="text-xl font-semibold mt-8">3.9 New improvements of <span class="math">\\mathbb{F}_{p^{12}}</span> arithmetic</h3>

    <p class="text-gray-300">Usually, the cost of additions is not taken in account in complexity studies because it is assumed to be negligible. However, it is not always the case in hardware or assembly language where the ratio between additions and multiplications in <span class="math">\\mathbb{F}_{p}</span> can be as large as <span class="math">0.2</span> to <span class="math">0.5</span>, as explained in Section 3.1. In this case, we get some new improvements (saving of course only additions). The first one is just a computational trick and is probably used in practical implementations but it is usually not explicitly written. The second one consists in precomputing the traces of some elements of the intermediate levels of the extension tower which are involved in several operations.</p>

    <p class="text-gray-300">Since these are new results, we chose to present them in a dedicated section. These results could be included in our previous discussion on the choices for building <span class="math">\\mathbb{F}_{p^{12}}</span>. We did not do it for two reasons. The first one is that they require some precomputations storage which is not always desirable, depending on the context. The second one is that it has no influence on the choices to be made.</p>

    <h4 id="sec-41" class="text-lg font-semibold mt-6">3.9.1 Multiplications by <span class="math">\\xi-1</span> in Karatsuba operations</h4>

    <p class="text-gray-300">If <span class="math">\\mathbf{m}_{i,\\xi-1}\\leq\\mathbf{m}_{i,\\xi}</span>, then the Karatsuba multiplication of <span class="math">x_{0}+x_{1}\\beta</span> by <span class="math">y_{0}+y_{1}\\beta</span> in <span class="math">\\mathbb{F}_{p^{2i}}</span> can be evaluated as</p>

    <p class="text-gray-300"><span class="math">x_{0}y_{0}+x_{1}y_{1}+(\\xi-1)x_{1}y_{1}+((x_{0}+x_{1})(y_{0}+y_{1})-x_{0}y_{0}-x_{1}y_{1})\\beta,</span></p>

    <p class="text-gray-300">instead of</p>

    <p class="text-gray-300"><span class="math">x_{0}y_{0}+\\xi x_{1}y_{1}+((x_{0}+x_{1})(y_{0}+y_{1})-x_{0}y_{0}-x_{1}y_{1})\\beta.</span></p>

    <p class="text-gray-300">Then it requires <span class="math">3\\mathbf{M}_{i}+\\mathbf{m}_{i,\\xi-1}+5\\mathbf{A}_{i}</span> instead of <span class="math">3\\mathbf{M}_{i}+\\mathbf{m}_{i,\\xi}+5\\mathbf{A}_{i}</span> because <span class="math">x_{0}y_{0}+x_{1}y_{1}</span> is used twice.</p>

    <p class="text-gray-300">In the same way, the Karatsuba multiplication of <span class="math">x_{0}+x_{1}\\beta+x_{2}\\beta^{2}</span> by <span class="math">y_{0}+y_{1}\\beta+y_{0}\\beta^{2}</span> in <span class="math">\\mathbb{F}_{p^{3i}}</span> can be evaluated as</p>

    <p class="text-gray-300"><span class="math">x_{0}y_{0}+\\xi((x_{1}+x_{2})(y_{1}+y_{2})-x_{1}y_{1}-x_{2}y_{2})</span> <span class="math">+[(x_{0}+x_{1})(y_{0}+y_{1})-x_{0}y_{0}-x_{1}y_{1}+x_{2}y_{2}+(\\xi-1)x_{2}y_{2}]\\beta</span> <span class="math">+[(x_{0}+x_{2})(y_{0}+y_{2})-x_{0}y_{0}-(-x_{1}y_{1}+x_{2}y_{2})]\\beta^{2}.</span></p>

    <p class="text-gray-300">One of the multiplications by <span class="math">\\xi</span> is then replaced by a multiplication by <span class="math">\\xi-1</span> compared to the formula given in 3.3.2. Of course, both in the case of quadratic and cubic extensions, this trick also applies to Karatsuba squaring.</p>

    <p class="text-gray-300">In the cases considered in Section 3.8, this improvement is only interesting in the intermediate fields (<span class="math">\\mathbb{F}_{p^{4}}/\\mathbb{F}_{p^{2}}</span> in the <span class="math">2,2,3</span> case and <span class="math">\\mathbb{F}_{p^{6}}/\\mathbb{F}_{p^{2}}</span> in the <span class="math">2,3,2</span> case) and allows to save some <span class="math">\\mathbb{F}_{p}</span> additions for each Karatsuba multiplication or squaring in <span class="math">\\mathbb{F}_{p^{4}}</span> or <span class="math">\\mathbb{F}_{p^{6}}</span> in the cases given in Table 5.</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">m2,-1</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">m2,</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Saving</th>

          </tr>

        </thead>

        <tbody>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">1+i</td>

            <td class="px-3 py-2 border-b border-gray-700">0</td>

            <td class="px-3 py-2 border-b border-gray-700">2A1</td>

            <td class="px-3 py-2 border-b border-gray-700">2A1</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">2+i</td>

            <td class="px-3 py-2 border-b border-gray-700">2A1</td>

            <td class="px-3 py-2 border-b border-gray-700">2A1+2A'1</td>

            <td class="px-3 py-2 border-b border-gray-700">2A'1</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">3+i</td>

            <td class="px-3 py-2 border-b border-gray-700">2A1+2A'1</td>

            <td class="px-3 py-2 border-b border-gray-700">4A1+2A'1</td>

            <td class="px-3 py-2 border-b border-gray-700">2A1</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">2+-2</td>

            <td class="px-3 py-2 border-b border-gray-700">2A1+A'1</td>

            <td class="px-3 py-2 border-b border-gray-700">2A1+2A'1</td>

            <td class="px-3 py-2 border-b border-gray-700">A'1</td>

          </tr>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">Remark 6. This trick is more interesting in the case 2, 2, 3 that in the case 2, 3, 2. Indeed, a Karatsuba multiplication in  <span class="math">\\mathbb{F}_{p^{12}}</span>  requires 6 multiplications at the middle level in the case 2, 2, 3 (and then  <span class="math">6m_{2,\\xi}</span>  are replaced by  <span class="math">6m_{2,\\xi -1}</span> ) but only 3 in the case 2, 3, 2. Of course, this remark also applies to sparse  <span class="math">\\mathbb{F}_{p^{12}}</span>  multiplications and to  <span class="math">\\mathbb{F}_{p^{12}}</span>  squarings.</p>

    <p class="text-gray-300">In the case where memory is large enough, we can perform some pre-computations to speed up the different operations (i.e.  <span class="math">\\mathbf{M}_i</span>  or  <span class="math">\\mathbf{S}_i</span> ). In particular, it could be interesting to precompute the trace of an element if this element is used in several operations (requiring its trace) in the following.</p>

    <p class="text-gray-300">For example, assuming that  <span class="math">x_0 + x_1 = tr_{\\mathbb{F}_{p^{2i}} / \\mathbb{F}_{p^i}}(x_0 + x_1\\alpha)</span>  is precomputed, computing  <span class="math">(x_0 + x_1\\alpha)^2</span>  in  <span class="math">\\mathbb{F}_{p^{2i}}</span>  using the Karatsuba method as in 3.2.3 requires only  <span class="math">3\\mathbf{S}_i + \\mathbf{m}_{i,\\mu} + 3\\mathbf{A}_i</span>  instead of  <span class="math">3\\mathbf{S}_i + \\mathbf{m}_{i,\\mu} + 4\\mathbf{A}_i</span> . The same remark holds for all the methods for squaring or multiplying in  <span class="math">\\mathbb{F}_{p^{2i}}</span>  or  <span class="math">\\mathbb{F}_{p^{3i}}</span>  involving traces (or more precisely sums of coordinates). It is summarized in Table 6 (notations are those of Sections 3.2 and 3.3).</p>

    <p class="text-gray-300">Table 5: Savings provided by the  <span class="math">\\xi -1</span>  trick</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Operation</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Method</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Precomputations</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Saving</th>

          </tr>

        </thead>

        <tbody>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">(x0+x1)(y0+y1)</td>

            <td class="px-3 py-2 border-b border-gray-700">M2i</td>

            <td class="px-3 py-2 border-b border-gray-700">x0+x1,y0+y1</td>

            <td class="px-3 py-2 border-b border-gray-700">2Ai</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">(x0+x1)2</td>

            <td class="px-3 py-2 border-b border-gray-700">S2i or S2i</td>

            <td class="px-3 py-2 border-b border-gray-700">x0+x1</td>

            <td class="px-3 py-2 border-b border-gray-700">Ai</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">(x0+x1+x22)(y0+y1+y22)</td>

            <td class="px-3 py-2 border-b border-gray-700">M3i</td>

            <td class="px-3 py-2 border-b border-gray-700">x0+x1,x0+x2,x1+x2y0+y1,y0+y2,y1+y2</td>

            <td class="px-3 py-2 border-b border-gray-700">6Ai</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">(x0+x1+x22)2</td>

            <td class="px-3 py-2 border-b border-gray-700">S3i</td>

            <td class="px-3 py-2 border-b border-gray-700">x0+x1,x0+x2,x1+x2</td>

            <td class="px-3 py-2 border-b border-gray-700">3Ai</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">S3i</td>

            <td class="px-3 py-2 border-b border-gray-700">x0+x1+x2</td>

            <td class="px-3 py-2 border-b border-gray-700">2Ai</td>

          </tr>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">Table 6: Precomputing traces</p>

    <p class="text-gray-300">Of course, we get savings only if the precomputations are used in several operations. This may hold in the arithmetic of the extension tower when an element is used twice. For example, a schoolbook multiplication in  <span class="math">\\mathbb{F}_{p^{2i}}</span>  will use  <span class="math">x_0</span>  both for  <span class="math">x_0y_0</span>  and for  <span class="math">x_0y_1</span> . If these multiplications are performed with the Karatsuba method in  <span class="math">\\mathbb{F}_{p^i}</span> , precomputing the trace of  <span class="math">x_0</span>  is interesting because it is used twice. However, in Karatsuba operations or in complex squarings, no element is used twice. As a consequence, this is not interesting for multiplications in  <span class="math">\\mathbb{F}_{p^{12}}</span>  because the Karatsuba method is always used at higher levels of the extension tower according to Sections 3.6 and 3.7. But it can be applied for squarings</p>

    <p class="text-gray-300">when the Chung-Hasan method is used over Karatsuba or complex arithmetic. It can also be applied for sparse multiplications since it involves schoolbook steps if operands have only one non-zero coefficient. Finally, we can also precompute traces if one <span class="math">\\mathbb{F}_{p^{12}}</span> element is used for several multiplications, which is usually the case in the final exponentiation step. Let us now give more details about these three situations.</p>

    <h4 id="sec-43" class="text-lg font-semibold mt-6">3.9.3 Use of precomputed traces in <span class="math">\\mathbb{F}_{p^{12}}</span> squarings</h4>

    <p class="text-gray-300">Some coefficients are used several times in <span class="math">\\mathbb{F}_{p^{12}}</span> squaring if the Chung-Hasan method is used over Karatsuba or complex arithmetic (i.e. when <span class="math">\\mathbf{A}_{1}</span> is not very expensive compared to <span class="math">\\mathbf{M}_{1}</span>). Indeed, we know from Section 3.3 that <span class="math">x_{0},2x_{1}</span> and <span class="math">x_{2}</span> are used twice to compute <span class="math">(x_{0}+x_{1}\\alpha+x_{2}\\alpha^{2})^{2}</span> using the Chung-Hasan method in <span class="math">\\mathbb{F}_{p^{3i}}/\\mathbb{F}_{p^{i}}</span>. Thus <span class="math">3\\mathbf{A}_{i}</span> can be saved in <span class="math">\\mathbf{S}_{3i}^{\\alpha i}</span> if traces are precomputed at the level <span class="math">i</span>. We saw in Sections 3.6 and 3.7 that this method is always used but one can do even better, depending on the way to build <span class="math">\\mathbb{F}_{p^{12}}</span>.</p>

    <h5 id="sec-44" class="text-base font-semibold mt-4">Case 2,3,2.</h5>

    <p class="text-gray-300">We saw in Section 3.6 that the Karatsuba method is usually used for the <span class="math">\\mathbb{F}_{p^{12}}/\\mathbb{F}_{p^{6}}</span> squaring, so that the Chung-Hasan squaring in <span class="math">\\mathbb{F}_{p^{6}}</span> is used 3 times to compute <span class="math">(c_{0}+c_{1}\\gamma)^{2}</span> (for <span class="math">c_{0}^{2},c_{1}^{2}</span> and <span class="math">(c_{0}+c_{1})^{2}</span>). Of course each of them is used only once but precomputing traces is nonetheless interesting because <span class="math">tr_{\\mathbb{F}_{p^{6}}/\\mathbb{F}_{p^{2}}}(c_{0}+c_{1})=tr_{\\mathbb{F}_{p^{6}}/\\mathbb{F}_{p^{2}}}(c_{0})+tr_{\\mathbb{F}_{p^{6}}/\\mathbb{F}_{p^{2}}}(c_{1})</span> which requires only one <span class="math">\\mathbf{A}_{2}</span> instead of 2 if it is computed directly. Hence, in this case, if the Karatsuba method is used in <span class="math">\\mathbb{F}_{p^{2}}</span>, <span class="math">11\\mathbf{A}_{1}</span> can be saved in <span class="math">\\mathbf{S}_{12}</span> thanks to trace precomputations (9 from <span class="math">\\mathbb{F}_{p^{6}}/\\mathbb{F}_{p^{2}}</span> Chung-Hasan over Karatsuba squaring and 2 from <span class="math">\\mathbb{F}_{p^{12}}/\\mathbb{F}_{p^{6}}</span> Karatsuba over Chung-Hasan squaring). If the Karatsuba method is not used in <span class="math">\\mathbb{F}_{p^{2}}</span>, which means that <span class="math">\\mathbf{A}_{1}&gt;0.33\\mathbf{M}_{1}</span>, only <span class="math">2\\mathbf{A}_{1}</span> can be saved (from <span class="math">\\mathbb{F}_{p^{12}}/\\mathbb{F}_{p^{6}}</span> Karatsuba over Chung-Hasan squaring).</p>

    <h5 id="sec-45" class="text-base font-semibold mt-4">Case 2,2,3.</h5>

    <p class="text-gray-300">We saw that when we compute <span class="math">(c_{0}+c_{1}\\gamma+c_{2}\\gamma^{2})^{2}</span> with the Chung-Hasan method <span class="math">c_{0},c_{1}</span> and <span class="math">c_{2}\\in\\mathbb{F}_{p^{4}}</span> are used twice. For example <span class="math">c_{0}</span> is used in <span class="math">c_{0}^{2}</span> and in <span class="math">2c_{0}c_{1}</span>, so that precomputing <span class="math">t_{0}=tr_{\\mathbb{F}_{p^{4}}/\\mathbb{F}_{p^{2}}}(c_{0})</span> saves one <span class="math">\\mathbf{A}_{2}</span>. But, assuming that <span class="math">c_{0}=b_{0}+b_{1}\\beta</span>, <span class="math">b_{0}\\in\\mathbb{F}_{p^{2}}</span> is also used twice (also in <span class="math">c_{0}^{2}</span> and in <span class="math">2c_{0}c_{1}</span> whatever the methods used) and precomputing its trace is then interesting if the Karatsuba/complex method is used in <span class="math">\\mathbb{F}_{p^{2}}</span>. Moreover for <span class="math">\\mathbb{F}_{p^{4}}</span> Karatsuba or complex operations, <span class="math">t_{0}</span> plays the same role as <span class="math">b_{0}</span> so that precomputing its trace is also interesting. Finally, in this case and if the Karatsuba method is used in <span class="math">\\mathbb{F}_{p^{2}}</span>, <span class="math">15\\mathbf{A}_{1}</span> can be saved in <span class="math">\\mathbf{S}_{12}</span> thanks to trace precomputations (6 from the <span class="math">\\mathbb{F}_{p^{4}}/\\mathbb{F}_{p^{2}}</span> traces of the <span class="math">c_{i}</span>, 6 from the <span class="math">\\mathbb{F}_{p^{2}}/\\mathbb{F}_{p}</span> traces of the <span class="math">\\mathbb{F}_{p^{2}}</span> components of the <span class="math">c_{i}</span> and 3 from the <span class="math">\\mathbb{F}_{p^{2}}/\\mathbb{F}_{p}</span> traces of the <span class="math">\\mathbb{F}_{p^{4}}/\\mathbb{F}_{p^{2}}</span> traces of the <span class="math">c_{i}</span>). If the Karatsuba method is not used in <span class="math">\\mathbb{F}_{p^{2}}</span>, which means that <span class="math">\\mathbf{A}_{1}&gt;0.33\\mathbf{M}_{1}</span>, only <span class="math">6\\mathbf{A}_{1}</span> can be saved (from the <span class="math">\\mathbb{F}_{p^{4}}/\\mathbb{F}_{p^{2}}</span> traces of the <span class="math">c_{i}</span>).</p>

    <p class="text-gray-300">###</p>

    <p class="text-gray-300">3.9.4 Use of precomputed traces in <span class="math">\\mathbb{F}_{p^{12}}</span> sparse multiplications</p>

    <p class="text-gray-300">The sparse multiplication involved in the Miller loop for the optimal Ate pairing involves schoolbook steps if operands have only one non-zero coefficient. Again, the savings are depending on the way to build <span class="math">\\mathbb{F}_{p^{12}}</span></p>

    <p class="text-gray-300">Case 2,3,2. Looking at formula (1) given in Section 3.6.2, we can see that</p>

    <ul class="list-disc list-inside space-y-1 text-gray-300 my-2 ml-4">

      <li><span class="math">b_{0}</span> is used in 3 <span class="math">\\mathbb{F}_{p^{2}}</span> multiplications. Precomputing its trace then saves <span class="math">2\\mathbf{A}_{1}</span>,</li>

      <li><span class="math">b_{1}</span> and the third component of <span class="math">c_{1}</span> are used in 2 <span class="math">\\mathbb{F}_{p^{2}}</span> multiplications during the sparse product <span class="math">(b_{1} + b_{3}\\beta)c_{1}</span>, so <span class="math">2\\mathbf{A}_{1}</span> can be saved,</li>

      <li>The same holds for the sparse product <span class="math">(b_{0} + b_{1} + b_{3}\\beta)(c_{0} + c_{1})</span>,</li>

      <li><span class="math">b_{3}</span> is used twice in each of these sparse products, so <span class="math">3\\mathbf{A}_{1}</span> can be saved by precomputing <span class="math">tr_{\\mathbb{F}_{p^{2}} / \\mathbb{F}_{p}}(b_{3})</span>.</li>

    </ul>

    <p class="text-gray-300">Finally, <span class="math">9\\mathbf{A}_1</span> can be saved in the sparse multiplication if traces are precomputed (assuming that the Karatsuba method is used for <span class="math">\\mathbb{F}_{p^2}</span> multiplications, i.e. that <span class="math">\\mathbf{A}_1 \\leq 0.33\\mathbf{M}_1</span>)</p>

    <p class="text-gray-300">Case 2, 2, 3. Looking at formula (2) given in Section 3.7.2, we can see that</p>

    <ul class="list-disc list-inside space-y-1 text-gray-300 my-2 ml-4">

      <li><span class="math">b_{0} + b_{3}\\beta</span> is used in 2 <span class="math">\\mathbb{F}_{p^4}</span> multiplication. Precomputing its trace <span class="math">(b_0 + b_3)</span> saves <span class="math">\\mathbf{A}_2</span>,</li>

      <li>As a consequence of the previous point, <span class="math">b_{0}, b_{3}</span> and <span class="math">b_{0} + b_{3}</span> are used in 2 <span class="math">\\mathbb{F}_{p^2}</span> multiplications, so <span class="math">3\\mathbf{A}_1</span> can be saved,</li>

      <li><span class="math">b_{3}</span> is also used in the <span class="math">\\mathbb{F}_{p^4}</span> product <span class="math">(c_0 + c_1)(b_0 + b_1 + b_3\\beta)</span> so one additional <span class="math">\\mathbf{A}_1</span> can be saved,</li>

      <li><span class="math">b_{1}</span> is used in 4 <span class="math">\\mathbb{F}_{p^2}</span> multiplications (<span class="math">c_{2}b_{1}</span> and <span class="math">c_{1}b_{1}</span>) so <span class="math">3\\mathbf{A}_1</span> can be saved by precomputing <span class="math">tr_{\\mathbb{F}_{p^2} / \\mathbb{F}_p}(b_1)</span>,</li>

      <li><span class="math">c_{2}</span> is used twice (in <span class="math">c_{2}b_{1}</span> and in <span class="math">c_{2}(b_{0} + b_{3}\\beta)</span>) so its <span class="math">\\mathbb{F}_{p^2}</span> coefficients are used twice each which saves <span class="math">2\\mathbf{A}_1</span>.</li>

    </ul>

    <p class="text-gray-300">Finally, <span class="math">11\\mathbf{A}_1</span> can be saved in the sparse multiplication if traces are precomputed (assuming that the Karatsuba method is used for <span class="math">\\mathbb{F}_{p^2}</span> multiplications, i.e. that <span class="math">\\mathbf{A}_1 \\leq 0.33\\mathbf{M}_1</span>, otherwise only <span class="math">2\\mathbf{A}_1</span> are saved).</p>

    <p class="text-gray-300">In all considered cases, the saving obtained is around <span class="math">10\\%</span> of the total number of additions in <span class="math">\\mathbb{F}_{p^{12}}</span> operations which is not negligible if the relative cost of an addition compared to a multiplication in <span class="math">\\mathbb{F}_p</span> is not small.</p>

    <p class="text-gray-300">25</p>

    <p class="text-gray-300">3.9.5 Use of precomputed traces in the final exponentiation</p>

    <p class="text-gray-300">Full multiplications in <span class="math">\\mathbb{F}_{p^{12}}</span> are only used in the final exponentiation (in the Miller loop, sparse multiplications are used). If the implemented exponentiation parses the exponent from left to right (which is usually the case), then the multiplication steps are performed with one constant term <span class="math">c</span>. Hence, we can precompute and store all the traces depending only on <span class="math">c</span>. Since the Karatsuba method is used at all levels of the extension tower (except in <span class="math">\\mathbb{F}_{p^{2}}</span> if <span class="math">\\mathbf{A}_{1}&gt;0.33\\mathbf{M}_{1}</span>), we will significantly reduce the number of required additions, whatever the way to build <span class="math">\\mathbb{F}_{p^{12}}</span>.</p>

    <h4 id="sec-46" class="text-lg font-semibold mt-6">Case 2,3,2.</h4>

    <ul class="list-disc list-inside space-y-1 text-gray-300 my-2 ml-4">

      <li><span class="math">\\mathbf{M}_{12}^{K}</span> requires the <span class="math">\\mathbb{F}_{p^{12}}/\\mathbb{F}_{p^{6}}</span> trace of <span class="math">c</span>, thus one <span class="math">\\mathbf{A}_{6}</span> can be saved if this trace is already precomputed. It also requires <span class="math">3\\mathbf{M}_{6}^{K}</span> with one constant term (the 2 coordinates of <span class="math">c</span> and its trace).</li>

      <li>Each <span class="math">\\mathbf{M}_{6}^{K}</span> involving a constant term <span class="math">b</span> requires 3 sums of 2 coordinates of <span class="math">b</span>, thus <span class="math">3\\mathbf{A}_{2}</span> can be saved if these sums are precomputed. Hence <span class="math">9\\mathbf{A}_{2}</span> are saved at this level. Each <span class="math">\\mathbf{M}_{6}^{K}</span> also requires <span class="math">6\\mathbf{M}_{2}</span> with one constant term (the 3 coordinates of <span class="math">b</span> and the 3 sums of 2 coordinates).</li>

      <li>Each <span class="math">\\mathbf{M}_{2}^{K}</span> involving a constant term <span class="math">a</span> requires the <span class="math">\\mathbb{F}_{p^{2}}/\\mathbb{F}_{p}</span> trace of <span class="math">a</span>, thus one <span class="math">\\mathbf{A}_{1}</span> can be saved if this trace is precomputed. Hence <span class="math">18\\mathbf{A}_{1}</span> can be saved at this level when the Karatsuba method is used for <span class="math">\\mathbf{M}_{2}</span> (i.e. if <span class="math">\\mathbf{A}_{1}\\leq 0.33\\mathbf{M}_{1}</span> according to Section 3.5).</li>

    </ul>

    <h4 id="sec-47" class="text-lg font-semibold mt-6">Case 2,2,3.</h4>

    <ul class="list-disc list-inside space-y-1 text-gray-300 my-2 ml-4">

      <li><span class="math">\\mathbf{M}_{12}^{K}</span> requires 3 sums of 2 coordinates of <span class="math">c</span>, thus <span class="math">3\\mathbf{A}_{4}</span> can be saved if these sums are precomputed. It also requires <span class="math">6\\mathbf{M}_{4}^{K}</span> with one constant term (the 3 coordinates of <span class="math">c</span> and the 3 sums of 2 coordinates).</li>

      <li>Each <span class="math">\\mathbf{M}_{4}^{K}</span> involving a constant term <span class="math">b</span> requires the <span class="math">\\mathbb{F}_{p^{4}}/\\mathbb{F}_{p^{2}}</span> trace of <span class="math">b</span>, thus one <span class="math">\\mathbf{A}_{2}</span> can be saved if this trace is precomputed. Hence <span class="math">6\\mathbf{A}_{2}</span> are saved at this level. Each <span class="math">\\mathbf{M}_{4}^{K}</span> also requires <span class="math">3\\mathbf{M}_{2}</span> with one constant term (the 2 coordinates of <span class="math">b</span> and its trace).</li>

      <li>Again, one <span class="math">\\mathbf{A}_{1}</span> can be saved for each <span class="math">\\mathbf{M}_{2}^{K}</span> involving a constant term if its trace is precomputed. Hence <span class="math">18\\mathbf{A}_{1}</span> can be saved at this level when the Karatsuba method is used for <span class="math">\\mathbf{M}_{2}</span> (i.e. if <span class="math">\\mathbf{A}_{1}\\leq 0.33\\mathbf{M}_{1}</span> according to Section 3.5).</li>

    </ul>

    <p class="text-gray-300">In both cases, <span class="math">42\\mathbf{A}_{1}</span> can be saved for each multiplication in <span class="math">\\mathbb{F}_{p^{12}}</span> involving a constant term if its traces are precomputed. This is about 20% of the total number of additions in <span class="math">\\mathbf{M}_{12}</span> which is significant if the relative cost of an addition compared to a multiplication in <span class="math">\\mathbb{F}_{p}</span> is not small. If <span class="math">\\mathbf{A}_{1}&gt;0.33\\mathbf{M}_{1}</span>, the schoolbook method is used for <span class="math">\\mathbb{F}_{p^{2}}</span> multiplication and only <span class="math">24\\mathbf{A}_{1}</span> are saved in this case.</p>

    <p class="text-gray-300">####</p>

    <p class="text-gray-300">In the previous sections, we explained how to choose the tower field depending on  <span class="math">u</span>  and on the relative cost of  <span class="math">\\mathbb{F}_p</span>  operations. We also saw that the arithmetic choices to be made are essentially depending on the  <span class="math">\\mathbb{F}_{p^2}</span>  arithmetic. Let us now recapitulate these choices.</p>

    <p class="text-gray-300">This choice can be made if  <span class="math">u</span>  is odd and  <span class="math">\\xi</span>  can be chosen "small" in most cases:</p>

    <ul class="list-disc list-inside space-y-1 text-gray-300 my-2 ml-4">

      <li><span class="math">\\xi = 1 + \\mathbf{i}</span>  if  <span class="math">u = 7</span>  or 11 modulo 12 and  <span class="math">\\mathbf{m}_{2,\\xi} = 2\\mathbf{A}_1</span> ,</li>

      <li><span class="math">\\xi = 2 + \\mathbf{i}</span>  if  <span class="math">u = 1,3,13,27,33,37,41,57</span>  modulo 60 and  <span class="math">\\mathbf{m}_{2,\\xi} = 2\\mathbf{A}_1 + 2\\mathbf{A}&#x27;_1</span> ,</li>

      <li><span class="math">\\xi = 3 + \\mathbf{i}</span>  if  <span class="math">u = 17,39</span>  or 53 modulo 60 and  <span class="math">\\mathbf{m}_{2,\\xi} = 4\\mathbf{A}_1 + 2\\mathbf{A}&#x27;_1</span> .</li>

    </ul>

    <p class="text-gray-300">Let us first assume that  <span class="math">\\mathbf{A}_1 \\leq 0.33\\mathbf{M}_1</span> . In this case, the full  <span class="math">\\mathbb{F}_{p^{12}}</span>  multiplication and the sparse multiplication should be done using Karatsuba arithmetic at all levels of the tower. Concerning the  <span class="math">\\mathbb{F}_{p^{12}}</span>  squaring, the Chung Hasan method should be used for squaring in the degree 3 extension  <span class="math">(\\mathbb{F}_{p^6} / \\mathbb{F}_{p^2}</span>  or  <span class="math">\\mathbb{F}_{p^{12}} / \\mathbb{F}_{p^4})</span>  but all the other multiplications should use the Karatsuba method. The overall complexities are summarized in Table 7. For the complexities using our new improvements given in Section 3.9, we assumed that  <span class="math">\\mathbf{M}_{12}</span>  is only used in the final exponentiation and  <span class="math">\\mathbf{sM}_{12}</span>  is only used in the Miller loop (which is always the case in practice). We also assumed for simplifying that the  <span class="math">\\xi - 1</span>  trick saves  <span class="math">2\\mathbf{A}_1</span>  whatever the choice of  <span class="math">\\xi</span>  (in fact it saves  <span class="math">2\\mathbf{A}&#x27;_1</span>  instead of  <span class="math">2\\mathbf{A}_1</span>  if  <span class="math">\\xi = 2 + \\mathbf{i}</span> ). An interesting point is that, if our improvements are used, the results given in Table 7 also hold if  <span class="math">\\mathbf{A}_1 &amp;gt; 0.33\\mathbf{M}_1</span>  (because less additions are required). Finally, in this table (as well as in the following ones), K, CH, SB and  <span class="math">\\mathbb{C}</span>  denote the methods used for arithmetic and SB/ <span class="math">\\mathbb{C}</span>  means that the schoolbook method is used for multiplications and the complex method is used for squarings.</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Oper-ation</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Case</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Arithmetic used</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Number of operations without/with improvement</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

          </tr>

        </thead>

        <tbody>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">Fp2</td>

            <td class="px-3 py-2 border-b border-gray-700">Fp4</td>

            <td class="px-3 py-2 border-b border-gray-700">Fp6</td>

            <td class="px-3 py-2 border-b border-gray-700">Fp12</td>

            <td class="px-3 py-2 border-b border-gray-700">M1</td>

            <td class="px-3 py-2 border-b border-gray-700">A1</td>

            <td class="px-3 py-2 border-b border-gray-700">A'1</td>

            <td class="px-3 py-2 border-b border-gray-700">m2,</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">M12</td>

            <td class="px-3 py-2 border-b border-gray-700">2,3,2</td>

            <td class="px-3 py-2 border-b border-gray-700">K</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">K</td>

            <td class="px-3 py-2 border-b border-gray-700">K</td>

            <td class="px-3 py-2 border-b border-gray-700">54</td>

            <td class="px-3 py-2 border-b border-gray-700">210/162</td>

            <td class="px-3 py-2 border-b border-gray-700">0</td>

            <td class="px-3 py-2 border-b border-gray-700">7</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">2,2,3</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">K</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">210/156</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">8</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">sM12</td>

            <td class="px-3 py-2 border-b border-gray-700">2,3,2</td>

            <td class="px-3 py-2 border-b border-gray-700">K</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">K</td>

            <td class="px-3 py-2 border-b border-gray-700">K</td>

            <td class="px-3 py-2 border-b border-gray-700">39</td>

            <td class="px-3 py-2 border-b border-gray-700">115/106</td>

            <td class="px-3 py-2 border-b border-gray-700">0</td>

            <td class="px-3 py-2 border-b border-gray-700">3</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">2,2,3</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">K</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">117/100</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">4</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">S12</td>

            <td class="px-3 py-2 border-b border-gray-700">2,3,2</td>

            <td class="px-3 py-2 border-b border-gray-700">K/CC</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">CH</td>

            <td class="px-3 py-2 border-b border-gray-700">K</td>

            <td class="px-3 py-2 border-b border-gray-700">36</td>

            <td class="px-3 py-2 border-b border-gray-700">120/109</td>

            <td class="px-3 py-2 border-b border-gray-700">15</td>

            <td class="px-3 py-2 border-b border-gray-700">7</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">2,2,3</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">K</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">CH</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">124/99</td>

            <td class="px-3 py-2 border-b border-gray-700">13</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

          </tr>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">Table 7:  <span class="math">\\mathbb{F}_{p^{12}}</span>  complexities if  <span class="math">\\mu = -1</span>  (assuming  <span class="math">\\mathbf{A}_1 \\leq 0.33\\mathbf{M}_1</span>  if our new improvements are not used)</p>

    <p class="text-gray-300">Remark 7. We can see that, if our new improvements are not used, it is slightly better to choose a 2,3,2 extension tower. This is in accordance with the state of</p>

    <p class="text-gray-300">the art (see [20, 14, 3, 27] for example). However, our improvements take more advantage of a 2, 2, 3 extension tower and then this way to build  <span class="math">\\mathbb{F}_{p^{12}}</span>  becomes the one to choose.</p>

    <p class="text-gray-300">The other cases are quite similar so we are only giving the final complexities in tables. Let us first give in Table 8 the  <span class="math">\\mathbb{F}_{p^{12}}</span>  complexities if  <span class="math">\\mathbf{A}_1 &amp;gt; 0.33\\mathbf{M}_1</span> .</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Oper-ation</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Case</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Arithmetic used</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Number of operations</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

          </tr>

        </thead>

        <tbody>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">\\( \\mathbb{F}_{p^2} \\)</td>

            <td class="px-3 py-2 border-b border-gray-700">\\( \\mathbb{F}_{p^4} \\)</td>

            <td class="px-3 py-2 border-b border-gray-700">\\( \\mathbb{F}_{p^6} \\)</td>

            <td class="px-3 py-2 border-b border-gray-700">\\( \\mathbb{F}_{p^{12}} \\)</td>

            <td class="px-3 py-2 border-b border-gray-700">\\( \\mathbf{M}_1 \\)</td>

            <td class="px-3 py-2 border-b border-gray-700">\\( \\mathbf{A}_1 \\)</td>

            <td class="px-3 py-2 border-b border-gray-700">\\( \\mathbf{A}'_1 \\)</td>

            <td class="px-3 py-2 border-b border-gray-700">\\( \\mathbf{m}_{2,\\xi} \\)</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">\\( \\mathbf{M}_{12} \\)</td>

            <td class="px-3 py-2 border-b border-gray-700">2,3,2</td>

            <td class="px-3 py-2 border-b border-gray-700">SB</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">K</td>

            <td class="px-3 py-2 border-b border-gray-700">K</td>

            <td class="px-3 py-2 border-b border-gray-700">72</td>

            <td class="px-3 py-2 border-b border-gray-700">156</td>

            <td class="px-3 py-2 border-b border-gray-700">0</td>

            <td class="px-3 py-2 border-b border-gray-700">7</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">2,2,3</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">K</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">156</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">8</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">\\( \\mathbf{sM}_{12} \\)</td>

            <td class="px-3 py-2 border-b border-gray-700">2,3,2</td>

            <td class="px-3 py-2 border-b border-gray-700">SB</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">K</td>

            <td class="px-3 py-2 border-b border-gray-700">K</td>

            <td class="px-3 py-2 border-b border-gray-700">52</td>

            <td class="px-3 py-2 border-b border-gray-700">76</td>

            <td class="px-3 py-2 border-b border-gray-700">0</td>

            <td class="px-3 py-2 border-b border-gray-700">3</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">2,2,3</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">K</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">78</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">4</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">\\( \\mathbf{S}_{12} \\)</td>

            <td class="px-3 py-2 border-b border-gray-700">2,3,2</td>

            <td class="px-3 py-2 border-b border-gray-700">SB/C</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">CH</td>

            <td class="px-3 py-2 border-b border-gray-700">K</td>

            <td class="px-3 py-2 border-b border-gray-700">42</td>

            <td class="px-3 py-2 border-b border-gray-700">102</td>

            <td class="px-3 py-2 border-b border-gray-700">15</td>

            <td class="px-3 py-2 border-b border-gray-700">7</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">2,2,3</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">K</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">CH</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">106</td>

            <td class="px-3 py-2 border-b border-gray-700">13</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

          </tr>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">This choice should be made if the previous one cannot, in the case where  <span class="math">u = 2</span>  modulo 4. Tables 9 and 10 give the complexities of  <span class="math">\\mathbb{F}_{p^{12}}</span>  operations when  <span class="math">\\xi = \\sqrt{-2}</span>  (which means, according to Section 3.8, that  <span class="math">u = 2</span>  or 10 modulo 12) and when  <span class="math">\\xi = 2 + \\sqrt{-2}</span>  (which means that  <span class="math">u = 6</span>  or 30 modulo 36 but not 18).</p>

    <p class="text-gray-300">Table 8:  <span class="math">\\mathbb{F}_{p^{12}}</span>  complexities if  <span class="math">\\mu = -1</span>  assuming our improvements are not used and  <span class="math">\\mathbf{A}_1 &amp;gt; 0.33\\mathbf{M}_1</span></p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Oper-ation</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Case</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Arithmetic used</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Number of operations without/with improvement</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

          </tr>

        </thead>

        <tbody>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">\\( \\mathbf{M}_{1} \\)</td>

            <td class="px-3 py-2 border-b border-gray-700">if \\( \\xi = \\sqrt{-2} \\)</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">if \\( \\xi = 2 + \\sqrt{-2} \\)</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">\\( \\mathbb{F}_{p^2} \\)</td>

            <td class="px-3 py-2 border-b border-gray-700">\\( \\mathbb{F}_{p^4} \\)</td>

            <td class="px-3 py-2 border-b border-gray-700">\\( \\mathbb{F}_{p^6} \\)</td>

            <td class="px-3 py-2 border-b border-gray-700">\\( \\mathbb{F}_{p^{12}} \\)</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">\\( \\mathbf{A}_1 \\)</td>

            <td class="px-3 py-2 border-b border-gray-700">\\( \\mathbf{A}'_1 \\)</td>

            <td class="px-3 py-2 border-b border-gray-700">\\( \\mathbf{A}_1 \\)</td>

            <td class="px-3 py-2 border-b border-gray-700">\\( \\mathbf{A}'_1 \\)</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">\\( \\mathbf{M}_{12} \\)</td>

            <td class="px-3 py-2 border-b border-gray-700">2,3,2</td>

            <td class="px-3 py-2 border-b border-gray-700">K</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">K</td>

            <td class="px-3 py-2 border-b border-gray-700">K</td>

            <td class="px-3 py-2 border-b border-gray-700">54</td>

            <td class="px-3 py-2 border-b border-gray-700">210/168</td>

            <td class="px-3 py-2 border-b border-gray-700">25</td>

            <td class="px-3 py-2 border-b border-gray-700">224/182</td>

            <td class="px-3 py-2 border-b border-gray-700">32/29</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">2,2,3</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">K</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">210/168</td>

            <td class="px-3 py-2 border-b border-gray-700">26</td>

            <td class="px-3 py-2 border-b border-gray-700">226/184</td>

            <td class="px-3 py-2 border-b border-gray-700">34/28</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">\\( \\mathbf{sM}_{12} \\)</td>

            <td class="px-3 py-2 border-b border-gray-700">2,3,2</td>

            <td class="px-3 py-2 border-b border-gray-700">K</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">K</td>

            <td class="px-3 py-2 border-b border-gray-700">K</td>

            <td class="px-3 py-2 border-b border-gray-700">39</td>

            <td class="px-3 py-2 border-b border-gray-700">115/106</td>

            <td class="px-3 py-2 border-b border-gray-700">16</td>

            <td class="px-3 py-2 border-b border-gray-700">121/112</td>

            <td class="px-3 py-2 border-b border-gray-700">19</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">2,2,3</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">K</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">117/106</td>

            <td class="px-3 py-2 border-b border-gray-700">17</td>

            <td class="px-3 py-2 border-b border-gray-700">125/114</td>

            <td class="px-3 py-2 border-b border-gray-700">21/18</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">\\( \\mathbf{S}_{12} \\)</td>

            <td class="px-3 py-2 border-b border-gray-700">2,3,2</td>

            <td class="px-3 py-2 border-b border-gray-700">K/C</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">CH</td>

            <td class="px-3 py-2 border-b border-gray-700">K</td>

            <td class="px-3 py-2 border-b border-gray-700">36</td>

            <td class="px-3 py-2 border-b border-gray-700">129/118</td>

            <td class="px-3 py-2 border-b border-gray-700">37</td>

            <td class="px-3 py-2 border-b border-gray-700">143/132</td>

            <td class="px-3 py-2 border-b border-gray-700">44</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">2,2,3</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">K</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">CH</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">133/118</td>

            <td class="px-3 py-2 border-b border-gray-700">35</td>

            <td class="px-3 py-2 border-b border-gray-700">147/132</td>

            <td class="px-3 py-2 border-b border-gray-700">42/37</td>

          </tr>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">Table 9:  <span class="math">\\mathbb{F}_{p^{12}}</span>  complexities if  <span class="math">\\mu = -2</span>  (assuming  <span class="math">\\mathbf{A}_1 \\leq 0.33\\mathbf{M}_1</span>  if our improvements are not used)</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Oper-ation</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Case</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Arithmetic used</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Number of operations</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

          </tr>

        </thead>

        <tbody>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">M1</td>

            <td class="px-3 py-2 border-b border-gray-700">if  = -2</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">if  = 2 + -2</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">Fp2</td>

            <td class="px-3 py-2 border-b border-gray-700">Fp4</td>

            <td class="px-3 py-2 border-b border-gray-700">Fp6</td>

            <td class="px-3 py-2 border-b border-gray-700">Fp12</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">A1</td>

            <td class="px-3 py-2 border-b border-gray-700">A'1</td>

            <td class="px-3 py-2 border-b border-gray-700">A1</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">M12</td>

            <td class="px-3 py-2 border-b border-gray-700">2,3,2</td>

            <td class="px-3 py-2 border-b border-gray-700">SB</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">K</td>

            <td class="px-3 py-2 border-b border-gray-700">K</td>

            <td class="px-3 py-2 border-b border-gray-700">72</td>

            <td class="px-3 py-2 border-b border-gray-700">156</td>

            <td class="px-3 py-2 border-b border-gray-700">25</td>

            <td class="px-3 py-2 border-b border-gray-700">170</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">2,2,3</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">K</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">156</td>

            <td class="px-3 py-2 border-b border-gray-700">26</td>

            <td class="px-3 py-2 border-b border-gray-700">172</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">sM12</td>

            <td class="px-3 py-2 border-b border-gray-700">2,3,2</td>

            <td class="px-3 py-2 border-b border-gray-700">SB</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">K</td>

            <td class="px-3 py-2 border-b border-gray-700">K</td>

            <td class="px-3 py-2 border-b border-gray-700">52</td>

            <td class="px-3 py-2 border-b border-gray-700">76</td>

            <td class="px-3 py-2 border-b border-gray-700">16</td>

            <td class="px-3 py-2 border-b border-gray-700">82</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">2,2,3</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">K</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">78</td>

            <td class="px-3 py-2 border-b border-gray-700">17</td>

            <td class="px-3 py-2 border-b border-gray-700">86</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">S12</td>

            <td class="px-3 py-2 border-b border-gray-700">2,3,2</td>

            <td class="px-3 py-2 border-b border-gray-700">SB</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">K</td>

            <td class="px-3 py-2 border-b border-gray-700">C</td>

            <td class="px-3 py-2 border-b border-gray-700">48</td>

            <td class="px-3 py-2 border-b border-gray-700">108</td>

            <td class="px-3 py-2 border-b border-gray-700">24</td>

            <td class="px-3 py-2 border-b border-gray-700">120</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">S1=M1</td>

            <td class="px-3 py-2 border-b border-gray-700">2,2,3</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">K/C</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">CH</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">106</td>

            <td class="px-3 py-2 border-b border-gray-700">32</td>

            <td class="px-3 py-2 border-b border-gray-700">126</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">S12</td>

            <td class="px-3 py-2 border-b border-gray-700">2,3,2</td>

            <td class="px-3 py-2 border-b border-gray-700">SB</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">CH</td>

            <td class="px-3 py-2 border-b border-gray-700">K</td>

            <td class="px-3 py-2 border-b border-gray-700">47.4</td>

            <td class="px-3 py-2 border-b border-gray-700">93</td>

            <td class="px-3 py-2 border-b border-gray-700">37</td>

            <td class="px-3 py-2 border-b border-gray-700">107</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">S1=08M1</td>

            <td class="px-3 py-2 border-b border-gray-700">2,2,3</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">K</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">CH</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">97</td>

            <td class="px-3 py-2 border-b border-gray-700">35</td>

            <td class="px-3 py-2 border-b border-gray-700">111</td>

          </tr>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">This choice should be made if the previous ones cannot, in the case where  <span class="math">u = 8,12</span>  or 16 modulo 20. Tables 11 and 12 give the complexities of  <span class="math">\\mathbb{F}_{p^{12}}</span>  operations when  <span class="math">\\xi = \\sqrt{-5}</span>  which means, according to Section 3.8, that  <span class="math">u = 12,16,28,48,52</span>  or 56 modulo 60 (but not 8,32 or 36).</p>

    <p class="text-gray-300">Table 10:  <span class="math">\\mathbb{F}_{p^{12}}</span>  complexities if  <span class="math">\\mu = -2</span>  assuming our improvements are not used and  <span class="math">\\mathbf{A}_1 &amp;gt; 0.33\\mathbf{M}_1</span></p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Oper-ation</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Case</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Arithmetic used</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Number of operations without/with improvement</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

          </tr>

        </thead>

        <tbody>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">Fp2</td>

            <td class="px-3 py-2 border-b border-gray-700">Fp4</td>

            <td class="px-3 py-2 border-b border-gray-700">Fp6</td>

            <td class="px-3 py-2 border-b border-gray-700">Fp12</td>

            <td class="px-3 py-2 border-b border-gray-700">M1</td>

            <td class="px-3 py-2 border-b border-gray-700">A1</td>

            <td class="px-3 py-2 border-b border-gray-700">A'1</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">M12</td>

            <td class="px-3 py-2 border-b border-gray-700">2,3,2</td>

            <td class="px-3 py-2 border-b border-gray-700">K</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">K</td>

            <td class="px-3 py-2 border-b border-gray-700">K</td>

            <td class="px-3 py-2 border-b border-gray-700">54</td>

            <td class="px-3 py-2 border-b border-gray-700">225/183</td>

            <td class="px-3 py-2 border-b border-gray-700">50</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">2,2,3</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">K</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">226/184</td>

            <td class="px-3 py-2 border-b border-gray-700">52</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">sM12</td>

            <td class="px-3 py-2 border-b border-gray-700">2,3,2</td>

            <td class="px-3 py-2 border-b border-gray-700">K</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">K</td>

            <td class="px-3 py-2 border-b border-gray-700">K</td>

            <td class="px-3 py-2 border-b border-gray-700">39</td>

            <td class="px-3 py-2 border-b border-gray-700">131/122</td>

            <td class="px-3 py-2 border-b border-gray-700">32</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">2,2,3</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">K</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">134/123</td>

            <td class="px-3 py-2 border-b border-gray-700">34</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">S12</td>

            <td class="px-3 py-2 border-b border-gray-700">2,3,2</td>

            <td class="px-3 py-2 border-b border-gray-700">K/C</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">CH</td>

            <td class="px-3 py-2 border-b border-gray-700">K</td>

            <td class="px-3 py-2 border-b border-gray-700">36</td>

            <td class="px-3 py-2 border-b border-gray-700">151/140</td>

            <td class="px-3 py-2 border-b border-gray-700">50</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">2,2,3</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">K</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">CH</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">155/140</td>

            <td class="px-3 py-2 border-b border-gray-700">48</td>

          </tr>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">Table 11:  <span class="math">\\mathbb{F}_{p^{12}}</span>  complexities if  <span class="math">\\mu = -5</span>  (assuming  <span class="math">\\mathbf{A}_1 \\leq 0.33\\mathbf{M}_1</span>  if our improvements are not used)</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Oper-ation</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Case</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Arithmetic used</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Number of operations</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

          </tr>

        </thead>

        <tbody>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">Fp2</td>

            <td class="px-3 py-2 border-b border-gray-700">Fp4</td>

            <td class="px-3 py-2 border-b border-gray-700">Fp6</td>

            <td class="px-3 py-2 border-b border-gray-700">Fp12</td>

            <td class="px-3 py-2 border-b border-gray-700">M1</td>

            <td class="px-3 py-2 border-b border-gray-700">A1</td>

            <td class="px-3 py-2 border-b border-gray-700">A'1</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">M12</td>

            <td class="px-3 py-2 border-b border-gray-700">2,3,2</td>

            <td class="px-3 py-2 border-b border-gray-700">SB</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">K</td>

            <td class="px-3 py-2 border-b border-gray-700">K</td>

            <td class="px-3 py-2 border-b border-gray-700">72</td>

            <td class="px-3 py-2 border-b border-gray-700">181</td>

            <td class="px-3 py-2 border-b border-gray-700">50</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">2,2,3</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">K</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">182</td>

            <td class="px-3 py-2 border-b border-gray-700">52</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">sM12</td>

            <td class="px-3 py-2 border-b border-gray-700">2,3,2</td>

            <td class="px-3 py-2 border-b border-gray-700">SB</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">K</td>

            <td class="px-3 py-2 border-b border-gray-700">K</td>

            <td class="px-3 py-2 border-b border-gray-700">52</td>

            <td class="px-3 py-2 border-b border-gray-700">92</td>

            <td class="px-3 py-2 border-b border-gray-700">32</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">2,2,3</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">K</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">95</td>

            <td class="px-3 py-2 border-b border-gray-700">34</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">S12</td>

            <td class="px-3 py-2 border-b border-gray-700">2,3,2</td>

            <td class="px-3 py-2 border-b border-gray-700">SB/C</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">CH</td>

            <td class="px-3 py-2 border-b border-gray-700">K</td>

            <td class="px-3 py-2 border-b border-gray-700">42</td>

            <td class="px-3 py-2 border-b border-gray-700">133</td>

            <td class="px-3 py-2 border-b border-gray-700">50</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">2,2,3</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">K</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">CH</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">137</td>

            <td class="px-3 py-2 border-b border-gray-700">48</td>

          </tr>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">Table 12:  <span class="math">\\mathbb{F}_{p^{12}}</span>  complexities if  <span class="math">\\mu = -5</span>  assuming our improvements are not used and  <span class="math">\\mathbf{A}_1 &amp;gt; 0.33\\mathbf{M}_1</span></p>

    <p class="text-gray-300">This choice should be made if  <span class="math">u = 0</span>  or 4 modulo 20 and we assume that  <span class="math">\\xi = \\sqrt{\\mu}</span>  since it is always possible to choose such a  <span class="math">\\mu</span> . In this case, we have  <span class="math">\\mathbf{m}_{1,\\mu} = \\mathbf{m}_{2,\\xi} = \\mathbf{M}_1</span>  and the complexities of  <span class="math">\\mathbb{F}_{p^{12}}</span>  operations are given in Tables 13 and 14.</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Oper-ation</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Case</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Arithmetic used</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Number of operations without/with improvement</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

          </tr>

        </thead>

        <tbody>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">\\( \\mathbb{F}_{p^2} \\)</td>

            <td class="px-3 py-2 border-b border-gray-700">\\( \\mathbb{F}_{p^4} \\)</td>

            <td class="px-3 py-2 border-b border-gray-700">\\( \\mathbb{F}_{p^6} \\)</td>

            <td class="px-3 py-2 border-b border-gray-700">\\( \\mathbb{F}_{p^{12}} \\)</td>

            <td class="px-3 py-2 border-b border-gray-700">\\( \\mathbf{M}_1 \\)</td>

            <td class="px-3 py-2 border-b border-gray-700">\\( \\mathbf{A}_1 \\)</td>

            <td class="px-3 py-2 border-b border-gray-700">\\( \\mathbf{A}'_1 \\)</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">\\( \\mathbf{M}_{12} \\)</td>

            <td class="px-3 py-2 border-b border-gray-700">2,3,2</td>

            <td class="px-3 py-2 border-b border-gray-700">K</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">K</td>

            <td class="px-3 py-2 border-b border-gray-700">K</td>

            <td class="px-3 py-2 border-b border-gray-700">79</td>

            <td class="px-3 py-2 border-b border-gray-700">210/168</td>

            <td class="px-3 py-2 border-b border-gray-700">0</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">2,2,3</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">K</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">80</td>

            <td class="px-3 py-2 border-b border-gray-700">210/168</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">\\( \\mathbf{sM}_{12} \\)</td>

            <td class="px-3 py-2 border-b border-gray-700">2,3,2</td>

            <td class="px-3 py-2 border-b border-gray-700">K</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">K</td>

            <td class="px-3 py-2 border-b border-gray-700">K</td>

            <td class="px-3 py-2 border-b border-gray-700">55</td>

            <td class="px-3 py-2 border-b border-gray-700">115/106</td>

            <td class="px-3 py-2 border-b border-gray-700">0</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">2,2,3</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">K</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">56</td>

            <td class="px-3 py-2 border-b border-gray-700">117/106</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">\\( \\mathbf{S}_{12} \\)</td>

            <td class="px-3 py-2 border-b border-gray-700">2,3,2</td>

            <td class="px-3 py-2 border-b border-gray-700">K</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">K</td>

            <td class="px-3 py-2 border-b border-gray-700">C</td>

            <td class="px-3 py-2 border-b border-gray-700">54</td>

            <td class="px-3 py-2 border-b border-gray-700">144/133</td>

            <td class="px-3 py-2 border-b border-gray-700">6</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">2,2,3</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">K/C</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">CH</td>

            <td class="px-3 py-2 border-b border-gray-700">58</td>

            <td class="px-3 py-2 border-b border-gray-700">142/127</td>

            <td class="px-3 py-2 border-b border-gray-700">10</td>

          </tr>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">Table 13:  <span class="math">\\mathbb{F}_{p^{12}}</span>  complexities if  <span class="math">\\mu</span>  is large (assuming  <span class="math">\\mathbf{A}_1 \\leq 0.33\\mathbf{M}_1</span>  if our improvements are not used)</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Oper-ation</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Case</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Arithmetic used</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Number of operations</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

          </tr>

        </thead>

        <tbody>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">\\( \\mathbb{F}_{p^2} \\)</td>

            <td class="px-3 py-2 border-b border-gray-700">\\( \\mathbb{F}_{p^4} \\)</td>

            <td class="px-3 py-2 border-b border-gray-700">\\( \\mathbb{F}_{p^6} \\)</td>

            <td class="px-3 py-2 border-b border-gray-700">\\( \\mathbb{F}_{p^{12}} \\)</td>

            <td class="px-3 py-2 border-b border-gray-700">\\( \\mathbf{M}_1 \\)</td>

            <td class="px-3 py-2 border-b border-gray-700">\\( \\mathbf{A}_1 \\)</td>

            <td class="px-3 py-2 border-b border-gray-700">\\( \\mathbf{A}'_1 \\)</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">\\( \\mathbf{M}_{12} \\)</td>

            <td class="px-3 py-2 border-b border-gray-700">2,3,2</td>

            <td class="px-3 py-2 border-b border-gray-700">SB</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">K</td>

            <td class="px-3 py-2 border-b border-gray-700">K</td>

            <td class="px-3 py-2 border-b border-gray-700">97</td>

            <td class="px-3 py-2 border-b border-gray-700">156</td>

            <td class="px-3 py-2 border-b border-gray-700">0</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">2,2,3</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">K</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">98</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">\\( \\mathbf{sM}_{12} \\)</td>

            <td class="px-3 py-2 border-b border-gray-700">2,3,2</td>

            <td class="px-3 py-2 border-b border-gray-700">SB</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">K</td>

            <td class="px-3 py-2 border-b border-gray-700">K</td>

            <td class="px-3 py-2 border-b border-gray-700">68</td>

            <td class="px-3 py-2 border-b border-gray-700">76</td>

            <td class="px-3 py-2 border-b border-gray-700">0</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">2,2,3</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">K</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">69</td>

            <td class="px-3 py-2 border-b border-gray-700">78</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">\\( \\mathbf{S}_{12} \\)\\( S_{1=M_1} \\)</td>

            <td class="px-3 py-2 border-b border-gray-700">2,3,2</td>

            <td class="px-3 py-2 border-b border-gray-700">SB</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">K</td>

            <td class="px-3 py-2 border-b border-gray-700">C</td>

            <td class="px-3 py-2 border-b border-gray-700">66</td>

            <td class="px-3 py-2 border-b border-gray-700">108</td>

            <td class="px-3 py-2 border-b border-gray-700">6</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">2,2,3</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">K/C</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">CH</td>

            <td class="px-3 py-2 border-b border-gray-700">70</td>

            <td class="px-3 py-2 border-b border-gray-700">106</td>

            <td class="px-3 py-2 border-b border-gray-700">10</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">\\( \\mathbf{S}_{12} \\)\\( S_{1=M_1} \\)</td>

            <td class="px-3 py-2 border-b border-gray-700">2,3,2</td>

            <td class="px-3 py-2 border-b border-gray-700">SB</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">K</td>

            <td class="px-3 py-2 border-b border-gray-700">C</td>

            <td class="px-3 py-2 border-b border-gray-700">66</td>

            <td class="px-3 py-2 border-b border-gray-700">108</td>

            <td class="px-3 py-2 border-b border-gray-700">6</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">2,2,3</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">K/SB</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">CH</td>

            <td class="px-3 py-2 border-b border-gray-700">73.6</td>

            <td class="px-3 py-2 border-b border-gray-700">82</td>

            <td class="px-3 py-2 border-b border-gray-700">16</td>

          </tr>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">Table 14:  <span class="math">\\mathbb{F}_{p^{12}}</span>  complexities if  <span class="math">\\mu</span>  is large assuming our improvements are not used and  <span class="math">\\mathbf{A}_1 &amp;gt; 0.33\\mathbf{M}_1</span></p>

    <p class="text-gray-300">Looking at these tables, we can make some interesting remarks:</p>

    <ul class="list-disc list-inside space-y-1 text-gray-300 my-2 ml-4">

      <li>As noticed in Remark 7 building  <span class="math">\\mathbb{F}_{p^{12}}</span>  with a 2,3,2 tower remains preferable in most cases to a 2,2,3 tower if our new improvements are not used but this is no longer the case if there are used. Anyway, the difference between the complexities of the two choices for building  <span class="math">\\mathbb{F}_{p^{12}}</span>  is negligible.</li>

      <li>As already mentioned, the choice of  <span class="math">\\mu</span>  has a great influence on the number of additions involved in  <span class="math">\\mathbb{F}_{p^{12}}</span>  arithmetic, so it should be chosen first, even if the choice of  <span class="math">\\xi</span>  is not optimal in this case. For example, it is better to take  <span class="math">\\mu = -2, \\xi = 2 + \\sqrt{-2}</span>  than  <span class="math">\\mu = -5, \\xi = \\sqrt{-5}</span> .</li>

    </ul>

    <ul class="list-disc list-inside space-y-1 text-gray-300 my-2 ml-4">

      <li>Our new improvements have a significant impact on <span class="math">\\mathbb{F}_{p^{12}}</span> arithmetic if <span class="math">\\mathbb{F}_p</span> additions are costly which, as explained in Section 3.1, is often the case in low level implementations. For example if <span class="math">\\mathbf{A}_1 = 0.25\\mathbf{M}_1</span> (which is probably not far from the average cost of additions in hardware implementations), our improvements are providing a gain between 6 and <span class="math">13\\%</span> on <span class="math">\\mathbb{F}_{p^{12}}</span> arithmetic (and then on pairing computation). In fact the gain is even not so negligible if <span class="math">\\mathbb{F}_p</span> additions are cheap (like in software implementations). For example, if <span class="math">\\mathbf{A}_1 = 0.1\\mathbf{M}_1</span>, it is between 3 and <span class="math">7\\%</span>.</li>

      <li>The cost of <span class="math">\\mathbb{F}_p</span> squaring (with respect to <span class="math">\\mathbb{F}_p</span> multiplication) and <span class="math">\\mathbb{F}_p</span> doubling (with respect to <span class="math">\\mathbb{F}_p</span> addition) have very few impact on the choices to be made for <span class="math">\\mathbb{F}_{p^{12}}</span> arithmetic.</li>

    </ul>

    <p class="text-gray-300">The parameter <span class="math">u</span> is involved at several levels of the pairing computation, so that the best choice is not trivial to do. Let us summarize the constraints on <span class="math">u</span> that we have to deal with in order to make a good choice.</p>

    <ul class="list-disc list-inside space-y-1 text-gray-300 my-2 ml-4">

      <li>The parameter <span class="math">u</span> is defining the security level. Indeed, it is both parametrizing the size of the elliptic curve (whose prime order is <span class="math">36u^4 + 36u^3 + 18u^2 + 6u + 1</span>) and the number of elements of the target finite field (which is <span class="math">(36u^4 + 36u^3 + 24u^2 + 6u + 1)^{12}</span>).</li>

      <li>It is involved as an exponent in the Miller loop. More precisely, in the case of an optimal Ate pairing, the exponent of the Miller loop is <span class="math">6u + 2</span>. In order to optimize this step, <span class="math">u</span> should be chosen such that <span class="math">6u + 2</span> is sparse.</li>

      <li>It is involved as an exponent in the final exponentiation. If the addition chain given in Section 2.4 is used, <span class="math">u</span> is directly used (three times) as an exponent, so it should be sparse to ensure a fast final exponentiation. Other final exponentiation methods may involve exponentiations by <span class="math">6u + 5</span> and <span class="math">6u^2 + 1</span> [21, 23] or <span class="math">6u + 4</span> [23] but these quantities are usually sparse at the same time as <span class="math">u</span>.</li>

      <li>The sign of <span class="math">u</span> has no consequence in terms of complexities of the algorithms involved. Indeed, changing <span class="math">u</span> in <span class="math">-u</span> costs an <span class="math">\\mathbb{F}_{p^{12}}</span> inversion, but this inversion can be replaced by a conjugation in <span class="math">\\mathbb{F}_{p^{12}} / \\mathbb{F}_{p^6}</span> thanks to the final exponentiation.</li>

      <li>Choosing <span class="math">u</span> with a signed binary representation (to facilitate the research of a sparse <span class="math">u</span>) is possible if the exponentiation algorithms are adapted.</li>

      <li>The choice of <span class="math">u</span> has a great impact on <span class="math">\\mathbb{F}_{p^{12}}</span> arithmetic. The work done in Section 3 shows that the choice of the extension tower is a direct consequence of the value of <span class="math">u</span> modulo 12, 20, 36 or 60. It is summarized in Table 4. The best choice is <span class="math">u = 7</span> or 11 modulo 12 so that we can use <span class="math">\\mu = -1</span> and <span class="math">\\xi = 1 + \\mathbf{i}</span>. Depending on the situation, it could be better to choose a</li>

    </ul>

    <p class="text-gray-300">sparser <span class="math">u \\neq 7, 11</span> modulo 12 or reciprocally a <span class="math">u</span> of higher Hamming weight but congruent to 7 or 11 modulo 12.</p>

    <p class="text-gray-300">Hence <span class="math">u</span> should be chosen as sparse as possible and with the best possible way to build <span class="math">\\mathbb{F}_{p^{12}}</span>. Moreover, its size must ensure the right security level. For example, at the 128-bit security level, <span class="math">u</span> should be a 63-bit integer. A 95-bit integer provides a 192-bit security level on the elliptic curve but not in <span class="math">\\mathbb{F}_{p^{12}}</span>. To get this level of security, a 169 or 170-bit integer <span class="math">u</span> should be chosen.</p>

    <p class="text-gray-300">Thanks to the results of Section 3.8, finding an appropriate value of <span class="math">u</span> can be easily done by an exhaustive search with any software which is able to check integer's primality. Unfortunately, only few values of <span class="math">u</span> with very low Hamming weight can be found. The best choice at the 128-bit security level is given by <span class="math">u = -2^{61} - 2^{55} - 1</span> [44], even if it is ensuring a slightly smaller security level than 128. It has weight 3 and is congruent to 11 modulo 12, so that <span class="math">\\mu = -1</span> and <span class="math">\\xi = 1 + \\mathbf{i}</span> can be used to build <span class="math">\\mathbb{F}_{p^{12}}</span> (and to twist the curve). For these reasons, it is widely used in the literature. However, relaxing the constraint on the weight of <span class="math">u</span> allows to generate many good values of <span class="math">u</span> (of weight 4, 5 or 6 for example) that can be used in a database of pairing friendly parameters or for higher (or smaller) security levels.</p>

    <h2 id="sec-56" class="text-2xl font-bold">5.1 Choosing the elliptic curve</h2>

    <p class="text-gray-300">Choosing the curve is not difficult once <span class="math">u</span> is chosen. Indeed, the base field <span class="math">\\mathbb{F}_p</span> and the cardinality of the curve <span class="math">r</span> are fixed by the BN parametrisation given in Section 2.1. Then, we only have to find <span class="math">b \\in \\mathbb{F}_p</span> such that the curve defined by the equation</p>

    <div class="my-4 text-center"><span class="math-block">E: y ^ {2} = x ^ {3} + b</span></div>

    <p class="text-gray-300">has cardinality <span class="math">r</span>. Because of the form of the equation and of the existence of a sextic twist, there are only 6 isomorphism classes over <span class="math">\\mathbb{F}_p</span>. So, if <span class="math">b</span> is randomly chosen, there is about one chance in 6 that <span class="math">\\# E(\\mathbb{F}_p) = r</span>. Checking the cardinality is easily done by verifying that <span class="math">rP = O_E</span> for some <span class="math">P \\in E(\\mathbb{F}_p)</span>.</p>

    <p class="text-gray-300"><strong>Remark 8.</strong> We will see in Section 6 that the coefficient <span class="math">b</span> is involved in the elliptic curve arithmetic, so that it is better to choose it small.</p>

    <p class="text-gray-300">However, <span class="math">E</span> is not the only curve to choose, we also have to choose its twist <span class="math">E&#x27;</span>. If <span class="math">\\xi</span> is the <span class="math">\\mathbb{F}_{p^2}</span> element chosen to define <span class="math">\\mathbb{F}_{p^{12}}</span>, <span class="math">E&#x27;</span> is defined over <span class="math">\\mathbb{F}_{p^2}</span> by the equation</p>

    <div class="my-4 text-center"><span class="math-block">y ^ {2} = x ^ {3} + b ^ {\\prime},</span></div>

    <p class="text-gray-300">where <span class="math">b&#x27; = b / \\xi</span> or <span class="math">b&#x27; = b\\xi</span>, such that <span class="math">r</span> divides the cardinality of <span class="math">E&#x27;</span>. This is the case for exactly one of the two choices for <span class="math">b&#x27;</span> [2]. Again, the correct choice for <span class="math">b&#x27;</span> is done by checking the cardinality of <span class="math">E&#x27;</span>, thanks to some point in <span class="math">E&#x27;(\\mathbb{F}_{p^2})</span>.</p>

    <p class="text-gray-300">32</p>

    <p class="text-gray-300">Since <span class="math">E(\\mathbb{F}_p)</span> has prime order, it is naturally protected against subgroup attacks which exploit small prime divisors of the cofactor [38]. However, this is not the case of <span class="math">E&#x27;(\\mathbb{F}_{p^2})</span> whose order equals <span class="math">r(2p - r)</span>. For example, the value of <span class="math">u</span> given in Section 4, and usually used in the literature for the 128-bit security level, is not naturally protected against subgroup attacks. This can be prevented by using (possibly expensive) membership tests. If we want to avoid these tests, the parameter <span class="math">u</span> should be chosen such that both <span class="math">r</span> and <span class="math">2p - r</span> are prime numbers [5].</p>

    <h2 id="sec-57" class="text-2xl font-bold">5.2 Choosing the generators</h2>

    <p class="text-gray-300">In this section, we present an explicit method to construct the points <span class="math">P</span> and <span class="math">Q</span> potentially involved in the optimal Ate pairing computations. Since <span class="math">E(\\mathbb{F}_p)</span> has prime order <span class="math">r</span>, it is trivial to find a suitable candidate for <span class="math">P</span>: any point <span class="math">P \\neq O_E</span> has order <span class="math">r</span>.</p>

    <p class="text-gray-300">However, generating a suitable point <span class="math">Q</span> seems less easy because it must be of order <span class="math">r</span> in <span class="math">E\\left(\\mathbb{F}_{p^{12}}\\right)</span>, come from the twisted curve and be an eigenvector for the eigenvalue <span class="math">p</span> of the Frobenius map. In fact, it is not so difficult because the last condition is a consequence of the other ones [29]. Finding a suitable point <span class="math">Q</span> is then done in the following way:</p>

    <ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">

      <li>Choose a random point <span class="math">Q&#x27;</span> in <span class="math">E&#x27;(\\mathbb{F}_{p^2})</span>.</li>

      <li>If <span class="math">Q&#x27;</span> has not order <span class="math">r</span> (which is statistically always the case), replace it by <span class="math">(p - 2r)Q&#x27;</span> which has order <span class="math">r</span> since <span class="math">\\# E&#x27;(\\mathbb{F}_{p^2}) = (p - 2r)r</span>.</li>

      <li>If <span class="math">Q&#x27; = O_{E&#x27;}</span> then repeat steps 1 and 2.</li>

      <li>Map <span class="math">Q&#x27;</span> to <span class="math">E\\left(\\mathbb{F}_{p^{12}}\\right)</span> thanks to the twist isomorphism between <span class="math">E</span> and <span class="math">E&#x27;</span> over <span class="math">\\mathbb{F}_{p^{12}}</span>. If <span class="math">b&#x27; = b / \\xi</span> this is nothing but</li>

    </ol>

    <div class="my-4 text-center"><span class="math-block">Q = \\left(x _ {Q ^ {\\prime}} \\gamma^ {2}, y _ {Q ^ {\\prime}} \\gamma^ {3}\\right) \\text{ if } \\gamma^ {6} = \\xi .</span></div>

    <p class="text-gray-300">Then <span class="math">Q</span> is a valuable candidate, in particular it lies in the <span class="math">p</span>-eigenspace of <span class="math">\\pi</span>.</p>

    <h2 id="sec-58" class="text-2xl font-bold">6 Choosing the system of coordinates</h2>

    <p class="text-gray-300">In this section, we give the formulas for adding and doubling points on BN curves (with the line computation) and their complexities in the affine and the projective cases (it is now well known that Jacobian coordinates are always less efficient than projective coordinates for pairing computations [18]). This allows to determine which system of coordinates should be chosen, depending on the context. Assuming the previous choices, the two operations involved in the Miller loop are</p>

    <p class="text-gray-300">The doubling step. In this step, we have to</p>

    <ul class="list-disc list-inside space-y-1 text-gray-300 my-2 ml-4">

      <li>double a temporary point <span class="math">T = \\left(x_{T}\\gamma^{2},y_{T}\\gamma^{3}\\right)\\in E\\left(\\mathbb{F}_{p^{12}}\\right)</span> with <span class="math">x_{T},y_{T}\\in \\mathbb{F}_{p^{2}}</span></li>

      <li>compute the tangent line to <span class="math">E</span> at <span class="math">T</span></li>

      <li>evaluate it at <span class="math">P = (x_{P},y_{P})\\in E(\\mathbb{F}_{p})</span></li>

    </ul>

    <p class="text-gray-300">The addition step In this step, we have to</p>

    <ul class="list-disc list-inside space-y-1 text-gray-300 my-2 ml-4">

      <li>add <span class="math">Q = \\left(x_{Q}\\gamma^{2},y_{Q}\\gamma^{3}\\right)</span> and <span class="math">T = \\left(x_{T}\\gamma^{2},y_{T}\\gamma^{3}\\right)</span> in <span class="math">E\\left(\\mathbb{F}_{p^{12}}\\right)</span> with <span class="math">x_{Q},y_{Q},x_{T},y_{T} \\in \\mathbb{F}_{p^{2}}</span></li>

      <li>compute the line passing through <span class="math">T</span> and <span class="math">Q</span></li>

      <li>evaluate it at <span class="math">P = (x_{P},y_{P})\\in E(\\mathbb{F}_{p})</span></li>

    </ul>

    <h2 id="sec-59" class="text-2xl font-bold">6.1 Affine coordinates</h2>

    <p class="text-gray-300">The slope of the line passing through <span class="math">T</span> and <span class="math">Q</span> (or the tangent line at <span class="math">T</span> if <span class="math">T = Q</span>) is <span class="math">\\lambda \\gamma</span>, with</p>

    <div class="my-4 text-center"><span class="math-block">\\lambda = \\frac {y _ {T} - y _ {Q}}{x _ {T} - x _ {Q}} \\quad \\left(\\mathrm {o r} \\quad \\lambda = \\frac {3 x _ {T} ^ {2}}{2 y _ {T}}\\right).</span></div>

    <p class="text-gray-300">Then <span class="math">T + Q</span> (or <span class="math">2T</span>) can be written in the form <span class="math">\\left(x_{T + Q}\\gamma^{2},y_{T + Q}\\gamma^{3}\\right)</span> with</p>

    <div class="my-4 text-center"><span class="math-block">x _ {T + Q} = \\lambda^ {2} - x _ {T} - x _ {Q} \\quad \\text{and} \\quad y _ {T + Q} = \\lambda (x _ {T} - x _ {T + Q}) - y _ {T}.</span></div>

    <p class="text-gray-300">The equation of the line involved in the operation is <span class="math">y = \\lambda \\gamma (x - x_{T}\\gamma^{2}) - y_{T}\\gamma^{3}</span>, thus the <span class="math">\\mathbb{F}_{p^{12}}</span> element involved in the update of <span class="math">f</span> in Algorithm 1 is</p>

    <div class="my-4 text-center"><span class="math-block">\\ell = y _ {P} - \\lambda x _ {P} \\gamma + (\\lambda x _ {T} - y _ {T}) \\gamma^ {3}.</span></div>

    <p class="text-gray-300">Assuming that <span class="math">-x_{P}</span> is precomputed, the cost of the addition step (including the line computation) is then <span class="math">\\mathbf{I}_2 + 3\\mathbf{M}_2 + \\mathbf{S}_2 + 2\\mathbf{M}_1 + 7\\mathbf{A}_2</span> and the cost of the doubling step is <span class="math">\\mathbf{I}_2 + 3\\mathbf{M}_2 + 2\\mathbf{S}_2 + 2\\mathbf{M}_1 + 5\\mathbf{A}_2 + 2\\mathbf{A}&#x27;_2</span>.</p>

    <p class="text-gray-300"><strong>Remark 9.</strong> Since <span class="math">\\lambda</span> is used three times in <span class="math">\\mathbb{F}_{p^2}</span> operations (<span class="math">\\lambda^2, \\lambda(x_T - x_{T+Q})</span> and <span class="math">\\lambda x_T</span>), <span class="math">2\\mathbf{A}_1</span> can be saved using our idea of precomputing its trace if the Karatsuba/complex methods are used for <span class="math">\\mathbb{F}_{p^2}</span> arithmetic. In the same way, <span class="math">x_T</span> is used twice in the doubling step so that an additional <span class="math">\\mathbf{A}_1</span> can be saved in this case.</p>

    <h2 id="sec-60" class="text-2xl font-bold">6.2 Projective coordinates</h2>

    <p class="text-gray-300">In order to avoid inversions in <span class="math">\\mathbb{F}_{p^2}</span>, projective coordinates are used for the point <span class="math">T</span>, so that <span class="math">T = (X_T\\gamma^2, Y_T\\gamma^3, Z_T)</span> with <span class="math">X_T, Y_T</span> and <span class="math">Z_T \\in \\mathbb{F}_{p^2}</span>. However, the</p>

    <p class="text-gray-300">point <span class="math">Q</span> is kept in affine coordinates (mixed addition method). According to [18], <span class="math">2T = \\left(X_{2T}\\gamma^{2},Y_{2T}\\gamma^{3},Z_{2T}\\right)</span> with</p>

    <div class="my-4 text-center"><span class="math-block">X _ {2 T} = 2 X _ {T} Y _ {T} \\left(Y _ {T} ^ {2} - 9 b Z _ {T} ^ {2}\\right)</span></div>

    <div class="my-4 text-center"><span class="math-block">Y _ {2 T} = \\left(Y _ {T} ^ {2} + 9 b Z _ {T} ^ {2}\\right) ^ {2} - 1 2 (3 b Z _ {T} ^ {2}) ^ {2}</span></div>

    <div class="my-4 text-center"><span class="math-block">Z _ {2 T} = 8 Y _ {T} ^ {3} Z _ {T}</span></div>

    <p class="text-gray-300">and the equation of the tangent to the curve at <span class="math">T</span> is (up to some subfield multiple)</p>

    <div class="my-4 text-center"><span class="math-block">\\ell = 2 y _ {P} Y _ {T} Z _ {T} - 3 x _ {P} X _ {T} ^ {2} \\gamma + \\left(Y _ {T} ^ {2} - 3 b Z _ {T} ^ {2}\\right) \\gamma^ {3}.</span></div>

    <p class="text-gray-300">Assuming that <span class="math">-3x_{P}</span> is precomputed, the doubling step (including the line computation) then requires <span class="math">2\\mathbf{M}_2 + 7\\mathbf{S}_2 + 4\\mathbf{M}_1 + 13\\mathbf{A}_2 + 5\\mathbf{A}&#x27;_2 + 2\\mathbf{m}_{1,b}</span>. In order to obtain this complexity, the double products like <span class="math">2X_{T}Y_{T}</span> are computed by <span class="math">(X_{T} + Y_{T})^{2} - X_{T}^{2} - Y_{T}^{2}</span>. This trick is not always interesting over <span class="math">\\mathbb{F}_p</span> (e.g. if <span class="math">\\mathbf{M}_1 = \\mathbf{S}_1</span>) but it is always interesting over <span class="math">\\mathbb{F}_{p^2}</span> because <span class="math">\\mathbf{S}_2</span> is clearly cheaper than <span class="math">\\mathbf{M}_2</span> according to Section 3.5.</p>

    <p class="text-gray-300">In the same way, if</p>

    <div class="my-4 text-center"><span class="math-block">N = Y _ {T} - y _ {Q} Z _ {T},</span></div>

    <div class="my-4 text-center"><span class="math-block">D = X _ {T} - x _ {Q} Z _ {T} \\quad (\\text {so that} \\lambda = \\frac {N}{D}),</span></div>

    <div class="my-4 text-center"><span class="math-block">X = N ^ {2} Z _ {T} - X _ {T} D ^ {2} - x _ {Q} D ^ {2} Z _ {T},</span></div>

    <p class="text-gray-300">we compute the addition step with</p>

    <div class="my-4 text-center"><span class="math-block">X _ {T + Q} = D X</span></div>

    <div class="my-4 text-center"><span class="math-block">Y _ {T + Q} = N \\left(x _ {Q} D ^ {2} Z _ {T} - X\\right) - y _ {Q} D ^ {3} Z _ {T}</span></div>

    <div class="my-4 text-center"><span class="math-block">Z _ {T + Q} = D ^ {3} Z _ {T}</span></div>

    <div class="my-4 text-center"><span class="math-block">\\ell = y _ {P} D - N x _ {P} \\gamma + \\left(N x _ {Q} - D y _ {Q}\\right) \\gamma^ {3}.</span></div>

    <p class="text-gray-300">Assuming that <span class="math">-x_{P}</span> is precomputed, this requires <span class="math">12\\mathbf{M}_2 + 2\\mathbf{S}_2 + 4\\mathbf{M}_1 + 7\\mathbf{A}_2</span>.</p>

    <p class="text-gray-300"><strong>Remark 10.</strong> Again, many <span class="math">\\mathbb{F}_{p^2}</span> operands are used several times during the computation, so that precomputing the traces saves additions in <span class="math">\\mathbb{F}_p</span>. We do not give details here because the addition step is rarely used in the Miller loop but it is not difficult to see that <span class="math">16\\mathbf{A}_1</span> can be saved if Karatsuba/complex arithmetic is used for <span class="math">\\mathbb{F}_{p^2}</span> arithmetic.</p>

    <h2 id="sec-61" class="text-2xl font-bold">6.3 Consequences of formulas</h2>

    <p class="text-gray-300">Several remarks can be made looking at these formulas.</p>

    <p class="text-gray-300">The first one is that the influence of <span class="math">b</span> is small since it is just involved in two multiplications by <span class="math">\\mathbb{F}_p</span> elements. Hence a sparse <span class="math">u</span> or a value of <span class="math">u</span> enabling a nice choice of <span class="math">\\mu</span> (and <span class="math">\\xi</span>) should be preferred, even if a very small value of <span class="math">b</span> is not</p>

    <p class="text-gray-300">available.</p>

    <p class="text-gray-300">The second one is that, as mentioned in Sections 3.6 and 3.7, the line <span class="math">\\ell</span> is of the form <span class="math">b_{0} + b_{1}\\gamma + b_{3}\\gamma^{3}</span> with <span class="math">b_{i} \\in \\mathbb{F}_{p^{2}}</span>, thus it is sparse in <span class="math">\\mathbb{F}_{p^{12}}</span> and a multiplication by <span class="math">\\ell</span> is faster than a full multiplication in <span class="math">\\mathbb{F}_{p^{12}}</span>.</p>

    <p class="text-gray-300">The third one is that, as already mentioned in [34, 1, 35, 27], it can be better to use affine coordinates than projective coordinates, depending on the context. Indeed, using the complexity formula for <span class="math">\\mathbf{I}_2</span> given in Section 3.2.4 and the complexities obtained for the doubling step in affine and projective coordinates, it is easy to verify that affine coordinates become interesting for this step (and then for the full Miller loop) as soon as</p>

    <div class="my-4 text-center"><span class="math-block">\\mathbf {I} _ {1} &amp;lt;   5 \\mathbf {S} _ {2} - \\mathbf {M} _ {2} - 2 \\mathbf {S} _ {1} + 1 5 \\mathbf {A} _ {1} + 6 \\mathbf {A} _ {1} ^ {\\prime} + 2 \\mathbf {m} _ {1, b} - \\mathbf {m} _ {1, \\mu}.</span></div>

    <p class="text-gray-300">For example, in the case <span class="math">\\mu = -1, \\mathbf{A}_1 \\leq 0.33\\mathbf{M}_1</span>, Tables 1 and 2 show that affine coordinates are interesting as soon as</p>

    <div class="my-4 text-center"><span class="math-block">\\mathbf {I} _ {1} &amp;lt;   7 \\mathbf {M} _ {1} - 2 \\mathbf {S} _ {1} + 2 0 \\mathbf {A} _ {1} + 1 1 \\mathbf {A} _ {1} ^ {\\prime} + 2 \\mathbf {m} _ {1, b}. \\tag {3}</span></div>

    <p class="text-gray-300">Depending on the way to implement <span class="math">\\mathbb{F}_p</span> inversion, this inequality may hold in practice, especially if <span class="math">\\mathbb{F}_p</span> addition are not negligible. In Table 15, we give the maximum cost of <span class="math">\\mathbf{I}_1</span> for which affine coordinates should be chosen, depending on the context. To make the results more readable, we assumed that <span class="math">\\mathbf{S}_1 = \\mathbf{M}_1, \\mathbf{A}_1 = \\mathbf{A}&#x27;_1</span> and <span class="math">b = 2</span> (which is the least advantageous value for affine coordinates). In any case, the non-simplified result is very similar to (3).</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Use affine coordinates if</th>

          </tr>

        </thead>

        <tbody>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">-1</td>

            <td class="px-3 py-2 border-b border-gray-700"><span class="math">\\mathbf{I}_1 &lt; 5\\mathbf{M}_1 + 33\\mathbf{A}_1</span></td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">-2</td>

            <td class="px-3 py-2 border-b border-gray-700"><span class="math">\\mathbf{I}_1 &lt; 5\\mathbf{M}_1 + 41\\mathbf{A}_1</span></td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">-5</td>

            <td class="px-3 py-2 border-b border-gray-700"><span class="math">\\mathbf{I}_1 &lt; 5\\mathbf{M}_1 + 42\\mathbf{A}_1</span></td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">any</td>

            <td class="px-3 py-2 border-b border-gray-700"><span class="math">\\mathbf{I}_1 &lt; 13\\mathbf{M}_1 + 28\\mathbf{A}_1</span></td>

          </tr>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">Table 15: Affine coordinates versus projective ones</p>

    <p class="text-gray-300">We describe here some algorithms which should not influence the choice of the parameters but which are important for the efficiency of pairing computation.</p>

    <p class="text-gray-300">Let</p>

    <div class="my-4 text-center"><span class="math-block">a = b _ {0} + b _ {1} \\gamma + b _ {2} \\gamma^ {2} + b _ {3} \\gamma^ {3} + b _ {4} \\gamma^ {4} + b _ {5} \\gamma^ {5}</span></div>

    <p class="text-gray-300">be an arbitrary element of <span class="math">\\mathbb{F}_{p^{12}}</span>, where <span class="math">b_{j}\\in\\mathbb{F}_{p^{2}}</span>, <span class="math">j=0,\\ldots,5</span> and <span class="math">\\gamma^{6}=\\xi\\in\\mathbb{F}_{p^{2}}</span>. The Frobenius map, which consists in computing <span class="math">a^{p}</span>, can be easily written in terms of <span class="math">a</span>. In this section, we give a way to compute it efficiently, as well as <span class="math">a^{p^{\\prime}}</span> for <span class="math">i=1,\\ldots,11</span>.</p>

    <h4 id="sec-64" class="text-lg font-semibold mt-6">7.1.1 Computation of <span class="math">a^{p}</span></h4>

    <p class="text-gray-300">Since the Frobenius map is linear, we have</p>

    <p class="text-gray-300"><span class="math">a^{p}=b_{0}^{p}+b_{1}^{p}\\gamma^{p}+b_{3}^{p}\\left(\\gamma^{2}\\right)^{p}+b_{3}^{p}\\left(\\gamma^{3}\\right)^{p}+b_{4}^{p}\\left(\\gamma^{4}\\right)^{p}+b_{5}^{p}\\left(\\gamma^{5}\\right)^{p},</span></p>

    <p class="text-gray-300">and <span class="math">b_{j}^{p}</span> is just the conjugate <span class="math">\\overline{b_{j}}</span> of <span class="math">b_{j}</span>. Therefore, we only have to study the <span class="math">\\left(\\gamma^{j}\\right)^{p}</span>. For this, we define the constant</p>

    <p class="text-gray-300"><span class="math">\\delta=\\xi^{\\frac{p-1}{6}}\\in\\mathbb{F}_{p^{2}},</span></p>

    <p class="text-gray-300">so that <span class="math">\\gamma^{p}=(\\gamma^{6})^{(p-1)/6}\\gamma=\\delta\\gamma</span> and we have</p>

    <p class="text-gray-300"><span class="math">a^{p}=\\overline{b_{0}}+\\overline{b_{1}}\\delta\\gamma+\\overline{b_{2}}\\delta^{2}\\gamma^{2}+\\overline{b_{3}}\\delta^{3}\\gamma^{3}+\\overline{b_{4}}\\delta^{4}\\gamma^{4}+\\overline{b_{5}}\\delta^{5}\\gamma^{5}.</span></p>

    <p class="text-gray-300">The constants <span class="math">\\delta^{j}</span> are only depending on the way to build <span class="math">\\mathbb{F}_{p^{12}}</span>, so they can be precomputed. Finally, computing <span class="math">a^{p}</span> requires <span class="math">5\\mathbf{M}_{2}</span>. If precomputing the <span class="math">\\delta^{j}</span> is a problem in terms of memory resources, they can of course all be recovered from <span class="math">\\delta</span> using only <span class="math">2\\mathbf{S}_{2}+2\\mathbf{M}_{2}</span>. But in any case, <span class="math">\\delta</span> should be precomputed since it is very expensive to compute.</p>

    <p class="text-gray-300">Let us finally note that some particular choices of <span class="math">\\mu</span> and <span class="math">\\xi</span> allow to improve this computation by using a precomputed constant in <span class="math">\\mathbb{F}_{p}</span> instead of <span class="math">\\delta\\in\\mathbb{F}_{p^{2}}</span>. Some details for the most interesting cases are given in Section 7.1.4.</p>

    <h4 id="sec-65" class="text-lg font-semibold mt-6">7.1.2 Computation of <span class="math">a^{p^{2}}</span></h4>

    <p class="text-gray-300">In this case</p>

    <p class="text-gray-300"><span class="math">a^{p^{2}}=b_{0}+b_{1}\\gamma^{p^{2}}+b_{2}\\left(\\gamma^{2}\\right)^{p^{2}}+b_{3}\\left(\\gamma^{3}\\right)^{p^{2}}+b_{4}\\left(\\gamma^{4}\\right)^{p^{2}}+b_{5}\\left(\\gamma^{5}\\right)^{p^{2}}.</span></p>

    <p class="text-gray-300">We need the new precomputed constant</p>

    <p class="text-gray-300"><span class="math">\\omega=\\xi^{\\frac{p^{2}-1}{6}}=N_{\\mathbb{F}_{p^{2}}/\\mathbb{F}_{p}}(\\delta)\\in\\mathbb{F}_{p}.</span></p>

    <p class="text-gray-300">Then we have <span class="math">\\gamma^{p^{2}}=(\\gamma^{6})^{(p^{2}-1)/6}\\gamma=\\omega\\gamma</span>. Notice that <span class="math">\\omega</span> is a primitive <span class="math">6</span>th root of unity (because <span class="math">\\xi</span> is neither a square nor a cube in <span class="math">\\mathbb{F}_{p^{2}}</span>). In particular, we have</p>

    <p class="text-gray-300"><span class="math">\\omega^{2}-\\omega+1=0.</span> (4)</p>

    <p class="text-gray-300">Then</p>

    <p class="text-gray-300"><span class="math">a^{p^{2}}=b_{0}+b_{1}\\omega\\gamma+b_{2}\\left(\\omega-1\\right)\\gamma^{2}-b_{3}\\gamma^{3}-b_{4}\\omega\\gamma^{4}-b_{5}\\left(\\omega-1\\right)\\gamma^{5},</span></p>

    <p class="text-gray-300">and computing <span class="math">a^{p^{2}}</span> requires one addition in <span class="math">\\mathbb{F}_{p}</span> to compute <span class="math">\\omega-1</span> (it can be precomputed but the interest is really limited) and <span class="math">5</span> multiplications of an element of <span class="math">\\mathbb{F}_{p^{2}}</span> by an element of <span class="math">\\mathbb{F}_{p}</span>, thus the total cost is <span class="math">10\\mathbf{M}_{1}+\\mathbf{A}_{1}</span>.</p>

    <p class="text-gray-300">####</p>

    <p class="text-gray-300">7.1.3 Generalization to the computation of <span class="math">a^{p^i}</span></p>

    <p class="text-gray-300">The results of the two previous sections can be generalized as follows: for <span class="math">i = 1, \\ldots, 11</span>, <span class="math">j = 0, \\ldots, 5</span>, let <span class="math">c_{i,j} = \\omega^{j\\lfloor i / 2\\rfloor}</span>. Notice that it is easy to deduce from (4) that <span class="math">c_{i,j} = 1</span> (resp. <span class="math">\\omega, \\omega - 1, -1, -\\omega, -\\omega + 1</span>) if <span class="math">j\\lfloor i / 2\\rfloor = 0 \\mod 6</span> (resp. 1, 2, 3, 4, 5). We find that for <span class="math">i = 1, \\ldots, 11</span>,</p>

    <div class="my-4 text-center"><span class="math-block">a^{p^i} = \\overline{b_0} + \\overline{b_1} c_{i,1} \\delta \\gamma + \\overline{b_2} c_{i,2} \\delta^2 \\gamma^2 + \\overline{b_3} c_{i,3} \\delta^3 \\gamma^3 + \\overline{b_4} c_{i,4} \\delta^4 \\gamma^4 + \\overline{b_5} c_{i,5} \\delta^5 \\gamma^5</span></div>

    <p class="text-gray-300">if <span class="math">i</span> is odd, and</p>

    <div class="my-4 text-center"><span class="math-block">a^{p^i} = b_0 + b_1 c_{i,1} \\gamma + b_2 c_{i,2} \\gamma^2 + b_3 c_{i,3} \\gamma^3 + b_4 c_{i,4} \\gamma^4 + b_5 c_{i,5} \\gamma^5</span></div>

    <p class="text-gray-300">if <span class="math">i</span> is even.</p>

    <p class="text-gray-300">As explained for <span class="math">i = 2</span>, the <span class="math">c_{i,j}</span> can be easily deduced from <span class="math">\\omega</span>, so that only <span class="math">\\omega, \\delta</span> and possibly the <span class="math">c_{i,j} \\delta^j</span> need to be precomputed. We also note that computing <span class="math">a^{p^p}</span> is for free, since it is nothing but the conjugation in <span class="math">\\mathbb{F}_{p^{12}} / \\mathbb{F}_{p^6}</span>.</p>

    <p class="text-gray-300">7.1.4 Simplification of the constant <span class="math">\\delta</span> for odd powers</p>

    <p class="text-gray-300">For some particular choices of <span class="math">\\mu</span> and <span class="math">\\xi</span>, the precomputed constants for odd powers of the Frobenius map can be simplified.</p>

    <p class="text-gray-300">The case <span class="math">\\mu = -1</span> and <span class="math">\\xi = 1 + \\mathbf{i}</span>. We proved in Section 3.8 that in this case, <span class="math">u = 7</span> or 11 modulo 12, so <span class="math">p</span> equals 7 modulo 12. Then</p>

    <div class="my-4 text-center"><span class="math-block">\\delta = (1 + \\mathbf{i})^{\\frac{p - 1}{6}} = (1 + \\mathbf{i})^{\\frac{p - 7}{12}} (1 + \\mathbf{i}) = (2\\mathbf{i})^{\\frac{p - 7}{12}} (1 + \\mathbf{i}) = \\mathbf{i}^{\\frac{p - 7}{12}} (1 + \\mathbf{i}) \\mathbf{2}^{\\frac{p - 7}{12}},</span></div>

    <p class="text-gray-300">thus we only need to precompute <span class="math">d_{1} = 2^{\\frac{p - 7}{12}} \\in \\mathbb{F}_{p}</span> instead of <span class="math">\\delta \\in \\mathbb{F}_{p^2}</span>. Moreover, in this case, <span class="math">\\overline{\\delta} = \\mathbf{i}\\delta</span> so that <span class="math">\\omega = \\mathbf{i}\\delta^{2}</span> and by (4), we get <span class="math">\\delta^4 = 1 - \\mathbf{i}\\delta^2</span>. Finally, if <span class="math">d_{2} = -2d_{1}^{2}</span> and <span class="math">d_{3} = d_{1}d_{2}</span>, it is easy to find that</p>

    <div class="my-4 text-center"><span class="math-block">\\begin{array}{l} \\left(\\delta, \\delta^2, \\delta^3, \\delta^4, \\delta^5\\right) = \\left(\\overline{\\xi} d_1, \\mathbf{i} d_2, \\xi d_3, d_2 + 1, \\overline{\\xi} (d_1 + d_3)\\right) \\text{ if } u = 11, 19 \\mod 24, \\\\ = \\left(-\\overline{\\xi} d_1, \\mathbf{i} d_2, -\\xi d_3, d_2 + 1, -\\overline{\\xi} (d_1 + d_3)\\right) \\text{ if } u = 7, 23 \\mod 24. \\end{array}</span></div>

    <p class="text-gray-300">It is not necessary to precompute <span class="math">d_{2}</span> and <span class="math">d_{3}</span> because their computation requires only <span class="math">\\mathbf{M}_1 + \\mathbf{S}_1 + \\mathbf{A}&#x27;_1</span>. Once they are computed, computing <span class="math">a^p</span> requires 5 multiplications of an element of <span class="math">\\mathbb{F}_p</span> by an element of <span class="math">\\mathbb{F}_{p^2}</span>, 2 additions <span class="math">(1 + d_{2}</span> and <span class="math">d_{1} + d_{3})</span> and 3 multiplications by <span class="math">\\xi</span> or <span class="math">\\overline{\\xi}</span>. Finally, assuming that <span class="math">d_{1}</span> is precomputed, computing <span class="math">a^p</span> requires <span class="math">11\\mathbf{M}_1 + \\mathbf{S}_1 + 8\\mathbf{A}_1 + \\mathbf{A}&#x27;_1</span>.</p>

    <p class="text-gray-300">The case <span class="math">\\xi = \\sqrt{\\mu}</span>. We assume that <span class="math">u</span> is even (see Section 3.5.1), so <span class="math">p = 1 \\mod 12</span>. We have</p>

    <div class="my-4 text-center"><span class="math-block">\\delta = \\sqrt{\\mu}^{\\frac{p - 1}{6}} = \\mu^{\\frac{p - 1}{12}} \\in \\mathbb{F}_p.</span></div>

    <p class="text-gray-300">Therefore, multiplications by <span class="math">\\delta</span> and its powers by <span class="math">\\mathbb{F}_{p^2}</span> elements cost <span class="math">2\\mathbf{M}_1</span> and <span class="math">\\overline{\\delta} = \\delta</span> so that <span class="math">\\omega = \\delta^2</span> and by (4), <span class="math">\\delta^4 = \\delta^2 - 1</span> (and <span class="math">\\delta^5 = \\delta^3 - \\delta</span>). Finally, if <span class="math">\\delta</span> is precomputed, computing <span class="math">a^p</span> requires <span class="math">11\\mathbf{M}_1 + \\mathbf{S}_1 + 2\\mathbf{A}_1</span> (<span class="math">\\mathbf{M}_1 + \\mathbf{S}_1 + 2\\mathbf{A}_1</span> to compute the <span class="math">\\delta^j</span> and <span class="math">10\\mathbf{M}_1</span> to compute the <span class="math">\\overline{b_j}\\delta^j</span>).</p>

    <p class="text-gray-300">7.2 Cyclotomic squaring</p>

    <p class="text-gray-300">As mentioned in Section 2.4, the final exponentiation requires exponentiations in the subgroup <span class="math">G_{\\Phi_6(p^2)}</span> of <span class="math">\\mathbb{F}_{p^{12}}^*</span> of elements of order dividing <span class="math">\\Phi_6(p^2)</span>. Since around <span class="math">3\\log_2u</span> squarings are performed during the final exponentiation, saving few field operations for each squaring leads to a significant improvement. Given <span class="math">a\\in \\mathbb{F}_{p^{12}}</span>, the condition <span class="math">a^{\\Phi_6(p^2)} = 1</span> combined with a description of the Frobenius action gives algebraic relations on the coordinates of <span class="math">a</span> (where <span class="math">\\mathbb{F}_{p^{12}}</span> is seen as a <span class="math">\\mathbb{F}_{p^2}</span>-vector space). Granger and Scott [26] proposed to exploit these relations to simplify the expression of <span class="math">a^2</span>.</p>

    <p class="text-gray-300">Furthermore, these relations can be used to compress the representation of <span class="math">a</span> in such a way that the square of <span class="math">a</span> can be directly computed in its compressed form (multiplications have to be performed on the non-compressed forms). In particular, Karabina's method for compressed squaring [31, 2] costs <span class="math">3\\mathbf{S}_2 + 10\\mathbf{A}_2 + \\mathbf{m}_{2,\\xi}</span> less than Granger and Scott's method (in most cases). On the other hand, the decompression step is relatively expensive and requires an inversion in <span class="math">\\mathbb{F}_{p^2}</span>. The number of decompressions required for an exponentiation is at most the Hamming weight of the exponent, which is assumed to be small in our situation (see Sections 2.4 and 4), and moreover, Montgomery's simultaneous inversion trick [41] can be used (we refer to [2] for more details). Therefore, if <span class="math">\\mathbb{F}_{p^2}</span> inversions are available (at a reasonable cost), Karabina's method should be used for final exponentiation, otherwise, Granger and Scott's method should be chosen.</p>

    <p class="text-gray-300">7.2.1 Karabina's method</p>

    <p class="text-gray-300">This method is due to Karabina [31] and was slightly improved in [2]. Let <span class="math">a = b_{0} + b_{1}\\gamma +b_{2}\\gamma^{2} + b_{3}\\gamma^{3} + b_{4}\\gamma^{4} + b_{5}\\gamma^{5}\\in G_{\\Phi_{6}(p^{2})}\\setminus \\{1\\}</span>, with <span class="math">b_{j}\\in \\mathbb{F}_{p^{2}}</span>. The compressed representation of <span class="math">a</span> is <span class="math">[b_1,b_2,b_4,b_5]</span>. The full representation (decompression) of <span class="math">a</span> is obtained via the formulae</p>

    <div class="my-4 text-center"><span class="math-block">b _ {3} = \\frac {b _ {5} ^ {2} \\xi + 3 b _ {2} ^ {2} - 2 b _ {4}}{4 b _ {1}}, \\qquad b _ {0} = (2 b _ {3} ^ {2} + b _ {1} b _ {5} - 3 b _ {4} b _ {2}) \\xi + 1, \\qquad \\mathrm {if} b _ {1} \\neq 0,</span></div>

    <div class="my-4 text-center"><span class="math-block">b _ {3} = \\frac {2 b _ {2} b _ {5}}{b _ {4}}, \\qquad \\qquad b _ {0} = (2 b _ {3} ^ {2} - 3 b _ {4} b _ {2}) \\xi + 1, \\qquad \\qquad \\mathrm {if} b _ {1} = 0,</span></div>

    <p class="text-gray-300">for a cost of <span class="math">\\mathbf{I}_2 + 2\\mathbf{M}_2 + 3\\mathbf{S}_2 + 4\\mathbf{A}&#x27;_2 + 6\\mathbf{A}_2 + 2\\mathbf{m}_{2,\\xi} + \\mathbf{A}_1</span> (or <span class="math">\\mathbf{I}_2 + 2\\mathbf{M}_2 + \\mathbf{S}_2 + 2\\mathbf{A}&#x27;_2 + 2\\mathbf{A}_2 + \\mathbf{m}_{2,\\xi} + \\mathbf{A}_1</span> if <span class="math">b_1 = 0</span>). The compressed representation <span class="math">[B_1, B_2, B_4, B_5]</span> of <span class="math">a^2</span> can be computed using the formulae</p>

    <div class="my-4 text-center"><span class="math-block">B _ {1} = 2 b _ {1} + 3 \\left(S _ {2, 5} - S _ {2} - S _ {5}\\right) \\xi \\quad B _ {4} = 3 \\left(S _ {2} + S _ {5} \\xi\\right) - 2 b _ {4}</span></div>

    <div class="my-4 text-center"><span class="math-block">B _ {2} = 3 \\left(S _ {1} + S _ {4} \\xi\\right) - 2 b _ {2} \\quad B _ {5} = 2 b _ {5} + 3 \\left(S _ {1, 4} - S _ {1} - S _ {4}\\right),</span></div>

    <p class="text-gray-300">where <span class="math">S_{i,j} = (b_i + b_j)^2</span> and <span class="math">S_{i} = b_{i}^{2}</span>, for a cost of <span class="math">6\\mathbf{S}_2 + 4\\mathbf{A}&#x27;_2 + 16\\mathbf{A}_2 + 3\\mathbf{m}_{2,\\xi}</span>.</p>

    <p class="text-gray-300">7.2.2 Granger and Scott's method</p>

    <p class="text-gray-300">This method is due to Granger and Scott [26]. They worked with a tower 2, 2, 3 but their results can be easily adapted to a tower 2, 3, 2, either by using the</p>

    <p class="text-gray-300">39</p>

    <p class="text-gray-300">same technique and the formulae from Section 7.1, or simply by expanding the formulae for a tower 2, 2, 3.</p>

    <p class="text-gray-300"><strong>Case 2, 2, 3.</strong> With the notations of Section 3.7, let <span class="math"> a = c_0 + c_1\\gamma + c_2\\gamma^2 \\in \\mathbb{F}_{p^{12}} = \\mathbb{F}_{p^2}[\\gamma] </span>, where <span class="math"> c_0, c_1, c_2 \\in \\mathbb{F}_{p^4} </span> and write</p>

    <div class="my-4 text-center"><span class="math-block">a^2 = C_0 + C_1\\gamma + C_2\\gamma^2,</span></div>

    <p class="text-gray-300">where <span class="math"> C_0, C_1, C_2 \\in \\mathbb{F}_{p^4} </span>. If <span class="math"> a \\in G_{\\Phi_{\\mathrm{E}}(p^2)} </span>, then we have the following formulae, given in [26]</p>

    <div class="my-4 text-center"><span class="math-block">C_0 = 3c_0^2 - 2\\overline{c_0}</span></div>

    <div class="my-4 text-center"><span class="math-block">C_1 = 3\\beta c_2^2 + 2\\overline{c_1}</span></div>

    <div class="my-4 text-center"><span class="math-block">C_2 = 3c_1^2 - 2\\overline{c_2},</span></div>

    <p class="text-gray-300">where <span class="math"> \\overline{u + v\\beta} = u - v\\beta </span>, for <span class="math"> u, v \\in \\mathbb{F}_{p^2} </span>. Therefore, the square of <span class="math"> a \\in G_{\\Phi_{\\mathrm{E}}(p^2)} </span> can be computed for a cost of <span class="math"> 3\\mathbf{S}_4 + 3\\mathbf{A}&#x27;_4 + 6\\mathbf{A}_4 + \\mathbf{m}_{4,\\beta} </span> (using that an expression of the form <span class="math"> 3u + 2v = 2(u + v) + u </span> can be computed with one doubling and 2 additions).</p>

    <p class="text-gray-300"><strong>Case 2, 3, 2.</strong> With the notations of Section 3.6, let <span class="math"> a = (b_0 + b_2\\beta + b_4\\beta^2) + (b_1 + b_3\\beta + b_5\\beta^2)\\gamma \\in \\mathbb{F}_{p^2}[\\gamma] </span>, where <span class="math"> b_i \\in \\mathbb{F}_{p^2} </span>, <span class="math"> i = 0, \\ldots, 5 </span>, and write</p>

    <div class="my-4 text-center"><span class="math-block">a^2 = (B_0 + B_2\\beta + B_4\\beta^2) + (B_1 + B_3\\beta + B_5\\beta^2)\\gamma</span></div>

    <p class="text-gray-300">where <span class="math"> B_i \\in \\mathbb{F}_{p^2} </span>, <span class="math"> i = 0, \\ldots, 5 </span>. If <span class="math"> a \\in G_{\\Phi_{\\mathrm{E}}(p^2)} </span>, then we have</p>

    <div class="my-4 text-center"><span class="math-block">B_0 = 3(b_5^2\\xi + b_0^2) - 2b_0</span></div>

    <div class="my-4 text-center"><span class="math-block">B_2 = 3(b_4^2\\xi + b_1^2) - 2b_2</span></div>

    <div class="my-4 text-center"><span class="math-block">B_4 = 3(b_5^2\\xi + b_2^2) - 2b_4</span></div>

    <div class="my-4 text-center"><span class="math-block">B_1 = 3\\xi((b_2 + b_5)^2 - b_2^2 - b_5^2)) + 2b_1</span></div>

    <div class="my-4 text-center"><span class="math-block">B_3 = 3((b_0 + b_3)^2 - b_0^2 - b_3^2)) + 2b_3</span></div>

    <div class="my-4 text-center"><span class="math-block">B_5 = 3((b_4 + b_1)^2 - b_4^2 - b_1^2)) + 2b_5.</span></div>

    <p class="text-gray-300">We find that the square of <span class="math"> a \\in G_{\\Phi_{\\mathrm{E}}(p^2)} </span> can be computed for a cost of <span class="math"> 9\\mathbf{S}_2 + 6\\mathbf{A}&#x27;_2 + 24\\mathbf{A}_2 + 4\\mathbf{m}_{2,\\xi} </span>.</p>

    <p class="text-gray-300"><strong>Remark 11.</strong> According to Table 3, <span class="math"> \\mathbf{S}_4 = 3\\mathbf{S}_2 + \\mathbf{m}_{2,\\xi} + 4\\mathbf{A}_2 </span> in the most common case and then it is easy to verify that the cost of squaring in the case 2, 2, 3 is exactly the same as in the case 2, 3, 2</p>

    <p class="text-gray-300">In this paper, we explained in details how to choose and generate the parameters for implementing a pairing on BN curves. More precisely, we explained the choices which should be made in terms of</p>

    <p class="text-gray-300">40</p>

    <ul class="list-disc list-inside space-y-1 text-gray-300 my-2 ml-4">

      <li>pairing algorithm (Miller loop, final exponentiation),</li>

      <li>ways to build the tower field depending on the value of the BN parameter <span class="math">u</span> as a nice application of old elementary arithmetic results,</li>

      <li><span class="math">\\mathbb{F}_{p^{12}}</span> arithmetic depending on the relative cost of <span class="math">\\mathbb{F}_p</span> operations on the targeted device,</li>

      <li>groups involved (base elliptic curve, its twist and their generators),</li>

      <li>system of coordinates to be used depending on the context.</li>

    </ul>

    <p class="text-gray-300">Of course, the best choices are already well-known but there are many situations where generating other parameters is necessary (pairing parameters database, other security levels than 126-bit, resistance to subgroups attacks, trusted parameters, ...) and this paper should help anyone interested by generating pairing parameters depending on the target device (security level, relative cost of <span class="math">\\mathbb{F}_p</span> operations, memory resources, ...). Moreover, we used this opportunity to give some new improvements on <span class="math">\\mathbb{F}_{p^{12}}</span> arithmetic (in a pairing context) in terms of <span class="math">\\mathbb{F}_p</span>-addition because they are usually not so negligible for small devices. The gain obtained on <span class="math">\\mathbb{F}_{p^{12}}</span> arithmetic is around <span class="math">10\\%</span>, depending on the context and the <span class="math">\\mathbb{F}_{p^{12}}</span> operation considered.</p>

    <h2 id="sec-67" class="text-2xl font-bold">References</h2>

    <p class="text-gray-300">[1] Tolga Acar, Kristin E. Lauter, Michael Naehrig, and Daniel Shumow. Affine pairings on ARM. In Michel Abdalla and Tanja Lange, editors, <em>Pairing-Based Cryptography - Pairing 2012</em>, volume 7708 of <em>Lecture Notes in Computer Science</em>, pages 203209. Springer, 2012.</p>

    <p class="text-gray-300">[2] D. Aranha, K. Karabina, P. Longa, C. H. Gebotys, and J Lpez. Faster explicit formulas for computing pairings over ordinary curves. In <em>Advances in Cryptology EUROCRYPT 2011</em>, volume 6632 of LNCS, pages 4868. Springer, 2011.</p>

    <p class="text-gray-300">[3] Dieg oF. Aranha, Paulo S.L.M. Barreto, Patrick Longa, and Jefferson E. Ricardini. The realm of the pairings. In Tanja Lange, Kristin Lauter, and Petr Lisonk, editors, <em>Selected Areas in Cryptography  SAC 2013</em>, volume 8282 of <em>Lecture Notes in Computer Science</em>, pages 325. Springer Berlin Heidelberg, 2014.</p>

    <p class="text-gray-300">[4] Razvan Barbulescu, Pierrick Gaudry, Antoine Joux, and Emmanuel Thom. A heuristic quasi-polynomial algorithm for discrete logarithm in finite fields of small characteristic.</p>

    <p class="text-gray-300">[5] Paulo S. L. M. Barreto, Craig Costello, Rafael Misoczki, Michael Naehrig, Geovandro C. C. F. Pereira, and Gustavo Zanon. Subgroup security in pairing-based cryptography. In <em>LATINCRYPT 2015</em>, volume 9230 of <em>Lecture Notes in Computer Science</em>, pages 245265. Springer-Verlag, 2015.</p>

    <p class="text-gray-300">41</p>

    <p class="text-gray-300">[6] Paulo S. L. M. Barreto, Steven D. Galbraith, Colm O. hEigeartaigh, and Michael Scott. Efficient pairing computation on supersingular abelian varieties. IACR Cryptology ePrint Archive, 2004:375, 2004.</p>

    <p class="text-gray-300">[7] Paulo S. L. M. Barreto, Hae Yong Kim, Ben Lynn, and Michael Scott. Efficient algorithms for pairing-based cryptosystems. In CRYPTO 2002, volume 2442 of LNCS, pages 354368. Springer, 2002.</p>

    <p class="text-gray-300">[8] Paulo S. L. M. Barreto and Michael Naehrig. Pairing-friendly elliptic curves of prime order. In Proc. of SAC 2005, volume 3897 of LNCS, pages 319331. Springer-Verlag, 2006.</p>

    <p class="text-gray-300">[9] Paul Barrett. Implementing the rivest shamir and adleman public key encryption algorithm on a standard digital signal processor. In Proceedings on Advances in cryptologyCRYPTO '86, pages 311323, London, UK, UK, 1987. Springer-Verlag.</p>

    <p class="text-gray-300">[10] Dan Boneh and Matthew K. Franklin. Identity-based encryption from the weil pairing. In CRYPTO 2001, volume 2139 of Lecture Notes in Computer Science, pages 213229. Springer, 2001.</p>

    <p class="text-gray-300">[11] Dan Boneh, Craig Gentry, and B. Waters.</p>

    <p class="text-gray-300">[12] Dan Boneh, Ben Lynn, and Hovav Shacham. Short signatures from the weil pairing. Journal of cryptology, 17(4):297319, 2004.</p>

    <p class="text-gray-300">[13] Laura Fuentes Castaneda, Edward Knapp, and Francisco Rodrguez Henrquez. Faster hashing to <span class="math">\\{\\backslash</span> mathbb G\\}_2$. In Selected Areas in Cryptography - 18th International Workshop, 2011, Toronto, ON, Canada, August 1112, 2011, Revised Selected Papers, pages 412430, 2011.</p>

    <p class="text-gray-300">[14] Ray C. C. Cheung, Sylvain Duquesne, Junfeng Fan, Nicolas Guillermin, Ingrid Verbauwhede, and Gavin Xiaoxu Yao. FPGA implementation of pairings using residue number system and lazy reduction. In Cryptographic Hardware and Embedded Systems - CHES 2011, volume 6917 of LNCS, pages 421441. Springer, 2011.</p>

    <p class="text-gray-300">[15] Jaewook Chung and M. Anwar Hasan. More generalized mersenne numbers: (extended abstract). In Selected Areas in Cryptography, 10th Annual International Workshop, SAC 2003, Ottawa, Canada, August 1415, 2003, Revised Papers, pages 335347, 2003.</p>

    <p class="text-gray-300">[16] Jaewook Chung and M Anwar Hasan. Asymmetric squaring formulae. In <span class="math">18^{th}</span> symposium on Computer Arithmetic, Montpellier, France, IEEE conference publications, pages 113122, 2007.</p>

    <p class="text-gray-300">[17] Henri Cohen, Gerhard Frey, Roberto Avanzi, Christophe Doche, Tanja Lange, Kim Nguyen, and Frederik Vercauteren. Handbook of Elliptic and Hyperelliptic Curve Cryptography, Second Edition. Chapman &amp; Hall/CRC, 2nd edition, 2012.</p>

    <p class="text-gray-300">42</p>

    <p class="text-gray-300">[18] Craig Costello, Tanja Lange, and Michael Naehrig. Faster pairing computations on curves with high-degree twists. In PhongQ. Nguyen and David Pointcheval, editors, Public Key Cryptography -AS PKC 2010, volume 6056 of Lecture Notes in Computer Science, pages 224-242. Springer Berlin Heidelberg, 2010.</p>

    <p class="text-gray-300">[19] David A. Cox. <em>Primes of the form <span class="math">x^2 + ny^2</span></em>. 1989.</p>

    <p class="text-gray-300">[20] Augusto Jun Devegili, Colm O'Eigeartaigh, Michael Scott, and Ricardo Dahab. Multiplication and squaring on pairing-friendly fields. IACR Cryptology ePrint Archive, page 471, 2006.</p>

    <p class="text-gray-300">[21] Augusto Jun Devegili, Michael Scott, and Ricardo Dahab. Implementing cryptographic pairings over barreto-naehrig curve. pages 197-207.</p>

    <p class="text-gray-300">[22] Sylvain Duquesne. RNS arithmetic in pk and application to fast pairing computation. J. Mathematical Cryptology, 5(1):51-88, 2011.</p>

    <p class="text-gray-300">[23] Sylvain Duquesne and Loubna Ghammam. Memory-saving computation of the pairing final exponentiation on bn curves. Groups, Complexity, Cryptology, 2015. To appear.</p>

    <p class="text-gray-300">[24] C. C. F. Pereira Geovandro, Marcos A. Simplicio Jr., Michael Naehrig, and Paulo S. L. M. Barreto. A family of implementation-friendly bn elliptic curves. Journal of Systems and Software, 84(8):1319-1326, 2011.</p>

    <p class="text-gray-300">[25] Christophe Giraud and Vincent Verneuil. Atomicity improvement for elliptic curve scalar multiplication. In Dieter Gollmann, Jean-Louis Lanet, and Julien Iguchi-Cartigny, editors, Smart Card Research and Advanced Application, volume 6035 of Lecture Notes in Computer Science, pages 80-101. Springer Berlin Heidelberg, 2010.</p>

    <p class="text-gray-300">[26] Robert Granger and Michael Scott. Faster squaring in the cyclotomic subgroup of sixth degree extensions. In Public Key Cryptography - PKC 2010, 13th International Conference on Practice and Theory in Public Key Cryptography, Paris, France, May 26-28, 2010. Proceedings, pages 209-223, 2010.</p>

    <p class="text-gray-300">[27] Gurleen Grewal, Reza Azarderakhsh, Patrick Longa, Shi Hu, and David Jao. Efficient implementation of bilinear pairings on arm processors. In LarsR. Knudsen and Huapeng Wu, editors, Selected Areas in Cryptography, volume 7707 of Lecture Notes in Computer Science, pages 149-165. Springer Berlin Heidelberg, 2013.</p>

    <p class="text-gray-300">[28] Florian He. Pairing lattices. In Proc. of Pairing 2008, volume 5209 of LNCS, pages 18-38, 2008.</p>

    <p class="text-gray-300">[29] Florian Hess, Nigel P. Smart, and Frederik Vercauteren. The eta pairing revisited. IEEE Transactions on Information Theory, 52(10):4595-4602, 2006.</p>

    <p class="text-gray-300">43</p>

    <p class="text-gray-300">[30] Antoine Joux. A new index calculus algorithm with complexity <span class="math">l(1/4+o(1))</span> in small characteristic. In Tanja Lange, Kristin Lauter, and Petr Lisonk, editors, Selected Areas in Cryptography  SAC 2013, volume 8282 of Lecture Notes in Computer Science, pages 355379. Springer Berlin Heidelberg, 2014.</p>

    <p class="text-gray-300">[31] Koray Karabina. Squaring in cyclotomic subgroups. <em>Math. Comput.</em>, 82(281), 2013.</p>

    <p class="text-gray-300">[32] Donald E. Knuth. <em>The Art of Computer Programming, Volume 2 (3rd Ed.): Seminumerical Algorithms</em>. Addison-Wesley Longman Publishing Co., Inc., Boston, MA, USA, 1997.</p>

    <p class="text-gray-300">[33] N. Koblitz and A. Menezes. Pairing-based cryptography at high security levels. <em>Cryptography and coding</em>, 3796:1336, 2005.</p>

    <p class="text-gray-300">[34] Kristin E. Lauter, Peter L. Montgomery, and Michael Naehrig. An analysis of affine coordinates for pairing computation. In Marc Joye, Atsuko Miyaji, and Akira Otsuka, editors, <em>Pairing-Based Cryptography - Pairing 2010 - 4th International Conference, Yamanaka Hot Spring, Japan, December 2010. Proceedings</em>, volume 6487 of <em>Lecture Notes in Computer Science</em>, pages 120. Springer, 2010.</p>

    <p class="text-gray-300">[35] Duc-Phong Le and ChikHow Tan. Speeding up ate pairing computation in affine coordinates. In Taekyoung Kwon, Mun-Kyu Lee, and Daesung Kwon, editors, <em>Information Security and Cryptology - AS ICISC 2012</em>, volume 7839 of <em>Lecture Notes in Computer Science</em>, pages 262277. Springer Berlin Heidelberg, 2013.</p>

    <p class="text-gray-300">[36] Eunjeong Lee, Hyang-Sook Lee, and Cheol-Min Park. Efficient and generalized pairing computation on abelian varieties. <em>Information Theory, IEEE Transactions on</em>, 55(4):17931803, April 2009.</p>

    <p class="text-gray-300">[37] Rudolf Lidl and Harald Niederreiter. <em>Finite Fields</em>. Cambridge University Press, 1997.</p>

    <p class="text-gray-300">[38] Chae Hoon Lim and Pil Joong Lee. A key recovery attack on discrete log-based schemes using a prime order subgroup. In <em>CRYPTO 1997</em>, pages 249263. Springer-Verlag, 1997.</p>

    <p class="text-gray-300">[39] Seiichi Matsuda, Naoki Kanayama, Florian He, and Eiji Okamoto. Optimised versions of the Ate and twisted Ate pairings. <em>IEICE Transactions</em>, 92-A(7):16601667, 2009.</p>

    <p class="text-gray-300">[40] S.V. Miller. The weil pairing, and its efficient calculation. <em>Journal of cryptology</em>, vol. 17(4), pp. 235261, 2004.</p>

    <p class="text-gray-300">[41] P. L. Montgomery. Speeding the pollard and elliptic curve methods of factorization. <em>Mathematics of Computation</em>, 48(177):243264, 1987.</p>

    <p class="text-gray-300">44</p>

    <p class="text-gray-300">[42] Peter L. Montgomery. Modular multiplication without trial division. Mathematics of Computation, 44(170):519521, 1985.</p>

    <p class="text-gray-300">[43] Michael Naehrig, Ruben Niederhagen, and Peter Schwabe. New software speed records for cryptographic pairings. In <em>LATINCRYPT 2010</em>, volume 6212 of LNCS, pages 109123. Springer, 2010.</p>

    <p class="text-gray-300">[44] Yasuyuki Nogami, Masataka Akane, Yumi Sakemi, Hidehiro Katou, and Yoshitaka Morikawa. Integer variable chi-based ate pairing. In <em>Pairing-Based Cryptography - Pairing 2008</em>, pages 178191, 2008.</p>

    <p class="text-gray-300">[45] National Institute of Standard and technology. Key management, 2007.</p>

    <p class="text-gray-300">[46] Microsoft Research. Msr ecclib v2.0. 2015.</p>

    <p class="text-gray-300">[47] Franck Rondepierre. Revisiting atomic patterns for scalar multiplications on elliptic curves. In Aurlien Francillon and Pankaj Rohatgi, editors, <em>Smart Card Research and Advanced Applications</em>, volume 8419 of <em>Lecture Notes in Computer Science</em>, pages 171186. Springer International Publishing, 2014.</p>

    <p class="text-gray-300">[48] Oliver Schirokauer. The number field sieve for integers of low weight. <em>Math. Comput.</em>, 79(269):583602, 2010.</p>

    <p class="text-gray-300">[49] Michael Scott and Paulo S. L. M. Barreto. Compressed pairings. In <em>Advances in cryptographyCRYPTO 2004</em>, volume 3152 of <em>Lecture Notes in Comput. Sci.</em>, pages 140156. Springer, Berlin, 2004.</p>

    <p class="text-gray-300">[50] Michael Scott, Naomi Benger, Manuel Charlemagne, Luis J. Dominguez Perez, and Ezekiel J. Kachisa. On the final exponentiation for calculating pairings on ordinary elliptic curves. In <em>Pairings 2009</em>, volume 5671 of LNCS, pages 7888. Springer, 2009.</p>

    <p class="text-gray-300">[51] Jerome A. Solinas. Generalized mersenne numbers. Technical report, 1999.</p>

    <p class="text-gray-300">[52] Martijn Stam and Arjen K. Lenstra. Efficient subgroup exponentiation in quadratic and sixth degree extensions. In <em>Cryptographic Hardware and Embedded Systems - CHES 2002, 4th International Workshop, Redwood Shores, CA, USA, August 1315, 2002, Revised Papers</em>, pages 318332, 2002.</p>

    <p class="text-gray-300">[53] Thomas Unterluggauer and Erich Wenger. Efficient pairings and ecc for embedded systems. In Lejla Batina and Matthew Robshaw, editors, <em>Cryptographic Hardware and Embedded Systems 'CHES 2014</em>, volume 8731 of <em>Lecture Notes in Computer Science</em>, pages 298315. Springer Berlin Heidelberg, 2014.</p>

    <p class="text-gray-300">[54] Frederik Vercauteren. Optimal pairings. <em>IEEE Transactions of Information Theory</em>, 56:455461, 2009.</p>

    <p class="text-gray-300">45</p>

    <p class="text-gray-300">A Appendix</p>

    <p class="text-gray-300">In this appendix, we prove some results on the required conditions for an element to be a square or a cube in <span class="math">\\mathbb{F}_p</span> or <span class="math">\\mathbb{F}_{p^2}</span>, if <span class="math">p</span> is a BN prime.</p>

    <p class="text-gray-300"><strong>Proposition 1.</strong> Let <span class="math">p = 36u^4 + 36u^3 + 24u^2 + 6u + 1</span> be a BN prime, we have</p>

    <p class="text-gray-300">i) <span class="math">-1</span> is a square in <span class="math">\\mathbb{F}_p</span> if and only if <span class="math">u</span> is even.</p>

    <p class="text-gray-300">ii) <span class="math">2</span> is a square in <span class="math">\\mathbb{F}_p</span> if and only if <span class="math">u = 0</span> or <span class="math">1</span> modulo <span class="math">4</span>.</p>

    <p class="text-gray-300">iii) <span class="math">3</span> is a square in <span class="math">\\mathbb{F}_p</span> if and only if <span class="math">u</span> is even.</p>

    <p class="text-gray-300">iv) <span class="math">5</span> is a square in <span class="math">\\mathbb{F}_p</span> if and only if <span class="math">u = 0</span> or <span class="math">4</span> modulo <span class="math">5</span>.</p>

    <p class="text-gray-300"><strong>Proof.</strong></p>

    <p class="text-gray-300">i) Since <span class="math">p = 1 + 2u \\mod 4</span>, this is a direct consequence of the classical result stating that <span class="math">-1</span> is a square in <span class="math">\\mathbb{F}_p</span> if and only if <span class="math">p = 1</span> modulo 4.</p>

    <p class="text-gray-300">ii) It is well known that 2 is a square in <span class="math">\\mathbb{F}_p</span> if and only if <span class="math">p = \\pm 1 \\mod 8</span>. Since <span class="math">p = 1 + 6u \\mod 8</span>, 2 is a square in <span class="math">\\mathbb{F}_p</span> if and only if <span class="math">u = 0</span> or <span class="math">1 \\mod 4</span>.</p>

    <p class="text-gray-300">iii) It is not difficult to prove, using the quadratic reciprocity law, that 3 is a square in <span class="math">\\mathbb{F}_p</span> if and only if <span class="math">p = \\pm 1 \\mod 12</span>. Since <span class="math">p = 1 + 6u \\mod 12</span>, this holds when <span class="math">u</span> is even.</p>

    <p class="text-gray-300">iv) Again, 5 is a square if and only if <span class="math">p = \\pm 1 \\mod 5</span> and it is easy to check that this only holds when <span class="math">u = 0</span> or <span class="math">4 \\mod 5</span>.</p>

    <p class="text-gray-300"><span class="math">\\square</span></p>

    <p class="text-gray-300"><strong>Proposition 2.</strong> Let <span class="math">p = 36u^4 + 36u^3 + 24u^2 + 6u + 1</span> be a BN prime, we have</p>

    <ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">

      <li><span class="math">2</span> is a cube in <span class="math">\\mathbb{F}_p</span> if and only if <span class="math">u = 0 \\mod 3</span>.</li>

    </ol>

    <ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">

      <li><span class="math">3</span> is a cube in <span class="math">\\mathbb{F}_p</span> if and only if <span class="math">u = 0, 1</span> or <span class="math">5</span> modulo <span class="math">9</span>.</li>

    </ol>

    <ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">

      <li><span class="math">5</span> is a cube in <span class="math">\\mathbb{F}_p</span> if and only if <span class="math">u = 0, 2, 4, 6</span> or <span class="math">8</span> modulo <span class="math">15</span>.</li>

    </ol>

    <p class="text-gray-300"><strong>Proof.</strong></p>

    <p class="text-gray-300">This result is based on two old statements. The first one is a theorem of Fermat stating that every prime <span class="math">p = 1 \\mod 3</span> can be written in the form <span class="math">a^2 + 3b^2</span> and that this representation is unique (up to signs). The second one is known as Euler's conjectures and is proven by Cox in [19]. In the cases interesting us, it states that if <span class="math">p = a^2 + 3b^2</span> as above, we have</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">- <span class="math">2</span> is a cube in <span class="math">\\mathbb{F}_p</span> if and only if $3</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">b$.</th>

          </tr>

        </thead>

        <tbody>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">- <span class="math">5</span> is a cube in <span class="math">\\mathbb{F}_p</span> if and only if $15</td>

            <td class="px-3 py-2 border-b border-gray-700">b<span class="math"> or </span>3</td>

            <td class="px-3 py-2 border-b border-gray-700">b, 5</td>

            <td class="px-3 py-2 border-b border-gray-700">a<span class="math"> or </span>15</td>

            <td class="px-3 py-2 border-b border-gray-700">a \\pm b<span class="math"> or </span>15</td>

            <td class="px-3 py-2 border-b border-gray-700">2a \\pm b$.</td>

          </tr>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">46</p>

    <p class="text-gray-300">BN primes are congruent to 1 modulo 3 and the Fermat representation can be explicitly given by</p>

    <div class="my-4 text-center"><span class="math-block">p = 36u^4 + 36u^3 + 24u^2 + 6u + 1 = \\left(6u^2 + 3u + 1\\right)^2 + 3u^2.</span></div>

    <p class="text-gray-300">So we have <span class="math">b = u</span> and <span class="math">a = 6u^2 + 3u + 1</span> and it is not difficult to find for which values of <span class="math">u</span> the conditions of Euler's conjectures are satisfied.</p>

    <p class="text-gray-300"><strong>Proposition 3.</strong> Let <span class="math">p</span> be an odd prime number which is equal to 1 modulo 3. Then an element is a square (resp. a cube) in <span class="math">\\mathbb{F}_{p^2}</span> if and only if its norm is a square (resp. a cube) in <span class="math">\\mathbb{F}_p</span>.</p>

    <p class="text-gray-300"><strong>Proof.</strong></p>

    <p class="text-gray-300">This is not a difficult proof and it can be done by an undergraduate student. It is for example trivial that, if an element is a square (resp. a cube) then its norm is a square (resp. a cube). Let us now reciprocally assume that <span class="math">a \\in \\mathbb{F}_{p^2}</span> and <span class="math">N_{\\mathbb{F}_{p^2} / \\mathbb{F}_p} = b^2</span> for some <span class="math">b</span> in <span class="math">\\mathbb{F}_p</span>. To prove that <span class="math">a</span> is a square, we first need to determine the number of squares in <span class="math">\\mathbb{F}_{p^2}</span>. For this, we study the linear map</p>

    <div class="my-4 text-center"><span class="math-block">\\psi : \\mathbb{F}_{p^2}^* \\quad \\rightarrow \\quad \\mathbb{F}_{p^2}^*</span></div>

    <div class="my-4 text-center"><span class="math-block">x \\quad \\mapsto \\quad x^2.</span></div>

    <p class="text-gray-300">The kernel of <span class="math">\\psi</span> is of course <span class="math">\\{\\pm 1\\}</span> so that its image has cardinality <span class="math">\\frac{p^2 - 1}{2}</span>. This means that there are exactly <span class="math">\\frac{p^2 - 1}{2}</span> squares in <span class="math">\\mathbb{F}_{p^2}^*</span>. Let us now prove that <span class="math">a</span> is one of them. Since the conjugate of <span class="math">a</span> is nothing but <span class="math">a^p</span>, the norm of <span class="math">a</span> is <span class="math">a^{p + 1}</span>. So we have <span class="math">a^{p + 1} = b^2</span> and we can raise this equality to the power of <span class="math">\\frac{p - 1}{2}</span> because <span class="math">p</span> is odd so we get</p>

    <div class="my-4 text-center"><span class="math-block">a^{\\frac{p^2 - 1}{2}} = b^{p - 1} = 1.</span></div>

    <p class="text-gray-300">This means that <span class="math">a</span> is in the kernel of the linear map</p>

    <div class="my-4 text-center"><span class="math-block">\\varphi : \\mathbb{F}_{p^2}^* \\quad \\rightarrow \\quad \\mathbb{F}_{p^2}^*</span></div>

    <div class="my-4 text-center"><span class="math-block">x \\quad \\mapsto \\quad x^{\\frac{p^2 - 1}{2}}.</span></div>

    <p class="text-gray-300">The kernel of this map is the set of all roots of the polynomial <span class="math">X^{\\frac{p^2 - 1}{2}} - 1</span> and there are at most <span class="math">\\frac{p^2 - 1}{2}</span> such roots since <span class="math">\\mathbb{F}_{p^2}</span> is a field. On the other hand, because of Lagrange theorem, all the squares of <span class="math">\\mathbb{F}_{p^2}^<em></span> are in <span class="math">\\ker \\varphi</span> and we saw that there are <span class="math">\\frac{p^2 - 1}{2}</span> of them. This means <span class="math">\\ker \\varphi</span> is exactly the set of squares in <span class="math">\\mathbb{F}_{p^2}^</em></span> so that <span class="math">a</span> is a square.</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">The proof is essentially the same for cubes where the kernel of <span class="math">\\psi</span> is made of third roots of unity which are all lying in <span class="math">\\mathbb{F}_{p^2}</span> since $3</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">p^2 - 1<span class="math">. The condition </span>p = 1 \\mod 3<span class="math"> is necessary to raise </span>a<span class="math"> to the </span>\\frac{p - 1}{3}$.</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300"><strong>Corollary 1.</strong> Let <span class="math">p</span> be an odd prime number and <span class="math">n \\in \\mathbb{F}_p</span>, then <span class="math">n</span> is always a square in <span class="math">\\mathbb{F}_{p^2}</span>.</p>

    <p class="text-gray-300"><strong>Proof.</strong> <span class="math">N_{\\mathbb{F}_{p^2} / \\mathbb{F}_p}(n) = n^2</span> is a square in <span class="math">\\mathbb{F}_p</span> so that <span class="math">n</span> is a square in <span class="math">\\mathbb{F}_{p^2}</span> according to proposition 3.</p>`;
---

<BaseLayout title="Choosing and generating parameters for low level pairing imp... (2015/1212)">
  <article class="max-w-4xl mx-auto article-prose">
    <nav class="mb-8">
      <a href="/papers" class="text-blue-400 hover:text-blue-300">
        &larr; Back to Papers
      </a>
    </nav>

    <header class="mb-12">
      <h1 class="text-3xl font-bold mb-4"
        set:html={TITLE_HTML} />
      <p class="text-gray-400 mb-2"
        set:html={AUTHORS_HTML} />
      <p class="text-gray-500 text-sm mb-4">
        2015 &middot; eprint 2015/1212
      </p>
      <div class="flex gap-4 text-sm">
        <a
          href={EPRINT_URL}
          target="_blank"
          rel="noopener noreferrer"
          class="text-blue-400 hover:text-blue-300"
        >
          Paper (eprint) &rarr;
        </a>
      </div>
      <p class="mt-4 text-xs text-gray-500">
        All content below belongs to the original authors. This page
        reproduces the paper for educational purposes. Always
        <a
          href={EPRINT_URL}
          target="_blank"
          rel="noopener noreferrer"
          class="text-blue-400 hover:text-blue-300"
        >cite the original</a>.
      </p>
      <p class="mt-1 text-xs text-gray-600">
        Converted with: {CRAWLER} &middot; {CONVERTED_DATE}
      </p>
    </header>

    <Fragment set:html={CONTENT} />

  </article>
</BaseLayout>
