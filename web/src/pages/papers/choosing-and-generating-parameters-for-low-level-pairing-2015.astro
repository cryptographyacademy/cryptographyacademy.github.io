---
import BaseLayout from '../../layouts/BaseLayout.astro';
import PaperDisclaimer from '../../components/PaperDisclaimer.astro';
import PaperHistory from '../../components/PaperHistory.astro';

const EPRINT_URL = 'https://eprint.iacr.org/2015/1212';
const CRAWLER = 'marker';
const CONVERTED_DATE = '2026-02-20';
const TITLE_HTML = 'Choosing and generating parameters for low level pairing implementation on BN curves';
const AUTHORS_HTML = 'Sylvain Duquesne, Nadia El Mrabet, Safia Haloui, Franck Rondepierre';

const CONTENT = `    <section id="abstract" class="mb-10">
      <h2 class="text-2xl font-bold">Abstract</h2>
      <p class="text-gray-300">Many hardware and software pairing implementations can be found in the literature and some pairing friendly parameters are given. However, depending on the situation, it could be useful to generate other nice parameters (e.g. resistance to subgroup attacks, larger security levels, database of pairing friendly curves). The main purpose of this paper is to describe explicitly and exhaustively what should be done to generate the best possible parameters and to make the best choices depending on the implementation context (in terms of pairing algorithm, ways to build the tower field, $\\mathbb{F}_{p^{12}}$ arithmetic, groups involved and their generators, system of coordinates).

We focus on low level implementations, assuming that $\\mathbb{F}_p$ additions have a significant cost compared to other $\\mathbb{F}_p$ operations. However, the results obtained are still valid in the case where $\\mathbb{F}_p$ additions can be neglected. We also explain why the best choice for the polynomials defining the tower field $\\mathbb{F}_{p^{12}}$ is only depending on the value of the BN parameter $u$ modulo small integers like $12$ as a nice application of old elementary arithmetic results. Moreover, we use this opportunity to give some new improvements on $\\mathbb{F}_{p^{12}}$ arithmetic (in a pairing context) in terms of $\\mathbb{F}_p$-addition allowing to save around $10\\%$ of them depending on the context.</p>
      <p class="text-gray-300"><strong>Keywords:</strong> pairing</p>
    </section>

    <section id="sec-1" class="mb-10">
      <h2 class="text-2xl font-bold">1 Introduction</h2>

    <p class="text-gray-300">Pairing based cryptography has now many practical applications such as short signature schemes [12], identity based cryptography [10] or broadcast encryption [11]. Because of recent attacks on the discrete logarithm problem in small characteristic finite fields [30, 4], it is now clear that prime base fields should be used to define pairing friendly elliptic curves. Many implementations, both hardware and software can be found in the literature and some pairing friendly parameters are given. For example, at the 128-bit security level, the parameters given in [44] are almost always used because they have many good properties, in particular in terms of efficiency. However, depending on the situation, it could be useful to generate other nice parameters (e.g. resistance to subgroup attacks [38, 5], larger (or smaller) security levels, database of pairing friendly curves).</p>

    <p class="text-gray-300">This paper deals only with the case of BN curves because they are undoubtedly the best choice at the 128-bit security level, which is the most used today and in the near future, but also because they have many nice properties (e.g. maximal degree twists) that make them interesting even for higher security levels.</p>

    <p class="text-gray-300">The main purpose of this paper is to describe explicitly and exhaustively what should be done to generate the best possible parameters and to make the best choices depending on the implementation context. We focus on low level implementation (mainly hardware but also assembly language), assuming that  <span class="math">\\mathbb{F}_p</span>  additions have a significant cost compared to other  <span class="math">\\mathbb{F}_p</span>  operations, whereas they are usually neglected in the literature. However, the results obtained are still valid in the case where  <span class="math">\\mathbb{F}_p</span>  additions can be neglected. Most of the content of this paper already lies in the literature or in existing implementations but, even if it is not our initial purpose, we also give some new ideas to minimize the number of  <span class="math">\\mathbb{F}_p</span>  additions during the pairing computation. We also explain why the best choice for the polynomials defining the tower field  <span class="math">\\mathbb{F}_{p^{12}}</span>  is only depending on the value of the BN parameter u modulo small integers like 12.</p>

    <p class="text-gray-300">The paper is organized as follows. In Section 2 we recall how the optimal Ate pairing on BN curves is computed. In Section 3 we present the different options to build  <span class="math">\\mathbb{F}_{p^{12}}</span>  and how to implement the basic operations. This includes the choice of the defining polynomials in terms of u, the choice of the tower structure and the choice of the algorithms for basic arithmetic, depending on the relative cost of  <span class="math">\\mathbb{F}_p</span>  operations. In Section 4 we explain how to choose the BN parameter u. Sections 5 and 6 are devoted to the choices inherent to the curve (coefficients, generators, system of coordinates). Finally, in Section 7 we recall the other algorithms that must be used for efficient implementation and adapt them to our context and to the results obtained in the previous sections.</p>

    <p class="text-gray-300">The following notations for  <span class="math">\\mathbb{F}_{p^i}</span>  arithmetic will be used:</p>

    <ul class="list-disc list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li><span class="math">\\mathbf{A}_i</span>  denotes an addition and  <span class="math">\\mathbf{A&#x27;}_i</span>  denotes a multiplication by 2,</li>
      <li><span class="math">\\mathbf{M}_i</span>  denotes a multiplication ( <span class="math">\\mathbf{M}_i^M</span>  if the method M is used),</li>
      <li><span class="math">\\mathbf{sM}_i</span>  denotes a sparse multiplication,</li>
      <li><span class="math">\\mathbf{m}_{i,c}</span>  denotes a multiplication by a constant c,</li>
      <li><span class="math">\\mathbf{S}_i</span>  denotes a squaring ( <span class="math">\\mathbf{S}_i^M</span>  if the method M is used),</li>
      <li><span class="math">I_i</span>  denotes an inversion.</li>
    </ul>

      <h3 id="sec-2.1" class="text-xl font-semibold mt-8">2.1 BN curves</h3>

    <p class="text-gray-300">A Barreto-Naehrig (BN) curve [8] is an elliptic curve E over a finite field  <span class="math">\\mathbb{F}_p</span> ,  <span class="math">p \\geq 5</span> , with order  <span class="math">r = \\#E(\\mathbb{F}_p)</span> , such that p and r are prime numbers given by</p>

    <p class="text-gray-300"><span class="math">$p = 36u^4 + 36u^3 + 24u^2 + 6u + 1,</span>$</p>

    <p class="text-gray-300"><span class="math">$r = 36u^4 + 36u^3 + 18u^2 + 6u + 1,</span>$</p>

    <p class="text-gray-300">for some u in  <span class="math">\\mathbb{Z}</span> . It has an equation of the form</p>

    <p class="text-gray-300"><span class="math">$y^2 = x^3 + b,</span>$</p>

    <p class="text-gray-300">where  <span class="math">b \\in \\mathbb{F}_p^*</span> . Its neutral element is denoted by  <span class="math">O_E</span> .</p>

    <p class="text-gray-300">BN curves have been designed to have an embedding degree equal to 12. This makes them particularly appropriate for the 128-bit security level. Indeed, a prime p of size 256 bits leads to a BN curve whose group order is roughly 256 bits together with pairings taking values in  <span class="math">\\mathbb{F}_{p^{12}}^*</span> , which is a 3072-bit multiplicative group. According to the NIST recommendations [45], both groups involved are matching the 128-bit security level. By the way, BN curves at this security level have been the object of numerous recent publications ([21, 2, 14, 24, 43, 27, 53]).</p>

    <p class="text-gray-300">Finally, BN curves always have degree 6 twists. If  <span class="math">\\xi</span>  is an element which is neither a square nor a cube in  <span class="math">\\mathbb{F}_{p^2}</span> , the twisted curve E' of E is defined over  <span class="math">\\mathbb{F}_{p^2}</span>  by the equation</p>

    <p class="text-gray-300"><span class="math">$E&#x27;: y^2 = x^3 + b&#x27;.</span>$</p>

    <p class="text-gray-300">with  <span class="math">b&#x27; = b/\\xi</span>  or  <span class="math">b&#x27; = b\\xi</span> . In order to simplify the computations, the element  <span class="math">\\xi</span>  should also be used to represent  <span class="math">\\mathbb{F}_{p^{12}}</span>  as a degree 6 extension of  <span class="math">\\mathbb{F}_{p^2}</span>  ( <span class="math">\\mathbb{F}_{p^{12}} = \\mathbb{F}_{p^2}[\\gamma]</span>  with  <span class="math">\\gamma^6 = \\xi</span> ) [21], [37]. In this paper, we deal only with the case  <span class="math">b&#x27; = b/\\xi</span>  as usually done in the literature but  <span class="math">b&#x27; = b/\\xi^5</span>  can be also used with a very small additional cost [27].</p>

      <h3 id="sec-2.2" class="text-xl font-semibold mt-8">2.2 Optimal Ate pairing</h3>

    <p class="text-gray-300">Let a be an integer and  <span class="math">Q \\neq O_E</span>  be a point on E. We denote by  <span class="math">f_{a,Q}</span>  the normalized function on the curve with divisor</p>

    <p class="text-gray-300"><span class="math">$\\operatorname{div}(f_{a,Q}) = a[Q] - [aQ] - (a-1)[O_E].</span>$</p>

    <p class="text-gray-300">Such functions are the core of all known pairings. They are computed thanks to the Miller loop (described in Section 2.3), which is an adaptation of the classical scalar multiplication algorithm. For example, the (reduced) Tate pairing is defined by</p>

    <p class="text-gray-300"><span class="math">$e_T(P,Q) = f_{r,P}(Q)^{\\frac{p^{12}-1}{r}}.</span>$</p>

    <p class="text-gray-300">There are many variants of the Tate pairing allowing to use a smaller value of a in order to shorten the length of the Miller loop ([6, 29, 28, 39, 36, 54]). It has been proven in [54] that the shortest possible loop has length  <span class="math">r/\\varphi(12) = r/4</span>  and that this length is reached by the so-called optimal Ate pairing.</p>

    <p class="text-gray-300">Let  <span class="math">\\pi(x,y) = (x^p, y^p)</span>  be the Frobenius map on the curve. If P is a rational point on E and Q is a point in  <span class="math">E\\left(\\mathbb{F}_{p^{12}}\\right)</span>  which is in the p-eigenspace of  <span class="math">\\pi</span> , the optimal Ate pairing [43] can be defined by</p>

    <p class="text-gray-300"><span class="math">$a_{opt}(Q,P) = \\left(f_{v,Q}(P).\\ell_{vQ,\\pi(Q)}(P).\\ell_{vQ+\\pi(Q),-\\pi^2(Q)}(P)\\right)^{\\frac{p^{12}-1}{r}},</span>$</p>

    <p class="text-gray-300">where v = 6u + 2 and  <span class="math">\\ell_{A,B}</span>  is the normalized line function arising in the sum of the points A and B.</p>

    <p class="text-gray-300">In this study, we are only considering this pairing because it makes no doubt that it is currently the most efficient for BN curves, but the same work can be easily done with other pairings. The computation of the optimal Ate pairing is done in four steps:</p>

    <ul class="list-disc list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li><ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li>A Miller loop to compute  <span class="math">f_{|v|,Q}(P)</span> . The algorithmic choices for this step are discussed in Section 2.3.</li>
    </ol></li>
      <li><ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li>If v &lt; 0, the result f of the Miller loop must be inverted to recover  <span class="math">f_{v,Q}(P)</span> . Such an inversion is potentially expensive but thanks to the final exponentiation,  <span class="math">f^{-1}</span>  can be replaced by  <span class="math">f^{p^6}</span>  [2] which is nothing but the conjugation in  <span class="math">\\mathbb{F}_{p^{12}}/\\mathbb{F}_{p^6}</span> , thus it is for free.</li>
    </ol></li>
      <li><ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li>Two line computations,  <span class="math">\\ell_{vQ,\\pi(Q)}(P)</span>  and  <span class="math">\\ell_{vQ+\\pi(Q),-\\pi^2(Q)}(P)</span>  which are nothing but extra addition steps of the Miller loop.</li>
    </ol></li>
      <li><ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li>A final exponentiation to the power of  <span class="math">\\frac{p^{12}-1}{r}</span> . The algorithmic choices for this step are discussed in Section 2.4.</li>
    </ol></li>
    </ul>

    <p class="text-gray-300">Since BN curves have twists of order 6, a twisted version of the optimal Ate pairing allows to take Q in  <span class="math">E&#x27;\\left(\\mathbb{F}_{p^2}\\right)</span> . Using the isomorphism between the curve and its twist, the point Q in our definition of the optimal Ate pairing can then be chosen of the form  <span class="math">\\left(x_Q\\gamma^2,y_Q\\gamma^3\\right)\\in E\\left(\\mathbb{F}_{p^{12}}\\right)</span> , where  <span class="math">x_Q,y_Q\\in\\mathbb{F}_{p^2}\\left((x_Q,y_Q)\\in E&#x27;\\left(\\mathbb{F}_{p^2}\\right)\\right)</span> . This means that elliptic curve operations lie in  <span class="math">\\mathbb{F}_{p^2}</span>  instead of  <span class="math">\\mathbb{F}_{p^{12}}</span>  (but the result remains in  <span class="math">\\mathbb{F}_{p^{12}}</span> ). Of course, this makes computations easier, but this also allows denominator elimination as in [7] because all the factors lying in a proper subfield of  <span class="math">\\mathbb{F}_{p^{12}}</span>  (as  <span class="math">\\mathbb{F}_{p^2}</span> ) are wiped out by the final exponentiation.</p>

      <h3 id="sec-2.3" class="text-xl font-semibold mt-8">2.3 The Miller loop</h3>

    <p class="text-gray-300">The first step of the pairing computation evaluates  <span class="math">f_{|v|,Q}(P)</span>  thanks to the Miller algorithm presented in Algorithm 1 and introduced in [40]. It is based on the double and add scheme used for the computation of |v|Q by evaluating at P the</p>

    <p class="text-gray-300">lines occurring in the doubling and addition steps of this computation. More precisely, it is based on Miller's formula given in the following Lemma, which can be proven by considering divisors.</p>

    <p class="text-gray-300"><strong>Lemma 1.</strong> For all  <span class="math">a, b \\in \\mathbb{Z}</span> , Q a point of E, we have</p>

    <p class="text-gray-300"><span class="math">$f_{a+b,Q} = f_{a,Q} f_{b,Q} \\frac{\\ell_{aQ,bQ}}{v_{(a+b)Q}}</span>$</p>

    <p class="text-gray-300">where  <span class="math">\\ell_{aQ,bQ}</span>  is the equation of the line passing through the points aQ and bQ and  <span class="math">v_{(a+b)Q}</span>  is the equation of the vertical line passing through the point (a+b)Q.</p>

    <p class="text-gray-300"><strong>Remark 1.</strong> In the case of the optimal Ate pairing, the point Q comes from the twisted curve. Hence its x-coordinate lies in a proper subfield of  <span class="math">\\mathbb{F}_{p^{12}}</span>  and  <span class="math">p \\in E(\\mathbb{F}_p)</span>  so that  <span class="math">v_{(a+b)Q}(P)</span>  also lies in a proper subfield of  <span class="math">\\mathbb{F}_{p^{12}}</span>  and then is wiped out by the final exponentiation. This is known as the denominator elimination optimisation [33]. Then we do not take  <span class="math">v_{(a+b)Q}</span>  into consideration in the following.</p>

    <p class="text-gray-300">Miller's algorithm makes use of Lemma 1 with b=a (for doubling steps) or b=1 (for addition steps) and is described by the pseudocode in Algorithm 1 assuming Remark 1.</p>

    <h2 id="sec-misc-1" class="text-2xl font-bold">Algorithm 1: Miller(P, Q, a)</h2>

    <pre><code class="language-text">Data: a=(a_n\\dots a_0)_2, P\\in E\\left(\\mathbb{F}_p\\right), Q\\in E\\left(\\mathbb{F}_{p^{12}}\\right) having its x-coordinate in a proper subfield of \\mathbb{F}_{p^{12}}; Result: \\lambda f_{a,Q}(P)\\in \\mathbb{F}_{p^{12}}^* with \\lambda in a proper subfield of \\mathbb{F}_{p^{12}}; T\\leftarrow Q; f\\leftarrow 1; for i=n-1 to 0 do  \\left|\\begin{array}{cc} f\\leftarrow f^2\\times \\ell_{T,T}(P);\\\\ T\\leftarrow 2T;\\\\ \\text{if }a_i=1\\text{ then}\\\\ \\left|\\begin{array}{cc} f\\leftarrow f\\times \\ell_{T,Q}(P);\\\\ T\\leftarrow T+Q;\\\\ \\end{array}\\right| end end return f
</code></pre>

    <p class="text-gray-300">Several choices are possible for the system of coordinates in order to perform the operations over the elliptic curve during the Miller loop. We discuss them in Section 6.</p>

    <p class="text-gray-300">Since the Miller algorithm is based on the double and add algorithm, it is natural to try to improve it by using advanced exponentiation techniques like the sliding window method [17, Algo 9.10] or the NAF representation [17, Algo 9.14]. However, the interest is limited in practice for two reasons:</p>

    <ul class="list-disc list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li>In the context of pairing based cryptography, the exponent is not a secret. Then it is usually chosen sparse so these advanced exponentiation methods are useless.</li>
      <li>Such methods involve operations like  <span class="math">T \\leftarrow T + 3Q</span> . We need to compute  <span class="math">f \\leftarrow f \\times f_{3,Q} \\times \\ell_{T,3Q}</span>  to obtain the corresponding function. Of course,  <span class="math">f_{3,Q}</span>  can be precomputed but such a step requires an additional  <span class="math">\\mathbb{F}_{p^{12}}</span>  multiplication which is the most consuming operation in Algorithm 1.</li>
    </ul>

    <p class="text-gray-300">The only interesting case is a signed binary representation of the exponent (i.e. a 2-NAF) because it can help to find a sparse exponent. In this case, the substraction step of Algorithm 1 is involving an additional division by the vertical line passing trough Q and -Q which could be expensive, but fortunately it is wiped out by the final exponentiation if Q comes from the twisted curve.</p>

      <h3 id="sec-2.4" class="text-xl font-semibold mt-8">2.4 The final exponentiation</h3>

    <p class="text-gray-300">As proposed in [33, 50] the cost of the final exponentiation can be reduced thanks to the integer factorization</p>

    <p class="text-gray-300"><span class="math">$\\frac{p^{12}-1}{r} = (p^6-1)(p^2+1)\\left(\\frac{p^4-p^2+1}{r}\\right).</span>$</p>

    <p class="text-gray-300">Since p is the characteristic of  <span class="math">\\mathbb{F}_{p^{12}}</span> , it is easy to compute the  <span class="math">p^{\\text{th}}</span> -power of any element in  <span class="math">\\mathbb{F}_{p^{12}}</span> . More details about these Frobenius computations can be found in Section 7.1. Powering to the  <span class="math">(p^6-1)(p^2+1)</span>  is then called the easy part of the final exponentiation, even if an expensive inversion in  <span class="math">\\mathbb{F}_{p^{12}}</span>  is required.</p>

    <p class="text-gray-300">Powering to the  <span class="math">\\frac{p^4-p^2+1}{r}</span>  is called the hard part of the final exponentiation. For this computation, the exponent is usually developed in base p in order to use again cheap Frobenius computations ([49, 21, 50, 13, 23]), and the cost is around three times the cost of an exponentiation by u.</p>

    <p class="text-gray-300">Moreover, as f has been raised to the power of  <span class="math">(p^6-1)(p^2+1)</span> , it has order dividing  <span class="math">p^4-p^2+1</span> . Then, as noticed in [26], it lies in the cyclotomic group  <span class="math">G_{\\Phi_6}(\\mathbb{F}_{p^2})</span> . This has two important consequences for the efficiency of the computation:</p>

    <ul class="list-disc list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li>Squaring is less expensive than a classical squaring in  <span class="math">\\mathbb{F}_{p^{12}}</span>  [26, 31] (more details are given in Section 7.2),</li>
      <li>Inversion is the same operation as raising to the power  <span class="math">p^6</span> , which is nothing but the conjugation in  <span class="math">\\mathbb{F}_{p^{12}}/\\mathbb{F}_{p^6}</span> , thus it is for free [49, 52].</li>
    </ul>

    <p class="text-gray-300">The most popular way to perform this hard part uses the following addition chain [50]:</p>

    <p class="text-gray-300"><span class="math">$f^{\\frac{p^4-p^2+1}{r}} = y_0 y_1^2 y_2^6 y_3^{12} y_4^{18} y_5^{30} y_6^{36},</span>$</p>

    <p class="text-gray-300">where
<span class="math">$y_0 = f^p f^{p^2} f^{p^3}, \\quad y_1 = \\frac{1}{f}, \\quad y_2 = \\left(f^{u^2}\\right)^{p^2}, \\quad y_3 = \\left(f^u\\right)^p,</span>$</p>

    <p class="text-gray-300"><span class="math">$y_4 = \\frac{\\left(f^{u^2}\\right)^p}{f^u}, \\quad y_5 = \\frac{1}{f^{u^2}}, \\quad y_6 = \\frac{\\left(f^{u^3}\\right)^p}{f^{u^3}}.</span>$</p>

    <p class="text-gray-300">The cost of this method is  <span class="math">13\\mathbf{M}_{12}</span> ,  <span class="math">4\\mathbf{S}_{12}</span>  and 7 Frobenius maps in addition to the cost of 3 exponentiations by u. The method given in [13] is slightly more efficient but computes a power of the optimal Ate pairing. The main drawback of these methods is that they are memory consuming (up to  <span class="math">4\\mathbf{Ko}</span> ), which can be annoying in restricted environments. Some variants of these methods optimized in terms of memory consumption are given in [23].</p>

      <h3 id="sec-3.1" class="text-xl font-semibold mt-8">3.1 <span class="math">\\mathbb{F}_p</span> arithmetic</h3>

    <p class="text-gray-300">In this paper, we assume that the basic operations in  <span class="math">\\mathbb{F}_p</span>  (additions, subtractions, multiplications) are already implemented. This multiple precision arithmetic is usually performed by combining the schoolbook method or the Karatsuba method [32] and the Montgomery reduction [42] or the Barrett reduction [9].</p>

    <p class="text-gray-300">In the case where p is taken to be a generalized Mersene prime [51, 15], the field operations can be sped-up by exploiting the particular shape of p. However, no general method to produce ordinary pairing-friendly elliptic curves with such p is known, and moreover, using low weight primes could introduce weakness in pairing based cryptosystems [48].</p>

    <p class="text-gray-300">As an alternative, several authors (e.g. [22], [14]) proposed to use the Residue Number Systems (RNS) for pairing computation (an integer a modulo p is represented by  <span class="math">(a_1, \\ldots, a_n)</span> , where  <span class="math">a_i = a \\mod m_i</span> , for some well-chosen coprime integers  <span class="math">m_1, \\ldots, m_n</span> ). The RNS allows a rather low cost for additions and multiplications, but on the other hand, the reduction step is expensive, so it is recommended to accumulate several operations before performing a reduction (this is called lazy reduction), which requires some extra memory.</p>

    <p class="text-gray-300">Anyway, the method used for  <span class="math">\\mathbb{F}_p</span>  arithmetic does not have direct consequences on the choices to be made for extension field or elliptic curve arithmetic. The only important criterion is the relative cost between the  <span class="math">\\mathbb{F}_p</span>  operations  <span class="math">(\\mathbf{A}_1, \\mathbf{A}&#x27;_1, \\mathbf{M}_1, \\mathbf{S}_1, \\mathbf{I}_1)</span> . One of the main purpose of this paper is to discuss the available choices depending on these ratios. We plan to cover most of the possible practical situations, so that we make the following assumptions:</p>

    <p class="text-gray-300">&bull; Addition can be relatively expensive  <span class="math">(\\mathbf{A}_1 &lt; 0.5\\mathbf{M}_1)</span> . They are often neglected in theoretical studies but this should not be the case for real life implementations, especially in low level implementation where the most</p>

    <p class="text-gray-300">common ratios at the 128-bit security level are between 0.2 and 0.3 [47, 25], but also in software implementation (for example, the ratio is 0.17 in the Microsoft ECC library [46] at the 128-bit security level). Therefore, the number of  <span class="math">\\mathbb{F}_p</span>  additions involved in extension field arithmetic must be taken into account and may have an influence on the choices to be made.</p>

    <ul class="list-disc list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li>In order to stay in the most general case, we chose to use distinct symbols to denote an addition  <span class="math">(\\mathbf{A}_1)</span>  and a doubling  <span class="math">(\\mathbf{A}&#x27;_1)</span> . However, notice that we usually have  <span class="math">\\mathbf{A}&#x27;_1 = \\mathbf{A}_1</span> .</li>
      <li>If a specific algorithm for squaring is implemented, then  <span class="math">S_1</span>  is usually assumed to be  <span class="math">0.8M_1</span> , else, a square is computed by doing a multiplication and  <span class="math">S_1 = M_1</span> .</li>
    </ul>

      <h3 id="sec-3.2" class="text-xl font-semibold mt-8">3.2 Arithmetic of <span class="math">\\mathbb{F}_{p^{2i}}/\\mathbb{F}_{p^i}</span></h3>

    <p class="text-gray-300">In theory, any irreducible quadratic polynomial can be used to build  <span class="math">\\mathbb{F}_{p^{2i}}</span>  over  <span class="math">\\mathbb{F}_{p^i}</span> , but non-zero coefficients of this polynomial imply extra operations for  <span class="math">\\mathbb{F}_{p^{2i}}</span>  arithmetic. Therefore,  <span class="math">\\mathbb{F}_{p^{2i}}</span>  is usually built with a polynomial of the form  <span class="math">X^2 - \\mu</span> , where  <span class="math">\\mu</span>  is not a square in  <span class="math">\\mathbb{F}_{p^i}</span> .</p>

    <p class="text-gray-300"><span class="math">$\\mathbb{F}_{p^{2i}} = \\mathbb{F}_{p^i}[\\alpha]</span>$
with  <span class="math">\\alpha^2 = \\mu</span> .</p>

      <h4 id="sec-3.2.1" class="text-lg font-semibold mt-6">3.2.1 <span class="math">\\mathbb{F}_{p^{2i}}</span> addition</h4>

    <p class="text-gray-300">Whatever the choice for building  <span class="math">\\mathbb{F}_{p^{2i}}</span> , an addition (resp. a multiplication by 2) always requires  <span class="math">2 \\mathbb{F}_{p^i}</span>  additions (resp. multiplications by 2). In any case</p>

    <p class="text-gray-300"><span class="math">$\\mathbf{A}_{2i} = 2\\mathbf{A}_i</span>$
and  <span class="math">\\mathbf{A&#x27;}_{2i} = 2\\mathbf{A&#x27;}_i</span> .</p>

      <h4 id="sec-3.2.2" class="text-lg font-semibold mt-6">3.2.2 <span class="math">\\mathbb{F}_{p^{2i}}</span> multiplication</h4>

    <p class="text-gray-300">We will consider only two methods since the other methods do not reduce the overall complexity, independently of the relative cost of  <span class="math">\\mathbb{F}_{p^i}</span>  operations.</p>

    <p class="text-gray-300"><strong>Schoolbook method.</strong> The method computes as follows:</p>

    <p class="text-gray-300"><span class="math">$(x_0 + x_1\\alpha)(y_0 + y_1\\alpha) = x_0y_0 + \\mu x_1y_1 + (x_0y_1 + x_1y_0)\\alpha</span>$</p>

    <p class="text-gray-300">and requires  <span class="math">\\mathbf{M}_{2i}^{sB} = 4\\mathbf{M}_i + \\mathbf{m}_{i,\\mu} + 2\\mathbf{A}_i</span> .</p>

    <p class="text-gray-300"><strong>Karatsuba method.</strong> The method is a standard variant of the schoolbook method. The evaluation is performed as follows:</p>

    <p class="text-gray-300"><span class="math">$(x_0 + x_1\\alpha)(y_0 + y_1\\alpha) = x_0y_0 + \\mu x_1y_1 + ((x_0 + x_1)(y_0 + y_1) - x_0y_0 - x_1y_1)\\alpha</span>$</p>

    <p class="text-gray-300">and requires  <span class="math">\\mathbf{M}_{2i}^K = 3\\mathbf{M}_i + \\mathbf{m}_{i,\\mu} + 5\\mathbf{A}_i</span> .</p>

    <p class="text-gray-300"><strong>Remark 2.</strong> The schoolbook method should be preferred to the Karatsuba method when  <span class="math">3\\mathbf{A}_i &gt; \\mathbf{M}_i</span> .</p>

      <h4 id="sec-3.2.3" class="text-lg font-semibold mt-6">3.2.3 <span class="math">\\mathbb{F}_{p^{2i}}</span> squaring</h4>

    <p class="text-gray-300">In this case, we will additionally consider the complex method.</p>

    <p class="text-gray-300">Schoolbook method. In the squaring case, we get</p>

    <p class="text-gray-300"><span class="math">$(x_0 + x_1\\alpha)^2 = x_0^2 + \\mu x_1^2 + 2x_0x_1\\alpha</span>$</p>

    <p class="text-gray-300">which requires  <span class="math">\\mathbf{S}_{2i}^{ss} = \\mathbf{M}_i + 2\\mathbf{S}_i + \\mathbf{m}_{i,\\mu} + \\mathbf{A}_i + \\mathbf{A}&#x27;_i</span> .</p>

    <p class="text-gray-300">Karatsuba method. In the squaring case, we get</p>

    <p class="text-gray-300"><span class="math">$(x_0 + x_1\\alpha)^2 = x_0^2 + \\mu x_1^2 + ((x_0 + x_1)^2 - x_0^2 - x_1^2)\\alpha</span>$</p>

    <p class="text-gray-300">which requires  <span class="math">\\mathbf{S}_{2i}^{K} = 3\\mathbf{S}_{i} + \\mathbf{m}_{i,\\mu} + 4\\mathbf{A}_{i}</span> .</p>

    <p class="text-gray-300">Complex method. The method is particularly efficient if  <span class="math">\\mu = -1</span> , which explains its name. It computes as follows:</p>

    <p class="text-gray-300"><span class="math">$(x_0 + x_1\\alpha)^2 = (x_0 + \\mu x_1)(x_0 + x_1) - (\\mu + 1)x_0x_1 + 2x_0x_1\\alpha</span>$</p>

    <p class="text-gray-300">and requires  <span class="math">\\mathbf{S}_{2i}^{c} = 2\\mathbf{M}_{i} + \\mathbf{m}_{i,\\mu} + \\mathbf{m}_{i,\\mu+1} + 3\\mathbf{A}_{i} + \\mathbf{A&#x27;}_{i}</span> .</p>

    <p class="text-gray-300">Remark 3. Determining which method is the best is not as easy as for multiplication in the general case because it depends on both the relative cost of  <span class="math">\\mathbf{M}_i</span>  and  <span class="math">\\mathbf{A}_i</span>  and of  <span class="math">\\mathbf{M}_i</span>  and  <span class="math">\\mathbf{S}_i</span> . We postpone this question to Section 3.5 which discusses specific choices of  <span class="math">\\mu</span> .</p>

      <h4 id="sec-3.2.4" class="text-lg font-semibold mt-6">3.2.4 <span class="math">\\mathbb{F}_{p^{2i}}</span> inversion</h4>

    <p class="text-gray-300">The  <span class="math">\\mathbb{F}_{p^{2i}}</span>  inversion is classically done thanks to the norm of an element</p>

    <p class="text-gray-300"><span class="math">$N = (x_0 + x_1 \\alpha) (x_0 - x_1 \\alpha) = x_0^2 - \\mu x_1^2 \\in \\mathbb{F}_p.</span>$</p>

    <p class="text-gray-300">We easily get the inverse of  <span class="math">x_0 + x_1 \\alpha</span>  as  <span class="math">\\frac{x_0}{N} - \\frac{x_1}{N} \\alpha</span> . This way of computing an inverse in  <span class="math">\\mathbb{F}_{p^{2i}}</span>  requires</p>

    <p class="text-gray-300"><span class="math">$\\mathbf{I}_{2i} = \\mathbf{I}_i + 2\\mathbf{M}_i + 2\\mathbf{S}_i + \\mathbf{A}_i + \\mathbf{m}_{i,\\mu}.</span>$</p>

    <p class="text-gray-300">As in Section 3.2, it is preferable to chose a sparse polynomial to minimize the cost of  <span class="math">\\mathbb{F}_{p^{3i}}</span>  arithmetic. Thus,  <span class="math">\\mathbb{F}_{p^{3i}}</span>  is built as  <span class="math">\\mathbb{F}_{p^i}[\\alpha]</span> , where  <span class="math">\\alpha^3 = \\xi</span>  for some  <span class="math">\\xi</span>  in  <span class="math">\\mathbb{F}_{p^i}</span> . Of course,  <span class="math">\\mathbb{F}_{p^{3i}}</span>  arithmetic will involve some multiplications by  <span class="math">\\xi</span> , so that  <span class="math">\\xi</span>  must be chosen carefully.</p>

      <h4 id="sec-3.3.1" class="text-lg font-semibold mt-6">3.3.1 Fp3<sup>i</sup> addition</h4>

    <p class="text-gray-300">Whatever the choice for building Fp3<sup>i</sup> , an addition (resp. a multiplication by 2) always requires 3 Fp<sup>i</sup> additions (resp. multiplications by 2). So in any case</p>

    <p class="text-gray-300"><span class="math">$\\mathbf{A}_{3i} = 3\\mathbf{A}_i</span>$
and  <span class="math">\\mathbf{A&#x27;}_{3i} = 3\\mathbf{A&#x27;}_i</span> .</p>

      <h4 id="sec-3.3.2" class="text-lg font-semibold mt-6">3.3.2 Fp3<sup>i</sup> multiplication</h4>

    <p class="text-gray-300">Again, we give only the schoolbook and the Karatsuba methods because other methods (like Toom-Cook) require too many additions (and divisions by 2 or 3), which is contradictory with our assumptions (additions are not so negligible on real world devices).</p>

    <p class="text-gray-300">Schoolbook method. The method uses the following equality</p>

    <p class="text-gray-300"><span class="math">$(x_0 + x_1\\alpha + x_2\\alpha^2)(y_0 + y_1\\alpha + y_0\\alpha^2) = x_0y_0 + \\xi(x_1y_2 + x_2y_1) + [x_0y_1 + x_1y_0 + \\xi x_2y_2]\\alpha + [x_0y_2 + y_2x_0 + x_1y_1]\\alpha^2</span>$</p>

    <p class="text-gray-300">.</p>

    <p class="text-gray-300">and requires MSB <sup>3</sup><sup>i</sup> = 9M<sup>i</sup> + 2mi,&xi; + 6A<sup>i</sup></p>

    <p class="text-gray-300">Karatsuba method. As in the case of quadratic extensions, the method allows to compute sums of products like x1y2+x2y<sup>1</sup> with only one multiplication, assuming that x1y<sup>1</sup> and x2y<sup>2</sup> are already computed. The equality in the cubic case is</p>

    <p class="text-gray-300"><span class="math">$(x_0 + x_1\\alpha + x_2\\alpha^2)(y_0 + y_1\\alpha + y_2\\alpha^2) = x_0y_0 + \\xi((x_1 + x_2)(y_1 + y_2) - x_1y_1 - x_2y_2) + [(x_0 + x_1)(y_0 + y_1) - x_0y_0 - x_1y_1 + \\xi x_2y_2]\\alpha + [(x_0 + x_2)(y_0 + y_2) - x_0y_0 - x_2y_2 + x_1y_1]\\alpha^2</span>$</p>

    <p class="text-gray-300">This means that 2M<sup>i</sup> + A<sup>i</sup> is replaced by M<sup>i</sup> + 4A<sup>i</sup> three times. As in the case of quadratic extensions, the Karatsuba method then becomes interesting when M<sup>i</sup> &ge; 3A<sup>i</sup> and requires M<sup>K</sup> <sup>3</sup><sup>i</sup> = 6M<sup>i</sup> + 15A<sup>i</sup> + 2mi,&xi;.</p>

    <p class="text-gray-300">We will also use in the following the Karatsuba method when one of the operands is sparse. If two coecients are zero, the Karatsuba method has no interest but it can be used if one coecient, say y2, is zero. In this case, we have</p>

    <p class="text-gray-300"><span class="math">$(x_0 + x_1\\alpha + x_2\\alpha^2)(y_0 + y_1\\alpha) = x_0y_0 + \\xi x_2y_1 + [(x_0 + x_1)(y_0 + y_1) - x_0y_0 - x_1y_1]\\alpha + [x_2y_0 + x_1y_1]\\alpha^2</span>$</p>

    <p class="text-gray-300">which requires sM<sup>K</sup> <sup>3</sup><sup>i</sup> = 5M<sup>i</sup> + 6A<sup>i</sup> + mi,&xi;.</p>

      <h4 id="sec-3.3.3" class="text-lg font-semibold mt-6">3.3.3 Squaring</h4>

    <p class="text-gray-300">The Schoolbook and Karatsuba squarings are deduced from the multiplication.</p>

    <p class="text-gray-300">Schoolbook method. The method uses the equality</p>

    <p class="text-gray-300"><span class="math">$(x_0 + x_1\\alpha + x_2\\alpha^2)^2 = x_0^2 + 2\\xi x_1x_2 + \\left[2x_0x_1 + \\xi x_2^2\\right]\\alpha + \\left[x_1^2 + 2x_0x_2\\right]\\alpha^2.</span>$</p>

    <p class="text-gray-300">Note that if we first compute  <span class="math">2x_1</span> , only 2 multiplications by 2 are necessary to evaluate this formula, so the cost is  <span class="math">\\mathbf{S}_{3i}^{\\mathtt{SB}} = 3\\mathbf{M}_i + 3\\mathbf{S}_i + 3\\mathbf{A}_i + 2\\mathbf{A}&#x27;_i + 2\\mathbf{m}_{i,\\xi}</span> .</p>

    <p class="text-gray-300"><strong>Karatsuba Method.</strong> The method computes the double products involved in the schoolbook squaring using</p>

    <p class="text-gray-300"><span class="math">$2x_0x_1 = (x_0 + x_1)^2 - x_0^2 - x_1^2.</span>$</p>

    <p class="text-gray-300">The complexity becomes  <span class="math">\\mathbf{S}_{3i}^{K} = 6\\mathbf{S}_{i} + 12\\mathbf{A}_{i} + 2\\mathbf{m}_{i,\\xi}</span> .</p>

    <p class="text-gray-300"><strong>Chung-Hasan Method.</strong> We can also use the Chung-Hasan method [16] for squaring in degree 3 extensions. There are several variants but the most interesting in our context is to compute the term in  <span class="math">\\alpha^2</span>  in the schoolbook method using the formula</p>

    <p class="text-gray-300"><span class="math">$x_1^2 + 2x_0x_2 = (x_0 + x_1 + x_2)^2 - (2x_0x_1 + 2x_1x_2 + x_0^2 + x_2^2).</span>$</p>

    <p class="text-gray-300">Computing this term requires  <span class="math">\\mathbf{S}_i + 6\\mathbf{A}_i</span>  instead of  <span class="math">\\mathbf{M}_i + \\mathbf{S}_i + \\mathbf{A}_i + \\mathbf{A&#x27;}_i</span> , so the overall complexity is  <span class="math">\\mathbf{S}_{3i}^{CH} = 2\\mathbf{M}_i + 3\\mathbf{S}_i + 8\\mathbf{A}_i + \\mathbf{A&#x27;}_i + 2\\mathbf{m}_{i,\\xi}</span> .</p>

    <p class="text-gray-300">In this section, we discuss the ways to build the extension tower  <span class="math">\\mathbb{F}_{p^{12}}</span>  for pairings on BN curves. All the ways to build  <span class="math">\\mathbb{F}_{p^{12}}</span>  are mathematically equivalent. However, we will use this extension in the specific case of pairings on BN curves, which implies some constraints in order to allow other improvements for pairing computation.</p>

    <ul class="list-disc list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li>As explained in Section 2.2,  <span class="math">\\mathbb{F}_{p^{12}}</span>  must be built as an extension of  <span class="math">\\mathbb{F}_{p^2}</span>  because of the use of a sextic twist. Indeed, the twisted curve is defined over  <span class="math">\\mathbb{F}_{p^2}</span> .</li>
      <li><span class="math">\\mathbb{F}_{p^{12}}</span>  must be built over  <span class="math">\\mathbb{F}_{p^2}</span>  with a polynomial  <span class="math">X^6 \\xi</span>  where  <span class="math">\\xi</span> , which is neither a square nor a cube, is the element used to define the twisted curve. This allows the line involved in the Miller algorithm to be a sparse element of  <span class="math">\\mathbb{F}_{p^{12}}</span>  (see Section 6 for more details).</li>
    </ul>

    <p class="text-gray-300">Then,  <span class="math">\\mathbb{F}_{p^{12}}</span>  should be built</p>

    <p class="text-gray-300">&bull; Case 2, 2, 3: as a cubic extension of a quadratic extension of  <span class="math">\\mathbb{F}_{p^2}</span> ,</p>

    <ul class="list-disc list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li>Case 2, 3, 2: as a quadratic extension of a cubic extension of  <span class="math">\\mathbb{F}_{p^2}</span> ,</li>
      <li>Case 2,6: as a sextic extension of  <span class="math">\\mathbb{F}_{p^2}</span> .</li>
    </ul>

    <p class="text-gray-300">The latter case is proved to be less efficient [20], so we will only consider here the first two ones. In any case, we have</p>

    <p class="text-gray-300"><span class="math">$\\mathbb{F}_{p^{12}} = \\mathbb{F}_{p^2}[\\gamma] \\text{ with } \\gamma^6 = \\xi \\in \\mathbb{F}_{p^2}.</span>$</p>

    <p class="text-gray-300">In the case 2, 2, 3, we will use  <span class="math">\\beta = \\gamma^3</span>  to define  <span class="math">\\mathbb{F}_{p^4}</span>  and in the case 2, 3, 2, we will use  <span class="math">\\beta = \\gamma^2</span>  to define  <span class="math">\\mathbb{F}_{p^6}</span> . These cases are studied in detail in Sections 3.6 and 3.7.</p>

    <p class="text-gray-300">Of course,  <span class="math">\\xi</span>  must be carefully chosen, since  <span class="math">\\mathbb{F}_{p^{12}}</span>  arithmetic will involve multiplications by  <span class="math">\\xi</span>  or  <span class="math">\\beta</span> ; this is the purpose of Section 3.8. But let us first give more details on the choice of  <span class="math">\\mathbb{F}_{p^2}</span>  and its arithmetic.</p>

      <h3 id="sec-3.5" class="text-xl font-semibold mt-8">3.5 Choice of <span class="math">\\mathbb{F}_{p^2}</span> and its arithmetic</h3>

    <p class="text-gray-300">As explained in Section 3.2,  <span class="math">\\mathbb{F}_{p^2}</span>  is built thanks to an element  <span class="math">\\mu</span>  which is not a square in  <span class="math">\\mathbb{F}_p</span>  so that</p>

    <p class="text-gray-300"><span class="math">$\\mathbb{F}_{p^2} = \\mathbb{F}_p[\\alpha]</span>$
with  <span class="math">\\alpha^2 = \\mu</span> .</p>

    <p class="text-gray-300">According to Remark 2, the Karatsuba method for  <span class="math">\\mathbb{F}_{p^2}</span>  multiplication is better when  <span class="math">\\mathbf{A}_1 &lt; \\frac{1}{3}\\mathbf{M}_1</span> .</p>

    <p class="text-gray-300">Determining the best squaring algorithm is less simple. Let us first compare the schoolbook and the Karatsuba method. The difference between the complexities is  <span class="math">\\mathbf{M}_1 - \\mathbf{S}_1 + \\mathbf{A}&#x27;_1 - 3\\mathbf{A}_1</span> . Assuming that  <span class="math">\\mathbf{S}_1 = \\mathbf{M}_1</span> , this difference becomes  <span class="math">\\mathbf{A}&#x27;_1 - 3\\mathbf{A}_1</span>  which is always negative. This means that the schoolbook method is always better. Assuming that  <span class="math">\\mathbf{S}_1 = 0.8\\mathbf{M}_1</span> , the difference becomes  <span class="math">0.2\\mathbf{M}_1 + \\mathbf{A}&#x27;_1 - 3\\mathbf{A}_1</span>  which is negative if  <span class="math">\\mathbf{A}_1 \\geq 0.1\\mathbf{M}_1</span>  (and even less if  <span class="math">\\mathbf{A}&#x27;_1</span>  is assumed to be cheaper than  <span class="math">\\mathbf{A}_1</span> ). Thus the schoolbook method is also better in this case, unless if the addition in  <span class="math">\\mathbb{F}_p</span>  is really very efficient ( <span class="math">\\mathbf{A}_1 &lt; 0.1\\mathbf{M}_1</span> ). We then assume that the Karatsuba method for  <span class="math">\\mathbb{F}_{p^2}</span>  squaring has no (or very few) interest.</p>

    <p class="text-gray-300">Let us now compare the Schoolbook method and the complex method. In this case, the difference between the complexities is  <span class="math">2\\mathbf{S}_1 - \\mathbf{M}_1 - 2\\mathbf{A}_1 - \\mathbf{m}_{1,\\mu+1}</span> . This means that the schoolbook method is generally better if  <span class="math">\\mu</span>  is randomly chosen  <span class="math">(\\mathbf{m}_{1,\\mu+1} = \\mathbf{M}_1)</span> . If  <span class="math">\\mu</span>  is chosen to be a small number, the conclusion is depending on this choice (more precisely on the cost of the multiplication by  <span class="math">\\mu + 1</span> ). The choice of  <span class="math">\\mu</span>  is the object of Section 3.5.1.</p>

      <h4 id="sec-3.5.1" class="text-lg font-semibold mt-6">3.5.1 Choice of <span class="math">\\mu</span> and consequences on u</h4>

    <p class="text-gray-300">We focus on multiplications and squarings in  <span class="math">\\mathbb{F}_{p^2}</span>  because other operations such as inversions or additions are rare or independent of the choice of  <span class="math">\\mu</span> . In order to have the best arithmetic,  <span class="math">\\mu</span>  must be chosen such that  <span class="math">\\mathbf{m}_{1,\\mu}</span>  and  <span class="math">\\mathbf{m}_{1,\\mu+1}</span>  are</p>

    <p class="text-gray-300">as cheap as possible. Since  <span class="math">\\mu</span>  has to be a non-square in  <span class="math">\\mathbb{F}_p</span> , 0 and 1 must be avoided and the best choice is  <span class="math">\\mu = -1</span> . If this choice is not possible,  <span class="math">\\mu = \\pm 2</span>  is also a good choice. Other choices are possible, even if they are of course more expensive. Let us now give more details on which values of  <span class="math">\\mu</span>  should be used to define  <span class="math">\\mathbb{F}_{p^2}</span> , depending on u. Further justifications are given in Appendix A.</p>

    <p class="text-gray-300">The case  <span class="math">\\mathbb{F}_{p^2} = \\mathbb{F}_p[\\mathbf{i}]</span> . If  <span class="math">\\mu = -1</span> , then  <span class="math">\\mathbb{F}_{p^2}</span>  can be seen as an analogue of the complex field and in this case  <span class="math">\\alpha</span>  is usually denoted by  <span class="math">\\mathbf{i}</span> . In this situation,  <span class="math">\\mathbf{m}_{1,\\mu}</span>  and  <span class="math">\\mathbf{m}_{1,\\mu+1}</span>  are both for free, but one can do even better because the complex method for squaring becomes</p>

    <p class="text-gray-300"><span class="math">$(a_0 + a_1 \\mathbf{i})^2 = (a_0 - a_1)(a_0 + a_1) + 2a_0 a_1 \\mathbf{i}</span>$</p>

    <p class="text-gray-300">and requires  <span class="math">2\\mathbf{M}_1 + 2\\mathbf{A}_1 + \\mathbf{A&#x27;}_1</span>  which is faster than schoolbook or Karatsuba method in any case.</p>

    <p class="text-gray-300">Choosing  <span class="math">\\mu = -1</span>  is possible if and only if -1 is not a square in  <span class="math">\\mathbb{F}_p</span> , which is equivalent to take u odd, as proved in Proposition 1 of Appendix A.</p>

    <p class="text-gray-300">The case  <span class="math">\\mathbb{F}_{p^2} = \\mathbb{F}_p\\left[\\sqrt{-2}\\right]</span> . In this case,  <span class="math">\\mathbf{m}_{1,\\mu} = \\mathbf{A}&#x27;_1</span>  and  <span class="math">\\mathbf{m}_{1,\\mu+1} = 0</span> . The complex method for computing a square in  <span class="math">\\mathbb{F}_{p^2}</span>  then requires  <span class="math">2\\mathbf{M}_1 + 3\\mathbf{A}_1 + 2\\mathbf{A}&#x27;_1</span>  whereas the schoolbook method needs  <span class="math">\\mathbf{M}_1 + 2\\mathbf{S}_1 + \\mathbf{A}_1 + 2\\mathbf{A}&#x27;_1</span> . The difference between the complexities is  <span class="math">2\\mathbf{S}_1 - \\mathbf{M}_1 - 2\\mathbf{A}_1</span> . The complex method is then always better if  <span class="math">\\mathbf{S}_1 = \\mathbf{M}_1</span> . If  <span class="math">\\mathbf{S}_1 = 0.8\\mathbf{M}_1</span> , the schoolbook method is better only if  <span class="math">\\mathbf{A}_1 &gt; 0.3\\mathbf{M}_1</span> .</p>

    <p class="text-gray-300">According to Proposition 1 of Appendix A, choosing  <span class="math">\\mu=-2</span>  is possible if and only if u=1 or 2 modulo 4. However, if u=1 modulo 4, choosing  <span class="math">\\mu=-1</span>  is more appropriate in terms of efficiency.</p>

    <p class="text-gray-300">The case  <span class="math">\\mathbb{F}_{p^2} = \\mathbb{F}_p\\left[\\sqrt{-5}\\right]</span> . In this case,  <span class="math">\\mathbf{m}_{1,\\mu} = 2\\mathbf{A}&#x27;_1 + \\mathbf{A}_1</span>  and  <span class="math">\\mathbf{m}_{1,\\mu+1} = 2\\mathbf{A}&#x27;_1</span> . However, the complex method can be rewritten in a more efficient way</p>

    <p class="text-gray-300"><span class="math">$(a_0 + a_1\\alpha)^2 = (a_0 + a_1 + 2a_1&#x27;)(a_0 + a_1) + 2a_0a_1&#x27; + a_0a_1&#x27;\\alpha</span>$
with  <span class="math">a_1&#x27; = 2a_1</span></p>

    <p class="text-gray-300">and then requires  <span class="math">2\\mathbf{M}_1 + 4\\mathbf{A}_1 + 2\\mathbf{A}&#x27;_1</span>  which is almost as good as the case  <span class="math">\\mu = -2</span>  and better than the schoolbook method (except if  <span class="math">\\mathbf{A}&#x27;_1</span>  is very small compared to  <span class="math">\\mathbf{A}_1</span>  and  <span class="math">\\mathbf{S}_1 = 0.8\\mathbf{M}_1</span> ).</p>

    <p class="text-gray-300">If u is odd, it is better to choose  <span class="math">\\mu=-1</span> , and if u=2 modulo 4 it is better to choose  <span class="math">\\mu=\\pm 2</span> , so we assume that u=0 modulo 4. In this case, according to Proposition 1 of Appendix A, 5 and -5 are squares together when u=0 or 4 modulo 5. Therefore,  <span class="math">\\mu=-5</span>  should be chosen when u=8,12 or 16 modulo 20.</p>

    <h4 id="sec-misc-2" class="text-lg font-semibold mt-6">Other choices for building <span class="math">\\mathbb{F}_{p^2}</span></h4>

    <ul class="list-disc list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li>If  <span class="math">\\mu = -1</span>  and  <span class="math">\\mu = -2</span>  cannot be chosen to build  <span class="math">\\mathbb{F}_{p^2}</span> , then 2 cannot be chosen either. Moreover, choosing  <span class="math">\\mu = 2</span>  instead of -2 is less efficient for the complex method since  <span class="math">\\mu + 1 = 3</span>  instead of -1. Therefore, choosing  <span class="math">\\mu = 2</span>  has no interest.</li>
      <li>The same remark holds for  <span class="math">\\mu = 5</span> .</li>
      <li>The case  <span class="math">\\mu = 3</span>  is interesting at first glance because the complexity of the complex method is as good as when  <span class="math">\\mu = -2</span> . However, this choice can be done if and only if u is odd, and in this case, choosing  <span class="math">\\mu = -1</span>  is more appropriate in terms of efficiency.</li>
      <li>Since p=1 modulo 3 for BN primes, -3 is always a square in  <span class="math">\\mathbb{F}_p</span> , so it cannot be chosen to build  <span class="math">\\mathbb{F}_{p^2}</span> .</li>
    </ul>

    <p class="text-gray-300">Finally, the only interesting small values for  <span class="math">\\mu</span>  are -1, -2 and -5 and one of them can be used whenever  <span class="math">u \\neq 0</span>  or 4 modulo 20.</p>

      <h4 id="sec-3.5.2" class="text-lg font-semibold mt-6">3.5.2 Summary of choices and complexities for <span class="math">\\mathbb{F}_{p^2}</span> arithmetic</h4>

    <p class="text-gray-300">We saw that we trivially have  <span class="math">\\mathbf{A}_2 = 2\\mathbf{A}_1</span>  and  <span class="math">\\mathbf{A&#x27;}_2 = 2\\mathbf{A&#x27;}_1</span>  whatever the choice made to build  <span class="math">\\mathbb{F}_{p^2}</span> . The situation is more complicated for  <span class="math">\\mathbf{M}_2</span>  and  <span class="math">\\mathbf{S}_2</span> ; it is summarized in Tables 1 and 2. In these tables SB, K and  <span class="math">\\mathbb{C}</span>  denote the method used.</p>

    <div class="overflow-x-auto my-4">
      <table class="min-w-full text-sm text-gray-300">
        <thead>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"><span class="math">\\mu</span></th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">Assuming <span class="math">\\mathbf{A}_1 \\leq 0.33\\mathbf{M}_1</span></th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">Assuming <span class="math">\\mathbf{A}_1 &gt; 0.33\\mathbf{M}_1</span></th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">Condition</th>
        </thead>
        <tbody>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-1</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">3\\mathbf{M}_1 + 5\\mathbf{A}_1 \\text{ (K)}</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">4\\mathbf{M}_1 + 2\\mathbf{A}_1 \\text{ (SB)}</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">u = 1 \\mod 2</span></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-2</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">3\\mathbf{M}_1 + 5\\mathbf{A}_1 + \\mathbf{A&#x27;}_1 \\text{ (K)}</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">4\\mathbf{M}_1 + 2\\mathbf{A}_1 + \\mathbf{A&#x27;}_1 \\text{ (SB)}</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">u = 2 \\mod 4</span></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-5</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">3\\mathbf{M}_1 + 6\\mathbf{A}_1 + 2\\mathbf{A&#x27;}_1</span> (K)</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">4\\mathbf{M}_1 + 3\\mathbf{A}_1 + 2\\mathbf{A&#x27;}_1 \\text{ (SB)}</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">u = 8, 12, 16 \\mod 20</span></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">any</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">4\\mathbf{M}_1 + 5\\mathbf{A}_1 \\text{ (K)}</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">5\\mathbf{M}_1 + 2\\mathbf{A}_1 \\text{ (SB)}</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">u = 0, 4 \\mod 20</span></td>
          </tr>
        </tbody>
      </table>
    </div>

    <p class="text-gray-300">Table 1: Complexities of  <span class="math">\\mathbf{M}_2</span>  depending on the way to build  <span class="math">\\mathbb{F}_{p^2}</span></p>

    <div class="overflow-x-auto my-4">
      <table class="min-w-full text-sm text-gray-300">
        <thead>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"></th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">Assuming <span class="math">\\mathbf{S}_1 = \\mathbf{M}_1</span> or</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"><span class="math">{\\rm Assuming}</span></th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">Condition</th>
        </thead>
        <tbody>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">\\mu</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">\\mathbf{S}_1 = 0.8\\mathbf{M}_1, \\mathbf{A}_1 \\le 0.3\\mathbf{M}_1</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">\\mathbf{S}_1 = 0.8\\mathbf{M}_1, \\mathbf{A}_1 &gt; 0.3\\mathbf{M}_1</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-1</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">2\\mathbf{M}_1 + 2\\mathbf{A}_1 + \\mathbf{A&#x27;}_1 \\ (\\mathbb{C})</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">u = 1 \\mod 2</span></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-2</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">2\\mathbf{M}_1 + 3\\mathbf{A}_1 + 2\\mathbf{A&#x27;}_1 \\ (\\mathbb{C})</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">\\mathbf{M}_1 + 2\\mathbf{S}_1 + \\mathbf{A}_1 + 2\\mathbf{A&#x27;}_1 \\text{ (SB)}</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">u = 2 \\mod 4</span></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-5</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">2\\mathbf{M}_1 + 4\\mathbf{A}_1 + 2\\mathbf{A&#x27;}_1 \\ (\\mathbb{C})</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">u = 8, 12, 16 \\mod 20</span></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">any</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">2\\mathbf{M}_1 + 2\\mathbf{S}_1 +</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">u = 0, 4 \\mod 20</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
        </tbody>
      </table>
    </div>

    <p class="text-gray-300">Table 2: Complexities of  <span class="math">S_2</span>  depending on the way to build  <span class="math">\\mathbb{F}_{n^2}</span></p>

    <p class="text-gray-300"><strong>Remark 4.</strong> The influence of the relative cost of  <span class="math">\\mathbf{A}&#x27;_1</span>  compared to  <span class="math">\\mathbf{A}_1</span>  is small and even negligible, even if -2 is chosen to define  <span class="math">\\mathbb{F}_{p^2}</span></p>

    <p class="text-gray-300">Thanks to Tables 1 and 2, it is easy to choose the best algorithm for  <span class="math">\\mathbb{F}_{p^2}</span>  multiplication and squaring depending on the context (relative cost of  <span class="math">\\mathbb{F}_p</span>  operations, choice of u).</p>

      <h3 id="sec-3.6" class="text-xl font-semibold mt-8">3.6 Choice of F<sup>p</sup> <sup>12</sup> arithmetic in the case 2, 3, 2</h3>

    <p class="text-gray-300">We assume that Fp<sup>12</sup> is built over Fp<sup>2</sup> via Fp<sup>6</sup> , using some &xi; which is neither a square nor a cube in Fp<sup>2</sup> :</p>

    <p class="text-gray-300"><span class="math">$\\mathbb{F}_{p^6} = \\mathbb{F}_{p^2}[\\beta] \\text{ where } \\beta^3 = \\xi \\text{ and } \\mathbb{F}_{p^{12}} = \\mathbb{F}_{p^6}[\\gamma] \\text{ with } \\gamma^2 = \\beta.</span>$</p>

      <h4 id="sec-3.6.1" class="text-lg font-semibold mt-6">3.6.1 Fp<sup>6</sup> arithmetic</h4>

    <p class="text-gray-300">We saw in Section 3.3.2 that the Karatsuba method becomes interesting when M<sup>2</sup> &ge; 3A2. Regarding Table 1, this condition is clearly always satised. Therefore, the Karatsuba method should always be used for Fp<sup>6</sup> /Fp<sup>2</sup> multiplications and</p>

    <p class="text-gray-300"><span class="math">$\\mathbf{M}_6 = 6\\mathbf{M}_2 + 15\\mathbf{A}_2 + 2\\mathbf{m}_{2,\\xi}.</span>$</p>

    <p class="text-gray-300">It is also easy to study the dierence between the complexities of the schoolbook, the Karastuba and the Chung-Hasan methods and to conclude that the latter is better in each case of Tables 1 and 2. Therefore, the Chung-Hasan method should always be use for Fp<sup>6</sup> /Fp<sup>2</sup> squaring so</p>

    <p class="text-gray-300"><span class="math">$\\mathbf{S}_6 = 2\\mathbf{M}_2 + 3\\mathbf{S}_2 + 8\\mathbf{A}_2 + \\mathbf{A&#x27;}_2 + 2\\mathbf{m}_{2,\\xi}.</span>$</p>

      <h4 id="sec-3.6.2" class="text-lg font-semibold mt-6">3.6.2 Fp<sup>12</sup> arithmetic</h4>

    <p class="text-gray-300">We obviously have A<sup>12</sup> = 2A<sup>6</sup> = 12A<sup>1</sup> and A<sup>0</sup> <sup>12</sup> = 2A<sup>0</sup> <sup>6</sup> = 12A<sup>0</sup> 1.</p>

    <p class="text-gray-300">Fp<sup>12</sup> multiplication. According to Section 3.2, the Karatsuba method is better than the schoolbook method when 3A<sup>6</sup> &lt; M6, which is obviously always the case according to 3.6.1. The Fp<sup>6</sup> multiplication by &beta; involved in Karatsuba formulas is given by</p>

    <p class="text-gray-300"><span class="math">$(b_0 + b_1 \\beta + b_2 \\beta^2) \\beta = \\xi b_2 + b_0 \\beta + b_1 \\beta^2,</span>$</p>

    <p class="text-gray-300">thus m6,&beta; = m2,&xi;. Finally, the Karatsuba method should always be used for Fp<sup>12</sup> /Fp<sup>6</sup> multiplications and</p>

    <p class="text-gray-300"><span class="math">$\\mathbf{M}_{12} = 18\\mathbf{M}_2 + 60\\mathbf{A}_2 + 7\\mathbf{m}_{2,\\xi}.</span>$</p>

    <p class="text-gray-300">Fp<sup>12</sup> sparse multiplication. During the Miller loop for the optimal Ate pairing, one of the operands (the line <code>) is sparse but the conclusion remains the same: the Karatsuba method should be preferred for multiplications at all levels, assuming that at least two coecients are non-zero. More precisely, as explained in Section 6, </code> is of the form b<sup>0</sup> +b1&gamma; +b3&gamma; 3 , where b<sup>i</sup> &isin; Fp<sup>2</sup> . With our notations, it can be written <code>= b&lt;sup&gt;0&lt;/sup&gt; + (b&lt;sup&gt;1&lt;/sup&gt; + b3&beta;)&gamma;. The Karatsuba multiplication in Fp&lt;sup&gt;12&lt;/sup&gt; between</code> and c<sup>0</sup> + c1&gamma; is given by</p>

    <p class="text-gray-300"><span class="math">$b_0c_0 + (b_1 + b_3\\beta)c_1\\beta + ((b_0 + b_1 + b_3\\beta)(c_0 + c_1) - b_0c_0 - (b_1 + b_3\\beta)c_1)</span>$
(1)</p>

    <p class="text-gray-300">and requires</p>

    <ul class="list-disc list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li>one multiplication of c<sup>0</sup> &isin; Fp<sup>6</sup> by b<sup>0</sup> &isin; Fp<sup>2</sup> which trivially costs 3M2,</li>
      <li>one multiplication of c<sup>1</sup> &isin; Fp<sup>6</sup> by b<sup>1</sup> + b3&beta;. It is done thanks to the sparse Karatsuba multiplication given in Section 3.3 and costs 5M2+6A2+m2,&xi;,</li>
      <li>4A<sup>2</sup> to compute b<sup>0</sup> + b<sup>1</sup> and c<sup>0</sup> + c1,</li>
      <li>one multiplication of c<sup>0</sup> + c<sup>1</sup> by b<sup>0</sup> + b<sup>1</sup> + b3&beta; which is the same as the one of c<sup>1</sup> by b<sup>1</sup> + b3&beta;,</li>
      <li>one m6,&beta; = m2,&xi; and 3A<sup>6</sup> to compute the nal result.</li>
    </ul>

    <p class="text-gray-300">Hence a Fp<sup>12</sup> sparse multiplication requires</p>

    <p class="text-gray-300"><span class="math">$\\mathbf{sM}_{12} = 13\\mathbf{M}_2 + 25\\mathbf{A}_2 + 3\\mathbf{m}_{2,\\xi}.</span>$</p>

    <p class="text-gray-300">Fp<sup>12</sup> squaring. Let us now compare the schoolbook and the Karatsuba methods for squaring in Fp<sup>12</sup> /Fp<sup>6</sup> . Using the complexities obtained for M<sup>6</sup> and S<sup>6</sup> in 3.6.1, the dierence between the complexities is</p>

    <p class="text-gray-300"><span class="math">$\\mathbf{S}_{12}^{\\scriptscriptstyle{K}} - \\mathbf{S}_{12}^{\\scriptscriptstyle{SB}} = 3\\mathbf{S}_2 - 4\\mathbf{M}_2 + 2\\mathbf{A}_2 - 2\\mathbf{A&#x27;}_2 + \\mathbf{m}_{2,\\xi}.</span>$</p>

    <p class="text-gray-300">Using Tables 1 and 2, we can easily verify that this dierence is negative in all the cases we have considered even if m2,&xi; = M<sup>2</sup> (which is obviously the worst case for m2,&xi;). Therefore, the schoolbook method should not be used.</p>

    <p class="text-gray-300">We have now to compare the Karatsuba and the complex methods for squaring in Fp<sup>12</sup> /Fp<sup>6</sup> . Using the complexities obtained for M<sup>6</sup> and S<sup>6</sup> in 3.6.1 and assuming that m6,&beta;+1 = A<sup>6</sup> + m6,&beta; = A<sup>6</sup> + m2,&xi;, the dierence between the complexities is</p>

    <p class="text-gray-300"><span class="math">$\\Delta = \\mathbf{S}_{12}^{\\scriptscriptstyle{K}} - \\mathbf{S}_{12}^{\\scriptscriptstyle{\\mathbb{C}}} = 9\\mathbf{S}_{2} - 6\\mathbf{M}_{2} - 6\\mathbf{A}_{2} + \\mathbf{m}_{2,\\xi}</span>$</p>

    <p class="text-gray-300">The sign of &#8710; depends on the value of &micro;. Again, we do not give all the details but thanks to Tables 1 and 2, we can determine that</p>

    <p class="text-gray-300">&bull; The Karatsuba method should be used if &micro; = &minus;1, &minus;5 and if &micro; = &minus;2 with A<sup>1</sup> &le; 0.33M<sup>1</sup> or S<sup>1</sup> = 0.8M<sup>1</sup> and in this case</p>

    <p class="text-gray-300"><span class="math">$\\mathbf{S}_{12} = 6\\mathbf{M}_2 + 9\\mathbf{S}_2 + 36\\mathbf{A}_2 + 3\\mathbf{A&#x27;}_2 + 7\\mathbf{m}_{2,\\xi}.</span>$</p>

    <p class="text-gray-300">&bull; The complex method should be used if &micro; is not small and if &micro; = &minus;2 with A<sup>1</sup> &gt; 0.33M<sup>1</sup> and S<sup>1</sup> = M<sup>1</sup> and in this case</p>

    <p class="text-gray-300"><span class="math">$\\mathbf{S}_{12} = 12\\mathbf{M}_2 + 42\\mathbf{A}_2 + 3\\mathbf{A&#x27;}_2 + 6\\mathbf{m}_{2,\\xi}.</span>$</p>

      <h3 id="sec-3.7" class="text-xl font-semibold mt-8">3.7 Choice of F<sup>p</sup> <sup>12</sup> arithmetic in the case 2, 2, 3</h3>

    <p class="text-gray-300">We assume that Fp<sup>12</sup> is built over Fp<sup>2</sup> via Fp<sup>4</sup> , using some &xi; which is neither a square nor a cube in Fp<sup>2</sup> :</p>

    <p class="text-gray-300"><span class="math">$\\mathbb{F}_{p^4} = \\mathbb{F}_{p^2}[\\beta]</span>$
where  <span class="math">\\beta^2 = \\xi</span>  and  <span class="math">\\mathbb{F}_{p^{12}} = \\mathbb{F}_{p^4}[\\gamma]</span>  with  <span class="math">\\gamma^3 = \\beta</span> .</p>

      <h4 id="sec-3.7.1" class="text-lg font-semibold mt-6">3.7.1 <span class="math">\\mathbb{F}_{p^4}</span> arithmetic</h4>

    <p class="text-gray-300">We saw in Section 3.2.2 that the Karatsuba method becomes interesting when  <span class="math">\\mathbf{M}_2 \\geq 3\\mathbf{A}_2 = 6\\mathbf{A}_1</span> . Regarding Table 1, this condition is clearly always satisfied.</p>

    <p class="text-gray-300">Therefore, the Karatsuba method should always be used for  <span class="math">\\mathbb{F}_{p^4}/\\mathbb{F}_{p^2}</span>  multiplications and</p>

    <p class="text-gray-300"><span class="math">$\\mathbf{M}_4 = 3\\mathbf{M}_2 + 5\\mathbf{A}_2 + \\mathbf{m}_{2,\\xi}.</span>$</p>

    <p class="text-gray-300">Concerning the squaring, all the methods are close in terms of complexity. We do not give details here, but thanks to Tables 1 and 2, we can decide which method is preferable to use, depending on the context. The Karatsuba method is usually the best and this is summarized in Table 3.</p>

    <div class="overflow-x-auto my-4">
      <table class="min-w-full text-sm text-gray-300">
        <thead>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"></th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">_</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"></th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"></th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"></th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"></th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"></th>
        </thead>
        <tbody>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">\\mu</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">condition</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">- method</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">complexity</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">assuming <span class="math">\\mathbf{A}_1 \\leq 0.33\\mathbf{M}_1</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-1, -2  or  -5</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">K</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">3S_2 + m_{2,\\xi} + 4A_2</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">any</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">\\mathbb{C}</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">2\\mathbf{M}_2 + \\mathbf{m}_{2,\\xi} + \\mathbf{m}_{2,\\xi+1} + 3\\mathbf{A}_2 + \\mathbf{A&#x27;}_2</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">assuming <span class="math">\\mathbf{A}_1 &gt; 0.33\\mathbf{M}_1</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-1  or  -5</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">K</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">3\\mathbf{S}_2 + \\mathbf{m}_{2,\\xi} + 4\\mathbf{A}_2</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-2</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">S_1 = 0.8M_1</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">11</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">35_2+\\mathbf{m}_{2,\\xi}+4\\mathbf{A}_2</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">any</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">\\mathbf{S}_1 = 0.01</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">SB</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">\\mathbf{M}_2 + 2\\mathbf{S}_2 + \\mathbf{m}_{2,\\xi} + \\mathbf{A}_2 + \\mathbf{A&#x27;}_2</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-2  or any</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">\\mathbf{S}_1 = \\mathbf{M}_1</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">\\mathbb{C}</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">2\\mathbf{M}_2 + \\mathbf{m}_{2,\\xi} + \\mathbf{m}_{2,\\xi+1} + 3\\mathbf{A}_2 + \\mathbf{A&#x27;}_2</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
        </tbody>
      </table>
    </div>

    <p class="text-gray-300">Table 3: Complexities of  <span class="math">S_4</span>  depending on the context</p>

      <h4 id="sec-3.7.2" class="text-lg font-semibold mt-6">3.7.2 <span class="math">\\mathbb{F}_{p^{12}}</span> arithmetic</h4>

    <p class="text-gray-300">We also have  <span class="math">\\mathbf{A}_{12} = 12\\mathbf{A}_1</span>  and  <span class="math">\\mathbf{A&#x27;}_{12}12\\mathbf{A&#x27;}_1</span>  in this case.</p>

    <p class="text-gray-300"><span class="math">\\mathbb{F}_{p^{12}}</span>  multiplication. According to Section 3.3, the Karatsuba method is better than the schoolbook method for multiplications in  <span class="math">\\mathbb{F}_{p^{12}}/\\mathbb{F}_{p^4}</span>  when  <span class="math">3\\mathbf{A}_4 &lt; \\mathbf{M}_4</span> , which is obviously always the case according to Section 3.7.1. The  <span class="math">\\mathbb{F}_{p^4}</span>  multiplication by  <span class="math">\\beta</span>  involved in Karatsuba formulas is given by</p>

    <p class="text-gray-300"><span class="math">$(b_0 + b_1 \\beta) \\beta = \\xi b_1 + b_0 \\beta</span>$
,</p>

    <p class="text-gray-300">thus  <span class="math">\\mathbf{m}_{4,\\beta} = \\mathbf{m}_{2,\\xi}</span> . Therefore, the Karatsuba method should always be used for  <span class="math">\\mathbb{F}_{p^{12}}/\\mathbb{F}_{p^4}</span>  multiplications and</p>

    <p class="text-gray-300"><span class="math">$\\mathbf{M}_{12} = 18\\mathbf{M}_2 + 60\\mathbf{A}_2 + 8\\mathbf{m}_{2.\\xi}.</span>$</p>

    <p class="text-gray-300"><span class="math">\\mathbb{F}_{p^{12}}</span>  sparse multiplication. Again, the Karatsuba method should be preferred for multiplications at all levels when one of the operands is sparse. With our notations, the sparse element involved in the Miller loop can be written</p>

    <p class="text-gray-300"><code>= b&lt;sup&gt;0&lt;/sup&gt; +b3&beta; +b1&gamma;. We use the sparse Karatsuba multiplication given in Section 3.3 to compute the product of</code> and c<sup>0</sup> + c1&gamma; + c2&gamma; <sup>2</sup> &isin; Fp<sup>12</sup></p>

    <p class="text-gray-300"><span class="math">$(c_0 + c_1 \\gamma + c_2 \\gamma^2)((b_0 + b_3 \\beta) + b_1 \\gamma) = c_0(b_0 + b_3 \\beta) + \\beta c_2 b_1 + [(c_0 + c_1)(b_0 + b_3 \\beta + b_1) - c_0(b_0 + b_3 \\beta) - c_1 b_1] \\gamma + [c_2(b_0 + b_3 \\beta) + c_1 b_1] \\gamma^2</span>$
(2)</p>

    <p class="text-gray-300">It requires</p>

    <ul class="list-disc list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li>Two multiplications of c<sup>1</sup> (or c2) &isin; Fp<sup>4</sup> by b<sup>1</sup> &isin; Fp<sup>2</sup> which trivially cost 2M<sup>2</sup> each.</li>
      <li>Three Fp<sup>4</sup> multiplications which are done thanks to the Karatsuba method and cost 3M<sup>2</sup> + 5A<sup>2</sup> + m2,&xi;.</li>
      <li>3A<sup>2</sup> to compute b<sup>0</sup> + b<sup>1</sup> and c<sup>0</sup> + c1.</li>
      <li>One m4,&beta; = m2,&xi; and 4A<sup>4</sup> to compute the nal result.</li>
    </ul>

    <p class="text-gray-300">Hence a Fp<sup>12</sup> sparse multiplication requires</p>

    <p class="text-gray-300"><span class="math">$\\mathbf{sM}_{12} = 13\\mathbf{M}_2 + 26\\mathbf{A}_2 + 4\\mathbf{m}_{2,\\xi}.</span>$</p>

    <p class="text-gray-300">Fp<sup>12</sup> squaring. We do not give details here because it would be repetitive after previous sections but it is easy to study the dierence between the complexities of the schoolbook, the Karastuba and the Chung-Hasan methods and to conclude that the latter is always better. Therefore, the Chung-Hasan method should always be used for Fp<sup>12</sup> /Fp<sup>4</sup> squaring and</p>

    <p class="text-gray-300"><span class="math">$\\mathbf{S}_{12} = 3\\mathbf{S}_4 + 6\\mathbf{M}_2 + 26\\mathbf{A}_2 + 2\\mathbf{A&#x27;}_2 + 4\\mathbf{m}_{2,\\xi}.</span>$</p>

      <h3 id="sec-3.8" class="text-xl font-semibold mt-8">3.8 Choice of &xi; and consequences on u</h3>

    <p class="text-gray-300">The choice of &xi; has no consequence on the way of choosing the arithmetic of Fp<sup>12</sup> , but it must be done such that multiplication by &xi; is as ecient as possible. However, the choice of &xi; has less inuence on M<sup>12</sup> and S<sup>12</sup> complexities than the choice of &micro;. So an ecient &micro; should be chosen in priority.</p>

    <p class="text-gray-300">The most natural choice is &xi; = &alpha;, so that a multiplication by &xi; in Fp<sup>2</sup> is</p>

    <p class="text-gray-300"><span class="math">$(a_0 + a_1 \\alpha)\\xi = \\mu a_1 + a_0 \\alpha</span>$</p>

    <p class="text-gray-300">and thus m2,&xi; = m1,&micro;. It means that &micro; must be neither a fourth power nor a cube in Fp. If p &equiv; 1 (mod 6), which is always the case for a BN prime, such a &micro; always exists.</p>

    <p class="text-gray-300">In practice, it is easy to nd one by trial and error, by factoring x <sup>12</sup> &minus; &micro; modulo p until nding an irreducible polynomial. However, the obtained value is not necessarily optimal for  <span class="math">\\mathbb{F}_{p^2}</span>  arithmetic and  <span class="math">\\mu</span>  should be chosen in priority to define  <span class="math">\\mathbb{F}_{p^2}</span>  as efficiently as possible. For example, the best choice for  <span class="math">\\mathbb{F}_{p^2}</span>  is  <span class="math">\\mu=-1</span>  but it is obviously always a cube. Then, if  <span class="math">\\mu</span>  is already fixed to define  <span class="math">\\mathbb{F}_{p^2}</span>  and is a cube,  <span class="math">\\xi</span>  must be chosen as an element of  <span class="math">\\mathbb{F}_{p^2}</span>  with small coefficients. At first glance, the best choices are  <span class="math">\\xi=2</span>  and  <span class="math">\\xi=1+\\alpha</span> . However, as proved in Corollary 1 of Appendix A, 2 (as any other element of  <span class="math">\\mathbb{F}_p</span> ) is always a square in  <span class="math">\\mathbb{F}_{p^2}</span> , so it cannot be chosen to define  <span class="math">\\mathbb{F}_{p^{12}}</span> . Other choices can be made as  <span class="math">2+\\alpha</span>  but they are of course less interesting in terms of efficiency.</p>

    <p class="text-gray-300">Remark 5. The condition to choose  <span class="math">\\xi</span>  is that it is neither a square nor a cube in  <span class="math">\\mathbb{F}_{p^2}</span> . Since -1 is always a square and a cube in  <span class="math">\\mathbb{F}_{p^2}</span> , there is no interest to consider the sign of  <span class="math">\\xi</span> . In the same way, there is no interest to consider the conjugates of  <span class="math">\\xi</span>  because they are squares and cubes at the same times as  <span class="math">\\xi</span> .</p>

    <p class="text-gray-300">Let us now precise the possible choices for  <span class="math">\\xi</span>  depending on the choice of  <span class="math">\\mu</span>  and their consequences on the choice of the parameter u. We will use the following proposition which is proved in Appendix A:</p>

    <p class="text-gray-300"><strong>Proposition 3.</strong> Let p be an odd prime number which is equal to 1 modulo 3 (this is always the case for BN primes). Then an element is a square (resp. a cube) in  <span class="math">\\mathbb{F}_{p^2}</span>  if and only if its norm is a square (resp. a cube) in  <span class="math">\\mathbb{F}_p</span> .</p>

      <h4 id="sec-3.8.1" class="text-lg font-semibold mt-6"><strong>3.8.1</strong> The case <span class="math">\\mu = -1</span></h4>

    <p class="text-gray-300">In this case, the smallest complexity for  <span class="math">\\mathbf{m}_{2,\\xi}</span>  is reached by  <span class="math">\\xi = 1 + \\mathbf{i}</span>  and equals  <span class="math">2\\mathbf{A}_1</span>  since</p>

    <p class="text-gray-300"><span class="math">$(1+\\mathbf{i})(a_0+a_1\\mathbf{i}) = a_0-a_1+(a_0+a_1)\\mathbf{i}.</span>$</p>

    <p class="text-gray-300">Let us now study the conditions on u ensuring that  <span class="math">1+\\mathbf{i}</span>  is neither a square nor a cube in  <span class="math">\\mathbb{F}_{p^2}</span> .</p>

    <p class="text-gray-300"><strong>Theorem 1.</strong> Let  <span class="math">p = 36u^4 + 36u^3 + 24u^2 + 6u + 1</span>  be a BN prime with u odd (thus  <span class="math">\\mathbb{F}_{p^2}</span>  can be defined by  <span class="math">\\mathbf{i} = \\sqrt{-1}</span> ). Then  <span class="math">1 + \\mathbf{i}</span>  is neither a square nor a cube in  <span class="math">\\mathbb{F}_{p^2}</span>  if and only if u = 7 or 11 modulo 12. In this case,  <span class="math">\\mathbb{F}_{p^{12}}</span>  can be defined over  <span class="math">\\mathbb{F}_{p^2}</span>  by a sixth root of  <span class="math">1 + \\mathbf{i}</span> .</p>

    <p class="text-gray-300"><em>Proof.</em> By Proposition 3,  <span class="math">1 + \\mathbf{i}</span>  is a square (resp. a cube) in  <span class="math">\\mathbb{F}_{p^2}</span>  if and only if  <span class="math">2 = N_{\\mathbb{F}_{p^2}/\\mathbb{F}_p}(1 + \\mathbf{i})</span>  is a square (resp. a cube) in  <span class="math">\\mathbb{F}_p</span> .</p>

    <ul class="list-disc list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li>According to Proposition 1 of Appendix A, 2 is a square in  <span class="math">\\mathbb{F}_p</span>  if and only if u = 0 or 1 modulo 4. Thus, in our situation,  <span class="math">1 + \\mathbf{i}</span>  is not a square in  <span class="math">\\mathbb{F}_{p^2}</span>  if and only if u = 3 modulo 4.</li>
      <li>In the same way,  <span class="math">1 + \\mathbf{i}</span>  is not a cube if and only if 2 is not a cube which means, according to Proposition 2 of Appendix A, that  <span class="math">u \\neq 0 \\mod 3</span> . Thus  <span class="math">1 + \\mathbf{i}</span>  is not a cube if and only if u = 1 or 5 modulo 6.</li>
    </ul>

    <p class="text-gray-300">Combining these two congruences ends the proof.</p>

    <p class="text-gray-300">If  <span class="math">1+\\mathbf{i}</span>  cannot be chosen,  <span class="math">\\xi</span>  should be sought in the form  <span class="math">a+\\mathbf{i}b</span>  with a&gt;b&gt;0 and can be chosen if and only if  <span class="math">a^2+b^2=N_{\\mathbb{F}_{p^2}/\\mathbb{F}_p}(a+\\mathbf{i}b)</span>  is neither a square nor a cube in  <span class="math">\\mathbb{F}_p</span> . The next candidate in terms of efficiency is  <span class="math">\\xi=2+\\mathbf{i}</span>  for which  <span class="math">\\mathbf{m}_{2,\\xi}=2\\mathbf{A}_1+2\\mathbf{A}&#x27;_1</span>  and whose norm is 5. Combining the condition ensuring that 5 is neither a square nor a cube given in Appendix A and the fact that  <span class="math">u\\neq 7</span>  or 11 modulo 12 (otherwise  <span class="math">\\xi=1+\\mathbf{i}</span>  can be chosen), we get that  <span class="math">2+\\mathbf{i}</span>  should be chosen to define  <span class="math">\\mathbb{F}_{p^{12}}</span>  if u=1,3,13,27,33,37,41 or 57 modulo 60 but not in the 12 remaining cases (u=5,9,15,17,21,25,29,39,45,49,51 or 53 modulo 60). In 3 of these cases (u=17,39 and 53 modulo 60), one can choose  <span class="math">3+\\mathbf{i}</span> , whose norm is 10. Of course, this study can be easily continued with &quot;larger&quot; values of  <span class="math">\\xi</span>  ( <span class="math">4+\\mathbf{i},3+2\\mathbf{i},...</span> ) to be able to deal with the 9 remaining cases. But the interest is limited here and the reader can easily do it by himself if necessary.</p>

      <h4 id="sec-3.8.2" class="text-lg font-semibold mt-6"><strong>3.8.2</strong> The case <span class="math">\\mu = -2</span></h4>

    <p class="text-gray-300">Taking in account the results from Section 3.5, this choice should be made only when -1 cannot be chosen to build  <span class="math">\\mathbb{F}_{p^2}</span> , that is, when u=2 modulo 4 (-1 is a square and -2 is not a square). In this case, the smallest complexity for  <span class="math">\\mathbf{m}_{2,\\xi}</span>  is reached by  <span class="math">\\xi = \\alpha = \\sqrt{-2}</span> . Let us now study the conditions on u ensuring that  <span class="math">\\sqrt{-2}</span>  is neither a square nor a cube in  <span class="math">\\mathbb{F}_{p^2}</span> .</p>

    <p class="text-gray-300"><strong>Theorem 2.</strong> Let  <span class="math">p = 36u^4 + 36u^3 + 24u^2 + 6u + 1</span>  be a BN prime with u = 2 modulo 4 (thus  <span class="math">\\mathbb{F}_{p^2}</span>  can be defined by  <span class="math">\\sqrt{-2}</span>  but not by  <span class="math">\\sqrt{-1}</span> ). Then  <span class="math">\\alpha = \\sqrt{-2}</span>  is neither a square nor a cube in  <span class="math">\\mathbb{F}_{p^2}</span>  if and only if u = 2 or 10 modulo 12. In this case,  <span class="math">\\mathbb{F}_{p^{12}}</span>  can be defined over  <span class="math">\\mathbb{F}_{p^2}</span>  by a sixth root of  <span class="math">\\alpha</span> .</p>

    <h4 id="sec-misc-3" class="text-lg font-semibold mt-6">Proof.</h4>

    <ul class="list-disc list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li>Since -1 is a square and -2 is not,  <span class="math">N_{\\mathbb{F}_{p^2}/\\mathbb{F}_p}(\\alpha) = 2</span>  is never a square in  <span class="math">\\mathbb{F}_p</span>  and thus, by 3,  <span class="math">\\alpha</span>  is never a square in  <span class="math">\\mathbb{F}_{p^2}</span> . Note that this proof is not specific to the case  <span class="math">\\mu = -2</span> ; it is only using the fact that -1 is a square in  <span class="math">\\mathbb{F}_p</span>  and  <span class="math">\\mu</span>  is not.</li>
      <li>Since -1 is a cube,  <span class="math">\\alpha</span>  is a cube in  <span class="math">\\mathbb{F}_{p^2}</span>  if and only if  <span class="math">2 = -N_{\\mathbb{F}_{p^2}/\\mathbb{F}_p}(\\alpha)</span>  is a cube in  <span class="math">\\mathbb{F}_p</span> . According to Proposition 2 of Appendix A, 2, and thus  <span class="math">\\alpha</span> , is not a cube if and only if u = 1 or 2 modulo 3. Taking in account that -1 is a square and -2 is not a square, this last condition can be rewritten u = 2 or 10 modulo 12.</li>
    </ul>

    <p class="text-gray-300">The next interesting candidate is  <span class="math">\\xi=1+\\alpha</span>  but it cannot be chosen since its norm equals 3 which is always a square in  <span class="math">\\mathbb{F}_p</span>  in the remaining case (u=6 modulo 12). The situation is better if  <span class="math">\\xi=2+\\alpha</span>  whose norm is 6. Indeed, since 2 is not a square and 3 is always a square, 6 is never a square in  <span class="math">\\mathbb{F}_p</span> . Moreover, since it was not possible to choose  <span class="math">\\xi=\\alpha</span> , 2 is a cube in  <span class="math">\\mathbb{F}_p</span>  and thus 6 is not a cube in  <span class="math">\\mathbb{F}_p</span>  if and only if 3 is not a cube in  <span class="math">\\mathbb{F}_p</span> . According to Proposition 2 of</p>

    <p class="text-gray-300">Appendix A,  <span class="math">\\xi = 2 + \\alpha</span>  can then be chosen if u = 6 or 30 modulo 36. In this case  <span class="math">\\mathbf{m}_{2,\\xi} = 2\\mathbf{A}_1 + 2\\mathbf{A}&#x27;_1</span> . Again, this study can be easily continued by the interested reader with &quot;larger&quot; values of  <span class="math">\\xi</span>  like  <span class="math">3 + \\alpha</span>  to deal with the last remaining case (u = 18 modulo 36).</p>

      <h4 id="sec-3.8.3" class="text-lg font-semibold mt-6"><strong>3.8.3</strong> The case <span class="math">\\mu = -5</span></h4>

    <p class="text-gray-300">Again, taking in account the results from Section 3.5, this case should be considered only if u=8,12 or 16 modulo 20  <span class="math">(-1,\\pm 2</span>  are squares and  <span class="math">\\pm 5</span>  are not). The smallest complexity for  <span class="math">\\mathbf{m}_{2,\\xi}</span>  is reached by  <span class="math">\\xi=\\alpha=\\sqrt{-5}</span> . Let us study the conditions on u ensuring that  <span class="math">\\sqrt{-5}</span>  is neither a square nor a cube in  <span class="math">\\mathbb{F}_{p^2}</span> .</p>

    <p class="text-gray-300"><strong>Theorem 3.</strong> Let  <span class="math">p=36u^4+36u^3+24u^2+6u+1</span>  be a BN prime with u=8,12 or 16 modulo 20. Then  <span class="math">\\alpha=\\sqrt{-5}</span>  is neither a square nor a cube in  <span class="math">\\mathbb{F}_{p^2}</span>  if and only if u=12,16,28,48,52,56 modulo 60. In this case,  <span class="math">\\mathbb{F}_{p^{12}}</span>  can be defined over  <span class="math">\\mathbb{F}_{p^2}</span>  by a sixth root of  <span class="math">\\alpha</span> .</p>

    <p class="text-gray-300"><em>Proof.</em> Similarly to the proof of Theorem 2, we prove that  <span class="math">\\alpha</span>  is never a square in  <span class="math">\\mathbb{F}_{p^2}</span> . Moreover,  <span class="math">\\alpha</span>  is a cube in  <span class="math">\\mathbb{F}_{p^2}</span>  if and only if  <span class="math">5 = -N_{\\mathbb{F}_{p^2}/\\mathbb{F}_p}(\\alpha)</span>  is a cube in  <span class="math">\\mathbb{F}_p</span> . Proposition 2 of Appendix A gives a condition ensuring that 5, and thus  <span class="math">\\alpha</span> , is not a cube and allows to conclude.</p>

    <p class="text-gray-300">The next interesting candidate is  <span class="math">\\xi=1+\\alpha</span>  but it cannot be chosen since its norm equals 6 which is always a square in this case. The situation is the same for  <span class="math">2+\\alpha</span>  since its norm is 9. The &quot;smallest&quot; usable candidates are  <span class="math">1+2\\alpha</span>  and  <span class="math">3+\\alpha</span>  whose norms are respectively 21 and 14. This will give conditions on u modulo 7 but we leave it to the interested reader, since there are very few concerned cases (u=8,32 or 36 modulo 60) and the cost of  <span class="math">\\mathbf{m}_{2,\\xi}</span>  becomes high.</p>

      <h4 id="sec-3.8.4" class="text-lg font-semibold mt-6">3.8.4 Recapitulative table</h4>

    <p class="text-gray-300">Finally, we gave almost all the best choices for  <span class="math">\\xi</span> , depending on the value of u. This is summarized in Table 4.</p>

    <div class="overflow-x-auto my-4">
      <table class="min-w-full text-sm text-gray-300">
        <thead>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"><span class="math">\\mu</span></th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">Value of <span class="math">u</span> modulo</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"></th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"></th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"></th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"></th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">c</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"></th>
        </thead>
        <tbody>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">4</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">12</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">20</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">36</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">60</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">&xi;</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">\\mathbf{m}_{2,\\xi}</span></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-1</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1,3</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">7,11</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">1 + \\mathbf{i}</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">2\\mathbf{A}_1</span></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1, 3, 5, 9</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1, 3, 13, 27, 33, 37, 41, 57</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">2 + \\mathbf{i}</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">2\\mathbf{A}_1 + 2\\mathbf{A&#x27;}_1</span></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">17, 39, 53</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">3 + i</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">4A_1 + 2A&#x27;_1</span></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">5, 9, 15, 21, 25, 29, 45, 49, 51</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">_</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">_</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-2</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">2</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">2,10</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">\\sqrt{-2}</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">\\mathbf{A&#x27;}_1</span></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">6</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">6,30</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">2 + \\sqrt{-2}</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">2\\mathbf{A}_1 + 2\\mathbf{A&#x27;}_1</span></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">18</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">_</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">_</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-5</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">0</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">0,4,8</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">8, 12, 16</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">12, 16, 28, 48, 52, 56</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">\\sqrt{-5}</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">\\mathbf{A}_1 + 2\\mathbf{A&#x27;}_1</span></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-5</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">8, 32, 36</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">_</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">_</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">any</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">0, 4</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">\\sqrt{\\mu}</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">\\mathbf{M}_1</span></td>
          </tr>
        </tbody>
      </table>
    </div>

    <p class="text-gray-300">Table 4: Best choices of  <span class="math">\\mu</span>  and  <span class="math">\\xi</span>  in terms of u</p>

      <h3 id="sec-3.9" class="text-xl font-semibold mt-8">3.9 New improvements of <span class="math">\\mathbb{F}_{p^{12}}</span> arithmetic</h3>

    <p class="text-gray-300">Usually, the cost of additions is not taken in account in complexity studies because it is assumed to be negligible. However, it is not always the case in hardware or assembly language where the ratio between additions and multiplications in  <span class="math">\\mathbb{F}_p</span>  can be as large as 0.2 to 0.5, as explained in Section 3.1. In this case, we get some new improvements (saving of course only additions). The first one is just a computational trick and is probably used in practical implementations but it is usually not explicitly written. The second one consists in precomputing the traces of some elements of the intermediate levels of the extension tower which are involved in several operations.</p>

    <p class="text-gray-300">Since these are new results, we chose to present them in a dedicated section. These results could be included in our previous discussion on the choices for building  <span class="math">\\mathbb{F}_{p^{12}}</span> . We did not do it for two reasons. The first one is that they require some precomputations storage which is not always desirable, depending on the context. The second one is that it has no influence on the choices to be made.</p>

      <h4 id="sec-3.9.1" class="text-lg font-semibold mt-6">3.9.1 Multiplications by <span class="math">\\xi - 1</span> in Karatsuba operations</h4>

    <p class="text-gray-300">If  <span class="math">\\mathbf{m}_{i,\\xi-1} \\leq \\mathbf{m}_{i,\\xi}</span> , then the Karatsuba multiplication of  <span class="math">x_0 + x_1\\beta</span>  by  <span class="math">y_0 + y_1\\beta</span>  in  <span class="math">\\mathbb{F}_{p^{2i}}</span>  can be evaluated as</p>

    <p class="text-gray-300"><span class="math">$x_0y_0 + x_1y_1 + (\\xi - 1)x_1y_1 + ((x_0 + x_1)(y_0 + y_1) - x_0y_0 - x_1y_1)\\beta</span>$
,</p>

    <p class="text-gray-300">instead of</p>

    <p class="text-gray-300"><span class="math">$x_0y_0 + \\xi x_1y_1 + ((x_0 + x_1)(y_0 + y_1) - x_0y_0 - x_1y_1)\\beta.</span>$</p>

    <p class="text-gray-300">Then it requires  <span class="math">3\\mathbf{M}_i + \\mathbf{m}_{i,\\xi-1} + 5\\mathbf{A}_i</span>  instead of  <span class="math">3\\mathbf{M}_i + \\mathbf{m}_{i,\\xi} + 5\\mathbf{A}_i</span>  because  <span class="math">x_0y_0 + x_1y_1</span>  is used twice.</p>

    <p class="text-gray-300">In the same way, the Karatsuba multiplication of  <span class="math">x_0 + x_1\\beta + x_2\\beta^2</span>  by  <span class="math">y_0 + y_1\\beta + y_0\\beta^2</span>  in  <span class="math">\\mathbb{F}_{p^{3i}}</span>  can be evaluated as</p>

    <p class="text-gray-300"><span class="math">$x_0y_0 + \\xi((x_1 + x_2)(y_1 + y_2) - x_1y_1 - x_2y_2) + [(x_0 + x_1)(y_0 + y_1) - x_0y_0 - x_1y_1 + x_2y_2 + (\\xi - 1)x_2y_2]\\beta + [(x_0 + x_2)(y_0 + y_2) - x_0y_0 - (-x_1y_1 + x_2y_2)]\\beta^2.</span>$</p>

    <p class="text-gray-300">One of the multiplications by  <span class="math">\\xi</span>  is then replaced by a multiplication by  <span class="math">\\xi - 1</span>  compared to the formula given in 3.3.2. Of course, both in the case of quadratic and cubic extensions, this trick also applies to Karatsuba squaring.</p>

    <p class="text-gray-300">In the cases considered in Section 3.8, this improvement is only interesting in the intermediate fields  <span class="math">(\\mathbb{F}_{p^4}/\\mathbb{F}_{p^2})</span>  in the 2, 2, 3 case and  <span class="math">\\mathbb{F}_{p^6}/\\mathbb{F}_{p^2}</span>  in the 2, 3, 2 case) and allows to save some  <span class="math">\\mathbb{F}_p</span>  additions for each Karatsuba multiplication or squaring in  <span class="math">\\mathbb{F}_{p^4}</span>  or  <span class="math">\\mathbb{F}_{p^6}</span>  in the cases given in Table 5.</p>

    <div class="overflow-x-auto my-4">
      <table class="min-w-full text-sm text-gray-300">
        <thead>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">&xi;</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"><span class="math">m_{2,\\xi-1}</span></th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"><span class="math">m_{2,\\xi}</span></th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">Saving</th>
        </thead>
        <tbody>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">1+\\mathbf{i}</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">0</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">2\\mathbf{A}_1</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">2\\mathbf{A}_1</span></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">2+\\mathbf{i}</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">2\\mathbf{A}_1</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">2\\mathbf{A}_1 + 2\\mathbf{A&#x27;}_1</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">2\\mathbf{A&#x27;}_1</span></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">3+\\mathbf{i}</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">2\\mathbf{A}_1 + 2\\mathbf{A&#x27;}_1</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">4\\mathbf{A}_1 + 2\\mathbf{A&#x27;}_1</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">2\\mathbf{A}_1</span></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">2 + \\sqrt{-2}</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">2\\mathbf{A}_1 + \\mathbf{A&#x27;}_1</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">2\\mathbf{A}_1 + 2\\mathbf{A&#x27;}_1</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">\\mathbf{A&#x27;}_1</span></td>
          </tr>
        </tbody>
      </table>
    </div>

    <p class="text-gray-300">Table 5: Savings provided by the  <span class="math">\\xi - 1</span>  trick</p>

    <p class="text-gray-300"><strong>Remark 6.</strong> This trick is more interesting in the case 2,2,3 that in the case 2,3,2. Indeed, a Karatsuba multiplication in  <span class="math">\\mathbb{F}_{p^{12}}</span>  requires 6 multiplications at the middle level in the case 2,2,3 (and then  <span class="math">6m_{2,\\xi}</span>  are replaced by  <span class="math">6m_{2,\\xi-1}</span> ) but only 3 in the case 2,3,2. Of course, this remark also applies to sparse  <span class="math">\\mathbb{F}_{p^{12}}</span>  multiplications and to  <span class="math">\\mathbb{F}_{p^{12}}</span>  squarings.</p>

      <h4 id="sec-3.9.2" class="text-lg font-semibold mt-6">3.9.2 Precomputed traces</h4>

    <p class="text-gray-300">In the case where memory is large enough, we can perform some pre-computations to speed up the different operations  <span class="math">(i.e. \\mathbf{M}_i \\text{ or } \\mathbf{S}_i)</span> . In particular, it could be interesting to precompute the trace of an element if this element is used in several operations (requiring its trace) in the following.</p>

    <p class="text-gray-300">For example, assuming that  <span class="math">x_0 + x_1 = tr_{\\mathbb{F}_{p^{2i}}/\\mathbb{F}_{p^i}}(x_0 + x_1\\alpha)</span>  is precomputed, computing  <span class="math">(x_0 + x_1\\alpha)^2</span>  in  <span class="math">\\mathbb{F}_{p^{2i}}</span>  using the Karatsuba method as in 3.2.3 requires only  <span class="math">3\\mathbf{S}_i + \\mathbf{m}_{i,\\mu} + 3\\mathbf{A}_i</span>  instead of  <span class="math">3\\mathbf{S}_i + \\mathbf{m}_{i,\\mu} + 4\\mathbf{A}_i</span> . The same remark holds for all the methods for squaring or multiplying in  <span class="math">\\mathbb{F}_{p^{2i}}</span>  or  <span class="math">\\mathbb{F}_{p^{3i}}</span>  involving traces (or more precisely sums of coordinates). It is summarized in Table 6 (notations are those of Sections 3.2 and 3.3).</p>

    <div class="overflow-x-auto my-4">
      <table class="min-w-full text-sm text-gray-300">
        <thead>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">Operation</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">Method</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">Precomputations</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">Saving</th>
        </thead>
        <tbody>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">(x_0 + x_1 \\alpha)(y_0 + y_1 \\alpha)</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">\\mathbf{M}_{2i}^{\\scriptscriptstyle K}</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">x_0 + x_1, y_0 + y_1</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">2\\mathbf{A}_i</span></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">(x_0 + x_1 \\alpha)^2</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">\\mathbf{S}_{2i}^{\\scriptscriptstyle{K}}</span> or <span class="math">\\mathbf{S}_{2i}^{\\scriptscriptstyle{\\mathbb{C}}}</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">x_0 + x_1</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">\\mathbf{A}_i</span></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">(x_0 + x_1\\xi + x_2\\xi^2)(y_0 + y_1\\xi + y_2\\xi^2)</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">\\mathbf{M}_{3i}^{\\scriptscriptstyle K}</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">x_0 + x_1, x_0 + x_2, x_1 + x_2</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">6\\mathbf{A}_i</span></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1,131</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">y_0 + y_1, y_0 + y_2, y_1 + y_2</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">(x_0 + x_1\\xi + x_2\\xi^2)^2</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">\\mathbf{S}_{3i}^{\\scriptscriptstyle K}</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">x_0 + x_1, x_0 + x_2, x_1 + x_2</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">3\\mathbf{A}_i</span></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">(x_0 + x_1\\zeta + x_2\\zeta)</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">\\mathbf{S}_{3i}^{\\text{\\tiny CH}}</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">x_0 + x_1 + x_2</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">2\\mathbf{A}_i</span></td>
          </tr>
        </tbody>
      </table>
    </div>

    <p class="text-gray-300">Table 6: Precomputing traces</p>

    <p class="text-gray-300">Of course, we get savings only if the precomputations are used in several operations. This may hold in the arithmetic of the extension tower when an element is used twice. For example, a schoolbook multiplication in  <span class="math">\\mathbb{F}_{p^{2i}}</span>  will use  <span class="math">x_0</span>  both for  <span class="math">x_0y_0</span>  and for  <span class="math">x_0y_1</span> . If these multiplications are performed with the Karatsuba method in  <span class="math">\\mathbb{F}_{p^i}</span> , precomputing the trace of  <span class="math">x_0</span>  is interesting because it is used twice. However, in Karatsuba operations or in complex squarings, no element is used twice. As a consequence, this is not interesting for multiplications in  <span class="math">\\mathbb{F}_{p^{12}}</span>  because the Karatsuba method is always used at higher levels of the extension tower according to Sections 3.6 and 3.7. But it can be applied for squarings</p>

    <p class="text-gray-300">when the Chung-Hasan method is used over Karatsuba or complex arithmetic. It can also be applied for sparse multiplications since it involves schoolbook steps if operands have only one non-zero coefficient. Finally, we can also precompute traces if one  <span class="math">\\mathbb{F}_{p^{12}}</span>  element is used for several multiplications, which is usually the case in the final exponentiation step. Let us now give more details about these three situations.</p>

      <h4 id="sec-3.9.3" class="text-lg font-semibold mt-6">3.9.3 Use of precomputed traces in <span class="math">\\mathbb{F}_{p^{12}}</span> squarings</h4>

    <p class="text-gray-300">Some coefficients are used several times in  <span class="math">\\mathbb{F}_{p^{12}}</span>  squaring if the Chung-Hasan method is used over Karatsuba or complex arithmetic (i.e. when  <span class="math">\\mathbf{A}_1</span>  is not very expensive compared to  <span class="math">\\mathbf{M}_1</span> ). Indeed, we know from Section 3.3 that  <span class="math">x_0, 2x_1</span>  and  <span class="math">x_2</span>  are used twice to compute  <span class="math">(x_0 + x_1\\alpha + x_2\\alpha^2)^2</span>  using the Chung-Hasan method in  <span class="math">\\mathbb{F}_{p^{3i}}/\\mathbb{F}_{p^i}</span> . Thus  <span class="math">3\\mathbf{A}_i</span>  can be saved in  <span class="math">\\mathbf{S}_{3i}^{CF}</span>  if traces are precomputed at the level i. We saw in Sections 3.6 and 3.7 that this method is always used but one can do even better, depending on the way to build  <span class="math">\\mathbb{F}_{p^{12}}</span> .</p>

    <p class="text-gray-300">Case 2,3,2. We saw in Section 3.6 that the Karatsuba method is usually used for the  <span class="math">\\mathbb{F}_{p^{12}}/\\mathbb{F}_{p^6}</span>  squaring, so that the Chung-Hasan squaring in  <span class="math">\\mathbb{F}_{p^6}</span>  is used 3 times to compute  <span class="math">(c_0 + c_1\\gamma)^2</span>  (for  <span class="math">c_0^2, c_1^2</span>  and  <span class="math">(c_0 + c_1)^2</span> ). Of course each of them is used only once but precomputing traces is nonetheless interesting because  <span class="math">tr_{\\mathbb{F}_{p^6}/\\mathbb{F}_{p^2}}(c_0 + c_1) = tr_{\\mathbb{F}_{p^6}/\\mathbb{F}_{p^2}}(c_0) + tr_{\\mathbb{F}_{p^6}/\\mathbb{F}_{p^2}}(c_1)</span>  which requires only one  <span class="math">\\mathbf{A}_2</span>  instead of 2 if it is computed directly. Hence, in this case, if the Karatsuba method is used in  <span class="math">\\mathbb{F}_{p^2}</span> ,  <span class="math">11\\mathbf{A}_1</span>  can be saved in  <span class="math">\\mathbf{S}_{12}</span>  thanks to trace precomputations (9 from  <span class="math">\\mathbb{F}_{p^6}/\\mathbb{F}_{p^2}</span>  Chung-Hasan over Karatsuba squaring and 2 from  <span class="math">\\mathbb{F}_{p^{12}}/\\mathbb{F}_{p^6}</span>  Karatsuba over Chung-Hasan squaring). If the Karatsuba method is not used in  <span class="math">\\mathbb{F}_{p^2}</span> , which means that  <span class="math">\\mathbf{A}_1 &gt; 0.33\\mathbf{M}_1</span> , only  <span class="math">2\\mathbf{A}_1</span>  can be saved (from  <span class="math">\\mathbb{F}_{p^{12}}/\\mathbb{F}_{p^6}</span>  Karatsuba over Chung-Hasan squaring).</p>

    <p class="text-gray-300">Case 2,2,3. We saw that when we compute  <span class="math">(c_0+c_1\\gamma+c_2\\gamma^2)^2</span>  with the Chung-Hasan method  <span class="math">c_0, c_1</span>  and  <span class="math">c_2 \\in \\mathbb{F}_{p^4}</span>  are used twice. For example  <span class="math">c_0</span>  is used in  <span class="math">c_0^2</span>  and in  <span class="math">2c_0c_1</span> , so that precomputing  <span class="math">t_0 = tr_{\\mathbb{F}_{p^4}/\\mathbb{F}_{p^2}}(c_0)</span>  saves one  <span class="math">\\mathbf{A}_2</span> . But, assuming that  <span class="math">c_0 = b_0 + b_1\\beta</span> ,  <span class="math">b_0 \\in \\mathbb{F}_{p^2}</span>  is also used twice (also in  <span class="math">c_0^2</span>  and in  <span class="math">2c_0c_1</span>  whatever the methods used) and precomputing its trace is then interesting if the Karatsuba/complex method is used in  <span class="math">\\mathbb{F}_{p^2}</span> . Moreover for  <span class="math">\\mathbb{F}_{p^4}</span>  Karatsuba or complex operations,  <span class="math">t_0</span>  plays the same role as  <span class="math">b_0</span>  so that precomputing its trace is also interesting. Finally, in this case and if the Karatsuba method is used in  <span class="math">\\mathbb{F}_{p^2}</span> ,  <span class="math">15\\mathbf{A}_1</span>  can be saved in  <span class="math">\\mathbf{S}_{12}</span>  thanks to trace precomputations (6 from the  <span class="math">\\mathbb{F}_{p^4}/\\mathbb{F}_{p^2}</span>  traces of the  <span class="math">c_i</span> , 6 from the  <span class="math">\\mathbb{F}_{p^2}/\\mathbb{F}_p</span>  traces of the  <span class="math">\\mathbb{F}_{p^2}</span>  components of the  <span class="math">c_i</span>  and 3 from the  <span class="math">\\mathbb{F}_{p^2}/\\mathbb{F}_p</span>  traces of the  <span class="math">\\mathbb{F}_{p^2}/\\mathbb{F}_p</span>  traces of the  <span class="math">c_i</span> ). If the Karatsuba method is not used in  <span class="math">\\mathbb{F}_{p^2}</span> , which means that  <span class="math">\\mathbf{A}_1 &gt; 0.33\\mathbf{M}_1</span> , only  <span class="math">6\\mathbf{A}_1</span>  can be saved (from the  <span class="math">\\mathbb{F}_{p^4}/\\mathbb{F}_{p^2}</span>  traces of the  <span class="math">c_i</span> ).</p>

      <h4 id="sec-3.9.4" class="text-lg font-semibold mt-6">3.9.4 Use of precomputed traces in <span class="math">\\mathbb{F}_{p^{12}}</span> sparse multiplications</h4>

    <p class="text-gray-300">The sparse multiplication involved in the Miller loop for the optimal Ate pairing involves schoolbook steps if operands have only one non-zero coefficient. Again, the savings are depending on the way to build  <span class="math">\\mathbb{F}_{p^{12}}</span></p>

    <p class="text-gray-300">Case 2,3,2. Looking at formula (1) given in Section 3.6.2, we can see that</p>

    <ul class="list-disc list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li><span class="math">b_0</span>  is used in  <span class="math">3 \\mathbb{F}_{p^2}</span>  multiplications. Precomputing its trace then saves  <span class="math">2\\mathbf{A}_1</span> ,</li>
      <li><span class="math">b_1</span>  and the third component of  <span class="math">c_1</span>  are used in  <span class="math">2 \\mathbb{F}_{p^2}</span>  multiplications during the sparse product  <span class="math">(b_1 + b_3\\beta)c_1</span> , so  <span class="math">2\\mathbf{A}_1</span>  can be saved,</li>
      <li>The same holds for the sparse product  <span class="math">(b_0 + b_1 + b_3\\beta)(c_0 + c_1)</span> ,</li>
      <li><span class="math">b_3</span>  is used twice in each of these sparse products, so  <span class="math">3\\mathbf{A}_1</span>  can be saved by precomputing  <span class="math">tr_{\\mathbb{F}_{n^2}/\\mathbb{F}_p}(b_3)</span> .</li>
    </ul>

    <p class="text-gray-300">Finally,  <span class="math">9\\mathbf{A}_1</span>  can be saved in the sparse multiplication if traces are precomputed (assuming that the Karatsuba method is used for  <span class="math">\\mathbb{F}_{p^2}</span>  multiplications, <em>i.e.</em> that  <span class="math">\\mathbf{A}_1 \\leq 0.33\\mathbf{M}_1</span> )</p>

    <p class="text-gray-300">Case 2, 2, 3. Looking at formula (2) given in Section 3.7.2, we can see that</p>

    <ul class="list-disc list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li><span class="math">b_0 + b_3\\beta</span>  is used in  <span class="math">2 \\mathbb{F}_{p^4}</span>  multiplication. Precomputing its trace  <span class="math">(b_0 + b_3)</span>  saves  <span class="math">\\mathbf{A}_2</span> ,</li>
      <li>As a consequence of the previous point,  <span class="math">b_0, b_3</span>  and  <span class="math">b_0 + b_3</span>  are used in 2  <span class="math">\\mathbb{F}_{p^2}</span>  multiplications, so  <span class="math">3\\mathbf{A}_1</span>  can be saved,</li>
      <li><span class="math">b_3</span>  is also used in the  <span class="math">\\mathbb{F}_{p^4}</span>  product  <span class="math">(c_0 + c_1)(b_0 + b_1 + b_3\\beta)</span>  so one additional  <span class="math">\\mathbf{A}_1</span>  can be saved,</li>
      <li><span class="math">b_1</span>  is used in  <span class="math">4 \\mathbb{F}_{p^2}</span>  multiplications  <span class="math">(c_2b_1 \\text{ and } c_1b_1)</span>  so  <span class="math">3\\mathbf{A}_1</span>  can be saved by precomputing  <span class="math">tr_{\\mathbb{F}_{n^2}/\\mathbb{F}_p}(b_1)</span> ,</li>
      <li><span class="math">c_2</span>  is used twice (in  <span class="math">c_2b_1</span>  and in  <span class="math">c_2(b_0+b_3\\beta)</span> ) so its  <span class="math">\\mathbb{F}_{p^2}</span>  coefficients are used twice each which saves  <span class="math">2\\mathbf{A}_1</span> .</li>
    </ul>

    <p class="text-gray-300">Finally,  <span class="math">11\\mathbf{A}_1</span>  can be saved in the sparse multiplication if traces are precomputed (assuming that the Karatsuba method is used for  <span class="math">\\mathbb{F}_{p^2}</span>  multiplications, <em>i.e.</em> that  <span class="math">\\mathbf{A}_1 \\leq 0.33\\mathbf{M}_1</span> , otherwise only  <span class="math">2\\mathbf{A}_1</span>  are saved).</p>

    <p class="text-gray-300">In all considered cases, the saving obtained is around 10% of the total number of additions in  <span class="math">\\mathbb{F}_{p^{12}}</span>  operations which is not negligible if the relative cost of an addition compared to a multiplication in  <span class="math">\\mathbb{F}_p</span>  is not small.</p>

      <h4 id="sec-3.9.5" class="text-lg font-semibold mt-6">3.9.5 Use of precomputed traces in the final exponentiation</h4>

    <p class="text-gray-300">Full multiplications in  <span class="math">\\mathbb{F}_{p^{12}}</span>  are only used in the final exponentiation (in the Miller loop, sparse multiplications are used). If the implemented exponentiation parses the exponent from left to right (which is usually the case), then the multiplication steps are performed with one constant term c. Hence, we can precompute and store all the traces depending only on c. Since the Karatsuba method is used at all levels of the extension tower (except in  <span class="math">\\mathbb{F}_{p^2}</span>  if  <span class="math">\\mathbf{A}_1 &gt; 0.33\\mathbf{M}_1</span> ), we will significantly reduce the number of required additions, whatever the way to build  <span class="math">\\mathbb{F}_{p^{12}}</span> .</p>

    <h4 id="sec-misc-4" class="text-lg font-semibold mt-6">Case 2,3,2.</h4>

    <ul class="list-disc list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li><span class="math">\\mathbf{M}_{12}^{\\kappa}</span>  requires the  <span class="math">\\mathbb{F}_{p^{12}}/\\mathbb{F}_{p^6}</span>  trace of c, thus one  <span class="math">\\mathbf{A}_6</span>  can be saved if this trace is already precomputed. It also requires  <span class="math">3\\mathbf{M}_6^{\\kappa}</span>  with one constant term (the 2 coordinates of c and its trace).</li>
      <li>Each  <span class="math">\\mathbf{M}_{6}^{\\kappa}</span>  involving a constant term b requires 3 sums of 2 coordinates of b, thus  <span class="math">3\\mathbf{A}_{2}</span>  can be saved if these sums are precomputed. Hence  <span class="math">9\\mathbf{A}_{2}</span>  are saved at this level. Each  <span class="math">\\mathbf{M}_{6}^{\\kappa}</span>  also requires  <span class="math">6\\mathbf{M}_{2}</span>  with one constant term (the 3 coordinates of b and the 3 sums of 2 coordinates).</li>
      <li>Each  <span class="math">\\mathbf{M}_2^{\\kappa}</span>  involving a constant term a requires the  <span class="math">\\mathbb{F}_{p^2}/\\mathbb{F}_p</span>  trace of a, thus one  <span class="math">\\mathbf{A}_1</span>  can be saved if this trace is precomputed. Hence  <span class="math">18\\mathbf{A}_1</span>  can be saved at this level when the Karatsuba method is used for  <span class="math">\\mathbf{M}_2</span>  (<em>i.e.</em> if  <span class="math">\\mathbf{A}_1 \\leq 0.33\\mathbf{M}_1</span>  according to Section 3.5).</li>
    </ul>

    <h4 id="sec-misc-5" class="text-lg font-semibold mt-6">Case 2,2,3.</h4>

    <ul class="list-disc list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li><span class="math">\\mathbf{M}_{12}^{\\kappa}</span>  requires 3 sums of 2 coordinates of c, thus  <span class="math">3\\mathbf{A}_4</span>  can be saved if these sums are precomputed. It also requires  <span class="math">6\\mathbf{M}_4^{\\kappa}</span>  with one constant term (the 3 coordinates of c and the 3 sums of 2 coordinates).</li>
      <li>Each  <span class="math">\\mathbf{M}_4^K</span>  involving a constant term b requires the  <span class="math">\\mathbb{F}_{p^4}/\\mathbb{F}_{p^2}</span>  trace of b, thus one  <span class="math">\\mathbf{A}_2</span>  can be saved if this trace is precomputed. Hence  <span class="math">6\\mathbf{A}_2</span>  are saved at this level. Each  <span class="math">\\mathbf{M}_4^K</span>  also requires  <span class="math">3\\mathbf{M}_2</span>  with one constant term (the 2 coordinates of b and its trace).</li>
      <li>Again, one  <span class="math">\\mathbf{A}_1</span>  can be saved for each  <span class="math">\\mathbf{M}_2^K</span>  involving a constant term if its trace is precomputed. Hence  <span class="math">18\\mathbf{A}_1</span>  can be saved at this level when the Karatsuba method is used for  <span class="math">\\mathbf{M}_2</span>  (<em>i.e.</em> if  <span class="math">\\mathbf{A}_1 \\leq 0.33\\mathbf{M}_1</span>  according to Section 3.5).</li>
    </ul>

    <p class="text-gray-300">In both cases,  <span class="math">42\\mathbf{A}_1</span>  can be saved for each multiplication in  <span class="math">\\mathbb{F}_{p^{12}}</span>  involving a constant term if its traces are precomputed. This is about 20% of the total number of additions in  <span class="math">\\mathbf{M}_{12}</span>  which is significant if the relative cost of an addition compared to a multiplication in  <span class="math">\\mathbb{F}_p</span>  is not small. If  <span class="math">\\mathbf{A}_1 &gt; 0.33\\mathbf{M}_1</span> , the schoolbook method is used for  <span class="math">\\mathbb{F}_{p^2}</span>  multiplication and only  <span class="math">24\\mathbf{A}_1</span>  are saved in this case.</p>

      <h3 id="sec-3.10" class="text-xl font-semibold mt-8">3.10 Summary of <span class="math">\\mathbb{F}_{p^{12}}</span> arithmetic</h3>

    <p class="text-gray-300">In the previous sections, we explained how to choose the tower field depending on u and on the relative cost of  <span class="math">\\mathbb{F}_p</span>  operations. We also saw that the arithmetic choices to be made are essentially depending on the  <span class="math">\\mathbb{F}_{p^2}</span>  arithmetic. Let us now recapitulate these choices.</p>

      <h4 id="sec-3.10.1" class="text-lg font-semibold mt-6"><strong>3.10.1</strong> The case <span class="math">\\mu = -1</span></h4>

    <p class="text-gray-300">This choice can be made if u is odd and  <span class="math">\\xi</span>  can be chosen &quot;small&quot; in most cases:</p>

    <ul class="list-disc list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li><span class="math">\\xi = 1 + \\mathbf{i}</span>  if u = 7 or 11 modulo 12 and  <span class="math">\\mathbf{m}_{2,\\xi} = 2\\mathbf{A}_1</span> ,</li>
      <li><span class="math">\\xi = 2 + \\mathbf{i}</span>  if u = 1, 3, 13, 27, 33, 37, 41, 57 modulo 60 and  <span class="math">\\mathbf{m}_{2,\\xi} = 2\\mathbf{A}_1 + 2\\mathbf{A}&#x27;_1</span> ,</li>
      <li><span class="math">\\xi = 3 + \\mathbf{i}</span>  if u = 17,39 or 53 modulo 60 and  <span class="math">\\mathbf{m}_{2,\\xi} = 4\\mathbf{A}_1 + 2\\mathbf{A&#x27;}_1</span> .</li>
    </ul>

    <p class="text-gray-300">Let us first assume that  <span class="math">\\mathbf{A}_1 \\leq 0.33\\mathbf{M}_1</span> . In this case, the full  <span class="math">\\mathbb{F}_{p^{12}}</span>  multiplication and the sparse multiplication should be done using Karatsuba arithmetic at all levels of the tower. Concerning the  <span class="math">\\mathbb{F}_{p^{12}}</span>  squaring, the Chung Hasan method should be used for squaring in the degree 3 extension  <span class="math">(\\mathbb{F}_{p^6}/\\mathbb{F}_{p^2})</span>  or  <span class="math">\\mathbb{F}_{p^{12}}/\\mathbb{F}_{p^4}</span>  but all the other multiplications should use the Karatsuba method. The overall complexities are summarized in Table 7. For the complexities using our new improvements given in Section 3.9, we assumed that  <span class="math">\\mathbf{M}_{12}</span>  is only used in the final exponentiation and  <span class="math">\\mathbf{sM}_{12}</span>  is only used in the Miller loop (which is always the case in practice). We also assumed for simplifying that the  <span class="math">\\xi - 1</span>  trick saves  <span class="math">2\\mathbf{A}_1</span>  whatever the choice of  <span class="math">\\xi</span>  (in fact it saves  <span class="math">2\\mathbf{A}&#x27;_1</span>  instead of  <span class="math">2\\mathbf{A}_1</span>  if  <span class="math">\\xi = 2 + \\mathbf{i}</span> ). An interesting point is that, if our improvements are used, the results given in Table 7 also hold if  <span class="math">\\mathbf{A}_1 &gt; 0.33\\mathbf{M}_1</span>  (because less additions are required). Finally, in this table (as well as in the following ones), K, CH, SB and  <span class="math">\\mathbb C</span>  denote the methods used for arithmetic and  <span class="math">\\mathbb SB/\\mathbb C</span>  means that the schoolbook method is used for multiplications and the complex method is used for squarings.</p>

    <div class="overflow-x-auto my-4">
      <table class="min-w-full text-sm text-gray-300">
        <thead>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">Oper-<br>ation</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">Case</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">A&#305;</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">rithme</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">etic use</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">ed</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">Number of operations without/with improvement</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"></th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"></th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"></th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"></th>
        </thead>
        <tbody>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">ation</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">\\mathbb{F}_{p^2}</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">\\mathbb{F}_{p^4}</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">\\mathbb{F}_{p^6}</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">\\mathbb{F}_{p^{12}}</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">\\mathbf{M}_1</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">\\mathbf{A}_1</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">\\mathbf{A&#x27;}_1</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">\\mathbf{m}_{2,\\xi}</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">\\mathbf{M}_{12}</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">2, 3, 2</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">K</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">K</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">K</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">54</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">210/162</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">0</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">7</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-12</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">2, 2, 3</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">K</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">210/156</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">8</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">\\mathbf{sM}_{12}</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">2, 3, 2</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">K</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">K</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">K</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">39</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">115/106</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">0</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">3</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">517172</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">2, 2, 3</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">K</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">117/100</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">4</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">\\mathbf{S}_{12}</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">2, 3, 2</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">\\mathrm{K}/\\mathbb{C}</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">&#1057;&#1053;</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">K</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">36</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">120/109</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">15</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">7</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">2, 2, 3</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">IX/C</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">K</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">&#1057;&#1053;</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">124/99</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">13</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
        </tbody>
      </table>
    </div>

    <p class="text-gray-300">Table 7:  <span class="math">\\mathbb{F}_{p^{12}}</span>  complexities if  <span class="math">\\mu=-1</span>  (assuming  <span class="math">\\mathbf{A}_1\\leq 0.33\\mathbf{M}_1</span>  if our new improvements are not used)</p>

    <p class="text-gray-300">Remark 7. We can see that, if our new improvements are not used, it is slightly better to choose a 2,3,2 extension tower. This is in accordance with the state of</p>

    <p class="text-gray-300">the art (see [20, 14, 3, 27] for example). However, our improvements take more advantage of a 2, 2, 3 extension tower and then this way to build  <span class="math">\\mathbb{F}_{p^{12}}</span>  becomes the one to choose.</p>

    <p class="text-gray-300">The other cases are quite similar so we are only giving the final complexities in tables. Let us first give in Table 8 the  <span class="math">\\mathbb{F}_{p^{12}}</span>  complexities if  <span class="math">\\mathbf{A}_1 &gt; 0.33\\mathbf{M}_1</span> .</p>

    <div class="overflow-x-auto my-4">
      <table class="min-w-full text-sm text-gray-300">
        <thead>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">Oper-<br>ation</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">Case</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">Ar</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">ithmet</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">ic use</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">d</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">Number of operations</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"></th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"></th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"></th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"></th>
        </thead>
        <tbody>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">ation</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Case</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">\\mathbb{F}_{p^2}</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">\\mathbb{F}_{p^4}</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">\\mathbb{F}_{p^6}</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">\\mathbb{F}_{p^{12}}</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">\\mathbf{M}_1</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">\\mathbf{A}_1</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">\\mathbf{A&#x27;}_1</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">\\mathbf{m}_{2,\\xi}</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">\\mathbf{M}_{12}</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">2, 3, 2</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">SB</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">K</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">K</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">72</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">156</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">0</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">7</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">IVI <sub>12</sub></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">2, 2, 3</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">30</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">K</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">12</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">156</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">U</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">8</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">\\mathbf{sM}_{12}</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">2, 3, 2</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">SB</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">K</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">K</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">52</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">76</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">0</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">3</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">SIVI12</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">2, 2, 3</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">00</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">K</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">11</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">52</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">78</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">4</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">\\mathbf{S}_{12}</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">2, 3, 2</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">SB/C</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">&#1057;&#1053;</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">K</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">42</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">102</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">15</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">7</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1012</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">2, 2, 3</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">&#1506;&#1504;&#1496;</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">K</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">&#1057;&#1053;</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">42</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">106</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">13</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><b>'</b></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
        </tbody>
      </table>
    </div>

    <p class="text-gray-300">Table 8:  <span class="math">\\mathbb{F}_{p^{12}}</span>  complexities if  <span class="math">\\mu=-1</span>  assuming our improvements are not used and  <span class="math">\\mathbf{A}_1&gt;0.33\\mathbf{M}_1</span></p>

      <h4 id="sec-3.10.2" class="text-lg font-semibold mt-6"><strong>3.10.2</strong> The case <span class="math">\\mu = -2</span></h4>

    <p class="text-gray-300">This choice should be made if the previous one cannot, in the case where u=2 modulo 4. Tables 9 and 10 give the complexities of  <span class="math">\\mathbb{F}_{p^{12}}</span>  operations when  <span class="math">\\xi=\\sqrt{-2}</span>  (which means, according to Section 3.8, that u=2 or 10 modulo 12) and when  <span class="math">\\xi=2+\\sqrt{-2}</span>  (which means that u=6 or 30 modulo 36 but not 18).</p>

    <div class="overflow-x-auto my-4">
      <table class="min-w-full text-sm text-gray-300">
        <thead>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">Oper-<br>ation</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">Case</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">A&#305;</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">rithme</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">etic use</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">ed</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"><span class="math">\\begin{array}{ll} {\\rm Number~of~operations} \\\\ {\\rm without/with~improvement} \\end{array}</span></th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"></th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"></th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"></th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"></th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"></th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"></th>
        </thead>
        <tbody>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">801011</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Case</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">&#1098;&#1083;</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">if <span class="math">\\xi = \\sqrt{1}</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">\\sqrt{-2}</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">if <span class="math">\\xi = 2 + \\sqrt{-2}</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">\\mathbb{F}_{p^2}</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">\\mathbb{F}_{p^4}</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">\\mathbb{F}_{p^6}</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">\\mathbb{F}_{p^{12}}</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">\\mathbf{M}_1</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">\\mathbf{A}_1</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">\\mathbf{A&#x27;}_1</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">\\mathbf{A}_1</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">\\mathbf{A&#x27;}_1</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">\\mathbf{M}_{12}</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">2, 3, 2</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">K</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">K</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">K</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">54</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">210/168</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">25</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">224/182</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">32/29</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1112</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">2, 2, 3</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">K</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">210/168</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">26</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">226/184</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">34/28</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">\\mathbf{sM}_{12}</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">2, 3, 2</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">K</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">I/</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">K</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">K</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">39</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">115/106</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">16</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">121/112</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">19</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">S1V112</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-12   2,2,3   K   K   38</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">- <del>5</del> 9</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">117/106</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">17</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">125/114</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">21/18</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">\\mathbf{S}_{12}</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">2, 3, 2</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">\\frac{2}{2}</span> K/C</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">&#1057;&#1053;</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">K</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">36</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">129/118</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">37</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">143/132</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">44</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">\\mathbf{S}_{12}</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">2, 2, 3</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">11/</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">K</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">CH 30</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">- 50</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">133/118</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">35</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">147/132</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">42/37</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
        </tbody>
      </table>
    </div>

    <p class="text-gray-300">Table 9:  <span class="math">\\mathbb{F}_{p^{12}}</span>  complexities if  <span class="math">\\mu=-2</span>  (assuming  <span class="math">\\mathbf{A}_1\\leq 0.33\\mathbf{M}_1</span>  if our improvements are not used)</p>

    <div class="overflow-x-auto my-4">
      <table class="min-w-full text-sm text-gray-300">
        <thead>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">Oper</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"></th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">,</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">\\rithmo</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">tic 1150</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">nd.</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">Number of operations</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"></th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"></th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"></th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"></th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"></th>
        </thead>
        <tbody>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Oper-<br>ation</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Case</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Arithmetic used</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">\\mathbf{M}_1</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">if <span class="math">\\xi = \\sqrt{-2}</span> if <span class="math">\\xi = 2 + \\sqrt{-2}</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">= 2 + \\sqrt{-2}</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">\\mathbb{F}_{p^2}</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">\\mathbb{F}_{p^4}</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">\\mathbb{F}_{p^6}</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">\\mathbb{F}_{p^{12}}</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1011</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">\\mathbf{A}_1</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">\\mathbf{A&#x27;}_1</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">\\mathbf{A}_1</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">\\mathbf{A&#x27;}_1</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">\\mathbf{M}_{12}</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">2, 3, 2</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">SB</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">K</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">K</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">72</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">156</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">25</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">170</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">32</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1112</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">2, 2, 3</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">K</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">156</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">26</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">172</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">34</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">\\mathbf{sM}_{12}</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">2, 3, 2</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">SB</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">K</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">K</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">52</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">76</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">16</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">82</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">19</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">S1V112</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">2, 2, 3</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">K</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">78</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">17</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">86</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">21</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">\\mathbf{S}_{12}</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">2, 3, 2</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">SB</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">K</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">\\mathbb{C}</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">48</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">108</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">24</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">120</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">30</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">s_1=M_1</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">2, 2, 3</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">&#1101;&#1074;</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">K/\\mathbb{C}</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">&#1057;&#1053;</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">40</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">106</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">32</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">126</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">42</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">\\mathbf{S}_{12}</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">2, 3, 2</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">SB</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">&#1057;&#1053;</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">K</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">47.4</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">93</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">37</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">107</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">44</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">s_1=0.8M_1</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">2, 2, 3</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">&#1513;&#1496;</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">K</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">&#1057;&#1053;</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">41.4</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">97</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">35</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">111</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">40</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
        </tbody>
      </table>
    </div>

    <p class="text-gray-300">Table 10:  <span class="math">\\mathbb{F}_{p^{12}}</span>  complexities if  <span class="math">\\mu=-2</span>  assuming our improvements are not used and  <span class="math">\\mathbf{A}_1&gt;0.33\\mathbf{M}_1</span></p>

      <h4 id="sec-3.10.3" class="text-lg font-semibold mt-6"><strong>3.10.3</strong> The case <span class="math">\\mu = -5</span></h4>

    <p class="text-gray-300">This choice should be made if the previous ones cannot, in the case where u=8,12 or 16 modulo 20. Tables 11 and 12 give the complexities of  <span class="math">\\mathbb{F}_{p^{12}}</span>  operations when  <span class="math">\\xi=\\sqrt{-5}</span>  which means, according to Section 3.8, that u=12,16,28,48,52 or 56 modulo 60 (but not 8,32 or 36).</p>

    <div class="overflow-x-auto my-4">
      <table class="min-w-full text-sm text-gray-300">
        <thead>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">Oper-<br>ation</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">Case</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">A&#305;</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"><span class="math">\\operatorname{rithm} \\epsilon</span></th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">tic use</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">ed</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">Number of operations without/with improvement</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"></th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"></th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"></th>
        </thead>
        <tbody>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">\\mathbb{F}_{p^2}</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">\\mathbb{F}_{p^4}</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">\\mathbb{F}_{p^6}</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">\\mathbb{F}_{p^{12}}</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">\\mathbf{M}_1</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">\\mathbf{A}_1</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">\\mathbf{A&#x27;}_1</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">\\mathbf{M}_{12}</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">2, 3, 2</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">K</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">K</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">K</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">54</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">225/183</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">50</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">IVI <sub>12</sub></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">2, 2, 3</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">K</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">226/184</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">52</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">\\mathbf{sM}_{12}</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">2, 3, 2</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">K</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">K</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">K</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">39</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">131/122</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">32</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">SIVI <sub>12</sub></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">2, 2, 3</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">K</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">&#305;x</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">39</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">134/123</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">34</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">\\mathbf{S}_{12}</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">2, 3, 2</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">\\mathrm{K}/\\mathbb{C}</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">&#1057;&#1053;</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">K<br>CH</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">36</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">151/140</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">50</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">2, 2, 3</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">K/C</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">K</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">30</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">155/140</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">48</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
        </tbody>
      </table>
    </div>

    <p class="text-gray-300">Table 11:  <span class="math">\\mathbb{F}_{p^{12}}</span>  complexities if  <span class="math">\\mu = -5</span>  (assuming  <span class="math">\\mathbf{A}_1 \\leq 0.33\\mathbf{M}_1</span>  if our improvements are not used)</p>

    <div class="overflow-x-auto my-4">
      <table class="min-w-full text-sm text-gray-300">
        <thead>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">Oper-<br>ation</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">Case</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">Ar</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">ithmet</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">ic use</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">d</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">Number of operations</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"></th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"></th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"></th>
        </thead>
        <tbody>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">ation</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Case</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">\\mathbb{F}_{p^2}</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">\\mathbb{F}_{p^4}</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">\\mathbb{F}_{p^6}</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">\\mathbb{F}_{p^{12}}</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">\\mathbf{M}_1</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">\\mathbf{A}_1</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">\\mathbf{A&#x27;}_1</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">\\mathbf{M}_{12}</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">2, 3, 2</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">SB</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">K</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">K</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">72</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">181</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">50</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1 <b>V1</b> 12</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">2, 2, 3</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">) D</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">K</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">IX.</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">14</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">182</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">52</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">\\mathbf{sM}_{12}</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">2, 3, 2</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">SB</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">K</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">K</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">52</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">92</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">32</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><b>SIVI</b> 12</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">2, 2, 3</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">K</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">95</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">34</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">\\mathbf{S}_{12}</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">2, 3, 2</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">\\mathrm{SB}/\\mathbb{C}</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">&#1057;&#1053;</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">K</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">42</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">133</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">50</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">\\mathbf{S}_{12}</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">2, 2, 3</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">2D/C</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">K</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">&#1057;&#1053;</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">42</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">137</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">48</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
        </tbody>
      </table>
    </div>

    <p class="text-gray-300">Table 12:  <span class="math">\\mathbb{F}_{p^{12}}</span>  complexities if  <span class="math">\\mu=-5</span>  assuming our improvements are not used and  <span class="math">\\mathbf{A}_1&gt;0.33\\mathbf{M}_1</span></p>

      <h4 id="sec-3.10.4" class="text-lg font-semibold mt-6">3.10.4 The case <span class="math">\\mu</span> large</h4>

    <p class="text-gray-300">This choice should be made if u=0 or 4 modulo 20 and we assume that  <span class="math">\\xi=\\sqrt{\\mu}</span>  since it is always possible to choose such a  <span class="math">\\mu</span> . In this case, we have  <span class="math">\\mathbf{m}_{1,\\mu}=\\mathbf{m}_{2,\\xi}=\\mathbf{M}_1</span>  and the complexities of  <span class="math">\\mathbb{F}_{p^{12}}</span>  operations are given in Tables 13 and 14.</p>

    <div class="overflow-x-auto my-4">
      <table class="min-w-full text-sm text-gray-300">
        <thead>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">Oper-<br>ation</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">Case</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">Arithmetic used</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"></th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"></th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"></th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">Number of operations without/with improvement</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"></th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"></th>
        </thead>
        <tbody>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">ation</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">\\mathbb{F}_{p^2}</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">\\mathbb{F}_{p^4}</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">\\mathbb{F}_{p^6}</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">\\mathbb{F}_{p^{12}}</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">\\mathbf{M}_1</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">\\mathbf{A}_1</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">\\mathbf{A&#x27;}_1</span></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">\\mathbf{M}_{12}</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">2, 3, 2</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">K</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">K</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">K</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">79</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">210/168</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">0</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">2, 2, 3</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">17</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">K</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">117</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">80</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">210/168</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">\\mathbf{sM}_{12}</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">2, 3, 2</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">K</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">K</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">K</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">55</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">115/106</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">0</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">2, 2, 3</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">K</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">56</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">117/106</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">\\mathbf{S}_{12}</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">2, 3, 2</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">&#1050;</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">K</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">\\mathbb{C}</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">54</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">144/133</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">6</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">2, 2, 3</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">K/\\mathbb{C}</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">&#1057;&#1053;</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">58</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">142/127</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">10</td>
          </tr>
        </tbody>
      </table>
    </div>

    <p class="text-gray-300">Table 13:  <span class="math">\\mathbb{F}_{p^{12}}</span>  complexities if  <span class="math">\\mu</span>  is large (assuming  <span class="math">\\mathbf{A}_1 \\leq 0.33\\mathbf{M}_1</span>  if our improvements are not used)</p>

    <div class="overflow-x-auto my-4">
      <table class="min-w-full text-sm text-gray-300">
        <thead>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">Oper-</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"></th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">Arithmetic used</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"></th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"></th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"></th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">Number of operations</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"></th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"></th>
        </thead>
        <tbody>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">ation</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Case</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">\\mathbb{F}_{p^2}</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">\\mathbb{F}_{p^4}</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">\\mathbb{F}_{p^6}</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">\\mathbb{F}_{p^{12}}</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">\\mathbf{M}_1</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">\\mathbf{A}_1</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">\\mathbf{A&#x27;}_1</span></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">\\mathbf{M}_{12}</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">2, 3, 2</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">SB</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">K</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">K</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">97</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">156</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">0</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1112</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">2, 2, 3</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">&#1513;&#1496;</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">K</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">17</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">98</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">190</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">\\mathbf{sM}_{12}</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">2, 3, 2</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">SB</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">K</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">K</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">68</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">76</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">0</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">SIVI12</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">2, 2, 3</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">&#1513;&#1496;</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">K</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">11</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">69</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">78</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">\\mathbf{S}_{12}</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">2, 3, 2</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">SB</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">K</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">\\mathbb{C}</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">66</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">108</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">6</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">s_1=M_1</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">2, 2, 3</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">&#1501; &#1504;&#1493;</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">K/\\mathbb{C}</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">&#1057;&#1053;</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">70</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">106</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">10</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">\\mathbf{S}_{12}</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">2, 3, 2</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">SB</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">K</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">\\mathbb{C}</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">66</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">108</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">6</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">s_1=M_1</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">2, 2, 3</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">&#1501; &#1504;&#1493;</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">K/SB</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">&#1057;&#1053;</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">73.6</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">82</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">16</td>
          </tr>
        </tbody>
      </table>
    </div>

    <p class="text-gray-300">Table 14:  <span class="math">\\mathbb{F}_{p^{12}}</span>  complexities if  <span class="math">\\mu</span>  is large assuming our improvements are not used and  <span class="math">\\mathbf{A}_1 &gt; 0.33\\mathbf{M}_1</span></p>

      <h4 id="sec-3.10.5" class="text-lg font-semibold mt-6">3.10.5 Some remarks</h4>

    <p class="text-gray-300">Looking at these tables, we can make some interesting remarks:</p>

    <ul class="list-disc list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li><p class="text-gray-300">As noticed in Remark 7 building  <span class="math">\\mathbb{F}_{p^{12}}</span>  with a 2, 3, 2 tower remains preferable in most cases to a 2, 2, 3 tower if our new improvements are not used but this is no longer the case if there are used. Anyway, the difference between the complexities of the two choices for building  <span class="math">\\mathbb{F}_{p^{12}}</span>  is negligible.</p></li>
      <li><p class="text-gray-300">As already mentioned, the choice of  <span class="math">\\mu</span>  has a great influence on the number of additions involved in  <span class="math">\\mathbb{F}_{p^{12}}</span>  arithmetic, so it should be chosen first, even if the choice of  <span class="math">\\xi</span>  is not optimal in this case. For example, it is better to take  <span class="math">\\mu = -2, \\xi = 2 + \\sqrt{-2}</span>  than  <span class="math">\\mu = -5, \\xi = \\sqrt{-5}</span> .</p></li>
      <li><p class="text-gray-300">Our new improvements have a significant impact on  <span class="math">\\mathbb{F}_{p^{12}}</span>  arithmetic if  <span class="math">\\mathbb{F}_p</span>  additions are costly which, as explained in Section 3.1, is often the case in low level implementations. For example if  <span class="math">\\mathbf{A}_1 = 0.25\\mathbf{M}_1</span>  (which is probably not far from the average cost of additions in hardware implementations), our improvements are providing a gain between 6 and 13% on  <span class="math">\\mathbb{F}_{p^{12}}</span>  arithmetic (and then on pairing computation). In fact the gain is even not so negligible if  <span class="math">\\mathbb{F}_p</span>  additions are cheap (like in software implementations). For example, if  <span class="math">\\mathbf{A}_1 = 0.1\\mathbf{M}_1</span> , it is between 3 and 7%.</p></li>
      <li><p class="text-gray-300">The cost of  <span class="math">\\mathbb{F}_p</span>  squaring (with respect to  <span class="math">\\mathbb{F}_p</span>  multiplication) and  <span class="math">\\mathbb{F}_p</span>  doubling (with respect to  <span class="math">\\mathbb{F}_p</span>  addition) have very few impact on the choices to be made for  <span class="math">\\mathbb{F}_{p^{12}}</span>  arithmetic.</p></li>
    </ul>

    <p class="text-gray-300">The parameter u is involved at several levels of the pairing computation, so that the best choice is not trivial to do. Let us summarize the constraints on u that we have to deal with in order to make a good choice.</p>

    <ul class="list-disc list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li>The parameter u is defining the security level. Indeed, it is both parametrizing the size of the elliptic curve (whose prime order is  <span class="math">36u^4 + 36u^3 + 18u^2 + 6u + 1</span> ) and the number of elements of the target finite field (which is  <span class="math">(36u^4 + 36u^3 + 24u^2 + 6u + 1)^{12}</span> ).</li>
      <li>It is involved as an exponent in the Miller loop. More precisely, in the case of an optimal Ate pairing, the exponent of the Miller loop is 6u + 2. In order to optimize this step, u should be chosen such that 6u + 2 is sparse.</li>
      <li>It is involved as an exponent in the final exponentiation. If the addition chain given in Section 2.4 is used, u is directly used (three times) as an exponent, so it should be sparse to ensure a fast final exponentiation. Other final exponentiation methods may involve exponentiations by 6u+5 and  <span class="math">6u^2+1</span>  [21, 23] or 6u+4 [23] but these quantities are usually sparse at the same time as u.</li>
      <li>The sign of u has no consequence in terms of complexities of the algorithms involved. Indeed, changing u in -u costs an  <span class="math">\\mathbb{F}_{p^{12}}</span>  inversion, but this inversion can be replaced by a conjugation in  <span class="math">\\mathbb{F}_{p^{12}}/\\mathbb{F}_{p^6}</span>  thanks to the final exponentiation.</li>
      <li>Choosing u with a signed binary representation (to facilitate the research of a sparse u) is possible if the exponentiation algorithms are adapted.</li>
      <li>The choice of u has a great impact on  <span class="math">\\mathbb{F}_{p^{12}}</span>  arithmetic. The work done in Section 3 shows that the choice of the extension tower is a direct consequence of the value of u modulo 12, 20, 36 or 60. It is summarized in Table 4. The best choice is u=7 or 11 modulo 12 so that we can use  <span class="math">\\mu=-1</span>  and  <span class="math">\\xi=1+\\mathbf{i}</span> . Depending on the situation, it could be better to choose a</li>
    </ul>

    <p class="text-gray-300">sparser  <span class="math">u \\neq 7,11</span>  modulo 12 or reciprocally a u of higher Hamming weight but congruent to 7 or 11 modulo 12.</p>

    <p class="text-gray-300">Hence u should be chosen as sparse as possible and with the best possible way to build  <span class="math">\\mathbb{F}_{p^{12}}</span> . Moreover, its size must ensure the right security level. For example, at the 128-bit security level, u should be a 63-bit integer. A 95-bit integer provides a 192-bit security level on the elliptic curve but not in  <span class="math">\\mathbb{F}_{p^{12}}</span> . To get this level of security, a 169 or 170-bit integer u should be chosen.</p>

    <p class="text-gray-300">Thanks to the results of Section 3.8, finding an appropriate value of u can be easily done by an exhaustive search with any software which is able to check integer's primality. Unfortunately, only few values of u with very low Hamming weight can be found. The best choice at the 128-bit security level is given by  <span class="math">u=-2^{61}-2^{55}-1</span>  [44], even if it is ensuring a slightly smaller security level than 128. It has weight 3 and is congruent to 11 modulo 12, so that  <span class="math">\\mu=-1</span>  and  <span class="math">\\xi=1+\\mathbf{i}</span>  can be used to build  <span class="math">\\mathbb{F}_{p^{12}}</span>  (and to twist the curve). For these reasons, it is widely used in the literature. However, relaxing the constraint on the weight of u allows to generate many good values of u (of weight 4,5 or 6 for example) that can be used in a database of pairing friendly parameters or for higher (or smaller) security levels.</p>

      <h3 id="sec-5.1" class="text-xl font-semibold mt-8">5.1 Choosing the elliptic curve</h3>

    <p class="text-gray-300">Choosing the curve is not difficult once u is chosen. Indeed, the base field  <span class="math">\\mathbb{F}_p</span>  and the cardinality of the curve r are fixed by the BN parametrisation given in Section 2.1. Then, we only have to find  <span class="math">b \\in \\mathbb{F}_p</span>  such that the curve defined by the equation</p>

    <p class="text-gray-300"><span class="math">$E: y^2 = x^3 + b</span>$</p>

    <p class="text-gray-300">has cardinality r. Because of the form of the equation and of the existence of a sextic twist, there are only 6 isomorphism classes over  <span class="math">\\mathbb{F}_p</span> . So, if b is randomly chosen, there is about one chance in 6 that  <span class="math">\\#E(\\mathbb{F}_p) = r</span> . Checking the cardinality is easily done by verifying that  <span class="math">rP = O_E</span>  for some  <span class="math">P \\in E(\\mathbb{F}_p)</span> .</p>

    <p class="text-gray-300">Remark 8. We will see in Section 6 that the coefficient b is involved in the elliptic curve arithmetic, so that it is better to choose it small.</p>

    <p class="text-gray-300">However, E is not the only curve to choose, we also have to choose its twist E'. If  <span class="math">\\xi</span>  is the  <span class="math">\\mathbb{F}_{p^2}</span>  element chosen to define  <span class="math">\\mathbb{F}_{p^{12}}</span> , E' is defined over  <span class="math">\\mathbb{F}_{p^2}</span>  by the equation</p>

    <p class="text-gray-300"><span class="math">$y^2 = x^3 + b&#x27;,</span>$</p>

    <p class="text-gray-300">where  <span class="math">b&#x27; = b/\\xi</span>  or  <span class="math">b&#x27; = b\\xi</span> , such that r divides the cardinality of E'. This is the case for exactly one of the two choices for b' [2]. Again, the correct choice for b' is done by checking the cardinality of E', thanks to some point in  <span class="math">E&#x27;(\\mathbb{F}_{p^2})</span> .</p>

    <p class="text-gray-300">Since  <span class="math">E(\\mathbb{F}_p)</span>  has prime order, it is naturally protected against subgroup attacks which exploit small prime divisors of the cofactor [38]. However, this is not the case of  <span class="math">E&#x27;(\\mathbb{F}_{p^2})</span>  whose order equals r(2p-r). For example, the value of u given in Section 4, and usually used in the literature for the 128-bit security level, is not naturally protected against subgroup attacks. This can be prevented by using (possibly expensive) membership tests. If we want to avoid these tests, the parameter u should be chosen such that both r and 2p-r are prime numbers [5].</p>

      <h3 id="sec-5.2" class="text-xl font-semibold mt-8">5.2 Choosing the generators</h3>

    <p class="text-gray-300">In this section, we present an explicit method to construct the points P and Q potentially involved in the optimal Ate pairing computations. Since  <span class="math">E(\\mathbb{F}_p)</span>  has prime order r, it is trivial to find a suitable candidate for P: any point  <span class="math">P \\neq O_E</span>  has order r.</p>

    <p class="text-gray-300">However, generating a suitable point Q seems less easy because it must be of order r in  <span class="math">E\\left(\\mathbb{F}_{p^{12}}\\right)</span> , come from the twisted curve and be an eigenvector for the eigenvalue p of the Frobenius map. In fact, it is not so difficult because the last condition is a consequence of the other ones [29]. Finding a suitable point Q is then done in the following way:</p>

    <ul class="list-disc list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li><ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li>Choose a random point Q' in  <span class="math">E&#x27;(\\mathbb{F}_{p^2})</span> .</li>
    </ol></li>
      <li><ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li>If Q' has not order r (which is statistically always the case), replace it by (p-2r)Q' which has order r since  <span class="math">\\#E&#x27;(\\mathbb{F}_{p^2})=(p-2r)r</span> .</li>
    </ol></li>
      <li><ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li>If  <span class="math">Q&#x27; = O_{E&#x27;}</span>  then repeat steps 1 and 2.</li>
    </ol></li>
      <li><ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li>Map Q' to  <span class="math">E\\left(\\mathbb{F}_{p^{12}}\\right)</span>  thanks to the twist isomorphism between E and E' over  <span class="math">\\mathbb{F}_{p^{12}}</span> . If  <span class="math">b&#x27;=b/\\xi</span>  this is nothing but</li>
    </ol></li>
    </ul>

    <p class="text-gray-300"><span class="math">$Q = (x_{Q&#x27;}\\gamma^2, y_{Q&#x27;}\\gamma^3) \\text{ if } \\gamma^6 = \\xi.</span>$</p>

    <p class="text-gray-300">Then Q is a valuable candidate, in particular it lies in the p-eigenspace of  <span class="math">\\pi</span> .</p>

    <p class="text-gray-300">In this section, we give the formulas for adding and doubling points on BN curves (with the line computation) and their complexities in the affine and the projective cases (it is now well known that Jacobian coordinates are always less efficient than projective coordinates for pairing computations [18]). This allows to determine which system of coordinates should be chosen, depending on the context. Assuming the previous choices, the two operations involved in the Miller loop are</p>

    <p class="text-gray-300">The doubling step. In this step, we have to</p>

    <ul class="list-disc list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li>double a temporary point  <span class="math">T = (x_T \\gamma^2, y_T \\gamma^3) \\in E(\\mathbb{F}_{p^{12}})</span>  with  <span class="math">x_T, y_T \\in \\mathbb{F}_{p^2}</span> ,</li>
      <li>compute the tangent line to E at T,</li>
      <li>evaluate it at  <span class="math">P = (x_P, y_P) \\in E(\\mathbb{F}_p)</span> .</li>
    </ul>

    <p class="text-gray-300">The addition step In this step, we have to</p>

    <ul class="list-disc list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li>add  <span class="math">Q = (x_Q \\gamma^2, y_Q \\gamma^3)</span>  and  <span class="math">T = (x_T \\gamma^2, y_T \\gamma^3)</span>  in  <span class="math">E(\\mathbb{F}_{p^{12}})</span>  with  <span class="math">x_Q, y_Q, x_T, y_T \\in \\mathbb{F}_{p^2}</span> ,</li>
      <li>compute the line passing through T and Q,</li>
      <li>evaluate it at  <span class="math">P = (x_P, y_P) \\in E(\\mathbb{F}_p)</span> .</li>
    </ul>

      <h3 id="sec-6.1" class="text-xl font-semibold mt-8">6.1 Affine coordinates</h3>

    <p class="text-gray-300">The slope of the line passing through T and Q (or the tangent line at T if T=Q) is  <span class="math">\\lambda \\gamma</span> , with</p>

    <p class="text-gray-300"><span class="math">$\\lambda = \\frac{y_T - y_Q}{x_T - x_Q} \\quad \\left( \\text{ or } \\quad \\lambda = \\frac{3x_T^2}{2y_T} \\right).</span>$</p>

    <p class="text-gray-300">Then T+Q (or 2T) can be written in the form  <span class="math">\\left(x_{T+Q}\\gamma^2,y_{T+Q}\\gamma^3\\right)</span>  with</p>

    <p class="text-gray-300"><span class="math">$x_{T+Q} = \\lambda^2 - x_T - x_Q</span>$
and  <span class="math">y_{T+Q} = \\lambda (x_T - x_{T+Q}) - y_T</span> .</p>

    <p class="text-gray-300">The equation of the line involved in the operation is  <span class="math">y = \\lambda \\gamma (x - x_T \\gamma^2) - y_T \\gamma^3</span> , thus the  <span class="math">\\mathbb{F}_{p^{12}}</span>  element involved in the update of f in Algorithm 1 is</p>

    <p class="text-gray-300"><span class="math">$\\ell = y_P - \\lambda x_P \\gamma + (\\lambda x_T - y_T) \\gamma^3.</span>$</p>

    <p class="text-gray-300">Assuming that  <span class="math">-x_P</span>  is precomputed, the cost of the addition step (including the line computation) is then  <span class="math">\\mathbf{I}_2 + 3\\mathbf{M}_2 + \\mathbf{S}_2 + 2\\mathbf{M}_1 + 7\\mathbf{A}_2</span>  and the cost of the doubling step is  <span class="math">\\mathbf{I}_2 + 3\\mathbf{M}_2 + 2\\mathbf{S}_2 + 2\\mathbf{M}_1 + 5\\mathbf{A}_2 + 2\\mathbf{A}&#x27;_2</span> .</p>

    <p class="text-gray-300">Remark 9. Since  <span class="math">\\lambda</span>  is used three times in  <span class="math">\\mathbb{F}_{p^2}</span>  operations  <span class="math">(\\lambda^2, \\lambda(x_T - x_{T+Q})</span>  and  <span class="math">\\lambda x_T)</span> ,  <span class="math">2\\mathbf{A}_1</span>  can be saved using our idea of precomputing its trace if the Karatsuba/complex methods are used for  <span class="math">\\mathbb{F}_{p^2}</span>  arithmetic. In the same way,  <span class="math">x_T</span>  is used twice in the doubling step so that an additional  <span class="math">\\mathbf{A}_1</span>  can be saved in this case.</p>

      <h3 id="sec-6.2" class="text-xl font-semibold mt-8">6.2 Projective coordinates</h3>

    <p class="text-gray-300">In order to avoid inversions in  <span class="math">\\mathbb{F}_{p^2}</span> , projective coordinates are used for the point T, so that  <span class="math">T = (X_T \\gamma^2, Y_T \\gamma^3, Z_T)</span>  with  <span class="math">X_T, Y_T</span>  and  <span class="math">Z_T \\in \\mathbb{F}_{p^2}</span> . However, the</p>

    <p class="text-gray-300">point Q is kept in affine coordinates (mixed addition method). According to [18],  <span class="math">2T = (X_{2T}\\gamma^2, Y_{2T}\\gamma^3, Z_{2T})</span>  with</p>

    <p class="text-gray-300"><span class="math">$\\begin{array}{rcl} X_{2T} &amp; = &amp; 2X_TY_T(Y_T^2 - 9bZ_T^2) \\\\ Y_{2T} &amp; = &amp; \\left(Y_T^2 + 9bZ_T^2\\right)^2 - 12(3bZ_T^2)^2 \\\\ Z_{2T} &amp; = &amp; 8Y_T^3Z_T \\end{array}</span>$</p>

    <p class="text-gray-300">and the equation of the tangent to the curve at T is (up to some subfield multiple)</p>

    <p class="text-gray-300"><span class="math">$\\ell = 2y_P Y_T Z_T - 3x_P X_T^2 \\gamma + (Y_T^2 - 3b Z_T^2) \\gamma^3.</span>$</p>

    <p class="text-gray-300">Assuming that  <span class="math">-3x_P</span>  is precomputed, the doubling step (including the line computation) then requires  <span class="math">2\\mathbf{M}_2 + 7\\mathbf{S}_2 + 4\\mathbf{M}_1 + 13\\mathbf{A}_2 + 5\\mathbf{A}&#x27;_2 + 2\\mathbf{m}_{1,b}</span> . In order to obtain this complexity, the double products like  <span class="math">2X_TY_T</span>  are computed by  <span class="math">(X_T + Y_T)^2 - X_T^2 - Y_T^2</span> . This trick is not always interesting over  <span class="math">\\mathbb{F}_p</span>  (e.g. if  <span class="math">\\mathbf{M}_1 = \\mathbf{S}_1</span> ) but it is always interesting over  <span class="math">\\mathbb{F}_{p^2}</span>  because  <span class="math">\\mathbf{S}_2</span>  is clearly cheaper than  <span class="math">\\mathbf{M}_2</span>  according to Section 3.5.</p>

    <p class="text-gray-300">In the same way, if</p>

    <p class="text-gray-300"><span class="math">$N = Y_T - y_Q Z_T,</span>$</p>

    <p class="text-gray-300"><span class="math">$D = X_T - x_Q Z_T \\quad \\text{(so that } \\lambda = \\frac{N}{D}),</span>$</p>

    <p class="text-gray-300"><span class="math">$X = N^2 Z_T - X_T D^2 - x_Q D^2 Z_T,</span>$</p>

    <p class="text-gray-300">we compute the addition step with</p>

    <p class="text-gray-300"><span class="math">$X_{T+Q} = DX</span>$</p>

    <p class="text-gray-300"><span class="math">Y_{T+Q} = N(x_Q D^2 Z_T - X) - y_Q D^3 Z_T</span>
<span class="math">Z_{T+Q} = D^3 Z_T</span>
<span class="math">\\ell = y_P D - Nx_P \\gamma + (Nx_Q - Dy_Q) \\gamma^3</span> .</p>

    <p class="text-gray-300">Assuming that  <span class="math">-x_P</span>  is precomputed, this requires  <span class="math">12\\mathbf{M}_2 + 2\\mathbf{S}_2 + 4\\mathbf{M}_1 + 7\\mathbf{A}_2</span> .</p>

    <p class="text-gray-300"><strong>Remark 10.</strong> Again, many  <span class="math">\\mathbb{F}_{p^2}</span>  operands are used several times during the computation, so that precomputing the traces saves additions in  <span class="math">\\mathbb{F}_p</span> . We do not give details here because the addition step is rarely used in the Miller loop but it is not difficult to see that  <span class="math">16\\mathbf{A}_1</span>  can be saved if Karatsuba/complex arithmetic is used for  <span class="math">\\mathbb{F}_{p^2}</span>  arithmetic.</p>

      <h3 id="sec-6.3" class="text-xl font-semibold mt-8">6.3 Consequences of formulas</h3>

    <p class="text-gray-300">Several remarks can be made looking at these formulas.</p>

    <p class="text-gray-300">The first one is that the influence of b is small since it is just involved in two multiplications by  <span class="math">\\mathbb{F}_p</span>  elements. Hence a sparse u or a value of u enabling a nice choice of  <span class="math">\\mu</span>  (and  <span class="math">\\xi</span> ) should be preferred, even if a very small value of b is not</p>

    <p class="text-gray-300">available.</p>

    <p class="text-gray-300">The second one is that, as mentioned in Sections 3.6 and 3.7, the line  <span class="math">\\ell</span>  is of the form  <span class="math">b_0 + b_1 \\gamma + b_3 \\gamma^3</span>  with  <span class="math">b_i \\in \\mathbb{F}_{p^2}</span> , thus it is sparse in  <span class="math">\\mathbb{F}_{p^{12}}</span>  and a multiplication by  <span class="math">\\ell</span>  is faster than a full multiplication in  <span class="math">\\mathbb{F}_{p^{12}}</span> .</p>

    <p class="text-gray-300">The third one is that, as already mentioned in [34, 1, 35, 27], it can be better to use affine coordinates than projective coordinates, depending on the context. Indeed, using the complexity formula for  <span class="math">I_2</span>  given in Section 3.2.4 and the complexities obtained for the doubling step in affine and projective coordinates, it is easy to verify that affine coordinates become interesting for this step (and then for the full Miller loop) as soon as</p>

    <p class="text-gray-300"><span class="math">$I_1 &lt; 5S_2 - M_2 - 2S_1 + 15A_1 + 6A&#x27;_1 + 2m_{1,b} - m_{1,\\mu}.</span>$</p>

    <p class="text-gray-300">For example, in the case  <span class="math">\\mu = -1</span> ,  <span class="math">\\mathbf{A}_1 \\leq 0.33\\mathbf{M}_1</span> , Tables 1 and 2 show that affine coordinates are interesting as soon as</p>

    <p class="text-gray-300"><span class="math">$\\mathbf{I}_1 &lt; 7\\mathbf{M}_1 - 2\\mathbf{S}_1 + 20\\mathbf{A}_1 + 11\\mathbf{A}&#x27;_1 + 2\\mathbf{m}_{1,b}. \\tag{3}</span>$</p>

    <p class="text-gray-300">Depending on the way to implement  <span class="math">\\mathbb{F}_p</span>  inversion, this inequality may hold in practice, especially if  <span class="math">\\mathbb{F}_p</span>  addition are not negligible. In Table 15, we give the maximum cost of  <span class="math">\\mathbf{I}_1</span>  for which affine coordinates should be chosen, depending on the context. To make the results more readable, we assumed that  <span class="math">\\mathbf{S}_1 = \\mathbf{M}_1, \\mathbf{A}_1 = \\mathbf{A}&#x27;_1</span>  and b = 2 (which is the least advantageous value for affine coordinates). In any case, the non-simplified result is very similar to (3).</p>

    <div class="overflow-x-auto my-4">
      <table class="min-w-full text-sm text-gray-300">
        <thead>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"><span class="math">\\mu</span></th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">Use affine coordinates if</th>
        </thead>
        <tbody>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-1</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">\\mathbf{I}_1 &lt; 5\\mathbf{M}_1 + 33\\mathbf{A}_1</span></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-2</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">\\mathbf{I}_1 &lt; 5\\mathbf{M}_1 + 41\\mathbf{A}_1</span></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-5</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">\\mathbf{I}_1 &lt; 5\\mathbf{M}_1 + 42\\mathbf{A}_1</span></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">any</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">\\mathbf{I}_1 &lt; 13\\mathbf{M}_1 + 28\\mathbf{A}_1</span></td>
          </tr>
        </tbody>
      </table>
    </div>

    <p class="text-gray-300">Table 15: Affine coordinates versus projective ones</p>

    <p class="text-gray-300">We describe here some algorithms which should not influence the choice of the parameters but which are important for the efficiency of pairing computation.</p>

      <h3 id="sec-7.1" class="text-xl font-semibold mt-8">7.1 Frobenius computation</h3>

    <p class="text-gray-300">Let</p>

    <p class="text-gray-300"><span class="math">$a = b_0 + b_1 \\gamma + b_2 \\gamma^2 + b_3 \\gamma^3 + b_4 \\gamma^4 + b_5 \\gamma^5</span>$</p>

    <p class="text-gray-300">be an arbitrary element of  <span class="math">\\mathbb{F}_{p^{12}}</span> , where  <span class="math">b_j \\in \\mathbb{F}_{p^2}</span> ,  <span class="math">j = 0, \\ldots, 5</span>  and  <span class="math">\\gamma^6 = \\xi \\in \\mathbb{F}_{p^2}</span> . The Frobenius map, which consists in computing  <span class="math">a^p</span> , can be easily written in terms of a. In this section, we give a way to compute it efficiently, as well as  <span class="math">a^{p^i}</span>  for  <span class="math">i = 1, \\ldots, 11</span> .</p>

      <h4 id="sec-7.1.1" class="text-lg font-semibold mt-6">7.1.1 Computation of <span class="math">a^p</span></h4>

    <p class="text-gray-300">Since the Frobenius map is linear, we have</p>

    <p class="text-gray-300"><span class="math">$a^{p} = b_{0}^{p} + b_{1}^{p} \\gamma^{p} + b_{2}^{p} \\left(\\gamma^{2}\\right)^{p} + b_{3}^{p} \\left(\\gamma^{3}\\right)^{p} + b_{4}^{p} \\left(\\gamma^{4}\\right)^{p} + b_{5}^{p} \\left(\\gamma^{5}\\right)^{p},</span>$</p>

    <p class="text-gray-300">and  <span class="math">b_j^p</span>  is just the conjugate  <span class="math">\\overline{b_j}</span>  of  <span class="math">b_j</span> . Therefore, we only have to study the  <span class="math">(\\gamma^j)^p</span> . For this, we define the constant</p>

    <p class="text-gray-300"><span class="math">$\\delta = \\xi^{\\frac{p-1}{6}} \\in \\mathbb{F}_{p^2},</span>$</p>

    <p class="text-gray-300">so that  <span class="math">\\gamma^p = (\\gamma^6)^{(p-1)/6} \\gamma = \\delta \\gamma</span>  and we have</p>

    <p class="text-gray-300"><span class="math">$a^p = \\overline{b_0} + \\overline{b_1}\\delta\\gamma + \\overline{b_2}\\delta^2\\gamma^2 + \\overline{b_3}\\delta^3\\gamma^3 + \\overline{b_4}\\delta^4\\gamma^4 + \\overline{b_5}\\delta^5\\gamma^5.</span>$</p>

    <p class="text-gray-300">The constants  <span class="math">\\delta^j</span>  are only depending on the way to build  <span class="math">\\mathbb{F}_{p^{12}}</span> , so they can be precomputed. Finally, computing  <span class="math">a^p</span>  requires  <span class="math">5\\mathbf{M}_2</span> . If precomputing the  <span class="math">\\delta^j</span>  is a problem in terms of memory resources, they can of course all be recovered from  <span class="math">\\delta</span>  using only  <span class="math">2\\mathbf{S}_2 + 2\\mathbf{M}_2</span> . But in any case,  <span class="math">\\delta</span>  should be precomputed since it is very expensive to compute.</p>

    <p class="text-gray-300">Let us finally note that some particular choices of  <span class="math">\\mu</span>  and  <span class="math">\\xi</span>  allow to improve this computation by using a precomputed constant in  <span class="math">\\mathbb{F}_p</span>  instead of  <span class="math">\\delta \\in \\mathbb{F}_{p^2}</span> . Some details for the most interesting cases are given in Section 7.1.4.</p>

    <p class="text-gray-300">In this case</p>

    <p class="text-gray-300"><span class="math">$a^{p^2} = b_0 + b_1 \\gamma^{p^2} + b_2 (\\gamma^2)^{p^2} + b_3 (\\gamma^3)^{p^2} + b_4 (\\gamma^4)^{p^2} + b_5 (\\gamma^5)^{p^2}.</span>$</p>

    <p class="text-gray-300">We need the new precomputed constant</p>

    <p class="text-gray-300"><span class="math">$\\omega = \\xi^{\\frac{p^2 - 1}{6}} = N_{\\mathbb{F}_{p^2}/\\mathbb{F}_p}(\\delta) \\in \\mathbb{F}_p.</span>$</p>

    <p class="text-gray-300">Then we have  <span class="math">\\gamma^{p^2} = (\\gamma^6)^{(p^2-1)/6} \\gamma = \\omega \\gamma</span> . Notice that  <span class="math">\\omega</span>  is a primitive 6th root of unity (because  <span class="math">\\xi</span>  is neither a square nor a cube in  <span class="math">\\mathbb{F}_{p^2}</span> ). In particular, we have</p>

    <p class="text-gray-300"><span class="math">$\\omega^2 - \\omega + 1 = 0. \\tag{4}</span>$</p>

    <p class="text-gray-300">Then</p>

    <p class="text-gray-300"><span class="math">$a^{p^2} = b_0 + b_1 \\omega \\gamma + b_2 (\\omega - 1) \\gamma^2 - b_3 \\gamma^3 - b_4 \\omega \\gamma^4 - b_5 (\\omega - 1) \\gamma^5,</span>$</p>

    <p class="text-gray-300">and computing  <span class="math">a^{p^2}</span>  requires one addition in  <span class="math">\\mathbb{F}_p</span>  to compute  <span class="math">\\omega - 1</span>  (it can be precomputed but the interest is really limited) and 5 multiplications of an element of  <span class="math">\\mathbb{F}_{p^2}</span>  by an element of  <span class="math">\\mathbb{F}_p</span> , thus the total cost is  <span class="math">10\\mathbf{M}_1 + \\mathbf{A}_1</span> .</p>

      <h4 id="sec-7.1.3" class="text-lg font-semibold mt-6">7.1.3 Generalization to the computation of <span class="math">a^{p^i}</span></h4>

    <p class="text-gray-300">The results of the two previous sections can be generalized as follows: for  <span class="math">i=1,\\ldots,11,\\ j=0,\\ldots,5,\\ \\text{let}\\ c_{i,j}=\\omega^{j\\lfloor i/2\\rfloor}</span> . Notice that it is easy to deduce from (4) that  <span class="math">c_{i,j}=1</span>  (resp.  <span class="math">\\omega,\\ \\omega-1,\\ -1,\\ -\\omega,\\ -\\omega+1</span> ) if  <span class="math">j\\lfloor i/2\\rfloor=0</span>  mod 6 (resp.  <span class="math">1,\\ 2,\\ 3,\\ 4,\\ 5</span> ). We find that for  <span class="math">i=1,\\ldots,11</span> ,</p>

    <p class="text-gray-300"><span class="math">$a^{p^i} = \\overline{b_0} + \\overline{b_1}c_{i,1}\\delta\\gamma + \\overline{b_2}c_{i,2}\\delta^2\\gamma^2 + \\overline{b_3}c_{i,3}\\delta^3\\gamma^3 + \\overline{b_4}c_{i,4}\\delta^4\\gamma^4 + \\overline{b_5}c_{i,5}\\delta^5\\gamma^5</span>$</p>

    <p class="text-gray-300">if i is odd, and</p>

    <p class="text-gray-300"><span class="math">$a^{p^{i}} = b_{0} + b_{1}c_{i,1}\\gamma + b_{2}c_{i,2}\\gamma^{2} + b_{3}c_{i,3}\\gamma^{3} + b_{4}c_{i,4}\\gamma^{4} + b_{5}c_{i,5}\\gamma^{5}</span>$</p>

    <p class="text-gray-300">if i is even.</p>

    <p class="text-gray-300">As explained for i=2, the  <span class="math">c_{i,j}</span>  can be easily deduced from  <span class="math">\\omega</span> , so that only  <span class="math">\\omega, \\delta</span>  and possibly the  <span class="math">c_{i,j}\\delta^j</span>  need to be precomputed. We also note that computing  <span class="math">a^{p^6}</span>  is for free, since it is nothing but the conjugation in  <span class="math">\\mathbb{F}_{p^{12}}/\\mathbb{F}_{p^6}</span> .</p>

      <h4 id="sec-7.1.4" class="text-lg font-semibold mt-6">7.1.4 Simplification of the constant <span class="math">\\delta</span> for odd powers</h4>

    <p class="text-gray-300">For some particular choices of  <span class="math">\\mu</span>  and  <span class="math">\\xi</span> , the precomputed constants for odd powers of the Frobenius map can be simplified.</p>

    <p class="text-gray-300">The case  <span class="math">\\mu = -1</span>  and  <span class="math">\\xi = 1 + i</span> . We proved in Section 3.8 that in this case, u = 7 or 11 modulo 12, so p equals 7 modulo 12. Then</p>

    <p class="text-gray-300"><span class="math">$\\delta = (1+\\mathbf{i})^{\\frac{p-1}{6}} = (1+\\mathbf{i})^{2\\frac{p-7}{12}}(1+\\mathbf{i}) = (2\\mathbf{i})^{\\frac{p-7}{12}}(1+\\mathbf{i}) = \\mathbf{i}^{\\frac{p-7}{12}}(1+\\mathbf{i})2^{\\frac{p-7}{12}},</span>$</p>

    <p class="text-gray-300">thus we only need to precompute  <span class="math">d_1 = 2^{\\frac{p-7}{12}} \\in \\mathbb{F}_p</span>  instead of  <span class="math">\\delta \\in \\mathbb{F}_{p^2}</span> . Moreover, in this case,  <span class="math">\\overline{\\delta} = \\mathbf{i}\\delta</span>  so that  <span class="math">\\omega = \\mathbf{i}\\delta^2</span>  and by (4), we get  <span class="math">\\delta^4 = 1 - \\mathbf{i}\\delta^2</span> . Finally, if  <span class="math">d_2 = -2d_1^2</span>  and  <span class="math">d_3 = d_1d_2</span> , it is easy to find that</p>

    <p class="text-gray-300"><span class="math">$\\begin{array}{lll} \\left(\\delta, \\delta^2, \\delta^3, \\delta^4, \\delta^5\\right) &amp; = &amp; \\left(\\overline{\\xi}d_1, \\mathbf{i}d_2, \\xi d_3, d_2 + 1, \\overline{\\xi}(d_1 + d_3)\\right) \\text{ if } u = 11, 19 \\mod 24, \\\\ &amp; = &amp; \\left(-\\overline{\\xi}d_1, \\mathbf{i}d_2, -\\xi d_3, d_2 + 1, -\\overline{\\xi}(d_1 + d_3)\\right) \\text{ if } u = 7, 23 \\mod 24.</span>$</p>

    <p class="text-gray-300">It is not necessary to precompute  <span class="math">d_2</span>  and  <span class="math">d_3</span>  because their computation requires only  <span class="math">\\mathbf{M}_1 + \\mathbf{S}_1 + \\mathbf{A}&#x27;_1</span> . Once they are computed, computing  <span class="math">a^p</span>  requires 5 multiplications of an element of  <span class="math">\\mathbb{F}_p</span>  by an element of  <span class="math">\\mathbb{F}_{p^2}</span> , 2 additions  <span class="math">(1 + d_2)</span>  and  <span class="math">d_1 + d_3 + d_4 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5 + d_5</span></p>

    <p class="text-gray-300">The case  <span class="math">\\xi = \\sqrt{\\mu}</span> . We assume that u is even (see Section 3.5.1), so  <span class="math">p = 1 \\mod 12</span> . We have</p>

    <p class="text-gray-300"><span class="math">$\\delta = \\sqrt{\\mu}^{\\frac{p-1}{6}} = \\mu^{\\frac{p-1}{12}} \\in \\mathbb{F}_p.</span>$</p>

    <p class="text-gray-300">Therefore, multiplications by  <span class="math">\\delta</span>  and its powers by  <span class="math">\\mathbb{F}_{p^2}</span>  elements cost  <span class="math">2\\mathbf{M}_1</span>  and  <span class="math">\\overline{\\delta} = \\delta</span>  so that  <span class="math">\\omega = \\delta^2</span>  and by (4),  <span class="math">\\delta^4 = \\delta^2 - 1</span>  (and  <span class="math">\\delta^5 = \\delta^3 - \\delta</span> ). Finally, if  <span class="math">\\delta</span>  is precomputed, computing  <span class="math">a^p</span>  requires  <span class="math">11\\mathbf{M}_1 + \\mathbf{S}_1 + 2\\mathbf{A}_1</span>  ( <span class="math">\\mathbf{M}_1 + \\mathbf{S}_1 + 2\\mathbf{A}_1</span>  to compute the  <span class="math">\\delta^j</span>  and  <span class="math">10\\mathbf{M}_1</span>  to compute the  <span class="math">\\overline{b_j}\\delta^j</span> ).</p>

      <h3 id="sec-7.2" class="text-xl font-semibold mt-8">7.2 Cyclotomic squaring</h3>

    <p class="text-gray-300">As mentioned in Section 2.4, the final exponentiation requires exponentiations in the subgroup  <span class="math">G_{\\Phi_6(p^2)}</span>  of  <span class="math">\\mathbb{F}_{p^{12}}^*</span>  of elements of order dividing  <span class="math">\\Phi_6(p^2)</span> . Since around  <span class="math">3\\log_2 u</span>  squarings are performed during the final exponentiation, saving few field operations for each squaring leads to a significant improvement. Given  <span class="math">a \\in \\mathbb{F}_{p^{12}}</span> , the condition  <span class="math">a^{\\Phi_6(p^2)} = 1</span>  combined with a description of the Frobenius action gives algebraic relations on the coordinates of a (where  <span class="math">\\mathbb{F}_{p^{12}}</span>  is seen as a  <span class="math">\\mathbb{F}_{p^2}</span> -vector space). Granger and Scott [26] proposed to exploit these relations to simplify the expression of  <span class="math">a^2</span> .</p>

    <p class="text-gray-300">Furthermore, these relations can be used to compress the representation of a in such a way that the square of a can be directly computed in its compressed form (multiplications have to be performed on the non-compressed forms). In particular, Karabina's method for compressed squaring [31, 2] costs  <span class="math">3\\mathbf{S}_2 + 10\\mathbf{A}_2 + \\mathbf{m}_{2,\\xi}</span>  less than Granger and Scott's method (in most cases). On the other hand, the decompression step is relatively expensive and requires an inversion in  <span class="math">\\mathbb{F}_{p^2}</span> . The number of decompressions required for an exponentiation is at most the Hamming weight of the exponent, which is assumed to be small in our situation (see Sections 2.4 and 4), and moreover, Montgomery's simultaneous inversion trick [41] can be used (we refer to [2] for more details). Therefore, if  <span class="math">\\mathbb{F}_{p^2}</span>  inversions are available (at a reasonable cost), Karabina's method should be used for final exponentiation, otherwise, Granger and Scott's method should be chosen.</p>

      <h4 id="sec-7.2.1" class="text-lg font-semibold mt-6">7.2.1 Karabina's method</h4>

    <p class="text-gray-300">This method is due to Karabina [31] and was slightly improved in [2]. Let  <span class="math">a=b_0+b_1\\gamma+b_2\\gamma^2+b_3\\gamma^3+b_4\\gamma^4+b_5\\gamma^5\\in G_{\\Phi_6(p^2)}\\setminus\\{1\\}</span> , with  <span class="math">b_j\\in\\mathbb{F}_{p^2}</span> . The compressed representation of a is  <span class="math">[b_1,b_2,b_4,b_5]</span> . The full representation (decompression) of a is obtained via the formulae</p>

    <p class="text-gray-300"><span class="math">$b_3 = \\frac{b_5^2 \\xi + 3b_2^2 - 2b_4}{4b_1}, \\qquad b_0 = (2b_3^2 + b_1b_5 - 3b_4b_2)\\xi + 1, \\qquad \\text{if } b_1 \\neq 0,</span>$</p>

    <p class="text-gray-300"><span class="math">$b_3 = \\frac{2b_2b_5}{b_4}, \\qquad b_0 = (2b_3^2 - 3b_4b_2)\\xi + 1, \\qquad \\text{if } b_1 = 0,</span>$</p>

    <p class="text-gray-300">for a cost of  <span class="math">\\mathbf{I}_2+2\\mathbf{M}_2+3\\mathbf{S}_2+4\\mathbf{A&#x27;}_2+6\\mathbf{A}_2+2\\mathbf{m}_{2,\\xi}+\\mathbf{A}_1</span>  (or  <span class="math">\\mathbf{I}_2+2\\mathbf{M}_2+\\mathbf{S}_2+2\\mathbf{A&#x27;}_2+2\\mathbf{A}_2+\\mathbf{m}_{2,\\xi}+\\mathbf{A}_1</span>  if  <span class="math">b_1=0</span> ). The compressed representation  <span class="math">[B_1,B_2,B_4,B_5]</span>  of  <span class="math">a^2</span>  can be computed using the formulae</p>

    <p class="text-gray-300"><span class="math">$B_1 = 2b_1 + 3(S_{2,5} - S_2 - S_5)\\xi \\qquad B_4 = 3(S_2 + S_5\\xi) - 2b_4</span>$</p>

    <p class="text-gray-300"><span class="math">$B_2 = 3(S_1 + S_4\\xi) - 2b_2 \\qquad B_5 = 2b_5 + 3(S_{1,4} - S_1 - S_4),</span>$
where  <span class="math">S_{i,j} = (b_i + b_j)^2</span>  and  <span class="math">S_i = b_i^2</span> , for a cost of  <span class="math">\\mathbf{6S}_2 + 4\\mathbf{A&#x27;}_2 + 16\\mathbf{A}_2 + 3\\mathbf{m}_{2,\\xi}</span> .</p>

      <h4 id="sec-7.2.2" class="text-lg font-semibold mt-6">7.2.2 Granger and Scott's method</h4>

    <p class="text-gray-300">This method is due to Granger and Scott [26]. They worked with a tower 2, 2, 3 but their results can be easily adapted to a tower 2, 3, 2, either by using the</p>

    <p class="text-gray-300">same technique and the formulae from Section 7.1, or simply by expanding the formulae for a tower 2, 2, 3.</p>

    <p class="text-gray-300">Case 2,2,3. With the notations of Section 3.7, let  <span class="math">a=c_0+c_1\\gamma+c_2\\gamma^2\\in \\mathbb{F}_{p^{12}}=\\mathbb{F}_{p^2}[\\gamma]</span> , where  <span class="math">c_0,c_1,c_2\\in \\mathbb{F}_{p^4}</span>  and write</p>

    <p class="text-gray-300"><span class="math">$a^2 = C_0 + C_1 \\gamma + C_2 \\gamma^2</span>$</p>

    <p class="text-gray-300">where  <span class="math">C_0, C_1, C_2 \\in \\mathbb{F}_{p^4}</span> . If  <span class="math">a \\in G_{\\Phi_6(p^2)}</span> , then we have the following formulae, given in [26]</p>

    <p class="text-gray-300"><span class="math">$C_0 = 3c_0^2 - 2\\overline{c_0}</span>$</p>

    <p class="text-gray-300"><span class="math">$C_1 = 3\\beta c_2^2 + 2\\overline{c_1}</span>$</p>

    <p class="text-gray-300"><span class="math">$C_2 = 3c_1^2 - 2\\overline{c_2},</span>$</p>

    <p class="text-gray-300">where  <span class="math">\\overline{u+v\\beta}=u-v\\beta</span> , for  <span class="math">u,v\\in\\mathbb{F}_{p^2}</span> . Therefore, the square of  <span class="math">a\\in G_{\\Phi_6(p^2)}</span>  can be computed for a cost of  <span class="math">3\\mathbf{S}_4+3\\mathbf{A}&#x27;_4+6\\mathbf{A}_4+\\mathbf{m}_{4,\\beta}</span>  (using that an expression of the form 3u+2v=2(u+v)+u can be computed with one doubling and 2 additions).</p>

    <p class="text-gray-300">Case 2,3,2. With the notations of Section 3.6, let  <span class="math">a=(b_0+b_2\\beta+b_4\\beta^2)+(b_1+b_3\\beta+b_5\\beta^2)\\gamma\\in\\mathbb{F}_{p^2}[\\gamma]</span> , where  <span class="math">b_i\\in\\mathbb{F}_{p^2}</span> ,  <span class="math">i=0,\\ldots,5</span> , and write</p>

    <p class="text-gray-300"><span class="math">$a^{2} = (B_{0} + B_{2}\\beta + B_{4}\\beta^{2}) + (B_{1} + B_{3}\\beta + B_{5}\\beta^{2})\\gamma</span>$</p>

    <p class="text-gray-300">where  <span class="math">B_i \\in \\mathbb{F}_{p^2}</span> ,  <span class="math">i = 0, \\dots, 5</span> . If  <span class="math">a \\in G_{\\Phi_6(p^2)}</span> , then we have</p>

    <p class="text-gray-300"><span class="math">$B_0 = 3(b_3^2 \\xi + b_0^2) - 2b_0</span>$</p>

    <p class="text-gray-300"><span class="math">$B_2 = 3(b_4^2 \\xi + b_1^2) - 2b_2</span>$</p>

    <p class="text-gray-300"><span class="math">$B_4 = 3(b_5^2 \\xi + b_2^2) - 2b_4</span>$</p>

    <p class="text-gray-300"><span class="math">$B_1 = 3\\xi((b_2 + b_5)^2 - b_2^2 - b_5^2)) + 2b_1</span>$</p>

    <p class="text-gray-300"><span class="math">$B_3 = 3((b_0 + b_3)^2 - b_0^2 - b_3^2)) + 2b_3</span>$</p>

    <p class="text-gray-300"><span class="math">$B_5 = 3((b_4 + b_1)^2 - b_4^2 - b_1^2)) + 2b_5.</span>$</p>

    <p class="text-gray-300">We find that the square of  <span class="math">a \\in G_{\\Phi_6(p^2)}</span>  can be computed for a cost of  <span class="math">9\\mathbf{S}_2 + 6\\mathbf{A}&#x27;_2 + 24\\mathbf{A}_2 + 4\\mathbf{m}_{2,\\xi}</span> .</p>

    <p class="text-gray-300"><strong>Remark 11.</strong> According to Table 3,  <span class="math">S_4 = 3S_2 + m_{2,\\xi} + 4A_2</span>  in the most common case and then it is easy to verify that the cost of squaring in the case 2, 2, 3 is exactly the same as in the case 2, 3, 2</p>

    </section>

    <section id="sec-8" class="mb-10">
      <h2 class="text-2xl font-bold">8 Conclusion</h2>

    <p class="text-gray-300">In this paper, we explained in details how to choose and generate the parameters for implementing a pairing on BN curves. More precisely, we explained the choices which should be made be made in terms of</p>

    <ul class="list-disc list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li>pairing algorithm (Miller loop, final exponentiation),</li>
      <li>ways to build the tower field depending on the value of the BN parameter u as a nice application of old elementary arithmetic results,</li>
      <li><span class="math">\\mathbb{F}_{p^{12}}</span>  arithmetic depending on the relative cost of  <span class="math">\\mathbb{F}_p</span>  operations on the targeted device,</li>
      <li>groups involved (base elliptic curve, its twist and their generators),</li>
      <li>system of coordinates to be used depending on the context.</li>
    </ul>

    <p class="text-gray-300">Of course, the best choices are already well-known but there are many situations where generating other parameters is necessary (pairing parameters database, other security levels than 126-bit, resistance to subgroups attacks, trusted parameters, ...) and this paper should help anyone interested by generating pairing parameters depending on the target device (security level, relative cost of  <span class="math">\\mathbb{F}_p</span>  operations, memory resources, ...). Moreover, we used this opportunity to give some new improvements on  <span class="math">\\mathbb{F}_{p^{12}}</span>  arithmetic (in a pairing context) in terms of  <span class="math">\\mathbb{F}_p</span> -addition because they are usually not so negligible for small devices. The gain obtained on  <span class="math">\\mathbb{F}_{p^{12}}</span>  arithmetic is around 10%, depending on the context and the  <span class="math">\\mathbb{F}_{p^{12}}</span>  operation considered.</p>

    </section>

    <section id="references" class="mb-10">
      <h2 class="text-2xl font-bold">References</h2>

    <ul class="space-y-2 text-gray-400 text-sm list-none">
      <li><p class="text-gray-300">[1] Tolga Acar, Kristin E. Lauter, Michael Naehrig, and Daniel Shumow. Affine pairings on ARM. In Michel Abdalla and Tanja Lange, editors, <em>Pairing-Based Cryptography Pairing 2012</em>, volume 7708 of <em>Lecture Notes in Computer Science</em>, pages 203&ndash;209. Springer, 2012.</p></li>
      <li><p class="text-gray-300">[2] D. Aranha, K. Karabina, P. Longa, C. H. Gebotys, and J L&oacute;pez. Faster explicit formulas for computing pairings over ordinary curves. In <em>Advances</em> in <em>Cryptology EUROCRYPT 2011</em>, volume 6632 of <em>LNCS</em>, pages 48&ndash;68. Springer, 2011.</p></li>
      <li><p class="text-gray-300">[3] Dieg of. Aranha, Paulo S.L.M. Barreto, Patrick Longa, and Jefferson E. Ricardini. The realm of the pairings. In Tanja Lange, Kristin Lauter, and Petr Lison&Auml;&#379;k, editors, Selected Areas in Cryptography SAC 2013, volume 8282 of Lecture Notes in Computer Science, pages 3&ndash;25. Springer Berlin Heidelberg, 2014.</p></li>
      <li><p class="text-gray-300">[4] Razvan Barbulescu, Pierrick Gaudry, Antoine Joux, and Emmanuel Thom&eacute;. A heuristic quasi-polynomial algorithm for discrete logarithm in finite fields of small characteristic.</p></li>
      <li><p class="text-gray-300">[5] Paulo S. L. M. Barreto, Craig Costello, Rafael Misoczki, Michael Naehrig, Geovandro C. C. F. Pereira, and Gustavo Zanon. Subgroup security in pairing-based cryptography. In <em>LATINCRYPT 2015</em>, volume 9230 of <em>Lecture Notes in Computer Science</em>, pages 245&ndash;265. Springer-Verlag, 2015.</p></li>
      <li><p class="text-gray-300">[6] Paulo S. L. M. Barreto, Steven D. Galbraith, Colm O. hEigeartaigh, and Michael Scott. Ecient pairing computation on supersingular abelian varieties. IACR Cryptology ePrint Archive, 2004:375, 2004.</p></li>
      <li><p class="text-gray-300">[7] Paulo S. L. M. Barreto, Hae Yong Kim, Ben Lynn, and Michael Scott. Ecient algorithms for pairing-based cryptosystems. In CRYPTO 2002, volume 2442 of LNCS, pages 354368. Springer, 2002.</p></li>
      <li><p class="text-gray-300">[8] Paulo S. L. M. Barreto and Michael Naehrig. Pairing-friendly elliptic curves of prime order. In Proc. of SAC 2005, volume 3897 of LNCS, pages 319 331. Springer-Verlag, 2006.</p></li>
      <li><p class="text-gray-300">[9] Paul Barrett. Implementing the rivest shamir and adleman public key encryption algorithm on a standard digital signal processor. In Proceedings on Advances in cryptologyCRYPTO '86, pages 311323, London, UK, UK, 1987. Springer-Verlag.</p></li>
      <li><p class="text-gray-300">[10] Dan Boneh and Matthew K. Franklin. Identity-based encryption from the weil pairing. In CRYPTO 2001, volume 2139 of Lecture Notes in Computer Science, pages 213229. Springer, 2001.</p></li>
      <li><p class="text-gray-300">[11] Dan Boneh, Craig Gentry, and B. Waters.</p></li>
      <li><p class="text-gray-300">[12] Dan Boneh, Ben Lynn, and Hovav Shacham. Short signatures from the weil pairing. Journal of cryptology, 17(4):297319, 2004.</p></li>
      <li><p class="text-gray-300">[13] Laura Fuentes Castaneda, Edward Knapp, and Francisco Rodrguez Henrquez. Faster hashing to \${\\mathbb G}_2$. In Selected Areas in Cryptography - 18th International Workshop, 2011, Toronto, ON, Canada, August 11-12, 2011, Revised Selected Papers, pages 412430, 2011.</p></li>
      <li><p class="text-gray-300">[14] Ray C. C. Cheung, Sylvain Duquesne, Junfeng Fan, Nicolas Guillermin, Ingrid Verbauwhede, and Gavin Xiaoxu Yao. FPGA implementation of pairings using residue number system and lazy reduction. In Cryptographic Hardware and Embedded Systems - CHES 2011, volume 6917 of LNCS, pages 421441. Springer, 2011.</p></li>
      <li><p class="text-gray-300">[15] Jaewook Chung and M. Anwar Hasan. More generalized mersenne numbers: (extended abstract). In Selected Areas in Cryptography, 10th Annual International Workshop, SAC 2003, Ottawa, Canada, August 14-15, 2003, Revised Papers, pages 335347, 2003.</p></li>
      <li><p class="text-gray-300">[16] Jaewook Chung and M Anwar Hasan. Asymmetric squaring formulae. In 18th symposium on Computer Arithmetic, Montpellier, France, IEEE conference publications, pages 113122, 2007.</p></li>
      <li><p class="text-gray-300">[17] Henri Cohen, Gerhard Frey, Roberto Avanzi, Christophe Doche, Tanja Lange, Kim Nguyen, and Frederik Vercauteren. Handbook of Elliptic and Hyperelliptic Curve Cryptography, Second Edition. Chapman &amp; Hall/CRC, 2nd edition, 2012.</p></li>
      <li><p class="text-gray-300">[18] Craig Costello, Tanja Lange, and Michael Naehrig. Faster pairing computations on curves with high-degree twists. In PhongQ. Nguyen and David Pointcheval, editors, Public Key Cryptography - PKC 2010, volume 6056 of Lecture Notes in Computer Science, pages 224242. Springer Berlin Heidelberg, 2010.</p></li>
      <li><p class="text-gray-300">[19] David A. Cox. Primes of the form x <sup>2</sup> + ny<sup>2</sup> . 1989.</p></li>
      <li><p class="text-gray-300">[20] Augusto Jun Devegili, Colm O'Eigeartaigh, Michael Scott, and Ricardo Dahab. Multiplication and squaring on pairing-friendly elds. IACR Cryptology ePrint Archive, page 471, 2006.</p></li>
      <li><p class="text-gray-300">[21] Augusto Jun Devegili, Michael Scott, and Ricardo Dahab. Implementing cryptographic pairings over barreto-naehrig curve. pages 197207.</p></li>
      <li><p class="text-gray-300">[22] Sylvain Duquesne. RNS arithmetic in pk and application to fast pairing computation. J. Mathematical Cryptology, 5(1):5188, 2011.</p></li>
      <li><p class="text-gray-300">[23] Sylvain Duquesne and Loubna Ghammam. Memory-saving computation of the pairing nal exponentiation on bn curves. Groups, Complexity, Cryptology, 2015. To appear.</p></li>
      <li><p class="text-gray-300">[24] C. C. F. Pereira Geovandro, Marcos A. Simpl&iacute;cio Jr., Michael Naehrig, and Paulo S. L. M. Barreto. A family of implementation-friendly bn elliptic curves. Journal of Systems and Software, 84(8):13191326, 2011.</p></li>
      <li><p class="text-gray-300">[25] Christophe Giraud and Vincent Verneuil. Atomicity improvement for elliptic curve scalar multiplication. In Dieter Gollmann, Jean-Louis Lanet, and Julien Iguchi-Cartigny, editors, Smart Card Research and Advanced Application, volume 6035 of Lecture Notes in Computer Science, pages 80101. Springer Berlin Heidelberg, 2010.</p></li>
      <li><p class="text-gray-300">[26] Robert Granger and Michael Scott. Faster squaring in the cyclotomic subgroup of sixth degree extensions. In Public Key Cryptography - PKC 2010, 13th International Conference on Practice and Theory in Public Key Cryptography, Paris, France, May 26-28, 2010. Proceedings, pages 209223, 2010.</p></li>
      <li><p class="text-gray-300">[27] Gurleen Grewal, Reza Azarderakhsh, Patrick Longa, Shi Hu, and David Jao. Ecient implementation of bilinear pairings on arm processors. In LarsR. Knudsen and Huapeng Wu, editors, Selected Areas in Cryptography, volume 7707 of Lecture Notes in Computer Science, pages 149165. Springer Berlin Heidelberg, 2013.</p></li>
      <li><p class="text-gray-300">[28] Florian He&yuml;. Pairing lattices. In Proc. of Pairing 2008, volume 5209 of LNCS, pages 1838, 2008.</p></li>
      <li><p class="text-gray-300">[29] Florian Hess, Nigel P. Smart, and Frederik Vercauteren. The eta pairing revisited. IEEE Transactions on Information Theory, 52(10):45954602, 2006.</p></li>
      <li><p class="text-gray-300">[30] Antoine Joux. A new index calculus algorithm with complexity l(1/4+o(1)) in small characteristic. In Tanja Lange, Kristin Lauter, and Petr Lison&Auml;k, editors, Selected Areas in Cryptography SAC 2013, volume 8282 of Lecture Notes in Computer Science, pages 355379. Springer Berlin Heidelberg, 2014.</p></li>
      <li><p class="text-gray-300">[31] Koray Karabina. Squaring in cyclotomic subgroups. Math. Comput., 82(281), 2013.</p></li>
      <li><p class="text-gray-300">[32] Donald E. Knuth. The Art of Computer Programming, Volume 2 (3rd Ed.): Seminumerical Algorithms. Addison-Wesley Longman Publishing Co., Inc., Boston, MA, USA, 1997.</p></li>
      <li><p class="text-gray-300">[33] N. Koblitz and A. Menezes. Pairing-based cryptography at high security levels. Cryptography and coding, 3796:1336, 2005.</p></li>
      <li><p class="text-gray-300">[34] Kristin E. Lauter, Peter L. Montgomery, and Michael Naehrig. An analysis of ane coordinates for pairing computation. In Marc Joye, Atsuko Miyaji, and Akira Otsuka, editors, Pairing-Based Cryptography - Pairing 2010 - 4th International Conference, Yamanaka Hot Spring, Japan, December 2010. Proceedings, volume 6487 of Lecture Notes in Computer Science, pages 1 20. Springer, 2010.</p></li>
      <li><p class="text-gray-300">[35] Duc-Phong Le and ChikHow Tan. Speeding up ate pairing computation in ane coordinates. In Taekyoung Kwon, Mun-Kyu Lee, and Daesung Kwon, editors, Information Security and Cryptology - ICISC 2012, volume 7839 of Lecture Notes in Computer Science, pages 262277. Springer Berlin Heidelberg, 2013.</p></li>
      <li><p class="text-gray-300">[36] Eunjeong Lee, Hyang-Sook Lee, and Cheol-Min Park. Ecient and generalized pairing computation on abelian varieties. Information Theory, IEEE Transactions on, 55(4):17931803, April 2009.</p></li>
      <li><p class="text-gray-300">[37] Rudolf Lidl and Harald Niederreiter. Finite Fields. Cambridge University Press, 1997.</p></li>
      <li><p class="text-gray-300">[38] Chae Hoon Lim and Pil Joong Lee. A key recovery attack on discrete log-based schemes using a prime order subgroup. In CRYPTO 1997, pages 249263. Springer-Verlag, 1997.</p></li>
      <li><p class="text-gray-300">[39] Seiichi Matsuda, Naoki Kanayama, Florian He&yuml;, and Eiji Okamoto. Optimised versions of the Ate and twisted Ate pairings. IEICE Transactions, 92-A(7):16601667, 2009.</p></li>
      <li><p class="text-gray-300">[40] S.V. Miller. The weil pairing, and its ecient calculation. Journal of cryptology, vol. 17(4), pp. 235-261, 2004.</p></li>
      <li><p class="text-gray-300">[41] P. L. Montgomery. Speeding the pollard and elliptic curve methods of factorization. Mathematics of Computation, 48(177):243264, 1987.</p></li>
      <li><p class="text-gray-300">[42] Peter L. Montgomery. Modular multiplication without trial division. Mathematics of Computation, 44(170):519521, 1985.</p></li>
      <li><p class="text-gray-300">[43] Michael Naehrig, Ruben Niederhagen, and Peter Schwabe. New software speed records for cryptographic pairings. In LATINCRYPT 2010, volume 6212 of LNCS, pages 109123. Springer, 2010.</p></li>
      <li><p class="text-gray-300">[44] Yasuyuki Nogami, Masataka Akane, Yumi Sakemi, Hidehiro Katou, and Yoshitaka Morikawa. Integer variable chi-based ate pairing. In Pairing-Based Cryptography - Pairing 2008, pages 178191, 2008.</p></li>
      <li><p class="text-gray-300">[45] National Institute of Standard and technology. Key management, 2007.</p></li>
      <li><p class="text-gray-300">[46] Microsoft Research. Msr ecclib v2.0. 2015.</p></li>
      <li><p class="text-gray-300">[47] Franck Rondepierre. Revisiting atomic patterns for scalar multiplications on elliptic curves. In Aur&eacute;lien Francillon and Pankaj Rohatgi, editors, Smart Card Research and Advanced Applications, volume 8419 of Lecture Notes in Computer Science, pages 171186. Springer International Publishing, 2014.</p></li>
      <li><p class="text-gray-300">[48] Oliver Schirokauer. The number eld sieve for integers of low weight. Math. Comput., 79(269):583602, 2010.</p></li>
      <li><p class="text-gray-300">[49] Michael Scott and Paulo S. L. M. Barreto. Compressed pairings. In Advances in cryptologyCRYPTO 2004, volume 3152 of Lecture Notes in Comput. Sci., pages 140156. Springer, Berlin, 2004.</p></li>
      <li><p class="text-gray-300">[50] Michael Scott, Naomi Benger, Manuel Charlemagne, Luis J. Dominguez Perez, and Ezekiel J. Kachisa. On the nal exponentiation for calculating pairings on ordinary elliptic curves. In Pairings 2009, volume 5671 of LNCS, pages 7888. Springer, 2009.</p></li>
      <li><p class="text-gray-300">[51] Jerome A. Solinas. Generalized mersenne numbers. Technical report, 1999.</p></li>
      <li><p class="text-gray-300">[52] Martijn Stam and Arjen K. Lenstra. Ecient subgroup exponentiation in quadratic and sixth degree extensions. In Cryptographic Hardware and Embedded Systems - CHES 2002, 4th International Workshop, Redwood Shores, CA, USA, August 13-15, 2002, Revised Papers, pages 318332, 2002.</p></li>
      <li><p class="text-gray-300">[53] Thomas Unterluggauer and Erich Wenger. Ecient pairings and ecc for embedded systems. In Lejla Batina and Matthew Robshaw, editors, Cryptographic Hardware and Embedded Systems CHES 2014, volume 8731 of Lecture Notes in Computer Science, pages 298315. Springer Berlin Heidelberg, 2014.</p></li>
      <li><p class="text-gray-300">[54] Frederik Vercauteren. Optimal pairings. IEEE Transactions of Information Theory, 56:455461, 2009.</p></li>
    </ul>

    </section>

    <section id="app-a" class="mb-10">
      <h2 class="text-2xl font-bold">A Appendix</h2>

    <p class="text-gray-300">In this appendix, we prove some results on the required conditions for an element to be a square or a cube in F<sup>p</sup> or Fp<sup>2</sup> , if p is a BN prime.</p>

    <p class="text-gray-300">Proposition 1. Let p = 36u <sup>4</sup> + 36u <sup>3</sup> + 24u <sup>2</sup> + 6u + 1 be a BN prime, we have</p>

    <ul class="list-disc list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li>i) &minus;1 is a square in F<sup>p</sup> if and only if u is even.</li>
      <li>ii) 2 is a square in F<sup>p</sup> if and only if u = 0 or 1 modulo 4.</li>
      <li>iii) 3 is a square in F<sup>p</sup> if and only if u is even.</li>
      <li>iv) 5 is a square in F<sup>p</sup> if and only if u = 0 or 4 modulo 5.</li>
    </ul>

    <p class="text-gray-300">Proof.</p>

    <ul class="list-disc list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li>i) Since p = 1 + 2u mod 4, this is a direct consequence of the classical result stating that &minus;1 is a square in F<sup>p</sup> if and only if p = 1 modulo 4.</li>
      <li>ii) It is well known that 2 is a square in F<sup>p</sup> if and only if p = &plusmn;1 mod 8. Since p = 1 + 6u mod 8, 2 is a square in F<sup>p</sup> if and only if u = 0 or 1 mod 4.</li>
      <li>iii) It is not dicult to prove, using the quadratic reciprocity law, that 3 is a square in F<sup>p</sup> if and only if p = &plusmn;1 mod 12. Since p = 1 + 6u mod 12, this holds when u is even.</li>
      <li>iv) Again, 5 is a square if and only if p = &plusmn;1 mod 5 and it is easy to check that this only holds when u = 0 or 4 mod 5.</li>
    </ul>

    <p class="text-gray-300">Proposition 2. Let p = 36u <sup>4</sup> + 36u <sup>3</sup> + 24u <sup>2</sup> + 6u + 1 be a BN prime, we have</p>

    <ul class="list-disc list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li><ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li>2 is a cube in F<sup>p</sup> if and only if u = 0 mod 3.</li>
    </ol></li>
      <li><ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li>3 is a cube in F<sup>p</sup> if and only if u = 0, 1 or 5 modulo 9.</li>
    </ol></li>
      <li><ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li>5 is a cube in F<sup>p</sup> if and only if u = 0, 2, 4, 6 or 8 modulo 15.</li>
    </ol></li>
    </ul>

    <h2 id="sec-misc-6" class="text-2xl font-bold">Proof.</h2>

    <p class="text-gray-300">This result is based on two old statements. The rst one is a theorem of Fermat stating that every prime p = 1 mod 3 can be written in the form a <sup>2</sup> + 3b <sup>2</sup> and that this representation is unique (up to signs). The second one is known as Euler's conjectures and is proven by Cox in [19]. In the cases interesting us, it states that if p = a <sup>2</sup> + 3b <sup>2</sup> as above, we have</p>

    <ul class="list-disc list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li>2 is a cube in F<sup>p</sup> if and only if 3|b.</li>
      <li>3 is a cube in F<sup>p</sup> if and only if 9|b or 9|a &plusmn; b.</li>
      <li>5 is a cube in F<sup>p</sup> if and only if 15|b or 3|b, 5|a or 15|a &plusmn; b or 15|2a &plusmn; b.</li>
    </ul>

    <p class="text-gray-300">BN primes are congruent to 1 modulo 3 and the Fermat representation can be explicitly given by</p>

    <p class="text-gray-300"><span class="math">$p = 36u^4 + 36u^3 + 24u^2 + 6u + 1 = (6u^2 + 3u + 1)^2 + 3u^2.</span>$</p>

    <p class="text-gray-300">So we have b = u and  <span class="math">a = 6u^2 + 3u + 1</span>  and it is not difficult to find for which values of u the conditions of Euler's conjectures are satisfied.</p>

    <p class="text-gray-300"><strong>Proposition 3.</strong> Let p be an odd prime number which is equal to 1 modulo 3. Then an element is a square (resp. a cube) in  <span class="math">\\mathbb{F}_{p^2}</span>  if and only if its norm is a square (resp. a cube) in  <span class="math">\\mathbb{F}_p</span> .</p>

    <h4 id="sec-misc-7" class="text-lg font-semibold mt-6">Proof</h4>

    <p class="text-gray-300">This is not a difficult proof and it can be done by an undergraduate student. It is for example trivial that, if an element is a square (resp. a cube) then its norm is a square (resp. a cube). Let us now reciprocally assume that  <span class="math">a \\in \\mathbb{F}_{p^2}</span>  and  <span class="math">N_{\\mathbb{F}_{p^2}/\\mathbb{F}_p} = b^2</span>  for some b in  <span class="math">\\mathbb{F}_p</span> . To prove that a is a square, we first need to determine the number of squares in  <span class="math">\\mathbb{F}_{p^2}</span> . For this, we study the linear map</p>

    <p class="text-gray-300"><span class="math">$\\psi: \\mathbb{F}_{p^2}^* \\to \\mathbb{F}_{p^2}^*</span>$
<span class="math">$x \\mapsto x^2.</span>$</p>

    <p class="text-gray-300">The kernel of  <span class="math">\\psi</span>  is of course  <span class="math">\\{\\pm 1\\}</span>  so that its image has cardinality  <span class="math">\\frac{p^2-1}{2}</span> . This means that there are exactly  <span class="math">\\frac{p^2-1}{2}</span>  squares in  <span class="math">\\mathbb{F}_{p^2}^*</span> . Let us now prove that a is one of them. Since the conjugate of a is nothing but  <span class="math">a^p</span> , the norm of a is  <span class="math">a^{p+1}</span> . So we have  <span class="math">a^{p+1}=b^2</span>  and we can raise this equality to the power of  <span class="math">\\frac{p-1}{2}</span>  because p is odd so we get</p>

    <p class="text-gray-300"><span class="math">$a^{\\frac{p^2-1}{2}} = b^{p-1} = 1.</span>$</p>

    <p class="text-gray-300">This means that a is in the kernel of the linear map</p>

    <p class="text-gray-300"><span class="math">$\\begin{array}{ccc} \\varphi: \\mathbb{F}_{p^2}^* &amp; \\to &amp; \\mathbb{F}_{p^2}^* \\\\ &amp; x &amp; \\mapsto &amp; x^{\\frac{p^2-1}{2}}. \\end{array}</span>$</p>

    <p class="text-gray-300">The kernel of this map is the set of all roots of the polynomial  <span class="math">X^{\\frac{p^2-1}{2}}-1</span>  and there are at most  <span class="math">\\frac{p^2-1}{2}</span>  such roots since  <span class="math">\\mathbb{F}_{p^2}</span>  is a field. On the other hand, because of Lagrange theorem, all the squares of  <span class="math">\\mathbb{F}_{p^2}^*</span>  are in  <span class="math">\\ker \\varphi</span>  and we saw that there are  <span class="math">\\frac{p^2-1}{2}</span>  of them. This means  <span class="math">\\ker \\varphi</span>  is exactly the set of squares in  <span class="math">\\mathbb{F}_{p^2}^*</span>  so that a is a square.</p>

    <p class="text-gray-300">The proof is essentially the same for cubes where the kernel of  <span class="math">\\psi</span>  is made of third roots of unity which are all lying in  <span class="math">\\mathbb{F}_{p^2}</span>  since  <span class="math">3|p^2-1</span> . The condition  <span class="math">p=1 \\mod 3</span>  is necessary to raise a to the  <span class="math">\\frac{p-1}{3}</span> .</p>

    <p class="text-gray-300">Corollary 1. Let p be an odd prime number and  <span class="math">n \\in \\mathbb{F}_p</span> , then n is always a square in  <span class="math">\\mathbb{F}_{p^2}</span> .</p>

    <p class="text-gray-300"><em>Proof.</em>  <span class="math">N_{\\mathbb{F}_{p^2}/\\mathbb{F}_p}(n) = n^2</span>  is a square in  <span class="math">\\mathbb{F}_p</span>  so that n is a square in  <span class="math">\\mathbb{F}_{p^2}</span>  according to proposition 3.</p>

    </section>
`;
---

<BaseLayout title="Choosing and generating parameters for low level pairing imp... (2015/1212)">
  <article class="max-w-4xl mx-auto article-prose">
    <nav class="mb-8">
      <a href="/papers" class="text-blue-400 hover:text-blue-300">
        &larr; Back to Papers
      </a>
    </nav>

    <header class="mb-12">
      <h1 class="text-3xl font-bold mb-4"
        set:html={TITLE_HTML} />
      <p class="text-gray-400 mb-2"
        set:html={AUTHORS_HTML} />
      <p class="text-gray-500 text-sm mb-4">
        2015 &middot; eprint 2015/1212
      </p>
      <div class="flex gap-4 text-sm">
        <a
          href={EPRINT_URL}
          target="_blank"
          rel="noopener noreferrer"
          class="text-blue-400 hover:text-blue-300"
        >
          Paper (eprint) &rarr;
        </a>
      </div>
      <PaperDisclaimer eprintUrl={EPRINT_URL} />
      <p class="mt-1 text-xs text-gray-600">
        Converted with: {CRAWLER} &middot; {CONVERTED_DATE}
      </p>
    </header>

    <nav id="toc" class="mb-10 p-6 rounded-lg" style="background: rgba(255,255,255,0.03); border: 1px solid rgba(255,255,255,0.06);">
      <h2 class="text-lg font-bold mb-4">Table of Contents</h2>
      <ol class="space-y-1 text-sm text-gray-300
        list-decimal list-inside">
        <li><a href="#abstract" class="hover:text-white">Abstract</a></li>
        <li><a href="#sec-1" class="hover:text-white">Introduction</a></li>
        <li>
          <a href="#sec-2" class="hover:text-white">Background</a>
          <ol class="ml-6 mt-1 space-y-1 list-decimal
            list-inside text-gray-400">
            <li><a href="#sec-2.1" class="hover:text-white">BN curves</a></li>
            <li><a href="#sec-2.2" class="hover:text-white">Optimal Ate pairing</a></li>
            <li><a href="#sec-2.3" class="hover:text-white">The Miller loop</a></li>
            <li><a href="#sec-2.4" class="hover:text-white">The final exponentiation</a></li>
          </ol>
        </li>
        <li>
          <a href="#sec-3" class="hover:text-white">Choosing the finite fields and their arithmetic</a>
          <ol class="ml-6 mt-1 space-y-1 list-decimal
            list-inside text-gray-400">
            <li><a href="#sec-3.1" class="hover:text-white">\mathbb&#123;F&#125;_p arithmetic</a></li>
            <li><a href="#sec-3.2" class="hover:text-white">Arithmetic of \mathbb&#123;F&#125;_&#123;p^&#123;2i&#125;&#125;/\mathbb&#123;F&#125;_&#123;p^i&#125;</a></li>
            <li><a href="#sec-3.2.1" class="hover:text-white">\mathbb&#123;F&#125;_&#123;p^&#123;2i&#125;&#125; addition</a></li>
            <li><a href="#sec-3.2.2" class="hover:text-white">\mathbb&#123;F&#125;_&#123;p^&#123;2i&#125;&#125; multiplication</a></li>
            <li><a href="#sec-3.2.3" class="hover:text-white">\mathbb&#123;F&#125;_&#123;p^&#123;2i&#125;&#125; squaring</a></li>
            <li><a href="#sec-3.2.4" class="hover:text-white">\mathbb&#123;F&#125;_&#123;p^&#123;2i&#125;&#125; inversion</a></li>
            <li><a href="#sec-3.3" class="hover:text-white">Arithmetic of \mathbb&#123;F&#125;_&#123;p^&#123;3i&#125;&#125;/\mathbb&#123;F&#125;_&#123;p^i&#125;</a></li>
            <li><a href="#sec-3.3.1" class="hover:text-white">Fp3i addition</a></li>
            <li><a href="#sec-3.3.2" class="hover:text-white">Fp3i multiplication</a></li>
            <li><a href="#sec-3.3.3" class="hover:text-white">Squaring</a></li>
            <li><a href="#sec-3.4" class="hover:text-white">Building \mathbb&#123;F&#125;_&#123;p^&#123;12&#125;&#125;</a></li>
            <li><a href="#sec-3.5" class="hover:text-white">Choice of \mathbb&#123;F&#125;_&#123;p^2&#125; and its arithmetic</a></li>
            <li><a href="#sec-3.5.1" class="hover:text-white">Choice of \mu and consequences on u</a></li>
            <li><a href="#sec-3.5.2" class="hover:text-white">Summary of choices and complexities for \mathbb&#123;F&#125;_&#123;p^2&#125; arithmetic</a></li>
            <li><a href="#sec-3.6" class="hover:text-white">Choice of Fp 12 arithmetic in the case 2, 3, 2</a></li>
            <li><a href="#sec-3.6.1" class="hover:text-white">Fp6 arithmetic</a></li>
            <li><a href="#sec-3.6.2" class="hover:text-white">Fp12 arithmetic</a></li>
            <li><a href="#sec-3.7" class="hover:text-white">Choice of Fp 12 arithmetic in the case 2, 2, 3</a></li>
            <li><a href="#sec-3.7.1" class="hover:text-white">\mathbb&#123;F&#125;_&#123;p^4&#125; arithmetic</a></li>
            <li><a href="#sec-3.7.2" class="hover:text-white">\mathbb&#123;F&#125;_&#123;p^&#123;12&#125;&#125; arithmetic</a></li>
            <li><a href="#sec-3.8" class="hover:text-white">Choice of &xi; and consequences on u</a></li>
            <li><a href="#sec-3.8.1" class="hover:text-white">The case \mu = -1</a></li>
            <li><a href="#sec-3.8.2" class="hover:text-white">The case \mu = -2</a></li>
            <li><a href="#sec-3.8.3" class="hover:text-white">The case \mu = -5</a></li>
            <li><a href="#sec-3.8.4" class="hover:text-white">Recapitulative table</a></li>
            <li><a href="#sec-3.9" class="hover:text-white">New improvements of \mathbb&#123;F&#125;_&#123;p^&#123;12&#125;&#125; arithmetic</a></li>
            <li><a href="#sec-3.9.1" class="hover:text-white">Multiplications by \xi - 1 in Karatsuba operations</a></li>
            <li><a href="#sec-3.9.2" class="hover:text-white">Precomputed traces</a></li>
            <li><a href="#sec-3.9.3" class="hover:text-white">Use of precomputed traces in \mathbb&#123;F&#125;_&#123;p^&#123;12&#125;&#125; squarings</a></li>
            <li><a href="#sec-3.9.4" class="hover:text-white">Use of precomputed traces in \mathbb&#123;F&#125;_&#123;p^&#123;12&#125;&#125; sparse multiplications</a></li>
            <li><a href="#sec-3.9.5" class="hover:text-white">Use of precomputed traces in the final exponentiation</a></li>
            <li><a href="#sec-3.10" class="hover:text-white">Summary of \mathbb&#123;F&#125;_&#123;p^&#123;12&#125;&#125; arithmetic</a></li>
            <li><a href="#sec-3.10.1" class="hover:text-white">The case \mu = -1</a></li>
            <li><a href="#sec-3.10.2" class="hover:text-white">The case \mu = -2</a></li>
            <li><a href="#sec-3.10.3" class="hover:text-white">The case \mu = -5</a></li>
            <li><a href="#sec-3.10.4" class="hover:text-white">The case \mu large</a></li>
            <li><a href="#sec-3.10.5" class="hover:text-white">Some remarks</a></li>
          </ol>
        </li>
        <li><a href="#sec-4" class="hover:text-white">Choosing u</a></li>
        <li>
          <a href="#sec-5" class="hover:text-white">Choosing the groups involved</a>
          <ol class="ml-6 mt-1 space-y-1 list-decimal
            list-inside text-gray-400">
            <li><a href="#sec-5.1" class="hover:text-white">Choosing the elliptic curve</a></li>
            <li><a href="#sec-5.2" class="hover:text-white">Choosing the generators</a></li>
          </ol>
        </li>
        <li>
          <a href="#sec-6" class="hover:text-white">Choosing the system of coordinates</a>
          <ol class="ml-6 mt-1 space-y-1 list-decimal
            list-inside text-gray-400">
            <li><a href="#sec-6.1" class="hover:text-white">Affine coordinates</a></li>
            <li><a href="#sec-6.2" class="hover:text-white">Projective coordinates</a></li>
            <li><a href="#sec-6.3" class="hover:text-white">Consequences of formulas</a></li>
          </ol>
        </li>
        <li>
          <a href="#sec-7" class="hover:text-white">Algorithms that must be used for efficient implementation</a>
          <ol class="ml-6 mt-1 space-y-1 list-decimal
            list-inside text-gray-400">
            <li><a href="#sec-7.1" class="hover:text-white">Frobenius computation</a></li>
            <li><a href="#sec-7.1.1" class="hover:text-white">Computation of a^p</a></li>
            <li><a href="#sec-7.1.2" class="hover:text-white">Computation of a^&#123;p^2&#125;</a></li>
            <li><a href="#sec-7.1.3" class="hover:text-white">Generalization to the computation of a^&#123;p^i&#125;</a></li>
            <li><a href="#sec-7.1.4" class="hover:text-white">Simplification of the constant \delta for odd powers</a></li>
            <li><a href="#sec-7.2" class="hover:text-white">Cyclotomic squaring</a></li>
            <li><a href="#sec-7.2.1" class="hover:text-white">Karabina&#x27;s method</a></li>
            <li><a href="#sec-7.2.2" class="hover:text-white">Granger and Scott&#x27;s method</a></li>
          </ol>
        </li>
        <li><a href="#sec-8" class="hover:text-white">Conclusion</a></li>
      </ol>
      <p class="text-xs text-gray-500 mt-4 mb-1 font-semibold">
        Appendices
      </p>
      <ol class="space-y-1 text-sm text-gray-400
        list-[upper-alpha] list-inside">
        <li><a href="#app-a" class="hover:text-white">Appendix</a></li>
      </ol>
      <p class="text-xs text-gray-500 mt-4 mb-1 font-semibold">
        Additional
      </p>
      <ul class="space-y-1 text-sm text-gray-400
        list-disc list-inside">
        <li><a href="#references" class="hover:text-white">References</a></li>
      </ul>
    </nav>


    <Fragment set:html={CONTENT} />

    <PaperHistory slug="choosing-and-generating-parameters-for-low-level-pairing-2015" />
  </article>
</BaseLayout>
