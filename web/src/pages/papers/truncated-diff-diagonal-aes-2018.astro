---
import BaseLayout from '../../layouts/BaseLayout.astro';

const EPRINT_URL = 'https://eprint.iacr.org/2018/182';
const CRAWLER = 'marker';
const CONVERTED_DATE = '2026-02-14';
---

<BaseLayout title="Truncated Differential Properties of the Diagonal Set of Inputs for 5-round AES (2018/182)">
  <article class="max-w-4xl mx-auto article-prose">
    <nav class="mb-8">
      <a href="/papers" class="text-blue-400 hover:text-blue-300">
        &larr; Back to Papers
      </a>
    </nav>

    <!-- ============================================================ -->
    <!-- HEADER                                                       -->
    <!-- ============================================================ -->

    <header class="mb-12">
      <h1 class="text-3xl font-bold mb-4">
        Truncated Differential Properties of the Diagonal Set of
        Inputs for 5-round AES
      </h1>
      <p class="text-gray-400 mb-2">
        Lorenzo Grassi and Christian Rechberger
      </p>
      <p class="text-gray-500 text-sm mb-4">
        2018 &middot; Extended Version &middot; eprint 2018/182
      </p>
      <div class="flex gap-4 text-sm">
        <a
          href={EPRINT_URL}
          target="_blank"
          rel="noopener noreferrer"
          class="text-blue-400 hover:text-blue-300"
        >
          Paper (eprint) &rarr;
        </a>
      </div>
      <p class="mt-4 text-xs text-gray-500">
        All content below belongs to the original authors. This page
        reproduces the paper for educational purposes. Always
        <a
          href={EPRINT_URL}
          target="_blank"
          rel="noopener noreferrer"
          class="text-blue-400 hover:text-blue-300"
        >cite the original</a>.
      </p>
      <p class="mt-1 text-xs text-gray-600">Converted with: {CRAWLER} &middot; {CONVERTED_DATE}</p>
    </header>

    <!-- ============================================================ -->
    <!-- TABLE OF CONTENTS                                            -->
    <!-- ============================================================ -->

    <nav id="toc" class="mb-10 p-6 rounded-lg"
      style="background: rgba(255,255,255,0.03);
             border: 1px solid rgba(255,255,255,0.06);">
      <h2 class="text-lg font-bold mb-4">Table of Contents</h2>
      <ol class="space-y-1 text-sm text-gray-300
        list-decimal list-inside">
        <li>
          <a href="#abstract"
            class="hover:text-white">Abstract</a>
        </li>
        <li>
          <a href="#sec-1"
            class="hover:text-white">Introduction</a>
          <ol class="ml-6 mt-1 space-y-1 list-decimal
            list-inside text-gray-400">
            <li>
              <a href="#sec-1.1"
                class="hover:text-white">Contributions</a>
            </li>
            <li>
              <a href="#sec-1.2"
                class="hover:text-white">Follow-Up Works</a>
            </li>
          </ol>
        </li>
        <li>
          <a href="#sec-2"
            class="hover:text-white">Preliminary</a>
          <ol class="ml-6 mt-1 space-y-1 list-decimal
            list-inside text-gray-400">
            <li>
              <a href="#sec-2.1"
                class="hover:text-white">
                Advanced Encryption Standard (AES)</a>
            </li>
            <li>
              <a href="#sec-2.2"
                class="hover:text-white">
                Properties of an S-Box</a>
            </li>
          </ol>
        </li>
        <li>
          <a href="#sec-3"
            class="hover:text-white">
            Probability Distribution for 5-round AES</a>
          <ol class="ml-6 mt-1 space-y-1 list-decimal
            list-inside text-gray-400">
            <li>
              <a href="#sec-3.1"
                class="hover:text-white">
                Truncated Differentials for 2-round AES</a>
            </li>
            <li>
              <a href="#sec-3.2"
                class="hover:text-white">
                Multiple-of-8 Property and Mixture Differential</a>
            </li>
            <li>
              <a href="#sec-3.3"
                class="hover:text-white">
                Main Result: Probability Distribution</a>
            </li>
          </ol>
        </li>
        <li>
          <a href="#sec-4"
            class="hover:text-white">Initial Considerations</a>
        </li>
        <li>
          <a href="#sec-5"
            class="hover:text-white">
            Proof of Theorem 4: Sum of Binomial Distributions</a>
        </li>
        <li>
          <a href="#sec-6"
            class="hover:text-white">
            Proof of Theorem 4: About the Probabilities</a>
          <ol class="ml-6 mt-1 space-y-1 list-decimal
            list-inside text-gray-400">
            <li>
              <a href="#sec-6.1"
                class="hover:text-white">
                Reduction to the Middle Round</a>
            </li>
            <li>
              <a href="#sec-6.2"
                class="hover:text-white">
                A &ldquo;Simpler&rdquo; Case</a>
            </li>
            <li>
              <a href="#sec-6.3"
                class="hover:text-white">
                Generic Case</a>
            </li>
          </ol>
        </li>
        <li>
          <a href="#sec-7"
            class="hover:text-white">
            Practical Results for 5-round AES</a>
        </li>
        <li>
          <a href="#sec-8"
            class="hover:text-white">
            Truncated Differential Distinguishers</a>
        </li>
      </ol>
      <p class="text-xs text-gray-500 mt-4 mb-1 font-semibold">
        Additional
      </p>
      <ul class="space-y-1 text-sm text-gray-400 list-disc
        list-inside">
        <li>
          <a href="#acknowledgements"
            class="hover:text-white">Acknowledgements</a>
        </li>
        <li>
          <a href="#references"
            class="hover:text-white">References</a>
        </li>
      </ul>
    </nav>

    <!-- ============================================================ -->
    <!-- ABSTRACT                                                     -->
    <!-- ============================================================ -->

    <section id="abstract" class="mb-10">
      <h2 class="text-2xl font-bold">Abstract</h2>
      <p class="text-gray-300">
        In the last couple of years, a new wave of results appeared,
        proposing and exploiting new properties of round-reduced AES.
        In this paper we survey and combine some of these results
        (namely, the multiple-of-<span class="math">n</span> property
        and the mixture differential cryptanalysis) in a systematic way
        in order to answer more general questions regarding the
        probability distribution of encrypted diagonal sets. This
        allows to analyze this special set of inputs, and report on new
        properties regarding the probability distribution of the number
        of different pairs of corresponding ciphertexts are equal in
        certain anti-diagonal(s) after 5 rounds.
      </p>
      <p class="text-gray-300">
        An immediate corollary of the multiple-of-8 property is that
        the variance of such a distribution can be shown to be higher
        than for a random permutation. Surprisingly, also the mean of
        the distribution is significantly different from random,
        something which cannot be explained by the multiple-of-8
        property. We propose a theoretical explanation of this, by
        assuming an APN-like assumption on the S-Box which closely
        resembles the AES-Sbox. By combining the multiple-of-8
        property, the mixture differential approach, and the results
        just mentioned about the mean and the variance, we are finally
        able to formulate the probability distribution of the diagonal
        set after 5-round AES as a sum of independent binomial
        distributions.
      </p>
      <p class="text-gray-300">
        <strong>Keywords:</strong> AES &ndash; Truncated-Differential
        Cryptanalysis &ndash; Distinguisher
      </p>
    </section>

    <!-- ============================================================ -->
    <!-- 1. INTRODUCTION                                              -->
    <!-- ============================================================ -->

    <section id="sec-1" class="mb-10">
      <h2 class="text-2xl font-bold">1. Introduction</h2>
      <p class="text-gray-300">
        AES (Advanced Encryption Standard) [DaemenRijmen02] is probably the most
        used and studied block cipher. Since the development of
        cryptanalysis of AES and AES-like constructions in the late
        1990s, the set of input which differ only in one diagonal has
        special importance. Indeed, it appears in several attacks and
        distinguishers, including various (truncated) differential
        [Lai94, Knudsen95], integral [DaemenKnudsenRijmen97], and impossible differential attacks
        [BihamBiryukovShamir99], among others. In particular, given a diagonal set of
        plaintexts and the corresponding ciphertexts after 4 rounds,
        it is well known that the XOR-sum of the ciphertexts is equal
        to zero [DaemenKnudsenRijmen97], or that each pair of ciphertexts cannot be equal
        in any of the four anti-diagonals, as shown by Biham and
        Keller in [BihamKeller01].
      </p>
      <p class="text-gray-300">
        While a lot is known about the encryption of a diagonal set of
        plaintexts for up to 4-round AES, an analysis for 5 or more
        rounds AES is still missing. At Eurocrypt 2017, a new property
        which is independent of the secret key has been found for
        5-round AES [GrassiRechbergerRonjom17]. By appropriate choices of a number of input
        pairs, it is possible to make sure that the number of times
        that the difference of the resulting output pairs lie in a
        particular subspace
        <span class="math">\mathcal&#123;ID&#125;</span> is always a
        multiple of 8.
      </p>
      <p class="text-gray-300">
        In this paper, given a diagonal set of plaintexts, we consider
        the probability distribution of the corresponding number of
        pairs of ciphertexts that are equal in one fixed anti-diagonal
        after 5-round AES (without the final MixColumns operation).
      </p>

      <h3 id="sec-1.1" class="text-xl font-semibold mt-8 mb-3">
        1.1 Contributions
      </h3>
      <p class="text-gray-300">
        As the main contribution, we perform for the first time a
        differential analysis of such distribution after 5-round AES,
        and find significant deviations from random, supported by
        practical implementations and verification. For a theoretical
        explanation we have to resort to an APN-like assumption on the
        S-Box, which closely resembles the AES-Sbox.
      </p>
      <p class="text-gray-300">
        <strong>Mean of 5-round AES.</strong> By an appropriate choice
        of <span class="math">2^&#123;32&#125;</span> plaintexts in a
        diagonal space
        <span class="math">\mathcal&#123;D&#125;</span>, the authors
        prove that the average number of times that the resulting
        output pairs are equal in one fixed anti-diagonal is slightly
        bigger for 5-round AES than for a random permutation,
        independently of the secret key.
      </p>
      <p class="text-gray-300">
        <strong>Variance of 5-round AES.</strong> The variance of the
        probability distribution is shown to be higher (by a factor of
        approximately 36) for 5-round AES than for a random
        permutation, mainly due to the &ldquo;multiple-of-8&rdquo;
        result [GrassiRechbergerRonjom17].
      </p>
      <p class="text-gray-300">
        <strong>Probability Distribution of 5-round AES.</strong> By
        combining the multiple-of-8 property, the mixture differential
        cryptanalysis, and the results about the mean and the variance,
        the probability distribution is shown to be well described by
        a sum of independent binomial distributions.
      </p>

      <h3 id="sec-1.2" class="text-xl font-semibold mt-8 mb-3">
        1.2 Follow-Up Works: Truncated Differentials for
        5-/6-round AES
      </h3>
      <p class="text-gray-300">
        In [BaoGuoList20], Bao, Guo and List presented &ldquo;extended
        expectation cryptanalysis&rdquo; on round-reduced AES. The
        technique is based on results by Patarin [Patarin13], who observed
        that the expected number of collisions differs slightly for a
        sum of permutations from the ideal. In [BardehRonjom19], Bardeh and
        R&oslash;njom developed the &ldquo;exchange equivalence
        attack&rdquo; for up to 6-round AES, with complexity of about
        <span class="math">2^&#123;88.2&#125;</span> computations and
        chosen texts.
      </p>
    </section>

    <!-- ============================================================ -->
    <!-- 2. PRELIMINARY                                               -->
    <!-- ============================================================ -->

    <section id="sec-2" class="mb-10">
      <h2 class="text-2xl font-bold">2. Preliminary</h2>

      <h3 id="sec-2.1" class="text-xl font-semibold mt-8 mb-3">
        2.1 Advanced Encryption Standard (AES)
      </h3>
      <p class="text-gray-300">
        AES [DaemenRijmen02] is a Substitution-Permutation network based on the
        &ldquo;Wide Trail Design&rdquo; strategy [DaemenRijmen02a], that supports
        key sizes of 128, 192 and 256 bits. The 128-bit plaintext
        initializes the internal state as a
        <span class="math">4 \times 4</span> matrix of bytes as values
        in the finite field
        <span class="math">\mathbb&#123;F&#125;_&#123;2^8&#125;</span>.
        Depending on the version of AES,
        <span class="math">N_r</span> rounds are applied to the state:
        <span class="math">N_r = 10</span> for AES-128,
        <span class="math">N_r = 12</span> for AES-192 and
        <span class="math">N_r = 14</span> for AES-256. An AES round
        applies four operations to the state matrix:
      </p>
      <ul class="list-disc list-inside text-gray-300 space-y-1 ml-4">
        <li>
          <strong>SubBytes (S-Box)</strong> applying the same 8-bit to
          8-bit invertible S-Box 16 times in parallel on each byte of
          the state;
        </li>
        <li>
          <strong>ShiftRows (SR)</strong> cyclic shift of each row to
          the left;
        </li>
        <li>
          <strong>MixColumns (MC)</strong> multiplication of each column
          by a constant
          <span class="math">4 \times 4</span> invertible matrix;
        </li>
        <li>
          <strong>AddRoundKey (ARK)</strong> XORing the state with a
          128-bit subkey
          <span class="math">k</span>.
        </li>
      </ul>
      <p class="text-gray-300">
        One round of AES can be described as
        <span class="math">R(x) = k \oplus MC \circ SR \circ \text&#123;S-Box&#125;(x)</span>.
        In the first round an additional AddRoundKey operation is
        applied, and in the last round the MixColumns operation is
        omitted.
      </p>
      <p class="text-gray-300">
        <strong>Notation.</strong> Let
        <span class="math">x</span> denote a plaintext, ciphertext, or
        intermediate state. Then
        <span class="math">x_&#123;i,j&#125;</span> with
        <span class="math">i,j \in \&#123;0,\ldots,3\&#125;</span>
        denotes the byte in row
        <span class="math">i</span> and column
        <span class="math">j</span>. We denote by
        <span class="math">R</span> one round of AES (and
        <span class="math">R_f</span> if MixColumns is omitted), while
        <span class="math">R^r</span> denotes
        <span class="math">r</span> rounds. The
        <span class="math">i</span>-th diagonal of a
        <span class="math">4 \times 4</span> matrix
        <span class="math">A</span> is defined as the elements on row
        <span class="math">r</span> and column
        <span class="math">c</span> such that
        <span class="math">r - c \equiv_4 i</span>. The
        <span class="math">i</span>-th anti-diagonal is defined by
        <span class="math">r + c \equiv_4 i</span>.
      </p>

      <h3 id="sec-2.2" class="text-xl font-semibold mt-8 mb-3">
        2.2 Properties of an S-Box
      </h3>
      <p class="text-gray-300">
        Given a bijective S-Box function on
        <span class="math">\mathbb&#123;F&#125;_&#123;2^n&#125;</span>,
        let
        <span class="math">\Delta_I, \Delta_O \in \mathbb&#123;F&#125;_&#123;2^n&#125;</span>.
        Let
        <span class="math">N_&#123;\Delta_I, \Delta_O&#125;</span>
        denote the number of solutions of the equation
      </p>
      <div class="math-block">
        \text&#123;S-Box&#125;(x \oplus \Delta_I) \oplus
        \text&#123;S-Box&#125;(x) = \Delta_O
      </div>
      <p class="text-gray-300">
        for each
        <span class="math">\Delta_I \neq 0</span> and
        <span class="math">\Delta_O \neq 0</span>.
      </p>
      <p class="text-gray-300">
        <strong>Mean Value.</strong> Independently of the details of
        the S-Box, the mean value of
        <span class="math">N_&#123;\Delta_I,\Delta_O&#125;</span> is
        equal to
        <span class="math">\mathbb&#123;E&#125;[N_&#123;\Delta_I,\Delta_O&#125;] = \frac&#123;2^n&#125;&#123;2^n - 1&#125;</span>.
      </p>
      <p class="text-gray-300">
        <strong>Variance.</strong> The variance
        <span class="math">\text&#123;Var&#125;(N_&#123;\Delta_I,\Delta_O&#125;)</span>
        depends on the details of the S-Box. For the AES S-Box, for
        each
        <span class="math">\Delta_I \neq 0</span> there are 128
        values of
        <span class="math">\Delta_O \neq 0</span> for which the
        equation has no solution, 126 values with 2 solutions, and 1
        value with 4 solutions. The variance for the AES S-Box is
        <span class="math">\text&#123;Var&#125;_&#123;AES&#125;(N_&#123;\Delta_I,\Delta_O&#125;) = \frac&#123;67064&#125;&#123;65025&#125;</span>.
      </p>
      <p class="text-gray-300">
        <strong>Maximum Differential Probability.</strong> The Maximum
        Differential Probability
        <span class="math">\text&#123;DP&#125;_&#123;\max&#125;</span>
        of an S-Box is defined as
      </p>
      <div class="math-block">
        \text&#123;DP&#125;_&#123;\max&#125; = 2^&#123;-n&#125; \cdot
        \max_&#123;\Delta_I \neq 0, \Delta_O&#125;
        N_&#123;\Delta_I, \Delta_O&#125;.
      </div>
      <p class="text-gray-300">
        Since
        <span class="math">\max_&#123;\Delta_I \neq 0, \Delta_O&#125; N_&#123;\Delta_I, \Delta_O&#125; \geq 2</span>,
        <span class="math">\text&#123;DP&#125;_&#123;\max&#125;</span>
        is always at least
        <span class="math">2^&#123;-n+1&#125;</span>. Permutations
        with
        <span class="math">\text&#123;DP&#125;_&#123;\max&#125; = 2^&#123;-n+1&#125;</span>
        are called Almost Perfect Nonlinear (APN).
      </p>
      <p class="text-gray-300">
        <strong>&ldquo;Homogeneous&rdquo; S-Box.</strong> Given
        <span class="math">\Delta_I \neq 0</span>, we say the S-Box
        is (differential) &ldquo;homogeneous&rdquo; if the probability
        distribution of
        <span class="math">N_&#123;\Delta_I,\Delta_O&#125;</span> with
        respect to
        <span class="math">\Delta_O \neq 0</span> is independent of
        <span class="math">\Delta_I</span>. The AES S-Box is
        differential &ldquo;homogeneous&rdquo;, while the PRINCE S-Box
        is not.
      </p>
    </section>

    <!-- ============================================================ -->
    <!-- 3. PROBABILITY DISTRIBUTION FOR 5-ROUND AES                  -->
    <!-- ============================================================ -->

    <section id="sec-3" class="mb-10">
      <h2 class="text-2xl font-bold">
        3. Probability Distribution for 5-round AES
      </h2>
      <p class="text-gray-300">
        In this section, we first recall some results already published
        in the literature about round-reduced AES. Then, given a
        diagonal space of
        <span class="math">2^&#123;32&#125;</span> plaintexts with one
        active diagonal, we present the probability distribution of the
        number of different pairs of ciphertexts which are equal in one
        fixed anti-diagonal after 5-round AES (without the final
        MixColumns operation).
      </p>

      <h3 id="sec-3.1" class="text-xl font-semibold mt-8 mb-3">
        3.1 Truncated Differentials for 2-round AES
      </h3>

      <div class="formal-block formal-block-definition">
        <div class="formal-block-title text-blue-400">
          Definition 1
        </div>
        <div class="formal-block-content">
          <p class="text-gray-300">
            For each
            <span class="math">i \in \&#123;0, 1, 2, 3\&#125;</span>:
          </p>
          <ul class="list-disc list-inside text-gray-300 space-y-1
            ml-4">
            <li>
              The column spaces
              <span class="math">\mathcal&#123;C&#125;_i</span> are
              defined as
              <span class="math">\mathcal&#123;C&#125;_i = \langle e_&#123;0,i&#125;, e_&#123;1,i&#125;, e_&#123;2,i&#125;, e_&#123;3,i&#125; \rangle</span>.
            </li>
            <li>
              The diagonal spaces
              <span class="math">\mathcal&#123;D&#125;_i</span> are
              defined as
              <span class="math">\mathcal&#123;D&#125;_i = SR^&#123;-1&#125;(\mathcal&#123;C&#125;_i)</span>.
              Similarly, the inverse-diagonal spaces
              <span class="math">\mathcal&#123;ID&#125;_i</span> are
              defined as
              <span class="math">\mathcal&#123;ID&#125;_i = SR(\mathcal&#123;C&#125;_i)</span>.
            </li>
            <li>
              The <span class="math">i</span>-th mixed spaces
              <span class="math">\mathcal&#123;M&#125;_i</span> are
              defined as
              <span class="math">\mathcal&#123;M&#125;_i = MC(\mathcal&#123;ID&#125;_i)</span>.
            </li>
          </ul>
        </div>
      </div>

      <div class="formal-block formal-block-definition">
        <div class="formal-block-title text-blue-400">
          Definition 2
        </div>
        <div class="formal-block-content">
          <p class="text-gray-300">
            For each
            <span class="math">I \subseteq \&#123;0, 1, 2, 3\&#125;</span>,
            let
            <span class="math">\mathcal&#123;C&#125;_I</span>,
            <span class="math">\mathcal&#123;D&#125;_I</span>,
            <span class="math">\mathcal&#123;ID&#125;_I</span> and
            <span class="math">\mathcal&#123;M&#125;_I</span> be
            defined as
          </p>
          <div class="math-block">
            \mathcal&#123;C&#125;_I = \bigoplus_&#123;i \in I&#125;
            \mathcal&#123;C&#125;_i, \quad
            \mathcal&#123;D&#125;_I = \bigoplus_&#123;i \in I&#125;
            \mathcal&#123;D&#125;_i, \quad
            \mathcal&#123;ID&#125;_I = \bigoplus_&#123;i \in I&#125;
            \mathcal&#123;ID&#125;_i, \quad
            \mathcal&#123;M&#125;_I = \bigoplus_&#123;i \in I&#125;
            \mathcal&#123;M&#125;_i.
          </div>
        </div>
      </div>

      <div class="formal-block formal-block-definition">
        <div class="formal-block-title text-blue-400">
          Definition 3
        </div>
        <div class="formal-block-content">
          <p class="text-gray-300">
            Let
            <span class="math">t \in \mathbb&#123;F&#125;_&#123;2^n&#125;^&#123;4 \times 4&#125;</span>
            be a text in a coset of a space
            <span class="math">\mathcal&#123;X&#125; \subseteq \mathbb&#123;F&#125;_&#123;2^n&#125;^&#123;4 \times 4&#125;</span>
            such that
            <span class="math">\mathcal&#123;X&#125; = \langle x_0, x_1, \dots, x_&#123;d-1&#125; \rangle</span>
            where
            <span class="math">\dim(\mathcal&#123;X&#125;) = d</span>,
            namely
            <span class="math">t \in \mathcal&#123;X&#125; \oplus \gamma</span>.
            Given <span class="math">\gamma</span>,
            <span class="math">(t_0, t_1, \ldots, t_&#123;d-1&#125;) \in \mathbb&#123;F&#125;_&#123;2^n&#125;^d</span>
            are the <em>generating variables</em> of
            <span class="math">t</span> if
          </p>
          <div class="math-block">
            t \equiv (t_0, t_1, \dots, t_&#123;d-1&#125;) \quad
            \text&#123;if and only if&#125; \quad t = \gamma \oplus
            \bigoplus_&#123;j=0&#125;^&#123;d-1&#125; t_j \cdot x_j.
          </div>
        </div>
      </div>

      <div class="formal-block formal-block-theorem">
        <div class="formal-block-title text-green-400">
          Theorem 1 <span class="text-gray-400">[GrassiRechbergerRonjom17a]</span>
        </div>
        <div class="formal-block-content">
          <p class="text-gray-300">
            For each
            <span class="math">I \subseteq \&#123;0,1,2,3\&#125;</span>
            and for each
            <span class="math">\alpha \in \mathbb&#123;F&#125;_&#123;2^8&#125;^&#123;4 \times 4&#125;</span>,
            there exists
            <span class="math">\beta \in \mathbb&#123;F&#125;_&#123;2^8&#125;^&#123;4 \times 4&#125;</span>
            such that
            <span class="math">R^2(\mathcal&#123;D&#125;_I \oplus \alpha) = \mathcal&#123;M&#125;_I \oplus \beta</span>.
            Equivalently:
          </p>
          <div class="math-block">
            \Pr(R^2(x) \oplus R^2(y) \in \mathcal&#123;M&#125;_I
            \mid x \oplus y \in \mathcal&#123;D&#125;_I) = 1.
          </div>
        </div>
      </div>

      <!-- 3.2 Multiple-of-8 Property -->
      <h3 id="sec-3.2" class="text-xl font-semibold mt-8 mb-3">
        3.2 Multiple-of-8 Property and Mixture Differential
        Cryptanalysis
      </h3>

      <div class="formal-block formal-block-theorem">
        <div class="formal-block-title text-green-400">
          Theorem 2 <span class="text-gray-400">[GrassiRechbergerRonjom17]</span>
        </div>
        <div class="formal-block-content">
          <p class="text-gray-300">
            Let
            <span class="math">\&#123;p^i\&#125;_&#123;i \in \&#123;0,1,\ldots,2^&#123;32 \cdot d&#125;-1\&#125;\&#125;</span>
            be
            <span class="math">2^&#123;32 \cdot d&#125;</span>
            plaintexts with
            <span class="math">1 \leq d \leq 3</span> active
            diagonals, or equivalently in the same coset of a diagonal
            subspace
            <span class="math">\mathcal&#123;D&#125;_I</span> for a
            certain
            <span class="math">I \subseteq \&#123;0,1,2,3\&#125;</span>
            with
            <span class="math">|I| = d</span>. Consider the
            corresponding ciphertexts after 5 rounds (without the final
            MixColumns operation), that is,
            <span class="math">(p^i, c^i)</span> for
            <span class="math">i \in \&#123;0,\ldots,2^&#123;32 \cdot |I|&#125;-1\&#125;</span>
            where
            <span class="math">c^i = R_f^5(p^i)</span>. The number of
            different pairs of ciphertexts
            <span class="math">(c^i, c^j)</span> that are equal in
            <span class="math">1 \le a \le 3</span> anti-diagonals
            (i.e., that belong to the same coset of a subspace
            <span class="math">\mathcal&#123;ID&#125;_J</span> for a
            certain
            <span class="math">J \subseteq \&#123;0,1,2,3\&#125;</span>
            with
            <span class="math">|J| = 4 - a</span>) is always a
            multiple of 8, independently of the secret key, of the
            details of the S-Box and of the MixColumns matrix.
          </p>
        </div>
      </div>

      <div class="formal-block formal-block-theorem">
        <div class="formal-block-title text-green-400">
          Theorem 3 <span class="text-gray-400">[Grassi18]</span>
        </div>
        <div class="formal-block-content">
          <p class="text-gray-300">
            Let
            <span class="math">t^1, t^2</span> be two texts in
            <span class="math">\mathcal&#123;C&#125;_i \oplus \gamma</span>
            for a certain
            <span class="math">i \in \&#123;0, 1, 2, 3\&#125;</span>,
            namely two plaintexts that differ in the
            <span class="math">i</span>-th column only. Let
            <span class="math">t^1 \equiv (x_0^1, x_1^1, x_2^1, x_3^1)</span>
            and
            <span class="math">t^2 \equiv (x_0^2, x_1^2, x_2^2, x_3^2)</span>
            be their generating variables. Let
            <span class="math">s^1, s^2 \in \mathcal&#123;C&#125;_i \oplus \gamma</span>
            be defined such that for each
            <span class="math">i</span>:
          </p>
          <ul class="list-disc list-inside text-gray-300 space-y-1
            ml-4">
            <li>
              if
              <span class="math">x_i^1 \neq x_i^2</span>: the
              <span class="math">i</span>-th generating variable
              <span class="math">s_i^1</span> of
              <span class="math">s^1</span> is either
              <span class="math">x_i^1</span> or
              <span class="math">x_i^2</span>, and the
              <span class="math">i</span>-th generating variable of
              <span class="math">s^2</span> is
              <span class="math">\&#123;x_i^1, x_i^2\&#125; \setminus s_i^1</span>;
            </li>
            <li>
              if
              <span class="math">x_i^1 = x_i^2</span>: the
              <span class="math">i</span>-th generating variable
              <span class="math">s_i^1</span> of
              <span class="math">s^1</span> is equal to the
              <span class="math">i</span>-th generating variable of
              <span class="math">s^2</span>.
            </li>
          </ul>
          <p class="text-gray-300">The following holds:</p>
          <ol class="list-decimal list-inside text-gray-300 space-y-1
            ml-4">
            <li>
              <span class="math">R^2(t^1) \oplus R^2(t^2) = R^2(s^1) \oplus R^2(s^2)</span>;
            </li>
            <li>
              for each
              <span class="math">J \subseteq \&#123;0, 1, 2, 3\&#125;</span>:
              <span class="math">R^4(t^1) \oplus R^4(t^2) \in \mathcal&#123;M&#125;_J</span>
              if and only if
              <span class="math">R^4(s^1) \oplus R^4(s^2) \in \mathcal&#123;M&#125;_J</span>.
            </li>
          </ol>
        </div>
      </div>

      <!-- 3.3 Main Result -->
      <h3 id="sec-3.3" class="text-xl font-semibold mt-8 mb-3">
        3.3 Main Result: Probability Distribution for 5-round AES
      </h3>

      <div class="formal-block formal-block-theorem">
        <div class="formal-block-title text-green-400">Theorem 4</div>
        <div class="formal-block-content">
          <p class="text-gray-300">
            Given an AES-like cipher that works with texts in
            <span class="math">\mathbb&#123;F&#125;_&#123;2^8&#125;^&#123;4 \times 4&#125;</span>,
            assume that (1st) the MixColumns matrix is an MDS matrix
            and that (2nd) the solutions of the equation
            <span class="math">\text&#123;S-Box&#125;(x \oplus \Delta_I) \oplus \text&#123;S-Box&#125;(x) = \Delta_O</span>
            are uniformly distributed for each non-zero input/output
            difference
            <span class="math">\Delta_I \neq 0</span> and
            <span class="math">\Delta_O \neq 0</span>.
          </p>
          <p class="text-gray-300">
            Given
            <span class="math">2^&#123;32&#125;</span> plaintexts
            <span class="math">\&#123;p^i\&#125;_&#123;i \in \&#123;0,1,\ldots,2^&#123;32&#125;-1\&#125;\&#125;</span>
            with one active diagonal (i.e., in a coset of a diagonal
            subspace
            <span class="math">\mathcal&#123;D&#125;_i</span> for
            <span class="math">i \in \&#123;0,1,2,3\&#125;</span>),
            consider the number of different pairs of ciphertexts
            <span class="math">(c^h, c^j)</span> for
            <span class="math">h \neq j</span> that belong into the
            same coset of
            <span class="math">\mathcal&#123;ID&#125;_J</span> for any
            fixed
            <span class="math">J \subseteq \&#123;0,1,2,3\&#125;</span>
            with
            <span class="math">|J| = 3</span>. The corresponding
            probability distribution &mdash; denoted by
            <span class="math">\mathfrak&#123;D&#125;_&#123;5\text&#123;-&#125;AES&#125;</span>
            &mdash; with respect to all possible initial cosets and all
            possible secret keys is given by
          </p>
          <div class="math-block">
            \mathfrak&#123;D&#125;_&#123;5\text&#123;-&#125;AES&#125;
            = 2^3 \times \mathfrak&#123;B&#125;(n_3, p_3)
            + 2^&#123;10&#125; \times \mathfrak&#123;B&#125;(n_&#123;10&#125;, p_&#123;10&#125;)
            + 2^&#123;17&#125; \times \mathfrak&#123;B&#125;(n_&#123;17&#125;, p_&#123;17&#125;),
          </div>
          <p class="text-gray-300">
            where
            <span class="math">\mathfrak&#123;B&#125;_i \sim \mathfrak&#123;B&#125;(n_i, p_i)</span>
            for
            <span class="math">i \in \&#123;3, 10, 17\&#125;</span>
            are binomial distributions, and where
          </p>
          <div class="math-block">
            n_3 = 2^&#123;28&#125; \cdot (2^8 - 1)^4, \quad
            p_3 = 2^&#123;-32&#125; + 2^&#123;-53.983&#125;;
          </div>
          <div class="math-block">
            n_&#123;10&#125; = 2^&#123;23&#125; \cdot (2^8 - 1)^3,
            \quad
            p_&#123;10&#125; = 2^&#123;-32&#125; - 2^&#123;-45.989&#125;;
          </div>
          <div class="math-block">
            n_&#123;17&#125; = 3 \cdot 2^&#123;15&#125; \cdot (2^8 - 1)^2,
            \quad
            p_&#123;17&#125; = 2^&#123;-32&#125; + 2^&#123;-37.986&#125;.
          </div>
          <p class="text-gray-300">
            Such distribution has mean value
            <span class="math">\mu = 2\,147\,484\,685.6</span>, and
            standard deviation
            <span class="math">\sigma = 277\,204.426</span>.
          </p>
        </div>
      </div>

      <div class="formal-block formal-block-theorem">
        <div class="formal-block-title text-green-400">
          Corollary 1
        </div>
        <div class="formal-block-content">
          <p class="text-gray-300">
            Given an AES-like cipher that works with texts in
            <span class="math">\mathbb&#123;F&#125;_&#123;2^8&#125;^&#123;4 \times 4&#125;</span>,
            assume that (1st) the MixColumns matrix is an MDS matrix
            and that (2nd) the solutions of the equation
            <span class="math">\text&#123;S-Box&#125;(x \oplus \Delta_I) \oplus \text&#123;S-Box&#125;(x) = \Delta_O</span>
            are uniformly distributed for each non-zero input/output
            difference
            <span class="math">\Delta_I \neq 0</span> and
            <span class="math">\Delta_O \neq 0</span>.
          </p>
          <p class="text-gray-300">
            Given
            <span class="math">2^&#123;32&#125;</span> plaintexts with
            one active diagonal, the probability that
            <span class="math">n \in \mathbb&#123;N&#125;</span>
            different pairs of ciphertexts are equal in one fixed
            anti-diagonal is given by:
          </p>
          <div class="math-block">
            \Pr(n) = \begin&#123;cases&#125;
            0 &amp; \text&#123;if &#125; n \bmod 8 \neq 0 \\
            \displaystyle\sum_&#123;(x_3, x_&#123;10&#125;, x_&#123;17&#125;) \in X_n&#125;
            \left( \prod_&#123;i \in \&#123;3, 10, 17\&#125;&#125;
            \binom&#123;n_i&#125;&#123;x_i&#125; \cdot (p_i)^&#123;x_i&#125;
            \cdot (1 - p_i)^&#123;n_i - x_i&#125; \right)
            &amp; \text&#123;otherwise&#125;
            \end&#123;cases&#125;
          </div>
          <p class="text-gray-300">
            where
          </p>
          <div class="math-block">
            X_n = \left\&#123;
            (x_3, x_&#123;10&#125;, x_&#123;17&#125;)
            \in \mathbb&#123;N&#125; \times \mathbb&#123;N&#125;
            \times \mathbb&#123;N&#125;
            \;\middle|\;
            0 \le x_i \le n_i \text&#123; and &#125;
            2^3 \cdot x_3 + 2^&#123;10&#125; \cdot x_&#123;10&#125;
            + 2^&#123;17&#125; \cdot x_&#123;17&#125; = n
            \right\&#125;
          </div>
          <p class="text-gray-300">
            and where
            <span class="math">n_i</span> and
            <span class="math">p_i</span> for
            <span class="math">i \in \&#123;3, 10, 17\&#125;</span>
            are as in Theorem 4.
          </p>
        </div>
      </div>
    </section>

    <!-- ============================================================ -->
    <!-- 4. INITIAL CONSIDERATIONS                                    -->
    <!-- ============================================================ -->

    <section id="sec-4" class="mb-10">
      <h2 class="text-2xl font-bold">4. Initial Considerations</h2>
      <p class="text-gray-300">
        The assumption that &ldquo;the solutions of the differential
        equation are uniformly distributed for each
        <span class="math">\Delta_I \neq 0</span> and
        <span class="math">\Delta_O \neq 0</span>&rdquo; basically
        corresponds to an S-Box that is
        &ldquo;homogeneous&rdquo; and whose variance
        <span class="math">\text&#123;Var&#125;(N_&#123;\Delta_I,\Delta_O&#125;)</span>
        is as low as possible. This is close to being true if the
        S-Box is APN, or if the S-Box is &ldquo;close&rdquo; to being
        APN. The AES S-Box is not APN but differentially 4-uniform,
        and approximately matches the assumptions.
      </p>

      <div class="formal-block formal-block-theorem">
        <div class="formal-block-title text-green-400">
          Proposition 1
        </div>
        <div class="formal-block-content">
          <p class="text-gray-300">
            Consider
            <span class="math">2^&#123;32&#125;</span> plaintexts
            <span class="math">\&#123;p^i\&#125;_&#123;i \in \&#123;0,1,\dots,2^&#123;32&#125;-1\&#125;\&#125;</span>
            with one active diagonal, and the corresponding
            (cipher)texts generated by a random permutation
            <span class="math">\Pi</span>, that is
            <span class="math">c^i = \Pi(p^i)</span>. The probability
            distribution of the number of different pairs of
            ciphertexts
            <span class="math">(c^h, c^j)</span> that belong to the
            same coset of
            <span class="math">\mathcal&#123;ID&#125;_J</span> for any
            fixed
            <span class="math">J \subseteq \&#123;0,1,2,3\&#125;</span>
            with
            <span class="math">|J| = 3</span> is given by a binomial
            distribution
            <span class="math">\mathfrak&#123;B&#125;(n,p)</span>,
            where
            <span class="math">n = \binom&#123;2^&#123;32&#125;&#125;&#123;2&#125; = 2^&#123;31&#125; \cdot (2^&#123;32&#125; - 1)</span>
            and
            <span class="math">p = \frac&#123;2^&#123;96&#125; - 1&#125;&#123;2^&#123;128&#125; - 1&#125; \approx 2^&#123;-32&#125;</span>.
            The average number of collisions is equal to
            <span class="math">2^&#123;31&#125; - 0.5 = 2\,147\,483\,647.5</span>,
            while its variance is approximately
            <span class="math">2^&#123;31&#125;</span>.
          </p>
        </div>
      </div>

      <p class="text-gray-300">
        It follows that, independently of the secret key, the average
        number of pairs of ciphertexts equal in one fixed anti-diagonal
        is slightly bigger for 5-round AES than for a random
        permutation (approximately 1038.1 more collisions), and the
        variance is much bigger (approximately a factor of 36).
      </p>
    </section>

    <!-- ============================================================ -->
    <!-- 5. PROOF OF THEOREM 4: SUM OF BINOMIAL DISTRIBUTIONS         -->
    <!-- ============================================================ -->

    <section id="sec-5" class="mb-10">
      <h2 class="text-2xl font-bold">
        5. Proof of Theorem 4: Sum of Binomial Distributions
      </h2>
      <p class="text-gray-300">
        Consider a set of
        <span class="math">2^&#123;32&#125;</span> plaintexts with one
        active diagonal and the corresponding ciphertexts after
        5-round AES. As shown by the multiple-of-8 property [GrassiRechbergerRonjom17] and
        by the mixture differential cryptanalysis [Grassi18], the pairs of
        ciphertexts are not independent. These pairs can be divided
        into
        <span class="math">n_3 + n_&#123;10&#125; + n_&#123;17&#125; + n_&#123;24&#125;</span>
        sets such that:
      </p>
      <ol class="list-decimal list-inside text-gray-300 space-y-1
        ml-4">
        <li>
          for each
          <span class="math">i \in \&#123;3, 10, 17, 24\&#125;</span>,
          exactly
          <span class="math">n_i</span> sets have cardinality
          <span class="math">2^i</span>;
        </li>
        <li>
          each set contains pairs of texts for which
          <span class="math">i</span> out of the four generating
          variables are equal after 1-round encryption;
        </li>
        <li>
          within each set, either all pairs of ciphertexts satisfy the
          anti-diagonal equality or none do;
        </li>
        <li>
          pairs of texts in different sets are independent.
        </li>
      </ol>
      <p class="text-gray-300">
        The values of
        <span class="math">n_3, n_&#123;10&#125;, n_&#123;17&#125;</span>
        are given by
      </p>
      <div class="math-block">
        \forall v \in \&#123;0, 1, 2\&#125;: \quad
        n_&#123;7v + 3&#125; = \binom&#123;4&#125;&#123;v&#125; \cdot
        \frac&#123;2^&#123;31&#125; \cdot (2^8 - 1)^&#123;4-v&#125;&#125;&#123;2^&#123;7v + 3&#125;&#125;.
      </div>
      <p class="text-gray-300">
        Due to the impossible differential trail on 4-round AES, if
        three out of four generating variables are equal after 1-round
        encryption, then the corresponding ciphertexts cannot be equal
        in any anti-diagonal. Therefore
        <span class="math">p_&#123;24&#125; = 0</span>.
      </p>
      <p class="text-gray-300">
        <strong>Mean Value and Variance.</strong> The mean value
        <span class="math">\mu</span> is
      </p>
      <div class="math-block">
        \mu = \mathbb&#123;E&#125;[\mathfrak&#123;D&#125;_&#123;5\text&#123;-&#125;AES&#125;]
        = 2^3 \cdot n_3 \cdot p_3 + 2^&#123;10&#125; \cdot n_&#123;10&#125; \cdot p_&#123;10&#125;
        + 2^&#123;17&#125; \cdot n_&#123;17&#125; \cdot p_&#123;17&#125;,
      </div>
      <p class="text-gray-300">
        and the variance
        <span class="math">\sigma^2</span> is
      </p>
      <div class="math-block">
        \sigma^2 = 2^6 \cdot n_3 \cdot p_3 \cdot (1 - p_3)
        + 2^&#123;20&#125; \cdot n_&#123;10&#125; \cdot p_&#123;10&#125; \cdot (1 - p_&#123;10&#125;)
        + 2^&#123;34&#125; \cdot n_&#123;17&#125; \cdot p_&#123;17&#125; \cdot (1 - p_&#123;17&#125;).
      </div>
    </section>

    <!-- ============================================================ -->
    <!-- 6. PROOF OF THEOREM 4: ABOUT THE PROBABILITIES               -->
    <!-- ============================================================ -->

    <section id="sec-6" class="mb-10">
      <h2 class="text-2xl font-bold">
        6. Proof of Theorem 4: About the Probabilities
        <span class="math">p_3, p_&#123;10&#125;, p_&#123;17&#125;</span>
      </h2>

      <h3 id="sec-6.1" class="text-xl font-semibold mt-8 mb-3">
        6.1 Reduction to the Middle Round
      </h3>
      <p class="text-gray-300">
        Due to the 2-round truncated differential with probability 1,
        the 5-round chain decomposes as
      </p>
      <div class="math-block">
        \mathcal&#123;D&#125;_i \oplus \delta
        \xrightarrow&#123;R^2&#125;
        \mathcal&#123;M&#125;_i \oplus \omega
        \xrightarrow&#123;R&#125;
        \mathcal&#123;D&#125;_J \oplus \delta'
        \xrightarrow&#123;R_f^2&#125;
        \mathcal&#123;ID&#125;_J \oplus \omega'.
      </div>
      <p class="text-gray-300">
        It is therefore sufficient to focus on the middle round
        <span class="math">\mathcal&#123;M&#125;_i \oplus \omega \xrightarrow&#123;R&#125; \mathcal&#123;D&#125;_J \oplus \delta'</span>
        in order to compute the desired result. The proof proceeds
        first for a simpler case of
        <span class="math">2^&#123;16&#125;</span> texts with two
        equal generating variables, then extends to the generic case
        of <span class="math">2^&#123;32&#125;</span> texts.
      </p>

      <h3 id="sec-6.2" class="text-xl font-semibold mt-8 mb-3">
        6.2 A &ldquo;Simpler&rdquo; Case:
        <span class="math">2^&#123;16&#125;</span> Texts with Two
        Equal Generating Variables
      </h3>
      <p class="text-gray-300">
        Consider
        <span class="math">2^&#123;16&#125;</span> texts for which two
        generating variables are equal, e.g.,
        <span class="math">z^1 = z^2</span> and
        <span class="math">w^1 = w^2</span>. Two such texts are equal
        in the first diagonal after one round if and only if four
        equations of the form
      </p>
      <div class="math-block">
        A \cdot \left( \text&#123;S-Box&#125;(B \cdot x^1 \oplus a)
        \oplus \text&#123;S-Box&#125;(B \cdot x^2 \oplus a) \right)
        \oplus C \cdot \left( \text&#123;S-Box&#125;(D \cdot y^1 \oplus c)
        \oplus \text&#123;S-Box&#125;(D \cdot y^2 \oplus c) \right) = 0
      </div>
      <p class="text-gray-300">
        are satisfied, where
        <span class="math">A, B, C, D \in \mathbb&#123;F&#125;_&#123;2^8&#125;</span>
        depend on the MixColumns matrix, while
        <span class="math">a, c \in \mathbb&#123;F&#125;_&#123;2^8&#125;</span>
        depend on the secret key and on the initial constant
        <span class="math">\omega</span>.
      </p>
      <p class="text-gray-300">
        Each such equation has exactly
        <span class="math">255 \cdot 2^&#123;15&#125;</span> different
        non-null solutions. Under the APN-like assumption and the MDS
        property, the probability that two equations share a common
        solution is
        <span class="math">255^&#123;-2&#125; \cdot 2^&#123;-15&#125;</span>.
        The average number of common solutions of 4 such equations is
      </p>
      <div class="math-block">
        (255 \cdot 2^&#123;15&#125;)^4 \cdot (255^&#123;-2&#125; \cdot
        2^&#123;-15&#125;)^3 = \frac&#123;2^&#123;15&#125;&#125;&#123;255^2&#125;
        \simeq 0.503929 \simeq 2^&#123;-1&#125; + 2^&#123;-7.992&#125;.
      </div>
      <p class="text-gray-300">
        This leads to the probability
      </p>
      <div class="math-block">
        p_&#123;17&#125; = 2^&#123;-32&#125; + 2^&#123;-37.986&#125;.
      </div>

      <h3 id="sec-6.3" class="text-xl font-semibold mt-8 mb-3">
        6.3 Generic Case:
        <span class="math">2^&#123;32&#125;</span> Texts
      </h3>
      <p class="text-gray-300">
        The generic case extends the analysis to
        <span class="math">2^&#123;32&#125;</span> texts, where
        four equations of the form
      </p>
      <div class="math-block">
        A \cdot (\text&#123;S-Box&#125;(B \cdot x^1 \oplus b) \oplus
        \text&#123;S-Box&#125;(B \cdot x^2 \oplus b))
        \oplus C \cdot (\text&#123;S-Box&#125;(D \cdot y^1 \oplus d)
        \oplus \text&#123;S-Box&#125;(D \cdot y^2 \oplus d))
        \oplus E \cdot (\text&#123;S-Box&#125;(F \cdot z^1 \oplus f)
        \oplus \text&#123;S-Box&#125;(F \cdot z^2 \oplus f))
        \oplus G \cdot (\text&#123;S-Box&#125;(H \cdot w^1 \oplus h)
        \oplus \text&#123;S-Box&#125;(H \cdot w^2 \oplus h)) = 0
      </div>
      <p class="text-gray-300">
        must be satisfied. The proof splits into three cases depending
        on how many of
        <span class="math">\Delta_O, \Delta_O', \Delta_O'', \Delta_O'''</span>
        are zero, yielding:
      </p>
      <ul class="list-disc list-inside text-gray-300 space-y-2 ml-4">
        <li>
          <strong>First case</strong> (two equal generating variables):
          average common solutions
          <span class="math">\binom&#123;4&#125;&#123;2&#125; \cdot 256^2 \cdot \frac&#123;2^&#123;15&#125;&#125;&#123;255^2&#125; = \frac&#123;2^&#123;32&#125;&#125;&#123;21675&#125; \simeq 198\,153.047</span>,
          giving
          <span class="math">p_&#123;17&#125; = 2^&#123;-32&#125; + 2^&#123;-37.986&#125;</span>.
        </li>
        <li>
          <strong>Second case</strong> (one equal generating variable):
          average common solutions
          <span class="math">\simeq 33\,160\,710.047</span>, giving
          <span class="math">p_&#123;10&#125; = 2^&#123;-32&#125; - 2^&#123;-45.989&#125;</span>.
        </li>
        <li>
          <strong>Third case</strong> (no equal generating variables):
          average common solutions
          <span class="math">\simeq 2\,114\,125\,822.5</span>, giving
          <span class="math">p_3 = 2^&#123;-32&#125; + 2^&#123;-53.983&#125;</span>.
        </li>
      </ul>
      <p class="text-gray-300">
        The total number of collisions is
      </p>
      <div class="math-block">
        2\,114\,125\,822.5 + 33\,160\,710.047 + 198\,153.047
        \simeq 2\,147\,484\,685.594 \simeq 2^&#123;31&#125; + 2^&#123;10.02&#125;.
      </div>
    </section>

    <!-- ============================================================ -->
    <!-- 7. PRACTICAL RESULTS FOR 5-ROUND AES                        -->
    <!-- ============================================================ -->

    <section id="sec-7" class="mb-10">
      <h2 class="text-2xl font-bold">
        7. Practical Results for 5-round AES
      </h2>
      <p class="text-gray-300">
        The mean and variance have been practically verified using a
        C/C++ implementation. The mean value was verified on a
        small-scale AES as proposed in [CidMurphyRobshaw05], and the variance both on
        full-size and on small-scale AES.
      </p>

      <div class="formal-block formal-block-theorem">
        <div class="formal-block-title text-green-400">
          Proposition 2
        </div>
        <div class="formal-block-content">
          <p class="text-gray-300">
            Consider an AES-like cipher that works with texts in
            <span class="math">\mathbb&#123;F&#125;_&#123;2^n&#125;^&#123;4 \times 4&#125;</span>,
            such that (1st) the MixColumns matrix is an MDS matrix and
            (2nd) the solutions of the differential equation are
            uniformly distributed for each
            <span class="math">\Delta_I \neq 0</span> and
            <span class="math">\Delta_O \neq 0</span>. Given
            <span class="math">2^&#123;4n&#125;</span> plaintexts with
            one active diagonal, independently of the initial coset and
            the secret key, the average number of different pairs of
            ciphertexts that belong to the same coset of
            <span class="math">\mathcal&#123;ID&#125;_J</span> for any
            fixed
            <span class="math">J</span> with
            <span class="math">|J| = 3</span> is
          </p>
          <div class="math-block">
            \frac&#123;2^&#123;4n-1&#125; \cdot (2^&#123;2n&#125; - 3 \cdot 2^n + 3)^4&#125;&#123;(2^n - 1)^8&#125;
            + \frac&#123;(2^&#123;n-1&#125; - 1)^4 \cdot 2^&#123;4n+5&#125;&#125;&#123;(2^n - 1)^5&#125;
            + 3 \cdot \frac&#123;2^&#123;4n&#125;&#125;&#123;(2^n - 1)^2&#125;,
          </div>
          <p class="text-gray-300">and the variance is</p>
          <div class="math-block">
            \frac&#123;2^&#123;4n+2&#125; \cdot (2^&#123;2n&#125; - 3 \cdot 2^n + 3)^4&#125;&#123;(2^n - 1)^8&#125;
            + \frac&#123;(2^&#123;n-1&#125; - 1)^4 \cdot 2^&#123;5n+7&#125;&#125;&#123;(2^n - 1)^5&#125;
            + \frac&#123;3 \cdot 2^&#123;6n+1&#125;&#125;&#123;(2^n - 1)^2&#125;.
          </div>
        </div>
      </div>

      <p class="text-gray-300">
        <strong>Full-size AES variance:</strong>
        <span class="math">\sigma_T^2 = 76\,842\,293\,834.905 \simeq 2^&#123;36.161&#125;</span>
        (theoretical) versus
        <span class="math">\sigma_P^2 = 73\,288\,132\,411.36 \simeq 2^&#123;36.093&#125;</span>
        (practical).
      </p>
      <p class="text-gray-300">
        <strong>Small-scale AES mean:</strong>
        <span class="math">\mu_&#123;AES&#125;^T = 32\,847.124</span>
        versus
        <span class="math">\mu_&#123;AES&#125;^P = 32\,848.57</span>;
        <span class="math">\mu_&#123;rand&#125;^T = 32\,767.5</span>
        versus
        <span class="math">\mu_&#123;rand&#125;^P = 32\,768.2</span>.
      </p>
      <p class="text-gray-300">
        <strong>Small-scale AES standard deviation:</strong>
        <span class="math">\sigma_&#123;AES&#125;^T = 1036.58</span>
        versus
        <span class="math">\sigma_&#123;AES&#125;^P = 1027.93</span>;
        <span class="math">\sigma_&#123;rand&#125;^T = 181.02</span>
        versus
        <span class="math">\sigma_&#123;rand&#125;^P = 182.42</span>.
      </p>
      <p class="text-gray-300">
        The distribution for small-scale 5-round AES has a positive
        skew (approximately 0.47), while the random distribution has
        skew approximately zero.
      </p>
    </section>

    <!-- ============================================================ -->
    <!-- 8. TRUNCATED DIFFERENTIAL DISTINGUISHERS                     -->
    <!-- ============================================================ -->

    <section id="sec-8" class="mb-10">
      <h2 class="text-2xl font-bold">
        8. Truncated Differential Distinguishers for 5-round AES
      </h2>
      <p class="text-gray-300">
        The truncated differential distinguishers presented in this
        section are based on the difference in the probability
        distribution of the number of collisions between 5-round AES
        and a random permutation.
      </p>

      <p class="text-gray-300">
        <strong>8.1 Variance-based Distinguisher.</strong> Since the
        variance of the AES case is approximately 36 times that of a
        random permutation, this can be exploited for a
        secret-key distinguisher. With 4 initial cosets of
        <span class="math">\mathcal&#123;D&#125;_i</span> (data cost
        <span class="math">2^&#123;34&#125;</span> chosen plaintexts),
        the computational cost is approximately
        <span class="math">2^&#123;37.6&#125;</span> table look-ups
        (<span class="math">\approx 2^&#123;31&#125;</span> five-round
        encryptions).
      </p>

      <div class="formal-block formal-block-lemma">
        <div class="formal-block-title text-amber-400">Lemma 1</div>
        <div class="formal-block-content">
          <p class="text-gray-300">
            Consider an AES-like cipher that works with texts in
            <span class="math">\mathbb&#123;F&#125;_&#123;2^8&#125;^&#123;4 \times 4&#125;</span>
            and for which the assumptions of Theorem 4 hold. Consider
            <span class="math">2^&#123;32&#125;</span> plaintexts with
            one active diagonal. The probability distribution of the
            number of different pairs of ciphertexts that are equal in
            one anti-diagonal after 5 rounds is approximated by a
            normal distribution
            <span class="math">\mathfrak&#123;N&#125;(\mu, \sigma^2)</span>,
            where the mean value is
            <span class="math">\mu = 2\,147\,484\,685.6 = 2^&#123;32&#125; + 1\,037.6</span>
            and the standard deviation is
            <span class="math">\sigma = 277\,204.426</span>.
          </p>
        </div>
      </div>

      <p class="text-gray-300">
        <strong>8.3 Mean-based Distinguisher.</strong> Using the
        normal approximation, the difference of the two distributions
        (AES and random) is again a normal distribution. In order to
        have a probability of success greater than 95%, the number of
        pairs must satisfy
        <span class="math">n \geq 2^&#123;78.374&#125;</span>. Given
        <span class="math">2^&#123;32&#125;</span> chosen plaintexts
        per coset (approximately
        <span class="math">2^&#123;63&#125;</span> pairs of texts),
        the distinguisher requires
        <span class="math">2^&#123;16.96&#125;</span> initial cosets
        for a data cost of
        <span class="math">2^&#123;48.96&#125;</span> chosen
        plaintexts and a computational cost of
        <span class="math">2^&#123;52.6&#125;</span> table look-ups
        (<span class="math">\approx 2^&#123;46&#125;</span> five-round
        encryptions).
      </p>
    </section>

    <!-- ============================================================ -->
    <!-- ACKNOWLEDGEMENTS                                             -->
    <!-- ============================================================ -->

    <section id="acknowledgements" class="mb-10">
      <h2 class="text-2xl font-bold">Acknowledgements</h2>
      <p class="text-gray-300">
        This work was accomplished when L. Grassi was at IAIK, Graz
        University of Technology, Austria. Authors thank anonymous
        reviewers for their valuable comments and suggestions. Authors
        thank Matthias Niel for implementing on C/C++ the truncated
        differential distinguishers on 6- and 8-bit AES presented in
        this paper. Authors also thank Anne Canteaut for pointing out
        the constant of the ratio between the variances for 5-round
        AES and for a random permutation. L. Grassi is currently
        supported by the European Research Council under the ERC
        advanced grant agreement under grant ERC-2017-ADG Nr. 788980
        ESCADA.
      </p>
    </section>

    <!-- ============================================================ -->
    <!-- REFERENCES                                                   -->
    <!-- ============================================================ -->

    <section id="references" class="mb-10">
      <h2 class="text-2xl font-bold">References</h2>
      <ul class="space-y-2 text-gray-400 text-sm list-none">
        <li id="ref-Albrecht+14">
          <span class="text-gray-500">[Albrecht+14]</span>
          M. R. Albrecht, B. Driessen, E. B. Kavun, G. Leander,
          C. Paar, and T. Yalcin, &ldquo;Block Ciphers &ndash; Focus
          on the Linear Layer (feat. PRIDE),&rdquo; in
          <em>CRYPTO 2014</em>, ser. LNCS, vol. 8616, 2014,
          pp. 57&ndash;76.
        </li>
        <li id="ref-Banik+15">
          <span class="text-gray-500">[Banik+15]</span>
          S. Banik, A. Bogdanov, T. Isobe, K. Shibutani,
          H. Hiwatari, T. Akishita, and F. Regazzoni,
          &ldquo;Midori: A Block Cipher for Low Energy,&rdquo; in
          <em>ASIACRYPT 2015</em>, ser. LNCS, vol. 9453, 2015,
          pp. 411&ndash;436.
        </li>
        <li id="ref-BaoGuoList20">
          <span class="text-gray-500">[BaoGuoList20]</span>
          Z. Bao, J. Guo, and E. List, &ldquo;Extended
          Truncated-differential Distinguishers on Round-reduced
          AES,&rdquo; <em>IACR Trans. Symmetric Cryptol.</em>,
          vol. 2020, no. 3, pp. 197&ndash;261, 2020.
          <a href="/papers/truncated-diff-aes-2019" class="text-blue-400 hover:text-blue-300">[page on this site]</a>
        </li>
        <li id="ref-Bar-On+18">
          <span class="text-gray-500">[Bar-On+18]</span>
          A. Bar-On, O. Dunkelman, N. Keller, E. Ronen, and
          A. Shamir, &ldquo;Improved Key Recovery Attacks on
          Reduced-Round AES with Practical Data and Memory
          Complexities,&rdquo; in <em>CRYPTO 2018</em>, ser. LNCS,
          vol. 10992, 2018, pp. 185&ndash;212.
        </li>
        <li id="ref-BardehRonjom19">
          <span class="text-gray-500">[BardehRonjom19]</span>
          N. G. Bardeh and S. R&oslash;njom, &ldquo;The Exchange
          Attack: How to Distinguish 6 Rounds of AES with
          <span class="math">2^&#123;88.2&#125;</span> chosen
          plaintexts,&rdquo; in <em>ASIACRYPT 2019</em>, ser. LNCS,
          vol. 11923, 2019, pp. 347&ndash;370.
        </li>
        <li id="ref-BihamBiryukovShamir99">
          <span class="text-gray-500">[BihamBiryukovShamir99]</span>
          E. Biham, A. Biryukov, and A. Shamir,
          &ldquo;Cryptanalysis of Skipjack Reduced to 31 Rounds Using
          Impossible Differentials,&rdquo; in
          <em>EUROCRYPT 1999</em>, ser. LNCS, vol. 1592, 1999,
          pp. 12&ndash;23.
        </li>
        <li id="ref-BihamKeller01">
          <span class="text-gray-500">[BihamKeller01]</span>
          E. Biham and N. Keller, &ldquo;Cryptanalysis of Reduced
          Variants of Rijndael,&rdquo; 2001, unpublished.
        </li>
        <li id="ref-BihamShamir91">
          <span class="text-gray-500">[BihamShamir91]</span>
          E. Biham and A. Shamir, &ldquo;Differential
          cryptanalysis of DES-like cryptosystems,&rdquo;
          <em>Journal of Cryptology</em>, vol. 4, no. 1,
          pp. 3&ndash;72, Jan 1991.
        </li>
        <li id="ref-BlondeauLeanderNyberg17">
          <span class="text-gray-500">[BlondeauLeanderNyberg17]</span>
          C. Blondeau, G. Leander, and K. Nyberg,
          &ldquo;Differential-Linear Cryptanalysis Revisited,&rdquo;
          <em>Journal of Cryptology</em>, vol. 30, no. 3,
          pp. 859&ndash;888, 2017.
        </li>
        <li id="ref-Bogdanov+07">
          <span class="text-gray-500">[Bogdanov+07]</span>
          A. Bogdanov, L. R. Knudsen, G. Leander, C. Paar,
          A. Poschmann, M. J. B. Robshaw, Y. Seurin, and
          C. Vikkelsoe, &ldquo;PRESENT: An Ultra-Lightweight Block
          Cipher,&rdquo; in <em>CHES 2007</em>, ser. LNCS,
          vol. 4727, 2007, pp. 450&ndash;466.
        </li>
        <li id="ref-Borghoff+12">
          <span class="text-gray-500">[Borghoff+12]</span>
          J. Borghoff, A. Canteaut, T. G&uuml;neysu,
          E. B. Kavun, M. Knezevic, L. R. Knudsen, G. Leander,
          V. Nikov, C. Paar, C. Rechberger, P. Rombouts,
          S. S. Thomsen, and T. Yalcin, &ldquo;PRINCE &ndash; A
          Low-Latency Block Cipher for Pervasive Computing
          Applications,&rdquo; in <em>ASIACRYPT 2012</em>, ser. LNCS,
          vol. 7658, 2012, pp. 208&ndash;225.
        </li>
        <li id="ref-BouraCanteautCoggia19">
          <span class="text-gray-500">[BouraCanteautCoggia19]</span>
          C. Boura, A. Canteaut, and D. Coggia, &ldquo;A General
          Proof Framework for Recent AES Distinguishers,&rdquo;
          <em>IACR Trans. Symmetric Cryptol.</em>, vol. 2019, no. 1,
          pp. 170&ndash;191, 2019.
        </li>
        <li id="ref-CidMurphyRobshaw05">
          <span class="text-gray-500">[CidMurphyRobshaw05]</span>
          C. Cid, S. Murphy, and M. J. B. Robshaw, &ldquo;Small
          Scale Variants of the AES,&rdquo; in <em>FSE 2005</em>,
          ser. LNCS, vol. 9054, 2005, pp. 145&ndash;162.
        </li>
        <li id="ref-DaemenKnudsenRijmen97">
          <span class="text-gray-500">[DaemenKnudsenRijmen97]</span>
          J. Daemen, L. R. Knudsen, and V. Rijmen, &ldquo;The
          Block Cipher Square,&rdquo; in <em>FSE 1997</em>,
          ser. LNCS, vol. 1267, 1997, pp. 149&ndash;165.
        </li>
        <li id="ref-Daemen+00">
          <span class="text-gray-500">[Daemen+00]</span>
          J. Daemen, M. Peeters, G. V. Assche, and V. Rijmen,
          &ldquo;Nessie proposal: the block cipher Noekeon,&rdquo;
          Nessie submission, 2000.
        </li>
        <li id="ref-DaemenRijmen02">
          <span class="text-gray-500">[DaemenRijmen02]</span>
          J. Daemen and V. Rijmen, <em>The Design of Rijndael:
          AES The Advanced Encryption Standard</em>, ser. Information
          Security and Cryptography. Springer, 2002.
        </li>
        <li id="ref-DaemenRijmen02a">
          <span class="text-gray-500">[DaemenRijmen02a]</span>
          J. Daemen and V. Rijmen, &ldquo;Security of a Wide
          Trail Design,&rdquo; in <em>INDOCRYPT 2002</em>, ser. LNCS,
          vol. 2551, 2002, pp. 1&ndash;11.
        </li>
        <li id="ref-GongNikovaLaw12">
          <span class="text-gray-500">[GongNikovaLaw12]</span>
          Z. Gong, S. Nikova, and Y. W. Law, &ldquo;KLEIN: A
          New Family of Lightweight Block Ciphers,&rdquo; in
          <em>RFID 2011</em>, ser. LNCS, vol. 7055, 2012,
          pp. 1&ndash;18.
        </li>
        <li id="ref-Grassi18">
          <span class="text-gray-500">[Grassi18]</span>
          L. Grassi, &ldquo;Mixture Differential Cryptanalysis: a
          New Approach to Distinguishers and Attacks on round-reduced
          AES,&rdquo; <em>IACR Trans. Symmetric Cryptol.</em>,
          vol. 2018, no. 2, pp. 133&ndash;160, 2018.
          <a href="/papers/mixture-differential-aes-2017" class="text-blue-400 hover:text-blue-300">[page on this site]</a>
        </li>
        <li id="ref-Grassi19">
          <span class="text-gray-500">[Grassi19]</span>
          L. Grassi, &ldquo;Probabilistic Mixture Differential
          Cryptanalysis on Round-Reduced AES,&rdquo; in
          <em>SAC 2019</em>, ser. LNCS, vol. 11959, 2019,
          pp. 53&ndash;84.
        </li>
        <li id="ref-GrassiRechbergerRonjom17">
          <span class="text-gray-500">[GrassiRechbergerRonjom17]</span>
          L. Grassi, C. Rechberger, and S. R&oslash;njom,
          &ldquo;A New Structural-Differential Property of 5-Round
          AES,&rdquo; in <em>EUROCRYPT 2017</em>, ser. LNCS,
          vol. 10211, 2017, pp. 289&ndash;317.
        </li>
        <li id="ref-GrassiRechbergerRonjom17a">
          <span class="text-gray-500">[GrassiRechbergerRonjom17a]</span>
          L. Grassi, C. Rechberger, and S. R&oslash;njom,
          &ldquo;Subspace Trail Cryptanalysis and its Applications to
          AES,&rdquo; <em>IACR Trans. Symmetric Cryptol.</em>,
          vol. 2016, no. 2, pp. 192&ndash;225, 2017.
          <a href="/papers/subspace-trails-2020" class="text-blue-400 hover:text-blue-300">[page on this site]</a>
        </li>
        <li id="ref-Knudsen95">
          <span class="text-gray-500">[Knudsen95]</span>
          L. R. Knudsen, &ldquo;Truncated and higher order
          differentials,&rdquo; in <em>FSE 1994</em>, ser. LNCS,
          vol. 1008, 1995, pp. 196&ndash;211.
        </li>
        <li id="ref-Lai94">
          <span class="text-gray-500">[Lai94]</span>
          X. Lai, <em>Higher Order Derivatives and Differential
          Cryptanalysis</em>. Springer US, 1994, pp. 227&ndash;233.
        </li>
        <li id="ref-LeanderPoschmann07">
          <span class="text-gray-500">[LeanderPoschmann07]</span>
          G. Leander and A. Poschmann, &ldquo;On the
          Classification of 4 Bit S-Boxes,&rdquo; in
          <em>Arithmetic of Finite Fields &ndash; WAIFI 2007</em>,
          ser. LNCS, vol. 4547, 2007, pp. 159&ndash;176.
        </li>
        <li id="ref-Nyberg91">
          <span class="text-gray-500">[Nyberg91]</span>
          K. Nyberg, &ldquo;Perfect nonlinear S-boxes,&rdquo; in
          <em>EUROCRYPT 1991</em>, ser. LNCS, vol. 547, 1991,
          pp. 378&ndash;386.
        </li>
        <li id="ref-Patarin13">
          <span class="text-gray-500">[Patarin13]</span>
          J. Patarin, &ldquo;Generic Attacks for the Xor of k
          Random Permutations,&rdquo; in <em>ACNS 2013</em>,
          ser. LNCS, vol. 7954, 2013, pp. 154&ndash;169.
        </li>
        <li id="ref-RonjomBardehHelleseth17">
          <span class="text-gray-500">[RonjomBardehHelleseth17]</span>
          S. R&oslash;njom, N. G. Bardeh, and T. Helleseth,
          &ldquo;Yoyo Tricks with AES,&rdquo; in
          <em>ASIACRYPT 2017</em>, ser. LNCS, vol. 10624, 2017,
          pp. 217&ndash;243.
        </li>
        <li id="ref-Zhang+15">
          <span class="text-gray-500">[Zhang+15]</span>
          W. Zhang, Z. Bao, D. Lin, V. Rijmen, B. Yang, and
          I. Verbauwhede, &ldquo;RECTANGLE: a bit-slice lightweight
          block cipher suitable for multiple platforms,&rdquo;
          <em>Science China Information Sciences</em>, vol. 58, no. 12,
          pp. 1&ndash;15, Dec 2015.
        </li>
      </ul>
    </section>

  </article>
</BaseLayout>
