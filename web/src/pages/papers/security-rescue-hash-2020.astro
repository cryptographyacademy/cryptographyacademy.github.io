---
import BaseLayout from '../../layouts/BaseLayout.astro';

const EPRINT_URL = 'https://eprint.iacr.org/2020/820';
---

<BaseLayout title="On the Security of the Rescue Hash Function (2020/820)">
  <article class="max-w-4xl mx-auto article-prose">
    <nav class="mb-8">
      <a href="/papers" class="text-blue-400 hover:text-blue-300">
        &larr; Back to Papers
      </a>
    </nav>

    <!-- ============================================================ -->
    <!-- HEADER                                                       -->
    <!-- ============================================================ -->

    <header class="mb-12">
      <h1 class="text-3xl font-bold mb-4">
        On the Security of the Rescue Hash Function
      </h1>
      <p class="text-gray-400 mb-2">
        Tim Beyne, Anne Canteaut, Gregor Leander,
        Mar&iacute;a Naya-Plasencia, L&eacute;o Perrin,
        and Friedrich Wiemer
      </p>
      <p class="text-gray-500 text-sm mb-4">
        2020 &middot; Full Version &middot; eprint 2020/820
      </p>
      <div class="flex gap-4 text-sm">
        <a
          href={EPRINT_URL}
          target="_blank"
          rel="noopener noreferrer"
          class="text-blue-400 hover:text-blue-300"
        >
          Paper (eprint) &rarr;
        </a>
      </div>
      <p class="mt-4 text-xs text-gray-500">
        All content below belongs to the original authors. This page
        reproduces the paper for educational purposes. Always
        <a
          href={EPRINT_URL}
          target="_blank"
          rel="noopener noreferrer"
          class="text-blue-400 hover:text-blue-300"
        >cite the original</a>.
      </p>
    </header>

    <!-- ============================================================ -->
    <!-- TABLE OF CONTENTS                                            -->
    <!-- ============================================================ -->

    <nav id="toc" class="mb-10 p-6 rounded-lg"
      style="background: rgba(255,255,255,0.03);
             border: 1px solid rgba(255,255,255,0.06);">
      <h2 class="text-lg font-bold mb-4">Table of Contents</h2>
      <ol class="space-y-1 text-sm text-gray-300
        list-decimal list-inside">
        <li>
          <a href="#abstract"
            class="hover:text-white">Abstract</a>
        </li>
        <li>
          <a href="#sec-1"
            class="hover:text-white">Summary of the Results</a>
          <ol class="ml-6 mt-1 space-y-1 list-decimal
            list-inside text-gray-400">
            <li>
              <a href="#sec-1.1"
                class="hover:text-white">Steps vs Rounds</a>
            </li>
          </ol>
        </li>
        <li>
          <a href="#sec-2"
            class="hover:text-white">The Rescue Hash Function</a>
        </li>
        <li>
          <a href="#sec-3"
            class="hover:text-white">Linear Cryptanalysis</a>
          <ol class="ml-6 mt-1 space-y-1 list-decimal
            list-inside text-gray-400">
            <li>
              <a href="#sec-3.1"
                class="hover:text-white">
                Upper Bounds for Linear Trails</a>
            </li>
            <li>
              <a href="#sec-3.2"
                class="hover:text-white">
                Upper Bounds for Four Rounds</a>
            </li>
          </ol>
        </li>
        <li>
          <a href="#sec-4"
            class="hover:text-white">Differential Cryptanalysis</a>
          <ol class="ml-6 mt-1 space-y-1 list-decimal
            list-inside text-gray-400">
            <li>
              <a href="#sec-4.1"
                class="hover:text-white">
                Two-Round Differentials</a>
            </li>
            <li>
              <a href="#sec-4.2"
                class="hover:text-white">
                Four-Round Differentials and Weak Round-Keys</a>
            </li>
            <li>
              <a href="#sec-4.3"
                class="hover:text-white">
                More Experimental Results</a>
            </li>
          </ol>
        </li>
        <li>
          <a href="#sec-5"
            class="hover:text-white">
            Multiplicative Subgroups Analysis</a>
          <ol class="ml-6 mt-1 space-y-1 list-decimal
            list-inside text-gray-400">
            <li>
              <a href="#sec-5.1"
                class="hover:text-white">The Setup</a>
            </li>
            <li>
              <a href="#sec-5.2"
                class="hover:text-white">
                The Effect of the Round Operations</a>
            </li>
            <li>
              <a href="#sec-5.3"
                class="hover:text-white">Diagonal Subgroups</a>
            </li>
          </ol>
        </li>
        <li>
          <a href="#sec-6"
            class="hover:text-white">
            Rebound Attacks for Finding Collisions</a>
          <ol class="ml-6 mt-1 space-y-1 list-decimal
            list-inside text-gray-400">
            <li>
              <a href="#sec-6.1"
                class="hover:text-white">
                Example Collision Attack on 3 Rounds</a>
            </li>
            <li>
              <a href="#sec-6.2"
                class="hover:text-white">
                Extension to 4 Rounds</a>
            </li>
            <li>
              <a href="#sec-6.3"
                class="hover:text-white">Conclusion</a>
            </li>
          </ol>
        </li>
      </ol>
      <p class="text-xs text-gray-500 mt-4 mb-1 font-semibold">
        Additional
      </p>
      <ul class="space-y-1 text-sm text-gray-400 list-disc
        list-inside">
        <li>
          <a href="#acknowledgements"
            class="hover:text-white">Acknowledgements</a>
        </li>
        <li>
          <a href="#references"
            class="hover:text-white">References</a>
        </li>
      </ul>
    </nav>

    <!-- ============================================================ -->
    <!-- ABSTRACT                                                     -->
    <!-- ============================================================ -->

    <section id="abstract" class="mb-10">
      <h2 class="text-2xl font-bold">Abstract</h2>
      <p class="text-gray-300">
        In this report, we cryptanalyse the Rescue hash function. In
        particular, we look at linear and differential cryptanalysis
        of Rescue, how multiplicative subgroups are propagated by the
        round function and at rebound attacks. Overall, we do not find
        any direct threat to the security of Rescue.
      </p>
      <p class="text-gray-300">
        <strong>Keywords:</strong> Rescue, Algebraic optimised, Linear
        Cryptanalysis, Differential Cryptanalysis, Multiplicative
        Subgroups, Rebound Attacks
      </p>
    </section>

    <!-- ============================================================ -->
    <!-- 1. SUMMARY OF THE RESULTS                                    -->
    <!-- ============================================================ -->

    <section id="sec-1" class="mb-10">
      <h2 class="text-2xl font-bold">
        1. Summary of the Results
      </h2>

      <p class="text-gray-300">
        This report is the result of a joint effort to analyze the
        security of Rescue. We considered several attack vectors and
        did not find attacks that pose a direct risk to the current
        design. Time was limited and we cannot exclude that other
        attack vectors or variants of the ones we considered lead to
        a full break of Rescue. In more detail, we considered the
        following attacks.
      </p>

      <p class="text-gray-300">
        <strong>Linear Cryptanalysis.</strong> We adapt the notion of
        linear cryptanalysis to the case of odd characteristic using
        the notion of additive characters on
        <span class="math">\mathbb&#123;F&#125;_p</span>. Building
        upon this we can show that single linear trails do not pose
        a threat to Rescue. Furthermore, we investigate the effect of
        trail clustering. As for almost any cipher, we are not able
        to settle this completely. However, our investigations do not
        point at any weakness for Rescue.
      </p>

      <p class="text-gray-300">
        <strong>Differential Cryptanalysis.</strong> Generalization of
        differential cryptanalysis to the case of odd characteristic
        is, compared to linear characteristic, trivially done.
        Consequently, it is not surprising that important properties
        can be transferred as well. In particular, the maximal
        expected differential probability (MEDP) can be bounded. We
        thus confirm that averaging over independent round keys,
        differential cryptanalysis does not seem to pose a threat to
        Rescue. However, in the case of a fixed key, we experimentally
        observe the existence of a few keys that exhibit a
        significantly larger probability of differentials than expected
        from a random permutation. We can explain this behaviour only
        partially. One reason is that using the S-box layer and its
        inverse in turns leads to a large uniformity for two rounds.
        Thus, we can explain why some keys lead to a higher than
        expected differential uniformity, but there remain keys with a
        similar property that we do not fully understand. Again, it
        seems highly unlikely that this poses a threat for Rescue with
        the chosen parameters.
      </p>

      <p class="text-gray-300">
        <strong>Multiplicative Subgroups.</strong> Motivated by the
        lack of additive structure and the S-boxes being homomorphisms
        in <span class="math">\mathbb&#123;F&#125;_p^*</span>, we
        next focus on attacks exploiting multiplicative structures. In
        particular, we investigate how certain multiplicative subgroups
        (and their cosets) are mapped by parts of the round functions.
        While the S-box and the linear layer exhibit strong non-random
        properties, we argue that those are destroyed with high
        probability by the key (or constant) addition.
      </p>

      <p class="text-gray-300">
        The main result in this part of the analysis is that the round
        constants for Rescue could be chosen in a way that allows to
        easily break the cipher with the given key scheduling for any
        number of rounds. The main reason here is that Rescue reuses
        the round function in the key-scheduling. Again, for
        non-maliciously chosen parameters, this is not going to happen
        with an overwhelming probability.
      </p>

      <p class="text-gray-300">
        <strong>Rebound Attacks.</strong> One of the most successful
        attacks against hash functions are rebound attacks. Those
        attacks use the freedom of the attacker in a non-keyed setting
        to efficiently generate pairs following a (truncated)
        differential characteristic and thus often cover a larger
        number of rounds compared to usual differential attacks. In
        the case of Rescue our investigations indicate that there is
        a rather large security margin against those attacks.
      </p>

      <h3 id="sec-1.1" class="text-xl font-semibold mt-8 mb-3">
        1.1 Steps vs Rounds
      </h3>
      <p class="text-gray-300">
        In this report, we stick to the common way of counting rounds
        as the number of S-box layer applications (including following
        linear layer and key addition). Thus, what is called a step
        in [Aly+19] is here called a round.
      </p>
    </section>

    <!-- ============================================================ -->
    <!-- 2. THE RESCUE HASH FUNCTION                                  -->
    <!-- ============================================================ -->

    <section id="sec-2" class="mb-10">
      <h2 class="text-2xl font-bold">
        2. The Rescue Hash Function
      </h2>

      <p class="text-gray-300">
        We quickly recall the design specification of Rescue from [Aly+19]
        to settle a common ground for notations. Let
        <span class="math">p</span> be an odd prime, we denote the
        finite field with <span class="math">p</span> elements by
        <span class="math">\mathbb&#123;F&#125;_p</span>. Further,
        let <span class="math">g</span> be a generator of the
        multiplicative group
        <span class="math">\mathbb&#123;F&#125;_p^*</span> and for
        any
        <span class="math">\alpha \in \mathbb&#123;F&#125;_p^*</span>,
        <span class="math">\langle \alpha \rangle</span> is the
        multiplicative subgroup of
        <span class="math">\mathbb&#123;F&#125;_p^*</span> generated
        by <span class="math">\alpha</span>.
      </p>

      <p class="text-gray-300">
        Rescue operates on a state which is represented as an element
        of <span class="math">\mathbb&#123;F&#125;_p^m</span>. In
        other words, the state is represented by
        <span class="math">m</span> words in
        <span class="math">\mathbb&#123;F&#125;_p</span>. The state
        is transformed by an S-box layer followed by a linear layer
        and a key addition. In what follows, we stick to the common
        way of counting rounds as the number of S-box layer
        applications (including following linear layer and key
        addition).
      </p>

      <p class="text-gray-300">
        The S-box layer is not identical for all rounds, but rather
        two S-box layers are alternated, where the second is the
        inverse of the first. The S-box is a power permutation, i.e.
        for the smallest prime <span class="math">d</span> that is
        coprime to <span class="math">p - 1</span>:
      </p>
      <div class="math-block">
        S(x) \coloneqq x^&#123;1/d&#125;
      </div>
      <p class="text-gray-300">
        and <span class="math">S^&#123;-1&#125;</span> accordingly.
        The linear layer multiplies the state by a (randomly generated
        Cauchy) MDS matrix
        <span class="math">M \in \mathbb&#123;F&#125;_p^&#123;m \times m&#125;</span>.
        The key schedule for deriving the round keys reuses this round
        function; each round key
        <span class="math">k_i</span> is the state after the
        <span class="math">i</span>th application of the round
        function. During the key schedule, the &ldquo;round
        key&rdquo; addition is substituted by a round constant
        addition, where the round constants
        <span class="math">\mathrm&#123;rc&#125;_i</span> are pseudo
        randomly chosen.
      </p>

      <p class="text-gray-300">
        Overall, Rescue iterates
        <span class="math">r = \min\&#123;20, 4\lceil \log_2(p)/4 \rceil\&#125;</span>
        rounds. Suggested parameters for Rescue are:
      </p>

      <div class="overflow-x-auto my-4">
        <table class="text-sm text-gray-300 border-collapse">
          <thead>
            <tr class="border-b border-gray-700">
              <th class="px-4 py-2 text-left">Parameter Name</th>
              <th class="px-4 py-2 text-left">
                <span class="math">n = \log_2 p</span></th>
              <th class="px-4 py-2 text-left">
                <span class="math">m</span></th>
              <th class="px-4 py-2 text-left">
                <span class="math">r</span></th>
            </tr>
          </thead>
          <tbody>
            <tr class="border-b border-gray-800">
              <td class="px-4 py-2">Rescue128a</td>
              <td class="px-4 py-2">125</td>
              <td class="px-4 py-2">4</td>
              <td class="px-4 py-2">32</td>
            </tr>
            <tr class="border-b border-gray-800">
              <td class="px-4 py-2">Rescue128b</td>
              <td class="px-4 py-2">253</td>
              <td class="px-4 py-2">12</td>
              <td class="px-4 py-2">44</td>
            </tr>
            <tr class="border-b border-gray-800">
              <td class="px-4 py-2">Rescue128c</td>
              <td class="px-4 py-2">125</td>
              <td class="px-4 py-2">12</td>
              <td class="px-4 py-2">20</td>
            </tr>
            <tr class="border-b border-gray-800">
              <td class="px-4 py-2">Rescue128d</td>
              <td class="px-4 py-2">61</td>
              <td class="px-4 py-2">12</td>
              <td class="px-4 py-2">20</td>
            </tr>
            <tr>
              <td class="px-4 py-2">Rescue128e</td>
              <td class="px-4 py-2">253</td>
              <td class="px-4 py-2">11</td>
              <td class="px-4 py-2">20</td>
            </tr>
          </tbody>
        </table>
      </div>
    </section>

    <!-- ============================================================ -->
    <!-- 3. LINEAR CRYPTANALYSIS                                      -->
    <!-- ============================================================ -->

    <section id="sec-3" class="mb-10">
      <h2 class="text-2xl font-bold">
        3. Linear Cryptanalysis
      </h2>

      <p class="text-gray-300">
        A natural generalization of linear cryptanalysis to
        <span class="math">\mathbb&#123;F&#125;_p^m</span> is to
        consider the probability distribution of linear combinations
        <span class="math">u^\top x</span> of the state
        <span class="math">x</span>. As discussed in [Bey19], this
        distribution can be associated with a
        <span class="math">p</span>-dimensional subspace of the
        vector space of functions
        <span class="math">\mathbb&#123;F&#125;_p^m \to \mathbb&#123;C&#125;</span>.
        A basis for this subspace is given by the functions
        <span class="math">x \mapsto \chi(u^\top x)</span> where
        <span class="math">\chi</span> is an additive character of
        <span class="math">\mathbb&#123;F&#125;_p</span>.
      </p>

      <p class="text-gray-300">
        In the following, let <span class="math">\chi</span> denote
        an additive character of
        <span class="math">\mathbb&#123;F&#125;_p</span>. Further,
        let <span class="math">d</span> be an integer coprime to
        <span class="math">p - 1</span>. This section is structured
        into two parts: Section 3.1 shows that (for
        <span class="math">p</span> large enough) two rounds of
        Rescue have no linear trails with correlation significantly
        higher than
        <span class="math">p^&#123;-m/2&#125;</span>. Section 3.2
        provides upper bounds on the correlation of linear
        approximations over four rounds of Rescue.
      </p>

      <!-- 3.1 Upper Bounds for Linear Trails -->

      <h3 id="sec-3.1" class="text-xl font-semibold mt-8 mb-3">
        3.1 Upper Bounds for Linear Trails
      </h3>

      <p class="text-gray-300">
        We first show that every linear trail over two rounds has
        correlation less than
        <span class="math">p^&#123;-m/2&#125;</span> if
        <span class="math">p</span> is sufficiently large. As in
        the characteristic two case, the MDS-property of the linear
        layer ensures that absolute correlations of two-round
        approximations are bounded by
        <span class="math">|c|^&#123;m+1&#125;</span>, where
        <span class="math">c</span> is the correlation of the best
        non-trivial linear approximation of
        <span class="math">x \mapsto x^d</span>.
      </p>

      <p class="text-gray-300">
        The correlation of a linear approximation over a single S-box
        is given by
      </p>
      <div class="math-block">
        \frac&#123;1&#125;&#123;p&#125; \sum_&#123;x \in \mathbb&#123;F&#125;_p&#125; \chi(ux - vx^d) = \frac&#123;1&#125;&#123;p&#125; \sum_&#123;x \in \mathbb&#123;F&#125;_p&#125; \chi(x^d - uv^&#123;-1/d&#125;x)
      </div>

      <p class="text-gray-300">
        Consequently, it suffices to compute the exponential sums
      </p>
      <div class="math-block">
        \sum_&#123;x \in \mathbb&#123;F&#125;_p&#125; \chi(x^d + wx)
      </div>

      <p class="text-gray-300">
        We use the following classical result due to Weil [Wei48].
      </p>

      <div class="formal-block formal-block-theorem">
        <div class="formal-block-title text-green-400">
          Proposition 1 (Weil [Wei48])
        </div>
        <div class="formal-block-content">
          <p class="text-gray-300">
            Let <span class="math">\chi</span> be an additive
            character of
            <span class="math">\mathbb&#123;F&#125;_p</span> and
            <span class="math">f</span> a non-constant univariate
            polynomial of degree <span class="math">d</span> over
            <span class="math">\mathbb&#123;F&#125;_p</span>. It
            holds that
          </p>
          <div class="math-block">
            \left| \sum_&#123;x \in \mathbb&#123;F&#125;_p&#125; \chi(f(x)) \right| \leqslant (d-1)\, p^&#123;1/2&#125;
          </div>
        </div>
      </div>

      <p class="text-gray-300">
        For <span class="math">d = 3</span>, Proposition 1 yields the
        bound
        <span class="math">|c| \leqslant (d-1)/\sqrt&#123;p&#125;</span>.
        Consequently, the correlation of an
        <span class="math">r</span>-round trail is bounded by
      </p>
      <div class="math-block">
        \left(\frac&#123;d-1&#125;&#123;\sqrt&#123;p&#125;&#125;\right)^&#123;r(m+1)&#125; \leqslant p^&#123;-m/2&#125;
      </div>
      <p class="text-gray-300">
        where the inequality holds for
        <span class="math">r \geqslant \frac&#123;1&#125;&#123;4&#125; \log_&#123;d-1&#125; p / (\log_&#123;d-1&#125; p - 2)</span>.
      </p>

      <!-- 3.2 Upper Bounds for Four Rounds -->

      <h3 id="sec-3.2" class="text-xl font-semibold mt-8 mb-3">
        3.2 Upper Bounds for Four Rounds
      </h3>

      <p class="text-gray-300">
        The result from the previous section shows that there are no
        usable linear trails. However, since iterating the Rescue
        round function gives a function of the form
        <span class="math">S \circ A \circ S^&#123;-1&#125; \circ A'</span>
        with <span class="math">A</span> and
        <span class="math">A'</span> affine maps, it is natural to
        wonder if clustering of linear trails can result in strong
        linear approximations over iterations of the round function.
        To this end, we will give upper bounds on the correlation of
        arbitrary approximations over
        <span class="math">F = S \circ A \circ S^&#123;-1&#125;</span>.
      </p>

      <p class="text-gray-300">
        We start from the straightforward observation that the
        correlation of a two-round approximation with masks
        <span class="math">(u, v)</span> is given by
      </p>
      <div class="math-block">
        \frac&#123;1&#125;&#123;p^m&#125; \sum_&#123;x \in \mathbb&#123;F&#125;_p^m&#125; \chi(u^\top x - v^\top F(x)) = \frac&#123;1&#125;&#123;p^m&#125; \sum_&#123;x \in \mathbb&#123;F&#125;_p^m&#125; \chi(u^\top S(x) - v^\top (S \circ A)(x))
      </div>

      <p class="text-gray-300">
        Let <span class="math">A(x) = Mx + c</span> with
        <span class="math">M \in \mathbb&#123;F&#125;_p^&#123;m \times m&#125;</span>.
        Computing the correlation then amounts to computing the
        exponential sum
      </p>
      <div class="math-block">
        \sum_&#123;z \in \alpha + V&#125; \chi\!\left(\sum_&#123;i=1&#125;^&#123;t&#125; w_i z_i^d\right)
      </div>
      <p class="text-gray-300">
        where <span class="math">t = 2m</span>,
        <span class="math">\alpha = (0, c)</span> and
        <span class="math">w = (u, -v)</span>.
      </p>

      <div class="formal-block formal-block-theorem">
        <div class="formal-block-title text-green-400">
          Proposition 2 (Deligne [Del74])
        </div>
        <div class="formal-block-content">
          <p class="text-gray-300">
            Let <span class="math">g</span> be a degree
            <span class="math">d</span> polynomial in
            <span class="math">n</span> variables on
            <span class="math">\mathbb&#123;F&#125;_p</span> with
            maximal homogeneous part <span class="math">h</span>.
            Suppose <span class="math">d</span> is coprime to
            <span class="math">p</span> and the projective
            hypersurface defined by <span class="math">h</span> in
            <span class="math">\mathbb&#123;P&#125;_p^&#123;n-1&#125;</span>
            is non-singular. For any additive character
            <span class="math">\chi</span> of
            <span class="math">\mathbb&#123;F&#125;_p</span>, it
            holds that
          </p>
          <div class="math-block">
            \left|\sum_&#123;x \in \mathbb&#123;F&#125;_p^n&#125; \chi(g(x))\right| \leqslant (d-1)^n p^&#123;n/2&#125;
          </div>
        </div>
      </div>

      <div class="formal-block formal-block-theorem">
        <div class="formal-block-title text-green-400">
          Proposition 3 (Katz [Kat99])
        </div>
        <div class="formal-block-content">
          <p class="text-gray-300">
            Let <span class="math">g</span> be a degree
            <span class="math">d</span> polynomial in
            <span class="math">n</span> variables on
            <span class="math">\mathbb&#123;F&#125;_p</span> with
            maximal homogeneous part <span class="math">h</span>.
            Suppose <span class="math">d</span> is coprime to
            <span class="math">p</span> and the singular set of the
            projective hypersurface defined by
            <span class="math">h</span> in
            <span class="math">\mathbb&#123;P&#125;_p^&#123;n-1&#125;</span>
            has dimension <span class="math">\delta</span>. For any
            additive character <span class="math">\chi</span> of
            <span class="math">\mathbb&#123;F&#125;_p</span>, it
            holds that
          </p>
          <div class="math-block">
            \left| \sum_&#123;x \in \mathbb&#123;F&#125;_p^n&#125; \chi(g(x)) \right| \leqslant C\, p^&#123;(n + \delta + 1)/2&#125;
          </div>
          <p class="text-gray-300">
            where
            <span class="math">C = (4d + 5)^n</span>.
          </p>
        </div>
      </div>

      <p class="text-gray-300">
        Follow-up work by Rojas Le&oacute;n [RL04] provides a
        generalization and shows that <span class="math">C</span> may
        be taken as
        <span class="math">C = 3(d + 1)^n</span>. To apply
        Katz&rsquo;s result, the remaining work is to determine the
        dimension <span class="math">\delta</span>.
      </p>

      <div class="formal-block formal-block-theorem">
        <div class="formal-block-title text-green-400">
          Proposition 4
        </div>
        <div class="formal-block-content">
          <p class="text-gray-300">
            Let
            <span class="math">F = S \circ A \circ S^&#123;-1&#125;</span>,
            <span class="math">\sigma(x) = \sum_&#123;i=1&#125;^&#123;m&#125; S(x)_i</span>
            and denote the linear part of the affine map
            <span class="math">A</span> by
            <span class="math">M</span>. Let
            <span class="math">L(x) = (x, Mx)</span> and, for any
            masks
            <span class="math">u, v \in \mathbb&#123;F&#125;_p^m</span>,
            let
            <span class="math">D = \mathrm&#123;diag&#125;(u_1, \ldots, u_m, -v_1, \ldots, -v_m)</span>.
            Furthermore, let
          </p>
          <div class="math-block">
            \mathbb&#123;V&#125; = \left\&#123; x \in \overline&#123;\mathbb&#123;F&#125;&#125;_p^m \mid L^\top D\left[(\nabla \sigma) \circ L\right](x) = 0 \right\&#125;
          </div>
          <p class="text-gray-300">
            If
            <span class="math">\dim \mathbb&#123;V&#125; \leq \ell</span>,
            then for any additive character
            <span class="math">\chi</span> of
            <span class="math">\mathbb&#123;F&#125;_p</span>,
          </p>
          <div class="math-block">
            \left| \frac&#123;1&#125;&#123;p^m&#125; \sum_&#123;x \in \mathbb&#123;F&#125;_p^m&#125; \chi(u^\top x - v^\top F(x)) \right| \leqslant C\, p^&#123;(\ell - m)/2&#125;
          </div>
          <p class="text-gray-300">
            where
            <span class="math">C = (d-1)^m</span> for
            <span class="math">\ell = 0</span> and
            <span class="math">C = 3(d+1)^m</span> if
            <span class="math">\ell \geqslant 1</span>.
          </p>
        </div>
      </div>

      <p class="text-gray-300">
        The section continues with detailed Gr&ouml;bner basis
        computations for <span class="math">m = 2</span> (with
        <span class="math">p = 41</span>) and
        <span class="math">m = 3</span> (with
        <span class="math">p = 1511</span>), showing that
        <span class="math">\dim \mathbb&#123;V&#125; = 0</span> for
        all but a small fraction of masks. For
        <span class="math">m = 2</span>, the exceptional fraction is
        at most <span class="math">4/p</span>; for
        <span class="math">m = 3</span>, it is at most
        <span class="math">12/p + 25/p^3</span>. Experimentally, no
        approximations violating the stronger bounds were found.
      </p>
    </section>

    <!-- ============================================================ -->
    <!-- 4. DIFFERENTIAL CRYPTANALYSIS                                -->
    <!-- ============================================================ -->

    <section id="sec-4" class="mb-10">
      <h2 class="text-2xl font-bold">
        4. Differential Cryptanalysis
      </h2>

      <p class="text-gray-300">
        In this section we describe our attempts to attack Rescue
        using differential cryptanalysis. We start by two-round
        differentials, averaged over all round keys, before
        investigating special choices of keys that, even for more
        rounds, lead to a differential uniformity that is larger than
        expected. We add experimental observations to our theoretical
        analysis.
      </p>

      <p class="text-gray-300">
        <strong>Notations.</strong> For differential cryptanalysis, we
        are interested in the number of solutions for the equation
      </p>
      <div class="math-block">
        \Delta_&#123;\alpha&#125; F(x) := F(x) - F(x + \alpha) = \beta
      </div>
      <p class="text-gray-300">
        where <span class="math">F</span> is the (key-dependent)
        function under scrutiny. The Difference Distribution Table
        (DDT) captures these numbers:
      </p>
      <div class="math-block">
        \mathrm&#123;DDT&#125;_F[\alpha, \beta] \coloneqq |\&#123;x \mid \Delta_&#123;\alpha&#125; F(x) = \beta\&#125;|
      </div>
      <p class="text-gray-300">
        The overall resistance of <span class="math">F</span> against
        differential cryptanalysis is measured by its differential
        uniformity:
      </p>
      <div class="math-block">
        \delta(F) := \max_&#123;\alpha \neq 0,\, \beta&#125; \mathrm&#123;DDT&#125;_F[\alpha, \beta]
      </div>

      <!-- 4.1 Two-round differentials -->

      <h3 id="sec-4.1" class="text-xl font-semibold mt-8 mb-3">
        4.1 Two-Round Differentials
      </h3>

      <p class="text-gray-300">
        The aim of this section is to understand how the study of
        two-round differentials [8, 5] on the AES can be transferred
        to Rescue.
      </p>

      <div class="formal-block formal-block-theorem">
        <div class="formal-block-title text-green-400">
          Proposition 5
        </div>
        <div class="formal-block-content">
          <p class="text-gray-300">
            The MEDP of two rounds of Rescue operating on
            <span class="math">\mathbb&#123;F&#125;_p^m</span> with
            an S-box layer with differential uniformity
            <span class="math">\delta(S)</span> and an MDS linear
            layer satisfies
          </p>
          <div class="math-block">
            \mathsf&#123;MEDP&#125;_2 \leqslant \left(\frac&#123;\delta(S)&#125;&#123;p&#125;\right)^m
          </div>
        </div>
      </div>

      <p class="text-gray-300">
        In the specific case of Rescue, the S-box has differential
        uniformity 2, which leads to
      </p>
      <div class="math-block">
        \mathsf&#123;MEDP&#125;_2 \leqslant \left(\frac&#123;2&#125;&#123;p&#125;\right)^m
      </div>

      <p class="text-gray-300">
        However, the MEDP is the highest probability of a
        differential, among all differentials averaged over the round
        key (or round constant). This may be very different from the
        maximal differential probability with a fixed key.
      </p>

      <div class="formal-block formal-block-theorem">
        <div class="formal-block-title text-green-400">
          Proposition 6
        </div>
        <div class="formal-block-content">
          <p class="text-gray-300">
            Let <span class="math">M</span> denote the MDS matrix and
            <span class="math">(K_0, \ldots, K_&#123;m-1&#125;) \in \mathbb&#123;F&#125;_p^m</span>
            the round key. For all round-keys such that
            <span class="math">(K_0, \ldots, K_&#123;m-1&#125;)</span>
            or
            <span class="math">M^&#123;-1&#125;(K_0, \ldots, K_&#123;m-1&#125;)^\top</span>
            has weight at most
            <span class="math">(m - 1)</span>, the function
            corresponding to two rounds of Rescue has differential
            uniformity at least <span class="math">p</span>.
          </p>
          <p class="text-gray-300">
            Moreover, for all round-keys such that both
            <span class="math">(K_0, \ldots, K_&#123;m-1&#125;)</span>
            and
            <span class="math">M^&#123;-1&#125;(K_0, \ldots, K_&#123;m-1&#125;)^\top</span>
            have weight <span class="math">m</span>, all
            differentials of weight
            <span class="math">(m + 1)</span> such that either the
            input difference or the difference after the second S-box
            layer has weight 1 are satisfied for at most
            <span class="math">2^&#123;m+2&#125;</span> inputs.
          </p>
        </div>
      </div>

      <p class="text-gray-300">
        <em>Proof sketch.</em> The proof considers differentials where
        the input difference has weight 1 and analyzes the system of
        equations arising from the two S-box layers. When
        <span class="math">M^&#123;-1&#125;K</span> has a zero
        component, a degenerate case occurs where the differential is
        satisfied by exactly <span class="math">p</span> inputs.
        Otherwise, the system reduces to a degree-4 equation in
        <span class="math">\lambda</span> with at most 4 solutions,
        each leading to at most
        <span class="math">2^m</span> values, giving a total of at
        most <span class="math">2^&#123;m+2&#125;</span>.
      </p>

      <!-- 4.2 Four-round differentials and weak round-keys -->

      <h3 id="sec-4.2" class="text-xl font-semibold mt-8 mb-3">
        4.2 Four-Round Differentials and Weak Round-Keys
      </h3>

      <p class="text-gray-300">
        In the following, we consider several rounds with independent
        round-keys (i.e., we do not use the key-schedule defined for
        the Rescue block cipher). Simulation results for
        <span class="math">m = 2</span> show that there is a small
        proportion of round keys for which the differential uniformity
        of four rounds exceeds <span class="math">p</span>.
      </p>

      <div class="formal-block formal-block-theorem">
        <div class="formal-block-title text-green-400">
          Proposition 7 (Two-Round Multiplicative Property)
        </div>
        <div class="formal-block-content">
          <p class="text-gray-300">
            Let <span class="math">G_&#123;2,d&#125;</span> be two
            rounds of Rescue operating on
            <span class="math">\mathbb&#123;F&#125;_p^m</span> and
            let
            <span class="math">(K_0, \ldots, K_&#123;m-1&#125;)</span>
            denote the round-key. Let
            <span class="math">\alpha \in \mathbb&#123;F&#125;_p^m</span>
            and <span class="math">S</span> denote the support of
          </p>
          <div class="math-block">
            M \begin&#123;pmatrix&#125; \alpha_0^d \\ \vdots \\ \alpha_&#123;m-1&#125;^d \end&#123;pmatrix&#125;
          </div>
          <p class="text-gray-300">
            Then, for any key such that
            <span class="math">K_i = 0</span> for all
            <span class="math">i \in S</span>, there exists
            <span class="math">\beta \in \mathbb&#123;F&#125;_p^m</span>
            with
            <span class="math">\mathrm&#123;Supp&#125;(\beta) = S</span>
            such that, for all
            <span class="math">\lambda \in \mathbb&#123;F&#125;_p</span>,
          </p>
          <div class="math-block">
            G_&#123;2,d&#125;(\lambda \alpha_0, \ldots, \lambda \alpha_&#123;m-1&#125;) - G_&#123;2,d&#125;(0, \ldots, 0) = (\lambda \beta_0, \ldots, \lambda \beta_&#123;m-1&#125;)
          </div>
        </div>
      </div>

      <div class="formal-block formal-block-theorem">
        <div class="formal-block-title text-green-400">
          Corollary 1 (Three-Round Multiplicative Property)
        </div>
        <div class="formal-block-content">
          <p class="text-gray-300">
            Let <span class="math">G_&#123;3,d&#125;</span> be three
            rounds of Rescue operating on
            <span class="math">\mathbb&#123;F&#125;_p^m</span> and
            let <span class="math">K_r</span> denote the key at
            round <span class="math">r</span>. Let
            <span class="math">\alpha \in \mathbb&#123;F&#125;_p^m</span>
            and <span class="math">S</span> denote the support of
            <span class="math">M(\alpha_0^d, \ldots, \alpha_&#123;m-1&#125;^d)^\top</span>.
            Then, for any <span class="math">K_0</span> such that
            <span class="math">K_&#123;0,i&#125; = 0</span> for all
            <span class="math">i \in S</span>, there exist
            <span class="math">K_1</span> and
            <span class="math">\beta \in \mathbb&#123;F&#125;_p^m</span>
            such that, for all
            <span class="math">\lambda \in \mathbb&#123;F&#125;_p</span>,
          </p>
          <div class="math-block">
            G_&#123;3,d&#125;(\lambda \alpha) = \lambda^d \beta
          </div>
        </div>
      </div>

      <div class="formal-block formal-block-lemma">
        <div class="formal-block-title text-amber-400">
          Lemma 1
        </div>
        <div class="formal-block-content">
          <p class="text-gray-300">
            Let <span class="math">G_&#123;3,d&#125;</span> be three
            rounds of Rescue operating on
            <span class="math">\mathbb&#123;F&#125;_p^m</span> and
            let <span class="math">K_r</span> denote the key at
            round <span class="math">r</span>. Let
            <span class="math">\alpha \in \mathbb&#123;F&#125;_p^m</span>
            and <span class="math">S</span> denote the support of
            <span class="math">M(\alpha_0^d, \ldots, \alpha_&#123;m-1&#125;^d)^\top</span>.
            Then, for any <span class="math">K_0</span> such that
            <span class="math">K_&#123;0,i&#125; = 0</span> for all
            <span class="math">i \in S</span> and for any
            <span class="math">\lambda_0 \in \mathbb&#123;F&#125;_p</span>,
            there exist <span class="math">K_1</span> and
            <span class="math">\beta \in \mathbb&#123;F&#125;_p^m</span>
            such that, for all
            <span class="math">\lambda \in \mathbb&#123;F&#125;_p</span>,
          </p>
          <div class="math-block">
            G_&#123;3,d&#125;(\lambda \alpha) - G_&#123;3,d&#125;(0, \ldots, 0) = \left[(\lambda + \lambda_0)^d - \lambda_0^d\right] \beta
          </div>
        </div>
      </div>

      <div class="formal-block formal-block-theorem">
        <div class="formal-block-title text-green-400">
          Proposition 8 (Four-Round Multiplicative Property)
        </div>
        <div class="formal-block-content">
          <p class="text-gray-300">
            Let <span class="math">G_&#123;4,1/d&#125;</span> be four
            rounds of Rescue operating on
            <span class="math">\mathbb&#123;F&#125;_p^m</span> and
            let <span class="math">K_r</span> denote the key at
            round <span class="math">r</span>. Then, for any
            <span class="math">K_0</span>, there is at least one
            <span class="math">(K_1, K_2)</span> such that there
            exist
            <span class="math">x \in \mathbb&#123;F&#125;_p^m</span>,
            <span class="math">\delta \in \mathbb&#123;F&#125;_p^m</span>
            with
            <span class="math">\mathrm&#123;wt&#125;(\delta) = 1</span>
            and
            <span class="math">\beta \in \mathbb&#123;F&#125;_p^m</span>
            for which
          </p>
          <div class="math-block">
            G_&#123;4,1/d&#125;(x + \mu \delta) - G_&#123;4,1/d&#125;(x) = \mu \beta
          </div>
          <p class="text-gray-300">
            It follows that, for these keys, the differential
            <span class="math">(\delta, \beta)</span> is satisfied by
            at least <span class="math">p</span> inputs, namely all
            <span class="math">x + \mu \delta</span>,
            <span class="math">\mu \in \mathbb&#123;F&#125;_p</span>.
          </p>
        </div>
      </div>

      <div class="formal-block formal-block-theorem">
        <div class="formal-block-title text-green-400">
          Corollary 2
        </div>
        <div class="formal-block-content">
          <p class="text-gray-300">
            Let <span class="math">M^&#123;[d]&#125;</span> denote
            the matrix whose entries at position
            <span class="math">(i, j)</span> correspond to
            <span class="math">a_&#123;i,j&#125;^d</span>. Let
            <span class="math">K_1 \in \mathbb&#123;F&#125;_p^m</span>
            such that <span class="math">K_1</span> vanishes on the
            support of a column of
            <span class="math">(M M^&#123;[d]&#125;)</span>. Then,
            for all
            <span class="math">K_0 \in \mathbb&#123;F&#125;_p^m</span>,
            there exists
            <span class="math">K_2 \in \mathbb&#123;F&#125;_p^m</span>
            such that
            <span class="math">G_&#123;4,1/d&#125;</span> with round
            keys <span class="math">(K_0, K_1, K_2)</span> has
            differential uniformity at least
            <span class="math">p</span>.
          </p>
        </div>
      </div>

      <!-- 4.3 More Experimental Results -->

      <h3 id="sec-4.3" class="text-xl font-semibold mt-8 mb-3">
        4.3 More Experimental Results
      </h3>

      <p class="text-gray-300">
        In order to experimentally assess the security of Rescue, we
        compute the differential uniformity of multiple instances of
        the block cipher. Our aims are: (1) analyse whether the
        behaviours identified above can occur with a strong round
        constant derivation procedure, and (2) analyse the number of
        rounds needed to reach the differential uniformity of a random
        permutation operating on the same set.
      </p>

      <div class="formal-block formal-block-theorem">
        <div class="formal-block-title text-green-400">
          Proposition 9
        </div>
        <div class="formal-block-content">
          <p class="text-gray-300">
            Let <span class="math">F</span> be a permutation on
            <span class="math">(\mathbb&#123;F&#125;_p)^m</span>
            picked uniformly at random from the corresponding set,
            where <span class="math">p</span> is prime. The DDT
            coefficients of <span class="math">F</span> that
            correspond to non-zero input differences can all be
            accurately modeled as
            <span class="math">(p^m - 1)^2 / 2</span> independent
            and identically distributed variables following a Poisson
            distribution with parameter 1.
          </p>
        </div>
      </div>

      <div class="formal-block formal-block-theorem">
        <div class="formal-block-title text-green-400">
          Conjecture 1
        </div>
        <div class="formal-block-content">
          <p class="text-gray-300">
            The probability that the differential uniformity of a
            permutation of
            <span class="math">(\mathbb&#123;F&#125;_p)^m</span> is
            upper bounded by
          </p>
          <div class="math-block">
            B(p, m) = \frac&#123;2 \log\!\left(\frac&#123;(p^m - 1)^2&#125;&#123;2&#125;\right)&#125;&#123;\log\!\left(\log\!\left(\frac&#123;(p^m - 1)^2&#125;&#123;2&#125;\right)\right)&#125;
          </div>
          <p class="text-gray-300">
            converges to 1 as <span class="math">p</span> increases,
            where <span class="math">\log</span> is the natural
            logarithm.
          </p>
        </div>
      </div>

      <p class="text-gray-300">
        Experimental results confirm the conjecture: the DDT
        coefficients of random permutations over
        <span class="math">\mathbb&#123;F&#125;_p</span> behave like
        Poisson-distributed variables with parameter 1. The
        differential uniformity of Rescue instances converges to the
        predicted bound within 4&ndash;5 rounds in the overwhelming
        majority of cases.
      </p>

      <p class="text-gray-300">
        <strong>Remark 1.</strong> The analysis highlights the
        importance of having a strong round constant derivation
        method. The round constant generation method for the hash
        function could allow related-cipher attacks if Rescue is
        superseded by Rescue2 in the future, since these hash
        functions would share some round constants at different
        positions.
      </p>
    </section>

    <!-- ============================================================ -->
    <!-- 5. MULTIPLICATIVE SUBGROUPS ANALYSIS                         -->
    <!-- ============================================================ -->

    <section id="sec-5" class="mb-10">
      <h2 class="text-2xl font-bold">
        5. Multiplicative Subgroups Analysis
      </h2>

      <p class="text-gray-300">
        The idea of this analysis, or attack vector, is to trace how
        cosets of multiplicative subgroups get mapped to other cosets
        through the encryption process. This can be seen as a
        multiplicative variant of linear cryptanalysis in the case of
        a subgroup of codimension 2. We first describe the idea and
        fix the notation. Next, we investigate how those
        multiplicative structures are affected by the separate parts
        of the round function, i.e. the linear layer, the S-box, and
        the key-addition. Finally, we focus on the most interesting
        case of what we call a diagonal subgroup, a structure closely
        related to one-dimensional subspaces.
      </p>

      <p class="text-gray-300">
        We show that it is in principle possible to maliciously choose
        round constants that would lead to a significant non-random
        behaviour for any key even using the heavy key-scheduling of
        Rescue.
      </p>

      <!-- 5.1 The Setup -->

      <h3 id="sec-5.1" class="text-xl font-semibold mt-8 mb-3">
        5.1 The Setup
      </h3>

      <p class="text-gray-300">
        Let
        <span class="math">U \subseteq \mathbb&#123;F&#125;_p^*</span>
        be a multiplicative subgroup of
        <span class="math">\mathbb&#123;F&#125;_p^*</span> of order
        <span class="math">q \mid p - 1</span>. The cosets of
        <span class="math">U</span> are
        <span class="math">U, gU, g^2 U, \ldots, g^&#123;s-1&#125; U</span>,
        where <span class="math">s = (p-1)/q</span> and
        <span class="math">g</span> is a generator of
        <span class="math">\mathbb&#123;F&#125;_p^*</span>. We extend
        such a subgroup to
      </p>
      <div class="math-block">
        U^&#123;\otimes m&#125; = U \times \cdots \times U \subseteq (\mathbb&#123;F&#125;_p^*)^m
      </div>
      <p class="text-gray-300">
        by the componentwise multiplication. We define, for a function
        <span class="math">F : \mathbb&#123;F&#125;_p^m \to \mathbb&#123;F&#125;_p^m</span>,
        the counters
      </p>
      <div class="math-block">
        c_F(\alpha, \beta) = |\&#123;x \in \alpha U^&#123;\otimes m&#125; \mid F(x) \in \beta U^&#123;\otimes m&#125;\&#125;|
      </div>
      <p class="text-gray-300">
        which correspond, up to scaling, to the probability of an
        element in
        <span class="math">\alpha U^&#123;\otimes m&#125;</span> being
        mapped to the coset
        <span class="math">\beta U^&#123;\otimes m&#125;</span> by
        <span class="math">F</span>.
      </p>

      <!-- 5.2 The Effect of the Round Operations -->

      <h3 id="sec-5.2" class="text-xl font-semibold mt-8 mb-3">
        5.2 The Effect of the Round Operations
      </h3>

      <p class="text-gray-300">
        <strong>S-box Layer.</strong> The S-box
        <span class="math">S : \mathbb&#123;F&#125;_p \to \mathbb&#123;F&#125;_p</span>
        is a permutation of the form
        <span class="math">x \mapsto x^d</span>. Since
        <span class="math">S(\alpha_i U) = \alpha_i^d U^d = \alpha_i^d U</span>,
        the S-box layer only permutes the cosets. In other words, the
        probability that an input from a specific coset is mapped by
        the S-box to another specific coset is either one or zero.
      </p>

      <p class="text-gray-300">
        <strong>Constant Addition.</strong> Given a constant
        <span class="math">k \in \mathbb&#123;F&#125;_p^m</span>,
        the transition counter
        <span class="math">c_k(\alpha, \beta)</span> relates to the
        cyclotomic numbers of order <span class="math">s</span>.
        For <span class="math">s = 2</span> (squares vs
        non-squares), the cyclotomic numbers are known exactly and
        depend on whether <span class="math">-1</span> is a square.
        For <span class="math">s > 2</span>, the bound is
      </p>
      <div class="math-block">
        \left| c_k(\alpha, \beta) - \frac&#123;|U|&#125;&#123;s&#125; \right| \leqslant 2\sqrt&#123;p&#125;
      </div>
      <p class="text-gray-300">
        which implies a rather uniform distribution for large
        subgroups.
      </p>

      <div class="formal-block formal-block-theorem">
        <div class="formal-block-title text-green-400">
          Proposition 10
        </div>
        <div class="formal-block-content">
          <p class="text-gray-300">
            Let
            <span class="math">L : \mathbb&#123;F&#125;_p^m \to \mathbb&#123;F&#125;_p^m</span>
            be a linear mapping. Then
          </p>
          <div class="math-block">
            |U| \mid c_L(\alpha, \beta)
          </div>
          <p class="text-gray-300">
            that is, all transition counters are divisible by the size
            of <span class="math">U</span>.
          </p>
        </div>
      </div>

      <!-- 5.3 Diagonal Subgroups -->

      <h3 id="sec-5.3" class="text-xl font-semibold mt-8 mb-3">
        5.3 Diagonal Subgroups
      </h3>

      <p class="text-gray-300">
        For a subgroup
        <span class="math">U \subseteq \mathbb&#123;F&#125;_p^*</span>
        we define
      </p>
      <div class="math-block">
        \mathcal&#123;D&#125;(U) := \&#123;(a, \ldots, a) \mid a \in U\&#125; \subseteq (\mathbb&#123;F&#125;_p^*)^m
      </div>
      <p class="text-gray-300">
        These diagonal subgroups and their cosets behave nicely for
        both the linear layer and the S-boxes: the transition matrices
        are permutation matrices. However, the key-addition destroys
        this behaviour with very high probability in general.
      </p>

      <p class="text-gray-300">
        For the easiest case of
        <span class="math">U = \mathbb&#123;F&#125;_p^*</span>
        entirely, fixing an arbitrary vector
        <span class="math">\alpha \in (\mathbb&#123;F&#125;_p^*)^m</span>
        and constants <span class="math">k = \alpha</span>, the coset
        <span class="math">\alpha \mathcal&#123;D&#125;(\mathbb&#123;F&#125;_p^*)</span>
        is mapped to itself by adding the key, since for
        <span class="math">a \in \mathbb&#123;F&#125;_p^*</span> we
        have
        <span class="math">a\alpha + k = a\alpha + \alpha = (a+1)\alpha</span>.
        Choosing round constants of the form
      </p>
      <div class="math-block">
        k^&#123;(i+1)&#125; = L\!\left(S\!\left(k^&#123;(i)&#125;\right)\right)
      </div>
      <p class="text-gray-300">
        leads to this diagonal subgroup being mapped to a fixed coset.
        Interestingly, this is very close, up to the round constants,
        to the actual key schedule. This can be reformulated as the
        existence of round constants such that there exists a
        key-independent function
        <span class="math">f : \mathbb&#123;F&#125;_p^* \to \mathbb&#123;F&#125;_p^*</span>
        with
      </p>
      <div class="math-block">
        E_k(ak) = f(a) E_k(k)
      </div>
      <p class="text-gray-300">
        for all <span class="math">a \in \mathbb&#123;F&#125;_p</span>,
        all keys
        <span class="math">k \in (\mathbb&#123;F&#125;_p^*)^m</span>,
        a rather intriguing and unusual property. Luckily, it can be
        argued that almost any other choice of constants seems to be
        destroying this property very quickly and results in a very
        uniform distribution with just one key addition.
      </p>
    </section>

    <!-- ============================================================ -->
    <!-- 6. REBOUND ATTACKS FOR FINDING COLLISIONS                    -->
    <!-- ============================================================ -->

    <section id="sec-6" class="mb-10">
      <h2 class="text-2xl font-bold">
        6. Rebound Attacks for Finding Collisions
      </h2>

      <p class="text-gray-300">
        Rebound attacks are a common tool used for studying the
        security of hash functions. This technique introduced in [Men+09],
        with many follow-up works published in the last few years, can
        allow to efficiently find solutions for a certain differential
        path by merging partial middle solutions, that are enforced by
        first choosing differences and next filling in the values that
        make the difference transitions possible.
      </p>

      <p class="text-gray-300">
        In this section, we first propose a semi-free start collision
        on 3 rounds of the permutation, that will serve as an example
        of the techniques on Rescue. Next, we discuss how this could
        be extended to reach 1 more round generating an output
        near-collision.
      </p>

      <!-- 6.1 Example collision attack on 3 rounds -->

      <h3 id="sec-6.1" class="text-xl font-semibold mt-8 mb-3">
        6.1 Example Collision Attack on 3 Rounds
      </h3>

      <p class="text-gray-300">
        We describe here how to build a semi-free start collision (a
        collision where the value of the capacity is chosen, and the
        difference is introduced in the message part) with a cost of
        <span class="math">2^&#123;n/2&#125;</span> versus
        <span class="math">2^&#123;2n&#125;</span>, which would be the
        generic cost. For illustrating our example we consider the
        parameters <span class="math">m = 12</span>,
        <span class="math">n = 125</span> and a capacity
        <span class="math">c = 4</span>.
      </p>

      <p class="text-gray-300">
        The number of active words in the state at round
        <span class="math">i</span> is denoted by
        <span class="math">N_i</span>. The number of expected
        solutions for the 3-round path is
      </p>
      <div class="math-block">
        2^&#123;mn&#125; \cdot 2^&#123;N_0 n&#125; \cdot 2^&#123;-(m - N_2)n&#125; \cdot 2^&#123;-(m - N_4)n&#125; \cdot 2^&#123;-(m - N_6)n&#125; = 2^&#123;(N_0 + N_2 + N_4 + N_6 - 2m)n&#125;
      </div>

      <p class="text-gray-300">
        With <span class="math">N_0 = N_6 = m - c = 8</span> and
        <span class="math">N_2 + N_4 = m + 1 = 13</span>, the
        procedure builds two lists
        <span class="math">L_1</span> and
        <span class="math">L_2</span> of valid differences, then
        merges them. The cost is
        <span class="math">2^x + 2^y</span>. Choosing
        <span class="math">2^x = 2^y = 2^&#123;n/2&#125;</span>
        yields an optimal overall cost of
        <span class="math">2^&#123;n/2&#125;</span>.
      </p>

      <!-- 6.2 Extension to 4 rounds -->

      <h3 id="sec-6.2" class="text-xl font-semibold mt-8 mb-3">
        6.2 Extension to 4 Rounds
      </h3>

      <p class="text-gray-300">
        Adding one more round to the previous path, the number of
        solutions becomes
      </p>
      <div class="math-block">
        2^&#123;(N_0 + N_2 + N_4 + N_6 + N_8 - 3m)n&#125;
      </div>
      <p class="text-gray-300">
        With the minimum number of active S-boxes, this yields
        <span class="math">2^&#123;-2n&#125;</span> solutions, less
        than 1. The authors explore exploiting a property of the S-box
        <span class="math">S</span> where, for two values
        <span class="math">X, Y</span> with small differences and
        restricted most significant bits,
        <span class="math">S(X) - S(Y)</span> preserves a truncated
        pattern. Combined with a weaker (AES-like) MDS matrix, this
        could extend the attack to 4 rounds for a near-collision.
        However, the matrix property needed is not satisfied by the
        matrices proposed for Rescue.
      </p>

      <!-- 6.3 Conclusion -->

      <h3 id="sec-6.3" class="text-xl font-semibold mt-8 mb-3">
        6.3 Conclusion
      </h3>

      <p class="text-gray-300">
        The best collision attacks we could find on Rescue reach 3
        rounds with a complexity of
        <span class="math">2^&#123;n/2&#125;</span>. We proposed a
        potential extension of the attack by one round for a modified
        MDS matrix and an inverted order of the S-box layers. This
        extension is based on a property of the S-box. The matrix
        property needed for potentially extending the 3-round
        collision attack into a 4-round one is not satisfied by the
        matrices proposed for Rescue.
      </p>

      <p class="text-gray-300">
        Based on our present understanding, it does not seem probable
        that any such attacks could reach 5 rounds. Thus, the security
        margin with respect to rebound-type attacks seems really big.
      </p>
    </section>

    <!-- ============================================================ -->
    <!-- ACKNOWLEDGEMENTS                                             -->
    <!-- ============================================================ -->

    <section id="acknowledgements" class="mb-10">
      <h2 class="text-2xl font-bold">Acknowledgements</h2>
      <p class="text-gray-300">
        This work was supported by StarkWare Industries and the
        Ethereum Foundation.
      </p>
    </section>

    <!-- ============================================================ -->
    <!-- REFERENCES                                                   -->
    <!-- ============================================================ -->

    <section id="references" class="mb-10">
      <h2 class="text-2xl font-bold">References</h2>
      <ul class="space-y-2 text-gray-400 text-sm list-none">
        <li>
          <span class="text-gray-500">[Aly+19]</span>
          Abdelrahaman Aly et al. &ldquo;Design of Symmetric-Key
          Primitives for Advanced Cryptographic Protocols.&rdquo;
          Cryptology ePrint Archive, Report 2019/426.
          <a
            href="https://eprint.iacr.org/2019/426"
            target="_blank"
            rel="noopener noreferrer"
            class="text-blue-400 hover:text-blue-300"
          >eprint.iacr.org/2019/426</a>. 2019.
        </li>
        <li>
          <span class="text-gray-500">[BSV07]</span>
          Thomas Baigneres, Jacques Stern, and Serge Vaudenay.
          &ldquo;Linear cryptanalysis of non binary ciphers.&rdquo;
          In: <em>International Workshop on Selected Areas in
          Cryptography</em>. Springer. 2007, pp. 184&ndash;211.
        </li>
        <li>
          <span class="text-gray-500">[Bey19]</span>
          Tim Beyne. &ldquo;Linear Cryptanalysis in the Weak Key
          Model.&rdquo; KU Leuven, 2019.
        </li>
        <li>
          <span class="text-gray-500">[CLO13]</span>
          David Cox, John Little, and Donal O&rsquo;Shea.
          <em>Ideals, varieties, and algorithms: an introduction to
          computational algebraic geometry and commutative
          algebra</em>. Springer Science &amp; Business Media, 2013.
        </li>
        <li>
          <span class="text-gray-500">[DR07]</span>
          Joan Daemen and Vincent Rijmen. &ldquo;Plateau
          characteristics.&rdquo; In: <em>IET Information
          Security</em> 1.1 (2007), pp. 11&ndash;17.
        </li>
        <li>
          <span class="text-gray-500">[DR05]</span>
          Joan Daemen and Vincent Rijmen.
          <em>Probability distributions of Correlation and
          Differentials in Block Ciphers</em>. Cryptology ePrint
          Archive, Report 2005/212.
          <a
            href="https://eprint.iacr.org/2005/212"
            target="_blank"
            rel="noopener noreferrer"
            class="text-blue-400 hover:text-blue-300"
          >eprint.iacr.org/2005/212</a>. 2005.
        </li>
        <li>
          <span class="text-gray-500">[DR02]</span>
          Joan Daemen and Vincent Rijmen. <em>The Design of
          Rijndael: AES &ndash; The Advanced Encryption
          Standard</em>. Information Security and Cryptography.
          Springer, 2002.
        </li>
        <li>
          <span class="text-gray-500">[DR06]</span>
          Joan Daemen and Vincent Rijmen. &ldquo;Understanding
          Two-Round Differentials in AES.&rdquo; In: <em>SCN
          06</em>. Ed. by Roberto De Prisco and Moti Yung. Vol. 4116.
          LNCS. Springer, Heidelberg, Sept. 2006, pp. 78&ndash;94.
          doi:
          <a
            href="https://doi.org/10.1007/11832072_6"
            target="_blank"
            rel="noopener noreferrer"
            class="text-blue-400 hover:text-blue-300"
          >10.1007/11832072_6</a>.
        </li>
        <li>
          <span class="text-gray-500">[Del74]</span>
          Pierre Deligne. &ldquo;La conjecture de Weil :
          I.&rdquo; In: <em>Publications Math&eacute;matiques de
          l&rsquo;IH&Eacute;S</em> 43 (1974), pp.
          273&ndash;307. url:
          <a
            href="http://eudml.org/doc/103930"
            target="_blank"
            rel="noopener noreferrer"
            class="text-blue-400 hover:text-blue-300"
          >eudml.org/doc/103930</a>.
        </li>
        <li>
          <span class="text-gray-500">[HO99]</span>
          Philip Hawkes and Luke O&rsquo;Connor. &ldquo;XOR and
          Non-XOR Differential Probabilities.&rdquo; In:
          <em>EUROCRYPT&rsquo;99</em>. Ed. by Jacques Stern.
          Vol. 1592. LNCS. Springer, Heidelberg, May 1999,
          pp. 272&ndash;285. doi:
          <a
            href="https://doi.org/10.1007/3-540-48910-X_19"
            target="_blank"
            rel="noopener noreferrer"
            class="text-blue-400 hover:text-blue-300"
          >10.1007/3-540-48910-X_19</a>.
        </li>
        <li>
          <span class="text-gray-500">[Hon+01]</span>
          Seokhie Hong et al. &ldquo;Provable Security against
          Differential and Linear Cryptanalysis for the SPN
          Structure.&rdquo; In: <em>FSE 2000</em>. Ed. by Bruce
          Schneier. Vol. 1978. LNCS. Springer, Heidelberg, Apr. 2001,
          pp. 273&ndash;283. doi:
          <a
            href="https://doi.org/10.1007/3-540-44706-7_19"
            target="_blank"
            rel="noopener noreferrer"
            class="text-blue-400 hover:text-blue-300"
          >10.1007/3-540-44706-7_19</a>.
        </li>
        <li>
          <span class="text-gray-500">[Kat99]</span>
          Nicholas M. Katz. &ldquo;Estimates for singular
          exponential sums.&rdquo; In: <em>International Mathematics
          Research Notices</em> 1999.16 (1999), pp.
          875&ndash;899.
        </li>
        <li>
          <span class="text-gray-500">[Men+09]</span>
          Florian Mendel et al. &ldquo;The Rebound Attack:
          Cryptanalysis of Reduced Whirlpool and
          Gr&oslash;stl.&rdquo; In: <em>FSE 2009</em>. Ed. by Orr
          Dunkelman. Vol. 5665. LNCS. Springer, Heidelberg, Feb.
          2009, pp. 260&ndash;276. doi:
          <a
            href="https://doi.org/10.1007/978-3-642-03317-9_16"
            target="_blank"
            rel="noopener noreferrer"
            class="text-blue-400 hover:text-blue-300"
          >10.1007/978-3-642-03317-9_16</a>.
        </li>
        <li>
          <span class="text-gray-500">[OCo94]</span>
          Luke O&rsquo;Connor. &ldquo;On the Distribution of
          Characteristics in Bijective Mappings.&rdquo; In:
          <em>EUROCRYPT&rsquo;93</em>. Ed. by Tor Helleseth.
          Vol. 765. LNCS. Springer, Heidelberg, May 1994,
          pp. 360&ndash;370. doi:
          <a
            href="https://doi.org/10.1007/3-540-48285-7_31"
            target="_blank"
            rel="noopener noreferrer"
            class="text-blue-400 hover:text-blue-300"
          >10.1007/3-540-48285-7_31</a>.
        </li>
        <li>
          <span class="text-gray-500">[RL04]</span>
          Antonio Rojas Le&oacute;n. &ldquo;General Estimates
          for Exponential Sums.&rdquo; PhD thesis. Princeton
          University, 2004.
        </li>
        <li>
          <span class="text-gray-500">[Wei48]</span>
          Andr&eacute; Weil. &ldquo;On some exponential
          sums.&rdquo; In: <em>Proceedings of the National Academy of
          Sciences of the United States of America</em> 34.5 (1948),
          p. 204.
        </li>
      </ul>
    </section>

  </article>
</BaseLayout>
