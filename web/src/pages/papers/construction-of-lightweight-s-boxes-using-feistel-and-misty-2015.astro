---
import BaseLayout from '../../layouts/BaseLayout.astro';
import PaperDisclaimer from '../../components/PaperDisclaimer.astro';
import PaperHistory from '../../components/PaperHistory.astro';

const EPRINT_URL = 'https://eprint.iacr.org/2015/711';
const CRAWLER = 'marker';
const CONVERTED_DATE = '2026-02-16';
const TITLE_HTML = 'Construction of Lightweight S-Boxes using Feistel and MISTY structures (Full Version)';
const AUTHORS_HTML = 'Anne Canteaut, S&eacute;bastien Duval, Ga&euml;tan Leurent';

const CONTENT = `    <section id="abstract" class="mb-10">
      <h2 class="text-2xl font-bold">Abstract</h2>
      <p class="text-gray-300">The aim of this work is to find large S-Boxes, typically operating on 8
bits, having both good cryptographic properties and a low implementation
cost. Such S-Boxes are suitable building-blocks in many lightweight
block ciphers since they may achieve a better security level than
designs based directly on smaller S-Boxes. We focus on S-Boxes
corresponding to three rounds of a balanced Feistel and of a balanced
MISTY structure, and generalize the recent results by Li and Wang on the
best differential uniformity and linearity offered by such a
construction. Most notably, we prove that Feistel networks supersede
MISTY networks for the construction of 8-bit permutations. Based on
these results, we also provide a particular instantiation of an 8-bit
permutation with better properties than the S-Boxes used in several
ciphers, including Robin, Fantomas or CRYPTON.</p>
      <p class="text-gray-300"><strong>Keywords:</strong> S-Box &middot; Feistel network &middot; MISTY network &middot; Lightweight block-cipher</p>
    </section>

    <section id="sec-1" class="mb-10">
      <h2 class="text-2xl font-bold">1 Introduction</h2>

    <p class="text-gray-300">A secure block cipher must follow Shannon's criteria and provide confusion and diffusion [42]. In most cases, confusion is achieved with small substitution boxes (S-Boxes) operating on parts of the state (usually bytes) in parallel, and diffusion is achieved with linear operations mixing the state. The security of the cipher is then strongly dependent on the cryptographic properties of the S-Boxes. For instance, the AES uses an 8-bit S-Box based on the inversion in the finite field with 2<sup>8</sup> elements. This S-Box has the smallest known differential probability and linear correlation, and then allows the AES to be secure with a small number of rounds, and to reach very good performances. However, it is not always the best option for constrained environments. In software, an S-Box can be implemented with a look-up table in memory, but this takes 256 bytes for the AES S-Box, and there might be issues with cache-timing attacks [7]. In hardware, the best known implementation of the AES S-Box requires 115 gates [13]; this hardware description can also be used for a bit-sliced software implementation [24]. For some constrained environments, this cost might be too high. Therefore, the field of lightweight cryptography has produced many alternatives with a smaller footprint, such as Tea [48], Crypton [28,29], Noekeon [15], PRESENT [11], Katan [16], LBLOCK [49], PRINCE [12], TWINE [45], the LS-Designs [22], or PRIDE [2]. In particular, many of those lightweight ciphers use S-Boxes operating on 4-bit words, or even on a smaller alphabet like in [1]. But, reducing the number of variables increases the values of the optimal differential probability and linear correlation. Therefore, more rounds are required in order to achieve the same resistance against differential and linear attacks.</p>

    <p class="text-gray-300">An alternative approach when constructing a lightweight cipher consists in using larger S-Boxes, typically operating on 8 bits like in the AES, but with a lower implementation cost. Then, we search for S-Boxes with better implementations than the AES S-Box, at the cost of suboptimal cryptographic properties. Finding 8-bit S-Boxes which offer such an interesting trade-off is a difficult problem: they cannot be classified like in the 4-bit case [26,17], and randomly chosen S-Boxes have a high implementation cost [47]. Therefore, we focus on constructions based on smaller S-Boxes and linear operations. This general approach has been used in several previous constructions: CRYPTON v0.5 [28] (3-round Feistel), CRYPTON v1.0 [29] (2-round SPN), WHIRLPOOL [5] (using five small S-Boxes), KHAZAD [4] (3-round SPN), ICEBERG [43] (3-round SPN), ZORRO [20] (4-round</p>

    <p class="text-gray-300"><sup>*</sup> Full version of the extended abstract published in the proceedings of SAC 2015.</p>

    <p class="text-gray-300"><sup>**</sup> Partially supported by the French Agence Nationale de la Recherche through the BLOC project under Contract ANR-11-INS-011.</p>

    <p class="text-gray-300">Feistel with mixing layer), and the LS-Designs <a href="#page-21-7">[22]</a> (3-round Feistel and MISTY network). As in <a href="#page-21-7">[22]</a>, we here focus on constructions with a 3-round Feistel network, or a 3-round balanced MISTY network, because they use only 3 smaller S-Boxes, but can still provide good large S-Boxes. And we study the respective merits of these two constructions, since this comparison is raised as an open question in <a href="#page-21-7">[22]</a>.</p>

    <p class="text-gray-300">The Feistel and MISTY structures have been intensively studied in the context of block cipher design, and bounds are known for the maximum expected differential probability (MEDP) <a href="#page-21-12">[37</a><a href="#page-21-13">,38</a><a href="#page-20-11">,3,</a><a href="#page-21-14">31]</a> and maximum expected linear potential (MELP) <a href="#page-21-15">[36,</a><a href="#page-20-11">3]</a>. However, those results are not relevant for the construction of S-Boxes, because they only consider the average value over all the keys, while an S-Box is unkeyed. Therefore, the differential and linear properties of the Feistel and MISTY constructions need to be analyzed in the unkeyed setting. Such a study has been initiated recently by Li and Wang <a href="#page-21-16">[27]</a> in the case of 3 rounds of a Feistel network. In this work, we expand the results of Li and Wang, by giving some more general theoretical results for unkeyed Feistel and MISTY structures, with a particular focus on the construction of 8-bit permutations.</p>

    <p class="text-gray-300">Our contributions. We first explain why the usual MEDP and MELP notions are meaningless in the unkeyed setting. In particular we exhibit a 3-round MISTY network where there exists a differential with probability higher than the MEDP for any fixed key, but this optimal differential depends on the key. Then, Section <a href="#page-4-0">3</a> gives some lower bounds on the differential uniformity and linearity of any 3-round balanced MISTY structure, which involve the properties of the three inner S-Boxes. Section <a href="#page-9-0">4</a> then focuses on the construction of 8-bit permutations. Similar results on 3-round Feistel networks are detailed in Section <a href="#page-13-0">5,</a> which generalize the previous result from <a href="#page-21-16">[27]</a>. Most notably, we show that 3 rounds of a Feistel network with appropriate inner S-Boxes provide better cryptographic properties than any 3-round MISTY network, explaining some experimental results reported in <a href="#page-21-7">[22]</a>. Section <a href="#page-17-0">6</a> then gives an instantiation of such an 8-bit permutation, which offers a very good trade-off between the cryptographic properties and the implementation cost. It can be implemented efficiently in hardware and for bit-sliced software, and has good properties for side-channel resistant implementations with masking. In particular, this S-Box supersedes the S-Boxes considered in many lightweight ciphers including CRYPTON, Robin and Fantomas.</p>

    </section>

    <section id="sec-2" class="mb-10">
      <h2 class="text-2xl font-bold">2 From keyed constructions to unkeyed S-Boxes</h2>

      <h3 id="sec-2.1" class="text-xl font-semibold mt-8">2.1 Main cryptographic properties for an S-Box</h3>

    <p class="text-gray-300">In this paper, we focus on S-Boxes having the same number of input and output bits. The resistance offered by an S-Box against differential <a href="#page-20-12">[10]</a> and linear <a href="#page-21-17">[30]</a> cryptanalysis is quantified by the highest value in its difference table (resp. table of linear biases, aka linear-approximation table). More precisely, these two major security parameters are defined as follows.</p>

    <p class="text-gray-300">Definition 1 (Differential uniformity <a href="#page-21-18">[35]</a>). Let F be a function from F n 2 into F n 2 . For any pair of differences (a, b) in F n 2 , we define the set</p>

    <p class="text-gray-300"><span class="math">$D_F(a \\to b) = \\{ x \\in \\mathbb{F}_2^n \\mid F(x \\oplus a) \\oplus F(x) = b \\} .</span>$</p>

    <p class="text-gray-300">The entry at position (a, b) in the difference table of F then corresponds to the cardinality of D<sup>F</sup> (a &rarr; b) and will be denoted by &delta;<sup>F</sup> (a, b).</p>

    <p class="text-gray-300">Moreover, the differential uniformity of F is</p>

    <p class="text-gray-300"><span class="math">$\\delta(F) = \\max_{a \\neq 0, b} \\delta_F(a, b) .</span>$</p>

    <p class="text-gray-300">Obviously, the differential uniformity of an S-Box is always even, implying that, for any F, &delta;(F) &ge; 2. The functions F for which equality holds are named almost perfect nonlinear (APN) functions.</p>

    <p class="text-gray-300">Similarly, the bias of the best linear approximation of an S-Box is measured by its linearity.</p>

    <p class="text-gray-300"><strong>Definition 2 (Walsh transform of an S-Box).</strong> Let F be a function from  <span class="math">\\mathbb{F}_2^n</span>  into  <span class="math">\\mathbb{F}_2^n</span> . The Walsh transform of F is the function</p>

    <p class="text-gray-300"><span class="math">$\\begin{array}{ccc} \\mathbb{F}_2^n \\times \\mathbb{F}_2^n \\to \\mathbb{Z} \\\\ (a,b) &amp; \\mapsto \\lambda_F(a,b) = \\sum_{x \\in \\mathbb{F}_2^n} (-1)^{b \\cdot F(x) + a \\cdot x} \\ . \\end{array}</span>$</p>

    <p class="text-gray-300">Moreover, the linearity of F is</p>

    <p class="text-gray-300"><span class="math">$\\mathcal{L}(F) = \\max_{a,b \\in \\mathbb{F}_{2}^{n}, b \\neq 0} |\\lambda_{F}(a,b)|.</span>$</p>

    <p class="text-gray-300">Indeed, up to a factor  <span class="math">2^n</span> , the linearity corresponds to the bias of the best linear relation between the input and output of F:</p>

    <p class="text-gray-300"><span class="math">$\\Pr_X[b \\cdot F(X) + a \\cdot X = 1] = \\frac{1}{2^n} \\left( 2^{n-1} - \\frac{1}{2} \\sum_{x \\in \\mathbb{F}_2^n} (-1)^{b \\cdot F(x) + a \\cdot x} \\right) = \\frac{1}{2} \\left( 1 - \\frac{\\lambda_F(a, b)}{2^n} \\right).</span>$</p>

    <p class="text-gray-300">It is worth noticing that, for any fixed output mask  <span class="math">b \\in \\mathbb{F}_2^n</span> , the function  <span class="math">a \\mapsto \\lambda_F(a, b)</span> , corresponds to the Walsh transform of the <em>n</em>-variable Boolean component of  <span class="math">F: x \\mapsto b \\cdot F(x)</span> . In particular, it enjoys all properties of a discrete Fourier transform, for instance the Parseval relation.</p>

      <h3 id="sec-2.2" class="text-xl font-semibold mt-8">2.2 Constructing S-Boxes from smaller ones</h3>

    <p class="text-gray-300">If this paper we focus on the construction of S-Boxes using several smaller S-Boxes. Indeed small S-Boxes are much cheaper to implement that large S-Boxes:</p>

    <ul class="list-disc list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li>for table-based software implementations, the tables are smaller;</li>
      <li>for hardware implementations, the gate count is lower;</li>
      <li>for bit-sliced software implementation, the instructions count is lower;</li>
      <li>for vectorized implementation, small S-Boxes can use vector permutations.</li>
    </ul>

    <p class="text-gray-300">In many cases, implementing several small S-Boxes requires less resources than implementing a large one. Therefore, constructing S-Boxes from smaller ones can reduce the implementation cost.</p>

    <p class="text-gray-300">The Feistel construction is a well-known construction to build a 2n-bit permutation from smaller n-bit functions, introduced in 1971 for the design of Lucifer (which later became DES [33]). It is a good candidate for constructing large S-Boxes from smaller ones at a reasonable implementation cost. In particular, this construction has been used for the S-Boxes of Crypton v0.5 [28], ZUC [19] (for  <span class="math">S_0</span> ), Robin [22] and iSCREAM [21]. The MISTY construction introduced by Matsui [31] uses a different structure, but offers a similar level of security. The main advantage of the MISTY network is that it can offer a reduced latency because the first two S-Boxes can be evaluated in parallel. Therefore it is a natural alternative to Feistel networks for the construction of lightweight S-Boxes, and it has been used in the design of Fantomas [22] and SCREAM [21]. In order to reduce the number of gates used for implementing the construction, we focus on balanced MISTY networks, while the MISTY block cipher proposed in [32] is unbalanced and combines an (n-1)-bit S-Box and an (n+1)-bit S-Box.</p>

    <p class="text-gray-300">The two structures we study are depicted in Figures 1 and 2. It is worth noticing a major difference between the two: the function resulting from the Feistel construction is always invertible (since one round is an involution, up to a permutation of the outputs), while the function resulting from the MISTY construction is invertible if and only if all the inner S-Boxes are invertible.</p>

    <p class="text-gray-300">Analysis of Feistel and MISTY structures. Since these two constructions have been used for the design of many block ciphers (in particular the DES [33] and MISTY [32], respectively), their security properties have been intensively studied. A natural way to measure the resistance of the resulting block cipher against differential and linear cryptanalysis is to study the probabilities of the differentials (respectively the potentials of the linear approximations) averaged over all keys.</p>

    <p class="text-gray-300">    <img src="_page_3_Figure_0.jpeg" alt="" class="my-4 max-w-full" />
</p>

    <p class="text-gray-300">    <img src="_page_3_Picture_1.jpeg" alt="" class="my-4 max-w-full" />
</p>

    <p class="text-gray-300">Fig. 1. 3-round MISTY network</p>

    <p class="text-gray-300">Fig. 2. 3-round Feistel network</p>

    <p class="text-gray-300">Definition 3 (MEDP and MELP). Let F<sup>K</sup> be a family of function from F n 2 into F n 2 . The MEDP is the maximum probability of a differential, averaged over all keys:</p>

    <p class="text-gray-300"><span class="math">$\\mathsf{MEDP}(F_K) = \\max_{a \\neq 0, b} \\frac{1}{2^k} \\sum_{K \\in \\mathbb{F}_2^k} \\frac{\\delta_{F_K}(a, b)}{2^n} \\;.</span>$</p>

    <p class="text-gray-300">The MELP is the maximum potential of a linear approximation, averaged over all keys:</p>

    <p class="text-gray-300"><span class="math">$\\mathsf{MELP}(F_K) = \\max_{a,b \\neq 0} \\frac{1}{2^k} \\sum_{K \\in \\mathbb{F}_2^k} \\left( \\frac{\\lambda_{F_K}(a,b)}{2^n} \\right)^2 \\ .</span>$</p>

    <p class="text-gray-300">The following theorem shows that the MEDP and MELP of a Feistel or MISTY network can be bounded.</p>

    <h4 id="sec-misc-1" class="text-lg font-semibold mt-6">Theorem 1 (Feistel or MISTY, averaged over all keys, <a href="#page-21-12">[37,</a><a href="#page-21-13">38,</a><a href="#page-20-11">3,</a><a href="#page-21-14">31]</a>).</h4>

    <p class="text-gray-300">Given S1, S<sup>2</sup> and S<sup>3</sup> three n-bit permutations, let p = max<sup>i</sup> &delta;(Si)/2 <sup>n</sup> and q = maxi(L(Si)/2 n) 2 . Then the family of functions (FK)K=(K1,K2,K3)&isin;<sup>F</sup> 3k 2 defined by 3 rounds of a Feistel or of a MISTY network with S<sup>i</sup> as inner functions verifies</p>

    <p class="text-gray-300"><span class="math">$\\mathsf{MEDP}(F_K) \\leq p^2 \\ and \\ \\mathsf{MELP}(F_K) \\leq q^2 \\ .</span>$</p>

    <p class="text-gray-300">This theorem is very powerful for the construction of iterated block ciphers: it shows that a big function with strong cryptographic properties can be built from small functions with strong cryptographic properties. However, for the design of an S-Box from smaller S-Boxes, it is of little use. Indeed, we are interested in the properties of a single fixed S-Box, rather than the average properties of a family of S-Boxes. For a fixed (a, b) the theorem proves that the average values of &delta;<sup>F</sup><sup>K</sup> (a, b) and &lambda;<sup>F</sup><sup>K</sup> (a, b) are bounded, therefore there exist at least one key for which the value is smaller than or equal to the average. However, it might be that the values a, b where the maximum is reached are not the same for every key. Therefore if we select a key so that &delta;<sup>F</sup><sup>K</sup> (a, b) is small for an a, b maximizing the average probability, the maximum can be reached for another entry of the differential table.</p>

    <p class="text-gray-300">More strikingly, we discovered some choices of S1, S2, S<sup>3</sup> such that the maximum differential probability of the functions in the corresponding family is always higher than the MEDP.</p>

    <p class="text-gray-300">Example 1. We consider a MISTY structure with three identical S-Boxes:</p>

    <p class="text-gray-300"><span class="math">$S_i = [A, 7, 9, 6, 0, 1, 5, B, 3, E, 8, 2, C, D, 4, F].</span>$</p>

    <p class="text-gray-300">We have MEDP(FK) &le; 16/256 according to Th. <a href="#page-3-2">1,</a> because &delta;(Si) = 4. However, for any function in this family, there exists a differential with probability 32/256. This is not a contradiction, because the differential reaching the maximum depends on the key.</p>

    <p class="text-gray-300">The relevant property for the construction of an S-Box is the maximum differential probability (respectively maximum linear potential). Therefore, we could derive some information on this quantity for  <span class="math">F_K</span>  for some fixed keys from the knowledge of the average value of the maximal differential probability, i.e., the EMDP (resp. EMLP), which may significantly differ from the MEDP (resp. MELP). We would like to point out that there is a confusion between the two notions in [32]: the definition corresponds to the expected maximum differential probability (respectively expected maximum linear potential), while the theorems apply to the MEDP and MELP.</p>

    <p class="text-gray-300">Analysis of Feistel and MISTY structures with fixed key. In order to study the properties of Feistel and MISTY structures for the construction of lightweight S-Boxes, we must study these structures with a fixed key. Equivalently, we can consider the structures without any key, because a structure with a fixed key is equivalent to an unkeyed one with different S-Boxes. Indeed, using an S-Box  <span class="math">S_i</span>  with round key  <span class="math">k_i</span>  is equivalent to using  <span class="math">S_i&#x27;: x \\mapsto S_i(x + k_i)</span>  as an S-Box without any key. In the following, we always consider a key-less variant.</p>

    <p class="text-gray-300">In a recent analysis of the fixed-key Feistel structure [27], Li and Wang derive the best differential uniformity and linearity which can be achieved by a 3-round Feistel cipher with a fixed key, and give examples reaching this bound. Their main results are as follows:</p>

    <p class="text-gray-300"><strong>Theorem 2 (Feistel unkeyed, [27]).</strong> Let  <span class="math">S_1</span> ,  <span class="math">S_2</span>  and  <span class="math">S_3</span>  be three n-bit S-Boxes and F be the 2n-bit function defined by the corresponding 3-round Feistel network. Then,  <span class="math">\\delta(F) \\geq 2\\delta(S_2)</span> . Moreover, if  <span class="math">S_2</span>  is not a permutation,  <span class="math">\\delta(F) \\geq 2^{n+1}</span> .</p>

    <p class="text-gray-300">If n = 4, F satisfies  <span class="math">\\delta(F) \\geq 8</span> . If equality holds, then  <span class="math">\\mathcal{L}(F) \\geq 64</span> .</p>

    </section>

    <section id="sec-3" class="mb-10">
      <h2 class="text-2xl font-bold">3 S-Boxes obtained from 3 rounds of MISTY</h2>

      <h3 id="sec-3.1" class="text-xl font-semibold mt-8">3.1 Our results</h3>

    <p class="text-gray-300">In this paper, we generalize the bounds of Li and Wang [27] on Feistel structures, and derive bounds for MISTY structures. The results are very similar for the two structures, but for a MISTY structure, optimal results are only achieved with non-invertible inner functions. Therefore, our work shows that Feistel structures allow better results than MISTY structures for the design of invertible 8-bit S-Boxes.</p>

    <p class="text-gray-300">More precisely, we introduce two new S-Box properties  <span class="math">\\delta_{\\min}</span>  and  <span class="math">\\mathcal{L}_{\\min}</span>  in order to derive our bounds:  <span class="math">\\mathcal{L}_{\\min}</span>  is the smallest linearity we can have for a non-trivial component of the S-Box. Similarly,  <span class="math">\\delta_{\\min}</span>  is the smallest value we can have for the maximum  <span class="math">\\max_b \\delta(a,b)</span>  within a row in the difference table. In particular, for any 4-bit function S,  <span class="math">\\delta_{\\min}(S) \\geq 2</span>  and  <span class="math">\\mathcal{L}_{\\min}(S) \\geq 4</span> . Moreover, if S is a 4-bit permutation, then  <span class="math">\\delta_{\\min}(S) \\geq 4</span>  and  <span class="math">\\mathcal{L}_{\\min}(S) \\geq 8</span> .</p>

    <p class="text-gray-300">We first present the general lower bounds we obtain on the differential uniformity and linearity of 3 rounds of a Feistel and of a MISTY construction.</p>

    <pre><code class="language-text">1. For a Feistel network with inner S-Boxes S_1, S_2 and S_3:

 - \\delta(F) \\geq \\delta(S_2) \\max{(\\delta_{\\min}(S_1), \\delta_{\\min}(S_3))}
 - \\text{if } S_2 \\text{ is not a permutation, } \\delta(F) \\geq 2^{n+1}.
 - \\text{if } S_2 \\text{ is a permutation, } \\delta(F) \\geq \\max_{i \\neq 2, j \\neq i, 2} \\left(\\delta(S_i)\\delta_{\\min}(S_j), \\ \\delta(S_i)\\delta_{\\min}(S_2^{-1})\\right).
 - \\mathcal{L}(F) \\geq \\mathcal{L}(S_2) \\max{(\\mathcal{L}_{\\min}(S_1), \\mathcal{L}_{\\min}(S_3))}
 - \\text{if } S_2 \\text{ is a permutation, } \\mathcal{L}(F) \\geq \\max_{i \\neq 2, j \\neq i, 2} \\left(\\mathcal{L}(S_i)\\mathcal{L}_{\\min}(S_j), \\ \\mathcal{L}(S_i)\\mathcal{L}_{\\min}(S_2^{-1})\\right).
2. For a MISTY network with inner S-Boxes S_1, S_2 and S_3:
 - \\delta(F) \\geq \\delta(S_1) \\max{(\\delta_{\\min}(S_2), \\delta_{\\min}(S_3))}
 - \\text{if } S_1 \\text{ is not a permutation, } \\delta(F) \\geq 2^{n+1}.
 - \\text{if } S_1 \\text{ is a permutation, } \\delta(F) \\geq \\max_{i \\neq 1, j \\neq 1, i} \\left(\\delta(S_i)\\delta_{\\min}(S_j), \\ \\delta(S_i)\\delta_{\\min}(S_1^{-1})\\right);
 - \\mathcal{L}(F) \\geq \\max{(\\mathcal{L}(S_1)\\mathcal{L}_{\\min}(S_2), \\mathcal{L}(S_2)\\mathcal{L}_{\\min}(S_1), \\ \\mathcal{L}(S_3)\\mathcal{L}_{\\min}(S_1)); }
 - \\text{if } S_3 \\text{ is a permutation, } \\mathcal{L}(F) \\geq \\mathcal{L}(S_1)\\mathcal{L}_{\\min}(S_2).
 - \\text{if } S_1 \\text{ is a permutation, } \\mathcal{L}(F) \\geq \\mathcal{L}(S_3)\\mathcal{L}_{\\min}(S_2).
 - \\text{if } S_1 \\text{ and } S_3 \\text{ are permutations, } \\mathcal{L}(F) \\geq \\mathcal{L}(S_2)\\mathcal{L}_{\\min}(S_3^{-1}).
</code></pre>

    <p class="text-gray-300">If n = 4 this yields for both constructions:</p>

    <p class="text-gray-300"><span class="math">$\\delta(F) \\geq 8</span>$
and  <span class="math">\\mathcal{L}(F) \\geq 48</span> .</p>

    <p class="text-gray-300">Moreover,  <span class="math">\\mathcal{L}(F) \\geq 64</span>  unless  <span class="math">\\delta(F) \\geq 32</span> .</p>

    <p class="text-gray-300">For the MISTY construction with n=4, if F is a permutation, we obtain tighter bounds:  <span class="math">\\delta(F) \\geq 16</span>  and  <span class="math">\\mathcal{L}(F) \\geq 64</span> . This implies that the Feistel construction is more appropriate for constructing 8-bit permutations. We will also show that all these bounds for n=4 are tight. We now detail the results first in the case of the MISTY construction, and then for the Feistel construction.</p>

      <h3 id="sec-3.2" class="text-xl font-semibold mt-8">3.2 Differential uniformity of 3 rounds of MISTY</h3>

    <p class="text-gray-300">Our lower bound on the differential uniformity of the 3-round MISTY relies on the evaluation of the number of solutions of some differentials for which the input difference of one of the 3 S-Boxes is canceled (see Figure 3).</p>

    <p class="text-gray-300"><strong>Proposition 1.</strong> Let  <span class="math">S_1</span> ,  <span class="math">S_2</span>  and  <span class="math">S_3</span>  be three n-bit S-Boxes and F be the 2n-bit function defined by the corresponding 3-round MISTY network. Then, for all a, b and c in  <span class="math">\\mathbb{F}_2^n</span> , we have:</p>

    <p class="text-gray-300">(i)
<span class="math">$\\delta_F(0||a,b||c) = \\delta_{S_1}(a,c) \\times \\delta_{S_3}(c,b \\oplus c);</span>$</p>

    <p class="text-gray-300">(ii) If  <span class="math">S_1</span>  is bijective.</p>

    <p class="text-gray-300">
<span class="math">$\\delta_F(a||0,b||c) = \\delta_{S_2}(a, a \\oplus c) \\times \\delta_{S_3}(a, b \\oplus c) ;</span>$</p>

    <p class="text-gray-300">(iii)
<span class="math">$\\delta_{S_1}(a,b) \\times \\delta_{S_2}(b,c) \\leq \\delta_F(b||a,c||c) \\leq \\sum_{d \\in \\mathbb{F}_2^n} \\delta_{S_1}(a,b \\oplus d) \\times \\delta_{S_2}(b,c \\oplus d) \\times \\gamma_{S_3}(d)</span>$</p>

    <p class="text-gray-300">where  <span class="math">\\gamma_{S_3}(d)</span>  is 0 if  <span class="math">\\delta_{S_3}(d,0) = 0</span>  and 1 otherwise. Most notably, if  <span class="math">S_3</span>  is bijective,</p>

    <p class="text-gray-300"><span class="math">$\\delta_F(b||a,c||c) = \\delta_{S_1}(a,b) \\times \\delta_{S_2}(b,c) .</span>$</p>

    <p class="text-gray-300"><em>Proof.</em> Let x be the input of the MISTY network, and let  <span class="math">x_L</span>  and  <span class="math">x_R</span>  be its left and right parts respectively. The three results that we prove correspond to the configurations depicted on Figure 3.</p>

    <p class="text-gray-300">(i)
<span class="math">$x = (x_L, x_R)</span>$
satisfies  <span class="math">F(x_L || x_R) \\oplus F(x_L || (x_R \\oplus a)) = b || c</span>  if and only if</p>

    <p class="text-gray-300"><span class="math">$\\begin{cases} S_3(S_1(x_R) \\oplus x_L) \\oplus S_3(S_1(x_R \\oplus a) \\oplus x_L) = b \\oplus c, \\\\ S_2(x_L) \\oplus S_1(x_R) \\oplus x_L \\oplus S_2(x_L) \\oplus S_1(x_R \\oplus a) \\oplus x_L = c \\end{cases}</span>$</p>

    <p class="text-gray-300"><span class="math">$\\Leftrightarrow \\begin{cases} S_3(S_1(x_R) \\oplus x_L) \\oplus S_3(S_1(x_R \\oplus a) \\oplus x_L) = b \\oplus c, \\\\ S_1(x_R) \\oplus S_1(x_R \\oplus a) = c \\end{cases}</span>$</p>

    <p class="text-gray-300">or equivalently</p>

    <p class="text-gray-300"><span class="math">$x_R \\in D_{S_1}(a \\to c)</span>$
and  <span class="math">x_L \\in S_1(x_R) \\oplus D_{S_2}(c \\to b \\oplus c)</span> .</p>

    <p class="text-gray-300">Hence, we deduce that there are exactly  <span class="math">\\delta_{S_1}(a,c)</span>  values of  <span class="math">x_R</span> , and for each of those,  <span class="math">\\delta_{S_3}(c,b\\oplus c)</span>  values of  <span class="math">x_L</span> , such that x verifies the differential.</p>

    <p class="text-gray-300">(ii)  <span class="math">x = (x_L, x_R)</span>  satisfies  <span class="math">F(x_L || x_R) \\oplus F((x_L \\oplus a) || x_R) = b || c</span>  if and only if</p>

    <p class="text-gray-300"><span class="math">$\\begin{cases} S_3(S_1(x_R) \\oplus x_L) \\oplus S_3(S_1(x_R) \\oplus x_L \\oplus a) = b \\oplus c, \\\\ S_2(x_L) \\oplus S_1(x_R) \\oplus x_L \\oplus S_2(x_L \\oplus a) \\oplus S_1(x_R) \\oplus x_L \\oplus a = c \\end{cases}</span>$</p>

    <p class="text-gray-300"><span class="math">$\\Leftrightarrow \\begin{cases} S_1(x_R) \\oplus x_L \\in D_{S_3}(a \\to b \\oplus c), \\\\ S_2(x_L) \\oplus S_2(x_L \\oplus a) = a \\oplus c \\end{cases}</span>$</p>

    <p class="text-gray-300">or equivalently,</p>

    <p class="text-gray-300"><span class="math">$x_L \\in D_{S_2}(a \\to a \\oplus c)</span>$
and  <span class="math">S_1(x_R) \\in x_L \\oplus D_{S_3}(a \\to b \\oplus c)</span> .</p>

    <p class="text-gray-300">If  <span class="math">S_1</span>  is invertible, for any fixed  <span class="math">x_L</span> , each one of the  <span class="math">\\delta_{S_3}(a, b \\oplus c)</span>  values defined by the second condition determines a unique value of  <span class="math">x_R</span> . Therefore, the number of  <span class="math">(x_L, x_R)</span>  satisfying the differential is exactly  <span class="math">\\delta_{S_2}(a, a \\oplus c) \\times \\delta_{S_3}(a, b \\oplus c)</span> .</p>

    <p class="text-gray-300">    <img src="_page_6_Figure_0.jpeg" alt="" class="my-4 max-w-full" />
</p>

    <p class="text-gray-300">Fig. 3. Red values indicate differences. The interest of these differentials is that for each of them, only 2 S-Boxes influence the 3-round differential (under the condition that  <span class="math">S_1</span>  is invertible for 3.2 and that  <span class="math">S_3</span>  is invertible for 3.3).</p>

    <p class="text-gray-300">(iii)
<span class="math">$(x_L, x_R)</span>$
satisfies  <span class="math">F(x_L || x_R) \\oplus F((x_L \\oplus b) || (x_R \\oplus a)) = c || c</span>  if and only if</p>

    <p class="text-gray-300"><span class="math">$\\begin{cases} S_3(S_1(x_R) \\oplus x_L) \\oplus S_3(S_1(x_R \\oplus a) \\oplus x_L \\oplus b) = 0, \\\\ S_2(x_L) \\oplus S_1(x_R) \\oplus x_L \\oplus S_2(x_L \\oplus b) \\oplus S_1(x_R \\oplus a) \\oplus x_L \\oplus b = c \\end{cases}</span>$</p>

    <p class="text-gray-300"><span class="math">$\\Leftrightarrow \\begin{cases} S_3(S_1(x_R) \\oplus x_L) \\oplus S_3(S_1(x_R \\oplus a) \\oplus x_L \\oplus b) = 0, \\\\ S_2(x_L) \\oplus S_1(x_R) \\oplus S_2(x_L \\oplus b) \\oplus S_1(x_R \\oplus a) = b \\oplus c \\end{cases}</span>$</p>

    <p class="text-gray-300">This equivalently means that there exists some  <span class="math">d \\in \\mathbb{F}_2^n</span>  such that</p>

    <p class="text-gray-300"><span class="math">$\\begin{cases} x_R \\in D_{S_1}(a \\to b \\oplus d), x_L \\in D_{S_2}(b \\to c \\oplus d), \\\\ S_3(S_1(x_R) \\oplus x_L) \\oplus S_3(S_1(x_R \\oplus a) \\oplus x_L \\oplus b) = 0, \\end{cases}</span>$</p>

    <p class="text-gray-300">i.e.,</p>

    <p class="text-gray-300"><span class="math">$x_R \\in D_{S_1}(a \\to b \\oplus d), \\ x_L \\in D_{S_2}(b \\to c \\oplus d) \\text{ and } S_1(x_R) \\oplus x_L \\in D_{S_3}(d \\to 0).</span>$</p>

    <p class="text-gray-300">Then, for any fixed  <span class="math">d \\in \\mathbb{F}_2^n</span>  such that  <span class="math">\\delta_{S_3}(d,0) = 0</span> , no pair  <span class="math">(x_L, x_R)</span>  satisfies the third condition. If  <span class="math">\\delta_{S_3}(d,0) &gt; 0</span> , then some of the values  <span class="math">(x_L, x_R)</span>  defined by the first two conditions may also satisfy the third one, and if d = 0, the third condition is always satisfied. It then follows that</p>

    <p class="text-gray-300"><span class="math">$\\delta_{S_1}(a,b) \\times \\delta_{S_2}(b,c) \\leq \\delta_F(b||a,c||c) \\leq \\sum_{d \\in \\mathbb{F}_2^n} \\delta_{S_1}(a,b \\oplus d) \\times \\delta_{S_2}(b,c \\oplus d) \\times \\gamma_{S_3}(d)</span>$</p>

    <p class="text-gray-300">where  <span class="math">\\gamma_{S_3}(d)</span>  is 0 if  <span class="math">\\delta_{S_3}(d,0) = 0</span>  and 1 otherwise. Moreover, if  <span class="math">S_3</span>  is bijective,  <span class="math">\\delta_{S_3}(d,0) &gt; 0</span>  if and only if d = 0, implying that the two previous bounds are equal, i.e.,</p>

    <p class="text-gray-300">
<span class="math">$\\delta_F(b||a,c||c) = \\delta_{S_1}(a,b) \\times \\delta_{S_2}(b,c) . \\qquad \\Box</span>$</p>

    <p class="text-gray-300">These three particular types of differentials provide us with the following lower bound on the differential uniformity of any 3-round MISTY network.</p>

    <p class="text-gray-300"><strong>Theorem 3.</strong> Let  <span class="math">S_1</span> ,  <span class="math">S_2</span>  and  <span class="math">S_3</span>  be three n-bit S-Boxes and let F be the 2n-bit function defined by the corresponding 3-round MISTY network. Then,</p>

    <p class="text-gray-300"><span class="math">$\\delta(F) \\ge \\delta(S_1) \\max \\left(\\delta_{\\min}(S_2), \\delta_{\\min}(S_3)\\right) \\text{ where } \\delta_{\\min}(S) = \\min_{a \\ne 0} \\max_b \\delta_S(a, b) \\text{ .}</span>$</p>

    <p class="text-gray-300">Moreover.</p>

    <ul class="list-disc list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li>if  <span class="math">S_1</span>  is a permutation,</li>
    </ul>

    <p class="text-gray-300"><span class="math">$\\delta(F) \\ge \\max_{i \\ne 1, j \\ne 1, i} \\max \\left( \\delta(S_i) \\delta_{\\min}(S_j), \\ \\delta(S_i) \\delta_{\\min}(S_1^{-1}) \\right) ,</span>$</p>

    <ul class="list-disc list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li>if  <span class="math">S_1</span>  is not a permutation,  <span class="math">\\delta(F) \\geq 2^{n+1}</span> .</li>
    </ul>

    <p class="text-gray-300"><em>Proof.</em> The result is a direct consequence of Prop. 1. We here derive the bounds from the first item in Prop. 1; the other cases can be similarly deduced from the two other items. Let us first consider a pair of differences  <span class="math">(\\alpha, \\beta)</span>  which achieves the differential uniformity of  <span class="math">S_1</span> , i.e.,  <span class="math">\\delta(S_1) = \\delta_{S_1}(\\alpha, \\beta)</span> . Then, we choose  <span class="math">a = \\alpha</span>  and  <span class="math">c = \\beta</span> , and get that, for any  <span class="math">b \\in \\mathbb{F}_2^n</span> ,</p>

    <p class="text-gray-300"><span class="math">$\\delta_F(0||\\alpha, b||\\beta) = \\delta(S_1) \\times \\delta_{S_3}(\\beta, \\beta \\oplus b)</span>$
.</p>

    <p class="text-gray-300">Then, we can choose for b the value which maximizes  <span class="math">\\delta_{S_3}(\\beta, \\beta \\oplus b)</span> . This value is always greater than or equal to  <span class="math">\\delta_{\\min}(S_3)</span> . Similarly, we can now consider a pair of differences  <span class="math">(\\alpha, \\beta)</span>  which achieves the differential uniformity of  <span class="math">S_3</span> , i.e.,  <span class="math">\\delta(S_3) = \\delta_{S_3}(\\alpha, \\beta)</span> . In this case, we choose  <span class="math">c = \\alpha</span>  and  <span class="math">b = \\alpha \\oplus \\beta</span> , and get that, for any  <span class="math">a \\in \\mathbb{F}_2^n</span> ,</p>

    <p class="text-gray-300"><span class="math">$\\delta_F(0||a,(\\alpha\\oplus\\beta)||\\alpha) = \\delta_{S_1}(a,\\alpha)\\times\\delta(S_3)</span>$
.</p>

    <p class="text-gray-300">We then choose for a the value which maximizes  <span class="math">\\delta_{S_1}(a,\\alpha)</span>  which is always greater than or equal to  <span class="math">\\delta_{\\min}(S_1^{-1})</span>  when  <span class="math">S_1</span>  is a permutation.</p>

    <p class="text-gray-300">Let us now assume that  <span class="math">S_1</span>  is not bijective. This means that there exists some nonzero  <span class="math">a \\in \\mathbb{F}_2^n</span>  such that  <span class="math">\\delta_{S_1}(a,0) \\geq 2</span> . Then, we deduce from the first item in Prop. 1, with b=c=0, that  <span class="math">F(x_L||x_R) \\oplus F_K(x_L \\oplus a||x_R) = (0,0)</span>  has  <span class="math">\\delta_{S_1}(a,0) \\times \\delta_{S_3}(0,0) \\geq 2 \\times 2^n = 2^{n+1}</span>  solutions in  <span class="math">\\mathbb{F}_2^{2n}</span> .  <span class="math">\\square</span></p>

      <h3 id="sec-3.3" class="text-xl font-semibold mt-8">3.3 Linearity of 3 rounds of MISTY</h3>

    <p class="text-gray-300">The lower bound on the linearity of a three-round MISTY structure can be derived in a similar way.</p>

    <p class="text-gray-300"><strong>Proposition 2.</strong> Let  <span class="math">S_1</span> ,  <span class="math">S_2</span>  and  <span class="math">S_3</span>  be three n-bit S-Boxes and F the 2n-bit function defined by the corresponding 3-round MISTY network. Then, for all a, b and c in  <span class="math">\\mathbb{F}_2^n</span> , we have:</p>

    <ul class="list-disc list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li>(i)  <span class="math">\\lambda_F(a||b,0||c) = \\lambda_{S_1}(b,c)\\lambda_{S_2}(a \\oplus c,c)</span></li>
      <li>(ii)  <span class="math">\\lambda_F(a||b,c||c) = \\lambda_{S_1}(b,a)\\lambda_{S_3}(a,c)</span></li>
      <li>(iii) If  <span class="math">S_1</span>  is bijective,  <span class="math">\\lambda_F(a||0,b||c) = \\lambda_{S_2}(a,b\\oplus c)\\lambda_{S_3}(b\\oplus c,b)</span></li>
    </ul>

    <p class="text-gray-300">Proof. The following three results correspond to the configurations depicted on Figure 4.</p>

    <p class="text-gray-300">(i)
<span class="math">$\\lambda_{F}(a||b,0||c) = \\sum_{(x_{R},x_{L})\\in(\\mathbb{F}_{2}^{n})^{2}} (-1)^{c\\cdot S_{2}(x_{L})\\oplus c\\cdot S_{1}(x_{R})\\oplus c\\cdot x_{L}\\oplus a\\cdot x_{L}\\oplus b\\cdot x_{R}}</span>$</p>

    <p class="text-gray-300"><span class="math">$= \\sum_{x_{R}\\in\\mathbb{F}_{2}^{n}} (-1)^{c\\cdot S_{1}(x_{R})\\oplus b\\cdot x_{R}} \\sum_{x_{L}\\in\\mathbb{F}_{2}^{n}} (-1)^{c\\cdot S_{2}(x_{L})\\oplus (a\\oplus c)\\cdot x_{L}}</span>$</p>

    <p class="text-gray-300"><span class="math">$= \\lambda_{S_{1}}(b,c) \\lambda_{S_{2}}(a\\oplus c,c)</span>$</p>

    <p class="text-gray-300">    <img src="_page_8_Figure_0.jpeg" alt="" class="my-4 max-w-full" />
</p>

    <p class="text-gray-300">Fig. 4. Blue values indicate linear masks.</p>

    <p class="text-gray-300">(ii)
<span class="math">$\\lambda_F(a||b,c||c) = \\sum_{(x_R,x_L) \\in (\\mathbb{F}_2^n)^2} (-1)^{(c,c) \\cdot F_K(x_L||x_R) \\oplus (a,b) \\cdot (x_L,x_R)}</span>$
<span class="math">$= \\sum_{(x_R,x_L) \\in (\\mathbb{F}_2^n)^2} (-1)^{c \\cdot S_3(S_1(x_R) \\oplus x_L) \\oplus a \\cdot x_L \\oplus b \\cdot x_R}</span>$
<span class="math">$(x_R,x_L) \\in (\\mathbb{F}_2^n)^2</span>$</p>

    <p class="text-gray-300">We set  <span class="math">x_L = S_1(x_R) \\oplus z</span>  and observe that, for any fixed  <span class="math">x_R</span> , z takes all possible values in  <span class="math">\\mathbb{F}_2^n</span>  when  <span class="math">x_L</span>  varies, implying that</p>

    <p class="text-gray-300"><span class="math">$\\lambda_F(a\\|b,c\\|c) = \\sum_{x_R \\in \\mathbb{F}_2^n} \\sum_{z \\in \\mathbb{F}_2^n} (-1)^{c \\cdot S_3(z) \\oplus a \\cdot (z \\oplus S_1(x_R)) \\oplus b \\cdot x_R} = \\lambda_{S_1}(b,a) \\lambda_{S_3}(a,c) .</span>$
(iii)
<span class="math">$\\lambda_F(a\\|0,b\\|c) = \\sum_{(x_R,x_L) \\in (\\mathbb{F}_2^n)^2} (-1)^{(b,c) \\cdot F_K(x_L\\|x_R) \\oplus (a,0) \\cdot (x_L,x_R)}</span>$</p>

    <p class="text-gray-300"><span class="math">$= \\sum_{(x_R,x_L) \\in (\\mathbb{F}_2^n)^2} (-1)^{b \\cdot S_3(S_1(x_R) \\oplus x_L) \\oplus [b \\oplus c] \\cdot [S_1(x_R) \\oplus S_2(x_L)] \\oplus [a \\oplus b \\oplus c] \\cdot x_L}</span>$</p>

    <p class="text-gray-300"><span class="math">$(x_R,x_L) \\in (\\mathbb{F}_2^n)^2</span>$</p>

    <p class="text-gray-300">If  <span class="math">S_1</span>  is bijective, we set  <span class="math">x_R = S_1^{-1}(z \\oplus x_L)</span> . Using that, for any fixed  <span class="math">x_L</span> , z takes all possible values in  <span class="math">\\mathbb{F}_2^n</span>  when  <span class="math">x_R</span>  varies, we deduce that</p>

    <p class="text-gray-300"><span class="math">$\\lambda_F(a||0,b||c) = \\sum_{x_L \\in \\mathbb{F}_2^n} (-1)^{(b \\oplus c) \\cdot S_2(x_L) \\oplus a \\cdot x_L} \\sum_{z \\in \\mathbb{F}_2^n} (-1)^{b \\cdot S_3(z) \\oplus (b \\oplus c) \\cdot z}</span>$
<span class="math">$= \\lambda_{S_2}(a,b \\oplus c) \\lambda_{S_3}(b \\oplus c,b) \\quad \\Box</span>$</p>

    <p class="text-gray-300">As in the differential case, the previous three linear approximations provide us with a lower bound on the linearity of any 3-round MISTY network. This bound involves both the linearity of the constituent S-Boxes and another quantity denoted by  <span class="math">\\mathcal{L}_{\\min}</span>  computed from the table of linear biases as follows.</p>

    <p class="text-gray-300"><strong>Definition 4</strong> ( <span class="math">\\mathcal{L}_{\\min}</span> ). Let F be an n-bit S-Box. We define</p>

    <p class="text-gray-300">
<span class="math">$\\mathcal{L}_{\\min}(F) = \\min_{b \\in \\mathbb{F}_2^n, b \\neq 0} \\max_{a \\in \\mathbb{F}_2^n} |\\lambda_F(a, b)|.</span>$</p>

    <p class="text-gray-300">Most notably,  <span class="math">\\mathcal{L}_{\\min}(F) \\geq 2^{\\frac{n}{2}}</span>  and this bound is not tight when F is bijective.</p>

    <p class="text-gray-300"><em>Proof.</em> By definition,  <span class="math">\\mathcal{L}_{\\min}(F)</span>  is the smallest linearity achieved by a component  <span class="math">F_b: x \\mapsto b \\cdot F(x)</span>  of F, when b varies in  <span class="math">\\mathbb{F}_2^n \\setminus \\{0\\}</span> . Since any  <span class="math">F_b</span>  is an n-variable Boolean function, its linearity is at least  <span class="math">2^{\\frac{n}{2}}</span>  with equality if and only if  <span class="math">F_b</span>  is bent [41]. Since bent functions are not balanced, none of the components of a permutation is bent, implying that  <span class="math">\\mathcal{L}_{\\min}(F) &gt; 2^{\\frac{n}{2}}</span>  when F is a permutation.  <span class="math">\\square</span></p>

    <p class="text-gray-300">We then derive the following lower bound on the linearity of any 3-round MISTY network.</p>

    <p class="text-gray-300"><strong>Theorem 4.</strong> Let  <span class="math">S_1</span> ,  <span class="math">S_2</span>  and  <span class="math">S_3</span>  be three n-bit S-Boxes and let F be the 2n-bit function defined by the corresponding 3-round MISTY network. Then,</p>

    <p class="text-gray-300"><span class="math">$\\mathcal{L}(F) \\ge \\max(\\mathcal{L}(S_1)\\mathcal{L}_{\\min}(S_2), \\ \\mathcal{L}(S_2)\\mathcal{L}_{\\min}(S_1), \\ \\mathcal{L}(S_3)\\mathcal{L}_{\\min}(S_1))</span>$
.</p>

    <p class="text-gray-300">Moreover, if  <span class="math">S_1</span>  is a permutation,  <span class="math">\\mathcal{L}(F) \\geq \\mathcal{L}(S_3)\\mathcal{L}_{\\min}(S_2)</span> ; if  <span class="math">S_3</span>  is a permutation,  <span class="math">\\mathcal{L}(F) \\geq \\mathcal{L}(S_1)\\mathcal{L}_{\\min}(S_3^{-1})</span> , and if both  <span class="math">S_1</span>  and  <span class="math">S_3</span>  are permutations, then  <span class="math">\\mathcal{L}(F) \\geq \\mathcal{L}(S_2)\\mathcal{L}_{\\min}(S_3^{-1})</span> .</p>

    <p class="text-gray-300"><em>Proof.</em> Let us first choose a pair of masks  <span class="math">(\\alpha, \\beta)</span>  for some  <span class="math">S_i</span>  which achieves the linearity  <span class="math">\\mathcal{L}(S_i)</span> . For i = 1 or i = 2, we use the first item in Prop. 2 and deduce that, for any  <span class="math">\\gamma</span> ,</p>

    <p class="text-gray-300"><span class="math">$|\\lambda_F(\\gamma || \\alpha, 0 || \\beta)| = \\mathcal{L}(S_1) |\\lambda_{S_2}(\\gamma \\oplus \\beta, \\beta)|</span>$
<span class="math">$|\\lambda_F((\\alpha \\oplus \\beta) || \\gamma, 0 || \\beta)| = \\mathcal{L}(S_2) |\\lambda_{S_1}(\\gamma, \\beta)|.</span>$</p>

    <p class="text-gray-300">For i = 3, we use the second item in Prop. 2 and get</p>

    <p class="text-gray-300"><span class="math">$|\\lambda_F(\\alpha||\\gamma,\\beta||\\beta)| = \\mathcal{L}(S_3)|\\lambda_{S_1}(\\gamma,\\alpha)|.</span>$</p>

    <p class="text-gray-300">Moreover, when  <span class="math">S_1</span>  is a permutation, the third item in Prop. 2 applies, and for  <span class="math">(\\alpha, \\beta)</span>  such that  <span class="math">|\\lambda_{S_3}(\\alpha, \\beta)| = \\mathcal{L}(S_3)</span> , we get</p>

    <p class="text-gray-300"><span class="math">$|\\lambda_F(\\gamma||0,\\beta||(\\alpha\\oplus\\beta))| = \\mathcal{L}(S_3)|\\lambda_{S_2}(\\gamma,\\alpha)|.</span>$</p>

    <p class="text-gray-300">Then, in all these four cases, we choose for  <span class="math">\\gamma</span>  the nonzero value which maximizes the right-hand term in the product, i.e., which maximizes the Walsh transform of the involved component of  <span class="math">S_j</span> . By definition,  <span class="math">\\mathcal{L}_{\\min}(S_j)</span>  is then a lower bound for this right-hand term.</p>

    <p class="text-gray-300">The last statements in the theorem are derived from the second (resp. third) item in Prop. 2, by choosing  <span class="math">(\\alpha, \\beta)</span>  such that  <span class="math">|\\lambda_{S_1}(\\alpha, \\beta)| = \\mathcal{L}(S_1)</span>  (resp.  <span class="math">|\\lambda_{S_2}(\\alpha, \\beta)| = \\mathcal{L}(S_2)</span> ). Then we obtain</p>

    <p class="text-gray-300"><span class="math">$|\\lambda_F(\\beta \\| \\alpha, \\gamma \\| \\gamma)| = \\mathcal{L}(S_1) |\\lambda_{S_3}(\\beta, \\gamma)| |\\lambda_F(\\alpha \\| 0, \\gamma \\| \\beta \\oplus \\gamma)| = \\mathcal{L}(S_2) |\\lambda_{S_3}(\\beta, \\gamma)| ,</span>$</p>

    <p class="text-gray-300">where the second equality holds when  <span class="math">S_1</span>  is a permutation. Then, if  <span class="math">S_3</span>  is a permutation, we use that, for any fixed  <span class="math">\\beta \\neq 0</span> ,</p>

    <p class="text-gray-300"><span class="math">$\\max_{\\gamma \\in \\mathbb{F}_2^n} |\\lambda_{S_3}(\\beta, \\gamma)| \\ge \\mathcal{L}_{\\min}(S_3^{-1}) . \\qquad \\Box</span>$</p>

    <p class="text-gray-300">In this section, we investigate the cryptographic properties of 8-bit S-Boxes corresponding to a 3-round MISTY structure with 4-bit inner S-Boxes, with a particular focus on the case where the three inner S-Boxes are bijective, since it corresponds to the case where the resulting function is a permutation.</p>

      <h3 id="sec-4.1" class="text-xl font-semibold mt-8">4.1 Differential uniformity</h3>

    <p class="text-gray-300">The following bound on the differential uniformity of any 3-round MISTY network over  <span class="math">\\mathbb{F}_2^8</span>  is a direct consequence of Theorem 3.</p>

    <p class="text-gray-300">Corollary 1. Any 8-bit function F corresponding to a 3-round MISTY network satisfies  <span class="math">\\delta(F) \\geq 8</span> .</p>

    <p class="text-gray-300"><em>Proof.</em> The bound clearly holds when  <span class="math">S_1</span>  is not bijective, since we known from Theorem 3 that  <span class="math">\\delta(F) \\geq 32</span>  in this case. If  <span class="math">S_1</span>  is bijective, then  <span class="math">\\delta(S_1) \\geq 4</span>  since APN permutations over  <span class="math">\\mathbb{F}_2^4</span>  do not exist, as proved in [23, Th. 2.3]. Obviously, any 4-bit S-Box S satisfies  <span class="math">\\delta_{\\min}(S) \\geq 2</span> , implying that</p>

    <p class="text-gray-300">
<span class="math">$\\delta(F) \\ge \\delta(S_1)\\delta_{\\min}(S_2) \\ge 8</span>$
.</p>

    <p class="text-gray-300">Besides this general result, we can provide some necessary conditions on the constituent S-Boxes to achieve the previous lower bound. This result relies on the following lemma.</p>

    <p class="text-gray-300"><strong>Lemma 1.</strong> Let  <span class="math">S_1</span>  be a 4-bit permutation with  <span class="math">\\delta(S_1) = 4</span>  and  <span class="math">S_2</span>  and  <span class="math">S_3</span>  be two 4-bit functions. Let F be the 8-bit function defined by the corresponding 3-round MISTY network. If  <span class="math">\\delta(S_2) \\geq 4</span>  or if  <span class="math">\\delta(S_3) \\geq 4</span> , then  <span class="math">\\delta(F) \\geq 16</span> .</p>

    <p class="text-gray-300"><em>Proof.</em> Here,  <span class="math">S_2</span>  and  <span class="math">S_3</span>  play a symmetrical role. Then, we assume Wlog that  <span class="math">\\delta(S_3) \\geq 4</span> . Let us consider nonzero differences a and b such that  <span class="math">\\delta_{S_3}(a,b) \\geq 4</span> . Then  <span class="math">D_{S_3}(a \\to b)</span>  contains an affine subspace of dimension 2 of  <span class="math">\\mathbb{F}_2^4</span> . Indeed, if we choose  <span class="math">x \\in D_{S_3}(a \\to b)</span> , there exists  <span class="math">c \\in \\mathbb{F}_2^4 \\setminus \\{0\\}</span> ,  <span class="math">c \\neq a</span> , such that  <span class="math">D_{S_3}(a \\to b) \\supseteq \\{x, x \\oplus a, x \\oplus c, x \\oplus c \\oplus a\\}</span> . Hence, we get that</p>

    <p class="text-gray-300"><span class="math">$S_3(x) \\oplus S_3(x \\oplus c) = S_3(x \\oplus a) \\oplus S_3((x \\oplus a) \\oplus c)</span>$</p>

    <p class="text-gray-300">and</p>

    <p class="text-gray-300"><span class="math">$S_3(x) \\oplus S_3(x \\oplus (c \\oplus a)) = S_3(x \\oplus a) \\oplus S_3((x \\oplus a) \\oplus (c \\oplus a))</span>$</p>

    <p class="text-gray-300">Thus the three rows defined by a, c and  <span class="math">(a \\oplus c)</span>  in the differential table of  <span class="math">S_3</span>  contain a value greater than or equal to 4.</p>

    <p class="text-gray-300">From the first item in Prop. 1, we deduce that, for any  <span class="math">\\alpha \\in \\{a, c, a \\oplus c\\}</span> , we can choose some b such that, for any  <span class="math">\\gamma</span> ,</p>

    <p class="text-gray-300"><span class="math">$\\delta_F(0||\\gamma, b||\\alpha) = \\delta_{S_1}(\\gamma, \\alpha) \\times \\delta_{S_2}(\\alpha, b \\oplus \\alpha) &gt; 4\\delta_{S_1}(\\gamma, \\alpha)</span>$
.</p>

    <p class="text-gray-300">Therefore,  <span class="math">\\delta(F) \\geq 16</span>  unless the three columns in the difference table of  <span class="math">S_1</span>  defined by a difference in  <span class="math">\\{a, c, a \\oplus c\\}</span>  do not contain any 4. Let  <span class="math">\\mathcal{C}(S_1)</span>  denote the set of columns in the difference table of an S-Box which consist of 0s and 2s only:</p>

    <p class="text-gray-300"><span class="math">$C(S_1) = \\{b \\in \\mathbb{F}_2^4 \\setminus \\{0\\} : \\delta_{S_1}(a,b) \\le 2, \\forall a \\ne 0\\}.</span>$</p>

    <p class="text-gray-300">Amongst all equivalence classes of 4-bit permutations  <span class="math">S_1</span>  with  <span class="math">\\delta(S_1) = 4</span> , only 12 satisfy  <span class="math">\\#\\mathcal{C}(S_1) \\geq 3</span> . Moreover, 3 of them have their set  <span class="math">\\mathcal{C}(S_1)</span>  included in the set  <span class="math">\\mathcal{C}(S_1&#x27;)</span>  of a function in another class, hence we ignore them.</p>

    <p class="text-gray-300">The values of C for the 9 remaining classes are listed below.</p>

    <div class="overflow-x-auto my-4">
      <table class="min-w-full text-sm text-gray-300">
        <thead>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">Representatives of the class</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"><span class="math">\\mathcal C</span></th>
        </thead>
        <tbody>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">[0, 1, 2, 3, 4, 6, 9, A, 8, C, 5, D, B, E, F, 7]</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">\\{4, 5, 7, 9, 15\\}</span></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">[0, 1, 2, 3, 4, 6, 9, C, 8, 5, B, F, E, D, 7, A]</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">\\{4, 6, 7, 11, 14\\}</span></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">[0, 1, 2, 3, 4, 6, 9, C, 8, 5, F, D, B, 7, A, E]</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">\\{4, 10, 12, 13, 15\\}</span></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">[0, 1, 2, 3, 4, 6, 9, A, 8, B, C, E, F, 7, 5, D]</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">\\{4, 5, 11, 12, 13\\}</span></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">[0, 1, 2, 3, 4, 6, 9, A, 8, 5, C, F, D, B, E, 7]</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">\\{4, 9, 11, 14\\}</span></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">[0, 1, 2, 3, 4, 6, 9, A, 8, C, 5, D, 7, E, F, B]</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">\\{5, 9, 11, 15\\}</span></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">[0, 1, 2, 3, 4, 6, 9, A, 8, C, B, D, 5, F, E, 7]</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">\\{5, 7, 14, 15\\}</span></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">[0, 1, 2, 3, 4, 6, 9, C, 8, 5, D, A, E, 7, B, F]</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">\\{10, 14, 15\\}</span></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">[{\\tt 0,1,2,3,4,6,9,A,8,B,C,E,5,D,F,7}]</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">\\{6,7,11,14,15\\}</span></td>
          </tr>
        </tbody>
      </table>
    </div>

    <p class="text-gray-300">We can check that none of these sets C(S) contains a subset with 3 elements stable by addition. Furthermore, this property is invariant under affine transformation. Indeed, for  <span class="math">S&#x27; = A_2 \\circ S \\circ A_1</span> , we have</p>

    <p class="text-gray-300"><span class="math">$\\delta_{S&#x27;}(a,b) = \\delta_S(L_1(a), L_2^{-1}(b))</span>$</p>

    <p class="text-gray-300">where  <span class="math">L_1</span>  and  <span class="math">L_2</span>  are the linear parts of  <span class="math">A_1</span>  and  <span class="math">A_2</span> . It follows that  <span class="math">\\mathcal{C}(S&#x27;) = L_2(\\mathcal{C}(S))</span> . Therefore, the configuration needed for having  <span class="math">\\delta(F) &lt; 16</span>  never appears.</p>

    <p class="text-gray-300">We can now deduce some necessary conditions to achieve  <span class="math">\\delta(F) = 8</span> .</p>

    <p class="text-gray-300"><strong>Theorem 5.</strong> Let  <span class="math">S_1</span> ,  <span class="math">S_2</span>  and  <span class="math">S_3</span>  be three 4-bit S-Boxes and let F be the 8-bit function defined by the corresponding 3-round MISTY network. Then,  <span class="math">\\delta(F) = 8</span>  implies that  <span class="math">S_1</span>  is a permutation with  <span class="math">\\delta(S_1) = 4</span>  and  <span class="math">S_2</span>  and  <span class="math">S_3</span>  are two APN functions. Otherwise,  <span class="math">\\delta(F) \\geq 12</span> .</p>

    <p class="text-gray-300">Proof. Since  <span class="math">\\delta(F) \\geq 32</span>  when  <span class="math">S_1</span>  is not bijective, we only need to focus on the case where  <span class="math">S_1</span>  is a permutation. If any of the constituent S-Boxes  <span class="math">S_i</span>  has differential uniformity strictly greater than 4, i.e.,  <span class="math">\\delta(S_i) \\geq 6</span> , we deduce from Theorem 3 that  <span class="math">\\delta(F) \\geq \\delta(S_i)\\delta_{\\min}(S_j) \\geq 12</span> . Therefore,  <span class="math">\\delta(F) = 8</span>  can be achieved only if  <span class="math">\\delta(S_1) = 4</span> ,  <span class="math">\\delta(S_2) \\leq 4</span> , and  <span class="math">\\delta(S_3) \\leq 4</span> . The fact that  <span class="math">\\delta(F) \\geq 16</span>  when at least one of the S-Boxes  <span class="math">S_2</span>  or  <span class="math">S_3</span>  has differential uniformity 4 is proved in Lemma 1.</p>

    <p class="text-gray-300">We can then prove that the lower bound in Corollary 1 is tight by exhibiting three 4-bit S-Boxes satisfying the previous conditions which lead to a 3-round MISTY network with differential uniformity 8.</p>

    <p class="text-gray-300"> <span class="math">Example\\ 2</span> . The following 4-bit S-Boxes yield an 8-bit S-Box with differential uniformity 8 and linearity 64 when used in a MISTY structure:</p>

    <p class="text-gray-300"><span class="math">$\\begin{split} S_1 &amp;= [\\texttt{4}, \\texttt{0}, \\texttt{1}, \\texttt{f}, \\texttt{2}, \\texttt{b}, \\texttt{6}, \\texttt{7}, \\texttt{3}, \\texttt{9}, \\texttt{a}, \\texttt{5}, \\texttt{c}, \\texttt{d}, \\texttt{e}, \\texttt{8}] \\\\ S_2 &amp;= [\\texttt{0}, \\texttt{0}, \\texttt{0}, \\texttt{1}, \\texttt{0}, \\texttt{a}, \\texttt{8}, \\texttt{3}, \\texttt{0}, \\texttt{8}, \\texttt{2}, \\texttt{b}, \\texttt{4}, \\texttt{6}, \\texttt{e}, \\texttt{d}] \\\\ S_3 &amp;= [\\texttt{0}, \\texttt{7}, \\texttt{b}, \\texttt{d}, \\texttt{4}, \\texttt{1}, \\texttt{b}, \\texttt{f}, \\texttt{1}, \\texttt{2}, \\texttt{c}, \\texttt{e}, \\texttt{d}, \\texttt{c}, \\texttt{5}, \\texttt{5}] \\end{split}</span>$</p>

    <p class="text-gray-300">With bijective inner S-Boxes. We now focus on the case where the three inner S-Boxes are permutations since this guarantees that the resulting MISTY network is a permutation. We have proved that, in this case, the lowest possible differential uniformity we can obtain is 12. Here, we refine this result and show that the differential uniformity cannot be lower than 16. This improved bound exploits the following lemma on the difference tables of 4-bit permutations.</p>

    <p class="text-gray-300"><strong>Lemma 2.</strong> Let  <span class="math">S_1</span> ,  <span class="math">S_2</span>  and  <span class="math">S_3</span>  be 4-bit permutations. Then, there exists a nonzero difference  <span class="math">\\gamma \\in \\mathbb{F}_2^4 \\setminus \\{0\\}</span>  such that at least one of the following statements holds:</p>

    <ul class="list-disc list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li>The difference table of  <span class="math">S_1</span>  has at least one value greater than or equal to 4 in Column  <span class="math">\\gamma</span>  and the difference table of  <span class="math">S_2</span>  has at least one value greater than or equal to 4 in Row  <span class="math">\\gamma</span> ;</li>
      <li>The difference table of  <span class="math">S_1</span>  has at least one value greater than or equal to 4 in Column  <span class="math">\\gamma</span>  and the difference table of  <span class="math">S_3</span>  has at least one value greater than or equal to 4 in Row  <span class="math">\\gamma</span> ,</li>
      <li>The difference table of  <span class="math">S_2</span>  has at least one value greater than or equal to 4 in Row  <span class="math">\\gamma</span>  and the difference table of  <span class="math">S_3</span>  has at least one value greater than or equal to 4 in Row  <span class="math">\\gamma</span> .</li>
    </ul>

    <p class="text-gray-300"><em>Proof.</em> This result relies on an exhaustive search over the equivalence classes defined by composition on the left and on the right by an affine transformation, exactly as in the classification of optimal 4-bit S-Boxes in [17,26]. There are 302 equivalence classes for 4-bit permutations. From each of the classes we picked a representative, and checked that its difference table has at least six rows defined by some nonzero input difference a which contain a value greater than or equal to 4. Let  <span class="math">\\mathcal{R}(S)</span>  denote the corresponding set (of size at least six):</p>

    <p class="text-gray-300"><span class="math">$\\mathcal{R}(S) = \\left\\{ a \\in \\mathbb{F}_2^4 \\setminus \\{0\\} : \\exists b \\in \\mathbb{F}_2^4 \\setminus \\{0\\}, \\delta_S(a, b) \\ge 4 \\right\\}.</span>$</p>

    <p class="text-gray-300">Therefore, if there exists no difference  <span class="math">\\gamma \\in \\mathbb{F}_2^4 \\setminus \\{0\\}</span>  satisfying one of the three statements in the lemma, then this would mean that the three sets  <span class="math">\\mathcal{R}(S_2)</span> ,  <span class="math">\\mathcal{R}(S_3)</span>  and  <span class="math">\\mathcal{R}(S_1^{-1})</span>  are disjoint. In other words, we could find 18 distinct values amongst the 15 nonzero elements in  <span class="math">\\mathbb{F}_2^4</span> , which is impossible.</p>

    <p class="text-gray-300">We then deduce the following refined lower bound on the differential uniformity of a 3-round MISTY network over  <span class="math">\\mathbb{F}_2^8</span>  with inner permutations.</p>

    <p class="text-gray-300"><strong>Theorem 6.</strong> Let  <span class="math">S_1</span> ,  <span class="math">S_2</span>  and  <span class="math">S_3</span>  be three 4-bit permutations and let F be the 8-bit function defined by the corresponding 3-round MISTY network. Then,  <span class="math">\\delta(F) \\geq 16</span> .</p>

    <p class="text-gray-300"><em>Proof.</em> The result is a direct consequence of Prop. 1 combined with the previous lemma. Indeed, Lemma 2 guarantees the existence of a, b and c such that at least one of the three following properties holds:</p>

    <ul class="list-disc list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li><span class="math">$\\begin{split} &amp;-\\delta_{S_1}(a,c)\\geq 4 \\text{ and } \\delta_{S_3}(c,b\\oplus c)\\geq 4,\\\\ &amp;-\\delta_{S_2}(a,a\\oplus c)\\geq 4 \\text{ and } \\delta_{S_3}(a,b\\oplus c)\\geq 4,\\\\ &amp;-\\delta_{S_1}(a,b)\\geq 4 \\text{ and } \\delta_{S_2}(b,c)\\geq 4. \\end{split}</span>$</li>
    </ul>

    <p class="text-gray-300">In each of these three situations, Prop. 1 exhibits a differential  <span class="math">(\\alpha, \\beta)</span>  for F with  <span class="math">\\delta_F(\\alpha, \\beta) = 16</span> .</p>

    <h4 id="sec-misc-2" class="text-lg font-semibold mt-6">4.2Linearity</h4>

    <p class="text-gray-300">In order to apply Theorem 4 to the case of 8-bit MISTY network, we need to estimate the best linearity (and  <span class="math">\\mathcal{L}_{min}</span> ) for 4-bit S-Boxes. It is well-known that the lowest linearity for a 4-bit permutation is 8. But, this result still holds if the S-Box is not bijective.</p>

    <p class="text-gray-300"><strong>Lemma 3.</strong> Any 4-bit S-Box S satisfies  <span class="math">\\mathcal{L}(S) \\geq 8</span> .</p>

    <p class="text-gray-300"><em>Proof.</em> Assume that there exists some S from  <span class="math">\\mathbb{F}_2^4</span>  into  <span class="math">\\mathbb{F}_2^4</span>  with  <span class="math">\\mathcal{L}(S) &lt; 8</span> , i.e., with  <span class="math">\\mathcal{L}(S) \\le 6</span> . Then, all nonzero Boolean components of S,  <span class="math">S_c: x \\mapsto c \\cdot S(x)</span>  with  <span class="math">c \\neq 0</span> , satisfy  <span class="math">\\mathcal{L}(S_c) \\leq 6</span> . From the classification of all Boolean functions of at most 5 variables by Berlekamp and Welch [6], we deduce that any  <span class="math">S_c</span> ,  <span class="math">c \\neq 0</span> , is affine equivalent either to  <span class="math">x_1x_2x_3x_4 + x_1x_2 + x_3x_4</span>  or to  <span class="math">x_1x_2 + x_3x_4</span> , because these are the only classes of Boolean functions with linearity at most 6. Let  <span class="math">L_1</span>  (resp.  <span class="math">L_2</span> ) denote the set of all nonzero  <span class="math">c \\in \\mathbb{F}_2^4</span>  such that  <span class="math">S_c</span>  belongs to the first (resp. second) class. Since the degree is invariant under affine transformations,  <span class="math">L_1</span>  (resp.  <span class="math">L_2</span> ) corresponds to the components with degree 4 (resp. with degree at most 2). The sum of two components of degree at most 2 has degree at most 2, implying that  <span class="math">L_2 \\cup \\{0\\}</span>  is a linear subspace V of  <span class="math">\\mathbb{F}_2^4</span> . It follows that the projection of S on V can be seen as a function from  <span class="math">\\mathbb{F}_2^4</span>  into  <span class="math">\\mathbb{F}_2^{\\dim V}</span>  with linearity 4, i.e., a bent function. It has been shown by Nyberg [34] that, if a function F from  <span class="math">\\mathbb{F}_2^n</span>  into  <span class="math">\\mathbb{F}_2^m</span>  is bent, then  <span class="math">m \\leq n/2</span> . Therefore, dim <span class="math">V \\leq 2</span> . But, the sum of any two components  <span class="math">S_c</span>  of degree 4 cannot have degree 4 since there is a single monomial of degree 4 of 4 variables. We deduce that, if  <span class="math">L_1</span>  contains t words of weight 1 (i.e., if S has t coordinates with linearity 6), then</p>

    <p class="text-gray-300"><span class="math">$\\#L_2 \\ge {t \\choose 2} + 2^{4-t} - 1 &gt; 3,</span>$</p>

    <p class="text-gray-300">for all  <span class="math">0 \\le t \\le 4</span> , a contradiction</p>

    <p class="text-gray-300">Combined with the previous lemma and with Definition 4, Theorem 4 provides the following lower bound on the linearity of a 3-round MISTY network over  <span class="math">\\mathbb{F}_2^8</span> .</p>

    <p class="text-gray-300">Corollary 2. Any 8-bit function F corresponding to a 3-round MISTY network satisfies  <span class="math">\\mathcal{L}(F) \\geq 32</span> .</p>

    <p class="text-gray-300">This bound is of marginal interest since, up to our best knowledge,  <span class="math">\\mathcal{L}(S) = 32</span>  is the lowest known linearity for an 8-bit S-Box. But, once again, the previous lower bound can be improved when focusing on permutations. Indeed, we can exploit that  <span class="math">\\mathcal{L}_{\\min}(S) \\geq 8</span>  for any 4-bit permutation:</p>

    <p class="text-gray-300"><strong>Lemma 4.</strong> For any 4-bit permutation S, the table of linear biases of S has at least one value greater than or equal to 8 on every row and column.</p>

    <p class="text-gray-300"><em>Proof.</em> This result is obtained by an exhaustive search over all affine equivalence classes. The 302 representatives have been examined, and we could check the result for each of them.</p>

    <p class="text-gray-300">Using that any 4-bit permutation S satisfies  <span class="math">\\mathcal{L}(S) \\geq 8</span>  and  <span class="math">\\mathcal{L}_{\\min}(S) \\geq 8</span> , we directly deduce from Theorem 4 the following improved lower bound.</p>

    <p class="text-gray-300">Proposition 3. Let S1, S<sup>2</sup> and S<sup>3</sup> be three 4-bit S-Boxes and let F be the 8-bit function defined by the corresponding 3-round MISTY network. If any of the three inner S-Boxes is a permutation, then L(F) &ge; 64. Most notably, if L(F) &lt; 64, then &delta;(F) &ge; 32.</p>

    <p class="text-gray-300">The last statement in the previous theorem is deduced from the first item in Theorem <a href="#page-7-1">3.</a> While it shows that 3-round MISTY with L(F) &lt; 64 would be of little interest, we now show that their linearity is at least 48.</p>

    <p class="text-gray-300">We first observe that if there is a nonzero linear mask c with |&lambda;S<sup>3</sup> (0, c)| &ge; 4, then we have |&lambda;<sup>F</sup> (0k0, ckc)| = 16 &times; 4 = 64 according to Prop. <a href="#page-7-0">2.</a> Therefore we study the functions such that |&lambda;S(0, c)| &lt; 4 for all nonzero c.</p>

    <p class="text-gray-300">Lemma 5. The only 4-bit functions S with |&lambda;S(0, c)| &lt; 4 for all nonzero c are the permutations, and the functions with image size 15.</p>

    <p class="text-gray-300">Proof. The property &forall;c 6= 0: |&lambda;S(0, c)| &lt; 4 depends only on the set of images of S, with multiplicity. This results is obtained by an exhaustive search over all the multisets of 16 elements in {0, . . . , 15}. We have tested the property over all 300540195 multisets; only the multiset with 16 distinct values and the 240 multisets with 15 distinct values satisfy it.</p>

    <p class="text-gray-300">Lemma 6. For any 4-bit functions S with image size 15 or 16, the table of linear biases of S has at least one value greater than or equal to 6 in every column ( i.e. &forall;c 6= 0: &exist;a, |&lambda;S(a, c)| &ge; 6).</p>

    <p class="text-gray-300">Proof. The property is invariant under affine equivalence. Therefore, we obtain the result by an exhaustive search over the affine equivalence classes of S with image size 15 or 16. According to the classification of 4-bit permutations <a href="#page-20-8">[17]</a>, there is a set of 302 permutations P<sup>k</sup> such that any 4-bit permutation P can be decomposed as P = &beta; &#9702; P<sup>k</sup> &#9702; &alpha;, where &alpha;, &beta; are affine permutations.</p>

    <p class="text-gray-300">Let S be a 4-bit function with image size 15. We denote by &pi;i,j the projection i 7&rarr; j; x 6= i 7&rarr; x. There exist a permutation P, and a projection &pi;i,j such that S = &pi;i,j &#9702; P. Using the decomposition P = &beta; &#9702; P<sup>k</sup> &#9702; &alpha;, we show that S is affine equivalent to a function &pi;a,b &#9702; Pk:</p>

    <p class="text-gray-300"><span class="math">$S = \\pi_{i,j} \\circ \\beta \\circ P_k \\circ \\alpha = \\beta \\circ \\pi_{\\beta^{-1}(i),\\beta^{-1}(j)} \\circ P_k \\circ \\alpha.</span>$</p>

    <p class="text-gray-300">We have tested the property for all 302 permutations P<sup>k</sup> and all 72480 functions &pi;a,b &#9702; Pk.</p>

    <p class="text-gray-300">This allows to prove the following improved bound.</p>

    <p class="text-gray-300">Theorem 7. Let S1, S<sup>2</sup> and S<sup>3</sup> be three 4-bit S-Boxes and let F be the 8-bit function defined by the corresponding 3-round MISTY network. Then L(F) &ge; 48.</p>

    <p class="text-gray-300">Proof. The result is immediate if there exists a nonzero c with |&lambda;S<sup>3</sup> (0, c)| &ge; 4. Otherwise, we choose a and b such that |&lambda;<sup>S</sup><sup>1</sup> (b, a)| &ge; 8, and Lemmas <a href="#page-13-1">5</a> and <a href="#page-13-2">6</a> show that there exists c with |&lambda;<sup>S</sup><sup>3</sup> (a, c)| &ge; 6. We have |&lambda;<sup>F</sup> (akb, ckc)| &ge; 48 from Prop. <a href="#page-7-0">2.</a></p>

    <p class="text-gray-300">We conjecture that any MISTY network with 4-bit inner functions actually satisfies L(F) &ge; 64, but it seems hard to prove without a full classification of the 4-bit functions.</p>

    <p class="text-gray-300">The results by Li and Wang <a href="#page-21-16">[27]</a> on 3 rounds of the Feistel construction provide a lower bound on the differential uniformity and on the linearity of the resulting function depending on the differential uniformity and linearity of S2. However, these results can be generalized in order to involve the properties of the three constituent S-Boxes in an almost symmetric way by using the same method as for the MISTY construction. We here detail these generalized results and their proofs.</p>

      <h3 id="sec-5.1" class="text-xl font-semibold mt-8">5.1 Differential uniformity of a 3-round Feistel construction</h3>

    <p class="text-gray-300"><strong>Proposition 4.</strong> Let  <span class="math">S_1</span> ,  <span class="math">S_2</span>  and  <span class="math">S_3</span>  be three n-bit S-Boxes and F be the 2n-bit function defined by the corresponding 3-round Feistel network. Then, for all a, b and c in  <span class="math">\\mathbb{F}_2^n</span> , we have:</p>

    <p class="text-gray-300">(i)
<span class="math">$\\delta_F(0||a,b||c) = \\delta_{S_2}(a,c) \\times \\delta_{S_3}(c,a \\oplus b);</span>$</p>

    <p class="text-gray-300">(ii) If  <span class="math">S_2</span>  is bijective,</p>

    <p class="text-gray-300"><span class="math">$\\delta_F(a||b,c||a)| = \\delta_{S_1}(a,b) \\times \\delta_{S_3}(a,c) ;</span>$</p>

    <p class="text-gray-300">(iii)
<span class="math">$\\delta_F(a||b,c||0) = \\delta_{S_1}(a,b\\oplus c) \\times \\delta_{S_2}(c,a) .</span>$</p>

    <p class="text-gray-300">Proof.</p>

    <p class="text-gray-300">(i)  <span class="math">x = (x_L, x_R)</span>  satisfies  <span class="math">F(x_L||x_R) \\oplus F(x_L||(x_R \\oplus a)) = b||c|</span>  if and only if</p>

    <p class="text-gray-300"><span class="math">$\\begin{cases} S_2(S_1(x_L) \\oplus x_R \\oplus a) \\oplus S_2(S_1(x_L) \\oplus x_R) = c \\\\ S_3(y_R \\oplus c) \\oplus S_1(x_L) \\oplus x_R \\oplus a \\oplus S_3(y_R) \\oplus S_1(x_L) \\oplus x_R = b \\end{cases}</span>$</p>

    <p class="text-gray-300">or equivalently.</p>

    <p class="text-gray-300"><span class="math">$S_1(x_L) \\oplus x_R \\in D_{S_2}(a \\to c)</span>$
and  <span class="math">y_R \\in D_{S_3}(c \\to a \\oplus b)</span> .</p>

    <p class="text-gray-300">The function  <span class="math">(x_L, x_R) \\mapsto ((S_1(x_L) \\oplus x_R), y_R)</span>  is a permutation since it corresponds to 2 rounds of the Feistel construction. Therefore, the number of  <span class="math">x = (x_L, x_R)</span>  satisfying the differential is  <span class="math">\\delta_{S_2}(a \\to c) \\times \\delta_{S_3}(c \\to a \\oplus b)</span> .</p>

    <p class="text-gray-300">(ii)  <span class="math">x = (x_L, x_R)</span>  satisfies  <span class="math">F(x_L||x_R) \\oplus F((x_L \\oplus a)||(x_R \\oplus b)) = c||a|</span>  iff</p>

    <p class="text-gray-300"><span class="math">$\\begin{cases} S_2(S_1(x_L \\oplus a) \\oplus x_R \\oplus b) \\oplus x_L \\oplus a \\oplus S_2(S_1(x_L) \\oplus x_R) \\oplus x_L = a \\\\ S_3(y_R \\oplus a) \\oplus S_1(x_L \\oplus a) \\oplus x_R \\oplus b \\oplus S_3(y_R) \\oplus S_1(x_L) \\oplus x_R = c \\end{cases}</span>$</p>

    <p class="text-gray-300">The first equality corresponds to</p>

    <p class="text-gray-300"><span class="math">$S_2(S_1(x_L \\oplus a) \\oplus x_R \\oplus) \\oplus S_2(S_1(x_L) \\oplus x_R) = 0</span>$
,</p>

    <p class="text-gray-300">which is equivalent to</p>

    <p class="text-gray-300"><span class="math">$S_1(x_L \\oplus a) \\oplus x_R \\oplus b = S_1(x_L) \\oplus x_R</span>$</p>

    <p class="text-gray-300">if  <span class="math">S_2</span>  is a permutation. Therefore,  <span class="math">(x_L, x_R)</span>  satisfies the differential iff</p>

    <p class="text-gray-300"><span class="math">$x_L \\in D_{S_1}(a \\to b)</span>$
and  <span class="math">y_R \\in D_{S_2}(a \\to c)</span> .</p>

    <p class="text-gray-300">For any fixed  <span class="math">x_L \\in D_{S_1}(a \\to b)</span> , there are  <span class="math">\\delta_{S_3}(a,c)</span>  values of  <span class="math">x_R = S_2^{-1}(x_L \\oplus y_R) \\oplus S_1(x_L)</span>  which provide a valid input.</p>

    <p class="text-gray-300">(iii)  <span class="math">x=(x_L,x_R)</span>  satisfies  <span class="math">F(x_L||x_R)\\oplus F((x_L\\oplus a)||(x_R\\oplus b))=c||0</span>  iff</p>

    <p class="text-gray-300"><span class="math">$\\begin{cases} S_2(S_1(x_L \\oplus a) \\oplus x_R \\oplus b) \\oplus x_L \\oplus a \\oplus S_2(S_1(x_L) \\oplus x_R) \\oplus x_L = 0 \\\\ S_3(y_R) \\oplus S_1(x_L \\oplus a) \\oplus x_R \\oplus b \\oplus S_3(y_R) \\oplus S_1(x_L) \\oplus x_R = c \\end{cases}</span>$</p>

    <p class="text-gray-300">The second equation is equivalent to</p>

    <p class="text-gray-300"><span class="math">$x_L \\in D_{S_1}(a \\to b \\oplus c)</span>$</p>

    <p class="text-gray-300">and the first one corresponds to</p>

    <p class="text-gray-300"><span class="math">$S_1(x_L) \\oplus x_R \\in D_{S_2}(c \\to a)</span>$
.</p>

    <p class="text-gray-300">From these three particular types of differentials, we deduce a lower bound on the differential uniformity of a 3-round Feistel construction, similar to Theorem 3.</p>

    <p class="text-gray-300"><strong>Theorem 8.</strong> Let  <span class="math">S_1</span> ,  <span class="math">S_2</span>  and  <span class="math">S_3</span>  be three n-bit S-Boxes and let F be the 2n-bit function defined by the corresponding 3-round Feistel network. Then,</p>

    <p class="text-gray-300"><span class="math">$\\delta(F) \\geq \\delta(S_2) \\max (\\delta_{\\min}(S_1), \\delta_{\\min}(S_3))</span>$
.</p>

    <p class="text-gray-300">Moreover,</p>

    <p class="text-gray-300">&ndash; if S<sup>2</sup> is a permutation,</p>

    <p class="text-gray-300"><span class="math">$\\delta(F) \\ge \\max_{i \\ne 2, j \\ne 2, i} \\max \\left( \\delta(S_i) \\delta_{\\min}(S_j), \\ \\max_{i \\ne 2} \\delta(S_i) \\delta_{\\min}(S_2^{-1}) \\right) ,</span>$</p>

    <p class="text-gray-300">&ndash; if S<sup>2</sup> is not a permutation, &delta;(F) &ge; 2 n+1 .</p>

    <p class="text-gray-300">Proof. The result when S<sup>2</sup> is not a permutation has been proved in <a href="#page-21-16">[27]</a>. From the first item in the previous theorem, we now deduce that</p>

    <p class="text-gray-300"><span class="math">$\\delta(F) \\ge \\delta(S_2)\\delta_{\\min}(S_3)</span>$
and  <span class="math">\\delta(F) \\ge \\delta(S_3)\\delta_{\\min}(S_2^{-2})</span></p>

    <p class="text-gray-300">where the second inequality requires that S<sup>2</sup> is a permutation. Indeed, the first result is obtained by choosing (a, c) such that &delta;S<sup>2</sup> (a, c) = &delta;(S2) and by taking the maximum over all b. When we choose (a &oplus; b, c) such that &delta;S<sup>3</sup> (c, a &oplus; b) = &delta;(S3) and take the maximum over all a, we get the second result using that</p>

    <p class="text-gray-300"><span class="math">$\\max_{\\alpha \\neq 0} \\delta_{S_2}(\\alpha, \\beta) = \\max_{\\alpha \\neq 0} \\delta_{S_2^{-1}}(\\beta, \\alpha) \\ge \\delta_{\\min}(S_2^{-1})</span>$</p>

    <p class="text-gray-300">when S<sup>2</sup> is a permutation.</p>

    <p class="text-gray-300">The second item in Prop. <a href="#page-14-0">4,</a> which holds when S<sup>2</sup> is a permutation, leads to</p>

    <p class="text-gray-300"><span class="math">$\\delta(F) \\ge \\delta(S_1)\\delta_{\\min}(S_3)</span>$
and  <span class="math">\\delta(F) \\ge \\delta(S_3)\\delta_{\\min}(S_1)</span> .</p>

    <p class="text-gray-300">The first inequality is obtained by choosing (a, b) such that &delta;S<sup>1</sup> (a, b) = &delta;(S1) and by taking the maximum over all c, and the second one by choosing (a, c) such that &delta;S<sup>3</sup> (a, c) = &delta;(S3) and then taking the maximum over all b.</p>

    <p class="text-gray-300">The third item in Prop. <a href="#page-14-0">4</a> leads to</p>

    <p class="text-gray-300"><span class="math">$\\delta(F) \\ge \\delta(S_1) \\delta_{\\min}(S_2^{-1})</span>$
and  <span class="math">\\delta_F \\ge \\delta(S_2) \\delta_{\\min}(S_1)</span>  .</p>

    <p class="text-gray-300">The first inequality is obtained by choosing (a, b &oplus; c) such that &delta;S<sup>1</sup> (a, b &oplus; c) = &delta;(S1) and by taking the maximum over all c when S<sup>2</sup> is a permutation, and the second one by choosing (a, c) such that &delta;S<sup>2</sup> (c, a) = &delta;(S2) and then taking the maximum over all b.</p>

    <p class="text-gray-300">Also, for n = 4, we can exhibit a necessary condition on the S-Boxes to achieve the lower bound &delta;(F) = 8, by using the same technique as for the MISTY construction. Indeed, we have a result analogous to Lemma <a href="#page-10-0">1.</a></p>

    <p class="text-gray-300">Lemma 7. Let S<sup>2</sup> be a 4-bit permutation with &delta;(S2) = 4 and S<sup>1</sup> and S<sup>3</sup> be two 4-bit functions. Let F be the 8-bit function defined by the corresponding 3-round Feistel network. If &delta;(S1) &ge; 4 or if &delta;(S3) &ge; 4, then &delta;(F) &ge; 16.</p>

    <p class="text-gray-300">Proof. Let C(S) denote the set of columns in the difference table of an S-Box which consist of 0s and 2s only. Then, the first item in Prop. <a href="#page-14-0">4</a> shows that &delta;(F) &ge; 16 unless C(S2) contains all the rows in the difference table of S<sup>3</sup> with a value greater than or equal to 4. Also, the third item in Prop. <a href="#page-14-0">4</a> shows that &delta;(F) &ge; 16 unless C(S2) contains all the rows in the difference table of S<sup>1</sup> with a 4. We have shown in the proof of Lemma <a href="#page-10-0">1</a> that this situation cannot occur.</p>

    <p class="text-gray-300">Therefore, we deduce the following condition for obtaining a 3-round Feistel construction over F 8 <sup>2</sup> with differential uniformity 8.</p>

    <p class="text-gray-300">Theorem 9. Let S1, S<sup>2</sup> and S<sup>3</sup> be three 4-bit S-Boxes and let F be the 8-bit function defined by the corresponding 3-round Feistel construction. Then, &delta;(F) = 8 implies that S<sup>2</sup> is a permutation with &delta;(S2) = 4 and S<sup>1</sup> and S<sup>3</sup> are two APN functions. Otherwise, &delta;(F) &ge; 12.</p>

    <p class="text-gray-300">For instance, we can directly derive that the 8-bit S-Box P in CS-Cipher <a href="#page-21-25">[44]</a> and the S-Box of Robin <a href="#page-21-7">[22]</a> have differential uniformity at least 16 since their constituent S-Boxes satisfy the hypotheses of Lemma <a href="#page-15-0">7.</a></p>

      <h3 id="sec-5.2" class="text-xl font-semibold mt-8">5.2 Linearity of a 3-round Feistel construction</h3>

    <p class="text-gray-300"><strong>Proposition 5.</strong> Let  <span class="math">S_1</span> ,  <span class="math">S_2</span>  and  <span class="math">S_3</span>  three n-bit S-Boxes and F the 2n-bit function defined by the corresponding 3-round Feistel construction. Then, for all a, b and c in  <span class="math">\\mathbb{F}_2^n</span> , we have:</p>

    <ul class="list-disc list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li>(i)  <span class="math">\\lambda_F(a||b,0||c) = \\lambda_{S_1}(a \\oplus c,b)\\lambda_{S_2}(b,c)</span></li>
      <li>(ii)  <span class="math">\\lambda_F(a||0,b||c) = \\lambda_{S_2}(b,a)\\lambda_{S_3}(a \\oplus c,b)</span></li>
      <li>(iii) If  <span class="math">S_2</span>  is bijective,  <span class="math">\\lambda_F(a||b,b||c) = \\lambda_{S_1}(a,b)\\lambda_{S_3}(c,b)</span></li>
    </ul>

    <p class="text-gray-300">Proof. (i)
<span class="math">$\\lambda_{F}(a||b,0||c) = \\sum_{(x_{R},x_{L}) \\in (\\mathbb{F}_{2}^{n})^{2}} (-1)^{c \\cdot x_{L} + c \\cdot S_{2}(S_{1}(x_{L}) \\oplus x_{R}) \\oplus a \\cdot x_{L} \\oplus b \\cdot x_{R}}</span>$</p>

    <p class="text-gray-300"><span class="math">$= \\sum_{x_{L} \\in \\mathbb{F}_{2}^{n}} (-1)^{(a \\oplus c) \\cdot x_{L} + b \\cdot S_{1}(x_{L})} \\sum_{z \\in \\mathbb{F}_{2}^{n}} (-1)^{c \\cdot S_{2}(z) + b \\cdot z}</span>$</p>

    <p class="text-gray-300"><span class="math">$= \\lambda_{S_{1}}(a \\oplus c, b) \\lambda_{S_{2}}(b, c)</span>$</p>

    <p class="text-gray-300">where we set  <span class="math">z = S_1(x_L) + x_R</span>  and we use the fact that, for any fixed  <span class="math">x_L, x_R \\mapsto z</span>  is a permutation.</p>

    <p class="text-gray-300">(ii)
<span class="math">$\\lambda_{F}(a||0,b||c) = \\sum_{(x_{R},x_{L}) \\in (\\mathbb{F}_{2}^{n})^{2}} (-1)^{c \\cdot y_{R} + b \\cdot S_{3}(y_{R}) + b \\cdot (S_{1}(x_{L}) \\oplus x_{R}) \\oplus a \\cdot x_{L}}</span>$</p>

    <p class="text-gray-300"><span class="math">$= \\sum_{(y_{R},z) \\in (\\mathbb{F}_{2}^{n})^{2}} (-1)^{c \\cdot y_{R} + b \\cdot S_{3}(y_{R}) + b \\cdot z + a \\cdot (y_{R} + S_{2}(z))}</span>$</p>

    <p class="text-gray-300"><span class="math">$= \\lambda_{S_{2}}(b,a) \\lambda_{S_{3}}(a \\oplus c,b)</span>$</p>

    <p class="text-gray-300">where we use that the function  <span class="math">(x_L, x_R) \\mapsto (y_R, z)</span>  is a permutation since it corresponds to two rounds of the Feistel construction.</p>

    <p class="text-gray-300">(iii)
<span class="math">$\\lambda_{F}(a||b,b||c) = \\sum_{(x_{R},x_{L})\\in(\\mathbb{F}_{2}^{n})^{2}} (-1)^{c\\cdot y_{R}+b\\cdot S_{3}(y_{R})+b\\cdot x_{R}+b\\cdot S_{1}(x_{L})\\oplus a\\cdot x_{L}+b\\cdot x_{R}}</span>$</p>

    <p class="text-gray-300"><span class="math">$= \\sum_{x_{L}\\in\\mathbb{F}_{2}^{n}} (-1)^{b\\cdot S_{1}(x_{L})\\oplus a\\cdot x_{L}} \\sum_{y\\in\\mathbb{F}_{2}^{n}} (-1)^{c\\cdot y+b\\cdot S_{3}(y)}</span>$</p>

    <p class="text-gray-300"><span class="math">$= \\lambda_{S_{1}}(a,b) \\lambda_{S_{3}}(c,b)</span>$</p>

    <p class="text-gray-300">using that  <span class="math">x_R \\mapsto y = x_L \\oplus S_2(S_1(x_L) \\oplus x_R)</span>  is a permutation for any fixed  <span class="math">x_L</span>  when  <span class="math">S_2</span>  is a permutation.</p>

    <p class="text-gray-300">We then deduce the following lower bound on the linearity of any 3-round Feistel construction.</p>

    <p class="text-gray-300"><strong>Theorem 10.</strong> Let  <span class="math">S_1</span> ,  <span class="math">S_2</span>  and  <span class="math">S_3</span>  be three n-bit S-Boxes and let F be the 2n-bit function defined by the corresponding 3-round Feistel network. Then,</p>

    <p class="text-gray-300"><span class="math">$\\mathcal{L}(F) \\ge \\mathcal{L}(S_2) \\max (\\mathcal{L}_{\\min}(S_1), \\mathcal{L}_{\\min}(S_3))</span>$
.</p>

    <p class="text-gray-300">Moreover, if  <span class="math">S_2</span>  is a permutation,</p>

    <p class="text-gray-300"><span class="math">$\\mathcal{L}(F) \\ge \\mathcal{L}(S_1) \\max \\left(\\mathcal{L}_{\\min}(S_2^{-1}), \\ \\mathcal{L}_{\\min}(S_3)\\right)</span>$</p>

    <p class="text-gray-300">and
<span class="math">$\\mathcal{L}(F) \\geq \\mathcal{L}(S_3) \\max \\left(\\mathcal{L}_{\\min}(S_1), \\ \\mathcal{L}_{\\min}(S_2^{-1})\\right)</span>$
.</p>

    <p class="text-gray-300"><em>Proof.</em> From the first item in the previous theorem, we deduce that</p>

    <p class="text-gray-300"><span class="math">$\\mathcal{L}(F) \\ge \\mathcal{L}(S_1)\\mathcal{L}_{\\min}(S_2^{-1})</span>$
and  <span class="math">\\mathcal{L}(F) \\ge \\mathcal{L}(S_2)\\mathcal{L}_{\\min}(S_1)</span></p>

    <p class="text-gray-300">where the first inequality requires that  <span class="math">S_2</span>  be a permutation.</p>

    <p class="text-gray-300">The second item in Prop. 5 provides</p>

    <p class="text-gray-300"><span class="math">$\\mathcal{L}(F) \\ge \\mathcal{L}(S_2)\\mathcal{L}_{\\min}(S_3)</span>$
and  <span class="math">\\mathcal{L}(F) \\ge \\mathcal{L}(S_3)\\mathcal{L}_{\\min}(S_2^{-1})</span></p>

    <p class="text-gray-300">where the second inequality holds when  <span class="math">S_2</span>  is a permutation.</p>

    <p class="text-gray-300">From the third item in Prop. 5, we get that, when  <span class="math">S_2</span>  is a permutation</p>

    <p class="text-gray-300"><span class="math">$\\mathcal{L}(F) \\geq \\mathcal{L}(S_1)\\mathcal{L}_{\\min}(S_3)</span>$
and  <span class="math">\\mathcal{L}(F) \\geq \\mathcal{L}(S_3)\\mathcal{L}_{\\min}(S_1)</span> .</p>

    <p class="text-gray-300">The previous general bound can be improved in the case n=4, exactly as for the MISTY construction. First, we get the following proposition as a direct consequence of Lemma 4.</p>

    <p class="text-gray-300"><strong>Proposition 6.</strong> Let  <span class="math">S_1</span> ,  <span class="math">S_2</span>  and  <span class="math">S_3</span>  be three 4-bit S-Boxes and let F be the 8-bit function defined by the corresponding 3-round Feistel network. If any of the three inner S-Boxes is a permutation, then</p>

    <p class="text-gray-300"><span class="math">$\\mathcal{L}(F) \\geq 64</span>$
.</p>

    <p class="text-gray-300">Most notably, if  <span class="math">\\mathcal{L}(F) &lt; 64</span> , then  <span class="math">\\delta(F) \\geq 32</span> .</p>

    <p class="text-gray-300">Even if 3-round Feistel with  <span class="math">\\mathcal{L}(F) &lt; 64</span>  would be of very little interest, we can show that their linearity is at least 48.</p>

    <p class="text-gray-300"><strong>Theorem 11.</strong> Let  <span class="math">S_1</span> ,  <span class="math">S_2</span>  and  <span class="math">S_3</span>  be three 4-bit S-Boxes and let F be the 8-bit function defined by the corresponding 3-round Feistel network. Then</p>

    <p class="text-gray-300"><span class="math">$\\mathcal{L}(F) \\geq 48</span>$
.</p>

    <p class="text-gray-300"><em>Proof.</em> The previous theorem shows that the result holds if  <span class="math">S_2</span>  is a permutation. Assume that  <span class="math">S_2</span>  is not a permutation, i.e., there exists some nonzero output mask c such that  <span class="math">\\lambda_{S_2}(0,c) &gt; 0</span> . Using the first item in Prop. 5, we get that</p>

    <p class="text-gray-300"><span class="math">$\\lambda_F(c||0,0||c) = \\lambda_{S_1}(0,0)\\lambda_{S_2}(0,c) = 16\\lambda_{S_2}(0,c)</span>$
.</p>

    <p class="text-gray-300">The result then holds if there exists some nonzero c such that  <span class="math">\\lambda_{S_2}(0,c) \\geq 4</span> . Otherwise, we deduce from Lemmas 5 and 6 that</p>

    <p class="text-gray-300"><span class="math">$\\mathcal{L}(F) \\ge 48</span>$
.</p>

    </section>

    <section id="sec-6" class="mb-10">
      <h2 class="text-2xl font-bold">6 Constructions</h2>

    <p class="text-gray-300">We now use the previous results to design concrete 8-bit invertible S-Boxes optimized for lightweight implementations. We use Feistel and MISTY networks, and select 4-bit S-Boxes  <span class="math">S_i</span> 's with a low-cost implementation that provide good cryptographic properties of the resulting 8-bit S-Box. Such S-Boxes have been considered as good candidates for many lightweight construction (e.g. the LS-designs [22]), but their respective merits and their cryptographic properties remained open.</p>

    <p class="text-gray-300">We focus on implementing functions with a low gate count for hardware implementations, and a low instruction count for bit-sliced implementations (for table-based implementations, the table size is independent of the concrete S-Boxes). Moreover, we focus on implementations with a small number of non-linear gates, because non-linear gates are much harder to implement than linear gates in some dedicated settings such as masking [40], multi-party computation, or homomorphic encryption [1]. Bit-slicing can be used as an implementation technique to take advantage of some platform characteristics (for instance, it yields the fastest known implementation of AES on some Intel processors [24]), but it can also be a design criterion. Indeed, using a bit-sliced S-Box allow compact implementations without tables, and good performances both in software and hardware. In addition, S-Boxes implemented in this way are easier to protect against side-channel attacks with masking. Therefore, this approach is used by many lightweight designs such as SERPENT [9], NOEKEON [15], KECCAK [8], ROBIN and FANTOMAS [22], PRIDE [2], PR&Oslash;ST [25], or ASCON [18]. This makes the construction of S-Boxes with a low gate count particularly relevant for lightweight cryptography.</p>

    <p class="text-gray-300">Following the previous sections, the best results we can achieve for an 8-bit invertible S-Box are:</p>

    <p class="text-gray-300">With a MISTY network:  <span class="math">\\delta(F) = 16</span>  and  <span class="math">\\mathcal{L}(F) = 64</span> .</p>

    <p class="text-gray-300">With a Feistel network: &delta;(F) = 8 and L(F) = 64.</p>

    <p class="text-gray-300">We can provide some examples fulfilling these bounds: Example <a href="#page-11-1">2</a> is optimal for the MISTY construction, and an example for the Feistel construction is now exhibited. It is worth noticing that these results explain the compared properties of the S-Boxes obtained by the simulations reported in <a href="#page-21-7">[22]</a>. Since Feistel networks can reach a better security, we will mostly consider this construction. In this case, the optimal differential uniformity can be reached only if S1, S<sup>3</sup> are APN, and S<sup>2</sup> is a permutation with &delta;(S2) = 4, as proved in Th. <a href="#page-15-1">9.</a> Note that, in some other contexts, the MISTY construction presents some advantages since it offers better performance in terms of throughput and latency because the first two S-Boxes can be evaluated in parallel.</p>

      <h3 id="sec-6.1" class="text-xl font-semibold mt-8">6.1 Feistel network with low gate count and instruction count</h3>

    <p class="text-gray-300">Rather than choosing S-Boxes S1, S<sup>2</sup> and S<sup>3</sup> with good properties first, and then searching for an efficient implementation of these S-Boxes (as in <a href="#page-21-28">[39</a><a href="#page-20-1">,13]</a> for instance), we take the opposite approach, following Ullrich et al. <a href="#page-21-29">[46]</a>. We build gate descriptions of S-Boxes, and we test their cryptographic properties until we find a good candidate. Indeed, we do not have to specify in advance the 4-bit S-Boxes S1, S2, S3. Instead, we look for a good implementation of a permutation with &delta;(S) = 4 for S2, a good implementation of an APN function for S<sup>1</sup> and S3, and we test the properties of the resulting Feistel structure. With good probability, this results in a Feistel network F with &delta;(F) = 8 and L(F) = 64.</p>

    <p class="text-gray-300">Following Ullrich et al., we run a search oriented towards bit-sliced implementations. We consider sequences of software instructions, with instructions AND, OR, XOR, NOT, and MOV, using at most 5 registers. This directly translates to a hardware representation: the MOV instruction become a branch while the other instructions represent the corresponding gates. There are 85 choices of instructions at each step, but we use an equivalence relation to restrict the search. For S2, we can directly reuse the results of <a href="#page-21-29">[46]</a>: they give an optimal implementation of a 4-bit permutation with &delta;(S) = 4. For S<sup>1</sup> and S3, we implemented a version of their algorithm, and searched for APN functions. We found that there is no construction of an APN function with 9 or fewer instructions. There are solutions with 10 instructions, but they have at least 6 non-linear instructions (AND, OR), which is not efficient for a masked implementation. Finally, with 11 instructions, there are constructions of APN functions with 4 non-linear instructions, 5 XOR instructions, and 2 MOV (copy) instructions. This search requires about 6000 core-hours of computation. The branching factor of our search is close to 10, while Ullrich et al. report a branching factor of less than 7; this is because we do not restrict the search to permutations (indeed, 4-bit APN functions are not permutations). This results in a very efficient 8-bit S-Box with good cryptographic properties, using 12 nonlinear gates, and 26 XORs. According to Theorem <a href="#page-15-1">9</a> and to the following Lemma, this is the optimal number of non-linear gates.</p>

    <p class="text-gray-300">Lemma 8. Let S be a 4-bit permutation with &delta;(S) &le; 4 or a 4-bit APN function. Any implementation of S requires at least 4 non-linear gates.</p>

    <p class="text-gray-300">Proof. If S can be implemented with 3 non-linear gates or less, then the algebraic expression of the output variables is a linear combination of the input variables, and of the 3 polynomials corresponding to the output of the 3 non-linear gates. Therefore, there exists a linear combination of the input and output variables that sums to a constant, i.e. L(S) = 16. According to the classification of 4-bit permutation in <a href="#page-20-8">[17]</a>, any permutation with &delta;(S) = 4 satisfies L(S) &le; 12. Furthermore, the classification of 4-bit APN functions <a href="#page-20-18">[14]</a> shows that they satisfy L(S) = 8, which proves the lemma.</p>

    <p class="text-gray-300">We give an example of such an implementation in Figure <a href="#page-19-0">5,</a> and we compare our results with previous designs in Table <a href="#page-20-19">1.</a> In particular, we reach a better differential uniformity than the S-Boxes used in Robin and Fantomas <a href="#page-21-7">[22]</a>, for a small number of extra gates. For comparing the respective merits of the S-Boxes considered in Table <a href="#page-20-19">1,</a> we use the fact that, as a simple approximation, the number of rounds needed to reach a fixed security level against differential attacks is proportional to 1/ log(&delta;(S)/256), and the implementation cost per round is proportional to the number of non-linear gates (for a bit-sliced software implementation with masking). This allows to derive a simple implementation cost metric for the S-Boxes presented in the last column, taking 1 for the AES, and considering only security against differential attacks.</p>

    <p class="text-gray-300">    <img src="_page_19_Figure_0.jpeg" alt="" class="my-4 max-w-full" />
</p>

    <p class="text-gray-300">    <img src="_page_19_Figure_1.jpeg" alt="" class="my-4 max-w-full" />
</p>

    <p class="text-gray-300"><strong>5.1.</strong>
<span class="math">$S_1</span>$
, APN function with  <span class="math">\\delta(S_1) = 2</span> .  <span class="math">S_1 = [0, 0, 4, d, c, 0, 0, 5, 8, 0, 7, 6, 5, a, 2, 4]</span></p>

    <p class="text-gray-300">5.2. S2, permutation with &delta;(S2) = 4. S<sup>2</sup> = [0, 8, 6, d, 5, f, 7, c, 4, e, 2, 3, 9, 1, b, a]</p>

    <p class="text-gray-300">Fig. 5. Construction of a lightweight S-Box S with a three-round Feistel (S1, S2, S1) satisfying &delta;(S) = 8 and L(S) = 64.</p>

    <p class="text-gray-300">Finally, we consider an alternative to MISTY structures as studied in this paper. Instead of dividing the input into two halves of equal size, we consider unbalanced networks. The idea is to split the 8 input bits in two inequal parts of 3 and 5 bits. Thus, the MISTY network will use only 3 and 5 bit S-Boxes. The advantage of 3- and 5-bit S-Boxes is that invertible S-Boxes with &delta; = 2 exist, contrarily to the case of 4-bit S-Boxes. We managed to obtain 8-bit S-Boxes S with &delta;(S) = 8 using unbalanced MISTY networks, which is better than the lower bound &delta;(S) &ge; 16 proved for balanced MISTY networks. However, this method uses 5-bit S-Boxes, which are more complicated to implement than 4-bit S-Boxes.</p>

    <p class="text-gray-300">Example 3. We consider a 3-round unbalanced MISTY structure, with 5-bit permutations S1, S<sup>3</sup> and a 3-bit permutation S2. After S<sup>1</sup> and S3, the 3-bit x<sup>L</sup> is xored in the 3 MSB of xR; after S<sup>2</sup> the 3 MSB of the 5-bit x<sup>L</sup> are xored into xL. The following S-Boxes define an 8-bit S-Box with &delta; = 8 and L = 64:</p>

    <pre><code class="language-text">S1 = [00, 01, 02, 04, 03, 08, 0d, 10, 05, 11, 1c, 1b, 1e, 0e, 18, 0a,
       06, 13, 0b, 14, 1f, 1d, 0c, 15, 12, 1a, 0f, 19, 07, 16, 17, 09]
S2 = [2, 5, 6, 4, 0, 1, 3, 7]
S3 = [00, 01, 02, 04, 03, 08, 10, 1c, 05, 0a, 1a, 12, 11, 14, 1f, 1d,
       06, 15, 18, 0c, 16, 0f, 19, 07, 0e, 13, 0d, 17, 09, 1e, 1b, 0b]
</code></pre>

    <p class="text-gray-300">This shows that generalizing our results to the unbalanced case, especially for the MISTY construction, may be of interest.</p>

    <p class="text-gray-300">Our results give a better understanding of the cryptographic properties of lightweight S-Boxes built from smaller S-Boxes. We give a precise description of the best security achievable with a 3-round balanced Feistel or MISTY structure for an 8-bit S-Box, and necessary conditions to reach the bound. Interestingly, the MISTY network cannot offer the same security as the Feistel network for constructing an invertible 8-bit S-Box. Using those results, we describe an 8-bit S-Box S using only 12 non-linear gates and 26 XOR gates, with &delta;(S) = 8 and L(S) = 64. This is the best security than can be achieved with a 3-round Feistel or MISTY structure, and our construction uses the minimal number of non-linear gates to reach this security with these structures. This is an improvement over previous proposals, including the S-Boxes used in CRYPTON, Fantomas and Robin, but further work is required to determine whether different structures can provide better S-Boxes.</p>

    <p class="text-gray-300">Table 1. Comparison of some 8-bit S-Boxes. &delta; and L respectively denote the differential uniformity and the linearity of the S-Box (see Section <a href="#page-1-0">2.1</a> for the definitions), the last column presents the relative overall implementation cost (taking 1 for the AES).</p>

    <div class="overflow-x-auto my-4">
      <table class="min-w-full text-sm text-gray-300">
        <thead>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">S-Box</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">Construction</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">Implementation</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"></th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">Properties</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"></th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"></th>
        </thead>
        <tbody>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">AND/OR</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">XOR</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">L</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">&delta;</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">cost</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">AES [13]</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Inversion in F28<br>+ affine</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">32</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">83</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">32</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">4</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Whirlpool [5]</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Lai-Massey</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">36</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">58</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">64</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">8</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1.35</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">CRYPTON [28] 3-round Feistel</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">49</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">12</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">64</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">8</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1.83</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Robin [22]</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">3-round Feistel</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">12</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">24</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">64</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">16</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">0.56</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Fantomas [22]</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">3-round MISTY (3/5 bits)</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">11</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">25</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">64</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">16</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">0.51</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Unnamed [22]</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Whirlpool-like</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">16</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">41</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">64</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">10</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">0.64</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">New</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">3-round Feistel</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">12</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">26</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">64</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">8</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">0.45</td>
          </tr>
        </tbody>
      </table>
    </div>

    <ul class="list-disc list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li><p class="text-gray-300">1. Albrecht, M., Rechberger, C., Schneider, T., Tiessen, T., Zohner, M.: Ciphers for MPC and FHE. In: Advances in Cryptology - EUROCRYPT 2015, Part I. LNCS, vol. 9056, pp. 430&ndash;454. Springer (2015)</p></li>
      <li><p class="text-gray-300">2. Albrecht, M.R., Driessen, B., Kavun, E.B., Leander, G., Paar, C., Yal&cedil;cin, T.: Block Ciphers - Focus on the Linear Layer (feat. PRIDE). In: Advances in Cryptology - CRYPTO 2014. LNCS, vol. 8616, pp. 57&ndash;76. Springer (2014)</p></li>
      <li><p class="text-gray-300">3. Aoki, K., Ohta, K.: Strict Evaluation of the Maximum Average of Differential Probability and the Maximum Average of Linear Probability. IEICE TRANSACTIONS on Fundamentals of Electronics, Communications and Computer Sciences E80A(1), 2&ndash;8 (1997)</p></li>
      <li><p class="text-gray-300">4. Barreto, P.S., Rijmen, V.: The KHAZAD Legacy-Level Block Cipher. NESSIE submission</p></li>
      <li><p class="text-gray-300">5. Barreto, P.S., Rijmen, V.: The WHIRLPOOL Hashing Function. NESSIE submission</p></li>
      <li><p class="text-gray-300">6. Berlekamp, E.R., Welch, L.R.: Weight distributions of the cosets of the (32, 6) Reed-Muller code. IEEE Transactions on Information Theory 18(1), 203&ndash;207 (1972)</p></li>
      <li><p class="text-gray-300">7. Bernstein, D.J.: Cache-timing on AES. In: Symmetric-Key Encryption Workshop - SKEW 2005 (2005), <a href="http://cr.yp.to/antiforgery/cachetiming-20050414.pdf" target="_blank" rel="noopener noreferrer">http://cr.yp.to/antiforgery/cachetiming-20050414.pdf</a></p></li>
      <li><p class="text-gray-300">8. Bertoni, G., Daemen, J., Peeters, M., Assche, G.V.: The Keccak reference (January 2011), <a href="http://keccak.noekeon.org/" target="_blank" rel="noopener noreferrer">http:</a> <a href="http://keccak.noekeon.org/" target="_blank" rel="noopener noreferrer">//keccak.noekeon.org/</a></p></li>
      <li><p class="text-gray-300">9. Biham, E., Anderson, R.J., Knudsen, L.R.: Serpent: A new block cipher proposal. In: Fast Software Encryption - FSE '98. LNCS, vol. 1372, pp. 222&ndash;238. Springer (1998)</p></li>
      <li><p class="text-gray-300">10. Biham, E., Shamir, A.: Differential Cryptanalysis of DES-like Cryptosystems. J. Cryptology 4(1), 3&ndash;72 (1991)</p></li>
      <li><p class="text-gray-300">11. Bogdanov, A., Knudsen, L.R., Leander, G., Paar, C., Poschmann, A., Robshaw, M.J.B., Seurin, Y., Vikkelsoe, C.: PRESENT: An Ultra-Lightweight Block Cipher. In: Cryptographic Hardware and Embedded Systems - CHES 2007. LNCS, vol. 4727, pp. 450&ndash;466. Springer (2007)</p></li>
      <li><p class="text-gray-300">12. Borghoff, J., Canteaut, A., G&uml;uneysu, T., Kavun, E.B., Knezevic, M., Knudsen, L.R., Leander, G., Nikov, V., Paar, C., Rechberger, C., Rombouts, P., Thomsen, S.S., Yal&cedil;cin, T.: PRINCE - A Low-Latency Block Cipher for Pervasive Computing Applications - Extended Abstract. In: Advances in Cryptology - ASIACRYPT 2012. LNCS, vol. 7658, pp. 208&ndash;225. Springer (2012)</p></li>
      <li><p class="text-gray-300">13. Boyar, J., Peralta, R.: A new combinational logic minimization technique with applications to cryptology. In: International Symposium on Experimental Algorithms - SEA 2010. LNCS, vol. 6049, pp. 178&ndash;189. Springer (2010)</p></li>
      <li><p class="text-gray-300">14. Brinkmann, M., Leander, G.: On the classification of APN functions up to dimension five. Des. Codes Cryptography 49(1-3), 273&ndash;288 (2008)</p></li>
      <li><p class="text-gray-300">15. Daemen, J., Peeters, M., Assche, G.V., Rijmen, V.: Nessie proposal: NOEKEON (2000)</p></li>
      <li><p class="text-gray-300">16. De Canni\`ere, C., Dunkelman, O., Knezevic, M.: KATAN and KTANTAN - A family of small and efficient hardware-oriented block ciphers. In: Cryptographic Hardware and Embedded Systems - CHES 2009. LNCS, vol. 5747, pp. 272&ndash;288. Springer (2009)</p></li>
      <li><p class="text-gray-300">17. De Canni\`ere, C.: Analysis and Design of Symmetric Encryption Algorithms. Ph.D. thesis, KU Leuven (2007)</p></li>
      <li><p class="text-gray-300">18. Dobraunig, C., Eichlseder, M., Mendel, F., Schl&uml;affer, M.: Ascon v1. CAESAR Competition (2014), <a href="http://competitions.cr.yp.to/round1/asconv1.pdf" target="_blank" rel="noopener noreferrer">http://competitions.cr.yp.to/round1/asconv1.pdf</a></p></li>
      <li><p class="text-gray-300">19. ETSI/SAGE: Specification of the 3GPP Confidentiality and Integrity Algorithms 128-EEA3 &amp; 128-EIA3. Document 4: Design and Evaluation Report. Tech. rep. (2011)</p></li>
      <li><p class="text-gray-300">20. G&acute;erard, B., Grosso, V., Naya-Plasencia, M., Standaert, F.: Block ciphers that are easier to mask: How far can we go? In: Cryptographic Hardware and Embedded Systems - CHES 2013. LNCS, vol. 8086, pp. 383&ndash;399. Springer (2013)</p></li>
      <li><p class="text-gray-300">21. Grosso, V., Leurent, G., Standaert, F.X., Varici, K., Durvaux, F., Gaspar, L., Kerckhof, S.: SCREAM &amp; iSCREAM Side-Channel Resistant Authenticated Encryption with Masking. CAESAR competition (2014), <a href="http://competitions.cr.yp.to/round1/screamv1.pdf" target="_blank" rel="noopener noreferrer">http://competitions.cr.yp.to/round1/screamv1.pdf</a></p></li>
      <li><p class="text-gray-300">22. Grosso, V., Leurent, G., Standaert, F.X., Var&#305;c&#305;, K.: LS-designs: Bitslice encryption for efficient masked software implementations. In: Fast Software Encryption - FSE 2014. LNCS, Springer (2014)</p></li>
      <li><p class="text-gray-300">23. Hou, X.D.: Affinity of permutations of F n <sup>2</sup> . Discrete Applied Mathematics 154(2), 313 &ndash; 325 (2006)</p></li>
      <li><p class="text-gray-300">24. K&uml;asper, E., Schwabe, P.: Faster and timing-attack resistant AES-GCM. In: Cryptographic Hardware and Embedded Systems - CHES 2009. LNCS, vol. 5747, pp. 1&ndash;17. Springer (2009)</p></li>
      <li><p class="text-gray-300">25. Kavun, E.B., Lauridsen, M.M., Leander, G., Rechberger, C., Schwabe, P., Yal&cedil;c&#305;n, T.: Pr&oslash; st. CAESAR Proposal (2014), <a href="http://proest.compute.dtu.dk" target="_blank" rel="noopener noreferrer">http://proest.compute.dtu.dk</a></p></li>
      <li><p class="text-gray-300">26. Leander, G., Poschmann, A.: On the Classification of 4 Bit S-Boxes. In: Arithmetic of Finite Fields - WAIFI. LNCS, vol. 4547, pp. 159&ndash;176. Springer (2007)</p></li>
      <li><p class="text-gray-300">27. Li, Y., Wang, M.: Constructing S-boxes for Lightweight Cryptography with Feistel Structure. In: Cryptographic Hardware and Embedded Systems &ndash; CHES 2014, LNCS, vol. 8731, pp. 127&ndash;146. Springer (2014)</p></li>
      <li><p class="text-gray-300">28. Lim, C.H.: CRYPTON: A New 128-bit Block Cipher. AES submission (1998)</p></li>
      <li><p class="text-gray-300">29. Lim, C.H.: A Revised Version of CRYPTON - CRYPTON V1.0. In: Fast Software Encryption &ndash; FSE'99. LNCS, vol. 1636, pp. 31&ndash;45. Springer (1999)</p></li>
      <li><p class="text-gray-300">30. Matsui, M.: Linear cryptanalysis method for DES cipher. In: Advances in Cryptology&mdash;EUROCRYPT'93. LNCS, vol. 765, pp. 386&ndash;397. Springer (1994)</p></li>
      <li><p class="text-gray-300">31. Matsui, M.: New Structure of Block Ciphers with Provable Security against Differential and Linear Cryptanalysis. In: Fast Software Encryption - FSE'96. LNCS, vol. 1039, pp. 205&ndash;218. Springer (1996)</p></li>
      <li><p class="text-gray-300">32. Matsui, M.: New Block Encryption Algorithm MISTY. In: Fast Software Encryption - FSE'97. LNCS, vol. 1267, pp. 54&ndash;68. Springer (1997)</p></li>
      <li><p class="text-gray-300">33. National Institute of Standards and Technology: Data Encryption Standard. FIPS Publication 46-2 (December 1993)</p></li>
      <li><p class="text-gray-300">34. Nyberg, K.: Perfect nonlinear S-boxes. In: Advances in Cryptology - EUROCRYPT'91. LNCS, vol. 547, pp. 378&ndash;385. Springer-Verlag (1991)</p></li>
      <li><p class="text-gray-300">35. Nyberg, K.: Differentially uniform mappings for cryptography. In: Advances in Cryptology - EURO-CRYPT '93. LNCS, vol. 765, pp. 55&ndash;64. Springer (1993)</p></li>
      <li><p class="text-gray-300">36. Nyberg, K.: Linear approximation of block ciphers. In: Advances in Cryptology - EUROCRYPT '94. LNCS, vol. 950, pp. 439&ndash;444. Springer (1994)</p></li>
      <li><p class="text-gray-300">37. Nyberg, K., Knudsen, L.R.: Provable security against differential cryptanalysis. In: Advances in Cryptology - CRYPTO '92. LNCS, vol. 740, pp. 566&ndash;574. Springer (1992)</p></li>
      <li><p class="text-gray-300">38. Nyberg, K., Knudsen, L.R.: Provable security against a differential attack. J. Cryptology 8(1), 27&ndash;37 (1995)</p></li>
      <li><p class="text-gray-300">39. Osvik, D.A.: Speeding up Serpent. In: AES Candidate Conference. pp. 317&ndash;329 (2000)</p></li>
      <li><p class="text-gray-300">40. Rivain, M., Prouff, E.: Provably secure higher-order masking of AES. In: Cryptographic Hardware and Embedded Systems, CHES 2010. LNCS, vol. 6225, pp. 413&ndash;427. Springer (2010)</p></li>
      <li><p class="text-gray-300">41. Rothaus, O.S.: On &quot;bent&quot; functions. J. Comb. Theory, Ser. A 20(3), 300&ndash;305 (1976)</p></li>
      <li><p class="text-gray-300">42. Shannon, C.E.: Communication Theory of Secrecy Systems. Bell system technical journal 28(4), 656&ndash;715 (1949)</p></li>
      <li><p class="text-gray-300">43. Standaert, F., Piret, G., Rouvroy, G., Quisquater, J., Legat, J.: ICEBERG : An involutional cipher efficient for block encryption in reconfigurable hardware. In: Fast Software Encryption - FSE 2004. LNCS, vol. 3017, pp. 279&ndash;299. Springer (2004)</p></li>
      <li><p class="text-gray-300">44. Stern, J., Vaudenay, S.: CS-Cipher. In: Fast Software Encryption - FSE '98. LNCS, vol. 1372, pp. 189&ndash;205. Springer (1998)</p></li>
      <li><p class="text-gray-300">45. Suzaki, T., Minematsu, K., Morioka, S., Kobayashi, E.: Twine: A lightweight block cipher for multiple platforms. In: Selected Areas in Cryptography - SAC 2012. LNCS, vol. 7707, pp. 339&ndash;354. Springer (2012)</p></li>
      <li><p class="text-gray-300">46. Ullrich, M., De Canni\`ere, C., Indesteege, S., K&uml;u&cedil;c&uml;uk, O., Mouha, N., Preneel, B.: Finding Optimal &uml; Bitsliced Implementations of 4x4-bit S-Boxes. In: SKEW 2011 Symmetric Key Encryption Workshop, Copenhagen, Denmark. pp. 16&ndash;17 (2011)</p></li>
      <li><p class="text-gray-300">47. Wegener, I.: The complexity of Boolean functions. Wiley-Teubner (1987)</p></li>
      <li><p class="text-gray-300">48. Wheeler, D.J., Needham, R.M.: TEA, a Tiny Encryption Algorithm. In: Fast Software Encryption - FSE'94. LNCS, vol. 1008, pp. 363&ndash;366. Springer (1994)</p></li>
      <li><p class="text-gray-300">49. Wu, W., Zhang, L.: LBlock: A lightweight block cipher. In: Applied Cryptography and Network Security - ACNS 2011. LNCS, vol. 6715, pp. 327&ndash;344 (2011)</p></li>
    </ul>

    </section>
`;
---

<BaseLayout title="Construction of Lightweight S-Boxes using Feistel and MISTY ... (2015/711)">
  <article class="max-w-4xl mx-auto article-prose">
    <nav class="mb-8">
      <a href="/papers" class="text-blue-400 hover:text-blue-300">
        &larr; Back to Papers
      </a>
    </nav>

    <header class="mb-12">
      <h1 class="text-3xl font-bold mb-4"
        set:html={TITLE_HTML} />
      <p class="text-gray-400 mb-2"
        set:html={AUTHORS_HTML} />
      <p class="text-gray-500 text-sm mb-4">
        2015 &middot; eprint 2015/711
      </p>
      <div class="flex gap-4 text-sm">
        <a
          href={EPRINT_URL}
          target="_blank"
          rel="noopener noreferrer"
          class="text-blue-400 hover:text-blue-300"
        >
          Paper (eprint) &rarr;
        </a>
      </div>
      <PaperDisclaimer eprintUrl={EPRINT_URL} />
      <p class="mt-1 text-xs text-gray-600">
        Converted with: {CRAWLER} &middot; {CONVERTED_DATE}
      </p>
    </header>

    <nav id="toc" class="mb-10 p-6 rounded-lg" style="background: rgba(255,255,255,0.03); border: 1px solid rgba(255,255,255,0.06);">
      <h2 class="text-lg font-bold mb-4">Table of Contents</h2>
      <ol class="space-y-1 text-sm text-gray-300
        list-decimal list-inside">
        <li><a href="#sec-1" class="hover:text-white">Introduction</a></li>
        <li>
          <a href="#sec-2" class="hover:text-white">From keyed constructions to unkeyed S-Boxes</a>
          <ol class="ml-6 mt-1 space-y-1 list-decimal
            list-inside text-gray-400">
            <li><a href="#sec-2.1" class="hover:text-white">Main cryptographic properties for an S-Box</a></li>
            <li><a href="#sec-2.2" class="hover:text-white">Constructing S-Boxes from smaller ones</a></li>
          </ol>
        </li>
        <li>
          <a href="#sec-3" class="hover:text-white">S-Boxes obtained from 3 rounds of MISTY</a>
          <ol class="ml-6 mt-1 space-y-1 list-decimal
            list-inside text-gray-400">
            <li><a href="#sec-3.1" class="hover:text-white">Our results</a></li>
            <li><a href="#sec-3.2" class="hover:text-white">Differential uniformity of 3 rounds of MISTY</a></li>
            <li><a href="#sec-3.3" class="hover:text-white">Linearity of 3 rounds of MISTY</a></li>
          </ol>
        </li>
        <li>
          <a href="#sec-4" class="hover:text-white">Application to 8-bit S-Boxes</a>
          <ol class="ml-6 mt-1 space-y-1 list-decimal
            list-inside text-gray-400">
            <li><a href="#sec-4.1" class="hover:text-white">Differential uniformity</a></li>
            <li><a href="#sec-4.2" class="hover:text-white">Linearity</a></li>
          </ol>
        </li>
        <li>
          <a href="#sec-5" class="hover:text-white">S-Boxes obtained from a 3-round Feistel network</a>
          <ol class="ml-6 mt-1 space-y-1 list-decimal
            list-inside text-gray-400">
            <li><a href="#sec-5.1" class="hover:text-white">Differential uniformity of a 3-round Feistel construction</a></li>
            <li><a href="#sec-5.2" class="hover:text-white">Linearity of a 3-round Feistel construction</a></li>
          </ol>
        </li>
        <li>
          <a href="#sec-6" class="hover:text-white">Constructions</a>
          <ol class="ml-6 mt-1 space-y-1 list-decimal
            list-inside text-gray-400">
            <li><a href="#sec-6.1" class="hover:text-white">Feistel network with low gate count and instruction count</a></li>
            <li><a href="#sec-6.2" class="hover:text-white">Unbalanced MISTY structure</a></li>
          </ol>
        </li>
        <li><a href="#sec-7" class="hover:text-white">Conclusion</a></li>
      </ol>
      <p class="text-xs text-gray-500 mt-4 mb-1 font-semibold">
        Additional
      </p>
      <ul class="space-y-1 text-sm text-gray-400
        list-disc list-inside">
        <li><a href="#references" class="hover:text-white">References</a></li>
      </ul>
    </nav>


    <Fragment set:html={CONTENT} />

    <PaperHistory slug="construction-of-lightweight-s-boxes-using-feistel-and-misty-2015" />
  </article>
</BaseLayout>
