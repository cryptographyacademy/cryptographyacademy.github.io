---
import BaseLayout from '../../layouts/BaseLayout.astro';

const EPRINT_URL = 'https://eprint.iacr.org/2015/666';
const CRAWLER = 'mistral';
const CONVERTED_DATE = '2026-02-16';
const TITLE_HTML = 'Improved Linear Hull Attack on Round-Reduced \\textsc{Simon} with Dynamic Key-guessing Techniques';
const AUTHORS_HTML = 'Huaifeng Chen, Xiaoyun Wang';

const CONTENT = `    <p class="text-gray-300">Huaifeng Chen [ Key Laboratory of Cryptologic Technology and Information Security, Ministry of Education, Shandong University, Jinan 250100, China ] Xiaoyun Wang [ Corresponding Author Key Laboratory of Cryptologic Technology and Information Security, Ministry of Education, Shandong University, Jinan 250100, China hfchen@mail.sdu.edu.cn, xiaoyunwang@mail.tsinghua.edu.cn ]</p>

    <h6 id="sec-2" class="text-base font-medium mt-4">Abstract</h6>

    <p class="text-gray-300">Simon is a lightweight block cipher family proposed by NSA in 2013. It has drawn many cryptanalysts’ attention and varieties of cryptanalysis results have been published, including differential, linear, impossible differential, integral cryptanalysis and so on. In this paper, we give the improved linear attacks on all reduced versions of Simon with dynamic key-guessing technique, which was proposed to improve the differential attack on Simon recently. By establishing the boolean function of parity bit in the linear hull distinguisher and reducing the function according to the property of AND operation, we can guess different subkeys (or equivalent subkeys) for different situations, which decrease the number of key bits involved in the attack and decrease the time complexity in a further step. As a result, 23-round Simon32/64, 24-round Simon48/72, 25-round Simon48/96, 30-round Simon64/96, 31-round Simon64/128, 37-round Simon96/96, 38-round Simon96/144, 49-round Simon128/128, 51-round Simon128/192 and 53-round Simon128/256 can be attacked. As far as we know, our attacks on most reduced versions of Simon are the best compared with the previous cryptanalysis results. However, this does not shake the security of Simon family with full rounds.</p>

    <h2 id="sec-3" class="text-2xl font-bold">1 Introduction</h2>

    <p class="text-gray-300">In 2013, NSA proposed a new family of lightweight block cipher with Feistel structure, named as Simon, which is tuned for optimal performance in hardware applications <em>[1]</em>. The Simon family consists of various block and key sizes to match different application requirements. There is no S-box in the round function. The round function consists of AND, rotation and Xor (ARX structure), leading to a low-area hardware requirement.</p>

    <p class="text-gray-300">Related Works. Simon family has attracted a lot of cryptanalysts’ attention since its proposition. Many cryptanalysis results on various versions of Simon were published. For differential attack, Alkhzaimi and Lauridsen <em>[13]</em> gave the first differential attacks on all versions of Simon. The attacks cover 16, 18, 24, 29, 40 rounds for the versions with block size 32, 48, 64, 96 and 128 respectively. At FSE 2014, Abed et al. <em>[9]</em> gave differential attack on variants of Simon reduced to 18, 19, 26, 35, 46 rounds with respective block size 32, 48, 64, 96 and 128. At the same time, Biryukov et al. <em>[10]</em> gave differential attack on several versions of Simon independently. And 19-round Simon32, 20-round Simon48, 26-round Simon64 were attacked. Then Wang et al. <em>[14]</em> proposed better differential attacks with existing differentials, using dynamic key-guessing techniques. As a result, 21-round Simon32/64, 23-round Simon48/72, 24-round Simon48/96, 28-round Simon64/96, 29-round Simon64/128, 37-round Simon96/96, 37-round Simon96/144, 49-round Simon128/128, 49-round Simon128/192, 50-round Simon128/256 were attacked.</p>

    <p class="text-gray-300">For the earlier linear cryptanalysis, 11, 14, 16, 20, 23-round key recovery attacks on Simon with block size 32, 48, 64, 96, 128 were presented in <em>[8]</em>. Then, Alizadeh et al. <em>[15]</em> improved the linear attacks on 13-round Simon32, 15-round Simon48, 19-round Simon64, 28-round Simon96, 35-round Simon128. Recently, Abdelraheem et al. <em>[6]</em> took advantage of the links between linear characteristics and differential characteristics for Simon and found some linear distinguishers using differential characteristics found earlier. They presented various linear attacks on Simon with linear, multiple linear, linear hull cryptanalysis. The linear hull cryptanalysis has better attack results, which can attack 21-round Simon32/64, 20-round Simon48/72, 21-round Simon48/96, 27-round Simon64/96, 29-round Simon64/128, 36-round Simon96/144,</p>

    <p class="text-gray-300">48-round SIMON128/192 and 50-round SIMON128/256. Then, with the Mixed-integer Linear Programming based technique, Shi et al. [7] searched new linear trails and linear hulls, and 21, 21, 29 rounds for SIMON32/64, SIMON48/96, SIMON64/128 were attacked respectively. Also, Sun et al. [12] found a 16-round linear hull distinguisher of SIMON48, with which he attacked 23-round SIMON48/96. Ashur [20] introduced a new way to calculate the correlations of short linear hulls and provided a more accurate estimation for some previously published linear trails. He gave multiple linear cryptanalysis on 24-round SIMON32/64, 23-round SIMON48/72, 24-round SIMON48/96, 24-round SIMON64/96 and 25-round SIMON64/128. However, it uses the correlation when all the subkeys are zero as the expected correlation under random key situations, which is not exact. Moreover, if the potential of each linear hull of the cipher is smaller than that of random permutations, then the combination of these linear hulls can not distinguish between the cipher and a random permutation.</p>

    <p class="text-gray-300">Table 1: Summary of Linear Hull Attacks on SIMON</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Cipher</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Total Rounds</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Attacked rounds</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Data</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Time</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Reference</th>

          </tr>

        </thead>

        <tbody>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">SIMON32/64</td>

            <td class="px-3 py-2 border-b border-gray-700">32</td>

            <td class="px-3 py-2 border-b border-gray-700">21</td>

            <td class="px-3 py-2 border-b border-gray-700">230.56</td>

            <td class="px-3 py-2 border-b border-gray-700">255.56</td>

            <td class="px-3 py-2 border-b border-gray-700">[6]</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">21</td>

            <td class="px-3 py-2 border-b border-gray-700">-a</td>

            <td class="px-3 py-2 border-b border-gray-700">-</td>

            <td class="px-3 py-2 border-b border-gray-700">[7]</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">23</td>

            <td class="px-3 py-2 border-b border-gray-700">231.19</td>

            <td class="px-3 py-2 border-b border-gray-700">257.19TWOb+261.84Ac+256Ed</td>

            <td class="px-3 py-2 border-b border-gray-700">Section 4.2</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">SIMON48/72</td>

            <td class="px-3 py-2 border-b border-gray-700">36</td>

            <td class="px-3 py-2 border-b border-gray-700">20</td>

            <td class="px-3 py-2 border-b border-gray-700">244.11</td>

            <td class="px-3 py-2 border-b border-gray-700">270.61</td>

            <td class="px-3 py-2 border-b border-gray-700">[6]</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">24</td>

            <td class="px-3 py-2 border-b border-gray-700">247.92</td>

            <td class="px-3 py-2 border-b border-gray-700">269.92ONEb+267.89A+256E</td>

            <td class="px-3 py-2 border-b border-gray-700">Appendix B</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">SIMON48/96</td>

            <td class="px-3 py-2 border-b border-gray-700">36</td>

            <td class="px-3 py-2 border-b border-gray-700">21</td>

            <td class="px-3 py-2 border-b border-gray-700">244.11</td>

            <td class="px-3 py-2 border-b border-gray-700">270.61</td>

            <td class="px-3 py-2 border-b border-gray-700">[6]</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">21</td>

            <td class="px-3 py-2 border-b border-gray-700">-</td>

            <td class="px-3 py-2 border-b border-gray-700">-</td>

            <td class="px-3 py-2 border-b border-gray-700">[7]</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">23</td>

            <td class="px-3 py-2 border-b border-gray-700">247.92</td>

            <td class="px-3 py-2 border-b border-gray-700">292.92</td>

            <td class="px-3 py-2 border-b border-gray-700">[12]</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">25</td>

            <td class="px-3 py-2 border-b border-gray-700">247.92</td>

            <td class="px-3 py-2 border-b border-gray-700">291.92TWO+289.89A+280E</td>

            <td class="px-3 py-2 border-b border-gray-700">Appendix B</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">SIMON64/96</td>

            <td class="px-3 py-2 border-b border-gray-700">42</td>

            <td class="px-3 py-2 border-b border-gray-700">27</td>

            <td class="px-3 py-2 border-b border-gray-700">262.53</td>

            <td class="px-3 py-2 border-b border-gray-700">288.53</td>

            <td class="px-3 py-2 border-b border-gray-700">[6]</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">30</td>

            <td class="px-3 py-2 border-b border-gray-700">263.53</td>

            <td class="px-3 py-2 border-b border-gray-700">289.53ONE+293.62A+288E</td>

            <td class="px-3 py-2 border-b border-gray-700">Appendix B</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">SIMON64/128</td>

            <td class="px-3 py-2 border-b border-gray-700">44</td>

            <td class="px-3 py-2 border-b border-gray-700">29</td>

            <td class="px-3 py-2 border-b border-gray-700">262.53</td>

            <td class="px-3 py-2 border-b border-gray-700">2123.53</td>

            <td class="px-3 py-2 border-b border-gray-700">[6]</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">29</td>

            <td class="px-3 py-2 border-b border-gray-700">-</td>

            <td class="px-3 py-2 border-b border-gray-700">-</td>

            <td class="px-3 py-2 border-b border-gray-700">[7]</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">31</td>

            <td class="px-3 py-2 border-b border-gray-700">263.53</td>

            <td class="px-3 py-2 border-b border-gray-700">2115.53TWO+2119.62A+2120E</td>

            <td class="px-3 py-2 border-b border-gray-700">Appendix B</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">SIMON96/96</td>

            <td class="px-3 py-2 border-b border-gray-700">52</td>

            <td class="px-3 py-2 border-b border-gray-700">37</td>

            <td class="px-3 py-2 border-b border-gray-700">295.2</td>

            <td class="px-3 py-2 border-b border-gray-700">267.94A+288E</td>

            <td class="px-3 py-2 border-b border-gray-700">Appendix B</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">SIMON96/144</td>

            <td class="px-3 py-2 border-b border-gray-700">54</td>

            <td class="px-3 py-2 border-b border-gray-700">36</td>

            <td class="px-3 py-2 border-b border-gray-700">294.2</td>

            <td class="px-3 py-2 border-b border-gray-700">2123.5</td>

            <td class="px-3 py-2 border-b border-gray-700">[6]</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">38</td>

            <td class="px-3 py-2 border-b border-gray-700">295.2</td>

            <td class="px-3 py-2 border-b border-gray-700">2126.2ONE+298.94A+2136E</td>

            <td class="px-3 py-2 border-b border-gray-700">Appendix B</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">SIMON128/128</td>

            <td class="px-3 py-2 border-b border-gray-700">68</td>

            <td class="px-3 py-2 border-b border-gray-700">49</td>

            <td class="px-3 py-2 border-b border-gray-700">2127.6</td>

            <td class="px-3 py-2 border-b border-gray-700">287.77A+2120E</td>

            <td class="px-3 py-2 border-b border-gray-700">Appendix B</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">SIMON128/192</td>

            <td class="px-3 py-2 border-b border-gray-700">69</td>

            <td class="px-3 py-2 border-b border-gray-700">48</td>

            <td class="px-3 py-2 border-b border-gray-700">2126.6</td>

            <td class="px-3 py-2 border-b border-gray-700">2187.6</td>

            <td class="px-3 py-2 border-b border-gray-700">[6]</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">51</td>

            <td class="px-3 py-2 border-b border-gray-700">2127.6</td>

            <td class="px-3 py-2 border-b border-gray-700">2165ONE+2155.77A+2184E</td>

            <td class="px-3 py-2 border-b border-gray-700">Appendix B</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">SIMON128/256</td>

            <td class="px-3 py-2 border-b border-gray-700">72</td>

            <td class="px-3 py-2 border-b border-gray-700">50</td>

            <td class="px-3 py-2 border-b border-gray-700">2126.6</td>

            <td class="px-3 py-2 border-b border-gray-700">2242.6</td>

            <td class="px-3 py-2 border-b border-gray-700">[6]</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">53</td>

            <td class="px-3 py-2 border-b border-gray-700">2127.6</td>

            <td class="px-3 py-2 border-b border-gray-700">2249ONE+2239.77A+2248E</td>

            <td class="px-3 py-2 border-b border-gray-700">Appendix B</td>

          </tr>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">a  <span class="math">\\cdot</span>  means not given b TWO means two rounds encryption or decryption <span class="math">c</span>  A means addition <span class="math">d</span>  E means encryption of attacked rounds <span class="math">e</span>  ONE means one round encryption or decryption</p>

    <p class="text-gray-300">Also, there are some results with other attack models, such as impossible differential cryptanalysis [15-18], zero-correlation cryptanalysis [16] and integral cryptanalysis [16].</p>

    <p class="text-gray-300">Our Contributions. In this paper, we give the improved linear hull attacks on all reduced versions of SIMON family with dynamic key-guessing technique, which was proposed initially to improve the differential attack on SIMON [14], using existing linear hull distinguishers. In linear attack, one important point is to compute the empirical correlations (bias) of the parity bit, which derives from the Xor-sum of the active bits at both sides of the linear hull distinguisher, under some key guess. Our attack on SIMON improves this procedure efficiently.</p>

    <p class="text-gray-300">The non-linear part in the round function of SIMON is mainly derived from the bitwise AND (&amp;) operation while it has a significant feature. For details, if one of the two elements is equal to zero, the result of their AND will be zero, no matter what value the other element takes. For a function  <span class="math">f = f_{1}(x_{1},k_{1})\\&amp;amp; f_{2}(x_{2},k_{2})</span> , if we</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">GUESS <span class="math">k_{1}</span> at first, and SPLIT the all $x=x_{1}</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">x_{2}<span class="math"> into two cases: case 1, </span>f_{1}(x_{1},k_{1})=0<span class="math">; case 2, </span>f_{1}(x_{1},k_{1})=1<span class="math">, there is no need to guess the key bits </span>k_{2}<span class="math"> in case 1, since </span>f=0<span class="math"> holds for any value of </span>f_{2}<span class="math"> in case 1. Then, we can compute the correlations in each case with less time and at last, we COMBINE the two correlations together for corresponding key </span>k=k_{1}</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">k_{2}$.</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">At first, we give the boolean representations for the parity bit in the linear distinguisher of Simon. And then we apply the GUESS, SPLIT and COMBINE technique in the calculation of the empirical correlations, which mainly exploits the dynamic key-guessing idea to reduce the number of subkey bits guessed significantly. For example, in the attack on 21-round Simon32, 32 subkey bits are involved. With above technique, we can only guess 12.5 bits from the total 32-bit subkey on average to compute the correlations.</p>

    <p class="text-gray-300">As a result, the improved attack results are shown as follows. We can attack 23-round Simon32/64, 24-round Simon48/72, 25-round Simon48/96, 30-round Simon64/96, 31-round Simon64/128, 37-round Simon96/96, 38-round Simon96/144, 49-round Simon128/128, 51-round Simon128/192 and 53-round Simon128/256. This improves the linear attack results for all versions. From the point of number of rounds attacked, the results on most versions are best up to now. The existing and new linear hull attack results on Simon are summarized in Table 1. Also, we implement the 21-round attack on Simon32. In the attack, we can decrease the 32 subkey bits involved in the attack by 8 bits. The experiments show that the attack success probability is about 27.7% using <span class="math">2^{31.19}</span> plaintext-ciphertext pairs.</p>

    <p class="text-gray-300">The paper is organised as follows. In section 2, we introduce the linear (hull) cryptanalysis and give the description of Simon family. Section 3 gives the dynamic key-guessing technique used in the linear cryptanalysis. Then the improved attacks on Simon32/64 and all other variants are given in section 4. Finally, we conclude in section 5. Appendix A gives the time complexities to calculate the empirical correlations in some simple situations. In Appendix B, we give the improved attacks on other variants of Simon. The source code of the implementation of 21-round attack on Simon32 is given in Appendix C.</p>

    <h2 id="sec-4" class="text-2xl font-bold">2 Preliminaries</h2>

    <h3 id="sec-5" class="text-xl font-semibold mt-8">2.1 Linear Cryptanalysis and Linear Hull</h3>

    <p class="text-gray-300"><span class="math">\\mathbb{F}_{2}</span> denotes the field with two elements and <span class="math">\\mathbb{F}_{2}^{n}</span> is the <span class="math">n</span>-dimensional vector space of <span class="math">\\mathbb{F}_{2}</span>. Let <span class="math">g:\\mathbb{F}_{2}^{n}\\rightarrow\\mathbb{F}_{2}</span> be a Boolean function. Let <span class="math">B(g)=\\sum_{x\\in\\mathbb{F}_{2}^{n}}(-1)^{g(x)}</span>. The correlation <span class="math">c(g)</span> of <span class="math">g</span> and <span class="math">0</span> (in the following paper, when we say the correlation of a function, it means the correlation of this function and <span class="math">0</span>) is defined by</p>

    <p class="text-gray-300"><span class="math">c(g)=2^{-n}\\sum_{x\\in\\mathbb{F}_{2}^{n}}(-1)^{g(x)}=2^{-n}B(g).</span> (1)</p>

    <p class="text-gray-300">(In some situations of the remainder of this paper, we regard <span class="math">B(g)</span> as the correlation for simplicity of description.) The bias of <span class="math">g</span> is defined by half of <span class="math">c(g)</span>, which is represented as <span class="math">\\epsilon(g)=\\frac{1}{2}c(g)</span>.</p>

    <p class="text-gray-300">Linear cryptanalysis <em>[2]</em> is a powerful cryptanalytic method proposed in 1993 to cryptanalysis DES. At first, one tries to find a good linear approximation involving some plaintext bits, ciphertext bits and the subkey bits as follows</p>

    <p class="text-gray-300"><span class="math">\\alpha\\cdot P\\oplus\\beta\\cdot C=\\gamma\\cdot K,</span> (2)</p>

    <p class="text-gray-300">where <span class="math">\\alpha,\\beta,\\gamma</span> are masks and <span class="math">P,C,K</span> represent the plaintext, ciphertext and keys. ’good’ means that the probability of the linear approximations is far away from <span class="math">1/2</span>, which is the probability in random situations. In other words, higher absolute of bias <span class="math">\\epsilon(\\alpha\\cdot P\\oplus\\beta\\cdot C\\oplus\\gamma\\cdot K)</span> leads to better linear crypanalysis result in general. Algorithm 1 and Algorithm 2 in <em>[2]</em> are two attack models exploiting the linear approximation as distinguisher. <span class="math">\\mathcal{O}(\\frac{1}{\\epsilon^{2}})</span> known plaintexts are needed in the key-recovery attacks.</p>

    <p class="text-gray-300">Then in 1994, Nyberg <em>[4]</em> studied the linear approximations with same input mask <span class="math">\\alpha</span> and output mask <span class="math">\\beta</span>, and denoted them as linear hull. The potential of a linear hull is defined as</p>

    <p class="text-gray-300"><span class="math">ALH(\\alpha,\\beta)=\\sum_{\\gamma}\\epsilon^{2}(\\alpha\\cdot P\\oplus\\beta\\cdot C\\oplus\\gamma\\cdot K)=\\bar{\\epsilon}^{2}.</span> (3)</p>

    <p class="text-gray-300">The effect of linear hull is that the final bias <span class="math">\\bar{\\epsilon}</span> may become significantly higher than that of any individual linear trail. Then the linear attacks with linear hull require less known plaintexts, i.e., <span class="math">\\mathcal{O}(\\frac{1}{\\bar{\\epsilon}^{2}})</span></p>

    <p class="text-gray-300">Selçuk and Biçak <em>[5]</em> gave the estimation of success probability in linear attack for achieving a desired advantage level. The advantage is the complexity reduction over the exhaustive search. For example, if <span class="math">m</span>-bit key is attacked and the right key is ranked <span class="math">t</span>-th among all <span class="math">2^{m}</span> candidates, the advantage of this attack is <span class="math">m-log_{2}(t)</span>. Theorem 2 in <em>[5]</em> described the relation between success rate, advantage and number of data samples.</p>

    <h6 id="sec-6" class="text-base font-medium mt-4">Theorem 1 (Theorem 2 in <em>[5]</em>).</h6>

    <p class="text-gray-300">Let <span class="math">P_{S}</span> be the probability that a linear attack, as defined by Algorithm-2 in <em>[2]</em>, where all candidates are tried for an <span class="math">m</span>-bit subkey, in an approximation of probability <span class="math">p</span>, with <span class="math">N</span> known plaintext blocks, delivers an <span class="math">a</span>-bit or higher advantage. Assuming that the approximation’s probablity is independent for each key tried and is equal to <span class="math">1/2</span> for all wrong keys, we have, for sufficiently large <span class="math">m</span> and <span class="math">N</span>,</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">$P_{S}=\\int_{-2\\sqrt{N}</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">p-1/2</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">+\\Phi^{-1}(1-2^{-a-1})}^{\\infty}\\phi(x)dx,$ (4)</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">independent of <span class="math">m</span>.</p>

    <h3 id="sec-7" class="text-xl font-semibold mt-8">2.2 Description of Simon</h3>

    <p class="text-gray-300">Simon is a family of lightweight block cipher with Feistel structure designed by NSA, which is tuned for optimal performance in hardware applications <em>[1]</em>. The Simon block cipher with an <span class="math">n</span>-bit word (hence <span class="math">2n</span>-bit block) is denoted Simon<span class="math">2n</span>, where <span class="math">n</span> is limited to be 16, 24, 32, 48 or 64. The key length is required to be <span class="math">mn</span> where <span class="math">m</span> takes value from 2, 3 and 4. Simon<span class="math">2n</span> with <span class="math">m</span>-word key is referred to Simon<span class="math">2n/mn</span>. There are ten versions in the Simon family and the detailed parameters are listed in Table 2.</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">block size (<span class="math">2n</span>)</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">key size (<span class="math">mn</span>)</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">rounds</th>

          </tr>

        </thead>

        <tbody>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">32 (<span class="math">n=16</span>)</td>

            <td class="px-3 py-2 border-b border-gray-700">64 (<span class="math">m=4</span>)</td>

            <td class="px-3 py-2 border-b border-gray-700">32</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">48 (<span class="math">n=24</span>)</td>

            <td class="px-3 py-2 border-b border-gray-700">72 (<span class="math">m=3</span>)</td>

            <td class="px-3 py-2 border-b border-gray-700">36</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">96 (<span class="math">m=4</span>)</td>

            <td class="px-3 py-2 border-b border-gray-700">36</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">64 (<span class="math">n=32</span>)</td>

            <td class="px-3 py-2 border-b border-gray-700">96 (<span class="math">m=3</span>)</td>

            <td class="px-3 py-2 border-b border-gray-700">42</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">128 (<span class="math">m=4</span>)</td>

            <td class="px-3 py-2 border-b border-gray-700">44</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">96 (<span class="math">n=48</span>)</td>

            <td class="px-3 py-2 border-b border-gray-700">96 (<span class="math">m=2</span>)</td>

            <td class="px-3 py-2 border-b border-gray-700">52</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">144 (<span class="math">m=3</span>)</td>

            <td class="px-3 py-2 border-b border-gray-700">54</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">128 (<span class="math">n=64</span>)</td>

            <td class="px-3 py-2 border-b border-gray-700">128 (<span class="math">m=2</span>)</td>

            <td class="px-3 py-2 border-b border-gray-700">68</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">192 (<span class="math">m=3</span>)</td>

            <td class="px-3 py-2 border-b border-gray-700">69</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">256 (<span class="math">m=4</span>)</td>

            <td class="px-3 py-2 border-b border-gray-700">72</td>

          </tr>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">Table 2: The Simon Family Block Ciphers</p>

    <p class="text-gray-300">!<a href="img-0.jpeg">img-0.jpeg</a> Figure 1: Round Function of Simon</p>

    <p class="text-gray-300">Before introducing the round functions of Simon, we give some notations of symbols used throughout this paper.</p>

    <p class="text-gray-300"><span class="math">X^{r}</span> <span class="math">2n</span>-bit output of round <span class="math">r</span> (input of round <span class="math">r+1</span>)</p>

    <p class="text-gray-300"><span class="math">X^{r}_{L}</span> left half <span class="math">n</span>-bit of <span class="math">X^{r}</span></p>

    <p class="text-gray-300"><span class="math">X^{r}_{R}</span> right half <span class="math">n</span>-bit of <span class="math">X^{r}</span></p>

    <p class="text-gray-300"><span class="math">K^{r}</span> subkey used in round <span class="math">r+1</span></p>

    <p class="text-gray-300"><span class="math">x_{i}</span> the <span class="math">i</span>-th bit of <span class="math">x</span>, begin with bit 0 from right (e.g., <span class="math">X^{r}_{L,0}</span> is the LSB of <span class="math">X^{r}_{L}</span> )</p>

    <p class="text-gray-300"><span class="math">x_{i_{1},\\ldots,i_{t}}</span> the XOR-sum of <span class="math">x_{i}</span> for <span class="math">i=i_{1},i_{2},\\ldots,i_{t}</span> (e.g., <span class="math">x_{0,1}=x_{0}\\oplus x_{1}</span>)</p>

    <p class="text-gray-300"><span class="math">x\\lll i</span> left circulant shift by <span class="math">i</span> bits of <span class="math">x</span></p>

    <p class="text-gray-300"><span class="math">\\oplus</span> bitwise XOR</p>

    <p class="text-gray-300"><span class="math">\\&amp;</span> bitwise AND</p>

    <p class="text-gray-300"><span class="math">F(x)</span> <span class="math">F(x)=((x\\lll 1)\\&amp;(x\\lll 8))\\oplus(x\\lll 2)</span></p>

    <p class="text-gray-300">The <span class="math">r</span>-th round function of Simon<span class="math">2n</span> is a Feistel map</p>

    <p class="text-gray-300"><span class="math">F_{K^{r-1}}:\\mathbb{F}_{2}^{n}\\times\\mathbb{F}_{2}^{n}\\rightarrow\\mathbb{F}_{2}^{n}\\times\\mathbb{F}_{2}^{n},</span></p>

    <p class="text-gray-300"><span class="math">(X^{r-1}_{L},X^{r-1}_{R})\\rightarrow(X^{r}_{L},X^{r}_{R})</span></p>

    <p class="text-gray-300"><span class="math">X_{R}^{r}=X_{L}^{r-1}</span> and <span class="math">X_{L}^{r}=F(X_{L}^{r-1})\\oplus X_{R}^{r-1}\\oplus K^{r-1}</span>. The round function of Simon is depicted in Figure 1. Suppose the number of rounds is <span class="math">T</span>, the whole encryption of Simon is the composition <span class="math">F_{K^{T-1}\\circ\\cdots\\circ F_{K^{1}}\\circ F_{K^{0}}}</span>. The subkeys are derived from the master key. The key schedules are a little different depending on the key size. However, the master key can be derived from any <span class="math">m</span> consecutive subkeys. Please refer to <em>[1]</em> for more details.</p>

    <h2 id="sec-8" class="text-2xl font-bold">3 Time Reduction in Linear Cryptanalysis for Bit-Oriented Block Cipher</h2>

    <p class="text-gray-300">For bit-oriented block cipher, such as Simon, the operations of round function can be seen as the concatenation of some boolean functions. For example, in Simon32, the 0-th bit of <span class="math">X_{L}^{r}</span> is a boolean function of some bits of <span class="math">X^{r-1}</span> and subkeys as follows,</p>

    <p class="text-gray-300"><span class="math">X_{L,0}^{r}=(X_{L,15}^{r-1}\\&amp;X_{L,8}^{r-1})\\oplus X_{L,14}^{r-1}\\oplus X_{R,0}^{r-1}\\oplus K_{0}^{r-1}.</span> (5)</p>

    <p class="text-gray-300">Other bits in <span class="math">X_{L}^{r}</span> have similar boolean representations and the bits in <span class="math">X_{R}^{r}</span> are same with the bits in <span class="math">X_{L}^{r-1}</span>. The boolean representation of one bit can be extended to multiple rounds.</p>

    <h3 id="sec-9" class="text-xl font-semibold mt-8">3.1 Linear Compression</h3>

    <p class="text-gray-300">In Matsui’s improved linear cryptanalysis <em>[3]</em>, the attacker can pre-construct a table to store the plaintexts and ciphertexts. We call this pre-construction procedure as linear compression, since the purpose is to reduce the size of efficient states by compressing the linear part. The detail of the compression is as follows.</p>

    <p class="text-gray-300">Suppose <span class="math">x</span> is a <span class="math">l_{1}</span>-bit value derived from the <span class="math">n</span>-bit plaintext or ciphertext and <span class="math">k</span> is a <span class="math">l_{2}</span>-bit value derived from the subkey. <span class="math">y\\in\\mathbb{F}_{2}</span> is a boolean function of <span class="math">x</span> and <span class="math">k</span>, <span class="math">y=f(x,k)</span>. Let <span class="math">V[x]</span> stores the count number of <span class="math">x</span>. We define <span class="math">B^{k}(y)</span> with counter vector <span class="math">V</span> and function <span class="math">y=f(x,k)</span> for <span class="math">k</span> as</p>

    <p class="text-gray-300"><span class="math">B^{k}(y)=\\sum_{x}(-1)^{f(x,k)}V[x].</span> (6)</p>

    <p class="text-gray-300">So, <span class="math">B^{k}(y)</span> is the correlation of <span class="math">y</span> with <span class="math">x</span> under key guess <span class="math">k</span>. One needs to do <span class="math">2^{l_{1}+l_{2}}</span> computations of function <span class="math">f</span> to calculate the correlations of <span class="math">y</span> for all <span class="math">k</span> with a straight-forward method at most. If <span class="math">y</span> is linear with some bits of <span class="math">x</span> and <span class="math">k</span>, the time can be decreased.</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">For simplicity, let $x=x^{\\prime}</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">x_{0}<span class="math">, </span>k=k^{\\prime}</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">k_{0}<span class="math"> and </span>y=x_{0}\\oplus k_{0}\\oplus f_{1}(x^{\\prime},k^{\\prime})<span class="math">, where both </span>x_{0}<span class="math"> and </span>k_{0}<span class="math"> are single bits. The correlation of </span>y<span class="math"> under some </span>k$ is</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">$B^{k}(y)=(-1)^{k_{0}}\\sum_{x^{\\prime}}(-1)^{f_{1}(x^{\\prime},k^{\\prime})}(V[x^{\\prime}</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">0]-V[x^{\\prime}</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">1]).$ (7)</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">It is obvious the correlations of <span class="math">y</span> under same <span class="math">k^{\\prime}</span> and different <span class="math">k_{0}</span> have same absolute value, and they are different just in the sign. So if we compress the <span class="math">x_{0}</span> bit at first according to $V^{\\prime}[x^{\\prime}]=V[x^{\\prime}</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">0]-V[x^{\\prime}</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">1]<span class="math">, </span>B^{k^{\\prime}}(y^{\\prime})<span class="math"> with counter vertor </span>V^{\\prime}<span class="math"> and function </span>y^{\\prime}=g^{\\prime}(x^{\\prime},k^{\\prime})<span class="math"> for </span>k^{\\prime}<span class="math"> can be computed with </span>2^{l_{1}+l_{2}-2}<span class="math"> calculations of </span>f_{1}<span class="math">. And the correlation </span>B^{k}(y)<span class="math"> can be derived directly from </span>B^{k}(y)=(-1)^{k_{0}}B^{k^{\\prime}}(y^{\\prime})<span class="math">. We define </span>k_{0}<span class="math"> the related bit. If the absolute correlations are desired, the related bit </span>k_{0}$ can be omitted directly, since it has no effect on the absolute values.</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">If <span class="math">y</span> is linear with multiple bits of <span class="math">x</span> and <span class="math">k</span>, the linear bits can be combined at first, then above linear compression can be applied. For example, <span class="math">y=(x_{0}\\oplus k_{0})\\oplus\\cdots\\oplus(x_{t}\\oplus k_{t})\\oplus f_{t}(x^{\\prime\\prime},k^{\\prime\\prime})</span> where <span class="math">x^{\\prime\\prime},k^{\\prime\\prime}</span> are the other bits of <span class="math">x</span> and <span class="math">k</span> respectively. We can initialize a new counter vector $V^{\\prime}[x^{\\prime\\prime}</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">x_{0}^{\\prime}]<span class="math"> where </span>x_{0}^{\\prime}<span class="math"> is 1-bit value of the xor sum of </span>x_{0},x_{1},\\ldots,x_{t}<span class="math">. We set </span>V^{\\prime}[x^{\\prime\\prime}</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">x_{0}^{\\prime}]=\\sum_{x_{0}\\oplus\\cdots\\oplus x_{t}=x_{0}^{\\prime}}V[x]<span class="math">. Let </span>k_{0}^{\\prime}=k_{0}\\oplus\\cdots\\oplus k_{t}<span class="math">. The target value </span>y<span class="math"> becomes </span>y=x_{0}^{\\prime}\\oplus k_{0}^{\\prime}\\oplus f_{t}(x^{\\prime\\prime},k^{\\prime\\prime})<span class="math"> with counter vector </span>V^{\\prime}[x^{\\prime\\prime}</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">x_{0}^{\\prime}]$, which is the case discussed above.</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <h3 id="sec-10" class="text-xl font-semibold mt-8">3.2 Dynamic key-guessing in linear attack: Guess, Split and Combination</h3>

    <p class="text-gray-300">Suppose one want to compute <span class="math">B^{k}(y)</span> with counter vector <span class="math">V</span> and boolean function <span class="math">y=f(x,k)</span>, along with the definitions in the above section. With a straight-forward method, the time to compute <span class="math">B^{k}(y)</span> is <span class="math">2^{l_{1}+l_{2}}</span></p>

    <p class="text-gray-300">!<a href="img-1.jpeg">img-1.jpeg</a> Fig. 2: When  <span class="math">k_{G}</span>  is known, the set of  <span class="math">x</span>  can be split to two sets.  <span class="math">f</span>  is independent of  <span class="math">k_{B}</span>  in set  <span class="math">S_{A}</span>  and independent of  <span class="math">k_{A}</span>  in set  <span class="math">S_{B}</span> .</p>

    <p class="text-gray-300">for different values of  <span class="math">x</span> , different key bits of  <span class="math">k</span>  are involved in function  <span class="math">f(x, k)</span> , the time to calculate  <span class="math">B^{k}(y)</span>  can be decreased.</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">For simplicity, let  $k = k_{G}</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">k_{A}</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">k_{B}</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">k_{C}<span class="math"> , where  </span>k_{G}, k_{A}, k_{B}, k_{C}<span class="math">  are  </span>l_{2}^{G}, l_{2}^{A}, l_{2}^{B}<span class="math">  and  </span>l_{2}^{C}<span class="math">  bits ( </span>l_{2}^{G} + l_{2}^{A} + l_{2}^{B} + l_{2}^{C} = l_{2}<span class="math"> ) respectively. Suppose when  </span>k_{G}<span class="math">  is known, the all  </span>x<span class="math">  can be split into two sets, i.e.  </span>S_{A}<span class="math">  with  </span>N_{A}<span class="math">  elements and  </span>S_{B}<span class="math">  with  </span>N_{B}<span class="math">  elements ( </span>N_{A} + N_{B} = 2^{l_{1}}<span class="math"> ). And when  </span>x \\in S_{A}<span class="math"> ,  </span>f(x,k) = f_{A}(x,k_{A}</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">k_{C})<span class="math">  which is independent of  </span>k_{B}<span class="math"> ; when  </span>x \\in S_{B}<span class="math"> ,  </span>f(x,k) = f_{B}(x,k_{B}</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">k_{C})<span class="math">  which is independent of  </span>k_{A}<span class="math">  (See Figure 2). Then,  </span>B^{k}(y)$  can be obtained from the following combination</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <div class="my-4 text-center"><span class="math-block"></span></div>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">B ^ {k} (y) = \\sum_ {x \\in S _ {A}} (- 1) ^ {f _ {A} (x, k _ {A}</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">k _ {C})} V [ x ] + \\sum_ {x \\in S _ {B}} (- 1) ^ {f _ {B} (x, k _ {B}</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">k _ {C})} V [ x ] \\tag {8}</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <div class="my-4 text-center"><span class="math-block"></span></div>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">for some guessed  <span class="math">k_{G}</span> . The time to compute  $\\sum (-1)^{f_{A}(x,k_{A}</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">k_{C})}V[x]<span class="math">  for the  </span>x\\in S_A<span class="math">  needs  </span>N_{A}2^{l_{2}^{G} + l_{2}^{A} + l_{2}^{C}}<span class="math">  calculations, while  </span>\\sum (-1)^{f_B(x,k_B</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">k_C)}V[x]<span class="math">  for  </span>x\\in S_B<span class="math">  needs  </span>N_{B}2^{l_{2}^{G} + l_{2}^{B} + l_{2}^{C}}<span class="math"> . The combination needs  </span>2^{l_2}$  additions. So the time complexity in total is about</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <div class="my-4 text-center"><span class="math-block">N _ {A} 2 ^ {l _ {2} ^ {G} + l _ {2} ^ {A} + l _ {2} ^ {C}} + N _ {B} 2 ^ {l _ {2} ^ {G} + l _ {2} ^ {B} + l _ {2} ^ {C}} + 2 ^ {l _ {2}}</span></div>

    <p class="text-gray-300">which improves the time complexity compared with  <span class="math">2^{l_1 + l_2}</span> .</p>

    <p class="text-gray-300">The AND operation in Simon will generate the situations discussed above. Let  <span class="math">x, k \\in \\mathbb{F}_2^2</span>  and  <span class="math">y = f(x, k) = (x_0 \\oplus k_0) \\&amp;amp; (x_1 \\oplus k_1)</span> .  <span class="math">V[x]</span>  denotes the count number of  <span class="math">x</span> . With a straight-forward method, the calculation of correlations for all  <span class="math">k</span>  need time  <span class="math">2^{2 + 2} = 2^4</span> . If one side of the AND in  <span class="math">f(x, k)</span>  is 0,  <span class="math">y</span>  would be 0 without knowing the value in the other side. Exploiting this property, we can improve the time complexity for calculating the correlations. At first, we guess one bit of  <span class="math">k</span> , e.g.  <span class="math">k_0</span> . Then we split the  <span class="math">x</span>  into two sets and compute the correlations in each set. At last, we combine the correlations according to the keys guessed.</p>

    <ul class="list-disc list-inside space-y-1 text-gray-300 my-2 ml-4">

      <li>GUESS  <span class="math">k_{0}</span>  and SPLIT the  <span class="math">x</span>  into two sets</li>

    </ul>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">- For the  <span class="math">x</span>  with  <span class="math">x_0 = k_0</span> , initialize a counter  <span class="math">T_0</span>  and set  $T_0 = V[0</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">x_0] + V[1</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">x_0]$</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <ul class="list-disc list-inside space-y-1 text-gray-300 my-2 ml-4">

      <li>COMBINE  <span class="math">B(y) = T_0 + (-1)^{k_1}T_1</span>  ( <span class="math">k_1</span>  is a related bit)</li>

    </ul>

    <p class="text-gray-300">So in total, it needs  <span class="math">2(1 + 1 + 2) = 2^3</span>  additions to compute the correlations for all the  <span class="math">k</span> , which improves the time complexity compared to the straight-forward method. Although there are 2 bits of  <span class="math">k</span>  involved in the attack, we guess only one bit and make some computations while another bit is just involved in the final combination. This can be viewed as that we reduce the number of key bits guessed from 2 to 1. Moreover, this technique adapts to some complicated boolean functions and more key (or equivalent key) bits can be reduced significantly. Some cases have been discussed in Appendix A.</p>

    <p class="text-gray-300">In this section, we will give the improved procedure of linear attack on SIMON using existing linear hull distinguishers for all versions of SIMON</p>

    <p class="text-gray-300">Some linear hulls have been proposed recently in [6, 7, 12], and they are displayed in Table 3. Abdelraheem et al. [6] took advantage of the connection between linear- and differential- characteristics for SIMON and transformed the differential characteristics proposed in [8, 10] to linear characteristics directly. Similarly, differentials can be transformed to the linear hulls. Also, they found a new 14-round linear hull for SIMON32/64,</p>

    <p class="text-gray-300">Table 3: Linear Hulls for SIMON</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">BS</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Input Active Bits</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Output Active Bits</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">ALH</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">#R</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Ref.</th>

          </tr>

        </thead>

        <tbody>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">32</td>

            <td class="px-3 py-2 border-b border-gray-700">XL,6</td>

            <td class="px-3 py-2 border-b border-gray-700">X1+13R,14</td>

            <td class="px-3 py-2 border-b border-gray-700">2-31.69</td>

            <td class="px-3 py-2 border-b border-gray-700">13</td>

            <td class="px-3 py-2 border-b border-gray-700">[6]</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">XL,5</td>

            <td class="px-3 py-2 border-b border-gray-700">X1+13R,13</td>

            <td class="px-3 py-2 border-b border-gray-700">2-30.19</td>

            <td class="px-3 py-2 border-b border-gray-700">13</td>

            <td class="px-3 py-2 border-b border-gray-700">[7]</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">XL,0</td>

            <td class="px-3 py-2 border-b border-gray-700">X1+14L,8, X1+14R,6</td>

            <td class="px-3 py-2 border-b border-gray-700">2-32.56</td>

            <td class="px-3 py-2 border-b border-gray-700">14</td>

            <td class="px-3 py-2 border-b border-gray-700">[6]</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">48</td>

            <td class="px-3 py-2 border-b border-gray-700">XL,7, XL,11, XL,19, XR,9, XR,17</td>

            <td class="px-3 py-2 border-b border-gray-700">X1+15L,5, X1+15R,7, X1+15R,11, X1+15R,19</td>

            <td class="px-3 py-2 border-b border-gray-700">2-44.11</td>

            <td class="px-3 py-2 border-b border-gray-700">15</td>

            <td class="px-3 py-2 border-b border-gray-700">[6]</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">XL,6, XL,14, XL,18, XL,22, XR,16</td>

            <td class="px-3 py-2 border-b border-gray-700">X1+15L,4, X1+15R,6, X1+15R,18, X1+15R,20</td>

            <td class="px-3 py-2 border-b border-gray-700">2-42.28</td>

            <td class="px-3 py-2 border-b border-gray-700">15</td>

            <td class="px-3 py-2 border-b border-gray-700">[7]</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">XL,1, XL,5, XL,21, XR,23</td>

            <td class="px-3 py-2 border-b border-gray-700">X1+16L,1, X1+16R,23</td>

            <td class="px-3 py-2 border-b border-gray-700">2-44.92</td>

            <td class="px-3 py-2 border-b border-gray-700">16</td>

            <td class="px-3 py-2 border-b border-gray-700">[12]</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">64</td>

            <td class="px-3 py-2 border-b border-gray-700">XL,20, XL,24, XR,22</td>

            <td class="px-3 py-2 border-b border-gray-700">X1+21L,22, X1+21R,20, X1+21R,24</td>

            <td class="px-3 py-2 border-b border-gray-700">2-62.53</td>

            <td class="px-3 py-2 border-b border-gray-700">21</td>

            <td class="px-3 py-2 border-b border-gray-700">[6]</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">XL,6</td>

            <td class="px-3 py-2 border-b border-gray-700">X1+21L,6, X1+21R,2, X1+21R,6, X1+21R,30</td>

            <td class="px-3 py-2 border-b border-gray-700">2-60.72</td>

            <td class="px-3 py-2 border-b border-gray-700">21</td>

            <td class="px-3 py-2 border-b border-gray-700">[7]</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">XL,3, XL,27, XL,31, XR,29</td>

            <td class="px-3 py-2 border-b border-gray-700">X1+22L,3, X1+22R,1, X1+22R,2</td>

            <td class="px-3 py-2 border-b border-gray-700">2-63.83</td>

            <td class="px-3 py-2 border-b border-gray-700">22</td>

            <td class="px-3 py-2 border-b border-gray-700">[7]</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">96</td>

            <td class="px-3 py-2 border-b border-gray-700">XL,2, XL,34, XL,38, XL,42, XR,36</td>

            <td class="px-3 py-2 border-b border-gray-700">X1+30L,2, X1+30R,1, X1+30R,40, X1+30R,40</td>

            <td class="px-3 py-2 border-b border-gray-700">2-94.2</td>

            <td class="px-3 py-2 border-b border-gray-700">30</td>

            <td class="px-3 py-2 border-b border-gray-700">[6]</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">128</td>

            <td class="px-3 py-2 border-b border-gray-700">XL,2, XL,58, XL,62, XR,60</td>

            <td class="px-3 py-2 border-b border-gray-700">X1+41L,60, X1+41R,0, X1+41R,2, X1+41R,58, X1+41R,62</td>

            <td class="px-3 py-2 border-b border-gray-700">2-126.6</td>

            <td class="px-3 py-2 border-b border-gray-700">41</td>

            <td class="px-3 py-2 border-b border-gray-700">[6]</td>

          </tr>

        </tbody>

      </table>

    </div>

    <ul class="list-disc list-inside space-y-1 text-gray-300 my-2 ml-4">

      <li>BS means the block size of SIMON; #R means the number of rounds for the linear hull</li>

    </ul>

    <p class="text-gray-300">by constructing squared correlation matrix to compute the average squared correlation. Shi et al. [7] searched the linear characteristics with same input and output masks using the Mixed-integer Linear Programming modelling, which was investigated to search the differential characteristics for bit-oriented block cipher [11] and then extended to search the linear characteristics (hull) later [12].</p>

    <p class="text-gray-300">Similar to the rotational property of integral distinguishers and zero-correlation linear hull shown in [16], more linear hulls can be constructed as follows.</p>

    <p class="text-gray-300">Property 1. Assume that  <span class="math">X_{L,j_0^0}^i,\\ldots ,X_{L,j_{t_0}^0}^i,X_{R,j_0^1}^i,\\ldots ,X_{R,j_{t_1}^1}^i\\to X_{L,j_0^2}^i,\\ldots ,X_{L,j_{t_2}^2}^i,X_{R,j_0^3}^i,\\ldots ,X_{R,j_{t_3}^2}^i</span>  is a  <span class="math">r</span> -round linear hull with potential  <span class="math">\\bar{\\epsilon}^2</span>  for SIMON2n, where  <span class="math">j_0^0,\\dots ,j_{t_0}^0,j_0^1,\\dots ,j_{t_1}^1,j_0^2,\\dots ,j_{t_2}^2,j_0^3,\\dots ,j_{t_3}^3\\in \\{0,\\dots ,n-1\\}</span> . Let  <span class="math">j_q^{p,s} = (j_q^p +s)</span>  mod  <span class="math">n</span> , where  <span class="math">p = 0,\\ldots ,3,q = 0,\\ldots ,t_p</span> , then for  <span class="math">0\\leq s\\leq n - 1</span> , we have that the potential of the  <span class="math">r</span> -round linear hull  <span class="math">X_{L,j_0^{n,s}}^i,\\ldots ,X_{L,j_{t_0}^{n,s}}^i,X_{R,j_0^{1,s}}^i,\\ldots ,X_{R,j_{t_1}^{1,s}}^i\\to X_{L,j_0^{2,s}}^i,\\ldots ,X_{L,j_{t_2}^{2,s}}^i,X_{R,j_0^{3,s}}^i,\\ldots ,X_{R,j_{t_3}^{3,s}}^i</span>  for SIMON2n is also  <span class="math">\\bar{\\epsilon}^2</span> .</p>

    <p class="text-gray-300">Observe the two 13-round linear hulls of SIMON32 in Table 3 and we can find they are in fact the rotations of same linear hull. The potential of  <span class="math">X_{L,6}^{i} \\to X_{L,14}^{i+13}</span>  is estimated as  <span class="math">2^{-31.69}</span>  in [6] while that of  <span class="math">X_{L,5}^{i} \\to X_{L,13}^{i+13}</span>  is estimated as  <span class="math">2^{-30.19}</span>  in [7]. The difference may come from the different search methods and different linear trails found. Since SIMON32 has small block size, we can test the bias (potential) of the 13-round linear hull experimentally. In the experimentation, we choose 600 keys randomly, and compute the corresponding bias from the whole plaintexts. The results are shown in the following table.</p>

    <p class="text-gray-300">Table 4: Experimental bias for the 13-round linear hull of Simon32</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">ε2=</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">p-1/2</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">2</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Number</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Number/600</th>

          </tr>

        </thead>

        <tbody>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">ε2≥ 2-27.19</td>

            <td class="px-3 py-2 border-b border-gray-700">7</td>

            <td class="px-3 py-2 border-b border-gray-700">0.012</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">227.19 > ε2≥ 2-28.19</td>

            <td class="px-3 py-2 border-b border-gray-700">21</td>

            <td class="px-3 py-2 border-b border-gray-700">0.035</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">228.19 > ε2≥ 2-29.19</td>

            <td class="px-3 py-2 border-b border-gray-700">58</td>

            <td class="px-3 py-2 border-b border-gray-700">0.097</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">229.19 > ε2≥ 2-30.19</td>

            <td class="px-3 py-2 border-b border-gray-700">72</td>

            <td class="px-3 py-2 border-b border-gray-700">0.12</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">230.19 > ε2≥ 2-31.19</td>

            <td class="px-3 py-2 border-b border-gray-700">104</td>

            <td class="px-3 py-2 border-b border-gray-700">0.173</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">ε2< 2-31.19</td>

            <td class="px-3 py-2 border-b border-gray-700">338</td>

            <td class="px-3 py-2 border-b border-gray-700">0.563</td>

          </tr>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">From the table, we know that about  <span class="math">26.4\\%</span>  of the keys have  <span class="math">\\epsilon^2 \\geq 2^{-30.19}</span> . So  <span class="math">2^{30.19}</span>  is a little optimistic for the other  <span class="math">73.6\\%</span>  keys. However, this linear hull distinguisher is interesting and in the following, we will give the key recovery procedure using this linear hull. Also, we implement the 21-round attack on SIMON32 and the results show that we can decrease the candidate key space by 8 bits when the potential under the real key is large.</p>

    <p class="text-gray-300">We exploit the 13-round linear hull proposed in [7] to make key recovery attack on round-reduced SIMON32. The linear hull is</p>

    <div class="my-4 text-center"><span class="math-block">X _ {L, 5} ^ {i} \\rightarrow X _ {R, 1 3} ^ {i + 1 3}.</span></div>

    <p class="text-gray-300">We mount a key recovery attack on 21-round SIMON32/64 by adding four rounds before and appending four rounds after the distinguisher. Here let  <span class="math">P = X^{i - 4}</span>  be the plaintext and  <span class="math">C = X^{i + 17}</span>  be the corresponding ciphertext. Suppose the subkeys involved in the first four rounds are  <span class="math">K_{P}</span>  and those in the last four rounds are  <span class="math">K_{C}</span> . Then  <span class="math">X_{L,5}^{i}</span>  is a function of  <span class="math">P</span>  and  <span class="math">K_{P}</span> ,  <span class="math">X_{L,5}^{i} = E(P,K_{P})</span> . Similarly,  <span class="math">X_{R,13}^{i + 13} = D(C,K_{C})</span>  is a function of  <span class="math">C</span>  and  <span class="math">K_{C}</span> . Let  <span class="math">S</span>  be the set of  <span class="math">N</span>  plaintext-ciphertext pairs obtained, the empirical correlation under some key  <span class="math">K_{P},K_{C}</span>  is</p>

    <div class="my-4 text-center"><span class="math-block">\\bar {c} _ {K _ {P}, K _ {C}} = \\frac {1}{N} \\sum_ {P, C \\in \\mathcal {S}} (- 1) ^ {E (P, K _ {P}) \\oplus D (C, K _ {C})}. \\tag {9}</span></div>

    <p class="text-gray-300">Table 5: 4 rounds before  <span class="math">{X}_{L,5}^{i}</span>  for SIMON32</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">x</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Representation of xi</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">k</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Representation of ki</th>

          </tr>

        </thead>

        <tbody>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">x0</td>

            <td class="px-3 py-2 border-b border-gray-700">Xi-4L,13 ⊕ (Xi-4L,14&Xi-4L,7) ⊕ Xi-4R,15 ⊕ Xi-4L,5</td>

            <td class="px-3 py-2 border-b border-gray-700">k0</td>

            <td class="px-3 py-2 border-b border-gray-700">Ki-4L,15 ⊕ Ki-3 ⊕ Ki-3R,15 ⊕ Ki-2⊕ Ki-1</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">x1</td>

            <td class="px-3 py-2 border-b border-gray-700">Xi-4L,14 ⊕ (Xi-4L,15&Xi-4L,8) ⊕ Xi-4R,9</td>

            <td class="px-3 py-2 border-b border-gray-700">k1</td>

            <td class="px-3 py-2 border-b border-gray-700">Ki-4</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">x2</td>

            <td class="px-3 py-2 border-b border-gray-700">Xi-4L,7 ⊕ (Xi-4L,8&Xi-4L,1) ⊕ Xi-4R,9</td>

            <td class="px-3 py-2 border-b border-gray-700">k2</td>

            <td class="px-3 py-2 border-b border-gray-700">Ki-4</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">x3</td>

            <td class="px-3 py-2 border-b border-gray-700">Xi-4L,2 ⊕ (Xi-4L,3&Xi-4L,12) ⊕ Xi-4R,4</td>

            <td class="px-3 py-2 border-b border-gray-700">k3</td>

            <td class="px-3 py-2 border-b border-gray-700">Ki-4</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">x4</td>

            <td class="px-3 py-2 border-b border-gray-700">Xi-4L,11 ⊕ (Xi-4L,12&Xi-4L,5) ⊕ Xi-4R,13</td>

            <td class="px-3 py-2 border-b border-gray-700">k4</td>

            <td class="px-3 py-2 border-b border-gray-700">Ki-4</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">x5</td>

            <td class="px-3 py-2 border-b border-gray-700">Xi-4L,13 ⊕ (Xi-4L,10&Xi-4L,8) ⊕ Xi-4R,0 ⊕ Xi-4L,2</td>

            <td class="px-3 py-2 border-b border-gray-700">k5</td>

            <td class="px-3 py-2 border-b border-gray-700">Ki-4 ⊕ Ki-3</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">x6</td>

            <td class="px-3 py-2 border-b border-gray-700">Xi-4L,15 ⊕ (Xi-4L,0&Xi-4L,9) ⊕ Xi-4R,1</td>

            <td class="px-3 py-2 border-b border-gray-700">k6</td>

            <td class="px-3 py-2 border-b border-gray-700">Ki-4</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">x7</td>

            <td class="px-3 py-2 border-b border-gray-700">Xi-4L,8 ⊕ (Xi-4L,9&Xi-4L,2) ⊕ Xi-4R,10</td>

            <td class="px-3 py-2 border-b border-gray-700">k7</td>

            <td class="px-3 py-2 border-b border-gray-700">Ki-4</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">x8</td>

            <td class="px-3 py-2 border-b border-gray-700">Xi-4L,7 ⊕ (Xi-4L,8&Xi-4L,1) ⊕ Xi-4R,9 ⊕ Xi-4L,11</td>

            <td class="px-3 py-2 border-b border-gray-700">k8</td>

            <td class="px-3 py-2 border-b border-gray-700">Ki-4 ⊕ Ki-3</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">x9</td>

            <td class="px-3 py-2 border-b border-gray-700">Xi-4L,1 ⊕ (Xi-4L,2&Xi-4L,11) ⊕ Xi-4R,3</td>

            <td class="px-3 py-2 border-b border-gray-700">k9</td>

            <td class="px-3 py-2 border-b border-gray-700">Ki-4</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">x10</td>

            <td class="px-3 py-2 border-b border-gray-700">Xi-4L,14 ⊕ (Xi-4L,15&Xi-4L,8) ⊕ Xi-4R,0 ⊕ (Xi-4L,3&Xi-4L,13) ⊕ Xi-4R,4</td>

            <td class="px-3 py-2 border-b border-gray-700">k10</td>

            <td class="px-3 py-2 border-b border-gray-700">Ki-4 ⊕ Ki-3 ⊕ Ki-4 ⊕ Ki-2</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">x11</td>

            <td class="px-3 py-2 border-b border-gray-700">Xi-4L,15 ⊕ (Xi-4L,0&Xi-4L,9) ⊕ Xi-4R,1 ⊕ Xi-4L,3</td>

            <td class="px-3 py-2 border-b border-gray-700">k11</td>

            <td class="px-3 py-2 border-b border-gray-700">Ki-4 ⊕ Ki-3</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">x12</td>

            <td class="px-3 py-2 border-b border-gray-700">Xi-4L,0 ⊕ (Xi-4L,1&Xi-4L,10) ⊕ Xi-4R,2</td>

            <td class="px-3 py-2 border-b border-gray-700">k12</td>

            <td class="px-3 py-2 border-b border-gray-700">Ki-4</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">x13</td>

            <td class="px-3 py-2 border-b border-gray-700">Xi-4L,9 ⊕ (Xi-4L,10&Xi-4L,3) ⊕ Xi-4R,11</td>

            <td class="px-3 py-2 border-b border-gray-700">k13</td>

            <td class="px-3 py-2 border-b border-gray-700">Ki-4</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">x14</td>

            <td class="px-3 py-2 border-b border-gray-700">Xi-4L,8 ⊕ (Xi-4L,9&Xi-4L,2) ⊕ Xi-4R,10 ⊕ Xi-4L,12</td>

            <td class="px-3 py-2 border-b border-gray-700">k14</td>

            <td class="px-3 py-2 border-b border-gray-700">Ki-4 ⊕ Ki-3</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">x15</td>

            <td class="px-3 py-2 border-b border-gray-700">Xi-4L,7 ⊕ (Xi-4L,8&Xi-4L,1) ⊕ Xi-4R,9 ⊕ (Xi-4L,12&Xi-4L,5) ⊕ Xi-4R,13</td>

            <td class="px-3 py-2 border-b border-gray-700">k15</td>

            <td class="px-3 py-2 border-b border-gray-700">Ki-4 ⊕ Ki-3 ⊕ Ki-4 ⊕ Ki-2</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">x16</td>

            <td class="px-3 py-2 border-b border-gray-700">Xi-4L,1 ⊕ (Xi-4L,2&Xi-4L,11) ⊕ Xi-4R,3 ⊕ Xi-4L,5</td>

            <td class="px-3 py-2 border-b border-gray-700">k16</td>

            <td class="px-3 py-2 border-b border-gray-700">Ki-4 ⊕ Ki-3</td>

          </tr>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">1 Notice:  <span class="math">x_{10} = x_3\\oplus x_5,x_{15} = x_4\\oplus x_8</span> <span class="math">2X^{i - 4}</span>  is the plaintext  <span class="math">P</span> ,  <span class="math">K^{i - 4},\\ldots ,K^{i - 1}</span>  are the subkeys used in the initial four rounds, i.e.  <span class="math">K_{P}</span> 3 In the description of the paper,  <span class="math">x_{P} = x = (x_{0},\\ldots ,x_{16}),k_{P} = k = (k_{0},\\ldots ,k_{16})</span></p>

    <p class="text-gray-300">In a further step,  <span class="math">X_{L,5}^{i}</span>  can be represented as  <span class="math">X_{L,5}^{i} = f(x,k)</span>  where</p>

    <div class="my-4 text-center"><span class="math-block">f (x, k) = x _ {0} \\oplus k _ {0} \\oplus ((x _ {1} \\oplus k _ {1}) \\&amp;amp; (x _ {2} \\oplus k _ {2})) \\oplus ((x _ {3} \\oplus k _ {3}) \\&amp;amp; (x _ {4} \\oplus k _ {4})) \\oplus</span></div>

    <div class="my-4 text-center"><span class="math-block">[ (x _ {5} \\oplus k _ {5} \\oplus ((x _ {6} \\oplus k _ {6}) \\&amp;amp; (x _ {7} \\oplus k _ {7}))) \\&amp;amp; (x _ {8} \\oplus k _ {8} \\oplus ((x _ {9} \\oplus k _ {9}) \\&amp;amp; (x _ {7} \\oplus k _ {7}))) ] \\oplus</span></div>

    <div class="my-4 text-center"><span class="math-block">\\{(x _ {1 0} \\oplus k _ {1 0} \\oplus ((x _ {6} \\oplus k _ {6}) \\&amp;amp; (x _ {7} \\oplus k _ {7})) \\oplus</span></div>

    <div class="my-4 text-center"><span class="math-block">[ (x _ {1 1} \\oplus k _ {1 1} \\oplus ((x _ {1 2} \\oplus k _ {1 2}) \\&amp;amp; (x _ {1 3} \\oplus k _ {1 3}))) \\&amp;amp; (x _ {1 4} \\oplus k _ {1 4} \\oplus ((x _ {3} \\oplus k _ {3}) \\&amp;amp; (x _ {1 3} \\oplus k _ {1 3}))) ]) \\&amp;amp;</span></div>

    <div class="my-4 text-center"><span class="math-block">\\left(x _ {1 5} \\oplus k _ {1 5} \\oplus \\left(\\left(x _ {7} \\oplus k _ {7}\\right) \\&amp;amp; \\left(x _ {9} \\oplus k _ {9}\\right)\\right) \\oplus \\right.</span></div>

    <div class="my-4 text-center"><span class="math-block">[ (x _ {1 4} \\oplus k _ {1 4} \\oplus ((x _ {1 3} \\oplus k _ {1 3}) \\&amp;amp; (x _ {3} \\oplus k _ {3}))) \\&amp;amp; (x _ {1 6} \\oplus k _ {1 6} \\oplus ((x _ {3} \\oplus k _ {3}) \\&amp;amp; (x _ {4} \\oplus k _ {4}))) ]) \\}</span></div>

    <p class="text-gray-300">Table 6: 4 rounds after  <span class="math">{X}_{R,{13}}^{++{13}}</span>  for SIMON32</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">x</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Representation of xi</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">k</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Representation of ki</th>

          </tr>

        </thead>

        <tbody>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">x0</td>

            <td class="px-3 py-2 border-b border-gray-700">XR,5++17 ⊕ (XR,6++17 & XR,15) ⊕ XL,7++17 ⊕ XR,9</td>

            <td class="px-3 py-2 border-b border-gray-700">k0</td>

            <td class="px-3 py-2 border-b border-gray-700">K7++16 ⊕ K9++15 ⊕ K13++15 ⊕ K11++14 ⊕ K13++13</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">x1</td>

            <td class="px-3 py-2 border-b border-gray-700">XR,6++17 ⊕ (XR,7++17 & XR,0) ⊕ XL,8</td>

            <td class="px-3 py-2 border-b border-gray-700">k1</td>

            <td class="px-3 py-2 border-b border-gray-700">K8++16</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">x2</td>

            <td class="px-3 py-2 border-b border-gray-700">XR,15++17 ⊕ (XR,0) ⊕ (XR,9) ⊕ XL,1</td>

            <td class="px-3 py-2 border-b border-gray-700">k2</td>

            <td class="px-3 py-2 border-b border-gray-700">K1++16</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">x3</td>

            <td class="px-3 py-2 border-b border-gray-700">XR,10++17 ⊕ (XR,11) ⊕ (XR,4) ⊕ XL,12</td>

            <td class="px-3 py-2 border-b border-gray-700">k3</td>

            <td class="px-3 py-2 border-b border-gray-700">K12++16</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">x4</td>

            <td class="px-3 py-2 border-b border-gray-700">XR,3++17 ⊕ (XR,4) ⊕ (XR,13) ⊕ XL,5</td>

            <td class="px-3 py-2 border-b border-gray-700">k4</td>

            <td class="px-3 py-2 border-b border-gray-700">K5++16</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">x5</td>

            <td class="px-3 py-2 border-b border-gray-700">XR,6++17 ⊕ (XR,7) ⊕ (XR,0) ⊕ (XR,8) ⊕ XR,10</td>

            <td class="px-3 py-2 border-b border-gray-700">k5</td>

            <td class="px-3 py-2 border-b border-gray-700">K8++16 ⊕ K10++15</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">x6</td>

            <td class="px-3 py-2 border-b border-gray-700">XR,7++17 ⊕ (XR,8) ⊕ (XR,1) ⊕ XL,9</td>

            <td class="px-3 py-2 border-b border-gray-700">k6</td>

            <td class="px-3 py-2 border-b border-gray-700">K9++16</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">x7</td>

            <td class="px-3 py-2 border-b border-gray-700">XR,0++17 ⊕ (XR,1) ⊕ (XR,10) ⊕ XL,11</td>

            <td class="px-3 py-2 border-b border-gray-700">k7</td>

            <td class="px-3 py-2 border-b border-gray-700">K2++16</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">x8</td>

            <td class="px-3 py-2 border-b border-gray-700">XR,15++17 ⊕ (XR,0) ⊕ (XR,9) ⊕ XL,11</td>

            <td class="px-3 py-2 border-b border-gray-700">k8</td>

            <td class="px-3 py-2 border-b border-gray-700">K1++16 ⊕ K3++15</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">x9</td>

            <td class="px-3 py-2 border-b border-gray-700">XR,9++17 ⊕ (XR,10) ⊕ (XR,3) ⊕ XL,11</td>

            <td class="px-3 py-2 border-b border-gray-700">k9</td>

            <td class="px-3 py-2 border-b border-gray-700">K11++16</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">x10</td>

            <td class="px-3 py-2 border-b border-gray-700">XR,6++17 ⊕ (XR,7) ⊕ (XR,0) ⊕ (XL,8) ⊕ (XR,11) ⊕ (XL,12)</td>

            <td class="px-3 py-2 border-b border-gray-700">k10</td>

            <td class="px-3 py-2 border-b border-gray-700">K8++16 ⊕ K10++15 ⊕ K12++16 ⊕ K12++14</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">x11</td>

            <td class="px-3 py-2 border-b border-gray-700">XR,7++17 ⊕ (XR,8) ⊕ (XR,1) ⊕ (XL,9) ⊕ XL,11</td>

            <td class="px-3 py-2 border-b border-gray-700">k11</td>

            <td class="px-3 py-2 border-b border-gray-700">K9++16 ⊕ K11++15</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">x12</td>

            <td class="px-3 py-2 border-b border-gray-700">XR,8++17 ⊕ (XR,9) ⊕ (XR,2) ⊕ (XL,10)</td>

            <td class="px-3 py-2 border-b border-gray-700">k12</td>

            <td class="px-3 py-2 border-b border-gray-700">K10++16</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">x13</td>

            <td class="px-3 py-2 border-b border-gray-700">XR,11++17 ⊕ (XR,2) ⊕ (XR,11) ⊕ (XL,3)</td>

            <td class="px-3 py-2 border-b border-gray-700">k13</td>

            <td class="px-3 py-2 border-b border-gray-700">K3++16</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">x14</td>

            <td class="px-3 py-2 border-b border-gray-700">XR,0++17 ⊕ (XR,1) ⊕ (XR,10) ⊕ (XL,2) ⊕ (XL,4)</td>

            <td class="px-3 py-2 border-b border-gray-700">k14</td>

            <td class="px-3 py-2 border-b border-gray-700">K2++16 ⊕ K4++15</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">x15</td>

            <td class="px-3 py-2 border-b border-gray-700">XR,15++17 ⊕ (XR,0) ⊕ (XR,9) ⊕ XL,11</td>

            <td class="px-3 py-2 border-b border-gray-700">k15</td>

            <td class="px-3 py-2 border-b border-gray-700">K1++16 ⊕ K3++15 ⊕ K5++16 ⊕ K5++14</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">x16</td>

            <td class="px-3 py-2 border-b border-gray-700">XR,9++17 ⊕ (XR,10) ⊕ (XR,3) ⊕ XL,11</td>

            <td class="px-3 py-2 border-b border-gray-700">k16</td>

            <td class="px-3 py-2 border-b border-gray-700">K11++16 ⊕ K13++15</td>

          </tr>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">1 Notice:  <span class="math">x_{10} = x_3\\oplus x_5,x_{15} = x_4\\oplus x_8</span> <span class="math">2X^{i + 17}</span>  is the ciphertext  <span class="math">C</span> ,  <span class="math">K^{i + 13},\\ldots ,K^{i + 16}</span>  are the subkeys used in the last four rounds, i.e.  <span class="math">K_{C}</span> 3 In the description of the paper,  <span class="math">x_{C} = x = (x_{0},\\ldots ,x_{16}),k_{C} = k = (k_{0},\\ldots ,k_{16})</span></p>

    <p class="text-gray-300">where the representation of  <span class="math">x</span>  and  <span class="math">k</span>  are 17-bit value shown in Table 5. With the same way,  <span class="math">X_{R,13}^{i+13}</span>  can also be represented as  <span class="math">f(x,k)</span>  where the corresponding  <span class="math">x</span>  and  <span class="math">k</span>  are described in Table 6. To distinguish them, let  <span class="math">x_P, k_P</span>  be the  <span class="math">x,k</span>  described in Table 5 and  <span class="math">x_C, k_C</span>  be the  <span class="math">x,k</span>  described in Table 6. The  <span class="math">N</span>  plaintext-ciphertext pairs in  <span class="math">S</span>  can be compressed into a counter vector  <span class="math">V[x_P, x_C]</span> , which stores the number of  <span class="math">x_P, x_C</span> . Then there is</p>

    <div class="my-4 text-center"><span class="math-block">\\bar {c} _ {k _ {P}, k _ {C}} = \\frac {1}{N} \\sum_ {x _ {P}, x _ {C}} (- 1) ^ {f \\left(x _ {P}, k _ {P}\\right) \\oplus f \\left(x _ {C}, k _ {C}\\right)} V \\left[ x _ {P}, x _ {C} \\right]. \\tag {10}</span></div>

    <p class="text-gray-300">Notice that  <span class="math">f(x, k)</span>  is linear with  <span class="math">x_0 \\oplus k_0</span> . According to the linear compression technique, the 0-th bit of  <span class="math">x_P</span>  and  <span class="math">x_C</span>  could be compressed initially. Suppose that  <span class="math">x_P&#x27;</span>  is the 16-bit value of  <span class="math">x_P</span>  without the 0-th bit (same representations for  <span class="math">x_C&#x27;, k_P&#x27;, k_C&#x27;</span> ). Initialize a new counter vector  <span class="math">V_1</span>  which has values</p>

    <div class="my-4 text-center"><span class="math-block">V _ {1} \\left[ x _ {P} ^ {\\prime}, x _ {C} ^ {\\prime} \\right] = \\sum_ {x _ {P, 0}, x _ {C, 0}} (- 1) ^ {x _ {P, 0} \\oplus x _ {C, 0}} V \\left[ x _ {P}, x _ {C} \\right]. \\tag {11}</span></div>

    <p class="text-gray-300">Then the correlation becomes</p>

    <div class="my-4 text-center"><span class="math-block">\\begin{array}{l} \\bar {c} _ {k _ {P} ^ {\\prime}, k _ {C} ^ {\\prime}} = \\frac {1}{N} \\sum_ {x _ {P} ^ {\\prime}, x _ {C} ^ {\\prime}} (- 1) ^ {f ^ {\\prime} (x _ {P} ^ {\\prime}, k _ {P} ^ {\\prime}) \\oplus f ^ {\\prime} (x _ {C} ^ {\\prime}, k _ {C} ^ {\\prime})} V _ {1} [ x _ {P} ^ {\\prime}, x _ {C} ^ {\\prime} ] \\\\ = \\frac {1}{N} \\sum_ {x _ {C} ^ {\\prime}} (- 1) ^ {f ^ {\\prime} \\left(x _ {C} ^ {\\prime}, k _ {C} ^ {\\prime}\\right)} \\sum_ {x _ {P} ^ {\\prime}} (- 1) ^ {f ^ {\\prime} \\left(x _ {P} ^ {\\prime}, k _ {P} ^ {\\prime}\\right)} V _ {1} \\left[ x _ {P} ^ {\\prime}, x _ {C} ^ {\\prime} \\right], \\tag {12} \\\\ \\end{array}</span></div>

    <p class="text-gray-300">where  <span class="math">f&#x27;</span>  is part of  <span class="math">f</span> , i.e.  <span class="math">f(x, k) = x_0 \\oplus k_0 \\oplus f&#x27;(x&#x27;, k&#x27;)</span> ,  <span class="math">x&#x27; = (x_1, \\ldots, x_{16})</span> ,  <span class="math">k&#x27; = (k_1, \\ldots, k_{16})</span> .</p>

    <p class="text-gray-300">So we can guess  <span class="math">k_P&#x27;</span>  (16-bit) at first and compress the plaintexts into a counter. Then guess  <span class="math">k_C&#x27;</span>  (16-bit) to decrypt the appending rounds, to achieve the final correlations. In the following, we introduce the attack procedure in the forward rounds in detail. The procedure to compute  <span class="math">\\sum_{x_P&#x27;} (-1)^{f&#x27;(x_P&#x27;, k_P&#x27;)} V_1[x_P&#x27;, x_C&#x27;]</span>  for each</p>

    <p class="text-gray-300"><span class="math">x_{C}^{\\prime}</span>  is same with the procedure to compute  <span class="math">B^{k^{\\prime}}(y)</span>  with some counter vector  <span class="math">V_{1}^{\\prime}[x^{\\prime}]</span>  and boolean function  <span class="math">f^{\\prime}</span> . Counter vector  <span class="math">V_{1}^{\\prime}</span>  is part of counter vector  <span class="math">V_{1}</span> . For each specific  <span class="math">x_{C}^{\\prime}</span> ,</p>

    <div class="my-4 text-center"><span class="math-block">V _ {1} ^ {\\prime} [ x ^ {\\prime} ] = V _ {1} [ x ^ {\\prime}, x _ {C} ^ {\\prime} ],</span></div>

    <p class="text-gray-300">which means  <span class="math">V_1&#x27;[x&#x27;]</span>  takes value of  <span class="math">V_1[x_P&#x27;, x_C&#x27;]</span>  where  <span class="math">x_P&#x27; = x&#x27;</span>  and  <span class="math">x_C&#x27;</span>  is fixed. Moreover, there are relations that  <span class="math">x_{10} = x_3 \\oplus x_5, x_{15} = x_4 \\oplus x_8</span>  in Table 5,6, which means there are only 14 independent bits for  <span class="math">x&#x27;</span>  ( <span class="math">x_P&#x27;</span>  or  <span class="math">x_C&#x27;</span> ).</p>

    <p class="text-gray-300">Compute  <span class="math">B^{k&#x27;}(y)</span>  with counter vector  <span class="math">V_1&#x27;[x&#x27;]</span>  and Boolean function  <span class="math">f&#x27;</span> . (For simplicity, we define this procedure as Procedure A.) Although  <span class="math">x&#x27;</span>  is a 16-bit value, there are only  <span class="math">2^{14}</span>  possible values for  <span class="math">x&#x27;</span>  as explained above. We use the guess, split and combination technique to decrease the time complexity to compute  <span class="math">B^{k&#x27;}(y)</span>  with counter vector  <span class="math">V_1&#x27;[x&#x27;]</span>  and boolean function  <span class="math">y = f&#x27;</span> , for  <span class="math">2^{16}</span>  key vaules  <span class="math">k&#x27;</span> .</p>

    <ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">

      <li>Guess  <span class="math">k_{1}, k_{3}, k_{7}</span>  and split the plaintexts into 8 sets according to the value  <span class="math">(x_{1} \\oplus k_{1}, x_{3} \\oplus k_{3}, x_{7} \\oplus k_{7})</span> . The simplification for  <span class="math">f&#x27;(x&#x27;, k&#x27;)</span>  after guessing some keys are shown in Table 7. The representation of  <span class="math">f_{ij}</span>  are</li>

    </ol>

    <p class="text-gray-300">Table 7: Simplification for  <span class="math">f^{\\prime}(x^{\\prime},k^{\\prime})</span>  after guessing  <span class="math">k_{1},k_{3},k_{7}</span></p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Guess</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">x1 ⊕ k1, x3 ⊕ k3, x7 ⊕ k7</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">f'</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Related Bit</th>

          </tr>

        </thead>

        <tbody>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">k1, k3, k7</td>

            <td class="px-3 py-2 border-b border-gray-700">0,0,0</td>

            <td class="px-3 py-2 border-b border-gray-700">f00</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">0,0,1</td>

            <td class="px-3 py-2 border-b border-gray-700">f01</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">0,1,0</td>

            <td class="px-3 py-2 border-b border-gray-700">f10</td>

            <td class="px-3 py-2 border-b border-gray-700">k4</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">0,1,1</td>

            <td class="px-3 py-2 border-b border-gray-700">f11</td>

            <td class="px-3 py-2 border-b border-gray-700">k4</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">1,0,0</td>

            <td class="px-3 py-2 border-b border-gray-700">f00</td>

            <td class="px-3 py-2 border-b border-gray-700">k2</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">1,0,1</td>

            <td class="px-3 py-2 border-b border-gray-700">f01</td>

            <td class="px-3 py-2 border-b border-gray-700">k2</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">1,1,0</td>

            <td class="px-3 py-2 border-b border-gray-700">f10</td>

            <td class="px-3 py-2 border-b border-gray-700">k2,4</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">1,1,1</td>

            <td class="px-3 py-2 border-b border-gray-700">f11</td>

            <td class="px-3 py-2 border-b border-gray-700">k2,4</td>

          </tr>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">as follows,</p>

    <div class="my-4 text-center"><span class="math-block">f _ {0 0} = \\left(\\left(x _ {5} \\oplus k _ {5}\\right) \\&amp;amp; \\left(x _ {8} \\oplus k _ {8}\\right)\\right) \\oplus \\left\\{\\left(x _ {1 0} \\oplus k _ {1 0} \\oplus \\left[ \\left(x _ {1 1} \\oplus k _ {1 1} \\oplus \\left(\\left(x _ {1 2} \\oplus k _ {1 2}\\right) \\&amp;amp; \\left(x _ {1 3} \\oplus k _ {1 3}\\right)\\right)\\right) \\right. \\right.</span></div>

    <div class="my-4 text-center"><span class="math-block">\\&amp;amp; (x _ {1 4} \\oplus k _ {1 4}) ]) \\&amp;amp; (x _ {1 5} \\oplus k _ {1 5} \\oplus [ (x _ {1 4} \\oplus k _ {1 4}) \\&amp;amp; (x _ {1 6} \\oplus k _ {1 6}) ]) \\},</span></div>

    <div class="my-4 text-center"><span class="math-block">f _ {0 1} = \\left(\\left(x _ {5, 6} \\oplus k _ {5, 6}\\right) \\&amp;amp; \\left(x _ {8, 9} \\oplus k _ {8, 9}\\right)\\right) \\oplus \\left\\{\\left(x _ {6, 1 0} \\oplus k _ {6, 1 0} \\oplus \\left[ \\left(x _ {1 1} \\oplus k _ {1 1} \\oplus \\left(\\left(x _ {1 2} \\oplus k _ {1 2}\\right) \\right. \\right. \\right. \\right.</span></div>

    <div class="my-4 text-center"><span class="math-block">\\&amp;amp; (x _ {1 3} \\oplus k _ {1 3})) \\&amp;amp; (x _ {1 4} \\oplus k _ {1 4}) ]) \\&amp;amp; (x _ {9, 1 5} \\oplus k _ {9, 1 5} \\oplus [ (x _ {1 4} \\oplus k _ {1 4}) \\&amp;amp; (x _ {1 6} \\oplus k _ {1 6}) ]) \\},</span></div>

    <div class="my-4 text-center"><span class="math-block">f _ {1 0} = \\left(\\left(x _ {5} \\oplus k _ {5}\\right) \\&amp;amp; \\left(x _ {8} \\oplus k _ {8}\\right)\\right) \\oplus \\left\\{\\left(x _ {1 0} \\oplus k _ {1 0} \\oplus \\left[ \\left(x _ {1 1} \\oplus k _ {1 1} \\oplus \\left(\\left(x _ {1 2} \\oplus k _ {1 2}\\right) \\&amp;amp; \\left(x _ {1 3} \\oplus k _ {1 3}\\right)\\right)\\right) \\right. \\right.</span></div>

    <div class="my-4 text-center"><span class="math-block">\\&amp;amp; (x _ {1 3, 1 4} \\oplus k _ {1 3, 1 4}) ]) \\&amp;amp; (x _ {1 5} \\oplus k _ {1 5} \\oplus [ (x _ {1 3, 1 4} \\oplus k _ {1 3, 1 4}) \\&amp;amp; (x _ {4, 1 6} \\oplus k _ {4, 1 6}) ]) \\},</span></div>

    <div class="my-4 text-center"><span class="math-block">f _ {1 1} = \\left(\\left(x _ {5, 6} \\oplus k _ {5, 6}\\right) \\&amp;amp; \\left(x _ {8, 9} \\oplus k _ {8, 9}\\right)\\right) \\oplus \\left\\{\\left(x _ {6, 1 0} \\oplus k _ {6, 1 0} \\oplus \\left[ \\left(x _ {1 1} \\oplus k _ {1 1} \\oplus \\left(\\left(x _ {1 2} \\oplus k _ {1 2}\\right) \\&amp;amp; \\left(x _ {1 3} \\right. \\right. \\right. \\right. \\right.</span></div>

    <div class="my-4 text-center"><span class="math-block">\\oplus k _ {1 3})) \\&amp;amp; (x _ {1 3, 1 4} \\oplus k _ {1 3, 1 4}) ]) \\&amp;amp; (x _ {9, 1 5} \\oplus k _ {9, 1 5} \\oplus [ (x _ {1 3, 1 4} \\oplus k _ {1 3, 1 4}) \\&amp;amp; (x _ {4, 1 6} \\oplus k _ {4, 1 6}) ]) \\}.</span></div>

    <p class="text-gray-300">The counter vectors for  <span class="math">x&#x27;</span>  can be compressed in a further step according to the new representations of  <span class="math">f&#x27;</span> . For example, if  <span class="math">(x_1 \\oplus k_1, x_3 \\oplus k_3, x_7 \\oplus k_7) = (0, 0, 0)</span> ,  <span class="math">f&#x27;</span>  will be equal to the formula  <span class="math">f_{00}</span> , which is independent of  <span class="math">x_2, x_4, x_6, x_9</span> . So we compress the corresponding counters into a new counter  <span class="math">V_{000}</span> , and</p>

    <div class="my-4 text-center"><span class="math-block">V _ {0 0 0} [ x _ {5}, x _ {8}, x _ {1 0} - x _ {1 6} ] = \\sum_ {x _ {1} = k _ {1}, x _ {3} = k _ {3}, x _ {7} = k _ {7}, x _ {2} \\in \\mathbb {F} _ {2}, x _ {4} \\in \\mathbb {F} _ {2}, x _ {6} \\in \\mathbb {F} _ {2}, x _ {9} \\in \\mathbb {F} _ {2}} V _ {1} ^ {\\prime} [ x ^ {\\prime} ].</span></div>

    <p class="text-gray-300">Notice  <span class="math">x_{10} = x_3 \\oplus x_5</span> , so there are 8 independent  <span class="math">x</span>  bits for  <span class="math">x_5, x_8, x_{10} - x_{16}</span> . Notice  <span class="math">x_{15} = x_4 \\oplus x_8</span> , for some fixed value of  <span class="math">x_5, x_8, x_{10} - x_{16}</span> , there are 7 times addition in above equation. So generating this new counter vector needs  <span class="math">2^8 \\times 7</span>  additions.</p>

    <p class="text-gray-300">We give another example to illustrate the situations with related key bit. If  <span class="math">(x_{1} \\oplus k_{1}, x_{3} \\oplus k_{3}, x_{7} \\oplus k_{7}) = (1, 0, 0)</span> , there is  <span class="math">f&#x27; = (x_{2} \\oplus k_{2}) \\oplus f_{00}</span> . Notice in this subset,  <span class="math">f&#x27;</span>  is linear with  <span class="math">x_{2} \\oplus k_{2}</span>  and  <span class="math">x_{2}</span>  can be compressed into the new counters with related key  <span class="math">k_{2}</span> . So the new counter vector  <span class="math">V_{100}</span>  is as follows,</p>

    <div class="my-4 text-center"><span class="math-block">V _ {1 0 0} [ x _ {5}, x _ {8}, x _ {1 0} - x _ {1 6} ] = \\sum_ {x _ {1} = k _ {1} \\oplus 1, x _ {3} = k _ {3}, x _ {7} = k _ {7}, x _ {2} \\in \\mathbb {F} _ {2}, x _ {4} \\in \\mathbb {F} _ {2}, x _ {6} \\in \\mathbb {F} _ {2}, x _ {9} \\in \\mathbb {F} _ {2}} (- 1) ^ {x _ {2}} V _ {1} ^ {\\prime} [ x ^ {\\prime} ].</span></div>

    <p class="text-gray-300">Also, there are 8 independent  <span class="math">x</span>  bits for  <span class="math">x_{5}, x_{8}, x_{10} - x_{16}</span> . For each fixed  <span class="math">x_{5}, x_{8}, x_{10} - x_{16}</span> , the new counter can be obtained with 7 additions according to above equation.</p>

    <p class="text-gray-300">The procedures to generate the new counter vectors for other cases are similar as that of case  <span class="math">(x_{1} \\oplus k_{1}, x_{3} \\oplus k_{3}, x_{7} \\oplus k_{7}) = (0, 0, 0)</span>  or  <span class="math">(1, 0, 0)</span> . Moreover, the time complexity to split the plaintexts and construct new counter vectors is same for each case. Observing the four functions  <span class="math">f_{00}, f_{01}, f_{10}</span>  and  <span class="math">f_{11}</span> , we know that they are with same form. In the following step, we explain the attack procedure of case  <span class="math">(x_{1} \\oplus k_{1}, x_{3} \\oplus k_{3}, x_{7} \\oplus k_{7}) = (0, 0, 0)</span>  in detail and the others can be obtained in the same way.</p>

    <p class="text-gray-300">Note that, there are 9 subkey bits in each function of  <span class="math">f_{00}, f_{01}, f_{10}</span>  and  <span class="math">f_{11}</span>  after guessing  <span class="math">k_{1}, k_{3}, k_{7}</span> . So this can be viewed as that  <span class="math">3 + 9 = 12</span>  subkey bits are involved in the attack while there are 16 subkey bits are involved initially in  <span class="math">f&#x27;</span> . In the following, the number of key bits can be reduced in a further step.</p>

    <ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">

      <li>For  <span class="math">f_{00}</span> , guess  <span class="math">k_{5}, k_{14}</span>  and split the plaintexts into 4 sets according to the value  <span class="math">(x_{5} \\oplus k_{5}, x_{14} \\oplus k_{14})</span> . The simplification for  <span class="math">f_{00}</span>  after guessing some keys are shown in Table 8.</li>

    </ol>

    <p class="text-gray-300">Table 8: Simplification for  <span class="math">{f}_{00}</span>  after guessing  <span class="math">{k}_{5},{k}_{14}</span></p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Guess</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Value</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">f00</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Related Bit</th>

          </tr>

        </thead>

        <tbody>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">k5,k14</td>

            <td class="px-3 py-2 border-b border-gray-700">0,0</td>

            <td class="px-3 py-2 border-b border-gray-700">(x10 ⊕ k10)&(x15 ⊕ k15)</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">0,1</td>

            <td class="px-3 py-2 border-b border-gray-700">(x10,11 ⊕ k10,11 ⊕ ((x12 ⊕ k12)&(x13 ⊕ k13))&(x15,16 ⊕ k15,16)</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">1,0</td>

            <td class="px-3 py-2 border-b border-gray-700">(x10 ⊕ k10)&(x15 ⊕ k15)</td>

            <td class="px-3 py-2 border-b border-gray-700">k8</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">1,1</td>

            <td class="px-3 py-2 border-b border-gray-700">(x10,11 ⊕ k10,11 ⊕ ((x12 ⊕ k12)&(x13 ⊕ k13))&(x15,16 ⊕ k15,16)</td>

            <td class="px-3 py-2 border-b border-gray-700">k8</td>

          </tr>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">The time complexity of computing the counters' value  <span class="math">B^{k_5, k_8, k_{10} - k_{16}}(y)</span>  with counter vector  <span class="math">V_{000}</span>  and function  <span class="math">f_{00}</span>  is as follows:</p>

    <p class="text-gray-300">(a) Guess  <span class="math">k_{5}, k_{14}</span>  and split the states into four parts</p>

    <p class="text-gray-300">i.  <span class="math">(x_{5}\\oplus k_{5},x_{14}\\oplus k_{14}) = (0,0)</span></p>

    <p class="text-gray-300">A. Since  <span class="math">x_{10} = x_3 \\oplus x_5</span> ,  <span class="math">x_5 = k_5</span>  and  <span class="math">x_3 = k_3</span>  (the first case in Table 7), so the  <span class="math">x_{10}</span>  here is fixed. There is one variable bit  <span class="math">x_{15}</span>  to store. Let  <span class="math">V_{000}^{00}[x_{10}, x_{15}]</span>  store the number of  <span class="math">(x_{10}, x_{15})</span> . There is</p>

    <div class="my-4 text-center"><span class="math-block">V _ {0 0 0} ^ {0 0} \\left[ x _ {1 0}, x _ {1 5} \\right] = \\sum_ {x _ {5} = k _ {5}, x _ {1 4} = k _ {1 4}} V _ {0 0 0} \\left[ x _ {5}, x _ {8}, x _ {1 0} - x _ {1 6} \\right]. \\tag {13}</span></div>

    <p class="text-gray-300">There are two possible values for  <span class="math">(x_{10}, x_{15})</span>  here and for each value, the above sum needs  <span class="math">2^5 - 1</span>  additions (5 variable bits  <span class="math">(x_8, x_{11}, x_{12}, x_{13}, x_{16})</span> ). So generating the new counter vector needs  <span class="math">2 \\times (2^5 - 1) = 2^6 - 2</span>  additions.</p>

    <p class="text-gray-300">B. Computing  <span class="math">B_{00}^{k_{10},k_{15}}(y)</span>  with new function (the first case in Table 8) and vector  <span class="math">V_{000}^{00}</span> :</p>

    <p class="text-gray-300">If  <span class="math">k_{10} = x_{10}</span> ,  <span class="math">B_{00}^{k_{10},k_{15}}(y) = V_{000}^{00}[x_{10},0] + V_{000}^{00}[x_{10},1]</span> ;</p>

    <p class="text-gray-300">if  <span class="math">k_{10} = x_{10} \\oplus 1</span> ,  <span class="math">B_{00}^{k_{10}, k_{15}}(y) = (-1)^{k_{15}}(V_{000}^{00}[x_{10}, 0] - V_{000}^{00}[x_{10}, 1])</span> . So in total there are no more than  <span class="math">2^2</span>  additions.</p>

    <p class="text-gray-300">ii.  <span class="math">(x_{5}\\oplus k_{5},x_{14}\\oplus k_{14}) = (0,1)</span></p>

    <p class="text-gray-300">A. There are 4 variable bits  <span class="math">(x_{10,11}, x_{12}, x_{13}, x_{15,16})</span>  to store. Let  <span class="math">V_{000}^{01}[x_{10,11}, x_{12}, x_{13}, x_{15,16}]</span>  store the counter number of  <span class="math">(x_{10,11}, x_{12}, x_{13}, x_{15,16})</span> . There is</p>

    <div class="my-4 text-center"><span class="math-block">V _ {0 0 0} ^ {0 1} \\left[ x _ {1 0, 1 1}, x _ {1 2}, x _ {1 3}, x _ {1 5, 1 6} \\right] = \\sum_ {x _ {5} = k _ {5}, x _ {1 4} = k _ {1 4} \\oplus 1} V _ {0 0 0} \\left[ x _ {5}, x _ {8}, x _ {1 0} - x _ {1 6} \\right]. \\tag {14}</span></div>

    <p class="text-gray-300">For each possible value of  <span class="math">(x_{10,11}, x_{12}, x_{13}, x_{15,16})</span> , the above sum needs  <span class="math">2^2 - 1</span>  additions (2 free variables  <span class="math">(x_8, x_{15})</span> ,  <span class="math">x_{10}</span>  is fixed,  <span class="math">x_{11} = x_{10} \\oplus x_{10,11}</span> ,  <span class="math">x_{16} = x_{15} \\oplus x_{15,16}</span> ). So generating the new counter vector needs:  <span class="math">2^4 \\times (2^2 - 1) = 2^6 - 2^4</span>  additions.</p>

    <p class="text-gray-300">B. Partial  <span class="math">B_{01}^{k_{10,11},k_{12},k_{13},k_{15,16}}(y)</span>  with new function and vector  <span class="math">V_{000}^{01}</span> : 25.64 additions. (See  <span class="math">f_{5}</span>  in Appendix A)</p>

    <p class="text-gray-300">iii.  <span class="math">(x_{5}\\oplus k_{5},x_{14}\\oplus k_{14}) = (1,0)</span></p>

    <p class="text-gray-300">Similar to the first case in Step (2(a)i), let <span class="math">V_{000}^{10}[x_{10},x_{15}]</span> store the number of <span class="math">(x_{10},x_{15})</span>. There is</p>

    <p class="text-gray-300"><span class="math">V_{000}^{10}[x_{10},x_{15}]=\\sum_{x_{5}=k_{5},x_{14}=k_{14}}V_{000}(-1)^{x_{8}}[x_{5},x_{8},x_{10}-x_{16}].</span> (15)</p>

    <p class="text-gray-300">So generating the new counter vector also needs <span class="math">2\\times(2^{5}-1)=2^{6}-2</span> additions. <span class="math">k_{8}</span> becomes a related bit.</p>

    <ul class="list-disc list-inside space-y-1 text-gray-300 my-2 ml-4">

      <li>Partial <span class="math">B_{10}^{k_{10},k_{15}}(y)</span> with new function and vector <span class="math">V_{000}^{10}</span>: <span class="math">2^{2}</span> additions (same with case <span class="math">(0,0)</span>).</li>

      <li><span class="math">(x_{5}\\oplus k_{5},x_{14}\\oplus k_{14})=(1,1)</span></li>

      <li>Similar to the second case in Step (2(a)ii), let <span class="math">V_{000}^{11}[x_{10,11},x_{12},x_{13},\\,x_{15,16}]</span> store the counter number of <span class="math">(x_{10,11},x_{12},\\,x_{13},x_{15,16})</span>. There is</li>

    </ul>

    <p class="text-gray-300"><span class="math">V_{000}^{11}[x_{10,11},x_{12},x_{13},x_{15,16}]=\\sum_{x_{5}=k_{5},x_{14}=k_{14}\\oplus 1}(-1)^{x_{8}}V_{000}[x_{5},x_{8},x_{10}-x_{16}].</span> (16)</p>

    <p class="text-gray-300">So generating the new counter vector needs: <span class="math">2^{4}\\times(2^{2}-1)=2^{6}-2^{4}</span> additions. <span class="math">k_{8}</span> becomes a related bit.</p>

    <ul class="list-disc list-inside space-y-1 text-gray-300 my-2 ml-4">

      <li>Partial <span class="math">B_{11}^{k_{10,11},k_{12},k_{13},k_{15,16}}(y)</span> with new function and vector <span class="math">V_{000}^{11}</span>: <span class="math">2^{5.64}</span> additions. (See <span class="math">f_{5}</span> in Appendix A)</li>

      <li>For each of <span class="math">2^{9}</span> keys involved in <span class="math">f_{00}</span>, partial <span class="math">B^{k_{5},k_{8},k_{10}-k_{16}}(y)</span> with function <span class="math">y=f_{00}</span> and counter vector <span class="math">V_{000}</span> under key guess <span class="math">k_{5},k_{14}</span> is</li>

    </ul>

    <p class="text-gray-300"><span class="math">B^{k_{5},k_{8},k_{10}-k_{16}}(y)=</span> <span class="math">(B_{00}^{k_{10},k_{15}}(y)+B_{01}^{k_{10,11},k_{12},k_{13},k_{15,16}}(y))</span> (17) <span class="math">+(-1)^{k_{8}}</span> <span class="math">(B_{10}^{k_{10},k_{15}}(y)+B_{01}^{k_{10,11},k_{12},k_{13},k_{15,16}}(y)).</span></p>

    <p class="text-gray-300">We can add <span class="math">B_{00}^{k_{10},k_{15}}(y)</span> and <span class="math">B_{01}^{k_{10,11},k_{12},k_{13},k_{15,16}}(y)</span> at first, then add <span class="math">B_{10}^{k_{10},k_{15}}(y)</span> and <span class="math">B_{01}^{k_{10,11},k_{12},k_{13},k_{15,16}}(y)</span>, at last add the two parts according to the index value and <span class="math">k_{8}</span>. The combination phase needs <span class="math">2^{6}+2^{6}+2^{7}=2^{8}</span> additions in total when <span class="math">k_{5},k_{14}</span> are fixed.</p>

    <ul class="list-disc list-inside space-y-1 text-gray-300 my-2 ml-4">

      <li>In total, there are</li>

    </ul>

    <p class="text-gray-300"><span class="math">2^{2}\\times((2^{6}-2+2^{2}+2^{6}-2^{4}+2^{5.64})\\times 2+2^{8})\\approx 2^{11.19}</span></p>

    <p class="text-gray-300">additions to compute <span class="math">B^{k_{5},k_{8},k_{10}-k_{16}}(y)</span> for all <span class="math">2^{9}</span> possible key values. Note that, about 1 subkey bit is guessed in the first (or third) step of step 2a. In the second (or forth) step of step 2a, 1.5 subkey bits are guessed on average. So, although there are 9 subkey bits in total, only 2+(1+1+1.5+1.5)/4=3.25 bits on average are guessed with dynamic key-guessing technique.</p>

    <ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">

      <li>The time of computing <span class="math">B^{k^{\\prime}}(y)</span> with counter vector <span class="math">V_{1}^{\\prime}[x^{\\prime}]</span> and boolean function <span class="math">f^{\\prime}</span> is shown in Table 9. <span class="math">T_{1}</span> denotes the time of seperation of the plaintexts according to the guessed bit of <span class="math">k</span>. <span class="math">T_{2}</span> denotes the time of computation in the inner part. <span class="math">T_{3}</span> is the time in the combination phase. When <span class="math">k_{1},k_{3},k_{7}</span> are fixed, in each case, <span class="math">T_{1}=2^{8}\\times 7</span> as explainted in Step 1. <span class="math">T_{2}</span> is <span class="math">2^{11.19}</span> as explained in Step 2. There are 13 bits for <span class="math">k^{\\prime}</span> except <span class="math">k_{1},k_{3},k_{7}</span>, leading to <span class="math">T_{3}=2^{13}\\times 7</span>. For all guesses of <span class="math">k_{1},k_{3},k_{7}</span>, the total time is about <span class="math">2^{19.46}</span> additions.</li>

    </ol>

    <p class="text-gray-300">In Step 1, 3 key bits are guessed and the plaintexts are splitted into 8 situations. For each situation, 3.25 key bits are guessed as explained above. So on average, about <span class="math">3+3.25=6.25</span> subkey bits are guessed in this procedure, while there are 16 subkey bits involved.</p>

    <p class="text-gray-300">21-round attack on Simon32/64. Adding four rounds and appending four rounds after the 13-round linear hull distinguisher, we give the 21-round linear attack on Simon32/64. The estimated potential of the linear hull is <span class="math">\\bar{\\epsilon}^{2}\\approx 2^{-30.19}</span> in <em>[7]</em>, which is a little optimistic for more than half of keys. In the attack, we use <span class="math">N=2^{31.19}</span> plaintext-ciphertext pairs. According to Theorem 1, the relation between the bias and success probability is shown in Table 10 when using <span class="math">2^{31.19}</span> plaintext-ciphertext pairs. So according to Table 4 and Table 10, the expected success probability of the attack is larger than</p>

    <p class="text-gray-300"><span class="math">0.012<em>p_{0}+0.035</em>p_{1}+0.097<em>p_{2}+0.12</em>p_{3}+0.173*p_{4}\\approx 0.22,</span></p>

    <p class="text-gray-300">Table 9: Time Complexity of computing  <span class="math">B^{k&#x27;}(y)</span>  with counter vector  <span class="math">V_1&#x27;[x&#x27;]</span>  and boolean function  <span class="math">f&#x27;</span></p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Guess</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">x1 ⊕ k1, x3 ⊕ k3, x7 ⊕ k7</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">f'</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Related Bit</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Time</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

          </tr>

        </thead>

        <tbody>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">T1</td>

            <td class="px-3 py-2 border-b border-gray-700">T2</td>

            <td class="px-3 py-2 border-b border-gray-700">T3</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">k1, k3, k7</td>

            <td class="px-3 py-2 border-b border-gray-700">0,0,0</td>

            <td class="px-3 py-2 border-b border-gray-700">f00</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">28 × 7</td>

            <td class="px-3 py-2 border-b border-gray-700">211.19</td>

            <td class="px-3 py-2 border-b border-gray-700">213 × 7</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">0,0,1</td>

            <td class="px-3 py-2 border-b border-gray-700">f01</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">28 × 7</td>

            <td class="px-3 py-2 border-b border-gray-700">211.19</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">0,1,0</td>

            <td class="px-3 py-2 border-b border-gray-700">f10</td>

            <td class="px-3 py-2 border-b border-gray-700">k4</td>

            <td class="px-3 py-2 border-b border-gray-700">28 × 7</td>

            <td class="px-3 py-2 border-b border-gray-700">211.19</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">0,1,1</td>

            <td class="px-3 py-2 border-b border-gray-700">f11</td>

            <td class="px-3 py-2 border-b border-gray-700">k4</td>

            <td class="px-3 py-2 border-b border-gray-700">28 × 7</td>

            <td class="px-3 py-2 border-b border-gray-700">211.19</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">1,0,0</td>

            <td class="px-3 py-2 border-b border-gray-700">f00</td>

            <td class="px-3 py-2 border-b border-gray-700">k2</td>

            <td class="px-3 py-2 border-b border-gray-700">28 × 7</td>

            <td class="px-3 py-2 border-b border-gray-700">211.19</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">1,0,1</td>

            <td class="px-3 py-2 border-b border-gray-700">f01</td>

            <td class="px-3 py-2 border-b border-gray-700">k2</td>

            <td class="px-3 py-2 border-b border-gray-700">28 × 7</td>

            <td class="px-3 py-2 border-b border-gray-700">211.19</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">1,1,0</td>

            <td class="px-3 py-2 border-b border-gray-700">f10</td>

            <td class="px-3 py-2 border-b border-gray-700">k2.4</td>

            <td class="px-3 py-2 border-b border-gray-700">28 × 7</td>

            <td class="px-3 py-2 border-b border-gray-700">211.19</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">1,1,1</td>

            <td class="px-3 py-2 border-b border-gray-700">f11</td>

            <td class="px-3 py-2 border-b border-gray-700">k2.4</td>

            <td class="px-3 py-2 border-b border-gray-700">28 × 7</td>

            <td class="px-3 py-2 border-b border-gray-700">211.19</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">Total Time</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">((28 × 7 + 211.19) × 8 + 213 × 7) × 23 = 219.46</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

          </tr>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">Table 10: Relation between bias and success probability using  <span class="math">2^{31.19}</span>  data and setting advantage  <span class="math">a = 8</span></p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">ε2= 227.19</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">p0≈ 1.000</th>

          </tr>

        </thead>

        <tbody>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">ε2= 228.19</td>

            <td class="px-3 py-2 border-b border-gray-700">p1≈ 0.997</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">ε2= 229.19</td>

            <td class="px-3 py-2 border-b border-gray-700">p2≈ 0.864</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">ε2= 230.19</td>

            <td class="px-3 py-2 border-b border-gray-700">p3≈ 0.477</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">ε2= 231.19</td>

            <td class="px-3 py-2 border-b border-gray-700">p4≈ 0.188</td>

          </tr>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">and it is smaller than</p>

    <div class="my-4 text-center"><span class="math-block">(0. 0 1 2 + 0. 0 3 5) * p _ {0} + 0. 0 9 7 * p _ {1} + 0. 1 2 * p _ {2} + 0. 1 7 3 * p _ {3} \\approx 0. 3 3.</span></div>

    <p class="text-gray-300">There are 32 subkey bits involved in this attack. With our attack method, only about  <span class="math">6.25 + 6.25 = 12.5</span>  bits are guessed on average, which reduces the number of key bits greatly.</p>

    <p class="text-gray-300">Attack:</p>

    <ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">

      <li>Compress the  <span class="math">N</span>  plaintext-ciphertext pairs into the counter vector  <span class="math">V_{1}[x_{P}^{\\prime},x_{C}^{\\prime}]</span>  of size  <span class="math">2^{14 + 14}</span> .</li>

      <li>For each of  <span class="math">2^{14}x_{C}^{\\prime}</span></li>

    </ol>

    <p class="text-gray-300">(a) Call Procedure A. Store the counters according to  <span class="math">x_{C}^{\\prime}</span>  and  <span class="math">k_{P}^{\\prime}</span></p>

    <ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">

      <li>For each  <span class="math">k_P&#x27;</span>  of  <span class="math">2^{16}</span>  possible values.</li>

    </ol>

    <p class="text-gray-300">(a) Call procedure A. Store the counters according to  <span class="math">k_P&#x27;</span>  and  <span class="math">k_C&#x27;</span> .</p>

    <ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">

      <li>The keys with counter values ranked in the largest  <span class="math">2^{32 - 8} = 2^{24}</span>  values would be the right subkey candidates. Exploiting the key schedule and guessing some other bits, use two plaintext-ciphertext pairs to check the right key.</li>

    </ol>

    <p class="text-gray-300">Time:  <span class="math">(1)N = 2^{31.19}</span>  times compression (2)  <span class="math">2^{14} \\times 2^{19.46} = 2^{33.46}</span>  additions.  <span class="math">(3)2^{16} \\times 2^{19.46} = 2^{35.46}</span>  additions. So the time to compute the empirical bias for the subkeys involved is about  <span class="math">2^{35.84}</span>  while that given in [6] with similar linear hull is  <span class="math">2^{63.69}</span> . The time is improved significantly. Step (4) is to recovery the master key, which needs  <span class="math">2^{64 - 8} = 2^{56}</span>  21-round encryptions. However, [6] does not give this step.</p>

    <p class="text-gray-300">Also we implemented the 21-round attack on SIMON32 using  <span class="math">2^{31.19}</span>  plaintext-ciphertext pairs. (The exhaustive search part of the attack is not included since it would take about  <span class="math">2^{64 - 8} = 2^{56}</span>  encryptions, which takes too much time.) In the implementation, we set the main key randomly and collect  <span class="math">2^{31.19}</span>  plaintext-ciphertext pairs (data collection part), then use the dynamic key-guessing techniques to recover 8-bit key information for the 32 subkey bits (recovery part). We store the  <span class="math">2^{32 - 8} = 2^{24}</span>  keys with large bias in set  <span class="math">S</span>  as the right key candidates, then compute the real 32 subkey bits from the main key and check whether it is in  <span class="math">S</span> . In the implementation, about 5GB memory is needed. The data collection part ( <span class="math">2^{31.19}</span>  encryptions) takes about 11 minutes and the recovery part takes about 11 minutes too (using Intel(R) Xeon(R) CPU E5-2620, 2.00GHz). 1000 experiments were done and 277 of them were successful. This derives that the experimental success probability is about  <span class="math">27.7\\%</span> , which is consistent with the expected success probability.</p>

    <p class="text-gray-300">22-round attack on SIMON32/64. Add one more round before the 21-round attack, we can attack 22-round of SIMON32/64. There are 13 active key bits involved in round  <span class="math">i - 5</span> , which is  <span class="math">\\kappa_{1} = (K_{0}^{i - 5} -</span></p>

    <p class="text-gray-300"><span class="math">K_{3}^{i-5},K_{5}^{i-5},K_{7}^{i-5}-K_{12}^{i-5},K_{14}^{i-5},K_{15}^{i-5})</span>, to obtain the <span class="math">x</span> represented in Table 5. Attack:</p>

    <ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">

      <li>Guess each of <span class="math">2^{13}</span> <span class="math">\\kappa_{1}</span></li>

      <li>Encrypt the plaintexts by one round.</li>

      <li>Do as the first three steps in the 21-round attack</li>

      <li>The keys with counter values ranked in the largest <span class="math">2^{32+13-8}=2^{37}</span> values would be the right subkey candidates. Exploiting the key schedule and guessing some other bits, use two plaintex-ciphertext pairs to check the right key.</li>

    </ol>

    <p class="text-gray-300">Time: (1.a)<span class="math">2^{13}\\times N=2^{44.19}</span> one-round encryptions. (1.b) <span class="math">2^{13}\\times 2^{35.84}=2^{48.84}</span> additions. (2) Exhaustive phase needs about <span class="math">2^{64-8}=2^{56}</span> 22-round encryptions. So the total time is about <span class="math">2^{56}</span> 22-round encryptions and <span class="math">2^{48.84}</span> additions.</p>

    <h4 id="sec-14" class="text-lg font-semibold mt-6">4.2.3 23-round attack on Simon32/64.</h4>

    <p class="text-gray-300">Add one more round before and one round after the 21-round attack, we can attack 23-round of SIMON32/64. There are 13 active key bits involved in round <span class="math">i+17</span>, which is <span class="math">\\kappa_{2}=(K_{0}^{i+17}-K_{3}^{i+17},K_{5}^{i+17},</span> <span class="math">K_{7}^{i+17}-K_{12}^{i+17},K_{14}^{i+17},K_{15}^{i+17})</span>, to obtain the <span class="math">x</span> represented in Table 6. Attack:</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">1. Guess each of <span class="math">2^{13+13}</span> $\\kappa_{1}</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\kappa_{2}$</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">

      <li>Encrypt the plaintexts by one round and decrypt the ciphertexts by one round.</li>

      <li>Do as the first three steps in the 21-round attack</li>

      <li>The keys with counter values ranked in the largest <span class="math">2^{32+26-8}=2^{50}</span> values would be the right subkey candidates. Exploiting the key schedule and guessing some other bits, use two plaintex-ciphertext pairs to check the right key.</li>

    </ol>

    <p class="text-gray-300">Time: (1.a)<span class="math">2^{26}\\times N=2^{57.19}</span> two-round encryptions. (1.b) <span class="math">2^{26}\\times 2^{35.84}=2^{61.84}</span> additions. (2) Exhaustive phase needs about <span class="math">2^{64-8}=2^{56}</span> 23-round encryptions. So the total time complexity is about <span class="math">2^{56.3}</span> 23-round encryptions and <span class="math">2^{61.84}</span> additions.</p>

    <h3 id="sec-15" class="text-xl font-semibold mt-8">4.3 Improved Key Recovery Attack on Other Variants of Simon</h3>

    <p class="text-gray-300">With the dynamic key-guessing technique shown in above attack, we can also improve the linear hull attacks on all other variants of Simon. The linear hulls used are displayed in Table 3. For Simon48, we exploit the 22-round linear hull proposed in <em>[12]</em>, which covers most rounds up to date. For Simon64, the 21-round linear hull with potential <span class="math">2^{-62.53}</span> proposed in <em>[6]</em> is used in the attack. Also, the 31-round (resp. 40-round) linear hull for Simon96 (resp. Simon128) in <em>[6]</em> are used to attack corresponding variant. The detail of these attacks is given in Appendix B and the improved results for these variants are listed in Table 1.</p>

    <h3 id="sec-16" class="text-xl font-semibold mt-8">4.4 Multiple Linear Hull Attack on Simon</h3>

    <p class="text-gray-300">Combining multiple linear cryptanalysis <em>[19]</em> and linear hull together, one can make multiple linear hull attack with improved data complexity. Our attack technique can be used in the multiple linear hull attack of Simon well. According to the rotational property, Property 1, of Simon, lots of linear hulls with high potential can be found. For example, the two 13-round linear hulls for Simon32 in Table 3 are rotations of same linear hull.</p>

    <p class="text-gray-300">Suppose that the time to compute the bias for one linear hull is <span class="math">\\mathcal{T}_{1}</span> and data complexity is <span class="math">\\mathcal{N}</span>. If <span class="math">m</span> linear hulls with same bias are used in the multiple linear hull attack, the data complexity would be decreased to <span class="math">\\mathcal{N}/m</span>. But the time complexity would increase to <span class="math">m\\mathcal{T}_{1}+2^{\\mathcal{K}}</span>, where <span class="math">\\mathcal{K}</span> is the size of the independent key bits involved in all <span class="math">m</span> linear hull attacks. For example, there are 32 independent key bits involved in the 21-round attack of Simon32 with linear hull <span class="math">X_{L,5}^{i}\\rightarrow X_{R,13}^{i+13}</span>. The data complexity is <span class="math">2^{31.19}</span> known plaintext-ciphertext pairs and the time needs about <span class="math">2^{35.84}</span> additions to get the bias. When another linear hull <span class="math">X_{L,6}^{i}\\rightarrow X_{R,14}^{i+13}</span> is taken in to make a multiple linear hull attack, the data size will decrease to <span class="math">2^{30.19}</span>. There are also 32 independent key bits involved in this linear hull attack. But, the total independent key size of both linear hulls is 48. So the time to compute the bias for the multiple linear hull attack with above two linear hulls needs about <span class="math">2^{36.84}</span> additions and <span class="math">2^{48}</span> combinations.</p>

    <p class="text-gray-300">5 Conclusion</p>

    <p class="text-gray-300">In this paper, we gave the improved linear attacks on all the reduced versions of Simon family with dynamic key-guessing techniques. By establishing the boolean function of parity bit in the linear hull distinguisher and reducing the expressions of function according to the property of AND operation, we decrease the number of key bits involved in the attack and decrease the attack complexity in a further step. As a result, we can attack 23-round Simon32/64, 24-round Simon48/72, 25-round Simon8/96, 30-round Simon64/96, 31-round Simon64/128, 37-round Simon96/96, 38-round Simon96/144, 49-round Simon128/128, 51-round Simon128/192 and 53-round Simon128/256. The differential attack in <em>[14]</em> and our linear hull attack are bit-level cryptanalysis results, which provide the more efficient and precise security estimation results on Simon. It is mentioned that, the bit-level cryptanalysis combining with dynamic key-guessing techniques are applicable to more light-weight block ciphers and hash functions etc.</p>

    <h2 id="sec-17" class="text-2xl font-bold">References</h2>

    <ul class="list-disc list-inside space-y-1 text-gray-300 my-2 ml-4">

      <li>[1] Ray Beaulieu, Douglas Shors, Jason Smith, Stefan Treatman-Clark, Bryan Weeks, Louid Wingers. The Simon and Speck Families of Lightweight Block Ciphers. 2013</li>

      <li>[2] Mitsuru Matsui. Linear Cryptanalysis Method for DES Cipher. EUROCRYPT 1993, LNCS 765, pp. 386-397. Springer- Heidelberg, 1994</li>

      <li>[3] Mitsuru Matsui. The First Experimental Cryptanalysis of the Data Encryption Standard. CRYPTO 1994. LNCS 839, pp. 1-11. Springer- Heidelberg, 1994</li>

      <li>[4] Kaisa Nyberg. Linear Approximation of Block Ciphers. EUROCRYPT 1994, LNCS 950, pp. 439-444. Springer- Heidelberg, 1995</li>

      <li>[5] Ali Aydin Selçuk, Ali Biçak. On Probability of Success in Linear and Differential Cryptanalysis. SCN 2002. LNCS 2576, pp. 174-185. Springer- Heidelberg, 2003.</li>

      <li>[6] Mohamed Ahmed Abdelraheem, Javad Alizadeh, Hoda A. Alkhzaimi, Mohammad Resa Aref, Nasour Bagheri, Praveen Gauravaram, Martin M. Lauridsen. Improved Linear Cryptanalysis of Reduced-Round Simon. IACR Cryptology ePrint Archive 2014/681, 2014</li>

      <li>[7] Danping Shi, Lei Hu, Siwei Sun, Ling Song, Kexin Qiao, Xiaoshuang Ma. Improved Linear (Hull) Cryptanalysis of Round-reduced Versions of Simon. IACR Cryptology ePrint Archive 2014/973, 2014</li>

      <li>[8] Farzaneh Abed, Eik List, Stefan Lucks, and Jakob Wenzel. Differential Cryptanalysis of Reduced-Round Simon. IACR Cryptology ePrint Archive, 2013/526, 2013.</li>

      <li>[9] Farzaneh Abed, Eik List, Jakob Wenzel, and Stefan Lucks. Differential Cryptanalysis of Reduced-Round Simon and SPECK. In FSE (2014)</li>

      <li>[10] Alex Biryukov, Arnab Roy, and Vesselin Velichkov. Differential analysis of block ciphers SIMON and SPECK. FSE 2014</li>

      <li>[11] Siwei Sun, Lei Hu, Peng Wang, Kexin Qiao, Xiaoshuang Ma, Ling Song. Automatic Security Evaluation and (Related-Key) Differential Characteristic Search: Application to SIMON, PRESENT, LBlock, DES(L) and Other Bit-Oriented Block Ciphers. ASIACRYPT 2014, LNCS 8873, pp. 158-178. Springer- Heidelberg, 2014</li>

      <li>[12] Siwei Sun, Lei Hu, Meiqin Wang, Peng Wang, Kexin Qiao, Xiaoshuang Ma, Danping Ma, Ling Song, Kai Fu. Towards Finding the Best Characteristics of Some Bit-oriented Block Ciphers and Automatic Enumeration of (Related-Key) Differential and Linear Characteristics with Predefined Properties and Its Applications. IACR Cryptology ePrint Archive 2014/747, 2014</li>

      <li>[13] Hoda A. Alkhzaimi, Martin M. Lauridsen. Cryptanalysis of the SIMON Family of Block Ciphers. IACR Cryptology ePrint Archive 2013, 543 (2013)</li>

      <li>[14] Ning Wang, Xiaoyun Wang, Keting Jia, Jingyuan Zhao. Differential Attacks on Reduced SIMON Versions with Dynamic Key-guessing Techniques. IACR Cryptology ePrint Archive 2014, 448 (2014)</li>

      <li>[15] Javad Alizadeh, Hoda A. Alkhzaimi, Mohammad Reza Aref, Nasour Begheri, Paraveen Gauravaram, Abhishek Kumar, Martin M. Lauridsen, and Somitra Kumar Sanadhya. Cryptanalysis of SIMON Variants with Connections. In RFIDsec’14, LNCS, 8651, pp.1-20. Springer- Heidelberg, 2014.</li>

      <li>[16] Qingju Wang, Zhiqiang Liu, Kerem Varıcı, Yu Sasaki, Vincent Rijmen, and Yosuke Todo. Cryptanalysis of Reudced-round SIMON32 and SIMON48. INDOCRYPT 2014.</li>

      <li>[17] Zhan Chen, Ning Wang, Xiaoyun Wang. Impossible Differential Cryptanalysis of Reduced Round SIMON. IACR Cryptology ePrint Archive 2015/286 (2015)</li>

      <li>[18] Boura, C., Naya-Plasencia, M., Suder, V. Scrutinzing and improving impossible differential attacks: Applications to Clefia, Camellia, Lblock and Simon. ASIACRYPT 2014. pp. 179-199. Springer- Heidelberg, 2014</li>

    </ul>

    <ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">

      <li>Alex Biryukov, Christophe De Cannière, Michael Quisquater. On Multiple Linear Approximations. CRYPTO 2004, LNCS 3152, pp. 1-22, Springer-Heidelberg, 2004</li>

      <li>Tomer Asgur. Improved Linear Trails for the Block Cipher SIMON. IACR Cryptology ePrint Archive 2015/285 (2015)</li>

    </ol>

    <p class="text-gray-300">In this section, we give the time complexities of computing the counters  <span class="math">B^{k}(y)</span>  for some simple functions of  <span class="math">y = f(x,k)</span> . This would be the deepest layer's operation in the linear attack to SIMON. Notice in the following, 'Guess' denotes the bits guessed at first. The second column  <span class="math">x_{i} \\oplus k_{i}</span>  denotes the value of  <span class="math">x_{i}</span>  which is used in the splitting phase. The third column denotes the new representation of the target function according to the value of  <span class="math">x_{i} \\oplus k_{i}</span> . 'RB' is the related bit (defined in Section 3).  <span class="math">T_{1}</span>  denotes the time of separation of the plaintexts according to the guessed bit of  <span class="math">k</span> .  <span class="math">T_{2}</span>  denotes the time of computation in the inner part.  <span class="math">T_{3}</span>  is the time in the combination phase. Total Time is the final time complexity, which is twice of the sum of all  <span class="math">T_{1}, T_{2}</span>  and  <span class="math">T_{3}</span> . Notice that  <span class="math">T_{1}, T_{2}</span>  and  <span class="math">T_{3}</span>  represent the number of addition operations. For simplicity, we denote  <span class="math">f^{<em>}</span>  the function with same form of  <span class="math">f</span> . For example, if  <span class="math">f_{1} = (x_{0} \\oplus k_{0})\\&amp;amp;(x_{1} \\oplus k_{1})</span>  and  <span class="math">f_{1}&#x27; = (x_{0} \\oplus k_{0})\\&amp;amp;(x_{3} \\oplus k_{3})</span> , we say  <span class="math">f_{1}&#x27;</span>  is with form  <span class="math">f_{1}^{</em>}</span> . The calculation of  <span class="math">B(y)</span>  for the functions with same form have same procedures and time complexities.</p>

    <ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">

      <li><span class="math">f_{1} = (x_{0}\\oplus k_{0})\\&amp;amp; (x_{1}\\oplus k_{1})</span></li>

    </ol>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Guess</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">x0 ⊕ k0</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">f1</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">RB</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">T1</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">T2</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">T3</th>

          </tr>

        </thead>

        <tbody>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">k0</td>

            <td class="px-3 py-2 border-b border-gray-700">0</td>

            <td class="px-3 py-2 border-b border-gray-700">0</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">1</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">2</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">1</td>

            <td class="px-3 py-2 border-b border-gray-700">0</td>

            <td class="px-3 py-2 border-b border-gray-700">k1</td>

            <td class="px-3 py-2 border-b border-gray-700">1</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">Total Time</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">2 × (1 + 1 + 2) = 23</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

          </tr>

        </tbody>

      </table>

    </div>

    <ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">

      <li><span class="math">f_{2} = ((x_{0}\\oplus k_{0})\\oplus ((x_{1}\\oplus k_{1})\\&amp;amp; (x_{2}\\oplus k_{2})))\\&amp;amp; ((x_{3}\\oplus k_{3})\\oplus ((x_{1}\\oplus k_{1})\\&amp;amp; (x_{4}\\oplus k_{4})))</span></li>

    </ol>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Guess</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">x1 ⊕ k1</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">f2</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">RB</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">T1</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">T2</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">T3</th>

          </tr>

        </thead>

        <tbody>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">k1</td>

            <td class="px-3 py-2 border-b border-gray-700">0</td>

            <td class="px-3 py-2 border-b border-gray-700">f1*</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">22 × 3</td>

            <td class="px-3 py-2 border-b border-gray-700">23</td>

            <td class="px-3 py-2 border-b border-gray-700">24</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">1</td>

            <td class="px-3 py-2 border-b border-gray-700">f1*</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">22 × 3</td>

            <td class="px-3 py-2 border-b border-gray-700">23</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">Total Time</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">2 × ((22 × 3 + 23) × 2 + 24) = 26.46</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

          </tr>

        </tbody>

      </table>

    </div>

    <ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">

      <li><span class="math">f_{3} = ((x_{0}\\oplus k_{0})\\&amp;amp; (x_{1}\\oplus k_{1}))\\oplus ((x_{2}\\oplus k_{2})\\oplus ((x_{3}\\oplus k_{3})\\&amp;amp; (x_{4}\\oplus k_{4})))\\&amp;amp; ((x_{5}\\oplus k_{5})\\oplus ((x_{3}\\oplus k_{3})\\&amp;amp; (x_{6}\\oplus k_{6})))</span></li>

    </ol>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Guess</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">x0 ⊕ k0</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">f3</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">RB</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">T1</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">T2</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">T3</th>

          </tr>

        </thead>

        <tbody>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">k0</td>

            <td class="px-3 py-2 border-b border-gray-700">0</td>

            <td class="px-3 py-2 border-b border-gray-700">f2*</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">25 × 1</td>

            <td class="px-3 py-2 border-b border-gray-700">26.46</td>

            <td class="px-3 py-2 border-b border-gray-700">26</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">1</td>

            <td class="px-3 py-2 border-b border-gray-700">f2*</td>

            <td class="px-3 py-2 border-b border-gray-700">k1</td>

            <td class="px-3 py-2 border-b border-gray-700">25 × 1</td>

            <td class="px-3 py-2 border-b border-gray-700">26.46</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">Total Time</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">2 × ((25 × 1 + 26.46) × 2 + 26) = 29.25</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

          </tr>

        </tbody>

      </table>

    </div>

    <ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">

      <li><span class="math">f_{4} = (x_{0}\\oplus k_{0})\\oplus (x_{1}\\oplus k_{1})\\&amp;amp; (x_{2}\\oplus k_{2})</span></li>

    </ol>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Guess</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">x0</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">f4</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">RB</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">T1</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">T2</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">T3</th>

          </tr>

        </thead>

        <tbody>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">f1*</td>

            <td class="px-3 py-2 border-b border-gray-700">k0</td>

            <td class="px-3 py-2 border-b border-gray-700">22 × 1</td>

            <td class="px-3 py-2 border-b border-gray-700">23</td>

            <td class="px-3 py-2 border-b border-gray-700">23</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">Total Time</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">22 + 23 + 23 = 24.32</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

          </tr>

        </tbody>

      </table>

    </div>

    <ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">

      <li><span class="math">f_{5} = (x_{0}\\oplus k_{0})\\&amp;amp; ((x_{1}\\oplus k_{1})\\oplus (x_{2}\\oplus k_{2})\\&amp;amp; (x_{3}\\oplus k_{3}))</span></li>

    </ol>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Guess</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">x0 ⊕ k0</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">f5</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">RB</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">T1</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">T2</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">T3</th>

          </tr>

        </thead>

        <tbody>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">k0</td>

            <td class="px-3 py-2 border-b border-gray-700">0</td>

            <td class="px-3 py-2 border-b border-gray-700">0</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">23 - 1</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">23</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">1</td>

            <td class="px-3 py-2 border-b border-gray-700">f4*</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">24.32</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">Total Time</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">2 × (23 - 1 + 24.32 + 23) = 25.64</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

          </tr>

        </tbody>

      </table>

    </div>

    <ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">

      <li><span class="math">f_{6} = ((x_{0}\\oplus k_{0})\\&amp;amp; (x_{1}\\oplus k_{1}))\\oplus ((x_{2}\\oplus k_{2})\\oplus ((x_{3}\\oplus k_{3})\\&amp;amp; (x_{1}\\oplus k_{1})))\\&amp;amp; ((x_{4}\\oplus k_{4})\\oplus ((x_{3}\\oplus k_{3})\\&amp;amp; (x_{5}\\oplus k_{5})))</span></li>

    </ol>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Guess</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">x1 ⊕ k1</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">f6</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">RB</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">T1</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">T2</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">T3</th>

          </tr>

        </thead>

        <tbody>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">k1</td>

            <td class="px-3 py-2 border-b border-gray-700">0</td>

            <td class="px-3 py-2 border-b border-gray-700">f5*</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">24 × 1</td>

            <td class="px-3 py-2 border-b border-gray-700">25.64</td>

            <td class="px-3 py-2 border-b border-gray-700">25</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">1</td>

            <td class="px-3 py-2 border-b border-gray-700">f5*</td>

            <td class="px-3 py-2 border-b border-gray-700">k0</td>

            <td class="px-3 py-2 border-b border-gray-700">24 × 1</td>

            <td class="px-3 py-2 border-b border-gray-700">25.64</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">Total Time</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">2 × ((24 + 25.64) × 2 + 25) = 28.36</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

          </tr>

        </tbody>

      </table>

    </div>

    <ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">

      <li><span class="math">f_{7} = [x_{0}\\oplus k_{0}\\oplus ((x_{1}\\oplus k_{1})\\&amp;amp; (x_{2}\\oplus k_{2}))\\oplus ((x_{3}\\oplus k_{3}\\oplus ((x_{4}\\oplus k_{4})\\&amp;amp; (x_{5}\\oplus k_{5})))\\&amp;amp; (x_{6}\\oplus k_{6}\\oplus ((x_{5}\\oplus k_{5})\\&amp;amp; (x_{7}\\oplus k_{7})))]\\&amp;amp;</span> <span class="math">[x_8\\oplus k_8\\oplus ((x_2\\oplus k_2)\\&amp;amp; (x_9\\oplus k_9))\\oplus ((x_6\\oplus k_6\\oplus ((x_5\\oplus k_5)\\&amp;amp; (x_7\\oplus k_7)))\\&amp;amp; (x_{10}\\oplus k_{10}\\oplus ((x_7\\oplus k_7)\\&amp;amp; (x_{11}\\oplus k_{11}))))]</span></li>

    </ol>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Guess</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">x2 ⊕ k2, x5 ⊕ k5, x7 ⊕ k7</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">f7</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">RB</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">T1</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">T2</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">T3</th>

          </tr>

        </thead>

        <tbody>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">k2, k5, k7</td>

            <td class="px-3 py-2 border-b border-gray-700">0,0,0</td>

            <td class="px-3 py-2 border-b border-gray-700">f2*</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">25 × (24 - 1)</td>

            <td class="px-3 py-2 border-b border-gray-700">26.46</td>

            <td class="px-3 py-2 border-b border-gray-700">29 × 7</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">0,0,1</td>

            <td class="px-3 py-2 border-b border-gray-700">f2*</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">25 × (24 - 1)</td>

            <td class="px-3 py-2 border-b border-gray-700">26.46</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">0,1,0</td>

            <td class="px-3 py-2 border-b border-gray-700">f2*</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">25 × (24 - 1)</td>

            <td class="px-3 py-2 border-b border-gray-700">26.46</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">0,1,1</td>

            <td class="px-3 py-2 border-b border-gray-700">f2*</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">25 × (24 - 1)</td>

            <td class="px-3 py-2 border-b border-gray-700">26.46</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">1,0,0</td>

            <td class="px-3 py-2 border-b border-gray-700">f2*</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">25 × (24 - 1)</td>

            <td class="px-3 py-2 border-b border-gray-700">26.46</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">1,0,1</td>

            <td class="px-3 py-2 border-b border-gray-700">f2*</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">25 × (24 - 1)</td>

            <td class="px-3 py-2 border-b border-gray-700">26.46</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">1,1,0</td>

            <td class="px-3 py-2 border-b border-gray-700">f2*</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">25 × (24 - 1)</td>

            <td class="px-3 py-2 border-b border-gray-700">26.46</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">1,1,1</td>

            <td class="px-3 py-2 border-b border-gray-700">f2*</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">25 × (24 - 1)</td>

            <td class="px-3 py-2 border-b border-gray-700">26.46</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">Total Time</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">23 × ((25 × (24 - 1) + 26.46) × 8 + 29 × 7) = 215.99</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

          </tr>

        </tbody>

      </table>

    </div>

    <ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">

      <li><span class="math">f_{8} = f_{7}\\oplus ((x_{12}\\oplus k_{12}\\oplus ((x_{1}\\oplus k_{1})\\&amp;amp; (x_{2}\\oplus k_{2})))\\&amp;amp; (x_{13}\\oplus k_{13}\\oplus ((x_{2}\\oplus k_{2})\\&amp;amp; (x_{9}\\oplus k_{9}))))</span></li>

    </ol>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Guess</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">x2 ⊕ k2, x5 ⊕ k5, x7 ⊕ k7</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">f8</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">RB</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">T1</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">T2</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">T3</th>

          </tr>

        </thead>

        <tbody>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">k2, k5, k7</td>

            <td class="px-3 py-2 border-b border-gray-700">0,0,0</td>

            <td class="px-3 py-2 border-b border-gray-700">f3*</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">27 × (24 - 1)</td>

            <td class="px-3 py-2 border-b border-gray-700">29.25</td>

            <td class="px-3 py-2 border-b border-gray-700">211 × 7</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">0,0,1</td>

            <td class="px-3 py-2 border-b border-gray-700">f3*</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">27 × (24 - 1)</td>

            <td class="px-3 py-2 border-b border-gray-700">29.25</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">0,1,0</td>

            <td class="px-3 py-2 border-b border-gray-700">f3*</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">27 × (24 - 1)</td>

            <td class="px-3 py-2 border-b border-gray-700">29.25</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">0,1,1</td>

            <td class="px-3 py-2 border-b border-gray-700">f3*</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">27 × (24 - 1)</td>

            <td class="px-3 py-2 border-b border-gray-700">29.25</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">1,0,0</td>

            <td class="px-3 py-2 border-b border-gray-700">f3*</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">27 × (24 - 1)</td>

            <td class="px-3 py-2 border-b border-gray-700">29.25</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">1,0,1</td>

            <td class="px-3 py-2 border-b border-gray-700">f3*</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">27 × (24 - 1)</td>

            <td class="px-3 py-2 border-b border-gray-700">29.25</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">1,1,0</td>

            <td class="px-3 py-2 border-b border-gray-700">f3*</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">27 × (24 - 1)</td>

            <td class="px-3 py-2 border-b border-gray-700">29.25</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">1,1,1</td>

            <td class="px-3 py-2 border-b border-gray-700">f3*</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">27 × (24 - 1)</td>

            <td class="px-3 py-2 border-b border-gray-700">29.25</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">Total Time</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">23 × ((27 × (24 - 1) + 29.25) × 8 + 211 × 7) = 218.08</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

          </tr>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">Case 1 gives the time complexity when  <span class="math">y = f(x, k) = (x_0 \\oplus k_0) \\&amp;amp; (x_1 \\oplus k_1)</span> . We explain Case 2 in detail and the others are similar.  <span class="math">f_2</span>  is a function of 5-bit value  <span class="math">x</span>  and  <span class="math">k</span> . Suppose  <span class="math">V[x]</span>  denotes the number of  <span class="math">x</span> . After  <span class="math">k_1</span>  is guessed, the representation of  <span class="math">f_2</span>  will be simplified for  <span class="math">x_1 = k_1</span>  and  <span class="math">x_1 = k_1 \\oplus 1</span> . If  <span class="math">x_1 = k_1</span> , there is  <span class="math">f_2 = f_2^0 = (x_0 \\oplus k_0) \\&amp;amp; (x_3 \\oplus k_3)</span>  which is with form  <span class="math">f_1 <em></span> . Initialize a new counter vector  <span class="math">V_0[x^0]</span>  where  <span class="math">x^0</span>  is of 2-bit. Set  <span class="math">V_0[x^0] = \\sum_{x_0 = x_0^0, x_3 = x_1^0, x_1 = k_1} V[x]</span> . There are three additions for each  <span class="math">x^0</span>  and in total  <span class="math">T_1 = 2^2 \\times 3</span> . If  <span class="math">x_1 = k_1 \\oplus 1</span> , there is  <span class="math">f_2 = f_2^1 = (x_{0,2} \\oplus k_{0,2}) \\&amp;amp; (x_{3,4} \\oplus k_{3,4})</span>  which is also with form  <span class="math">f_1 </em></span> . Similarly, initialize a new counter vector  <span class="math">V_1[x^1]</span>  where  <span class="math">x^1</span>  is of 2-bit. Set  <span class="math">V_1[x^1] = \\sum_{x_{0,2} = x_0^1, x_{3,4} = x_1^1, x_1 = k_1 \\oplus 1} V[x]</span> . There are three additions for each  <span class="math">x^1</span>  and in total  <span class="math">T_1 = 2^2 \\times 3</span> . The function in the inner part is with form  <span class="math">f_1 *</span>  for both situations and it is easy to know  <span class="math">T_2 = 2^3</span>  according to Case 1. Let  <span class="math">B_0^{k_0, k_3}(y)</span>  be the  <span class="math">B(y)</span>  with counter vector  <span class="math">V_0</span>  and function  <span class="math">f_2^0</span>  for  <span class="math">k_0, k_3</span> . Let  <span class="math">B_1^{k_{0,2}, k_{3,4}}(y)</span>  be the  <span class="math">B(y)</span>  with counter vector  <span class="math">V_1</span>  and function  <span class="math">f_2^1</span>  for  <span class="math">k_{0,2}, k_{3,4}</span> . When  <span class="math">k_1</span>  is fixed,  <span class="math">B(y)</span>  for  <span class="math">k</span>  is  <span class="math">B_0^{k_0, k_3}(y) + B_1^{k_{0,2}, k_{3,4}}(y)</span> . Since there are 4 independent bits of  <span class="math">k</span>  when  <span class="math">k_1</span>  is fixed, leading to  <span class="math">T_3 = 2^4</span> , which is the complexity of combination. In total, the time is twice of  <span class="math">(2^2 + 2^3) + 2^4</span> , since there are two possible guesses for  <span class="math">k_1</span> .</p>

    <p class="text-gray-300">The related bit (RB) is generated in linear compression. For example in Case 3, when  <span class="math">x_0 \\oplus k_0 = 1</span> ,  <span class="math">f_3</span>  is linear with  <span class="math">x_1 \\oplus k_1</span> . As explained in Section 3,  <span class="math">x_1</span>  is compressed and  <span class="math">k_1</span>  becomes a related bit. In Case 4, linear compression is done before any key guess, leading to the compression of bit  <span class="math">x_0</span>  and generation of related bit  <span class="math">k_0</span> .</p>

    <p class="text-gray-300">The linear hull we used to attack SIMON48/K is</p>

    <div class="my-4 text-center"><span class="math-block">X _ {L, 1} ^ {i} \\oplus X _ {L, 5} ^ {i} \\oplus X _ {L, 2 1} ^ {i} \\oplus X _ {R, 2 3} ^ {i} \\rightarrow X _ {L, 1} ^ {i + 1 6} \\oplus X _ {L, 5} ^ {i + 1 6} \\oplus X _ {R, 2 3} ^ {i + 1 6}</span></div>

    <p class="text-gray-300">which is proposed in [12], with potential  <span class="math">\\bar{\\epsilon}^2 = 2^{-44.92}</span> .</p>

    <p class="text-gray-300">Table 11: 3 rounds before  <span class="math">{X}_{L,1}^{i} \\oplus  {X}_{L,5}^{i} \\oplus  {X}_{L,{21}}^{i} \\oplus  {X}_{R,{23}}^{i}</span>  for SIMON48</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">x0</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">X1-3L,15 ⊕ X1-3R,17 ⊕ (X1-3L,16 & X1-3L,9) ⊕ X1-3R,5 ⊕ (X1-3L,4 & X1-3L,21) ⊕ X1-3R,21 ⊕ (X1-3L,20 & X1-3L,13)</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">k0</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">K3i-2 ⊕ K1i-3 ⊕ K1i-2 ⊕ K1i-1 ⊕ K5i-3 ⊕ K2i-3 ⊕ K5i-1 ⊕ K2i-1</th>

          </tr>

        </thead>

        <tbody>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">x1</td>

            <td class="px-3 py-2 border-b border-gray-700">X1-3L,0 ⊕ X1-3R,2 ⊕ (X1-3L,1 & X1-3L,18)</td>

            <td class="px-3 py-2 border-b border-gray-700">k1</td>

            <td class="px-3 py-2 border-b border-gray-700">K2i-3</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">x2</td>

            <td class="px-3 py-2 border-b border-gray-700">X1-3L,17 ⊕ X1-3R,19 ⊕ (X1-3L,18 & X1-3L,11)</td>

            <td class="px-3 py-2 border-b border-gray-700">k2</td>

            <td class="px-3 py-2 border-b border-gray-700">K1i-3</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">x3</td>

            <td class="px-3 py-2 border-b border-gray-700">X1-3L,16 ⊕ X1-3R,18 ⊕ (X1-3L,1 & X1-3L,10)</td>

            <td class="px-3 py-2 border-b border-gray-700">k3</td>

            <td class="px-3 py-2 border-b border-gray-700">K1i-3</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">x4</td>

            <td class="px-3 py-2 border-b border-gray-700">X1-3L,9 ⊕ X1-3R,11 ⊕ (X1-3L,10 & X1-3L,3)</td>

            <td class="px-3 py-2 border-b border-gray-700">k4</td>

            <td class="px-3 py-2 border-b border-gray-700">K1i-3</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">x5</td>

            <td class="px-3 py-2 border-b border-gray-700">X1-3L,20 ⊕ X1-3R,22 ⊕ (X1-3L,21 & X1-3L,14) ⊕ X1-3L,0</td>

            <td class="px-3 py-2 border-b border-gray-700">k5</td>

            <td class="px-3 py-2 border-b border-gray-700">K2i-3 ⊕ K0i-2</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">x6</td>

            <td class="px-3 py-2 border-b border-gray-700">X1-3L,21 ⊕ X1-3R,23 ⊕ (X1-3L,22 & X1-3L,15)</td>

            <td class="px-3 py-2 border-b border-gray-700">k6</td>

            <td class="px-3 py-2 border-b border-gray-700">K2i-3</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">x7</td>

            <td class="px-3 py-2 border-b border-gray-700">X1-3L,14 ⊕ X1-3R,16 ⊕ (X1-3L,15 & X1-3L,8)</td>

            <td class="px-3 py-2 border-b border-gray-700">k7</td>

            <td class="px-3 py-2 border-b border-gray-700">K1i-3</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">x8</td>

            <td class="px-3 py-2 border-b border-gray-700">X1-3L,13 ⊕ X1-3R,15 ⊕ (X1-3L,14 & X1-3L,7) ⊕ X1-3L,17</td>

            <td class="px-3 py-2 border-b border-gray-700">k8</td>

            <td class="px-3 py-2 border-b border-gray-700">K1i-3 ⊕ K1i-2</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">x9</td>

            <td class="px-3 py-2 border-b border-gray-700">X1-3L,7 ⊕ X1-3R,9 ⊕ (X1-3L,8 & X1-3L,1)</td>

            <td class="px-3 py-2 border-b border-gray-700">k9</td>

            <td class="px-3 py-2 border-b border-gray-700">K9i-3</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">x10</td>

            <td class="px-3 py-2 border-b border-gray-700">X1-3L,0 ⊕ X1-3R,2 ⊕ (X1-3L,1 & X1-3L,3) ⊕ X1-3L,4</td>

            <td class="px-3 py-2 border-b border-gray-700">k10</td>

            <td class="px-3 py-2 border-b border-gray-700">K2i-3 ⊕ K4i-2</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">x11</td>

            <td class="px-3 py-2 border-b border-gray-700">X1-3L,1 ⊕ X1-3R,3 ⊕ (X1-3L,2 & X1-3L,19)</td>

            <td class="px-3 py-2 border-b border-gray-700">k11</td>

            <td class="px-3 py-2 border-b border-gray-700">K3i-3</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">x12</td>

            <td class="px-3 py-2 border-b border-gray-700">X1-3L,18 ⊕ X1-3R,20 ⊕ (X1-3L,19 & X1-3L,12)</td>

            <td class="px-3 py-2 border-b border-gray-700">k12</td>

            <td class="px-3 py-2 border-b border-gray-700">K2i-3</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">x13</td>

            <td class="px-3 py-2 border-b border-gray-700">X1-3L,17 ⊕ X1-3R,19 ⊕ (X1-3L,18 & X1-3L,11) ⊕ X1-3L,21</td>

            <td class="px-3 py-2 border-b border-gray-700">k13</td>

            <td class="px-3 py-2 border-b border-gray-700">K1i-3</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">x14</td>

            <td class="px-3 py-2 border-b border-gray-700">X1-3L,11 ⊕ X1-3R,13 ⊕ (X1-3L,12 & X1-3L,5)</td>

            <td class="px-3 py-2 border-b border-gray-700">k14</td>

            <td class="px-3 py-2 border-b border-gray-700">K1i-3</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">x15</td>

            <td class="px-3 py-2 border-b border-gray-700">X1-3L,16 ⊕ X1-3R,18 ⊕ (X1-3L,17 & X1-3L,10) ⊕ X1-3L,20</td>

            <td class="px-3 py-2 border-b border-gray-700">k15</td>

            <td class="px-3 py-2 border-b border-gray-700">K1i-3</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">x16</td>

            <td class="px-3 py-2 border-b border-gray-700">X1-3L,10 ⊕ X1-3R,12 ⊕ (X1-3L,11 & X1-3L,4)</td>

            <td class="px-3 py-2 border-b border-gray-700">k16</td>

            <td class="px-3 py-2 border-b border-gray-700">K1i-2</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">x17</td>

            <td class="px-3 py-2 border-b border-gray-700">X1-3L,9 ⊕ X1-3R,11 ⊕ (X1-3L,10 & X1-3L,3) ⊕ X1-3L,13</td>

            <td class="px-3 py-2 border-b border-gray-700">k17</td>

            <td class="px-3 py-2 border-b border-gray-700">K1i-3</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">x18</td>

            <td class="px-3 py-2 border-b border-gray-700">X1-3L,3 ⊕ X1-3R,5 ⊕ (X1-3L,4 & X1-3L,21)</td>

            <td class="px-3 py-2 border-b border-gray-700">k18</td>

            <td class="px-3 py-2 border-b border-gray-700">K5i-3</td>

          </tr>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">Similar to the attack on SIMON32, at first we give the procedure to compress the plaintexts, then the procedure to compress the ciphertexts. Add 3 rounds before the distinguisher. According to the representations for  <span class="math">x, k</span>  in Table 11,  <span class="math">X_{L,1}^{i} \\oplus X_{L,5}^{i} \\oplus X_{L,21}^{i} \\oplus X_{R,23}^{i}</span>  can be represented as</p>

    <p class="text-gray-300"><span class="math">x_0\\oplus k_0\\oplus ((x_1\\oplus k_1)\\&amp;amp; (x_2\\oplus k_2))\\oplus ((x_3\\oplus k_3)\\&amp;amp; (x_4\\oplus k_4))\\oplus</span></p>

    <p class="text-gray-300"><span class="math">((x_{5}\\oplus k_{5}\\oplus ((x_{6}\\oplus k_{6})\\&amp;amp; (x_{7}\\oplus k_{7})))\\&amp;amp; (x_{8}\\oplus k_{8}\\oplus ((x_{7}\\oplus k_{7})\\&amp;amp; (x_{9}\\oplus k_{9}))))\\oplus</span></p>

    <p class="text-gray-300"><span class="math">((x_{10}\\oplus k_{10}\\oplus ((x_{11}\\oplus k_{11})\\&amp;amp; (x_{12}\\oplus k_{12})))\\&amp;amp; (x_{13}\\oplus k_{13}\\oplus ((x_{12}\\oplus k_{12})\\&amp;amp; (x_{14}\\oplus k_{14}))))\\oplus</span></p>

    <p class="text-gray-300"><span class="math">((x_{15}\\oplus k_{15}\\oplus ((x_{2}\\oplus k_{2})\\&amp;amp; (x_{16}\\oplus k_{16})))\\&amp;amp; (x_{17}\\oplus k_{17}\\oplus ((x_{16}\\oplus k_{16})\\&amp;amp; (x_{18}\\oplus k_{18}))))</span></p>

    <p class="text-gray-300">Compress the plaintexts: (Procedure SIMON48-Head) At first compress the data samples into a counter vector  <span class="math">V[x_1 - x_{18}]</span> , then DO</p>

    <ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">

      <li>For each  <span class="math">x_{3} - x_{14}</span></li>

    </ol>

    <p class="text-gray-300">(a) Guess the keys related to  <span class="math">x_{1} - x_{2}, x_{15} - x_{18}</span>  and compress  <span class="math">x_{1} - x_{2}, x_{15} - x_{18}</span>  as the Case  <span class="math">f_{6}</span>  in Appendix A. There are 6-bit keys  <span class="math">(k_{1} - k_{2}, k_{15} - k_{18})</span>  to store, and the time is about  <span class="math">2^{8.36}</span> . So here the memory is about  <span class="math">2^{6} \\times 2^{12}</span>  counters, and the total time is about  <span class="math">2^{12} \\times 2^{8.36} = 2^{20.36}</span> .</p>

    <ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">

      <li>For each key  <span class="math">k_{1} - k_{2}, k_{15} - k_{18}</span></li>

    </ol>

    <p class="text-gray-300">(a) For each  <span class="math">x_{10} - x_{14}</span></p>

    <p class="text-gray-300">i. Guess the keys related to  <span class="math">x_{3} - x_{9}</span>  and compress  <span class="math">x_{3} - x_{9}</span>  as Case  <span class="math">f_{3}</span>  in Appendix A. There are 7-bit keys  <span class="math">(k_{3} - k_{9})</span>  to store, and the time is about  <span class="math">2^{9.25}</span> . So here the memory is about  <span class="math">2^{6 + 7} \\times 2^{5}</span>  counters, and the total time is about  <span class="math">2^{6 + 5} \\times 2^{9.25} = 2^{20.25}</span> .</p>

    <ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">

      <li>For each key  <span class="math">k_{1} - k_{9}, k_{15} - k_{18}</span></li>

    </ol>

    <p class="text-gray-300">(a) Guess the keys related to  <span class="math">x_{10} - x_{14}</span>  and compress  <span class="math">x_{10} - x_{14}</span>  as Case  <span class="math">f_{2}</span>  in Appendix A. There are 5-bit keys  <span class="math">(k_{10} - k_{14})</span>  to store, and the time is about  <span class="math">2^{6.46}</span> . So here the memory is about  <span class="math">2^{13 + 5}</span>  counters, and the total time is about  <span class="math">2^{13} \\times 2^{6.46} = 2^{19.46}</span> .</p>

    <ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">

      <li>Total time is  <span class="math">2^{20.36} + 2^{20.25} + 2^{19.46} = 2^{21.66}</span>  additions. Memory is about  <span class="math">O(2^{18})</span> .</li>

    </ol>

    <p class="text-gray-300">Table 12: 4 rounds after  <span class="math">{X}_{L,1}^{i + {16}} \\oplus  {X}_{L,5}^{i + {16}} \\oplus  {X}_{R,{23}}^{i + {16}}</span>  for SIMON48</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">x0</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">XR,3+20 ⊕ XL,5+20 ⊕ (XR,4+20 & XR,21) ⊕ XR,3+20 ⊕ XR,15 ⊕ XL,17 ⊕ (XR,16 & XR,9) ⊕ XL,21 ⊕ (XR,20 & XR,13)</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">k0</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">K1+19 ⊕ K1+17 ⊕ K23+16 K1+19 ⊕ K5+19 ⊕ K3+18 ⊕ K5+17 K17+19 ⊕ K21+19 ⊕ K19+18 ⊕ K21+17</th>

          </tr>

        </thead>

        <tbody>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">x1</td>

            <td class="px-3 py-2 border-b border-gray-700">XR,16+20 ⊕ XL,18 ⊕ (XR,17 & XR,10)</td>

            <td class="px-3 py-2 border-b border-gray-700">k1</td>

            <td class="px-3 py-2 border-b border-gray-700">K18+19</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">x2</td>

            <td class="px-3 py-2 border-b border-gray-700">XR,9+20 ⊕ XL,11 ⊕ (XR,10 & XR,3)</td>

            <td class="px-3 py-2 border-b border-gray-700">k2</td>

            <td class="px-3 py-2 border-b border-gray-700">K11+19</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">x3</td>

            <td class="px-3 py-2 border-b border-gray-700">XR,0+20 ⊕ XL,3 ⊕ (XR,1 & XR,18)</td>

            <td class="px-3 py-2 border-b border-gray-700">k3</td>

            <td class="px-3 py-2 border-b border-gray-700">K5+19</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">x4</td>

            <td class="px-3 py-2 border-b border-gray-700">XR,17+20 ⊕ XL,19 ⊕ (XR,18 & XR,11)</td>

            <td class="px-3 py-2 border-b border-gray-700">k4</td>

            <td class="px-3 py-2 border-b border-gray-700">K19+19</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">x5</td>

            <td class="px-3 py-2 border-b border-gray-700">XR,20+20 ⊕ XL,22 ⊕ (XR,21 & XR,14) ⊕ XR,0</td>

            <td class="px-3 py-2 border-b border-gray-700">k5</td>

            <td class="px-3 py-2 border-b border-gray-700">K22+19 ⊕ K0+18</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">x6</td>

            <td class="px-3 py-2 border-b border-gray-700">XR,21+20 ⊕ XL,23 ⊕ (XR,22 & XR,15)</td>

            <td class="px-3 py-2 border-b border-gray-700">k6</td>

            <td class="px-3 py-2 border-b border-gray-700">K23+19</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">x7</td>

            <td class="px-3 py-2 border-b border-gray-700">XR,14+20 ⊕ XL,16 ⊕ (XR,15 & XR,8)</td>

            <td class="px-3 py-2 border-b border-gray-700">k7</td>

            <td class="px-3 py-2 border-b border-gray-700">K16+19</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">x8</td>

            <td class="px-3 py-2 border-b border-gray-700">XR,13+20 ⊕ XL,15 ⊕ (XR,14 & XR,7) ⊕ XR,17</td>

            <td class="px-3 py-2 border-b border-gray-700">k8</td>

            <td class="px-3 py-2 border-b border-gray-700">K15+19 ⊕ K17+18</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">x9</td>

            <td class="px-3 py-2 border-b border-gray-700">XR,7+20 ⊕ XL,9 ⊕ (XR,8 & XR,1)</td>

            <td class="px-3 py-2 border-b border-gray-700">k9</td>

            <td class="px-3 py-2 border-b border-gray-700">K9+19</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">x10</td>

            <td class="px-3 py-2 border-b border-gray-700">XR,0+20 ⊕ XL,2 ⊕ (XR,1 & XR,18) ⊕ XR,4</td>

            <td class="px-3 py-2 border-b border-gray-700">k10</td>

            <td class="px-3 py-2 border-b border-gray-700">K2+19 ⊕ K4+18</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">x11</td>

            <td class="px-3 py-2 border-b border-gray-700">XR,1+20 ⊕ XL,3 ⊕ (XR,2 & XR,19)</td>

            <td class="px-3 py-2 border-b border-gray-700">k11</td>

            <td class="px-3 py-2 border-b border-gray-700">K2+19</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">x12</td>

            <td class="px-3 py-2 border-b border-gray-700">XR,18+20 ⊕ XL,20 ⊕ (XR,20 & XR,12)</td>

            <td class="px-3 py-2 border-b border-gray-700">k12</td>

            <td class="px-3 py-2 border-b border-gray-700">K2+19</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">x13</td>

            <td class="px-3 py-2 border-b border-gray-700">XR,11+20 ⊕ XL,13 ⊕ (XR,12 & XR,5) ⊕ XR,21</td>

            <td class="px-3 py-2 border-b border-gray-700">k13</td>

            <td class="px-3 py-2 border-b border-gray-700">K19+19 ⊕ K21+18</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">x14</td>

            <td class="px-3 py-2 border-b border-gray-700">XR,11+20 ⊕ XL,13 ⊕ (XR,12 & XR,5)</td>

            <td class="px-3 py-2 border-b border-gray-700">k14</td>

            <td class="px-3 py-2 border-b border-gray-700">K13+19</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">x15</td>

            <td class="px-3 py-2 border-b border-gray-700">XR,16+20 ⊕ XL,18 ⊕ (XR,17 & XR,10) ⊕ XR,20</td>

            <td class="px-3 py-2 border-b border-gray-700">k15</td>

            <td class="px-3 py-2 border-b border-gray-700">K18+19 ⊕ K20+18</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">x16</td>

            <td class="px-3 py-2 border-b border-gray-700">XR,10+20 ⊕ XL,12 ⊕ (XR,11 & XR,4)</td>

            <td class="px-3 py-2 border-b border-gray-700">k16</td>

            <td class="px-3 py-2 border-b border-gray-700">K12+19</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">x17</td>

            <td class="px-3 py-2 border-b border-gray-700">XR,9+20 ⊕ XL,11 ⊕ (XR,10 & XR,3) ⊕ XR,13</td>

            <td class="px-3 py-2 border-b border-gray-700">k17</td>

            <td class="px-3 py-2 border-b border-gray-700">K11+19 ⊕ K13+18</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">x18</td>

            <td class="px-3 py-2 border-b border-gray-700">XR,3+20 ⊕ XL,5 ⊕ (XR,4 & XR,21)</td>

            <td class="px-3 py-2 border-b border-gray-700">k18</td>

            <td class="px-3 py-2 border-b border-gray-700">K5+19</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">x19</td>

            <td class="px-3 py-2 border-b border-gray-700">XR,20+20 ⊕ XL,18 ⊕ (XR,17 & XR,10) ⊕ XL,22 ⊕ (XR,20 & XR,14)</td>

            <td class="px-3 py-2 border-b border-gray-700">k19</td>

            <td class="px-3 py-2 border-b border-gray-700">K18+19 ⊕ K20+18 ⊕ K22+19</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">x20</td>

            <td class="px-3 py-2 border-b border-gray-700">XR,10+20 ⊕ XL,12 ⊕ (XR,11 & XR,4) ⊕ XR,4</td>

            <td class="px-3 py-2 border-b border-gray-700">k20</td>

            <td class="px-3 py-2 border-b border-gray-700">K12+19 ⊕ K14+18</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">x21</td>

            <td class="px-3 py-2 border-b border-gray-700">XR,9+20 ⊕ XL,11 ⊕ (XR,10 & XR,3) ⊕ XL,15 ⊕ (XR,14 & XR,7)</td>

            <td class="px-3 py-2 border-b border-gray-700">k21</td>

            <td class="px-3 py-2 border-b border-gray-700">K11+19 ⊕ K13+18 ⊕ K15+19</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">x22</td>

            <td class="px-3 py-2 border-b border-gray-700">XR,20+20 ⊕ XL,5 ⊕ (XR,20 & XR,22)</td>

            <td class="px-3 py-2 border-b border-gray-700">k22</td>

            <td class="px-3 py-2 border-b border-gray-700">K6+19</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">x23</td>

            <td class="px-3 py-2 border-b border-gray-700">XR,3+20 ⊕ XL,5 ⊕ (XR,4 & XR,21) ⊕ XR,7</td>

            <td class="px-3 py-2 border-b border-gray-700">k23</td>

            <td class="px-3 py-2 border-b border-gray-700">K5+19 ⊕ K7+18</td>

          </tr>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">If we append four rounds at the end of the linear distinguisher, according to Table 12,  <span class="math">X_{L,1}^{i + 16} \\oplus X_{L,5}^{i + 16} \\oplus X_{R,23}^{i + 16}</span>  can be represented as</p>

    <p class="text-gray-300"><span class="math">x_0\\oplus k_0\\oplus ((x_1\\oplus k_1)\\&amp;amp; (x_2\\oplus k_2))\\oplus ((x_3\\oplus k_3)\\&amp;amp; (x_4\\oplus k_4))\\oplus</span></p>

    <p class="text-gray-300"><span class="math">((x_{5}\\oplus k_{5}\\oplus ((x_{6}\\oplus k_{6})\\&amp;amp; (x_{7}\\oplus k_{7})))\\&amp;amp; (x_{8}\\oplus k_{8}\\oplus ((x_{7}\\oplus k_{7})\\&amp;amp; (x_{9}\\oplus k_{9})))\\oplus</span></p>

    <p class="text-gray-300"><span class="math">((x_{10}\\oplus k_{10}\\oplus ((x_{11}\\oplus k_{11})\\&amp;amp; (x_{12}\\oplus k_{12})))\\&amp;amp; (x_{13}\\oplus k_{13}\\oplus ((x_{12}\\oplus k_{12})\\&amp;amp; (x_{14}\\oplus k_{14})))\\oplus</span></p>

    <p class="text-gray-300"><span class="math">((x_{15}\\oplus k_{15}\\oplus ((x_{4}\\oplus k_{4})\\&amp;amp; (x_{16}\\oplus k_{16})))\\&amp;amp; (x_{17}\\oplus k_{17}\\oplus ((x_{16}\\oplus k_{16})\\&amp;amp; (x_{18}\\oplus k_{18})))\\oplus</span></p>

    <p class="text-gray-300"><span class="math">\\{(x_{19}\\oplus k_{19}\\oplus ((x_4\\oplus k_4)\\&amp;amp; (x_{16}\\oplus k_{16}))\\oplus</span></p>

    <p class="text-gray-300"><span class="math">((x_{13}\\oplus k_{13}\\oplus ((x_{12}\\oplus k_{12})\\&amp;amp; (x_{14}\\oplus k_{14})))\\&amp;amp; (x_{20}\\oplus k_{20}\\oplus ((x_{14}\\oplus k_{14})\\&amp;amp; (x_{22}\\oplus k_{22}))))</span></p>

    <p class="text-gray-300">&amp;</p>

    <p class="text-gray-300"><span class="math">(x_{21}\\oplus k_{21}\\oplus ((x_{16}\\oplus k_{16})\\&amp;amp; (x_{18}\\oplus k_{18}))\\oplus</span></p>

    <p class="text-gray-300"><span class="math">((x_{20}\\oplus k_{20}\\oplus ((x_{14}\\oplus k_{14})\\&amp;amp; (x_{22}\\oplus k_{22})))\\&amp;amp; (x_{23}\\oplus k_{23}\\oplus ((x_{22}\\oplus k_{22})\\&amp;amp; (x_{6}\\oplus k_{6})))))</span></p>

    <p class="text-gray-300">Compress the ciphertexts: (Procedure SIMON48-Tail) To simplify our description, we introduce the situations that the XOR for the guessed  <span class="math">k</span>  bit and corresponding  <span class="math">x</span>  bit is zero in Step 2 to Step 8, since the representation of the target parity bit in another situation has same form with it. At first compress the data samples into a counter vector  <span class="math">V[x_1 - x_{23}]</span> , then DO</p>

    <ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">

      <li>For each of  <span class="math">x_{3} - x_{23}</span></li>

    </ol>

    <p class="text-gray-300">(a) Compress  <span class="math">x_{1} - x_{2}</span>  as Case  <span class="math">f_{1}</span>  in Appendix A. There is 2-bit key  <span class="math">(k_{1} - k_{2})</span>  to store and the time is  <span class="math">2^{3}</span> . So this step needs memory  <span class="math">2^{23}</span>  counters and total time is about  <span class="math">2^{21} \\times 2^{3} = 2^{24}</span> .</p>

    <ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">

      <li>Guess  <span class="math">k_{4}</span> . Since  <span class="math">x_{4} \\oplus k_{4} = 0</span> ,  <span class="math">x_{3}</span>  can be compressed. The time is about  <span class="math">2^{19}</span>  additions.</li>

      <li>Guess  <span class="math">k_{7}</span> . Since  <span class="math">x_{7} \\oplus k_{7} = 0</span> ,  <span class="math">x_{9}</span>  can be compressed. The time is about  <span class="math">2^{17}</span>  additions.</li>

      <li>Guess  <span class="math">k_{5}</span> . Since  <span class="math">x_{5} \\oplus k_{5} = 0</span> ,  <span class="math">x_{8}</span>  can be compressed. The time is about  <span class="math">2^{15}</span>  additions.</li>

    </ol>

    <ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">

      <li>Guess  <span class="math">k_{12}</span> . Since  <span class="math">x_{12} \\oplus k_{12} = 0</span> ,  <span class="math">x_{11}</span>  can be compressed. The time is about  <span class="math">2^{13}</span>  additions.</li>

      <li>Guess  <span class="math">k_{22}</span> . Since  <span class="math">x_{22} \\oplus k_{22} = 0</span> ,  <span class="math">x_{14}, x_{6}</span>  can be compressed. The time is about  <span class="math">2^{10} \\times 3</span>  additions.</li>

      <li>Guess  <span class="math">k_{16}</span> . Since  <span class="math">x_{16} \\oplus k_{16} = 0</span> ,  <span class="math">x_{18}</span>  can be compressed. The time is about  <span class="math">2^{8}</span>  additions.</li>

      <li>Guess  <span class="math">k_{15}</span> . Since  <span class="math">x_{15} \\oplus k_{15} = 0</span> ,  <span class="math">x_{17}</span>  can be compressed. The time is about  <span class="math">2^{6}</span>  additions.</li>

      <li>After above guessing and split, remained bits for  <span class="math">x</span>  and  <span class="math">k</span>  are bit 10, 13, 19, 20, 21, 23. We can compress them as Case  <span class="math">f_{6}</span>  in Appendix A. The time is  <span class="math">2^{8.36}</span> .</li>

      <li>Calculate the other situations similar to that above.</li>

    </ol>

    <p class="text-gray-300">Time is estimated from the inner part to outer part. Step 9 needs about  <span class="math">T_{9} = 2^{8.36}</span>  additions. In Step 8, the two cases,  <span class="math">x_{15} \\oplus k_{15} = 0</span> ,  <span class="math">x_{15} \\oplus k_{15} = 1</span>  have same time complexity and there are two possible guesses for  <span class="math">k_{15}</span> . So the total time for Step 8 and 9 is  <span class="math">T_{8} = 2 \\times ((2^{6} + T_{9}) \\times 2 + 2^{7}) = 2^{10.83}</span> , where  <span class="math">2^{7}</span>  is the time for combination. Similarly, the time for Step 2 to Step 9 is as follows.</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Step</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Time</th>

          </tr>

        </thead>

        <tbody>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">8-9</td>

            <td class="px-3 py-2 border-b border-gray-700">T8=2×((26+T9)×2+27)=210.83</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">7-9</td>

            <td class="px-3 py-2 border-b border-gray-700">T7=2×((28+T8)×2+29)=213.19</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">6-9</td>

            <td class="px-3 py-2 border-b border-gray-700">T6=2×((210×3+T7)×2+212)=215.82</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">5-9</td>

            <td class="px-3 py-2 border-b border-gray-700">T5=2×((213+T6)×2+214)=218.18</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">4-9</td>

            <td class="px-3 py-2 border-b border-gray-700">T4=2×((215+T5)×2+216)=220.47</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">3-9</td>

            <td class="px-3 py-2 border-b border-gray-700">T3=2×((217+T4)×2+218)=222.71</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">2-9</td>

            <td class="px-3 py-2 border-b border-gray-700">T2=2×((219×3+T3)×2+220)=224.91</td>

          </tr>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">So in total, the time is  <span class="math">2^{24.91} \\times 2^2 + 2^{24} \\approx 2^{27.09}</span> . The memory is about  <span class="math">\\mathcal{O}(2^{23})</span>  counters.</p>

    <p class="text-gray-300">23-round attack on SIMON48/72. We add three rounds before and four rounds after the 16-round linear distinguisher to attack 23-round SIMON48/K. Suppose we use  <span class="math">N = 8\\bar{\\epsilon}^{-2} = 2^{47.92}</span>  known plaintext-ciphertext pairs. Set advantage  <span class="math">a = 16</span> . The success probability would be 0.909. At first, compress the  <span class="math">N</span>  plaintext-ciphertext pairs to  <span class="math">2^{18 + 23}</span>  counters according to Table 11, 12. Suppose the plaintext be compressed to  <span class="math">x_{P}</span>  and ciphertext be compressed to  <span class="math">x_{C}</span> .</p>

    <ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">

      <li>For each of  <span class="math">2^{23}x_{C}</span></li>

    </ol>

    <p class="text-gray-300">(a) Call Procedure SIMON48-Head, and store the counters according to the keys used in the forward rounds</p>

    <ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">

      <li>For each of  <span class="math">2^{18}</span>  keys involved in the forward rounds</li>

    </ol>

    <p class="text-gray-300">(a) Call Procedure SIMON48-Tail, and store the counters according to the keys used in the backward rounds</p>

    <ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">

      <li>Rank the keys and exhaustive the candidates with the help of key schedule</li>

    </ol>

    <p class="text-gray-300">Time: 1.  <span class="math">2^{23} \\times 2^{21.66} = 2^{44.66}</span>  additions; 2.  <span class="math">2^{18} \\times 2^{27.09} = 2^{45.09}</span>  additions. So it needs  <span class="math">2^{44.66} + 2^{45.09} = 2^{45.89}</span>  additions to get the correlations. 3. Since the size of master key is 72, the exhaustive phase needs  <span class="math">2^{72 - 16} = 2^{56}</span>  23-round encryptions.</p>

    <p class="text-gray-300">24-round attack on SIMON48/72. Expand one more round before  <span class="math">X^{i-3}</span> . The key bits of  <span class="math">K^{i-4}</span>  involved to obtain the  <span class="math">x</span>  represented in Table 11 are  <span class="math">\\kappa_1 = (K_0^{i-4} - K_5^{i-4}, K_7^{i-4} - K_{22}^{i-4})</span> , in total 22 bits.</p>

    <ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">

      <li>Guess each of  <span class="math">2^{22}\\kappa_{1}</span></li>

    </ol>

    <p class="text-gray-300">(a) Encrypt the  <span class="math">N</span>  plaintexts by one round (b) Do as first two steps of the 23-round attack</p>

    <ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">

      <li>Rank the keys and exhaustive the candidates with the help of key schedule</li>

    </ol>

    <p class="text-gray-300">Time: (1.a)  <span class="math">2^{22} \\times N = 2^{69.92}</span>  one-round encryptions. (1.b)  <span class="math">2^{22} \\times 2^{45.89} = 2^{67.89}</span>  additions. 2. Since the size of master key is 72, the exhaustive phase needs  <span class="math">2^{72 - 16} = 2^{56}</span>  24-round encryptions. So in total the time is about  <span class="math">2^{65.34}</span>  encryptions and  <span class="math">2^{67.89}</span>  additions.</p>

    <p class="text-gray-300">25-round attack on SIMON48/96. Expand one more round before  <span class="math">X^{i-3}</span>  and one more round after  <span class="math">X^{i+20}</span> . The key bits of  <span class="math">K^{i+20}</span>  involved to obtain the  <span class="math">x</span>  represented in Table 12 are  <span class="math">\\kappa_2 = (K_0^{i+20} - K_5^{i+20}, K_7^{i+20} - K_{22}^{i+18})</span> , in total 22 bits.</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">1. Guess each of <span class="math">2^{44}</span> $\\kappa_{1}</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\kappa_{2}$</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">

      <li>Encrypt the <span class="math">N</span> plaintexts by one round</li>

      <li>Do as first two steps of the 23-round attack</li>

      <li>Rank the keys and exhaustive the candidates with the help of key schedule</li>

    </ol>

    <p class="text-gray-300">Time: (1.a) <span class="math">2^{44}\\times N=2^{91.92}</span> two-round encryptions. (1.b) <span class="math">2^{44}\\times 2^{45.89}=2^{89.89}</span> additons. 2. The exhaustive phase needs <span class="math">2^{96-16}=2^{80}</span> 25-round encryptions. So in total the time is about <span class="math">2^{88.28}</span> encryptions and <span class="math">2^{89.89}</span> additions.</p>

    <h3 id="sec-21" class="text-xl font-semibold mt-8">B.2 Linear Attack on Simon64/<span class="math">K</span></h3>

    <p class="text-gray-300">The linear hull we used to attack Simon64/<span class="math">K</span> is</p>

    <p class="text-gray-300"><span class="math">X^{i}_{L,20}\\oplus X^{i}_{L,24}\\oplus X^{i}_{R,22}\\rightarrow X^{i+21}_{L,22}\\oplus X^{i+21}_{R,20}\\oplus X^{i+21}_{R,24}</span></p>

    <p class="text-gray-300">which is proposed in <em>[6]</em>, with potential <span class="math">\\bar{\\epsilon}^{2}=2^{-62.53}</span>.</p>

    <p class="text-gray-300">If we add four rounds before the linear hull, accodring to Table 13, <span class="math">X^{i}_{L,20}\\oplus X^{i}_{L,24}\\oplus X^{i}_{R,22}</span> can be represented as</p>

    <p class="text-gray-300"><span class="math">x_{0}\\oplus k_{0}\\oplus((x_{1}\\oplus k_{1})\\&amp;(x_{2}\\oplus k_{2}))\\oplus((x_{3}\\oplus k_{3})\\&amp;(x_{4}\\oplus k_{4}))\\oplus((x_{5}\\oplus k_{5})\\&amp;(\\underline{x_{6}\\oplus k_{6}}))\\oplus</span> <span class="math">((x_{7}\\oplus k_{7}\\oplus((x_{6}\\oplus k_{6})\\&amp;(x_{8}\\oplus k_{8})))\\&amp;(x_{9}\\oplus k_{9}\\oplus((x_{8}\\oplus k_{8})\\&amp;(x_{10}\\oplus k_{10})))\\oplus</span> <span class="math">\\{(x_{11}\\oplus k_{11}\\oplus((x_{6}\\oplus k_{6})\\&amp;(x_{8}\\oplus k_{8}))\\oplus</span> <span class="math">((x_{12}\\oplus k_{12}\\oplus((x_{13}\\oplus k_{13})\\&amp;(x_{14}\\oplus k_{14})))\\&amp;(x_{15}\\oplus k_{15}\\oplus((x_{13}\\oplus k_{13})\\&amp;(x_{16}\\oplus k_{16}))))</span> <span class="math">\\&amp;</span> <span class="math">(x_{17}\\oplus k_{17}\\oplus((x_{8}\\oplus k_{8})\\&amp;(x_{10}\\oplus k_{10}))\\oplus</span> <span class="math">((x_{15}\\oplus k_{15}\\oplus((x_{13}\\oplus k_{13})\\&amp;(x_{16}\\oplus k_{16})))\\&amp;(x_{18}\\oplus k_{18}\\oplus((x_{16}\\oplus k_{16})\\&amp;(x_{19}\\oplus k_{19}))))\\}\\oplus</span> <span class="math">\\{(x_{20}\\oplus k_{20}\\oplus((x_{21}\\oplus k_{21})\\&amp;(x_{22}\\oplus k_{22}))\\oplus</span> <span class="math">((x_{23}\\oplus k_{23}\\oplus((x_{24}\\oplus k_{24})\\&amp;(x_{25}\\oplus k_{25})))\\&amp;(x_{26}\\oplus k_{26}\\oplus((x_{25}\\oplus k_{25})\\&amp;(x_{27}\\oplus k_{27}))))</span> <span class="math">\\&amp;</span> <span class="math">(x_{28}\\oplus k_{28}\\oplus((x_{22}\\oplus k_{22})\\&amp;(x_{29}\\oplus k_{29}))\\oplus</span> <span class="math">((x_{26}\\oplus k_{26}\\oplus((x_{25}\\oplus k_{25})\\&amp;(x_{27}\\oplus k_{27})))\\&amp;(x_{30}\\oplus k_{30}\\oplus((x_{27}\\oplus k_{27})\\&amp;(x_{31}\\oplus k_{31}))))\\}.</span></p>

    <p class="text-gray-300">Since <span class="math">x_{11}=x_{1}\\oplus x_{7}</span> and <span class="math">x_{17}=x_{2}\\oplus x_{9}</span>, there are 30 independent bits for <span class="math">x</span> and 32 independent bits for <span class="math">k</span>.</p>

    <p class="text-gray-300">Compress the plaintexts: (Procedure Simon64-Head) At first, compress the plaintexts into a counter vector <span class="math">V[x_{1}-x_{31}]</span> using the linear compression technique. There are <span class="math">2^{29}</span> elements for <span class="math">V</span>. To simplify our description of attack, the <span class="math">x_{6},k_{6}</span> with underline above are regarded as new variables <span class="math">x^{\\prime}_{6},k^{\\prime}_{6}</span>.</p>

    <ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">

      <li>For each <span class="math">x_{3}-x_{31}</span></li>

      <li>Compress <span class="math">x_{1},x_{2}</span>. Since <span class="math">x_{1}=x_{7}\\oplus x_{11},x_{2}=x_{9}\\oplus x_{17}</span>, there is only one value for <span class="math">x_{1},x_{2}</span>. There is 2-bit key to store <span class="math">(k_{1},k_{2})</span>, and the time is <span class="math">2^{2}</span>. So here the memory is about <span class="math">2^{29}\\times 2^{2}=2^{31}</span> counters and total time is <span class="math">2^{29}\\times 2^{2}=2^{31}</span>.</li>

      <li>For each <span class="math">k_{1},k_{2},x_{5}-x_{31}</span></li>

      <li>Compress <span class="math">x_{3},x_{4}</span> as the Case <span class="math">f_{1}</span> in Appendix A. There is 2-bit key to store <span class="math">(k_{3},k_{4})</span>, and the time is <span class="math">2^{3}</span>. So here the memory is about <span class="math">2^{29}\\times 2^{2}=2^{31}</span> counters and total time is <span class="math">2^{29}\\times 2^{3}=2^{32}</span>.</li>

      <li>For each <span class="math">k_{1}-k_{4},x_{6}-x_{31}</span></li>

      <li>Compress <span class="math">x_{5},x^{\\prime}_{6}</span>. Since <span class="math">x^{\\prime}_{6}=x_{6}</span>, there is only two values for <span class="math">x_{5},x^{\\prime}_{6}</span>. There is 1-bit key to store <span class="math">(k_{5})</span> since <span class="math">k^{\\prime}_{6}=k_{6}</span> becomes a related bit, which will be determined in the following steps. The time is <span class="math">2^{3}</span>. So here the memory is about <span class="math">2^{30}\\times 2^{1}=2^{31}</span> counters and total time is <span class="math">2^{30}\\times 2^{3}=2^{33}</span>.</li>

      <li>For each <span class="math">k_{1}-k_{5},x_{20}-x_{31}</span></li>

      <li>Compress <span class="math">x_{6}-x_{19}</span> as Case <span class="math">f_{8}</span> in Appendix A. There is 14-bit key to store <span class="math">(k_{6}-k_{19})</span>and the time is <span class="math">2^{18.08}</span>. So here the memory is about <span class="math">2^{17}\\times 2^{14}=2^{31}</span> counters and total time is <span class="math">2^{17}\\times 2^{18.08}=2^{35.08}</span>.</li>

      <li>For each <span class="math">k_{1}-k_{19}</span></li>

    </ol>

    <p class="text-gray-300">Table 13: 4 rounds before  <span class="math">X_{L,20}^{i} \\oplus X_{L,24}^{i} \\oplus X_{R,22}^{i}</span>  for SIMON64</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">x0</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Xl-4L,20 ⊕ Xl-4L,16 ⊕ Xl-4L,12 ⊕ (Xl-4L,13 & Xl-4L,6) ⊕ Xl-4R,14 ⊕ Xl-4L,24 ⊕ Xl-4L,20 ⊕ (Xl-4L,21 & Xl-4L,14) ⊕ Xl-4R,22</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">k0</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">K20i-3 ⊕ K16i-3 ⊕ K18i-2 ⊕ K20i-1 ⊕ K24i-3 ⊕ K24i-1 ⊕ K14i-4 ⊕ K22i-4</th>

          </tr>

        </thead>

        <tbody>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">x1</td>

            <td class="px-3 py-2 border-b border-gray-700">Xl-4L,17 ⊕ (Xl-4L,18 & Xl-4L,11) ⊕ Xl-4R,19</td>

            <td class="px-3 py-2 border-b border-gray-700">k1</td>

            <td class="px-3 py-2 border-b border-gray-700">K19i-4</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">x2</td>

            <td class="px-3 py-2 border-b border-gray-700">Xl-4L,10 ⊕ (Xl-4L,11 & Xl-4L,4) ⊕ Xl-4R,12</td>

            <td class="px-3 py-2 border-b border-gray-700">k2</td>

            <td class="px-3 py-2 border-b border-gray-700">K12i-4</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">x3</td>

            <td class="px-3 py-2 border-b border-gray-700">Xl-4L,13 ⊕ (Xl-4L,14 & Xl-4L,7) ⊕ Xl-4R,15</td>

            <td class="px-3 py-2 border-b border-gray-700">k3</td>

            <td class="px-3 py-2 border-b border-gray-700">K15i-4</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">x4</td>

            <td class="px-3 py-2 border-b border-gray-700">Xl-4L,6 ⊕ (Xl-4L,7 & Xl-4L,0) ⊕ Xl-4R,8</td>

            <td class="px-3 py-2 border-b border-gray-700">k4</td>

            <td class="px-3 py-2 border-b border-gray-700">K8i-4</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">x5</td>

            <td class="px-3 py-2 border-b border-gray-700">Xl-4L,21 ⊕ (Xl-4L,22 & Xl-4L,15) ⊕ Xl-4R,23</td>

            <td class="px-3 py-2 border-b border-gray-700">k5</td>

            <td class="px-3 py-2 border-b border-gray-700">K23i-4</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">x6</td>

            <td class="px-3 py-2 border-b border-gray-700">Xl-4L,14 ⊕ (Xl-4L,15 & Xl-4L,3) ⊕ Xl-4R,16</td>

            <td class="px-3 py-2 border-b border-gray-700">k6</td>

            <td class="px-3 py-2 border-b border-gray-700">K16i-4</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">x7</td>

            <td class="px-3 py-2 border-b border-gray-700">Xl-4L,17 ⊕ Xl-4L,13 ⊕ (Xl-4L,14 & Xl-4L,7) ⊕ Xl-4R,15</td>

            <td class="px-3 py-2 border-b border-gray-700">k7</td>

            <td class="px-3 py-2 border-b border-gray-700">K17i-3 ⊕ K15i-4</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">x8</td>

            <td class="px-3 py-2 border-b border-gray-700">Xl-4L,7 ⊕ (Xl-4L,8 & Xl-4L,1) ⊕ Xl-4R,9</td>

            <td class="px-3 py-2 border-b border-gray-700">k8</td>

            <td class="px-3 py-2 border-b border-gray-700">K9i-4</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">x9</td>

            <td class="px-3 py-2 border-b border-gray-700">Xl-4L,10 ⊕ Xl-4L,6 ⊕ (Xl-4L,7 & Xl-4L,0) ⊕ Xl-4R,8</td>

            <td class="px-3 py-2 border-b border-gray-700">k9</td>

            <td class="px-3 py-2 border-b border-gray-700">K10i-3 ⊕ K8i-4</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">x10</td>

            <td class="px-3 py-2 border-b border-gray-700">Xl-4L,0 ⊕ (Xl-4L,1 & Xl-4L,26) ⊕ Xl-4R,2</td>

            <td class="px-3 py-2 border-b border-gray-700">k10</td>

            <td class="px-3 py-2 border-b border-gray-700">K2i-4</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">x11</td>

            <td class="px-3 py-2 border-b border-gray-700">(Xl-4L,18 & Xl-4L,1) ⊕ Xl-4R,19 ⊕ Xl-4L,13 ⊕ (Xl-4L,14 & Xl-4L,7) ⊕ Xl-4R,15</td>

            <td class="px-3 py-2 border-b border-gray-700">k11</td>

            <td class="px-3 py-2 border-b border-gray-700">K17i-3 ⊕ K19i-2 ⊕ K19i-4 ⊕ K15i-4</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">x12</td>

            <td class="px-3 py-2 border-b border-gray-700">Xl-4L,18 ⊕ Xl-4L,14 ⊕ (Xl-4L,15 & Xl-4L,8) ⊕ Xl-4R,16</td>

            <td class="px-3 py-2 border-b border-gray-700">k12</td>

            <td class="px-3 py-2 border-b border-gray-700">K18i-3 ⊕ K16i-4</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">x13</td>

            <td class="px-3 py-2 border-b border-gray-700">Xl-4L,8 ⊕ (Xl-4L,9 & Xl-4L,2) ⊕ Xl-4R,10</td>

            <td class="px-3 py-2 border-b border-gray-700">k13</td>

            <td class="px-3 py-2 border-b border-gray-700">K10i-4</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">x14</td>

            <td class="px-3 py-2 border-b border-gray-700">Xl-4L,15 ⊕ (Xl-4L,16 & Xl-4L,9) ⊕ Xl-4R,17</td>

            <td class="px-3 py-2 border-b border-gray-700">k14</td>

            <td class="px-3 py-2 border-b border-gray-700">K17i-4</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">x15</td>

            <td class="px-3 py-2 border-b border-gray-700">Xl-4L,11 ⊕ Xl-4L,7 ⊕ (Xl-4L,8 & Xl-4L,1) ⊕ Xl-4R,9</td>

            <td class="px-3 py-2 border-b border-gray-700">k15</td>

            <td class="px-3 py-2 border-b border-gray-700">K11i-3 ⊕ K9i-4</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">x16</td>

            <td class="px-3 py-2 border-b border-gray-700">Xl-4L,14 ⊕ (Xl-4L,14 & Xl-4L,27) ⊕ Xl-4R,3</td>

            <td class="px-3 py-2 border-b border-gray-700">k16</td>

            <td class="px-3 py-2 border-b border-gray-700">K3i-4</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">x17</td>

            <td class="px-3 py-2 border-b border-gray-700">(Xl-4L,11 & Xl-4L,4) ⊕ Xl-4R,12 ⊕ Xl-4L,6 ⊕ (Xl-4L,7 & Xl-4L,0) ⊕ Xl-4R,8</td>

            <td class="px-3 py-2 border-b border-gray-700">k17</td>

            <td class="px-3 py-2 border-b border-gray-700">K10i-3 ⊕ K12i-2 ⊕ K12i-4 ⊕ K8i-4</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">x18</td>

            <td class="px-3 py-2 border-b border-gray-700">Xl-4L,4 ⊕ Xl-4L,0 ⊕ (Xl-4L,1 & Xl-4L,26) ⊕ Xl-4R,2</td>

            <td class="px-3 py-2 border-b border-gray-700">k18</td>

            <td class="px-3 py-2 border-b border-gray-700">K4i-3 ⊕ K2i-4</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">x19</td>

            <td class="px-3 py-2 border-b border-gray-700">Xl-4L,26 ⊕ (Xl-4L,27 & Xl-4L,20) ⊕ Xl-4R,28</td>

            <td class="px-3 py-2 border-b border-gray-700">k19</td>

            <td class="px-3 py-2 border-b border-gray-700">K28i-4</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">x20</td>

            <td class="px-3 py-2 border-b border-gray-700">(Xl-4L,22 & Xl-4L,15) ⊕ Xl-4R,23 ⊕ Xl-4L,27 ⊕ (Xl-4L,18 & Xl-4L,11) ⊕ Xl-4R,19</td>

            <td class="px-3 py-2 border-b border-gray-700">k20</td>

            <td class="px-3 py-2 border-b border-gray-700">K21i-3 ⊕ K23i-2 ⊕ K23i-4 ⊕ K19i-4</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">x21</td>

            <td class="px-3 py-2 border-b border-gray-700">Xl-4L,18 ⊕ (Xl-4L,19 & Xl-4L,12) ⊕ Xl-4R,20</td>

            <td class="px-3 py-2 border-b border-gray-700">k21</td>

            <td class="px-3 py-2 border-b border-gray-700">K20i-4</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">x22</td>

            <td class="px-3 py-2 border-b border-gray-700">Xl-4L,11 ⊕ (Xl-4L,12 & Xl-4L,5) ⊕ Xl-4R,13</td>

            <td class="px-3 py-2 border-b border-gray-700">k22</td>

            <td class="px-3 py-2 border-b border-gray-700">K13i-4</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">x23</td>

            <td class="px-3 py-2 border-b border-gray-700">Xl-4L,22 ⊕ Xl-4L,18 ⊕ (Xl-4L,19 & Xl-4L,12) ⊕ Xl-4R,20</td>

            <td class="px-3 py-2 border-b border-gray-700">k23</td>

            <td class="px-3 py-2 border-b border-gray-700">K22i-3 ⊕ K20i-4</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">x24</td>

            <td class="px-3 py-2 border-b border-gray-700">Xl-4L,19 ⊕ (Xl-4L,20 & Xl-4L,13) ⊕ Xl-4R,21</td>

            <td class="px-3 py-2 border-b border-gray-700">k24</td>

            <td class="px-3 py-2 border-b border-gray-700">K21i-4</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">x25</td>

            <td class="px-3 py-2 border-b border-gray-700">Xl-4L,12 ⊕ (Xl-4L,13 & Xl-4L,6) ⊕ Xl-4R,14</td>

            <td class="px-3 py-2 border-b border-gray-700">k25</td>

            <td class="px-3 py-2 border-b border-gray-700">K14i-4</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">x26</td>

            <td class="px-3 py-2 border-b border-gray-700">Xl-4L,15 ⊕ Xl-4L,11 ⊕ (Xl-4L,12 & Xl-4L,5) ⊕ Xl-4R,13</td>

            <td class="px-3 py-2 border-b border-gray-700">k26</td>

            <td class="px-3 py-2 border-b border-gray-700">K15i-3 ⊕ K13i-4</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">x27</td>

            <td class="px-3 py-2 border-b border-gray-700">Xl-4L,5 ⊕ (Xl-4L,6 & Xl-4L,31) ⊕ Xl-4R,7 f7</td>

            <td class="px-3 py-2 border-b border-gray-700">k27</td>

            <td class="px-3 py-2 border-b border-gray-700">K7i-4</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">x28</td>

            <td class="px-3 py-2 border-b border-gray-700">(Xl-4L,15 & Xl-4L,8) ⊕ Xl-4R,16 ⊕ Xl-4L,10 ⊕ (Xl-4L,11 & Xl-4L,4) ⊕ Xl-4R,12</td>

            <td class="px-3 py-2 border-b border-gray-700">k28</td>

            <td class="px-3 py-2 border-b border-gray-700">K14i-3 ⊕ K16i-2 ⊕ K16i-4 ⊕ K12i-4</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">x29</td>

            <td class="px-3 py-2 border-b border-gray-700">Xl-4L,4 ⊕ (Xl-4L,5 & Xl-4L,30) ⊕ Xl-4R,6</td>

            <td class="px-3 py-2 border-b border-gray-700">k29</td>

            <td class="px-3 py-2 border-b border-gray-700">K6i-4</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">x30</td>

            <td class="px-3 py-2 border-b border-gray-700">Xl-4L,8 ⊕ Xl-4L,4 ⊕ (Xl-4L,3 & Xl-4L,30) ⊕ Xl-4R,6</td>

            <td class="px-3 py-2 border-b border-gray-700">k30</td>

            <td class="px-3 py-2 border-b border-gray-700">K8i-3 ⊕ K6i-4</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">x31</td>

            <td class="px-3 py-2 border-b border-gray-700">Xl-4L,30 ⊕ (Xl-4L,31 & Xl-4L,24) ⊕ Xl-4R,0</td>

            <td class="px-3 py-2 border-b border-gray-700">k31</td>

            <td class="px-3 py-2 border-b border-gray-700">K0i-4</td>

          </tr>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300"><span class="math">x_{11} = x_1\\oplus x_7,x_{17} = x_2\\oplus x_9,</span></p>

    <p class="text-gray-300">(a) Compress  <span class="math">x_{20} - x_{31}</span>  as Case  <span class="math">f_7</span>  in Appendix A. There is 12-bit key to store  <span class="math">(k_{20} - k_{31})</span>  and the time is  <span class="math">2^{15.99}</span> . So here the memory is about  <span class="math">2^{19} \\times 2^{12} = 2^{31}</span>  counters and total time is  <span class="math">2^{19} \\times 2^{15.99} = 2^{34.99}</span> . 6. The total time is about  <span class="math">2^{36.31}</span>  additions and memory is  <span class="math">\\mathcal{O}(2^{31})</span> .</p>

    <p class="text-gray-300">Compress the ciphertexts: (Procedure SIMON64-Tail) Add four rounds after the distinguisher, the representation of  <span class="math">X_{R,20}^{i+21} \\oplus X_{R,24}^{i+21} \\oplus X_{L,22}^{i+21}</span>  is same as that of  <span class="math">X_{L,20}^{i} \\oplus X_{L,24}^{i} \\oplus X_{R,22}^{i}</span> , except that the new representations for  <span class="math">x</span>  and  <span class="math">k</span>  are shown in Table 14. Compress the ciphertexts to a counter vector  <span class="math">V[x_1 - x_{31}]</span>  at first. Then do as the compressing procedure SIMON64-Head.</p>

    <p class="text-gray-300">Table 14: 4 rounds after  <span class="math">{X}_{L,{20}}^{i + {21}} \\oplus  {X}_{L,{24}}^{i + {21}} \\oplus  {X}_{R,{22}}^{{21}}</span>  for SIMON64</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">x0</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">X1+25R,20 ⊕ X1+25R,16 ⊕ X1+25R,12 ⊕ (X1+25R,13 & X1+25R,6) ⊕ XL,14 ⊕ X1+25R,24 ⊕ X1+25R,20 ⊕ (X1+25R,21 & X1+25R,14) ⊕ XL,22</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">k0</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">K1+23R,16 ⊕ K1+23R,18 ⊕ K1+22R,20 ⊕ K1+23R,24 ⊕ K1+24R,22</th>

          </tr>

        </thead>

        <tbody>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">x1</td>

            <td class="px-3 py-2 border-b border-gray-700">X1+25R,17 ⊕ (X1+25R,18 & X1+25R,11) ⊕ XL,19</td>

            <td class="px-3 py-2 border-b border-gray-700">k1</td>

            <td class="px-3 py-2 border-b border-gray-700">K1+24R,19</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">x2</td>

            <td class="px-3 py-2 border-b border-gray-700">X1+25R,10 ⊕ (X1+25R,17 & X1+25R,4) ⊕ XL,12</td>

            <td class="px-3 py-2 border-b border-gray-700">k2</td>

            <td class="px-3 py-2 border-b border-gray-700">K1+24R,12</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">x3</td>

            <td class="px-3 py-2 border-b border-gray-700">X1+25R,13 ⊕ (X1+25R,14 & X1+25R,7) ⊕ XL,15</td>

            <td class="px-3 py-2 border-b border-gray-700">k3</td>

            <td class="px-3 py-2 border-b border-gray-700">K1+24R,15</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">x4</td>

            <td class="px-3 py-2 border-b border-gray-700">X1+25R,6 ⊕ (X1+25R,7 & X1+25R,0) ⊕ XL,8</td>

            <td class="px-3 py-2 border-b border-gray-700">k4</td>

            <td class="px-3 py-2 border-b border-gray-700">K1+24R,8</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">x5</td>

            <td class="px-3 py-2 border-b border-gray-700">X1+25R,21 ⊕ (X1+25R,22 & X1+25R,15) ⊕ XL,23</td>

            <td class="px-3 py-2 border-b border-gray-700">k5</td>

            <td class="px-3 py-2 border-b border-gray-700">K1+24R,23</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">x6</td>

            <td class="px-3 py-2 border-b border-gray-700">X1+25R,14 ⊕ (X1+25R,15 & X1+25R,8) ⊕ XL,16</td>

            <td class="px-3 py-2 border-b border-gray-700">k6</td>

            <td class="px-3 py-2 border-b border-gray-700">K1+24R,16</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">x7</td>

            <td class="px-3 py-2 border-b border-gray-700">X1+25R,17 ⊕ X1+25R,13 ⊕ (X1+25R,14 & X1+25R,7) ⊕ XL,15</td>

            <td class="px-3 py-2 border-b border-gray-700">k7</td>

            <td class="px-3 py-2 border-b border-gray-700">K1+23R,15</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">x8</td>

            <td class="px-3 py-2 border-b border-gray-700">X1+25R,7 ⊕ (X1+25R,8 & X1+25R,1) ⊕ XL,9</td>

            <td class="px-3 py-2 border-b border-gray-700">k8</td>

            <td class="px-3 py-2 border-b border-gray-700">K0+24R,9</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">x9</td>

            <td class="px-3 py-2 border-b border-gray-700">X1+25R,10 ⊕ X1+25R,6 ⊕ (X1+25R,7 & X1+25R,0) ⊕ XL,8</td>

            <td class="px-3 py-2 border-b border-gray-700">k9</td>

            <td class="px-3 py-2 border-b border-gray-700">K1+23R,8</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">x10</td>

            <td class="px-3 py-2 border-b border-gray-700">X1+25R,0 ⊕ (X1+25R,13 & X1+25R,26) ⊕ XL,2</td>

            <td class="px-3 py-2 border-b border-gray-700">k10</td>

            <td class="px-3 py-2 border-b border-gray-700">K1+24R,2</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">x11</td>

            <td class="px-3 py-2 border-b border-gray-700">(X1+25R,18 & X1+25R,11) ⊕ XL,19 ⊕ X1+25R,14 ⊕ (X1+25R,14 & X1+25R,7) ⊕ XL,15</td>

            <td class="px-3 py-2 border-b border-gray-700">k11</td>

            <td class="px-3 py-2 border-b border-gray-700">K1+23R,19 ⊕ K1+22R,19 ⊕ K1+24R,15</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">x12</td>

            <td class="px-3 py-2 border-b border-gray-700">X1+25R,18 ⊕ X1+25R,14 ⊕ (X1+25R,15 & X1+25R,8) ⊕ XL,16</td>

            <td class="px-3 py-2 border-b border-gray-700">k12</td>

            <td class="px-3 py-2 border-b border-gray-700">K1+23R,16</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">x13</td>

            <td class="px-3 py-2 border-b border-gray-700">X1+25R,8 ⊕ (X1+25R,9 & X1+25R,2) ⊕ XL,10</td>

            <td class="px-3 py-2 border-b border-gray-700">k13</td>

            <td class="px-3 py-2 border-b border-gray-700">K1+24R,10</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">x14</td>

            <td class="px-3 py-2 border-b border-gray-700">X1+25R,15 ⊕ (X1+25R,16 & X1+25R,9) ⊕ XL,17</td>

            <td class="px-3 py-2 border-b border-gray-700">k14</td>

            <td class="px-3 py-2 border-b border-gray-700">K1+24R,17</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">x15</td>

            <td class="px-3 py-2 border-b border-gray-700">X1+25R,11 ⊕ X1+25R,7 ⊕ (X1+25R,8 & X1+25R,1) ⊕ XL,9</td>

            <td class="px-3 py-2 border-b border-gray-700">k15</td>

            <td class="px-3 py-2 border-b border-gray-700">K1+23R,9</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">x16</td>

            <td class="px-3 py-2 border-b border-gray-700">X1+25R,1 ⊕ (X1+25R,2 & X1+25R,27) ⊕ XL,3</td>

            <td class="px-3 py-2 border-b border-gray-700">k16</td>

            <td class="px-3 py-2 border-b border-gray-700">K1+24R,2</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">x17</td>

            <td class="px-3 py-2 border-b border-gray-700">(X1+25R,14 & X1+25R,4) ⊕ XL,12 ⊕ X1+25R,6 ⊕ (X1+25R,7 & X1+25R,0) ⊕ XL,8</td>

            <td class="px-3 py-2 border-b border-gray-700">k17</td>

            <td class="px-3 py-2 border-b border-gray-700">K1+23R,12 ⊕ K1+22R,12 ⊕ K1+24R,8</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">x18</td>

            <td class="px-3 py-2 border-b border-gray-700">X1+25R,4 ⊕ X1+25R,0 ⊕ (X1+25R,1 & X1+25R,26) ⊕ XL,2</td>

            <td class="px-3 py-2 border-b border-gray-700">k18</td>

            <td class="px-3 py-2 border-b border-gray-700">K1+23R,2</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">x19</td>

            <td class="px-3 py-2 border-b border-gray-700">X1+25R,26 ⊕ (X1+25R,27 & X1+25R,20) ⊕ XL,28</td>

            <td class="px-3 py-2 border-b border-gray-700">k19</td>

            <td class="px-3 py-2 border-b border-gray-700">K1+24R,28</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">x20</td>

            <td class="px-3 py-2 border-b border-gray-700">(X1+25R,22 & X1+25R,15) ⊕ XL,23 ⊕ X1+25R,27 ⊕ (X1+25R,18 & X1+25R,11) ⊕ XL,19</td>

            <td class="px-3 py-2 border-b border-gray-700">k20</td>

            <td class="px-3 py-2 border-b border-gray-700">K1+23R,23 ⊕ K1+22R,23 ⊕ K1+24R,19</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">x21</td>

            <td class="px-3 py-2 border-b border-gray-700">X1+25R,18 ⊕ (X1+25R,19 & X1+25R,12) ⊕ XL,20</td>

            <td class="px-3 py-2 border-b border-gray-700">k21</td>

            <td class="px-3 py-2 border-b border-gray-700">K1+24R,20</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">x22</td>

            <td class="px-3 py-2 border-b border-gray-700">X1+25R,11 ⊕ (X1+25R,12 & X1+25R,5) ⊕ XL,13</td>

            <td class="px-3 py-2 border-b border-gray-700">k22</td>

            <td class="px-3 py-2 border-b border-gray-700">K1+24R,13</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">x23</td>

            <td class="px-3 py-2 border-b border-gray-700">X1+25R,22 ⊕ X1+25R,18 ⊕ (X1+25R,19 & X1+25R,12) ⊕ XL,20</td>

            <td class="px-3 py-2 border-b border-gray-700">k23</td>

            <td class="px-3 py-2 border-b border-gray-700">K1+23R,22 ⊕ K1+24R,20</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">x24</td>

            <td class="px-3 py-2 border-b border-gray-700">X1+25R,19 ⊕ (X1+25R,20 & X1+25R,13) ⊕ XL,21</td>

            <td class="px-3 py-2 border-b border-gray-700">k24</td>

            <td class="px-3 py-2 border-b border-gray-700">K1+24R,21</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">x25</td>

            <td class="px-3 py-2 border-b border-gray-700">X1+25R,12 ⊕ (X1+25R,13 & X1+25R,6) ⊕ XL,14</td>

            <td class="px-3 py-2 border-b border-gray-700">k25</td>

            <td class="px-3 py-2 border-b border-gray-700">K1+24R,14</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">x26</td>

            <td class="px-3 py-2 border-b border-gray-700">X1+25R,15 ⊕ X1+25R,11 ⊕ (X1+25R,12 & X1+25R,5) ⊕ XL,13</td>

            <td class="px-3 py-2 border-b border-gray-700">k26</td>

            <td class="px-3 py-2 border-b border-gray-700">K1+23R,13</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">x27</td>

            <td class="px-3 py-2 border-b border-gray-700">X1+25R,5 ⊕ (X1+25R,6 & X1+25R,3) ⊕ XL,7</td>

            <td class="px-3 py-2 border-b border-gray-700">k27</td>

            <td class="px-3 py-2 border-b border-gray-700">K1+24R,7</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">x28</td>

            <td class="px-3 py-2 border-b border-gray-700">(X1+25R,25 & X1+25R,8) ⊕ XL,16 ⊕ X1+25R,10 ⊕ (X1+25R,14 & X1+25R,12) ⊕ XL,12</td>

            <td class="px-3 py-2 border-b border-gray-700">k28</td>

            <td class="px-3 py-2 border-b border-gray-700">K1+23R,16 ⊕ K1+22R,16 ⊕ K1+24R,12</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">x29</td>

            <td class="px-3 py-2 border-b border-gray-700">X1+25R,4 ⊕ (X1+25R,5 & X1+25R,30) ⊕ XL,6</td>

            <td class="px-3 py-2 border-b border-gray-700">k29</td>

            <td class="px-3 py-2 border-b border-gray-700">K1+24R,6</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">x30</td>

            <td class="px-3 py-2 border-b border-gray-700">X1+25R,8 ⊕ X1+25R,4 ⊕ (X1+25R,5 & X1+25R,30) ⊕ XL,6</td>

            <td class="px-3 py-2 border-b border-gray-700">k30</td>

            <td class="px-3 py-2 border-b border-gray-700">K1+23R,6</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">x31</td>

            <td class="px-3 py-2 border-b border-gray-700">X1+25R,30 ⊕ (X1+25R,30 & X1+25R,24) ⊕ XL,0</td>

            <td class="px-3 py-2 border-b border-gray-700">k31</td>

            <td class="px-3 py-2 border-b border-gray-700">K1+24R,0</td>

          </tr>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300"><span class="math">x_{11} = x_1\\oplus x_7,x_{17} = x_2\\oplus x_9</span></p>

    <p class="text-gray-300">29-round attack on SIMON64/96. We add four rounds before and after the 21-round linear distinguisher to attack 29-round SIMON64/96. Suppose we use  <span class="math">N = 2\\bar{\\epsilon}^{-2} = 2^{63.53}</span>  known plaintext-ciphertext pairs. Set advantage  <span class="math">a = 8</span> . The success probability would be 0.477. At first, compress the  <span class="math">N</span>  plaintext-ciphertext pairs to  <span class="math">2^{29 + 29}</span>  counters according to Table 13 and 14. Suppose the plaintext be compressed to  <span class="math">x_{P}</span>  and ciphertext be compressed to  <span class="math">x_{C}</span> .</p>

    <ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">

      <li>For each of  <span class="math">2^{29}x_{C}</span></li>

    </ol>

    <ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">

      <li>Call Procedure Simon64-Head, and store the counters according to the keys used in the first four rounds</li>

      <li>For each of <span class="math">2^{31}</span> keys involved in the first four rounds</li>

    </ol>

    <ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">

      <li>Call Procedure Simon64-Tail, and store the counters according to the keys used in the last four rounds</li>

      <li>Rank the keys and exhaustive the candidates with the help of key schedule</li>

    </ol>

    <p class="text-gray-300">Time: 1. <span class="math">2^{29}\\times 2^{36.31}=2^{65.31}</span> additions; 2. <span class="math">2^{31}\\times 2^{36.31}=2^{67.31}</span> additions. So it needs <span class="math">2^{65.31}+2^{67.31}=2^{67.62}</span> additions to get the bias for the subkeys. 3. The exhaustive phase needs <span class="math">2^{96-8}=2^{88}</span> 29-round encryptions.</p>

    <p class="text-gray-300">30-round attack on Simon64/96. Expand one more round before <span class="math">X^{i-4}</span>. The key bits of <span class="math">K^{i-5}</span> involved to obtain the <span class="math">x</span> represented in Table 13 are <span class="math">\\kappa_{1}=(K^{i-5}_{0}-K^{i-5}_{2},K^{i-5}_{4}-K^{i-5}_{22},K^{i-5}_{24},K^{i-5}_{26},K^{i-5}_{30},K^{i-5}_{31})</span>, in total 26 bits.</p>

    <ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">

      <li>Guess each of <span class="math">2^{26}</span> <span class="math">\\kappa_{1}</span></li>

    </ol>

    <ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">

      <li>Encrypt the <span class="math">N</span> plaintexts by one round. Compress the internal states to a counter vectr of size <span class="math">2^{58}</span>.</li>

      <li>Do as first two steps of the 29-round attack</li>

      <li>Rank the keys and exhaustive the candidates with the help of key schedule</li>

    </ol>

    <p class="text-gray-300">Time: (1.a) <span class="math">2^{26}\\times N=2^{89.53}</span> one-round encryptions. (1.b) <span class="math">2^{26}\\times 2^{67.62}=2^{93.62}</span> additons. 2. The exhaustive phase needs <span class="math">2^{96-8}=2^{88}</span> 30-round encryptions. So in total the time is about <span class="math">2^{88.13}</span> encryptions and <span class="math">2^{93.62}</span> additions.</p>

    <p class="text-gray-300">31-round attack on Simon64/128. Expand one more round before <span class="math">X^{i-4}</span> and one more round after <span class="math">X^{i+25}</span>. The key bits of <span class="math">K^{i+25}</span> involved to obtain the <span class="math">x</span> represented in Table 14 are</p>

    <p class="text-gray-300"><span class="math">\\kappa_{2}=(K^{i+25}_{0}-K^{i+25}_{2},K^{i+25}_{4}-K^{i+25}_{22},K^{i+25}_{24},K^{i+25}_{26},K^{i+25}_{30},K^{i+25}_{31}),</span></p>

    <p class="text-gray-300">in total 26 bits.</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">1. Guess each of <span class="math">2^{52}</span> $\\kappa_{1}</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\kappa_{2}$</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">

      <li>Encrypt the <span class="math">N</span> plaintexts by one round and decrypt coresponding ciphertext by one round. Compress the internal states to a counter vectr of size <span class="math">2^{58}</span>.</li>

      <li>Do as first two steps of the 29-round attack</li>

      <li>Rank the keys and exhaustive the candidates with the help of key schedule</li>

    </ol>

    <p class="text-gray-300">Time: (1.a) <span class="math">2^{52}\\times N=2^{115.53}</span> two-round encryptions. (1.b) <span class="math">2^{52}\\times 2^{67.62}=2^{119.62}</span> additons. 2.The exhaustive phase needs <span class="math">2^{128-8}=2^{120}</span> 31-round encryptions. The total time is about <span class="math">2^{120.00}</span> encryptions and <span class="math">2^{119.62}</span> additions.</p>

    <h3 id="sec-22" class="text-xl font-semibold mt-8">B.3 Linear Attack on Simon96/<span class="math">K</span></h3>

    <p class="text-gray-300">The linear hull used to attack Simon96/<span class="math">K</span> is</p>

    <p class="text-gray-300"><span class="math">X^{i}_{L,2}\\oplus X^{i}_{L,34}\\oplus X^{i}_{L,38}\\oplus X^{i}_{L,42}\\oplus X^{i}_{R,36}\\rightarrow X^{i+30}_{L,2}\\oplus X^{i+30}_{L,42}\\oplus X^{i+30}_{L,46}\\oplus X^{i+30}_{R,0}\\oplus X^{i+30}_{R,40},</span></p>

    <p class="text-gray-300">which is proposed in <em>[6]</em> with potential <span class="math">2^{-94.2}</span>.</p>

    <p class="text-gray-300">If we add three rounds before the linear hull, according to Table 15, <span class="math">X^{i}_{L,2}\\oplus X^{i}_{L,34}\\oplus X^{i}_{L,38}\\oplus X^{i}_{L,42}\\oplus X^{i}_{R,36}</span> can be represented as</p>

    <p class="text-gray-300"><span class="math">x_{0}\\oplus k_{0}\\oplus((x_{1}\\oplus k_{1})\\&amp;(x_{2}\\oplus k_{2}))\\oplus((x_{3}\\oplus k_{3})\\&amp;(x_{4}\\oplus k_{4}))\\oplus((x_{5}\\oplus k_{5})\\&amp;(x_{6}\\oplus k_{6}))</span> <span class="math">\\oplus((x_{7}\\oplus k_{7}\\oplus((x_{8}\\oplus k_{8})\\&amp;(x_{9}\\oplus k_{9})))\\&amp;(x_{10}\\oplus k_{10}\\oplus((x_{9}\\oplus k_{9})\\&amp;(x_{11}\\oplus k_{11}))))</span> <span class="math">\\oplus((x_{12}\\oplus k_{12}\\oplus((x_{6}\\oplus k_{6})\\&amp;(x_{13}\\oplus k_{13})))\\&amp;(x_{14}\\oplus k_{14}\\oplus((x_{13}\\oplus k_{13})\\&amp;(x_{15}\\oplus k_{15}))))</span> <span class="math">\\oplus((x_{16}\\oplus k_{16}\\oplus((x_{17}\\oplus k_{17})\\&amp;(x_{18}\\oplus k_{18})))\\&amp;(x_{19}\\oplus k_{19}\\oplus((x_{18}\\oplus k_{18})\\&amp;(x_{20}\\oplus k_{20}))))</span> <span class="math">\\oplus((x_{21}\\oplus k_{21}\\oplus((x_{2}\\oplus k_{2})\\&amp;(x_{22}\\oplus k_{22})))\\&amp;(x_{23}\\oplus k_{23}\\oplus((x_{22}\\oplus k_{22})\\&amp;(x_{24}\\oplus k_{24}))))</span></p>

    <p class="text-gray-300">Table 15: Add 3 rounds before  <span class="math">X_{L,2}^{i} \\oplus X_{L,34}^{i} \\oplus X_{L,38}^{i} \\oplus X_{L,42}^{i} \\oplus X_{R,36}^{i}</span>  for SIMON96</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">x0</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Xi-3R,2 ⊕ (Xi-3L,1 & Xi-3L,42) ⊕ Xi-3R,34 ⊕ (Xi-3L,33 & Xi-3L,26) ⊕ Xi-3R,42 ⊕ (Xi-3L,41 & Xi-3L,34) ⊕ Xi-3R,46 ⊕ Xi-3L,44 ⊕ (Xi-3L,45 & Xi-3L,38) ⊕ Xi-3R,30 ⊕ Xi-3L,28 ⊕ (Xi-3L,29 & Xi-3L,22)</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">k0</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">K2i-3 ⊕ K3i-3 ⊕ K4i-3 ⊕ K0i-2 ⊕ K3i-2 ⊕ K4i-2 ⊕ K4i-3 ⊕ K3i-3 ⊕ K2i-1 ⊕ K3i-1 ⊕ K3i-1 ⊕ K4i-1</th>

          </tr>

        </thead>

        <tbody>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">x1</td>

            <td class="px-3 py-2 border-b border-gray-700">Xi-3R,47 ⊕ Xi-3L,45 ⊕ (Xi-3L,46 & Xi-3L,39)</td>

            <td class="px-3 py-2 border-b border-gray-700">k1</td>

            <td class="px-3 py-2 border-b border-gray-700">K4i-3</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">x2</td>

            <td class="px-3 py-2 border-b border-gray-700">Xi-3R,40 ⊕ Xi-3L,38 ⊕ (Xi-3L,39 & Xi-3L,32)</td>

            <td class="px-3 py-2 border-b border-gray-700">k2</td>

            <td class="px-3 py-2 border-b border-gray-700">K4i-3</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">x3</td>

            <td class="px-3 py-2 border-b border-gray-700">Xi-3L,31 ⊕ Xi-3L,29 ⊕ (Xi-3L,30 & Xi-3L,23)</td>

            <td class="px-3 py-2 border-b border-gray-700">k3</td>

            <td class="px-3 py-2 border-b border-gray-700">K3i-3</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">x4</td>

            <td class="px-3 py-2 border-b border-gray-700">Xi-3L,22 ⊕ (Xi-3L,23 & Xi-3L,16)</td>

            <td class="px-3 py-2 border-b border-gray-700">k4</td>

            <td class="px-3 py-2 border-b border-gray-700">K2i-3</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">x5</td>

            <td class="px-3 py-2 border-b border-gray-700">Xi-3L,39 ⊕ Xi-3L,37 ⊕ (Xi-3L,38 & Xi-3L,31)</td>

            <td class="px-3 py-2 border-b border-gray-700">k5</td>

            <td class="px-3 py-2 border-b border-gray-700">K3i-3</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">x6</td>

            <td class="px-3 py-2 border-b border-gray-700">Xi-3L,32 ⊕ Xi-3L,30 ⊕ (Xi-3L,31 & Xi-3L,24)</td>

            <td class="px-3 py-2 border-b border-gray-700">k6</td>

            <td class="px-3 py-2 border-b border-gray-700">K2i-3</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">x7</td>

            <td class="px-3 py-2 border-b border-gray-700">Xi-3L,45 ⊕ Xi-3L,45 ⊕ (Xi-3L,46 & Xi-3L,39) ⊕ Xi-3L,1</td>

            <td class="px-3 py-2 border-b border-gray-700">k7</td>

            <td class="px-3 py-2 border-b border-gray-700">K4i-3 ⊕ K1i-2</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">x8</td>

            <td class="px-3 py-2 border-b border-gray-700">Xi-3L,46 ⊕ (Xi-3L,47 & Xi-3L,40)</td>

            <td class="px-3 py-2 border-b border-gray-700">k8</td>

            <td class="px-3 py-2 border-b border-gray-700">K6i-3</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">x9</td>

            <td class="px-3 py-2 border-b border-gray-700">Xi-3L,41 ⊕ Xi-3L,39 ⊕ (Xi-3L,40 & Xi-3L,33)</td>

            <td class="px-3 py-2 border-b border-gray-700">k9</td>

            <td class="px-3 py-2 border-b border-gray-700">K4i-3</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">x10</td>

            <td class="px-3 py-2 border-b border-gray-700">Xi-3L,40 ⊕ Xi-3L,38 ⊕ (Xi-3L,39 & Xi-3L,32) ⊕ Xi-3L,42</td>

            <td class="px-3 py-2 border-b border-gray-700">k10</td>

            <td class="px-3 py-2 border-b border-gray-700">K4i-3 ⊕ K4i-2</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">x11</td>

            <td class="px-3 py-2 border-b border-gray-700">Xi-3L,34 ⊕ Xi-3L,32 ⊕ (Xi-3L,39 & Xi-3L,26)</td>

            <td class="px-3 py-2 border-b border-gray-700">k11</td>

            <td class="px-3 py-2 border-b border-gray-700">K3i-3</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">x12</td>

            <td class="px-3 py-2 border-b border-gray-700">Xi-3L,31 ⊕ Xi-3L,29 ⊕ (Xi-3L,30 & Xi-3L,23) ⊕ Xi-3L,33</td>

            <td class="px-3 py-2 border-b border-gray-700">k12</td>

            <td class="px-3 py-2 border-b border-gray-700">K3i-3 ⊕ K3i-2</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">x13</td>

            <td class="px-3 py-2 border-b border-gray-700">Xi-3L,25 ⊕ Xi-3L,23 ⊕ (Xi-3L,24 & Xi-3L,17)</td>

            <td class="px-3 py-2 border-b border-gray-700">k13</td>

            <td class="px-3 py-2 border-b border-gray-700">K2i-3</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">x14</td>

            <td class="px-3 py-2 border-b border-gray-700">Xi-3L,44 ⊕ Xi-3L,42 ⊕ (Xi-3L,43 & Xi-3L,19) ⊕ Xi-3L,26</td>

            <td class="px-3 py-2 border-b border-gray-700">k14</td>

            <td class="px-3 py-2 border-b border-gray-700">K2i-3 ⊕ K2i-2</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">x15</td>

            <td class="px-3 py-2 border-b border-gray-700">Xi-3L,18 ⊕ Xi-3L,16 ⊕ (Xi-3L,17 & Xi-3L,10)</td>

            <td class="px-3 py-2 border-b border-gray-700">k15</td>

            <td class="px-3 py-2 border-b border-gray-700">K1i-3</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">x16</td>

            <td class="px-3 py-2 border-b border-gray-700">Xi-3L,35 ⊕ Xi-3L,33 ⊕ (Xi-3L,34 & Xi-3L,27) ⊕ Xi-3L,37</td>

            <td class="px-3 py-2 border-b border-gray-700">k16</td>

            <td class="px-3 py-2 border-b border-gray-700">K3i-3 ⊕ K3i-2</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">x17</td>

            <td class="px-3 py-2 border-b border-gray-700">Xi-3L,36 ⊕ Xi-3L,34 ⊕ (Xi-3L,35 & Xi-3L,28)</td>

            <td class="px-3 py-2 border-b border-gray-700">k17</td>

            <td class="px-3 py-2 border-b border-gray-700">K3i-3</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">x18</td>

            <td class="px-3 py-2 border-b border-gray-700">Xi-3L,29 ⊕ Xi-3L,27 ⊕ (Xi-3L,28 & Xi-3L,21)</td>

            <td class="px-3 py-2 border-b border-gray-700">k18</td>

            <td class="px-3 py-2 border-b border-gray-700">K2i-3</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">x19</td>

            <td class="px-3 py-2 border-b border-gray-700">Xi-3L,28 ⊕ Xi-3L,26 ⊕ (Xi-3L,27 & Xi-3L,20) ⊕ Xi-3L,30</td>

            <td class="px-3 py-2 border-b border-gray-700">k19</td>

            <td class="px-3 py-2 border-b border-gray-700">K2i-3 ⊕ K3i-2</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">x20</td>

            <td class="px-3 py-2 border-b border-gray-700">Xi-3L,22 ⊕ Xi-3L,20 ⊕ (Xi-3L,21 & Xi-3L,14)</td>

            <td class="px-3 py-2 border-b border-gray-700">k20</td>

            <td class="px-3 py-2 border-b border-gray-700">K2i-3</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">x21</td>

            <td class="px-3 py-2 border-b border-gray-700">Xi-3L,39 ⊕ Xi-3L,37 ⊕ (Xi-3L,38 & Xi-3L,31) ⊕ Xi-3L,41</td>

            <td class="px-3 py-2 border-b border-gray-700">k21</td>

            <td class="px-3 py-2 border-b border-gray-700">K3i-3 ⊕ K4i-2</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">x22</td>

            <td class="px-3 py-2 border-b border-gray-700">Xi-3L,33 ⊕ Xi-3L,31 ⊕ (Xi-3L,32 & Xi-3L,25)</td>

            <td class="px-3 py-2 border-b border-gray-700">k22</td>

            <td class="px-3 py-2 border-b border-gray-700">K3i-3</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">x23</td>

            <td class="px-3 py-2 border-b border-gray-700">Xi-3L,32 ⊕ Xi-3L,30 ⊕ (Xi-3L,31 & Xi-3L,24) ⊕ Xi-3L,34</td>

            <td class="px-3 py-2 border-b border-gray-700">k23</td>

            <td class="px-3 py-2 border-b border-gray-700">K3i-3 ⊕ K3i-2</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">x24</td>

            <td class="px-3 py-2 border-b border-gray-700">Xi-3L,24 ⊕ (Xi-3L,25 & Xi-3L,18)</td>

            <td class="px-3 py-2 border-b border-gray-700">k24</td>

            <td class="px-3 py-2 border-b border-gray-700">K2i-3</td>

          </tr>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">Compress the plaintexts: (Procedure SIMON96-Head) At first, compress the plaintexts into a counter vector <span class="math">V[x_1 - x_{24}]</span> using the linear compression technique.</p>

    <ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">

      <li>For each <span class="math">x_{3} - x_{20}</span></li>

    </ol>

    <p class="text-gray-300">(a) Compress <span class="math">x_{1}, x_{2}, x_{21} - x_{24}</span> as Case <span class="math">f_{6}</span> in Appendix A. There is 6-bit key <span class="math">(k_{1}, k_{2}, k_{21} - k_{24})</span> to store and time is <span class="math">2^{8.36}</span>. So here the memory is about <span class="math">2^{18} \\times 2^{6} = 2^{24}</span> counters and total time is <span class="math">2^{18} \\times 2^{8.36} = 2^{26.36}</span>.</p>

    <ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">

      <li>For each <span class="math">x_{3}, x_{4}, x_{7} - x_{11}, x_{16} - x_{20}, k_{1}, k_{2}, k_{21} - k_{24}</span></li>

    </ol>

    <p class="text-gray-300">(a) Compress <span class="math">x_{5}, x_{6}, x_{12} - x_{15}</span> as Case <span class="math">f_{6}</span> in Appendix A. There is 6-bit key <span class="math">(k_{5}, k_{6}, k_{12} - k_{15})</span> to store and time is <span class="math">2^{8.36}</span>. So here the memory is about <span class="math">2^{18} \\times 2^{6} = 2^{24}</span> counters and total time is <span class="math">2^{18} \\times 2^{8.36} = 2^{26.36}</span>.</p>

    <ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">

      <li>For each <span class="math">x_{16} - x_{20}, k_{1}, k_{2}, k_{5}, k_{6}, k_{12} - k_{15}, k_{21} - k_{24}</span></li>

    </ol>

    <p class="text-gray-300">(a) Compress <span class="math">x_{3}, x_{4}, x_{7} - x_{11}</span> as Case <span class="math">f_{3}</span> in Appendix A. There is 7-bit key <span class="math">(k_{3}, k_{4}, k_{7} - k_{11})</span> to store and time is <span class="math">2^{9.25}</span>. So here the memory is about <span class="math">2^{17} \\times 2^{7} = 2^{24}</span> counters and total time is <span class="math">2^{17} \\times 2^{9.25} = 2^{26.25}</span>.</p>

    <ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">

      <li>For each <span class="math">k_{1} - k_{15}, k_{21} - k_{24}</span></li>

    </ol>

    <p class="text-gray-300">(a) Compress <span class="math">x_{16} - x_{20}</span>, as Case <span class="math">f_{2}</span> in Appendix A. There is 5-bit key <span class="math">(k_{16} - k_{20})</span> to store and time is <span class="math">2^{6.46}</span>. So here the memory is about <span class="math">2^{19} \\times 2^{5} = 2^{24}</span> counters and total time is <span class="math">2^{19} \\times 2^{6.46} = 2^{25.46}</span>.</p>

    <ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">

      <li>The total time is about <span class="math">2^{28.15}</span> additions and memory is <span class="math">\\mathcal{O}(2^{24})</span></li>

    </ol>

    <p class="text-gray-300">If we add four rounds after the linear hull, according to Table 16, <span class="math">X_{L,2}^{i+30} \\oplus X_{L,42}^{i+30} \\oplus X_{L,46}^{i+30} \\oplus X_{R,0}^{i+30} \\oplus X_{R,40}^{i+30}</span> can be represented as</p>

    <div class="my-4 text-center"><span class="math-block">\\begin{array}{l} x_{0} \\oplus k_{0} \\oplus ((x_{1} \\oplus k_{1}) \\&amp;amp; (x_{2} \\oplus k_{2})) \\oplus \\\\ ((x_{3} \\oplus k_{3} \\oplus ((x_{4} \\oplus k_{4}) \\&amp;amp; (x_{5} \\oplus k_{5}))) \\&amp;amp; (x_{6} \\oplus k_{6} \\oplus ((x_{5} \\oplus k_{5}) \\&amp;amp; (x_{7} \\oplus k_{7}))) \\oplus \\\\ ((x_{8} \\oplus k_{8} \\oplus ((x_{9} \\oplus k_{9}) \\&amp;amp; (x_{10} \\oplus k_{10}))) \\&amp;amp; (x_{11} \\oplus k_{11} \\oplus ((x_{10} \\oplus k_{10}) \\&amp;amp; (x_{12} \\oplus k_{12}))) \\oplus \\\\ ((x_{13} \\oplus k_{13} \\oplus ((x_{14} \\oplus k_{14}) \\&amp;amp; (x_{15} \\oplus k_{15}))) \\&amp;amp; (x_{16} \\oplus k_{16} \\oplus ((x_{15} \\oplus k_{15}) \\&amp;amp; (x_{17} \\oplus k_{17}))) \\oplus \\\\ \\{(x_{18} \\oplus k_{18} \\oplus ((x_{19} \\oplus k_{19}) \\&amp;amp; (\\underline{x_{20} \\oplus k_{20}})) \\oplus \\\\ ((x_{21} \\oplus k_{21} \\oplus ((x_{22} \\oplus k_{22}) \\&amp;amp; (x_{23} \\oplus k_{23}))) \\&amp;amp; (x_{24} \\oplus k_{24} \\oplus ((x_{23} \\oplus k_{23}) \\&amp;amp; (x_{25} \\oplus k_{25})))) \\} \\&amp;amp; \\end{array}</span></div>

    <div class="my-4 text-center"><span class="math-block">\\begin{array}{l} (x_{26} \\oplus k_{26} \\oplus ((\\underline{x_{20} \\oplus k_{20}}) \\&amp;amp; (\\underline{x_{27} \\oplus k_{27}})) \\oplus \\\\ ((x_{24} \\oplus k_{24} \\oplus ((x_{23} \\oplus k_{23}) \\&amp;amp; (x_{25} \\oplus k_{25}))) \\&amp;amp; (x_{28} \\oplus k_{28} \\oplus ((x_{25} \\oplus k_{25}) \\&amp;amp; (x_{29} \\oplus k_{29})))) \\} \\oplus \\\\ \\{(x_{30} \\oplus k_{30} \\oplus ((x_{31} \\oplus k_{31}) \\&amp;amp; (x_{15} \\oplus k_{15})) \\oplus \\\\ ((x_{32} \\oplus k_{32} \\oplus ((x_{20} \\oplus k_{20}) \\&amp;amp; (x_{27} \\oplus k_{27}))) \\&amp;amp; (x_{33} \\oplus k_{33} \\oplus ((x_{27} \\oplus k_{27}) \\&amp;amp; (x_{34} \\oplus k_{34})))) \\} \\&amp;amp; \\end{array}</span></div>

    <div class="my-4 text-center"><span class="math-block">\\begin{array}{l} (x_{35} \\oplus k_{35} \\oplus ((x_{15} \\oplus k_{15}) \\&amp;amp; (x_{17} \\oplus k_{17})) \\oplus \\\\ ((x_{33} \\oplus k_{33} \\oplus ((x_{27} \\oplus k_{27}) \\&amp;amp; (x_{34} \\oplus k_{34}))) \\&amp;amp; (x_{36} \\oplus k_{36} \\oplus ((x_{34} \\oplus k_{34}) \\&amp;amp; (x_{37} \\oplus k_{37})))) \\} \\\\ \\end{array}</span></div>

    <p class="text-gray-300">Compress the ciphertexts: (Procedure SIMON96-Tail) At first, compress the ciphertexts into a counter vector <span class="math">V[x_1 - x_{37}]</span> using the linear compression technique. To simplify our description of attack, we regard the <span class="math">x_{20}, x_{27}</span> with underline as new variables <span class="math">x_{20}&#x27;, x_{27}&#x27;</span>. It is the same with <span class="math">k_{20}</span> and <span class="math">k_{27}</span>.</p>

    <ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">

      <li>For each <span class="math">x_{8} - x_{37}</span></li>

    </ol>

    <p class="text-gray-300">(a) Compress <span class="math">x_{1} - x_{7}</span> as Case <span class="math">f_{3}</span> in Appendix A. There is 7-bit key <span class="math">(k_{1} - k_{7})</span> to store and time is <span class="math">2^{9.25}</span>. So here the memory is about <span class="math">2^{30} \\times 2^{7} = 2^{37}</span> counters and total time is <span class="math">2^{30} \\times 2^{9.25} = 2^{39.25}</span>.</p>

    <ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">

      <li>For each <span class="math">x_{13} - x_{37}, k_{1} - k_{7}</span></li>

    </ol>

    <p class="text-gray-300">(a) Compress <span class="math">x_{8} - x_{12}</span> as Case <span class="math">f_{2}</span> in Appendix A. There is 5-bit key <span class="math">(k_{8} - k_{12})</span> to store and time is <span class="math">2^{6.46}</span>. So here the memory is about <span class="math">2^{32} \\times 2^{5} = 2^{37}</span> counters and total time is <span class="math">2^{32} \\times 2^{6.46} = 2^{38.46}</span>.</p>

    <ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">

      <li>For each <span class="math">x_{18}, x_{19}, x_{20}&#x27;, x_{21} - x_{26}, x_{27}&#x27;, x_{28}, x_{29}, k_{1} - k_{12}</span></li>

    </ol>

    <p class="text-gray-300">(a) Compress <span class="math">x_{13} - x_{17}, x_{20}, x_{27}, x_{30} - x_{37}</span> as Case <span class="math">f_{7}</span> in Appendix A. There is 15-bit key <span class="math">(k_{13} - k_{17}, k_{20}, k_{27}, k_{30} - k_{37})</span> to store and time is <span class="math">2^{18.08}</span>. So here the memory is about <span class="math">2^{24} \\times 2^{15} = 2^{39}</span> counters and total time is <span class="math">2^{24} \\times 2^{18.08} = 2^{42.08}</span>.</p>

    <ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">

      <li>For each <span class="math">k_{1} - k_{17}, k_{20}, k_{27}, k_{30} - k_{37}</span></li>

    </ol>

    <p class="text-gray-300">(a) Compress <span class="math">x_{18}, x_{19}, x_{20}&#x27;, x_{21} - x_{26}, x_{27}&#x27;, x_{28}, x_{29}</span>, as Case <span class="math">f_{7}</span> in Appendix A. There is 10-bit key <span class="math">(k_{18}, k_{19}, k_{21} - k_{26}, k_{28}, k_{29})</span> to store and time is <span class="math">2^{15.99}</span>. So here the memory is about <span class="math">2^{27} \\times 2^{10} = 2^{37}</span> counters and total time is <span class="math">2^{27} \\times 2^{15.99} = 2^{42.99}</span>.</p>

    <p class="text-gray-300">26</p>

    <p class="text-gray-300">Table 16: Add 4 rounds after  <span class="math">X_{L,2}^{i + 30} \\oplus X_{L,42}^{i + 30} \\oplus X_{L,46}^{i + 30} \\oplus X_{R,0}^{i + 30} \\oplus X_{R,40}^{i + 30}</span>  for SIMON96</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">x0</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">XR,0i+34⊕XR,12⊕(XR,13⊕XR,42⊕XR,43⊕XR,44⊕XR,45⊕XR,46⊕XR,47⊕XR,48⊕XR,49⊕XR,50⊕XR,51⊕XR,52⊕XR,53⊕XR,54⊕XR,55⊕XR,56⊕XR,57⊕XR,58⊕XR,59⊕XR,60⊕XR,61⊕XR,62⊕XR,63⊕XR,64⊕XR,65⊕XR,66⊕XR,67⊕XR,68⊕XR,69⊕XR,70⊕XR,71⊕XR,72⊕XR,73⊕XR,74⊕XR,75⊕XR,76⊕XR,77⊕XR,78⊕XR,79⊕XR,80⊕XR,81⊕XR,82⊕XR,83⊕XR,84⊕XR,85⊕XR,86⊕XR,87⊕XR,88⊕XR,89⊕XR,90⊕XR,91⊕XR,92⊕XR,93⊕XR,94⊕XR,95⊕XR,96⊕XR,97⊕XR,98⊕XR,99⊕XR,100</th>

          </tr>

        </thead>

        <tbody>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">x1</td>

            <td class="px-3 py-2 border-b border-gray-700">XR,134⊕XR,135⊕(XR,134⊕XR,135⊕XR,135⊕XR,135⊕XR,135⊕XR,135⊕XR,135⊕XR,135⊕XR,135⊕XR,135⊕XR,135⊕XR,135⊕XR,135</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">x2</td>

            <td class="px-3 py-2 border-b border-gray-700">XR,134⊕XR,135⊕XR,135⊕XR,135⊕XR,135⊕XR,135⊕XR,135⊕XR,135⊕XR,135⊕XR,135⊕XR,135⊕XR,135</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">x3</td>

            <td class="px-3 py-2 border-b border-gray-700">XR,134⊕XR,135⊕XR,135⊕XR,135⊕XR,135⊕XR,135⊕XR,135⊕XR,135⊕XR,135</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">x4</td>

            <td class="px-3 py-2 border-b border-gray-700">XR,134⊕XR,135⊕XR,135⊕XR,135⊕XR,135⊕XR,135⊕XR,135</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">x5</td>

            <td class="px-3 py-2 border-b border-gray-700">XR,134⊕XR,135⊕XR,135⊕XR,135⊕XR,135⊕XR,135⊕XR,135</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">x6</td>

            <td class="px-3 py-2 border-b border-gray-700">XR,134⊕XR,135⊕XR,135⊕XR,135⊕XR,135⊕XR,135</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">x7</td>

            <td class="px-3 py-2 border-b border-gray-700">XR,134⊕XR,135⊕XR,135⊕XR,135⊕XR,135⊕XR,135</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">x8</td>

            <td class="px-3 py-2 border-b border-gray-700">XR,134⊕XR,135⊕XR,135⊕XR,135⊕XR,135⊕XR,135</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">x9</td>

            <td class="px-3 py-2 border-b border-gray-700">XR,134⊕XR,135⊕XR,135⊕XR,135⊕XR,135</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">x10</td>

            <td class="px-3 py-2 border-b border-gray-700">XR,134⊕XR,135⊕XR,135⊕XR,135⊕XR,135</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">x11</td>

            <td class="px-3 py-2 border-b border-gray-700">XR,134⊕XR,135⊕XR,135⊕XR,135⊕XR,135</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">x12</td>

            <td class="px-3 py-2 border-b border-gray-700">XR,134⊕XR,135⊕XR,135⊕XR,135⊕XR,135</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">x13</td>

            <td class="px-3 py-2 border-b border-gray-700">XR,134⊕XR,135⊕XR,135⊕XR,135⊕XR,135</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">x14</td>

            <td class="px-3 py-2 border-b border-gray-700">XR,134⊕XR,135⊕XR,135⊕XR,135</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">x15</td>

            <td class="px-3 py-2 border-b border-gray-700">XR,134⊕XR,135⊕XR,135⊕XR,135</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">x16</td>

            <td class="px-3 py-2 border-b border-gray-700">XR,134⊕XR,135⊕XR,135⊕XR,135</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">x17</td>

            <td class="px-3 py-2 border-b border-gray-700">XR,134⊕XR,135⊕XR,135⊕XR,135</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">x18</td>

            <td class="px-3 py-2 border-b border-gray-700">XR,134⊕XR,135⊕XR,135⊕XR,135</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">x19</td>

            <td class="px-3 py-2 border-b border-gray-700">XR,134⊕XR,135⊕XR,135⊕XR,135</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">x20</td>

            <td class="px-3 py-2 border-b border-gray-700">XR,134⊕XR,135⊕XR,135⊕XR,135</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">x21</td>

            <td class="px-3 py-2 border-b border-gray-700">XR,134⊕XR,135⊕XR,135⊕XR,135</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">x22</td>

            <td class="px-3 py-2 border-b border-gray-700">XR,134⊕XR,135⊕XR,135⊕XR,135</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">x23</td>

            <td class="px-3 py-2 border-b border-gray-700">XR,134⊕XR,135⊕XR,135</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">x24</td>

            <td class="px-3 py-2 border-b border-gray-700">XR,134⊕XR,135⊕XR,135</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">x25</td>

            <td class="px-3 py-2 border-b border-gray-700">XR,134⊕XR,135⊕XR,135</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">x26</td>

            <td class="px-3 py-2 border-b border-gray-700">XR,134⊕XR,135⊕XR,135</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">x27</td>

            <td class="px-3 py-2 border-b border-gray-700">XR,134⊕XR,135⊕XR,135</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">x28</td>

            <td class="px-3 py-2 border-b border-gray-700">XR,134⊕XR,135⊕XR,135</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">x29</td>

            <td class="px-3 py-2 border-b border-gray-700">XR,134⊕XR,135⊕XR,135</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">x30</td>

            <td class="px-3 py-2 border-b border-gray-700">XR,134⊕XR,135⊕XR,135</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">x31</td>

            <td class="px-3 py-2 border-b border-gray-700">XR,134⊕XR,135⊕XR,135</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">x32</td>

            <td class="px-3 py-2 border-b border-gray-700">XR,134⊕XR,135⊕XR,135</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">x33</td>

            <td class="px-3 py-2 border-b border-gray-700">XR,134⊕XR,135⊕XR,135</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">x34</td>

            <td class="px-3 py-2 border-b border-gray-700">XR,134⊕XR,135⊕XR,135</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">x35</td>

            <td class="px-3 py-2 border-b border-gray-700">XR,134⊕XR,135⊕XR,135</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">x36</td>

            <td class="px-3 py-2 border-b border-gray-700">XR,134⊕XR,135⊕XR,135</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">x37</td>

            <td class="px-3 py-2 border-b border-gray-700">XR,134⊕XR,135⊕XR,135</td>

          </tr>

        </tbody>

      </table>

    </div>

    <ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">

      <li>The total time is less than <span class="math">2^{43.71}</span> additions and memory is <span class="math">\\mathcal{O}(2^{39})</span>.</li>

    </ol>

    <p class="text-gray-300">37-round attack on Simon96/96. We add three rounds before and four rounds after the 30-round linear distinguisher to attack 37-round Simon96/K. Suppose we use <span class="math">N=2\\bar{\\epsilon}^{-2}=2^{95.2}</span> known plaintext-ciphertext pairs. Set advantage <span class="math">a=8</span>. The success probability would be <span class="math">0.477</span>. At first, compress the <span class="math">N</span> plaintext-ciphertext pairs to <span class="math">2^{24+37}</span> counters according to Table 15 and 16. Suppose the plaintext be compressed to <span class="math">x_{P}</span> and ciphertext be compressed to <span class="math">x_{C}</span>.</p>

    <ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">

      <li>For each of <span class="math">2^{37}</span> <span class="math">x_{C}</span></li>

    </ol>

    <ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">

      <li>Call Procedure Simon96-Head, and store the counters according to the keys used in the first three rounds</li>

      <li>For each of <span class="math">2^{24}</span> keys involved in the first three rounds</li>

    </ol>

    <ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">

      <li>Call Procedure Simon96-Tail, and store the counters according to the keys used in the last four rounds</li>

      <li>Rank the keys and exhaustive the candidates with the help of key schedule</li>

    </ol>

    <p class="text-gray-300">Time: 1. <span class="math">2^{37}\\times 2^{28.15}=2^{65.15}</span> additions; 2. <span class="math">2^{24}\\times 2^{43.71}=2^{67.71}</span> additions. So it needs <span class="math">2^{65.15}+2^{67.71}=2^{67.94}</span> additions to get the bias for the subkeys. 3. The exhaustive phase needs <span class="math">2^{96-8}=2^{88}</span> 37-round encryptions. So in total the time is about <span class="math">2^{88}</span> encryptions and <span class="math">2^{67.94}</span> additions.</p>

    <p class="text-gray-300">38-round attack on Simon96/144. Expand one more round before <span class="math">X^{i-3}</span>. The key bits of <span class="math">K^{i-4}</span> involved to obtain the <span class="math">x</span> represented in Table 15 are <span class="math">\\kappa_{1}=(K^{i-4}_{1},K^{i-4}_{10},K^{i-4}_{14},K^{i-4}_{16}-K^{i-4}_{18},K^{i-4}_{20}-K^{i-4}_{35},K^{i-4}_{37}-K^{i-4}_{42},K^{i-4}_{45}-K^{i-4}_{47})</span>, in total 31 bits.</p>

    <ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">

      <li>Guess each of <span class="math">2^{31}</span> <span class="math">\\kappa_{1}</span></li>

    </ol>

    <ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">

      <li>Encrypt the <span class="math">N</span> plaintexts by one round. Compress the internal states to a counter vectr of size <span class="math">2^{61}</span>.</li>

      <li>Do as first two steps of the 37-round attack</li>

      <li>Rank the keys and exhaustive the candidates with the help of key schedule</li>

    </ol>

    <p class="text-gray-300">Time: (1.a) <span class="math">2^{31}\\times N=2^{126.2}</span> one-round encryptions. (1.b) <span class="math">2^{31}\\times 2^{67.94}=2^{98.94}</span> additons. 2.The exhaustive phase needs <span class="math">2^{144-8}=2^{136}</span> 38-round encryptions. So in total the time is about <span class="math">2^{136}</span> enxryptions and <span class="math">2^{98.94}</span> additions.</p>

    <h3 id="sec-23" class="text-xl font-semibold mt-8">B.4 Linear Attack on Simon128/<span class="math">K</span></h3>

    <p class="text-gray-300">The linear hull used to attack Simon128/<span class="math">K</span> is</p>

    <p class="text-gray-300"><span class="math">X^{i}_{L,2}\\oplus X^{i}_{L,58}\\oplus X^{i}_{L,62}\\oplus X^{i}_{R,60}\\rightarrow X^{i+41}_{L,60}\\oplus X^{i+41}_{R,2}\\oplus X^{i+41}_{R,58}\\oplus X^{i+41}_{R,62},</span></p>

    <p class="text-gray-300">which is proposed in <em>[6]</em> with pop</p>

    <p class="text-gray-300">Table 17: 4 rounds beofre  <span class="math">X_{L,2}^{i}\\oplus X_{L,58}^{i}\\oplus X_{L,62}^{i}\\oplus X_{R,60}^{i}</span>  for SIMON128</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">x0</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Xi-4L,2⊕ Xi-4L,50⊕ Xi-4R,53⊕ (Xi-4L,51&Xi-4L,44) ⊕ Xi-4L,54⊕ Xi-4L,58</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">k0</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Ki-4L,54⊕ Ki-2⊕ Ki-3⊕ Ki-3⊕ Ki-2⊕ Ki-1⊕ Ki-1</th>

          </tr>

        </thead>

        <tbody>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">x1</td>

            <td class="px-3 py-2 border-b border-gray-700">Xi-4L,63⊕ Xi-4R,1⊕ (Xi-4L,0&Xi-4L,57)</td>

            <td class="px-3 py-2 border-b border-gray-700">k1</td>

            <td class="px-3 py-2 border-b border-gray-700">Ki-4L,1</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">x2</td>

            <td class="px-3 py-2 border-b border-gray-700">Xi-4L,56⊕ Xi-4R,58⊕ (Xi-4L,57&Xi-4L,50)</td>

            <td class="px-3 py-2 border-b border-gray-700">k2</td>

            <td class="px-3 py-2 border-b border-gray-700">Ki-4L,58</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">x3</td>

            <td class="px-3 py-2 border-b border-gray-700">Xi-4L,51⊕ Xi-4R,53⊕ (Xi-4L,52&Xi-4L,45)</td>

            <td class="px-3 py-2 border-b border-gray-700">k3</td>

            <td class="px-3 py-2 border-b border-gray-700">Ki-4L,53</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">x4</td>

            <td class="px-3 py-2 border-b border-gray-700">Xi-4L,44⊕ Xi-4R,46⊕ (Xi-4L,45&Xi-4L,38)</td>

            <td class="px-3 py-2 border-b border-gray-700">k4</td>

            <td class="px-3 py-2 border-b border-gray-700">Ki-4L,46</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">x5</td>

            <td class="px-3 py-2 border-b border-gray-700">Xi-4L,55⊕ Xi-4R,57⊕ (Xi-4L,56&Xi-4L,49)</td>

            <td class="px-3 py-2 border-b border-gray-700">k5</td>

            <td class="px-3 py-2 border-b border-gray-700">Ki-4L,57</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">x6</td>

            <td class="px-3 py-2 border-b border-gray-700">Xi-4L,48⊕ Xi-4R,50⊕ (Xi-4L,49&Xi-4L,42)</td>

            <td class="px-3 py-2 border-b border-gray-700">k6</td>

            <td class="px-3 py-2 border-b border-gray-700">Ki-4L,50</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">x7</td>

            <td class="px-3 py-2 border-b border-gray-700">Xi-4L,59⊕ Xi-4R,61⊕ (Xi-4L,60&Xi-4L,53) ⊕ Xi-4L,63</td>

            <td class="px-3 py-2 border-b border-gray-700">k7</td>

            <td class="px-3 py-2 border-b border-gray-700">Ki-4L,61⊕ Ki-3</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">x8</td>

            <td class="px-3 py-2 border-b border-gray-700">Xi-4L,60⊕ Xi-4R,62⊕ (Xi-4L,61&Xi-4L,54)</td>

            <td class="px-3 py-2 border-b border-gray-700">k8</td>

            <td class="px-3 py-2 border-b border-gray-700">Ki-4L,62</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">x9</td>

            <td class="px-3 py-2 border-b border-gray-700">Xi-4L,53⊕ Xi-4R,55⊕ (Xi-4L,54&Xi-4L,47)</td>

            <td class="px-3 py-2 border-b border-gray-700">k9</td>

            <td class="px-3 py-2 border-b border-gray-700">Ki-4L,55</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">x10</td>

            <td class="px-3 py-2 border-b border-gray-700">Xi-4L,52⊕ Xi-4R,54⊕ (Xi-4L,53&Xi-4L,46) ⊕ Xi-4L,56</td>

            <td class="px-3 py-2 border-b border-gray-700">k10</td>

            <td class="px-3 py-2 border-b border-gray-700">Ki-4L,54⊕ Ki-3</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">x11</td>

            <td class="px-3 py-2 border-b border-gray-700">Xi-4L,46⊕ Xi-4R,48⊕ (Xi-4L,47&Xi-4L,40)</td>

            <td class="px-3 py-2 border-b border-gray-700">k11</td>

            <td class="px-3 py-2 border-b border-gray-700">Ki-4L,48</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">x12</td>

            <td class="px-3 py-2 border-b border-gray-700">Xi-4L,44⊕ Xi-4R,46⊕ (Xi-4L,45&Xi-4L,38) ⊕ Xi-4L,48</td>

            <td class="px-3 py-2 border-b border-gray-700">k12</td>

            <td class="px-3 py-2 border-b border-gray-700">Ki-4L,46⊕ Ki-3</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">x13</td>

            <td class="px-3 py-2 border-b border-gray-700">Xi-4L,45⊕ Xi-4R,47⊕ (Xi-4L,46&Xi-4L,39)</td>

            <td class="px-3 py-2 border-b border-gray-700">k13</td>

            <td class="px-3 py-2 border-b border-gray-700">Ki-4L,47</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">x14</td>

            <td class="px-3 py-2 border-b border-gray-700">Xi-4L,38⊕ Xi-4R,40⊕ (Xi-4L,39&Xi-4L,32)</td>

            <td class="px-3 py-2 border-b border-gray-700">k14</td>

            <td class="px-3 py-2 border-b border-gray-700">Ki-4L,40</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">x15</td>

            <td class="px-3 py-2 border-b border-gray-700">Xi-4L,51⊕ Xi-4R,53⊕ (Xi-4L,52&Xi-4L,45) ⊕ Xi-4L,55</td>

            <td class="px-3 py-2 border-b border-gray-700">k15</td>

            <td class="px-3 py-2 border-b border-gray-700">Ki-4L,53⊕ Ki-3</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">x16</td>

            <td class="px-3 py-2 border-b border-gray-700">Xi-4L,52⊕ Xi-4R,54⊕ (Xi-4L,53&Xi-4L,46)</td>

            <td class="px-3 py-2 border-b border-gray-700">k16</td>

            <td class="px-3 py-2 border-b border-gray-700">Ki-4L,54</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">x17</td>

            <td class="px-3 py-2 border-b border-gray-700">Xi-4L,59⊕ Xi-4R,61⊕ (Xi-4L,60&Xi-4L,53) ⊕ Xi-4L,1⊕ (Xi-4L,4&Xi-4L,57)</td>

            <td class="px-3 py-2 border-b border-gray-700">k17</td>

            <td class="px-3 py-2 border-b border-gray-700">Ki-4L,61⊕ Ki-3⊕ Ki-2</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">x18</td>

            <td class="px-3 py-2 border-b border-gray-700">Xi-4L,60⊕ Xi-4R,62⊕ (Xi-4L,61&Xi-4L,54) ⊕ Xi-4L,0</td>

            <td class="px-3 py-2 border-b border-gray-700">k18</td>

            <td class="px-3 py-2 border-b border-gray-700">Ki-4L,62⊕ Ki-3</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">x19</td>

            <td class="px-3 py-2 border-b border-gray-700">Xi-4L,61⊕ Xi-4R,63⊕ (Xi-4L,62&Xi-4L,55)</td>

            <td class="px-3 py-2 border-b border-gray-700">k19</td>

            <td class="px-3 py-2 border-b border-gray-700">Ki-4L,63</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">x20</td>

            <td class="px-3 py-2 border-b border-gray-700">Xi-4L,54⊕ Xi-4R,56⊕ (Xi-4L,55&Xi-4L,48)</td>

            <td class="px-3 py-2 border-b border-gray-700">k20</td>

            <td class="px-3 py-2 border-b border-gray-700">Ki-4L,66</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">x21</td>

            <td class="px-3 py-2 border-b border-gray-700">Xi-4L,53⊕ Xi-4R,55⊕ (Xi-4L,54&Xi-4L,47) ⊕ Xi-4L,57</td>

            <td class="px-3 py-2 border-b border-gray-700">k21</td>

            <td class="px-3 py-2 border-b border-gray-700">Ki-4L,55⊕ Ki-3</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">x22</td>

            <td class="px-3 py-2 border-b border-gray-700">Xi-4L,47⊕ Xi-4R,49⊕ (Xi-4L,48&Xi-4L,41)</td>

            <td class="px-3 py-2 border-b border-gray-700">k22</td>

            <td class="px-3 py-2 border-b border-gray-700">Ki-4L,60</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">x23</td>

            <td class="px-3 py-2 border-b border-gray-700">Xi-4L,52⊕ Xi-4R,54⊕ (Xi-4L,53&Xi-4L,46) ⊕ Xi-4L,58⊕ (Xi-4L,57&Xi-4L,50)</td>

            <td class="px-3 py-2 border-b border-gray-700">k23</td>

            <td class="px-3 py-2 border-b border-gray-700">Ki-4L,54⊕ Ki-4⊕ Ki-3⊕ Ki-2</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">x24</td>

            <td class="px-3 py-2 border-b border-gray-700">Xi-4L,46⊕ Xi-4R,48⊕ (Xi-4L,48&Xi-4L,40) ⊕ Xi-4L,50</td>

            <td class="px-3 py-2 border-b border-gray-700">k24</td>

            <td class="px-3 py-2 border-b border-gray-700">Ki-4L,48⊕ Ki-3</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">x25</td>

            <td class="px-3 py-2 border-b border-gray-700">Xi-4L,40⊕ Xi-4L,42⊕ (Xi-4L,41&Xi-4L,33)</td>

            <td class="px-3 py-2 border-b border-gray-700">k25</td>

            <td class="px-3 py-2 border-b border-gray-700">Ki-4L,42</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">x26</td>

            <td class="px-3 py-2 border-b border-gray-700">Xi-4L,51⊕ Xi-4L,53⊕ (Xi-4L,52&Xi-4L,45) ⊕ Xi-4L,57⊕ (Xi-4L,56&Xi-4L,49)</td>

            <td class="px-3 py-2 border-b border-gray-700">k26</td>

            <td class="px-3 py-2 border-b border-gray-700">Ki-4L,53⊕ Ki-4⊕ Ki-3⊕ Ki-2</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">x27</td>

            <td class="px-3 py-2 border-b border-gray-700">Xi-4L,45⊕ Xi-4L,47⊕ (Xi-4L,48&Xi-4L,39) ⊕ Xi-4L,49</td>

            <td class="px-3 py-2 border-b border-gray-700">k27</td>

            <td class="px-3 py-2 border-b border-gray-700">Ki-4L,49⊕ Ki-3</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">x28</td>

            <td class="px-3 py-2 border-b border-gray-700">Xi-4L,39⊕ Xi-4L,41⊕ (Xi-4L,40&Xi-4L,33)</td>

            <td class="px-3 py-2 border-b border-gray-700">k28</td>

            <td class="px-3 py-2 border-b border-gray-700">Ki-4L,41</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">x29</td>

            <td class="px-3 py-2 border-b border-gray-700">Xi-4L,44⊕ Xi-4L,46⊕ (Xi-4L,48&Xi-4L,38) ⊕ Xi-4L,50⊕ (Xi-4L,49&Xi-4L,42)</td>

            <td class="px-3 py-2 border-b border-gray-700">k29</td>

            <td class="px-3 py-2 border-b border-gray-700">Ki-4L,46⊕ Ki-3⊕ Ki-2</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">x30</td>

            <td class="px-3 py-2 border-b border-gray-700">Xi-4L,38⊕ Xi-4L,40⊕ (Xi-4L,39&Xi-4L,32) ⊕ Xi-4L,42</td>

            <td class="px-3 py-2 border-b border-gray-700">k30</td>

            <td class="px-3 py-2 border-b border-gray-700">Ki-4L,40⊕ Ki-2</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">x31</td>

            <td class="px-3 py-2 border-b border-gray-700">Xi-4L,32⊕ Xi-4L,34⊕ (Xi-4L,33&Xi-4L,26)</td>

            <td class="px-3 py-2 border-b border-gray-700">k31</td>

            <td class="px-3 py-2 border-b border-gray-700">Ki-4L,34</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">x32</td>

            <td class="px-3 py-2 border-b border-gray-700">Xi-4L,55⊕ Xi-4L,57⊕ (Xi-4L,56&Xi-4L,49) ⊕ Xi-4L,60&Xi-4L,53)</td>

            <td class="px-3 py-2 border-b border-gray-700">k32</td>

            <td class="px-3 py-2 border-b border-gray-700">Ki-4L,57⊕ Ki-4⊕ Ki-3⊕ Ki-2</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">x33</td>

            <td class="px-3 py-2 border-b border-gray-700">Xi-4L,49⊕ Xi-4L,51⊕ (Xi-4L,50&Xi-4L,33)</td>

            <td class="px-3 py-2 border-b border-gray-700">k33</td>

            <td class="px-3 py-2 border-b border-gray-700">Ki-4L,51</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">x34</td>

            <td class="px-3 py-2 border-b border-gray-700">Xi-4L,56⊕ Xi-4L,58⊕ (Xi-4L,57&Xi-4L,50) ⊕ Xi-4L,60</td>

            <td class="px-3 py-2 border-b border-gray-700">k34</td>

            <td class="px-3 py-2 border-b border-gray-700">Ki-4L,58⊕ Ki-3</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">x35</td>

            <td class="px-3 py-2 border-b border-gray-700">Xi-4L,57⊕ Xi-4L,59⊕ (Xi-4L,58&Xi-4L,51)</td>

            <td class="px-3 py-2 border-b border-gray-700">k35</td>

            <td class="px-3 py-2 border-b border-gray-700">Ki-4L,59</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">x36</td>

            <td class="px-3 py-2 border-b border-gray-700">Xi-4L,50⊕ Xi-4L,52⊕ (Xi-4L,51&Xi-4L,44)</td>

            <td class="px-3 py-2 border-b border-gray-700">k36</td>

            <td class="px-3 py-2 border-b border-gray-700">Ki-4L,52</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">x37</td>

            <td class="px-3 py-2 border-b border-gray-700">Xi-4L,49⊕ Xi-4L,51⊕ (Xi-4L,50&Xi-4L,43) ⊕ Xi-4L,53</td>

            <td class="px-3 py-2 border-b border-gray-700">k37</td>

            <td class="px-3 py-2 border-b border-gray-700">Ki-4L,51⊕ Ki-3</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">x38</td>

            <td class="px-3 py-2 border-b border-gray-700">Xi-4L,43⊕ Xi-4L,45⊕ (Xi-4L,44&Xi-4L,37)</td>

            <td class="px-3 py-2 border-b border-gray-700">k38</td>

            <td class="px-3 py-2 border-b border-gray-700">Ki-4L,53</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">x39</td>

            <td class="px-3 py-2 border-b border-gray-700">Xi-4L,48⊕ Xi-4L,50⊕ (Xi-4L,49&Xi-4L,42) ⊕ Xi-4L,53⊕ (Xi-4L,53&Xi-4L,46)</td>

            <td class="px-3 py-2 border-b border-gray-700">k39</td>

            <td class="px-3 py-2 border-b border-gray-700">Ki-4L,50⊕ Ki-4⊕ Ki-3⊕ Ki-2</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">x40</td>

            <td class="px-3 py-2 border-b border-gray-700">Xi-4L,42⊕ Xi-4L,44⊕ (Xi-4L,43&Xi-4L,36)</td>

            <td class="px-3 py-2 border-b border-gray-700">k40</td>

            <td class="px-3 py-2 border-b border-gray-700">Ki-4L,44</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">x41</td>

            <td class="px-3 py-2 border-b border-gray-700">Xi-4L,42⊕ Xi-4L,44⊕ (Xi-4L,43&Xi-4L,36) ⊕ Xi-4L,46</td>

            <td class="px-3 py-2 border-b border-gray-700">k41</td>

            <td class="px-3 py-2 border-b border-gray-700">Ki-4L,44⊕ Ki-3</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">x42</td>

            <td class="px-3 py-2 border-b border-gray-700">Xi-4L,36⊕ Xi-4L,38⊕ (Xi-4L,37&Xi-4L,30)</td>

            <td class="px-3 py-2 border-b border-gray-700">k42</td>

            <td class="px-3 py-2 border-b border-gray-700">Ki-4L,38</td>

          </tr>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">Notice:  <span class="math">x_{17} = x_{1}\\oplus x_{7},x_{23} = x_{2}\\oplus x_{10},x_{26} = x_{5}\\oplus x_{15},x_{29} = x_{6}\\oplus x_{12}</span></p>

    <p class="text-gray-300">If we add four rounds before the linear hull, according to Table 17, <span class="math">X^{i}_{L,2}\\oplus X^{i}_{L,58}\\oplus X^{i}_{L,62}\\oplus X^{i}_{R,60}</span> can be represented as</p>

    <p class="text-gray-300"><span class="math">x_{0}\\oplus k_{0}\\oplus((x_{1}\\oplus k_{1})\\&amp;(x_{2}\\oplus k_{2}))\\oplus((x_{3}\\oplus k_{3})\\&amp;(x_{4}\\oplus k_{4}))\\oplus((x_{5}\\oplus k_{5})\\&amp;(x_{6}\\oplus k_{6}))\\oplus</span> <span class="math">((x_{7}\\oplus k_{7}\\oplus((x_{8}\\oplus k_{8})\\&amp;(x_{9}\\oplus k_{9})))\\&amp;(x_{10}\\oplus k_{10}\\oplus((x_{9}\\oplus k_{9})\\&amp;(x_{11}\\oplus k_{11}))))\\oplus</span> <span class="math">((x_{12}\\oplus k_{12}\\oplus((x_{13}\\oplus k_{13})\\&amp;(x_{14}\\oplus k_{14})))\\&amp;(x_{15}\\oplus k_{15}\\oplus((x_{13}\\oplus k_{13})\\&amp;(x_{16}\\oplus k_{16}))))\\oplus</span> <span class="math">\\{(x_{17}\\oplus k_{17}\\oplus((x_{8}\\oplus k_{8})\\&amp;(x_{9}\\oplus k_{9}))\\oplus</span> <span class="math">((x_{18}\\oplus k_{18}\\oplus((x_{19}\\oplus k_{19})\\&amp;(x_{20}\\oplus k_{20})))\\&amp;(x_{21}\\oplus k_{21}\\oplus((x_{20}\\oplus k_{20})\\&amp;(x_{22}\\oplus k_{22})))))\\&amp;</span> <span class="math">(x_{23}\\oplus k_{23}\\oplus((x_{9}\\oplus k_{9})\\&amp;(x_{11}\\oplus k_{11}))\\oplus</span> <span class="math">((x_{21}\\oplus k_{21}\\oplus((x_{20}\\oplus k_{20})\\&amp;(x_{22}\\oplus k_{22})))\\&amp;(x_{24}\\oplus k_{24}\\oplus((x_{22}\\oplus k_{22})\\&amp;(x_{25}\\oplus k_{25})))))\\}\\oplus</span> <span class="math">\\{(x_{26}\\oplus k_{26}\\oplus((x_{13}\\oplus k_{13})\\&amp;(x_{16}\\oplus k_{16}))\\oplus</span> <span class="math">((x_{10}\\oplus k_{10}\\oplus((x_{9}\\oplus k_{9})\\&amp;(x_{11}\\oplus k_{11})))\\&amp;(x_{27}\\oplus k_{27}\\oplus((x_{11}\\oplus k_{11})\\&amp;(x_{28}\\oplus k_{28})))))\\&amp;</span> <span class="math">(x_{29}\\oplus k_{29}\\oplus((x_{13}\\oplus k_{13})\\&amp;(x_{14}\\oplus k_{14}))\\oplus</span> <span class="math">((x_{27}\\oplus k_{27}\\oplus((x_{11}\\oplus k_{11})\\&amp;(x_{28}\\oplus k_{28})))\\&amp;(x_{30}\\oplus k_{30}\\oplus((x_{28}\\oplus k_{28})\\&amp;(x_{34}\\oplus k_{34})))))\\}\\oplus</span> <span class="math">\\{(x_{32}\\oplus k_{32}\\oplus((\\underline{x_{2}\\oplus k_{2}})\\&amp;(x_{33}\\oplus k_{33}))\\oplus</span> <span class="math">((x_{34}\\oplus k_{34}\\oplus((x_{35}\\oplus k_{35})\\&amp;(x_{36}\\oplus k_{36})))\\&amp;(x_{37}\\oplus k_{37}\\oplus((x_{36}\\oplus k_{36})\\&amp;(x_{38}\\oplus k_{38})))))\\&amp;</span> <span class="math">(x_{39}\\oplus k_{39}\\oplus((x_{33}\\oplus k_{33})\\&amp;(x_{40}\\oplus k_{40}))\\oplus</span> <span class="math">((x_{37}\\oplus k_{37}\\oplus((x_{36}\\oplus k_{36})\\&amp;(x_{38}\\oplus k_{38})))\\&amp;(x_{41}\\oplus k_{41}\\oplus((x_{38}\\oplus k_{38})\\&amp;(x_{42}\\oplus k_{42})))))\\}</span></p>

    <p class="text-gray-300">Compress the plaintexts: (Procedure Simon128-Head) At first, compress the plaintexts into a counter vector <span class="math">V[x_{1}-x_{42}]</span>. In fact, there are <span class="math">2^{38}</span> elements for vector <span class="math">V</span>, since <span class="math">x_{17}=x_{1}\\oplus x_{7},x_{23}=x_{2}\\oplus x_{10},x_{26}=x_{5}\\oplus x_{15}</span> and <span class="math">x_{29}=x_{6}\\oplus x_{12}</span>. To simplify our description, we introduce the situations that the XOR for the guessed <span class="math">k</span> bit and corresponding <span class="math">x</span> bit is zero in Step 2 to Step 9, since the representation of the target parity bit in another situation has same form with it. <span class="math">x_{2},k_{2}</span> with underline shown above are regarded as new variables <span class="math">x_{2}^{\\prime},k_{2}^{\\prime}</span>, independent of <span class="math">x_{2},k_{2}</span>.</p>

    <ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">

      <li>Guess <span class="math">k_{1},k_{2},k_{5},k_{6}</span></li>

      <li><span class="math">x_{1},x_{2},x_{5},x_{6}</span> can be removed and the index value for counter vectors becomes <span class="math">x_{2}^{\\prime},x_{3},x_{4},x_{7}-x_{42}</span>. There are <span class="math">2^{38}</span> new counters and the counter values are refreshed according to <span class="math">((x_{1}\\oplus k_{1})\\&amp;(x_{2}\\oplus k_{2}))\\oplus((x_{5}\\oplus k_{5})\\&amp;(x_{6}\\oplus k_{6}))</span>. The time is <span class="math">2^{38}\\times 2^{4}=2^{42}</span> simple calculations.</li>

      <li>Guess <span class="math">k_{13}</span>. Since <span class="math">x_{13}\\oplus k_{13}=0</span>, <span class="math">x_{14},x_{16}</span> can be compressed. The time is <span class="math">2^{35}\\times 3</span> additions.</li>

      <li>Guess <span class="math">k_{9}</span>. Since <span class="math">x_{9}\\oplus k_{9}=0</span>, <span class="math">x_{8}</span> can be compressed. The time is <span class="math">2^{33}</span> additions.</li>

      <li>Guess <span class="math">k_{20}</span>. Since <span class="math">x_{20}\\oplus k_{20}=0</span>, <span class="math">x_{19}</span> can be compressed. The time is <span class="math">2^{31}</span> additions.</li>

      <li>Guess <span class="math">k_{22}</span>. Since <span class="math">x_{22}\\oplus k_{22}=0</span>, <span class="math">x_{25}</span> can be compressed. The time is <span class="math">2^{29}</span> additions.</li>

      <li>Guess <span class="math">k_{28}</span>. Since <span class="math">x_{28}\\oplus k_{28}=0</span>, <span class="math">x_{11},x_{34}</span> can be compressed. The time is <span class="math">2^{26}\\times 3</span> additions.</li>

      <li>Guess <span class="math">k_{36}</span>. Since <span class="math">x_{36}\\oplus k_{36}=0</span>, <span class="math">x_{35}</span> can be compressed. The time is <span class="math">2^{24}</span> additions.</li>

      <li>Guess <span class="math">k_{33}</span>. Since <span class="math">x_{33}\\oplus k_{33}=0</span>, <span class="math">x_{2}</span> with underline and <span class="math">x_{40}</span> can be compressed. The time is <span class="math">2^{22}</span> additions.</li>

      <li>Guess <span class="math">k_{38}</span>. Since <span class="math">x_{38}\\oplus k_{38}=0</span>, <span class="math">x_{42}</span> can be compressed. The time is <span class="math">2^{20}</span> additions.</li>

      <li>After above guess and split, remained bits for <span class="math">x</span> and <span class="math">k</span> are bit 3,4,7,10,12,15,17,18,21,23,24,26,27,29,30,32, 34,37, 39,41. We can compress <span class="math">x_{3},x_{4},x_{17},x_{18},x_{21},x_{23},x_{24}</span> as case <span class="math">f_{3}</span> in Appendix A. The time is <span class="math">2^{13}\\times 2^{9.25}=2^{22.25}</span>. Then we compress <span class="math">x_{7},x_{10},x_{26},x_{27},x_{29},x_{30}</span> as case <span class="math">f_{6}</span> in Appendix A. The time is <span class="math">2^{14}\\times 2^{8.36}=2^{22.36}</span>. At last, we compress <span class="math">x_{12},x_{15},x_{32},x_{34},x_{37},x_{39},x_{41}</span> as case <span class="math">f_{3}</span> in Appendix A. The time is <span class="math">2^{13}\\times 2^{9.25}=2^{22.25}</span>.</li>

      <li>Calculate the other situations as above.</li>

    </ol>

    <p class="text-gray-300">Time is estimated from the inner part to outer part. Step 10 needs about <span class="math">T_{10}=2^{23.87}</span> additions. In Step 9, the two cases, <span class="math">x_{38}\\oplus k_{38}=0</span>, <span class="math">x_{38}\\oplus k_{38}=1</span> have same time complexity and there are two possible guesses for <span class="math">k_{38}</span>. So the total time for Step 9 and 10 is <span class="math">T_{9}=2\\times((2^{20}+T_{10})\\times 2+2^{21})=2^{26.05}</span>, where <span class="math">2^{21}</span> is the time for combination. Similarly, the time for Step 2 to Step 10 is as follows.</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Step</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Time</th>

          </tr>

        </thead>

        <tbody>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">9-10</td>

            <td class="px-3 py-2 border-b border-gray-700">T9=2×((220+T10)×2+221)=226.05</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">8-10</td>

            <td class="px-3 py-2 border-b border-gray-700">T8=2×((222+T9)×2+223)=228.21</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">7-10</td>

            <td class="px-3 py-2 border-b border-gray-700">T7=2×((224+T8)×2+225)=230.36</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">6-10</td>

            <td class="px-3 py-2 border-b border-gray-700">T6=2×((226×3+T7)×2+228)=232.67</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">5-10</td>

            <td class="px-3 py-2 border-b border-gray-700">T5=2×((229+T6)×2+230)=234.88</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">4-10</td>

            <td class="px-3 py-2 border-b border-gray-700">T4=2×((231+T5)×2+232)=237.06</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">3-10</td>

            <td class="px-3 py-2 border-b border-gray-700">T3=2×((233+T4)×2+234)=239.22</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">2-10</td>

            <td class="px-3 py-2 border-b border-gray-700">T2=2×((235×3+T3)×2+237)=241.56</td>

          </tr>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">So in total, the time is  <span class="math">2^{41.56} \\times 2^4 + 2^{42} \\approx 2^{45.68}</span> . The memory is about  <span class="math">\\mathcal{O}(2^{42})</span>  counters.</p>

    <p class="text-gray-300">Compress the ciphertexts: (Procedure SIMON128-Tail) Since the input active bits and output active bits in the linear hull distinguisher for SIMON128 are one-to-one, the representation for  <span class="math">X_{L,60}^{i + 41} \\oplus X_{R,2}^{i + 41} \\oplus X_{R,58}^{i + 41} \\oplus X_{R,62}^{i + 41}</span>  expanding four rounds (see Table 18) are same with that for  <span class="math">X_{L,2}^{i} \\oplus X_{L,58}^{i} \\oplus X_{L,62}^{i} \\oplus X_{R,60}^{i}</span> . So at first compress the ciphertexts into a counter vector  <span class="math">V[x_1 - x_{42}]</span> , then do as Procedure SIMON128-Head.</p>

    <p class="text-gray-300">49-round attack on SIMON128/128. We add four rounds before and after the 41-round linear hull distinguisher to attack 49-round SIMON128/K. We use  <span class="math">N = 2\\bar{\\epsilon}^{-2} = 2^{127.6}</span>  known plaintexts. Set advantage  <span class="math">a = 8</span> . The success probability would be 0.477. At first, compress the plaintext-ciphertext pairs to  <span class="math">2^{38 + 38}</span>  counters according to Table 17 and Table 18. Suppose the plaintext be compressed to  <span class="math">x_{P}</span>  and ciphertext be compressed to  <span class="math">x_{C}</span> .</p>

    <ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">

      <li>For each of  <span class="math">2^{38}x_{C}</span></li>

    </ol>

    <p class="text-gray-300">(a) Call Procedure SIMON128-Head, and store the keys used in the first four rounds</p>

    <ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">

      <li>For each of  <span class="math">2^{42}</span>  keys involved in the first four rounds</li>

    </ol>

    <p class="text-gray-300">(a) Call Procedure SIMON128-Tail, and store the keys used in the last four rounds</p>

    <ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">

      <li>Rank the keys and exhaustive the candidates with the help of key schedule.</li>

    </ol>

    <p class="text-gray-300">Time: 1.  <span class="math">2^{38} \\times 2^{45.68} = 2^{83.68}</span>  additions. 2.  <span class="math">2^{42} \\times 2^{45.68} = 2^{87.68}</span> . So the total time to compute the bias is  <span class="math">2^{83.68} + 2^{87.68} \\approx 2^{87.77}</span> . 3. The exhaustive phase needs  <span class="math">2^{128 - 8} = 2^{120}</span>  49-round encryptions. The total time is about  <span class="math">2^{120}</span>  encryptions and  <span class="math">2^{87.77}</span>  additions.</p>

    <p class="text-gray-300">51-round attack on SIMON128/192. We add five rounds before and after the 41-round linear hull distinguisher to attack 51-round SIMON128/K. Compared with the 49-round attack, we expand one more round at each side. To get the  <span class="math">x</span>  represented in Table 17, we should know the 0, 2, 26, 30, 32 - 34, 36 - 63 bits (35 bits) of  <span class="math">X_{L}^{i-5}</span>  and the 1, 34, 38, 40 - 42, 44 - 59, 61 - 63 bits (25 bits) of  <span class="math">X_{R}^{i-5}</span> . Notice that the input parity bit of the linear hull is linear with  <span class="math">X_{L,2}^{i-5}</span>  and this bit can be compressed at first. So we can compress the plaintexts into one counter vector with  <span class="math">2^{34+25} = 2^{59}</span>  elements. The key bits involved in round  <span class="math">i-5</span>  are the 0, 26, 30, 32 - 34, 36 - 63 (34 bits) of  <span class="math">K^{i-5}</span> . Similarly, we can compress the ciphertexts to a counter vector with  <span class="math">2^{59}</span>  elements and there are 34 bits of  <span class="math">K^{i+45}</span>  involved. So, at first, we compress the plaintext-ciphertext pairs to a counter vector of size  <span class="math">2^{59+59} = 2^{118}</span> .</p>

    <ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">

      <li>Guess the  <span class="math">2^{34}</span>  bits of  <span class="math">K^{i - 5}</span></li>

    </ol>

    <p class="text-gray-300">(a) Encrypt the plaintexts by one round and compress the states into a counter vector of size  <span class="math">2^{38 + 59} = 2^{97}</span></p>

    <ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">

      <li>Guess the  <span class="math">2^{34}</span>  bits of  <span class="math">K^{i + 45}</span></li>

    </ol>

    <p class="text-gray-300">(a) Decrypt the ciphertexts by one round and compress the states into a counter vector of size  <span class="math">2^{38 + 38} = 2^{76}</span></p>

    <ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">

      <li>Do as Step 1 and 2 in the 49-round attack</li>

      <li>Rank the keys and exhaustive the candidates with the help of key schedule.</li>

    </ol>

    <p class="text-gray-300">Time: 1.  <span class="math">2^{118} \\times 2^{34} = 2^{152}</span>  one-round encryptions. 2.  <span class="math">2^{97} \\times 2^{34 + 34} = 2^{165}</span>  one-round encryptions. 3.  <span class="math">2^{68} \\times 2^{87.77} = 2^{155.77}</span>  additions. So the total time to compute the bias is  <span class="math">2^{152} + 2^{165} \\approx 2^{165}</span>  one-round encryptions and  <span class="math">2^{155.77}</span>  additions, which is approximately equal to  <span class="math">2^{165}</span>  one-round encryptions. 4. The exhaustive phase needs  <span class="math">2^{192 - 8} = 2^{184}</span>  51-round encryptions. The total time is about  <span class="math">2^{184}</span>  encryptions and  <span class="math">2^{155.77}</span>  additions.</p>

    <p class="text-gray-300">Table 18: 4 rounds after  <span class="math">X_{L,60}^{i + 41}\\oplus X_{R,2}^{i + 41}\\oplus X_{R,58}^{i + 41}\\oplus X_{R,62}^{i + 41}</span>  for SIMON128</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">x0</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">XR,2i+44⊕XR,50i+44⊕XR,54i+44⊕XR,54i+44⊕XR,54i+44⊕XR,58</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">k0</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">K1+44⊕K1+42⊕K2+43⊕K54+43⊕K54i+42⊕K58</th>

          </tr>

        </thead>

        <tbody>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">x1</td>

            <td class="px-3 py-2 border-b border-gray-700">XR,63i+44⊕XR,51i+44⊕XR,57i+44⊕XR,57i+44⊕XR,57i+44⊕XR,58</td>

            <td class="px-3 py-2 border-b border-gray-700">k1</td>

            <td class="px-3 py-2 border-b border-gray-700">K1+44</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">x2</td>

            <td class="px-3 py-2 border-b border-gray-700">XR,56i+44⊕XR,58i+44⊕XR,57i+44⊕XR,50i+44⊕XR,50i+44⊕XR,50i+44⊕XR,50i+44⊕XR,50i+44⊕XR,50i+44</td>

            <td class="px-3 py-2 border-b border-gray-700">k2</td>

            <td class="px-3 py-2 border-b border-gray-700">K1+44</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">x3</td>

            <td class="px-3 py-2 border-b border-gray-700">XR,51i+44⊕XR,53i+44⊕XR,53i+44⊕XR,53i+44⊕XR,53i+44⊕XR,53i+44</td>

            <td class="px-3 py-2 border-b border-gray-700">k3</td>

            <td class="px-3 py-2 border-b border-gray-700">K1+44</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">x4</td>

            <td class="px-3 py-2 border-b border-gray-700">XR,44i+44⊕XR,46i+44⊕XR,45i+44⊕XR,45i+44⊕XR,45i+44⊕XR,45i+44</td>

            <td class="px-3 py-2 border-b border-gray-700">k4</td>

            <td class="px-3 py-2 border-b border-gray-700">K1+44</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">x5</td>

            <td class="px-3 py-2 border-b border-gray-700">XR,55i+44⊕XR,57i+44⊕XR,56i+44⊕XR,49i+44⊕XR,49i+44⊕XR,49i+44</td>

            <td class="px-3 py-2 border-b border-gray-700">k5</td>

            <td class="px-3 py-2 border-b border-gray-700">K1+44</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">x6</td>

            <td class="px-3 py-2 border-b border-gray-700">XR,48i+44⊕XR,50i+44⊕XR,49i+44⊕XR,49i+44⊕XR,49i+44</td>

            <td class="px-3 py-2 border-b border-gray-700">k6</td>

            <td class="px-3 py-2 border-b border-gray-700">K1+44</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">x7</td>

            <td class="px-3 py-2 border-b border-gray-700">XR,59i+44⊕XR,61i+44⊕XR,60i+44⊕XR,53i+44⊕XR,63i+44⊕XR,63i+44</td>

            <td class="px-3 py-2 border-b border-gray-700">k7</td>

            <td class="px-3 py-2 border-b border-gray-700">K1+44</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">x8</td>

            <td class="px-3 py-2 border-b border-gray-700">XR,60i+44⊕XR,62i+44⊕XR,61i+44⊕XR,61i+44⊕XR,61i+44</td>

            <td class="px-3 py-2 border-b border-gray-700">k8</td>

            <td class="px-3 py-2 border-b border-gray-700">K1+44</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">x9</td>

            <td class="px-3 py-2 border-b border-gray-700">XR,53i+44⊕XR,55i+44⊕XR,54i+44⊕XR,54i+44⊕XR,54i+44</td>

            <td class="px-3 py-2 border-b border-gray-700">k9</td>

            <td class="px-3 py-2 border-b border-gray-700">K1+44</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">x10</td>

            <td class="px-3 py-2 border-b border-gray-700">XR,52i+44⊕XR,54i+44⊕XR,53i+44⊕XR,54i+44⊕XR,54i+44</td>

            <td class="px-3 py-2 border-b border-gray-700">k10</td>

            <td class="px-3 py-2 border-b border-gray-700">K1+44</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">x11</td>

            <td class="px-3 py-2 border-b border-gray-700">XR,46i+44⊕XR,48i+44⊕XR,47i+44⊕XR,40i+44⊕XR,40i+44</td>

            <td class="px-3 py-2 border-b border-gray-700">k11</td>

            <td class="px-3 py-2 border-b border-gray-700">K1+44</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">x12</td>

            <td class="px-3 py-2 border-b border-gray-700">XR,44i+44⊕XR,46i+44⊕XR,45i+44⊕XR,48i+44⊕XR,48i+44</td>

            <td class="px-3 py-2 border-b border-gray-700">k12</td>

            <td class="px-3 py-2 border-b border-gray-700">K1+44</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">x13</td>

            <td class="px-3 py-2 border-b border-gray-700">XR,45i+44⊕XR,47i+44⊕XR,46i+44⊕XR,49i+44⊕XR,49i+44</td>

            <td class="px-3 py-2 border-b border-gray-700">k13</td>

            <td class="px-3 py-2 border-b border-gray-700">K1+44</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">x14</td>

            <td class="px-3 py-2 border-b border-gray-700">XR,38i+44⊕XR,40i+44⊕XR,39i+44⊕XR,32i+44⊕XR,32i+44</td>

            <td class="px-3 py-2 border-b border-gray-700">k14</td>

            <td class="px-3 py-2 border-b border-gray-700">K1+44</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">x15</td>

            <td class="px-3 py-2 border-b border-gray-700">XR,51i+44⊕XR,53i+44⊕XR,52i+44⊕XR,55i+44⊕XR,55i+44</td>

            <td class="px-3 py-2 border-b border-gray-700">k15</td>

            <td class="px-3 py-2 border-b border-gray-700">K1+44</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">x16</td>

            <td class="px-3 py-2 border-b border-gray-700">XR,52i+44⊕XR,54i+44⊕XR,53i+44⊕XR,54i+44</td>

            <td class="px-3 py-2 border-b border-gray-700">k16</td>

            <td class="px-3 py-2 border-b border-gray-700">K1+44</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">x17</td>

            <td class="px-3 py-2 border-b border-gray-700">XR,59i+44⊕XR,61i+44⊕XR,60i+44⊕XR,53i+44⊕XR,60i+44</td>

            <td class="px-3 py-2 border-b border-gray-700">k17</td>

            <td class="px-3 py-2 border-b border-gray-700">K1+44</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">x18</td>

            <td class="px-3 py-2 border-b border-gray-700">XR,60i+44⊕XR,62i+44⊕XR,61i+44⊕XR,60i+44</td>

            <td class="px-3 py-2 border-b border-gray-700">k18</td>

            <td class="px-3 py-2 border-b border-gray-700">K1+44</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">x19</td>

            <td class="px-3 py-2 border-b border-gray-700">XR,61i+44⊕XR,63i+44⊕XR,62i+44⊕XR,55i+44</td>

            <td class="px-3 py-2 border-b border-gray-700">k19</td>

            <td class="px-3 py-2 border-b border-gray-700">K1+44</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">x20</td>

            <td class="px-3 py-2 border-b border-gray-700">XR,54i+44⊕XR,56i+44⊕XR,55i+44</td>

            <td class="px-3 py-2 border-b border-gray-700">k20</td>

            <td class="px-3 py-2 border-b border-gray-700">K1+44</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">x21</td>

            <td class="px-3 py-2 border-b border-gray-700">XR,53i+44⊕XR,55i+44⊕XR,54i+44⊕XR,57i+44</td>

            <td class="px-3 py-2 border-b border-gray-700">k21</td>

            <td class="px-3 py-2 border-b border-gray-700">K1+44</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">x22</td>

            <td class="px-3 py-2 border-b border-gray-700">XR,47i+44⊕XR,49i+44⊕XR,48i+44⊕XR,41i+44</td>

            <td class="px-3 py-2 border-b border-gray-700">k22</td>

            <td class="px-3 py-2 border-b border-gray-700">K1+44</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">x23</td>

            <td class="px-3 py-2 border-b border-gray-700">XR,52i+44⊕XR,54i+44⊕XR,53i+44⊕XR,54i+44</td>

            <td class="px-3 py-2 border-b border-gray-700">k23</td>

            <td class="px-3 py-2 border-b border-gray-700">K1+44</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">x24</td>

            <td class="px-3 py-2 border-b border-gray-700">XR,46i+44⊕XR,47i+44⊕XR,47i+44⊕XR,40i+44</td>

            <td class="px-3 py-2 border-b border-gray-700">k24</td>

            <td class="px-3 py-2 border-b border-gray-700">K1+44</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">x25</td>

            <td class="px-3 py-2 border-b border-gray-700">XR,49i+44⊕XR,41i+44</td>

            <td class="px-3 py-2 border-b border-gray-700">k25</td>

            <td class="px-3 py-2 border-b border-gray-700">K1+44</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">x26</td>

            <td class="px-3 py-2 border-b border-gray-700">XR,51i+44⊕XR,52i+44⊕XR,52i+44</td>

            <td class="px-3 py-2 border-b border-gray-700">k26</td>

            <td class="px-3 py-2 border-b border-gray-700">K1+44</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">x27</td>

            <td class="px-3 py-2 border-b border-gray-700">XR,45i+44⊕XR,47i+44⊕XR,46i+44</td>

            <td class="px-3 py-2 border-b border-gray-700">k27</td>

            <td class="px-3 py-2 border-b border-gray-700">K1+44</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">x28</td>

            <td class="px-3 py-2 border-b border-gray-700">XR,39i+44⊕XR,41i+44</td>

            <td class="px-3 py-2 border-b border-gray-700">k28</td>

            <td class="px-3 py-2 border-b border-gray-700">K1+44</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">x29</td>

            <td class="px-3 py-2 border-b border-gray-700">XR,44i+44⊕XR,46i+44</td>

            <td class="px-3 py-2 border-b border-gray-700">k29</td>

            <td class="px-3 py-2 border-b border-gray-700">K1+44</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">x30</td>

            <td class="px-3 py-2 border-b border-gray-700">XR,43i+44⊕XR,45i+44</td>

            <td class="px-3 py-2 border-b border-gray-700">k30</td>

            <td class="px-3 py-2 border-b border-gray-700">K1+44</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">x31</td>

            <td class="px-3 py-2 border-b border-gray-700">XR,43i+44⊕XR,42i+44</td>

            <td class="px-3 py-2 border-b border-gray-700">k31</td>

            <td class="px-3 py-2 border-b border-gray-700">K1+44</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">x32</td>

            <td class="px-3 py-2 border-b border-gray-700">XR,55i+44⊕XR,57i+44</td>

            <td class="px-3 py-2 border-b border-gray-700">k32</td>

            <td class="px-3 py-2 border-b border-gray-700">K1+44</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">x33</td>

            <td class="px-3 py-2 border-b border-gray-700">XR,49i+44⊕XR,51i+44</td>

            <td class="px-3 py-2 border-b border-gray-700">k33</td>

            <td class="px-3 py-2 border-b border-gray-700">K1+44</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">x34</td>

            <td class="px-3 py-2 border-b border-gray-700">XR,56i+44⊕XR,58i+44</td>

            <td class="px-3 py-2 border-b border-gray-700">k34</td>

            <td class="px-3 py-2 border-b border-gray-700">K1+44</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">x35</td>

            <td class="px-3 py-2 border-b border-gray-700">XR,57i+44⊕XR,50i+44</td>

            <td class="px-3 py-2 border-b border-gray-700">k35</td>

            <td class="px-3 py-2 border-b border-gray-700">K1+44</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">x36</td>

            <td class="px-3 py-2 border-b border-gray-700">XR,50i+44⊕XR,52i+44</td>

            <td class="px-3 py-2 border-b border-gray-700">k36</td>

            <td class="px-3 py-2 border-b border-gray-700">K1+44</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">x37</td>

            <td class="px-3 py-2 border-b border-gray-700">XR,49i+44⊕XR,51i+44</td>

            <td class="px-3 py-2 border-b border-gray-700">k37</td>

            <td class="px-3 py-2 border-b border-gray-700">K1+44</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">x38</td>

            <td class="px-3 py-2 border-b border-gray-700">XR,43i+44⊕XR,45i+44</td>

            <td class="px-3 py-2 border-b border-gray-700">k38</td>

            <td class="px-3 py-2 border-b border-gray-700">K1+44</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">x39</td>

            <td class="px-3 py-2 border-b border-gray-700">XR,48i+44⊕XR,41i+44</td>

            <td class="px-3 py-2 border-b border-gray-700">k39</td>

            <td class="px-3 py-2 border-b border-gray-700">K1+44</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">x40</td>

            <td class="px-3 py-2 border-b border-gray-700">XR,42i+44⊕XR,43i+44</td>

            <td class="px-3 py-2 border-b border-gray-700">k40</td>

            <td class="px-3 py-2 border-b border-gray-700">K1+44</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">x41</td>

            <td class="px-3 py-2 border-b border-gray-700">XR,42i+44⊕XR,44i+44</td>

            <td class="px-3 py-2 border-b border-gray-700">k41</td>

            <td class="px-3 py-2 border-b border-gray-700">K1+44</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">x42</td>

            <td class="px-3 py-2 border-b border-gray-700">XR,36i+44⊕XR,37i+44</td>

            <td class="px-3 py-2 border-b border-gray-700">k42</td>

            <td class="px-3 py-2 border-b border-gray-700">K1+44</td>

          </tr>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">Notice:  <span class="math">x_{17} = x_{1}\\oplus x_{7},x_{23} = x_{2}\\oplus x_{10},x_{26} = x_{5}\\oplus x_{15},x_{29} = x_{6}\\oplus x_{12}</span></p>

    <p class="text-gray-300">53-round attack on <span class="math">\\tt{Simon128/256}</span>. We add six rounds before and after the 41-round linear hull distinguisher to attack 53-round <span class="math">\\tt{Simon128/K}</span>. Compared with the 51-round attack, we expand one more round at each side. The <span class="math">1,18,22,24-26,28-63</span> bits (42 bits) of <span class="math">K^{i-6}</span> and <span class="math">K^{i+45}</span> are involved in the attack.</p>

    <ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">

      <li>Guess the <span class="math">2^{42+42}</span> bits of <span class="math">K^{i-6},K^{i+46}</span> involved</li>

    </ol>

    <ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">

      <li>Encrypt the plaintexts by one round and decrypt the corresponding ciphertext by one round</li>

      <li>Do as Step 1-3 in the 51-round attack</li>

      <li>Rank the keys and exhaustive the candidates with the help of key schedule.</li>

    </ol>

    <p class="text-gray-300">Time: 1. <span class="math">2^{127.6}\\times 2^{84}=2^{211.6}</span> two-round encryptions. 2. <span class="math">2^{165}\\times 2^{84}=2^{249}</span> one-round encryptions and <span class="math">2^{197.77}</span> additions. So the total time to compute the bias is about <span class="math">2^{249}</span> one-round encryptions and <span class="math">2^{197.77}</span> additions. 3. Since <span class="math">K=256</span>, the exhaustive phase needs <span class="math">2^{256-8}=2^{248}</span> 53-round encryptions. The total time is about <span class="math">2^{248.01}</span> encryptions and <span class="math">2^{155.77}</span> additions.</p>

    <h2 id="sec-24" class="text-2xl font-bold">Appendix C Implementation of the 21-round attack on <span class="math">\\tt{Simon32}</span></h2>

    <p class="text-gray-300">⬇ //SIMON.H</p>

    <p class="text-gray-300">#ifndef SIMON_H_</p>

    <p class="text-gray-300">#define SIMON_H_ extern const int z[5][62]; /<em>simon32</em>/ typedef unsigned int uint32;</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">#define rotateleft32(x,l) (((x<<l)</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">( x>> (16-l))) & 0xFFFF)</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">extern const int c32; uint32 func32(uint32 x); void round32(uint32 in[2], uint32 out[2], uint32 k); void round32_inv(uint32 in[2], uint32 out[2], uint32 k); void key32(uint32 k[32]); void ENC32(uint32 in[2],uint32 out[2], uint32 subkey[32], int rN);</p>

    <p class="text-gray-300">#endif</p>

    <p class="text-gray-300">⬇ //SIMON.cpp</p>

    <p class="text-gray-300">#include "SIMON.H" const int z[5][62] = { {1,1,1,1,1,0,1,0,0,0,1,0,0,1,0,1,0,1,1,0,0,0,0,1,1,1,0,0,1,1,0, 1,1,1,1,1,0,1,0,0,0,1,0,0,1,0,1,0,1,1,0,0,0,0,1,1,1,0,0,1,1,0}, {1,0,0,0,1,1,1,0,1,1,1,1,1,0,0,1,0,0,1,1,0,0,0,0,1,0,1,1,0,1,0, 1,0,0,0,1,1,1,0,1,1,1,1,1,0,0,1,0,0,1,1,0,0,0,0,1,0,1,1,0,1,0}, {1,0,1,0,1,1,1,1,0,1,1,1,0,0,0,0,0,0,1,1,0,1,0,0,1,0,0,1,1,0,0, 0,1,0,1,0,0,0,0,1,0,0,0,1,1,1,1,1,1,0,0,1,0,1,1,0,1,1,0,0,1,1}, {1,1,0,1,1,0,1,1,1,0,1,0,1,1,0,0,0,1,1,0,0,1,0,1,1,1,1,0,0,0,0, 0,0,1,0,0,1,0,0,0,1,0,1,0,0,1,1,1,0,0,1,1,0,1,0,0,0,0,1,1,1,1}, {1,1,0,1,0,0,0,1,1,1,1,0,0,1,1,0,1,0,1,1,0,1,1,0,0,0,1,0,0,0,0, 0,0,1,0,1,1,1,0,0,0,0,1,1,0,0,1,0,1,0,0,1,0,0,1,1,1,0,1,1,1,1} }; const int c32 = (1<<16) - 4; uint32 func32(uint32 x){ uint32 y = rotateleft32(x,1); y &= rotateleft32(x,8); y ^= rotateleft32(x,2); return y; } void round32(uint32 in[2], uint32 out[2], uint32 k){//[0]left, [1]right out[1] = in[0]; out[0] = in[1] ^ func32(in[0]) ^ k; }</p>

    <pre><code class="language-c">void round32_inv(uint32 in[2], uint32 out[2], uint32 k){
out[0] = in[1];
out[1] = in[0] ^ func32(in[1]) ^ k;
}
void key32(uint32 k[32]){
for(int i=4; i &amp;lt; 32; ++i){
k[i] = rotateright32(k[i-1], 3);
k[i] ^= k[i-3];
k[i] ^= rotateright32(k[i], 1);
k[i] ^= c32 ^ z[0][i-4] ^ k[i-4];
}
}
void ENC32(uint32 in[2], uint32 out[2], uint32 subkey[32], int rN=32){//The whole 32-round encryption of SIMON32/64 uint32 tmp[2];
tmp[0] = in[0];
tmp[1] = in[1];
for(int i=0; i&amp;lt;rN; ++i){
round32(tmp, out, subkey[i]);
tmp[0] = out[0];
tmp[1] = out[1];
}</code></pre>

    <pre><code class="language-c">//VERIFY.H
#ifndef VERIFY_H_
#define VERIFY_H_
#include &quot;SIMON.H&quot;
#define TAKE_BIT(x, pos) (((x) &amp;gt;&amp;gt; (pos)) &amp;amp; 0x1)
#define COMPRESS_HEAD_x0(XL, XR) \\
(TAKE_BIT(XL, 13) ^ TAKE_BIT(XR, 15) ^ TAKE_BIT(XL, 1) ^ TAKE_BIT(XL, 5) ^ (TAKE_BIT(XL, 14) &amp;amp; TAKE_BIT(XL, 7)))
#define COMPRESS_HEAD_x1(XL, XR) (TAKE_BIT(XL, 14) ^ TAKE_BIT(XR, 0) ^ (TAKE_BIT(XL, 15) &amp;amp; TAKE_BIT(XL, 8)))
#define COMPRESS_HEAD_x2(XL, XR) (TAKE_BIT(XL, 7) ^ TAKE_BIT(XR, 9) ^ (TAKE_BIT(XL, 8) &amp;amp; TAKE_BIT(XL, 1)))
#define COMPRESS_HEAD_x3(XL, XR) (TAKE_BIT(XL, 2) ^ TAKE_BIT(XR, 4) ^ (TAKE_BIT(XL, 3) &amp;amp; TAKE_BIT(XL, 12)))
#define COMPRESS_HEAD_x4(XL, XR) (TAKE_BIT(XL, 11) ^ TAKE_BIT(XR, 13) ^ (TAKE_BIT(XL, 12) &amp;amp; TAKE_BIT(XL, 5)))
#define COMPRESS_HEAD_x5(XL, XR) \\
(TAKE_BIT(XL, 14) ^ TAKE_BIT(XR, 0) ^ (TAKE_BIT(XL, 15) &amp;amp; TAKE_BIT(XL, 8)) ^ TAKE_BIT(XL, 2))
#define COMPRESS_HEAD_x6(XL, XR) (TAKE_BIT(XL, 15) ^ TAKE_BIT(XR, 1) ^ (TAKE_BIT(XL, 0) &amp;amp; TAKE_BIT(XL, 9)))
#define COMPRESS_HEAD_x7(XL, XR) (TAKE_BIT(XL, 8) ^ TAKE_BIT(XR, 10) ^ (TAKE_BIT(XL, 9) &amp;amp; TAKE_BIT(XL, 2)))
#define COMPRESS_HEAD_x8(XL, XR)\\
(TAKE_BIT(XL, 7) ^ TAKE_BIT(XR, 9) ^ (TAKE_BIT(XL, 8) &amp;amp; TAKE_BIT(XL, 1)) ^ TAKE_BIT(XL, 11))
#define COMPRESS_HEAD_x9(XL, XR) (TAKE_BIT(XL, 1) ^ TAKE_BIT(XR, 3) ^ (TAKE_BIT(XL, 2) &amp;amp; TAKE_BIT(XL, 11)))
#define COMPRESS_HEAD_x10(XL, XR) (TAKE_BIT(XL, 14) ^ TAKE_BIT(XR, 0) ^ TAKE_BIT(XR, 4)\\
^ (TAKE_BIT(XL, 15) &amp;amp; TAKE_BIT(XL, 8)) ^ (TAKE_BIT(XL, 3) &amp;amp; TAKE_BIT(XL, 12)))
#define COMPRESS_HEAD_x11(XL, XR)\\
(TAKE_BIT(XL, 15) ^ TAKE_BIT(XR, 1) ^ (TAKE_BIT(XL, 0) &amp;amp; TAKE_BIT(XL, 9)) ^ TAKE_BIT(XL, 3))
</code></pre>

    <p class="text-gray-300">#define COMPRESS_HEAD_x12(XL, XR) (TAKE_BIT(XL, 0) ~ TAKE_BIT(XR, 2) ~ (TAKE_BIT(XL, 1) &amp; TAKE_BIT(XL, 10))</p>

    <p class="text-gray-300">#define COMPRESS_HEAD_x13(XL, XR) (TAKE_BIT(XL, 9) ~ TAKE_BIT(XR, 11) ~ (TAKE_BIT(XL, 10) &amp; TAKE_BIT(XL, 3))</p>

    <p class="text-gray-300">#define COMPRESS_HEAD_x14(XL, XR) (TAKE_BIT(XL, 8) ~ TAKE_BIT(XR, 10) ~ (TAKE_BIT(XL, 9) &amp; TAKE_BIT(XL, 2)) ~ TAKE_BIT(XL, 12))</p>

    <p class="text-gray-300">#define COMPRESS_HEAD_x15(XL, XR) (TAKE_BIT(XL, 7) ~ TAKE_BIT(XR, 9) ~ TAKE_BIT(XR, 13) ~ (TAKE_BIT(XL, 8) &amp; TAKE_BIT(XL, 1)) ~ (TAKE_BIT(XL, 12) &amp; TAKE BIT(XL, 5))</p>

    <p class="text-gray-300">#define COMPRESS_HEAD_x16(XL, XR) (TAKE_BIT(XL, 1) ~ TAKE_BIT(XR, 3) ~ (TAKE_BIT(XL, 2) &amp; TAKE_BIT(XL, 11)) ~ TAKE_BIT(XL, 5)</p>

    <p class="text-gray-300">#define KEY_HEAD_k0(K0, K1, K2, K3) (TAKE_BIT(K0, 15) ~ TAKE_BIT(K1, 1) ~ TAKE_BIT(K1, 5) ~ TAKE_BIT(K2, 3) ~ TAKE_BIT(K3, 5)</p>

    <p class="text-gray-300">#define KEY_HEAD_k1(K0, K1, K2, K3) (TAKE_BIT(K0, 0))</p>

    <p class="text-gray-300">#define KEY_HEAD_k2(K0, K1, K2, K3) (TAKE_BIT(K0, 9))</p>

    <p class="text-gray-300">#define KEY_HEAD_k3(K0, K1, K2, K3) (TAKE BIT(K0, 4))</p>

    <p class="text-gray-300">#define KEY_HEAD_k4(K0, K1, K2, K3) (TAKE BIT(K0, 13))</p>

    <p class="text-gray-300">#define KEY_HEAD_k5(K0, K1, K2, K3) (TAKE BIT(K0, 0) ~ TAKE_BIT(K1, 2))</p>

    <p class="text-gray-300">#define KEY_HEAD_k6(K0, K1, K2, K3) (TAKE BIT(K0, 1))</p>

    <p class="text-gray-300">#define KEY_HEAD_k7(K0, K1, K2, K3) (TAKE BIT(K0, 10))</p>

    <p class="text-gray-300">#define KEY_HEAD_k8(K0, K1, K2, K3) (TAKE BIT(K0, 9) ~ TAKE BIT(K1, 11))</p>

    <p class="text-gray-300">#define KEY_HEAD_k9(K0, K1, K2, K3) (TAKE BIT(K0, 3))</p>

    <p class="text-gray-300">#define KEY_HEAD_k10(K0, K1, K2, K3) (TAKE BIT(K0, 0) ~ TAKE BIT(K1, 2) ~ TAKE BIT(K0, 4) ~ TAKE BIT(K2, 4)</p>

    <p class="text-gray-300">#define KEY_HEAD_k11(K0, K1, K2, K3) (TAKE BIT(K0, 1) ~ TAKE BIT(K1, 3))</p>

    <p class="text-gray-300">#define KEY_HEAD_k12(K0, K1, K2, K3) (TAKE BIT(K0, 2))</p>

    <p class="text-gray-300">#define KEY_HEAD_k13(K0, K1, K2, K3) (TAKE BIT(K0, 11))</p>

    <p class="text-gray-300">#define KEY_HEAD_k14(K0, K1, K2, K3) (TAKE BIT(K0, 10) ~ TAKE BIT(K1, 12))</p>

    <p class="text-gray-300">#define KEY_HEAD_k15(K0, K1, K2, K3) (TAKE BIT(K0, 9) ~ TAKE BIT(K1, 11) ~ TAKE BIT(K0, 13) ~ TAKE BIT(K2, 13)</p>

    <p class="text-gray-300">#define KEY_HEAD_k16(K0, K1, K2, K3) (TAKE BIT(K0, 3) ~ TAKE BIT(K1, 5))</p>

    <p class="text-gray-300">#define COMPRESS_HEAD(XL, XR, x0_linear, x_other14) x0_linear = COMPRESS_HEAD_x0(XL, XR); \\ x_other14 = COMPRESS_HEAD_x16(XL, XR); \\ x_other14 = (x_other14 &lt;&lt; 1) ~ COMPRESS_HEAD_x14(XL, XR); \\ x_other14 = (x_other14 &lt;&lt; 1) ~ COMPRESS_HEAD_x13(XL, XR); \\ x_other14 = (x_other14 &lt;&lt; 1) ~ COMPRESS_HEAD_x12(XL, XR); \\ x_other14 = (x_other14 &lt;&lt; 1) ~ COMPRESS_HEAD_x11(XL, XR); \\ x_other14 = (x_other14 &lt;&lt; 1) ~ COMPRESS_HEAD_x9(XL, XR); \\ x_other14 = (x_other14 &lt;&lt; 1) ~ COMPRESS_HEAD_x8(XL, XR); \\ x_other14 = (x_other14 &lt;&lt; 1) ~ COMPRESS_HEAD_x7(XL, XR); \\ x_other14 = (x_other14 &lt;&lt; 1) ~ COMPRESS_HEAD_x6(XL, XR); \\ x_other14 = (x_other14 &lt;&lt; 1) ~ COMPRESS_HEAD_x5(XL, XR); \\ x_other14 = (x_other14 &lt;&lt; 1) ~ COMPRESS_HEAD_x4(XL, XR); \\ x_other14 = (x_other14 &lt;&lt; 1) ~ COMPRESS_HEAD_x3(XL, XR); \\ x_other14 = (x_other14 &lt;&lt; 1) ~ COMPRESS_HEAD_x2(XL, XR); \\ x_other14 = (x_other14 &lt;&lt; 1) ~ COMPRESS_HEAD_x1(XL, XR);</p>

    <p class="text-gray-300">#define COMPRESS_TAIL(XL, XR, x0_linear, x_other14, XL_shift, XR_shift) \\ XL_shift = (((XL &gt;&gt; 8) ~ (XL &lt;&lt; 8)) &amp; 0xFFFF); \\ XR_shift = (((XR &gt;&gt; 8) ~ (XR &lt;&lt; 8)) &amp; 0xFFFF); \\ COMPRESS_HEAD(XR_shift, XL_shift, x0_linear, x_other14);</p>

    <p class="text-gray-300">#define KEY_HEAD(K0, K1, K2, K3, k0_linear, k_other16) k0_linear = KEY_HEAD_k0(K0, K1, K2, K3); \\ k_other16 = KEY_HEAD_k16(K0, K1, K2, K3); \\ k_other16 = (k_other16 &lt;&lt; 1) ~ KEY_HEAD_k15(K0, K1, K2, K3); \\ k_other16 = (k_other16 &lt;&lt; 1) ~ KEY_HEAD_k14(K0, K1, K2, K3); \\ k_other16 = (k_other16 &lt;&lt; 1) ~ KEY_HEAD_k13(K0, K1, K2, K3);</p>

    <p class="text-gray-300">k_other16 = (k_other16 << 1) ^ KEY_HEAD_k12(K0, K1, K2, K3); \\ k_other16 = (k_other16 << 1) ^ KEY_HEAD_k11(K0, K1, K2, K3); \\ k_other16 = (k_other16 << 1) ^ KEY_HEAD_k10(K0, K1, K2, K3); \\ k_other16 = (k_other16 << 1) ^ KEY_HEAD_k9(K0, K1, K2, K3); \\ k_other16 = (k_other16 << 1) ^ KEY_HEAD_k8(K0, K1, K2, K3); \\ k_other16 = (k_other16 << 1) ^ KEY_HEAD_k7(K0, K1, K2, K3); \\ k_other16 = (k_other16 << 1) ^ KEY_HEAD_k6(K0, K1, K2, K3); \\ k_other16 = (k_other16 << 1) ^ KEY_HEAD_k5(K0, K1, K2, K3); \\ k_other16 = (k_other16 << 1) ^ KEY_HEAD_k4(K0, K1, K2, K3); \\ k_other16 = (k_other16 << 1) ^ KEY_HEAD_k3(K0, K1, K2, K3); \\ k_other16 = (k_other16 << 1) ^ KEY_HEAD_k2(K0, K1, K2, K3); \\ k_other16 = (k_other16 << 1) ^ KEY_HEAD_k1(K0, K1, K2, K3);</p>

    <p class="text-gray-300">#define KEY_TAIL(K0, K1, K2, K3, k0_linear, k_other16, K0_shift, K1_shift, K2_shift, K3_shift)\\ K0_shift = (((K0 >> 8) ^ (K0 << 8)) & 0xFFFF);\\ K1_shift = (((K1 >> 8) ^ (K1 << 8)) & 0xFFFF);\\ K2_shift = (((K2 >> 8) ^ (K2 << 8)) & 0xFFFF);\\ K3_shift = (((K3 >> 8) ^ (K3 << 8)) & 0xFFFF);\\ KEY_HEAD(K0_shift, K1_shift, K2_shift, K3_shift, k0_linear, k_other16); uint32 function_fp(uint32 x_14bits, uint32 k_16bits); uint32 function_f00(uint32 x_8bits, uint32 k_9bits, uint32 x3); uint32 function_f3_append(uint32 x_4bits, uint32 k_4bits); void simon32_4rounds_enc(uint32 in[2], uint32 out[2], uint32 k[4]); void simon32_4rounds_dec(uint32 in[2], uint32 out[2], uint32 k[4]); void correlation_function_fp_OPTIMIZE(int data[1<<14], int corr_K[1<<16]); void correlation_function_f00_OPTIMIZE(int data[1<<8], int corr_K[1<<9], int x3); void correlation_function_f3_append_OPTIMIZE(int data[16], int corr_K[16]); void correlation_function_fp_GENERAL(int data[1<<14], int corr_K[1<<16]); void correlation_function_f00_GENERAL(int data[256], int corr_K[512], uint32 x3); void correlation_function_f3_append_GENERAL(int data[16], int corr_K[16]);</p>

    <p class="text-gray-300">#endif</p>

    <p class="text-gray-300">//VERIFY.cpp</p>

    <p class="text-gray-300">#include "VERIFY.H"</p>

    <p class="text-gray-300">#include <cstring></p>

    <p class="text-gray-300">#include <iostream> using namespace std; uint32 function_fp(uint32 x_14bits, uint32 k_16bits){ uint32 x[17], k[17]; x[1] = TAKE_BIT(x_14bits, 0); x[2] = TAKE_BIT(x_14bits, 1); x[3] = TAKE_BIT(x_14bits, 2); x[4] = TAKE_BIT(x_14bits, 3); x[5] = TAKE_BIT(x_14bits, 4); x[6] = TAKE_BIT(x_14bits, 5); x[7] = TAKE_BIT(x_14bits, 6); x[8] = TAKE_BIT(x_14bits, 7); x[9] = TAKE_BIT(x_14bits, 8); x[10] = x[3] ^ x[5]; x[11] = TAKE_BIT(x_14bits, 9); x[12] = TAKE_BIT(x_14bits, 10); x[13] = TAKE_BIT(x_14bits, 11); x[14] = TAKE_BIT(x_14bits, 12); x[15] = x[4] ^ x[8]; x[16] = TAKE_BIT(x_14bits, 13); k[1] = TAKE_BIT(k_16bits, 0); k[2] = TAKE_BIT(k_16bits, 1); k[3] = TAKE_BIT(k_16bits, 2);</p>

    <p class="text-gray-300">k[4] = TAKE_BIT(k_16bits, 3); k[5] = TAKE_BIT(k_16bits, 4); k[6] = TAKE_BIT(k_16bits, 5); k[7] = TAKE_BIT(k_16bits, 6); k[8] = TAKE_BIT(k_16bits, 7); k[9] = TAKE_BIT(k_16bits, 8); k[10] = TAKE_BIT(k_16bits, 9); k[11] = TAKE_BIT(k_16bits, 10); k[12] = TAKE_BIT(k_16bits, 11); k[13] = TAKE_BIT(k_16bits, 12); k[14] = TAKE_BIT(k_16bits, 13); k[15] = TAKE_BIT(k_16bits, 14); k[16] = TAKE_BIT(k_16bits, 15); for(int i=1; i<=16; ++i){ x[i] ^= k[i]; } uint32 x1_2 = x[1] & x[2]; uint32 x3_4 = x[3] & x[4]; uint32 x6_7 = x[6] & x[7]; uint32 x7_9 = x[7] & x[9]; uint32 x12_13 = x[12] & x[13]; uint32 x3_13 = x[3] & x[13]; x[14] = x[14] ^ x3_13; x[16] = x[16] ^ x3_4; x[15] = x[15] ^ x7_9; x[11] = x[11] ^ x12_13; x[10] = x[10] ^ x6_7; x[5] = x[5] ^ x6_7; x[8] = x[8] ^ x7_9; uint32 out = (x[10] ^ ( x[11] & x[14])) & (x[15] ^ (x[14] & x[16])); out ^= (x[5] & x[8]); out ^= x1_2; out ^= x3_4; return out; } uint32 function_f00(uint32 x_8bits, uint32 k_9bits, uint32 x3){ uint32 x[17]; uint32 k[17]; x[5] = TAKE_BIT(x_8bits, 0); x[8] = TAKE_BIT(x_8bits, 1); x[11] = TAKE_BIT(x_8bits, 2); x[12] = TAKE_BIT(x_8bits, 3); x[13] = TAKE_BIT(x_8bits, 4); x[14] = TAKE_BIT(x_8bits, 5); x[15] = TAKE_BIT(x_8bits, 6); x[16] = TAKE_BIT(x_8bits, 7); x[10] = x3 ^ x[5]; k[5] = TAKE_BIT(k_9bits, 0); k[8] = TAKE_BIT(k_9bits, 1); k[10] = TAKE_BIT(k_9bits, 2); k[11] = TAKE_BIT(k_9bits, 3); k[12] = TAKE_BIT(k_9bits, 4); k[13] = TAKE_BIT(k_9bits, 5); k[14] = TAKE_BIT(k_9bits, 6); k[15] = TAKE_BIT(k_9bits, 7); k[16] = TAKE_BIT(k_9bits, 8); uint32 out; for(int i=0; i<17; ++i){ x[i] = x[i] ^ k[i];</p>

    <p class="text-gray-300">} uint32 x15 = x[15] ^ (x[14] & x[16]); uint32 x11 = x[11] ^ (x[12] & x[13]); x11 = x11 & x[14]; uint32 x10 = x11 ^ x[10]; out = x[5] & x[8]; out = out ^ (x10 & x15); return out; } uint32 function_f3_append(uint32 x_4bits, uint32 k_4bits){ //f3(z,k) = (z0 ^ k0 ^ (z1 ^ k1)θ(z2 ^ k2)) θ (z3 ^ k3) uint32 x[4], k[4]; for(int i=0; i<4; ++i){ x[i] = TAKE_BIT(x_4bits, i); k[i] = TAKE_BIT(k_4bits, i); x[i] = x[i] ^ k[i]; } uint32 out; out = x[1] & x[2]; out =out ^ x[0]; out = out & x[3]; return out; } void simon32_4rounds_enc(uint32 in[2], uint32 out[2], uint32 k[4]){ uint32 tmp[2]; tmp[0] = in[0]; tmp[1] = in[1]; for(int i=0; i<4; ++i){ round32(tmp, out, k[i]); tmp[0] = out[0]; tmp[1] = out[1]; } } void simon32_4rounds_dec(uint32 in[2], uint32 out[2], uint32 k[4]){ uint32 tmp[2]; tmp[0] = in[0]; tmp[1] = in[1]; for(int i=0; i<4; ++i){ round32_inv(tmp, out, k[i]); tmp[0] = out[0]; tmp[1] = out[1]; } } void correlation_function_fp_OPTIMIZE(int data[1<<14], int corr_K[1<<16]){ uint32 k[17]; uint32 eight; uint32 eight0, eight1, eight2, eight3, eight4, eight5, eight6, eight7; int V000[256], V001[256], V010[256], V011[256]; int V100[256], V101[256], V110[256], V111[256]; int K000[512], K001[512], K010[512], K011[512]; int K100[512], K101[512], K110[512], K111[512]; int case000_001, case010_011, case100_101, case110_111; int case000_001_010_011, case100_101_110_111; for(uint32 k1_3_7=0; k1_3_7 < 8; ++k1_3_7){ k[1] = TAKE_BIT(k1_3_7, 0); k[3] = TAKE_BIT(k1_3_7, 1); k[7] = TAKE_BIT(k1_3_7, 2);</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">uint32 K16_k1_3_7 = k[1]</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">(k[3] << 2)</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">(k[7] << 6);</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">memset(V000, 0, sizeof(int)*256); }</p>

    <pre><code class="language-matlab">memset(V001, 0, sizeof(int)*256);
memset(V010, 0, sizeof(int)*256);
memset(V011, 0, sizeof(int)*256);
memset(V100, 0, sizeof(int)*256);
memset(V101, 0, sizeof(int)*256);
memset(V110, 0, sizeof(int)*256);
memset(V111, 0, sizeof(int)*256);
for(uint32 data000=0; data000&amp;lt;256; ++data000){
eight = k[1];
eight |= (k[3] &amp;lt;&amp;lt; 2);
eight |= ((TAKE_BIT(data000, 1) ^ TAKE_BIT(data000, 6)) &amp;lt;&amp;lt; 3);
eight |= (TAKE_BIT(data000, 0) &amp;lt;&amp;lt; 4);
eight |= (k[7] &amp;lt;&amp;lt; 6);
eight |= (TAKE_BIT(data000, 1) &amp;lt;&amp;lt; 7);
eight |= ((data000 &amp;amp; 0x3C) &amp;lt;&amp;lt; 7);
eight |= (TAKE_BIT(data000, 7) &amp;lt;&amp;lt; 13);
eight0 = eight;
eight1 = eight0 ^ 0x0002;
eight2 = eight0 ^ 0x0020;
eight3 = eight0 ^ 0x0100;
eight4 = eight0 ^ 0x0022;
eight5 = eight0 ^ 0x0102;
eight6 = eight0 ^ 0x0120;
eight7 = eight0 ^ 0x0122;
V000[data000] = data[eight0] + data[eight1] + data[eight2] + data[eight3] + data[eight4] + data[eight5] + data[eight6] + data[eight7];
eight0 = eight ^ 0x0001;
eight1 = eight0 ^ 0x0002;
eight2 = eight0 ^ 0x0020;
eight3 = eight0 ^ 0x0100;
eight4 = eight0 ^ 0x0022;
eight5 = eight0 ^ 0x0102;
eight6 = eight0 ^ 0x0120;
eight7 = eight0 ^ 0x0122;
V100[data000] = data[eight0] - data[eight1] + data[eight2] + data[eight3] - data[eight4] - data[eight5] + data[eight6] - data[eight7];
eight0 = eight ^ 0x0040;
eight1 = eight0 ^ 0x0002;
eight2 = eight0 ^ 0x0030;
eight3 = eight0 ^ 0x0180;
eight4 = eight0 ^ 0x0032;
eight5 = eight0 ^ 0x0182;
eight6 = eight0 ^ 0x01B0;
eight7 = eight0 ^ 0x01B2;
V001[data000] = data[eight0] + data[eight1] + data[eight2] + data[eight3] + data[eight4] + data[eight5] + data[eight6] + data[eight7];
eight0 = eight ^ 0x0041;
eight1 = eight0 ^ 0x0002;
eight2 = eight0 ^ 0x0030;
eight3 = eight0 ^ 0x0180;
eight4 = eight0 ^ 0x0032;
eight5 = eight0 ^ 0x0182;
eight6 = eight0 ^ 0x01B0;
eight7 = eight0 ^ 0x01B2;
V101[data000] = data[eight0] - data[eight1] + data[eight2] + data[eight3] - data[eight4] - data[eight5] + data[eight6] - data[eight7];
eight0 = eight ^ 0x0004;
eight0 ^= (TAKE_BIT(eight, 11) &amp;lt;&amp;lt; 12);
eight0 ^= (TAKE_BIT(eight, 3) &amp;lt;&amp;lt; 13);</code></pre>

    <p class="text-gray-300">39</p>

    <p class="text-gray-300">eight1 = eight0 ^ 0x0002; eight2 = eight0 ^ 0x0020; eight3 = eight0 ^ 0x0100; eight4 = eight0 ^ 0x0022; eight5 = eight0 ^ 0x0102; eight6 = eight0 ^ 0x0120; eight7 = eight0 ^ 0x0122; V010[data000] = data[eight0] + data[eight1] + data[eight2] + data[eight3] + data[eight4] + data[eight5] + data[eight6] + data[eight7]; if(1 == TAKE_BIT(eight, 3)){ V010[data000] = 0 - V010[data000]; } eight0 = eight ^ 0x0005; eight0 ^= (TAKE_BIT(eight, 11) << 12); eight0 ^= (TAKE_BIT(eight, 3 ) << 13); eight1 = eight0 ^ 0x0002; eight2 = eight0 ^ 0x0020; eight3 = eight0 ^ 0x0100; eight4 = eight0 ^ 0x0022; eight5 = eight0 ^ 0x0102; eight6 = eight0 ^ 0x0120; eight7 = eight0 ^ 0x0122;</p>

    <p class="text-gray-300">V110[data000] = data[eight0] - data[eight1] + data[eight2] + data[eight3] - data[eight4] - data[eight5] + data[eight6] - data[eight7]; if(1 == TAKE_BIT(eight, 3)){ V110[data000] = 0 - V110[data000]; } eight0 = eight ^ 0x0044; eight0 ^= (TAKE_BIT(eight, 11) << 12); eight0 ^= (TAKE_BIT(eight, 3) << 13); eight1 = eight0 ^ 0x0002; eight2 = eight0 ^ 0x0030; eight3 = eight0 ^ 0x0180; eight4 = eight0 ^ 0x0032; eight5 = eight0 ^ 0x0182; eight6 = eight0 ^ 0x01B0; eight7 = eight0 ^ 0x01B2; V011[data000] = data[eight0] + data[eight1] + data[eight2] + data[eight3] + data[eight4] + data[eight5] + data[eight6] + data[eight7]; if(1 == TAKE_BIT(eight, 3)){ V011[data000] = 0 - V011[data000]; } eight0 = eight ^ 0x0045; eight0 ^= (TAKE_BIT(eight, 11) << 12); eight0 ^= (TAKE_BIT(eight, 3) << 13); eight1 = eight0 ^ 0x0002; eight2 = eight0 ^ 0x0030; eight3 = eight0 ^ 0x0180; eight4 = eight0 ^ 0x0032; eight5 = eight0 ^ 0x0182; eight6 = eight0 ^ 0x01B0; eight7 = eight0 ^ 0x01B2;</p>

    <p class="text-gray-300">V111[data000] = data[eight0] - data[eight1] + data[eight2] + data[eight3] - data[eight4] - data[eight5] + data[eight6] - data[eight7]; if(1 == TAKE_BIT(eight, 3)){ V111[data000] = 0 - V111[data000]; }</p>

    <p class="text-gray-300">} correlation_function_f00_OPTIMIZE(V000, K000, k[3]); correlation_function_f00_OPTIMIZE(V001, K001, k[3]); correlation_function_f00_OPTIMIZE(V010, K010, k[3] ^ 0x1); correlation_function_f00_OPTIMIZE(V011, K011, k[3] ^ 0x1); correlation_function_f00_OPTIMIZE(V100, K100, k[3]); correlation_function_f00_OPTIMIZE(V101, K101, k[3]); correlation_function_f00_OPTIMIZE(V110, K110, k[3] ^ 0x1); correlation_function_f00_OPTIMIZE(V111, K111, k[3] ^ 0x1); for(uint32 k6_9=0; k6_9 <4; ++k6_9){ k[6] = k6_9 & 0x1; k[9] = TAKE_BIT(k6_9, 1);</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">uint32 K16_k6_9 = (k[6] << 5)</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">(k[9] << 8);</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">for(uint32 key_9_bits=0; key_9_bits < 512; ++key_9_bits){ k[5] = TAKE_BIT(key_9_bits, 0); k[8] = TAKE_BIT(key_9_bits, 1); k[13] = TAKE_BIT(key_9_bits, 5);</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">uint32 K16_k5_8_10_T0_16 = (k[5] << 4)</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">(k[8] << 7)</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">((key_9_bits & 0</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">x1FC) << 7); uint32 key00 = key_9_bits; uint32 key01 = key_9_bits ^ k[6] ^ (k[9] << 1) ^ (k[6] << 2) ^ (k[9] << 7) ; case000_001 = K000[key00] + K001[key01]; case100_101 = K100[key00] + K101[key01]; k[4] = 0; uint32 K16_k4 = (k[4] << 3); uint32 key10 = key_9_bits ^ (k[13] << 6) ^ (k[4] << 8); uint32 key11 = key_9_bits ^ key01 ^ key10; case010_011 = K010[key10] + K011[key11]; case110_111 = K110[key10] + K111[key11]; case000_001_010_011 = case000_001 + case010_011; case100_101_110_111 = case100_101 + case110_111;</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">uint32 K16 = K16_k5_8_10_T0_16</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">K16_k6_9</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">K16_k1_3_7</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">K16_k4;</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">corr_K[K16 ] = case000_001_010_011 + case100_101_110_111; corr_K[K16 ^ 0x2] = case000_001_010_011 - case100_101_110_111; k[4] = 1; K16_k4 = (k[4] << 3); key10 = key_9_bits ^ (k[13] << 6) ^ (k[4] << 8); key11 = key_9_bits ^ key01 ^ key10; case010_011 = K010[key10] + K011[key11]; case110_111 = K110[key10] + K111[key11]; case000_001_010_011 = case000_001 - case010_011; case100_101_110_111 = case100_101 - case110_111;</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">K16 = K16_k5_8_10_T0_16</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">K16_k6_9</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">K16_k1_3_7</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">K16_k4;</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">corr_K[K16 ] = case000_001_010_011 + case100_101_110_111; corr_K[K16 ^ 0x2] = case000_001_010_011 - case100_101_110_111; } } } }</p>

    <p class="text-gray-300">void correlation_function_f00_OPTIMIZE(int data[1<<8], int corr_K[1<<9], int x3){ int V00[2]; int V01[16]; int V10[2]; int V11[16]; uint32 x10; int case00_k10_15[4]; int case01_k10__11_12_13_15__16[16];</p>

    <p class="text-gray-300">int case10_k10_15[4]; int case11_k10__11_12_13_15__16[16]; uint32 tmp; uint32 case00, case01, case10, case11; for(uint32 k5_14=0; k5_14 < 4; ++k5_14){ uint32 K9_k5_14 = ((k5_14 << 5) ^ k5_14) & 0x41; case00 = ((k5_14<<4) ^ k5_14) & 0x21; memset(V00, 0, sizeof(int)<em>2); memset(V01, 0, sizeof(int)</em>16); memset(V10, 0, sizeof(int)<em>2); memset(V11, 0, sizeof(int)</em>16); for(uint32 idx_data=0; idx_data<256; ++idx_data){ switch(((idx_data & 0x21)^case00)){ case 0x00: //(0,0) V00[TAKE_BIT(idx_data, 6)] += data[idx_data]; break; case 0x20: //(0,1) tmp = TAKE_BIT(k5_14, 0) ^ x3 ^ TAKE_BIT(idx_data, 2);</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">tmp</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">= ((idx_data&0x18) >> 2);</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">V01[tmp] += data[idx_data]; break; case 0x01: //(1,0) if((idx_data & 0x02) == 0){ V10[TAKE_BIT(idx_data, 6)] += data[idx_data]; }else{ V10[TAKE_BIT(idx_data, 6)] -= data[idx_data]; } break; case 0x21: //(1,1) tmp = TAKE_BIT(k5_14, 0) ^ 0x1 ^ x3 ^ TAKE_BIT(idx_data, 2);</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">tmp</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">= ((idx_data&0x18) >> 2);</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">if((idx_data & 0x02) == 0){ V11[tmp] += data[idx_data]; }else{ V11[tmp] -= data[idx_data]; } break; } } x10 = TAKE_BIT(k5_14, 0) ^ x3; //x10 = x5 ^ x3 case00_k10_15[x10] = V00[0] + V00[1]; //k10 = x10, k15 = 0 case00_k10_15[x10 ^ 0x2] = case00_k10_15[x10]; //k10 = x10, k15 = 1 case00_k10_15[x10 ^ 0x1] = V00[0] - V00[1]; //k10 = x10 ^ 1, k15 = 0 case00_k10_15[x10 ^ 0x3] = V00[1] - V00[0]; //k10 = x10 ^ 1, k15 = 1 //case01 (x5 = k5, x14 = k14 ^ 1) correlation_function_f3_append_OPTIMIZE(V01, case01_k10__11_12_13_15__16); //case10 (x5 = k5 ^ 1, x14 = k14) x10 = TAKE_BIT(k5_14, 0) ^ 0x1 ^ x3 ; //x10 = x5 ^ x3 case10_k10_15[x10] = V10[0] + V10[1]; //k10 = x10, k15 = 0 case10_k10_15[x10 ^ 0x2] = case10_k10_15[x10]; //k10 = x10, k15 = 1 case10_k10_15[x10 ^ 0x1] = V10[0] - V10[1]; //k10 = x10 ^ 1, k15 = 0 case10_k10_15[x10 ^ 0x3] = V10[1] - V10[0]; //k10 = x10 ^ 1, k15 = 1 //case11 correlation_function_f3_append_OPTIMIZE(V11, case11_k10__11_12_13_15__16); for(uint32 key_6_bits=0; key_6_bits < 64; ++key_6_bits){</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">uint32 K9_k10_T0_13_15_16 = (((key_6_bits & 0x30) << 1)</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">(key_6_bits & 0x0f</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">)) << 2;//k16, k15, _, k13, k12, k11, k10, _, _</p>

    <pre><code class="language-matlab">uint32 k10_15 = key_6_bits &amp;amp; 0x1;
k10_15 |= ((key_6_bits &amp;amp; 0x10) &amp;gt;&amp;gt; 3);
uint32 k10_11_12_13_15_16 = ((key_6_bits ^ (key_6_bits &amp;gt;&amp;gt; 1)) &amp;amp; 0x1);
k10_11_12_13_15_16 |= ((key_6_bits &amp;amp; 0xC) &amp;gt;&amp;gt; 1);
k10_11_12_13_15_16 |= (((key_6_bits &amp;gt;&amp;gt; 2) ^ (key_6_bits &amp;gt;&amp;gt; 1)) &amp;amp; 0x08);
int c0 = case00_k10_15[k10_15] + case01_k10_11_12_13_15_16[k10_11_12_13_15_16];
int c1 = case10_k10_15[k10_15] + case11_k10_11_12_13_15_16[k10_11_12_13_15_16];
uint32 key_9_bits = k5_14 &amp;amp; 0x1;
key_9_bits |= ((key_6_bits &amp;amp; 0xF) &amp;lt;&amp;lt; 2);
key_9_bits |= ((k5_14 &amp;amp; 0x2) &amp;lt;&amp;lt; 5);
key_9_bits |= ((key_6_bits &amp;amp; 0x30) &amp;lt;&amp;lt; 3);
uint32 K9 = K9_k5_14 | K9_k10_TO_13_15_16;
corr_K[K9 ] = c0 + c1;
corr_K[K9 ^ 0x2] = c0 - c1;
}</code></pre>

    <pre><code class="language-txt">}
}
}
void correlation_function_f3_append_OPTIMIZE(int data[16], int corr_K[16]){ //f3 = (z10_11 ^ k10_11 ^ (z12^k12) 0 (z13 ^ k13)) 0 (z15_16 ^ k15_16) uint32 xx; int case0; int case1[4]; int c0, c1; for(uint32 k15_16 = 0; k15_16 &amp;lt;= 1; ++k15_16){ xx = k15_16 &amp;lt;&amp;lt; 3; case0 = data[xx ] + data[xx ^ 0x1] + data[xx ^ 0x2] + data[xx ^ 0x3] + data[xx ^ 0x4] + data[xx ^ 0x5] + data[xx ^ 0x6] + data[xx ^ 0x7]; case1[0] = data[xx ^ 0x8] - data[xx ^ 0x9]; case1[1] = data[xx ^ 0xA] - data[xx ^ 0xB]; case1[2] = data[xx ^ 0xC] - data[xx ^ 0xD]; case1[3] = data[xx ^ 0xE] - data[xx ^ 0xF]; c0 = case1[0] + case1[2]; //z12 = k12 = 0 c1 = case1[1] - case1[3]; //z12 = k12 = 1 corr_K[xx ] = c0 + c1; //k13 = 0 corr_K[xx ^ 0x4] = c0 - c1; //k13 = 1 corr_K[xx ^ 0x1] = case0 - corr_K[xx ]; //k13 = 0, k12 = 0, k10_11 = 1 corr_K[xx ] = case0 + corr_K[xx ]; //k13 = 0, k12 = 0, k10_11 = 0 corr_K[xx ^ 0x5] = case0 - corr_K[xx ^ 0x4]; //k13 = 1, k12 = 0, k10_11 = 1 corr_K[xx ^ 0x4] = case0 + corr_K[xx ^ 0x4]; //k13 = 1, k12 = 0, k10_11 = 0 c0 = case1[1] + case1[3]; c1 = case1[0] - case1[2]; corr_K[xx ^ 0x2] = c0 + c1; //k13 = 0; k12 = 1, k10_11 = 0 corr_K[xx ^ 0x6] = c0 - c1; //k13 = 1; k12 = 1, k10_11 = 0 corr_K[xx ^ 0x3] = case0 - corr_K[xx ^ 0x2]; //k13 = 0, k12 = 1, k10_11 = 1 corr_K[xx ^ 0x2] = case0 + corr_K[xx ^ 0x2]; //k13 = 0, k12 = 1, k10_11 = 0 corr_K[xx ^ 0x7] = case0 - corr_K[xx ^ 0x6]; //k13 = 1, k12 = 1, k10_11 = 1 corr_K[xx ^ 0x6] = case0 + corr_K[xx ^ 0x6]; //k13 = 1, k12 = 1, k10_11 = 0
}
}
void correlation_function_fp_GENERAL(int data[1&amp;lt;&amp;lt;14], int corr_K[1&amp;lt;&amp;lt;16]){ memset(corr_K, 0, sizeof(int) * (1&amp;lt;&amp;lt;16)); uint32 out; for(uint32 key=0; key &amp;lt; (1&amp;lt;&amp;lt;16); ++key){ for(uint32 idx_data = 0; idx_data &amp;lt; (1&amp;lt;&amp;lt;14); ++idx_data){ out = function_fp(idx_data, key); if(out == 0){ corr_K[key] += data[idx_data];
</code></pre>

    <p class="text-gray-300">}else{ corr_K[key] -= data[idx_data]; } } }</p>

    <p class="text-gray-300">void correlation_function_f00_GENERAL(int data[256], int corr_K[512], uint32 x3){ memset(corr_K, 0, sizeof(int) * 512); uint32 out; for(uint32 key=0; key &lt; 512; ++key){ for(uint32 idx_data = 0; idx_data &lt; 256; ++idx_data){ out = function_f00(idx_data, key, x3); if(out == 0){ corr_K[key] += data[idx_data]; }else{ corr_K[key] -= data[idx_data]; } } }</p>

    <p class="text-gray-300">void correlation_function_f3_append_GENERAL(int data[16], int corr_K[16]){ memset(corr_K, 0, sizeof(int) * 16); uint32 out; for(uint32 key=0; key &lt; 16; ++key){ for(uint32 idx_data = 0; idx_data &lt; 16; ++idx_data){ out = function_f3_append(idx_data, key); if(out==0){ corr_K[key] += data[idx_data]; }else if(out == 1){ corr_K[key] -= data[idx_data]; } } }</p>

    <pre><code class="language-text"></code></pre>

    <p class="text-gray-300">//recovery.cpp</p>

    <p class="text-gray-300">#include "VERIFY.H"</p>

    <p class="text-gray-300">#include <iostream></p>

    <p class="text-gray-300">#include <cstdlib></p>

    <p class="text-gray-300">#include <iomanip></p>

    <p class="text-gray-300">#include <vector></p>

    <p class="text-gray-300">#include <algorithm> typedef long long int64;</p>

    <p class="text-gray-300">#define MEMORY 0</p>

    <p class="text-gray-300">#define TIME 1</p>

    <p class="text-gray-300">#define argument MEMORY //memory optimized, this takes more time //#define argument TIME //memory not optimized, this takes less time using namespace std; struct corr{ uint32 kP_kC; //16 MSB is the kP; 16 LSB is the kC int count; void pri(){ cout &lt;&lt; hex &lt;&lt; setw(4) &lt;&lt; (kP_kC &gt;&gt; 16) &lt;&lt; " &lt;&lt; setw(4) &lt;&lt; (kP_kC &amp; 0xFFFF) &lt;&lt; " &lt;&lt; dec &lt;&lt; count; } }; bool Comp(const corr &amp;a, const corr &amp;b){ return (a.count &gt; b.count); }</algorithm></vector></iomanip></cstdlib></iostream></p>

    <pre><code class="language-c">}
bool success(vector&amp;lt;corr&amp;gt; &amp;amp;vc, int kP_kC){
for(int i=0; i&amp;lt;(vc.size()); ++i){
if(vc[i].kP_kC == kP_kC){
return true;
}
}
return false;
}
const int cst_1_rl_14 = (1&amp;lt;&amp;lt;14);
const int64 dataSize = 2449771427; // (2^31.19)
void simon32_21rounds_enc(uint32 in[2], uint32 out[2], uint32 k[32], int SR){
uint32 tmp[2];
tmp[0] = in[0];
tmp[1] = in[1];
for(int i=SR; i&amp;lt;SR+21; ++i){
round32(tmp, out, k[i]);
tmp[0] = out[0];
tmp[1] = out[1];
}
}
int abs(int x){return ((x &amp;gt; 0) ? x : (0-x));}
void data_collection(uint32 k[32], int** v);
void correlation_compute(int* data[1&amp;lt;&amp;lt;14], vector&amp;lt;corr&amp;gt; &amp;amp;out, int argu);
int main(int argc, char **argv){
uint32 key[32];
srand(time(NULL));
key[0] =(uint32)random()&amp;amp;0xffff;
key[1] =(uint32)random()&amp;amp;0xffff;
key[2] =(uint32)random()&amp;amp;0xffff;
key[3] =(uint32)random()&amp;amp;0xffff;
cout&amp;lt;&amp;lt;&quot;---&quot;&amp;lt;&amp;lt;endl;
cout&amp;lt;&amp;lt;&quot;|  Select the main key randomly...  |\\n&quot;;
cout.fill(&#x27;0&#x27;);
cout&amp;lt;&amp;lt;&quot;|  key[0]=&quot;&amp;lt;&amp;lt;hex&amp;lt;&amp;lt;setw(4)&amp;lt;&amp;lt;key[0]&amp;lt;&amp;lt;&quot;  |\\n&quot;;
cout&amp;lt;&amp;lt;&quot;|  key[1]=&quot;&amp;lt;&amp;lt;hex&amp;lt;&amp;lt;setw(4)&amp;lt;&amp;lt;key[1]&amp;lt;&amp;lt;&quot;  |\\n&quot;;
cout&amp;lt;&amp;lt;&quot;|  key[2]=&quot;&amp;lt;&amp;lt;hex&amp;lt;&amp;lt;setw(4)&amp;lt;&amp;lt;key[2]&amp;lt;&amp;lt;&quot;  |\\n&quot;;
cout&amp;lt;&amp;lt;&quot;|  key[3]=&quot;&amp;lt;&amp;lt;hex&amp;lt;&amp;lt;setw(4)&amp;lt;&amp;lt;key[3]&amp;lt;&amp;lt;&quot;  |\\n&quot;;
cout&amp;lt;&amp;lt;&quot;---&quot;&amp;lt;&amp;lt;endl;
key32(key);
uint32 KP, KC;
uint32 KOP, KOC;
uint32 KC_shift0, KC_shift1, KC_shift2, KC_shift3;
KEY_HEAD(key[1],key[2],key[3],key[4], KOP, KP);
KEY_TAIL(key[21],key[20], key[19], key[18], KOC, KC, KC_shift0, KC_shift1,
KC_shift2, KC_shift3);
uint32 KP_KC = ((KP&amp;lt;&amp;lt;16) | KC);
int** data = new int*[1&amp;lt;&amp;lt;14];
for(int i=0; i&amp;lt;(1&amp;lt;&amp;lt;14); ++i){
data[i] = new int[1&amp;lt;&amp;lt;14];
}
time_t t;
time(&amp;amp;t);
cout&amp;lt;&amp;lt;&quot;Data collection begins.  TIME:  &quot;&amp;lt;&amp;lt;time(&amp;amp;t)&amp;lt;&amp;lt;endl;</code></pre>

    <p class="text-gray-300">45</p>

    <pre><code class="language-c">data_collection(key, data);
time(&amp;amp;t);
cout &amp;lt;&amp;lt; &quot;Data collection finishes. TIME: &quot;&amp;lt;&amp;lt; ctime(&amp;amp;t) &amp;lt;&amp;lt; endl;
time(&amp;amp;t);
cout &amp;lt;&amp;lt; &quot;Correlation computation begins: &quot;&amp;lt;&amp;lt; ctime(&amp;amp;t) &amp;lt;&amp;lt; endl;
vector &amp;lt; corr &amp;gt; vc;
correlation_compute(data, vc, argument);
time(&amp;amp;t);
cout &amp;lt;&amp;lt; &quot;Correlation computation finishes: &quot;&amp;lt;&amp;lt; ctime(&amp;amp;t) &amp;lt;&amp;lt; endl;
if (sucsess(vc, KP_KC)) {
cout &amp;lt;&amp;lt; &quot;SUCCESS\\n&quot;;
} else {
cout &amp;lt;&amp;lt; &quot;FAIL\\n&quot;;
}
for (int i = 0; i &amp;lt; (cst_1_rl_14); ++i) {
delete[] data[i];
}
delete[] data;
return 0;
}
void data_collection(uint32 k[32], int** v) {
for (int i = 0; i &amp;lt; cst_1_rl_14; ++i) {
for (int j = 0; j &amp;lt; cst_1_rl_14; ++j) {
v[i][j] = 0;
}
}
uint32 x0, xP;
uint32 y0, yP;
uint32 pl[2];
uint32 cl[2];
uint32 cl_L, cl_R;
for (int64 dS = 0; dS &amp;lt; dataSize; ++dS) {
// pl[0] = ((uint32)random()) @ 0xffff;
// pl[1] = ((uint32)random()) @ 0xffff;
pl[0] = (dS &amp;gt;&amp;gt; 16) &amp;amp; 0xFFFF;
pl[1] = dS &amp;amp; 0xFFFF;
simon32_21rounds_enc(pl, cl, k, 1);
COMPRESS_HEAD(pl[0], pl[1], x0, xP);
COMPRESS_TAIL(cl[0], cl[1], y0, yP, cl_L, cl_R);
if (x0 == y0) {
v[xP][yP] += 1;
} else {
v[xP][yP] -= 1;
}
}
}
void correlation_compute(int* data[1 &amp;lt;&amp;lt; 14], vector &amp;lt; corr &amp;gt; &amp;amp; out, int argu) {
corr zero;
zero.count = -1;
out.push_back(zero);
vector &amp;lt; corr &amp;gt;::iterator it;
int **ck = new int*[1 &amp;lt;&amp;lt; 14];
for (int i = 0; i &amp;lt; (1 &amp;lt;&amp;lt; 14); ++i) {
ck[i] = new int[1 &amp;lt;&amp;lt; 16];
}
int tmp[1 &amp;lt;&amp;lt; 14];
int kk[1 &amp;lt;&amp;lt; 16];
corr x;
for (int i = 0; i &amp;lt; cst_1_rl_14; ++i) {</code></pre>

    <p class="text-gray-300">46</p>

    <p class="text-gray-300">correlation_function_fp_OPTIMIZE(data[i], ck[i]); } time_t t; for(int j=0; j<(1<<16); ++j){ for(int i=0; i<(1<<14); ++i){ tmp[i] = ck[i][j]; } correlation_function_fp_OPTIMIZE(tmp, kk); for(int i=0; i<(1<<16); ++i){ x.kP_kC = (((uint32)i) << 16);</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">x.kP_kC</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">= ((uint32)j);</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">x.count = abs(kk[i]); out.push_back(x); } if(argu == MEMORY){ if((j & 0xFF) == 0xFF){ sort(out.begin(), out.end(), Comp); //cout<<out.size()<<endl; if(out.size() > (1<<24)){ out.erase(out.begin()+(1<<24), out.end()); } } } } sort(out.begin(), out.end(), Comp); //cout<<out.size()<<endl; if(out.size() > (1<<24)){ out.erase(out.begin()+(1<<24), out.end()); } for(int i=0; i<(1<<14); ++i){ delete[] ck[i]; } delete[] ck; }</p>

    <p class="text-gray-300">//test_verify.cpp</p>

    <p class="text-gray-300">#include "VERIFY.H"</p>

    <p class="text-gray-300">#include <cstdlib></p>

    <p class="text-gray-300">#include <iostream></p>

    <p class="text-gray-300">#include <cstring> using namespace std; struct argu_error{ argu_error(){ void usage(){ cout<<"./test --head:\\n" <<"\\tIllustrate the correctness of Table 5 and function f(x,k).\\n"; cout<<"./test --tail:\\n" <<"\\tIllustrate the correctness of Table 6 and function f(x,k).\\n"; cout<<"./test --correlation:\\n" <<"\\tIllustrate that the optimized method to compute the correlation of ’ fp(x1_16,k1_16)’ is right.\\n" <<"\\t(f(x,k)=x0^k0^fp(x1_16,k1_16))\\n"; cout<<"./test --time:\\n" <<"\\tCompare the time complexity of computing the correlations of ’fp’ using OPTIMIZED and GENERAL methods.\\n"; } }; void test_table4_function_f(); void test_table5_function_f();</p>

    <pre><code class="language-text">
void test_correlation_fp();
void time_compare();
void test_fp_3round();
void test_correlation_fp_3round();
int main(int argc, char **argv){
try{
string argument;
if(argc &lt; 2){ throw argu_error();}
argument = argv[1];
if(argument == &quot;--head&quot;){
test_table4_function_f();
}else if(argument == &quot;--tail&quot;){
test_table5_function_f();
}else if(argument == &quot;--correlation&quot;){
test_correlation_fp();
}else if(argument == &quot;--time&quot;){
time_compare();
}else{
throw argu_error();
}
}
catch(argu_error&amp; e){
e.usage();
}
return 0;
}
void test_table4_function_f(){
srand(time(NULL));
uint32 X[2];
uint32 Y[2];
uint32 K[4];
uint32 x0, k0, x_other14, k_16bits;
cout&lt;&lt;&quot;
|---&quot;
&quot;&lt;&lt;endl;
cout&lt;&lt;&quot;| This is to test the correctness of Table 4 and function f.
|&quot;&lt;&lt;endl;
cout&lt;&lt;&quot;| X^{i-4} and K[i-4],K[i-3],K[i-2],K[i-1] are set randomly.
|&quot;&lt;&lt;endl;
cout&lt;&lt;&quot;| In the following, the second column is the output of function ’f’ using the representation in Table 4.
|&quot;&lt;&lt;endl;
cout&lt;&lt;&quot;| The third column is the ’X^i_{L,5}’, which is computed using 4-round encryption.
|&quot;&lt;&lt;endl;
cout&lt;&lt;&quot;
|---&quot;
&quot;&lt;&lt;endl;
for(int i=0; i&lt;20; ++i){
X[0] = random() &amp; 0xFFFF;
X[1] = random() &amp; 0xFFFF;
K[0] = random() &amp; 0xFFFF;
K[1] = random() &amp; 0xFFFF;
K[2] = random() &amp; 0xFFFF;
K[3] = random() &amp; 0xFFFF;
COMPRESS_HEAD(X[0],X[1],x0, x_other14);
KEY_HEAD(K[0],K[1],K[2],K[3],k0,k_16bits);
simon32_4rounds_enc(X,Y,K); //4-round encryption, Y is the output(Y[0], Y[1])
uint32 f1 = x0 ^ function_fp(x_other14, k_16bits) ^ k0; //f1 = f(x,k) = x0 ^ k0 ^ fp(x1_16, k1_16)

uint32 f2 = (Y[0]&gt;&gt;5) &amp; 0x1; //f2 = Y[0]_5 = Y_{L,5}
if(f1 != f2){
cout&lt;&lt;&quot;TEST &quot;&lt;&lt;i&lt;&lt;&quot;: FAILED\\n&quot;;
cout&lt;&lt;X[0]&lt;&lt;&quot;\\t&quot;&lt;&lt;X[1]&lt;&lt;endl;
cout&lt;&lt;K[0]&lt;&lt;&quot;\\t&quot;&lt;&lt;K[1]&lt;&lt;&quot;\\t&quot;&lt;&lt;K[2]&lt;&lt;&quot;\\t&quot;&lt;&lt;K[3]&lt;&lt;endl;
cout&lt;&lt;f1&lt;&lt;&quot;\\t&quot;;
cout&lt;&lt;f2&lt;&lt;endl;
}else{
cout&lt;&lt;dec;
cout&lt;&lt;&quot;test&quot;&lt;&lt;1+i&lt;&lt;&quot;:\\t\\t&quot;&lt;&lt;f1&lt;&lt;&quot;\\t&quot;&lt;&lt;f2&lt;&lt;&quot;\\t OK \\n&quot;;
}
}
}
void test_table5_function_f(){
srand(time(NULL));
uint32 X[2];
uint32 Y[2];
uint32 K[4];
uint32 x0, k0, x_other14, k_16bits;
uint32 tmp1, tmp2, tmp3, tmp4;
cout&lt;&lt;&quot;
|---*
&quot;&lt;&lt;endl;
cout&lt;&lt;&quot;| This is to test the correctness of Table 5 and function f.
|&quot;&lt;&lt;endl;
cout&lt;&lt;&quot;| X^{i+17} and K[i+16],K[i+15],K[i+14],K[i+13] are set randomly.
|&quot;&lt;&lt;endl;
cout&lt;&lt;&quot;| In the following, the second column is the output of function ’f’ using the representation in Table 5. |&quot;&lt;&lt;endl;
cout&lt;&lt;&quot;| The third column is the ’X^{i+13}_{L,5}’, which is computed using 4-round decryption. |&quot;&lt;&lt;endl;
cout&lt;&lt;&quot;
|---*
&quot;&lt;&lt;endl;
for(int i=0; i&lt;20; ++i){
X[0] = random() &amp; 0xFFFF;
X[1] = random() &amp; 0xFFFF;
K[0] = random() &amp; 0xFFFF;
K[1] = random() &amp; 0xFFFF;
K[2] = random() &amp; 0xFFFF;
K[3] = random() &amp; 0xFFFF;
COMPRESS_TAIL(X[0],X[1],x0, x_other14, tmp1, tmp2);
KEY_TAIL(K[0],K[1],K[2],K[3],k0,k_16bits, tmp1, tmp2, tmp3, tmp4);
simon32_4rounds_dec(X,Y,K); //4-round decryption, Y is the output(Y[0], Y[1])
uint32 f1 = x0 ~ function_fp(x_other14, k_16bits) ~ k0; //f1 = f(x,k) = x0 ~ k0 ~ fp(x1_16, k1_16)
uint32 f2 = (Y[1]&gt;&gt;13) &amp; 0x1; //f2 = Y[1]_13 = Y_{R,13}
if(f1 != f2){
cout&lt;&lt;&quot;TEST &quot;&lt;&lt;i&lt;&lt;&quot;: FAILED\\n&quot;;
cout&lt;&lt;X[0]&lt;&lt;&quot;\\t&quot;&lt;&lt;X[1]&lt;&lt;endl;
cout&lt;&lt;K[0]&lt;&lt;&quot;\\t&quot;&lt;&lt;K[1]&lt;&lt;&quot;\\t&quot;&lt;&lt;K[2]&lt;&lt;&quot;\\t&quot;&lt;&lt;K[3]&lt;&lt;endl;
cout&lt;&lt;f1&lt;&lt;&quot;\\t&quot;;
cout&lt;&lt;f2&lt;&lt;endl;
}else{
cout&lt;&lt;dec;
cout&lt;&lt;&quot;test&quot;&lt;&lt;1+i&lt;&lt;&quot;:\\t\\t&quot;&lt;&lt;f1&lt;&lt;&quot;\\t&quot;&lt;&lt;f2&lt;&lt;&quot;\\t OK \\n&quot;;
}
}
</code></pre>

    <p class="text-gray-300">} void test_correlation_fp(){ cout&lt;&lt;"</p>

    <p class="text-gray-300">|--- n";</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">cout&lt;&lt;"</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">This is to illustrate that the correlation of 'fp(x,k)' under 'k'</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">got from the optimized method</p>

    <p class="text-gray-300">|n";</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">cout&lt;&lt;"</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">is equal to that from the general method. The counter number of 'x'</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">is set randomly(&lt;16). For 20</p>

    <p class="text-gray-300">|n";</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">cout&lt;&lt;"</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">random given 'k', the corresponding correlations are given. The</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">first column is got from the optimized</p>

    <p class="text-gray-300">|n";</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">cout&lt;&lt;"</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">method; the second column is from the general method.</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">|n";</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">cout&lt;&lt;"</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">This program will take several minutes...</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">|n"; cout&lt;&lt;"</p>

    <p class="text-gray-300">|--- n"; srand(time(NULL)); int DATA[1&lt;&lt;14]; int CORRELATION_OPTIMIZE[1&lt;&lt;16]; int CORRELATION_GENERAL[1&lt;&lt;16]; int flag = 0; for(int i=0; i&lt;(1&lt;&lt;14); ++i){ DATA[i] = random() &amp; 0xF; } correlation_function_fp_OPTIMIZE(DATA, CORRELATION_OPTIMIZE); correlation_function_fp_GENERAL(DATA, CORRELATION_GENERAL); for(int i=0; i&lt;(1&lt;&lt;16); ++i){ if(CORRELATION_OPTIMIZE[i] != CORRELATION_GENERAL[i]){ flag = 1; break; } } int i=0; while(i&lt;20){ int j=random()&amp;0xFFFF cout&lt;&lt;"key=0x"&lt;&lt;hex&lt;&lt;j&lt;&lt;":\\t"&lt;&lt;dec&lt;&lt;CORRELATION_OPTIMIZE[j]&lt;&lt;"\\t"&lt;&lt; CORRELATION_GENERAL[j]&lt;&lt;endl; ++i; } if(1 == flag){ cout&lt;&lt;"The optimized method is wrong!\\n"; }else{ cout&lt;&lt;"The optimized method is right!\\n"; } } void time_compare(){ time_t T1, T2, T3, T4; srand(time(NULL)); int DATA[1&lt;&lt;14]; int CORRELATION_OPTIMIZE[1&lt;&lt;16]; int CORRELATION_GENERAL[1&lt;&lt;16]; for(int i=0; i&lt;(1&lt;&lt;14); ++i){ DATA[i] = random() &amp; 0xF; } T1 = time(NULL); correlation_function_fp_OPTIMIZE(DATA, CORRELATION_OPTIMIZE); T2 = time(NULL);</p>

    <pre><code>
50

T3 = time(NULL);
cout&lt;&lt;&quot;Time to compute the correlations of ’fp’ for all the ’k’ using OPTIMIZED
method: t1 = &quot;&lt;&lt;difftime(T2, T1)&lt;&lt;&quot; seconds&quot;&lt;&lt;endl;
correlation_function_fp_general(data, correlation_general);
T3 = time(NULL);
cout&lt;&lt;&quot;Time to compute the correlations of ’fp’ for all the ’k’ using GENERAL
method: t2 = &quot;&lt;&lt;difftime(T3, T2)&lt;&lt;&quot; seconds&quot;&lt;&lt;endl;

for(int i = 0; i&lt;(1&lt;&lt;16); ++i){
correlation_function_fp_OPTIMIZE(data, correlation_OPTIMIZE);
}
T4 = time(NULL);
cout&lt;&lt;&quot;
---
n&quot;;
cout&lt;&lt;&quot;2^16 * t1 is:\\n&quot;;
cout&lt;&lt;&quot;Time to compute the correlations of ’fp’ for all the ’k’ using OPTIMIZED
method: t3 = &quot;&lt;&lt;difftime(T4, T3)&lt;&lt;&quot; seconds&quot;&lt;&lt;endl;
}

#Makefile
OBJECTS_VERIFY = VERIFY.o test_verify.o SIMON.o
OBJECTS_RECOVERY = SIMON.o recovery.o VERIFY.o
all: VERIFY RECOVERY
RECOVERY: $(OBJECTS_RECOVERY)
g++ -03 -march=native $(OBJECTS_RECOVERY) -o recovery
recovery.o: VERIFY.o recovery.cpp
g++ -03 -march=native -c recovery.cpp -o recovery.o
VERIFY: $(OBJECTS_VERIFY)
g++ -03 -march=native $(OBJECTS_VERIFY) -o verify
VERIFY.o: SIMON.o VERIFY.H VERIFY.cpp
g++ -03 -march=native -c VERIFY.cpp -o VERIFY.o
test_verify.o: VERIFY.o test_verify.cpp
g++ -03 -march=native -c test_verify.cpp -o test_verify.o
SIMON.o: SIMON.H SIMON.cpp
g++ -03 -march=native -c SIMON.cpp -o SIMON.o
clean:
rm *.o

Use &quot;make&quot;, we will get two executable files:

- verify
This is to verify the correctness of our expression and method in the paper
- recovery
This is to attack 21-round (round 2 to 20) Simon32

Usage:

- verify
- ./test -head
Illustrate the correctness of Table 5 and function f(x,k)
- ./test -tail
Illustrate the correctness of Table 6 and function f(x,k)
- ./test -correlation
Illustrate that the optimized method to compute the correlation of f&#x27;(x_{1-16},k_{1-16}) is right
(f(x,k) = x_{0} ⊕ k_{0} ⊕ f&#x27;(x_{1-16},k_{1-16})
- ./test -time:
Compare the time complexity of computing the correlations of f&#x27;(x_{1-16},k_{1-16}) using OPTIMIZED and GENERAL methods
- recovery

- ./recovery
Generate random key and $2^{31.19}$ plaintext-ciphertext pairs (round 2 to 20), then compute the bias for all the key and store the $2^{32-8}=2^{24}$ candidates with large bias in set $S$, at last check whether the right key is in $S$</code></pre>`;
---

<BaseLayout title="Improved Linear Hull Attack on Round-Reduced \textsc{Simon} ... (2015/666)">
  <article class="max-w-4xl mx-auto article-prose">
    <nav class="mb-8">
      <a href="/papers" class="text-blue-400 hover:text-blue-300">
        &larr; Back to Papers
      </a>
    </nav>

    <header class="mb-12">
      <h1 class="text-3xl font-bold mb-4"
        set:html={TITLE_HTML} />
      <p class="text-gray-400 mb-2"
        set:html={AUTHORS_HTML} />
      <p class="text-gray-500 text-sm mb-4">
        2015 &middot; eprint 2015/666
      </p>
      <div class="flex gap-4 text-sm">
        <a
          href={EPRINT_URL}
          target="_blank"
          rel="noopener noreferrer"
          class="text-blue-400 hover:text-blue-300"
        >
          Paper (eprint) &rarr;
        </a>
      </div>
      <p class="mt-4 text-xs text-gray-500">
        All content below belongs to the original authors. This page
        reproduces the paper for educational purposes. Always
        <a
          href={EPRINT_URL}
          target="_blank"
          rel="noopener noreferrer"
          class="text-blue-400 hover:text-blue-300"
        >cite the original</a>.
      </p>
      <p class="mt-1 text-xs text-gray-600">
        Converted with: {CRAWLER} &middot; {CONVERTED_DATE}
      </p>
    </header>

    <Fragment set:html={CONTENT} />

  </article>
</BaseLayout>
