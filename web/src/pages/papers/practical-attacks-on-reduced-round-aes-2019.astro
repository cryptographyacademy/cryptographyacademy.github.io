---
import BaseLayout from '../../layouts/BaseLayout.astro';

const EPRINT_URL = 'https://eprint.iacr.org/2019/770';
const CRAWLER = 'mistral';
const CONVERTED_DATE = '2026-02-16';
const TITLE_HTML = 'Practical Attacks on Reduced-Round AES';
const AUTHORS_HTML = 'Navid Ghaedi Bardeh, Sondre Rønjom';

const CONTENT = `    <p class="text-gray-300">Navid Ghaedi Bardeh [ Department of Informatics, University of Bergen, Bergen, Norway {navid.bardeh, sondre.ronjom}@uib.no ] Sondre Rønjom [ Department of Informatics, University of Bergen, Bergen, Norway {navid.bardeh, sondre.ronjom}@uib.no ]</p>

    <h6 id="sec-2" class="text-base font-medium mt-4">Abstract</h6>

    <p class="text-gray-300">In this paper we investigate the security of 5-round AES against two different attacks in an adaptive setting. We present a practical key-recovery attack on 5-round AES with a secret s-box that requires <span class="math">2^{32}</span> adaptively chosen ciphertexts, which is as far as we know a new record. In addition, we present a new and practical key-independent distinguisher for 5-round AES which requires <span class="math">2^{27.2}</span> adaptively chosen ciphertexts. While the data complexity of this distinguisher is in the same range as the current best 5-round distinguisher <em>[14]</em>, it exploits new structural properties of 5-round AES.</p>

    <p class="text-gray-300">AES Zero-difference Secret-key distinguisher Differential Secret S-box.</p>

    <h2 id="sec-3" class="text-2xl font-bold">1 Introduction</h2>

    <p class="text-gray-300">Block ciphers are typically designed by iterating an efficiently computable round function many times in the hope that the resulting composition behaves like a randomly drawn permutation. The designer is typically constrained by various practical criterion, e.g. security target, implementation boundaries, and specialized applications, that might lead the designer to introduce symmetries and structures in the round function as a compromise between efficiency and security. In the compromise, a round function is iterated enough times to make sure that any symmetries and structural properties that might exist in the round function vanish. Thus, a round function is typically designed to increasingly de-correlate with structure and symmetries after several rounds. Low data- and computational-complexity distinguishers and key-recovery attacks on round-reduced block ciphers have recently gained renewed interest in the literature. There are several reasons for this. In one direction cryptanalysis of block ciphers has focused on maximizing the number of rounds that can be broken without exhausting the full codebook and key space. This often leads to attacks marginally close to that of pure brute-force. These are attacks that typically have been improved over time based on many years of cryptanalysis. The most successful attacks often become de-facto standard methods of cryptanalysis for a particular block cipher and might discourage anyone from pursuing new directions in cryptanalysis that do not reach the same number of rounds. This in itself might hinder new breakthroughs, thus it can be important to investigate new promising ideas that might not have reached its full potential yet. New methods of cryptanalysis that break or distinguish fewer rounds faster but with lower</p>

    <p class="text-gray-300">complexity than established cryptanalysis is therefore interesting in this process. Many constructions employ reduced round AES as part of their design. On the other hand, reduced versions of AES have nice and well-studied properties that can be favorable as components of larger designs (see for instance Simpira <em>[13]</em>).</p>

    <p class="text-gray-300">The security of Rijndael-type block cipher <em>[5]</em> designs is believed to be a well-studied topic and has been in the focus of a large group of cryptanalysts during the last 20 years (see e.g. <em>[2, 3, 6, 7, 4, 8, 9, 12, 14, 1]</em>). Several distinguisher attacks exists agaist reduced-round of AES. The aim of a distinguisher attack is to distinguish the cipher from a sufficiently generic permutation i.e. the aim is to find some properties of the cipher that allows to set up a test for an unusual event with sufficiently different probability of happening in comparison to random (e.g. finding certain collision-events in a set of ciphertexts when restricted to structured sets of plaintexts). At Crypto 2016, Sun et al. <em>[15]</em> presented the very first 5-round key-dependent distinguisher for AES. They extend a 4-round integral property to 5-rounds by exploiting properties of the AES MixColumn matrix. Although their distinguisher requires the whole codebook, it spawned a series of new fundamental results for AES. It was later improved to <span class="math">2^{98.2}</span> chosen plaintexts with <span class="math">2^{107}</span> computations by extending a 4-round impossible differential property to a 5-round property. Then, at Eurocrypt 2017, Grassi et al. <em>[12]</em> proposed the first 5-round key-independent chosen plaintext distinguisher which requires <span class="math">2^{32}</span> chosen plaintexts with a computational cost of <span class="math">2^{36.6}</span> look-ups into memory of size <span class="math">2^{36}</span> bytes. They showed that by encrypting cosets of certain subspaces of the plaintext space the number of times the difference of ciphertext pairs lie in a particular subspace of the state space always is a multiple of 8. Later, at Asiacrypt 2017, Rønjom et al. <em>[14]</em> presented new fundamental properties for Rijndael-type block cipher designs leading to new types of 3- to 6-round key-independent distinguishers for AES that beats all previous records. They showed that zero-differences of encrypted plaintext (or decrypted ciphertext) pairs are left invariant by encrypting new pairs formed by exchanging ciphertext/plaintext-dependent values between already observed pairs. Using this property they present the first 6-round distinguisher which requires <span class="math">2^{122.83}</span> adaptively chosen ciphertexts and which has computational cost of <span class="math">2^{121.83}</span> XORs. Note that their result is in the adaptive setting where the adversary can actively query the encryption and decryption function depending on observed values, while the previous distinguishers are in the chosen plaintext or ciphertext setting.</p>

    <p class="text-gray-300">The security of AES with a secret s-box has been investigated in several papers. In this case, when the choice of s-box is made uniformly at random from all 8-bit s-boxes, the size of the secret information increases from 128<span class="math">-</span> and 256-bit keys to 1812<span class="math">-</span> and 1940-bits of secret key material. In FSE 2015, Tiessen et al. <em>[16]</em> proposed the first 5-round key recovery attack on AES with a secret s-box based on integral cryptanalysis, which requires <span class="math">2^{40}</span> chosen plaintexts with a computational cost of <span class="math">2^{38.7}</span> encryptions. In their attack, they first derive an affine equivalent s-box before they recover the secret key. Then at FSE 2016, Grassi et al. <em>[11]</em> proposed a key recovery attack which exploits a particular property of</p>

    <p class="text-gray-300">Practical Attacks on Reduced-Round AES</p>

    <p class="text-gray-300">the AES MixColumn matrix. They then combine this with impossible differential cryptanalysis to derive the secret key. Their attack requires  <span class="math">2^{102}</span>  chosen plaintexts with  <span class="math">2^{100.4}</span>  computations. It was later improved to  <span class="math">2^{53.25}</span>  chosen plaintexts and  <span class="math">2^{52.6}</span>  computations in [10] by using a similar approach, but instead of using impossible differential cryptanalysis, they apply multiple- <span class="math">n</span>  cryptanalysis.</p>

    <p class="text-gray-300">So far, various 5-round key recovery attacks on AES with a secret s-box have been presented based on integral, impossible differential and multiple- <span class="math">n</span>  cryptanalysis. In this paper, we raise the question whether it is possible to set up a 5-round key recovery attack on AES with a secret s-box based on recently developed attack techniques called zero-difference cryptanalysis. In this paper we present an efficient key-recovery attack on 5-round AES with a secret s-box based on zero-difference cryptanalysis that requires  <span class="math">2^{32}</span>  adaptively chosen ciphertexts and that has computational complexity consisting of  <span class="math">2^{31}</span>  XORs. We also present a new key-independent distinguisher for 5-round AES which requires  <span class="math">2^{27.2}</span>  adaptively chosen ciphertexts and which has computational complexity consisting of  <span class="math">2^{26.2}</span>  XORs. The latter distinguisher exploits new structural properties in 5-round AES.</p>

    <p class="text-gray-300">In Section 2 we briefly recall some results and notation that we use in the rest of this paper. In Section 3, we describe a new 5-round distinguisher for AES. Then in Section 4 we present a new key-recovery attack for AES with a secret s-box. The current best secret key distinguishers for 5-round AES and best key-recovery attacks for 5-round AES-128 with a secret s-box are presented in Table 1 and Table 2. We adopt that data complexity is measured in a minimum number of chosen plaintexts/ciphertexts  <span class="math">CP / CC</span>  or adaptively chosen plaintexts/ciphertexts  <span class="math">ACP / ACC</span> . Time complexity is measured in equivalent number of AES encryptions (E), memory access (M) and/or XOR operations (XOR).</p>

    <p class="text-gray-300">Table 1. Secret-Key Distinguishers for 5-round AES</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Property</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Rounds</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Data</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Cost</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Key-Independent</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Ref.</th>

          </tr>

        </thead>

        <tbody>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">Multiple-8</td>

            <td class="px-3 py-2 border-b border-gray-700">5</td>

            <td class="px-3 py-2 border-b border-gray-700">232 CP</td>

            <td class="px-3 py-2 border-b border-gray-700">236.6 M</td>

            <td class="px-3 py-2 border-b border-gray-700">✓</td>

            <td class="px-3 py-2 border-b border-gray-700">[12]</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">Zero Difference</td>

            <td class="px-3 py-2 border-b border-gray-700">5</td>

            <td class="px-3 py-2 border-b border-gray-700">227.2 ACC</td>

            <td class="px-3 py-2 border-b border-gray-700">226.2 XOR</td>

            <td class="px-3 py-2 border-b border-gray-700">✓</td>

            <td class="px-3 py-2 border-b border-gray-700">Sect. 3</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">Zero Difference</td>

            <td class="px-3 py-2 border-b border-gray-700">5</td>

            <td class="px-3 py-2 border-b border-gray-700">226.8 ACC</td>

            <td class="px-3 py-2 border-b border-gray-700">225.8 XOR</td>

            <td class="px-3 py-2 border-b border-gray-700">✓</td>

            <td class="px-3 py-2 border-b border-gray-700">[14]</td>

          </tr>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">N.G. Bardeh et al.</p>

    <p class="text-gray-300">Table 2. Comparison of key-recovery on 5-round AES with a secret s-box</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Attack</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Rounds</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Data</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Computation</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Memory</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Ref.</th>

          </tr>

        </thead>

        <tbody>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">Imp. Diff.</td>

            <td class="px-3 py-2 border-b border-gray-700">5</td>

            <td class="px-3 py-2 border-b border-gray-700">276.37 CP</td>

            <td class="px-3 py-2 border-b border-gray-700">274.09 E</td>

            <td class="px-3 py-2 border-b border-gray-700">28</td>

            <td class="px-3 py-2 border-b border-gray-700">[10]</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">Multiple of n</td>

            <td class="px-3 py-2 border-b border-gray-700">5</td>

            <td class="px-3 py-2 border-b border-gray-700">253.25 CP</td>

            <td class="px-3 py-2 border-b border-gray-700">252.6 E</td>

            <td class="px-3 py-2 border-b border-gray-700">216</td>

            <td class="px-3 py-2 border-b border-gray-700">[10]</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">Integral</td>

            <td class="px-3 py-2 border-b border-gray-700">5</td>

            <td class="px-3 py-2 border-b border-gray-700">240 CP</td>

            <td class="px-3 py-2 border-b border-gray-700">238.7 E</td>

            <td class="px-3 py-2 border-b border-gray-700">240</td>

            <td class="px-3 py-2 border-b border-gray-700">[16]</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">Zero Difference</td>

            <td class="px-3 py-2 border-b border-gray-700">5</td>

            <td class="px-3 py-2 border-b border-gray-700">229.19CP + 232 ACC</td>

            <td class="px-3 py-2 border-b border-gray-700">231 XOR</td>

            <td class="px-3 py-2 border-b border-gray-700">small1</td>

            <td class="px-3 py-2 border-b border-gray-700">Sect. 4</td>

          </tr>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">!<a href="img-0.jpeg">img-0.jpeg</a> Fig.1. Description of one AES round</p>

    <p class="text-gray-300">The AES internal state is typically represented as a 4 by 4 matrix over the finite field  <span class="math">\\mathbb{F}_{2^8}</span> . The state is sometimes also represented as a vector of length 4 over  <span class="math">\\mathbb{F}_{2^8}^4</span>  typically formed by concatenating the columns of the matrix state from left to right. This is the view typically taken in SuperBox cryptanalysis. One full round of AES consists of SubBytes (SB), ShiftRows (SR), MixColumns (MC) and AddKey (AK),  <span class="math">R = AK \\circ MC \\circ SR \\circ SB</span>  (depicted in Figure 1). The SB-layer applies a fixed 8-bit to 8-bit s-box independently to each byte of the state, the SR-layer cyclically shift the  <span class="math">i</span> -th row by  <span class="math">i</span>  positions, while the MC-layer applies a fixed linear transformation to each column. The key addition simply XORs a secret round-dependent value to the state. Also,  <span class="math">R^n(x)</span>  means  <span class="math">n</span>  rounds of AES. We omit the last  <span class="math">MC \\circ SR</span>  operations to simplify the presentation of our attacks (our attacks work as well in the case in which the final linear layer is omitted).</p>

    <p class="text-gray-300">In [11], Grassi et al. present subspace trail cryptanalysis on AES. They define two different subspaces related to AES. If we let  <span class="math">\\{e_{0,0},\\dots,e_{3,3}\\}</span>  form the unit vectors of  <span class="math">\\mathbb{F}_{2^8}^{4\\times 4}</span> , we have the following.</p>

    <p class="text-gray-300">Definition 1. (Diagonal spaces) The diagonal spaces  <span class="math">\\mathcal{D}_i</span>  are defined as</p>

    <div class="my-4 text-center"><span class="math-block">\\mathcal {D} _ {i} = &amp;lt;   e _ {0, i}, e _ {1, i + 1}, e _ {2, i + 2}, e _ {3, i + 3} &amp;gt;</span></div>

    <p class="text-gray-300">Practical Attacks on Reduced-Round AES</p>

    <p class="text-gray-300">where <span class="math">i + j</span> is computed modulo 4. For instance, the diagonal space <span class="math">\\mathcal{D}_0</span> corresponds to the symbolic matrix:</p>

    <div class="my-4 text-center"><span class="math-block">\\mathcal{D}_0 = \\left\\{ \\begin{bmatrix} x_1 &amp;amp; 0 &amp;amp; 0 &amp;amp; 0 \\\\ 0 &amp;amp; x_2 &amp;amp; 0 &amp;amp; 0 \\\\ 0 &amp;amp; 0 &amp;amp; x_3 &amp;amp; 0 \\\\ 0 &amp;amp; 0 &amp;amp; 0 &amp;amp; x_4 \\end{bmatrix} \\quad \\forall x_1, x_2, x_3, x_4 \\in \\mathbb{F}_{2^8} \\right\\}.</span></div>

    <p class="text-gray-300"><strong>Definition 2. (Column spaces)</strong> The column spaces <span class="math">\\mathcal{C}_i</span> are defined as</p>

    <div class="my-4 text-center"><span class="math-block">\\mathcal{C}_i = \\langle e_{0,i}, e_{1,i}, e_{2,i}, e_{3,i} \\rangle.</span></div>

    <p class="text-gray-300">For instance, the columns space <span class="math">\\mathcal{C}_0</span> corresponds to the symbolic matrix</p>

    <div class="my-4 text-center"><span class="math-block">\\mathcal{C}_0 = \\left\\{ \\begin{bmatrix} x_1 &amp;amp; 0 &amp;amp; 0 &amp;amp; 0 \\\\ x_2 &amp;amp; 0 &amp;amp; 0 &amp;amp; 0 \\\\ x_3 &amp;amp; 0 &amp;amp; 0 &amp;amp; 0 \\\\ x_4 &amp;amp; 0 &amp;amp; 0 &amp;amp; 0 \\end{bmatrix} \\quad \\forall x_1, x_2, x_3, x_4 \\in \\mathbb{F}_{2^8} \\right\\}.</span></div>

    <p class="text-gray-300"><strong>Definition 3.</strong> Let <span class="math">I \\subseteq \\{0,1,2,3\\}</span>. Let <span class="math">\\mathcal{D}_I</span> and <span class="math">\\mathcal{C}_I</span> be defined as</p>

    <div class="my-4 text-center"><span class="math-block">\\mathcal{D}_I = \\bigoplus_{i \\in I} \\mathcal{D}_i, \\qquad \\mathcal{C}_I = \\bigoplus_{i \\in I} \\mathcal{C}_i.</span></div>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">The dimension of the subspaces <span class="math">\\mathcal{D}_I</span> and <span class="math">\\mathcal{C}_I</span> are both $4 \\cdot</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">I</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">$. The following theorem describes the deterministic mapping between these two subspaces.</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300"><strong>Theorem 1.</strong> [11] For <span class="math">I \\subset \\{0,1,2,3\\}</span> and for each <span class="math">a \\in \\mathcal{D}_I^\\perp</span> (orthogonal complement of <span class="math">D_I</span>), there exists one and only one <span class="math">b \\in \\mathcal{C}_I^\\perp</span> (orthogonal complement of <span class="math">C_I</span>) such that:</p>

    <div class="my-4 text-center"><span class="math-block">R(\\mathcal{D}_I \\oplus a) = \\mathcal{C}_I \\oplus b.</span></div>

    <p class="text-gray-300"><strong>Lemma 1.</strong> [11] For all <span class="math">x, y \\in \\mathbb{F}_{2^8}^{4 \\times 4}</span> and for all <span class="math">I \\subseteq \\{0,1,2,3\\}</span>, it follows that</p>

    <div class="my-4 text-center"><span class="math-block"></span></div>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Pr(R(x) \\oplus R(y)) \\in \\mathcal{C}_I</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">x \\oplus y \\in \\mathcal{D}_I) = 1.</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <div class="my-4 text-center"><span class="math-block"></span></div>

    <p class="text-gray-300">In the other word, we can deduce that for each <span class="math">c \\in \\mathcal{C}_I^\\perp</span>, there exists exactly one <span class="math">d \\in \\mathcal{D}_I^\\perp</span> such that</p>

    <div class="my-4 text-center"><span class="math-block">R^{-1}(\\mathcal{C}_I \\oplus c) = \\mathcal{D}_I \\oplus d</span></div>

    <p class="text-gray-300">and in general</p>

    <div class="my-4 text-center"><span class="math-block"></span></div>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Pr(R^{-1}(x) \\oplus R^{-1}(y)) \\in \\mathcal{D}_I</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">x \\oplus y \\in \\mathcal{C}_I) = 1.</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <div class="my-4 text-center"><span class="math-block"></span></div>

    <p class="text-gray-300"><strong>Lemma 2.</strong> [11] For any <span class="math">\\mathcal{C}_I</span> and <span class="math">\\mathcal{D}_J</span>, we have that</p>

    <p class="text-gray-300">$$ \\begin{aligned}</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Pr(x \\in (\\mathcal{C}_I \\cap \\mathcal{D}_J)</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">x \\in \\mathcal{C}_I) &amp;= (2^{-8})^{4 \\cdot</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">I</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">-</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">I</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\cdot</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">J</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">} \\\\</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">\\end{aligned} $$</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">This means that if two elements belong to the same coset of <span class="math">\\mathcal{D}_I</span> (respectively <span class="math">\\mathcal{C}_I</span>), then they also belong to the same coset of <span class="math">\\mathcal{C}_J</span> (respectively <span class="math">\\mathcal{D}_J</span>) with probability $(2^{-8})^{4 \\cdot</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">I</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">-</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">I</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\cdot</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">J</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">}<span class="math">. More precisely, when we encrypt two plaintexts from the same coset of </span>D_I<span class="math"> for one round, then they belong to the same coset of </span>\\mathcal{C}_I \\cap \\mathcal{D}_J<span class="math"> with probability </span>(2^{-8})^{4 \\cdot</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">I</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">-</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">I</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\cdot</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">J</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">}$. We use this lemma to compute most of the probabilities in our attacks.</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <h3 id="sec-9" class="text-xl font-semibold mt-8">2.3 Zero-difference for 4-round AES</h3>

    <p class="text-gray-300">In <em>[14]</em>, Rønjom et al. present zero-difference cryptanalysis against generic Substitution Permutation Networks (SPNs). In the following, we recall the basic zero-difference properties for 4-rounds of AES.</p>

    <h6 id="sec-10" class="text-base font-medium mt-4">Definition 4</h6>

    <p class="text-gray-300"><em>[14]</em> For a vector <span class="math">v\\in\\mathbb{F}_{2}^{4}</span> and a pair of states <span class="math">\\alpha,\\beta\\in\\mathbb{F}_{2^{8}}^{4\\times 4}</span> define a new state</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">$\\rho^{v}(\\alpha,\\beta)=(\\alpha_{i}v_{i}\\oplus\\beta_{i}(v_{i}\\oplus 1)\\,</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\,0\\leq i<n).$</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">where <span class="math">\\alpha_{i}</span> and <span class="math">\\beta_{i}</span> are <span class="math">i</span>th columns of <span class="math">\\alpha</span> and <span class="math">\\beta</span></p>

    <p class="text-gray-300">The new pair <span class="math">(\\alpha^{\\prime},\\beta^{\\prime})=(\\rho^{v}(\\alpha,\\beta),\\rho^{v}(\\beta,\\alpha))</span> is formed by exchanging individual words between <span class="math">\\alpha</span> and <span class="math">\\beta</span> according to the binary coefficients of <span class="math">v</span>.</p>

    <p class="text-gray-300">Zero-difference cryptanalysis exploits a fundamental property of the <span class="math">SLS</span> construction (<span class="math">S</span> is a non-linear layer and <span class="math">L</span> is a linear transformation) which is encapsulated in the following theorem originally presented in <em>[14]</em>.</p>

    <h6 id="sec-11" class="text-base font-medium mt-4">Theorem 2</h6>

    <p class="text-gray-300"><em>[14]</em> Let <span class="math">\\alpha,\\beta\\in\\mathbb{F}_{2^{8}}^{4\\times 4}</span> and <span class="math">\\alpha^{\\prime}=\\rho^{v}(\\alpha,\\beta),\\beta^{\\prime}=\\rho^{v}(\\beta,\\alpha)</span> then</p>

    <p class="text-gray-300"><span class="math">\\nu(S\\circ L\\circ S(\\alpha)\\oplus S\\circ L\\circ S(\\beta))=\\nu(S\\circ L\\circ S(\\alpha^{\\prime})\\oplus S\\circ L\\circ S(\\beta^{\\prime}))</span></p>

    <p class="text-gray-300">where <span class="math">\\nu(x)</span> denotes the indicator vector which is <span class="math">1</span> if the word <span class="math">i</span> of <span class="math">x</span> is zero and <span class="math">0</span> otherwise.</p>

    <p class="text-gray-300">Due to the symmetry of <span class="math">SLS</span>, we get exactly the same result in the decryption direction. Note that the <span class="math">SLS</span> construction essentially corresponds to 4 full rounds of AES. In <em>[14]</em>, the authors fix plaintexts with fixed zero diagonals and decrypt the exchanged ciphertext pairs to a new plaintext pair which with probability 1 have exactly the same zero diagonals.</p>

    <p class="text-gray-300">We can represent Theorem 2 in terms of subspace cryptanalysis. Consider two plaintexts in the same coset of a diagonal space <span class="math">\\mathcal{D}_{I}</span>, <span class="math">p^{0},p^{1}\\in\\mathcal{D}_{I}+a</span>. Then let <span class="math">c^{0}=R^{4}(p^{0})</span>, <span class="math">c^{1}=R^{4}(p^{1})</span>, <span class="math">p^{\\prime 0}=R^{-4}(\\rho^{v}(c^{0},c^{1})))</span> and <span class="math">p^{\\prime 1}=R^{-4}(\\rho^{v}(c^{1},c^{0})))</span>. Then with probability one, we also have that <span class="math">p^{\\prime 0}\\oplus p^{\\prime 1}\\in\\mathcal{D}_{I}</span> (different coset than <span class="math">D_{I}+a</span>). In the next two sections, we present two practical different attacks based on this 4-round property. We have practically verified the attacks on full-scale AES in C/C++.</p>

    <h2 id="sec-12" class="text-2xl font-bold">3 5-round key-independent distinguisher</h2>

    <p class="text-gray-300">In this section we extend the 4-round distinguisher mentioned in the previous section to a 5-round distinguisher by adding one round at beginning. We encrypt a plaintext set and expect that some of them follow the 4-round property after one round encryption. Thus, we present a new 5-round key-independent distinguisher which requires <span class="math">2^{27.2}</span> adaptively chosen ciphertexts. The idea for setting up a 5-round distinguisher is as follows. We pick a plaintext set <span class="math">P</span> from a coset of a diagonal space <span class="math">\\mathcal{D}_{0}</span>, <span class="math">P\\subset\\mathcal{D}_{0}+a</span>, and encrypt them. Then from the</p>

    <p class="text-gray-300">Practical Attacks on Reduced-Round AES</p>

    <p class="text-gray-300">!<a href="img-1.jpeg">img-1.jpeg</a> Fig. 2. 5-round truncated differential characteristic used in case 1</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">set of all possible ciphertext pairs we form 7 new ciphertext pairs by exchanging mixed values between the original pairs. Then we decrypt the set of these newly generated ciphertext pairs and expect to observe one such pair belonging to the same coset of  <span class="math">\\mathcal{D}_L</span>  with  $</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">L</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">= 3$ .</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">We know that each coset of  <span class="math">\\mathcal{D}_I</span>  is mapped into a coset of  <span class="math">\\mathcal{C}_I</span>  with probability one, and diagonal and column spaces always have an intersection with a certain probability (Lemma 2). So, when we encrypt the plaintexts set  <span class="math">P</span> , one of following cases may happen after one round encryption.</p>

    <p class="text-gray-300">First case. After one round encryption, then according to Lemma 2, with probability  <span class="math">4 \\cdot 2^{-24}</span>  (a single byte can be active in 4 different positions in a column) we have that</p>

    <div class="my-4 text-center"><span class="math-block">R (p ^ {i}) \\oplus R (p ^ {j}) \\in D _ {K} \\cap C _ {0}</span></div>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">where  $</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">K</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">= 1$ . If we swap word(s) between the ciphertexts and decrypt them, we have, according to the 4-round property mentioned in Section 2.3, that</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <div class="my-4 text-center"><span class="math-block">R ^ {- 4} \\left(\\rho^ {v} \\left(c ^ {i}, c ^ {j}\\right)\\right) \\oplus R ^ {- 4} \\left(\\rho^ {v} \\left(c ^ {j}, c ^ {i}\\right)\\right) \\in D _ {K}</span></div>

    <p class="text-gray-300">and</p>

    <div class="my-4 text-center"><span class="math-block">R ^ {- 4} \\left(\\rho^ {v} \\left(c ^ {i}, c ^ {j}\\right)\\right) \\oplus R ^ {- 4} \\left(\\rho^ {v} \\left(c ^ {j}, c ^ {i}\\right)\\right) \\in D _ {K} \\cap C _ {L}</span></div>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">where  $</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">L</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">= 3<span class="math">  with probability  </span>4 \\cdot 2^{-8}<span class="math">  (there are 4 possible choices for choosing  </span>L<span class="math"> ). It means that after one more round of decryption, according to Theorem 1, the two new plaintexts,  </span>p^{ij}<span class="math">  and  </span>p^{ij}<span class="math"> , are in the same coset of a diagonal space  </span>\\mathcal{D}_L<span class="math">  where  </span></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">L</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">= 3<span class="math"> . Thus, it happens with a probability  </span>4 \\cdot 2^{-24} \\cdot 4 \\cdot 2^{-8}$ . The truncated differential characteristic used in this case is depicted in Figure 2.</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">Second case. In this case,  <span class="math">R(p^i) \\oplus R(p^j)</span>  differ in only two bytes with probability  <span class="math">6 \\cdot 2^{-16}</span> . In other words:</p>

    <div class="my-4 text-center"><span class="math-block">R (p ^ {i}) \\oplus R (p ^ {j}) \\in D _ {K} \\cap C _ {0}</span></div>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">where  $</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">K</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">= 2$ . Then, according to the 4-round property, we have that</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <div class="my-4 text-center"><span class="math-block">R ^ {- 4} \\left(\\rho^ {v} \\left(c ^ {i}, c ^ {j}\\right)\\right) \\oplus R ^ {- 4} \\left(\\rho^ {v} \\left(c ^ {j}, c ^ {i}\\right)\\right) \\in D _ {K},</span></div>

    <p class="text-gray-300">N.G. Bardeh et al.</p>

    <p class="text-gray-300">!<a href="img-2.jpeg">img-2.jpeg</a> Fig. 3. 5-round truncated differential characteristic used in case 2</p>

    <p class="text-gray-300">!<a href="img-3.jpeg">img-3.jpeg</a> Fig. 4. 5-round truncated differential characteristic used in case 3</p>

    <p class="text-gray-300">and with probability  <span class="math">4 \\cdot 2^{-16}</span>  we have that</p>

    <div class="my-4 text-center"><span class="math-block">R ^ {- 4} \\left(\\rho^ {v} \\left(c ^ {i}, c ^ {j}\\right)\\right) \\oplus R ^ {- 4} \\left(\\rho^ {v} \\left(c ^ {j}, c ^ {i}\\right)\\right) \\in D _ {K} \\cap C _ {L}</span></div>

    <p class="text-gray-300">so  <span class="math">R^{-5}(\\rho^v (c^i,c^j))\\oplus R^{-5}(\\rho^v (c^j,c^i))</span>  is zero in a diagonal with probability  <span class="math">6\\cdot 2^{-16}\\cdot 4\\cdot 2^{-16}</span> . Figure 3 depicts the truncated differential characteristic used in this case.</p>

    <p class="text-gray-300">Third case. There is also a case that  <span class="math">R(p^i) \\oplus R(p^j)</span>  is zero in all bytes except three bytes, which happens with probability  <span class="math">4 \\cdot 2^{-8}</span> . It means that</p>

    <div class="my-4 text-center"><span class="math-block">R (p ^ {i}) \\oplus R (p ^ {j}) \\in D _ {K} \\cap C _ {0}</span></div>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">where  $</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">K</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">= 3$ . Thus, this pair follows the 4-round property</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <div class="my-4 text-center"><span class="math-block">R ^ {- 4} \\left(\\rho^ {v} \\left(c ^ {i}, c ^ {j}\\right)\\right) \\oplus R ^ {- 4} \\left(\\rho^ {v} \\left(c ^ {j}, c ^ {i}\\right)\\right) \\in D _ {K},</span></div>

    <p class="text-gray-300">and with probability  <span class="math">4 \\cdot 2^{-24}</span> , we also have that</p>

    <div class="my-4 text-center"><span class="math-block">R ^ {- 4} \\left(\\rho^ {v} \\left(c ^ {i}, c ^ {j}\\right)\\right) \\oplus R ^ {- 4} \\left(\\rho^ {v} \\left(c ^ {j}, c ^ {i}\\right)\\right) \\in D _ {K} \\cap C _ {L}.</span></div>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Then after one more round of decryption, it follows that  <span class="math">p^{\\prime i} \\oplus p^{\\prime j} \\in \\mathcal{D}_L</span>  where  $</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">L</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">= 3<span class="math"> . In total, we expect this event happens with probability  </span>4 \\cdot 2^{-8} \\cdot 4 \\cdot 2^{-24}$ . In Figure 4, the truncated differential characteristic used in this case is depicted.</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">In total, the probability that there is a plaintext pair such that  <span class="math">p^{\\prime i} \\oplus p^{\\prime j} \\in C_L</span>  is  <span class="math">16 \\cdot 2^{-24} \\cdot 2^{-8} + 24 \\cdot 2^{-16} \\cdot 2^{-16} + 16 \\cdot 2^{-8} \\cdot 2^{-24} = 2^{-26.19}</span> . In order to set up</p>

    <p class="text-gray-300">Practical Attacks on Reduced-Round AES</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">a distinguisher, we encrypt  <span class="math">2^{12.2}</span>  plaintexts from a coset of  <span class="math">D_0</span> . We generate all  <span class="math">2^{23.4}</span>  possible ciphertext pairs and for each pair we generate all 7 possible new ciphertext pairs by swapping words between them. Then we decrypt all  <span class="math">7 \\cdot 2^{23.4}</span>  ciphertext pairs and expect that there is at least one plaintext pair such that  <span class="math">p&#x27;^0 \\oplus p&#x27;^1 \\in D_L</span>  with  $</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">L</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">= 3<span class="math"> . At random, the probability that two plaintexts belong to the same coset of  </span>D_L<span class="math">  is  </span>2^{-30}<span class="math"> . For AES, the probability of having a plaintext pair with our desired difference pattern is  </span>1 - (1 - 2^{-26.2})^{2^{26.2}} = 0.63<span class="math">  after decrypting  </span>2^{26.2}<span class="math">  ciphertext pairs, while for a random permutation, this probability is  </span>1 - (1 - 2^{-30})^{2^{26.2}} = 0.07<span class="math"> . Thus, the probability of success is 0.58. So, we can distinguish 5-round AES from a random permutation using  </span>2^{12.2}<span class="math">  chosen plaintext and  </span>2 \\cdot 2^{26.2} = 2^{27.2}$  adaptively chosen ciphertext. The algorithm for this distinguisher is presented in Algorithm 1.</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">The data complexity of this distinguisher is in the same range as the data complexity of the best 5-round adaptive distinguisher presented in [14]. Both distinguishers extend on the 4-round distinguisher mentioned in Section 2.3 to a 5-round distinguisher by adding a round at the beginning. In the distinguisher presented in [14], the aim is to find plaintext pairs such that all of them have a certain property (a certain zero-byte set). To achieve this, attacker needs to generate new pairs of plaintexts and ciphertexts adaptively from the original pairs. To set up our distinguisher, we just need to generate new ciphertext pairs adaptively. Our distinguisher exploits another structural properties over 5-round.</p>

    <p class="text-gray-300">Algorithm 1: 5-round key-independent distinguisher Input: Set  <span class="math">\\mathcal{P}</span>  contains  <span class="math">2^{12.2}</span>  plaintext  <span class="math">p^i</span>  where bytes in first diagonal takes a random values and others are constant Output: 1 for an AES, -1 otherwise. for  <span class="math">i</span>  from 0 to  <span class="math">2^{12.2}</span>  do <span class="math">c^i \\gets \\text{enc}_k(p^i)</span> end for  <span class="math">i</span>  from 0 to  <span class="math">2^{12.2}</span>  do for  <span class="math">j</span>  from  <span class="math">i + 1</span>  to  <span class="math">2^{12.2} - 1</span>  do for  <span class="math">r</span>  from 1 to 7 do <span class="math">c&#x27;^i \\gets \\rho^{v_r}(c^i, c^j)</span> ,  <span class="math">c&#x27;^j \\gets \\rho^{v_r}(c^j, c^i)</span> ,  <span class="math">p&#x27;^i \\gets \\text{dec}_k(c&#x27;^i)</span> ,  <span class="math">p&#x27;^j \\gets \\text{dec}_k(c&#x27;^j)</span></p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">if  <span class="math">p&#x27;^i \\oplus p&#x27;^j \\in D_L</span>  where  $</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">L</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">= 3$  then</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">return 1 end end end</p>

    <p class="text-gray-300">4 Key recovery attack on 5-round AES with a single secret s-box</p>

    <p class="text-gray-300">In this section we present a new key-recovery attack on 5-round AES with a secret s-box. The idea is to turn the 4-round distinguisher mentioned in section 2.3 to a key recovery attack by adding a round at beginning using a property of the MixColumn operation in AES. The MixColumns matrix <span class="math">M</span> in AES is defined by</p>

    <p class="text-gray-300">\\[ M=\\left[\\begin{array}[]{cccccc}\\alpha&\\alpha+1&1&1\\\\ 1&\\alpha&\\alpha+1&1\\\\ 1&1&\\alpha&\\alpha+1\\\\ \\alpha+1&1&1&1\\end{array}\\right]. \\]</p>

    <p class="text-gray-300">We pick two pairs of plaintexts <span class="math">p^{0}</span> and <span class="math">p^{1}</span> where the first diagonal is given by <span class="math">SR^{-1}(p^{0}_{0})=SR^{-1}(0,i,j,0)</span> and <span class="math">SR^{-1}(p^{1}_{0})=SR^{-1}(z,z+i,z+j,0)</span> and where <span class="math">z</span> is a random non-zero element of <span class="math">\\mathbb{F}_{2^{8}}</span>. Let <span class="math">k_{0}=(k_{0,0},k_{1,1},k_{2,2},k_{3,3})</span> denote the key-bytes XORed with the first diagonal of the plaintext. Then the difference between the first column after one encryption of the two plaintexts becomes</p>

    <p class="text-gray-300"><span class="math">\\alpha\\Delta x_{0}\\oplus(\\alpha+1)\\Delta x_{1}\\oplus\\Delta x_{2}=</span> <span class="math">y_{0}</span> <span class="math">\\Delta x_{0}\\oplus\\alpha\\Delta x_{1}\\oplus(\\alpha+1)\\Delta x_{2}=</span> <span class="math">y_{1}</span> <span class="math">\\Delta x_{0}\\oplus\\Delta x_{1}\\oplus\\alpha\\Delta x_{2}=</span> <span class="math">y_{2}</span> <span class="math">(\\alpha+1)\\Delta x_{0}\\oplus\\Delta x_{1}\\oplus\\Delta x_{2}=</span> <span class="math">y_{3}.</span></p>

    <p class="text-gray-300">where <span class="math">\\Delta x_{0}=s(k_{0,0})\\oplus s(z\\oplus k_{0,0})</span>, <span class="math">\\Delta x_{1}=s(k_{1,1}\\oplus z\\oplus i)\\oplus s(k_{1,1}\\oplus i)</span>, <span class="math">\\Delta x_{2}=s(k_{2,2}\\oplus z\\oplus j)\\oplus s(k_{2,2}\\oplus j)</span> and where <span class="math">s(x)</span> is the AES-sbox. Since the plaintexts are equal in the last byte, this part cancels out in the difference. In particular, if we look at the first two equations, it is not hard to see that they are zero when <span class="math">\\Delta x_{0}=\\Delta x_{1}=\\Delta x_{2}</span>,</p>

    <p class="text-gray-300"><span class="math">s(k_{0,0})\\oplus s(z\\oplus k_{0,0})=s(k_{1,1}\\oplus z\\oplus i)\\oplus s(k_{1,1}\\oplus i)=s(k_{2,2}\\oplus z\\oplus j)\\oplus s(k_{2,2}\\oplus j)</span></p>

    <p class="text-gray-300">This happens when <span class="math">i\\in\\{k_{0,0}\\oplus k_{1,1},z\\oplus k_{0,0}\\oplus k_{1,1}\\}</span> and <span class="math">j\\in\\{k_{0,0}\\oplus k_{2,2},z\\oplus k_{0,0}\\oplus k_{2,2}\\}</span>. Thus, if we let <span class="math">i</span> and <span class="math">j</span> run through all values of <span class="math">\\mathbb{F}_{2^{8}}</span>, we are guaranteed that there are at least four values for which the first two equations are zero.</p>

    <p class="text-gray-300">We prepare a set <span class="math">\\mathcal{P}</span> of plaintext pairs as follows. For each <span class="math">i</span> and <span class="math">j</span>, we generate a pair of plaintexts <span class="math">p^{0}</span> and <span class="math">p^{1}</span> where the first diagonal of <span class="math">p^{0}</span> is <span class="math">SR^{-1}(p^{0}_{0})=SR^{-1}(0,i,j,0)</span> while the first diagonal in the second text is <span class="math">SR^{-1}(p^{1}_{0})=SR^{-1}(z,z\\oplus i,z\\oplus j,0)</span>. We then encrypt this pair five rounds to a pair of ciphertexts <span class="math">c^{0}</span> and <span class="math">c^{1}</span>. We then pick all 7 new ciphertext pairs <span class="math">c^{\\prime 0},c^{\\prime 1}=(\\rho^{v}(c^{0},c^{1}),\\rho^{v}(c^{1},c^{0}))</span> and return the corresponding plaintexts <span class="math">p^{\\prime 0}</span> and <span class="math">p^{\\prime 1}</span>. Now we know that there are 28 pairs in the set such that</p>

    <p class="text-gray-300"><span class="math">R^{-4}(\\rho^{v}(c^{0},c^{1}))\\oplus R^{-4}(\\rho^{v}(c^{1},c^{0}))\\in D_{K}</span></p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">where $</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">K</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">=2<span class="math">, since for each of the pair satisfy </span>R(p^{0})\\oplus R(p^{1})\\in D_{K}<span class="math">. Thus, according to Lemma 2, with probability </span>4\\cdot 2^{-16}$ we have that</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300"><span class="math">R^{-4}(\\rho^{v}(c^{0},c^{1}))\\oplus R^{-4}(\\rho^{v}(c^{1},c^{0}))\\in D_{K}\\cap C_{L}</span></p>

    <p class="text-gray-300">Practical Attacks on Reduced-Round AES</p>

    <p class="text-gray-300">!<a href="img-4.jpeg">img-4.jpeg</a> Fig. 5. 5-round truncated differential characteristic used in key recovery attack AES</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">where  $</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">L</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">= 3<span class="math"> . This means that  </span>p'^0 \\oplus p'^1 \\in D_L<span class="math"> . Thus, for this pair, we can deduce the values of  </span>i<span class="math">  and  </span>j<span class="math">  which corresponds to  </span>k_{0,0} \\oplus k_{1,1}<span class="math">  ( </span>z \\oplus k_{0,0} \\oplus k_{1,1}<span class="math"> ) and  </span>k_{0,0} \\oplus k_{2,2}<span class="math">  ( </span>z \\oplus k_{0,0} \\oplus k_{2,2}<span class="math"> ) respectively. The truncated differential characteristic used in the attack is depicted in Figure 5. Since there are 28 right pairs in the set  </span>\\mathcal{P}<span class="math"> , the probability that there is a new plaintext pair such that  </span>p'^0 \\oplus p'^1 \\in C_L<span class="math">  is  </span>1 - (1 - 2^{-14})^{28} = 2^{-9.19}<span class="math"> . Then we need to encrypt  </span>2^{9.19}<span class="math">  sets  </span>\\mathcal{P}<span class="math">  (by picking different constants for the last three diagonals). Thus, to find two bytes of the key, the attacker needs  </span>2 \\cdot 2^{9.19} \\cdot 2^{16} = 2^{26.19}<span class="math">  chosen plaintexts and  </span>2 \\cdot 7 \\cdot 2^{9.19} \\cdot 2^{16} = 2^{29}<span class="math">  adaptively chosen ciphertexts. Then the attacker can repeat the attack for other diagonals (two times for each diagonal) and guess one byte of the key for each diagonal. In total the attacker needs  </span>2^{29.19}<span class="math">  chosen plaintexts and  </span>2^{32}<span class="math">  adaptively chosen ciphertexts to form an attack with success rate of 0.63. The algorithm for this key recovery attack is presented in Algorithm 2. The key-recovery attacks on 5-round AES with a secret s-box presented in [10] are based on impossible and multiple-  </span>n<span class="math">  cryptanalysis, while our attack is based on zero-difference cryptanalysis. Since our attack exploits a probability one 4-round property, it requires less texts than others which exploit probabilistic 4-round properties. Also, the best 5-round key recovery attacks in adaptive setting [14] and non-adaptive setting [1] require  </span>2^{11.3}<span class="math">  adaptively chosen ciphertexts and  </span>2^{22}<span class="math">  chosen plaintext respectively (with a known s-box), so compared to our attack, and despite the increased size of the secret information, the required data is increased, at most, by a factor of  </span>2^{21}$ .</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">In this paper we have introduced a new 5-round key-independent distinguisher which requires  <span class="math">2^{12.2}</span>  chosen plaintexts and  <span class="math">2^{27.2}</span>  adaptively chosen ciphertexts. In addition, we present a new key recovery attack against 5-round AES with a secret s-box based on zero-difference cryptanalysis. The attack requires  <span class="math">2^{29.19}</span>  chosen plaintexts and  <span class="math">2^{32}</span>  adaptively chosen ciphertexts. Both attacks mentioned in this paper are practical and have been verified experimentally on a standard laptop.</p>

    <p class="text-gray-300">N.G. Bardeh et al.</p>

    <p class="text-gray-300">|  Algorithm 2: Key recovery attack on 5-round AES with a single secret s-box  |   |</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">---</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">---</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">|  Input: 29.12 different sets P where each contains 216 plaintext pairs  |   |</p>

    <p class="text-gray-300">|  Output: Candidates for k0,0 ⊕ k1,1 (1 ⊕ k0,0 ⊕ k1,1) and k0,0 ⊕ k2,2 (1 ⊕ k0,0 ⊕ k2,2)  |   |</p>

    <p class="text-gray-300">|  for c from 0 to 29.12 do  |   |</p>

    <p class="text-gray-300">|  for i from 0 to 28 do  |   |</p>

    <p class="text-gray-300">|  for j from 0 to 28 do  |   |</p>

    <p class="text-gray-300">|  p06← (0,i,j,0), p01← (1,1 ⊕ i,1 ⊕ j,0)  |   |</p>

    <p class="text-gray-300">|  p10= p11= Random-value for l = 1,2,3  |   |</p>

    <p class="text-gray-300">|  c0← enck(p0), c1← enck(p1)  |   |</p>

    <p class="text-gray-300">|  for r from 1 to 7 do  |   |</p>

    <p class="text-gray-300">|  c'0← ρvr(c0, c1), c'1← ρvr(c1, c0)  |   |</p>

    <p class="text-gray-300">|  p'0← deck(c'0), p'1← deck(c'1)  |   |</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">if p'0 ⊕ p'1 ∈ DL where</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">L</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">= 3 then (i,j) is a candidate for two bytes of key. end</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">|  end  |   |</p>

    <p class="text-gray-300">|  end  |   |</p>

    <p class="text-gray-300">|  end  |   |</p>

    <p class="text-gray-300">We thank the anonymous reviewers for their valuable comments and suggestions. This Research was supported by the Norwegian Research Council.</p>

    <ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">

      <li>Bar-On, A., Dunkelman, O., Keller, N., Ronen, E., Shamir, A.: Improved key recovery attacks on reduced-round AES with practical data and memory complexities. In: Advances in Cryptology - CRYPTO 2018 - 38th Annual International Cryptology Conference, Santa Barbara, CA, USA, August 19-23, 2018, Proceedings, Part II. pp. 185-212 (2018). https://doi.org/10.1007/978-3-319-96881-0_7</li>

      <li>Biryukov, A., Khovratovich, D.: Related-key cryptanalysis of the full AES-192 and AES-256. In: Advances in Cryptology - ASIACRPT 2009, 15th International Conference on the Theory and Application of Cryptology and Information Security, Tokyo, Japan, December 6-10, 2009. Proceedings. pp. 1-18 (2009). https://doi.org/10.1007/978-3-642-10366-7_1</li>

      <li>Biryukov, A., Khovratovich, D., Nikolic, I.: Distinguisher and related-key attack on the full AES-256. In: Advances in Cryptology - CRYPTO 2009, 29th Annual International Cryptology Conference, Santa Barbara, CA, USA, August 16-20, 2009. Proceedings. pp. 231-249 (2009). https://doi.org/10.1007/978-3-642-03356-8_14</li>

      <li>Bouillaguet, C., Derbez, P., Dunkelman, O., Fouque, P., Keller, N., Rijmen, V.: Low-data complexity attacks on AES. IEEE Trans. Information Theory 58(11), 7002-7017 (2012). https://doi.org/10.1109/TIT.2012.2207880</li>

    </ol>

    <p class="text-gray-300">Practical Attacks on Reduced-Round AES</p>

    <ul class="list-disc list-inside space-y-1 text-gray-300 my-2 ml-4">

      <li>[5] Daemen, J., Rijmen, V.: The block cipher rijndael. In: Smart Card Research and Applications, This International Conference, CARDIS ’98, Louvain-la-Neuve, Belgium, September 14-16, 1998, Proceedings. pp. 277–284 (1998). https://doi.org/10.1007/10721064_26</li>

      <li>[6] Derbez, P., Fouque, P., Jean, J.: Improved key recovery attacks on reduced-round AES in the single-key setting. In: Advances in Cryptology - EUROCRYPT 2013, 32nd Annual International Conference on the Theory and Applications of Cryptographic Techniques, Athens, Greece, May 26-30, 2013. Proceedings. pp. 371–387 (2013). https://doi.org/10.1007/978-3-642-38348-9_23</li>

      <li>[7] Dunkelman, O., Keller, N., Shamir, A.: Improved single-key attacks on 8-round AES-192 and AES-256. In: Advances in Cryptology - ASIACRYPT 2010 - 16th International Conference on the Theory and Application of Cryptology and Information Security, Singapore, December 5-9, 2010. Proceedings. pp. 158–176 (2010). https://doi.org/10.1007/978-3-642-17373-8_10</li>

      <li>[8] Ferguson, N., Kelsey, J., Lucks, S., Schneier, B., Stay, M., Wagner, D.A., Whiting, D.: Improved cryptanalysis of rijndael. In: Fast Software Encryption, 7th International Workshop, FSE 2000, New York, NY, USA, April 10-12, 2000, Proceedings. pp. 213–230 (2000). https://doi.org/10.1007/3-540-44706-7_15</li>

      <li>[9] Gilbert, H., Minier, M.: A collision attack on 7 rounds of rijndael. In: AES Candidate Conference. pp. 230–241 (2000)</li>

      <li>[10] Grassi, L.: Mixcolumns properties and attacks on (round-reduced) AES with a single secret s-box. In: Topics in Cryptology - CT-RSA 2018 - The Cryptographers’ Track at the RSA Conference 2018, San Francisco, CA, USA, April 16-20, 2018, Proceedings. pp. 243–263 (2018). https://doi.org/10.1007/978-3-319-76953-0_13</li>

      <li>[11] Grassi, L., Rechberger, C., Rønjom, S.: Subspace trail cryptanalysis and its applications to AES. IACR Trans. Symmetric Cryptol. 2016(2), 192–225 (2016). https://doi.org/10.13154/tosc.v2016.i2.192-225</li>

      <li>[12] Grassi, L., Rechberger, C., Rønjom, S.: A new structural-differential property of 5-round AES. In: Advances in Cryptology - EUROCRYPT 2017 - 36th Annual International Conference on the Theory and Applications of Cryptographic Techniques, Paris, France, April 30 - May 4, 2017, Proceedings, Part II. pp. 289–317 (2017). https://doi.org/10.1007/978-3-319-56614-6_10</li>

      <li>[13] Gueron, S., Mouha, N.: Simpira v2: A family of efficient permutations using the AES round function. In: Advances in Cryptology - ASIACRYPT 2016 - 22nd International Conference on the Theory and Application of Cryptology and Information Security, Hanoi, Vietnam, December 4-8, 2016, Proceedings, Part I. pp. 95–125 (2016). https://doi.org/10.1007/978-3-662-53887-6_4</li>

      <li>[14] Rønjom, S., Bardeh, N.G., Helleseth, T.: Yoyo tricks with AES. In: Advances in Cryptology - ASIACRYPT 2017 - 23rd International Conference on the Theory and Applications of Cryptology and Information Security, Hong Kong, China, December 3-7, 2017, Proceedings, Part I. pp. 217–243 (2017). https://doi.org/10.1007/978-3-319-70694-8_8</li>

      <li>[15] Sun, B., Liu, M., Guo, J., Qu, L., Rijmen, V.: New insights on aes-like SPN ciphers. In: Advances in Cryptology - CRYPTO 2016 - 36th Annual International Cryptology Conference, Santa Barbara, CA, USA, August 14-18, 2016, Proceedings, Part I. pp. 605–624 (2016). https://doi.org/10.1007/978-3-662-53018-4_22</li>

      <li>[16] Tiessen, T., Knudsen, L.R., Kölbl, S., Lauridsen, M.M.: Security of the AES with a secret s-box. In: Fast Software Encryption - 22nd International Workshop, FSE 2015, Istanbul, Turkey, March 8-11, 2015, Revised Selected Papers. pp. 175–189 (2015). https://doi.org/10.1007/978-3-662-48116-5_9</li>

    </ul>`;
---

<BaseLayout title="Practical Attacks on Reduced-Round AES (2019/770)">
  <article class="max-w-4xl mx-auto article-prose">
    <nav class="mb-8">
      <a href="/papers" class="text-blue-400 hover:text-blue-300">
        &larr; Back to Papers
      </a>
    </nav>

    <header class="mb-12">
      <h1 class="text-3xl font-bold mb-4"
        set:html={TITLE_HTML} />
      <p class="text-gray-400 mb-2"
        set:html={AUTHORS_HTML} />
      <p class="text-gray-500 text-sm mb-4">
        2019 &middot; eprint 2019/770
      </p>
      <div class="flex gap-4 text-sm">
        <a
          href={EPRINT_URL}
          target="_blank"
          rel="noopener noreferrer"
          class="text-blue-400 hover:text-blue-300"
        >
          Paper (eprint) &rarr;
        </a>
      </div>
      <p class="mt-4 text-xs text-gray-500">
        All content below belongs to the original authors. This page
        reproduces the paper for educational purposes. Always
        <a
          href={EPRINT_URL}
          target="_blank"
          rel="noopener noreferrer"
          class="text-blue-400 hover:text-blue-300"
        >cite the original</a>.
      </p>
      <p class="mt-1 text-xs text-gray-600">
        Converted with: {CRAWLER} &middot; {CONVERTED_DATE}
      </p>
    </header>

    <Fragment set:html={CONTENT} />

  </article>
</BaseLayout>
