---
import BaseLayout from '../../layouts/BaseLayout.astro';

const EPRINT_URL = 'https://eprint.iacr.org/2021/267';
const CRAWLER = 'mistral';
const CONVERTED_DATE = '2026-02-16';
const TITLE_HTML = 'Ciminion: Symmetric Encryption Based on Toffoli-Gates over Large Finite Fields';
const AUTHORS_HTML = 'Christoph Dobraunig, Lorenzo Grassi, Anna Guinet, Daniël Kuijsters';

const CONTENT = `    <p class="text-gray-300">Christoph Dobraunig^{1,2} Lorenzo Grassi^{3} Anna Guinet^{3} Daniël Kuijsters^{3}</p>

    <h6 id="sec-2" class="text-base font-medium mt-4">Abstract</h6>

    <p class="text-gray-300">Motivated by new applications such as secure Multi-Party Computation (MPC), Fully Homomorphic Encryption (FHE), and Zero-Knowledge proofs (ZK), the need for symmetric encryption schemes that minimize the number of field multiplications in their natural algorithmic description is apparent. This development has brought forward many dedicated symmetric encryption schemes that minimize the number of multiplications in <span class="math">\\mathbb{F}_{2^{n}}</span> or <span class="math">\\mathbb{F}_{p}</span>, with <span class="math">p</span> being prime. These novel schemes have lead to new cryptanalytic insights that have broken many of said schemes. Interestingly, to the best of our knowledge, all of the newly proposed schemes that minimize the number of multiplications use those multiplications exclusively in S-boxes based on a power mapping that is typically <span class="math">x^{3}</span> or <span class="math">x^{-1}</span>. Furthermore, most of those schemes rely on complex and resource-intensive linear layers to achieve a low multiplication count. In this paper, we present Ciminion, an encryption scheme minimizing the number of field multiplications in large binary or prime fields, while using a very lightweight linear layer. In contrast to other schemes that aim to minimize field multiplications in <span class="math">\\mathbb{F}_{2^{n}}</span> or <span class="math">\\mathbb{F}_{p}</span>, Ciminion relies on the Toffoli gate to improve the non-linear diffusion of the overall design. In addition, we have tailored the primitive for the use in a Farfalle-like construction in order to minimize the number of rounds of the used primitive, and hence, the number of field multiplications as far as possible.</p>

    <h6 id="sec-3" class="text-base font-medium mt-4">Keywords:</h6>

    <p class="text-gray-300">Symmetric Encryption Low Multiplicative Complexity</p>

    <h2 id="sec-4" class="text-2xl font-bold">1 Introduction</h2>

    <p class="text-gray-300">Recently, several symmetric schemes have been proposed to reduce the number of field multiplications in their natural algorithmic description, often referred to as the multiplicative complexity. These ciphers fall into two main categories. The first one contains ciphers that minimize the use of multiplications in <span class="math">\\mathbb{F}_{2}</span>, for instance, Flip <em>[53]</em>, Keyvrium <em>[22]</em>, LowMC <em>[4]</em>, and Rasta <em>[33]</em>. The second category is comprised of ciphers having a natural description in larger fields, which are mostly binary fields <span class="math">\\mathbb{F}_{2^{n}}</span> and prime fields <span class="math">\\mathbb{F}_{p}</span>. Examples include MiMC <em>[3]</em>, GMiMC <em>[2]</em>, Jarvis <em>[8]</em>, Hades <em>[40]</em>, Poseidon <em>[39]</em> and Vision and Rescue <em>[6]</em>. The design of</p>

    <p class="text-gray-300">low multiplicative complexity ciphers is motivated by applications such as secure Multi-Party Computation (MPC), Fully Homomorphic Encryption (FHE), and Zero-Knowledge proofs (ZK). These recent ciphers based on specialized designs highly outperform “traditionally” designed ones in these applications. The search of minimizing the multiplicative complexity while providing a sufficient security level is an opportunity to explore and evaluate innovative design strategies.</p>

    <p class="text-gray-300">The sheer number of potentially devastating attacks on recently published designs implies that the design of schemes with low multiplicative complexity has not reached a mature state yet. Indeed, we count numerous attacks on variants of LowMC <em>[32, 58]</em>, Flip <em>[34]</em>, MiMC <em>[35]</em>, GMiMC <em>[15, 19]</em>, Jarvis <em>[1]</em>, and Starkad/Poseidon <em>[15]</em>. Attacks that are performed on schemes defined for larger fields mostly exploit weaknesses of the algebraic cipher description, e.g., Gröbner bases attacks on Jarvis <em>[1]</em> or higher-order differential attacks on MiMC <em>[35]</em>. Nonetheless, attack vectors such as differential cryptanalysis <em>[17]</em> and linear cryptanalysis <em>[51]</em> do not appear to threaten the security of these designs. Indeed, the latter two techniques seem to be able to attack only a tiny fraction of the rounds compared to algebraic attacks.</p>

    <p class="text-gray-300">Interestingly, the mentioned ciphers working over larger fields are inspired by design strategies proposed in the 1990s to mitigate differential cryptanalysis. For example, MiMC resembles the Knudsen-Nyberg cipher <em>[55]</em>, Jarvis claims to be inspired by the design of Rijndael <em>[27, 28]</em>, while Hades, Vision, and Rescue take inspiration from Shark <em>[59]</em>. The latter ciphers have a linear layer that consists of the application of a single MDS matrix to the state. An important commonality between all those examples is a non-linear layer that operates on individual field elements, e.g., cubing single field elements or computing their inverse. Furthermore, design strategies naturally working over larger fields easily prevent differential cryptanalysis. However, algebraic attacks seem to be their main threat. Therefore, it is worth exploring different design strategies to increase the resistance against algebraic attacks.</p>

    <p class="text-gray-300">Our Design: Ciminion. In that spirit, Ciminion offers a different design approach in which we do not apply non-linear transformations to individual field elements. Instead, we use the ability of the multiplication to provide non-linear diffusion between field elements. Our cipher is built upon the Toffoli gate <em>[61]</em>, which is a simple non-linear bijection of field elements that transforms the triple <span class="math">(a,b,c)</span> into the triple <span class="math">(a,b,ab+c)</span>. The binary version of the Toffoli gate is used as a building block in modern ciphers, such as FRIET <em>[60]</em>, which inspired our design. In addition to this, the S-box of Xoodoo <em>[26]</em> can also be described as the consecutive application of three binary Toffoli gates. With respect to the linear layer, we learned from ciphers like LowMC <em>[4]</em> that very heavy linear layers can have a considerably negative impact on the performance of applications <em>[31]</em>. Therefore, we decide to pair the Toffoli gate with a relatively lightweight linear layer to construct a cryptographic permutation on triples of field elements. Compared to the designs that use a non-linear bijection of a single field element, e.g., cubing in <span class="math">\\mathbb{F}_{2^{n}}</span> for odd <span class="math">n</span>, we can define our permutation on any field, and then provide a thorough security analysis for prime fields and binary fields.</p>

    <p class="text-gray-300">!<a href="img-0.jpeg">img-0.jpeg</a> (a) Farfalle Construction</p>

    <p class="text-gray-300">!<a href="img-1.jpeg">img-1.jpeg</a> (b) A Hades-like scheme. Fig. 1: Comparison of a Farfalle construction and a Hades-like scheme.</p>

    <p class="text-gray-300">We do not use a bare primitive in the applications, but we employ primitives in a mode of operation. Indeed, instead of constructing a primitive of low multiplicative complexity, our goal is to provide a cryptographic function of low multiplicative complexity. We achieve this by using a modified version of the Farfalle construction to make it possible to perform stream encryption. Farfalle [12] is an efficiently parallelizable permutation-based construction with a variable input and output length pseudorandom function (PRF). It is built upon a primitive, and modes are employed on top of it. The primitive is a PRF that takes as input a key with a string (or a sequence of strings), and produces an arbitrary-length output. The Farfalle construction involves two basic ingredients: a set of permutations of a  <span class="math">b</span> -bit state, and the so-called rolling function that is used to derive distinct  <span class="math">b</span> -bit mask values from a  <span class="math">b</span> -bit secret key, or to evolve the secret state. The Farfalle construction consists of a compression layer that is followed by an expansion layer. The compression layer produces a single  <span class="math">b</span> -bit accumulator value from a tuple of  <span class="math">b</span> -bit blocks representing the input data. The expansion layer first (non-linearly) transforms the accumulator value into a  <span class="math">b</span> -bit rolling state. Then, it (non-linearly) transforms a tuple of variants of this rolling state which are produced by iterating the rolling function, into a tuple of (truncated)  <span class="math">b</span> -bit output blocks. Both the compression and expansion layers involve  <span class="math">b</span> -bit mask values derived from the master key.</p>

    <p class="text-gray-300">We slightly modify Farfalle (see Fig. 3) and instantiate it with two different permutations:  <span class="math">p_C</span>  for the compression part, and  <span class="math">p_E</span>  for the expansion part. Those two permutations are obtained by iterating the same round function, but with a different number of rounds. In our construction, the permutation  <span class="math">p_C</span>  takes an input that is the concatenation of a nonce  <span class="math">\\aleph</span>  and a secret key, and it derives a secret intermediate state from this input. Then, the intermediate state is updated by using a simple rolling function, and fixed intermediate keys. From this intermediate state, the keystream for encrypting the plaintext is derived by using the permutation  <span class="math">p_E</span> . In order to prevent backward computation, the outputs of the expansion layers are truncated. Our security analysis that is</p>

    <p class="text-gray-300">!<a href="img-2.jpeg">img-2.jpeg</a> Fig. 2: Number of MPC multiplications of several designs over  <span class="math">(\\mathbb{F}_p)^t</span> , with  <span class="math">p \\approx 2^{128}</span>  and  <span class="math">t \\geq 2</span>  (security level of 128 bits).</p>

    <p class="text-gray-300">presented in Sect. 4 shows that  <span class="math">p_E</span>  requires a significantly lower number of rounds than  <span class="math">p_C</span> . The relatively low number of multiplications that is used per encrypted plaintext element leads to a remarkably overall low multiplicative complexity. The full specification for CIMINION is presented in Sect. 2. A detailed rationale of the choices made during the design process is given in Sect. 3. A reference implementation can be found at https://github.com/ongetekend/ciminion.</p>

    <p class="text-gray-300">A Concrete Use Case: Multi-Party Computation. The primary motivation of our design is to explore the limits on the use of non-linear operations in cipher design, while limiting the use of linear operations, and ensuring a secure design. The main body of our paper is thus dedicated to cryptanalysis which is accompanied by one specific use-case, namely Secure Multi-Party Computation.</p>

    <p class="text-gray-300">MPC is a subfield of cryptography that aims to create methods for parties to jointly compute a function over their inputs, without exposing these inputs. In recent years, MPC protocols have converged to a linearly homomorphic secret sharing scheme, whereby each participant is given a share of each secret value. Then, each participant locally adds shares of different secrets to generate the shares of the sum of the secrets. In order to get data securely in and out of a secret-sharing-based MPC system, an efficient solution is to directly evaluate a symmetric primitive within such system. In this setting, "traditional" PRFs based on, e.g., AES or SHA-3 are not efficient. Indeed, they were designed with different computing environments in mind. Hence, they work over data types that do not easily match the possible operations in the MPC application. As developed in [42], "traditional" PRFs like AES and SHA-3 are rather bit/byte/word-oriented schemes, which complicate their representation using arithmetic in  <span class="math">\\mathbb{F}_p</span>  or/and  <span class="math">\\mathbb{F}_{2^n}</span>  for large integer  <span class="math">n</span> , or prime  <span class="math">p</span> .</p>

    <p class="text-gray-300">From a theoretical point of view, the problem of secure MPC is strongly connected to the problem of masking a cryptographic implementation. This</p>

    <p class="text-gray-300">observation has been made in <em>[44, 45]</em>. The intuition behind is that both masking and MPC aim to perform computations on shared data. In more detail, the common strategy behind these techniques is to combine random and unknown masks with a shared secret value, and to perform operations on these masked values. Only at the end of the computation, the values are unmasked by combining them, in a manner that is defined by the masking scheme. In our scheme, we use a linear sharing scheme, because affine operations (e.g., additions, or multiplications with a constant) are non-interactive and resource efficient, unlike the multiplications that require some communication between the parties. The number of multiplications required to perform a computation is a good estimate of the complexity of an MPC protocol.</p>

    <p class="text-gray-300">However, in practice, other factors influence the efficiency of a design. For instance, while one multiplication requires one round of communication, a batch of multiplications can be processed into a single round in many cases. In that regard, Ciminion makes it possible to batch several multiplications due to the parallel execution of <span class="math">p_{E}</span>. Another alternative to speed up the processing of messages is to execute some communication rounds in an offline/pre-computation phase before receiving the input to the computation. This offline phase is cheaper than the online rounds. For example, in the case of Ciminion, precomputing several intermediate states is possible by applying <span class="math">p_{C}</span> to different nonces <span class="math">\\aleph</span>. As a result, for the encryption of arriving messages, those intermediate states only have to be expanded, and processed by <span class="math">p_{E}</span> to encrypt the plaintext.</p>

    <p class="text-gray-300">Sect. 5 demonstrates that our design Ciminion has a lower number of multiplications compared to several other schemes working over larger fields. The comparison of the number of multiplications in MPC applications to the ciphers that are presented in the literature, is shown in Fig. 2, when working over a field <span class="math">(\\mathbb{F}_{p})^{t}</span> with <span class="math">p\\approx 2^{128}</span> and <span class="math">t\\geq 1</span>, and with a security level of <span class="math">128</span> bits (which the most common case in the literature). It indicates that our design needs approximately <span class="math">t+14\\cdot\\lceil t/2\\rceil\\approx 8\\cdot t</span> multiplications compared to <span class="math">12\\cdot t</span> multiplications that are required by HadesMiMC, or <span class="math">60\\cdot t</span> multiplications that is needed by Rescue. These two schemes that have recently been proposed in the literature are our main competitors. Additionally, our design employs a low number of linear operations when compared with other designs present in the literature. Indeed, Ciminion grows linearly w.r.t. <span class="math">t</span>, whereas the number of linear operations grows quadratically in HadesMiMC and Rescue. That is because their rounds are instantiated via the multiplication with a <span class="math">t\\times t</span> MDS matrix. Even if the cost of a linear operation is considerably lower than the cost of a non-linear one in MPC applications, it is desirable to keep both numbers as low as possible. Our design has this advantage.</p>

    <h2 id="sec-5" class="text-2xl font-bold">2 Specification</h2>

    <h3 id="sec-6" class="text-xl font-semibold mt-8">2.1 Mode</h3>

    <p class="text-gray-300">In order to create a nonce-based stream-encryption scheme, we propose to work with the mode of operation described in Fig. 3. First, the scheme takes a nonce <span class="math">\\aleph</span></p>

    <p class="text-gray-300">!<a href="img-3.jpeg">img-3.jpeg</a> Fig. 3: Encryption with CIMINION over  <span class="math">\\mathbb{F}_{2^n}</span> . The construction is similar over  <span class="math">\\mathbb{F}_p</span>  ( <span class="math">\\oplus</span>  is replaced by  <span class="math">+</span> , the addition modulo  <span class="math">p</span> ).</p>

    <p class="text-gray-300">along with two subkey elements  <span class="math">K_{1}</span>  and  <span class="math">K_{2}</span>  as input, and processes these input with a permutation  <span class="math">p_{C}</span>  to output an intermediate state. This intermediate state is then processed by a permutation  <span class="math">p_{E}</span> , and truncated to two elements so that two plaintext elements  <span class="math">P_{1}</span>  and  <span class="math">P_{2}</span>  can be encrypted. If more elements need to be encrypted, the intermediate state can be expanded by repeatedly performing an addition of two subkey elements to the intermediate state, then followed by a call to the rolling function rol. After each call to the rolling function rol, two more plaintext elements  <span class="math">P_{2i}</span>  and  <span class="math">P_{2i+1}</span>  can be encrypted thanks to the application of  <span class="math">p_{E}</span>  to the resulting state. We consider the field elements as atomic, and therefore, our mode can cope with a different number of elements without the need for padding. The algorithmic description of the mode of operation that is described in Fig. 3, is provided in App. I.</p>

    <p class="text-gray-300">We describe two permutations of the vector space  <span class="math">\\mathbb{F}_q^3</span> . They act on a state of triples  <span class="math">(a,b,c) \\in \\mathbb{F}_q^3</span> . The first permutation is defined for a prime number  <span class="math">q = p</span>  of  <span class="math">\\log_2(p) \\approx n</span>  bits, while the second permutation is specified for  <span class="math">q = 2^n</span> . Both permutations are the result of the repeated application of a round function. Their only difference is the number of repeated applications that we call rounds. As</p>

    <p class="text-gray-300">!<a href="img-4.jpeg">img-4.jpeg</a> Fig. 4: Round function  <span class="math">f_{i}</span> .</p>

    <p class="text-gray-300">!<a href="img-5.jpeg">img-5.jpeg</a> Fig.5: rol.</p>

    <p class="text-gray-300">!<a href="img-6.jpeg">img-6.jpeg</a> Fig. 6: Key generation.</p>

    <p class="text-gray-300">presented in Fig. 3, we employ two permutations  <span class="math">p_C</span>  and  <span class="math">p_E</span>  that have respectively  <span class="math">N</span>  and  <span class="math">R</span>  rounds.</p>

    <p class="text-gray-300">Round Function. We write  <span class="math">f_{i}</span>  for round  <span class="math">i</span> . It uses four round constants  <span class="math">RC_{\\ell}</span> , with  <span class="math">\\ell = i</span>  for  <span class="math">p_C</span> , and  <span class="math">\\ell = i + N - R</span>  for  <span class="math">p_E</span> . We assume that  <span class="math">RC_{4\\ell}^{\\prime} \\notin \\{0,1\\}</span> . For each  <span class="math">i \\geq 1</span> ,  <span class="math">f_{i}</span>  maps a state  <span class="math">(a_{i-1}, b_{i-1}, c_{i-1})</span>  at its input to the state  <span class="math">(a_i, b_i, c_i)</span>  at its output, where the relation between these two states is</p>

    <div class="my-4 text-center"><span class="math-block">\\left[ \\begin{array}{c} a _ {i} \\\\ b _ {i} \\\\ c _ {i} \\end{array} \\right] := \\left[ \\begin{array}{c c c} 0 &amp;amp; 0 &amp;amp; 1 \\\\ 1 &amp;amp; R C _ {4 \\ell} ^ {\\prime} &amp;amp; R C _ {4 \\ell} ^ {\\prime} \\\\ 0 &amp;amp; 1 &amp;amp; 1 \\end{array} \\right] \\cdot \\left[ \\begin{array}{c} a _ {i - 1} \\\\ b _ {i - 1} \\\\ c _ {i - 1} + a _ {i - 1} \\cdot b _ {i - 1} \\end{array} \\right] + \\left[ \\begin{array}{c} R C 3 _ {\\ell} \\\\ R C 1 _ {\\ell} \\\\ R C 2 _ {\\ell} \\end{array} \\right].</span></div>

    <p class="text-gray-300">Our rolling function  <span class="math">rol</span>  is a simple NLFSR as depicted in Fig. 5. The rolling function takes three field elements  <span class="math">\\iota_{a}</span> ,  <span class="math">\\iota_{b}</span> , and  <span class="math">\\iota_{c}</span>  at the input. It outputs three field elements:  <span class="math">\\omega_{a} := \\iota_{c} + \\iota_{a} \\cdot \\iota_{b}</span> ,  <span class="math">\\omega_{b} := \\iota_{a}</span> , and  <span class="math">\\omega_{c} := \\iota_{b}</span> . The latter variables form the input of the permutation  <span class="math">p_{E}</span>  in our Farfalle-like mode Fig. 3.</p>

    <p class="text-gray-300">SubKeys Generation. We derive the SubKey material  <span class="math">K_{i}</span>  from two master keys  <span class="math">MK_{1}</span> , and  <span class="math">MK_{2}</span> . As a result, the secret is shared in a compact manner, while the expanded key is usually stored on a device, and used when needed. To expand the key, we use the sponge construction [13] instantiated with the permuta</p>

    <p class="text-gray-300">Table 1: Proposed number of rounds based on  <span class="math">f</span> . The security level  <span class="math">s</span>  must satisfy  <span class="math">64 \\leq s \\leq \\log_2(q)</span> , and  <span class="math">q \\geq 2^{64}</span> , where  <span class="math">q</span>  is the number of elements in the field.</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Instance</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">pC</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">pE (two output words per block)</th>

          </tr>

        </thead>

        <tbody>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">Standard</td>

            <td class="px-3 py-2 border-b border-gray-700">s+6</td>

            <td class="px-3 py-2 border-b border-gray-700">max{ [s+37/12], 6}</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">Data limit 2s/2 elements</td>

            <td class="px-3 py-2 border-b border-gray-700">2(s+6)/3</td>

            <td class="px-3 py-2 border-b border-gray-700">max{ [s+37/12], 6}</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">Conservative</td>

            <td class="px-3 py-2 border-b border-gray-700">s+6</td>

            <td class="px-3 py-2 border-b border-gray-700">max{ ([3/2, s+37/12]), 9}</td>

          </tr>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">tion  <span class="math">p_C</span> . The value  <span class="math">IV_H</span>  can be made publicly available, and is typically set to one.</p>

    <p class="text-gray-300">Round Constants Generation. We generate the round constants  <span class="math">RC1_{\\ell}</span> ,  <span class="math">RC2_{\\ell}</span> ,  <span class="math">RC3_{\\ell}</span> , and  <span class="math">RC4_{\\ell}</span>  with Shake-256 [14, 54]. The detail is provided in App. A.</p>

    <p class="text-gray-300">In this paper, we assume throughout that the security level of  <span class="math">s</span>  bits satisfies the condition  <span class="math">64 \\leq s \\leq \\lfloor \\log_2(q) \\rfloor</span> . This implies that  <span class="math">q \\geq 2^{64}</span> .</p>

    <p class="text-gray-300">In Tab. 1, we define three sets of round numbers for each permutation in our encryption scheme:</p>

    <ul class="list-disc list-inside space-y-1 text-gray-300 my-2 ml-4">

      <li>The "standard" set guarantees  <span class="math">s</span>  bit of security; in the following sections, we present our security analysis that supports the chosen number of rounds for this case.</li>

      <li>For our MPC application, we propose a number of rounds if the data available to the attacker is limited to  <span class="math">2^{s/2}</span> ; our security analysis that supports the chosen number of rounds for this case is presented in App. F.</li>

      <li>Finally, we present a "conservative" number of rounds where we arbitrarily decided to increase the number of rounds by  <span class="math">50\\%</span>  of the standard instance.</li>

    </ul>

    <p class="text-gray-300">Since many cryptanalytic attacks become more difficult with an increased number of rounds, we encourage to study reduced-round variants of our design to facilitate third-party cryptanalysis, and to estimate the security margin. For this reason, it is possible to specify toy versions of our cipher, i.e., with  <span class="math">q &amp;lt; 2^{64}</span>  which aim at achieving, for example, only 32 bits of security.</p>

    <p class="text-gray-300">In order to provide encryption, our first design choice is to choose between a mode of operation that is built upon a block cipher or a cryptographic permutation. In either case, a datapath design is necessary. However, a block cipher requires an additional key schedule, unlike a cryptographic permutation. If a designer opts for a block cipher, the key schedule can be chosen to be either a non-linear, an</p>

    <p class="text-gray-300">!<a href="img-7.jpeg">img-7.jpeg</a> Fig. 7: Intermediate step in constructing Fig. 3</p>

    <p class="text-gray-300">affine, or a trivial transformation, where the round keys are equal to the master key apart from round constants. In this case, the designer has to be careful, because a poor key schedule leads to weaknesses and attacks [19]. Considering that the research in low multiplicative complexity ciphers is a relatively new research area, we decided to limit our focus to the essential components of a primitive. Therefore, we opted for permutation-based cryptography.</p>

    <p class="text-gray-300">Since we consider the application of low multiplicative ciphers in areas that have enough resources to profit from parallel processing, we base our mode of operation on the Farfalle construction [12] as depicted in Fig. 1a. The Farfalle construction is a highly versatile construction that provides many functionalities. A Modified Version of Farfalle. As already mentioned in the introduction, our mode of operation resembles the Farfalle construction. In this section, we explain and support the modifications that we performed on the original Farfalle construction, as depicted in Fig. 1a. The aim of those modifications is to both increase the resistance of the construction against algebraic attacks which are the most competitive ones in our scenario, and to increase its efficiency in our target application scenario, that is to say to minimize the number of multiplications. We focus first on the security aspect, before explaining in further detail how we reach our efficiency goal.</p>

    <p class="text-gray-300">Our first modification is for simplicity. Since the functionality provided by the Farfalle construction to compress information is not needed, we merge  <span class="math">p_c</span>  and  <span class="math">p_d</span>  to a single permutation  <span class="math">p_C</span> .</p>

    <p class="text-gray-300">Our second modification is to truncate the output. This prevents meet-in-the-middle style attacks that require the knowledge of the full output.</p>

    <p class="text-gray-300">The third modification is to manipulate different keys  <span class="math">K_{i}</span>  (see Fig. 7) instead of employing the same key  <span class="math">k&#x27;</span>  for each output block. Since we aim to have a permutation with a low degree, Gröbner bases are the main threat. For the scheme that is depicted in Fig. 7, an attacker has to exploit equations of the form  <span class="math">f(x) + K_{i} = y</span>  and  <span class="math">f(x&#x27;) + K_{i} = y&#x27;</span> , with  <span class="math">f(x) - f(x&#x27;) = y - y&#x27;</span>  for a Gröbner basis attack. We describe this scenario in more detail in Sect. 4.4.</p>

    <p class="text-gray-300">Our last modification is to move the keys <span class="math">K_{i}</span> from the output of <span class="math">p_{E}</span> to the input of our rolling function, and hence, effectively to the input of <span class="math">p_{E}</span> (Fig. 3). Fig. 3 is our final construction, and it provides two main benefits. First, having the keys at the input does not make it possible to easily cancel them by computing the difference of the output as described before. Hence, this adds an additional barrier in mounting successful Gröbner basis attacks. Second, we can use a simple non-linear rolling function, because the addition of the key stream during the rolling function prevents the attacker from easily detecting short cycles within it.</p>

    <p class="text-gray-300">Minimizing the Number of Multiplications. One main reason to use the Farfalle construction is that its three permutations <span class="math">p_{c}</span>, <span class="math">p_{d}</span>, and <span class="math">p_{e}</span> do not have to provide protection against all possible attack vectors. Indeed, the permutation <span class="math">p_{e}</span> alone does not have to provide resistance against higher-order differential attacks <em>[47, 49]</em>. The latter are particular algebraic attacks that exploit the low degree polynomial descriptions of the scheme. Resistance against higher-order differential attacks (higher-order attacks in short) can be provided by the permutations <span class="math">p_{c}</span>, and <span class="math">p_{d}</span>, and it inherently depends on the algebraic degree that a permutation achieves. Hence, requiring protection against higher-order attacks provides a lower bound on the number of multiplications that are needed in a permutation. In a nutshell, since <span class="math">p_{e}</span> does not have to be secure against higher-order attacks, we can use a permutation with fewer multiplications. This benefits the multiplication count of the scheme, since the permutations <span class="math">p_{c}</span> and <span class="math">p_{d}</span> are called only once independently of the number of output words.</p>

    <p class="text-gray-300">The Rolling Function. An integral part of the Farfalle construction is the rolling function <em>rol</em>. The permutations <span class="math">p_{c}</span> and <span class="math">p_{e}</span> (Fig. 1a) in the Farfalle construction are usually chosen to be very lightweight, such that the algebraic degree is relatively low. Hence, to prevent higher-order attacks, the rolling function is chosen to be non-linear. In our modified version, the same is true up to the intermediate construction as depicted in Fig. 7. In this case, <em>rol</em> has to be non-linear in order to use a permutation <span class="math">p_{E}</span> of low degree. For our final construction (Fig. 3), we do not see any straightforward way to exploit higher-order attacks due to the unknown keys at the inputs of <span class="math">p_{E}</span>. Thus, we could use a linear rolling function <em>rol</em>, but we rather choose to use a simple non-linear <em>rol</em> for Ciminion. That is because it makes it possible to analyze the security of Fig. 7, and to keep the same conclusion when we opt for the stronger version of Fig. 3. In addition, we present Aiminion in App. B, a version of our design that does not follow this line of reasoning. Aiminion uses a linear rolling function, and nine rounds of <span class="math">p_{E}</span>. We deem this version to be an interesting target for further analysis that aims to evaluate the security impact of switching from a non-linear to a linear rolling function.</p>

    <p class="text-gray-300">Generating the Subkeys. Instead of sharing all subkeys <span class="math">K_{i}</span> directly by communicating parties to encrypt messages, we specify a derivation of the subkeys <span class="math">K_{i}</span> from two master keys <span class="math">MK_{1}</span>, and <span class="math">MK_{2}</span>. These subkeys can be generated in a single precomputation step. For the storage of the subkeys, trade-offs can be made to store as many subkeys as needed, and to split messages into lengths that match the stored subkey lengths.</p>

    <p class="text-gray-300">3.2 The Round Function</p>

    <p class="text-gray-300">Our round function is composed of three layers: a non-linear transformation, a linear transformation, and a round constant addition. Like classical designs, we employ the same non-linear and linear transformations for each round, but with different round constant additions. This makes it easier to implement, and to reduce code-size and area requirements. Nonetheless, some primitives that have been designed to lower the multiplicative complexity use a different linear layer for each round, like in LowMC <em>[4]</em>.</p>

    <p class="text-gray-300">Non-linear Transformation. Most primitives operating in large fields have a variant of powering field elements, e.g., <span class="math">x^{3}</span> or <span class="math">x^{-1}</span>. These mappings became popular to guard against linear and differential cryptanalysis due to their properties <em>[55]</em>. The most popular design that uses such mappings is the AES <em>[28]</em>, where <span class="math">x^{-1}</span> is used as part of its S-box. For ciphers that aim at a low multiplicative complexity, these power mappings are interesting because they often have an inverse of high degree, which provides protection against algebraic attacks. However, they impose some restrictions, e.g., the map <span class="math">x\\mapsto x^{\\alpha}</span> for integer <span class="math">\\alpha\\geq 2</span> is a bijection in <span class="math">\\mathbb{F}_{q}</span> if and only if <span class="math">\\gcd(q-1,\\alpha)=1</span> (e.g., <span class="math">x\\mapsto x^{3}</span> is a permutation over <span class="math">\\mathbb{F}_{2^{n}}</span> for odd <span class="math">n</span> only). Hence, one has to consider several power values <span class="math">\\alpha</span> in order for <span class="math">x^{\\alpha}</span> to stay a permutation for any field. In a design that should make it possible to be instantiated for a wide variety of fields, considering those special cases complicates the design of the cipher.</p>

    <p class="text-gray-300">Instead of a power mapping, the non-linear element in our designs is the Toffoli gate <em>[61]</em>. Indeed, algebraic attacks are the main threat against designs aiming to lower the multiplicative complexity, and the multiplications are the main cost factor in our design. It thus seems counter intuitive to spend the non-linear element on simply manipulating a single field element, as is the case for power mappings. Therefore, we choose to multiply two elements of the state, instead of operating on a single state element, in order to increase the non-linear diffusion. Furthermore, the Toffoli gate is a permutation for any field, and therefore we are not restricted to a specific field. We mitigate potential negative effects of the property of the Toffoli gate to provide the same degree in forward and backward direction by mandating its use only in modes that truncate the permutation output, and that never evaluate its inverse using the secret key.</p>

    <p class="text-gray-300">Linear Transformation. We present the linear transformation in its matrix form, the coefficients of which must be carefully chosen. One possibility is to use an MDS matrix. Since an MDS matrix has the highest branch number <em>[24]</em> among all possible matrices, it plays an important role in proving lower bounds on the linear and differential trail weight. However, we do not need to rely on MDS matrices as the field multiplications already have advantageous properties against linear and differential attacks.</p>

    <p class="text-gray-300">Another option is to randomly choose the coefficients of the matrix for each round, and then verify that the matrix is invertible. This strategy was used in one of the first low multiplicative complexity designs, namely LowMC <em>[4]</em>. However, the drawback is that random matrices contribute significantly to the cost of the</p>

    <p class="text-gray-300">primitive in some scenarios, and the security analysis becomes more involved. Hence, we have decided to use a much simpler linear layer.</p>

    <p class="text-gray-300">In order to provide sufficient diffusion, complex equation systems, and low multiplicative complexity, the degree of the functions that output equations depending on the input variables must grow as fast as possible. By applying a single multiplication per round, the degree doubles per round in the best scenario. However, this also depends on the linear layer. For instance, this layer could be a simple layer permuting the elements (e.g., the <span class="math">3 \\times 3</span> circulant matrix <span class="math">circ(0,0,1)</span>), for which the univariate degree of a single element only grows according to a Fibonacci sequence. To ensure that the univariate degree of a single element doubles per round, the result of the previous multiplication has to be reused in the multiplication of the next round. This is also applicable to the inverse of the permutation. Hence, we decided to use the following matrix for the linear layer:</p>

    <div class="my-4 text-center"><span class="math-block">M = \\left[ \\begin{array}{ccc} 0 &amp;amp; 0 &amp;amp; 1 \\\\ 1 &amp;amp; RC4 &amp;amp; RC4 \\\\ 0 &amp;amp; 1 &amp;amp; 1 \\end{array} \\right] \\qquad \\text{(and} \\qquad M^{-1} = \\left[ \\begin{array}{ccc} 0 &amp;amp; 1 &amp;amp; -RC4 \\\\ -1 &amp;amp; 0 &amp;amp; 1 \\\\ 1 &amp;amp; 0 &amp;amp; 0 \\end{array} \\right]),</span></div>

    <p class="text-gray-300">Here, <span class="math">M_{0,2}, M_{1,2}, M^{-1}_{0,2}, M^{-1}_{1,2} \\neq 0</span> with <span class="math">M_{i,j}</span> denoting the element of the matrix <span class="math">M</span> at row <span class="math">i</span> and column <span class="math">j</span>. The use of the round constant <span class="math">RC4 \\notin \\{0,1\\}</span> is motivated by aiming to improve the diffusion, and to avoid a weakness with respect to linear cryptanalysis that we discuss in Sect. 4.1.</p>

    <p class="text-gray-300"><strong>About Quadratic Functions.</strong> In addition to the matrix multiplication, another (semi-)linear transformation over a binary field <span class="math">\\mathbb{F}_{2^n}</span> is the quadratic permutation <span class="math">x \\mapsto x^2</span>. This transformation can be exploited as a component in the round function (e.g., as a replacement of the multiplication by <span class="math">RC4</span>) to both increase the diffusion and the overall degree of the function that describes the scheme. However, we do not employ it for several reasons. First, even if the quadratic permutation is linear over <span class="math">\\mathbb{F}_{2^n}</span>, its cost in an application like MPC might not be negligible. Indeed, the quadratic permutation costs one multiplication as detailed in [42]. As a result, even if it makes it possible to reduce the overall number of rounds due to a faster growth of the degree, the overall number of multiplications would not change for applications like MPC. Secondly, the quadratic function is not a permutation over <span class="math">\\mathbb{F}_p</span> for a prime <span class="math">p \\neq 2</span>. Thus, its introduction implies having to work with two different round functions: one for the binary case and one for the prime case. Since our goal is to present a simple and elegant general scheme, we decided not to use it.</p>

    <p class="text-gray-300"><strong>Round Constants.</strong> The round constants break up the symmetry in the design. They prevent the simplification of the algebraic description of the round function. However, as we manipulate many round constants, and since they influence the rounds in a complex manner, we use an extendable output function to obtain round constant values without an obvious structure. We performed some</p>

    <p class="text-gray-300">4 A function <span class="math">f</span> over <span class="math">(\\mathbb{F}, +)</span> is semi-linear if for each <span class="math">x, y \\in \\mathbb{F}</span>: <span class="math">f(x + y) = f(x) + f(y)</span>. It is linear if it is semi-linear and if for each <span class="math">x \\in \\mathbb{F}</span>: <span class="math">f(\\alpha \\cdot x) = \\alpha \\cdot f(x)</span>.</p>

    <p class="text-gray-300">5 A minimum number of multiplications is required to reach maximum degree, which is one of the property required by a cryptographic scheme to be secure.</p>

    <p class="text-gray-300">12</p>

    <p class="text-gray-300">experiments where we added round constants to one or two state elements. These instances provided simpler algebraic descriptions. Considering the small costs of manipulating dense round constants, we decide to use three round constants to complicate the algebraic description of the cipher, even after a few rounds.</p>

    <h2 id="sec-13" class="text-2xl font-bold">4 Security Analysis</h2>

    <p class="text-gray-300">We present our security analysis of Ciminion with respect to “standard” application of the attacks that are found in the literature. This analysis determines the required number of rounds to provide some level of confidence in its security. Due to page limitation, further analysis is presented in App. D-E.</p>

    <p class="text-gray-300">First and foremost, the number of rounds that guarantees security up to <span class="math">s</span> bits are computed under the assumption that the data available to the attacker is limited to <span class="math">2^{s}</span>, except if specified in a different way. Moreover, we do not make any claim about the security against related-key attacks and known- or chosen-key distinguishers (including the zero-sum partitions). The latter are out the scope of this paper.</p>

    <p class="text-gray-300">We observe that the attack vectors penetrating the highest number of rounds are algebraic attacks. On the contrary, traditional attacks, such as differential and linear cryptanalysis, are infeasible after a small number of rounds. As detailed in the following, in order to protect against algebraic attacks and higher-order differential attacks, we increase the number of rounds proportionally to the security level <span class="math">s</span>. A constant number of rounds is added to prevent an adversary from guessing part of the key or the initial or middle state, or to linearize part of the state. Hence, the numbers of rounds for <span class="math">p_{C}</span> and <span class="math">p_{E}</span> are respectively <span class="math">s+6</span> and <span class="math">\\left\\lceil\\frac{s+19}{12}+1.5\\right\\rceil</span> for the standard security level.</p>

    <h3 id="sec-14" class="text-xl font-semibold mt-8">4.1 Linear Cryptanalysis</h3>

    <p class="text-gray-300">Linear cryptanalysis <em>[51]</em> is a known-plaintext attack that abuses high <em>correlations</em> <em>[25]</em> between sums of input bits and sums of output bits of a cryptographic primitive. However, classical correlation analysis is not restricted to solely primitives operating on elements of binary fields. In this section, we apply the existing theory developed by Baignères et al. <em>[9]</em> for correlation analysis of primitives that operate on elements of arbitrary sets to the permutations defined in Sect. 2.</p>

    <p class="text-gray-300">General Correlation Analysis. An application of the theory to ciphers operating on elements of binary fields is presented by Daemen and Rijmen <em>[29]</em>. Classical correlation analysis is briefly recalled in App. C.1. In this section, we apply the theory to the more general case of primitives operating on elements of <span class="math">\\mathbb{F}_{q}</span> where <span class="math">q=p^{n}</span>. Henceforth, we suppose that <span class="math">f:(\\mathbb{F}_{q})^{l}\\to(\\mathbb{F}_{q})^{m}</span>.</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Correlation analysis is the study of <em>characters</em>, and their configuration in the <span class="math">l</span>-dimensional vector space <span class="math">L^{2}((\\mathbb{F}_{q})^{l})</span> of complex-valued functions <span class="math">(\\mathbb{F}_{q})^{l}\\to\\mathbb{C}</span>. The space <span class="math">L^{2}((\\mathbb{F}_{q})^{l})</span> comes with the inner product <span class="math">\\langle g,h\\rangle=\\sum g(x)\\overline{h(x)}</span>, which defines the norm $\\</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">g\\</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">=\\sqrt{\\langle g,g\\rangle}=q^{\\frac{1}{2}}$.</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">!<a href="img-8.jpeg">img-8.jpeg</a> Fig. 8: Mask propagation in  <span class="math">f</span></p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">A character is an additive homomorphism from  <span class="math">(\\mathbb{F}_q)^l</span>  into  $S\\coloneqq \\{z\\in \\mathbb{C}:</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">z</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">= 1\\}<span class="math"> . It is well-known that any character on  </span>(\\mathbb{F}_q)^l$  is of the form</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <div class="my-4 text-center"><span class="math-block">\\chi_ {u} (x) = e ^ {\\frac {2 \\pi i}{p} \\operatorname {T r} _ {p} ^ {q} (u ^ {\\top} x)},</span></div>

    <p class="text-gray-300">for some  <span class="math">u \\in (\\mathbb{F}_q)^l</span> . We recall that for  <span class="math">q = 2</span>  we have that  <span class="math">\\chi_u(x) = (-1)^{u^\\top x}</span> , which appears in classical correlation analysis. Here,  <span class="math">\\mathrm{Tr}_p^q (x) = x + x^2 +\\dots +x^{p^{l - 1}}\\in \\mathbb{F}_p</span>  is the trace function. For this reason,  <span class="math">u^{\\top}x</span>  is called a vectorial trace parity and  <span class="math">u</span>  a trace mask vector. We call the ordered pair  <span class="math">(u,v)</span>  a linear approximation of  <span class="math">f</span> , where  <span class="math">u</span>  is understood to be the mask at the input and  <span class="math">v</span>  to be the mask at the output of  <span class="math">f</span> .</p>

    <p class="text-gray-300">We define the vectorial trace parity correlation in the following definition.</p>

    <div class="my-4 text-center"><span class="math-block"></span></div>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\mathrm {C} _ {f} (u, v) = \\frac {\\langle \\mu_ {u} , \\mu_ {v} \\circ f \\rangle}{\\</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\mu_ {u} \\</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\mu_ {v} \\circ f \\</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">} = \\frac {1}{q ^ {l}} \\sum_ {x \\in (\\mathbb {F} _ {q}) ^ {l}} e ^ {\\frac {2 \\pi i}{p} \\operatorname {T r} _ {p} ^ {q} (u ^ {\\top} x - v ^ {\\top} f (x))}</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <div class="my-4 text-center"><span class="math-block"></span></div>

    <p class="text-gray-300">This helps us to define a more general linear probability metric as follows.</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"># Definition 2 (Linear probability).  $\\mathrm{LP}_f(u,v) =</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\mathrm{C}_f(u,v)</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">^2$</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">The idea is then to consider the permutation as a circuit made of simple building blocks. Those blocks correspond to the operators that we apply, and for which we attach to each edge a trace mask vector. Importantly, these trace mask vectors are in one-to-one correspondence with characters. The goal of the attacker is to construct a linear trail from the end of the permutation to the beginning, with the goal of maximizing the linear probability of each building block. A list of the linear probabilities of each such building block can be found in App. C.2 to deduce the result of the analysis.</p>

    <p class="text-gray-300">On Three-round Linear Trails. Fig. 8 illustrates how the linear masks propagate through the round function when the linear probabilities of all building blocks are maximized. In this Figure,  <span class="math">c_{\\ell} \\coloneqq RC_{4\\ell}</span> . The attacker is able to choose</p>

    <p class="text-gray-300"><span class="math">u, v</span> , and <span class="math">w</span> freely at the beginning of the first round, and afterwards, a mask at the input of the next round is determined by a mask at the output of the former round. We write <span class="math">R_{i}</span> for the <span class="math">i</span>'th round function. Moreover, we use the notation <span class="math">c_{ij} \\coloneqq c_i c_j</span> and <span class="math">c_{ijk} \\coloneqq c_i c_j c_k</span>, where the subscript refers to the round number. The masks evolve as follows:</p>

    <div class="my-4 text-center"><span class="math-block">\\begin{array}{l} \\left( \\begin{array}{c} u \\\\ v \\\\ w \\end{array} \\right) \\xrightarrow {R _ {0}} \\left( \\begin{array}{c} v \\\\ c _ {1} v + w \\\\ u + c _ {1} v + w \\end{array} \\right) \\xrightarrow {R _ {1}} \\left( \\begin{array}{c} c _ {1} v + w \\\\ u + (c _ {1} + c _ {1 2}) v + (1 + c _ {2}) w \\\\ u + (1 + c _ {1} + c _ {1 2}) v + (1 + c _ {2}) w \\end{array} \\right) \\\\ \\xrightarrow {R _ {2}} \\left( \\begin{array}{c} u + (c _ {1} + c _ {1 2}) v + (1 + c _ {2}) w \\\\ (1 + c _ {3}) u + (1 + c _ {1} + c _ {1 2} + c _ {1 3} + c _ {1 2 3}) v + (1 + c _ {2} + c _ {3} + c _ {2 3}) w \\\\ (1 + c _ {3}) u + (1 + 2 c _ {1} + c _ {1 3} + c _ {1 2} + c _ {1 2 3}) v + (2 + c _ {2} + c _ {3} + c _ {2 3}) w \\end{array} \\right). \\end{array}</span></div>

    <p class="text-gray-300">An implicit assumption in both Fig. 8, and the mask derivation above, is that the masks at the output of the multiplication and at the input of the third branch are equal. However, an attacker can only make sure that this assumption is valid if the following system of equations has a non-zero solution:</p>

    <div class="my-4 text-center"><span class="math-block">\\left( \\begin{array}{c c c} 1 &amp;amp; c _ {1} &amp;amp; 1 \\\\ 1 &amp;amp; 1 + c _ {1} + c _ {1 2} &amp;amp; 1 + c _ {2} \\\\ 1 + c _ {3} &amp;amp; 1 + 2 c _ {1} + c _ {1 3} + c _ {1 2} + c _ {1 2 3} &amp;amp; 2 + c _ {2} + c _ {3} + c _ {2 3} \\end{array} \\right) \\left( \\begin{array}{c} u \\\\ v \\\\ w \\end{array} \\right) = \\left( \\begin{array}{c} 0 \\\\ 0 \\\\ 0 \\end{array} \\right).</span></div>

    <p class="text-gray-300">If we denote by <span class="math">A</span> the matrix above, then this happens if and only if the matrix is singular, i.e., if <span class="math">\\operatorname{det}(A) = c_2c_3 + 1 = 0</span>. If either <span class="math">c_2</span> or <span class="math">c_3</span> is equal to zero, then the condition does not hold. If both are non-zero, then the condition is equivalent to requiring that <span class="math">c_2 = -c_3^{-1}</span>. In this case, we can freely choose one value, which determines the other. Hence, the probability that the condition holds is equal to <span class="math">\\frac{q - 1}{q^2} &amp;lt; \\frac{1}{q}</span>. Since <span class="math">\\log_2(q)</span> is the security parameter, this probability is negligible and there exists no three-round trail with a linear probability of 1.</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Clustering of Linear Trails. We have <span class="math">\\mathrm{LP}_f(u,v)\\geq \\sum_{Q\\in \\mathrm{LT}_f(u,v)}\\mathrm{LP}(Q)</span>, where <span class="math">\\mathrm{LT}_f(u,v)</span> is the set of linear trails contained in <span class="math">(u,v)</span>. If we suppose now that an attacker is able to find more than <span class="math">q</span> linear trails, i.e., if $</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\mathrm{LT}_f(u,v)</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">&gt; q<span class="math">, then we have </span>\\mathrm{LP}_f(u,v) &gt; \\frac{1}{q}<span class="math">. However, </span>\\log_2(q)$ is the security parameter, therefore the latter condition is not feasible. In a nutshell, three rounds are sufficient to resist against linear cryptanalysis.</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">Round Constant Multiplication Necessity. If the multiplication by the round constant is not present, or <span class="math">RC_{4\\ell} = 1</span>, then the masks evolve as follows over a single round:</p>

    <div class="my-4 text-center"><span class="math-block">\\left( \\begin{array}{c} u \\\\ v \\\\ w \\end{array} \\right) \\xrightarrow {f ^ {- 1}} \\left( \\begin{array}{c} v + x \\\\ v + w + y \\\\ u + v + w \\end{array} \\right) \\quad \\xrightarrow {\\text {if } u = v \\text{ and } x = y = w = 0} \\qquad \\left( \\begin{array}{c} v \\\\ v \\\\ 0 \\end{array} \\right) \\quad \\xrightarrow {f ^ {- 1}} \\left( \\begin{array}{c} v \\\\ v \\\\ 2 v \\end{array} \\right),</span></div>

    <p class="text-gray-300">where <span class="math">(x,y)</span> is the mask vector at the input of the multiplication function, which, like <span class="math">u,v</span>, and <span class="math">w</span>, can be freely chosen. Hence, if we choose <span class="math">u = v</span>, and <span class="math">x = y = w = 0</span>, and since the characteristic of the field is equal to two, then a one-round approximation with a linear probability of one can be chained indefinitely. This is the reason behind including a multiplication by a non-trivial constant.</p>

    <p class="text-gray-300">15</p>

    <p class="text-gray-300">4.2 Differential Cryptanalysis</p>

    <p class="text-gray-300">Differential cryptanalysis exploits the probability distribution of a non-zero input difference leading to an output difference after a given number of rounds <em>[17]</em>. As Ciminion is an iterated cipher, a cryptanalyst searches for ordered sequences of differences over <span class="math">r</span> rounds that are called <em>differential characteristics/trails</em>. A differential trail has a Differential Probability (DP). Assuming the independence of the rounds, the DP of a differential trail is the product of the DPs of its one-round differences (Definition 3).</p>

    <h6 id="sec-16" class="text-base font-medium mt-4">Definition 3 (One-round differential probability).</h6>

    <p class="text-gray-300">Let <span class="math">(\\alpha_{a},\\alpha_{b},\\alpha_{c})\\in(\\mathbb{F}_{p})^{3}</span> be the input of the round, and <span class="math">(\\alpha_{a}^{<em>},\\alpha_{b}^{</em>},\\alpha_{c}^{<em>})\\in(\\mathbb{F}_{p})^{3}</span> the chosen non-zero input difference. The probability that an input difference is mapped to an output difference <span class="math">(\\beta_{a}^{</em>},\\beta_{b}^{<em>},\\beta_{c}^{</em>})\\in(\\mathbb{F}_{p})^{3}</span> through one iteration of the round function <span class="math">f</span> is equal to</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">$\\frac{</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">f(\\alpha_{a}^{<em>}+\\alpha_{a},\\alpha_{b}^{</em>}+\\alpha_{b},\\alpha_{c}^{<em>}+\\alpha_{c})-f(\\alpha_{a},\\alpha_{b},\\alpha_{c})=(\\beta_{a}^{</em>},\\beta_{b}^{<em>},\\beta_{c}^{</em>})</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">}{</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">(\\mathbb{F}_{p})^{3}</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">}\\,.$</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">The operation <span class="math">+</span> is replaced by <span class="math">\\oplus</span> in <span class="math">\\mathbb{F}_{2^{n}}</span>.</p>

    <p class="text-gray-300">However, in general, the attacker does not have any information about the intermediate differences of the differential trail. Hence, the attacker only fixes the input and the output differences over <span class="math">r</span> rounds, and works with <em>differentials</em>. A differential is a collection of differential trails with fixed input and output differences, and free intermediate differences. The DP of a differential over <span class="math">r</span> rounds is the sum of all DPs of the differential trails that have the same input and output difference over the same number of rounds as the differential.</p>

    <p class="text-gray-300">In this paper, we perform the differential cryptanalysis by grouping fixed differences in <em>sets</em>. Those sets impose some conditions to satisfy between the differences of the branches of the round, and/or specify that some differences at the input of the branches equal zero. Then, given an input difference, we study the possible sets of output differences after a round, and we determine the DP that an input difference is mapped into an output difference over a round. The goal is to find the longest differential trail with the highest DP.</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Toward this end, we build a state finite machine (more details in App. C.3) that represents all the encountered sets of differences as states associated to their differential probabilities. To construct the graph, we start with a difference of the form $\\{(0,0,x)</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">x\\neq 0\\}<span class="math">, and we search for the possible sets of output differences until we have explored all the possibilities from each newly reached set. Hereafter, let us assume that the difference </span>x<span class="math"> is not zero. We see that an input difference from </span>\\{(0,0,x)\\}<span class="math"> is mapped into an output difference of the form </span>\\{(x,RC_{4\\>\\epsilon}x,x)\\}<span class="math"> after one round with probability one. Indeed, since the input difference goes through the non-linear operation and stays unchanged, the output difference is simply the result of the linear operation applied to the input difference. For the other cases, a non-zero input difference propagates to an output difference over one round with probability equal to </span>p^{-1}<span class="math"> in </span>\\mathbb{F}_{p}<span class="math">, or </span>2^{-n}<span class="math"> in </span>\\mathbb{F}_{2^{n}}$. From those results, we determine the differential over three rounds with the highest DP.</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">On Three-round Differentials. The differential trail in <span class="math">\\mathbb{F}_{p}</span> with the highest DP is</p>

    <p class="text-gray-300"><span class="math">\\{(0,0,x)\\}\\xrightarrow{\\text{prob. 1}}\\{(x,RC_{4\\ell}^{1}x,x)\\}\\xrightarrow{\\text{prob. }p^{-1}}\\{(−RC_{4\\ell}^{1}x,x,0)\\}\\xrightarrow{\\text{prob. }p^{-1}}\\{(0,0,x)\\}\\,,</span></p>

    <p class="text-gray-300">where the fixed input difference <span class="math">x</span> is equal to another fixed value in the following rounds, and satisfies the conditions imposed by the set (for details see App. C.3 ). Additionally, this differential trail holds if and only if the round constant <span class="math">RC_{4\\ell}^{1}</span> introduced by the first round is equal to the round constant <span class="math">RC_{4\\ell}^{1}</span> of the third round.</p>

    <p class="text-gray-300">In <span class="math">\\mathbb{F}_{2^{n}}</span>, we obtain almost the same state finite machine as in Fig. 9. The only exception is that the set of differences <span class="math">\\{(-RC_{4\\ell}^{1}x,x,0)\\}</span> corresponds to <span class="math">\\{(RC_{4\\ell}^{1}x,x,0)\\}</span>, because <span class="math">-z</span> is equal to <span class="math">z</span> for each <span class="math">z\\in\\mathbb{F}_{2^{n}}</span>. Hence, the differential trail in <span class="math">\\mathbb{F}_{2^{n}}</span> with the highest DP is</p>

    <p class="text-gray-300"><span class="math">\\{(0,0,x)\\}\\xrightarrow{\\text{prob. 1}}\\{(x,RC_{4\\ell}^{1}x,x)\\}\\xrightarrow{\\text{prob. }2^{-n}}\\{(RC_{4\\ell}^{1}x,x,0)\\}\\xrightarrow{\\text{prob. }2^{-n}}\\{(0,0,x)\\}\\,,</span></p>

    <p class="text-gray-300">under the same conditions that in <span class="math">\\mathbb{F}_{p}</span>.</p>

    <p class="text-gray-300">In summary, a fixed difference from <span class="math">\\{(0,0,x)\\}</span> is mapped to the difference of the form <span class="math">\\{(x,RC_{4\\ell}^{1}x,x)\\}</span> after one round with probability one in <span class="math">\\mathbb{F}_{2^{n}}</span> and in <span class="math">\\mathbb{F}_{p}</span>. Moreover, as depicted in Fig. 9, an input difference can be mapped to an output difference of the form <span class="math">\\{(0,0,x)\\}</span> with DP <span class="math">p^{-1}</span> (resp. <span class="math">2^{-n}</span>) if and only if this difference is of the form <span class="math">\\{(-RC_{4\\ell}^{1}x,x,0)\\}</span>. This means that the <em>only</em> possible differential trail over three rounds with input and output differences of the form <span class="math">\\{(0,0,x)\\}</span> are the ones given before. The DP of this differential trail is expressed in the following Lemma.</p>

    <h6 id="sec-17" class="text-base font-medium mt-4">Lemma 1.</h6>

    <p class="text-gray-300">A differential trail over three rounds has a probability at most equal to <span class="math">p^{-2}</span> in <span class="math">\\mathbb{F}_{p}</span> and <span class="math">2^{-2n}</span> in <span class="math">\\mathbb{F}_{2^{n}}</span>.</p>

    <p class="text-gray-300">The DP of all other differential trails over three round are at most equal to <span class="math">p^{-3}</span> in <span class="math">\\mathbb{F}_{p}</span> and <span class="math">2^{-3n}</span> in <span class="math">\\mathbb{F}_{2^{n}}</span>. Since the security level <span class="math">s</span> satisfies <span class="math">s\\leq\\log_{2}(p)</span> in <span class="math">\\mathbb{F}_{p}</span> and <span class="math">s\\leq n</span> in <span class="math">\\mathbb{F}_{2^{n}}</span>, we therefore conjecture that three rounds are sufficient to guarantee security against “basic” differential distinguishers. We thus choose to have at least six rounds for the permutations <span class="math">p_{E}</span> and <span class="math">p_{C}</span>, which is twice the number of rounds necessary to guarantee security against “basic” differential/linear distinguishers. The minimal number of rounds for the permutations should provide security against more advanced statistical distinguishers.</p>

    <h3 id="sec-18" class="text-xl font-semibold mt-8">4.3 Higher-Order Differential and Interpolation Attacks</h3>

    <p class="text-gray-300">If a cryptographic scheme has a simple algebraic representation, higher-order attacks <em>[47, 49]</em> and interpolation attack <em>[46]</em> have to be considered. In this part, we only focus on higher-order differential attacks. We conjecture that the number of rounds necessary to prevent higher-order differential attacks is also sufficient to prevent interpolation attacks (see details in App. D). This result is not novel, and the same applies for other schemes, like MiMC, as further explained in *[35]</p>

    <p class="text-gray-300">Background. We recall from Fig. 3 that an attacker can only directly manipulate a single element, and the two other elements are the secret subkeys. We therefore operate with this single element to input value sets, while keeping the two other elements fixed. Each output element is the result of a non-linear function depending on the input element <span class="math">x</span>, and two fixed elements that are the input of the permutation. Thus, we have <span class="math">f_{N}(x)=p(x,\\mathit{const},\\mathit{const})</span> in <span class="math">\\mathbb{F}_{2^{n}}</span>, and <span class="math">f_{p}(x)=p(x,\\mathit{const},\\mathit{const})</span> in <span class="math">\\mathbb{F}_{p}</span>.</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">A given function <span class="math">f_{p}</span> over prime fields <span class="math">\\mathbb{F}_{p}</span> is represented by <span class="math">f_{p}(x)=\\sum_{i=0}^{p-1}\\kappa_{i}x^{i}</span> with constants <span class="math">\\kappa_{i}\\in\\mathbb{F}_{p}</span>. The degree of the function <span class="math">f_{p}(x)</span> that we denote by <span class="math">d_{\\mathbb{F}_{p}}</span>, corresponds to the highest value <span class="math">i</span> for which <span class="math">\\kappa_{i}\\neq 0</span>. The same holds for a function <span class="math">f_{n}</span> working over binary extension fields <span class="math">\\mathbb{F}_{2^{n}}</span>. For the latter, <span class="math">f_{N}(x)=\\bigoplus_{i=0}^{d}\\kappa_{i}x^{i}</span> with <span class="math">\\kappa_{i}\\in\\mathbb{F}_{2^{n}}</span>, and <span class="math">d_{\\mathbb{F}_{2^{n}}}</span> is the degree of the function <span class="math">f_{n}(x)</span>. Like previously, the degree is the highest value <span class="math">i</span> for which <span class="math">\\kappa_{i}\\neq 0</span>. In <span class="math">\\mathbb{F}_{2^{n}}</span>, the function can as well be represented by its algebraic norm form (ANF) <span class="math">\\overrightarrow{f_{n}}(x_{1},\\ldots,x_{n})</span>, whose output element <span class="math">j</span> is defined by its coordinate function <span class="math">f_{n,j}(x_{1},\\ldots,x_{n})=\\bigoplus_{u=(u_{1},\\ldots,u_{2})}\\kappa_{j,u}\\cdot x_{1}^{u_{1}}\\cdot\\ldots\\cdot x_{n}^{u_{n}}</span> with <span class="math">\\kappa_{j,u}\\in\\mathbb{F}_{2}</span>. The degree <span class="math">d_{\\mathbb{F}_{2}^{n}}</span>of <span class="math">\\overrightarrow{f_{n}}</span> corresponds to the maximal Hamming weight of <span class="math">u</span> for which <span class="math">\\kappa_{j,u}\\neq 0</span>, that is to say $d_{\\mathbb{F}_{2}^{n}}=\\max_{i\\leq d}\\{hw(i)\\,</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\,\\kappa_{i}\\neq 0\\}$.</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">For the last representation, as proved by Lai <em>[49]</em> and in <em>[47]</em>, if we iterate over a vector space <span class="math">\\mathcal{V}</span> having a dimension strictly higher than <span class="math">d_{\\mathbb{F}_{2}^{n}}</span>, we obtain the following result: <span class="math">\\bigoplus_{v\\in\\mathcal{V}\\oplus\\nu}f_{n}(v)=0</span> . A similar result has also been recently presented for the prime case in <em>[35, Proposition 2]</em>. More precisely, if the degree of <span class="math">f_{p}(x)</span> is <span class="math">d_{\\mathbb{F}_{p}}</span>, then iterating over all elements of a multiplicative subgroup <span class="math">\\mathcal{G}</span> of <span class="math">\\mathbb{F}_{p}^{t}</span> of size $</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\mathcal{G}</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">>d_{\\mathbb{F}_{p}}<span class="math"> leads to </span>\\sum_{x\\in\\mathcal{G}}f_{p}(x)=f_{p}(0)\\cdot</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\mathcal{G}</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"><span class="math"> . The last sum is equal to zero modulo </span>p<span class="math"> since </span></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\mathcal{G}</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"><span class="math"> is a multiple of </span>p$.</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">In order to provide security against higher-order differential attacks based on the presented zero-sums, we choose the number of rounds of our permutation to have a function of a degree higher than our security claim.</p>

    <p class="text-gray-300">Overview of our Security Argument. In our construction, we assume that an attacker can choose the nonce <span class="math">\\aleph</span>, which is the input of the permutation <span class="math">p_{C}</span>. For the first call of this permutation, we want to prevent an attacker to input value sets that always result in the same constant after the application of the permutation <span class="math">p_{C}</span>. This requirement is necessary, since we assume in the remaining analysis that the output values of <span class="math">p_{C}</span> are unpredictable by an attacker. We emphasize that if the output of the permutation <span class="math">p_{C}</span> is guaranteed to be randomly distributed, then this is sufficient to prevent higher-order differential attacks. That is because the inverse of the final permutations <span class="math">p_{E}</span> is never evaluated, and the attacker cannot construct an affine subspace in the middle of the construction.</p>

    <p class="text-gray-300">Estimating the Degree of <span class="math">p_{C}</span>: Necessary Number of Rounds. We study the evolution of the degrees <span class="math">d_{\\mathbb{F}_{p}}</span> and <span class="math">d_{\\mathbb{F}_{2^{n}}}</span> for the permutation <span class="math">p_{C}</span> for which the round function <span class="math">f</span> (Fig. 3) is iterated <span class="math">r</span> times. We conclude that the degree of the permutation <span class="math">p_{C}</span> remains unchanged for two rounds, if an input element is present at branch <span class="math">a</span>, and the input at the branch <span class="math">b</span> is zero. For a higher number of rounds, the degree increases. We have chosen the affine layer to ensure that the output of the multiplication can affect both inputs of the multiplication in</p>

    <p class="text-gray-300">the next round. This should make it possible for the maximal possible degree of the output functions to increase faster than having affine layers without this property. In the best case, the maximal degree of the function can be doubled per round.</p>

    <p class="text-gray-300">Considering both previous observations, a minimum of <span class="math">s+2</span> rounds are required to obtain at least <span class="math">d_{\\mathbb{F}_{p}}\\approx 2^{s}</span>, or <span class="math">d_{\\mathbb{F}_{2^{n}}}\\approx 2^{s}</span>. As we want to ensure that the polynomial representation of <span class="math">p_{C}</span> is dense, it is then advisable to add more rounds as a safety margin. In order to reach this goal, we arbitrarily decided to add four more rounds.</p>

    <h3 id="sec-19" class="text-xl font-semibold mt-8">4.4 Gröbner Basis Attacks</h3>

    <p class="text-gray-300">Preliminary. To perform a Gröbner basis <em>[21]</em> attack, the adversary constructs a system of algebraic equations that represents the cipher. Finding the solution of those equations makes it possible for the attacker to recover the key that is denoted by the unknown variables <span class="math">x_{1},...,x_{n}</span> hereafter. In order to solve this system of equations, the attacker considers the <em>ideal</em> generated by the multivariate polynomials that define the system. A <em>Gröbner basis</em> is a particular generating set of the ideal. It is defined with respect to a total ordering on the set of monomials, in particular the lexicographic order. As a Gröbner basis with respect to the lexicographic order is of the form</p>

    <p class="text-gray-300"><span class="math">\\{x_{1}-h_{1}(x_{n}),\\ldots,x_{n-1}-h_{n-1}(x_{n}),h_{n}(x_{n})\\},</span></p>

    <p class="text-gray-300">the attacker can easily find the solution of the system of equations. To this end, one method is to employ the well-known Buchberger’s criterion <em>[21]</em>, which makes it possible to transform a given set of generators of the ideal into a Gröbner basis. From a theoretic point of view, state-of-the-art Gröbner basis algorithms are simply improvements to Buchberger’s algorithm that include enhanced selection criteria, faster reduction step by making use of fast linear algebra, and an attempt to predict reductions to zero. The best well-known algorithm is Faugère’s F5 algorithm <em>[36, 11]</em>.</p>

    <p class="text-gray-300">Experiments highlighted that computing a Gröbner basis with respect to the lexicographic order is a slow process. However, computing a Gröbner basis with respect to the grevlex order can be done in a faster manner. Fortunately, the FGLM algorithm <em>[37]</em> makes it possible to transform a Gröbner basis with respect to the grevlex order to another with respect to the lexicographic order. To summarize, the attacker adopts the following strategy:</p>

    <ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">

      <li>Using the F5 algorithm, compute a Gröbner basis w.r.t. the grevlex order.</li>

      <li>Using the FGLM algorithm, transform the previous basis into a Gröbner basis w.r.t. the lexicographic order.</li>

      <li>Using polynomial factorization and back substitution, solve the resulting system of equations.</li>

    </ol>

    <p class="text-gray-300">Henceforth, we consider the following setting: let <span class="math">K</span> be a finite field, let <span class="math">A=K[x_{1},\\ldots,x_{n}]</span> be the polynomial ring in <span class="math">n</span> variables, and let <span class="math">I\\subseteq A</span> be an</p>

    <p class="text-gray-300">ideal generated by a sequence of polynomials <span class="math">(f_{1},\\ldots,f_{r})\\in A^{r}</span> associated with the system of equations of interest.</p>

    <p class="text-gray-300">Cost of the F5 Algorithm. In the best adversarial scenario, we assume that the sequence of polynomials associated with the system of equations is regular. In this case, the F5 algorithm does not perform any redundant reductions to zero.</p>

    <p class="text-gray-300">Write <span class="math">F_{A/I}</span> for the Hilbert-Series of the algebra <span class="math">A/I</span> and <span class="math">H_{A/I}</span> for its Hilbert polynomial. The degree of regularity <span class="math">D_{\\mathrm{reg}}</span> is the smallest integer such that <span class="math">F_{A/I}(n)=H_{A/I}(n)</span> for all <span class="math">n\\geq D_{\\mathrm{reg}}</span>. The quantity <span class="math">D_{\\mathrm{reg}}</span> plays an important role in the cost of the algorithm. If the ideal <span class="math">I</span> is generated by a regular sequence of degrees <span class="math">d_{1},\\ldots,d_{r}</span>, then its Hilbert series equals <span class="math">F_{A/I}(t)=\\frac{\\prod_{i=1}^{r}(1+t+t^{2}+\\ldots+t^{d_{i}-1})}{(1-t)^{n-r}}</span>. From this, we deduce that <span class="math">\\deg(I)=\\prod_{i=1}^{r}d_{i}</span>, and <span class="math">D_{\\mathrm{reg}}=1+\\sum_{i=1}^{r}(d_{i}-1)</span>.</p>

    <p class="text-gray-300">The main result is that if <span class="math">f_{1},\\ldots,f_{r}</span> is a regular sequence in <span class="math">K[x_{1},\\ldots,x_{n}]</span>, then computing a Gröbner basis with respect to the grevlex order using the F5 algorithm can be performed within</p>

    <p class="text-gray-300"><span class="math">\\mathcal{O}\\left(\\binom{n+D_{\\mathrm{reg}}}{D_{\\mathrm{reg}}}\\right)^{\\omega}</span></p>

    <p class="text-gray-300">operations in <span class="math">K</span>, where <span class="math">2\\leq\\omega\\leq 3</span> is the matrix multiplication exponent.</p>

    <p class="text-gray-300">Costs of Gröbner Basis Conversion and of Back Substitution. FGLM is an algorithm that converts a Gröbner basis of <span class="math">I</span> with respect to one order, to a Gröbner basis of <span class="math">I</span> with respect to a second order in <span class="math">\\mathcal{O}(n\\deg(I)^{3})</span> operations in <span class="math">K</span>. Finally, as proved in <em>[38]</em>, the cost of factorizing a univariate polynomial in <span class="math">K[x]</span> of degree <span class="math">d</span> over <span class="math">\\mathbb{F}_{p^{n}}</span> for a prime <span class="math">p</span> is <span class="math">\\mathcal{O}(d^{3}n^{2}+dn^{3})</span>.</p>

    <p class="text-gray-300">Number of Rounds. After introducing the Gröbner Basis attack, we analyze the minimum number of rounds that is necessary to provide security against this attack. However, we first emphasize that:</p>

    <ul class="list-disc list-inside space-y-1 text-gray-300 my-2 ml-4">

      <li>there are several ways to set up the system of equations that describes the scheme. For instance, we could manipulate more equations, and thus more variables, of lower degree. Alternatively, we could work with less equations, and thus less variables, of higher degree. In addition, we could consider the relation between the input and the output, or between the middle state and the outputs, and so on. In the following, we present some of these strategies, that seem to be the most competitive ones;</li>

      <li>computing the exact cost of the attack is far from an easy task. As largely done in the literature, we assume that the most expensive step is the “F5 Algorithm”. If the cost of such a step is higher than the security level, we conclude that the scheme is secure against the analyzed attack.</li>

    </ul>

    <p class="text-gray-300">A Weaker Scheme. Instead of using the model that is described in Fig. 3, we analyze a weaker model as illustrated in Fig. 7. In the latter, the key is added after the expansion part, instead of before the rolling function application. This weaker</p>

    <p class="text-gray-300">model is easier to analyze, and makes it possible to draw a conclusion regarding the security of our scheme. Thus, we conjecture that if the scheme proposed in Fig. 7 is secure w.r.t. Gröbner Basis attack, then the scheme in Fig. 3 is secure. Indeed, in the scheme proposed in Fig. 7, it is always possible to consider the difference between two or more texts to remove the final key addition. For instance, given <span class="math">f(x) + K = y</span> and <span class="math">f(x&#x27;) + K = y&#x27;</span>, it follows that <span class="math">f(x) - f(x&#x27;) = y - y&#x27;</span>. As a result, the number of variables in the system of equations to be solved remains constant independently of the number of considered outputs. However, in Fig. 3, given <span class="math">g(x + K) = y</span> and <span class="math">g(x&#x27; + K) = y&#x27;</span>, this is not possible except if <span class="math">g(\\cdot)</span> is inverted. Nevertheless, since it is a truncated permutation, this does not seem feasible, unless the part of the output which is truncated is either treated as a variable (that results to have more variables than equations) or guessed by brute force (that results in an attack whose cost is higher than the security level, and <span class="math">2^s \\leq q</span>). Such consideration leads us to conjecture that the number of rounds necessary to make the scheme proposed in Fig. 7 secure is a good indicator of the number of rounds necessary to make the scheme in Fig. 3 secure as well.</p>

    <p class="text-gray-300">Input-Output Relation. The number of rounds must ensure that the maximum degree is reached. Based on that, we do not expect that the relation that holds between the input and the output, makes it possible for the attacker to break the scheme. In particular, let <span class="math">N</span> be the nonce, and <span class="math">k_{1}, k_{2}</span> be the secret keys. If we assume that a single word is output, then an equation of degree <span class="math">2^{r}</span> can be expressed between each input <span class="math">(N, k_{1}, k_{2}) \\in (\\mathbb{F}_{q})^{3}</span>, and the output <span class="math">T \\in \\mathbb{F}_{q}</span> with <span class="math">r</span> the number of rounds. Hence, if there are two different initial nonces, then the attacker has to solve two equations in two variables. In that case, <span class="math">D_{reg} = 1 + 2 \\cdot (2^{r} - 1) \\approx 2^{r + 1}</span>. The cost of the attack is thus lower bounded by <span class="math">\\left[\\binom{2 + 2^{r + 1}}{2^{r + 1}}\\right]^{\\omega} \\geq \\left[\\frac{(1 + 2^{r + 1})^{2}}{2}\\right]^{\\omega} \\geq 2^{2r + 1}</span>, where <span class="math">\\omega \\geq 2</span>. Consequently, <span class="math">2^{2r + 1} \\geq 2^{s}</span> if the total number of rounds is at least <span class="math">\\left\\lceil \\frac{s - 1}{2} \\right\\rceil</span> (e.g., 64 for <span class="math">s = 128</span>). Since the number of rounds for <span class="math">p_{C}</span> is <span class="math">s + 6</span>, this strategy does not outperform the previous attacks as expected.</p>

    <p class="text-gray-300">Finally, we additionally consider a strategy where new intermediate variables are introduced to reduce the degree of the involved polynomials. We concluded that this strategy does not reduce the solving time as it increases the number of variables.</p>

    <p class="text-gray-300">Middle State-Output Relation. There is another attack strategy that exploits the relation between the middle state and the outputs. In this strategy, only <span class="math">p_E</span> is involved, and several outputs are generated by the same unknown middle state. For a given nonce <span class="math">N</span>, let <span class="math">(x_0^N, x_1^N, x_2^N) \\in (\\mathbb{F}_q)^3</span> be the corresponding middle state. Since the key is added after the permutation <span class="math">p_E</span>, we first eliminate the key by considering two initial nonces, and taking the difference of the corresponding</p>

    <p class="text-gray-300">Another approach would be to involve the keys in the analysis. However, since the degree of the key-schedule is very high, the cost would then explode after few steps. It works by manipulating the degree of the key-schedule, or by introducing new variables for each new subkeys while keeping the degree as lower as possible. This approach does not seem to outperform the one described in the main text.</p>

    <p class="text-gray-300">output. This makes it possible to remove all the secret key material at the end, at the cost of having three more unknown variables in the middle.</p>

    <p class="text-gray-300">Hence, independently of the number of outputs that are generated, there are six variables, and thus simply the two middle states. That means that we need at least six output blocks, and an equivalent number of equations. Since two words are output for each call of <span class="math">p_{E}</span>, we have six equations of degree <span class="math">2^{r-1}</span> and <span class="math">2^{r}</span> for the first two words, <span class="math">2^{r}</span> and <span class="math">2^{r+1}</span> for the next two words, and so on. We recall that every call of the rolling function increases the degree by a factor two, while the function that describes the output of a single block has a maximum degree, namely <span class="math">2^{r}</span> after <span class="math">r</span> rounds for one word, and <span class="math">2^{r-1}</span> for the other two words. Hence, <span class="math">D_{reg}=1+(2^{r-1}-1)+2\\cdot\\sum_{i=0}^{1}(2^{r+i}-1)+(2^{r+2}-1)=21\\cdot 2^{r-1}-5\\approx 2^{r+3.4}</span>, and the cost of the attack is lower bounded by</p>

    <p class="text-gray-300"><span class="math">\\left[\\binom{6+2^{r+3.4}}{2^{r+3.4}}\\right]^{\\omega}\\geq\\left[\\frac{(1+2^{r+3.4})^{6}}{6!}\\right]^{\\omega}\\geq 2^{12(r+3.4)-19}\\,,</span></p>

    <p class="text-gray-300">where <span class="math">\\omega\\geq 2</span>. Therefore, <span class="math">2^{12(r+3.4)-19}\\geq 2^{s}</span> if the number of rounds for <span class="math">p_{E}</span> is at least <span class="math">\\left\\lceil\\frac{s+19}{12}-3.4\\right\\rceil</span> (e.g., 9 for <span class="math">s=128</span>). Like previously, potential improvement of the attack (e.g., an enhanced description of the equations) can lead to a lower computational cost. We thus decided to arbitrarily add five rounds as a security margin. We conjecture that at least <span class="math">\\left\\lceil\\frac{s+19}{12}+1.5\\right\\rceil</span> rounds for <span class="math">p_{E}</span> are necessary to provide some security (e.g., 14 for <span class="math">s=128</span>).</p>

    <p class="text-gray-300">In addition, in order to reduce the degree of the involved polynomials, we studied the consequences of introducing new intermediate variables in the middle, e.g., at the output of the rolling function or among the rounds. In that regard, we did not improve the previous results. Moreover, we also considered a scenario in which the attacker accesses more data, without being able to improve the previous results.</p>

    <h3 id="sec-20" class="text-xl font-semibold mt-8">4.5 On the Algebraic Cipher Representation</h3>

    <p class="text-gray-300">Algebraic attacks seem to be the most successful attack vector on ciphers that have a simple representation in larger fields, while restricting the usage of multiplications. Until now, we have mainly focused on the growth of the degree to estimate the costs of the algebraic attacks that we considered. However, this is not the only factor that influences the cost of an algebraic attack. It is well known that such attacks (including higher-order, interpolation, and Gröbner basis attacks) can be more efficient if the polynomial that represents the cipher is sparse. Consequently, it is necessary to study the algebraic representation of the cipher for a feasible number of rounds.</p>

    <p class="text-gray-300">To evaluate the number of monomials that we have for a given degree, we wrote a dedicated tool. This tool produces a symbolic evaluation of the round function</p>

    <p class="text-gray-300">Table 2: Number of monomials of a certain degree for  <span class="math">{\\mathbb{F}}_{p}</span>  .</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Output</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Degree</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

          </tr>

        </thead>

        <tbody>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">Round</td>

            <td class="px-3 py-2 border-b border-gray-700">Variable</td>

            <td class="px-3 py-2 border-b border-gray-700">0</td>

            <td class="px-3 py-2 border-b border-gray-700">1</td>

            <td class="px-3 py-2 border-b border-gray-700">2</td>

            <td class="px-3 py-2 border-b border-gray-700">3</td>

            <td class="px-3 py-2 border-b border-gray-700">4</td>

            <td class="px-3 py-2 border-b border-gray-700">5</td>

            <td class="px-3 py-2 border-b border-gray-700">6</td>

            <td class="px-3 py-2 border-b border-gray-700">7</td>

            <td class="px-3 py-2 border-b border-gray-700">8</td>

            <td class="px-3 py-2 border-b border-gray-700">9</td>

            <td class="px-3 py-2 border-b border-gray-700">10</td>

            <td class="px-3 py-2 border-b border-gray-700">11</td>

            <td class="px-3 py-2 border-b border-gray-700">12</td>

            <td class="px-3 py-2 border-b border-gray-700">13</td>

            <td class="px-3 py-2 border-b border-gray-700">14</td>

            <td class="px-3 py-2 border-b border-gray-700">15</td>

            <td class="px-3 py-2 border-b border-gray-700">16</td>

            <td class="px-3 py-2 border-b border-gray-700">17</td>

            <td class="px-3 py-2 border-b border-gray-700">18</td>

            <td class="px-3 py-2 border-b border-gray-700">19</td>

            <td class="px-3 py-2 border-b border-gray-700">20</td>

            <td class="px-3 py-2 border-b border-gray-700">21</td>

            <td class="px-3 py-2 border-b border-gray-700">22</td>

            <td class="px-3 py-2 border-b border-gray-700">23</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">max</td>

            <td class="px-3 py-2 border-b border-gray-700">1</td>

            <td class="px-3 py-2 border-b border-gray-700">3</td>

            <td class="px-3 py-2 border-b border-gray-700">6</td>

            <td class="px-3 py-2 border-b border-gray-700">10</td>

            <td class="px-3 py-2 border-b border-gray-700">15</td>

            <td class="px-3 py-2 border-b border-gray-700">21</td>

            <td class="px-3 py-2 border-b border-gray-700">28</td>

            <td class="px-3 py-2 border-b border-gray-700">36</td>

            <td class="px-3 py-2 border-b border-gray-700">45</td>

            <td class="px-3 py-2 border-b border-gray-700">55</td>

            <td class="px-3 py-2 border-b border-gray-700">66</td>

            <td class="px-3 py-2 border-b border-gray-700">78</td>

            <td class="px-3 py-2 border-b border-gray-700">91</td>

            <td class="px-3 py-2 border-b border-gray-700">105</td>

            <td class="px-3 py-2 border-b border-gray-700">120</td>

            <td class="px-3 py-2 border-b border-gray-700">136</td>

            <td class="px-3 py-2 border-b border-gray-700">153</td>

            <td class="px-3 py-2 border-b border-gray-700">171</td>

            <td class="px-3 py-2 border-b border-gray-700">190</td>

            <td class="px-3 py-2 border-b border-gray-700">210</td>

            <td class="px-3 py-2 border-b border-gray-700">231</td>

            <td class="px-3 py-2 border-b border-gray-700">253</td>

            <td class="px-3 py-2 border-b border-gray-700">276</td>

            <td class="px-3 py-2 border-b border-gray-700">300</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">2</td>

            <td class="px-3 py-2 border-b border-gray-700">a</td>

            <td class="px-3 py-2 border-b border-gray-700">1</td>

            <td class="px-3 py-2 border-b border-gray-700">3</td>

            <td class="px-3 py-2 border-b border-gray-700">4</td>

            <td class="px-3 py-2 border-b border-gray-700">3</td>

            <td class="px-3 py-2 border-b border-gray-700">1</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">b</td>

            <td class="px-3 py-2 border-b border-gray-700">1</td>

            <td class="px-3 py-2 border-b border-gray-700">3</td>

            <td class="px-3 py-2 border-b border-gray-700">4</td>

            <td class="px-3 py-2 border-b border-gray-700">3</td>

            <td class="px-3 py-2 border-b border-gray-700">1</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">c</td>

            <td class="px-3 py-2 border-b border-gray-700">1</td>

            <td class="px-3 py-2 border-b border-gray-700">3</td>

            <td class="px-3 py-2 border-b border-gray-700">4</td>

            <td class="px-3 py-2 border-b border-gray-700">3</td>

            <td class="px-3 py-2 border-b border-gray-700">1</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">3</td>

            <td class="px-3 py-2 border-b border-gray-700">a</td>

            <td class="px-3 py-2 border-b border-gray-700">1</td>

            <td class="px-3 py-2 border-b border-gray-700">3</td>

            <td class="px-3 py-2 border-b border-gray-700">6</td>

            <td class="px-3 py-2 border-b border-gray-700">8</td>

            <td class="px-3 py-2 border-b border-gray-700">11</td>

            <td class="px-3 py-2 border-b border-gray-700">8</td>

            <td class="px-3 py-2 border-b border-gray-700">6</td>

            <td class="px-3 py-2 border-b border-gray-700">3</td>

            <td class="px-3 py-2 border-b border-gray-700">1</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">b</td>

            <td class="px-3 py-2 border-b border-gray-700">1</td>

            <td class="px-3 py-2 border-b border-gray-700">3</td>

            <td class="px-3 py-2 border-b border-gray-700">6</td>

            <td class="px-3 py-2 border-b border-gray-700">8</td>

            <td class="px-3 py-2 border-b border-gray-700">11</td>

            <td class="px-3 py-2 border-b border-gray-700">8</td>

            <td class="px-3 py-2 border-b border-gray-700">6</td>

            <td class="px-3 py-2 border-b border-gray-700">3</td>

            <td class="px-3 py-2 border-b border-gray-700">1</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">c</td>

            <td class="px-3 py-2 border-b border-gray-700">1</td>

            <td class="px-3 py-2 border-b border-gray-700">3</td>

            <td class="px-3 py-2 border-b border-gray-700">6</td>

            <td class="px-3 py-2 border-b border-gray-700">8</td>

            <td class="px-3 py-2 border-b border-gray-700">11</td>

            <td class="px-3 py-2 border-b border-gray-700">8</td>

            <td class="px-3 py-2 border-b border-gray-700">6</td>

            <td class="px-3 py-2 border-b border-gray-700">3</td>

            <td class="px-3 py-2 border-b border-gray-700">1</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">4</td>

            <td class="px-3 py-2 border-b border-gray-700">a</td>

            <td class="px-3 py-2 border-b border-gray-700">1</td>

            <td class="px-3 py-2 border-b border-gray-700">3</td>

            <td class="px-3 py-2 border-b border-gray-700">6</td>

            <td class="px-3 py-2 border-b border-gray-700">10</td>

            <td class="px-3 py-2 border-b border-gray-700">15</td>

            <td class="px-3 py-2 border-b border-gray-700">19</td>

            <td class="px-3 py-2 border-b border-gray-700">24</td>

            <td class="px-3 py-2 border-b border-gray-700">28</td>

            <td class="px-3 py-2 border-b border-gray-700">33</td>

            <td class="px-3 py-2 border-b border-gray-700">28</td>

            <td class="px-3 py-2 border-b border-gray-700">24</td>

            <td class="px-3 py-2 border-b border-gray-700">19</td>

            <td class="px-3 py-2 border-b border-gray-700">15</td>

            <td class="px-3 py-2 border-b border-gray-700">10</td>

            <td class="px-3 py-2 border-b border-gray-700">6</td>

            <td class="px-3 py-2 border-b border-gray-700">3</td>

            <td class="px-3 py-2 border-b border-gray-700">1</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">b</td>

            <td class="px-3 py-2 border-b border-gray-700">1</td>

            <td class="px-3 py-2 border-b border-gray-700">3</td>

            <td class="px-3 py-2 border-b border-gray-700">6</td>

            <td class="px-3 py-2 border-b border-gray-700">10</td>

            <td class="px-3 py-2 border-b border-gray-700">15</td>

            <td class="px-3 py-2 border-b border-gray-700">19</td>

            <td class="px-3 py-2 border-b border-gray-700">24</td>

            <td class="px-3 py-2 border-b border-gray-700">28</td>

            <td class="px-3 py-2 border-b border-gray-700">33</td>

            <td class="px-3 py-2 border-b border-gray-700">28</td>

            <td class="px-3 py-2 border-b border-gray-700">24</td>

            <td class="px-3 py-2 border-b border-gray-700">19</td>

            <td class="px-3 py-2 border-b border-gray-700">15</td>

            <td class="px-3 py-2 border-b border-gray-700">10</td>

            <td class="px-3 py-2 border-b border-gray-700">6</td>

            <td class="px-3 py-2 border-b border-gray-700">3</td>

            <td class="px-3 py-2 border-b border-gray-700">1</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">c</td>

            <td class="px-3 py-2 border-b border-gray-700">1</td>

            <td class="px-3 py-2 border-b border-gray-700">3</td>

            <td class="px-3 py-2 border-b border-gray-700">6</td>

            <td class="px-3 py-2 border-b border-gray-700">10</td>

            <td class="px-3 py-2 border-b border-gray-700">15</td>

            <td class="px-3 py-2 border-b border-gray-700">19</td>

            <td class="px-3 py-2 border-b border-gray-700">24</td>

            <td class="px-3 py-2 border-b border-gray-700">28</td>

            <td class="px-3 py-2 border-b border-gray-700">33</td>

            <td class="px-3 py-2 border-b border-gray-700">28</td>

            <td class="px-3 py-2 border-b border-gray-700">24</td>

            <td class="px-3 py-2 border-b border-gray-700">19</td>

            <td class="px-3 py-2 border-b border-gray-700">15</td>

            <td class="px-3 py-2 border-b border-gray-700">10</td>

            <td class="px-3 py-2 border-b border-gray-700">6</td>

            <td class="px-3 py-2 border-b border-gray-700">3</td>

            <td class="px-3 py-2 border-b border-gray-700">1</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">5</td>

            <td class="px-3 py-2 border-b border-gray-700">a</td>

            <td class="px-3 py-2 border-b border-gray-700">1</td>

            <td class="px-3 py-2 border-b border-gray-700">3</td>

            <td class="px-3 py-2 border-b border-gray-700">6</td>

            <td class="px-3 py-2 border-b border-gray-700">10</td>

            <td class="px-3 py-2 border-b border-gray-700">15</td>

            <td class="px-3 py-2 border-b border-gray-700">21</td>

            <td class="px-3 py-2 border-b border-gray-700">28</td>

            <td class="px-3 py-2 border-b border-gray-700">36</td>

            <td class="px-3 py-2 border-b border-gray-700">45</td>

            <td class="px-3 py-2 border-b border-gray-700">53</td>

            <td class="px-3 py-2 border-b border-gray-700">62</td>

            <td class="px-3 py-2 border-b border-gray-700">70</td>

            <td class="px-3 py-2 border-b border-gray-700">79</td>

            <td class="px-3 py-2 border-b border-gray-700">87</td>

            <td class="px-3 py-2 border-b border-gray-700">96</td>

            <td class="px-3 py-2 border-b border-gray-700">104</td>

            <td class="px-3 py-2 border-b border-gray-700">113</td>

            <td class="px-3 py-2 border-b border-gray-700">104</td>

            <td class="px-3 py-2 border-b border-gray-700">96</td>

            <td class="px-3 py-2 border-b border-gray-700">87</td>

            <td class="px-3 py-2 border-b border-gray-700">79</td>

            <td class="px-3 py-2 border-b border-gray-700">70</td>

            <td class="px-3 py-2 border-b border-gray-700">62</td>

            <td class="px-3 py-2 border-b border-gray-700">53</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">b</td>

            <td class="px-3 py-2 border-b border-gray-700">1</td>

            <td class="px-3 py-2 border-b border-gray-700">3</td>

            <td class="px-3 py-2 border-b border-gray-700">6</td>

            <td class="px-3 py-2 border-b border-gray-700">10</td>

            <td class="px-3 py-2 border-b border-gray-700">15</td>

            <td class="px-3 py-2 border-b border-gray-700">21</td>

            <td class="px-3 py-2 border-b border-gray-700">28</td>

            <td class="px-3 py-2 border-b border-gray-700">36</td>

            <td class="px-3 py-2 border-b border-gray-700">45</td>

            <td class="px-3 py-2 border-b border-gray-700">53</td>

            <td class="px-3 py-2 border-b border-gray-700">62</td>

            <td class="px-3 py-2 border-b border-gray-700">70</td>

            <td class="px-3 py-2 border-b border-gray-700">79</td>

            <td class="px-3 py-2 border-b border-gray-700">87</td>

            <td class="px-3 py-2 border-b border-gray-700">96</td>

            <td class="px-3 py-2 border-b border-gray-700">104</td>

            <td class="px-3 py-2 border-b border-gray-700">113</td>

            <td class="px-3 py-2 border-b border-gray-700">104</td>

            <td class="px-3 py-2 border-b border-gray-700">96</td>

            <td class="px-3 py-2 border-b border-gray-700">87</td>

            <td class="px-3 py-2 border-b border-gray-700">79</td>

            <td class="px-3 py-2 border-b border-gray-700">70</td>

            <td class="px-3 py-2 border-b border-gray-700">62</td>

            <td class="px-3 py-2 border-b border-gray-700">53</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">c</td>

            <td class="px-3 py-2 border-b border-gray-700">1</td>

            <td class="px-3 py-2 border-b border-gray-700">3</td>

            <td class="px-3 py-2 border-b border-gray-700">6</td>

            <td class="px-3 py-2 border-b border-gray-700">10</td>

            <td class="px-3 py-2 border-b border-gray-700">15</td>

            <td class="px-3 py-2 border-b border-gray-700">21</td>

            <td class="px-3 py-2 border-b border-gray-700">28</td>

            <td class="px-3 py-2 border-b border-gray-700">36</td>

            <td class="px-3 py-2 border-b border-gray-700">45</td>

            <td class="px-3 py-2 border-b border-gray-700">53</td>

            <td class="px-3 py-2 border-b border-gray-700">62</td>

            <td class="px-3 py-2 border-b border-gray-700">70</td>

            <td class="px-3 py-2 border-b border-gray-700">79</td>

            <td class="px-3 py-2 border-b border-gray-700">87</td>

            <td class="px-3 py-2 border-b border-gray-700">96</td>

            <td class="px-3 py-2 border-b border-gray-700">104</td>

            <td class="px-3 py-2 border-b border-gray-700">113</td>

            <td class="px-3 py-2 border-b border-gray-700">104</td>

            <td class="px-3 py-2 border-b border-gray-700">96</td>

            <td class="px-3 py-2 border-b border-gray-700">87</td>

            <td class="px-3 py-2 border-b border-gray-700">79</td>

            <td class="px-3 py-2 border-b border-gray-700">70</td>

            <td class="px-3 py-2 border-b border-gray-700">62</td>

            <td class="px-3 py-2 border-b border-gray-700">53</td>

          </tr>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">without considering a particular field or specific round constants. Nevertheless, it considers the fact that each element in  <span class="math">\\mathbb{F}_{2^n}</span>  is also its inverse with respect to the addition. Since we do not instantiate any field and constants, the reported number of monomials might deviate from the real number of monomials here, e.g., due to unfortunate choices of round constants that sum to zero for some monomials. As a result, the entries in the tables are in fact upper bounds, but we do not expect high discrepancies between the numbers reported in the tables and the "real" ones.</p>

    <p class="text-gray-300">Prime Case. First, we consider iterations of the round function  <span class="math">f</span>  over  <span class="math">\\mathbb{F}_p</span> . In Tab. 2, we evaluate the output functions at  <span class="math">a_i</span> ,  <span class="math">b_i</span> , and  <span class="math">c_i</span>  depending on the inputs  <span class="math">a_0</span> ,  <span class="math">b_0</span> , and  <span class="math">c_0</span>  after a certain number of rounds  <span class="math">i \\geq 2</span> . We count in Tab. 2 the number of monomials for a certain multivariate degree up to a fixed degree  <span class="math">d_{\\mathbb{F}_p}</span> . Higher degree monomials might appear, but they are not presented in the table. To report this behavior, we do not input 0 in the table after the highest degree monomial. The column 'max' indicates the maximal number of monomials that can be encountered for three variables. As reported in Tab. 2, the number of monomials increases quite quickly, and we do not observe any unexpected behavior, or missing monomials of a certain degree.</p>

    <p class="text-gray-300">Binary Case. Tab. 3 provides the number of monomials of a certain degree in  <span class="math">\\mathbb{F}_{2^n}</span> . We notice that the diffusion is slower than in  <span class="math">\\mathbb{F}_p</span> , and it may be because of the behavior of the addition that is self inverse in  <span class="math">\\mathbb{F}_{2^n}</span> . More discussions on the algebraic cipher representation in the binary case can be found in App. D.</p>

    <p class="text-gray-300">In this section, we compare the performance of our design with other designs that are presented in the literature for an MPC protocol using masked operations. We mainly focus on the number of multiplications in an MPC setting, which is often the metric that influences the most the cost in such a protocol. In addition, we discuss the number of online and pre-computation/offline rounds, and we</p>

    <p class="text-gray-300">Table 3: Number of monomials of a certain degree for  <span class="math">{\\mathbb{F}}_{{2}^{n}}</span>  .</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Output</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Degree</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

          </tr>

        </thead>

        <tbody>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">0</td>

            <td class="px-3 py-2 border-b border-gray-700">1</td>

            <td class="px-3 py-2 border-b border-gray-700">2</td>

            <td class="px-3 py-2 border-b border-gray-700">3</td>

            <td class="px-3 py-2 border-b border-gray-700">4</td>

            <td class="px-3 py-2 border-b border-gray-700">5</td>

            <td class="px-3 py-2 border-b border-gray-700">6</td>

            <td class="px-3 py-2 border-b border-gray-700">7</td>

            <td class="px-3 py-2 border-b border-gray-700">8</td>

            <td class="px-3 py-2 border-b border-gray-700">9</td>

            <td class="px-3 py-2 border-b border-gray-700">10</td>

            <td class="px-3 py-2 border-b border-gray-700">11</td>

            <td class="px-3 py-2 border-b border-gray-700">12</td>

            <td class="px-3 py-2 border-b border-gray-700">13</td>

            <td class="px-3 py-2 border-b border-gray-700">14</td>

            <td class="px-3 py-2 border-b border-gray-700">15</td>

            <td class="px-3 py-2 border-b border-gray-700">16</td>

            <td class="px-3 py-2 border-b border-gray-700">17</td>

            <td class="px-3 py-2 border-b border-gray-700">18</td>

            <td class="px-3 py-2 border-b border-gray-700">19</td>

            <td class="px-3 py-2 border-b border-gray-700">20</td>

            <td class="px-3 py-2 border-b border-gray-700">21</td>

            <td class="px-3 py-2 border-b border-gray-700">22</td>

            <td class="px-3 py-2 border-b border-gray-700">23</td>

            <td class="px-3 py-2 border-b border-gray-700">24</td>

            <td class="px-3 py-2 border-b border-gray-700">25</td>

            <td class="px-3 py-2 border-b border-gray-700">26</td>

            <td class="px-3 py-2 border-b border-gray-700">27</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">max</td>

            <td class="px-3 py-2 border-b border-gray-700">1</td>

            <td class="px-3 py-2 border-b border-gray-700">3</td>

            <td class="px-3 py-2 border-b border-gray-700">6</td>

            <td class="px-3 py-2 border-b border-gray-700">10</td>

            <td class="px-3 py-2 border-b border-gray-700">15</td>

            <td class="px-3 py-2 border-b border-gray-700">21</td>

            <td class="px-3 py-2 border-b border-gray-700">28</td>

            <td class="px-3 py-2 border-b border-gray-700">36</td>

            <td class="px-3 py-2 border-b border-gray-700">45</td>

            <td class="px-3 py-2 border-b border-gray-700">55</td>

            <td class="px-3 py-2 border-b border-gray-700">66</td>

            <td class="px-3 py-2 border-b border-gray-700">78</td>

            <td class="px-3 py-2 border-b border-gray-700">91</td>

            <td class="px-3 py-2 border-b border-gray-700">105</td>

            <td class="px-3 py-2 border-b border-gray-700">120</td>

            <td class="px-3 py-2 border-b border-gray-700">136</td>

            <td class="px-3 py-2 border-b border-gray-700">153</td>

            <td class="px-3 py-2 border-b border-gray-700">171</td>

            <td class="px-3 py-2 border-b border-gray-700">190</td>

            <td class="px-3 py-2 border-b border-gray-700">210</td>

            <td class="px-3 py-2 border-b border-gray-700">231</td>

            <td class="px-3 py-2 border-b border-gray-700">253</td>

            <td class="px-3 py-2 border-b border-gray-700">276</td>

            <td class="px-3 py-2 border-b border-gray-700">300</td>

            <td class="px-3 py-2 border-b border-gray-700">325</td>

            <td class="px-3 py-2 border-b border-gray-700">351</td>

            <td class="px-3 py-2 border-b border-gray-700">378</td>

            <td class="px-3 py-2 border-b border-gray-700">406</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">2</td>

            <td class="px-3 py-2 border-b border-gray-700">a</td>

            <td class="px-3 py-2 border-b border-gray-700">1</td>

            <td class="px-3 py-2 border-b border-gray-700">3</td>

            <td class="px-3 py-2 border-b border-gray-700">4</td>

            <td class="px-3 py-2 border-b border-gray-700">2</td>

            <td class="px-3 py-2 border-b border-gray-700">1</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">b</td>

            <td class="px-3 py-2 border-b border-gray-700">1</td>

            <td class="px-3 py-2 border-b border-gray-700">3</td>

            <td class="px-3 py-2 border-b border-gray-700">4</td>

            <td class="px-3 py-2 border-b border-gray-700">2</td>

            <td class="px-3 py-2 border-b border-gray-700">1</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">c</td>

            <td class="px-3 py-2 border-b border-gray-700">1</td>

            <td class="px-3 py-2 border-b border-gray-700">3</td>

            <td class="px-3 py-2 border-b border-gray-700">4</td>

            <td class="px-3 py-2 border-b border-gray-700">2</td>

            <td class="px-3 py-2 border-b border-gray-700">1</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">3</td>

            <td class="px-3 py-2 border-b border-gray-700">a</td>

            <td class="px-3 py-2 border-b border-gray-700">1</td>

            <td class="px-3 py-2 border-b border-gray-700">3</td>

            <td class="px-3 py-2 border-b border-gray-700">6</td>

            <td class="px-3 py-2 border-b border-gray-700">7</td>

            <td class="px-3 py-2 border-b border-gray-700">7</td>

            <td class="px-3 py-2 border-b border-gray-700">3</td>

            <td class="px-3 py-2 border-b border-gray-700">3</td>

            <td class="px-3 py-2 border-b border-gray-700">0</td>

            <td class="px-3 py-2 border-b border-gray-700">1</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">b</td>

            <td class="px-3 py-2 border-b border-gray-700">1</td>

            <td class="px-3 py-2 border-b border-gray-700">3</td>

            <td class="px-3 py-2 border-b border-gray-700">6</td>

            <td class="px-3 py-2 border-b border-gray-700">7</td>

            <td class="px-3 py-2 border-b border-gray-700">7</td>

            <td class="px-3 py-2 border-b border-gray-700">3</td>

            <td class="px-3 py-2 border-b border-gray-700">3</td>

            <td class="px-3 py-2 border-b border-gray-700">0</td>

            <td class="px-3 py-2 border-b border-gray-700">1</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">c</td>

            <td class="px-3 py-2 border-b border-gray-700">1</td>

            <td class="px-3 py-2 border-b border-gray-700">3</td>

            <td class="px-3 py-2 border-b border-gray-700">6</td>

            <td class="px-3 py-2 border-b border-gray-700">7</td>

            <td class="px-3 py-2 border-b border-gray-700">7</td>

            <td class="px-3 py-2 border-b border-gray-700">3</td>

            <td class="px-3 py-2 border-b border-gray-700">3</td>

            <td class="px-3 py-2 border-b border-gray-700">0</td>

            <td class="px-3 py-2 border-b border-gray-700">1</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">4</td>

            <td class="px-3 py-2 border-b border-gray-700">a</td>

            <td class="px-3 py-2 border-b border-gray-700">1</td>

            <td class="px-3 py-2 border-b border-gray-700">3</td>

            <td class="px-3 py-2 border-b border-gray-700">6</td>

            <td class="px-3 py-2 border-b border-gray-700">9</td>

            <td class="px-3 py-2 border-b border-gray-700">15</td>

            <td class="px-3 py-2 border-b border-gray-700">14</td>

            <td class="px-3 py-2 border-b border-gray-700">19</td>

            <td class="px-3 py-2 border-b border-gray-700">12</td>

            <td class="px-3 py-2 border-b border-gray-700">13</td>

            <td class="px-3 py-2 border-b border-gray-700">5</td>

            <td class="px-3 py-2 border-b border-gray-700">6</td>

            <td class="px-3 py-2 border-b border-gray-700">2</td>

            <td class="px-3 py-2 border-b border-gray-700">3</td>

            <td class="px-3 py-2 border-b border-gray-700">0</td>

            <td class="px-3 py-2 border-b border-gray-700">0</td>

            <td class="px-3 py-2 border-b border-gray-700">0</td>

            <td class="px-3 py-2 border-b border-gray-700">1</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">b</td>

            <td class="px-3 py-2 border-b border-gray-700">1</td>

            <td class="px-3 py-2 border-b border-gray-700">3</td>

            <td class="px-3 py-2 border-b border-gray-700">6</td>

            <td class="px-3 py-2 border-b border-gray-700">9</td>

            <td class="px-3 py-2 border-b border-gray-700">15</td>

            <td class="px-3 py-2 border-b border-gray-700">14</td>

            <td class="px-3 py-2 border-b border-gray-700">19</td>

            <td class="px-3 py-2 border-b border-gray-700">12</td>

            <td class="px-3 py-2 border-b border-gray-700">13</td>

            <td class="px-3 py-2 border-b border-gray-700">5</td>

            <td class="px-3 py-2 border-b border-gray-700">6</td>

            <td class="px-3 py-2 border-b border-gray-700">2</td>

            <td class="px-3 py-2 border-b border-gray-700">3</td>

            <td class="px-3 py-2 border-b border-gray-700">0</td>

            <td class="px-3 py-2 border-b border-gray-700">0</td>

            <td class="px-3 py-2 border-b border-gray-700">0</td>

            <td class="px-3 py-2 border-b border-gray-700">1</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">c</td>

            <td class="px-3 py-2 border-b border-gray-700">1</td>

            <td class="px-3 py-2 border-b border-gray-700">3</td>

            <td class="px-3 py-2 border-b border-gray-700">6</td>

            <td class="px-3 py-2 border-b border-gray-700">9</td>

            <td class="px-3 py-2 border-b border-gray-700">15</td>

            <td class="px-3 py-2 border-b border-gray-700">14</td>

            <td class="px-3 py-2 border-b border-gray-700">19</td>

            <td class="px-3 py-2 border-b border-gray-700">12</td>

            <td class="px-3 py-2 border-b border-gray-700">13</td>

            <td class="px-3 py-2 border-b border-gray-700">5</td>

            <td class="px-3 py-2 border-b border-gray-700">6</td>

            <td class="px-3 py-2 border-b border-gray-700">2</td>

            <td class="px-3 py-2 border-b border-gray-700">3</td>

            <td class="px-3 py-2 border-b border-gray-700">0</td>

            <td class="px-3 py-2 border-b border-gray-700">0</td>

            <td class="px-3 py-2 border-b border-gray-700">0</td>

            <td class="px-3 py-2 border-b border-gray-700">1</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">5</td>

            <td class="px-3 py-2 border-b border-gray-700">a</td>

            <td class="px-3 py-2 border-b border-gray-700">1</td>

            <td class="px-3 py-2 border-b border-gray-700">3</td>

            <td class="px-3 py-2 border-b border-gray-700">6</td>

            <td class="px-3 py-2 border-b border-gray-700">9</td>

            <td class="px-3 py-2 border-b border-gray-700">15</td>

            <td class="px-3 py-2 border-b border-gray-700">18</td>

            <td class="px-3 py-2 border-b border-gray-700">28</td>

            <td class="px-3 py-2 border-b border-gray-700">28</td>

            <td class="px-3 py-2 border-b border-gray-700">39</td>

            <td class="px-3 py-2 border-b border-gray-700">35</td>

            <td class="px-3 py-2 border-b border-gray-700">41</td>

            <td class="px-3 py-2 border-b border-gray-700">36</td>

            <td class="px-3 py-2 border-b border-gray-700">39</td>

            <td class="px-3 py-2 border-b border-gray-700">24</td>

            <td class="px-3 py-2 border-b border-gray-700">26</td>

            <td class="px-3 py-2 border-b border-gray-700">16</td>

            <td class="px-3 py-2 border-b border-gray-700">19</td>

            <td class="px-3 py-2 border-b border-gray-700">9</td>

            <td class="px-3 py-2 border-b border-gray-700">10</td>

            <td class="px-3 py-2 border-b border-gray-700">7</td>

            <td class="px-3 py-2 border-b border-gray-700">9</td>

            <td class="px-3 py-2 border-b border-gray-700">3</td>

            <td class="px-3 py-2 border-b border-gray-700">3</td>

            <td class="px-3 py-2 border-b border-gray-700">0</td>

            <td class="px-3 py-2 border-b border-gray-700">3</td>

            <td class="px-3 py-2 border-b border-gray-700">0</td>

            <td class="px-3 py-2 border-b border-gray-700">0</td>

            <td class="px-3 py-2 border-b border-gray-700">0</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">b</td>

            <td class="px-3 py-2 border-b border-gray-700">1</td>

            <td class="px-3 py-2 border-b border-gray-700">3</td>

            <td class="px-3 py-2 border-b border-gray-700">6</td>

            <td class="px-3 py-2 border-b border-gray-700">9</td>

            <td class="px-3 py-2 border-b border-gray-700">15</td>

            <td class="px-3 py-2 border-b border-gray-700">18</td>

            <td class="px-3 py-2 border-b border-gray-700">28</td>

            <td class="px-3 py-2 border-b border-gray-700">28</td>

            <td class="px-3 py-2 border-b border-gray-700">39</td>

            <td class="px-3 py-2 border-b border-gray-700">35</td>

            <td class="px-3 py-2 border-b border-gray-700">41</td>

            <td class="px-3 py-2 border-b border-gray-700">36</td>

            <td class="px-3 py-2 border-b border-gray-700">39</td>

            <td class="px-3 py-2 border-b border-gray-700">24</td>

            <td class="px-3 py-2 border-b border-gray-700">26</td>

            <td class="px-3 py-2 border-b border-gray-700">16</td>

            <td class="px-3 py-2 border-b border-gray-700">19</td>

            <td class="px-3 py-2 border-b border-gray-700">9</td>

            <td class="px-3 py-2 border-b border-gray-700">10</td>

            <td class="px-3 py-2 border-b border-gray-700">7</td>

            <td class="px-3 py-2 border-b border-gray-700">9</td>

            <td class="px-3 py-2 border-b border-gray-700">3</td>

            <td class="px-3 py-2 border-b border-gray-700">3</td>

            <td class="px-3 py-2 border-b border-gray-700">0</td>

            <td class="px-3 py-2 border-b border-gray-700">3</td>

            <td class="px-3 py-2 border-b border-gray-700">0</td>

            <td class="px-3 py-2 border-b border-gray-700">0</td>

            <td class="px-3 py-2 border-b border-gray-700">0</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">c</td>

            <td class="px-3 py-2 border-b border-gray-700">1</td>

            <td class="px-3 py-2 border-b border-gray-700">3</td>

            <td class="px-3 py-2 border-b border-gray-700">6</td>

            <td class="px-3 py-2 border-b border-gray-700">9</td>

            <td class="px-3 py-2 border-b border-gray-700">15</td>

            <td class="px-3 py-2 border-b border-gray-700">18</td>

            <td class="px-3 py-2 border-b border-gray-700">28</td>

            <td class="px-3 py-2 border-b border-gray-700">28</td>

            <td class="px-3 py-2 border-b border-gray-700">39</td>

            <td class="px-3 py-2 border-b border-gray-700">35</td>

            <td class="px-3 py-2 border-b border-gray-700">41</td>

            <td class="px-3 py-2 border-b border-gray-700">36</td>

            <td class="px-3 py-2 border-b border-gray-700">39</td>

            <td class="px-3 py-2 border-b border-gray-700">24</td>

            <td class="px-3 py-2 border-b border-gray-700">26</td>

            <td class="px-3 py-2 border-b border-gray-700">16</td>

            <td class="px-3 py-2 border-b border-gray-700">19</td>

            <td class="px-3 py-2 border-b border-gray-700">9</td>

            <td class="px-3 py-2 border-b border-gray-700">10</td>

            <td class="px-3 py-2 border-b border-gray-700">7</td>

            <td class="px-3 py-2 border-b border-gray-700">9</td>

            <td class="px-3 py-2 border-b border-gray-700">3</td>

            <td class="px-3 py-2 border-b border-gray-700">3</td>

            <td class="px-3 py-2 border-b border-gray-700">0</td>

            <td class="px-3 py-2 border-b border-gray-700">3</td>

            <td class="px-3 py-2 border-b border-gray-700">0</td>

            <td class="px-3 py-2 border-b border-gray-700">0</td>

            <td class="px-3 py-2 border-b border-gray-700">0</td>

          </tr>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">compare those numbers to the ones specified for other schemes. The influence of the last two metrics on the overall costs highly varies depending on the concrete protocol/application, and the concrete environment, in which an MPC protocol is used, e.g., network of computers vs. a system on chip. Finally, we consider the advantages and the disadvantages of our design w.r.t. the other ones.</p>

    <p class="text-gray-300">We compare the MPC cost of CIMINION with the cost of other designs that are published in the literature with  <span class="math">q \\approx 2^{128}</span> , and  <span class="math">s = 128</span>  bits. We assume that the amount of data available to the attacker is fixed to  <span class="math">2^{s/2} = 2^{64}</span> , which is the most common case. Due to page limitation, we limit our analysis to CIMINION and HadesMiMC. The latter is the main competitive design currently present in the literature for the analyzed application. The detailed comparison with other designs (including MiMC, GMiMC, Rescue and Vision) is provided in App. G. A summary of the comparison is given in Tab. 4 and 5 for the binary and prime case, respectively.</p>

    <p class="text-gray-300">Our design has the lowest minimum number of multiplications w.r.t. all other designs, in both  <span class="math">\\mathbb{F}_p</span>  and  <span class="math">\\mathbb{F}_{2^n}</span> . In  <span class="math">(\\mathbb{F}_q)^t</span>  for  <span class="math">q \\approx 2^{128}</span> , our design needs approximately  <span class="math">t + 14 \\cdot \\lceil t / 2 \\rceil \\approx 8 \\cdot t</span>  multiplications w.r.t.  <span class="math">12 \\cdot t</span>  multiplications required by HadesMiMC or  <span class="math">60 \\cdot t</span>  by Rescue. Additionally, our design has a low number of linear operations compared to other designs. For instance, for large  <span class="math">t \\gg 1</span> , our design needs approximately  <span class="math">50 \\cdot t</span>  affine operations (sums and multiplications with constants) while HadesMiMC requires approximately  <span class="math">12 \\cdot t^2 + (157 + 4 \\cdot \\max\\{32; \\lceil \\log_3(t) \\rceil\\}) \\cdot t</span>  affine operations. However, this advantage comes at the price of having more online rounds than the other schemes. In particular,  <span class="math">104 + \\lceil t / 2 \\rceil</span>  online rounds are required by our design whereas HadesMiMC and Rescue have respectively 78 and 20 online rounds.</p>

    <p class="text-gray-300">Ciminion. For  <span class="math">q \\approx 2^{128}</span> , and a security level of 128 bits with data limited to  <span class="math">2^{64}</span> , the permutation  <span class="math">p_C</span>  counts 90 rounds. In order to output  <span class="math">2t&#x27; - 1 \\leq t \\leq 2t&#x27;</span></p>

    <p class="text-gray-300">Table 4: Comparison on the MPC cost of schemes over  <span class="math">\\mathbb{F}_{2^n}^t</span>  for  <span class="math">n = 128</span>  (or 129), and a security level of 128 bits. With the exception of Vision (whose number of offline rounds is equal to  <span class="math">\\max \\left\\{20,2\\cdot \\left\\lceil \\frac{136 + t}{t}\\right\\rceil \\right\\}</span> ), the number of offline rounds for all other schemes is zero.</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Scheme</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Multiplications (MPC)</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Online Rounds</th>

          </tr>

        </thead>

        <tbody>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">element in F2nt</td>

            <td class="px-3 py-2 border-b border-gray-700">asymptotically (t≫1)</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">CIMINION</td>

            <td class="px-3 py-2 border-b border-gray-700">8·t+89</td>

            <td class="px-3 py-2 border-b border-gray-700">8</td>

            <td class="px-3 py-2 border-b border-gray-700">104 + [t/2]</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">MiMC-CTR</td>

            <td class="px-3 py-2 border-b border-gray-700">164·t</td>

            <td class="px-3 py-2 border-b border-gray-700">164</td>

            <td class="px-3 py-2 border-b border-gray-700">82</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">Vision</td>

            <td class="px-3 py-2 border-b border-gray-700">t·max{70,7·[136+t/t]}</td>

            <td class="px-3 py-2 border-b border-gray-700">70</td>

            <td class="px-3 py-2 border-b border-gray-700">max{50,5·[136+t/t]}</td>

          </tr>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">Table 5: Comparison on the MPC cost of schemes over  <span class="math">\\mathbb{F}_p^t</span>  for  <span class="math">p\\approx 2^{128}</span> , and a security level of  <span class="math">\\approx 128</span>  bits. With the exception of Rescue (whose number of offline rounds is equal to  <span class="math">\\max \\{30;6\\cdot \\left\\lceil \\frac{32.5}{t}\\right\\rceil \\}</span> ), the number of offline rounds for all other schemes is zero.</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Scheme</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Multiplications (MPC)</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Online Rounds</th>

          </tr>

        </thead>

        <tbody>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">element in Fpt</td>

            <td class="px-3 py-2 border-b border-gray-700">asymptotically (t≫1)</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">CIMINION</td>

            <td class="px-3 py-2 border-b border-gray-700">14·[t/2] + t + 89</td>

            <td class="px-3 py-2 border-b border-gray-700">8</td>

            <td class="px-3 py-2 border-b border-gray-700">104 + [t/2]</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">MiMC-CTR</td>

            <td class="px-3 py-2 border-b border-gray-700">164·t</td>

            <td class="px-3 py-2 border-b border-gray-700">164</td>

            <td class="px-3 py-2 border-b border-gray-700">82</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">GMiMCerf</td>

            <td class="px-3 py-2 border-b border-gray-700">4 + 4t + max{4t2,320}</td>

            <td class="px-3 py-2 border-b border-gray-700">4·t</td>

            <td class="px-3 py-2 border-b border-gray-700">2 + 2t + max{2t2,160}</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">Rescue (α = 3)</td>

            <td class="px-3 py-2 border-b border-gray-700">t·max{60;12·[32.5/t]}</td>

            <td class="px-3 py-2 border-b border-gray-700">60</td>

            <td class="px-3 py-2 border-b border-gray-700">max{20;4·[32.5/t]}</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">HadesMiMC</td>

            <td class="px-3 py-2 border-b border-gray-700">12t + max{78 + [log3(t2)];142}</td>

            <td class="px-3 py-2 border-b border-gray-700">12</td>

            <td class="px-3 py-2 border-b border-gray-700">max{45 + [log3(t)];77}</td>

          </tr>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">words, we call  <span class="math">t&#x27;</span>  times the permutation  <span class="math">p_E</span>  that is composed of 14 rounds, and  <span class="math">(t&#x27; - 1)</span>  times the rolling function. Therefore, for the binary and the prime case, the cost of CIMINION in MPC applications to generate  <span class="math">t</span>  words is</p>

    <p class="text-gray-300">online rounds:  <span class="math">104 + \\lceil t / 2\\rceil</span></p>

    <p class="text-gray-300">The number of online rounds depends on  <span class="math">t</span> , because the rolling function is serial. It is noteworthy that the expansion part can be performed in parallel. We emphasize that the number of sums and multiplications with a constant <span class="math">^9</span>  (denoted as "affine" operations) is proportional to the number of multiplications. That is one of the main differences w.r.t. to the Hades construction as we argue afterwards.</p>

    <p class="text-gray-300">HadesMiMC. HadesMiMC [40] is a block cipher that is proposed over  <span class="math">(\\mathbb{F}_p)^t</span>  for a prime  <span class="math">p</span>  such that  <span class="math">\\gcd(p - 1, 3) = 1</span> , and  <span class="math">t \\geq 2</span> . It combines  <span class="math">R_F = 2R_f</span>  rounds with a full S-box layer ( <span class="math">R_f</span>  at the beginning, and  <span class="math">R_f</span>  at the end), and  <span class="math">R_P</span>  rounds with a partial S-box layer in the middle. Each round is defined with  <span class="math">R_i(x) = k_i + M \\times S(x)</span> , where  <span class="math">M</span>  is a  <span class="math">t \\times t</span>  MDS matrix, and  <span class="math">S</span>  is the S-box layer. This layer is defined as the concatenation of  <span class="math">t</span>  cube S-boxes in the rounds</p>

    <p class="text-gray-300">with full layer, and as the concatenation of one cube S-Box and <span class="math">t-1</span> identity functions in the rounds with partial layer.</p>

    <p class="text-gray-300">In addition, hash functions can be obtained by instantiating a Sponge construction with the Hades permutation, and a fixed key, like Poseidon & Starkad <em>[39]</em>. In <em>[15]</em>, the authors present an attack on Starkad that exploits a weakness in the matrix <span class="math">M</span> that defines the MixLayer. The attack takes advantage of the equation <span class="math">M^{2}=\\mu\\cdot I</span>. This attack can be prevented by carefully choosing the MixLayer (we refer to <em>[43]</em> for further detail). There is no attack that is based on an analogous strategy that has been proposed for the cipher.</p>

    <p class="text-gray-300">In order to guarantee some security, <span class="math">R_{F}</span> and <span class="math">R_{P}</span> must satisfy a list of inequalities <em>[40]</em>. There are several combinations of <span class="math">(R_{F},R_{P})</span> that can provide the same level of security. In that regard, authors of <em>[40]</em> present a tool that makes it possible to find the best combination that guarantees security, and minimizes the computational cost. For a security level of approximately <span class="math">\\log_{2}(p)</span> bits, and with <span class="math">\\log_{2}(p)\\gg t</span>, the combination <span class="math">(R_{F},R_{P})</span> minimizing the overall number of multiplications is</p>

    <p class="text-gray-300"><span class="math">(R_{F},R_{P})\\!=\\!\\left(\\!\\!6,\\max\\left\\{\\left\\lceil\\frac{\\log_{3}(p)}{2}\\right\\rceil+\\left\\lceil\\log_{3}(t)\\right\\rceil;\\left\\lceil\\log_{3}(p)\\right\\rceil-2\\lfloor\\log_{3}(\\log_{2}(p))\\rfloor\\right\\}-2\\right).</span></p>

    <p class="text-gray-300">In MPC applications (<span class="math">p\\approx 2^{128}</span> and <span class="math">s=128</span> bits), the cost of HadesMiMC is</p>

    <p class="text-gray-300"><span class="math">\\#</span> multiplications: <span class="math">2\\cdot(t\\cdot R_{F}+R_{P})=12t+\\max\\{78+\\left\\lceil\\log_{3}(t^{2})\\right\\rceil;142\\}\\,,</span> <span class="math">\\#</span> online rounds: <span class="math">R_{F}+R_{P}=\\max\\{45+\\left\\lceil\\log_{3}(t)\\right\\rceil;77\\}\\,,</span> <span class="math">\\#</span> affine operations: <span class="math">2\\cdot t^{2}\\cdot R_{F}+(4\\cdot R_{P}+1)\\cdot t-2\\cdot R_{P}</span> <span class="math">\\approx 12\\cdot t^{2}+(157+4\\cdot\\max\\{32;\\left\\lceil\\log_{3}(t)\\right\\rceil\\})\\cdot t\\,.</span></p>

    <p class="text-gray-300">Parallel S-boxes can be computed in a single online round. To compute the number of affine operations, we considered an equivalent representation of the cipher in which the MixLayer of the rounds, with a partial S-box layer, is defined by a matrix. In this matrix, only <span class="math">3t-2</span> entries are different from zero, that is to say the ones in the first column, in the first row , and in the first diagonal. (A <span class="math">(t-1)\\times(t-1)</span> submatrix is an identity matrix.) The details are presented in <em>[40, App. A]</em>. Therefore, the total number of affine operations required grows quadratically w.r.t. the number of rounds with full S-box layer, and thus w.r.t. the number of multiplications.</p>

    <p class="text-gray-300">Finally, we highlight that the number of multiplications is minimized when HadesMiMC takes as input the entire message. Indeed, let us assume that the input message is split into several parts, and that HadesMiMC is used in CTR mode (as suggested by the designers). In the analyzed case in which the security level is of the same order of the size of the field <span class="math">p</span>, the number of rounds is</p>

    <p class="text-gray-300">almost constant, and independent of the parameter <span class="math">t\\geq 2</span>. It follows that using HadesMiMC in CTR mode would require more multiplications, because every process requires the computation of the rounds with a partial S-box layer, whereas this computation is needed only once when the message size equals the block size. We stress that a similar conclusion holds for Rescue/Vision, for which the total number of multiplications would barely change when they are used in CTR mode, rather than when the message size is equal to the block size.</p>

    <h3 id="sec-25" class="text-xl font-semibold mt-8">5.2 Ciminion versus Hades: Advantages and Similarities</h3>

    <p class="text-gray-300">The previous comparison highlights that the two most competitive designs for MPC applications with a low multiplicative complexity are Ciminion and HadesMiMC. Referring to Fig. 1, we further develop the similarities and advantages between a block cipher based on a Hades design, and a cipher based on Farfalle. We present a brief comparison between our new design and the “ForkCipher” design that is proposed in <em>[7]</em> in App. G.2.</p>

    <p class="text-gray-300">Similarities: Distribution of the S-Boxes. We focus our attention on the distribution of the S-boxes, or more generally, the non-linear operations. Both strategies employ a particular parallelization of the non-linear operations/S-boxes to their advantage, in order to minimize the number of non-linear operations. More precisely, each step is composed of <span class="math">t</span> parallel non-linear operations in the external rounds, i.e., the rounds at the end and at the beginning. Furthermore, each step is composed of a single non-linear operation in the internal rounds.</p>

    <p class="text-gray-300">Both strategies take advantage of an attacker that cannot directly access the state in the middle rounds, because the state is masked both by the external rounds or phases, and by the presence of a key. In a Farfalle design, the attacker knows that each output of the expansion phase always employs the same value at the input, without accessing those inputs. In a Hades design, the attacker is able to skip some rounds with a partial S-box layer by carefully choosing the texts (see <em>[15]</em>). However, they cannot access the texts without bypassing the rounds with the full S-box layer that depends on the key.</p>

    <p class="text-gray-300">Having middle rounds with a single S-box makes it possible to reduce the overall number of non-linear operations. In addition, they ensure some security against algebraic attacks. Indeed, even a single S-box makes it possible to increase the overall degree of the scheme. For a concrete example, let <span class="math">(R_{c},R_{m},R_{e})</span> be the rounds for respectively the compression part, middle part and expansion part of Farfalle. Like previously, let <span class="math">(R_{F},R_{P})</span> be the number of rounds with respectively a full and a partial S-box layer in Hades. The number of multiplications is respectively <span class="math">(R_{c}+R_{e})\\cdot t+R_{m}</span> and <span class="math">R_{F}\\cdot t+R_{P}</span>. If <span class="math">R_{P}\\gg R_{F}</span> and <span class="math">R_{m}\\gg R_{c}+R_{e}</span>. For a similar number of round, i.e., proportional to <span class="math">\\approx R_{P}+R_{F}</span> or/and <span class="math">\\approx R_{m}+R_{c}+R_{e}</span>, it is then necessary to reach the maximum degree. Our number of multiplications is lower compared to a classical design where the rounds have a full S-box layer.</p>

    <p class="text-gray-300">Advantages. There are major differences between Farfalle-like designs and Hades-like designs, because of their primary intention. The Farfalle-like design aims to behave like a Pseudo-Random Function (PRF), and the Hades-like design like a Pseudo-Random Permutation (PRP). The latter is used as a PRF in</p>

    <p class="text-gray-300">the Counter mode (CTR). Under the assumption that affine operations are cheaper than non-linear ones, designers of Hades defined the MixLayer as the multiplication with a <span class="math">t\\times t</span> MDS matrix. Consequently, each round with full S-box layer counts <span class="math">t^{2}</span> multiplications with constants. However, when <span class="math">t\\gg 1</span>, linear operations cannot be considered as free anymore, and their presences influence the overall performance.</p>

    <p class="text-gray-300">This problem is not present in a Farfalle-like design. Indeed, by construction, in the first <span class="math">R_{c}</span> and the last <span class="math">R_{e}</span> rounds, the MixLayer is not required. That implies that the first three words are never mixed with the following ones. On the contrary, the elements are simply added together to generate the input of the compression phase. In addition, the expansion part’s input is generated through a non-linear rolling function whose cost grows linearly with <span class="math">t</span>. Finally, since invertibility is not required, the number of input words can be lower than the number of output words to design a function from <span class="math">(\\mathbb{F}_{q})^{3}</span> to <span class="math">(\\mathbb{F}_{q})^{t}</span> for any <span class="math">t\\geq 1</span>. Thus, independently of the number of output words, one multiplication per round is present in the compression phase, contrary to <span class="math">\\mathcal{O}(t)</span> of a Hades-like scheme.</p>

    <h4 id="sec-26" class="text-lg font-semibold mt-6">Acknowledgements.</h4>

    <p class="text-gray-300">We thank Joan Daemen for his guidance and support and the reviewers of Eurocrypt 2021 for their valuable comments that improved the paper. This work has been supported in part by the European Research Council under the ERC advanced grant agreement under grant ERC-2017-ADG Nr. 788980 ESCADA, the European Research Council (ERC) under the European Union’s Horizon 2020 research and innovation programme (grant agreement No 681402), and the Austrian Science Fund (FWF): J 4277-N38.</p>

    <h2 id="sec-27" class="text-2xl font-bold">References</h2>

    <ul class="list-disc list-inside space-y-1 text-gray-300 my-2 ml-4">

      <li>[1] Albrecht, M.R., Cid, C., Grassi, L., Khovratovich, D., Lüftenegger, R., Rechberger, C., Schofnegger, M.: Algebraic Cryptanalysis of STARK-Friendly Designs: Application to MARVELlous and MiMC. In: ASIACRYPT. LNCS, vol. 11923, pp. 371–397. Springer (2019)</li>

      <li>[2] Albrecht, M.R., Grassi, L., Perrin, L., Ramacher, S., Rechberger, C., Rotaru, D., Roy, A., Schofnegger, M.: Feistel Structures for MPC, and More. In: ESORICS. LNCS, vol. 11736, pp. 151–171. Springer (2019)</li>

      <li>[3] Albrecht, M.R., Grassi, L., Rechberger, C., Roy, A., Tiessen, T.: MiMC: Efficient Encryption and Cryptographic Hashing with Minimal Multiplicative Complexity. In: ASIACRYPT. LNCS, vol. 10031, pp. 191–219 (2016)</li>

      <li>[4] Albrecht, M.R., Rechberger, C., Schneider, T., Tiessen, T., Zohner, M.: Ciphers for MPC and FHE. In: EUROCRYPT. LNCS, vol. 9056, pp. 430–454 (2015)</li>

      <li>[5] Aly, A., Ashur, T., Ben-Sasson, E., Dhooghe, S., Szepieniec, A.: Design of Symmetric-Key Primitives for Advanced Cryptographic Protocols. Cryptology ePrint Archive, Report 2019/426 (2019)</li>

      <li>[6] Aly, A., Ashur, T., Ben-Sasson, E., Dhooghe, S., Szepieniec, A.: Design of Symmetric-Key Primitives for Advanced Cryptographic Protocols. IACR Trans. Symmetric Cryptol. 2020(3), 1–45 (2020)</li>

      <li>[</li>

    </ul>

    <p class="text-gray-300">7] Andreeva, E., Lallemand, V., Purnal, A., Reyhanitabar, R., Roy, A., Vizár, D.: Forkcipher: A New Primitive for Authenticated Encryption of Very Short Messages. In: ASIACRYPT. LNCS, vol. 11922, pp. 153–182. Springer (2019)</p>

    <ul class="list-disc list-inside space-y-1 text-gray-300 my-2 ml-4">

      <li>[8] Ashur, T., Dhooghe, S.: MARVELlous: a STARK-Friendly Family of Cryptographic Primitives. Cryptology ePrint Archive, Report 2018/1098 (2018)</li>

      <li>[9] Baignères, T., Stern, J., Vaudenay, S.: Linear Cryptanalysis of Non Binary Ciphers. In: SAC. pp. 184–211 (2007)</li>

      <li>[10] Bar-Ilan, J., Beaver, D.: Non-Cryptographic Fault-Tolerant Computing in Constant Number of Rounds of Interaction. In: ACM Symposium. pp. 201–209. ACM (1989)</li>

      <li>[11] Bardet, M., Faugère, J., Salvy, B.: On the complexity of the F5 Gröbner basis algorithm. J. Symb. Comput. 70, 49–70 (2015)</li>

      <li>[12] Bertoni, G., Daemen, J., Hoffert, S., Peeters, M., Van Assche, G., Van Keer, R.: Farfalle: parallel permutation-based cryptography. IACR Trans. Symmetric Cryptol. 2017(4), 1–38 (2017)</li>

      <li>[13] Bertoni, G., Daemen, J., Peeters, M., Van Assche, G.: Sponge functions. Ecrypt Hash Workshop 2007 (2007)</li>

      <li>[14] Bertoni, G., Daemen, J., Peeters, M., Van Assche, G.: The Keccak SHA-3 submission (Version 3.0) (2011)</li>

      <li>[15] Beyne, T., Canteaut, A., Dinur, I., Eichlseder, M., Leander, G., Leurent, G., Naya-Plasencia, M., Perrin, L., Sasaki, Y., Todo, Y., Wiemer, F.: Out of Oddity – New Cryptanalytic Techniques against Symmetric Primitives Optimized for Integrity Proof Systems. In: CRYPTO. LNCS, vol. 12172, pp. 299–328. Springer (2020)</li>

      <li>[16] Biham, E., Biryukov, A., Shamir, A.: Cryptanalysis of Skipjack Reduced to 31 Rounds Using Impossible Differentials. In: EUROCRYPT. LNCS, vol. 1592, pp. 12–23. Springer (1999)</li>

      <li>[17] Biham, E., Shamir, A.: Differential Cryptanalysis of DES-like Cryptosystems. In: CRYPTO. LNCS, vol. 537, pp. 2–21. Springer (1990)</li>

      <li>[18] Bogdanov, A., Wang, M.: Zero Correlation Linear Cryptanalysis with Reduced Data Complexity. In: FSE. LNCS, vol. 7549, pp. 29–48. Springer (2012)</li>

      <li>[19] Bonnetain, X.: Collisions on Feistel-MiMC and univariate GMiMC. Cryptology ePrint Archive, Report 2019/951 (2019)</li>

      <li>[20] Boura, C., Canteaut, A., De Cannière, C.: Higher-Order Differential Properties of Keccak and <em>Luffa</em>. In: FSE. LNCS, vol. 6733, pp. 252–269. Springer (2011)</li>

      <li>[21] Buchberger, B.: A theoretical basis for the reduction of polynomials to canonical forms. SIGSAM Bull. 10(3), 19–29 (1976)</li>

      <li>[22] Canteaut, A., Carpov, S., Fontaine, C., Lepoint, T., Naya-Plasencia, M., Paillier, P., Sirdey, R.: Stream Ciphers: A Practical Solution for Efficient Homomorphic-Ciphertext Compression. J. Cryptology 31(3), 885–916 (2018)</li>

      <li>[23] Carter, L., Wegman, M.N.: Universal Classes of Hash Functions (Extended Abstract). In: STOC. pp. 106–112. ACM (1977)</li>

      <li>[24] Daemen, J.: Cipher and hash function design, strategies based on linear and differential cryptanalysis, PhD Thesis. K.U.Leuven (1995)</li>

      <li>[25] Daemen, J., Govaerts, R., Vandewalle, J.: Correlation Matrices. In: FSE. LNCS, vol. 1008, pp. 275–285 (1994)</li>

      <li>[26] Daemen, J., Hoffert, S., Van Assche, G., Van Keer, R.: The design of Xoodoo and Xoofff. IACR Trans. Symmetric Cryptol. 2018(4), 1–38 (2018)</li>

      <li>[27] Daemen, J., Rijmen, V.: The Block Cipher Rijndael. In: CARDIS. LNCS, vol. 1820, pp. 277–284 (1998)</li>

      <li>[28] Daemen, J., Rijmen, V.: The Design of Rijndael: AES - The Advanced Encryption Standard. Information Security and Cryptography, Springer (2002)</li>

    </ul>

    <ul class="list-disc list-inside space-y-1 text-gray-300 my-2 ml-4">

      <li>[29] Daemen, J., Rijmen, V.: The Design of Rijndael: The Advanced Encryption Standard (AES), chap. Correlation Analysis in GF(2n), pp. 181–194. Springer (2020)</li>

      <li>[30] Damgård, I., Fazio, N., Nicolosi, A.: Non-interactive Zero-Knowledge from Homomorphic Encryption. In: TCC. LNCS, vol. 3876, pp. 41–59 (2006)</li>

      <li>[31] Dinur, I., Kales, D., Promitzer, A., Ramacher, S., Rechberger, C.: Linear Equivalence of Block Ciphers with Partial Non-Linear Layers: Application to LowMC. In: EUROCRYPT. LNCS, vol. 11476, pp. 343–372. Springer (2019)</li>

      <li>[32] Dinur, I., Liu, Y., Meier, W., Wang, Q.: Optimized Interpolation Attacks on LowMC. In: ASIACRYPT. LNCS, vol. 9453, pp. 535–560. Springer (2015)</li>

      <li>[33] Dobraunig, C., Eichlseder, M., Grassi, L., Lallemand, V., Leander, G., List, E., Mendel, F., Rechberger, C.: Rasta: A Cipher with Low ANDdepth and Few ANDs per Bit. In: CRYPTO. LNCS, vol. 10991, pp. 662–692 (2018)</li>

      <li>[34] Duval, S., Lallemand, V., Rotella, Y.: Cryptanalysis of the FLIP Family of Stream Ciphers. In: CRYPTO. LNCS, vol. 9814, pp. 457–475. Springer (2016)</li>

      <li>[35] Eichlseder, M., Grassi, L., Lüftenegger, R., Øygarden, M., Rechberger, C., Schofnegger, M., Wang, Q.: An Algebraic Attack on Ciphers with Low-Degree Round Functions: Application to Full MiMC. In: ASIACRYPT. LNCS, vol. 12491, pp. 477–506. Springer (2020)</li>

      <li>[36] Faugère, J.C.: A new efficient algorithm for computing Gröbner bases without reduction to zero F5. In: ISSAC. pp. 75–83. ACM (2002)</li>

      <li>[37] Faugère, J., Gianni, P.M., Lazard, D., Mora, T.: Efficient Computation of Zero-Dimensional Gröbner Bases by Change of Ordering. J. Symb. Comput. 16(4), 329–344 (1993)</li>

      <li>[38] Genovese, G.: Improving the algorithms of Berlekamp and Niederreiter for factoring polynomials over finite fields. J. Symb. Comput. 42(1-2), 159–177 (2007)</li>

      <li>[39] Grassi, L., Khovratovich, D., Rechberger, C., Roy, A., Schofnegger, M.: Poseidon: A New Hash Function for Zero-Knowledge Proof Systems. In: USENIX Security 21. USENIX Association (2021)</li>

      <li>[40] Grassi, L., Lüftenegger, R., Rechberger, C., Rotaru, D., Schofnegger, M.: On a Generalization of Substitution-Permutation Networks: The HADES Design Strategy. In: EUROCRYPT. LNCS, vol. 12106, pp. 674–704 (2020)</li>

      <li>[41] Grassi, L., Rechberger, C., Rønjom, S.: A New Structural-Differential Property of 5-Round AES. In: EUROCRYPT. LNCS, vol. 10211, pp. 289–317 (2017)</li>

      <li>[42] Grassi, L., Rechberger, C., Rotaru, D., Scholl, P., Smart, N.P.: MPC-Friendly Symmetric Key Primitives. In: CCS. pp. 430–443. ACM (2016)</li>

      <li>[43] Grassi, L., Rechberger, C., Schofnegger, M.: Weak Linear Layers in Word-Oriented Partial SPN and HADES-Like Ciphers. Cryptology ePrint Archive, Report 2020/500 (2020)</li>

      <li>[44] Grosso, V., Standaert, F., Faust, S.: Masking vs. multiparty computation: how large is the gap for AES? J. Cryptographic Engineering 4(1), 47–57 (2014)</li>

      <li>[45] Ishai, Y., Sahai, A., Wagner, D.A.: Private Circuits: Securing Hardware against Probing Attacks. In: CRYPTO. LNCS, vol. 2729, pp. 463–481. Springer (2003)</li>

      <li>[46] Jakobsen, T., Knudsen, L.R.: The Interpolation Attack on Block Ciphers. In: FSE. LNCS, vol. 1267, pp. 28–40. Springer (1997)</li>

      <li>[47] Knudsen, L.R.: Truncated and Higher Order Differentials. In: FSE. LNCS, vol. 1008, pp. 196–211. Springer (1994)</li>

      <li>[48] Knudsen, L.R.: DEAL – A 128-bit Block Cipher. (1998)</li>

      <li>[49] Lai, X.: Higher Order Derivatives and Differential Cryptanalysis. In: Communications and Cryptography: Two Sides of One Tapestry. pp. 227–233. Springer US (1994)</li>

    </ul>

    <ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">

      <li>Langford, S.K., Hellman, M.E.: Differential-Linear Cryptanalysis. In: CRYPTO. LNCS, vol. 839, pp. 17–25. Springer (1994)</li>

    </ol>

    <ul class="list-disc list-inside space-y-1 text-gray-300 my-2 ml-4">

      <li>51. Matsui, M.: Linear Cryptanalysis Method for DES Cipher. In: EUROCRYPT. LNCS, vol. 765, pp. 386–397 (1993)</li>

      <li>52. McGrew, D.A., Viega, J.: The Security and Performance of the Galois/Counter Mode of Operation (Full Version). Cryptology ePrint Archive, Report 2004/193 (2004)</li>

      <li>53. Méaux, P., Journault, A., Standaert, F., Carlet, C.: Towards Stream Ciphers for Efficient FHE with Low-Noise Ciphertexts. In: EUROCRYPT. LNCS, vol. 9665, pp. 311–343. Springer (2016)</li>

      <li>54. NIST: FIPS PUB 202: SHA-3 Standard: Permutation-Based Hash and Extendable-Output Functions (August 2015)</li>

      <li>55. Nyberg, K., Knudsen, L.R.: Provable Security Against a Differential Attack. J. Cryptology 8(1), 27–37 (1995)</li>

      <li>56. Procter, G.: A Security Analysis of the Composition of ChaCha20 and Poly1305. Cryptology ePrint Archive, Report 2014/613 (2014)</li>

      <li>57. Procter, G., Cid, C.: On Weak Keys and Forgery Attacks Against Polynomial-Based MAC Schemes. J. Cryptol. 28(4), 769–795 (2015)</li>

      <li>58. Rechberger, C., Soleimany, H., Tiessen, T.: Cryptanalysis of Low-Data Instances of Full LowMCv2. IACR Trans. Symmetric Cryptol. 2018(3), 163–181 (2018)</li>

      <li>59. Rijmen, V., Daemen, J., Preneel, B., Bosselaers, A., De Win, E.: The Cipher SHARK. In: FSE. LNCS, vol. 1039, pp. 99–111 (1996)</li>

      <li>60. Simon, T., Batina, L., Daemen, J., Grosso, V., Massolino, P.M.C., Papagiannopoulos, K., Regazzoni, F., Samwel, N.: Friet: An Authenticated Encryption Scheme with Built-in Fault Detection. In: EUROCRYPT. LNCS, vol. 12105, pp. 581–611 (2020)</li>

      <li>61. Toffoli, T.: Reversible Computing. In: ICALP. LNCS, vol. 85, pp. 632–644. Springer (1980)</li>

      <li>62. Wagner, D.A.: The Boomerang Attack. In: FSE. LNCS, vol. 1636, pp. 156–170. Springer (1999)</li>

    </ul>

    <p class="text-gray-300">A Round Constants Generation – Details</p>

    <p class="text-gray-300">As mentioned in the main part, the round constants <span class="math">RC1_{\\ell}</span>, <span class="math">RC2_{\\ell}</span>, <span class="math">RC3_{\\ell}</span>, and <span class="math">RC4_{\\ell}</span> are generated using Shake-256 <em>[14, 54]</em>. We detail this process in this section.</p>

    <p class="text-gray-300">For prime fields, a byte sequence of the ASCII characters “GF(p)” is absorbed with p denoting the numerical representation of the prime modulus. The output sequence of Shake-256 is then split into <span class="math">\\lceil\\log_{2}(p)\\rceil</span>-bit unsigned integers <span class="math">Z_{i}</span>. These values <span class="math">Z_{i}</span> are next sequentially assigned to <span class="math">RC1_{\\ell}</span>, <span class="math">RC2_{\\ell}</span>, <span class="math">RC3_{\\ell}</span>, and <span class="math">RC4_{\\ell}</span> for rising <span class="math">\\ell</span>, as long as <span class="math">1&lt;Z_{i}&lt;p</span>. Otherwise, we discard <span class="math">Z_{i}</span>, and we use instead the next unsigned integer <span class="math">1&lt;Z_{i}&lt;p</span> of the sequence.</p>

    <p class="text-gray-300">The round-constants generation process is analogous for fields over <span class="math">\\mathbb{F}_{2^{n}}</span>. In this case, we absorb a byte sequence corresponding to the ASCII characters “GF(2)[X]/polynomial’, where the characters “polynomial” is the hexadecimal representation in capital letters of the irreducible polynomial. Thereafter, the output sequence of Shake-256 is split into <span class="math">n</span>-bit unsigned integers <span class="math">Z_{i}</span>. These values <span class="math">Z_{i}</span> are then sequentially assigned to <span class="math">RC1_{\\ell}</span>, <span class="math">RC2_{\\ell}</span>, <span class="math">RC3_{\\ell}</span>, and <span class="math">RC4_{\\ell}</span> for rising <span class="math">\\ell</span> as long as <span class="math">Z_{i}&gt;1</span>. Otherwise, we discard <span class="math">Z_{i}</span>, and we employ instead the next unsigned integer <span class="math">Z_{i}&gt;1</span> of the sequence.</p>

    <h2 id="sec-28" class="text-2xl font-bold">Appendix B Aiminion: An Aggressive Evolution of Ciminion</h2>

    <p class="text-gray-300">For Ciminion, we modify the Farfalle <em>[12]</em> construction, in order to obtain a stronger design with a fewer successful attacks. In particular, moving the keys from the output of the construction (Fig. 7) to the inputs of <span class="math">p_{E}</span> (Fig. 3) results in the two following observations.</p>

    <ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">

      <li>The unknown keys <span class="math">K_{i}</span> at the inputs of <span class="math">p_{E}</span> prevent an attacker from knowing which inputs of <span class="math">p_{E}</span> form an affine space. Hence, the rolling function rol does not have to be non-linear to achieve this property.</li>

      <li>We cannot use the middle state-output relation (see Sect. 4.4) to set up a system of equations to be solved using Gröbner bases. In fact, despite our attempts (not involving <span class="math">p_{C}</span>), the system of equations is always under-determined. We have less equations than secret elements.</li>

    </ol>

    <p class="text-gray-300">This leads us to Aiminion. Compared to Ciminion, we use the identity as rolling function rol, and we fix the number of rounds to nine for <span class="math">p_{E}</span>, if we solely consider statistical attacks as a threat. This is three times the number of rounds where only bad differential/linear trails exists, as discussed in Tab. 6.</p>

    <p class="text-gray-300">Aiminion has an lower number of multiplication per elements than Ciminion. Indeed, it shifts from eight for large <span class="math">t</span> to only 4.5. However, this comes at the cost of interrupting the chain of arguments for security. In particular, probabilistically</p>

    <p class="text-gray-300">Table 6: Proposed number of rounds for AIMINION. The security level  <span class="math">s</span>  must satisfy  <span class="math">64 \\leq s \\leq \\log_2(q)</span>  and  <span class="math">q \\geq 2^{64}</span> , where  <span class="math">q</span>  is the number of elements in the field.</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Instance</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">pC</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">pE (two words per block)</th>

          </tr>

        </thead>

        <tbody>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">Data limit 2s/2elements</td>

            <td class="px-3 py-2 border-b border-gray-700">2(s+6)/3</td>

            <td class="px-3 py-2 border-b border-gray-700">9</td>

          </tr>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">formed affine spaces at the inputs of  <span class="math">p_E</span>  might still be detectable. We consider the evaluation of the complexity to find such an affine space as an interesting topic for future evaluation.</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">In this section, we present the notions of classical correlation analysis in a fashion that eases the transition to the more general theory. In classical correlation analysis, we consider vectorial Boolean functions  <span class="math">f: (\\mathbb{F}_2)^n \\to (\\mathbb{F}_2)^n</span> . From a more abstract point of view, classical correlation analysis is the study of certain characters, and their configuration in the space  <span class="math">L^2((\\mathbb{F}_2)^n)</span>  of complex-valued functions  <span class="math">(\\mathbb{F}_2)^n \\to \\mathbb{C}</span> . Let  $S = \\{z \\in \\mathbb{C} :</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">z</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">= 1\\}<span class="math">  be the multiplicative group of complex numbers of absolute value 1. An additive character of  </span>(\\mathbb{F}_2)^n<span class="math">  is a homomorphism from  </span>(\\mathbb{F}_2)^n<span class="math">  (considered as an abelian group) into  </span>S<span class="math"> . The  </span>L^2((\\mathbb{F}_2)^n)$ -inner product is given by</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <div class="my-4 text-center"><span class="math-block">\\langle \\chi , \\psi \\rangle = \\frac {1}{2 ^ {n}} \\sum_ {x \\in (\\mathbb {F} _ {2}) ^ {n}} \\chi (x) \\overline {{\\psi (x)}}.</span></div>

    <p class="text-gray-300">A parity of a vector  <span class="math">x \\in (\\mathbb{F}_2)^n</span>  is the sum of a specific subset of its components. Any parity of  <span class="math">x</span>  can be written as  <span class="math">u^\\top x</span>  for some  <span class="math">u \\in (\\mathbb{F}_2)^n</span> . We call  <span class="math">u</span>  a mask. Each mask  <span class="math">u</span>  defines a unique character  <span class="math">\\chi_u: (\\mathbb{F}_2)^n \\to \\mathbb{C} \\cap \\{-1, 1\\}</span>  given by</p>

    <div class="my-4 text-center"><span class="math-block">\\chi_ {u} (x) = (- 1) ^ {u ^ {\\top} x}.</span></div>

    <p class="text-gray-300">Together, these notions lead to the definition of correlation.</p>

    <p class="text-gray-300">Definition 4 (Parity Correlation). The correlation between an input mask  <span class="math">u</span>  and output mask  <span class="math">v</span>  with respect to a function  <span class="math">f</span>  is defined as</p>

    <div class="my-4 text-center"><span class="math-block">\\mathrm {C} _ {f} (u, v) = \\langle \\chi_ {u}, \\chi_ {v} \\circ f \\rangle = \\frac {1}{2 ^ {n}} \\sum_ {x \\in (\\mathbb {F} _ {2}) ^ {n}} (- 1) ^ {u ^ {\\top} x + v ^ {\\top} f (x)}.</span></div>

    <p class="text-gray-300">The number of known plaintext-ciphertext pairs required to mount a linear attack is inversely proportional to the square of the correlation. Hence, the square of the correlation serves as a measure to assess the effectiveness of a linear attack. It is called the linear probability.</p>

    <p class="text-gray-300">Definition 5 (Linear Probability). The linear probability of an input mask  <span class="math">u</span>  and output mask  <span class="math">v</span>  with respect to a function  <span class="math">f</span>  is defined as</p>

    <div class="my-4 text-center"><span class="math-block">\\mathrm {L P} _ {f} (u, v) = \\mathrm {C} _ {f} (u, v) ^ {2}.</span></div>

    <h2 id="sec-31" class="text-2xl font-bold">C.2 Proofs of Linear Probabilities</h2>

    <p class="text-gray-300">Lemma 2 (Orthogonality Relations). Let  <span class="math">\\chi</span>  and  <span class="math">\\psi</span>  be additive characters of  <span class="math">\\mathbb{F}_q</span> , then</p>

    <div class="my-4 text-center"><span class="math-block">\\sum_ {x \\in \\mathbb {F} _ {q}} \\chi_ {b} (x) \\overline {{\\chi_ {c} (x)}} = \\left\\{ \\begin{array}{l l} 0 &amp;amp; \\text{if } b \\neq c, \\\\ q &amp;amp; \\text{otherwise}. \\end{array} \\right.</span></div>

    <p class="text-gray-300">Theorem 1 (Linear Probabilities of the Multiplication Function). Let  <span class="math">m: \\mathbb{F}_q \\times \\mathbb{F}_q \\to \\mathbb{F}_q</span>  be given by  <span class="math">m(x, y) = xy</span> , then the linear probabilities for all masks  <span class="math">u \\in (\\mathbb{F}_q)^2</span>  at the input of  <span class="math">m</span>  and masks  <span class="math">v \\in \\mathbb{F}_q</span>  at the output of  <span class="math">m</span>  are as seen in Tab. 7.</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">u1</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">u2</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">v</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">LPm((u1, u2), v)</th>

          </tr>

        </thead>

        <tbody>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">*</td>

            <td class="px-3 py-2 border-b border-gray-700">*</td>

            <td class="px-3 py-2 border-b border-gray-700">1</td>

            <td class="px-3 py-2 border-b border-gray-700">1/q2</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">0</td>

            <td class="px-3 py-2 border-b border-gray-700">0</td>

            <td class="px-3 py-2 border-b border-gray-700">0</td>

            <td class="px-3 py-2 border-b border-gray-700">1</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">0</td>

            <td class="px-3 py-2 border-b border-gray-700">1</td>

            <td class="px-3 py-2 border-b border-gray-700">0</td>

            <td class="px-3 py-2 border-b border-gray-700">0</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">1</td>

            <td class="px-3 py-2 border-b border-gray-700">0</td>

            <td class="px-3 py-2 border-b border-gray-700">0</td>

            <td class="px-3 py-2 border-b border-gray-700">0</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">1</td>

            <td class="px-3 py-2 border-b border-gray-700">1</td>

            <td class="px-3 py-2 border-b border-gray-700">0</td>

            <td class="px-3 py-2 border-b border-gray-700">0</td>

          </tr>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">Table 7: Linear probabilities of  <span class="math">m</span>  in  <span class="math">{\\mathbb{F}}_{q}</span>  . A 0 denotes a zero value,a 1 denotes a non-zero value,and a * denotes any value.</p>

    <p class="text-gray-300">Proof. Let  <span class="math">v \\neq 0</span> . If  <span class="math">u_{1} = 0</span> , then</p>

    <div class="my-4 text-center"><span class="math-block"></span></div>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\begin{array}{l} \\mathrm {L P} _ {m} (u, v) = \\left</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\frac {1}{q ^ {2}} \\sum_ {x \\in \\mathbb {F} _ {q}} \\sum_ {y \\in \\mathbb {F} _ {q}} \\chi_ {1} \\left(u _ {1} x + u _ {2} y - v x y\\right) \\right</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">^ {2} = \\left</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\frac {1}{q ^ {2}} \\sum_ {x \\in \\mathbb {F} _ {q}} \\sum_ {y \\in \\mathbb {F} _ {q}} \\chi_ {1} \\left(u _ {2} y - v x y\\right) \\right</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">^ {2} \\\\ = \\left</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\frac {1}{q ^ {2}} \\sum_ {x \\in \\mathbb {F} _ {q}} \\sum_ {y \\in \\mathbb {F} _ {q}} \\chi_ {1} (u _ {2} y) \\overline {{\\chi_ {1} (v x y)}} \\right</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">^ {2} = \\frac {1}{q ^ {2}}, \\\\ \\end{array}</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <div class="my-4 text-center"><span class="math-block"></span></div>

    <p class="text-gray-300">where the last equality is due to the fact that - by Lemma 2 - the inner sum equals  <span class="math">q</span> , if  <span class="math">x = v^{-1}u_{2}</span> , and 0 otherwise.</p>

    <p class="text-gray-300">The case for which  <span class="math">u_{2} = 0</span>  is analogous to the previous one. Therefore, we can suppose that  <span class="math">u_{1} \\neq 0</span> , and  <span class="math">u_{2} \\neq 0</span> . Let  <span class="math">a \\in \\mathbb{F}_q</span> , and  <span class="math">b \\in \\mathbb{F}_q</span> , be such that</p>

    <div class="my-4 text-center"><span class="math-block">b + u _ {1} x + u _ {2} y - v x y = (1 + a x) (b + u _ {2} y).</span></div>

    <p class="text-gray-300">Then,</p>

    <div class="my-4 text-center"><span class="math-block"></span></div>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\mathrm {L P} _ {m} (u, v) = \\left</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\frac {1}{q ^ {2}} \\sum_ {x \\in \\mathbb {F} _ {q}} \\sum_ {y \\in \\mathbb {F} _ {q}} \\chi_ {1} (u _ {1} x + u _ {2} y - v x y) \\right</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">^ {2}.</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <div class="my-4 text-center"><span class="math-block"></span></div>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">By multiplying it by  $</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\chi_1(b)</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">^2 = 1$ :</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <div class="my-4 text-center"><span class="math-block"></span></div>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">= \\left</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\frac {1}{q ^ {2}} \\sum_ {x \\in \\mathbb {F} _ {q}} \\sum_ {y \\in \\mathbb {F} _ {q}} \\chi_ {1} (b + u _ {1} x + u _ {2} y - v x y) \\right</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">^ {2} = \\left</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\frac {1}{q ^ {2}} \\sum_ {x \\in \\mathbb {F} _ {q}} \\sum_ {y \\in \\mathbb {F} _ {q}} \\chi_ {1} ((1 + a x) (b + v y)) \\right</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">^ {2}.</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <div class="my-4 text-center"><span class="math-block"></span></div>

    <p class="text-gray-300">Note that  <span class="math">a \\neq 0</span>  and  <span class="math">v \\neq 0</span> , hence:</p>

    <div class="my-4 text-center"><span class="math-block"></span></div>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">= \\left</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\frac {1}{q ^ {2}} \\sum_ {x ^ {\\prime} \\in \\mathbb {F} _ {q}} \\sum_ {y ^ {\\prime} \\in \\mathbb {F} _ {q}} \\chi_ {1} \\left(x ^ {\\prime} y ^ {\\prime}\\right) \\right</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">^ {2} = \\frac {1}{q ^ {2}},</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <div class="my-4 text-center"><span class="math-block"></span></div>

    <p class="text-gray-300">where the last equality is due to the fact that - by Lemma 2 - the inner sum equals  <span class="math">q</span> , if  <span class="math">x&#x27; = 0</span> , and 0 otherwise.</p>

    <p class="text-gray-300">Next, let us consider that  <span class="math">v = 0</span> . From Lemma 2, we deduce that</p>

    <div class="my-4 text-center"><span class="math-block">\\mathrm {L P} _ {m} (u, 0) = \\left\\{ \\begin{array}{l} 1 \\text { if } u = (0, 0), \\\\ 0 \\text { otherwise}. \\end{array} \\right.</span></div>

    <p class="text-gray-300">Theorem 2 (Linear Probabilities of the Round Constant Addition). Let  <span class="math">c: \\mathbb{F}_q \\to \\mathbb{F}_q</span>  be given by  <span class="math">c(x) = x + c</span> , then</p>

    <div class="my-4 text-center"><span class="math-block">\\mathrm {L P} _ {c} (u, v) = \\left\\{ \\begin{array}{l} 1 \\text { if } u = v, \\\\ 0 \\text { otherwise}, \\end{array} \\right.</span></div>

    <p class="text-gray-300">for all masks  <span class="math">u,v\\in \\mathbb{F}_q</span></p>

    <p class="text-gray-300">Proof.</p>

    <div class="my-4 text-center"><span class="math-block"></span></div>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\begin{array}{l} \\mathrm {L P} _ {c} (u, v) = \\left</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\frac {1}{q} \\sum_ {x \\in \\mathbb {F} _ {q}} \\chi_ {1} (u x - v c (x)) \\right</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">^ {2} = \\left</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\frac {1}{q} \\sum_ {x \\in \\mathbb {F} _ {q}} \\chi_ {1} (u x - v (x + c)) \\right</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">^ {2} \\\\ = \\left</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\frac {1}{q} \\sum_ {x \\in \\mathbb {F} _ {q}} \\chi_ {1} ((u - v) x - v c) \\right</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">^ {2} = \\left</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\frac {1}{q} \\sum_ {x \\in \\mathbb {F} _ {q}} \\chi_ {1} ((u - v) x) \\overline {{\\chi_ {1} (v c)}} \\right</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">^ {2} \\\\ = \\left</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\frac {1}{q} \\sum_ {x \\in \\mathbb {F} _ {q}} \\chi_ {1} ((u - v) x) \\right</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">^ {2}. \\\\ \\end{array}</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <div class="my-4 text-center"><span class="math-block"></span></div>

    <p class="text-gray-300">The result now follows from Lemma 2.</p>

    <p class="text-gray-300">Theorem 3 (Linear Probabilities of the Addition). Let <span class="math">a: \\mathbb{F}_q \\times \\mathbb{F}_q \\to \\mathbb{F}_q</span> be given by <span class="math">a(x, y) = x + y</span>, then</p>

    <div class="my-4 text-center"><span class="math-block">\\mathrm{LP}_a(u, v) = \\begin{cases} 1 &amp;amp; \\text{if } u = (v, v), \\\\ 0 &amp;amp; \\text{otherwise}, \\end{cases}</span></div>

    <p class="text-gray-300">for all masks <span class="math">u \\in (\\mathbb{F}_q)^2</span> at the input of <span class="math">a</span>, and masks <span class="math">v \\in \\mathbb{F}_q</span> at the output of <span class="math">a</span>. Proof.</p>

    <p class="text-gray-300">$$ \\begin{aligned}</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\mathrm{LP}_a(u, v) &amp;= \\left</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\frac{1}{q^2} \\sum_{x \\in \\mathbb{F}_q} \\sum_{y \\in \\mathbb{F}_q} \\chi_1(u^\\top(x, y) - v a(x, y)) \\right</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">^2 \\\\</th>

          </tr>

        </thead>

        <tbody>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">&amp;= \\left</td>

            <td class="px-3 py-2 border-b border-gray-700">\\frac{1}{q^2} \\sum_{x \\in \\mathbb{F}_q} \\sum_{y \\in \\mathbb{F}_q} \\chi_1((u_1 - v) x + (u_2 - v) y) \\right</td>

            <td class="px-3 py-2 border-b border-gray-700">^2 \\\\</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">&amp;= \\left</td>

            <td class="px-3 py-2 border-b border-gray-700">\\frac{1}{q^2} \\sum_{x \\in \\mathbb{F}_q} \\chi_1((u_1 - v) x) \\sum_{y \\in \\mathbb{F}_q} \\chi_1((u_2 - v) y) \\right</td>

            <td class="px-3 py-2 border-b border-gray-700">^2.</td>

          </tr>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">\\end{aligned} $$</p>

    <p class="text-gray-300">By Lemma 2, both sums are non-zero if and only if <span class="math">u_1 = u_2 = v</span>. In this case, they both evaluate to <span class="math">q</span>.</p>

    <p class="text-gray-300">Theorem 4 (Linear Probabilities of the Branch Duplication). Let <span class="math">d: \\mathbb{F}_q \\to \\mathbb{F}_q \\times \\mathbb{F}_q</span> be given by <span class="math">d(x) = (x, x)</span>, then</p>

    <div class="my-4 text-center"><span class="math-block">\\mathrm{LP}_d(u, (v_1, v_2)) = \\begin{cases} 1 &amp;amp; \\text{if } u = v_1 + v_2, \\\\ 0 &amp;amp; \\text{otherwise}, \\end{cases}</span></div>

    <p class="text-gray-300">for all masks <span class="math">u \\in \\mathbb{F}_q</span> at the input of <span class="math">d</span>, and mask <span class="math">(v_1, v_2) \\in (\\mathbb{F}_q)^2</span> at the output of <span class="math">d</span>.</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Proof. Remember that $\\mathrm{LP}_d(u, (v_1, v_2)) = \\left</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\frac{1}{q} \\sum_{x \\in \\mathbb{F}_q} \\chi_u(x) \\overline{\\chi_{v_1 + v_2}(x)} \\right</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">^2<span class="math">. By Lemma 2, the sum is non-zero if and only if </span>u = v_1 + v_2<span class="math">. In this case, it evaluates to </span>q$.</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">Theorem 5 (Linear Probabilities of a <span class="math">\\mathbb{F}_q</span>-Linear Transformation.). Let <span class="math">L: (\\mathbb{F}_q)^m \\to (\\mathbb{F}_q)^m</span> be a linear transformation, then</p>

    <div class="my-4 text-center"><span class="math-block">\\mathrm{LP}_L(u, v) = \\begin{cases} 1 &amp;amp; \\text{if } u = L^\\top v, \\\\ 0 &amp;amp; \\text{otherwise}, \\end{cases}</span></div>

    <p class="text-gray-300">for all masks <span class="math">u, v \\in (\\mathbb{F}_q)^m</span>.</p>

    <p class="text-gray-300">36</p>

    <p class="text-gray-300">Proof.</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"><span class="math">\\mathrm{LP}_{L}(u,v)</span> $=\\left</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\frac{1}{q}\\sum_{x\\in\\mathbb{F}_{q}}\\chi_{1}(u^{\\top}x-v^{\\top}Lx)\\right</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">^{2}=\\left</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\frac{1}{q}\\sum_{x\\in\\mathbb{F}_{q}}\\chi_{1}(u^{T}x-(L^{\\top}v)^{\\top}x)\\right</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">^{2}$</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">The result now follows from Lemma 2. ∎</p>

    <h3 id="sec-32" class="text-xl font-semibold mt-8">C.3 Differential Attacks – Details</h3>

    <p class="text-gray-300">As mentioned in Sect. 4.2, we built a state finite machine in Fig. 9 that represents all sets of encountered differences as states that are associated to their differential probabilities. We focus on the prime case, but the results are analogous in <span class="math">\\mathbb{F}_{2^{n}}</span>.</p>

    <p class="text-gray-300">In order to understand the Figure, we mention that:</p>

    <ul class="list-disc list-inside space-y-1 text-gray-300 my-2 ml-4">

      <li>all entries are fixed differences, where <span class="math">(x,y,z)\\neq 0</span>, with <span class="math">x\\neq y</span>, <span class="math">x\\neq z</span>, and <span class="math">z\\neq y</span>.</li>

      <li>in order to simplify the Figure, we use only three letters <span class="math">x,y,z</span> to denote the differences for each branch. Most of the time, the value of the differences <span class="math">x,y,z</span> at the input are <em>not</em> equal to the value of the differences <span class="math">x,y,z</span> at the output. For instance, if we consider the one-round difference <span class="math">\\{(x,RC4^{.}x,x)\\}\\mapsto\\{(0,x,y)\\}</span>, the value of the input difference <span class="math">x</span> is usually not equal to the value of the output difference <span class="math">x</span>. Only in a few cases, the values of the differences <span class="math">x,y,z</span> at the input are exactly equal to the value of the differences <span class="math">x,y,z</span> at the output. This is the case for <span class="math">\\{(0,0,x)\\}\\mapsto\\{(x,RC4^{.}x,x)\\}</span> in <span class="math">\\mathbb{F}_{2^{n}}</span>.</li>

      <li>all arrows with a plain line represents a differential probability <span class="math">p^{-1}</span> in <span class="math">\\mathbb{F}_{p}</span> (similarly, <span class="math">2^{-n}</span> for the analogous case in <span class="math">\\mathbb{F}_{2^{n}}</span>); except for the arrow with a doted line that has a probability one.</li>

      <li>an arrow starting with a diamond and ending with a hollow head indicates that the round constant <span class="math">RC4^{.}</span> that is mentioned in the states before and after the considered round (<span class="math">\\mapsto</span>), comes from a previous round. In other words, if we consider the round <span class="math">\\ell</span>, the round constant <span class="math">RC4^{.}j</span> that is written in the difference states before/after this round, is introduced in a round <span class="math">j&lt;\\ell</span>. In addition, it is possible that the round constant <span class="math">RC4^{.}_{\\ell}</span> of the considered <span class="math">\\ell</span>-th round is equal to the round constant of the previous or preceding state(s). This highly determines the output state of <span class="math">\\{(-RC4^{.}x,x,0)\\}</span>. For instance, if we examine the round <span class="math">\\ell</span> that has the input differences <span class="math">\\{(-RC4^{.}j&lt;\\ell^{.}x,x,0)\\}</span>, the output differences can be either <span class="math">\\{(x,RC4^{.}j&lt;\\ell^{.}x,y)\\}</span> or <span class="math">\\{(x,y,z)\\}</span> depending on whether <span class="math">RC4^{.}j&lt;\\ell=RC4^{.}_{\\ell}</span>, if none of the output differences is equal to zero.</li>

    </ul>

    <p class="text-gray-300">!<a href="img-9.jpeg">img-9.jpeg</a> Fig. 9: Differential trails for the round function in  <span class="math">\\mathbb{F}_p</span> . The three-round differential trail with the highest DP from Sect. 4.2, is highlighted in yellow.</p>

    <p class="text-gray-300">In our keyed mode that is depicted in Fig. 3, the subkeys  <span class="math">K_{i}</span>  are derived from two master key elements  <span class="math">MK_{1}</span>  and  <span class="math">MK_{2}</span> . We analyze in this section how an attacker can gather many equations with the secrets  <span class="math">K_{1}</span>  and  <span class="math">K_{2}</span>  for the permutation  <span class="math">p_{C}</span> . As explained for higher-order differential attacks, the goal is to guarantee that the output of  <span class="math">p_{C}</span>  appears to be randomly generated. For the sake of simplicity, we neglect in these observations any further additions of key elements and application of  <span class="math">p_{E}</span> . Moreover, we study the upper bounds on the number of monomials that is needed to solve a system of equations.</p>

    <p class="text-gray-300">An Upper Bound on the Number of Monomials. We know from Sect. 4.3 that the number of rounds required to reach a degree  <span class="math">d_{\\mathbb{F}_p}</span> , or  <span class="math">d_{\\mathbb{F}_{2^n}}</span> , of approximately  <span class="math">2^s</span>  is  <span class="math">s + 2</span>  for either  <span class="math">K_1</span>  and  <span class="math">K_2</span> . Hence, the maximum number of possible monomials  <span class="math">\\mu</span>  of the maximal possible combinations of  <span class="math">K_1</span>  and  <span class="math">K_2</span>  up to degree  <span class="math">2^s</span>  is  <span class="math">2^{2s}</span> . This means that if the diffusion is decent, the equations containing the secret variables are likely to have at least  <span class="math">2^s</span>  monomials.</p>

    <p class="text-gray-300">The number of rounds that provides resistance against higher-order differential attacks should also guarantee sufficient protection against interpolation attacks <em>[46]</em> which use trivial linearization of all monomials. Indeed, this attack strategy aims to construct a polynomial corresponding to the encryption function without any knowledge of the secret key. If an adversary can construct such an interpolation polynomial without using the full code book, then they can potentially employ it to set up, e.g., a key-recovery attack.</p>

    <p class="text-gray-300">In order to set up the system of equations that describes the scheme, the attacker first needs more than <span class="math">2^{s}</span> inputs/outputs, which exceeds the security level. In the following, let us assume that the attacker can collect <span class="math">2^{s}</span> of such equations. In order to solve this system of equations, the adversary could substitute each monomial by another variable in order to linearize the system. The cost of this attack is of <span class="math">O\\left(2^{s\\omega}\\right)</span> field operations with <span class="math">\\omega&gt;2</span>. However, that is behind the security level, if the chosen number of rounds guarantees security against the higher-order differential attack.</p>

    <p class="text-gray-300">For completeness, we mention that the interpolation attack has a meet-in-the middle variant that significantly reduces the number of monomials in the system of equations which describes our rounds. However, in our construction that is illustrated in Fig. 3, this variant is difficult to perform because the output is always truncated. Hence, part of the output changes while remaining secret. Each collected equation thus adds new secret variables to the system of equations. In that respect, we do not think that an meet-in-the-middle style approach would work for a trivial linearization. Nonetheless, equation solving approaches might succeed, like Gröbner bases that we discuss in Sect. 4.4, but it is not restricted to it. Therefore, we study the equation systems obtained after a few rounds in Sect. 4.5 to reveal any special exploitable structures in the equation systems. For example, we search for sparse equations.</p>

    <h4 id="sec-34" class="text-lg font-semibold mt-6">Algebraic Attack (over <span class="math">\\mathbb{F}_{2^{n}}</span>): Case <span class="math">RC_{4\\ i}=1</span>.</h4>

    <p class="text-gray-300">The behavior of our round function with the round constants <span class="math">RC_{4\\ i}</span> set to one is presented in Tab. 8. If we compare the number of monomials in Tab. 8 with Tab. 3, the number of monomials in the Tab. 8 is clearly lower. Furthermore, if we consider the monomials of degree three until the round six, we only reach eight out of ten possible monomials, whereas we have all ten monomials in <span class="math">\\mathbb{F}_{p}</span> (Tab. 2). A deeper study reveals that out of all possible monomials of degree three, <span class="math">a_{0}b_{0}c_{0}</span> and <span class="math">c_{0}^{3}</span> are missing. The first one is lacking due to the use of the Toffoli gate, and hence, the value <span class="math">c_{0}</span> is amended to <span class="math">a_{0}b_{0}+c_{0}</span> at the very beginning. In addition, <span class="math">c_{0}^{3}</span> is missing due to the interaction in the linear part. Hence, we observe that the polynomial is more sparse (or equivalently, less dense) than when <span class="math">RC_{4\\ i}\\neq 1</span>.</p>

    <h2 id="sec-35" class="text-2xl font-bold">Appendix E Other Attack Vectors and Details</h2>

    <p class="text-gray-300">In this section, we discuss attack vectors that are not directly covered by the previous sections. These attack vectors mostly include attacks exploiting strongly</p>

    <p class="text-gray-300">Table 8: Number of monomials of a certain degree, where all inputs are considered as variables in  <span class="math">\\mathbb{F}_{2^n}</span> . All round constants  <span class="math">RC_{4_i}^j</span>  equal 1.</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Output</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Degree</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

          </tr>

        </thead>

        <tbody>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">Round</td>

            <td class="px-3 py-2 border-b border-gray-700">Variable</td>

            <td class="px-3 py-2 border-b border-gray-700">0</td>

            <td class="px-3 py-2 border-b border-gray-700">1</td>

            <td class="px-3 py-2 border-b border-gray-700">2</td>

            <td class="px-3 py-2 border-b border-gray-700">3</td>

            <td class="px-3 py-2 border-b border-gray-700">4</td>

            <td class="px-3 py-2 border-b border-gray-700">5</td>

            <td class="px-3 py-2 border-b border-gray-700">6</td>

            <td class="px-3 py-2 border-b border-gray-700">7</td>

            <td class="px-3 py-2 border-b border-gray-700">8</td>

            <td class="px-3 py-2 border-b border-gray-700">9</td>

            <td class="px-3 py-2 border-b border-gray-700">10</td>

            <td class="px-3 py-2 border-b border-gray-700">11</td>

            <td class="px-3 py-2 border-b border-gray-700">12</td>

            <td class="px-3 py-2 border-b border-gray-700">13</td>

            <td class="px-3 py-2 border-b border-gray-700">14</td>

            <td class="px-3 py-2 border-b border-gray-700">15</td>

            <td class="px-3 py-2 border-b border-gray-700">16</td>

            <td class="px-3 py-2 border-b border-gray-700">17</td>

            <td class="px-3 py-2 border-b border-gray-700">18</td>

            <td class="px-3 py-2 border-b border-gray-700">19</td>

            <td class="px-3 py-2 border-b border-gray-700">20</td>

            <td class="px-3 py-2 border-b border-gray-700">21</td>

            <td class="px-3 py-2 border-b border-gray-700">22</td>

            <td class="px-3 py-2 border-b border-gray-700">23</td>

            <td class="px-3 py-2 border-b border-gray-700">24</td>

            <td class="px-3 py-2 border-b border-gray-700">25</td>

            <td class="px-3 py-2 border-b border-gray-700">26</td>

            <td class="px-3 py-2 border-b border-gray-700">27</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">max</td>

            <td class="px-3 py-2 border-b border-gray-700">1</td>

            <td class="px-3 py-2 border-b border-gray-700">3</td>

            <td class="px-3 py-2 border-b border-gray-700">6</td>

            <td class="px-3 py-2 border-b border-gray-700">10</td>

            <td class="px-3 py-2 border-b border-gray-700">15</td>

            <td class="px-3 py-2 border-b border-gray-700">21</td>

            <td class="px-3 py-2 border-b border-gray-700">28</td>

            <td class="px-3 py-2 border-b border-gray-700">36</td>

            <td class="px-3 py-2 border-b border-gray-700">45</td>

            <td class="px-3 py-2 border-b border-gray-700">55</td>

            <td class="px-3 py-2 border-b border-gray-700">66</td>

            <td class="px-3 py-2 border-b border-gray-700">78</td>

            <td class="px-3 py-2 border-b border-gray-700">91</td>

            <td class="px-3 py-2 border-b border-gray-700">105</td>

            <td class="px-3 py-2 border-b border-gray-700">120</td>

            <td class="px-3 py-2 border-b border-gray-700">136</td>

            <td class="px-3 py-2 border-b border-gray-700">153</td>

            <td class="px-3 py-2 border-b border-gray-700">171</td>

            <td class="px-3 py-2 border-b border-gray-700">190</td>

            <td class="px-3 py-2 border-b border-gray-700">210</td>

            <td class="px-3 py-2 border-b border-gray-700">231</td>

            <td class="px-3 py-2 border-b border-gray-700">253</td>

            <td class="px-3 py-2 border-b border-gray-700">276</td>

            <td class="px-3 py-2 border-b border-gray-700">300</td>

            <td class="px-3 py-2 border-b border-gray-700">325</td>

            <td class="px-3 py-2 border-b border-gray-700">351</td>

            <td class="px-3 py-2 border-b border-gray-700">378</td>

            <td class="px-3 py-2 border-b border-gray-700">406</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">1</td>

            <td class="px-3 py-2 border-b border-gray-700">a</td>

            <td class="px-3 py-2 border-b border-gray-700">1</td>

            <td class="px-3 py-2 border-b border-gray-700">1</td>

            <td class="px-3 py-2 border-b border-gray-700">1</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">b</td>

            <td class="px-3 py-2 border-b border-gray-700">1</td>

            <td class="px-3 py-2 border-b border-gray-700">3</td>

            <td class="px-3 py-2 border-b border-gray-700">1</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">c</td>

            <td class="px-3 py-2 border-b border-gray-700">1</td>

            <td class="px-3 py-2 border-b border-gray-700">2</td>

            <td class="px-3 py-2 border-b border-gray-700">1</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">2</td>

            <td class="px-3 py-2 border-b border-gray-700">a</td>

            <td class="px-3 py-2 border-b border-gray-700">1</td>

            <td class="px-3 py-2 border-b border-gray-700">3</td>

            <td class="px-3 py-2 border-b border-gray-700">4</td>

            <td class="px-3 py-2 border-b border-gray-700">2</td>

            <td class="px-3 py-2 border-b border-gray-700">1</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">b</td>

            <td class="px-3 py-2 border-b border-gray-700">1</td>

            <td class="px-3 py-2 border-b border-gray-700">3</td>

            <td class="px-3 py-2 border-b border-gray-700">4</td>

            <td class="px-3 py-2 border-b border-gray-700">2</td>

            <td class="px-3 py-2 border-b border-gray-700">1</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">c</td>

            <td class="px-3 py-2 border-b border-gray-700">1</td>

            <td class="px-3 py-2 border-b border-gray-700">3</td>

            <td class="px-3 py-2 border-b border-gray-700">4</td>

            <td class="px-3 py-2 border-b border-gray-700">2</td>

            <td class="px-3 py-2 border-b border-gray-700">1</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">3</td>

            <td class="px-3 py-2 border-b border-gray-700">a</td>

            <td class="px-3 py-2 border-b border-gray-700">1</td>

            <td class="px-3 py-2 border-b border-gray-700">3</td>

            <td class="px-3 py-2 border-b border-gray-700">6</td>

            <td class="px-3 py-2 border-b border-gray-700">6</td>

            <td class="px-3 py-2 border-b border-gray-700">6</td>

            <td class="px-3 py-2 border-b border-gray-700">2</td>

            <td class="px-3 py-2 border-b border-gray-700">2</td>

            <td class="px-3 py-2 border-b border-gray-700">0</td>

            <td class="px-3 py-2 border-b border-gray-700">1</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">b</td>

            <td class="px-3 py-2 border-b border-gray-700">1</td>

            <td class="px-3 py-2 border-b border-gray-700">3</td>

            <td class="px-3 py-2 border-b border-gray-700">6</td>

            <td class="px-3 py-2 border-b border-gray-700">6</td>

            <td class="px-3 py-2 border-b border-gray-700">6</td>

            <td class="px-3 py-2 border-b border-gray-700">2</td>

            <td class="px-3 py-2 border-b border-gray-700">2</td>

            <td class="px-3 py-2 border-b border-gray-700">0</td>

            <td class="px-3 py-2 border-b border-gray-700">1</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">c</td>

            <td class="px-3 py-2 border-b border-gray-700">1</td>

            <td class="px-3 py-2 border-b border-gray-700">3</td>

            <td class="px-3 py-2 border-b border-gray-700">6</td>

            <td class="px-3 py-2 border-b border-gray-700">6</td>

            <td class="px-3 py-2 border-b border-gray-700">6</td>

            <td class="px-3 py-2 border-b border-gray-700">2</td>

            <td class="px-3 py-2 border-b border-gray-700">2</td>

            <td class="px-3 py-2 border-b border-gray-700">0</td>

            <td class="px-3 py-2 border-b border-gray-700">1</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">4</td>

            <td class="px-3 py-2 border-b border-gray-700">a</td>

            <td class="px-3 py-2 border-b border-gray-700">1</td>

            <td class="px-3 py-2 border-b border-gray-700">3</td>

            <td class="px-3 py-2 border-b border-gray-700">6</td>

            <td class="px-3 py-2 border-b border-gray-700">8</td>

            <td class="px-3 py-2 border-b border-gray-700">12</td>

            <td class="px-3 py-2 border-b border-gray-700">10</td>

            <td class="px-3 py-2 border-b border-gray-700">6</td>

            <td class="px-3 py-2 border-b border-gray-700">4</td>

            <td class="px-3 py-2 border-b border-gray-700">6</td>

            <td class="px-3 py-2 border-b border-gray-700">2</td>

            <td class="px-3 py-2 border-b border-gray-700">2</td>

            <td class="px-3 py-2 border-b border-gray-700">0</td>

            <td class="px-3 py-2 border-b border-gray-700">2</td>

            <td class="px-3 py-2 border-b border-gray-700">0</td>

            <td class="px-3 py-2 border-b border-gray-700">0</td>

            <td class="px-3 py-2 border-b border-gray-700">0</td>

            <td class="px-3 py-2 border-b border-gray-700">1</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">b</td>

            <td class="px-3 py-2 border-b border-gray-700">1</td>

            <td class="px-3 py-2 border-b border-gray-700">3</td>

            <td class="px-3 py-2 border-b border-gray-700">6</td>

            <td class="px-3 py-2 border-b border-gray-700">8</td>

            <td class="px-3 py-2 border-b border-gray-700">12</td>

            <td class="px-3 py-2 border-b border-gray-700">10</td>

            <td class="px-3 py-2 border-b border-gray-700">6</td>

            <td class="px-3 py-2 border-b border-gray-700">4</td>

            <td class="px-3 py-2 border-b border-gray-700">6</td>

            <td class="px-3 py-2 border-b border-gray-700">2</td>

            <td class="px-3 py-2 border-b border-gray-700">2</td>

            <td class="px-3 py-2 border-b border-gray-700">0</td>

            <td class="px-3 py-2 border-b border-gray-700">2</td>

            <td class="px-3 py-2 border-b border-gray-700">0</td>

            <td class="px-3 py-2 border-b border-gray-700">0</td>

            <td class="px-3 py-2 border-b border-gray-700">0</td>

            <td class="px-3 py-2 border-b border-gray-700">1</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">c</td>

            <td class="px-3 py-2 border-b border-gray-700">1</td>

            <td class="px-3 py-2 border-b border-gray-700">3</td>

            <td class="px-3 py-2 border-b border-gray-700">6</td>

            <td class="px-3 py-2 border-b border-gray-700">8</td>

            <td class="px-3 py-2 border-b border-gray-700">12</td>

            <td class="px-3 py-2 border-b border-gray-700">10</td>

            <td class="px-3 py-2 border-b border-gray-700">6</td>

            <td class="px-3 py-2 border-b border-gray-700">4</td>

            <td class="px-3 py-2 border-b border-gray-700">6</td>

            <td class="px-3 py-2 border-b border-gray-700">2</td>

            <td class="px-3 py-2 border-b border-gray-700">2</td>

            <td class="px-3 py-2 border-b border-gray-700">0</td>

            <td class="px-3 py-2 border-b border-gray-700">2</td>

            <td class="px-3 py-2 border-b border-gray-700">0</td>

            <td class="px-3 py-2 border-b border-gray-700">0</td>

            <td class="px-3 py-2 border-b border-gray-700">0</td>

            <td class="px-3 py-2 border-b border-gray-700">1</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">5</td>

            <td class="px-3 py-2 border-b border-gray-700">a</td>

            <td class="px-3 py-2 border-b border-gray-700">1</td>

            <td class="px-3 py-2 border-b border-gray-700">3</td>

            <td class="px-3 py-2 border-b border-gray-700">6</td>

            <td class="px-3 py-2 border-b border-gray-700">8</td>

            <td class="px-3 py-2 border-b border-gray-700">12</td>

            <td class="px-3 py-2 border-b border-gray-700">14</td>

            <td class="px-3 py-2 border-b border-gray-700">10</td>

            <td class="px-3 py-2 border-b border-gray-700">12</td>

            <td class="px-3 py-2 border-b border-gray-700">12</td>

            <td class="px-3 py-2 border-b border-gray-700">12</td>

            <td class="px-3 py-2 border-b border-gray-700">10</td>

            <td class="px-3 py-2 border-b border-gray-700">4</td>

            <td class="px-3 py-2 border-b border-gray-700">6</td>

            <td class="px-3 py-2 border-b border-gray-700">4</td>

            <td class="px-3 py-2 border-b border-gray-700">4</td>

            <td class="px-3 py-2 border-b border-gray-700">0</td>

            <td class="px-3 py-2 border-b border-gray-700">6</td>

            <td class="px-3 py-2 border-b border-gray-700">2</td>

            <td class="px-3 py-2 border-b border-gray-700">2</td>

            <td class="px-3 py-2 border-b border-gray-700">0</td>

            <td class="px-3 py-2 border-b border-gray-700">2</td>

            <td class="px-3 py-2 border-b border-gray-700">0</td>

            <td class="px-3 py-2 border-b border-gray-700">0</td>

            <td class="px-3 py-2 border-b border-gray-700">0</td>

            <td class="px-3 py-2 border-b border-gray-700">2</td>

            <td class="px-3 py-2 border-b border-gray-700">0</td>

            <td class="px-3 py-2 border-b border-gray-700">0</td>

            <td class="px-3 py-2 border-b border-gray-700">0</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">b</td>

            <td class="px-3 py-2 border-b border-gray-700">1</td>

            <td class="px-3 py-2 border-b border-gray-700">3</td>

            <td class="px-3 py-2 border-b border-gray-700">6</td>

            <td class="px-3 py-2 border-b border-gray-700">8</td>

            <td class="px-3 py-2 border-b border-gray-700">12</td>

            <td class="px-3 py-2 border-b border-gray-700">14</td>

            <td class="px-3 py-2 border-b border-gray-700">10</td>

            <td class="px-3 py-2 border-b border-gray-700">12</td>

            <td class="px-3 py-2 border-b border-gray-700">12</td>

            <td class="px-3 py-2 border-b border-gray-700">12</td>

            <td class="px-3 py-2 border-b border-gray-700">10</td>

            <td class="px-3 py-2 border-b border-gray-700">4</td>

            <td class="px-3 py-2 border-b border-gray-700">6</td>

            <td class="px-3 py-2 border-b border-gray-700">4</td>

            <td class="px-3 py-2 border-b border-gray-700">4</td>

            <td class="px-3 py-2 border-b border-gray-700">0</td>

            <td class="px-3 py-2 border-b border-gray-700">6</td>

            <td class="px-3 py-2 border-b border-gray-700">2</td>

            <td class="px-3 py-2 border-b border-gray-700">2</td>

            <td class="px-3 py-2 border-b border-gray-700">0</td>

            <td class="px-3 py-2 border-b border-gray-700">2</td>

            <td class="px-3 py-2 border-b border-gray-700">0</td>

            <td class="px-3 py-2 border-b border-gray-700">0</td>

            <td class="px-3 py-2 border-b border-gray-700">0</td>

            <td class="px-3 py-2 border-b border-gray-700">2</td>

            <td class="px-3 py-2 border-b border-gray-700">0</td>

            <td class="px-3 py-2 border-b border-gray-700">0</td>

            <td class="px-3 py-2 border-b border-gray-700">0</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">c</td>

            <td class="px-3 py-2 border-b border-gray-700">1</td>

            <td class="px-3 py-2 border-b border-gray-700">3</td>

            <td class="px-3 py-2 border-b border-gray-700">6</td>

            <td class="px-3 py-2 border-b border-gray-700">8</td>

            <td class="px-3 py-2 border-b border-gray-700">12</td>

            <td class="px-3 py-2 border-b border-gray-700">14</td>

            <td class="px-3 py-2 border-b border-gray-700">10</td>

            <td class="px-3 py-2 border-b border-gray-700">12</td>

            <td class="px-3 py-2 border-b border-gray-700">12</td>

            <td class="px-3 py-2 border-b border-gray-700">12</td>

            <td class="px-3 py-2 border-b border-gray-700">10</td>

            <td class="px-3 py-2 border-b border-gray-700">4</td>

            <td class="px-3 py-2 border-b border-gray-700">6</td>

            <td class="px-3 py-2 border-b border-gray-700">4</td>

            <td class="px-3 py-2 border-b border-gray-700">4</td>

            <td class="px-3 py-2 border-b border-gray-700">0</td>

            <td class="px-3 py-2 border-b border-gray-700">6</td>

            <td class="px-3 py-2 border-b border-gray-700">2</td>

            <td class="px-3 py-2 border-b border-gray-700">2</td>

            <td class="px-3 py-2 border-b border-gray-700">0</td>

            <td class="px-3 py-2 border-b border-gray-700">2</td>

            <td class="px-3 py-2 border-b border-gray-700">0</td>

            <td class="px-3 py-2 border-b border-gray-700">0</td>

            <td class="px-3 py-2 border-b border-gray-700">0</td>

            <td class="px-3 py-2 border-b border-gray-700">2</td>

            <td class="px-3 py-2 border-b border-gray-700">0</td>

            <td class="px-3 py-2 border-b border-gray-700">0</td>

            <td class="px-3 py-2 border-b border-gray-700">0</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">6</td>

            <td class="px-3 py-2 border-b border-gray-700">a</td>

            <td class="px-3 py-2 border-b border-gray-700">1</td>

            <td class="px-3 py-2 border-b border-gray-700">3</td>

            <td class="px-3 py-2 border-b border-gray-700">6</td>

            <td class="px-3 py-2 border-b border-gray-700">8</td>

            <td class="px-3 py-2 border-b border-gray-700">12</td>

            <td class="px-3 py-2 border-b border-gray-700">14</td>

            <td class="px-3 py-2 border-b border-gray-700">14</td>

            <td class="px-3 py-2 border-b border-gray-700">16</td>

            <td class="px-3 py-2 border-b border-gray-700">12</td>

            <td class="px-3 py-2 border-b border-gray-700">24</td>

            <td class="px-3 py-2 border-b border-gray-700">14</td>

            <td class="px-3 py-2 border-b border-gray-700">20</td>

            <td class="px-3 py-2 border-b border-gray-700">10</td>

            <td class="px-3 py-2 border-b border-gray-700">12</td>

            <td class="px-3 py-2 border-b border-gray-700">12</td>

            <td class="px-3 py-2 border-b border-gray-700">8</td>

            <td class="px-3 py-2 border-b border-gray-700">12</td>

            <td class="px-3 py-2 border-b border-gray-700">12</td>

            <td class="px-3 py-2 border-b border-gray-700">12</td>

            <td class="px-3 py-2 border-b border-gray-700">4</td>

            <td class="px-3 py-2 border-b border-gray-700">10</td>

            <td class="px-3 py-2 border-b border-gray-700">4</td>

            <td class="px-3 py-2 border-b border-gray-700">4</td>

            <td class="px-3 py-2 border-b border-gray-700">0</td>

            <td class="px-3 py-2 border-b border-gray-700">6</td>

            <td class="px-3 py-2 border-b border-gray-700">4</td>

            <td class="px-3 py-2 border-b border-gray-700">4</td>

            <td class="px-3 py-2 border-b border-gray-700">0</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">b</td>

            <td class="px-3 py-2 border-b border-gray-700">1</td>

            <td class="px-3 py-2 border-b border-gray-700">3</td>

            <td class="px-3 py-2 border-b border-gray-700">6</td>

            <td class="px-3 py-2 border-b border-gray-700">8</td>

            <td class="px-3 py-2 border-b border-gray-700">12</td>

            <td class="px-3 py-2 border-b border-gray-700">14</td>

            <td class="px-3 py-2 border-b border-gray-700">14</td>

            <td class="px-3 py-2 border-b border-gray-700">16</td>

            <td class="px-3 py-2 border-b border-gray-700">12</td>

            <td class="px-3 py-2 border-b border-gray-700">24</td>

            <td class="px-3 py-2 border-b border-gray-700">14</td>

            <td class="px-3 py-2 border-b border-gray-700">20</td>

            <td class="px-3 py-2 border-b border-gray-700">10</td>

            <td class="px-3 py-2 border-b border-gray-700">12</td>

            <td class="px-3 py-2 border-b border-gray-700">12</td>

            <td class="px-3 py-2 border-b border-gray-700">8</td>

            <td class="px-3 py-2 border-b border-gray-700">12</td>

            <td class="px-3 py-2 border-b border-gray-700">12</td>

            <td class="px-3 py-2 border-b border-gray-700">12</td>

            <td class="px-3 py-2 border-b border-gray-700">4</td>

            <td class="px-3 py-2 border-b border-gray-700">10</td>

            <td class="px-3 py-2 border-b border-gray-700">4</td>

            <td class="px-3 py-2 border-b border-gray-700">4</td>

            <td class="px-3 py-2 border-b border-gray-700">0</td>

            <td class="px-3 py-2 border-b border-gray-700">6</td>

            <td class="px-3 py-2 border-b border-gray-700">4</td>

            <td class="px-3 py-2 border-b border-gray-700">4</td>

            <td class="px-3 py-2 border-b border-gray-700">0</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">c</td>

            <td class="px-3 py-2 border-b border-gray-700">1</td>

            <td class="px-3 py-2 border-b border-gray-700">3</td>

            <td class="px-3 py-2 border-b border-gray-700">6</td>

            <td class="px-3 py-2 border-b border-gray-700">8</td>

            <td class="px-3 py-2 border-b border-gray-700">12</td>

            <td class="px-3 py-2 border-b border-gray-700">14</td>

            <td class="px-3 py-2 border-b border-gray-700">14</td>

            <td class="px-3 py-2 border-b border-gray-700">16</td>

            <td class="px-3 py-2 border-b border-gray-700">12</td>

            <td class="px-3 py-2 border-b border-gray-700">24</td>

            <td class="px-3 py-2 border-b border-gray-700">14</td>

            <td class="px-3 py-2 border-b border-gray-700">20</td>

            <td class="px-3 py-2 border-b border-gray-700">10</td>

            <td class="px-3 py-2 border-b border-gray-700">12</td>

            <td class="px-3 py-2 border-b border-gray-700">12</td>

            <td class="px-3 py-2 border-b border-gray-700">8</td>

            <td class="px-3 py-2 border-b border-gray-700">12</td>

            <td class="px-3 py-2 border-b border-gray-700">12</td>

            <td class="px-3 py-2 border-b border-gray-700">12</td>

            <td class="px-3 py-2 border-b border-gray-700">4</td>

            <td class="px-3 py-2 border-b border-gray-700">10</td>

            <td class="px-3 py-2 border-b border-gray-700">4</td>

            <td class="px-3 py-2 border-b border-gray-700">4</td>

            <td class="px-3 py-2 border-b border-gray-700">0</td>

            <td class="px-3 py-2 border-b border-gray-700">6</td>

            <td class="px-3 py-2 border-b border-gray-700">4</td>

            <td class="px-3 py-2 border-b border-gray-700">4</td>

            <td class="px-3 py-2 border-b border-gray-700">0</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

          </tr>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">aligned round functions, but also distinguishers only applicable to the permutation.</p>

    <p class="text-gray-300">Truncated and Impossible Differential Attacks. A variant of differential cryptanalysis is the truncated differential cryptanalysis [47]. In the latter, the attacker does not fix the values of the differences, but specifies conditions between the differences of the branches of the round that should be satisfied, or fixes some differences at the input of the branches to zero. The attacker works with truncated differential characteristics, which are a collection/set of several differential characteristic.</p>

    <p class="text-gray-300">Impossible differential cryptanalysis was introduced by Biham et al. [16] and Knudsen [48]. It exploits differentials that occur with probability zero.</p>

    <p class="text-gray-300">Regarding our scheme, we do not expect these two attacks to outperform the attacks that are presented in Sect. 4. As an example, a truncated differential with probability one covering one round can be used as starting point to present an impossible differential for two rounds:</p>

    <div class="my-4 text-center"><span class="math-block">\\{(0, 0, x) \\} \\xrightarrow {\\text {p r o b .} 1} \\{(x, R C _ {4 \\ell} x, x) \\} \\neq \\{(0, 0, y) \\} \\xleftarrow {\\text {p r o b .} 1} \\{(y, R C _ {4 \\ell} y, y) \\},</span></div>

    <p class="text-gray-300">where  <span class="math">(x,y)\\neq 0</span></p>

    <p class="text-gray-300">Zero-Sum Distinguishers. Zero-sum distinguishers [20] are so-called inside-out distinguishers on the permutation. With this type of distinguishers, an attacker crafts an initial structure that is placed somewhere in the middle of</p>

    <p class="text-gray-300">the permutation, and computes forward to the input and backward output of the permutation. An attacker can compute a set of input and output values that sums to zero by carefully selecting and employing the initial structure, and choosing the algebraic degree of the round function and the inverse of the round function.</p>

    <p class="text-gray-300">To prevent the use of such distinguishers against our round function, we need at least <span class="math">2s</span> rounds. We are fairly confident that this distinguishing property is unlikely to extend towards distinguisher of the used modes. For instance, zero-sum distinguisher on <em>full</em> Keccak-<span class="math">p</span> <em>[20]</em> are well known. On the contrary, attacks on constructions that use 12 rounds of the Keccak permutation, and that exploit this property are not known. This is half the number of rounds.</p>

    <h4 id="sec-36" class="text-lg font-semibold mt-6">Boomerang and Differential-linear Distinguishers.</h4>

    <p class="text-gray-300">Boomerang <em>[62]</em> and differential-linear <em>[50]</em> distinguishers, and their variants, rely on chaining two good differential/linear trails. As studied in Sect. 4, we have at least one active multiplication per three rounds in our trail. Those distinguishers are then rather unlikely. However, even if an attacker can find good differentials, or linear hulls, a differential-linear/boomerang distinguisher can only cover up to six rounds.</p>

    <h4 id="sec-37" class="text-lg font-semibold mt-6">Zero-correlation Attacks.</h4>

    <p class="text-gray-300">As their name suggest, these attacks exploit linear hulls with a zero correlation <em>[18]</em>. In general, those linear hulls are found by a miss-in-the-middle approach. For example, we need to find two trails that propagate some deterministic properties, and then to combine them, in order to ensure that the property cannot be fulfilled. However, our permutations have at least nine rounds, and based on the results of our differential and linear analysis, we assume that finding impossible differentials or zero-correlation linear hulls is infeasible.</p>

    <h4 id="sec-38" class="text-lg font-semibold mt-6">More Attacks Exploiting Strong Alignment.</h4>

    <p class="text-gray-300">As a cipher working natively on larger field elements, Ciminion could be considered to be strongly aligned. Many more attack vectors exist that exploit strong alignment on ciphers, especially for AES (see <em>[41]</em>). However, we conjecture that such attacks become quickly infeasible, because the security level is tied to the size of the field element, and there is a huge number of rounds compared to the number of field elements that form the state.</p>

    <h2 id="sec-39" class="text-2xl font-bold">Appendix F Security Analysis – Data Limit <span class="math">2^{s/2}</span></h2>

    <p class="text-gray-300">For applications like MPC, given a security level of <span class="math">s</span> bits, the data is limited to <span class="math">2^{s/2}</span> (namely, related to the birthday bound) instead of <span class="math">2^{s}</span>. For this reason, we analyze in this section the number of rounds that is required to provide security, if limited data is available to the attacker. We focus our attention on algebraic attacks, which are the most powerful ones against our cipher. In the following, we demonstrate that a lower number of rounds, w.r.t. the ones given previously,</p>

    <p class="text-gray-300">is sufficient to provide security. Additionally, we verify that the chosen number of rounds guarantees security against statistical attacks.</p>

    <h4 id="sec-40" class="text-lg font-semibold mt-6">Interpolation Attack.</h4>

    <p class="text-gray-300">The amount of data that is available to the attacker highly impacts the interpolation attack. Indeed, this attack can be set up if the number of texts is higher than or equal to the number of monomials that defines the polynomial. Since the number of monomials is related to the degree of the polynomial, a lower number of rounds (w.r.t. the one given previously) is sufficient to prevent this attack. In particular, assuming that the polynomial that describes the scheme is dense, since the degree grows as <span class="math">2^{r}</span> after <span class="math">r</span> rounds, approximately <span class="math">s/2</span> rounds are sufficient to prevent the attack (for data limited to <span class="math">2^{s/2}</span>). We arbitrarily decided to increase the number of rounds for <span class="math">p_{C}</span> to <span class="math">2/3\\cdot s</span> to provide some extra security against this attack.</p>

    <h4 id="sec-41" class="text-lg font-semibold mt-6">Gröbner Basis Attack.</h4>

    <p class="text-gray-300">The Gröbner basis attack that is described in the previous sections, requires a few number of texts that are much lower than <span class="math">2^{s/2}</span>. Hence, the analysis that is presented in Sect. 4.4, can also be applied in this case. The number of rounds for <span class="math">p_{C}</span> must thus be higher than <span class="math">s/2</span>, while the number of rounds for <span class="math">p_{E}</span> must be equal to <span class="math">\\left\\lceil\\frac{s+19}{12}+1.5\\right\\rceil</span>.</p>

    <h4 id="sec-42" class="text-lg font-semibold mt-6">Statistical Attacks.</h4>

    <p class="text-gray-300">Since the efficiency of statistical attacks depends on the amount of data that is available to the attacker, a lower number of rounds w.r.t. the standard one is still sufficient to guarantee security. We arbitrarily decided in this case to keep the same number of rounds as in the standard scenario, namely at least six rounds.</p>

    <h4 id="sec-43" class="text-lg font-semibold mt-6">Conclusion.</h4>

    <p class="text-gray-300">We conjecture that <span class="math">2/3\\cdot(s+6)</span> rounds for <span class="math">p_{C}</span>, and <span class="math">\\left\\lceil\\frac{s+19}{12}+1.5\\right\\rceil</span> rounds for <span class="math">p_{E}</span>, are sufficient to provide a security level of <span class="math">s</span> bits, if the amount of data available to the attacker is limited to <span class="math">2^{s/2}</span>. Due to argument analogous the ones given in Sect. 4, this number of rounds provides security against statistical attacks, and higher-order differential attack.</p>

    <h2 id="sec-44" class="text-2xl font-bold">Appendix G Related Works: MPC Costs for Several Ciphers Published in the Literature</h2>

    <h3 id="sec-45" class="text-xl font-semibold mt-8">G.1 Related Works</h3>

    <h4 id="sec-46" class="text-lg font-semibold mt-6">MiMC.</h4>

    <p class="text-gray-300">MiMC <em>[3]</em> is a scheme that has been proposed over <span class="math">\\mathbb{F}_{q}</span>, where <span class="math">q</span> is either a prime <span class="math">p</span>, or a power of <span class="math">2</span> <span class="math">q=2^{n}</span>, where <span class="math">\\gcd(p-1,3)=1</span> or <span class="math">n</span> odd. The round function of the block cipher is defined as</p>

    <p class="text-gray-300"><span class="math">R_{i}(x)=x^{3}\\oplus k\\oplus c_{i}\\qquad\\text{or}\\qquad R_{i}(x)=x^{3}+k+c_{i}\\,,</span></p>

    <p class="text-gray-300">for a round constant <span class="math">c_{i}</span>, and a master key <span class="math">k</span>. In <span class="math">\\mathbb{F}_{q}^{\\;\\,t}</span>, the cipher MiMC can be used in CTR-mode.</p>

    <p class="text-gray-300">The number of rounds is equal to <span class="math">\\lceil\\log_{3}(p)\\rceil</span>, or <span class="math">\\lceil n\\cdot\\log_{3}(2)\\rceil</span>. In MPC application, the cost to evaluate a text in <span class="math">\\mathbb{F}^{t}</span> is thus given by</p>

    <p class="text-gray-300"><span class="math">\\#\\text{ multiplications:}\\qquad 2t\\cdot\\lceil\\log_{3}(p)\\rceil\\,,</span> <span class="math">(\\#\\text{ online, </span>\\#<span class="math"> offline})\\text{ rounds:}\\qquad(\\lceil\\log_{3}(p)\\rceil,0)\\,,</span></p>

    <p class="text-gray-300">for both the binary and the prime case (it is sufficient to replace <span class="math">p</span> with <span class="math">2^{n}</span>). We refer to <em>[42]</em> for a detailed explanation about the possibility to evaluate <span class="math">x\\to x^{3}</span> with a single communication round. Moreover, evaluating <span class="math">x\\to x^{3}</span> requires two multiplications in MPC applications in the binary case.</p>

    <p class="text-gray-300">We make some observations. First of all, in a “classical” application, the number of multiplications in the binary case can be divided by two, since <span class="math">x\\to x^{2}</span> does not require any multiplication. Secondly, for the Boolean case only, a new attack on full MiMC has been presented recently <em>[35]</em>. The latter attack combines a distinguisher based on higher-order differential technique (that can cover up to <span class="math">\\lceil(n-1)\\cdot\\log_{3}(2)\\rceil-1</span> rounds) with an interpolation technique. That makes it possible to find the secret key. Since the data cost of such attack is half of the full code-book, it does not apply in this context, because we are working with a PRF. Indeed, we only consider attacks whose complexities are below the birthday bound.</p>

    <h4 id="sec-47" class="text-lg font-semibold mt-6">GMiMC_{erf}</h4>

    <p class="text-gray-300">GMiMC_{erf} <em>[2]</em> is a scheme from GMiMC family over <span class="math">\\mathbb{F}_{p}^{\\ t}</span>. The round function is defined as</p>

    <p class="text-gray-300"><span class="math">(x_{1},x_{2},\\ldots,x_{t})\\to(x_{2}+(x_{1}+k^{(i)})^{3},x_{3}+(x_{1}+k^{(i)})^{3},\\ldots,x_{t}+(x_{1}+k^{(i)})^{3},x_{1}).</span></p>

    <p class="text-gray-300">The detail regarding the key schedule is explained in <em>[2]</em>. We note that the round keys can be precomputed, thus they do not influence the cost in MPC applications. Under the assumption that <span class="math">p\\gg t</span>, and for a security level of <span class="math">\\log_{2}(p)</span> bits, the number of rounds is given by</p>

    <p class="text-gray-300"><span class="math">\\max\\left\\{2+2\\cdot(t+t^{2}),\\lceil 2\\cdot\\log_{3}(p)\\rceil+2t\\right\\}.</span></p>

    <p class="text-gray-300">More precisely, the designers deduced that <span class="math">2+(t+t^{2})/2</span> are sufficient to prevent differential attacks, under the assumption that there is a differential trail for <span class="math">t+t^{2}</span> rounds with prob. <span class="math">4\\cdot p^{-2}</span>. However, in <em>[15]</em>, the authors demonstrated that such differential trail has a probability equal to <span class="math">2\\cdot p^{-1}</span>. Consequently, they proved the existence of differential distinguishers that can cover the full cipher (and even more). For this reason, we adapted the number of rounds as suggested by the authors of <em>[2]</em> (in a private communication).</p>

    <p class="text-gray-300">##</p>

    <p class="text-gray-300">With the same application as in MiMC, the MPC cost using <span class="math">\\mathrm{GM}\\mathrm{i}\\mathrm{MC}_{erf}</span> is given by:</p>

    <p class="text-gray-300"><span class="math">\\#\\ \\mathrm{multiplications:}\\qquad 2\\cdot\\mathrm{max}\\left\\{2+2(t+t^{2}),\\lceil 2\\cdot\\log_{3}(p)\\rceil+2t\\right\\}\\,,</span> <span class="math">(\\#\\ \\mathrm{online},\\ \\#\\ \\mathrm{offline})\\ \\mathrm{rounds:}\\qquad\\left(\\mathrm{max}\\left\\{2+2(t+t^{2}),\\lceil 2\\cdot\\log_{3}(p)\\rceil+2t\\right\\},0\\right).</span></p>

    <p class="text-gray-300">Vision. Vision [5] is an AES-like scheme that works over <span class="math">\\mathbb{F}_{2^{n}}^{t}</span> for any <span class="math">n\\geq 3</span>, and <span class="math">t\\geq 2</span>. The round function is composed of two sub-rounds. It is defined as the following: <span class="math">R(\\cdot)=R_{2}\\circ R_{1}(\\cdot)</span>, with</p>

    <p class="text-gray-300"><span class="math">R_{1}(\\cdot)=k\\oplus M\\times\\left[B\\circ S(\\cdot)\\right]\\,,\\qquad\\mathrm{and}\\qquad R_{2}(\\cdot)=k^{\\prime}\\oplus M\\times\\left[B^{-1}\\circ S(\\cdot)\\right]\\,.</span></p>

    <p class="text-gray-300">The S-box layer <span class="math">S(\\cdot)</span> is defined as the concatenation of S-boxes that work at word level, and that are defined as <span class="math">x\\mapsto 1/x</span> (where <span class="math">1/0:=0</span>). In addition, <span class="math">B(\\cdot)</span> is defined as the concatenation of invertible linearized polynomials that work at a word level, and that are defined as <span class="math">B(x)=x^{4}\\oplus b_{2}\\cdot x^{2}\\oplus b_{3}\\cdot x\\oplus b_{4}</span>. In addition, <span class="math">M</span> is a <span class="math">t\\times t</span> MDS matrix. For a security level of <span class="math">n</span> bits, the number of rounds is equal to <span class="math">\\mathrm{max}\\left\\{10,2\\left\\lceil\\frac{n+t+8}{8t}\\right\\rceil,2\\left\\lceil\\frac{2n}{(t+1)(n-4)}\\right\\rceil\\right\\}</span>.</p>

    <p class="text-gray-300">Concerning the number of multiplications, the only non-linear operation is the inverse. In a MPC application, the inversion step can be evaluated by using the technique of Bar-Ilan and Beaver [10]. In brief, given <span class="math">x,y,z</span> s.t. <span class="math">x/y=z</span> (where <span class="math">y\\neq 0</span>), the idea is to manipulate the equality <span class="math">x=y\\cdot z</span> rather than <span class="math">x/y=z</span>. This procedure requires two communication rounds, and works for all non-zero elements <span class="math">x\\in\\mathbb{F}_{2^{n}}</span>. In scenarios where the shared value is unlikely to be zero (i.e., if the field is large enough), this technique can be used directly. Ignoring the zero test, the total cost of this method is one communication round. In the latter, it is possible to merge a multiplication, and an opening call. As presented in [5, App. E.2 of Version: 20190520:100450], <span class="math">B(\\cdot)</span> and <span class="math">B^{-1}(\\cdot)</span> require respectively two and three multiplications in MPC. Like previously, to give an overview, instead of using <span class="math">B^{-1}(x)=y</span>, the idea is to work with <span class="math">y=B(x)</span> (remember that <span class="math">B(\\cdot)</span> is semi-linear in the sense that <span class="math">B(x\\oplus y)=B(x)\\oplus B(y)</span>).</p>

    <p class="text-gray-300">It results that the cost in MPC protocol to working over <span class="math">\\mathbb{F}^{t}</span> (for a security level of <span class="math">n</span> bits) is given by</p>

    <p class="text-gray-300"><span class="math">\\#\\ \\mathrm{multiplications:}\\qquad 7t\\cdot\\mathrm{max}\\left\\{10,2\\left\\lceil\\frac{n+t+8}{8t}\\right\\rceil,2\\left\\lceil\\frac{2n}{(t+1)(n-4)}\\right\\rceil\\right\\}\\,,</span> <span class="math">\\#\\ \\mathrm{online\\ rounds:}\\qquad 5\\cdot\\mathrm{max}\\left\\{10,2\\left\\lceil\\frac{n+t+8}{8t}\\right\\rceil,2\\left\\lceil\\frac{2n}{(t+1)(n-4)}\\right\\rceil\\right\\}\\,,</span> <span class="math">\\#\\ \\mathrm{offline\\ rounds:}\\qquad 2\\cdot\\mathrm{max}\\left\\{10,2\\left\\lceil\\frac{n+t+8}{8t}\\right\\rceil,2\\left\\lceil\\frac{2n}{(t+1)(n-4)}\\right\\rceil\\right\\}\\,.</span></p>

    <p class="text-gray-300">We refer to [5, Version: 20190520:100450] for all details about the number of online/offline rounds. In this section, we solely recall that such numbers are independent of the number of S-boxes computed in parallel.</p>

    <p class="text-gray-300">In comparison, the number of multiplications in a “classical setting” is much higher. In particular, using a square-and-multiply strategy, <span class="math">x\\mapsto x^{-1}=x^{2^{n}-2}</span> requires <span class="math">n-2</span> multiplications and <span class="math">n-1</span> squarings (see <em>[5, App. F of Version: 20190520:100450]</em>). In this case, the total number of multiplications is higher, and is given by <span class="math">2t\\cdot(n-2)\\cdot\\max\\left\\{10,2\\left\\lceil\\frac{n+t+8}{8t}\\right\\rceil,2\\left\\lceil\\frac{2n}{(t+1)(n-4)}\\right\\rceil\\right\\}\\in\\mathcal{O}(n\\cdot t)</span>.</p>

    <h4 id="sec-48" class="text-lg font-semibold mt-6">Rescue.</h4>

    <p class="text-gray-300">Rescue <em>[5]</em> is an AES-like scheme that works over <span class="math">\\mathbb{F}_{p}^{\\ t}</span> for a prime <span class="math">p\\geq 3</span>, and <span class="math">t\\geq 2</span>. Let <span class="math">\\alpha\\geq 3</span> be the lowest integer s.t. <span class="math">\\gcd(p-1,\\alpha)=1</span>. The round function that is composed of two sub-rounds <span class="math">R(\\cdot)=R_{2}\\circ R_{1}(\\cdot)</span> is defined as follows:</p>

    <p class="text-gray-300"><span class="math">R_{1}(\\cdot)=k+M\\times S^{-1}(\\cdot)\\,,\\qquad\\text{ and }\\qquad R_{2}(\\cdot)=k^{\\prime}+M\\times S(\\cdot)\\,.</span></p>

    <p class="text-gray-300">The S-box layer <span class="math">S(\\cdot)</span> is defined as the concatenation of S-boxes that work at word level, where as <span class="math">x\\mapsto x^{\\alpha}</span> (and S-box<span class="math">{}^{-1}(x)=x^{1/\\alpha}</span>). <span class="math">M</span> is a <span class="math">t\\times t</span> MDS matrix. For a security level of <span class="math">\\approx\\log_{2}(p)</span> bits and <span class="math">\\alpha=3</span>, the number of rounds is equal to <span class="math">\\max\\left\\{10,2\\cdot\\left\\lceil\\frac{\\log_{2}(p)+2}{4t}\\right\\rceil;2\\cdot\\left\\lceil\\frac{2\\log_{2}(p)}{(t+1)\\cdot(\\log_{2}(p)-1)}\\right\\rceil\\right\\}</span>.</p>

    <p class="text-gray-300">The only non-linear operations of Rescue to consider are the <span class="math">\\alpha</span>, and inverse-<span class="math">\\alpha</span> power maps. For any arbitrary large <span class="math">\\beta</span>, <span class="math">x\\mapsto x^{\\beta}</span> can be computed by adapting the exponentiation technique that was introduced by Damgård et al. <em>[30]</em>. This technique requires <span class="math">\\lceil\\log_{2}\\beta\\rceil+2</span> multiplications. Hence, the cost in a MPC protocol is given by</p>

    <ul class="list-disc list-inside space-y-1 text-gray-300 my-2 ml-4">

      <li># multiplications:</li>

    </ul>

    <p class="text-gray-300"><span class="math">t\\cdot(4\\lceil\\log_{2}\\alpha\\rceil+4)\\cdot\\max\\left\\{5;\\left\\lceil\\frac{\\log_{2}(p)+2}{4t}\\right\\rceil;\\left\\lceil\\frac{2\\log_{2}(p)}{(t+1)\\cdot(\\log_{2}(p)-1)}\\right\\rceil\\right\\}\\,,</span></p>

    <ul class="list-disc list-inside space-y-1 text-gray-300 my-2 ml-4">

      <li># online rounds: <span class="math">4\\cdot\\max\\left\\{5;\\left\\lceil\\frac{\\log_{2}(p)+2}{4t}\\right\\rceil;\\left\\lceil\\frac{2\\log_{2}(p)}{(t+1)\\cdot(\\log_{2}(p)-1)}\\right\\rceil\\right\\}\\,,</span></li>

      <li># offline rounds:</li>

    </ul>

    <p class="text-gray-300"><span class="math">(2\\lceil\\log_{2}\\alpha\\rceil+2)\\cdot\\max\\left\\{5;\\left\\lceil\\frac{\\log_{2}(p)+2}{4t}\\right\\rceil;\\left\\lceil\\frac{2\\log_{2}(p)}{(t+1)\\cdot(\\log_{2}(p)-1)}\\right\\rceil\\right\\}\\,,</span></p>

    <p class="text-gray-300">where we refer to <em>[5, Version: 20190520:100450]</em> for more details about the number of online/offline rounds.</p>

    <p class="text-gray-300">In comparison, the number of multiplications is higher in a “classical setting”. In particular, <span class="math">x^{\\alpha}</span> requires approximately <span class="math">\\lceil\\log_{2}\\alpha\\rceil</span> multiplications, while <span class="math">x^{1/\\alpha}</span> requires approximately <span class="math">\\lceil\\log_{2}\\alpha\\rceil+\\lceil\\log_{2}p\\rceil</span> multiplications (see <em>[5, App. F of Version: 20190520:100450]</em>). For this reason, by applying a square-and-multiply strategy, the number of multiplications is higher, and approximately given by <span class="math">2t\\cdot(2\\lceil\\log_{2}\\alpha\\rceil+\\lceil\\log_{2}p\\rceil)\\cdot\\max\\left\\{5,\\left\\lceil\\frac{\\log_{2}(p)+2}{4t}\\right\\rceil;\\left\\lceil\\frac{2\\log_{2}(p)}{(t+1)\\cdot(\\log_{2}(p)-1)}\\right\\rceil\\right\\}\\in\\mathcal{O}(\\log_{2}(p)\\cdot t)</span>.</p>

    <h3 id="sec-49" class="text-xl font-semibold mt-8">G.2 About Fork-like Ciphers</h3>

    <p class="text-gray-300">Our design is based on a modified version of Farfalle that can be viewed as a generalization of the “ForkCipher” design <em>[7]</em>. A ForkCipher design is instan</p>

    <p class="text-gray-300">by keyed permutations <span class="math">P_{k},\\hat{P}_{k},\\tilde{P}_{k}</span> over <span class="math">\\mathbb{F}</span>, which are in general defined as the concatenation of a certain number of rounds of a given cipher. In this design, every input <span class="math">x\\in\\mathbb{F}</span> is mapped to</p>

    <p class="text-gray-300"><span class="math">\\text{ForkP}(x)=(\\hat{P}_{k}\\circ P_{k}(x),\\tilde{P}_{k}\\circ P_{k}(x))\\in\\mathbb{F}^{2}.</span></p>

    <p class="text-gray-300">However, unlike our design, a Fork-like cipher is invertible. That is to say, given <span class="math">\\text{ForkP}(x)=(\\hat{y},\\tilde{y})</span>, the following operations are possible:</p>

    <p class="text-gray-300"><span class="math">\\text{Decryption:}\\qquad x=P_{k}^{-1}\\circ\\hat{P}_{k}^{-1}(\\hat{y})=P_{k}^{-1}\\circ\\tilde{P}_{k}^{-1}(\\tilde{y}),</span> <span class="math">\\text{Inversion:}\\qquad\\tilde{P}_{k}\\circ\\tilde{P}_{k}^{-1}(\\hat{y})=\\tilde{y}\\text{ and }\\tilde{P}_{k}\\circ\\tilde{P}_{k}^{-1}(\\hat{y})=\\hat{y}.</span></p>

    <p class="text-gray-300">None of them is possible in our design, because the input of the middle phase is obtained by adding the outputs of the compression phase, and because of the truncation applied on the output words.</p>

    <h2 id="sec-50" class="text-2xl font-bold">Appendix H Towards an Authenticated Encryption Scheme</h2>

    <p class="text-gray-300">A potential direction that can be explored when authenticated encryption is needed, is to pair our encryption scheme with a Wegman-Carter MAC <em>[23]</em>. This makes it possible to process one ciphertext element with one field multiplication as shown in Fig. 10.</p>

    <p class="text-gray-300">To be more specific, to augment Ciminion with the authentication of ciphertexts, a similar approach to GHASH that is part of GCM <em>[52]</em>, can be used. In further detail, our construction uses <span class="math">T=\\textit{uhash}(\\hat{K},C)+\\textit{prf}(\\aleph)</span>, where <span class="math">\\textit{uhash}(\\hat{K},C)=C_{1}\\hat{K}^{2l+1}+C_{2}\\hat{K}^{2l}+\\cdots C_{2l}\\hat{K}^{2}+\\textit{len}(C)\\hat{K}</span> with <span class="math">\\hat{K}</span> as secret key element, <span class="math">\\textit{len}(C)</span> the number of field elements in <span class="math">C</span>, and <span class="math">\\textit{prf}(\\aleph)</span> an instantiation that is part of our Farfalle-like construction (Fig. 3).</p>

    <p class="text-gray-300">The security of the resulting Wegman-Carter MAC depends on the security of the used instance of <span class="math">\\textit{prf}(\\aleph)</span>, and the <span class="math">\\epsilon</span>-almost-<span class="math">\\Delta</span>-universality of the universal hash function <span class="math">\\textit{uhash}(\\hat{K},C)</span> that is employed. We have <span class="math">P(\\textit{uhash}(\\hat{K},C)+\\textit{uhash}(\\hat{K},C^{\\prime})=A)\\leq\\epsilon</span> for any constant <span class="math">A</span> over a uniformly random choice of <span class="math">\\hat{K}</span>. Following McGrew and Viega <em>[52]</em> for our choice of <span class="math">\\textit{uhash}(\\hat{K},C)</span>, we have <span class="math">\\epsilon\\leq(2l+1)2^{-n}</span> for <span class="math">\\mathbb{F}_{2^{n}}</span>, or <span class="math">\\epsilon\\leq(2l+1)/p</span> for <span class="math">\\mathbb{F}_{p}</span>, where <span class="math">2l</span> is the maximal number of elements per call to authenticated encryption or decryption. Like mentioned by Procter <em>[56]</em>, an adversary then has an advantage that is at most <span class="math">\\beta\\varepsilon</span> plus the advantage in breaking <span class="math">\\textit{prf}(\\aleph)</span> for creating a forgery. In this case, <span class="math">\\beta</span> is the total number of queries that are made to the authenticated encryption or decryption. Hence, for maintaining a sufficient level of security, the maximum length of messages, the maximum number of messages, and the verification attempts have to be limited.</p>

    <p class="text-gray-300">Despite the latter restriction and other unfavorable properties <em>[57]</em> of this style of authentication, we think that the efficiency benefits provided by Wegman-Carter-style MACs in scenarios where finite field multiplication is the dominant cost factor, reasonably counterbalance its downsides.</p>

    <p class="text-gray-300">!<a href="img-10.jpeg">img-10.jpeg</a> Fig. 10: Authenticated encryption with CIMINION plus Wegman-Carter MAC over  <span class="math">\\mathbb{F}_{2^n}</span> . The construction is similar over  <span class="math">\\mathbb{F}_p</span>  ( <span class="math">\\oplus</span>  is replaced by  <span class="math">+</span> , the addition modulo  <span class="math">p</span> ).</p>

    <p class="text-gray-300">Algorithm 1: Encryption and decryption, where  <span class="math">\\mathbb{F}</span>  is either  <span class="math">\\mathbb{F}_{2^n}</span> , or  <span class="math">\\mathbb{F}_p</span> .</p>

    <p class="text-gray-300">|  Encryption  |</p>

    <p class="text-gray-300">| --- |</p>

    <p class="text-gray-300">|  Require: key K ∈ {F}2[o/2],  |</p>

    <p class="text-gray-300">|  nonce K ∈ F,  |</p>

    <p class="text-gray-300">|  plaintext P ∈ {F}°  |</p>

    <p class="text-gray-300">|  Ensure: ciphertext C ∈ {F}°  |</p>

    <p class="text-gray-300">|  Processing Nonce  |</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">S1</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">S2</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">S3 ← K</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">K1</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">K2</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">|  Encrypting Plaintext  |</p>

    <p class="text-gray-300">|  for i = 1, ..., [o/2] do  |</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">O1</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">O2</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">O3 ← pE(S1</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">S2</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">S3)</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">|  C2i-1 ← O1 + P2i-1  |</p>

    <p class="text-gray-300">|  if i < [o/2] OR [o/2] = o/2 then  |</p>

    <p class="text-gray-300">|  C2i ← O2 + P2i  |</p>

    <p class="text-gray-300">|  if i < [o/2] then  |</p>

    <p class="text-gray-300">|  S2 ← S2 + Ki+1  |</p>

    <p class="text-gray-300">|  S3 ← S3 + Ki+2  |</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">S1</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">S2</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">S3 ← rol(S1</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">S2</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">S3)</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">|  Decryption  |</p>

    <p class="text-gray-300">| --- |</p>

    <p class="text-gray-300">|  Require: key K ∈ {F}2[o/2],  |</p>

    <p class="text-gray-300">|  nonce K ∈ F,  |</p>

    <p class="text-gray-300">|  ciphertext C ∈ {F}°  |</p>

    <p class="text-gray-300">|  Ensure: plaintext P ∈ {F}°  |</p>

    <p class="text-gray-300">|  Processing Nonce  |</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">S1</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">S2</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">S3 ← K</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">K1</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">K2</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">|  Decrypting Ciphertext  |</p>

    <p class="text-gray-300">|  for i = 1, ..., [o/2] do  |</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">O1</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">O2</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">O3 ← pE(S1</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">S2</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">S3)</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">|  P2i-1 ← O1 + C2i-1  |</p>

    <p class="text-gray-300">|  if i < [o/2] OR [o/2] = o/2 then  |</p>

    <p class="text-gray-300">|  P2i ← O2 + C2i  |</p>

    <p class="text-gray-300">|  if i < [o/2] then  |</p>

    <p class="text-gray-300">|  S2 ← S2 + Ki+1  |</p>

    <p class="text-gray-300">|  S3 ← S3 + Ki+2  |</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">S1</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">S2</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">S3 ← rol(S1</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">S2</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">S3)</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">Algorithm 2: Generation of key elements, where  <span class="math">\\mathbb{F}</span>  is either  <span class="math">\\mathbb{F}_{2^n}</span> , or  <span class="math">\\mathbb{F}_p</span> .</p>

    <p class="text-gray-300">|  Generation of Key Elements  |</p>

    <p class="text-gray-300">| --- |</p>

    <p class="text-gray-300">|  Require: master key MK ∈ {F}2, IVH ∈ F  |</p>

    <p class="text-gray-300">|  Ensure: key elements K ∈ {F}o  |</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">S1</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">S2</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">S3 ← IVH</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">MK2</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">|  for i = 1, ..., o do  |</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">S1</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">S2</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">S3 ← pc(S1</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">S2</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">S3)</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">|  Ki ← S1  |</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">return K1</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">...</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Ko</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">Algorithm 3: Permutation  <span class="math">p_N</span>  and rolling function  <span class="math">rol</span> , where  <span class="math">\\mathbb{F}</span>  is either  <span class="math">\\mathbb{F}_{2^n}</span> , or  <span class="math">\\mathbb{F}_p</span> .</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Rolling Function rol</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Permutation pN</th>

          </tr>

        </thead>

        <tbody>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">Require: lα ∈ F, lb ∈ F, lc ∈ F</td>

            <td class="px-3 py-2 border-b border-gray-700">Require: a ∈ F, b ∈ F, c ∈ F</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">Ensure: ωa ∈ F, ωb ∈ F, ωc ∈ F</td>

            <td class="px-3 py-2 border-b border-gray-700">Ensure: a ∈ F, b ∈ F, c ∈ F</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">l_c ← l_c + l_a · l_b</td>

            <td class="px-3 py-2 border-b border-gray-700">for i = 1, ..., N do</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">ωa ← l_c</td>

            <td class="px-3 py-2 border-b border-gray-700">c ← c + a · b</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">ωc ← l_b</td>

            <td class="px-3 py-2 border-b border-gray-700">b ← b + c</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">ωb ← l_a</td>

            <td class="px-3 py-2 border-b border-gray-700">a ← a + RC4i+E-N · b</td>

          </tr>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">|   | d ← a + RC1i+E-N  |</p>

    <p class="text-gray-300">|   | a ← c + RC3i+E-N  |</p>

    <p class="text-gray-300">|   | c ← b + RC2i+E-N  |</p>

    <p class="text-gray-300">|   | b ← d  |</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">return ωa, ωb, ωc</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">return a, b, c</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>`;
---

<BaseLayout title="Ciminion: Symmetric Encryption Based on Toffoli-Gates over L... (2021/267)">
  <article class="max-w-4xl mx-auto article-prose">
    <nav class="mb-8">
      <a href="/papers" class="text-blue-400 hover:text-blue-300">
        &larr; Back to Papers
      </a>
    </nav>

    <header class="mb-12">
      <h1 class="text-3xl font-bold mb-4"
        set:html={TITLE_HTML} />
      <p class="text-gray-400 mb-2"
        set:html={AUTHORS_HTML} />
      <p class="text-gray-500 text-sm mb-4">
        2021 &middot; eprint 2021/267
      </p>
      <div class="flex gap-4 text-sm">
        <a
          href={EPRINT_URL}
          target="_blank"
          rel="noopener noreferrer"
          class="text-blue-400 hover:text-blue-300"
        >
          Paper (eprint) &rarr;
        </a>
      </div>
      <p class="mt-4 text-xs text-gray-500">
        All content below belongs to the original authors. This page
        reproduces the paper for educational purposes. Always
        <a
          href={EPRINT_URL}
          target="_blank"
          rel="noopener noreferrer"
          class="text-blue-400 hover:text-blue-300"
        >cite the original</a>.
      </p>
      <p class="mt-1 text-xs text-gray-600">
        Converted with: {CRAWLER} &middot; {CONVERTED_DATE}
      </p>
    </header>

    <Fragment set:html={CONTENT} />

  </article>
</BaseLayout>
