---
import BaseLayout from '../../layouts/BaseLayout.astro';

const EPRINT_URL = 'https://eprint.iacr.org/2015/1142';
const CRAWLER = 'mistral';
const CONVERTED_DATE = '2026-02-16';
const TITLE_HTML = 'Midori: A Block Cipher for Low Energy (Extended Version)';
const AUTHORS_HTML = 'Subhadeep Banik, Andrey Bogdanov, Takanori Isobe, Kyoji Shibutani, Harunaga Hiwatari, Toru Akishita, Francesco Regazzoni';

const CONTENT = `    <p class="text-gray-300">Midori: A Block Cipher for Low Energy (Extended Version)</p>

    <p class="text-gray-300">Subhadeep Banik^{1}, Andrey Bogdanov^{1}, Takanori Isobe^{2}, Kyoji Shibutani^{2}, Harunaga Hiwatari^{2}, Toru Akishita^{2}, and Francesco Regazzoni^{3}</p>

    <p class="text-gray-300">^{1} Technical University of Denmark, Denmark. {subb,anbog}@dtu.dk ^{2} Sony Corporation, Japan. {Takanori.Isobe,Kyoji.Shibutani,Harunaga. Hiwatari,Toru.Akishita}@jp.sony.com ^{3} University of Lugano, Switzerland. regazzoni@alari.ch</p>

    <p class="text-gray-300">Abstract. In the past few years, lightweight cryptography has become a popular research discipline with a number of ciphers and hash functions proposed. The designersâ€™ focus has been predominantly to minimize the hardware area, while other goals such as low latency have been addressed rather recently only. However, the optimization goal of low energy for block cipher design has not been explicitly addressed so far. At the same time, it is a crucial measure of goodness for an algorithm. Indeed, a cipher optimized with respect to energy has wide applications, especially in constrained environments running on a tight power/energy budget such as medical implants.</p>

    <p class="text-gray-300">This paper presents the block cipher Midori that is optimized with respect to the energy consumed by the circuit per bit in encryption or decryption operation. We deliberate on the design choices that lead to low energy consumption in an electrical circuit, and try to optimize each component of the circuit as well as its entire architecture for energy. An added motivation is to make both encryption and decryption functionalities available by small tweak in the circuit that would not incur significant area or energy overheads. We propose two energy-efficient block ciphers Midori128 and Midori64 with block sizes equal to 128 and 64 bits respectively. These ciphers have the added property that a circuit that provides both the functionalities of encryption and decryption can be designed with very little overhead in terms of area and energy. We compare our results with other ciphers with similar characteristics: it was found that the energy consumptions of Midori64 and Midori128 are by far better when compared ciphers like PRINCE and NOEKEON.</p>

    <p class="text-gray-300">Keywords: AES, lightweight block cipher, low energy circuits</p>

    <p class="text-gray-300">1 Introduction</p>

    <p class="text-gray-300">The field of lightweight cryptography has gone into overdrive as evident from the number of cipher proposals that have emerged in the past few years, like</p>

    <p class="text-gray-300">^{4} The name of the cipher is the Japanese translation for the word Green.</p>

    <p class="text-gray-300">CLEFIA <em>[33]</em>, KATAN <em>[14]</em>, KLEIN <em>[19]</em>, LED <em>[20]</em>, PRESENT <em>[12]</em>, Piccolo <em>[32]</em>, PRINCE <em>[13]</em>, SIMON/SPECK <em>[6]</em> to name a few. However, the Advanced Encryption Standard (AES) <em>[17]</em> still remains the de-facto standard when it comes to practical lightweight encryption. The past few years have seen several low-power/area architectures for AES being reported in literature <em>[28, 31, 18]</em>. However, there has been little work that goes on to determine the design choices that lead to the most energy-efficient architecture. There are many parameters that contribute to the efficiency of a given lightweight design, with area, power, throughput and energy being the foremost among them. Power and energy, are correlated parameters, as energy is essentially the time integral of power, and power is equivalent to the energy consumed per unit time or simply the rate of energy consumption. Energy consumption, thus, is a measure of the total work done by voltage source during the execution of an operation. Hence, in many ways, energy rather than power may be a more relevant parameter to measure the efficiency of a design. Serial architectures of any block cipher that reduce the width of the datapath and reuse components, have a smaller power footprint than round based implementations in which the data path is equal to the block length of the cipher. However, serial implementations usually have high latency, that is, they take much longer to compute the result of an encryption operation than their round based counterparts, and as a result may end up consuming more energy. Therefore, there is no guarantee that low power architectures would necessarily lead to low energy architectures and vice versa.</p>

    <p class="text-gray-300">In <em>[22, 5]</em>, an evaluation of several lightweight block ciphers with respect to various hardware performance metrics, with a particular focus on the energy cost was done. A formal model for energy consumption in any <span class="math">r</span>-round unrolled block cipher architecture was proposed in <em>[3]</em>. However these papers do not specifically outline design choices that lead to energy-efficient designs.</p>

    <h3 id="sec-1" class="text-xl font-semibold mt-8">1.1 Our contributions</h3>

    <p class="text-gray-300">In this paper, we at first try to identify design choices that are energy-efficient and the related tradeoffs that are involved as a result of it. We throw some light at the design considerations that govern low energy circuits, and look at several factors like clock frequency, architecture, loop unrolling and lay down some general thumb rules that help in optimizing for energy. Then, we choose components specifically tailored to meet the requirements of low energy design. In particular, we develp energy-efficient linear layers and non-linear layers.</p>

    <p class="text-gray-300">We use <span class="math">4\\times 4</span> almost MDS binary matrices which are more efficient than <span class="math">4\\times 4</span> MDS matrices in the terms of area and signal-delay. Note that the branch numbers (the smallest nonzero sum of active inputs and outputs of the matrix) of MDS and almost MDS matrices areare 5 and 4, respectively. However, due to a smaller branch number, ciphers employing almost MDS matrices are likely to require the more number of rounds to guarantee its security against several attacks. To address this issue, we propose optimal cell-permutation layers which are aimed at improving diffusion speed and increasing the numbers of active</p>

    <p class="text-gray-300">S-boxes in each round with low implementation overheads. Our optimal cell-permutations drastically improve the minimum number of differentially/linearly active S-boxes in each round, and achieve faster diffusion compared to ShiftRow-type permutation. We construct a lightweight and small-delay 4-bit S-box by focusing on the dependency of the computation in S-boxes. The signal delay in our S-boxes is 1.5 times and twice faster than those of PRINCE and PRESENT, respectively. Since the S-box layer is one of the most critical and expensive operations of the cipher, our new S-boxes sufficiently contribute to low energy consumptions.</p>

    <p class="text-gray-300">Combining those new constructions, we design a family of low energy block ciphers Midori which is composed of two variants: Midori64 and Midori128. These provide the functionality for both encryption and decryption with minimal area and energy overhead. The two variants support a 128-bit secret key and a 64/128-bit block, respectively. Security wise, Midori64 and Midori128 do not claim related, known and chosen-key security as it is not relevant in our target application. Using the STM 90nm standard cell library, both these ciphers consume less than 1.89 <span class="math">pJ</span>/bit encrypted, which is by far better when compared ciphers like PRINCE and NOEKEON. These ciphers are particularly useful for applications that run on tight energy budget, e.g. active RFID tags, sensor nodes, medical implants and battery operated portable devices.</p>

    <h3 id="sec-2" class="text-xl font-semibold mt-8">1.2 Organization of the Paper</h3>

    <p class="text-gray-300">In Section 2, we look at some design considerations that help to minimize energy consumption in block cipher circuits. In Section 3, we outline the algorithmic specifications of the Midori128 and Midori64 ciphers. In Section 4, we explain our design decisions vis-a-vis the observations of Section 2. In Section 5, we outline the security analysis of the ciphers. Section 6 contains implementation results of our cipher in hardware using the standard cell library of the STM 90nm logic process. Section 7 concludes the paper.</p>

    <h2 id="sec-3" class="text-2xl font-bold">2 Design Considerations for Low Energy</h2>

    <p class="text-gray-300">For any given block cipher, three factors are likely to play a dominant role in determining the quantity of energy dissipated in the circuit:</p>

    <ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">

      <li>Frequency of the Clock used to drive the circuit,</li>

      <li>Architecture of the individual components,</li>

      <li>Unrolling round functions in the circuit.</li>

    </ol>

    <p class="text-gray-300">We will try to understand the significance of each of these parameters in the context of energy consumption. Let us start with clock frequency. Two components characterize the amount of energy dissipated in a CMOS circuit :</p>

    <ul class="list-disc list-inside space-y-1 text-gray-300 my-2 ml-4">

      <li>Dynamic dissipation due to the charging and discharging of load capacitances and the short-circuit current,</li>

    </ul>

    <p class="text-gray-300">!<a href="img-0.jpeg">img-0.jpeg</a> Fig. 1: S-boxes placed sequentially</p>

    <ul class="list-disc list-inside space-y-1 text-gray-300 my-2 ml-4">

      <li>Static dissipation due to leakage current and other current drawn continuously from the power supply.</li>

    </ul>

    <p class="text-gray-300">The total energy dissipation for a CMOS gate can be written as</p>

    <div class="my-4 text-center"><span class="math-block">E _ {g a t e} = E _ {l o a d} + E _ {s c} + E _ {l e a k a g e}</span></div>

    <p class="text-gray-300">The quantity  <span class="math">E_{load}</span>  is the energy dissipated for charging and discharging the capacitive load  <span class="math">C_L</span>  of a gate when output transitions occur. The energy dissipated per  <span class="math">0 \\rightarrow 1 / 1 \\rightarrow 0</span>  transition is given as</p>

    <div class="my-4 text-center"><span class="math-block">E = \\int_ {0} ^ {t} v i d t = \\int_ {0} ^ {t} v C _ {L} \\frac {d v}{d t} d t = C _ {L} \\int_ {0} ^ {V _ {D D}} v d v = \\frac {1}{2} C _ {L} V _ {D D} ^ {2}.</span></div>

    <p class="text-gray-300">The energy due to the short-circuit current,  <span class="math">E_{sc}</span>  is dissipated in a CMOS gate, when during a transition both the n and the p-transistors are on for a short period of time. The energy due to leakage currents  <span class="math">E_{leakage}</span>  is rather small, and is mainly caused due to the sub-threshold leakage current, which is the drain-source current in a CMOS gate when the transistor is OFF. This figure is becoming increasingly important as the technology is scaling down making the sub-threshold leakage more significant. However as pointed out in [3,22], the effect of the leakage energy at high clock frequencies is minimal. As such, energy becomes a metric which is a measure of the total switching activity of a circuit during the process. For sufficiently high frequencies, the energy consumption required to compute an encryption/decryption operation is essentially independent of frequency of operation. In our experiments, for circuits implemented using the standard cell library based on the STM 90nm low leakage process, at frequencies higher than 1 MHz, leakage energy is usually less than  <span class="math">1\\%</span>  of the total energy dissipated in the circuit.</p>

    <p class="text-gray-300">To understand the significance of the other parameters we performed the following experiments. Consider a case in which two Rijndael S-boxes are placed one after the other in a circuit as shown in Fig. 1. The signals to the input of the first S-box, the second S-box, and the output of the 2nd S-box are named S1xD, S2xD and S3xD respectively. Note that, analyzing this situation is particularly useful for understanding the energy consumption trends of unrolled designs where logic blocks are placed sequentially one after the other.</p>

    <p class="text-gray-300">Let us assume that the signal S1xD comes from an 8-bit register, so that it "cleanly" switches between successive byte values, i.e. all the bits of S1xD make logic transitions at the same point of time which is usually the rising clock edge for synchronous circuits. The signal S2xD will switch between various values in a given time interval  <span class="math">0 \\to \\tau_{d}</span> , before settling down to a stable value. The value</p>

    <p class="text-gray-300">!<a href="img-1.jpeg">img-1.jpeg</a> Fig. 2: The signals S1xD, S2xD, S3xD</p>

    <p class="text-gray-300"><span class="math">\\tau_{d}</span>  which is the delay experienced by the signal S1xD usually depends on the cell library and the architecture adopted to implement the S-boxes. Another parameter dependent on the logic process and architecture of the S-box is the switching activity of S2xD which can be informally defined as the number of logic transitions made by this signal in the period  <span class="math">0 \\rightarrow \\tau_{d}</span> .</p>

    <p class="text-gray-300">The second S-box  <span class="math">S_{2}</span> , sees this signal  <span class="math">\\mathsf{S2xD}</span> , which is switching between various values in the time interval  <span class="math">0 \\to \\tau_{d}</span> . Therefore, the switching activity of  <span class="math">S_{2}</span>  is actually at least double that of  <span class="math">S_{1}</span> , as it would continue switching for another  <span class="math">\\tau_{d}</span>  before producing a stable signal. Figure 2 provides an example in which, the three signals for the pair of Rijndael S-boxes (implemented using the Canright [15] architecture in the standard cell library of the STM 90nm logic process, at  <span class="math">10\\mathrm{MHz}</span> ) are shown. The synthesis for each S-box was done separately, so that the synthesis tool would not group together gates from the first and the second S-box in order to save area. Since the energy consumption of a logic block depends on the switching activity of all its nodes, the S-box  <span class="math">S_{2}</span>  should naturally consume more energy than  <span class="math">S_{1}</span> . Again the exact energy consumed by  <span class="math">S_{2}</span>  relative to  <span class="math">S_{1}</span>  depends on factors like</p>

    <p class="text-gray-300">(a) the logic process and hence the value of  <span class="math">\\tau_{d}</span> , (b) the architecture of the S-box and hence the amount of "extra" switching experienced by  <span class="math">S_{2}</span>  and (c) the algebraic structure of the S-box, i.e. its component Boolean functions.</p>

    <p class="text-gray-300">The extra switching activity would be proportional to the average number of gates that undergo a  <span class="math">0 \\to 1/1 \\to 0</span>  transition during the period  <span class="math">\\tau_d \\to 2\\tau_d</span>  (the average is typically taken over all possible transitions of the signal S1xD). Similarly if a third S-box  <span class="math">S_3</span>  were placed after  <span class="math">S_2</span> , then too it would experience an increase in switching activity relative to  <span class="math">S_2</span>  that would depend on the average number of gates switched in the period  <span class="math">2\\tau_d \\to 3\\tau_d</span> . The increase in switching activity of  <span class="math">S_3</span>  over  <span class="math">S_2</span>  is likely to be roughly the same as that of  <span class="math">S_2</span>  over  <span class="math">S_1</span> , since the number of gates in  <span class="math">S_2</span>  that switch in  <span class="math">\\tau_d \\to 2\\tau_d</span>  and those in  <span class="math">S_3</span>  between  <span class="math">2\\tau_d \\to 3\\tau_d</span>  when averaged over  <span class="math">\\binom{256}{2}</span>  transitions of S1xD, is likely to be same. And so if it so happens that  <span class="math">S_1, S_2</span>  and  <span class="math">S_3</span>  drive the same amount of capacitive load, the difference between the energy consumed between  <span class="math">S_2</span>  and  <span class="math">S_1</span>  is likely to be the same as between  <span class="math">S_3</span>  and  <span class="math">S_2</span> .</p>

    <p class="text-gray-300">!<a href="img-2.jpeg">img-2.jpeg</a> Fig.3: Energy per cycle  <span class="math">E_{i}</span>  in  <span class="math">i^{th}</span>  S-box  <span class="math">S_{i}</span></p>

    <p class="text-gray-300">!<a href="img-3.jpeg">img-3.jpeg</a> Fig.4: Energy  <span class="math">\\Omega_{n}</span>  required to compute  <span class="math">S^{10}(x)</span>  using  <span class="math">n</span>  S-boxes</p>

    <p class="text-gray-300">Taking these ideas forward, if we connect a series of  <span class="math">n</span>  S-boxes sequentially, the energy consumed by each S-box in a given period of time is likely to be more than the previous S-box, as the switching activity of the S-boxes are likely to increase from the first to the last. We tested three different architectures for the Rijndael S-box. The first is the Canright [15] architecture which is acknowledged to be smallest known implementation in terms of gate area. The second is the Look-up Table (LUT) based architecture as synthesized by the Synopsys Design Compiler. The LUT architecture, while larger than the Canright architecture in terms of area, is much faster in terms of signal delay from the input to output port. The third is a Decoder-Switch-Encoder (DSE) based architecture [8], which is optimal in terms of power/energy consumption. Over the years there has been much research on low power Rijndael S-boxes [29,36], but the DSE based architecture is widely believed to be most power/energy-efficient on account of its unique architecture. The 8-bit input is first decoded to a set of 256 wires. The S-box functionality is achieved by a shuffling of wires after which the output is produced by an encoding of the 256 shuffled wires (i.e. the inverse of the decoding process). The entire circuit can be constructed by AND/NAND gates, which have very low switching probability and since the S-box functionality is provided by wire shuffling, all 8-bit S-boxes can be constructed in this manner. The architecture offers very low switching per change of input bit: a maximum of  <span class="math">25\\%</span>  of the gates switch when one of the input bits is flipped.</p>

    <p class="text-gray-300">We connected 10 instances of the S-box constructed using the Canright architecture (using the standard cell library of the STM  <span class="math">90\\mathrm{nm}</span>  logic process) sequentially and used the Synopsys Power Compiler to estimate the energy consumed per clock cycle  <span class="math">E_{i}</span>  in each of the successive S-boxes  <span class="math">S_{i}</span>  at a clock frequency of 10 MHz. We repeated the same experiment for the LUT and DSE based S-boxes. The results can be seen in Fig. 3. It can be seen that the successive instances of the LUT based S-box which has a delay of around 2.1 ns consumes much less energy as compared to the Canright S-box which has a delay of around 2.9 ns. In both the LUT and Canright architectures, the switching activity in the circuit is</p>

    <p class="text-gray-300">roughly proportional to the signal delay across the input and output ports. This is however not the case for DSE S-box, which although has a delay of around <span class="math">2.3~{}ns</span>, experiences much lower increase in successive values of <span class="math">E_{i}</span> because the total switching activity in the delay period is much lower.</p>

    <p class="text-gray-300">The above analysis is particularly relevant due to two reasons. The first pertains to the structure of especially SPN based ciphers, in which each round typically consists of a substitution, a linear layer and a key addition placed sequentially. A substitution layer with low switching activity and signal delay ensures that the linear layer consumes less energy. Similarly a linear layer with similar characteristics ensures that any circuit placed after it consumes less energy. The second pertains to the consideration of round unrolled circuits. An <span class="math">r</span>-round unrolled circuit for a block cipher is one in which, the circuit computes the results of <span class="math">r</span> successive round functions in a single clock cycle. So if the block cipher specification calls for <span class="math">N</span> executions of the round function, an <span class="math">r</span>-round unrolled circuit will compute the result of the encryption operation in <span class="math">\\left\\lceil\\frac{N}{r}\\right\\rceil</span> cycles. An <span class="math">r</span>-round unrolled architecture is constructed by placing the circuits for <span class="math">r</span> round functions sequentially, followed by a register. The above analysis suggests that any multiple round unrolled circuit is unlikely to be efficient in terms of energy consumption. In the above example, using the LUT based S-box, computing the result of two S-box operations (i.e. <span class="math">S(S(x))</span>) over 2 cycles costs <span class="math">2*1.88=3.76~{}pJ</span>. Computing the same over one cycle by sequential placement of 2 S-boxes will cost <span class="math">1.88+3.91=5.79~{}pJ</span>. Similarly computing three S-box operations over three cycles takes <span class="math">5.64~{}pJ</span>, whereas the same over one cycle would take <span class="math">1.88+3.91+6.40=12.39~{}pJ</span>. Figure 4 shows the cumulative energy cost <span class="math">\\Omega_{n}</span> of computing <span class="math">S^{10}(x)</span> using a sequence of <span class="math">n</span> S-boxes (i.e. in <span class="math">\\frac{10}{n}</span> cycles), for different values of <span class="math">n</span>. It can be seen that, irrespective of the architecture of the S-box, the energy consumption is optimal for <span class="math">n=1</span>, i.e. computing the operation over 10 cycles using a single S-box, even if this involves updating the register 10 times in the process.</p>

    <h3 id="sec-4" class="text-xl font-semibold mt-8">2.1 M-S vs S-M based round functions</h3>

    <p class="text-gray-300">An interesting analysis would be to consider circuits in which the linear layer (i.e. the MixColumn logic) is placed before the substitution layer (see Figure 5). We will denote this configuration as M-S based round function, as opposed to S-M based functions in which the substitution layer precedes the linear layer. The block cipher Noekeon is an example of an M-S configuration, whereas Prince uses both S-M and M-S based functions in different rounds. To put things in perspective, we did the energy evaluation for the M-S and S-M configurations for AES (with the DSE architecture for S-box), Prince and Noekeon. The results are given in Table 1. The results suggest that there is not a very significant difference in M-S and S-M configurations, any advantage gained by one configuration over the other would depend on the respective designs. However our experiments suggest that placing the logic block with larger signal delay in the later part of the circuit would be more energy efficient. For example, in AES the substitution layer constitutes a bulk of the critical path, for which the M-S configuration</p>

    <p class="text-gray-300">!<a href="img-4.jpeg">img-4.jpeg</a> Fig. 5: The M-S and S-M architectures</p>

    <p class="text-gray-300">!<a href="img-5.jpeg">img-5.jpeg</a></p>

    <p class="text-gray-300">is more efficient. The Noekeon linear layer has nine levels of logic and hence a larger delay, than the Substitution layer which uses 4-bit S-boxes. For this cipher, the S-M configuration is found to be slightly better. For a cipher like Prince, in which both the linear layer and the substitution layer have very little signal delays the result of the S-M and M-S configurations are almost equally energy efficient.</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Design</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Delay in M (ns)</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Delay in S (ns)</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Energy per cycle (pJ)</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

          </tr>

        </thead>

        <tbody>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">M-S</td>

            <td class="px-3 py-2 border-b border-gray-700">S-M</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">AES</td>

            <td class="px-3 py-2 border-b border-gray-700">0.56</td>

            <td class="px-3 py-2 border-b border-gray-700">2.25</td>

            <td class="px-3 py-2 border-b border-gray-700">12.09</td>

            <td class="px-3 py-2 border-b border-gray-700">14.00</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">Noekeon</td>

            <td class="px-3 py-2 border-b border-gray-700">1.56</td>

            <td class="px-3 py-2 border-b border-gray-700">0.38</td>

            <td class="px-3 py-2 border-b border-gray-700">12.37</td>

            <td class="px-3 py-2 border-b border-gray-700">11.88</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">Prince</td>

            <td class="px-3 py-2 border-b border-gray-700">0.31</td>

            <td class="px-3 py-2 border-b border-gray-700">0.36</td>

            <td class="px-3 py-2 border-b border-gray-700">2.30</td>

            <td class="px-3 py-2 border-b border-gray-700">2.18</td>

          </tr>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">Table 1: A comparison of Energy per cycle of M-S/S-M configurations</p>

    <p class="text-gray-300">In light of the above analysis, it is clear that a design using a 4-bit S-box is more efficient in terms of energy consumed per cycle than a design using an 8-bit S-box. This is primarily due to the fact that a 4-bit S-box will typically have a lower signal delay as compared to an 8-bit S-box. However 8-bit S-boxes offer higher non-linearity and lower values of the DP/LP co-efficient, and so in order to sustain similar security margins, a design using a 4-bit S-box will typically need more executions of the round function. To put things, in perspective we performed the energy evaluation of the circuit of the SPN round function (with blocksize equal to 128 bits) in which we experimented with two different substitution layers, one having sixteen 8-bit S-boxes and the other having thirty two 4-bit S-boxes. The Rijndael MixColumn was used in both cases, and the STM  <span class="math">90\\mathrm{nm}</span>  cell library was used to synthesize the circuits. For this purpose four different 8-bit S-boxes were chosen. Apart from the LUT and DSE based Rijndael S-boxes, we chose the S-boxes used in mCrypton [25] and Whirlpool [4]. Unlike AES, these S-boxes can be functionally defined in terms of smaller 4-bit S-boxes, and so can be implemented efficiently in hardware. Additionally</p>

    <p class="text-gray-300">Table 2: A comparison of energy per cycle for round functions constructed with (A) 16 8-bit S-boxes, (B) 32 4-bit S-boxes.</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">S-box</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Delay in S (ns)</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Energy per cycle (pJ)</th>

          </tr>

        </thead>

        <tbody>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">A</td>

            <td class="px-3 py-2 border-b border-gray-700">DSE (8-bit)</td>

            <td class="px-3 py-2 border-b border-gray-700">2.25</td>

            <td class="px-3 py-2 border-b border-gray-700">14.00</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">Rijndael(LUT)</td>

            <td class="px-3 py-2 border-b border-gray-700">2.10</td>

            <td class="px-3 py-2 border-b border-gray-700">38.88</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">mCrypton</td>

            <td class="px-3 py-2 border-b border-gray-700">1.59</td>

            <td class="px-3 py-2 border-b border-gray-700">13.20</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">Whirlpool</td>

            <td class="px-3 py-2 border-b border-gray-700">1.33</td>

            <td class="px-3 py-2 border-b border-gray-700">16.38</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">B</td>

            <td class="px-3 py-2 border-b border-gray-700">DSE (4-bit)</td>

            <td class="px-3 py-2 border-b border-gray-700">0.81</td>

            <td class="px-3 py-2 border-b border-gray-700">7.92</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">PRINCE</td>

            <td class="px-3 py-2 border-b border-gray-700">0.36</td>

            <td class="px-3 py-2 border-b border-gray-700">4.87</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">PRESENT</td>

            <td class="px-3 py-2 border-b border-gray-700">0.45</td>

            <td class="px-3 py-2 border-b border-gray-700">6.18</td>

          </tr>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">we chose three 4-bit S-boxes: the generic DSE based S-box (note that since the S-box functionality is provided by a wire shuffle, all DSE S-boxes will have same energy consumption), and the S-boxes used in PRINCE [13] and PRESENT [12].</p>

    <p class="text-gray-300">Table 2 reports the energy per cycle figures at a frequency of  <span class="math">10\\mathrm{MHz}</span> . It can be seen that the DSE architecture is not as effective as energy saving measure for 4-bit S-boxes. It is also interesting to note that from the point of view of energy 4-bit S-boxes out performs their 8-bit counterparts by a ratio of around 2:1. Thus, the use of 4-bit S-boxes seems to be an efficient configuration even if the number of rounds in the encryption algorithm has to be increased in order to maintain security margins.</p>

    <p class="text-gray-300">As far as designing lightweight ciphers is concerned, both SPN and Feistel architectures have their respective advantages and disadvantages. Feistel structures (e.g. TWINE [34], Piccolo [32], SIMON [6]) usually apply a round function to only one half of the state and as such structures can be implemented in hardware with low average power. Also, implementing the inverse of Feistel constructions is not very difficult and hence a circuit that provides functionalities for both encryption and decryption can be designed with minimal overhead. However, given the fact that Feistel structures introduce non-linearity in only one half of the state in every round and hence, to maintain security margins, such constructions usually require more executions of the round functions as compared to SPN structures. As such Feistel, constructions are not suited for low latency implementations. Most SPN constructions, on the other hand, usually apply its transformation function to the entire state and so can be implemented using fewer rounds. In principle, if  <span class="math">n</span>  rounds of SPN function and  <span class="math">m</span>  rounds of Feistel function (where  <span class="math">m &amp;gt; n</span> ) have the same security margin and similar energy expenditure, then using the  <span class="math">n</span>  round SPN function makes more sense since lesser energy is consumed to update the state and key register for  <span class="math">n</span>  rounds. A similar argument can be used to resolve the choice between (a) Simple round functions with more rounds (e.g. PRESENT [12]) and (b) Complex round functions with lesser rounds.</p>

    <p class="text-gray-300">2.4 Effect of Key Schedule</p>

    <p class="text-gray-300">Generating separate round keys in each round by means of a key schedule operation can eat into the energy budget as it incurs the added cost of updating the key register in every round. For example using the STM 90nm standard cell library, in AES (with DSE S-box), the key schedule consumes a total of 25% of the total energy consumed. For PRESENT, the key schedule consumes close to 32% of the total energy. So designs meant primarily for low energy consumption, designers should look to avoid the key schedule operation. This would also be efficient in terms of area as it would not be necessary to include a key register in the design.</p>

    <h3 id="sec-7" class="text-xl font-semibold mt-8">2.5 Main Conclusion: Low-Energy Design Choices</h3>

    <p class="text-gray-300">We can now state some conclusions that will serve as pointers for a good low energy block cipher design. From the point of view of energy, we know that a round based architecture is usually optimal. Thus we concentrate on an efficient round based construction that would with minimal overhead provide both the functionalities of encryption and decryption. A cipher like PRINCE, although provides both encryption/decryption functionalities with minimal tweak in the circuit, does not have an equally energy-efficient round based construction <em>[13]</em>, as it needs to accommodate 3 different round functions in the same circuit. We have also seen that components with low switching and delay tend to perform better energy wise. So another requirement is choosing components with low area and delay. In this context, it makes sense to choose 4-bit S-boxes over 8-bit S-boxes. We choose SPN architecture over Feistel to minimize the number of rounds in the design. And since providing the functionalities of both encryption and decryption is an added motivation, we try to include components which in addition to having low area/delay, are also involutions. Having such components would minimize any additional overhead required for providing the functionalities of both encryption and decryption. We will now present the specifications for the proposed block cipher and in Section 4 we will explain the design decisions in the context of the observations made in this Section.</p>

    <h2 id="sec-8" class="text-2xl font-bold">3 Specification</h2>

    <p class="text-gray-300">Midori is a family of two block ciphers: Midori64 and Midori128. Both ciphers accept 128-bit keys, and have a different block size <span class="math">n</span> (<span class="math">n=64</span> for Midori64 and <span class="math">n=128</span> for Midori128). The basic parameters of Midori64 and Midori128 are shown in Table 3.</p>

    <p class="text-gray-300">Midori is a variant of a Substitution Permutation Network (SPN), which consists of the S-layer and the P-layer, and uses the following <span class="math">4\\times 4</span> array called</p>

    <p class="text-gray-300">Table 3: Parameters for Midori64 and Midori128</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">block size(n)</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">key size</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">cell size(m)</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">number of rounds</th>

          </tr>

        </thead>

        <tbody>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">Midori64</td>

            <td class="px-3 py-2 border-b border-gray-700">64</td>

            <td class="px-3 py-2 border-b border-gray-700">128</td>

            <td class="px-3 py-2 border-b border-gray-700">4</td>

            <td class="px-3 py-2 border-b border-gray-700">16</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">Midori128</td>

            <td class="px-3 py-2 border-b border-gray-700">128</td>

            <td class="px-3 py-2 border-b border-gray-700">128</td>

            <td class="px-3 py-2 border-b border-gray-700">8</td>

            <td class="px-3 py-2 border-b border-gray-700">20</td>

          </tr>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">Table 4: 4-bit bijective S-boxes  <span class="math">\\mathsf{Sb}_0</span>  and  <span class="math">\\mathsf{Sb}_1</span>  in hexadecimal form</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">x</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">0</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">1</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">2</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">3</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">4</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">5</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">6</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">7</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">8</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">9</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">a</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">b</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">c</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">d</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">e</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">f</th>

          </tr>

        </thead>

        <tbody>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">Sb0[x]</td>

            <td class="px-3 py-2 border-b border-gray-700">c</td>

            <td class="px-3 py-2 border-b border-gray-700">a</td>

            <td class="px-3 py-2 border-b border-gray-700">d</td>

            <td class="px-3 py-2 border-b border-gray-700">3</td>

            <td class="px-3 py-2 border-b border-gray-700">e</td>

            <td class="px-3 py-2 border-b border-gray-700">b</td>

            <td class="px-3 py-2 border-b border-gray-700">f</td>

            <td class="px-3 py-2 border-b border-gray-700">7</td>

            <td class="px-3 py-2 border-b border-gray-700">8</td>

            <td class="px-3 py-2 border-b border-gray-700">9</td>

            <td class="px-3 py-2 border-b border-gray-700">1</td>

            <td class="px-3 py-2 border-b border-gray-700">5</td>

            <td class="px-3 py-2 border-b border-gray-700">0</td>

            <td class="px-3 py-2 border-b border-gray-700">2</td>

            <td class="px-3 py-2 border-b border-gray-700">4</td>

            <td class="px-3 py-2 border-b border-gray-700">6</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">Sb1[x]</td>

            <td class="px-3 py-2 border-b border-gray-700">1</td>

            <td class="px-3 py-2 border-b border-gray-700">0</td>

            <td class="px-3 py-2 border-b border-gray-700">5</td>

            <td class="px-3 py-2 border-b border-gray-700">3</td>

            <td class="px-3 py-2 border-b border-gray-700">e</td>

            <td class="px-3 py-2 border-b border-gray-700">2</td>

            <td class="px-3 py-2 border-b border-gray-700">f</td>

            <td class="px-3 py-2 border-b border-gray-700">7</td>

            <td class="px-3 py-2 border-b border-gray-700">d</td>

            <td class="px-3 py-2 border-b border-gray-700">a</td>

            <td class="px-3 py-2 border-b border-gray-700">9</td>

            <td class="px-3 py-2 border-b border-gray-700">b</td>

            <td class="px-3 py-2 border-b border-gray-700">c</td>

            <td class="px-3 py-2 border-b border-gray-700">8</td>

            <td class="px-3 py-2 border-b border-gray-700">4</td>

            <td class="px-3 py-2 border-b border-gray-700">6</td>

          </tr>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">state as a data expression:</p>

    <div class="my-4 text-center"><span class="math-block">S = \\left[ \\begin{array}{l l l l} s _ {0} &amp;amp; s _ {4} &amp;amp; s _ {8} &amp;amp; s _ {1 2} \\\\ s _ {1} &amp;amp; s _ {5} &amp;amp; s _ {9} &amp;amp; s _ {1 3} \\\\ s _ {2} &amp;amp; s _ {6} &amp;amp; s _ {1 0} &amp;amp; s _ {1 4} \\\\ s _ {3} &amp;amp; s _ {7} &amp;amp; s _ {1 1} &amp;amp; s _ {1 5} \\end{array} \\right],</span></div>

    <p class="text-gray-300">where the sizes of each cell  <span class="math">m</span>  are 4 and 8 bits for Midori64 and Midori128, respectively, i.e.,  <span class="math">s_i \\in \\{0,1\\}^m</span> ,  <span class="math">m = 4</span>  for Midori64 and  <span class="math">m = 8</span>  for Midori128. A 64-bit or a 128-bit plaintext  <span class="math">P</span>  is loaded into the state, and the  <span class="math">i</span> -th round output state is defined as  <span class="math">S_i</span> , namely  <span class="math">S_0 = P</span> .</p>

    <h2 id="sec-9" class="text-2xl font-bold">3.1 S-boxes and Matrices</h2>

    <p class="text-gray-300">S-box: Midori utilizes two types of bijective 4-bit S-boxes,  <span class="math">\\mathsf{Sb}_0</span>  and  <span class="math">\\mathsf{Sb}_1</span> , where  <span class="math">\\mathsf{Sb}_0, \\mathsf{Sb}_1 : \\{0,1\\}^4 \\to \\{0,1\\}^4</span>  (see Table 4).  <span class="math">\\mathsf{Sb}_0</span>  and  <span class="math">\\mathsf{Sb}_1</span>  are used in Midori64 and Midori128, respectively. Note that  <span class="math">\\mathsf{Sb}_0</span>  and  <span class="math">\\mathsf{Sb}_1</span>  both have the involution property.</p>

    <p class="text-gray-300">Midori128 utilizes four different 8-bit S-boxes  <span class="math">\\mathsf{SSb}_0</span> ,  <span class="math">\\mathsf{SSb}_1</span> ,  <span class="math">\\mathsf{SSb}_2</span>  and  <span class="math">\\mathsf{SSb}_3</span> , where  <span class="math">\\mathsf{SSb}_0</span> ,  <span class="math">\\mathsf{SSb}_1</span> ,  <span class="math">\\mathsf{SSb}_2</span> ,  <span class="math">\\mathsf{SSb}_3: \\{0,1\\}^8 \\to \\{0,1\\}^8</span> . Mathematically, each  <span class="math">\\mathsf{SSb}_i</span>  consists of input and output bit permutations and two  <span class="math">\\mathsf{Sb}_i</span> 's as shown in Fig. 6. Each output bit permutation is taken as the inverse of the corresponding input bit permutation to keep the involution property. Let the input bit permutation of each  <span class="math">\\mathsf{SSb}_i</span>  be referred to as  <span class="math">\\mathsf{p}_i</span> . Let  <span class="math">x_{[i]}</span>  denote the  <span class="math">i</span> -th bit of  <span class="math">x</span> , where  <span class="math">x_{[0]}</span>  is the most significant bit (MSB). Then denoting  <span class="math">\\mathsf{p}_i(x) = y^{(i)}</span> , we have</p>

    <div class="my-4 text-center"><span class="math-block">y _ {[ 0, 1, 2, 3, 4, 5, 6, 7 ]} ^ {(0)} = x _ {[ 4, 1, 6, 3, 0, 5, 2, 7 ]}, y _ {[ 0, 1, 2, 3, 4, 5, 6, 7 ]} ^ {(1)} = x _ {[ 1, 6, 7, 0, 5, 2, 3, 4 ]}</span></div>

    <div class="my-4 text-center"><span class="math-block">y _ {[ 0, 1, 2, 3, 4, 5, 6, 7 ]} ^ {(2)} = x _ {[ 2, 3, 4, 1, 6, 7, 0, 5 ]}, y _ {[ 0, 1, 2, 3, 4, 5, 6, 7 ]} ^ {(3)} = x _ {[ 7, 4, 1, 2, 3, 0, 5, 6 ]}</span></div>

    <p class="text-gray-300">The output permutation used in each  <span class="math">\\mathsf{SSb}_i</span>  is simply the inverse of the map  <span class="math">\\mathsf{p}_i</span> .</p>

    <p class="text-gray-300">!<a href="img-6.jpeg">img-6.jpeg</a> Fig. 6:  <span class="math">\\mathsf{SSb}_0</span> ,  <span class="math">\\mathsf{SSb}_1</span> ,  <span class="math">\\mathsf{SSb}_2</span>  and  <span class="math">\\mathsf{SSb}_3</span></p>

    <p class="text-gray-300">Matrix: Midori utilizes an involutive binary matrix  <span class="math">M</span>  defined as follows:</p>

    <div class="my-4 text-center"><span class="math-block">\\boldsymbol {M} = \\left( \\begin{array}{c c c c} 0 &amp;amp; 1 &amp;amp; 1 &amp;amp; 1 \\\\ 1 &amp;amp; 0 &amp;amp; 1 &amp;amp; 1 \\\\ 1 &amp;amp; 1 &amp;amp; 0 &amp;amp; 1 \\\\ 1 &amp;amp; 1 &amp;amp; 1 &amp;amp; 0 \\end{array} \\right).</span></div>

    <p class="text-gray-300">The matrix  <span class="math">M</span>  updates four  <span class="math">m</span> -bit values  <span class="math">(x_0, x_1, x_2, x_3)</span>  as follows:</p>

    <div class="my-4 text-center"><span class="math-block">{ } ^ { t } ( x _ { 0 } , x _ { 1 } , x _ { 2 } , x _ { 3 } ) \\leftarrow M \\cdot { } ^ { t } ( x _ { 0 } , x _ { 1 } , x _ { 2 } , x _ { 3 } ) ,</span></div>

    <p class="text-gray-300">where the operations between a matrix and a vector are performed over  <span class="math">\\mathrm{GF}(2^m)</span> .</p>

    <h2 id="sec-10" class="text-2xl font-bold">3.2 Round Function</h2>

    <p class="text-gray-300">The round function of Midori consists of an S-layer SubCell:  <span class="math">\\{0,1\\}^n \\to \\{0,1\\}^n</span> , a P-layer ShuffleCell and MixColumn:  <span class="math">\\{0,1\\}^n \\to \\{0,1\\}^n</span>  and a key-addition layer KeyAdd:  <span class="math">\\{0,1\\}^n \\times \\{0,1\\}^n \\to \\{0,1\\}^n</span> . Each layer updates an  <span class="math">n</span> -bit state  <span class="math">S</span>  as follows.</p>

    <p class="text-gray-300">SubCell  <span class="math">(S)</span> :  <span class="math">\\mathsf{Sb}_0</span>  and  <span class="math">\\mathsf{SSb}_i</span>  are applied to every 4 and 8-bit cell of the state  <span class="math">S</span>  of Midori64 and Midori128 in parallel, respectively. Namely,  <span class="math">s_i \\gets \\mathsf{Sb}_0[s_i]</span>  for Midori64 and  <span class="math">s_i \\gets \\mathsf{SSb}_{(i \\mod 4)}[s_i]</span>  for Midori128, where  <span class="math">0 \\leq i \\leq 15</span> .</p>

    <p class="text-gray-300">ShuffleCell  <span class="math">(S)</span> : Each cell of the state is permuted as follows:</p>

    <p class="text-gray-300"><span class="math">(s_0,s_1,\\dots ,s_{15})\\gets (s_0,s_{10},s_5,s_{15},s_{14},s_4,s_{11},s_1,s_9,s_3,s_{12},s_6,s_7,s_{13},s_2,s_8).</span></p>

    <p class="text-gray-300">MixColumn  <span class="math">(S)</span> :  <span class="math">M</span>  is applied to every  <span class="math">4m</span> -bit column of the state  <span class="math">S</span> , i.e.,  <span class="math">t(s_i, s_{i+1}, s_{i+2}, s_{i+3}) \\gets M^t(s_i, s_{i+1}, s_{i+2}, s_{i+3})</span>  and  <span class="math">i = 0, 4, 8, 12</span> .</p>

    <p class="text-gray-300">KeyAdd(S,  <span class="math">RK_{i}</span> ): The  <span class="math">i</span> -th  <span class="math">n</span> -bit round key  <span class="math">RK_{i}</span>  is XORed to a state  <span class="math">S</span> .</p>

    <h2 id="sec-11" class="text-2xl font-bold">3.3 Data Processing Part</h2>

    <p class="text-gray-300">The data processing part of Midori for encryption  <span class="math">\\mathsf{MidoriCore}_{(R)}</span>  performs as follows:</p>

    <div class="my-4 text-center"><span class="math-block">\\mathsf {M i d o r i C o r e} _ {(R)}: \\left\\{ \\begin{array}{l} \\{0, 1 \\} ^ {1 6 m} \\times \\{0, 1 \\} ^ {1 6 m} \\times \\{\\{0, 1 \\} ^ {1 6 m} \\} ^ {R - 1} \\to \\{0, 1 \\} ^ {1 6 m} \\\\ (X, W K, R K _ {0}, \\dots , R K _ {R - 2}) \\mapsto Y \\end{array} \\right.</span></div>

    <p class="text-gray-300">|  Algorithm MidoriCore(R)(X,WK,RK0,...,RKR-2):  |</p>

    <p class="text-gray-300">| --- |</p>

    <p class="text-gray-300">|  Sâ† KeyAdd(X,WK)  |</p>

    <p class="text-gray-300">|  for i=0 to R-2 do  |</p>

    <p class="text-gray-300">|  Sâ† SubCell(S)  |</p>

    <p class="text-gray-300">|  Sâ† ShuffleCell(S)  |</p>

    <p class="text-gray-300">|  Sâ† MixColumn(S)  |</p>

    <p class="text-gray-300">|  Sâ† KeyAdd(S,RKi)  |</p>

    <p class="text-gray-300">|  Sâ† SubCell(S)  |</p>

    <p class="text-gray-300">|  Yâ† KeyAdd(S,WK)  |</p>

    <p class="text-gray-300">where  <span class="math">R = 16</span>  for Midori64 and  <span class="math">R = 20</span>  for Midori128. Similarly, the inverse data processing part MidoriCore <span class="math">^{(1)}_{(R)}</span>  operates as follows:</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">MidoriCore-(R) : { {0,1}16m Ã— {0,1}16m Ã— { {0,1}16m} (Y,WK,RKR-2,...,RK0) â†’ X</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">{0,1}16m</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">|  Algorithm MidoriCore-(R) (Y, WK, RKR-2, ..., RK0):  |</p>

    <p class="text-gray-300">| --- |</p>

    <p class="text-gray-300">|  S â† KeyAdd(Y, WK)  |</p>

    <p class="text-gray-300">|  for i = (R-2) to 0 do  |</p>

    <p class="text-gray-300">|  S â† SubCell(S)  |</p>

    <p class="text-gray-300">|  S â† MixColumn(S)  |</p>

    <p class="text-gray-300">|  S â† InvShuffleCell(S)  |</p>

    <p class="text-gray-300">|  S â† KeyAdd(S, L-1(RKi))  |</p>

    <p class="text-gray-300">|  S â† SubCell(S)  |</p>

    <p class="text-gray-300">|  X â† KeyAdd(S, WK)  |</p>

    <p class="text-gray-300">where  <span class="math">L^{-1}</span>  (inverse of the linear layer) denotes the composition of the operations InvShuffleCell  <span class="math">\\circ</span>  MixColumn, and InvShuffleCell permutes each cell of the state as follows.</p>

    <p class="text-gray-300"><span class="math">(s_0,s_1,\\dots ,s_{15})\\gets (s_0,s_7,s_{14},s_9,s_5,s_2,s_{11},s_{12},s_{15},s_8,s_1,s_6,s_{10},s_{13},s_4,s_3).</span></p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">For Midori64, a 128-bit secret key  <span class="math">K</span>  is denoted as two 64-bit keys  <span class="math">K_{0}</span>  and  <span class="math">K_{1}</span>  as  $K = K_{0}</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">K_{1}<span class="math"> . Then,  </span>WK = K_{0} \\oplus K_{1}<span class="math">  and  </span>RK_{i} = K_{(i \\mod 2)} \\oplus \\alpha_{i}<span class="math"> , where  </span>0 \\leq i \\leq 14<span class="math"> . For Midori128,  </span>WK = K<span class="math">  and  </span>RK_{i} = K \\oplus \\beta_{i}<span class="math"> , where  </span>0 \\leq i \\leq 18<span class="math"> . The constants  </span>\\beta_{i}<span class="math">  are defined in Table 5. It can be seen that the constants are in the form of  </span>4 \\times 4<span class="math">  binary matrices. They are added bitwise to the LSB of every round key byte in Midori128 and round key nibble in Midori64 respectively. Note that  </span>\\alpha_{i} = \\beta_{i}<span class="math">  for  </span>0 \\leq i \\leq 14$ .</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">Midori block ciphers are composed of two variants: Midori64 and Midori128 consisting of MidoriCore <span class="math">_{(16)}</span>  with  <span class="math">m = 4</span>  and MidoriCore <span class="math">_{(20)}</span>  with  <span class="math">m = 8</span> , respectively. MidoriCore <span class="math">_{(16)}</span>  is depicted in Fig. 7 as an example.</p>

    <p class="text-gray-300">Table 5: The Round Constants  <span class="math">{\\beta }_{i}</span></p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">i</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Î²i</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">i</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Î²i</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">i</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Î²i</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">i</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Î²i</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">i</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Î²i</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">i</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Î²i</th>

          </tr>

        </thead>

        <tbody>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">0</td>

            <td class="px-3 py-2 border-b border-gray-700">0 0 1 0</td>

            <td class="px-3 py-2 border-b border-gray-700">1</td>

            <td class="px-3 py-2 border-b border-gray-700">0 1 1 0</td>

            <td class="px-3 py-2 border-b border-gray-700">2</td>

            <td class="px-3 py-2 border-b border-gray-700">1 0 0 0</td>

            <td class="px-3 py-2 border-b border-gray-700">3</td>

            <td class="px-3 py-2 border-b border-gray-700">0 0 0 0</td>

            <td class="px-3 py-2 border-b border-gray-700">4</td>

            <td class="px-3 py-2 border-b border-gray-700">0 0 0 1</td>

            <td class="px-3 py-2 border-b border-gray-700">5</td>

            <td class="px-3 py-2 border-b border-gray-700">1 0 0 0</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">0 1 0 0</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">1 0 1 0</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">0 1 0 1</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">1 0 0 0</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">0 0 1 1</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">1 0 1 0</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">0 0 1 1</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">1 0 0 0</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">1 0 1 0</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">1 1 0 1</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">0 0 0 1</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">0 0 1 0</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">1 1 1 1</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">1 0 0 0</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">0 0 1 1</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">0 0 1 1</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">1 0 0 1</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">1 1 1 0</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">7</td>

            <td class="px-3 py-2 border-b border-gray-700">0 1 1 1</td>

            <td class="px-3 py-2 border-b border-gray-700">8</td>

            <td class="px-3 py-2 border-b border-gray-700">1 0 1 0</td>

            <td class="px-3 py-2 border-b border-gray-700">9</td>

            <td class="px-3 py-2 border-b border-gray-700">0 0 1 1</td>

            <td class="px-3 py-2 border-b border-gray-700">10</td>

            <td class="px-3 py-2 border-b border-gray-700">0 0 1 0</td>

            <td class="px-3 py-2 border-b border-gray-700">11</td>

            <td class="px-3 py-2 border-b border-gray-700">0 0 1 1</td>

            <td class="px-3 py-2 border-b border-gray-700">12</td>

            <td class="px-3 py-2 border-b border-gray-700">0 0 0 0</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">0 0 1 1</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">0 1 0 0</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">1 0 0 0</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">1 0 0 1</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">0 0 0 1</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">1 0 1 0</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">0 1 0 0</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">0 0 0 0</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">0 0 1 0</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">1 0 0 1</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">1 1 0 1</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">0 0 1 0</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">0 1 0 0</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">1 0 0 1</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">0 0 1 0</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">1 1 1 1</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">0 0 0 0</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">1 1 1 0</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">14</td>

            <td class="px-3 py-2 border-b border-gray-700">1 1 1 0</td>

            <td class="px-3 py-2 border-b border-gray-700">15</td>

            <td class="px-3 py-2 border-b border-gray-700">0 1 1 0</td>

            <td class="px-3 py-2 border-b border-gray-700">16</td>

            <td class="px-3 py-2 border-b border-gray-700">0 1 0 0</td>

            <td class="px-3 py-2 border-b border-gray-700">17</td>

            <td class="px-3 py-2 border-b border-gray-700">0 0 1 0</td>

            <td class="px-3 py-2 border-b border-gray-700">18</td>

            <td class="px-3 py-2 border-b border-gray-700">0 0 1 1</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">1 1 0 0</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">1 1 0 0</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">0 1 0 1</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">0 0 0 1</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">1 0 0 0</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">0 1 0 0</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">1 0 0 0</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">0 0 1 0</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">1 1 1 0</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">1 1 0 1</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">1 1 1 0</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">1 0 0 1</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">1 0 0 0</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">0 1 1 0</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">0 0 0 0</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

          </tr>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">!<a href="img-7.jpeg">img-7.jpeg</a> Fig. 7: Overview of Midori64</p>

    <p class="text-gray-300">Here, we explain our design decisions vis-a-vis the observations of Section 2.</p>

    <p class="text-gray-300">Linear layers of the each variant consist of a cell-permutation (ShuffleCell) and four  <span class="math">4 \\times 4</span>  matrix operations (MixColumn). Those operations are performed over  <span class="math">GF(2^4)</span>  and  <span class="math">GF(2^8)</span>  for the 64 and 128-bit variants, respectively.</p>

    <p class="text-gray-300">MDS vs Almost MDS. Using the NanGate 45nm open cell library, Table 6 compares three types of  <span class="math">4 \\times 4</span>  matrices, involutive MDS  <span class="math">(M_A)</span> , non-involutive MDS  <span class="math">(M_B)</span>  and involutive almost MDS matrices  <span class="math">(M_C)</span>  from implementation aspects. These matrices are considered lightweight in each of the three aforementioned criteria [27,32].</p>

    <div class="my-4 text-center"><span class="math-block">\\boldsymbol {M} _ {A} = \\left( \\begin{array}{c c c} 1 &amp;amp; 2 &amp;amp; 6 &amp;amp; 4 \\\\ 2 &amp;amp; 1 &amp;amp; 4 &amp;amp; 6 \\\\ 6 &amp;amp; 4 &amp;amp; 1 &amp;amp; 2 \\\\ 4 &amp;amp; 6 &amp;amp; 2 &amp;amp; 1 \\end{array} \\right), \\boldsymbol {M} _ {B} = \\left( \\begin{array}{c c c} 2 &amp;amp; 3 &amp;amp; 1 &amp;amp; 1 \\\\ 1 &amp;amp; 2 &amp;amp; 3 &amp;amp; 1 \\\\ 1 &amp;amp; 1 &amp;amp; 2 &amp;amp; 3 \\\\ 3 &amp;amp; 1 &amp;amp; 1 &amp;amp; 2 \\end{array} \\right), \\boldsymbol {M} _ {C} = \\left( \\begin{array}{c c c} 0 &amp;amp; 1 &amp;amp; 1 &amp;amp; 1 \\\\ 1 &amp;amp; 0 &amp;amp; 1 &amp;amp; 1 \\\\ 1 &amp;amp; 1 &amp;amp; 0 &amp;amp; 1 \\\\ 1 &amp;amp; 1 &amp;amp; 1 &amp;amp; 0 \\end{array} \\right).</span></div>

    <p class="text-gray-300">From Table 6,  <span class="math">M_C</span>  is obviously preferable over the others in terms of the gate size and the path delay. In fact, circulant-type almost MDS matrices are adopted</p>

    <p class="text-gray-300">Table 6: Comparison of three matrices</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">MA</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">MB</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">MC</th>

          </tr>

        </thead>

        <tbody>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">Area [GE]</td>

            <td class="px-3 py-2 border-b border-gray-700">108</td>

            <td class="px-3 py-2 border-b border-gray-700">104</td>

            <td class="px-3 py-2 border-b border-gray-700">48</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">Delay [ns]</td>

            <td class="px-3 py-2 border-b border-gray-700">0.93</td>

            <td class="px-3 py-2 border-b border-gray-700">0.68</td>

            <td class="px-3 py-2 border-b border-gray-700">0.37</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">Diffusion</td>

            <td class="px-3 py-2 border-b border-gray-700">MDS</td>

            <td class="px-3 py-2 border-b border-gray-700">MDS</td>

            <td class="px-3 py-2 border-b border-gray-700">Almost MDS</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">Involution</td>

            <td class="px-3 py-2 border-b border-gray-700">yes</td>

            <td class="px-3 py-2 border-b border-gray-700">no</td>

            <td class="px-3 py-2 border-b border-gray-700">yes</td>

          </tr>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">Table 7: Comparison of S-boxes</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">PRESENT</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">PRINCE</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Sb0</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Sb1</th>

          </tr>

        </thead>

        <tbody>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">Area [GE]</td>

            <td class="px-3 py-2 border-b border-gray-700">24.33</td>

            <td class="px-3 py-2 border-b border-gray-700">16</td>

            <td class="px-3 py-2 border-b border-gray-700">13.3</td>

            <td class="px-3 py-2 border-b border-gray-700">15.33</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">Delay [ns]</td>

            <td class="px-3 py-2 border-b border-gray-700">0.47</td>

            <td class="px-3 py-2 border-b border-gray-700">0.36</td>

            <td class="px-3 py-2 border-b border-gray-700">0.24</td>

            <td class="px-3 py-2 border-b border-gray-700">0.32</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">Involution</td>

            <td class="px-3 py-2 border-b border-gray-700">No</td>

            <td class="px-3 py-2 border-b border-gray-700">No</td>

            <td class="px-3 py-2 border-b border-gray-700">Yes</td>

            <td class="px-3 py-2 border-b border-gray-700">Yes</td>

          </tr>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">in PRINCE [13], PRIDE [1], FIDES [9] and CLOC [21]. Moreover, Khoo et al. showed that, for a 64-bit block size employing the AES-like structure, the combination of  <span class="math">4 \\times 4</span>  almost MDS matrices  <span class="math">(M_C)</span>  with ShiftRow and 16 4-bit S-boxes is the most efficient in both a round-based and a serialized implementation by proposing a new comparison metric FOAM (figure of adversarial merit), which combines the inherent security provided by cryptographic structures and components along with their implementation properties [23].</p>

    <p class="text-gray-300">While  <span class="math">M_C</span>  has efficient implementation properties, its diffusion speed is slower and the minimum number of active S-boxes in each round is smaller than those of ciphers employing MDS matrices due to its lower branch number. It has been known that those properties are directly related to the immunity against several attacks including impossible differential, saturation, differential and linear attacks. To improve security of the almost MDS with low implementation overheads, we adopt optimal cell-permutation layers which are aimed at improving diffusion speed and increasing the number of active S-boxes in each round. The diffusion speed is measured by the number of rounds taken to attain full diffusion, which is the property that all output cells are affected by all input cells. Importantly, changing cell-permutation patterns generally does not require additional implementation costs in a round-based and an unrolled hardware implementation.</p>

    <p class="text-gray-300">Approach to Find Optimal Cell-Permutation Layers for Almost MDS. Since it is computationally hard to exhaustively count the minimum number of active S-boxes for all possible permutations  <span class="math">(= 16! \\approx 2^{44.25})</span>  by Matsui's search approach [26,10], we take the following two-step approach to reduce the search space. In the first step, we restrict the cell-permutations to row-based cell-permutations which permute four cells in each row, e.g. ShiftRow in AES. The number of possible row-based cell-permutations is estimated as  <span class="math">2^{18.3} (= (4!)^4)</span> . This step is based on the fact that the full diffusion property relies on only row-based property of the cell-permutation. As a result of our searches, we find that a class of row-based cell-permutations achieves full diffusion in 3 rounds and its necessary and sufficient condition is as follows.</p>

    <p class="text-gray-300">Condition 1 (3-round full diffusion) For a  <span class="math">4 \\times 4</span>  cell-array, after applying a cell-permutation once and twice, each input cell in a column is mapped into a cell in the different column.</p>

    <p class="text-gray-300">From our search, 576 row-based cell-permutations satisfy Condition 1. Interestingly, ShiftRow-type permutation is not included in this class, i.e. it requires 4 rounds for full diffusion.</p>

    <p class="text-gray-300">In the second step, we add a column-based cell-permutation, which permutes four cells in each column, after applying the class of permutations satisfying Condition 1. The target cell permutation consists of the combination of the row-based and column-based permutations. Note that adding a column-based cell-permutation to the row-based permutations satisfying Condition 1 does not affect the full diffusion property. The number of all possible cell-permutations of this class is estimated as <span class="math">2^{27.51}</span> (<span class="math">=576\\times(4!)^{4}</span>). Consequently, we find a class of cell-permutation achieving the largest number of active S-boxes in each round and the smallest number of rounds to attain full diffusion when satisfying Condition 1 and the following Condition 2 <em>or</em> 3.</p>

    <h6 id="sec-16" class="text-base font-medium mt-4">Condition 2</h6>

    <p class="text-gray-300">(The number of active S-box) For a <span class="math">4\\times 4</span> cell-array, after applying a cell-permutation twice and twice inversely, each input cell in a column is mapped into a cell in the same row.</p>

    <h6 id="sec-17" class="text-base font-medium mt-4">Condition 3</h6>

    <p class="text-gray-300">(The number of active S-box) For a <span class="math">4\\times 4</span> cell-array, after applying a cell-permutation once and three times inversely, each input cell in a column is mapped into a cell in the same row.</p>

    <p class="text-gray-300">The numbers of cell-permutations satisfying Condition 2 and Condition 3 are both 576. We define such 1152 cell-permutation as <em>optimal cell-permutations</em>. Table 8 shows the minimum numbers of differentially/linearly active S-boxes of the optimal cell-permutations and the ShiftRow-type permutation. Our optimal cell-permutations drastically improve the minimum number of differentially/linearly active S-boxes in each round while keeping the 3-round full diffusion property as shown in Fig. 8. Thus, our optimal permutations achieve security against several attacks such as differential/linear and impossible attacks in the same number of rounds compared to ShiftRow-type permutation. Midori128 and Midori64 adopt one of optimal cell permutations satisfying both Conditions 1 and 2 as follows.</p>

    <p class="text-gray-300"><span class="math">(s_{0},s_{1},...,s_{15})\\leftarrow(s_{0},s_{10},s_{5},s_{15},s_{14},s_{4},s_{11},s_{1},s_{9},s_{3},s_{12},s_{6},s_{7},s_{13},s_{2},s_{8}).</span></p>

    <p class="text-gray-300">Starting from the state <span class="math">S_{0}</span>, each cell of <span class="math">S_{0}</span> is mapped to <span class="math">S_{1}</span>, <span class="math">S_{2}</span>, <span class="math">S_{1}^{-1}</span> and <span class="math">S_{2}^{-1}</span> after applying the above cell-permutation once, twice, once inversely and twice inversely, respectively, as follows.</p>

    <p class="text-gray-300">\\[ S_{0}=\\begin{bmatrix}s_{0}&s_{4}&s_{8}&s_{12}\\\\ s_{1}&s_{5}&s_{9}&s_{13}\\\\ s_{2}&s_{6}&s_{10}&s_{14}\\\\ s_{3}&s_{7}&s_{11}&s_{15}\\end{bmatrix},S_{1}=\\begin{bmatrix}s_{0}&s_{14}&s_{9}&s_{7}\\\\ s_{10}&s_{4}&s_{3}&s_{13}\\\\ s_{5}&s_{11}&s_{12}&s_{2}\\\\ s_{15}&s_{1}&s_{6}&s_{8}\\end{bmatrix},S_{2}=\\begin{bmatrix}s_{0}&s_{2}&s_{3}&s_{1}\\\\ s_{12}&s_{14}&s_{15}&s_{13}\\\\ s_{4}&s_{6}&s_{7}&s_{5}\\\\ s_{8}&s_{10}&s_{11}&s_{9}\\end{bmatrix}, \\]</p>

    <p class="text-gray-300">\\[ S_{1}^{-1}=\\begin{bmatrix}s_{0}&s_{5}&s_{15}&s_{10}\\\\ s_{7}&s_{2}&s_{8}&s_{13}\\\\ s_{14}&s_{11}&s_{1}&s_{4}\\\\ s_{9}&s_{12}&s_{6}&s_{3}\\end{bmatrix},S_{2}^{-1}=\\begin{bmatrix}s_{0}&s_{2}&s_{3}&s_{1}\\\\ s_{12}&s_{14}&s_{15}&s_{13}\\\\ s_{4}&s_{6}&s_{7}&s_{5}\\\\ s_{8}&s_{10}&s_{11}&s_{9}\\end{bmatrix}. \\]</p>

    <p class="text-gray-300">##</p>

    <p class="text-gray-300">Table 8: The number of minimum number of differentially/linearly active S-boxes (AS) of Midori64 and Midori128</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Round Number</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">4</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">5</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">6</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">7</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">8</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">9</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">10</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">11</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">12</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">13</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">14</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">15</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">16</th>

          </tr>

        </thead>

        <tbody>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">Min. # of AS (Optimal Cell-Permutation)</td>

            <td class="px-3 py-2 border-b border-gray-700">16</td>

            <td class="px-3 py-2 border-b border-gray-700">23</td>

            <td class="px-3 py-2 border-b border-gray-700">30</td>

            <td class="px-3 py-2 border-b border-gray-700">35</td>

            <td class="px-3 py-2 border-b border-gray-700">38</td>

            <td class="px-3 py-2 border-b border-gray-700">41</td>

            <td class="px-3 py-2 border-b border-gray-700">50</td>

            <td class="px-3 py-2 border-b border-gray-700">57</td>

            <td class="px-3 py-2 border-b border-gray-700">62</td>

            <td class="px-3 py-2 border-b border-gray-700">67</td>

            <td class="px-3 py-2 border-b border-gray-700">72</td>

            <td class="px-3 py-2 border-b border-gray-700">75</td>

            <td class="px-3 py-2 border-b border-gray-700">84</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">Min. # of AS (ShiftRow-type Permutation)</td>

            <td class="px-3 py-2 border-b border-gray-700">16</td>

            <td class="px-3 py-2 border-b border-gray-700">18</td>

            <td class="px-3 py-2 border-b border-gray-700">20</td>

            <td class="px-3 py-2 border-b border-gray-700">26</td>

            <td class="px-3 py-2 border-b border-gray-700">32</td>

            <td class="px-3 py-2 border-b border-gray-700">34</td>

            <td class="px-3 py-2 border-b border-gray-700">36</td>

            <td class="px-3 py-2 border-b border-gray-700">42</td>

            <td class="px-3 py-2 border-b border-gray-700">48</td>

            <td class="px-3 py-2 border-b border-gray-700">50</td>

            <td class="px-3 py-2 border-b border-gray-700">52</td>

            <td class="px-3 py-2 border-b border-gray-700">58</td>

            <td class="px-3 py-2 border-b border-gray-700">64</td>

          </tr>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">From those mappings, it is clear that the relation among  <span class="math">S_2^{-1}</span> ,  <span class="math">S_0</span>  and  <span class="math">S_2</span>  satisfies Condition 2. Similarly, all of the pairs  <span class="math">(S_2^{-1}, S_1^{-1})</span> ,  <span class="math">(S_1^{-1}, S_0)</span> ,  <span class="math">(S_0, S_1)</span> ,  <span class="math">(S_1, S_2)</span>  satisfy Condition 1.</p>

    <p class="text-gray-300">!<a href="img-8.jpeg">img-8.jpeg</a> Fig. 8: Comparison of the minimum numbers of differentially/linearly active S-boxes (AS)</p>

    <p class="text-gray-300">According to analysis of Section 2.2, 4-bit S-boxes are usually more efficient than 8-bit S-boxes in terms of energy consumption per cycle. Also, the small path delay and the small gate area lead to low-energy implementation. To optimize S-layer regarding energy consumption, we aim to develop a small-delay and lightweight 4-bit S-box which fulfill the following requirements: (1) the maximal probability of a differential is  <span class="math">2^{-2}</span> , (2) the maximal absolute bias of a linear approximation is  <span class="math">2^{-2}</span>  and (3) involution. The requirement (3) enables us to reduce the number of possible S-boxes from  <span class="math">2^{44.25}</span>  to  <span class="math">2^{25.5}</span> .</p>

    <p class="text-gray-300">Approach to Find Small-Delay and Lightweight 4-bit S-box. Our approach starts with a key observation that the path delay is highly related to the dependency of the computation. We introduce a metric depth to estimate the path delay of S-boxes.</p>

    <p class="text-gray-300"><strong>Definition 1 (depth):</strong> The depth is defined as the sum of sequential path delays of basic operations AND, OR, NAND, NOR and NOT.</p>

    <p class="text-gray-300"><strong>Example.</strong> The depth of the computation of <span class="math">(x \\oplus y) \\cdot z</span> is estimated as the sum of path delays of XOR and AND, because â€œ<span class="math">\\cdot z</span>â€ operation is feasible only after the computation of <span class="math">(x \\oplus y)</span>,</p>

    <p class="text-gray-300">In our search, we assume that depths of XOR, AND/OR, NAND/NOR and NOT are weighted as 2, 1.5, 1 and 0.5, respectively, based on the number of the transistors to be sequentially proceeded in the operation. The required gates of NOT, NAND/NOR, AND/OR and XOR/XNOR are estimated as 0.5, 1, 1.5 and 2 [GEs], respectively. We search all S-boxes whose depth is <span class="math">1, 1.5, 2, \\ldots</span>, and check whether the S-boxes satisfy our security requirements. As a result, we can find <span class="math">\\mathsf{Sb}_0</span> (see Table 4) whose depth and gate size are the lowest and the smallest ones in our search. <span class="math">\\mathsf{Sb}_0</span> can be expressed as follows, where inputs and outputs are defined as <span class="math">\\{a, b, c, d\\}</span> and <span class="math">\\{a&#x27;, b&#x27;, c&#x27;, d&#x27;\\}</span>, and <span class="math">a</span> and <span class="math">a&#x27;</span> are the most significant bits.</p>

    <div class="my-4 text-center"><span class="math-block">a&#x27; = \\left(\\bar{c} \\text{ NAND } (a \\text{ NAND } b)\\right) \\text{ NAND } (a \\text{ OR } d)</span></div>

    <div class="my-4 text-center"><span class="math-block">b&#x27; = \\left((a \\text{ NOR } d) \\text{ NOR } (b \\text{ AND } c)\\right) \\text{ NAND } \\left((a \\text{ AND } c) \\text{ NAND } d\\right)</span></div>

    <div class="my-4 text-center"><span class="math-block">c&#x27; = (b \\text{ NAND } d) \\text{ NAND } \\left((b \\text{ NOR } d) \\text{ OR } a\\right)</span></div>

    <div class="my-4 text-center"><span class="math-block">d&#x27; = \\left(a \\text{ NOR } (b \\text{ OR } c)\\right) \\text{ NOR } \\left((a \\text{ NAND } b) \\text{ NAND } (c \\text{ OR } d)\\right)</span></div>

    <p class="text-gray-300">For instance, let us consider the computation of <span class="math">c&#x27;</span>. In this computation, <span class="math">(b \\text{ NAND } d)</span> and <span class="math">(b \\text{ NOR } d)</span> can be done at first. After that, the computation of <span class="math">(b \\text{ NOR } d) \\text{ OR } a</span> is done. Then, the last operation of NAND is executable. Thus, the depth of <span class="math">c&#x27;</span> is estimated as 3.5 (<span class="math">= 1 + 1.5 + 1</span>). The depths of the remaining <span class="math">a&#x27;</span>, <span class="math">b&#x27;</span> and <span class="math">d&#x27;</span> are also estimated as 3.0 or 3.5.</p>

    <p class="text-gray-300">Considering additional requirement full diffusion property, we find <span class="math">\\mathsf{Sb}_1</span> which has the lowest depth and the smallest gate area among 4-bit bijective S-boxes satisfying the requirements (1), (2), (3) and the full diffusion property. <span class="math">\\mathsf{Sb}_1</span> is expressed as follows:</p>

    <div class="my-4 text-center"><span class="math-block">a&#x27; = \\left((b \\text{ NAND } c) \\text{ NAND } a\\right) \\text{ NAND } \\left((a \\text{ NOR } d) \\text{ NAND } b\\right)</span></div>

    <div class="my-4 text-center"><span class="math-block">b&#x27; = \\left((a \\text{ XOR } c) \\text{ NOR } b\\right) \\text{ NOR } \\left((b \\text{ NAND } c) \\text{ AND } d\\right)</span></div>

    <div class="my-4 text-center"><span class="math-block">c&#x27; = (c \\text{ NAND } d) \\text{ NAND } \\left((a \\text{ XOR } b) \\text{ NAND } (b \\text{ OR } d)\\right)</span></div>

    <div class="my-4 text-center"><span class="math-block">d&#x27; = \\left((a \\text{ NAND } b) \\text{ NAND } c\\right) \\text{ NAND } (b \\text{ OR } d)</span></div>

    <p class="text-gray-300">Note that an S-box satisfies the full diffusion property if and only if any inputs  <span class="math">\\{a, b, c, d\\}</span>  of the S-box non-linearly affect all outputs  <span class="math">\\{a&#x27;, b&#x27;, c&#x27;, d&#x27;\\}</span> . This full diffusion property enables us to ensure a 3-round property regarding the diffusion in Midori128 (we will explain it in the end of this section).</p>

    <p class="text-gray-300">Evaluation. Table 7 shows the comparison of S-boxes of PRESENT, PRINCE,  <span class="math">\\mathsf{Sb}_0</span>  and  <span class="math">\\mathsf{Sb}_1</span>  using NanGate  <span class="math">45\\mathrm{nm}</span>  open cell library. The path delay of  <span class="math">\\mathsf{Sb}_0</span>  is 1.5 times and twice smaller than PRINCE and PRESENT, respectively, and the gate size is also smaller than the others. Those of  <span class="math">\\mathsf{Sb}_1</span>  are comparable to PRINCE's S-box. Additionally  <span class="math">\\mathsf{Sb}_0</span>  and  <span class="math">\\mathsf{Sb}_1</span>  have the involution property.</p>

    <p class="text-gray-300">Table 9: Input-output bit relations of each S-box</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">SSb0</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">SSb1</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">SSb2</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">SSb3</th>

          </tr>

        </thead>

        <tbody>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">A</td>

            <td class="px-3 py-2 border-b border-gray-700">(1, 3, 4, 6)</td>

            <td class="px-3 py-2 border-b border-gray-700">(0, 1, 6, 7)</td>

            <td class="px-3 py-2 border-b border-gray-700">(1, 2, 3, 4)</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">B</td>

            <td class="px-3 py-2 border-b border-gray-700">(0, 2, 5, 7)</td>

            <td class="px-3 py-2 border-b border-gray-700">(2, 3, 4, 5)</td>

            <td class="px-3 py-2 border-b border-gray-700">(0, 5, 6, 7)</td>

          </tr>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">8-bit S-boxes based on 4-bit S-boxes. From the observation in Section 2.2, we adopt 8-bit S-boxes consisting of two 4-bit S-boxes processed in parallel to minimize the path delay in the round-based implementation. Moreover, in order to avoid having the unfavorable independent property exploited in the full-round attack on KLEIN [24], we add properly-chosen bit-permutations to the begin and the end of 8-bit S-boxes as shown in Fig. 6. As described in Section 3.1, each output bit-permutation is the inverse of the corresponding input bit-permutation to keep the involution property. With a property of our P-layer and those bit-permutations, we claim that no independent property is found after 3 rounds in Midori128. Since  <span class="math">\\mathsf{Sb}_1</span>  has the full diffusion property, any input bit of  <span class="math">\\mathsf{SSb}_i</span>  affects the corresponding 4 bits output as shown in Table 9. For example, in  <span class="math">\\mathsf{SSb}_1</span> , any of the  <span class="math">i</span> -th input bit affects all of the  <span class="math">i</span> -th output bits, where  <span class="math">i \\in \\{0,1,6,7\\}</span> . We choose bit-permutations for  <span class="math">\\mathsf{SSb}_0</span> ,  <span class="math">\\mathsf{SSb}_1</span> ,  <span class="math">\\mathsf{SSb}_2</span>  and  <span class="math">\\mathsf{SSb}_3</span>  so that those satisfy the following property.</p>

    <p class="text-gray-300">Property 1 Affected 4-bit positions of outputs of an  <span class="math">S</span> -box are included in both of two different input groups of the other three  <span class="math">S</span> -boxes.</p>

    <p class="text-gray-300">For example, the group A of  <span class="math">\\mathsf{SSb}_1</span>  is  <span class="math">\\{0, 1, 6, 7\\}</span> . Then, those bit positions are found in the groups A and B of  <span class="math">\\mathsf{SSb}_0</span> . This implies that the  <span class="math">\\{0, 1, 6, 7\\}</span> -th input bits of  <span class="math">\\mathsf{SSb}_0</span>  affect all 8 bits output. For the matrix operation  <span class="math">^t (y_0,y_1,y_2,y_3)\\gets M^t (x_0,x_1,x_2,x_3)</span> , we have the following property.</p>

    <p class="text-gray-300">Property 2 Each input cell affects three cells in the different cell positions from the input.</p>

    <p class="text-gray-300">!<a href="img-9.jpeg">img-9.jpeg</a> Fig. 9: Theorem 1: 3-round full diffusion property</p>

    <p class="text-gray-300">For instance,  <span class="math">x_0</span>  deterministically affects  <span class="math">y_1</span> ,  <span class="math">y_2</span>  and  <span class="math">y_3</span> , and does not affect  <span class="math">y_0</span> . From Properties 1 and 2, we obtain the following theorem.</p>

    <p class="text-gray-300">Theorem 1 In Midori128, any input bit nonlinearly affects all 128 bits of the state after 3 rounds.</p>

    <p class="text-gray-300">Proof. An input bit affects 4 bits in the corresponding cell after the first S-layer due to the full diffusion property of  <span class="math">\\mathsf{Sb}_1</span> . From Property 2, the affected 4 bits in the cell are diffused to three cells in the same column but the different cell position after MixColumn. Note that, in the affected three cells, the affected bit positions are the same. From Property 1, in each affected three cells, the affected 4 bits are spreads over all 8 bits in the cell after the 2nd S-layer. Therefore, all bits are affected by any input after 3 rounds (see Fig. 9).</p>

    <p class="text-gray-300">To save energy, Midori128 does not employ any key scheduling function. The same 128 bit key is used as the whitening key and to generate the round key. To make an efficient circuit for decryption, the  <span class="math">i</span> -th round key is defined as  <span class="math">L^{-1}(K) \\oplus L^{-1}(\\beta_{18-i})</span> , where  <span class="math">L^{-1}</span>  denotes the inverse of the linear layer. Computation of  <span class="math">L^{-1}(K)</span>  involves a one-time computation with the key at the beginning at the decryption function and so does not consume any significant energy. The round key generation of Midori64, is slightly more complicated, as it involves selecting  <span class="math">K_0</span>  and  <span class="math">K_1</span> , i.e. the most significant and least significant halves of the 128 bit key in alternate rounds. This can be achieved by the use of a single multiplexer. For efficient decryption, a one-time computation of  <span class="math">L^{-1}(K_0)</span>  and  <span class="math">L^{-1}(K_1)</span>  can be done at the beginning of the algorithm, which again does not consume any significant energy.</p>

    <p class="text-gray-300">Both Midori128 and Midori64 use  <span class="math">4 \\times 4</span>  binary matrices as round constants. The constants have been derived from the hexadecimal encoding of the fractional part of  <span class="math">\\pi = 3.243f</span>  6a88 85a3 ... For example, the 1st, 2nd, 3rd, 4th rows of  <span class="math">\\beta_0</span>  when read as a 4-bit binary constant, are the encoding of the hex values</p>

    <p class="text-gray-300">,4,3,f respectively. Similarly for the other <span class="math">\\beta^{\\prime}_{i}</span>s. These are added bitwise to the LSB of each round key byte in Midori128 and round key nibble in Midori64. The round constants were chosen in this manner with a view to have an energy-efficient decryption circuit. Both <span class="math">\\beta_{i}</span> and <span class="math">L^{-1}(\\beta_{i})</span> are <span class="math">4\\times 4</span> binary matrices, and so in both Midori128 and Midori64, the round constant addition requires a total of 16 XOR gates only. The constants <span class="math">\\beta_{i}</span> and <span class="math">L^{-1}(\\beta_{i})</span> can be stored in lookup tables and filtered accordingly in each round.</p>

    <h2 id="sec-21" class="text-2xl font-bold">5 Security Evaluation</h2>

    <h3 id="sec-22" class="text-xl font-semibold mt-8">5.1 Differential/Linear Cryptanalysis</h3>

    <p class="text-gray-300">The minimum number of differentially and linearly active S-boxes of each round is estimated as shown in Table 8. The maximum differential and linear probabilities of Sb_{0}, SSb_{0}, SSb_{1}, SSb_{2} and SSb_{3} are <span class="math">2^{-2}</span>, respectively. Midori64 and Midori128 have more than 32 and 64 active S-boxes after 7 and 13 rounds. Thus, we expect that variants of Midori64 and Midori128 reduced to 7 rounds and 13 rounds do not have any differential and linear trails whose probabilities are higher than <span class="math">2^{-64}</span> and <span class="math">2^{-128}</span>.</p>

    <h3 id="sec-23" class="text-xl font-semibold mt-8">5.2 Boomerang-Type Attack</h3>

    <p class="text-gray-300">The boomerang-type attacks first divide the cipher into two sub-ciphers, then find a boomerang quartet with high probability. The probability of constructing a boomerang quartet is denoted as <span class="math">\\hat{p}^{2}\\hat{q}^{2}</span>, where <span class="math">\\hat{p}=\\sqrt{\\sum_{\\beta}\\mathrm{Pr}^{2}[\\alpha\\rightarrow\\beta]}</span>, and <span class="math">\\alpha</span> and <span class="math">\\beta</span> are input and output differences for the first sub-cipher, and <span class="math">\\hat{q}</span> for the second sub-cipher. <span class="math">\\hat{p}^{2}</span> is bounded by the maximum differential trail probability, i.e., <span class="math">\\hat{p}^{2}\\leq\\max_{\\beta}\\mathrm{Pr}[\\alpha\\rightarrow\\beta]</span>, and <span class="math">\\hat{q}^{2}</span> as well. Let <span class="math">p,q</span> be the maximum differential trail probability for the first and the second sub-ciphers. Then, <span class="math">p,q</span> are bounded by multiplying the minimum number of active S-boxes in each sub-cipher. From Table 8, any combination of two sub-ciphers for consisting of Midori64 and Midori128 after 8 and 14 rounds has at least 32 and 64 active S-boxes in total. Note that these bounds of boomerang attacks are very conservative ones, i.e., it requires unrealistic assumptions of <span class="math">\\hat{p}^{2}=p</span> and <span class="math">\\hat{q}^{2}=q</span>. Actually, in our active S-box search, we did not find such special events. Thus, we expect that much smaller rounds than 8 and 14 rounds are secure against boomerang-type attacks.</p>

    <h3 id="sec-24" class="text-xl font-semibold mt-8">5.3 Impossible Differential Attacks</h3>

    <p class="text-gray-300">Midori64 and Midori128 achieve the 3-round full diffusion property. Thus, differences of all cells in a state becomes unknown after SubCell of 4 rounds, i.e., there is no any probability-one (truncated) differential characteristic. Following the miss-in-the-middle approach, the maximum number of rounds of impossible differential characteristics is estimated as 7 rounds.</p>

    <p class="text-gray-300">In order to obtain the lower bound of rounds of impossible differential, we try to find actual impossible differential characteristics. We utilize several deterministic properties of four binary matrices <span class="math">\\bm{M}</span>. This approach was also adopted in the security evaluation of FIDES <em>[9]</em>. As a result, we find 6-round impossible differentials such that <em>if only one active cell is input, 6-rounds of <span class="math">\\mathsf{Midori64}</span> and <span class="math">\\mathsf{Midori128}</span> never produces only one active cell</em>. We believe that full rounds of <span class="math">\\mathsf{Midori64}</span> and <span class="math">\\mathsf{Midori128}</span> have sufficient number of rounds as the security margin.</p>

    <h3 id="sec-25" class="text-xl font-semibold mt-8">5.4 Meet-in-the-Middle Attacks</h3>

    <p class="text-gray-300">The 3-round full diffusion property with our S-boxes enable us to claim that any inserted key bit of <span class="math">\\{K_{0}</span>, <span class="math">K_{1}\\}</span> or <span class="math">K</span> non-linearly affects all bits of the state after 3 rounds in the forward and the backward directions in <span class="math">\\mathsf{Midori64}</span> and <span class="math">\\mathsf{Midori128}</span>, respectively. Thus, the number of rounds used for the partial matching (PM) <em>[2]</em> is upper bounded by 5 <span class="math">(=(3-1)+(3-1)+1)</span>. The condition for the initial structure (IS) <em>[30]</em>, also called independent biclique <em>[11]</em>, is that key differential trails in the forward direction and those in the backward direction do not share active non-linear components. For <span class="math">\\mathsf{Midori64}</span> and <span class="math">\\mathsf{Midori128}</span>, since any key differential affects all 16 S-boxes after at least 4 rounds in the forward and the backward directions, there is no such differential which shares active S-box in more than 4 rounds. Thus, the number of rounds used for IS is upper bounded by 3. Assuming that the splice-and-cut technique allows an attacker to add more 3 rounds in the worst case, at most 11-round (3 + 3 + 5) MitM attack may be feasible. However, because of white keys in the begin and the end and the actual constraint of key orders, we consider that it is difficult to construct 11-round attacks on <span class="math">\\mathsf{Midori64}</span> and <span class="math">\\mathsf{Midori128}</span>.</p>

    <h4 id="sec-26" class="text-lg font-semibold mt-6">Integral Attacks</h4>

    <p class="text-gray-300">Integral attacks are likely to be efficient for the SPN ciphers. We define four states for a set of <span class="math">2^{n}</span> <span class="math">n</span>-bit cell: <span class="math">\\mathbf{A}</span>: if <span class="math">\\forall i,j\\ i\\neq j\\Leftrightarrow x_{i}\\neq x_{j}</span>, <span class="math">\\mathbf{C}</span>: if <span class="math">\\forall i,j\\ i\\neq j\\Leftrightarrow x_{i}=x_{j}</span>, <span class="math">\\mathbf{B}</span>: <span class="math">\\bigoplus_{i}^{2^{n}-1}x_{i}</span>, and <span class="math">\\mathbf{U}</span>: Other. In order to estimate upper bounds of integral characteristics, we utilize an evaluation method in <em>[35]</em>. At first, we obtain the required number of rounds <span class="math">N_{A}</span> for the event of <span class="math">(\\alpha\\rightarrow\\beta)</span>, <span class="math">\\alpha</span> is a state consisting of one <span class="math">\\mathbf{A}</span> and 15 <span class="math">\\mathbf{C}</span>, and <span class="math">\\beta</span> is a state consisting of all 16 <span class="math">\\mathbf{U}</span>. After that, we estimate the required number of rounds <span class="math">N_{B}</span> for the event of <span class="math">(\\alpha^{\\prime}\\rightarrow\\alpha)</span>, where <span class="math">\\alpha^{\\prime}</span> is a state consisting of all 16 <span class="math">\\mathbf{A}</span>. Then, the round number of integral characteristic is bounded by the sum of <span class="math">N_{A}</span> and <span class="math">N_{B}</span>. Since <span class="math">N_{A}</span> and <span class="math">N_{B}</span> of <span class="math">\\mathsf{Midori64}</span> and <span class="math">\\mathsf{Midori128}</span> are 4 and 2, respectively, we expected that the maximum number of round of integral characteristics is 7 rounds To obtain lower bounds, we try to find actual integral characteristics, and obtain a 3.5-round one. By exploiting several techniques used in the integral attack on <span class="math">\\mathsf{Prince}</span>, we can construct 7-round key recovery attacks based on the distinguisher but more round seems to be infeasible. Thus, full versions of <span class="math">\\mathsf{Midori64}</span> and <span class="math">\\mathsf{Midori128}</span> are expected to be enough secure against integral attacks.</p>

    <p class="text-gray-300">Slide Attacks</p>

    <p class="text-gray-300">Slide attacks exploit self similarities of round functions. Each round of Midori64 and Midori128 accept 16-bit round-dependent constants, and each bit is XORed to all 16 cells. These 16-bit constants make a sufficient difference in each round function. Actually, differences coming from these 16-bit constants are expanded into more than the half of a state after S-layer, and it can efficiently break self similarities to be utilized for slide attacks. Thus, we believe that any slide attacks can not be constructed in Midori64 and Midori128.</p>

    <h4 id="sec-27" class="text-lg font-semibold mt-6">Reflection Attacks</h4>

    <p class="text-gray-300">Reflection attacks rely on the structure of the Prince-like block cipher, described as <span class="math">F_{K}^{-1}\\circ M\\circ F_{K}</span>, and exploits the similarity of <span class="math">F_{K}</span> and <span class="math">F_{K}^{-1}</span>, where <span class="math">F_{K}</span> and <span class="math">F_{K}^{-1}</span> are keyed permutation and its inverse function, respectively, and <span class="math">M</span> is an involutive function, namely <span class="math">M=M^{-1}</span>. Although Midori64 and Midori128 utilize involutive components of S-boxes and Matrixes, the cell-permutation is not involution. Thus, Midori64 and Midori128 are not expressed as a function of <span class="math">F_{K}^{-1}\\circ M\\circ F_{K}</span>. In addition, 16-bit round-dependent constants break these similarities of the first half and the inverse of last half functions. Thus, we believe that any reflection attacks is not applicable to Midori64 and Midori128.</p>

    <h2 id="sec-28" class="text-2xl font-bold">6 Implementation</h2>

    <p class="text-gray-300">The main design objectives of Midori were first to achieve efficiency in energy consumption and second to provide both the encryption and decryption (ED) functionalities with minimal overhead. In this context, it is essential to have a round based design optimal in terms of energy consumption, since unrolled designs are unlikely to be efficient in terms of energy consumption. The S-box and the MixColumn layer were specifically chosen for their energy-efficiency and their involutive property. Both these layers have very small logic depth which makes the energy consumption per round figure as small as possible. Structurally MidoriCore and MidoriCore^{-1} differ only in the order of application of ShuffleCell, MixColumn and InvShuffleCell operations. And so, the circuit for the round based implementation of the cipher, that accommodates both encryption and decryption can be realized in Fig. 10.</p>

    <p class="text-gray-300">Since the ShuffleCell operation (Sh) and MixColumn (MC) do not commute, the linear layer which is basically the composition of MC<span class="math">\\circ</span>Sh (<span class="math">=L</span> say), must be inverted during the decryption by <span class="math">L^{-1}=\\text{ Sh}^{-1}\\circ</span>MC. In hardware, this can be achieved in two ways. The first involves filtering the outputs of the <span class="math">L</span> and <span class="math">L^{-1}</span> operations through a single multiplexer. This requires two instances of the MixColumn logic in the circuit, and since this layer is the most expensive in terms of area and energy consumed, it is not the most efficient way to achieve this functionality. The second method which is better in terms of both area and energy is the one shown in Fig. 10. This involves using two multiplexers</p>

    <p class="text-gray-300">!<a href="img-10.jpeg">img-10.jpeg</a> Fig. 10: The round based encryption/decryption (ED) architecture</p>

    <p class="text-gray-300">for filtering the outputs of the Sh and  <span class="math">\\mathrm{Sh}^{-1}</span>  operations and a single instance of the MixColumn logic. To perform the decryption operation using this circuit, the round key needs to be changed to  <span class="math">L^{-1}(K)</span> , and correspondingly the  <span class="math">i^{th}</span>  round constant to  <span class="math">L^{-1}(\\beta_{18 - i})</span> . The first involves a cheap one-time change to the master key, while keeping the whitening key constant. The round constant functionality can be achieved by employing two lookup tables, one each for encryption and decryption and filtering the appropriate round constant through a multiplexer. The round constants have been chosen in a manner so that both  <span class="math">\\beta_{i}</span>  and  <span class="math">L^{-1}(\\beta_{i})</span>  are  <span class="math">4\\times 4</span>  binary matrices, and so this layer requires a total of 16 XOR gates only. The circuit for the 64-bit variant is the same as in Fig. 10, except that it requires an extra filtering between between  <span class="math">K_{0}</span>  and  <span class="math">K_{1}</span>  (the most and least significant halves of the secret key) in alternate rounds. Additionally one can also design an encryption only (E) variant of the circuit as shown in Figure 11.</p>

    <p class="text-gray-300">!<a href="img-11.jpeg">img-11.jpeg</a> Fig. 11: The round based encryption only (E) architecture</p>

    <p class="text-gray-300">All the designs were initially implemented in VHDL and the functional verification was done using Mentor Graphics ModelSim SE software. The designs were then synthesized using the Synopsys Design Compiler for the Standard Cell library of the STM 90nm Logic Process: CORE90GPHVT v 2.1.a.</p>

    <p class="text-gray-300">Table 10: A comparison of energy consumption of Midori with selected ciphers for the STM 90nm Logic Process. (Average Power reported at 10 MHz)</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">#</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Cipher</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Block Size</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Architecture</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Area (in GE)</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Energy pJ</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Energy/bit pJ</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Average Power (Î¼W)</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Critical Path (ns)</th>

          </tr>

        </thead>

        <tbody>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">1</td>

            <td class="px-3 py-2 border-b border-gray-700">AES</td>

            <td class="px-3 py-2 border-b border-gray-700">128</td>

            <td class="px-3 py-2 border-b border-gray-700">ED</td>

            <td class="px-3 py-2 border-b border-gray-700">21274</td>

            <td class="px-3 py-2 border-b border-gray-700">769.0</td>

            <td class="px-3 py-2 border-b border-gray-700">6.01</td>

            <td class="px-3 py-2 border-b border-gray-700">699.1</td>

            <td class="px-3 py-2 border-b border-gray-700">4.08</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">E</td>

            <td class="px-3 py-2 border-b border-gray-700">12459</td>

            <td class="px-3 py-2 border-b border-gray-700">350.7</td>

            <td class="px-3 py-2 border-b border-gray-700">2.74</td>

            <td class="px-3 py-2 border-b border-gray-700">318.8</td>

            <td class="px-3 py-2 border-b border-gray-700">3.32</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">2</td>

            <td class="px-3 py-2 border-b border-gray-700">NOEKEON</td>

            <td class="px-3 py-2 border-b border-gray-700">128</td>

            <td class="px-3 py-2 border-b border-gray-700">ED</td>

            <td class="px-3 py-2 border-b border-gray-700">3439</td>

            <td class="px-3 py-2 border-b border-gray-700">331.5</td>

            <td class="px-3 py-2 border-b border-gray-700">2.59</td>

            <td class="px-3 py-2 border-b border-gray-700">184.2</td>

            <td class="px-3 py-2 border-b border-gray-700">3.79</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">E</td>

            <td class="px-3 py-2 border-b border-gray-700">2284</td>

            <td class="px-3 py-2 border-b border-gray-700">338.0</td>

            <td class="px-3 py-2 border-b border-gray-700">2.64</td>

            <td class="px-3 py-2 border-b border-gray-700">187.8</td>

            <td class="px-3 py-2 border-b border-gray-700">3.38</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">3</td>

            <td class="px-3 py-2 border-b border-gray-700">SIMON 128/128</td>

            <td class="px-3 py-2 border-b border-gray-700">128</td>

            <td class="px-3 py-2 border-b border-gray-700">ED</td>

            <td class="px-3 py-2 border-b border-gray-700">3480</td>

            <td class="px-3 py-2 border-b border-gray-700">855.6</td>

            <td class="px-3 py-2 border-b border-gray-700">6.68</td>

            <td class="px-3 py-2 border-b border-gray-700">124.0</td>

            <td class="px-3 py-2 border-b border-gray-700">2.67</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">E</td>

            <td class="px-3 py-2 border-b border-gray-700">2420</td>

            <td class="px-3 py-2 border-b border-gray-700">664.1</td>

            <td class="px-3 py-2 border-b border-gray-700">5.19</td>

            <td class="px-3 py-2 border-b border-gray-700">96.2</td>

            <td class="px-3 py-2 border-b border-gray-700">2.66</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">4</td>

            <td class="px-3 py-2 border-b border-gray-700">Midori128</td>

            <td class="px-3 py-2 border-b border-gray-700">128</td>

            <td class="px-3 py-2 border-b border-gray-700">ED</td>

            <td class="px-3 py-2 border-b border-gray-700">3661</td>

            <td class="px-3 py-2 border-b border-gray-700">228.3</td>

            <td class="px-3 py-2 border-b border-gray-700">1.78</td>

            <td class="px-3 py-2 border-b border-gray-700">108.7</td>

            <td class="px-3 py-2 border-b border-gray-700">2.44</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">E</td>

            <td class="px-3 py-2 border-b border-gray-700">2522</td>

            <td class="px-3 py-2 border-b border-gray-700">187.3</td>

            <td class="px-3 py-2 border-b border-gray-700">1.46</td>

            <td class="px-3 py-2 border-b border-gray-700">89.2</td>

            <td class="px-3 py-2 border-b border-gray-700">2.25</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">5</td>

            <td class="px-3 py-2 border-b border-gray-700">PRESENT</td>

            <td class="px-3 py-2 border-b border-gray-700">64</td>

            <td class="px-3 py-2 border-b border-gray-700">ED</td>

            <td class="px-3 py-2 border-b border-gray-700">2186</td>

            <td class="px-3 py-2 border-b border-gray-700">250.2</td>

            <td class="px-3 py-2 border-b border-gray-700">3.91</td>

            <td class="px-3 py-2 border-b border-gray-700">75.8</td>

            <td class="px-3 py-2 border-b border-gray-700">2.32</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">E</td>

            <td class="px-3 py-2 border-b border-gray-700">1440</td>

            <td class="px-3 py-2 border-b border-gray-700">172.3</td>

            <td class="px-3 py-2 border-b border-gray-700">2.69</td>

            <td class="px-3 py-2 border-b border-gray-700">52.2</td>

            <td class="px-3 py-2 border-b border-gray-700">2.09</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">6</td>

            <td class="px-3 py-2 border-b border-gray-700">PRINCE</td>

            <td class="px-3 py-2 border-b border-gray-700">64</td>

            <td class="px-3 py-2 border-b border-gray-700">ED</td>

            <td class="px-3 py-2 border-b border-gray-700">2650</td>

            <td class="px-3 py-2 border-b border-gray-700">146.3</td>

            <td class="px-3 py-2 border-b border-gray-700">2.29</td>

            <td class="px-3 py-2 border-b border-gray-700">112.5</td>

            <td class="px-3 py-2 border-b border-gray-700">4.09</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">E</td>

            <td class="px-3 py-2 border-b border-gray-700">2286</td>

            <td class="px-3 py-2 border-b border-gray-700">144.7</td>

            <td class="px-3 py-2 border-b border-gray-700">2.26</td>

            <td class="px-3 py-2 border-b border-gray-700">111.3</td>

            <td class="px-3 py-2 border-b border-gray-700">4.06</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">7</td>

            <td class="px-3 py-2 border-b border-gray-700">Midori64</td>

            <td class="px-3 py-2 border-b border-gray-700">64</td>

            <td class="px-3 py-2 border-b border-gray-700">ED</td>

            <td class="px-3 py-2 border-b border-gray-700">2450</td>

            <td class="px-3 py-2 border-b border-gray-700">121.0</td>

            <td class="px-3 py-2 border-b border-gray-700">1.89</td>

            <td class="px-3 py-2 border-b border-gray-700">71.2</td>

            <td class="px-3 py-2 border-b border-gray-700">2.12</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">E</td>

            <td class="px-3 py-2 border-b border-gray-700">1542</td>

            <td class="px-3 py-2 border-b border-gray-700">103.0</td>

            <td class="px-3 py-2 border-b border-gray-700">1.61</td>

            <td class="px-3 py-2 border-b border-gray-700">60.6</td>

            <td class="px-3 py-2 border-b border-gray-700">2.06</td>

          </tr>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">The switching activity file was then generated by performing a timing simulation on the synthesized netlist using the Synopsys VCS Software. The energy was then estimated with the Synopsys Power Compiler by using the switching activity file. An operating frequency of  <span class="math">10\\mathrm{MHz}</span>  was used in all the simulations since the effect of the leakage power is minimal at this frequency, and so the energy consumed is more or less independent of the clock frequency. The results of the simulation for the 90nm logic process are presented in Table 10 along with similar evaluations for AES, NOEKEON, SIMON 128/128, PRESENT, PRINCE. It can be seen that Midori128/Midori64 performs better than NOEKEON/PRINCE which were also designed to make the combined functionalities of encryption and decryption easily available. In Fig. 12 we compare the energy/bit consumption of the ED architectures all the seven ciphers along with the cumulative latency figure (calculated as critical path  <span class="math">\\times</span>  number of rounds). It can be seen that Midori128 and Midori64 fare optimally with respect to both parameters.</p>

    <p class="text-gray-300">The design flow was repeated with the standard cell library based on the STM  <span class="math">65\\mathrm{nm}</span>  logic process: CORE65LPHVT v 5.1. The simulation results are tabulated in Table 11.</p>

    <p class="text-gray-300">!<a href="img-12.jpeg">img-12.jpeg</a> Fig. 12: Cumulative Latency vs Energy/bit figures</p>

    <p class="text-gray-300">Table 11: A comparison of energy consumption of Midori with selected ciphers for the STM 65nm Logic Process. (Average Power reported at 10 MHz)</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">#</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Cipher</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Block Size</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Architecture</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Area (in GE)</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Energy pJ</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Energy/bit pJ</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Average Power (Î¼W)</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Critical Path (ns)</th>

          </tr>

        </thead>

        <tbody>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">1</td>

            <td class="px-3 py-2 border-b border-gray-700">AES</td>

            <td class="px-3 py-2 border-b border-gray-700">128</td>

            <td class="px-3 py-2 border-b border-gray-700">ED</td>

            <td class="px-3 py-2 border-b border-gray-700">24722</td>

            <td class="px-3 py-2 border-b border-gray-700">449.5</td>

            <td class="px-3 py-2 border-b border-gray-700">3.51</td>

            <td class="px-3 py-2 border-b border-gray-700">408.6</td>

            <td class="px-3 py-2 border-b border-gray-700">7.93</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">E</td>

            <td class="px-3 py-2 border-b border-gray-700">14483</td>

            <td class="px-3 py-2 border-b border-gray-700">225.6</td>

            <td class="px-3 py-2 border-b border-gray-700">1.76</td>

            <td class="px-3 py-2 border-b border-gray-700">205.1</td>

            <td class="px-3 py-2 border-b border-gray-700">5.27</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">2</td>

            <td class="px-3 py-2 border-b border-gray-700">Noekeon</td>

            <td class="px-3 py-2 border-b border-gray-700">128</td>

            <td class="px-3 py-2 border-b border-gray-700">ED</td>

            <td class="px-3 py-2 border-b border-gray-700">3640</td>

            <td class="px-3 py-2 border-b border-gray-700">183.2</td>

            <td class="px-3 py-2 border-b border-gray-700">1.43</td>

            <td class="px-3 py-2 border-b border-gray-700">101.8</td>

            <td class="px-3 py-2 border-b border-gray-700">6.64</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">E</td>

            <td class="px-3 py-2 border-b border-gray-700">2448</td>

            <td class="px-3 py-2 border-b border-gray-700">229.3</td>

            <td class="px-3 py-2 border-b border-gray-700">1.79</td>

            <td class="px-3 py-2 border-b border-gray-700">127.4</td>

            <td class="px-3 py-2 border-b border-gray-700">5.68</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">3</td>

            <td class="px-3 py-2 border-b border-gray-700">Simon 128/128</td>

            <td class="px-3 py-2 border-b border-gray-700">128</td>

            <td class="px-3 py-2 border-b border-gray-700">ED</td>

            <td class="px-3 py-2 border-b border-gray-700">3603</td>

            <td class="px-3 py-2 border-b border-gray-700">564.0</td>

            <td class="px-3 py-2 border-b border-gray-700">4.40</td>

            <td class="px-3 py-2 border-b border-gray-700">81.7</td>

            <td class="px-3 py-2 border-b border-gray-700">3.13</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">E</td>

            <td class="px-3 py-2 border-b border-gray-700">2612</td>

            <td class="px-3 py-2 border-b border-gray-700">443.1</td>

            <td class="px-3 py-2 border-b border-gray-700">3.46</td>

            <td class="px-3 py-2 border-b border-gray-700">64.2</td>

            <td class="px-3 py-2 border-b border-gray-700">3.17</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">4</td>

            <td class="px-3 py-2 border-b border-gray-700">Midori128</td>

            <td class="px-3 py-2 border-b border-gray-700">128</td>

            <td class="px-3 py-2 border-b border-gray-700">ED</td>

            <td class="px-3 py-2 border-b border-gray-700">3959</td>

            <td class="px-3 py-2 border-b border-gray-700">127.8</td>

            <td class="px-3 py-2 border-b border-gray-700">1.00</td>

            <td class="px-3 py-2 border-b border-gray-700">60.9</td>

            <td class="px-3 py-2 border-b border-gray-700">3.51</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">E</td>

            <td class="px-3 py-2 border-b border-gray-700">2714</td>

            <td class="px-3 py-2 border-b border-gray-700">105.8</td>

            <td class="px-3 py-2 border-b border-gray-700">0.83</td>

            <td class="px-3 py-2 border-b border-gray-700">50.4</td>

            <td class="px-3 py-2 border-b border-gray-700">3.87</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">5</td>

            <td class="px-3 py-2 border-b border-gray-700">Present</td>

            <td class="px-3 py-2 border-b border-gray-700">64</td>

            <td class="px-3 py-2 border-b border-gray-700">ED</td>

            <td class="px-3 py-2 border-b border-gray-700">2499</td>

            <td class="px-3 py-2 border-b border-gray-700">171.3</td>

            <td class="px-3 py-2 border-b border-gray-700">2.68</td>

            <td class="px-3 py-2 border-b border-gray-700">51.9</td>

            <td class="px-3 py-2 border-b border-gray-700">4.27</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">E</td>

            <td class="px-3 py-2 border-b border-gray-700">1679</td>

            <td class="px-3 py-2 border-b border-gray-700">114.5</td>

            <td class="px-3 py-2 border-b border-gray-700">1.79</td>

            <td class="px-3 py-2 border-b border-gray-700">34.7</td>

            <td class="px-3 py-2 border-b border-gray-700">3.70</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">6</td>

            <td class="px-3 py-2 border-b border-gray-700">Prince</td>

            <td class="px-3 py-2 border-b border-gray-700">64</td>

            <td class="px-3 py-2 border-b border-gray-700">ED</td>

            <td class="px-3 py-2 border-b border-gray-700">3199</td>

            <td class="px-3 py-2 border-b border-gray-700">83.6</td>

            <td class="px-3 py-2 border-b border-gray-700">1.31</td>

            <td class="px-3 py-2 border-b border-gray-700">64.3</td>

            <td class="px-3 py-2 border-b border-gray-700">6.43</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">E</td>

            <td class="px-3 py-2 border-b border-gray-700">2780</td>

            <td class="px-3 py-2 border-b border-gray-700">81.0</td>

            <td class="px-3 py-2 border-b border-gray-700">1.27</td>

            <td class="px-3 py-2 border-b border-gray-700">62.3</td>

            <td class="px-3 py-2 border-b border-gray-700">6.26</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">7</td>

            <td class="px-3 py-2 border-b border-gray-700">Midori64</td>

            <td class="px-3 py-2 border-b border-gray-700">64</td>

            <td class="px-3 py-2 border-b border-gray-700">ED</td>

            <td class="px-3 py-2 border-b border-gray-700">2620</td>

            <td class="px-3 py-2 border-b border-gray-700">68.5</td>

            <td class="px-3 py-2 border-b border-gray-700">1.07</td>

            <td class="px-3 py-2 border-b border-gray-700">40.3</td>

            <td class="px-3 py-2 border-b border-gray-700">4.09</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">E</td>

            <td class="px-3 py-2 border-b border-gray-700">1638</td>

            <td class="px-3 py-2 border-b border-gray-700">58.5</td>

            <td class="px-3 py-2 border-b border-gray-700">0.91</td>

            <td class="px-3 py-2 border-b border-gray-700">34.4</td>

            <td class="px-3 py-2 border-b border-gray-700">3.92</td>

          </tr>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">7 Conclusion</p>

    <p class="text-gray-300">In this paper we present the block ciphers Midori128 and Midori64, optimized with respect to energy consumption. We first identify design choices that make a given algorithm efficient in terms of energy. Thereafter we propose two design components i.e. MixColumn matrix and S-box, that help us achieve the objectives of low energy design. These components are additionally involutive, that makes it easier to design a circuit with functionalities for both encryption and decryption. The energy of the proposed design was then found to be optimal in comparison with state of the art block ciphers available in literature.</p>

    <h2 id="sec-31" class="text-2xl font-bold">References</h2>

    <ul class="list-disc list-inside space-y-1 text-gray-300 my-2 ml-4">

      <li>[1] M. Albrecht, B. Driessen, E. Kavun, G. Leander, C. Paar, and T. YalÃ§in. Block ciphers - focus on the linear layer (feat. PRIDE). In CRYPTO 2014, LNCS, Vol. 8616, pp. 57â€“76.</li>

      <li>[2] K. Aoki and Y. Sasaki. Preimage attacks on One-block MD4, 63-step MD5 and more. In SAC 2008, LNCS, Vol. 5381, pp. 103â€“119.</li>

      <li>[3] S. Banik, A. Bogdanov and F. Regazzoni. Exploring Energy Efficiency of Lightweight Block Ciphers. To appear in proceedings of SAC 2015.</li>

      <li>[4] P. Barreto and V. Rijmen. The WHIRLPOOL Hash Function. Available at http://www.larc.usp.br/~pbarreto/WhirlpoolPage.html</li>

      <li>[5] L. Batina, A. Das, B. Ege, E. B. Kavun, N. Mentens, C. Paar, I. Verbauwhede, T. YalÃ§in. Dietary Recommendations for Lightweight Block Ciphers: Power, Energy and Area Analysis of Recently Developed Architectures. In RFIDSec 2013, LNCS, vol. 8262, pp. 103-112.</li>

      <li>[6] R. Beaulieu, D. Shors, J. Smith, S. Treatman-Clark, B. Weeks, L. Wingers. The SIMON and SPECK Families of Lightweight Block Ciphers. In IACR eprint archive. Available at https://eprint.iacr.org/2013/404.pdf.</li>

      <li>[7] G. Bertoni, J. Daemen, M. Peeters, G. V. Assche. The Keccak Reference. Available at http://keccak.noekeon.org/Keccak-reference-3.0.pdf.</li>

      <li>[8] G. Bertoni, M. Macchetti, L. Negri, P. Fragneto. Power-efficient ASIC synthesis of cryptographic S-boxes. In 14th ACM Great Lakes Symposium on VLSI, pp. 277-281. ACM (2004).</li>

      <li>[9] B. Bilgin, A. Bogdanov, M. Knezevic, F. Mendel, and Q. Wang. FIDES: Lightweight authenticated cipher with side-channel resistance for constrained hardware. In CHES 2013, LNCS, Vol. 8086, pp. 142â€“158.</li>

      <li>[10] A. Biryukov and I. Nikolic. Automatic Search for Related-Key Differential Characteristics in Byte-Oriented Block Ciphers: Application to AES, Camellia, Khazad and Others. In EUROCRYPT 2010, LNCS, Vol. 6110, pp. 322â€“344.</li>

      <li>[11] A. Bogdanov, D. Khovratovich, and C. Rechberger. Biclique Cryptanalysis of the full AES. In ASIACRYPT 2011, LNCS, Vol. 7073, pp. 344â€“371.</li>

      <li>[12] A. Bogdanov, L. Knudsen, G. Leander, C. Paar, A. Poschmann, M. Robshaw, Y. Seurin, C. Vikkelsoe. PRESENT: An Ultra-Lightweight Block Cipher. In CHES 2007, LNCS, vol. 4727, pp. 450-466.</li>

      <li>[13] J. Borghoff, A. Canteaut, T. GÃ¼neysu, E. B. Kavun, M. KneÅ¾eviÄ‡, L. R. Knudsen, G. Leander, V. Nikov, C. Paar, C. Rechberger, P. Rombouts, S. S. Thomsen, T. YalÃ§in. PRINCE - A Low-Latency Block Cipher for Pervasive Computing Applications - Extended Abstract. In Asiacrypt 2012, LNCS, vol. 7658, pages 208-225.</li>

    </ul>

    <ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">

      <li>C. De CanniÃ¨re, O. Dunkelman, M. KneÅ¾eviÄ‡. KATAN and KTANTAN - a family of small and efficient hardware-oriented block ciphers. In CHES 2009, LNCS, vol. 5747, pp. 272-288.</li>

      <li>D. Canright. A very compact S-Box for AES. In CHES 2005, LNCS, vol. 3659, pp. 441-455.</li>

      <li>J. Daemen, M. Peeters, G. V. Assche, V. Rijmen. Nessie Proposal: NOEKEON. Available at http://gro.noekeon.org/Noekeon-spec.pdf.</li>

      <li>J. Daemen, V. Rijmen. The design of Rijndael: AES - the Advanced Encryption Standard. Springer-Verlag.</li>

      <li>M. Feldhofer, J. Wolkerstorfer, V. Rijmen. AES Implementation on a Grain of Sand. In IEEE Proceedings of Information Security, vol. 152(1), pages 13-20, 2005.</li>

      <li>Z. Gong, S. Nikova, Y.W. Law. KLEIN: a new family of lightweight block ciphers. In RFIDSec 2011, LNCS, vol. 7055, pp. 1-18.</li>

      <li>J. Guo, T. Peyrin, A. Poschmann, M. J. B. Robshaw. The LED Block Cipher. In CHES 2011, LNCS, vol. 6917, pp. 326-341.</li>

      <li>T. Iwata, K. Minematsu, J. Guo, and S. Morioka. CLOC: Authenticated Encryption for Short Input. In FSE 2014, LNCS, vol. 8540, pp. 149â€“167.</li>

      <li>S. Kerckhof, F. Durvaux, C. Hocquet, D. Bol, F. X. Standaert. Towards Green Cryptography: a Comparison of Lightweight Ciphers from the Energy Viewpoint. In CHES 2012, LNCS, vol. 7428, pp. 390-407.</li>

      <li>K. Khoo, T. Peyrin, A. Poschmann, and H. Yap. FOAM: Searching for Hardware-Optimal SPN Structures and Components with a Fair Comparison. In CHES 2014, LNCS, Vol. 8731, pp. 433â€“450.</li>

      <li>V. Lallemand and M. Naya-Plasencia. Cryptanalysis of KLEIN. In FSE 2014, LNCS, vol. 8540, pp. 451â€“470.</li>

      <li>C.H. Lim and T. Korishhko. mCrypton - A Lightweight Block Cipher for Security of Low-Cost RFID Tags and Sensors. In WISA 2006, LNCS, vol. 3786, pp 243-258.</li>

      <li>M. Matsui. On Correlation Between the Order of S-boxes and the Strength of DES. In EUROCRYPT 1994, LNCS, vol. 950, pp. 366â€“375.</li>

      <li>S. Meng Sim, K. Khoo, F. Oggier, and T. Peyrin. Lightweight MDS Involution Matrices. To appear in FSE 2015.</li>

      <li>A. Moradi, A. Poschmann, S. Ling, C. Paar, H. Wang. Pushing the Limits: A Very Compact and a Threshold Implementation of AES. In Eurocrypt 2011, LNCS, vol. 6632, pp. 69-88.</li>

      <li>S. Morioka, A. Satoh. An Optimized S-Box Circuit Architecture for Low Power AES Design. In CHES 2002, LNCS, vol. 2523, pp. 172-186.</li>

      <li>Y. Sasaki and K. Aoki. Finding Preimages in Full MD5 Faster Than Exhaustive Search. In EUROCRYPT 2009, LNCS, vol. 5479, pp. 134-152.</li>

      <li>A. Satoh, S. Morioka, K. Takano, S. Munetoh. A Compact Rijndael Hardware Architecture with S-Box Optimization. In Asiacrypt 2001, LNCS, vol. 2248, pp. 239-254.</li>

      <li>K. Shibutani, T. Isobe, H. Hiwatari, A. Mitsuda, T. Akishita, T. Shirai. Piccolo: An Ultra-Lightweight Blockcipher. In CHES 2011, LNCS, vol. 6917, pp. 342-357.</li>

      <li>T. Shirai, K. Shibutani, T. Akishita, S. Moriai, T. Iwata. The 128-bit Block-cipher CLEFIA (Extended Abstract). In FSE 2007, LNCS, vol. 4593, pp. 181-195.</li>

      <li>T. Suzaki, K. Minematsu, S. Morioka, E. Kobayashi. TWINE: A Lightweight Block Cipher for Multiple Platforms. In SAC 2012, LNCS, vol. 7707, pp. 339-354.</li>

      <li>T. Suzaki, K. Minematsu. Improving the Generalized Feistel. In FSE 2010, LNCS, vol. 6147, pp. 19-39.</li>

    </ol>

    <ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">

      <li>S. Tillich, M. Feldhofer, and J. GroÃŸschÃ¤dl. Area, Delay, and Power Characteristics of Standard-Cell Implementations of the AES S-Box. In SAMOS 2006, LNCS, vol. 4017, pp. 457-466.</li>

    </ol>

    <p class="text-gray-300">Appendix A: Test Vectors</p>

    <p class="text-gray-300">A. Midori128</p>

    <ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">

      <li>Maintext : 00000000000000000000000000000000</li>

      <li>Key : 00000000000000000000000000000000</li>

      <li>Ciphertext : c055cbb95996d14902b60574d5e728d6</li>

    </ol>

    <ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">

      <li>Maintext : 51084ce6e73a5ca2ec87d7babc297543</li>

      <li>Key : 687ded3b3c85b3f35b1009863e2a8cbf</li>

      <li>Ciphertext : 1e0ac4fddff71b4c1801b73ee4afc83d</li>

    </ol>

    <p class="text-gray-300">B. Midori64</p>

    <ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">

      <li>Maintext : 0000000000000000</li>

      <li>Key : 00000000000000000000000000000000</li>

      <li>Ciphertext : 3c9cceda2bbd449a</li>

    </ol>

    <ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">

      <li>Maintext : 42c20fd3b586879e</li>

      <li>Key : 687ded3b3c85b3f35b1009863e2a8cbf</li>

      <li>Ciphertext : 66bcdc6270d901cd</li>

    </ol>`;
---

<BaseLayout title="Midori: A Block Cipher for Low Energy (Extended Version) (2015/1142)">
  <article class="max-w-4xl mx-auto article-prose">
    <nav class="mb-8">
      <a href="/papers" class="text-blue-400 hover:text-blue-300">
        &larr; Back to Papers
      </a>
    </nav>

    <header class="mb-12">
      <h1 class="text-3xl font-bold mb-4"
        set:html={TITLE_HTML} />
      <p class="text-gray-400 mb-2"
        set:html={AUTHORS_HTML} />
      <p class="text-gray-500 text-sm mb-4">
        2015 &middot; eprint 2015/1142
      </p>
      <div class="flex gap-4 text-sm">
        <a
          href={EPRINT_URL}
          target="_blank"
          rel="noopener noreferrer"
          class="text-blue-400 hover:text-blue-300"
        >
          Paper (eprint) &rarr;
        </a>
      </div>
      <p class="mt-4 text-xs text-gray-500">
        All content below belongs to the original authors. This page
        reproduces the paper for educational purposes. Always
        <a
          href={EPRINT_URL}
          target="_blank"
          rel="noopener noreferrer"
          class="text-blue-400 hover:text-blue-300"
        >cite the original</a>.
      </p>
      <p class="mt-1 text-xs text-gray-600">
        Converted with: {CRAWLER} &middot; {CONVERTED_DATE}
      </p>
    </header>

    <Fragment set:html={CONTENT} />

  </article>
</BaseLayout>
