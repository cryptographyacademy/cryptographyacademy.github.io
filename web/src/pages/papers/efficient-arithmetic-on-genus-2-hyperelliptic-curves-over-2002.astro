---
import BaseLayout from '../../layouts/BaseLayout.astro';
import PaperDisclaimer from '../../components/PaperDisclaimer.astro';
import PaperHistory from '../../components/PaperHistory.astro';

const EPRINT_URL = 'https://eprint.iacr.org/2002/121';
const CRAWLER = 'marker';
const CONVERTED_DATE = '2026-02-17';
const TITLE_HTML = 'Efficient Arithmetic on Genus 2 Hyperelliptic Curves over Finite Fields via Explicit Formulae';
const AUTHORS_HTML = 'Tanja Lange';

const CONTENT = `    <section id="abstract" class="mb-10">
      <h2 class="text-2xl font-bold">Abstract</h2>
      <p class="text-gray-300">We extend the explicit formulae for arithmetic on genus two curves of Takahashi and Miyamoto,Doi,Matsuo,Chao,and Tsuji to fields of even characteristic and to arbitrary equation of the curve and slightly improve them. These formulae can be evaluated faster than the more general Cantor algorithm and allow to obtain faster arithmetic on a hyperelliptic genus 2 curve than on elliptic curves. We give timings for implementations using various libraries for the field arithmetic.</p>
      <p class="text-gray-300"><strong>Keywords:</strong> elliptic curve cryptosystem &middot; implementation &middot; number theory &middot; hyperellitptic curve cryptosystem &middot; arithmetic &middot; explicit formulae</p>
    </section>

    <p class="text-gray-300">In this note we first give a short introduction to the mathematical background of hyperelliptic curves and present the standard algorithms to do arithmetic in the ideal class group. This is the group used in the computations to have an efficient way of computing and storing the elements. It is isomorphic to the Jacobian of the curve. Then we present the explicit formulae which are faster than the usual algorithms, along with the analysis of the number of operations and a proof for their correctness.</p>

    <p class="text-gray-300">So far, the fastest explicit formulae are given by Miyamoto, Doi, Matsuo, Chao, and Tsuji [13] and Takahashi [21], building upon the work of Harley [3], but applying to odd characteristic only. Here we give the generalization to even characteristic and to curves stated in the most general form, thus working for any finite field and any hyperelliptic curve given in Weierstra&szlig; representation. As to date the cited algorithms are only available in Japanese we provide a full description and explain the steps in detail.</p>

    <p class="text-gray-300">Before giving an outlook, we present some timings obtained using these formula. It turns out that the comparison between elliptic curves and hyperelliptic curves depends heavily on the chosen library &ndash; respectively on the relation of inversion and multiplication and the overhead of function calls. We used GMP and NTL for prime fields and a program of N&uml;ocker [15] for binary fields. The curves used for the reference implementations are appropriate for use in cryptography since the field size is of the correct order. As inversions are not too expensive in any arithmetic used, we choose affine representations for elliptic and hyperelliptic curves.</p>

    <p class="text-gray-300">After the publication of the first version of this paper it was brought to the authors attention that there exist a further work on even characteristic by Sugizaki, Matsuo, Chao, and Tsujii [20].</p>

    <p class="text-gray-300">In this section we briefly sketch what is needed in the remainder of this paper. As elliptic curves are hyperelliptic curves of genus 1 the results stated below apply to this case as well. The interested reader is referred to Menezes, Wu, and Zuccherato [12], Lorenzini [10], and Stichtenoth [19] for more details and proofs. Let  <span class="math">\\mathbb{F}_q</span>  be a finite field of characteristic  <span class="math">p, q = p^{\\nu}</span> , and let  <span class="math">\\overline{\\mathbb{F}}_q</span>  denote the algebraic closure of  <span class="math">\\mathbb{F}_q</span> .</p>

    <p class="text-gray-300"><strong>Definition 2.1</strong> Let  <span class="math">\\mathbb{F}_q(C)/\\mathbb{F}_q</span>  be a quadratic function field defined via an equation</p>

    <p class="text-gray-300"><span class="math">$C: y^2 + h(x)y = f(x) \\text{ in } \\mathbb{F}_q[x, y],</span>$
(1)</p>

    <p class="text-gray-300">where  <span class="math">f(x) \\in \\mathbb{F}_q[x]</span>  is a monic polynomial of degree 2g+1,  <span class="math">h(x) \\in \\mathbb{F}_q[x]</span>  is a polynomial of degree at most g, and there are no solutions  <span class="math">(a,b) \\in \\bar{\\mathbb{F}}_q \\times \\bar{\\mathbb{F}}_q</span>  which simultaneously satisfy the equation  <span class="math">b^2 + h(a)b = f(a)</span>  and the partial derivative equations 2b + h(a) = 0 and h'(a)b - f'(a) = 0. The curve  <span class="math">C/\\mathbb{F}_q</span>  associated to this function field is called a hyperelliptic curve of genus g defined over  <span class="math">\\mathbb{F}_q</span> .</p>

    <p class="text-gray-300">For odd characteristic it suffices to let h(x) = 0 and to have f squarefree to satisfy the last condition of the definition.</p>

    <p class="text-gray-300">For our purposes it is enough to consider a point as a tuple  <span class="math">(a,b) \\in \\overline{\\mathbb{F}}_q^2</span>  which satisfies  <span class="math">n^2 + h(a)b = f(a)</span> . Besides these tuples there is one point  <span class="math">\\infty</span>  at infinity. The hyperelliptic involution  <span class="math">\\iota</span>  maps (a,b) to (a,-b-h(a)) and leaves  <span class="math">\\infty</span>  fixed.</p>

    <p class="text-gray-300">A divisor D of C is an element of the free abelian group over the points of C, e.g.  <span class="math">D = \\sum_{P \\in C} n_P P</span>  with  <span class="math">n_P \\in \\mathbb{Z}</span>  and  <span class="math">n_P = 0</span>  for almost all points P. The degree of D is defined as  <span class="math">\\deg(D) = \\sum_{P \\in C} n_P</span> . To every element F of the function field we can associate a divisor via the valuations at all points of the curve  <span class="math">\\operatorname{div}(F) = \\sum_{P \\in C(\\bar{\\mathbb{F}}_q)} v_P(F)P</span> . These so called principal divisors are of degree zero and form a subgroup of the group of degree zero divisors. The quotient group is called the <em>divisor class group</em>. The function (x-a) leads to a divisor  <span class="math">P+\\iota P-2\\infty</span> . Hence, we can achieve that we represent a divisor class by a divisor  <span class="math">D = \\sum_{i=1}^r P_i - r\\infty</span> , where  <span class="math">P_i \\neq \\infty</span>  and  <span class="math">P_i \\neq \\iota P_j</span>  for  <span class="math">i \\neq j</span> . Furthermore one finds a representative with  <span class="math">r \\leq g</span>  for each class. Note that D defined over  <span class="math">\\mathbb{F}_q</span>  does not imply that each  <span class="math">P_i</span>  is defined over this field. If  <span class="math">P_i</span>  is defined over  <span class="math">\\mathbb{F}_q</span>  then all l conjugates of  <span class="math">P_i</span>  must also occur in D. Therefore l is bounded by g.</p>

    <p class="text-gray-300">The maximal ideals of  <span class="math">\\mathbb{F}_q[x,y]/(y^2+h(x)y-f(x))</span>  have a basis consisting of two polynomials and one can achieve that the first polynomial is in  <span class="math">\\mathbb{F}_q[x]</span> , whereas the second one is of the form  <span class="math">y-v(x),v(x)\\in\\mathbb{F}_q[x]</span> , since we reduce modulo a polynomial of degree 2 in y. Now consider the ideal class group, i.e. the ideals modulo the principal ideals. In Mumford [14][page 3.17] the following representation is introduced which makes explicit the correspondence of ideal classes and divisor classes:</p>

    <h4 id="sec-misc-1" class="text-lg font-semibold mt-6">Theorem 2.2 (Mumford Representation)</h4>

    <p class="text-gray-300">Let the function field be given via the absolutely irreducible polynomial  <span class="math">y^2 + h(x)y = f(x)</span> , where  <span class="math">h, f \\in \\mathbb{F}_q[x]</span> ,  <span class="math">\\deg f = 2g + 1</span> ,  <span class="math">\\deg h \\leq g</span> . Each nontrivial ideal class over  <span class="math">\\mathbb{F}_q</span>  can be represented via a unique ideal generated by u(x) and y - v(x),  <span class="math">u, v \\in \\mathbb{F}_q[x]</span> , where</p>

    <ul class="list-disc list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li><ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li>u is monic,</li>
    </ol></li>
      <li><ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li><span class="math">\\deg v &lt; \\deg u \\le g</span> ,</li>
    </ol></li>
      <li><ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li><span class="math">u|v^2 + vh f</span> .</li>
    </ol></li>
    </ul>

    <p class="text-gray-300">Let  <span class="math">D = \\sum_{i=1}^r P_i - r\\infty</span> , where  <span class="math">P_i \\neq \\infty</span> ,  <span class="math">P_i \\neq \\iota P_j</span>  for  <span class="math">i \\neq j</span>  and  <span class="math">r \\leq g</span> . Put  <span class="math">P_i = (a_i, b_i)</span> . Then the corresponding ideal class is represented by  <span class="math">u = \\prod_{i=1}^r (x - a_i)</span>  and if  <span class="math">P_i</span>  occurs  <span class="math">n_i</span>  times then  <span class="math">\\left(\\frac{d}{dt}\\right)^j \\left[v(x)^2 + v(x)h(x) - f(x)\\right]_{|_{x=a_i}} = 0</span> ,  <span class="math">0 \\leq j \\leq n_i - 1</span> .</p>

    <p class="text-gray-300">The second part of the theorem means that for all points  <span class="math">P_i = (a_i, b_i)</span>  occurring in the support of D we have  <span class="math">u(a_i) = 0</span>  and the third condition guarantees that  <span class="math">v(a_i) = b_i</span>  with appropriate multiplicity.</p>

    <p class="text-gray-300">For short we denote this ideal by [u, v]. The inverse of a class is represented by [u, -h - v], where the second polynomial is understood modulo u if necessary. The ideal class group over  <span class="math">\\mathbb{F}_q</span>  is denoted by  <span class="math">\\mathrm{Cl}(C/\\mathbb{F}_q)</span> . The zero element of of  <span class="math">\\mathrm{Cl}(C/\\mathbb{F}_q)</span>  is represented by [1, 0].</p>

    <section id="sec-3" class="mb-10">
      <h2 class="text-2xl font-bold">3 Arithmetic using Cantor's Algorithm</h2>

    <p class="text-gray-300">In this section we consider the group operation. Here we still deal with general hyperelliptic curves, i. e. curves of arbitrary genus. Addition of divisor classes means multiplication of ideal classes, which consists in a composition of the ideals and a first reduction to a basis of two polynomials. The output of this algorithm is said to be semi-reduced. Then we need a second algorithm, which is usually called reduction, to find the unique representative in the class referred to above. Such an ideal is called <em>reduced</em>. Due to the work of Cantor [2] (for odd characteristic only) and Koblitz [4] one has an efficient algorithm to perform these operation, which uses only polynomial arithmetic over the finite field in which the ideal classes are defined.</p>

    <h3 id="sec-misc-2" class="text-xl font-semibold mt-8">Algorithm 3.1 (Composition)</h3>

    <pre><code class="language-text">\\begin{split} \\text{INPUT:} \\quad D_1 &amp;= [u_1, v_1], D_2 = [u_2, v_2], \\\\ \\quad C &amp;: y^2 + h(x)y = f(x). \\\\ \\text{OUTPUT:} D &amp;= [u, v] \\text{ } semi-reduced \\text{ } with \\text{ } D \\equiv D_1D_2. \\end{split}
</code></pre>

    <ul class="list-disc list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li><ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li>compute  <span class="math">d_1 = \\gcd(u_1, u_2) = e_1u_1 + e_2u_2</span> ;</li>
    </ol></li>
      <li><ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li>compute  <span class="math">d = \\gcd(d_1, v_1 + v_2 + h) = c_1d_1 + c_2(v_1 + v_2 + h)</span> ;</li>
    </ol></li>
    </ul>

    <ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li><p class="text-gray-300">let
<span class="math">$s_1 = c_1e_1</span>$
,  <span class="math">s_2 = c_1e_2</span> ,  <span class="math">s_3 = c_2</span> ; /* i.e.  <span class="math">d = s_1u_1 + s_2u_2 + s_3(v_1 + v_2 + h)</span> */</p></li>
      <li><p class="text-gray-300"><span class="math">$u = \\frac{u_1 u_2}{d^2}</span>$
;
<span class="math">v = \\frac{s_1 u_1 v_2 + s_2 u_2 v_1 + s_3 (v_1 v_2 + f)}{d} \\mod u</span> .</p></li>
    </ol>

    <h4 id="sec-misc-3" class="text-lg font-semibold mt-6">Algorithm 3.2 (Reduction)</h4>

    <p class="text-gray-300"><span class="math">$\\begin{split} \\text{INPUT:} \\quad D &amp;= [u,v] \\ \\textit{semi-reduced}. \\\\ \\text{OUTPUT:} \\quad D&#x27; &amp;= [u&#x27;,v&#x27;] \\ \\textit{reduced with} \\ D \\equiv D&#x27;. \\end{split}</span>$</p>

    <ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li><span class="math">$let u&#x27; = \\frac{f - vh - v^2}{u}, v&#x27; = (-h - v) \\mod u&#x27;;</span>$</li>
    </ol>

    <ul class="list-disc list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li><ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li>if  <span class="math">\\deg u&#x27; &gt; g</span>  put u = u', v = v'; goto step 1;</li>
    </ol></li>
      <li><ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li>make u' monic.</li>
    </ol></li>
    </ul>

    <p class="text-gray-300">This algorithm provides a universal way of doing arithmetic in  <span class="math">Cl(\\mathbb{F}_q)</span>  which applies to any genus and characteristic. However, in a straightforward implementation several unneeded coefficients are computed. Therefore a careful study making the steps explicit is necessary. We deal with this in the following section.</p>

    <p class="text-gray-300">The first attempt to avoid using Cantor's algorithm for faster arithmetic and deriving explicit formulae was made by Spallek [18] for genus two and odd characteristic. Harley [3] takes a slightly different approach to optimize the running time. This approach was generalized to even characteristic by Lange [7].</p>

    <p class="text-gray-300">Building on the work of Matsuo, Chao, and Tsujii [11], recently Miyamoto, Doi, Matsuo, Chao, and Tsujii [13] and Takahashi [21] obtained an even larger speed-up using Montgomery's trick to reduce the number of inversions to 1. We generalize the setting in order to deal with even characteristic as well. To do so, we first give the case study of [7] investigating what can be the input of the combination algorithm and proceed in considering these different cases. We determine the exact number of operations needed to perform addition and doubling in the most common cases.</p>

    <p class="text-gray-300">Unless stated otherwise the formulae hold independently of the characteristic, therefore we take care of the signs; in characteristic two, 2y is understood as zero.</p>

      <h3 id="sec-4.1" class="text-xl font-semibold mt-8">4.1 Different Cases</h3>

    <p class="text-gray-300">Consider the composition step of Cantors Algorithm 3.1. The input are two classes represented by two polynomials  <span class="math">[u_i, v_i]</span>  each. As we consider curves of genus two the following holds by Theorem 2.2:</p>

    <ul class="list-disc list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li><ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li>u is monic,</li>
    </ol></li>
      <li><span class="math">2. \\, \\deg v &lt; \\deg u \\le 2,</span></li>
      <li><ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li><span class="math">u|v^2 + vh f^2</span> .</li>
    </ol></li>
    </ul>

    <p class="text-gray-300">Without loss of generality let  <span class="math">\\deg u_1 \\leq \\deg u_2</span> .</p>

    <ul class="list-disc list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li><ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li><span class="math">u_1</span>  is of degree zero, this is only possible in the case  <span class="math">[u_1, v_1] = [1, 0]</span> , i.e. for the zero element. The result of the combination and reduction is the second class  <span class="math">[u_2, v_2]</span> .</li>
    </ol></li>
      <li><ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li>If  <span class="math">u_1</span>  is of degree one, then either  <span class="math">u_2</span>  is of degree one as well or it has full degree.</li>
    </ol>

    <ul class="list-disc list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li>(a) Assume deg  <span class="math">u_2 = 1</span> , i. e.  <span class="math">u_i = x + u_{i0}</span>  and the  <span class="math">v_i</span>  are constant. Then if  <span class="math">u_1 = u_2</span>  we obtain for  <span class="math">v_1 = -v_2 h(-u_{10})</span>  the zero element [1,0] and for  <span class="math">v_1 = v_2</span>  we double the divisor to obtain</li>
    </ul></li>
    </ul>

    <p class="text-gray-300"><span class="math">$u = u_1^2,</span>$</p>

    <p class="text-gray-300"><span class="math">$v = ((f&#x27;(-u_{10}) - v_1 h&#x27;(-u_{10}))x + (f&#x27;(-u_{10}) - v_1 h&#x27;(-u_{10}))u_{10})/(2v_1 + h(-u_{10})) + v_1.</span>$
(2)</p>

    <p class="text-gray-300">Otherwise the composition leads to  <span class="math">u = u_1u_2</span>  and  <span class="math">v = ((v_2 - v_1)x + v_2u_{10} - v_1u_{20})/(u_{10} - u_{20})</span> .</p>

    <p class="text-gray-300">In all cases the results are already reduced.</p>

    <ul class="list-disc list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li>(b) Now let the second polynomial be of degree two,  <span class="math">u_2 = x^2 + u_{21}x + u_{20}</span> . Then the corresponding divisors are given by  <span class="math">D_1 = P_1 \\infty</span>  and  <span class="math">D_2 = P_2 + P_3 2\\infty</span> ,  <span class="math">P_i \\neq \\infty</span> .    <ul class="list-disc list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li>i. If  <span class="math">u_2(-u_{10}) \\neq 0</span>  then  <span class="math">P_1</span>  and  <span class="math">-P_1</span>  do not occur in  <span class="math">D_2</span> . This case will be dealt with below in Subsection 4.2.2.</li>
      <li>ii. Otherwise if  <span class="math">v_2(-u_{10}) = v_1 + h(-u_{10})</span>  then  <span class="math">-P_1</span>  occurs in  <span class="math">D_2</span>  and the resulting class is given by  <span class="math">u = x + u_{21} u_{10}</span>  and  <span class="math">v = v_2(-u_{21} + u_{10})</span>  as  <span class="math">-u_{21}</span>  equals the sum of the x-coordinates of the points.</li>
    </ul></li>
    </ul>

    <p class="text-gray-300">Otherwise one first doubles  <span class="math">[u_1, v_1]</span>  by (2) and then adds  <span class="math">[x + u_{21} - u_{10}, v_2(-u_{21} + u_{10})]</span> , hence, reduces the problem to the case 2(b)i, unless  <span class="math">D_2 = 2P_1 - 2\\infty</span>  where one first doubles  <span class="math">D_2</span>  as in 3(a)ii and then subtracts  <span class="math">D_1</span>  using 2(b)i.</p>

    <ul class="list-disc list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li><ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li>Let  <span class="math">\\deg u_1 = \\deg u_2 = 2</span> .</li>
    </ol>

    <ul class="list-disc list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li>(a) Let first  <span class="math">u_1 = u_2</span> . This means that for an appropriate ordering  <span class="math">D_1 = P_1 + P_2 2\\infty</span> ,  <span class="math">D_2 = P_3 + P_4 2\\infty</span>  the x-coordinates of  <span class="math">P_i</span>  and  <span class="math">P_{i+2}</span>  are equal.    <ul class="list-disc list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li>i. If  <span class="math">v_1 \\equiv -v_2 h \\mod u_1</span>  then the result is [1, 0].</li>
      <li>ii. If  <span class="math">v_1 = v_2</span>  then we are in the case in which we double a class of order different from two and with first polynomial of full degree. Again we need to consider two sub-cases:</li>
    </ul></li>
    </ul></li>
    </ul>

    <p class="text-gray-300">If  <span class="math">D_1 = P_1 + P_2 - 2\\infty</span>  where  <span class="math">P_1</span>  is equal to its opposite, then the result is  <span class="math">2P_2</span>  and can be computed like above.  <span class="math">P_1 = (x_{P_1}, y_{P_1})</span>  is equal to its opposite, iff  <span class="math">h(x_{P_1}) = -2y_{P_1}</span> . To check for this case we compute the resultant of  <span class="math">h + 2v_1</span>  and  <span class="math">u_1</span> .</p>

    <ul class="list-disc list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li><p class="text-gray-300">A. If  <span class="math">res(h + 2v_1, u_1) \\neq 0</span>  then we are in the usual case where both points are not equal to their opposite. This will be considered in Subsection 4.2.3.</p></li>
      <li><p class="text-gray-300">B. Otherwise we compute the  <span class="math">gcd(h + 2v_1, u_1) = (x x_{P_1})</span>  to get the coordinate of  <span class="math">P_1</span>  and double  <span class="math">[x + u_{11} + x_{P_1}, v_1(-u_{11} x_{P_1})]</span> .</p></li>
      <li><p class="text-gray-300">iii. Now we know that without loss of generality  <span class="math">P_1 = P_3</span>  and  <span class="math">P_2 \\neq P_4</span>  is the opposite of  <span class="math">P_4</span> . Let  <span class="math">v_i = v_{i1}x + v_{i0}</span> , then the result  <span class="math">2P_1</span>  is obtained by doubling  <span class="math">[x (v_{10} v_{20})/(v_{21} v_{11}), v_1((v_{10} v_{20})/(v_{21} v_{11}))]</span>  using (2).</p></li>
      <li><p class="text-gray-300">(b) For the remaining case  <span class="math">u_1 \\neq u_2</span> , we need to consider the following possibilities.</p>

    <ul class="list-disc list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li>i. If  <span class="math">res(u_1, u_2) \\neq 0</span>  then no point of  <span class="math">D_1</span>  is equal to a point or its opposite in  <span class="math">D_2</span> . This is the most frequent case. We deal with it in Subsection 4.2.1.</li>
      <li>ii. If the above resultant is zero then  <span class="math">gcd(u_1, u_2) = x x_{P_1}</span>  and we know that either  <span class="math">D_1 = P_1 + P_2 2\\infty</span> ,  <span class="math">D_2 = P_1 + P_3 2\\infty</span>  or  <span class="math">D_2</span>  contains the opposite of  <span class="math">P_1</span>  instead. This can be checked by inserting  <span class="math">x_{P_1}</span>  in both  <span class="math">v_1</span>  and  <span class="math">v_2</span> .    <ul class="list-disc list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li>A. If the results are equal then we are in the first case and proceed by computing  <span class="math">D&#x27; = 2(P_1 \\infty)</span> , then  <span class="math">D&#x27;&#x27; = D&#x27; + P_2 \\infty</span>  and finally  <span class="math">D = D&#x27;&#x27; + P_3 \\infty</span>  by the formulae in 2. We extract the coordinates of  <span class="math">P_2</span>  and  <span class="math">P_3</span>  by  <span class="math">P_2 = (-u_{11} + x_{P_1}, v_1(-u_{11} + x_{P_1})), P_3 = (-u_{21} + x_{P_1}, v_2(-u_{21} + x_{P_1}))</span> .</li>
      <li>B. In case  <span class="math">v_1(x_{P_1}) \\neq v_2(x_{P_1})</span>  the result is  <span class="math">P_2 + P_3 2\\infty</span> .</li>
    </ul></li>
    </ul></li>
    </ul>

    <p class="text-gray-300">If one uses the resultant as recommended in 3(a)ii and 3(b)i then one needs to compute a greatest common divisor as well, to extract the coordinates of  <span class="math">P_1</span>  when needed. However, most frequently we are in the case of resultant nonzero and thus we save on average.</p>

      <h3 id="sec-4.2" class="text-xl font-semibold mt-8">4.2 Addition and Doubling</h3>

    <p class="text-gray-300">We now present in detail the algorithms for the most common cases. Put  <span class="math">f(x) = x^5 + \\sum_{i=0}^4 f_i x^i</span> ,  <span class="math">h(x) = \\sum_{i=0}^2 h_i x^i</span> . For the complexity estimates we always assume  <span class="math">h_2 \\in \\{0,1\\}</span> . For nonzero  <span class="math">h_2</span>  this can be achieved by substituting  <span class="math">y = h_2^5 y&#x27;, x = h_2^2 x&#x27;</span>  and dividing the resulting equation by  <span class="math">h_2^{10}</span> . If one does not want to transform some computations should be performed differently (like  <span class="math">s_0(s_0 + h_2)</span>  instead of  <span class="math">s_0^2 + s_0 h_2</span> ). Similarly we assume  <span class="math">f_4 = 0</span> , as this can be derived for  <span class="math">p \\neq 5</span>  by the substitution  <span class="math">x&#x27; = (x - f_4/5)</span> , and include this coefficient only for completeness. Furthermore we assume  <span class="math">h_1 \\in \\{0,1\\}</span> . We would like to stress that the formulae remain correct for other values, one simply has to allow some more operations.</p>

      <h4 id="sec-4.2.1" class="text-lg font-semibold mt-6">4.2.1 Addition in Most Common Case</h4>

    <p class="text-gray-300">In this case the two divisor classes to be combined consist of four points different from each other and from each other's negative. The results of the composition Algorithm 3.1 are  <span class="math">u_1u_2</span>  and a polynomial v of degree  <span class="math">\\leq 3</span>  satisfying  <span class="math">u|v^2+vh-f</span>  (see Theorem 2.2). As we started with  <span class="math">u_i|v_i^2+v_ih-f</span>  we can obtain v using Chinese remaindering:</p>

    <p class="text-gray-300"><span class="math">$v \\equiv v_1 \\bmod u_1,</span>$</p>

    <p class="text-gray-300"><span class="math">$v \\equiv v_2 \\bmod u_2.</span>$
(3)</p>

    <p class="text-gray-300">Then we compute the resulting first polynomial u' by making  <span class="math">(f - vh - h^2)/(u_1u_2)</span>  monic and taking  <span class="math">v&#x27; = (-h - v \\mod u&#x27;)</span> .</p>

    <p class="text-gray-300">To optimize the computations we do not follow this literally. We now list the needed subexpressions and then show that in fact we obtain the desired result.</p>

    <p class="text-gray-300"><span class="math">$k = (f - v_2h - v_2^2)/u_2</span>$</p>

    <p class="text-gray-300"><span class="math">$s \\equiv (v_1 - v_2)/u_2 \\mod u_1</span>$</p>

    <p class="text-gray-300"><span class="math">$l = s \\cdot u_2</span>$</p>

    <p class="text-gray-300"><span class="math">$u = (k - s(l + h + 2v_2))/u_1</span>$</p>

    <p class="text-gray-300"><span class="math">$u&#x27; = u \\text{ made monic}</span>$</p>

    <p class="text-gray-300"><span class="math">$v&#x27; \\equiv -h - (l + v_2) \\mod u&#x27;</span>$</p>

    <p class="text-gray-300">The divisions made to get k and u are exact divisions due to the definition of the polynomials. Let us first verify that  <span class="math">v = l + v_2 = s \\cdot u_2 + v_2</span>  satisfies the system of equations (3). This is obvious for the second</p>

    <p class="text-gray-300">equation. For the first one we consider  <span class="math">v \\equiv s \\cdot u_2 + v_2 \\equiv ((v_1 - v_2)/u_2)u_2 + v_2 \\equiv v_1 \\mod u_1</span> . Now we check that  <span class="math">u = (f - vh - v^2)/(u_1u_2)</span>  by expanding out</p>

    <p class="text-gray-300"><span class="math">$u_1 \\cdot u_2 \\cdot u = u_2(k - s(l + h + 2v_2)) = f - v_2h - v_2^2 - l(l + h) - 2lv_2 = f - vh - v^2.</span>$</p>

    <p class="text-gray-300">In the course of computing we do not need all coefficients of the polynomials defined above. As  <span class="math">f = x^5 + \\sum_{i=0}^4 f_i x^i</span>  is monic and of degree 5,  <span class="math">u_2</span>  is monic of degree 2,  <span class="math">\\deg h \\leq 2</span> , and  <span class="math">\\deg v_2 = 1</span>  we have that  <span class="math">k = x^3 + (f_4 - u_{21})x^2 + cx + c&#x27;</span> , where c, c' are some constants. In the computation of u we divide an expression involving k by a polynomial of degree 2, thus we only need the above known part of k. In the computation of a product of polynomials we use the following Karatsuba style formula to save one multiplication:</p>

    <p class="text-gray-300"><span class="math">$(ax + b)(cx + d) = acx^{2} + ((a + b)(c + d) - ac - bd)x + bd.</span>$</p>

    <p class="text-gray-300">To reduce a polynomial of degree 3 modulo a monic one of degree 2 we use</p>

    <p class="text-gray-300"><span class="math">$ax^3 + bx^2 + cx + d \\equiv (c - (i+j)(a + (b-ia)) + ia + j(b-ia))x + d - j(b-ia) \\mod x^2 + ix + j</span>$</p>

    <p class="text-gray-300">using only 3 multiplications instead of four. Furthermore we use an almost inverse in the computation of s and compute rs instead, where r is the resultant of  <span class="math">u_1</span>  and  <span class="math">u_2</span> , postponing and combining the inversion of r with that of s.</p>

    <p class="text-gray-300">In the following Table 1 we list the intermediate steps together with the number of multiplications (M), squarings (S) and inversions (I) needed. As we assume  <span class="math">h_2, h_1, f_4 \\in \\{0, 1\\}</span>  we do not count multiplications by these coefficients. In the case study we have already computed the resultant of  <span class="math">u_1</span>  and  <span class="math">u_2</span>  when we arrive at this algorithm. Hence, we can assume that  <span class="math">\\tilde{u}_2 = u_2 \\mod u_1</span>  and  <span class="math">\\operatorname{res}(\\tilde{u}_2, u_1)</span>  are known. However, we include the costs in the table, as we use these expressions to compute  <span class="math">1/\\tilde{u}_2 \\mod u_1</span> .</p>

    <p class="text-gray-300"><strong>Remark:</strong> Note, that if we assume that our field is represented via a normal basis and work in characteristic two, the squarings are virtually for free and using a polynomial basis they still are by far cheaper than multiplications. Furthermore, for even characteristic one can save one multiplications as  <span class="math">(h_1+2v_1)w_4 = h_1w_4</span> .</p>

      <h4 id="sec-4.2.2" class="text-lg font-semibold mt-6"><strong>4.2.2</strong> Addition in Case <span class="math">\\deg u_1 = 1</span> , <span class="math">\\deg u_2 = 2</span></h4>

    <p class="text-gray-300">By the above considerations we can assume that for  <span class="math">u_1 = x + u_{10}</span>  we have that  <span class="math">u_2(-u_{10}) \\neq 0</span> . In principle we follow the same algorithm as stated in the previous subsection. But to obtain u we divide by a polynomial of degree one, therefore we need an additional coefficient of k and save a lot in the other operations. Table 2 shows that this case is much cheaper than the general one, however it is not too likely to happen like all special cases.</p>

      <h4 id="sec-4.2.3" class="text-lg font-semibold mt-6">4.2.3 Doubling</h4>

    <p class="text-gray-300">The above case study left open how one computes the double of a class where the first polynomial has degree two and both points of the representing divisor are not equal to their opposite. Put  <span class="math">u = x^2 + u_1x + u_0</span> ,  <span class="math">v = v_1x + v_0</span> . Combining [u, v] with itself should result in a class  <span class="math">[u_{\\text{new}}, v_{\\text{new}}]</span> , where</p>

    <p class="text-gray-300"><span class="math">$u_{\\text{new}} = u^{2},</span>$</p>

    <p class="text-gray-300"><span class="math">$v_{\\text{new}} \\equiv v \\mod u,</span>$</p>

    <p class="text-gray-300"><span class="math">$u_{\\text{new}} \\mid v_{\\text{new}}^{2} + v_{\\text{new}}h - f.</span>$
(4)</p>

    <p class="text-gray-300">Then this class is reduced to obtain [u', v']. We use the following subexpressions:</p>

    <p class="text-gray-300"><span class="math">$k = (f - hv - v^{2})/u</span>$</p>

    <p class="text-gray-300"><span class="math">$s \\equiv k/(h + 2v) \\mod u</span>$</p>

    <p class="text-gray-300"><span class="math">$l = su</span>$</p>

    <p class="text-gray-300"><span class="math">$u_{1} = s^{2} - ((h + 2v)s - k)/u</span>$</p>

    <p class="text-gray-300"><span class="math">$u&#x27; = u_{1} \\text{ made monic}</span>$</p>

    <p class="text-gray-300"><span class="math">$v&#x27; \\equiv -h - (l + v) \\mod u&#x27;</span>$</p>

    <p class="text-gray-300">Table 1: Addition,  <span class="math">\\deg u_1 = \\deg u_2 = 2</span></p>

    <div class="overflow-x-auto my-4">
      <table class="min-w-full text-sm text-gray-300">
        <thead>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">Innut</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">Table 1: Addition, <span class="math">\\deg u_1 - \\deg u_2 - 2</span></th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"></th>
        </thead>
        <tbody>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Input</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">[u_1, v_1], [u_2, v_2], \\deg u_1 = \\deg u_2 = 2</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">u_i = x^2 + u_{i1}x + u_{i0}, v_i = v_{i1}x + v_{i0}</span><br><span class="math">h = h_2x^2 + h_1x + h_0, f = x^5 + f_4x^4 + f_3x^3 + f_2x^2 + f_1x + f_0</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Output</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Output</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">[u&#x27;,v&#x27;] = [u_1,v_1] + [u_2,v_2]</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">T .</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Step</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Expression</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Operations</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">compute resultant <span class="math">r</span> of <span class="math">u_1, u_2</span> :</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1S, 3M</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">z_1 = u_{11} - u_{21}, z_2 = u_{20} - u_{10}, z_3 = u_{11}z_1 + z_2;</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">r = z_2 z_3 + z_1^2 u_{10};</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">2</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">compute almost inverse of <span class="math">u_2</span> modulo <span class="math">u_1</span> ( <span class="math">inv = r/u_2 \\mod u_1</span> ):</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">inv_1 = z_1, inv_0 = z_3;</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">3</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">compute <span class="math">s&#x27; = rs \\equiv (v_1 - v_2)inv \\mod u_1</span> :</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">5M</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">\\overline{w_0 = v_{10} - v_{20}}, \\ w_1 = v_{11} - v_{21}, \\ w_2 = inv_0w_0, \\ w_3 = inv_1w_1;</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">s&#x27;_1 = (inv_0 + inv_1)(w_0 + w_1) - w_2 - w_3(1 + u_{11}), \\ s&#x27;_0 = w_2 - u_{10}w_3;</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">If <span class="math">s_1 = 0</span> see below</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">4</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">compute <span class="math">s&#x27;&#x27; = x + s_0/s_1 = x + s_0&#x27;/s_1&#x27;</span> and <span class="math">s_1</span> :</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">I, 2S, 5M</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">\\overline{w_1 = (rs&#x27;_1)^{-1}(=1/r^2s_1)}, \\ w_2 = rw_1(=1/s&#x27;_1), \\ w_3 = {s&#x27;}_1^2w_1(=s_1);</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">, -, -</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">w_1 = (rs_1)  (= 1/r \\ s_1), \\ w_2 = rw_1(= 1/s_1), \\ w_3 = s_1w_1(= s_1), \\ w_4 = rw_2(= 1/s_1), \\ w_5 = w_4^2;</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">5</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">s_0&#x27;&#x27; = s_0&#x27; w_2;</span> compute <span class="math">l&#x27; = s&#x27;&#x27; u_2 = x^3 + l_2&#x27; x^2 + l_1&#x27; x + l_0&#x27;</span> :</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">2M</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">9</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">\\frac{\\text{compute } i - s \\ u_2 - x + i_2 x + i_1 x + i_0}{t&#x27; + u_1 x + u_2 x + u_2 x + u_3 x + u_4 x + u_5}</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">2101</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">C</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">$ \\frac{l'<em>2 = u</em>{21} + s''<em>0, \\ l'_1 = u</em>{21}s''<em>0 + u</em>{20}, \\ l'<em>0 = u</em>{20}s''_0}{\\text{compute } u' = (s(l+h+2v_2)-k)/u_1 = x^2 + u'_1x + u'_0:} $</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">21/1</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">6</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">compute <span class="math">u = (s(t + n + 2v_2) - k)/u_1 = x^2 + u_1x + u_0</span> :</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">3M</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">\\overline{u_0&#x27; = (s_0&#x27;&#x27; - u_{11})(s_0&#x27;&#x27; - z_1 + h_2 w_4) - u_{10} + l_1&#x27; + (h_1 + 2v_{21})w_4 + (2u_{21} + z_1 - f_4)w_5};</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">u_1&#x27; = 2s_0&#x27;&#x27; - z_1 + h_2 w_4 - w_5;</span> compute <span class="math">v&#x27; \\equiv -h - (l + v_2) \\mod u&#x27; = v_1&#x27; x + v_0&#x27;</span> :</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">13.5</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">7</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">compute <span class="math">v&#x27; \\equiv -h - (l + v_2) \\mod u&#x27; = v_1&#x27; x + v_0&#x27;</span> :</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">4M</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">\\overline{w_1 = l_2&#x27; - u_1&#x27;}, \\ w_2 = u_1&#x27;w_1 + u_0&#x27; - l_1&#x27;;</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">v_1&#x27; = w_2 w_3 - v_{21} - h_1 + h_2 u_1&#x27;;</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">w_2 = u_0&#x27; w_1 - l_0&#x27;;</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">v_0&#x27; = w_2 w_3 - v_{20} - h_0 + h_2 u_0&#x27;;</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">total</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">I, 3S, 22M</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Special case <span class="math">s = s_0</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><u> </u></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">4'</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">compute <span class="math">s</span> :</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">I, M</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">r</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">\\frac{\\text{compute } s.}{inv = 1/r, s_0 = s_0&#x27; inv;}</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1, 1/1</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">5'</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">compute <span class="math">u&#x27; = (k - s(l + h + 2v_2))/u_1 = x + u&#x27;_0</span> :</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">S</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">9</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">\\frac{compute \\ u - (n - 3(t + n + 2v_2))/(u_1 - x + u_0)}{v&#x27;_1 - t}</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">5</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">c;</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">u&#x27;_0 = f_4 - u_{21} - u_{11} - s_0^2 - s_0 h_2;</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">03.4</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">6'</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">compute <span class="math">v&#x27; \\equiv -h - (l + v_2) \\mod u&#x27; = v&#x27;_0</span> :</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">2M</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">\\overline{w_1} = s_0(u_{21} + u_0&#x27;) + h_1 + v_{21} + h_2u_0&#x27;, \\ \\overline{w_2} = s_0 + v_{20} + h_0;</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">v_0&#x27; = u_0&#x27; w_1 - w_2;</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">total</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">I, 2S, 11M</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><u> </u></td>
          </tr>
        </tbody>
      </table>
    </div>

    <p class="text-gray-300">Input</p>

    <div class="overflow-x-auto my-4">
      <table class="min-w-full text-sm text-gray-300">
        <thead>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"></th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">Table 2: <b>Addition,</b> <span class="math">\\deg u_1 = 1, \\deg u_2 = 2</span></th>
        </thead>
        <tbody>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">,</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">[u_1, v_1], [u_2, v_2], \\deg u_1 = 1, \\deg u_2 = 2</span></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">u_1 = x + u_{10}, u_2 = x^2 + u_{21}x + u_{20}, v_1 = v_{10}, v_2 = v_{21}x + v_{20}</span></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">h = h_2 x^2 + h_1 x + h_0, f = x^5 + f_4 x^4 + f_3 x^3 + f_2 x^2 + f_1 x + f_0</span></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
        </tbody>
      </table>
    </div>

    <div class="overflow-x-auto my-4">
      <table class="min-w-full text-sm text-gray-300">
        <thead>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">Step</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">Expression</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">Operations</th>
        </thead>
        <tbody>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">compute <span class="math">r \\equiv u_2 \\mod u_1</span> :</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">M</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">\\overline{r} = u_{20} - (u_{21} - u_{10})u_{10};</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">2</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">compute inverse of <span class="math">u_2</span> modulo <span class="math">u_1</span> :</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">I</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">inv = 1/r</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">3</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">compute <span class="math">s = (v_1 - v_2)inv \\mod u_1</span> :</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">2M</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">s_0 = inv(v_{10} - v_{20} - v_{21}u_{10});</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">4</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">compute <span class="math">l = s \\cdot u_2 = s_0 x^2 + l_1 x + l_0</span> :</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">2M</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">l_1 = s_0 u_{21}, \\ l_0 = s_0 u_{20};</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">5</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">compute <span class="math">k = (f - v_2h - v_2^2)/u_2 = x^3 + k_2x^2 + k_1x + k_0</span> :</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">M</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">k_2 = f_4 - u_{21}, k_1 = f_3 - (f_4 - u_{21})u_{21} - v_{21}h_2 - u_{20};</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">6</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">compute <span class="math">u&#x27; = (k - s(l + h + 2v_2))/u_1 = x^2 + u&#x27;_1 x + u&#x27;_0</span> :</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">S,2M</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">u_1&#x27; = k_2 - s_0^2 - s_0 h_2 - u_{10};</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">u_0&#x27; = k_1 - s_0(l_1 + h_1 + 2v_{21}) - u_{10}u_1&#x27;;</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">7</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">compute <span class="math">v&#x27; \\equiv -h - (l + v_2) \\mod u&#x27; = v&#x27;_1 x + v&#x27;_0</span> :</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">2M</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">\\overline{v_1&#x27; = (h_2 + s_0)u_1&#x27; - (h_1 + l_1 + v_{21});}</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">v_0&#x27; = (h_2 + s_0)u_0&#x27; - (h_0 + l_0 + v_{20});</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">total</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">I, S, 10 M</td>
          </tr>
        </tbody>
      </table>
    </div>

    <p class="text-gray-300">Note that like above we do not compute the semi-reduced divisor explicitly, here  <span class="math">v_{\\text{new}} = su + v</span> . Hence, we see that (4) holds. To prove (5) we consider</p>

    <p class="text-gray-300"><span class="math">$v_{\\text{new}}^2 + v_{\\text{new}}h - f \\equiv l^2 + 2lv + v^2 + hl + hv - f = s^2u^2 + u(s(h+2v) - k)</span>$</p>

    <p class="text-gray-300">and</p>

    <p class="text-gray-300"><span class="math">$(h+2v)s - k \\equiv (h+2v)k/(h+2v) - k \\equiv 0 \\bmod u.</span>$</p>

    <p class="text-gray-300">Finally, one finds by</p>

    <p class="text-gray-300"><span class="math">$(v_{\\text{new}}^2 + v_{\\text{new}}h - f)/u_{\\text{new}} = (s^2u^2 + (h+2v)su - ku)/u^2</span>$</p>

    <p class="text-gray-300">that  <span class="math">u_1</span>  is in fact obtained as described in the reduction algorithm.</p>

    <p class="text-gray-300">Table 3 lists the numbers of elementary operations needed in the following table. Unlike in the addition case we now need the exact polynomial k to compute d. We include the costs to compute  <span class="math">\\operatorname{res}(\\tilde{h}, u)</span>  and assume  <span class="math">h_2, h_1, f_4 \\in \\{0, 1\\}.</span></p>

    <h4 id="sec-misc-4" class="text-lg font-semibold mt-6">Remarks:</h4>

    <ul class="list-disc list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li><ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li>Concerning the counting in Step 2 a remark is in order. Unless the characteristic is odd and  <span class="math">h \\neq 0</span> , the computation of  <span class="math">v_1^2, u_1^2</span>  and  <span class="math">\\tilde{v}_1^2</span>  needs only 2 squarings instead of the obvious 3. (In detail: if for odd characteristic h = 0 then  <span class="math">\\tilde{v}_1^2 = 4v_1^2</span> . If p = 2 then  <span class="math">\\tilde{v}_1^2 = h_2^2 u_1^2 + h_1^2 = h_2^2 w_1 + h_1^2</span>  and  <span class="math">h_2, h_1 \\in \\{0, 1\\}</span> . These details can be fixed for an actual implementation.)</li>
    </ol></li>
      <li><ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li>In characteristic 2 one can reduce the number of multiplications by 2 as in Step 1  <span class="math">w_3 = h_2 u_1^2 + h_1 u_1 =</span>  <span class="math">h_2w_1 + h_1u_1</span>  and in the computation of  <span class="math">u_0&#x27; = s_0&#x27;&#x27;^2 + w_4(h_2(s_0&#x27;&#x27; + u_1) + h_1) + w_5f_4</span>  the multiplication by  <span class="math">f_4</span>  need not be counted.</li>
    </ol></li>
    </ul>

    <p class="text-gray-300">If additionally  <span class="math">h_2 = 0</span>  the number of operations reduces even to I, 5S, 17M, as  <span class="math">r = h_1(w_0h_1 + h_0u_1)</span> can be computed directly and for free, and  <span class="math">u&#x27;_0 = s&#x27;&#x27;_0{}^2 + w_4h_1 + w_5f_4</span>  needs only one squaring.</p>

    <p class="text-gray-300">Table 3: <strong>Doubling</strong>,  <span class="math">\\deg u = 2</span></p>

    <div class="overflow-x-auto my-4">
      <table class="min-w-full text-sm text-gray-300">
        <thead>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"></th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">Table 5: <b>Doubling</b> , <span class="math">\\deg u = 2</span></th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"></th>
        </thead>
        <tbody>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Input</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">[u,v], \\deg u = 2</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">u = x^2 + u_1 x + u_0, v = v_1 x + v_0</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">h = h_2 x^2 + h_1 x + h_0, f = x^5 + f_4 x^4 + f_3 x^3 + f_2 x^2 + f_1 x + f_0</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Output</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">[u',v'] = 2[u,v]</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Step</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Expression</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Operations</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">compute <span class="math">\\tilde{v} \\equiv (h+2v) \\mod u = \\tilde{v}_1 x + \\tilde{v}_0</span> :</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">\\tilde{v}_1 = h_1 + 2v_1 - h_2u_1, \\ \\tilde{v}_0 = h_0 + 2v_0 - h_2u_0;</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">2</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">compute resultant <span class="math">r = res(\\tilde{v}, u)</span> :</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">2S, 3M</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">\\overline{w_0 = v_1^2, w_1 = u_1^2, w_2 = \\tilde{v}_1^2, w_3} = u_1 \\tilde{v}_1;</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">(see below)</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">r = u_0 w_2 + \\tilde{v}_0 (\\tilde{v}_0 - w_3);</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">(See Selew)</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">3</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">compute almost inverse <span class="math">inv&#x27; = inv \\cdot r</span> :</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">3</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">\\frac{\\text{compute almost inverse } tite - tite \\cdot \\tau}{\\text{inv}&#x27; - \\tilde{v}_{1} \\cdot \\text{inv}&#x27; - \\tilde{v}_{2}} = v_{1}</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">4</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">inv&#x27;_1 = -\\tilde{v}_1, inv&#x27;_0 = \\tilde{v}_0 - w_3;</span><br>compute <span class="math">k&#x27; = (f - hv - v^2)/u \\mod u = k&#x27;_1 x + k&#x27;_0:</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">11/1</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">4</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1M</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">w_3 = f_3 + w_1, w_4 = 2u_0;</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">k_1&#x27; = 2(w_1 - f_4 u_1) + w_3 - w_4 - v_1 h_2;</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">k&#x27;_0 = u_1(2w_4 - w_3 + f_4u_1 + v_1h_2) + f_2 - w_0 - 2f_4u_0 - v_1h_1 - v_0h_2;</span><br>compute <span class="math">s&#x27; = k&#x27;inv&#x27; \\mod u</span> :</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">5</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">5M</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">w_0 = k_0&#x27; inv_0&#x27;, \\ w_1 = k_1&#x27; inv_1&#x27;;</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">s_1&#x27; = (inv_0&#x27; + inv_1&#x27;)(k_0&#x27; + k_1&#x27;) - w_0 - w_1(1 + u_1);</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">s_0&#x27; = w_0 - u_0 w_1;</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">If <span class="math">s_1 = 0</span> see below</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">6</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">compute <span class="math">s&#x27;&#x27; = x + s_0/s_1</span> and <span class="math">s_1</span> :</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">I, 2S, 5M</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">\\overline{w_1 = 1/(rs_1&#x27;)(=1/r^2s_1)}, \\ w_2 = rw_1(=1/s_1&#x27;), \\ w_3 = s_1&#x27;^2w_1(=s_1);</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">w_4 = rw_2 (= 1/s_1), w_5 = w_4^2;</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">s_0&#x27;&#x27; = s_0&#x27; w_2;</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">7</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">compute <span class="math">l&#x27; = s&#x27;&#x27;u = x^3 + l_2&#x27;x^2 + l_1&#x27;x + l_0&#x27;</span> :</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">2M</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">\\frac{1}{l_2&#x27; = u_1 + s_0&#x27;&#x27;, \\ l_1&#x27; = u_1 s_0&#x27;&#x27; + u_0, \\ l_0&#x27; = u_0 s_0&#x27;&#x27;}</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">8</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">\\frac{l&#x27;_2 = u_1 + s&#x27;&#x27;_0, \\ l&#x27;_1 = u_1 s&#x27;&#x27;_0 + u_0, \\ l&#x27;_0 = u_0 s&#x27;&#x27;_0;}{\\text{compute } u&#x27; = s^2 + (h + 2v)s/u + (v^2 + hv - f)/u^2:}</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">S, 2M</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">\\frac{\\text{compare } u = s + (h + 2v)s/u + (v + hv - f)/u}{u&#x27;_0 = {s&#x27;&#x27;_0}^2 + w_4(h_2(s&#x27;&#x27;_0 - u_1) + 2v_1 + h_1) + w_5(2u_1 - f_4);}</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">5, 2111</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">0</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">u&#x27;_1 = 2s&#x27;&#x27;_0 + w_4h_2 - w_5;</span><br>compute <span class="math">v&#x27; \\equiv -h - (l+v) \\mod u&#x27; = v&#x27;_1x + v&#x27;_0</span> :</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">47. 1</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">9</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">\\frac{\\text{compute } v&#x27; \\equiv -h - (l + v) \\mod u&#x27; = v&#x27;_1 x + v&#x27;_0}{h&#x27;_1 + h&#x27;_2 + h&#x27;_3}</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">4M</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">w_1 = l&#x27;_2 - u&#x27;_1, \\ w_2 = u&#x27;_1 w_1 + u&#x27;_0 - l&#x27;_1;</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">v_1&#x27; = w_2 w_3 - v_1 - h_1 + u_1&#x27; h_2;</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">w_2 = u_0&#x27; w_1 - l_0&#x27;;</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">v_0&#x27; = w_2 w_3 - v_0 - h_0 + h_2 u_0&#x27;;</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">total</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">I, 5S, 22 M</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Special case <span class="math">s = s_0</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">6'</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">compute <span class="math">s</span> and precomputations:</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">I,3M</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">\\frac{\\text{compute } s \\text{ and precomputations.}}{w_1 = 1/r, s_0 = s&#x27;_0 w_1;}</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1,01/1</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">7</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">7'</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">w_1 = u_1 s_0 + v_1 + h_1, w_2 = u_0 s_0 + v_0 + h_0;</span><br>compute <span class="math">u&#x27; = (f - hv - v^2)/u^2 - (h + 2v)s/u - s^2:</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">S</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">&middot;</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">5</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">0,</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">u&#x27;_0 = f_4 - s_0^2 - s_0 h_2 - 2u_1;</span> compute <span class="math">v&#x27; \\equiv -h - (su + v) \\mod u&#x27;</span> :</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">03.5</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">8'</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">\\frac{\\text{compute } v&#x27; \\equiv -h - (su + v) \\bmod u&#x27;}{}</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">2M</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">\\overline{w_1 = w_1 - u_0&#x27;(s_0 + h_2)}, \\ v_0&#x27; = u_0&#x27;w_1 - w_2;</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">total</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">I, 3S, 14M</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">*</td>
          </tr>
        </tbody>
      </table>
    </div>

    <p class="text-gray-300">To compare the arithmetic on elliptic and hyperelliptic curves of genus 2 we implemented the above formulae in various environments. For elliptic curves we used the affine representation, i. e. the curve is given as in the introduction with g=1. This is justified by the fact that for all libraries one inversion takes less than six multiplications. The times needed for multiplication, squaring and inversion by the different libraries are listed in the appendix. Addition formulae for elliptic curves can be found in almost any textbook on this subject, e.g. Blake, Seroussi, and Smart [1], Silverman [17] or Koblitz [5]. To add two distinct points one needs one inversion, one squaring and two multiplications whereas doubling takes one more squaring.</p>

    <div class="overflow-x-auto my-4">
      <table class="min-w-full text-sm text-gray-300">
        <thead>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"><span class="math">\\mathbf{ECC}, \\mathbb{F}_{q_{ell}}</span></th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"></th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"></th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"><span class="math">\\mathrm{HEC}, \\mathbb{F}_{q_{hyp}}</span></th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"></th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"></th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"></th>
        </thead>
        <tbody>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">I</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">S</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">M</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">I</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">S</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">M</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Addition</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">2</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">2</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">23</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Doubling</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">2</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">2</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">5</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">22</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">m-fold</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">6\\lambda</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">10\\lambda</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">12\\lambda</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">6\\lambda</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">24\\lambda</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">134\\lambda</span></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">\\log_2 m = \\lambda</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
        </tbody>
      </table>
    </div>

    <p class="text-gray-300">For properly chosen curves (not supersingular, group order contains a large prime factor) the security mainly depends on the group size. By Weil's theorem we have</p>

    <p class="text-gray-300"><span class="math">$|\\mathrm{Cl}(C/\\mathbb{F}_{q^n})| \\sim q^{ng}.</span>$</p>

    <p class="text-gray-300">Hence, to achieve the same level of security the finite field for elliptic curves needs to be larger  <span class="math">q_{ell} \\sim q_{hyp}^2</span> . As the arithmetic in  <span class="math">\\mathbb{F}_q</span>  takes time  <span class="math">\\tilde{O}(\\log q)</span> , inversions are more expensive than multiplications, and squarings are even cheaper, one might expect that hyperelliptic curves could offer faster arithmetic than elliptic curves for the same level of security or at least achieve the same level of speed. The outcome of the experiments shows that this relation depends heavily on the underlying arithmetic. To be more precise, breaking down the operations to the smaller field  <span class="math">\\mathbb{F}_{q_{hyp}}</span>  on an elliptic curve we need at least two times as many inversions but less multiplications than on a hyperelliptic curve.</p>

    <p class="text-gray-300">For the implementations we used curves over prime fields  <span class="math">\\mathbb{F}_p</span>  and curves over  <span class="math">\\mathbb{F}_{2^n}</span> . The latter are Koblitz curves defined over  <span class="math">\\mathbb{F}_2</span> , therefore one can achieve a much faster implementation using the Frobenius endomorphism (see [7]), however, here we were only interested in the effects of the usual arithmetic in the ideal class group. We worked with the following curves and fields.</p>

    <div class="overflow-x-auto my-4">
      <table class="min-w-full text-sm text-gray-300">
        <thead>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"></th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">ECC</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"></th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"></th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"></th>
        </thead>
        <tbody>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">y^2 = x^3 + 2227264092164547360326443915353641005956041076603x +</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">\\mathbb{F}_p</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">+2705501697235753328656362326336626679936508382816</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">&bull;</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">p_1 = 2923003274661805836407369665432566039311865086059</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">y^2 = x^3 + 17737349176642349243894113027274253572128546075654068293x +</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">\\mathbb{F}_p</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">2</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">+11398124211651420413825497258317958241131759134764526623</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">p_2 = 18389946490390666300300164325803710203424869466203226147</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">\\mathbb{F}_2</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">3</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">y^2 + y = x^3 + 1</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">\\mathbb{F}_2</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">4</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">y^2 + y = x^3 + x^2 + 1</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">HEC</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">y^2 = x^5 + 153834295433461683634059x^3 + 1503542947764347319629935x^2 +</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">\\mathbb{F}_p</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">5</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">+1930714025804554453580068x + 790992824799875905266969</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">p_3 = 1932005208863265003490787</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">y^2 = x^5 + 241216435998068557682742515x^3 + 553011586465186980114036462x^2 + 241216435998068557682742515x^3 + 553011586465186980114036462x^2 + 241216435998068557682742515x^3 + 553011586465186980114036462x^2 + 241216435998068557682742515x^3 + 553011586465186980114036462x^2 + 24121643598068557682742515x^3 + 553011586465186980114036462x^2 + 24121643598068557682742515x^3 + 24121643598068557682742515x^3 + 24121643598068557682742515x^3 + 24121643598068557682742515x^3 + 24121643598668576867667676767676767676767676767676</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">\\mathbb{F}_p</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">6</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">+1456621446251091989731057514x + 3440013483680364963850133535</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">p_4 = 3713820117856140824697372689</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">\\mathbb{F}_2</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">7</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">y^2 + xy = x^5 + x^2 + 1</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">\\mathbb{F}_2</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">8</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">y^2 + (x^2 + x + 1)y = x^5 + x</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
        </tbody>
      </table>
    </div>

    <p class="text-gray-300">For the binary elliptic curves we considered the field extensions n = 163 and n = 191 and for hyperelliptic curves we took n = 83 and n = 97.</p>

    <p class="text-gray-300">Note that in the genus 2 case we cannot determine the group order for the prime fields, but the arithmetic depends only on the field size, thus even if these particular curves should turn out to be weak the arithmetic for appropriate curves is equally fast.</p>

    <p class="text-gray-300">In all the experiments the special cases never occurred, this goes along with the fact that the probability of occurrence is &sim; 1/p.</p>

    <p class="text-gray-300">All computations where performed on a Pentium IV, 1.5 GHz under linux.</p>

      <h3 id="sec-5.1" class="text-xl font-semibold mt-8">5.1 Prime Fields</h3>

    <p class="text-gray-300">We did a C implementation using GMP as long integer package and a C++ implementation with NTL. For GMP the field elements were considered as integers and reduction took place only where necessary. With NTL we used the library to perform finite field arithmetic.</p>

    <p class="text-gray-300">We carried out 10 000 scalar multiplications per curve using binary double-and-add, where the scalar is in the range of the group order. The table lists the average time needed to perform a scalar multiplication on the respective curve, where the scalar was of the order of the assumed group size. Time is given in ms.</p>

    <div class="overflow-x-auto my-4">
      <table class="min-w-full text-sm text-gray-300">
        <thead>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">GMP</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">ECC</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">HEC</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"></th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"></th>
        </thead>
        <tbody>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">&sim;<br>160 bits</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">4.577</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">8.232</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">&sim;<br>180 bits</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">5.668</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">9.121</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
        </tbody>
      </table>
    </div>

    <div class="overflow-x-auto my-4">
      <table class="min-w-full text-sm text-gray-300">
        <thead>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">NTL</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">ECC</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">HEC</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"></th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"></th>
        </thead>
        <tbody>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">&sim;<br>160 bits</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">10.785</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">11.326</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">&sim;<br>180 bits</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">14.303</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">16.324</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
        </tbody>
      </table>
    </div>

    <p class="text-gray-300">Thus interestingly the results show that the relation between the cost of arithmetic for elliptic and hyperelliptic curves depends heavily on the chosen implementation of field arithmetic. In any case the complexity is of the same order (at most twice) for both genera. In GMP we have that an inversion is less expensive compared to multiplications than in NTL (see Appendix). This relation seems to be the reason why in GMP the arithmetic on elliptic curves is faster whereas in NTL the timings are balanced.</p>

      <h3 id="sec-5.2" class="text-xl font-semibold mt-8">5.2 Binary Fields</h3>

    <p class="text-gray-300">The C++ program for curves over binary fields is based on an implementation of the arithmetic in IF2<sup>n</sup> by Michael N&uml;ocker [15], which allows to work with normal and polynomial bases and in the latter case accepts user defined irreducible polynomials. His program was built on bipolar, an implementation of polynomial arithmetic over IF2. Here we use polynomial arithmetic for the computations in IF2<sup>n</sup> . See [9] for a detailed study of the appropriate implementation of Koblitz curves. As irreducible polynomials we took sparse polynomials. For n = 163 and n = 83 we used a pentanomial; for n = 191 and n = 97 irreducible trinomials exist. Again 10 000 scalar multiplications per curve and extension field were performed and the table lists the average time for one scalar multiplication.</p>

    <div class="overflow-x-auto my-4">
      <table class="min-w-full text-sm text-gray-300">
        <thead>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">binary field</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">ECC</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"></th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">HEC</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"></th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"></th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"></th>
        </thead>
        <tbody>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">curve</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">3</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">4</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">7</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">8</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">&sim;<br>160 bits</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">26.208</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">26.504</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">18.875</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">21.143</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">&sim;<br>190 bits</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">31.958</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">32.240</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">25.215</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">27.188</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
        </tbody>
      </table>
    </div>

    <p class="text-gray-300">First of all one notices that again with this library arithmetic on hyperelliptic curves is faster than on elliptic curves. In comparing curves 3 and 4 respectively 7 and 8 one realizes that the running-time also depends on the coefficients of the equation of the curve. The difference results from the distinct number of additions needed.</p>

    <p class="text-gray-300">The formulae for even characteristic have been implemented on a ARM processor by Pelzl [16]. He also generalizes the explicit formulae for genus three given by Kuroki, Gonda, Matsuo, Chao, and Tsuji [6] to even characteristic.</p>

    <p class="text-gray-300">For restricted devices inversions are very expensive. A first attempt to avoid divisions on the cost of more multiplications and a further coordinate is given by Miyamoto, Doi, Matsuo, Chao, and Tsuji [13]. An optimized version that also covers even characteristic and considers the case of scalar multiplication is to appear [8].</p>

    <ul class="list-disc list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li><p class="text-gray-300">[1] I.F. Blake, G. Seroussi, and N.P. Smart. Elliptic curves in cryptography. London Mathematical Society Lecture Note Series. 265. Cambridge University Press, 1999.</p></li>
      <li><p class="text-gray-300">[2] D.G. Cantor. Computing in the Jacobian of a hyperelliptic curve. Math. Comp., 48:95&ndash;101, 1987.</p></li>
      <li><p class="text-gray-300">[3] R. Harley. Fast arithmetic on genus 2 curves. available at http://cristal.inria.fr/&sim;harley/hyper, 2000.</p></li>
      <li><p class="text-gray-300">[4] N. Koblitz. Hyperelliptic cryptosystems. J. of Cryptology, 1:139&ndash;150, 1989.</p></li>
      <li><p class="text-gray-300">[5] N. Koblitz. Algebraic aspects of cryptography. Springer, 1998.</p></li>
      <li><p class="text-gray-300">[6] J. Kuroki, M. Gonda, K. Matsuo, J. Chao, and S. Tsuji. Fast Genus Three Hyperelliptic Curve Cryptosystems. In Proc. of SCIS2002, IEICE Japan, 2002.</p></li>
      <li><p class="text-gray-300">[7] T. Lange. Efficient Arithmetic on Hyperelliptic Curves. PhD thesis, Universit&uml;at Gesamthochschule Essen, 2001.</p></li>
      <li><p class="text-gray-300">[8] T. Lange. Inversion-Free Arithmetic on Genus 2 Hyperelliptic Curves. Cryptology ePrint Archive, Report 2002/147, 2002. http://eprint.iacr.org/ or http://www.itsc.ruhr-uni-bochum.de/tanja.</p></li>
      <li><p class="text-gray-300">[9] T. Lange and M. N&uml;ocker. Optimal implementation of hyperelliptic Koblitz curves over IF2<sup>n</sup> . in preparation.</p></li>
      <li><p class="text-gray-300">[10] D. Lorenzini. An Invitation to Arithmetic Geometry, volume 9 of Graduate studies in mathematics. AMS, 1996.</p></li>
      <li><p class="text-gray-300">[11] K. Matsuo, J. Chao, and S. Tsujii. Fast genus two hyperellptic curve cryptosysytems. Technical Report ISEC2001-23, IEICE, 2001. pages 89-96.</p></li>
      <li><p class="text-gray-300">[12] A. Menezes, Y.-H. Wu, and R. Zuccherato. An Elementary Introduction to Hyperelliptic Curves. In Algebraic Aspects of Cryptography [5].</p></li>
      <li><p class="text-gray-300">[13] Y. Miyamoto, H. Doi, K. Matsuo, J. Chao, and S. Tsuji. A fast addition algorithm of genus two hyperelliptic curve. In Proc. of SCIS2002, IEICE Japan, pages 497&ndash;502, 2002. in Japanese.</p></li>
      <li><p class="text-gray-300">[14] D. Mumford. Tata Lectures on Theta II. Birkh&uml;auser, 1984.</p></li>
      <li><p class="text-gray-300">[15] M. N&uml;ocker. Data structures for parallel exponentiation. PhD thesis, Universit&uml;at Paderborn, 2001.</p></li>
      <li><p class="text-gray-300">[16] J. Pelzl. Fast Hyperelliptic Curve Cryptosystems for Embedded Processors. Master's thesis, Ruhr-University of Bochum, 2002.</p></li>
      <li><p class="text-gray-300">[17] J. H. Silverman. The arithmetic of elliptic curves, volume 106 of Graduate texts in mathematics. Springer, 1986.</p></li>
      <li><p class="text-gray-300">[18] A.M. Spallek. Kurven vom Geschlecht 2 und ihre Anwendung in Public-Key-Kryptosystemen. PhD thesis, Universit&uml;at Gesamthochschule Essen, 1994.</p></li>
      <li><p class="text-gray-300">[19] H. Stichtenoth. Algebraic Function Fields and Codes. Springer, 1993.</p></li>
      <li><p class="text-gray-300">[20] H. Sugizaki, K. Matsuo, J. Chao, and S. Tsujii. An Exntension of Harley algorithm addition algorithm for hyperelliptic curves over finite fields of characteritic two. Technical Report ISEC2002-9(2002-5), IEICE, 2002. pages 49-56.</p></li>
      <li><p class="text-gray-300">[21] M. Takahashi. Improving Harley Algorithms for Jacobians of genus 2 Hyperelliptic Curves. In <em>Proc. of SCIS2002</em>, <em>IEICE Japan</em>, 2002. in Japanese.</p></li>
    </ul>

    <p class="text-gray-300">Here we provide the timings for the field operations using the respective libraries. The timings were obtained on a Pentium IV, 1.5 GHz under linux. We carried out  <span class="math">1\\,000\\,000</span>  times each of the operations, times are given in  <span class="math">\\mu</span> s.</p>

    <p class="text-gray-300">As using GMP we carried out modular reductions only when it lead to an increase of speed, the table lists both the costs for multiplication and squaring of integers of the respective size without further reduction and including a modular reduction. Accordingly, in the implementation the times needed on average for these two operations is slightly larger if we disregard the reduction and smaller otherwise. Inversion is carried out as modular inversion in any case. Using NTL or working with binary fields we automatically have modular reduction. Finally we state the quotients of inversion and squaring over multiplications in all cases.</p>

    <div class="overflow-x-auto my-4">
      <table class="min-w-full text-sm text-gray-300">
        <thead>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"></th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">prime/fieldsize</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">I</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">S</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">M</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"><span class="math">S_{red}</span></th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"><span class="math">M_{red}</span></th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"><span class="math">\\frac{\\mathrm{I}}{\\mathrm{M}}</span></th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"><span class="math">\\frac{S}{M}</span></th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"><span class="math">\\frac{\\mathrm{I}}{\\mathrm{M}_{red}}</span></th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"><span class="math">\\frac{S_{red}}{M_{red}}</span></th>
        </thead>
        <tbody>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">GMP<br>4.0.1</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">p_1 \\sim 161 \\text{ bits}</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">16.22</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">3.04</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">5.93</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">3.99</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">6.84</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">2.73</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">0.51</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">2.37</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">0.58</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">p_2 \\sim 183 \\text{ bits}</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">17.23</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">2.31</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">4.42</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">3.18</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">5.37</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">3.89</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">0.52</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">3.20</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">0.59</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">p_3 \\sim 81 \\text{ bits}</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">7.64</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1.52</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">2.89</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">2.14</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">3.49</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">2.64</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">0.52</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">2.18</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">0.61</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">p_4 \\sim 91 \\text{ bits}</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">8.39</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1.63</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">3.01</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">2.14</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">3.55</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">2.78</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">0.54</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">2.36</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">0.60</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">NTL<br>5.2</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">p_1 \\sim 161 \\text{ bits}</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">35.36</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">_</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">_</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">4.95</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">7.74</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">_</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">_</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">4.56</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">0.63</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">p_2 \\sim 183 \\text{ bits}</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">40.62</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">_</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">_</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">5.66</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">8.88</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">_</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">_</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">4.57</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">0.63</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">p_3 \\sim 81 \\text{ bits}</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">18.24</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">_</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">_</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">3.19</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">5.53</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">_</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">_</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">3.29</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">0.57</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">p_4 \\sim 91 \\text{ bits}</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">20.55</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">_</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">_</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">3.06</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">4.98</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">_</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">_</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">4.12</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">0.61</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">\\mathbb{F}_{2^n}</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">n = 163</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">49.81</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">_</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">_</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">6.81</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">9.16</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">_</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">5.43</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">0.74</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">n = 191</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">58.79</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">_</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">_</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">7.19</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">9.60</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">_</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">_</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">6.12</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">0.74</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">n = 83</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">25.68</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">_</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">_</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">5.33</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">5.64</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">_</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">_</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">4.55</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">0.94</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">n = 97</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">28.79</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">_</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">_</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">5.45</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">5.96</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">_</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">_</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">4.83</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">0.91</td>
          </tr>
        </tbody>
      </table>
    </div>

    </section>
`;
---

<BaseLayout title="Efficient Arithmetic on Genus 2 Hyperelliptic Curves over Fi... (2002/121)">
  <article class="max-w-4xl mx-auto article-prose">
    <nav class="mb-8">
      <a href="/papers" class="text-blue-400 hover:text-blue-300">
        &larr; Back to Papers
      </a>
    </nav>

    <header class="mb-12">
      <h1 class="text-3xl font-bold mb-4"
        set:html={TITLE_HTML} />
      <p class="text-gray-400 mb-2"
        set:html={AUTHORS_HTML} />
      <p class="text-gray-500 text-sm mb-4">
        2002 &middot; eprint 2002/121
      </p>
      <div class="flex gap-4 text-sm">
        <a
          href={EPRINT_URL}
          target="_blank"
          rel="noopener noreferrer"
          class="text-blue-400 hover:text-blue-300"
        >
          Paper (eprint) &rarr;
        </a>
      </div>
      <PaperDisclaimer eprintUrl={EPRINT_URL} />
      <p class="mt-1 text-xs text-gray-600">
        Converted with: {CRAWLER} &middot; {CONVERTED_DATE}
      </p>
    </header>

    <nav id="toc" class="mb-10 p-6 rounded-lg" style="background: rgba(255,255,255,0.03); border: 1px solid rgba(255,255,255,0.06);">
      <h2 class="text-lg font-bold mb-4">Table of Contents</h2>
      <ol class="space-y-1 text-sm text-gray-300
        list-decimal list-inside">
        <li><a href="#abstract" class="hover:text-white">Abstract</a></li>
        <li><a href="#sec-1" class="hover:text-white">Introduction</a></li>
        <li><a href="#sec-2" class="hover:text-white">Mathematical Background on Elliptic and Hyperelliptic Curves</a></li>
        <li><a href="#sec-3" class="hover:text-white">Arithmetic using Cantor&#x27;s Algorithm</a></li>
        <li>
          <a href="#sec-4" class="hover:text-white">Explicit formulae</a>
          <ol class="ml-6 mt-1 space-y-1 list-decimal
            list-inside text-gray-400">
            <li><a href="#sec-4.1" class="hover:text-white">Different Cases</a></li>
            <li><a href="#sec-4.2" class="hover:text-white">Addition and Doubling</a></li>
            <li><a href="#sec-4.2.1" class="hover:text-white">Addition in Most Common Case</a></li>
            <li><a href="#sec-4.2.2" class="hover:text-white">Addition in Case \deg u_1 = 1, \deg u_2 = 2</a></li>
            <li><a href="#sec-4.2.3" class="hover:text-white">Doubling</a></li>
          </ol>
        </li>
        <li>
          <a href="#sec-5" class="hover:text-white">Timings</a>
          <ol class="ml-6 mt-1 space-y-1 list-decimal
            list-inside text-gray-400">
            <li><a href="#sec-5.1" class="hover:text-white">Prime Fields</a></li>
            <li><a href="#sec-5.2" class="hover:text-white">Binary Fields</a></li>
          </ol>
        </li>
        <li><a href="#sec-6" class="hover:text-white">Outlook</a></li>
      </ol>
      <p class="text-xs text-gray-500 mt-4 mb-1 font-semibold">
        Additional
      </p>
      <ul class="space-y-1 text-sm text-gray-400
        list-disc list-inside">
        <li><a href="#references" class="hover:text-white">References</a></li>
      </ul>
    </nav>


    <Fragment set:html={CONTENT} />

    <PaperHistory slug="efficient-arithmetic-on-genus-2-hyperelliptic-curves-over-2002" />
  </article>
</BaseLayout>
