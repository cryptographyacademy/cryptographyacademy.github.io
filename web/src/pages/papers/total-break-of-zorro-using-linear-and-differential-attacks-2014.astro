---
import BaseLayout from '../../layouts/BaseLayout.astro';

const EPRINT_URL = 'https://eprint.iacr.org/2014/220';
const CRAWLER = 'mistral';
const CONVERTED_DATE = '2026-02-16';
const TITLE_HTML = 'Total Break of Zorro using Linear and Differential Attacks';
const AUTHORS_HTML = 'Shahram Rasoolzadeh, Zahra Ahmadian, Mahmoud Salmasizadeh, Mohammad Reza Aref';

const CONTENT = `    <p class="text-gray-300">Shahram Rasoolzadeh^{1,2}, Zahra Ahmadian^{1,2}, Mahmoud Salmasizadeh^{2}, and Mohammad Reza Aref^{1}</p>

    <p class="text-gray-300">^{1} Information Systems and Security Lab (ISSL), Department of Electrical Engineering, ^{2} Electronic Research Institute, Sharif University of Technology, Tehran, Iran {sh_rasoolzadeh,ahmadian}@ee.sharif.edu,{salmasi,aref}@sharif.edu</p>

    <h6 id="sec-2" class="text-base font-medium mt-4">Abstract</h6>

    <p class="text-gray-300">An AES-like lightweight block cipher, namely Zorro, was proposed in CHES 2013. While it has a 16-byte state, it uses only 4 S-Boxes per round. This weak nonlinearity was widely criticized, insofar as it has been directly exploited in all the attacks on Zorro reported by now, including the weak key, reduced round, and even full round attacks. In this paper, using some properties discovered by Wang et al., we present new differential and linear attacks on Zorro, both of which recover the full secret key with practical complexities. These attacks are based on very efficient distinguishers that have only two active S-Boxes per four rounds. The time complexity of our differential and linear attacks are <span class="math">2^{56.76}</span> and <span class="math">2^{45.50}</span> and the data complexity are <span class="math">2^{56.73}</span> chosen plaintexts and <span class="math">2^{45.44}</span> known plaintexts, respectively. The results clearly show that the block cipher Zorro does not have enough security against differential and linear attacks.</p>

    <h6 id="sec-3" class="text-base font-medium mt-4">Keywords:</h6>

    <p class="text-gray-300">Zorro, Differential Attack, Linear Attack, Lightweight Block Cipher.</p>

    <h2 id="sec-4" class="text-2xl font-bold">1 Introduction</h2>

    <p class="text-gray-300">Block ciphers are the most widely-studied primitives in the area of symmetric cryptography. Among the different types of attacks, differential cryptanalysis <em>[1]</em> and linear cryptanalysis <em>[2]</em> can be regarded as two of the oldest and most important statistical methods to analyse the security of the block ciphers.</p>

    <p class="text-gray-300">Zorro is a newly proposed lightweight block cipher whose design is based on AES <em>[3]</em>. It is basically designed with the aim of increasing the resistance against side-channel attacks while still remaining a lightweight block cipher. In spite of its 16-byte state, the SubByte layer of Zorro uses only 4 similar S-Boxes in the first row, which are different from AES S-Boxes. Similar to LED-64 <em>[4]</em>, key addition layer in Zorro is applied only after each four rounds. Instead, an Add Constant layer is used in every rounds with round-dependent constants. Besides, Shift Row and Mix Column layers are exactly the same as AES ones.</p>

    <p class="text-gray-300">For both differential and linear cryptanalysis, designers of Zorro have evaluated the security of the cipher and found a balance between the number of inactive S-Boxes and the number of freedom degrees for differential or linear paths. The designers concluded that 14 and 16 rounds are upper bounds for any non-trivial differential or linear characteristics, respectively. Furthermore, they show that in the single key model of Zorro, a 12 round meet-in-the-middle attack is the most powerful attack. Therefore, for reaching the security margins they choose 24 rounds for Zorro <em>[3]</em>.</p>

    <h3 id="sec-5" class="text-xl font-semibold mt-8">1.1 Related work</h3>

    <p class="text-gray-300">The bold idea in designing Zorro was using the partial nonlinear layers: only 4 S-Boxes for a 16-byte state. That’s why Zorro has attracted the attentions of many cryptanalysts during the past year which result in some attacks even on the full version of the cipher. The first one, proposed by Guo et al., is a key recovery attack on the full-round version of the algorithm, but it works only for <span class="math">2^{64}</span> weak keys of the whole key space <span class="math">2^{128}</span> <em>[5]</em>. This attack exploits this unique property of Zorro twice in a two-stage attack: finding an equivalent description that does not have constants in the rounds, and then, launching an internal differential attack.</p>

    <p class="text-gray-300">In the next attack, Wang et al. presented a differential key recovery attack and a linear distinguisher for full-round Zorro <em>[6]</em>. They observed an interesting property for the Zorro’s Mix Column: the forth power of the mix column matrix is equal to the identity matrix. Using this property of Zorro along with its weak nonlinearity, they found differential and linear distinguishers for Zorro in which only four S-Boxes are activated per four rounds. The resulted differential cryptanalysis can recover the randomly chosen key with a time complexity of <span class="math">2^{108}</span> and data complexity of <span class="math">2^{112.4}</span> chosen plaintexts, and linear distinguisher use <span class="math">2^{105.3}</span> known plaintexts to successfully distinguish it from the random permutation.</p>

    <p class="text-gray-300">Also, Soleimany proposed a probabilistic variation of slide attack and applied it to 16 rounds of Zorro (out of 24 rounds) <em>[7]</em>. This attack challenges the key schedule approach in Zorro (and also LED <em>[4]</em>) in which all subkeys are equal to the master key of the algorithm, and this similarity is compensated by use of round-dependent constants. Probabilistic slide attack shows that this strategy does not necessarily make the cipher secure against the self-similarity attacks. Their attack requires <span class="math">2^{123.62}</span> known plaintexts with the time complexity of <span class="math">2^{123.8}</span> encryption or <span class="math">2^{121.59}</span> known plaintexts with time complexity of <span class="math">2^{124.23}</span> encryption.</p>

    <p class="text-gray-300">Finally, Bar-On et al. briefly reported their new results on Zorro in FSE 2014 rump session which is an improvement of Wang’s differential and linear attacks <em>[8]</em>. As they stated, the gain of their attack is not in the probability of distinguishers since the new distinguishers still have two active S-Boxes per two rounds (i.e. one S-Box per round in average which is similar to that of Wang’s attack). Instead, they achieved some improvements in the key recovery phase. Consequently, a differential attack with time and data complexity of <span class="math">2^{98}</span> and <span class="math">2^{95}</span>, and a linear attack with time and data complexity of <span class="math">2^{88}</span> and <span class="math">2^{83.3}</span> can be</p>

    <p class="text-gray-300">Total Break of Zorro using Linear and Differential Attacks</p>

    <p class="text-gray-300">obtained. As we explain more in the next subsection, they could improve their work further and achieved more efficient distinguishers.</p>

    <p class="text-gray-300">In this paper, we break the full-round version of Zorro by using differential and linear cryptanalyses. We propose very efficient iterated differential characteristics and linear trails that have only two active S-Boxes per four rounds. Using the 23, 22 and 21-round differential characteristics and linear trails, we can propose key recovery attacks for any randomly chosen secret key of full-round Zorro. Differential cryptanalysis has a time complexity of  <span class="math">2^{56.76}</span>  full round encryption and data complexity of  <span class="math">2^{56.73}</span>  chosen plaintexts. Also linear cryptanalysis has a time complexity of  <span class="math">2^{45.50}</span>  full round encryption and data complexity of  <span class="math">2^{45.44}</span>  known plaintexts. Also, the memory complexity of differential cryptanalysis is 12 blocks while for linear cryptanalysis is  <span class="math">2^{17.34}</span> . Table 1 summarizes the complexities of existing attacks and ours. Our results show that the theoretical security of the full-round Zorro evaluated by designers does not hold up in practice.</p>

    <p class="text-gray-300">Very recently, some days after that we archived our results on IACR ePrint Archive, Bar-On et al. published their improved attacks on Zorro in IACR ePrint Archive [9], that made use of different differential characteristics and linear trails from what they previously announced in FSE 2014 Rump session. It must be mentioned that their linear attack has same time, data and memory complexities as ours, because of using the same linear trails and same key recovery method. Also, their differential attack uses the same differential characteristics as ours. But, by using an improved key recovery method, their differential attack has better time and data complexities.</p>

    <p class="text-gray-300">Table 1. Summary of cryptanalytic results on Zorro</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Attack Type</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Rounds attacked</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Time</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Data</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Memory</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Ref.</th>

          </tr>

        </thead>

        <tbody>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">Differential</td>

            <td class="px-3 py-2 border-b border-gray-700">Full-round*</td>

            <td class="px-3 py-2 border-b border-gray-700">254.3</td>

            <td class="px-3 py-2 border-b border-gray-700">254.3 CP</td>

            <td class="px-3 py-2 border-b border-gray-700">254.3</td>

            <td class="px-3 py-2 border-b border-gray-700">[5]</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">Statistical Slide</td>

            <td class="px-3 py-2 border-b border-gray-700">16 (out of 24)</td>

            <td class="px-3 py-2 border-b border-gray-700">2123.8</td>

            <td class="px-3 py-2 border-b border-gray-700">2123.6 CP</td>

            <td class="px-3 py-2 border-b border-gray-700">-</td>

            <td class="px-3 py-2 border-b border-gray-700">[7]</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">Statistical Slide</td>

            <td class="px-3 py-2 border-b border-gray-700">16 (out of 24)</td>

            <td class="px-3 py-2 border-b border-gray-700">2124.2</td>

            <td class="px-3 py-2 border-b border-gray-700">2121.6 CP</td>

            <td class="px-3 py-2 border-b border-gray-700">-</td>

            <td class="px-3 py-2 border-b border-gray-700">[7]</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">Linear (Distinguisher)</td>

            <td class="px-3 py-2 border-b border-gray-700">Full-round</td>

            <td class="px-3 py-2 border-b border-gray-700">2105.3</td>

            <td class="px-3 py-2 border-b border-gray-700">2105.3 CP</td>

            <td class="px-3 py-2 border-b border-gray-700">-</td>

            <td class="px-3 py-2 border-b border-gray-700">[6]</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">Differential</td>

            <td class="px-3 py-2 border-b border-gray-700">Full-round</td>

            <td class="px-3 py-2 border-b border-gray-700">2108</td>

            <td class="px-3 py-2 border-b border-gray-700">2112.4 CP</td>

            <td class="px-3 py-2 border-b border-gray-700">232</td>

            <td class="px-3 py-2 border-b border-gray-700">[6]</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">Differential</td>

            <td class="px-3 py-2 border-b border-gray-700">Full-round</td>

            <td class="px-3 py-2 border-b border-gray-700">298</td>

            <td class="px-3 py-2 border-b border-gray-700">295 CP</td>

            <td class="px-3 py-2 border-b border-gray-700">-</td>

            <td class="px-3 py-2 border-b border-gray-700">[8]</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">Linear</td>

            <td class="px-3 py-2 border-b border-gray-700">Full-round</td>

            <td class="px-3 py-2 border-b border-gray-700">288</td>

            <td class="px-3 py-2 border-b border-gray-700">283.2 KP</td>

            <td class="px-3 py-2 border-b border-gray-700">280</td>

            <td class="px-3 py-2 border-b border-gray-700">[8]</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">Differential</td>

            <td class="px-3 py-2 border-b border-gray-700">Full-round</td>

            <td class="px-3 py-2 border-b border-gray-700">256.8</td>

            <td class="px-3 py-2 border-b border-gray-700">256.7 CP</td>

            <td class="px-3 py-2 border-b border-gray-700">12</td>

            <td class="px-3 py-2 border-b border-gray-700">Sec. 3</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">Linear</td>

            <td class="px-3 py-2 border-b border-gray-700">Full-round</td>

            <td class="px-3 py-2 border-b border-gray-700">245.5</td>

            <td class="px-3 py-2 border-b border-gray-700">245.4 KP</td>

            <td class="px-3 py-2 border-b border-gray-700">215.3</td>

            <td class="px-3 py-2 border-b border-gray-700">Sec. 4</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">Differential</td>

            <td class="px-3 py-2 border-b border-gray-700">Full-round</td>

            <td class="px-3 py-2 border-b border-gray-700">245.4</td>

            <td class="px-3 py-2 border-b border-gray-700">244.4 CP</td>

            <td class="px-3 py-2 border-b border-gray-700">219**</td>

            <td class="px-3 py-2 border-b border-gray-700">[9]</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">Linear</td>

            <td class="px-3 py-2 border-b border-gray-700">Full-round</td>

            <td class="px-3 py-2 border-b border-gray-700">245</td>

            <td class="px-3 py-2 border-b border-gray-700">245 CP</td>

            <td class="px-3 py-2 border-b border-gray-700">217</td>

            <td class="px-3 py-2 border-b border-gray-700">[9]</td>

          </tr>

        </tbody>

      </table>

    </div>

    <ul class="list-disc list-inside space-y-1 text-gray-300 my-2 ml-4">

      <li>This attack works only for  <span class="math">2^{64}</span>  keys of the whole key space  <span class="math">2^{128}</span> .</li>

    </ul>

    <p class="text-gray-300">** The memory complexity is estimated  <span class="math">2^{10}</span>  in [9]. However, they need to save DDT with its inputs for every index in searching level for key recovery method. CP: Chosen Plaintext, KP: Known Plaintext.</p>

    <h3 id="sec-7" class="text-xl font-semibold mt-8">1.3 Outline</h3>

    <p class="text-gray-300">This paper is organized as follows: Section 2 presents a brief description of Zorro. Section 3 represents the outline of the differential attack on full-round Zorro with all details and evaluates its complexities. Furthermore, the outline and details of linear attack and evaluation of its complexities are presented in Section 4. Section 5 includes results of our practical attacks to reduced-round Zorro. Finally, Section 6 concludes this paper.</p>

    <h2 id="sec-8" class="text-2xl font-bold">2 A Brief Description of Zorro</h2>

    <p class="text-gray-300">The block cipher Zorro has a 128-bit key and a 128-bit block size. It has 24 rounds which is divided into 6 steps of 4 rounds each.</p>

    <p class="text-gray-300">As in AES, the internal state in Zorro is a 4<span class="math">\\times</span>4 matrix of bytes, and every round consists of four transformations:</p>

    <ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">

      <li>SB^{∗} is the S-Box layer where 4 similar S-Boxes, which are different from AES S-Boxes, are applied to the 4 bytes of the first row in the state matrix.</li>

      <li>AC is adding (xoring) the round constant to the state matrix. Specifically, in round <span class="math">i</span>, the four constants (<span class="math">i</span>, <span class="math">i</span>, <span class="math">i</span>, <span class="math">i\\ll 3</span>) are xored to the four bytes of the first row of state matrix. By <span class="math">\\ll</span> we mean left shift.</li>

      <li>SR is similar to AES ShiftRow.</li>

      <li>MC is similar to AES MixColumn.</li>

    </ol>

    <p class="text-gray-300">The key schedule of Zorro is similar to that of LED block cipher <em>[4]</em>. Before the first and after each step (i.e. each four rounds), the master key is xored to the state.</p>

    <p class="text-gray-300">Since only 4 S-Boxes are applied to the first row in each round, combined with this feature of <span class="math">MC</span> matrix, iterated differential characteristics and linear trails are found for one step of Zorro.</p>

    <h2 id="sec-9" class="text-2xl font-bold">3 Differential Cryptanalysis</h2>

    <p class="text-gray-300">In this section, we first find some iterated differential characteristics for one step of Zorro which have a high probability. The independence of round functions is a conventional assumption in differential (and linear) cryptanalysis of block ciphers <em>[1, 2]</em>. For Zorro, the secret key is xored to the state every four rounds. Furthermore, 4 rounds of Zorro can be seen as a step that has no constants in the rounds, if we add one constant to the input and one to the output of the step <em>[5]</em>. Thus the assumption that the step functions are independent is more rational and realistic than the one that the round functions are independent. Using this assumption, we will construct three groups of distinguishers for 23, 22 and 21 rounds of Zorro. The first distinguisher is used in the first phase of the key recovery attack to reduce the key space of <span class="math">2^{128}</span> to <span class="math">2^{96}</span>. Having recovered 32 linear relations between bits of the key in the first phase, we use the second and third distinguishers in the next two phases to recover more relations. Finally, the remaining candidates of key can be retrieved by an exhaustive search.</p>

    <p class="text-gray-300">Total Break of Zorro using Linear and Differential Attacks</p>

    <p class="text-gray-300">Our strategy to find an efficient iterated differential characteristic for one step of Zorro with the minimum number of active S-Boxes is to exploit the maximum flexibility in the input difference. This is as follows:</p>

    <ul class="list-disc list-inside space-y-1 text-gray-300 my-2 ml-4">

      <li>Set the difference of the first row equal to zero to prevent the S-Boxes of the first round being active.</li>

      <li>Set the differences of the third and fourth columns equal to that of the first and second ones, respectively. This bypasses the influence of  <span class="math">SR</span>  transformation for a 4-round Zorro.</li>

      <li>Do not impose any more conditions on the remaining six bytes now and let their dependency be utilized in minimizing the number of active S-Boxes in the next rounds.</li>

    </ul>

    <p class="text-gray-300">We can extend this input difference to four rounds with only two active S-Boxes as shown in Fig. 1. In this figure the  <span class="math">AC</span>  transformation is omitted since it does not have any affect on the differentials. The active S-Boxes are shown in gray whose difference value is written inside. For attaining such a differential characteristic, some conditions in  <span class="math">MC</span>  transformations between states (#3, #4), (#6, #7), (#12, #1), as well as two conditions for  <span class="math">SB^{*}</span>  transformation between states (#10, #11) must be satisfied. All these conditions are presented in detail in Appendix B which result in the following representation of all the variables based on  <span class="math">A</span>  and  <span class="math">B</span> .</p>

    <p class="text-gray-300">!<a href="img-0.jpeg">img-0.jpeg</a> Fig. 1. Iterated differential characteristic of one step of Zorro</p>

    <p class="text-gray-300">Shahram Rasoolzadeh et al.</p>

    <p class="text-gray-300"><span class="math">\\mathrm{C} = \\mathrm{A}\\oplus \\mathrm{B}</span>  ，  <span class="math">\\mathrm{D} = \\mathrm{A}\\oplus \\mathrm{B}</span>  ，  <span class="math">\\mathrm{E} = 2\\mathrm{A}\\oplus \\mathrm{B}</span>  ，  <span class="math">\\mathrm{F} = \\mathrm{A}\\oplus 2\\mathrm{B}</span></p>

    <p class="text-gray-300"><span class="math">\\mathrm{G} = 2\\mathrm{A}\\oplus 3\\mathrm{B}</span>  ，  <span class="math">\\mathrm{H} = 3\\mathrm{A}\\oplus 2\\mathrm{B}</span>  ，  <span class="math">\\mathrm{I} = \\mathrm{A}\\oplus 5\\mathrm{B}</span>  ，  <span class="math">\\mathrm{J} = 5\\mathrm{A}\\oplus \\mathrm{B}</span></p>

    <p class="text-gray-300"><span class="math">\\mathrm{K} = 3\\mathrm{A}\\oplus 4\\mathrm{B}</span>  ，  <span class="math">\\mathrm{L} = 4\\mathrm{A}\\oplus 3\\mathrm{B}</span>  ，  <span class="math">\\mathrm{M} = \\mathrm{A}\\oplus 8\\mathrm{B}</span>  ，  <span class="math">\\mathrm{N} = 8\\mathrm{A}\\oplus \\mathrm{B}</span>  (1)</p>

    <p class="text-gray-300"><span class="math">\\mathrm{O} = 13(\\mathrm{A}\\oplus \\mathrm{B})</span>  ，  <span class="math">\\mathrm{P} = 13(\\mathrm{A}\\oplus \\mathrm{B})</span>  ，  <span class="math">\\mathrm{Q} = 10\\mathrm{A}\\oplus \\mathrm{B}</span>  ，  <span class="math">\\mathrm{R} = \\mathrm{A}\\oplus 10\\mathrm{B}</span></p>

    <p class="text-gray-300"><span class="math">\\mathrm{S} = 20\\mathrm{A}\\oplus 4\\mathrm{B}</span>  ，  <span class="math">\\mathrm{T} = 4\\mathrm{A}\\oplus 20\\mathrm{B}</span>  ，  <span class="math">\\mathrm{U} = 6\\mathrm{A}\\oplus 31\\mathrm{B}</span>  ，  <span class="math">\\mathrm{V} = 31\\mathrm{A}\\oplus 6\\mathrm{B}</span></p>

    <p class="text-gray-300"><span class="math">\\mathrm{W} = 17\\mathrm{A}\\oplus 5\\mathrm{B}</span>  ，  <span class="math">\\mathrm{X} = 5\\mathrm{A}\\oplus 17\\mathrm{B}</span>  ，  <span class="math">\\mathrm{Y} = 7\\mathrm{A}\\oplus 24\\mathrm{B}</span>  ，  <span class="math">\\mathrm{Z} = 24\\mathrm{A}\\oplus 7\\mathrm{B}</span></p>

    <p class="text-gray-300">Now let's focus on the  <span class="math">SB^{*}</span>  transformation of the fourth round. We need that for all the four active S-Boxes, each output difference equals its own input difference. Suppose this happens with the probability of  <span class="math">p</span> . We will try to maximize  <span class="math">p</span> . Also, we still have 2 degrees of freedom,  <span class="math">A</span>  and  <span class="math">B</span> . So we can set one of  <span class="math">S</span>  or  <span class="math">T</span>  to zero and confine the number of active S-Boxes to two, per four rounds. Let</p>

    <div class="my-4 text-center"><span class="math-block">\\left\\{ \\begin{array}{l} S = 0 \\Rightarrow B = 5 A \\\\ o r \\\\ T = 0 \\Rightarrow A = 5 B \\end{array} \\right. \\tag {2}</span></div>

    <p class="text-gray-300">Hence, for the best probability of the proposed 4-round differential characteristic</p>

    <div class="my-4 text-center"><span class="math-block">P _ {4 r} = \\max  _ {1 \\leq x \\leq 2 5 5} P r \\left\\{\\Delta_ {\\text {i n p u t}} = x \\rightarrow \\Delta_ {\\text {o u t p u t}} = x \\right\\} ^ {2} \\tag {3}</span></div>

    <p class="text-gray-300">According to DDT of S-Box, the maximum probability is equal to  <span class="math">P_{4r} = \\left(\\frac{6}{256}\\right)^2 = 2^{-10.83}</span>  and there are three choices for  <span class="math">x</span>  to achieve this value. Considering the two cases of  <span class="math">S = 0</span>  or  <span class="math">T = 0</span> , there would be, in total, six options for the input difference to construct a differential characteristic with this maximum probability. These six differential characteristics are listed in Table 2, in which every row shows the difference values  <span class="math">A, \\ldots, Z</span>  corresponding to one characteristic. Furthermore, we can replace the difference of state #1 by that of #4, #7 or #10, to get new sets of iterated differential characteristics.</p>

    <p class="text-gray-300">Table 2. Six iterated differential characteristics for one step</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">No.</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">A</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">B</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">C</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">D</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">E</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">F</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">G</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">H</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">I</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">J</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">K</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">L</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">M</th>

          </tr>

        </thead>

        <tbody>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">1</td>

            <td class="px-3 py-2 border-b border-gray-700">136</td>

            <td class="px-3 py-2 border-b border-gray-700">158</td>

            <td class="px-3 py-2 border-b border-gray-700">22</td>

            <td class="px-3 py-2 border-b border-gray-700">22</td>

            <td class="px-3 py-2 border-b border-gray-700">149</td>

            <td class="px-3 py-2 border-b border-gray-700">175</td>

            <td class="px-3 py-2 border-b border-gray-700">178</td>

            <td class="px-3 py-2 border-b border-gray-700">164</td>

            <td class="px-3 py-2 border-b border-gray-700">88</td>

            <td class="px-3 py-2 border-b border-gray-700">0</td>

            <td class="px-3 py-2 border-b border-gray-700">205</td>

            <td class="px-3 py-2 border-b border-gray-700">178</td>

            <td class="px-3 py-2 border-b border-gray-700">20</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">2</td>

            <td class="px-3 py-2 border-b border-gray-700">158</td>

            <td class="px-3 py-2 border-b border-gray-700">136</td>

            <td class="px-3 py-2 border-b border-gray-700">22</td>

            <td class="px-3 py-2 border-b border-gray-700">22</td>

            <td class="px-3 py-2 border-b border-gray-700">175</td>

            <td class="px-3 py-2 border-b border-gray-700">149</td>

            <td class="px-3 py-2 border-b border-gray-700">164</td>

            <td class="px-3 py-2 border-b border-gray-700">178</td>

            <td class="px-3 py-2 border-b border-gray-700">0</td>

            <td class="px-3 py-2 border-b border-gray-700">88</td>

            <td class="px-3 py-2 border-b border-gray-700">178</td>

            <td class="px-3 py-2 border-b border-gray-700">205</td>

            <td class="px-3 py-2 border-b border-gray-700">178</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">3</td>

            <td class="px-3 py-2 border-b border-gray-700">92</td>

            <td class="px-3 py-2 border-b border-gray-700">55</td>

            <td class="px-3 py-2 border-b border-gray-700">107</td>

            <td class="px-3 py-2 border-b border-gray-700">107</td>

            <td class="px-3 py-2 border-b border-gray-700">143</td>

            <td class="px-3 py-2 border-b border-gray-700">50</td>

            <td class="px-3 py-2 border-b border-gray-700">225</td>

            <td class="px-3 py-2 border-b border-gray-700">138</td>

            <td class="px-3 py-2 border-b border-gray-700">183</td>

            <td class="px-3 py-2 border-b border-gray-700">0</td>

            <td class="px-3 py-2 border-b border-gray-700">56</td>

            <td class="px-3 py-2 border-b border-gray-700">225</td>

            <td class="px-3 py-2 border-b border-gray-700">255</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">4</td>

            <td class="px-3 py-2 border-b border-gray-700">55</td>

            <td class="px-3 py-2 border-b border-gray-700">92</td>

            <td class="px-3 py-2 border-b border-gray-700">107</td>

            <td class="px-3 py-2 border-b border-gray-700">107</td>

            <td class="px-3 py-2 border-b border-gray-700">50</td>

            <td class="px-3 py-2 border-b border-gray-700">143</td>

            <td class="px-3 py-2 border-b border-gray-700">138</td>

            <td class="px-3 py-2 border-b border-gray-700">225</td>

            <td class="px-3 py-2 border-b border-gray-700">0</td>

            <td class="px-3 py-2 border-b border-gray-700">183</td>

            <td class="px-3 py-2 border-b border-gray-700">225</td>

            <td class="px-3 py-2 border-b border-gray-700">56</td>

            <td class="px-3 py-2 border-b border-gray-700">225</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">5</td>

            <td class="px-3 py-2 border-b border-gray-700">22</td>

            <td class="px-3 py-2 border-b border-gray-700">78</td>

            <td class="px-3 py-2 border-b border-gray-700">88</td>

            <td class="px-3 py-2 border-b border-gray-700">88</td>

            <td class="px-3 py-2 border-b border-gray-700">98</td>

            <td class="px-3 py-2 border-b border-gray-700">138</td>

            <td class="px-3 py-2 border-b border-gray-700">254</td>

            <td class="px-3 py-2 border-b border-gray-700">166</td>

            <td class="px-3 py-2 border-b border-gray-700">123</td>

            <td class="px-3 py-2 border-b border-gray-700">0</td>

            <td class="px-3 py-2 border-b border-gray-700">25</td>

            <td class="px-3 py-2 border-b border-gray-700">254</td>

            <td class="px-3 py-2 border-b border-gray-700">80</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">6</td>

            <td class="px-3 py-2 border-b border-gray-700">78</td>

            <td class="px-3 py-2 border-b border-gray-700">22</td>

            <td class="px-3 py-2 border-b border-gray-700">88</td>

            <td class="px-3 py-2 border-b border-gray-700">88</td>

            <td class="px-3 py-2 border-b border-gray-700">138</td>

            <td class="px-3 py-2 border-b border-gray-700">98</td>

            <td class="px-3 py-2 border-b border-gray-700">166</td>

            <td class="px-3 py-2 border-b border-gray-700">254</td>

            <td class="px-3 py-2 border-b border-gray-700">0</td>

            <td class="px-3 py-2 border-b border-gray-700">123</td>

            <td class="px-3 py-2 border-b border-gray-700">254</td>

            <td class="px-3 py-2 border-b border-gray-700">25</td>

            <td class="px-3 py-2 border-b border-gray-700">254</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">No.</td>

            <td class="px-3 py-2 border-b border-gray-700">N</td>

            <td class="px-3 py-2 border-b border-gray-700">O</td>

            <td class="px-3 py-2 border-b border-gray-700">P</td>

            <td class="px-3 py-2 border-b border-gray-700">Q</td>

            <td class="px-3 py-2 border-b border-gray-700">R</td>

            <td class="px-3 py-2 border-b border-gray-700">S</td>

            <td class="px-3 py-2 border-b border-gray-700">T</td>

            <td class="px-3 py-2 border-b border-gray-700">U</td>

            <td class="px-3 py-2 border-b border-gray-700">V</td>

            <td class="px-3 py-2 border-b border-gray-700">W</td>

            <td class="px-3 py-2 border-b border-gray-700">X</td>

            <td class="px-3 py-2 border-b border-gray-700">Y</td>

            <td class="px-3 py-2 border-b border-gray-700">Z</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">---</td>

            <td class="px-3 py-2 border-b border-gray-700">---</td>

            <td class="px-3 py-2 border-b border-gray-700">---</td>

            <td class="px-3 py-2 border-b border-gray-700">---</td>

            <td class="px-3 py-2 border-b border-gray-700">---</td>

            <td class="px-3 py-2 border-b border-gray-700">---</td>

            <td class="px-3 py-2 border-b border-gray-700">---</td>

            <td class="px-3 py-2 border-b border-gray-700">---</td>

            <td class="px-3 py-2 border-b border-gray-700">---</td>

            <td class="px-3 py-2 border-b border-gray-700">---</td>

            <td class="px-3 py-2 border-b border-gray-700">---</td>

            <td class="px-3 py-2 border-b border-gray-700">---</td>

            <td class="px-3 py-2 border-b border-gray-700">---</td>

            <td class="px-3 py-2 border-b border-gray-700">---</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">1</td>

            <td class="px-3 py-2 border-b border-gray-700">178</td>

            <td class="px-3 py-2 border-b border-gray-700">254</td>

            <td class="px-3 py-2 border-b border-gray-700">254</td>

            <td class="px-3 py-2 border-b border-gray-700">185</td>

            <td class="px-3 py-2 border-b border-gray-700">51</td>

            <td class="px-3 py-2 border-b border-gray-700">0</td>

            <td class="px-3 py-2 border-b border-gray-700">123</td>

            <td class="px-3 py-2 border-b border-gray-700">85</td>

            <td class="px-3 py-2 border-b border-gray-700">136</td>

            <td class="px-3 py-2 border-b border-gray-700">0</td>

            <td class="px-3 py-2 border-b border-gray-700">35</td>

            <td class="px-3 py-2 border-b border-gray-700">42</td>

            <td class="px-3 py-2 border-b border-gray-700">131</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">2</td>

            <td class="px-3 py-2 border-b border-gray-700">20</td>

            <td class="px-3 py-2 border-b border-gray-700">254</td>

            <td class="px-3 py-2 border-b border-gray-700">254</td>

            <td class="px-3 py-2 border-b border-gray-700">51</td>

            <td class="px-3 py-2 border-b border-gray-700">185</td>

            <td class="px-3 py-2 border-b border-gray-700">123</td>

            <td class="px-3 py-2 border-b border-gray-700">0</td>

            <td class="px-3 py-2 border-b border-gray-700">136</td>

            <td class="px-3 py-2 border-b border-gray-700">85</td>

            <td class="px-3 py-2 border-b border-gray-700">35</td>

            <td class="px-3 py-2 border-b border-gray-700">0</td>

            <td class="px-3 py-2 border-b border-gray-700">131</td>

            <td class="px-3 py-2 border-b border-gray-700">42</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">3</td>

            <td class="px-3 py-2 border-b border-gray-700">225</td>

            <td class="px-3 py-2 border-b border-gray-700">169</td>

            <td class="px-3 py-2 border-b border-gray-700">169</td>

            <td class="px-3 py-2 border-b border-gray-700">89</td>

            <td class="px-3 py-2 border-b border-gray-700">145</td>

            <td class="px-3 py-2 border-b border-gray-700">0</td>

            <td class="px-3 py-2 border-b border-gray-700">234</td>

            <td class="px-3 py-2 border-b border-gray-700">168</td>

            <td class="px-3 py-2 border-b border-gray-700">92</td>

            <td class="px-3 py-2 border-b border-gray-700">0</td>

            <td class="px-3 py-2 border-b border-gray-700">93</td>

            <td class="px-3 py-2 border-b border-gray-700">113</td>

            <td class="px-3 py-2 border-b border-gray-700">228</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">4</td>

            <td class="px-3 py-2 border-b border-gray-700">255</td>

            <td class="px-3 py-2 border-b border-gray-700">169</td>

            <td class="px-3 py-2 border-b border-gray-700">169</td>

            <td class="px-3 py-2 border-b border-gray-700">145</td>

            <td class="px-3 py-2 border-b border-gray-700">89</td>

            <td class="px-3 py-2 border-b border-gray-700">234</td>

            <td class="px-3 py-2 border-b border-gray-700">0</td>

            <td class="px-3 py-2 border-b border-gray-700">92</td>

            <td class="px-3 py-2 border-b border-gray-700">168</td>

            <td class="px-3 py-2 border-b border-gray-700">93</td>

            <td class="px-3 py-2 border-b border-gray-700">0</td>

            <td class="px-3 py-2 border-b border-gray-700">228</td>

            <td class="px-3 py-2 border-b border-gray-700">113</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">5</td>

            <td class="px-3 py-2 border-b border-gray-700">254</td>

            <td class="px-3 py-2 border-b border-gray-700">213</td>

            <td class="px-3 py-2 border-b border-gray-700">213</td>

            <td class="px-3 py-2 border-b border-gray-700">210</td>

            <td class="px-3 py-2 border-b border-gray-700">204</td>

            <td class="px-3 py-2 border-b border-gray-700">0</td>

            <td class="px-3 py-2 border-b border-gray-700">247</td>

            <td class="px-3 py-2 border-b border-gray-700">79</td>

            <td class="px-3 py-2 border-b border-gray-700">22</td>

            <td class="px-3 py-2 border-b border-gray-700">0</td>

            <td class="px-3 py-2 border-b border-gray-700">140</td>

            <td class="px-3 py-2 border-b border-gray-700">168</td>

            <td class="px-3 py-2 border-b border-gray-700">58</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">6</td>

            <td class="px-3 py-2 border-b border-gray-700">80</td>

            <td class="px-3 py-2 border-b border-gray-700">213</td>

            <td class="px-3 py-2 border-b border-gray-700">213</td>

            <td class="px-3 py-2 border-b border-gray-700">204</td>

            <td class="px-3 py-2 border-b border-gray-700">210</td>

            <td class="px-3 py-2 border-b border-gray-700">247</td>

            <td class="px-3 py-2 border-b border-gray-700">0</td>

            <td class="px-3 py-2 border-b border-gray-700">22</td>

            <td class="px-3 py-2 border-b border-gray-700">79</td>

            <td class="px-3 py-2 border-b border-gray-700">140</td>

            <td class="px-3 py-2 border-b border-gray-700">0</td>

            <td class="px-3 py-2 border-b border-gray-700">58</td>

            <td class="px-3 py-2 border-b border-gray-700">168</td>

          </tr>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">Total Break of Zorro using Linear and Differential Attacks</p>

    <p class="text-gray-300">The full key recovery attack on full-round Zorro proceeds in three phase. In first and second phases, we recover 32, and in third phase, we recover only 16 linear relations between bits of the secret key.</p>

    <h6 id="sec-12" class="text-base font-medium mt-4">Phase 1.</h6>

    <p class="text-gray-300">Recovering 32 Relations Between Bits of Key. Using each of the six 4-round iterated differentials introduced in Table 2, we can construct a 23-round (<span class="math">=5</span> steps + 3 rounds) differential characteristics with probability of</p>

    <p class="text-gray-300"><span class="math">P_{23r}=(P_{4r})^{5}\\times P_{3r}=2^{-10.83\\times 5}\\times 1=2^{-54.15}</span> (4)</p>

    <p class="text-gray-300">Note that the last three rounds of this characteristics have no cost in probability, i.e. <span class="math">P_{3r}=1</span>. Since <span class="math">P_{23r}</span> is too far from that of a Pseudo Random Permutation (<span class="math">2^{-128}</span>), such a 23-round distinguisher can be successfully used to distinguish the correct key from the wrong key in a 24-round attack.</p>

    <p class="text-gray-300">In the following, we explain a key recovery attack on full round Zorro which extracts 32 bits information of the secret key <span class="math">K</span>. Similar to <em>[1, 6]</em>, a structural attack which merges three differential characteristics simultaneously requires less data here. We also change the order of <span class="math">MC</span> and <span class="math">AK</span> in the last round where the equivalent key <span class="math">K^{\\prime}=MC^{-1}(K)</span> is added before <span class="math">MC</span>. In fact, this attack recovers 32 bits of the first row of <span class="math">K^{\\prime}</span>, each of which is a linear function of <span class="math">K</span>, in two procedures: In the first one, we find exact value of the second and fourth bytes of first row by using iterated differential characteristics respected to No. 1, 3 and 5 of Table 2; In the other one, exact value of the first and third bytes are recovered respected to No. 2, 4 and 6 of Table 2. At the end, we will come up with <span class="math">2^{96}</span> key candidates for the whole 128-bit key.</p>

    <p class="text-gray-300">!<a href="img-1.jpeg">img-1.jpeg</a> Figure 2: Differential characteristics on 23-round Zorro</p>

    <p class="text-gray-300">##</p>

    <ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">

      <li>Choosing the Plaintext Pairs</li>

    </ol>

    <p class="text-gray-300">Our Attack is a structural chosen plaintext attack, where we choose structures with <span class="math">2^{3}</span> plaintexts according to differential characteristics respected to No. 1, 3 and 5 of Table 2, and all the plaintexts in every structure are queried from the encryption oracle to get the corresponding ciphertexts. For having at least one correct differential pair we must have normally <span class="math">p^{-1}</span> differential pairs. But in this attack, determining exact value of relation between key bits needs two correct differential pairs. So we must have <span class="math">2\\times p^{-1}</span> differential pairs which is equal to <span class="math">\\frac{1}{12}\\times 2\\times p^{-1}=\\frac{1}{6}\\times p^{-1}</span> structures containing <span class="math">2^{3}\\times\\frac{1}{6}\\times p^{-1}=\\frac{4}{3}\\times p^{-1}</span> plaintexts. The precise relation between number of structures and number of differential pairs can be found in Appendix 0.A.</p>

    <ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">

      <li>Filtering the Ciphertext Pairs</li>

    </ol>

    <p class="text-gray-300">Partially decrypt all the ciphertext pairs generated in Step 1 to get their corresponding difference in the output of <span class="math">SB^{*}</span> of round 24. Keep only those pairs that satisfy the condition in the three lowest row of #10 as well as the two zero differences in the first row (see Fig. 2). After this filtering only a fraction of <span class="math">2^{-112}</span> wrong differential pairs remains, while we have only <span class="math">2^{55.15}</span> pairs. So, only 2 correct differential pairs remain which can be used to distinguish the right key from the wrong keys.</p>

    <ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">

      <li>Recovering 16 bits of <span class="math">K^{\\prime}</span></li>

    </ol>

    <p class="text-gray-300">Guess the two bytes of the first row of <span class="math">K^{\\prime}</span> corresponding to those two active S-Boxes, and partially decrypt the remaining pairs to get their differences in the first row of the input of round 24. As we have 2 correct differential pairs, we can determine the exact value of these 16 bits.</p>

    <p class="text-gray-300">A similar procedure can be repeated for the other two active S-Boxes to find the other two bytes in the first row.</p>

    <h4 id="sec-13" class="text-lg font-semibold mt-6">Phases 2 & 3. Recovering the 96 Remaining Key Bits.</h4>

    <p class="text-gray-300">If we replace the state of #1 by #4 or #7 in Fig. 1, we will come up with another 6 iterated differential characteristics, which can be used to construct 22 or 21-round differential characteristics with the same probability of <span class="math">P_{22r}=P_{21r}=2^{-54.15}</span>.</p>

    <p class="text-gray-300">The steps of Phase 2 are similar to that of Phase 1 with two minor differences: In Step 2, the ciphertext differences are filtered in two levels: First in round 24, before <span class="math">MC</span> transformation, which 6 Bytes must be a constant. And the second, after partial decrypting round 24 using the 32 bits of <span class="math">K^{\\prime}</span> retrieved in Phase 1, that 8 bytes must be constant. Also, in Step 3, We need to guess 16 bits of <span class="math">K^{\\prime\\prime}</span>, where <span class="math">K^{\\prime\\prime}=MC^{-1}(SR^{-1}(K^{\\prime}</span> with all bits 0 in the first row)).</p>

    <p class="text-gray-300">In this phase, we partially decrypt all the ciphertexts in the structure for one round . But in <span class="math">AC</span> layer of round 24, in addition to round constant, we add bit-wisely the first row of <span class="math">K^{\\prime}</span> which was found in Phase 1, and continue the rest of the attack similar to Phase 1. We guess all the <span class="math">2^{16}</span> keys involved in active S-Boxes, and repeat this procedure once more to get the other 16 key bits. So, we can finally find 32 bits of the first row of <span class="math">K^{\\prime\\prime}</span>.</p>

    <p class="text-gray-300">But in Phase 3, we make use of 21-round differentials and find some values for only 16 bits of <span class="math">K^{\\prime\\prime\\prime}</span>, where <span class="math">K^{\\prime\\prime\\prime}=MC^{-1}(SR^{-1}(K^{\\prime\\prime}</span> with all bits 0 in the</p>

    <p class="text-gray-300">first row)). In this phase we only need one correct differential pair and only for 2 bytes, it is because of time complexity that be the minimum one. According to DDT of Zorro, there will be only about 6.6 accepted values for this 16 bits. We do similar to Phase 2, except that at first all the ciphertexts in the structure are partially decrypted for one rounds, and in <span class="math">AC</span> layers, in addition to round constant, we add the first row of <span class="math">K^{\\prime}</span> in round 23, and the first row of <span class="math">K^{\\prime\\prime}</span> in round 22.</p>

    <p class="text-gray-300">Finally, by using the information retrieved from <span class="math">K^{\\prime}</span>, <span class="math">K^{\\prime\\prime}</span> and <span class="math">K^{\\prime\\prime\\prime}</span>, we end up with only <span class="math">6.6\\times 2^{48}</span> candidates for the 128-bit secret key <span class="math">K</span>. With an exhaustive search on these candidate key, we can find the whole 128 bits of secret key.</p>

    <h3 id="sec-14" class="text-xl font-semibold mt-8">3.3 Complexities</h3>

    <ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">

      <li>Data Complexity</li>

    </ol>

    <p class="text-gray-300">In Phases 1 and 2 we use two times <span class="math">\\frac{4}{3}\\times p^{-1}</span> plaintexts and their corresponding ciphertexts. But, in Phase 3 we use one time <span class="math">\\frac{2}{3}\\times p^{-1}</span> plaintext and ciphertext pairs. So, data complexity of our attack will be:</p>

    <p class="text-gray-300"><span class="math">D=\\frac{2}{3}\\times p^{-1}\\times(2\\times 2+2\\times 2+1)=6\\times p^{-1}=2^{56.73}</span></p>

    <ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">

      <li>Time Complexity</li>

    </ol>

    <p class="text-gray-300">As most time of a round is used on its <span class="math">SB^{*}</span> transformation, we don’t calculate the <span class="math">MC</span> transformations in filtering steps. Therefore computation time of Phases 1 and 2 are only in step 1 for producing ciphertexts. But in Phase 3 we must partially decrypt all ciphertexts for one round. And finally, we must check all remaining key candidates. Hence, time complexity will be:</p>

    <p class="text-gray-300"><span class="math">T=D+\\frac{1}{24}\\times\\frac{2}{3}\\times p^{-1}+6.6\\times 2^{48}=2^{56.76}</span></p>

    <ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">

      <li>Memory Complexity</li>

    </ol>

    <p class="text-gray-300">The memory required for attack is negligible that contains <span class="math">2^{3}</span> blocks for saving one structure, 3 blocks for saving 3 states of state #10 in Fig. 1 and 16 bytes for saving S-Box which at all is equal to 12 blocks of 128 bits.</p>

    <h2 id="sec-15" class="text-2xl font-bold">4 Linear Cryptanalysis</h2>

    <p class="text-gray-300">The procedure of linear attack is very similar to that of differential attack, presented in Section 3. We first try to find iterated linear trails with a high correlation for one step of the algorithm. Then we make use of this trail to construct 23, 22 and 21-round linear distinguishers, which are used for a key recovery attack on the full-round Zorro.</p>

    <p class="text-gray-300">Shahram Rasoolzadeh et al.</p>

    <p class="text-gray-300">Same as the way of finding iterated differential characteristics in Section 3.1, we can find iterated linear trails for Zorro. There exists some iterated linear trials for one step of Zorro whose patterns are identical to that of differential characteristics given in Fig. 1, where the gray bytes are the ones with a nonzero mask. For satisfying conditions of  <span class="math">MC</span>  transformation between states of (#3, #4), (#6, #7) and (#12, #1), we use 3 lemmas about the correlation matrixes of boolean functions in [10]. All these conditions are presented in detail in Appendix C which result in the following representation of all the variables based on  <span class="math">Q</span>  and  <span class="math">R</span> .</p>

    <p class="text-gray-300"><span class="math">\\mathrm{A} = 10\\mathrm{Q}\\oplus \\mathrm{R}</span>  ，  <span class="math">\\mathrm{B} = \\mathrm{Q}\\oplus 10\\mathrm{R}</span>  ，  <span class="math">\\mathrm{C} = 13\\mathrm{Q}\\oplus \\mathrm{R}</span>  ，  <span class="math">\\mathrm{D} = 13\\mathrm{Q}\\oplus \\mathrm{R}</span></p>

    <p class="text-gray-300"><span class="math">\\mathrm{E} = \\mathrm{Q}\\oplus 8\\mathrm{R}</span>  ，  <span class="math">\\mathrm{F} = 8\\mathrm{Q}\\oplus \\mathrm{R}</span>  ，  <span class="math">\\mathrm{G} = 3\\mathrm{Q}\\oplus 4\\mathrm{R}</span>  ，  <span class="math">\\mathrm{H} = 4\\mathrm{Q}\\oplus 3\\mathrm{R}</span></p>

    <p class="text-gray-300"><span class="math">\\mathrm{I} = \\mathrm{Q}\\oplus 5\\mathrm{R}</span>  ，  <span class="math">\\mathrm{J} = 5\\mathrm{Q}\\oplus \\mathrm{R}</span>  ，  <span class="math">\\mathrm{K} = 2\\mathrm{Q}\\oplus 3\\mathrm{R}</span>  ，  <span class="math">\\mathrm{L} = 3\\mathrm{Q}\\oplus 2\\mathrm{R}</span></p>

    <p class="text-gray-300"><span class="math">\\mathrm{M} = 2\\mathrm{Q}\\oplus \\mathrm{R}</span>  ，  <span class="math">\\mathrm{N} = \\mathrm{Q}\\oplus 2\\mathrm{R}</span>  ，  <span class="math">\\mathrm{O} = \\mathrm{Q}\\oplus \\mathrm{R}</span>  ，  <span class="math">\\mathrm{P} = \\mathrm{Q}\\oplus \\mathrm{R}</span></p>

    <p class="text-gray-300"><span class="math">\\mathrm{S} = 20\\mathrm{Q}\\oplus 4\\mathrm{R}</span>  ，  <span class="math">\\mathrm{T} = 4\\mathrm{Q}\\oplus 20\\mathrm{R}</span>  ，  <span class="math">\\mathrm{U} = 7\\mathrm{Q}\\oplus 24\\mathrm{R}</span>  ，  <span class="math">\\mathrm{V} = 24\\mathrm{Q}\\oplus 7\\mathrm{R}</span></p>

    <p class="text-gray-300"><span class="math">\\mathrm{W} = 17\\mathrm{Q}\\oplus 5\\mathrm{R}</span>  ，  <span class="math">\\mathrm{X} = 5\\mathrm{Q}\\oplus 17\\mathrm{R}</span>  ，  <span class="math">\\mathrm{Y} = 6\\mathrm{Q}\\oplus 31\\mathrm{R}</span>  ，  <span class="math">\\mathrm{Z} = 31\\mathrm{Q}\\oplus 6\\mathrm{R}</span></p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">The only nonlinear parts involved in this trail are the active S-Boxes of state #10 that the absolute correlation supposed to be  $</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">c</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"><span class="math"> . Again, we have 2 degrees of freedom,  </span>Q<span class="math">  and  </span>R<span class="math">  to maximize  </span></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">c</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"><span class="math"> . So we can set one of  </span>S<span class="math">  or  </span>T$  to zero.</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <div class="my-4 text-center"><span class="math-block">\\left\\{ \\begin{array}{c} S = 0 \\Rightarrow R = 5 Q \\\\ o r \\\\ T = 0 \\Rightarrow Q = 5 R \\end{array} \\right. \\tag {6}</span></div>

    <p class="text-gray-300">which in two cases yields</p>

    <div class="my-4 text-center"><span class="math-block"></span></div>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\left</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">c _ {4 r} \\right</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">= \\max  _ {1 \\leq x \\leq 2 5 5} C \\left(\\Gamma_ {\\text {i n p u t}} = x, \\Gamma_ {\\text {o u t p u t}} = x\\right) ^ {2}. \\tag {7}</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <div class="my-4 text-center"><span class="math-block"></span></div>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Which  <span class="math">\\Gamma</span>  is the linear mask for one byte. After searching the LAT of Zorro S-box, the largest linear correlation occurs when  <span class="math">x = 136</span> . With this setting the absolute of the corresponding correlation would be  $</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">c_{4r}</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">= (\\frac{28}{128})^2 \\simeq 2^{-4.39}<span class="math"> . Also, we can find new linear trails with the same correlation, if we change the relative location of #1 with #4, #7 or #10. In Table, each row shows the mask values  </span>A, \\ldots, Z$  corresponding to one of the above-mentioned linear trail.</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">Table 3. Two iterated linear trails for one step</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">No.</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">A</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">B</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">C</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">D</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">E</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">F</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">G</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">H</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">I</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">J</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">K</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">L</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">M</th>

          </tr>

        </thead>

        <tbody>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">1</td>

            <td class="px-3 py-2 border-b border-gray-700">177</td>

            <td class="px-3 py-2 border-b border-gray-700">97</td>

            <td class="px-3 py-2 border-b border-gray-700">227</td>

            <td class="px-3 py-2 border-b border-gray-700">227</td>

            <td class="px-3 py-2 border-b border-gray-700">191</td>

            <td class="px-3 py-2 border-b border-gray-700">126</td>

            <td class="px-3 py-2 border-b border-gray-700">130</td>

            <td class="px-3 py-2 border-b border-gray-700">126</td>

            <td class="px-3 py-2 border-b border-gray-700">34</td>

            <td class="px-3 py-2 border-b border-gray-700">0</td>

            <td class="px-3 py-2 border-b border-gray-700">126</td>

            <td class="px-3 py-2 border-b border-gray-700">251</td>

            <td class="px-3 py-2 border-b border-gray-700">160</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">2</td>

            <td class="px-3 py-2 border-b border-gray-700">97</td>

            <td class="px-3 py-2 border-b border-gray-700">177</td>

            <td class="px-3 py-2 border-b border-gray-700">227</td>

            <td class="px-3 py-2 border-b border-gray-700">227</td>

            <td class="px-3 py-2 border-b border-gray-700">126</td>

            <td class="px-3 py-2 border-b border-gray-700">191</td>

            <td class="px-3 py-2 border-b border-gray-700">126</td>

            <td class="px-3 py-2 border-b border-gray-700">130</td>

            <td class="px-3 py-2 border-b border-gray-700">0</td>

            <td class="px-3 py-2 border-b border-gray-700">34</td>

            <td class="px-3 py-2 border-b border-gray-700">251</td>

            <td class="px-3 py-2 border-b border-gray-700">126</td>

            <td class="px-3 py-2 border-b border-gray-700">52</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">No.</td>

            <td class="px-3 py-2 border-b border-gray-700">N</td>

            <td class="px-3 py-2 border-b border-gray-700">O</td>

            <td class="px-3 py-2 border-b border-gray-700">P</td>

            <td class="px-3 py-2 border-b border-gray-700">Q</td>

            <td class="px-3 py-2 border-b border-gray-700">R</td>

            <td class="px-3 py-2 border-b border-gray-700">S</td>

            <td class="px-3 py-2 border-b border-gray-700">T</td>

            <td class="px-3 py-2 border-b border-gray-700">U</td>

            <td class="px-3 py-2 border-b border-gray-700">V</td>

            <td class="px-3 py-2 border-b border-gray-700">W</td>

            <td class="px-3 py-2 border-b border-gray-700">X</td>

            <td class="px-3 py-2 border-b border-gray-700">Y</td>

            <td class="px-3 py-2 border-b border-gray-700">Z</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">---</td>

            <td class="px-3 py-2 border-b border-gray-700">---</td>

            <td class="px-3 py-2 border-b border-gray-700">---</td>

            <td class="px-3 py-2 border-b border-gray-700">---</td>

            <td class="px-3 py-2 border-b border-gray-700">---</td>

            <td class="px-3 py-2 border-b border-gray-700">---</td>

            <td class="px-3 py-2 border-b border-gray-700">---</td>

            <td class="px-3 py-2 border-b border-gray-700">---</td>

            <td class="px-3 py-2 border-b border-gray-700">---</td>

            <td class="px-3 py-2 border-b border-gray-700">---</td>

            <td class="px-3 py-2 border-b border-gray-700">---</td>

            <td class="px-3 py-2 border-b border-gray-700">---</td>

            <td class="px-3 py-2 border-b border-gray-700">---</td>

            <td class="px-3 py-2 border-b border-gray-700">---</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">1</td>

            <td class="px-3 py-2 border-b border-gray-700">52</td>

            <td class="px-3 py-2 border-b border-gray-700">133</td>

            <td class="px-3 py-2 border-b border-gray-700">133</td>

            <td class="px-3 py-2 border-b border-gray-700">234</td>

            <td class="px-3 py-2 border-b border-gray-700">234</td>

            <td class="px-3 py-2 border-b border-gray-700">0</td>

            <td class="px-3 py-2 border-b border-gray-700">136</td>

            <td class="px-3 py-2 border-b border-gray-700">95</td>

            <td class="px-3 py-2 border-b border-gray-700">37</td>

            <td class="px-3 py-2 border-b border-gray-700">0</td>

            <td class="px-3 py-2 border-b border-gray-700">170</td>

            <td class="px-3 py-2 border-b border-gray-700">163</td>

            <td class="px-3 py-2 border-b border-gray-700">234</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">2</td>

            <td class="px-3 py-2 border-b border-gray-700">152</td>

            <td class="px-3 py-2 border-b border-gray-700">133</td>

            <td class="px-3 py-2 border-b border-gray-700">133</td>

            <td class="px-3 py-2 border-b border-gray-700">234</td>

            <td class="px-3 py-2 border-b border-gray-700">234</td>

            <td class="px-3 py-2 border-b border-gray-700">136</td>

            <td class="px-3 py-2 border-b border-gray-700">0</td>

            <td class="px-3 py-2 border-b border-gray-700">37</td>

            <td class="px-3 py-2 border-b border-gray-700">95</td>

            <td class="px-3 py-2 border-b border-gray-700">170</td>

            <td class="px-3 py-2 border-b border-gray-700">0</td>

            <td class="px-3 py-2 border-b border-gray-700">234</td>

            <td class="px-3 py-2 border-b border-gray-700">163</td>

          </tr>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">4.2 Key recovery</p>

    <p class="text-gray-300">Similar to that of differential attack, the full key recovery attack on full-round Zorro proceeds in three phase. In each phases, we recover 32 linear relations between bits of the of secret key.</p>

    <h4 id="sec-17" class="text-lg font-semibold mt-6">4.2.1 Phase 1. Recovering the 32 Bits of Key.</h4>

    <p class="text-gray-300">Using each of the two 4-round iterated linear trails in Table 3, we can construct a 23-round (= 5 steps + 3 rounds) linear trail with the correlation of</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">$</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">c_{23r}</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">=</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">c_{4r}</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">^{5}\\times</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">c_{3r}</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">=2^{-4.39\\times 5}=2^{-21.93}$ (8)</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">This 23-round linear trail is similar to the 23-round differential characteristic given in Fig. 2. Since $</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">c_{23r}</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"><span class="math"> is much larger than that of a Pseudo Random Permutation, </span></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">c_{PRP}</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">=0$, such a 23-round distinguisher can be successfully used to distinguish the correct key from the wrong key in a 24-round attack.</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">In the following, we explain a key recovery attack on full round Zorro which extracts 32 bits of the first row of <span class="math">K^{\\prime}</span>, in two parallel procedures: First, we find the second and fourth bytes of the first row of <span class="math">K^{\\prime}</span> by using iterated linear trails respected to No. 1 of Table 3. Then, first and third bytes of key respected to No. 2 of Table 3 gets found.</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">With the assumption that the secret key is randomly chosen from the whole key space, the amount of plaintext/ciphertext pairs required for this attack would be $</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">c_{23r}</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">^{-2}=2^{43.85}$ as discussed in <em>[2]</em>. The steps of this phase of attack are as follows:</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">Data Collection Ask the corresponding ciphertexts <span class="math">2^{43.85}</span> of randomly generated plaintexts from the encryption oracle. Data Processing Compute</p>

    <p class="text-gray-300"><span class="math">\\alpha=\\Gamma_{\\#1}\\cdot P\\oplus\\Gamma_{\\#10,rows\\ 2,3,4}\\cdot C^{\\prime}_{rows\\ 2,3,4}</span> (9)</p>

    <p class="text-gray-300">where <span class="math">P</span> is the plaintext, <span class="math">C^{\\prime}</span> is the one-round partially decrypted ciphertext, <span class="math">\\cdot</span> represent the dot product, and <span class="math">\\Gamma_{\\#n}</span> is the linear mask for state <span class="math">\\#n</span> in No.1 linear trail given in Table 3. Checking the second and fourth bytes of <span class="math">K^{\\prime}</span> Guess the second and fourth bytes of <span class="math">K^{\\prime}</span>, partially decrypt the ciphertext to get the first row of <span class="math">C^{\\prime}</span> for every <span class="math">2^{16}</span> guesses. Compute</p>

    <p class="text-gray-300"><span class="math">\\beta=\\Gamma_{\\#10,row\\ 1}\\cdot C^{\\prime}_{row\\ 1}</span> (10) Checking the first and third bytes of <span class="math">K^{\\prime}</span> Repeat Steps 2 and 3 for these two bytes of key.</p>

    <p class="text-gray-300">At the end of this procedure, all the four bytes of <span class="math">K^{\\prime}</span>’s first row are introduced.</p>

    <p class="text-gray-300">In Step 3 we use a matrix with size of <span class="math">256\\times 256</span>, and index of <span class="math">(i,j)</span> matrix shows the sum of mask for S-Box input which its output equals to bit-wisely</p>

    <p class="text-gray-300">sum of <span class="math">i</span> and <span class="math">j</span>. For each active S-Box we take the <span class="math">x</span>-th row of the matrix, that <span class="math">x</span> is equal to output of S-Box in partially decrypted ciphertext. We have only two active S-Boxes, So first arrow is for 8 bits of key for the first active S-Box and the second arrow is for 8 bits of key for the second active S-Box. In each arrow <span class="math">j</span>’th bit shows sum of mask for S-Box input which output is <span class="math">j</span> bit-wisely added to partially decrypted ciphertext. With this method we can check for all <span class="math">2^{16}</span> keys, whether <span class="math">\\beta</span> equals to <span class="math">\\alpha</span> or not, with a negligible time for each pliantext/ciphertext pairs.</p>

    <h4 id="sec-18" class="text-lg font-semibold mt-6">3.0.2 Phases 2 & 3. Recovering the 96 Remaining Key Bits.</h4>

    <p class="text-gray-300">Look like full-key recovery attack in Phase 2 and 3 of differential cryptanalysis, we use 22 and 21-round linear distinguishers with <span class="math">c_{22r}=c_{21r}=2^{-21.93}</span> which works with an amount of <span class="math">2^{43.85}</span> known plaintexts. Except that at Phase 2 and 3, using found key bits we must partially decrypt ciphertext for one and two rounds, respectively. After reducing the key candidates to <span class="math">2^{32}</span>, we do a exhaustive search on the key candidates to get the secret key.</p>

    <h4 id="sec-19" class="text-lg font-semibold mt-6">3.0.3 Complexities</h4>

    <ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">

      <li>Data Complexity</li>

    </ol>

    <p class="text-gray-300">As mentioned before, for each phase we need about <span class="math">2^{43.85}</span> known plaintexts. So data complexity of linear attack will be:</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">$D=3\\times</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">c_{23r}</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">^{2}=2^{45.44}$</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">

      <li>Time Complexity</li>

    </ol>

    <p class="text-gray-300">We actually separated Steps 2 and 3 to avoid some unnecessary repetitions in attack computations in practice. Though this two steps have a negligible time in total, compared to Step 1 which must produce ciphertext for a random plaintext. Also in Phase 2 and 3 we need to partially decrypt the ciphertexts. So, time complexity for any of this phases equals to:</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">$T=</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">c_{23r}</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">^{2}\\times(1+1+\\frac{1}{24}+1+\\frac{2}{24})=</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">c_{23r}</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">^{2}\\times\\frac{25}{8}=2^{45.50}$</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">

      <li>Memory Complexity</li>

    </ol>

    <p class="text-gray-300">Since the procedure of recovering the two 16 bits of first row of <span class="math">K^{\\prime}</span> are performed in parallel, it is necessary to have enough memory for each <span class="math">2\\times 2^{16}</span> keys (5 bytes are enough for a counter), which is independent of number of datas. Another memory complexity is to saving <span class="math">256\\times 256</span> bits matrices. All needed memory is equal to <span class="math">2^{15.34}</span> blocks of 128 bits.</p>

    <p class="text-gray-300">All in all, the time, data and memory complexity for the proposed key recovery attack on full-round Zorro are <span class="math">2^{45.44},2^{45.44}</span>, and <span class="math">2^{17}</span>, respectively.</p>

    <h4 id="sec-20" class="text-lg font-semibold mt-6">3.0.4</h4>

    <p class="text-gray-300">5 Practical Results</p>

    <p class="text-gray-300">We have experimentally verified the efficiency of the proposed attacks by simulating some variants by a C++ code. As described in Sections 3 and 4, the complete key is recovered in 3 phases, in each phase we find some linear equations, and then find the right key from remaining candidates with an exhaustive search. We precisely implemented the 3 phases of the attack, excluding the exhaustive search of the last remaining candidates.</p>

    <p class="text-gray-300">In particular, this attack can be well regarded as the first successful practical attack on full-round Zorro. We used a PC with an Intel(R) Core(TM) i7 CPU Q740 at 1.73GHz, and with 4GB of RAM. Our results show that the proposed attack on 12 and 16 round-reduced variants of Zorro works and recovers the correct key as expected theoretically.</p>

    <h2 id="sec-21" class="text-2xl font-bold">6 Conclusions</h2>

    <p class="text-gray-300">In this paper, we presented an approach to break the full-round version of Zorro by using differential and linear cryptanalysis with practical complexities. These attacks works for all the key space and make use of 23, 22 and 21-round differential characteristics or linear trails. While differential cryptanalysis has a time complexity of <span class="math">2^{56.76}</span> full round encryption and data complexity of <span class="math">2^{56.73}</span> chosen plaintexts, linear cryptanalysis has a time complexity of <span class="math">2^{45.44}</span> full round encryption and data complexity of <span class="math">2^{45.50}</span> known plaintexts. Some reduced-round variants of both attacks have been simulated which absolutely validates the theoretically estimated complexities.</p>

    <p class="text-gray-300">As far as we know, this is the first practical attack on full-round Zorro which along with the previous cryptanalyses shows that the partial nonlinearity in the design of Zorro has obviously sacrificed the security for efficiency.</p>

    <h2 id="sec-22" class="text-2xl font-bold">References</h2>

    <ul class="list-disc list-inside space-y-1 text-gray-300 my-2 ml-4">

      <li>[1] E. Biham and A. Shamir. “Differential cryptanalysis of DES-like cryptosystems”. Advances in Cryptology - CRYPTO 1990, LNCS, vol. 537, pp. 2–21. Springer, 1991.</li>

      <li>[2] M. Matsui. “Linear cryptanalysis method for DES cipher”. Advances in Cryptology - EUROCRYPT 1993, LNCS, vol. 765, pp. 386–397. Springer, 1994.</li>

      <li>[3] B. Gérard, V. Grosso, M. Naya-Plasencia, and F.-X. Standaert. “Block ciphers that are easier to mask: How far can we go?”. Cryptographic Hardware and Embedded Systems (CHES) 2013, LNCS, vol. 8086, pp. 383–399. Springer, 2013.</li>

      <li>[4] J. Guo, T. Peyrin, A. Poschmann, and M. Robshaw. “The LED block cipher”. Cryptographic Hardware and Embedded Systems (CHES) 2011, LNCS, vol. 6917, pp. 326–341. Springer, 2011.</li>

      <li>[5] J. Guo, I. Nikolić, T. Peyrin, and L. Wang. “Cryptanalysis of Zorro”. Cryptology ePrint Archive, Report 2013/713, 2013.</li>

      <li>[6] Y. Wang, W. Wu, Z. Guo, and X. Yu. “Differential Cryptanalysis and Linear Distinguisher of Full-Round Zorro”. Cryptology ePrint Archive, Report 2013/713, 2013.</li>

    </ul>

    <ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">

      <li>H. Soleimany. “Probabilistic Slide Cryptanalysis and Its Applications to LED-64 and Zorro”. In the proceeding of the 21st International Workshop on Fast Software Encryption (FSE) 2014.</li>

      <li>A. Bar-On, I. Dinur, O. Dunkelman, N. Keller, V. Lallemand, M. Naya-Plasencia, B. Tsaban, and A. Shamir. “New Results on Zorro”. In the rump session of the 21st International Workshop on Fast Software Encryption (FSE) 2014. http://fse.2014.rump.cr.yp.to/</li>

      <li>A. Bar-On, I. Dinur, O. Dunkelman, V. Lallemand, and B. Tsaban. “Improved Analysis of Zorro-Like Ciphers”. Cryptology ePrint Archive, Report 2014/228, 2014.</li>

      <li>J. Daemen and V. Rijmen. “The Design of Rijndael”. Springer-Verlag New York, Inc., Secaucus, NJ, USA, 2002.</li>

    </ol>

    <h2 id="sec-23" class="text-2xl font-bold">Appendix 0.A Structural Chosen Plaintext</h2>

    <p class="text-gray-300">Assume that we have <span class="math">x</span> differential characteristics and we are going to choose minimum number of plaintexts that provide enough pairs for these <span class="math">x</span> differential characteristics. Let’s define a graph in which the vertexes are the plaintexts and the edges are the valid differential pairs. For any node we have <span class="math">x</span> edges and the number of nodes are <span class="math">2^{x}</span>. So, we have <span class="math">x\\times 2^{x-1}</span> differential plaintext pairs, in total. Thus, the ratio of the chosen plaintexts to the differential plaintext pairs in a structure is <span class="math">\\frac{2}{x}</span>. This method is an extension of what was proposed in <em>[1]</em> for generating data.</p>

    <h2 id="sec-24" class="text-2xl font-bold">Appendix 0.B Differential Characteristic Conditions</h2>

    <p class="text-gray-300">The conditions that must be satisfied for the differential characteristic are formulated as below. The condition for <span class="math">MC</span> transformation between states (#3, #4) results:</p>

    <p class="text-gray-300">\\[ \\left\\{\\begin{array}[]{l}\\mathrm{E}=3\\mathrm{A}\\oplus\\mathrm{D}\\\\ \\mathrm{F}=3\\mathrm{B}\\oplus\\mathrm{C}\\end{array}\\right.\\Rightarrow\\left\\{\\begin{array}[]{l}\\mathrm{G}=\\mathrm{B}\\oplus 2\\mathrm{C}\\quad,\\ \\mathrm{H}=\\mathrm{A}\\oplus 2\\mathrm{D}\\\\ \\mathrm{I}=4\\mathrm{B}\\oplus\\mathrm{C}\\quad,\\ \\mathrm{J}=4\\mathrm{A}\\oplus\\mathrm{D}\\\\ \\mathrm{K}=7\\mathrm{B}\\oplus 3\\mathrm{C}\\ ,\\ \\mathrm{L}=7\\mathrm{A}\\oplus 3\\mathrm{D}\\end{array}\\right. \\] (11)</p>

    <p class="text-gray-300">The condition for <span class="math">MC</span> transformation between states (#6, #7) results:</p>

    <p class="text-gray-300">\\[ \\left\\{\\begin{array}[]{l}\\mathrm{K}=3\\mathrm{G}\\oplus\\mathrm{J}\\\\ \\mathrm{L}=3\\mathrm{H}\\oplus\\mathrm{I}\\end{array}\\right.\\Rightarrow\\left\\{\\begin{array}[]{l}\\mathrm{M}=\\mathrm{H}\\oplus 2\\mathrm{I}\\quad,\\ \\mathrm{N}=\\mathrm{G}\\oplus 2\\mathrm{J}\\\\ \\mathrm{O}=4\\mathrm{H}\\oplus\\mathrm{I}\\quad,\\ \\mathrm{P}=4\\mathrm{G}\\oplus\\mathrm{J}\\\\ \\mathrm{Q}=7\\mathrm{H}\\oplus 3\\mathrm{I}\\ ,\\ \\mathrm{R}=7\\mathrm{G}\\oplus 3\\mathrm{J}\\end{array}\\right. \\] (12)</p>

    <p class="text-gray-300">Also after <span class="math">MC</span> transformation between states (#9, #10), we have:</p>

    <p class="text-gray-300">\\[ \\begin{array}[]{l}\\mathrm{S}=3\\mathrm{N}\\oplus\\mathrm{O}\\oplus\\mathrm{R}\\quad\\ ,\\ \\mathrm{T}=3\\mathrm{M}\\oplus\\mathrm{P}\\oplus\\mathrm{Q}\\\\ \\mathrm{U}=2\\mathrm{N}\\oplus 3\\mathrm{O}\\oplus\\mathrm{R}\\quad,\\ \\mathrm{V}=2\\mathrm{M}\\oplus 3\\mathrm{P}\\oplus\\mathrm{Q}\\\\ \\mathrm{W}=\\mathrm{N}\\oplus 2\\mathrm{O}\\oplus 3\\mathrm{R}\\ ,\\ \\mathrm{X}=\\mathrm{M}\\oplus 2\\mathrm{P}\\oplus 3\\mathrm{Q}\\\\ \\mathrm{Y}=\\mathrm{N}\\oplus\\mathrm{O}\\oplus 2\\mathrm{R}\\quad\\ ,\\ \\mathrm{Z}=\\mathrm{M}\\oplus\\mathrm{P}\\oplus 2\\mathrm{Q}\\end{array} \\] (13)</p>

    <p class="text-gray-300">Hence, after combining mentioned conditions with each other and some simplifications, we can represent all the variables based on <span class="math">A</span> and <span class="math">B</span>:</p>

    <p class="text-gray-300">\\[ \\begin{array}[]{lll}\\mathrm{C=A\\oplus B}\\qquad,&\\mathrm{D=A\\oplus B}\\qquad,&\\mathrm{E=2A\\oplus B}\\qquad,&\\mathrm{F=A\\oplus 2B}\\\\ \\mathrm{G=2A\\oplus 3B}\\qquad,&\\mathrm{H=3A\\oplus 2B}\\qquad,&\\mathrm{I=A\\oplus 5B}\\qquad,&\\mathrm{J=5A\\oplus B}\\\\ \\mathrm{K=3A\\oplus 4B}\\qquad,&\\mathrm{L=4A\\oplus 3B}\\qquad,&\\mathrm{M=A\\oplus 8B}\\qquad,&\\mathrm{N=8A\\oplus B}\\\\ \\mathrm{O=13(A\\oplus B)}\\quad,&\\mathrm{P=13(A\\oplus B)}\\quad,&\\mathrm{Q=10A\\oplus B}\\quad,&\\mathrm{R=A\\oplus 10B}\\\\ \\mathrm{S=20A\\oplus 4B}\\quad,&\\mathrm{T=4A\\oplus 20B}\\quad,&\\mathrm{U=6A\\oplus 31B}\\quad,\\ \\mathrm{V=31A\\oplus 6B}\\\\ \\mathrm{W=17A\\oplus 5B}\\quad,\\ \\mathrm{X=5A\\oplus 17B}\\quad,\\ \\mathrm{Y=7A\\oplus 24B}\\quad,\\ \\mathrm{Z=24A\\oplus 7B}\\\\ \\end{array} \\] (14)</p>

    <p class="text-gray-300">Using equations in (14) we see that condition for <span class="math">MC</span> transformation between states (#12, #1) are automatically satisfied.</p>

    <h2 id="sec-25" class="text-2xl font-bold">Appendix 0.C Linear Trail Conditions</h2>

    <p class="text-gray-300">The conditions that must be satisfied for the linear trail are formulated as below. The condition for <span class="math">MC</span> transformation between states (#3, #4) results:</p>

    <p class="text-gray-300">\\[ \\begin{cases}\\mathrm{G=I\\oplus 3K}\\\\ \\mathrm{H=J\\oplus 3L}\\end{cases}\\Rightarrow\\begin{cases}\\mathrm{A=3J\\oplus 7L}\\quad,&\\mathrm{B=3I\\oplus 7K}\\\\ \\mathrm{C=I\\oplus 4K}\\quad,&\\mathrm{D=J\\oplus 4L}\\\\ \\mathrm{E=2J\\oplus L}\\quad,&\\mathrm{F=2I\\oplus K}\\\\ \\end{cases} \\] (15)</p>

    <p class="text-gray-300">The condition for <span class="math">MC</span> transformation between states (#6, #7) results:</p>

    <p class="text-gray-300">\\[ \\begin{cases}\\mathrm{M=O\\oplus 3Q}\\\\ \\mathrm{N=P\\oplus 3R}\\end{cases}\\Rightarrow\\begin{cases}\\mathrm{G=3P\\oplus 7R}\\quad,&\\mathrm{H=3O\\oplus 7Q}\\\\ \\mathrm{I=O\\oplus 4Q}\\quad,\\ \\mathrm{J=P\\oplus 4R}\\\\ \\mathrm{K=2P\\oplus R}\\quad,\\ \\mathrm{L=2O\\oplus Q}\\\\ \\end{cases} \\] (16)</p>

    <p class="text-gray-300">Also after <span class="math">MC</span> transformation between states (#9, #10), we have:</p>

    <p class="text-gray-300">\\[ \\begin{cases}\\mathrm{W=2S\\oplus U\\oplus 3Y}\\\\ \\mathrm{X=2T\\oplus V\\oplus 3Z}\\end{cases}\\Rightarrow\\begin{cases}\\ \\mathrm{M=T\\oplus 3V\\oplus 2Z}\\quad,\\ \\mathrm{N=S\\oplus 3U\\oplus 2Y}\\\\ \\ \\mathrm{O=5S\\oplus U\\oplus 7Y}\\quad,\\ \\mathrm{P=5T\\oplus V\\oplus 7Z}\\\\ \\mathrm{Q=7T\\oplus 2V\\oplus 7Z}\\quad,\\ \\mathrm{R=7S\\oplus 2U\\oplus 7Y}\\\\ \\end{cases} \\] (17)</p>

    <p class="text-gray-300">Hence, after combining mentioned conditions with each other and some simplifications, we can represent all the variables based on <span class="math">Q</span> and <span class="math">R</span>:</p>

    <p class="text-gray-300">\\[ \\begin{array}[]{lll}\\mathrm{A=10Q\\oplus R}\\qquad,&\\mathrm{B=Q\\oplus 10R}\\qquad,&\\mathrm{C=13\\ Q\\oplus R}\\quad,\\ \\mathrm{D=13\\ Q\\oplus R}\\\\ \\mathrm{E=Q\\oplus 8R}\\qquad,&\\mathrm{F=8Q\\oplus R}\\qquad,&\\mathrm{G=3Q\\oplus 4R}\\qquad,&\\mathrm{H=4Q\\oplus 3R}\\\\ \\mathrm{I=Q\\oplus 5R}\\qquad,&\\mathrm{J=5Q\\oplus R}\\qquad,&\\mathrm{K=2Q\\oplus 3R}\\qquad,\\ \\mathrm{L=3Q\\oplus 2R}\\\\ \\mathrm{M=2Q\\oplus R}\\qquad,&\\mathrm{N=Q\\oplus 2R}\\qquad,&\\mathrm{O=Q\\oplus R}\\qquad,&\\mathrm{P=Q\\oplus R}\\\\ \\mathrm{S=20Q\\oplus 4R}\\quad,\\ \\mathrm{T=4Q\\oplus 20R}\\quad,\\ \\mathrm{U=7Q\\oplus 24R}\\quad,\\ \\mathrm{V=24Q\\oplus 7R}\\\\ \\mathrm{W=17Q\\oplus 5R}\\quad,\\ \\mathrm{X=5Q\\oplus 17R}\\quad,\\ \\mathrm{Y=6Q\\oplus 31R}\\quad,\\ \\mathrm{Z=31Q\\oplus 6R}\\\\ \\end{array} \\] (18)</p>

    <p class="text-gray-300">Using equations in (18) we see that condition for <span class="math">MC</span> transformation between states (#12, #1) are automatically satisfied.</p>`;
---

<BaseLayout title="Total Break of Zorro using Linear and Differential Attacks (2014/220)">
  <article class="max-w-4xl mx-auto article-prose">
    <nav class="mb-8">
      <a href="/papers" class="text-blue-400 hover:text-blue-300">
        &larr; Back to Papers
      </a>
    </nav>

    <header class="mb-12">
      <h1 class="text-3xl font-bold mb-4"
        set:html={TITLE_HTML} />
      <p class="text-gray-400 mb-2"
        set:html={AUTHORS_HTML} />
      <p class="text-gray-500 text-sm mb-4">
        2014 &middot; eprint 2014/220
      </p>
      <div class="flex gap-4 text-sm">
        <a
          href={EPRINT_URL}
          target="_blank"
          rel="noopener noreferrer"
          class="text-blue-400 hover:text-blue-300"
        >
          Paper (eprint) &rarr;
        </a>
      </div>
      <p class="mt-4 text-xs text-gray-500">
        All content below belongs to the original authors. This page
        reproduces the paper for educational purposes. Always
        <a
          href={EPRINT_URL}
          target="_blank"
          rel="noopener noreferrer"
          class="text-blue-400 hover:text-blue-300"
        >cite the original</a>.
      </p>
      <p class="mt-1 text-xs text-gray-600">
        Converted with: {CRAWLER} &middot; {CONVERTED_DATE}
      </p>
    </header>

    <Fragment set:html={CONTENT} />

  </article>
</BaseLayout>
