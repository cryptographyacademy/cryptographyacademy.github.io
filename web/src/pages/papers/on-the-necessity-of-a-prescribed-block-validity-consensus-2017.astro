---
import BaseLayout from '../../layouts/BaseLayout.astro';

const EPRINT_URL = 'https://eprint.iacr.org/2017/686';
const CRAWLER = 'mistral';
const CONVERTED_DATE = '2026-02-16';
const TITLE_HTML = 'On the Necessity of a Prescribed Block Validity Consensus: Analyzing Bitcoin Unlimited Mining Protocol';
const AUTHORS_HTML = 'Ren Zhang, Bart Preneel';

const CONTENT = `    <p class="text-gray-300">Ren Zhang [ imec-COSIC, KU Leuven, Belgium ren.zhang@esat.kuleuven.be ] Bart Preneel [ imec-COSIC, KU Leuven, Belgium bart.preneel@esat.kuleuven.be ]</p>

    <h6 id="sec-2" class="text-base font-medium mt-4">Abstract.</h6>

    <p class="text-gray-300">Bitcoin has not only attracted many users but also been considered as a technical breakthrough by academia. However, the expanding potential of Bitcoin is largely untapped due to its limited throughput. The Bitcoin community is now facing its biggest crisis in history as the community splits on how to increase the throughput. Among various proposals, Bitcoin Unlimited recently became the most popular candidate, as it allows miners to collectively decide the block size limit according to the real network capacity. However, the security of BU is heatedly debated and no consensus has been reached as the issue is discussed in different miner incentive models. In this paper, we systematically evaluate BU’s security with three incentive models via testing the two major arguments of BU supporters: the block validity consensus is not necessary for BU’s security; such consensus would emerge in BU out of economic incentives. Our results invalidate both arguments and therefore disprove BU’s security claims. Our paper further contributes to the field by addressing the necessity of a prescribed block validity consensus for cryptocurrencies.</p>

    <h2 id="sec-3" class="text-2xl font-bold">1 Introduction</h2>

    <p class="text-gray-300">Bitcoin <em>(32)</em>, a decentralized payment system, attracts many users <em>(3)</em> with its novel mechanism of maintaining a public ledger. The ledger, called <em>blockchain</em>, groups all settled transactions as a chain of <em>blocks</em>. New blocks are generated via a process called <em>mining</em>. Participants of the process—<em>miners</em>, compete in solving a cryptographic puzzle composed of a set of new transactions and the last blockchain block. Once solved, the puzzle and its solution are combined into a block and broadcast to the network. Every network participant—<em>node</em>, be it a miner or a non-miner, stores a copy of the ledger. All nodes recognize the longest chain composed entirely of valid blocks as the blockchain. Miners of blockchain blocks receive new bitcoins as rewards to their contributed computational power.</p>

    <p class="text-gray-300">Despite the rapid growth, the expanding potential of Bitcoin is largely untapped as it can only process transactions at a speed lower than four per second on average <em>(2)</em>. This is because the current design prescribes a ten-minute-average block generation interval and a one-megabyte block size upper bound. The Bitcoin community is divided on what technical approach to follow in order to increase the throughput <em>(17)</em>.</p>

    <p class="text-gray-300">One most popular approach to address this problem is a project named Bitcoin Unlimited (BU) <em>(34)</em>. Based on the argument that “the blocksize limit should never have been a consensus rule in the first place” <em>(35)</em>, BU allows miners to decide the block size limit collectively through a deliberative process. Specifically, every node signals an individual excessive block size <em>EB</em>, the maximum acceptable block size. A block larger than the local <em>EB</em> is called an <em>excessive block</em> and is considered invalid by the node until a certain number of blocks are built on top of it. By design, any block that is too large for the network will be ignored by the majority of the miners, and only blocks with appropriate sizes would be included in the blockchain. Eventually, BU aims to gradually increase the block size limit at a speed matching the network capacity, thus ending the divergence on the block size limit once and for all. In April 2017, the time of this writing, BU is supported by 40% of mining power, which makes it the largest among competing designs <em>(26)</em>.</p>

    <p class="text-gray-300">However, the popularity of BU kindled heated debate within the Bitcoin community, mainly regarding its security. Critics claim that when block validity consensus (BVC) is absent, the blockchain would more frequently fork into different versions, and be more vulnerable to various attacks <em>(13; 49; 51)</em>. BU supporters react to such challenges with conflicting arguments, mainly differing on the presence and necessity of BVC in BU. The first type of reaction acknowledges the necessity of BVC, but argues that although a BVC is not prescribed, participants would soon reach an <em>emergent consensus</em> <em>(9; 11)</em>. In other words, all nodes will choose the same <em>EB</em>, as either the nodes with lower storage and network capacity would be crowded out by “people and organizations with deeper pockets” <em>(10)</em>, or the miners who prefer larger blocks would lower their <em>EBs</em> to avoid economic loss <em>(48)</em>. The second type of reaction takes an even stronger position by discarding BVC as a pillar of Bitcoin. The BU homepage claims that since such attacks would “cost the attacker far more than the victim”, no malicious party can “arbitrarily game the system” <em>(35)</em>.</p>

    <p class="text-gray-300">In this paper, we evaluate BU’s security by testing the two aforementioned claims of BU supporters with an analytical approach. In particular, by scrutinizing the ongoing debate, we identify that one major obstacle preventing BU supporters and objectors from reaching an agreement is that they discuss the issue with different miner incentive models, which leads to different understandings on BU’s security. Therefore, to establish a framework for our analysis</p>

    <p class="text-gray-300">and provide a common ground for the discussion, we categorize known attacks towards mining protocols into three attacker incentive models: <em>compliant and profit-driven, non-compliant and profit driven</em>, and <em>non-profit driven</em>. Furthermore, a utility function for strategic miners is chosen for each incentive model based on its most well-known attack, to help quantifying different protocols’ attack resistance. We argue that a comprehensive analysis of a mining protocol should consider all three models.</p>

    <p class="text-gray-300">Based on this framework, we first test against the stronger statement of BU supporters on the dispensability of BVC by evaluating BU’s security in the absence of BVC. We formally define a strategy space in which a miner can utilize the absence of BVC to cause blockchain forks. The mining process within this strategy space is then encoded as a Markov decision process (MDP), which models decision making in a partly stochastic environment. Such encoding allows us to compute the optimal strategies of the attacker within the strategy space that maximize our utility functions. Our MDP results demonstrate that:</p>

    <ul class="list-disc list-inside space-y-1 text-gray-300 my-2 ml-4">

      <li>In compliant and profit-driven incentive model, unlike Bitcoin, BU is not incentive compatible even when all miners fully comply with the protocol: a strategic miner can gain block rewards unproportional to the mining power.</li>

      <li>In non-compliant and profit-driven incentive model, an attacker can trigger long block forks more frequently and with lower effort in BU than in Bitcoin, resulting in more profitable double-spending attacks.</li>

      <li>At last, in non-profit-driven incentive model, an attacker can invalidate up to 1.77 blocks with each attacker block, whereas in Bitcoin this number is no more than one.</li>

    </ul>

    <p class="text-gray-300">Second, given that BVC is indispensible for BU’s security, we further test against BU supporters’ claims on emergent consensus with game-theoretic analysis. We construct two games to model the social choice of parameters of all BU miners and analyze the equilibrium and termination state of these games. Our analysis reveals that miners supporting large blocks have both the incentive and the ability to keep mining large blocks, in order to force small miners to exit the business. We argue that the resulting block size may not necessarily match the “actual network capacity” as the supporters believe <em>(8; 48)</em>.</p>

    <p class="text-gray-300">The contributions of this work are as follows:</p>

    <ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">

      <li>To the best of our knowledge, this is the first study that systematically analyzes BU mining protocol. We conclude that the absence of BVC magnifies the effectiveness of existing attacks on Bitcoin. Moreover, emergent consensus will not be reached for a large space of mining power and block size preference distributions; for the remaining circumstances, the BVC is very fragile. A countermeasure is proposed accordingly.</li>

      <li>We provide an analytical framework with three different incentive models, which is indispensable to initiate effective communication on the security of BU. This framework is of independent interest: it can be used in general for evaluating mining protocol security.</li>

      <li>By indicating that the crux of BU’s insecurity is its forsaking of BVC and inability to achieve it, we want to raise awareness on the importance of a prescribed BVC. Future cryptocurrency designs should avoid opening attack vectors that allow miners/attackers to deliberately fork the network. Furthermore, we list several technical approaches to design secure mining protocols with a prescribed adjustable BVC or without a prescribed BVC.</li>

    </ol>

    <h2 id="sec-4" class="text-2xl font-bold">2. Preliminaries</h2>

    <h3 id="sec-5" class="text-xl font-semibold mt-8">2.1. Bitcoin Mining Protocol</h3>

    <p class="text-gray-300">Bitcoin establishes consensus on the blockchain in a decentralized, pseudonymous way <em>(32)</em>. Each block in the blockchain contains its distance from the first block, called <em>height</em>, the hash value of the preceding <em>parent block</em>, a set of transactions, and a nonce. Information about the parent block guarantees that a miner must choose which chain to mine on before starting. To construct a valid block, miners work on finding the right nonce so that the hash of the block is smaller than the <em>block difficulty target</em>. This target is adjusted every 2016 blocks so that on average a block is generated every ten minutes. The protocol assumes that miners publish valid blocks to the network the moment they are found. Miners are incentivized by two kinds of rewards. First, a fixed <em>block reward</em> is allocated to the miner of every blockchain block. Second, the difference between the amount of inputs and outputs in a transaction is called the <em>transaction fee</em>, which goes to the miner who includes the transaction in the blockchain.</p>

    <p class="text-gray-300">All Bitcoin participants follow the same prescribed <em>block validity consensus</em> (BVC), namely a block is either valid or invalid to everyone. When more than one valid block extends the same preceding block, a miner adopts and mines on the longest chain, or the first received block when several chains are of the same length. We refer to this <em>forked</em> situation as a <em>block race</em>, and an equal-length block race as a <em>tie</em>. In the latter situation, eventually one chain would be longer than the others, and blocks that are not on this chain are discarded by all miners. We call these blocks <em>orphaned</em>. Orphaned blocks receive no reward.</p>

    <h3 id="sec-6" class="text-xl font-semibold mt-8">2.2. Bitcoin Unlimited Mining Protocol</h3>

    <p class="text-gray-300">The BU mining protocol does not have an official specification. Here we summarize the protocol according to our understanding of the March 2017 BU release source code <em>(18)</em>.</p>

    <p class="text-gray-300">BU abandons BVC by introducing three new parameters to the Bitcoin mining protocol. Participants choose these parameters locally and broadcast their choices to the network. First, maximum generation size <em>MG</em> indicates the maximum block size a miner will generate. Second, excessive block size <em>EB</em> is the maximum block size the participant considers valid and accepts. Similar to Bitcoin, participants recognize the longest valid chain as the blockchain. A block that is larger than the local <em>EB</em> is called an <em>excessive block</em> and is considered invalid. Since a valid block for some miners might be excessive for the others, BU does not have a prescribed BVC. As a block with the exact size <em>EB</em> is not an excessive block, we will drop the term “excessive block size" and use <em>EB</em> instead to avoid confusion. Third, the excessive acceptance depth <em>AD</em> represents the length of a chain that needs to be built on an excessive block, starting from and including the block itself, before it is considered valid. In other words, if a chain of <span class="math">AD-1</span> blocks are mined after</p>

    <p class="text-gray-300">!<a href="img-0.jpeg">img-0.jpeg</a> Figure 1: A BU miner's choice of parent block, assuming  <span class="math">AD = 3</span> . In the upper figure, the excessive blocks are rejected. In the middle figure, two blocks are mined after the excessive block, the chain is then considered valid and accepted as the longest chain. As the sticky gate is open, the block size limit on that chain is released to 32MB. In the lower figure, the sticky gate is closed on a chain after 144 consecutive non-excessive blocks.</p>

    <p class="text-gray-300">the excessive block, the excessive block and the subsequent chain are accepted.</p>

    <p class="text-gray-300">According to the project's Chief Scientist Rizun [39], once an excessive block is accepted, a sticky gate, also referred to as excessive-block gate, is opened for the chain starting with the excessive block on the participant's client. When the sticky gate is open, the block size on that chain is only limited by the size of a network message, which is 32 MB (cf. Figure 1). The sticky gate will be closed after 144 consecutive non-excessive blocks appear on the chain, which takes roughly a day. The sticky gate mechanism is designed to prevent a miner with small  <span class="math">EB</span>  from working on a shorter chain indefinitely when the majority of mining power chooses a larger  <span class="math">MG</span> .</p>

    <p class="text-gray-300">BU's source code is inconsistent with Rizun's description. According to the source code, a chain whose latest block has height  <span class="math">h</span>  is considered valid if either the latest  <span class="math">AD</span>  blocks are all non-excessive, or there is an excessive block in the chain whose height is between  <span class="math">h - AD + 1</span>  and  <span class="math">h - AD - 143</span>  inclusive. The latter rule results in some counter-intuitive edge cases. For example, a chain is valid if it contains only two excessive blocks at height  <span class="math">h</span>  and  <span class="math">h - AD - 143</span>  respectively, but would be invalidated if another block is added, excessive or non-excessive. We believe this is an implementation error rather than the designers' intention, therefore we model the system according to Rizun's description in this paper.</p>

    <p class="text-gray-300">Currently, all BU miners choose  <span class="math">MG = EB = 1</span>  MB, meeting Bitcoin's BVC. However, miners and nodes signaling BU are already choosing different sets of parameters. The majority of BU's mining</p>

    <p class="text-gray-300">power chooses  <span class="math">AD = 6</span> , whereas BitClub Network, a miner, chooses  <span class="math">AD = 20</span> . Almost all BU public nodes choose  <span class="math">AD = 12</span> ,  <span class="math">EB = 16</span>  MB.</p>

    <p class="text-gray-300">BU project members conducted some preliminary analysis on the protocol and its rationality. Our results do not contradict these, but instead consider an expanded strategy space; unlike these prior models, ours includes strategies that deliberately cause forks and strategies that deviate from the protocol.</p>

    <p class="text-gray-300">Rizun pointed out that when there is no block size limit, a rational miner's block size is a tradeoff between higher transaction fees and lower orphan rate [38]. A corollary of this result is that miners have different block size preferences according to their mining costs and network capacity. This corollary justifies our setting in the block size increasing game in Sect. 5.2. As an additional contribution, Rizun briefly mentioned that a mining cartel with high internal bandwidth might form and negatively affect the network health, which is indeed confirmed by our results. However, his model does not consider the possibility of chain-splitting attacks, which are the crux of BU's insecurity in our model.</p>

    <p class="text-gray-300">Andrew Stone, the Lead Developer of BU, demonstrated with simulations that forks happen relatively rare in BU and are quickly resolved [47]. However, his model does not allow miners to change their block sizes and EBs during the simulation. Our results in Sect. 4 prove that forks happen frequently when the attacker's block size is flexible.</p>

    <p class="text-gray-300">An attack on BU was described in a reddit post by Cryptoconomy [13]. We generalize the attack to a series of attacks with different incentive models and quantify the results. Van Wirdum discussed the implications of some other possible scenarios, e.g., when miners choose different ADs or not all miners switch to BU [51].</p>

    <p class="text-gray-300">When analyzing BU mining protocol in Sect. 4 and Sect. 5, we follow the threat model of most studies on Bitcoin mining [1, 16, 20, 24, 27, 33, 41, 44, 52]. In this model, every miner controls strictly less than  <span class="math">50\\%</span>  of the total mining power. Moreover, no attacker has the power to downgrade the propagation speed of blocks found by other miners. For brevity, in this paper we use "the attacker" instead of "the non-compliant strategic miner". Every miner is capable of creating blocks of any size: when there is not enough transactions, the miner can always generate some. We assume all miners are honest with their signals, therefore do not distinguish the EBs they signal and their actual EBs.</p>

    <p class="text-gray-300">Also in this model, miners' profits are estimated according to the number of blocks eventually in the blockchain. In other words, we do not consider the effect of transaction fees. To the best of our knowledge, the only study that models the effect of transaction fees on mining strategy is by Carlsten et al. [6]. However they only study the period when block rewards are reduced to zero. Currently, block rewards are still miners' main income, and the transaction fees of a miner are generally proportional to the number of blocks [2].</p>

    <h2 id="sec-9" class="text-2xl font-bold">3. Incentive Models of Strategic Miners</h2>

    <p class="text-gray-300">When discussing the security of BU, supporters and objectors often use different miner incentive models. Supporters assume that all miners are profit-driven <em>(8; 9; 11; 31; 35)</em> and claim that any deviation from the protocol designers’ desired behavior would “negatively affect the BTC market price, and miner profitability” <em>(8)</em>. However, we argue that the security of a protocol should take into account all participant incentives. In this section we enumerate three incentive models of strategic miners to establish a framework for evaluating mining protocols. A utility function is chosen for each incentive model based on its most well-known attack, which shall be used in our later analysis.</p>

    <h3 id="sec-10" class="text-xl font-semibold mt-8">3.1. Compliant and Profit-Driven</h3>

    <p class="text-gray-300">The compliant and profit-driven miner believes that any observable deviation from the protocol weakens the public confidence of the cryptocurrency, leading to lower exchange rate and economic loss even for the attacker <em>(5)</em>. Therefore, strategic miners always follow the protocol unless the deviation is unobservable. In the absence of a prescribed BVC, every party chooses the parameters that maximize its profits.</p>

    <p class="text-gray-300">We use relative revenue <em>(1; 16; 20; 24; 27; 33; 41; 52)</em>, namely the proportion of the strategic miner’s blocks among all blocks, to represent this incentive model:</p>

    <p class="text-gray-300">(1) <span class="math">u_{\\mathrm{A,1}}=\\frac{\\sum R_{\\mathrm{A}}}{\\sum R_{\\mathrm{A}}+\\sum R_{\\mathrm{others}}}\\enspace,</span></p>

    <p class="text-gray-300">where <span class="math">\\sum R_{\\mathrm{A}}</span> is the total revenue received by the strategic miner during a certain period of time, in the unit of block reward; <span class="math">\\sum R_{\\mathrm{others}}</span> is the total block rewards of other miners. When all miners are compliant and the propagation delay is negligible, to the best of our knowledge, Bitcoin mining protocol is incentive compatible: the expected relative revenue of a miner equals the miner’s mining power share <em>(32)</em>. In other words, we are not aware of any compliant and profit-driven attack on Bitcoin.</p>

    <h3 id="sec-11" class="text-xl font-semibold mt-8">3.2. Non-Compliant and Profit-Driven</h3>

    <p class="text-gray-300">A non-compliant and profit-driven attacker may deviate from the prescribed protocol to gain profits in a way undesirable to the protocol designer. Unlike in the previous model, the drops in exchange rate do not affect the attacker’s profits. This is because either the attacker’s profits are not in the form of the cryptocurrency, or the attacker believes when the attack stops, either voluntarily or because the relevant vulnerabilities are fixed, the exchange rate would recover. Indeed the exchange rates of both Bitcoin and Ethereum, the two cryptocurrencies with largest market capitalization, frequently break their all time highs at the time of this writing, despite multiple attacks throughout their histories <em>(25; 36)</em>.</p>

    <p class="text-gray-300">The double-spending attack arises from this incentive model. The attacker sends funds in a transaction to a merchant for some products, and reverses the transaction after these products are received. By convention, a transaction embedded in a block is considered settled and products would be delivered when there are five blockchain blocks mined after the block. Therefore the attacker needs to publish a longer chain that does not contain this transaction after it is settled to reverse the transaction. A successful double-spending in Bitcoin happened in March 2013 when a blockchain fork occurred during a protocol update <em>(29)</em>.</p>

    <p class="text-gray-300">Sompolinsky and Zohar pointed out in <em>(44)</em> that an attacker can gain higher profits by combining double-spending with a selfish mining attack <em>(16; 33; 41)</em>: the attacker keeps mining in secret to perform double-spending attacks, and when there is little hope to orphan six blocks in a row, publishes the secret blocks to claim the block rewards and invalidate other miners’ blocks.</p>

    <p class="text-gray-300">In our later analysis we use the absolute reward <em>(20; 44)</em>, the time-averaged revenue of the combined selfish mining and double spending attack to represent this incentive model:</p>

    <p class="text-gray-300">(2) <span class="math">u_{\\mathrm{A,2}}=\\frac{\\sum R_{\\mathrm{A}}+\\sum R_{\\mathrm{DS}}}{t}\\enspace,</span></p>

    <p class="text-gray-300">where <span class="math">\\sum R_{\\mathrm{DS}}</span> is the total double-spending revenue received by the attacker, in the unit of block reward; <span class="math">t</span> is the time span of the attack.</p>

    <h3 id="sec-12" class="text-xl font-semibold mt-8">3.3. Non-Profit-Driven</h3>

    <p class="text-gray-300">A non-profit-driven attacker does not try to gain profits directly from the attack. The attacker’s goals may include preventing certain transactions from entering the blockchain, or lowering the quality of service of the cryptocurrency, so that, for example, users would turn to a competing cryptocurrency. Although profits made during the attack are not in the attacker’s consideration, the attacker still tries to achieve the goal with the lowest cost.</p>

    <p class="text-gray-300">The 51% attack, also referred to as Goldfinger attack <em>(5; 28)</em>, is in line with this incentive model. In this attack, the attacker controls more than 50% of mining power and constantly overrides the blockchain with longer chains to prevent transactions from being confirmed. A Bitcoin mining pool Eligius deployed this attack to destroy Coiledcoin, a cryptocurrency with lower mining capacity <em>(30)</em>.</p>

    <p class="text-gray-300">We adopt the average number of other miners’ blocks orphaned by each attacker block to evaluate the effectiveness of non-profit-driven attacks:</p>

    <p class="text-gray-300">(3) <span class="math">u_{\\mathrm{A,3}}=\\frac{\\sum O_{\\mathrm{others}}}{\\sum R_{\\mathrm{A}}+\\sum O_{\\mathrm{A}}}\\enspace,</span></p>

    <p class="text-gray-300">where <span class="math">O_{\\mathrm{A}}</span> and <span class="math">O_{\\mathrm{others}}</span> denote the number of orphaned blocks mined by the attacker and other miners, respectively.</p>

    <h2 id="sec-13" class="text-2xl font-bold">4. Is Consensus Necessary: Modeling a Strategic Miner in the Absence of Block Validity Consensus</h2>

    <p class="text-gray-300">To establish a common ground on the necessity of BVC, in this section we evaluate the security of BU mining protocol when BVC is absent. First, we describe a series of strategies that utilize the absence of BVC to cause forks, and model the strategy space with an MDP. Afterwards, we evaluate the security of BU with attackers of different incentive models by comparing the efficacy of the optimal strategies within the space with the best results of known attacks on Bitcoin. Note that since our strategy space covers only a subset of the attacker strategies in BU, the optimal strategies within our space are not necessarily the optimal strategies with certain incentive model. However by showing that a certain strategy in a reasonable setting outperforms the best attack on Bitcoin, we can conclude</p>

    <p class="text-gray-300">!<a href="img-1.jpeg">img-1.jpeg</a> Figure 2: Two states in different phases. In phase 1, Alice mines a block of size  <span class="math">\\mathrm{EB_C}</span>  so that Carol mines on this block and Bob rejects it; in phase 2, Bob's sticky gate is open, Alice mines a block of size  <span class="math">&amp;gt;\\mathrm{EB_C}</span>  so that it is accepted by Bob but rejected by Carol.</p>

    <p class="text-gray-300">that the new attack vector introduced by BU weakens Bitcoin's security.</p>

    <p class="text-gray-300">4.1.1 System Setting and Strategy Description. In this strategy space, a miner deliberately causes forks and could mine on either chain when the blockchain is forked. We generalize the attack proposed by Cryptoconomy [13] to allow diversified miner incentive models.</p>

    <p class="text-gray-300">There are three miners Alice, Bob and Carol in the system, among which Alice is the only strategic miner. Bob and Carol have the same MG and AD but different EBs:  <span class="math">\\mathrm{EB_B} &amp;lt; \\mathrm{EB_C}</span> . The mining power shares of Alice, Bob and Carol are  <span class="math">\\alpha</span> ,  <span class="math">\\beta</span>  and  <span class="math">\\gamma</span> , respectively, which satisfy  <span class="math">\\alpha + \\beta + \\gamma = 1</span> . Bob and Carol might be groups of miners so that one of them can control more than half of the mining power. We assume  <span class="math">\\alpha \\leq \\min\\{\\beta, \\gamma\\}</span> , and whenever Bob and Carol reach a consensus on the blockchain, Alice accepts and mines on the latest block in that chain. In other words, we do not consider the situation in which Alice mines on a shorter chain just by herself. Neither do we consider selfish mining attacks: Alice always publishes her blocks immediately after mined.</p>

    <p class="text-gray-300">The system can be in one of three phases, according to the sticky gates' situation. In phase 1, both Bob's and Carol's sticky gates are closed. If Bob and Carol mine on the same chain, which is denoted as Chain 1, Alice may try to mine a block of size  <span class="math">\\mathrm{EB_C}</span>  so that Carol mines on Alice's block while Bob considers this block excessive and mines on its predecessor. In this situation, we refer to Bob's chain as Chain 1 and Carol's chain as Chain 2. Alice may mine either on Chain 1 or Chain 2, depending on which action maximizes her utility. The left part in Figure 2 illustrates this forked situation. If Chain 1 outgrows Chain 2 at any time, Carol switches back to Chain 1; if Chain 2 reaches AD before Chain 1 does, Bob abandons his own chain, adopts all AD blocks in Chain 2 and opens his sticky gate. When Bob's sticky gate is open and Carol's is closed, the system enters phase 2. In phase 2, Alice may mine a block slightly larger than  <span class="math">\\mathrm{EB_C}</span>  so that Bob accepts this block and keeps mining on it while Carol rejects the block. If Alice chooses to do so and succeeds, we refer to Carol's chain as Chain 1 and Bob's chain as Chain 2 (cf. right part of Figure 2). Similar to phase 1, Bob switches back to Chain 1 if it outgrows Chain 2; if Chain 2 reaches AD before Chain</p>

    <p class="text-gray-300">1 does, Carol's sticky gate opens and the system enters phase 3. When both Bob and Carol open their sticky gates, a BVC is reached.</p>

    <p class="text-gray-300">Since we are mainly interested in the situation when BVC is absent in this section, we exclude phase 3 in our MDP. In reality the strategic miner can pause the strategy in phase 3. Note that during phase 3, the system is vulnerable to other attacks, such as embedding large blocks in the blockchain. Research conducted in 2016 by Croman et al. indicates that the block size cannot exceed 4MB to ensure  <span class="math">90\\%</span>  of public nodes have sufficient throughput at that time [12]. Although new technologies are deployed to accelerate block propagation and reduce bandwidth consumption, a consensus has not been reached on whether a block size limit of 32MB is feasible for the current Bitcoin network. By embedding giant blocks in the blockchain, a malicious miner can, for example, waste disk storage for all public nodes, or utilize the difference in receiving time among miners to separate their mining power and earn unfair profits. We consider the identification and analysis of possible attacks during phase 3 orthogonal to this paper.</p>

    <p class="text-gray-300">Since the risk of sticky gates is also recognized by some BU supporters, a Bitcoin Unlimited Improvement Proposal (BUIP) is submitted to remove this mechanism [23]. If sticky gates are removed, the system stays in phase 1 permanently. This setting is also considered in our MDP.</p>

    <p class="text-gray-300">At last we note that this setup with two "static" miner groups of different  <span class="math">EBs</span>  is the weakest form of the attack. When there are more than two  <span class="math">EBs</span>  in the network:  <span class="math">\\mathrm{EB}_1 &amp;lt; \\mathrm{EB}_2 &amp;lt; \\dots &amp;lt; \\mathrm{EB}_k</span> , Alice can choose arbitrary  <span class="math">1 \\leq d &amp;lt; k</span>  and split other miners into two groups of  <span class="math">\\mathrm{EB}_1, \\ldots, \\mathrm{EB}_d</span>  and  <span class="math">\\mathrm{EB}_{d+1}, \\ldots, \\mathrm{EB}_k</span>  with the same set of strategies. This can be achieved by substituting  <span class="math">\\mathrm{EB}_B</span>  in our model with  <span class="math">\\mathrm{EB}_1</span> ,  <span class="math">\\mathrm{EB}_C</span>  with  <span class="math">\\mathrm{EB}_{d+1}</span> , and blocks of size  <span class="math">&amp;gt; \\mathrm{EB}_C</span>  with size  <span class="math">&amp;gt; \\mathrm{EB}_k</span> . In other words, having more  <span class="math">EBs</span>  in the network only gives Alice more options to split other miners' mining power in her advantage. Next we formally define the MDP.</p>

    <p class="text-gray-300">4.1.2 MDP Design. MDP is commonly used by researchers to analyze the security of mining protocols [20, 41, 44, 52]. Modeling a system as an MDP allows us to compute the strategy that maximizes the utility of a strategic player with well-studied algorithms [7]. To achieve this goal, we need to encode all status and history information that might influence the player's decision into a state, and the player's available decisions into several actions. Moreover, a state transition matrix describes the probability distribution of the next state over every (state, action) pair. At last, a reward is allocated to the player if some transition happens, which is used to compute the utility. Converting mining rewards into a complex utility function is a non-trivial task, we refer to the paper by Sapirshtein et al. [41] for more details.</p>

    <p class="text-gray-300">State Space. A state is represented as a 5-tuple  <span class="math">(l_{1}, l_{2}, a_{1}, a_{2}, r)</span> . The lengths of Chain 1 and Chain 2 are encoded as  <span class="math">l_{1}</span>  and  <span class="math">l_{2}</span> , respectively. The number of blocks mined by Alice in these chains are  <span class="math">a_{1}</span>  and  <span class="math">a_{2}</span> . The parameter  <span class="math">r</span>  denotes the number of blocks that need to be mined on Bob's chain before he closes his sticky gate. When  <span class="math">r = 0</span> , the system is in phase 1; when  <span class="math">1 \\leq r \\leq 144</span> , the system is in phase 2. Phase 3 is only a temporary state during state transition.</p>

    <p class="text-gray-300">Actions. Two actions are always possible: OnChain1 and OnChain2. When Bob and Carol are mining on the same chain, which is Chain 1 by our definition, mining OnChain2 means Alice tries to mine a big block to divide the mining power of Bob’s and Carol’s. Upon success, Alice may mine either OnChain1 or OnChain2, depending on which action maximizes her utility. When Alice is non-profit-driven, a third action Wait is also possible. When choosing Wait, the next block can only be mined by Bob or Carol.</p>

    <h4 id="sec-15" class="text-lg font-semibold mt-6">State Transition</h4>

    <p class="text-gray-300">The system starts at the base state <span class="math">(0,\\,0,\\,0,\\,0,\\,0)</span>, in which Alice mines OnChain2. In each step, one block is found by Alice, Bob or Carol, with probabilities according to their mining capacities. At the base state, if the next block is found by Bob or Carol, the system stays at the base state and the block is locked in the blockchain. We call some blocks locked if all miners agree on these blocks. Whenever some blocks are locked, rewards are distributed and these blocks are excluded from the state, as they do not affect Alice’s strategy. When Alice finds a block at the base state, the system turns to state <span class="math">(0,\\,1,\\,0,\\,1,\\,0)</span> and the blockchain is forked. During the forked period, both chains grow according to the mining power working on that chain. For example, if the current state is <span class="math">(3,\\,4,\\,0,\\,1,\\,0)</span> and Alice works OnChain1, the next state might be: <span class="math">(4,\\,4,\\,1,\\,1,\\,0)</span> with probability <span class="math">\\alpha</span>, <span class="math">(4,\\,4,\\,0,\\,1,\\,0)</span> with probability <span class="math">\\beta</span>, and <span class="math">(3,\\,5,\\,0,\\,1,\\,0)</span> with probability <span class="math">\\gamma</span>. If at any moment <span class="math">l_{1}</span> outgrows <span class="math">l_{2}</span>, both Bob and Carol would mine on Chain 1, the system jumps back to the base state and all blocks on Chain 1 are locked. If <span class="math">l_{2}</span> reaches AD, the system turns to <span class="math">(0,\\,0,\\,0,\\,0,\\,144)</span> and blocks in Chain 2 are locked. State transition in phase 2 is very similar to that in phase 1 with two differences. First, the roles of Bob and Carol are exchanged: when the system forks, Bob works on Chain 2 and Carol works on Chain 1. Second, the state transition when Bob and Carol reach a consensus is slightly different. Whenever Chain 1 blocks are locked, <span class="math">r</span> is reduced by <span class="math">l_{1}</span>; when <span class="math">r</span> reaches 0 the system goes back to phase 1. If Chain 2 blocks are locked, the system temporarily goes to phase 3 and turns back to the base state.</p>

    <h4 id="sec-16" class="text-lg font-semibold mt-6">Solving for the Optimal Policy</h4>

    <p class="text-gray-300">We adopt the algorithm developed by Sapirshtein et al. to convert a mining model into an undiscounted average reward MDP <em>(Sapirshtein et al., 2017)</em>. The MDP is able to output the strategy that achieves the maximum utility of Alice and the utility. Alice’s utility is defined according to her incentive model, which we defined in Sect. 3 and will further specify in the rest of this section. As the total number of states within our MDP is finite, our results reflect Alice’s optimal expected utility within the strategy space with our predefined maximum error of <span class="math">10^{-4}</span>.</p>

    <p class="text-gray-300">As for the parameters, we choose <span class="math">AD=6</span> for both Bob and Carol in line with current BU miners. Seven different <span class="math">\\alpha</span> values are chosen: <span class="math">1\\%</span>, <span class="math">2.5\\%</span>, <span class="math">5\\%</span>, <span class="math">10\\%</span>, <span class="math">15\\%</span>, <span class="math">20\\%</span> and <span class="math">25\\%</span>. We split the rest of the mining power between Bob and Carol with nine most basic ratios: <span class="math">1:4</span>, <span class="math">1:3</span>, <span class="math">1:2</span>, <span class="math">2:3</span>, <span class="math">1:1</span>, <span class="math">3:2</span>, <span class="math">2:1</span>, <span class="math">3:1</span> and <span class="math">4:1</span>. Although we are only able to compute a limited set of parameters due to our limited computational resources, our results are sufficient to reveal BU’s vulnerabilities. All sets of parameters that satisfy <span class="math">\\alpha\\leq\\min\\{\\beta,\\gamma\\}</span> are computed under two different settings. In the first setting, the sticky gate is disabled, thus only phase 1 is permitted. In the second setting, the sticky gate is enabled, thus both phases are permitted. Another way to understand the settings is that in the first setting, the attacker is only allowed to launch the attack at phase 1; in the second setting, the attacker can launch the attack at both phases. A complete description of state transition and reward distribution of setting 1 with compliant and profit-driven Alice is in Table 1.</p>

    <h3 id="sec-17" class="text-xl font-semibold mt-8">4.2. A Compliant and Profit-Driven Alice</h3>

    <p class="text-gray-300">In our three-miner setting, <span class="math">\\sum R_{\\text{others}}</span> in Equation (1) is the block rewards of Bob’s and Carol’s combined. We program the MDP to output <span class="math">\\sum R_{\\text{A}}</span> and <span class="math">\\sum R_{\\text{others}}</span> whenever some blocks are locked, as described in Table 1. The maximum <span class="math">u_{\\text{A},1}</span> values can be found in Table 2. All parameter sets not displayed in the table satisfy <span class="math">\\max\\{u_{\\text{A},1}\\}=\\alpha</span>. Our results show that <span class="math">\\max\\{u_{\\text{A},1}\\}&gt;\\alpha</span>, namely Alice gains unfair relative revenue, for multiple parameter sets. For comparison, Bitcoin always has <span class="math">\\max\\{u_{\\text{A},1}\\}=\\alpha</span> when all miners are compliant.</p>

    <p class="text-gray-300">A closer look at Table 2 reveals that Alice only gains unfair rewards when <span class="math">\\alpha+\\gamma&gt;\\beta</span>. This is because in phase 1, when Alice mines a block of size <span class="math">\\text{EB}_{\\text{C}}</span> to “introduce” Chain 2 and fork the network, the maximum mining power share working on Chain 2 is <span class="math">\\alpha+\\gamma</span>, whereas Chain 1 has at least <span class="math">\\beta</span>. When <span class="math">\\alpha+\\gamma\\leq\\beta</span>, Chain 1 has at least equal chance to win the block race, in which case Alice’s first block on Chain 2 is orphaned, decreasing her utility. Consequently, Alice’s optimal strategy is to keep mining on Chain 1. As the system does not enter phase 2 in this case, setting 2 has similar results.</p>

    <h6 id="sec-18" class="text-base font-medium mt-4">Analytical Result 1.</h6>

    <p class="text-gray-300">When BVC is absent, BU is not incentive compatible even when all miners follow the protocol.</p>

    <h3 id="sec-19" class="text-xl font-semibold mt-8">4.3. A Non-Compliant and Profit-Driven Alice</h3>

    <p class="text-gray-300">We adopt a modified version of the setting in <em>(Sapirshtein et al., 2017)</em> to determine when to issue double-spending rewards in Bitcoin. In our setting, a transaction to the merchant is embedded in every block mined by compliant miners. Every time Alice overrides <span class="math">k&gt;3</span> other miners’ blocks in a block race, she receives <span class="math">(k-3)\\times R_{\\text{DS}}</span>, plus block rewards for all her blocks in the blockchain. We choose four confirmations instead of six to facilitate the comparison, as double-spending is hardly profitable in Bitcoin with six confirmations for Alice’s small mining power. For the same reason, we set the amount of <span class="math">R_{\\text{DS}}</span> ten times of a block reward. Failed double-spending attempts have no punishment.</p>

    <p class="text-gray-300">In BU, whenever Alice successfully forks the blockchain, she embeds a transaction in each block during the fork and a conflicting transaction spending the same inputs in the competing chain. The merchants receiving these transactions are chosen carefully so that merchants accepting Chain 1 transactions do not see Chain 2, and vise versa. She receives <span class="math">(k-3)\\times R_{\\text{DS}}</span> as double-spending rewards if either Chain 2 wins the block race and <span class="math">k&gt;3</span> blocks in Chain 1 are orphaned, or Chain 1 wins the block race and <span class="math">k&gt;3</span> blocks in Chain 2 are orphaned.</p>

    <p class="text-gray-300">As one block is found in each step in our model, we set <span class="math">t</span> in Equation (2) equal to <span class="math">\\sum R_{\\text{A}}+\\sum R_{\\text{others}}+\\sum O_{\\text{A}}+\\sum O_{\\text{others}}</span>. Therefore, the <span class="math">u_{\\text{A},2}</span> value can be interpreted as the expected reward Alice receives for each block that is mined in the network, or roughly every 10 minutes, in the unit of block reward. For example, <span class="math">\\max\\{u_{\\text{A},2}\\}=\\alpha</span> means Alice’s most profitable strategy is to keep mining on Chain 1 and never perform double-spending attack, so that <span class="math">\\alpha</span> proportion of the block rewards are Alice’s.</p>

    <p class="text-gray-300">Table 1: State transition and reward distribution for compliant and profit-driven Alice, setting 1. Note that setting 1 considers only phase 1, namely Bob's sticky gate is never open. The fifth entry in the state tuple is omitted as it is always zero in phase 1. When multiple events lead to the same state, the probability is defined as the total probability of these events, and the reward is weighted according to the distribution. In the table,  <span class="math">\\alpha&#x27; = \\alpha / (\\alpha + \\beta)</span> ,  <span class="math">\\alpha&#x27; = \\beta / (\\alpha + \\beta)</span> ,  <span class="math">\\alpha&#x27;&#x27; = \\alpha / (\\alpha + \\gamma)</span> ,  <span class="math">\\gamma&#x27;&#x27; = \\gamma / (\\alpha + \\gamma)</span> . OnChain1 and OnChain2 are abbreviated as onC1 and onC2, respectively.</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">(State × Action)</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Resulting State</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Probability</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Reward (RA, Rothers)</th>

          </tr>

        </thead>

        <tbody>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">(0,0,0,0), onC1</td>

            <td class="px-3 py-2 border-b border-gray-700">(0,0,0,0)</td>

            <td class="px-3 py-2 border-b border-gray-700">1</td>

            <td class="px-3 py-2 border-b border-gray-700">(α,β+γ)</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">(0,0,0,0), onC2</td>

            <td class="px-3 py-2 border-b border-gray-700">(0,0,0,0)</td>

            <td class="px-3 py-2 border-b border-gray-700">β+γ</td>

            <td class="px-3 py-2 border-b border-gray-700">(0,1)</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">(0,1,0,1)</td>

            <td class="px-3 py-2 border-b border-gray-700">α</td>

            <td class="px-3 py-2 border-b border-gray-700">(0,0)</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">(l1,l2,a1,a2), onC1</td>

            <td class="px-3 py-2 border-b border-gray-700">(l1+1,l2,a1+1,a2)</td>

            <td class="px-3 py-2 border-b border-gray-700">α</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">l1<l2≠AD-1</td>

            <td class="px-3 py-2 border-b border-gray-700">(l1+1,l2,a1,a2)</td>

            <td class="px-3 py-2 border-b border-gray-700">β</td>

            <td class="px-3 py-2 border-b border-gray-700">(0,0)</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">(l1,l2+1,a1,a2)</td>

            <td class="px-3 py-2 border-b border-gray-700">γ</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">(l1,l2,a1,a2), onC2</td>

            <td class="px-3 py-2 border-b border-gray-700">(l1,l2+1,a1,a2+1)</td>

            <td class="px-3 py-2 border-b border-gray-700">α</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">l1<l2≠AD-1</td>

            <td class="px-3 py-2 border-b border-gray-700">(l1+1,l2,a1,a2)</td>

            <td class="px-3 py-2 border-b border-gray-700">β</td>

            <td class="px-3 py-2 border-b border-gray-700">(0,0)</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">(l1,l2+1,a1,a2)</td>

            <td class="px-3 py-2 border-b border-gray-700">γ</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">(l1,l2,a1,a2), onC1</td>

            <td class="px-3 py-2 border-b border-gray-700">(0,0,0,0)</td>

            <td class="px-3 py-2 border-b border-gray-700">α+β</td>

            <td class="px-3 py-2 border-b border-gray-700">(α'(a1+1)+β'a1, α'(l1-a1)+β'(l1+1-a1))</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">l1=l2≠AD-1</td>

            <td class="px-3 py-2 border-b border-gray-700">(l1,l2+1,a1,a2)</td>

            <td class="px-3 py-2 border-b border-gray-700">γ</td>

            <td class="px-3 py-2 border-b border-gray-700">(0,0)</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">(l1,l2,a1,a2), onC2</td>

            <td class="px-3 py-2 border-b border-gray-700">(l1,l2+1,a1,a2+1)</td>

            <td class="px-3 py-2 border-b border-gray-700">α</td>

            <td class="px-3 py-2 border-b border-gray-700">(0,0)</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">l1=l2≠AD-1</td>

            <td class="px-3 py-2 border-b border-gray-700">(0,0,0,0)</td>

            <td class="px-3 py-2 border-b border-gray-700">β</td>

            <td class="px-3 py-2 border-b border-gray-700">(a1,l1+1-a1)</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">(l1,l2+1,a1,a2)</td>

            <td class="px-3 py-2 border-b border-gray-700">γ</td>

            <td class="px-3 py-2 border-b border-gray-700">(0,0)</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">(l1,l2,a1,a2), onC1</td>

            <td class="px-3 py-2 border-b border-gray-700">(l1+1,l2,a1+1,a2)</td>

            <td class="px-3 py-2 border-b border-gray-700">α</td>

            <td class="px-3 py-2 border-b border-gray-700">(0,0)</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">l1<l2=AD-1</td>

            <td class="px-3 py-2 border-b border-gray-700">(l1+1,l2,a1,a2)</td>

            <td class="px-3 py-2 border-b border-gray-700">β</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">(0,0,0,0)</td>

            <td class="px-3 py-2 border-b border-gray-700">γ</td>

            <td class="px-3 py-2 border-b border-gray-700">(a2,l2+1-a2)</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">(l1,l2,a1,a2), onC2</td>

            <td class="px-3 py-2 border-b border-gray-700">(0,0,0,0)</td>

            <td class="px-3 py-2 border-b border-gray-700">α+γ</td>

            <td class="px-3 py-2 border-b border-gray-700">(α''(a2+1)+γ''a2, α''(l2-a2)+γ''(l2+1-a2))</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">l1<l2=AD-1</td>

            <td class="px-3 py-2 border-b border-gray-700">(l1+1,l2,a1,a2)</td>

            <td class="px-3 py-2 border-b border-gray-700">β</td>

            <td class="px-3 py-2 border-b border-gray-700">(0,0)</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">(l1,l2,a1,a2), onC1</td>

            <td class="px-3 py-2 border-b border-gray-700">(0,0,0,0)</td>

            <td class="px-3 py-2 border-b border-gray-700">1</td>

            <td class="px-3 py-2 border-b border-gray-700">(α(a1+1)+βa1+γa2,</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">l1=l2=AD-1</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">α(l1-a1)+β(l1+1-a1)+γ(l2-a2))</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">(l1,l2,a1,a2), onC2</td>

            <td class="px-3 py-2 border-b border-gray-700">(0,0,0,0)</td>

            <td class="px-3 py-2 border-b border-gray-700">1</td>

            <td class="px-3 py-2 border-b border-gray-700">(α(a2+1)+βa1+γa2,</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">l1=l2=AD-1</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">α(l2-a2)+β(l1-a1)+γ(l2+1-a2))</td>

          </tr>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">Table 2: Alice's expected relative revenue (compliant and profit-driven, defined in Equation (1)). Setting is abbreviated as "Set."</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Set. 1</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Set. 2</th>

          </tr>

        </thead>

        <tbody>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">β:γ\\α</td>

            <td class="px-3 py-2 border-b border-gray-700">10%</td>

            <td class="px-3 py-2 border-b border-gray-700">15%</td>

            <td class="px-3 py-2 border-b border-gray-700">20%</td>

            <td class="px-3 py-2 border-b border-gray-700">25%</td>

            <td class="px-3 py-2 border-b border-gray-700">25%</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">3:2</td>

            <td class="px-3 py-2 border-b border-gray-700">10%</td>

            <td class="px-3 py-2 border-b border-gray-700">15%</td>

            <td class="px-3 py-2 border-b border-gray-700">20%</td>

            <td class="px-3 py-2 border-b border-gray-700">25%</td>

            <td class="px-3 py-2 border-b border-gray-700">25.29%</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">1:1</td>

            <td class="px-3 py-2 border-b border-gray-700">10%</td>

            <td class="px-3 py-2 border-b border-gray-700">15%</td>

            <td class="px-3 py-2 border-b border-gray-700">20%</td>

            <td class="px-3 py-2 border-b border-gray-700">26.24%</td>

            <td class="px-3 py-2 border-b border-gray-700">26.24%</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">2:3</td>

            <td class="px-3 py-2 border-b border-gray-700">10%</td>

            <td class="px-3 py-2 border-b border-gray-700">15.05%</td>

            <td class="px-3 py-2 border-b border-gray-700">21.15%</td>

            <td class="px-3 py-2 border-b border-gray-700">27.39%</td>

            <td class="px-3 py-2 border-b border-gray-700">25.29%</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">1:2</td>

            <td class="px-3 py-2 border-b border-gray-700">10%</td>

            <td class="px-3 py-2 border-b border-gray-700">15.62%</td>

            <td class="px-3 py-2 border-b border-gray-700">21.56%</td>

            <td class="px-3 py-2 border-b border-gray-700">27.56%</td>

            <td class="px-3 py-2 border-b border-gray-700">25%</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">1:3</td>

            <td class="px-3 py-2 border-b border-gray-700">10.26%</td>

            <td class="px-3 py-2 border-b border-gray-700">15.87%</td>

            <td class="px-3 py-2 border-b border-gray-700">21.58%</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">1:4</td>

            <td class="px-3 py-2 border-b border-gray-700">10.34%</td>

            <td class="px-3 py-2 border-b border-gray-700">15.84%</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

          </tr>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">In both Bitcoin and BU, the merchant might wait for more confirmations before delivery when forks happen constantly. Therefore choosing "four confirmations" as the delivery condition is an oversimplification of the reality. However this simplified setting already</p>

    <p class="text-gray-300">demonstrates that long forks can be triggered more easily and more frequently in BU, which is adequate for our comparison.</p>

    <p class="text-gray-300">Selected results are shown in Table 3. We omit the ratios  <span class="math">3:1</span> ,  <span class="math">3:2</span> ,  <span class="math">2:3</span> ,  <span class="math">1:3</span>  as they follow the same pattern with the rest of the data. In BU, Alice profits from double-spending attacks with almost all sets of parameters, even when she controls only  <span class="math">1\\%</span>  of mining power; whereas in Bitcoin, even when the attacker wins all equal-length block races, double-spending is not profitable with less than  <span class="math">10\\%</span>  of mining power.</p>

    <p class="text-gray-300">ANALYTICAL RESULT 2. When BVC is absent, double-spending in BU is often more profitable than the optimal combined attack on Bitcoin of double-spending and selfish mining. Unlike in Bitcoin, in BU even a  <span class="math">1\\%</span>  miner can launch double-spending attacks with nonnegligible success rate.</p>

    <p class="text-gray-300">For non-profit-driven Alice, we introduce another action Wait to our MDP so that Alice can sometimes stop her mining equipment and watch Bob and Carol orphan each other's blocks. The results</p>

    <p class="text-gray-300">Table 3: Alice's expected absolute revenue (non-compliant and profit-driven, defined in Equation (2)). Setting 1</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">α\\β:γ</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">4:1</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">2:1</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">1:1</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">1:2</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">1:4</th>

          </tr>

        </thead>

        <tbody>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">1%</td>

            <td class="px-3 py-2 border-b border-gray-700">0.013</td>

            <td class="px-3 py-2 border-b border-gray-700">0.035</td>

            <td class="px-3 py-2 border-b border-gray-700">0.042</td>

            <td class="px-3 py-2 border-b border-gray-700">0.025</td>

            <td class="px-3 py-2 border-b border-gray-700">0.013</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">2.5%</td>

            <td class="px-3 py-2 border-b border-gray-700">0.038</td>

            <td class="px-3 py-2 border-b border-gray-700">0.089</td>

            <td class="px-3 py-2 border-b border-gray-700">0.10</td>

            <td class="px-3 py-2 border-b border-gray-700">0.063</td>

            <td class="px-3 py-2 border-b border-gray-700">0.033</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">5%</td>

            <td class="px-3 py-2 border-b border-gray-700">0.090</td>

            <td class="px-3 py-2 border-b border-gray-700">0.18</td>

            <td class="px-3 py-2 border-b border-gray-700">0.20</td>

            <td class="px-3 py-2 border-b border-gray-700">0.13</td>

            <td class="px-3 py-2 border-b border-gray-700">0.067</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">10%</td>

            <td class="px-3 py-2 border-b border-gray-700">0.24</td>

            <td class="px-3 py-2 border-b border-gray-700">0.39</td>

            <td class="px-3 py-2 border-b border-gray-700">0.40</td>

            <td class="px-3 py-2 border-b border-gray-700">0.26</td>

            <td class="px-3 py-2 border-b border-gray-700">0.14</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">15%</td>

            <td class="px-3 py-2 border-b border-gray-700">0.44</td>

            <td class="px-3 py-2 border-b border-gray-700">0.61</td>

            <td class="px-3 py-2 border-b border-gray-700">0.59</td>

            <td class="px-3 py-2 border-b border-gray-700">0.40</td>

            <td class="px-3 py-2 border-b border-gray-700">0.23</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">20%</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">0.83</td>

            <td class="px-3 py-2 border-b border-gray-700">0.78</td>

            <td class="px-3 py-2 border-b border-gray-700">0.55</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">25%</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">1.1</td>

            <td class="px-3 py-2 border-b border-gray-700">0.97</td>

            <td class="px-3 py-2 border-b border-gray-700">0.71</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

          </tr>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">Setting 2</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">α\\β:γ</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">4:1</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">2:1</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">1:1</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">1:2</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">1:4</th>

          </tr>

        </thead>

        <tbody>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">1%</td>

            <td class="px-3 py-2 border-b border-gray-700">0.01</td>

            <td class="px-3 py-2 border-b border-gray-700">0.025</td>

            <td class="px-3 py-2 border-b border-gray-700">0.034</td>

            <td class="px-3 py-2 border-b border-gray-700">0.024</td>

            <td class="px-3 py-2 border-b border-gray-700">0.011</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">2.5%</td>

            <td class="px-3 py-2 border-b border-gray-700">0.027</td>

            <td class="px-3 py-2 border-b border-gray-700">0.064</td>

            <td class="px-3 py-2 border-b border-gray-700">0.084</td>

            <td class="px-3 py-2 border-b border-gray-700">0.063</td>

            <td class="px-3 py-2 border-b border-gray-700">0.028</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">5%</td>

            <td class="px-3 py-2 border-b border-gray-700">0.063</td>

            <td class="px-3 py-2 border-b border-gray-700">0.13</td>

            <td class="px-3 py-2 border-b border-gray-700">0.16</td>

            <td class="px-3 py-2 border-b border-gray-700">0.13</td>

            <td class="px-3 py-2 border-b border-gray-700">0.064</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">10%</td>

            <td class="px-3 py-2 border-b border-gray-700">0.16</td>

            <td class="px-3 py-2 border-b border-gray-700">0.27</td>

            <td class="px-3 py-2 border-b border-gray-700">0.31</td>

            <td class="px-3 py-2 border-b border-gray-700">0.27</td>

            <td class="px-3 py-2 border-b border-gray-700">0.16</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">15%</td>

            <td class="px-3 py-2 border-b border-gray-700">0.28</td>

            <td class="px-3 py-2 border-b border-gray-700">0.41</td>

            <td class="px-3 py-2 border-b border-gray-700">0.46</td>

            <td class="px-3 py-2 border-b border-gray-700">0.41</td>

            <td class="px-3 py-2 border-b border-gray-700">0.29</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">20%</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">0.55</td>

            <td class="px-3 py-2 border-b border-gray-700">0.59</td>

            <td class="px-3 py-2 border-b border-gray-700">0.55</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">25%</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">0.69</td>

            <td class="px-3 py-2 border-b border-gray-700">0.73</td>

            <td class="px-3 py-2 border-b border-gray-700">0.69</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

          </tr>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">Selfish Mining + Double-Spending on Bitcoin</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">P(win a tie)\\α</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">10%</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">15%</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">20%</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">25%</th>

          </tr>

        </thead>

        <tbody>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">50%</td>

            <td class="px-3 py-2 border-b border-gray-700">0.1</td>

            <td class="px-3 py-2 border-b border-gray-700">0.15</td>

            <td class="px-3 py-2 border-b border-gray-700">0.2</td>

            <td class="px-3 py-2 border-b border-gray-700">0.38</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">100%</td>

            <td class="px-3 py-2 border-b border-gray-700">0.11</td>

            <td class="px-3 py-2 border-b border-gray-700">0.18</td>

            <td class="px-3 py-2 border-b border-gray-700">0.30</td>

            <td class="px-3 py-2 border-b border-gray-700">0.52</td>

          </tr>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">!<a href="img-2.jpeg">img-2.jpeg</a> Figure 3: An example in which two blocks are orphaned by one Alice's block. Carol switches to Chain 1 after the block in the blue circle is mined.</p>

    <p class="text-gray-300">are displayed in Table 4. We only display the case when  <span class="math">\\alpha = 1\\%</span>  as the results are almost identical for all  <span class="math">\\alpha</span>  values. In other words, the effectiveness of the optimal strategy is constant no matter how small Alice's mining power is. Our results show that Alice can orphan more than one block mined by Bob and Carol for almost all parameter sets. An example of this scenario can be found in Figure 3. The damage increases when Bob's and Carol's mining power shares are close, as in this case it takes longer to decide a winner once the blockchain is forked. For comparison, in Bitcoin,  <span class="math">\\max \\{u_{\\mathrm{A},3}\\} \\leq 1</span> . With selfish mining, Alice can orphan an honest block with one block only if she can propagate her blocks strictly faster than all compliant miners; with  <span class="math">51\\%</span>  attack,  <span class="math">u_{\\mathrm{A},3} = 1</span> .</p>

    <p class="text-gray-300">Table 4: Number of Bob's and Carol's blocks orphaned by each Alice's block ( <span class="math">\\alpha = 1\\%</span> , non-profit-driven Alice, defined in Equation (3)).</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">β:γ\\Setting</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">1</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">2</th>

          </tr>

        </thead>

        <tbody>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">4:1</td>

            <td class="px-3 py-2 border-b border-gray-700">0.61</td>

            <td class="px-3 py-2 border-b border-gray-700">0.62</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">3:1</td>

            <td class="px-3 py-2 border-b border-gray-700">0.83</td>

            <td class="px-3 py-2 border-b border-gray-700">0.85</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">2:1</td>

            <td class="px-3 py-2 border-b border-gray-700">1.22</td>

            <td class="px-3 py-2 border-b border-gray-700">1.26</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">3:2</td>

            <td class="px-3 py-2 border-b border-gray-700">1.50</td>

            <td class="px-3 py-2 border-b border-gray-700">1.55</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">1:1</td>

            <td class="px-3 py-2 border-b border-gray-700">1.76</td>

            <td class="px-3 py-2 border-b border-gray-700">1.76</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">2:3</td>

            <td class="px-3 py-2 border-b border-gray-700">1.77</td>

            <td class="px-3 py-2 border-b border-gray-700">1.77</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">1:2</td>

            <td class="px-3 py-2 border-b border-gray-700">1.62</td>

            <td class="px-3 py-2 border-b border-gray-700">1.62</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">1:3</td>

            <td class="px-3 py-2 border-b border-gray-700">1.30</td>

            <td class="px-3 py-2 border-b border-gray-700">1.30</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">1:4</td>

            <td class="px-3 py-2 border-b border-gray-700">1.06</td>

            <td class="px-3 py-2 border-b border-gray-700">1.06</td>

          </tr>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">ANALYTICAL RESULT 3. When BVC is absent, BU allows a non-profit-driven attacker to orphan more than one compliant miners' block with each attacker block.</p>

    <p class="text-gray-300">As BU's security is weakened when BVC is absent, a natural question to ask is whether a BVC would emerge out of BU miners' economic incentives. This section studies miners' social choice of parameters with two games. These two games reveal the inconsistency between BU supporters' belief and miners' incentives.</p>

    <p class="text-gray-300">Both games are discussed in compliant and profit-driven incentive model, in line with BU project members. An ongoing attack might also be a driving force of emergent consensus, however we do not consider this case for two reasons. First, Sect. 4 reveals that it is difficult to draw the boundaries between compliant behaviors and attacks in BU. Second, we believe a secure system design should prevent attacks from happening instead of relying on them. The loss of some attacks, including double-spending attacks, cannot be recovered afterwards.</p>

    <p class="text-gray-300">In this part we model a simple game with the following assumption:</p>

    <p class="text-gray-300">ASSUMPTION 1. Every miner can choose any EB value without affecting the profitability.</p>

    <p class="text-gray-300">We first formally define the game and explain the rationality behind this game, then present our analysis on its equilibrium.</p>

    <p class="text-gray-300">5.1.1 The EB Choosing Game. In this game,  <span class="math">n</span>  miners in the system control positive mining power share  <span class="math">m_{1}, m_{2}, \\ldots, m_{n}</span>  respectively, that satisfy  <span class="math">\\sum_{i=1}^{n} m_{i} = 1</span> . There are two possible  <span class="math">EB</span>  values:  <span class="math">\\mathrm{EB}_{1}</span>  and  <span class="math">\\mathrm{EB}_{2}</span> . A miner may choose either of them and mine blocks of exactly that size. The set of miners who choose  <span class="math">\\mathrm{EB}_{j}</span>  is denoted as  <span class="math">S_{j}</span> , where  <span class="math">j = 1, 2</span> . Define  <span class="math">S_{0} = \\emptyset</span>  for completeness. Let  <span class="math">M_{j} = \\sum_{i \\in S_{j}} m_{i}</span> , namely the total mining power that chooses  <span class="math">\\mathrm{EB}_{j}</span> . When  <span class="math">M_{1} \\neq M_{2}</span> , let  <span class="math">M_{b}</span>  be the bigger one between  <span class="math">M_{1}</span>  and  <span class="math">M_{2}</span> , and  <span class="math">M_{s}</span>  the smaller one, where  <span class="math">b, s = 1</span>  or 2; if  <span class="math">M_{1} = M_{2}</span> ,  <span class="math">b = s = 0</span> . The utility of miner  <span class="math">i</span>  is defined as follows: if  <span class="math">i \\in S_{b}</span> ,  <span class="math">u_{i} = m_{i} / \\sum_{k \\in S_{b}} m_{k}</span> ; otherwise  <span class="math">u_{i} = 0</span> . In other words, if one  <span class="math">EB</span>  value is chosen by more</p>

    <p class="text-gray-300">mining power than the other, the mining rewards are distributed among miners who choose this value, according to their mining power share; other miners do not get any reward.</p>

    <h4 id="sec-23" class="text-lg font-semibold mt-6">5.1.2. Rationality</h4>

    <p class="text-gray-300">In reality, miners mine blocks of size EB either for more transaction fees or to cause a fork to orphan other miners’ blocks, as in Sect. 4.2. In this game, miners in group <span class="math">S_{b}</span> with stronger mining power will get more expected relative rewards than miners in <span class="math">S_{s}</span>. We justify this utility setting in two ways. First, a close examination of the optimal strategies in Sect. 4.2 shows that Alice mines with the stronger miner group unless the other group has a large lead, as the stronger group has a better chance to win the block race. Second, the following reasoning yields the same result. If <span class="math">\\text{EB}_{s}&lt;\\text{EB}_{b}</span>, miners in <span class="math">S_{s}</span> will consider <span class="math">\\text{EB}_{b}</span> blocks excessive, therefore ignore them. As miners in <span class="math">S_{s}</span> control less mining power than miners in <span class="math">S_{b}</span>, their chains of <span class="math">\\text{EB}_{s}</span> blocks would be shorter and orphaned more frequently than the chains of <span class="math">\\text{EB}_{b}</span> blocks. Otherwise if <span class="math">\\text{EB}_{s}&gt;\\text{EB}_{b}</span>, blocks mined by miners in <span class="math">S_{s}</span> are ignored by miners in <span class="math">S_{b}</span>, and can only be recognized if they build a chain of length AD faster than miners in <span class="math">S_{b}</span>. As they control less mining power than miners in <span class="math">S_{b}</span>, their chains would be orphaned more often. In reality, the sticky gate of a group could be triggered occasionally, therefore the losing group should still get positive rewards rather than the value zero as we defined. This simplification does not affect our analysis, since we only care about the equilibrium of this game. When <span class="math">M_{1}=M_{2}</span>, the result becomes unpredictable, which is a bad situation for all miners.</p>

    <h4 id="sec-24" class="text-lg font-semibold mt-6">5.1.3. Nash Equilibrium</h4>

    <p class="text-gray-300">In the EB choosing game, a Nash equilibrium (NE) exists when all miners choose the same EB.</p>

    <h6 id="sec-25" class="text-base font-medium mt-4">Proof.</h6>

    <p class="text-gray-300">Recall that in an NE, no player can change its action to achieve higher utility. When all miners choose <span class="math">\\text{EB}_{b}</span>, every miner’s utility is positive. Consider a miner <span class="math">i</span> who switches to another EB. As <span class="math">i</span> controls less than 50% of total mining power, in the new setting, we have <span class="math">M_{s}=m_{i}&lt;1-m_{i}=M_{b}</span>. Therefore in the new setting, the utility of <span class="math">i</span> is 0. ∎</p>

    <p class="text-gray-300">The key factor in this equilibrium is that miners can freely choose between these two EB values. We use two EB values just to simplify the analysis regarding utility. When more EB values are in the market, the same equilibrium holds. This game reveals the crucial insight behind BU’s design:</p>

    <h6 id="sec-26" class="text-base font-medium mt-4">Analytical Result 4.</h6>

    <p class="text-gray-300">When all miners are profitable with any EB value, there is an equilibrium in which miners choose the same EB to avoid economic loss.</p>

    <h3 id="sec-27" class="text-xl font-semibold mt-8">5.2. Every Miner has a Maximum Profitable Block Size</h3>

    <p class="text-gray-300">Although the EB choosing game has a desirable equilibrium, it does not reflect the reality as Assumption 1 is apparently too strong. In this part we study a more complex situation with a different yet more realistic assumption:</p>

    <h6 id="sec-28" class="text-base font-medium mt-4">Assumption 2.</h6>

    <p class="text-gray-300">Every miner has a maximum profitable block size (MPB). If most blockchain blocks are larger than a miner’s MPB, the miner is no longer profitable, thus forced to leave the business.</p>

    <p class="text-gray-300">After all, miners’ diverse bandwidth and mining capacity is the motivation why BU allows them to signal their EB values.</p>

    <h4 id="sec-29" class="text-lg font-semibold mt-6">5.2.1. The Block Size Increasing Game</h4>

    <p class="text-gray-300">In this game, all miners are honest and know each other’s MPBs. There are <span class="math">n</span> distinct MPB values: <span class="math">\\text{MPB}_{1},\\text{MPB}_{2},\\ldots,\\text{MPB}_{n}</span>, in increasing order. Miners with <span class="math">\\text{MPB}_{i}</span> are considered as a group, which control positive mining power share <span class="math">m_{i}</span>. Apparently <span class="math">\\sum_{i=1}^{n}m_{i}=1</span>. It is possible for a miner group to control more than half of mining power. At the beginning, all miners mine with the block size <span class="math">\\text{MPB}_{1}</span>. The game proceeds in rounds. We use <span class="math">S_{j}</span> to denote the remaining miner groups before round <span class="math">j+1</span>, <span class="math">S_{0}=\\{1,2,\\ldots,n\\}</span>. In round <span class="math">j</span>, all remaining miner groups vote on whether to increase the block size <span class="math">MG</span> to <span class="math">\\text{MPB}_{j+1}</span>. If at least half of the remaining mining power vote to increase the value, the block size is raised and miner group <span class="math">j</span> leaves the game, <span class="math">S_{j+1}=S_{j}-\\{j\\}</span>. The game terminates when more than half of the remaining mining power votes “no”. Assuming the game terminates after round <span class="math">t</span>, the utility function of miner <span class="math">i</span> is: if <span class="math">i\\in S_{t}</span>, <span class="math">u_{i}=m_{i}/\\sum_{k\\in S_{t}}m_{k}</span>; otherwise <span class="math">u_{i}=0</span>. In other words, the rewards are split among the miners who survive until the game terminates. When the game terminates, all remaining miners announce the same EB to prevent attackers from splitting the network.</p>

    <h4 id="sec-30" class="text-lg font-semibold mt-6">5.2.2. Rationality</h4>

    <p class="text-gray-300">Miners with the same MPB naturally group together as they share the same interests. When all miners are profit-driven, it is rational to deliberately create larger blocks to force the weakest miner to leave the business, so that the remaining miners receive larger share of the mining rewards. As can be seen from our analysis of the previous game, miners with the larger block size will succeed when more than half of mining power is on their side. However, by doing so, miners with moderate MPBs also increase their chance of being abandoned. Consider a system of three miner groups: <span class="math">m_{1}=m_{2}=0.3</span>, <span class="math">m_{3}=0.4</span>. If miner 2 votes “yes” in the first round, in the second round miner 3 would raise <span class="math">MG</span> to <span class="math">\\text{MPB}_{3}</span> and force miner 2 out of the business. Therefore, further analysis is required to learn when the game terminates.</p>

    <h4 id="sec-31" class="text-lg font-semibold mt-6">5.2.3. Termination State</h4>

    <p class="text-gray-300">We call <span class="math">S_{j}</span> a stable set of miner groups if one of the following conditions hold: (1) <span class="math">j=n</span>; (2) <span class="math">S_{k}</span> is the largest true stable subset of <span class="math">S_{j}</span>, and have <span class="math">\\sum_{i=j}^{k-1}m_{i}&gt;\\sum_{i=k}^{n}m_{i}</span> and <span class="math">\\sum_{i=j+1}^{k-1}m_{i}\\leq\\sum_{i=k}^{n}m_{i}</span>. The block size increasing game terminates when the remaining miner groups form a stable set.</p>

    <h6 id="sec-32" class="text-base font-medium mt-4">Proof.</h6>

    <p class="text-gray-300">We prove by backward induction. When <span class="math">j=n</span>, the system terminates, as no miner would mine blocks larger than its MPB. Assuming <span class="math">S_{k}</span> is the largest true stable subset of <span class="math">S_{j}</span> and the system terminates if <span class="math">S_{k}</span> is the remaining set. We claim that if <span class="math">S_{j}</span> is a stable set, miners from <span class="math">j</span> to <span class="math">k-1</span> would vote “no” on a larger block size to terminate the game. This is because if <span class="math">j</span> leaves, miners in <span class="math">S_{k}</span> would remove all miners between <span class="math">j+1</span> and <span class="math">k-1</span> with no risk in the following rounds. Similarly, if <span class="math">S_{j}</span> is not a stable set, by definition we have <span class="math">\\sum_{i=j}^{k-1}m_{i}\\leq\\sum_{i=k}^{n}m_{i}</span> or <span class="math">\\sum_{i=j+1}^{k-1}m_{i}&gt;\\sum_{i=k}^{n}m_{i}</span>. The latter case contradicts the fact that <span class="math">S_{k}</span> is the largest true stable subset of <span class="math">S_{j}</span>, whereas in the former case, miners from <span class="math">j</span> to <span class="math">k-1</span> would be forced to leave. ∎</p>

    <p class="text-gray-300">Our analysis shows that for many initial settings, the consensus on <span class="math">MG</span> and EB does not hold. Such consensus requires a delicate</p>

    <p class="text-gray-300">!<a href="img-3.jpeg">img-3.jpeg</a> round 1: block size increased Figure 4: A block size increasing game. In round 1, miner group 2, 3 and 4 vote for larger blocks, thus group 1 is forced to leave. In round 2, group 2 and 3 vote against larger blocks, because if group 2 leaves, group 4 can also force group 3 to leave.</p>

    <p class="text-gray-300">!<a href="img-4.jpeg">img-4.jpeg</a> round 2: game terminated</p>

    <p class="text-gray-300">miner group 1,  <span class="math">m_{1} = 10\\%</span> miner group 4,  <span class="math">m_4 = 40\\%</span> miner group 2,  <span class="math">m_2 = 20\\%</span> vote for a larger block size miner group 3,  <span class="math">m_3 = 30\\%</span> vote against a larger block size</p>

    <p class="text-gray-300">condition, which is easily disrupted even when it holds. When all miners are rational, any change in the system, like a strong miner increases its mining capacity or network bandwidth, might break the consensus and result in an increase in the block size limit. During the transition period, people might broadcast different  <span class="math">EBs</span>  to advocate their preferred block size and threaten other miners [31, 48], leaving the system in a vulnerable state as shown by Sect. 4. Moreover, if block size keeps rising in the system, eventually some public nodes will not be able to handle these large blocks and the decentralized nature of Bitcoin is damaged. In other words, in BU, the profit-driven nature of miners is inconsistent with Bitcoin's decentralized philosophy.</p>

    <p class="text-gray-300">ANALYTICAL RESULT 5. When every miner has a maximum profitable block size, unless all miners form a stable set, miners who can handle large blocks can form a coalition and increase their block size, so that other miners are forced to exit the business.</p>

    <p class="text-gray-300">The attacks described in this paper cannot be deployed to the current Bitcoin network, as all BU miners signal  <span class="math">EB = 1</span>  MB, which is equivalent to Bitcoin's BVC. This observation can be explained by our EB choosing game: when the majority mining power chooses a certain  <span class="math">EB</span> , it is rational for the rest to follow, maintaining an equilibrium. Unfortunately, such equilibrium does not hold when all miners adopt BU.</p>

    <p class="text-gray-300">Some BU supporters believe that our work, along with all game theoretic analyses on mining, is not practical as it "does not take miners' interest in a healthy network into consideration." [42]. We argue that first, there are plenty of examples where miners are malicious. Miners deployed  <span class="math">51\\%</span>  attack to destroy Coiledcoin [30] and to double spend on Krypton [40]. Even BU miners prepare to launch a  <span class="math">51\\%</span>  attack on the original Bitcoin when they reach super-majority, in order to force users and other miners to adopt</p>

    <p class="text-gray-300">BU [50]. Second, some mining-protocol attacks do not require the miners' interest, such as bribery attacks [4]. At last, when upgrading the mining protocol, we, as researchers, usually think of how to avoid new attack vectors instead of opening them. Security should be built in the protocol instead of relying on external forces. An analogy can be made between the attacks in this paper and selfish mining attack. Although the latter has not been observed in reality, almost all mining protocols designed after its discovery introduced extra mechanisms to mitigate the attack, such as Ethereum [15], SPECTRE [43], Decred [14], etc.</p>

    <p class="text-gray-300">By abandoning the prescribed BVC, BU provides a brave attempt not only in addressing the deficiency in the current Bitcoin system, but also in the design of cryptocurrencies in general. However, contrary to the designers' beliefs, the absence of a prescribed BVC opens multiple attack vectors. BU developers believe that the security of BU can be strengthened by adjusting the parameters [46, 48]. However, we argue that adjusting the parameters only trades one risk for another. For example, a large  <span class="math">AD</span>  allows an attacker to keep the blockchain forked for longer periods of time, whereas a small  <span class="math">AD</span>  lowers the attacker's effort to trigger all sticky gates and embed giant blocks in the blockchain. Similarly, a longer sticky gate period gives the attacker more time to mine giant blocks, whereas a shorter period allows the attacker to split the network more frequently.</p>

    <p class="text-gray-300">Another attempt to mitigate the attacks is BUIP55 [37], which allows miners to signal their next  <span class="math">EBs</span>  and their intended dates to upgrade in advance. By facilitating compliant miners to coordinate their choices of  <span class="math">EBs</span> , the designers hope that miners will reach a consensus before a new  <span class="math">EB</span>  comes into effect. However, as a miner can change the signal without any negative consequence, BUIP55 cannot bond the miners with their promises, neither can it prevent miners from maliciously increasing the block size. Moreover, it gives the attacker another tool to influence other miners' future  <span class="math">EBs</span> .</p>

    <p class="text-gray-300">We believe there is a fundamental reason lying behind the fact that BU, in the absence of BVC, weakens Bitcoin's security: the absence of BVC allows an attacker to separate the mining power of other miners, then utilize some miner's mining power against the others' for the attacker's own purpose. In contrast, in Bitcoin, as all compliant miners' behaviors are homogeneous, they act as a whole to defend against malicious behaviors. Unfortunately, an "emergent" BVC is not guaranteed. This is because the profit-driven nature of miners is inconsistent with Bitcoin's decentralized philosophy. To date, a prescribed BVC is the only mechanism to keep them aligned in Bitcoin. When not all miners are profit-driven, it should be even harder to reach a BVC.</p>

    <p class="text-gray-300">We do not exclude the possibility of a secure blockchain protocol without a prescribed BVC. One approach is to prove that the blockchain cannot be deliberately forked with less than  <span class="math">50\\%</span>  of malicious mining power, so that no extra security assumption is introduced. To the best of our knowledge, to date, no proof-of-work consensus protocol achieves this goal.</p>

    <p class="text-gray-300">In the context of Bitcoin, we believe a more practical way to defend against these attacks is to bring back the prescribed BVC. Note that having a prescribed BVC does not mean the rules cannot be dynamically adjusted. As long as the protocol guarantees a BVC at any given time, the detailed rules does not need to be prescribed. This approach is followed by BIP 100 <em>(19)</em>, a younger cryptocurrency named Decred <em>(14)</em>, as well as the following countermeasure we propose.</p>

    <p class="text-gray-300">In this countermeasure, miners can vote for or against a block size increase with their blocks. If in a 2016-block difficulty adjustment period, the proportion of blocks that vote for an increase is above a certain threshold, and the proportion that vote against is below a certain threshold, the block size limit increases by a small fixed value. As the blockchain might be forked at the end of the period, resulting in different understandings on whether the thresholds are reached, the adjustment should only be effective after a significant number of blocks, say two hundred, are mined in the next period. The limit can also decrease in a similar manner. This scheme follows BU’s philosophy that the effective block size limit is dynamically adjusted by miners, yet still maintains BVC at all time. At last we note that currently there is no secure solution that dynamically adjusts the block size limit according to the network and storage capacity of both mining and non-mining participants.</p>

    <h3 id="sec-37" class="text-xl font-semibold mt-8">6.4. Complex Consequences of Larger Blocks</h3>

    <p class="text-gray-300">Finding the optimal block size is a difficult task. On the surface, larger blocks lead to higher transaction confirmation throughput, encouraging more transactions with lower fees, which helps Bitcoin reach its expanding potential. These new transactions incur three aspects of extra costs from the public nodes: (1) higher network bandwidth to receive and broadcast transactions, (2) longer verification time to check their signatures, and (3) more memory space to store the unspent transaction output set, as the entire set is stored in memory in Bitcoin’s current implementation. Furthermore, lower fees result in higher proportion of small-size transactions <em>(22)</em>, which consumes higher bandwidth and verification time per byte when comparing with large-size transactions. Early analyses on the consequences of large blocks can be found in <em>(12; 21)</em>. As predicting the new transaction arrival rate is highly non-trivial, it is not certain whether the current public nodes can handle these transactions. If these extra costs drive a significant number of public nodes offline, the network’s quality of service would be damaged and the ecosystem is further centralized.</p>

    <p class="text-gray-300">BU’s approach to explore the optimal block size is via trial and error. Even if we do not consider the attacks in this paper, this approach is controversial as constant exploration on the block size limit would lower the performance of Bitcoin and leave the network vulnerable to other attacks. Moreover, when miners’ interests are misaligned with other participants, there is no mechanism in BU to reach a compromise, as miners are fully in charge of the block size.</p>

    <h3 id="sec-38" class="text-xl font-semibold mt-8">6.5. The Long Road to Decentralization</h3>

    <p class="text-gray-300">Although most people in the cryptocurrency community recognize the value of decentralization, most cryptocurrencies, including Bitcoin, only partially achieve that goal <em>(45)</em>. Mining activities tend to geographically located in places with cheap electricity; all proof-of-work schemes, which allocate new coins according to the current wealth distribution, suffer from Matthew Effect.</p>

    <p class="text-gray-300">Any decentralized system has two levels of power struggles: rule setting and execution. In analogy to a democratic country, the rule setting level decides who can vote, the execution level makes important decisions such as who gets elected. In Bitcoin, the rule setting level decides who makes the block validity rules, the execution level decides which blocks end up in the main chain and/or which blocks get relayed by the network, etc. By allowing consensus rules to be dynamically adjusted, BU aims to decentralize the rule setting level of Bitcoin. However, as our analysis shows, such attempt risks leading to a centralized blockchain where big miners rule by forcing small miners and slow public nodes to leave the network. On the other hand, current Bitcoin is arguably centralized in rule setting, but allows a more decentralized decision-making process in the blockchain. Before having an ideal solution to decentralize both levels, we argue that it is better to rely on some centralized power to lower the threshold so that everyone has a voice. After all, in a democracy, women and the poor are “prescribed” with voting rights so that the entire system can be more decentralized.</p>

    <h2 id="sec-39" class="text-2xl font-bold">7. Conclusion</h2>

    <p class="text-gray-300">Although deployed by miners who control almost half of the mining power in Bitcoin, BU’s security has not been thoroughly analyzed. The debate on BU’s security shows no sign of consensus, due to different miner incentive models assumed by BU supporters and objectors. In this study, we aim to end this debate by evaluating BU’s security within three incentive models. The results invalidate the two major arguments from BU supporters, namely a BVC is not necessary and a non-prescribed BVC would emerge. Our further analysis shows that at the core of the newly introduced attack vectors is BU’s abandonment of a prescribed BVC. Based on this conclusion, we propose a countermeasure to BU’s vulnerabilities, which allows miners to collectively decide the block size limit without abandoning BVC.</p>

    <p class="text-gray-300">Departing from our confirmation on the necessity of a prescribed BVC, we argue that now is the time to establish a series of principles in cryptocurrency protocol design in order to reduce the trial and error space, so that we can avoid energy-and-resource-consuming battles such as the one around BU. We hope our study can trigger discussions on such principles and their boundary conditions, such as different incentive models in this case. Therefore we, the cryptocurrency community, could move our discussion on security issues to a macro level, and therefore improve the efficiency of knowledge accumulation in the field.</p>

    <h6 id="sec-40" class="text-base font-medium mt-4">Acknowledgements.</h6>

    <p class="text-gray-300">This work was supported in part by the Research Council KU Leuven: C16/15/058. In addition, this work was supported by the imec High Impact initiative Distributed Trust project on Blockchain and Smart contracts. We would like to thank Kaiyu Shao, Andrew Miller, Alex Petrov, Güneş Acar, Alan Szepieniec, Yonatan Sompolinsky and the anonymous reviewers for their valuable comments and suggestions.</p>

    <p class="text-gray-300">References</p>

    <ul class="list-disc list-inside space-y-1 text-gray-300 my-2 ml-4">

      <li>[1] Lear Bahack. 2013. Theoretical Bitcoin Attacks with less than Half of the Computational Power (draft). arXiv preprint arXiv:1312.7013 (2013).</li>

      <li>[2] Blockchain. 2017. Bitcoin Block Explorer. (2017). Retrieved March 31, 2017 from https://blockchain.info/</li>

      <li>[3] Blockchain. 2017. Bitcoin Blockchain Wallet Users. (2017). Retrieved March 31, 2017 from https://blockchain.info/charts/my-wallet-n-users</li>

      <li>[4] Joseph Bonneau, Edward W. Felten, Steven Goldfeder, Joshua A. Kroll, and Arvind Narayanan. 2016. Why buy when you can rent?. In International Conference on Financial Cryptography and Data Security. Springer, 19–26.</li>

      <li>[5] Joseph Bonneau, Andrew Miller, Jeremy Clark, Arvind Narayanan, Joshua A Kroll, and Edward W Felten. 2015. Sok: Research perspectives and challenges for Bitcoin and cryptocurrencies. In Security and Privacy (SP), 2015 IEEE Symposium on. IEEE, 104–121.</li>

      <li>[6] Miles Carlsten, Harry Kalodner, S. Matthew Weinberg, and Arvind Narayanan. 2016. On the Instability of Bitcoin Without the Block Reward. In Proceedings of the 2016 ACM SIGSAC Conference on Computer and Communications Security (CCS ’16). ACM, New York, NY, USA, 154–167. https://doi.org/10.1145/2976749.2978408</li>

      <li>[7] Iadine Chadès, Guillaume Chapron, Marie-Josée Cros, Frédérick Garcia, and Régis Sabbadin. 2014. MDPtoolbox: a multi-platform toolbox to solve stochastic dynamic programming problems. Ecography 37, 9 (2014), 916–920.</li>

      <li>[8] Andrew Clifford. 2016. Decentralizing the Block Size Limit. (Oct. 2016). https://keepingstock.net/decentralizing-the-block-size-limit-1fe8f86730c</li>

      <li>[9] Andrew Clifford. 2016. OCS Emergent Consensus. (Dec. 2016). https://www.dropbox.com/sh/0y8jpbb2w8f4d1h/AABfzxJEq9Q23xjihtFFasova?dl=0&preview=OCS+Emergent+Consensus.pptx</li>

      <li>[10] Andrew Clifford. 2016. Time for Bitcoin 1.x. (July 2016). https://medium.com/@solex1/time-for-bitcoin-1-x-17b54eed2c4a</li>

      <li>[11] Andrew Clifford. 2017. Introduction to Emergent Consensus. (March 2017). https://medium.com/@solex1/introduction-to-emergent-consensus-c318c6c0e1bd</li>

      <li>[12] Kyle Croman, Christian Decker, Ittay Eyal, Adem Efe Gencer, Ari Juels, Ahmed Kosha, Andrew Miller, Prateek Saxena, Elaine Shi, Emin Gün Sirer, et al. 2016. On scaling decentralized blockchains. In International Conference on Financial Cryptography and Data Security. Springer, 106–125.</li>

      <li>[13] Cryptoconomy. 2017. The median EB attack against BU explained. (March 2017). https://np.reddit.com/r/Bitcoin/comments/5yjh8b/the_median_eb_attack_ against_bu_explained_im/</li>

      <li>[14] Decred Developers. 2017. Decred - decentralized credit. (2017). https://www.decred.org/</li>

      <li>[15] Vitalik Buterin et al. 2016. Ethereum White Paper: Modified Ghost Implementation. (2016). https://github.com/ethereum/wiki/wiki/White-Paper#modified-ghost-implementation</li>

      <li>[16] Ittay Eyal and Emin Gün Sirer. 2014. Majority is not enough: Bitcoin mining is vulnerable. In Financial Cryptography and Data Security. Springer, 436–454.</li>

      <li>[17] Corin Faife. 2017. Will 2017 Bring an End to Bitcoin’s Great Scaling Debate? (Jan. 2017). http://www.coindesk.com/2016-bitcoin-protocol-block-size-debate/</li>

      <li>[18] gandrewstone et al. 2017. Bitcoin Unlimited integration/staging tree. (2017). https://github.com/BitcoinUnlimited/BitcoinUnlimited Accessed: 2017-04-05.</li>

      <li>[19] Jeff Garzik, Tom Harding, and Dagur Valberg Johannsson. 2015. BIP 100: Dynamic maximum block size by miner vote. (June 2015). https://github.com/jgarzik/bip100/blob/master/bip-0100.mediawiki</li>

      <li>[20] Arthur Gervais, Ghassan O. Karame, Karl Wüst, Vasileios Glykantzis, Hubert Ritzdorf, and Srdjan Capkun. 2016. On the Security and Performance of Proof of Work Blockchains. In Proceedings of the 2016 ACM SIGSAC Conference on Computer and Communications Security (CCS ’16). ACM, New York, NY, USA, 3–16. https://doi.org/10.1145/2976749.2978341</li>

      <li>[21] BitFury Group. 2015. Block Size Increase. (Sept. 2015). http://bitfury.com/content/5-white-papers-research/block-size-1.1.1.pdf</li>

      <li>[22] BitFury Group. 2016. The distribution of transactions with different sizes. (Jan. 2016). https://imgur.com/4Lec4VY</li>

      <li>[23] Tom Harding. 2016. BUIP038: Revert “sticky gate”. (Nov. 2016). https://github.com/BitcoinUnlimited/BUIP/blob/master/038.mediawiki</li>

      <li>[24] Ethan Heilman. 2014. One Weird Trick to Stop Selfish Miners: Fresh Bitcoins, A Solution for the Honest Miner. Cryptology ePrint Archive, Report 2014/007. (2014). https://eprint.iacr.org/2014/007.</li>

      <li>[25] Alyssa Hertig. 2016. So, Ethereum’s Blockchain is Still Under Attack? (2016). https://www.coindesk.com/so-ethereum’s-blockchain-is-still-under-attack/</li>

      <li>[26] icodeforbitcoin. 2017. Nodecounter.com. (2017). Retrieved April 21, 2017 from http://xtnodes.com/</li>

      <li>[27] Aggelos Kiayias, Elias Koutsoupias, Maria Kyropoulos, and Yiannis Tselekounis. 2016. Blockchain mining games. In Proceedings of the 2016 ACM Conference on Economics and Computation. ACM, 365–382.</li>

      <li>[28] Joshua A Kroll, Ian C Davey, and Edward W Felten. 2013. The economics of Bitcoin mining, or Bitcoin in the presence of adversaries. In Proceedings of WED, Vol. 2013. Citeseer.</li>

      <li>[29] macbook air. 2013. A successful DOUBLE SPEND USD 10000 against OKPAY this morning. (Dec. 2013). https://bitcointalk.org/index.php?topic=152348</li>

      <li>[30] makomk. 2013. Coiledcoin. (2013). http://altcoin.wikia.com/wiki/Coiledcoin</li>

      <li>[31] Mengerian. 2016. The Market for Consensus. (Dec. 2016). https://medium.com/@Mengerian/the-market-for-consensus-203de92ed844</li>

      <li>[32] Satoshi Nakamoto. 2008. Bitcoin: A peer-to-peer electronic cash system. (2008). http://www.bitcoin.org/bitcoin.pdf</li>

      <li>[33] Kartik Nayak, Srijan Kumar, Andrew Miller, and Elaine Shi. 2016. Stubborn mining: Generalizing selfish mining and combining with an eclipse attack. In IEEE European Symposium on Security and Privacy (EureS&P). IEEE, 305–320.</li>

      <li>[34] The Bitcoin Unlimited Community Organization. 2017. Bitcoin Unlimited. (2017). Retrieved June 1, 2017 from https://www.bitcoinunlimited.info/</li>

      <li>[35] The Bitcoin Unlimited Community Organization. 2017. Bitcoin Unlimited: FAQ. (2017). Retrieved June 1, 2017 from https://www.bitcoinunlimited.info/faq</li>

      <li>[36] Luke Parker. 2017. Bitcoin ‘spam attack’ stressed network for at least 18 months, claims software developer. (2017). https://bravenewcoin.com/news/bitcoin-spam-attack-stressed-network-for-at-least-18-months-claims-software-developer/</li>

      <li>[37] Peter Rizun. 2017. BUIP055: Increase the Block Size Limit at a Fixed Block Height. (May 2017). https://bitco.in/forum/threads/buip055-passed-increase-the-block-size-limit-at-a-fixed-block-height.2103/</li>

      <li>[38] Peter R Rizun. 2015. A Transaction Fee Market Exists Without a Block Size Limit. (Aug. 2015). https://www.bitcoinunlimited.info/resources/feemarket.pdf</li>

      <li>[39] Peter R. Rizun. 2016. the Excessive-Block Gate: How a Bitcoin Unlimited Node Deals With “Large” Blocks. (Nov. 2016). https://medium.com/@peter_r/the-excessive-block-gate-how-a-bitcoin-unlimited-node-deals-with-large-blocks-22a4a5c322d4</li>

      <li>[40] Rocky. 2016. Krypton recovers from a new type of 51% network attack. (2016). https://cryptohustle.com/krypton-recovers-from-a-new-type-of-51-network-attack</li>

      <li>[41] Ayelet Sapirshtein, Yonatan Sompolinsky, and Aviv Zohar. 2016. Optimal Selfish Mining Strategies in Bitcoin. Financial Cryptography and Data Security (2016), 515–532.</li>

      <li>[42] satoshis_sockpuppet. 2017. Gold collapsing. Bitcoin UP. (2017). https://bitco.in/forum/threads/gold-collapsing-bitcoin-up.16/page-1002</li>

      <li>[43] Yonatan Sompolinsky, Yoad Lewenberg, and Aviv Zohar. 2016. SPECTRE: A Fast and Scalable Cryptocurrency Protocol. (2016). http://www.cs.huji.ac.il/~yoni_sompo/pubs/16/SPECTRE_complete.pdf</li>

      <li>[44] Yonatan Sompolinsky and Aviv Zohar. 2016. Bitcoin’s security model revisited. arXiv preprint arXiv:1605.09193 (2016).</li>

      <li>[45] Balaji S. Srinivasan. 2017. Quantifying Decentralization. (2017). https://news.21.co/quantifying-decentralization-e39db233c28e</li>

      <li>[46] Andrew Stone. 2016. BUIP041 (BUIP038 Counter): Prevent Minority Hash Power From Injecting Very Large Blocks into the Blockchain. (Dec. 2016). https://medium.com/@g.andrew.stone/buip041-buipt038-counter-prevent-minority-hash-power-from-injecting-very-large-blocks-into-the-4690deba0892</li>

      <li>[47] Andrew Stone. 2016. Emergent Consensus Simulations. (Dec. 2016). https://medium.com/@g.andrew.stone/emergent-consensus-simulations-99604190fa31</li>

      <li>[48] Andrew Stone. 2016. The Median EB “Attack” Against BU Explained. (March 2016). https://medium.com/@g.andrew.stone/the-median-eb-attack-against-bu-explained-daeadc3b43ba</li>

      <li>[49] Kyle Torpey. 2017. BitPay CEO Stephen Pair: Bitcoin Unlimited Would Materially Degrade the Network. (April 2017). https://bitcoinmagazine.com/articles/bitpay-ceo-stephen-pair-bitcoin-unlimited-would-materially-degrade-network/</li>

      <li>[50] Aaron van Wirdum. 2017. Bitcoin Unlimited Miners May Be Preparing a 51% Attack on Bitcoin. (May 2017). https://bitcoinmagazine.com/articles/bitcoin-unlimited-miners-may-be-preparing-51-attack-bitcoin/</li>

      <li>[51] Aaron van Wirdum. 2017. How Bitcoin Unlimited Users May End Up on Different Blockchains. (Jan. 2017). https://bitcoinmagazine.com/articles/how-bitcoin-unlimited-users-may-end-different-blockchains/</li>

      <li>[52] Ren Zhang and Bart Preneel. 2017. Publish or Perish: A Backward-Compatible Defense Against Selfish Mining in Bitcoin. In Topics in Cryptology – CT-RSA 2017: The Cryptographers’ Track at the RSA Conference 2017, San Francisco, CA, USA, February 14–17, 2017, Proceedings, Helena Handchish (Ed.), Springer International Publishing, Cham, 277–292. https://doi.org/10.1007/978-3-319-52153-4_16</li>

    </ul>`;
---

<BaseLayout title="On the Necessity of a Prescribed Block Validity Consensus: A... (2017/686)">
  <article class="max-w-4xl mx-auto article-prose">
    <nav class="mb-8">
      <a href="/papers" class="text-blue-400 hover:text-blue-300">
        &larr; Back to Papers
      </a>
    </nav>

    <header class="mb-12">
      <h1 class="text-3xl font-bold mb-4"
        set:html={TITLE_HTML} />
      <p class="text-gray-400 mb-2"
        set:html={AUTHORS_HTML} />
      <p class="text-gray-500 text-sm mb-4">
        2017 &middot; eprint 2017/686
      </p>
      <div class="flex gap-4 text-sm">
        <a
          href={EPRINT_URL}
          target="_blank"
          rel="noopener noreferrer"
          class="text-blue-400 hover:text-blue-300"
        >
          Paper (eprint) &rarr;
        </a>
      </div>
      <p class="mt-4 text-xs text-gray-500">
        All content below belongs to the original authors. This page
        reproduces the paper for educational purposes. Always
        <a
          href={EPRINT_URL}
          target="_blank"
          rel="noopener noreferrer"
          class="text-blue-400 hover:text-blue-300"
        >cite the original</a>.
      </p>
      <p class="mt-1 text-xs text-gray-600">
        Converted with: {CRAWLER} &middot; {CONVERTED_DATE}
      </p>
    </header>

    <Fragment set:html={CONTENT} />

  </article>
</BaseLayout>
