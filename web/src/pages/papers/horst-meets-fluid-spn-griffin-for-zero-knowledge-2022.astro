---
import BaseLayout from '../../layouts/BaseLayout.astro';
import PaperDisclaimer from '../../components/PaperDisclaimer.astro';
import PaperHistory from '../../components/PaperHistory.astro';

const EPRINT_URL = 'https://eprint.iacr.org/2022/403';
const CRAWLER = 'marker';
const CONVERTED_DATE = '2026-02-16';
const TITLE_HTML = 'Horst Meets Fluid-SPN: Griffin for Zero-Knowledge Applications';
const AUTHORS_HTML = 'Lorenzo Grassi, Yonglin Hao, Christian Rechberger, Markus Schofnegger, Roman Walch, Qingju Wang';

const CONTENT = `    <section id="abstract" class="mb-10">
      <h2 class="text-2xl font-bold">Abstract</h2>
      <p class="text-gray-300">Zero-knowledge (ZK) applications form a large group of use cases in modern cryptography, and recently gained in popularity due to novel proof systems. For many of these applications, cryptographic hash functions are used as the main building blocks, and they often dominate the overall performance and cost of these approaches.

Therefore, in the last years several new hash functions were built in order to reduce the cost in these scenarios, including Poseidon and Rescue among others. These hash functions often look very different from more classical designs such as AES or SHA-2. For example, they work natively over prime fields rather than binary ones. At the same time, for example Poseidon and Rescue share some common features, such as being SPN schemes and instantiating the nonlinear layer with invertible power maps. While this allows the designers to provide simple and strong arguments for establishing their security, it also introduces crucial limitations in the design, which may affect the performance in the target applications.

In this paper, we propose the Horst construction, in which the addition in a Feistel scheme (x, y) -&gt; (y + F(x), x) is extended via a multiplication, i.e., (x, y) -&gt; (y * G(x) + F(x), x).

By carefully analyzing the performance metrics in SNARK and STARK protocols, we show how to combine an expanding Horst scheme with a Rescue-like SPN scheme in order to provide security and better efficiency in the target applications. We provide an extensive security analysis for our new design Griffin and a comparison with all current competitors.</p>
      <p class="text-gray-300"><strong>Keywords:</strong> Hash Functions &middot; Griffin &middot; Zero Knowledge &middot; Horst &middot; Fluid-SPN</p>
    </section>

    <section id="sec-1" class="mb-10">
      <h2 class="text-2xl font-bold">1 Introduction</h2>

    <p class="text-gray-300">Concepts like multi-party computation (MPC), homomorphic encryption (HE), post-quantum signature schemes, and zero-knowledge (ZK) proof systems have recently grown in popularity. Some of these applications favor cryptographic schemes with specific properties, such as a small number of multiplications. Considering  <span class="math">\\mathbb{F}_p^t</span>  for a prime  <span class="math">p\\geq 3</span>  and  <span class="math">t\\geq 1</span> , examples include Feistel-MiMC [3], GMiMC [2], POSEIDON[32], Rescue [4, 59], Grendel [58], Reinforced Concrete [31], Neptune [35], and Anemoi [16], among others.</p>

    <p class="text-gray-300">The performance metrics vary between the different use cases. While the cost in e.g. MPC is well-studied [36, 3, 34], ZK protocols often have more sophisticated optimization targets. The two major classes of ZK proof systems are zero-knowledge succinct non-interactive arguments of knowledge (zk-SNARKs) and zero-knowledge scalable transparent arguments of knowledge (zk-STARKs), which are also the ones we focus on in this paper.</p>

    <p class="text-gray-300">Recent hash functions proposed for these protocols differ substantially from each other, however their internal permutations are usually SPN constructions. While this approach may have advantages for arguing security, it can also have various limitations affecting the performance in ZK protocols.</p>

      <h3 id="sec-1.1" class="text-xl font-semibold mt-8">1.1 Hash and Compression Functions in ZK Settings</h3>

    <p class="text-gray-300">Cost Metrics in ZK Protocols. In many ZK applications, the prover uses ZK proofs to convince a verifier that they know a preimage x of a given hash or compression output  <span class="math">y = \\mathcal{H}(x)</span>  without revealing anything about x. The efficiency of these protocols depends on the details of  <span class="math">\\mathcal{H}</span> . In zk-SNARKs, the cost of the proof is proportional to the number of nonlinear operations one has to perform, and in some cases (e.g., Plonk [29]) the number of linear operations must also be considered. In zk-STARKs, the cost is related to the degree and the depth of the circuit that must be verified. In both cases, it is not required to recompute  <span class="math">\\mathcal{H}</span>  in order to determine if  <span class="math">y = \\mathcal{H}(x)</span> . Indeed, one can verify any equivalent cheaper representation  <span class="math">\\mathcal{F}(x,y) = 0</span>  which is satisfied if and only if  <span class="math">y = \\mathcal{H}(x)</span> .</p>

    <p class="text-gray-300">Most previous designs focused only on a subset of cost metrics. For example, the idea of MiMC, HadesMiMC, and Poseidon was to minimize the number of multiplications. As a result, they can be efficient in SNARKs, but their comparatively large round numbers lead to disadvantages in other proof systems. In contrast, <em>Rescue</em> has an inner structure tailored for STARKs, which results in comparatively low round numbers and decent Plonk performance. However, the efficiency in other SNARKs and the plain performance suffer from this structure.</p>

    <p class="text-gray-300"><strong>SPN Schemes and Power Maps.</strong> Competitive hash functions for ZK protocols include <em>Rescue</em> and Poseidon. Both schemes are instantiated via an SPN permutation, whose round function  <span class="math">\\mathcal{R}: \\mathbb{F}_p^t \\to \\mathbb{F}_p^t</span>  is defined as</p>

    <p class="text-gray-300">
<span class="math">$\\mathcal{R}(\\cdot) = c + M \\times S(\\cdot),\\tag{1}</span>$</p>

    <p class="text-gray-300">where c is a round constant,  <span class="math">M \\in \\mathbb{F}_p^{t \\times t}</span>  is an MDS matrix, and  <span class="math">S : \\mathbb{F}_p^t \\to \\mathbb{F}_p^t</span>  is an S-box layer defined as</p>

    <p class="text-gray-300">
<span class="math">$S(x_0, x_1, \\dots, x_{t-1}) = S_0(x_0) || S_1(x_1) || \\dots || S_{t-1}(x_{t-1})</span>$
(2)</p>

    <p class="text-gray-300">for invertible maps  <span class="math">S_i : \\mathbb{F}_p \\to \\mathbb{F}_p</span>  ( <span class="math">\\cdot \\mid \\mid \\cdot</span>  denotes concatenation). Every round of <em>Rescue</em> consists of two steps, one in which all  <span class="math">S_i</span>  correspond to  <span class="math">x \\mapsto x^{1/d}</span>  and one in which all  <span class="math">S_i</span>  correspond to  <span class="math">x \\mapsto x^d</span> . Poseidon uses two different rounds, one in which  <span class="math">S_i(x) = x^d</span>  and one in which  <span class="math">S_0(x) = x^d</span>  and  <span class="math">S_{i\\neq 0}(x) = x</span>  (identity).</p>

      <h3 id="sec-1.2" class="text-xl font-semibold mt-8">1.2 Our Contribution</h3>

    <p class="text-gray-300"><strong>SPN Schemes in ZK.</strong> An SPN scheme usually allows for simple and strong security arguments regarding statistical attacks, including the (classical) differential [12] and linear [46] attacks. For example, the combination of a linear layer with a high branch number (e.g., an MDS matrix) and an S-box layer with a good maximum differential probability (e.g., certain classes of low-degree S-boxes) allows to efficiently use the wide trail design strategy [22].</p>

    <p class="text-gray-300">However, SPN schemes over  <span class="math">\\mathbb{F}_p^t</span>  have a crucial limitation in our setting. Indeed, a common way to instantiate the nonlinear layer for ZK use cases is to use invertible power maps  <span class="math">x\\mapsto x^d</span>  (hence,  <span class="math">\\gcd(d,p-1)=1</span> ). Since the square function is not a permutation over  <span class="math">\\mathbb{F}_p</span> , one has to use a function of degree  <span class="math">d\\geq 3</span> , which affects the performance. This is true for every state element, and hence the number of multiplications is at least 2t for a t-element state, and 3t for the particular ZK settings we are interested in (due to the specification of p).</p>

    <p class="text-gray-300">Horst Schemes. Together with an SPN, another popular cryptographic construction is the Feistel one, represented e.g. by GMiMC in the case of ZK-friendly schemes. Given a function F over a generic field  <span class="math">\\mathbb{F}</span> , a Feistel scheme is defined as the map  <span class="math">(x,y)\\mapsto (y+F(x),x)</span>  over  <span class="math">\\mathbb{F}_p^2</span> . Several generalizations over  <span class="math">\\mathbb{F}_p^t</span>  are proposed in the literature [62, 52, 38].</p>

    <p class="text-gray-300">Inspired by the results presented in [13] and in [21], in Section 3.2 we propose a modified Feistel scheme, called Horst, in which the linear relation between y and F(x) is combined with a nonlinear one, i.e.,  <span class="math">(y, x) \\mapsto (x, y \\times G(x) + F(x))</span> . To guarantee invertibility, we require that  <span class="math">G(x) \\neq 0</span>  for each input x.</p>

    <p class="text-gray-300">In Section 3.2, we show how to construct such a low-degree (non-trivial) function over any prime field  <span class="math">\\mathbb{F}_p</span>  independently of the size of p, and we propose an initial security analysis regarding the indifferentiability/indistinguishability of a generic iterated Horst construction.</p>

    <p class="text-gray-300">Besides that, our experiments suggest that the strength against algebraic attacks such as Gr&ouml;bner basis [17, 20] attacks is easier to argue by using Horst instead of the classical Feistel, resulting in another advantage of the new structure. We explore this direction in Section 6.3.</p>

    <p class="text-gray-300"><sup>&amp;</sup>lt;sup&gt;8</sup> The name Horst (due to the cryptographer Horst Feistel) has been chosen in order to emphasize the link between  <span class="math">(x, y) \\mapsto (y + F(x), x)</span>  and  <span class="math">(y, x) \\mapsto (x, y \\times G(x) + F(x))</span> .</p>

    <p class="text-gray-300"><strong>Griffin.</strong> In Section 5 we specify a new family of sponge hash and compression functions called Griffin, using the internal permutation Griffin- <span class="math">\\pi</span> . Griffin- <span class="math">\\pi</span>  cannot be rewritten as in Eqs. (1) and (2) since its nonlinear layer is not divided into independent nonlinear S-boxes. Instead, it is composed of two nonlinear sublayers defined via three different nonlinear functions. Two of them are defined via the invertible power maps  <span class="math">x \\mapsto x^d</span>  and  <span class="math">x \\mapsto x^{1/d}</span> , which is inspired by Rescue. The final one is defined by our proposed Horst strategy, using the map  <span class="math">(x,y)\\mapsto (x,y\\cdot G(x))</span>  for a quadratic function G s.t.  <span class="math">G(z)\\neq 0</span>  for each z.</p>

    <p class="text-gray-300">Since the cost metrics in our target use cases are mainly related to the number of nonlinear operations, a linear layer with an MDS matrix may be the simplest choice. However, for a  <span class="math">t \\times t</span>  matrix this usually requires  <span class="math">\\mathcal{O}(t^2)</span>  multiplications. Hence, we propose a matrix that can be implemented with a small number of operations. It is inspired by the linear layer of AES, i.e., it can be decomposed as the multiplication of two matrices. However, while in AES one of these two matrices (the one corresponding to the ShiftRows operation) only changes the position of the elements, both the matrices in the linear layer of GRIFFIN- <span class="math">\\pi</span>  provide full diffusion. This allows to achieve this property in each state word after a single round.</p>

    <p class="text-gray-300">As a result, similarly to the SPN wide trail design strategy and thanks to the details of the linear layer, we have simple arguments against statistical attacks. Moreover, due to the <em>Rescue</em>-like construction, we gain efficient verifiability and a high degree both in the forward and the backward direction. Finally, with our Horst construction, we have minimal multiplicative complexity and good security against algebraic attacks.</p>

    <p class="text-gray-300">Modes of Operation. Our proposed permutation GRIFFIN- <span class="math">\\pi</span>  can be used both in a sponge mode and in a compression mode. The former is more versatile while the latter can be more efficient in specific settings (for example, when only compression for small fixed-sized inputs is needed). We also compare our construction with other compression modes used in the literature, in particular those in Haraka [42] and Jive [16].</p>

    <p class="text-gray-300">Security Analysis. A security analysis of the proposed design is given in Section 6. From the algebraic perspective, Gr&ouml;bner basis attacks at the round level are the most efficient ones. We present several strategies considering the details of the function. Further, we compare GRIFFIN- <span class="math">\\pi</span>  instantiated with Feistel and with Horst in Section 6.3, observing that security is easier to argue with Horst.</p>

    <p class="text-gray-300">From the statistical perspective, well-known techniques like the wide trail design strategy do not apply since our design does not have an SPN structure. For this reason, we apply a simple bound against classical differential and linear attacks, which is sufficient for our purposes. For rebound attacks, an advanced</p>

    <p class="text-gray-300"><sup>&amp;</sup>lt;sup&gt;9</sup> The griffin is a legendary creature with the body, tail, and back legs of a lion, and the head and wings of an eagle. The name Griffin has been chosen since our design merges ideas of a <em>Fluid-SPN</em> and a construction as the <strong>Horst</strong> one.</p>

    <p class="text-gray-300">form of a (truncated) differential attack, we propose an analysis using dedicated tools that help us to provide the bound on the minimal number of rounds needed.</p>

    <p class="text-gray-300">Efficiency in Plain and ZK Settings. Following the cost metrics from Section 1.1, with Griffin we aim to find a beneficial tradeoff between all of them. We evaluate the performance of Griffin in SNARKs using R1CS and compare it to various other constructions in Section 7.2. Our evaluation shows that Griffin is better suited for these zk-SNARKs than any previously proposed design. In the case of zk-STARKs and Plonk (a SNARK with different arithmetization), Griffin provides similar performance as the currently best hash functions for STARKs, the best performance for many configurations in Plonk (especially larger state sizes) and is only slightly less efficient for smaller state sizes in some Plonk configurations compared to the recent design Anemoi proposed in [16]. We show a comparison of Griffin and similar constructions in Plonk in Section 7.3. We show the comparison between Griffin and its competitors in zk-STARKs in App. A. As was our goal, Griffin provides an efficient tradeoff between the plain performance and the performance across different ZK proof systems.</p>

    <p class="text-gray-300">In this section, we analyze the cost metrics for R1CS-based SNARKs and Plonk [29]. For a similar analysis for AIR-based STARKs we refer to App. A.1, and we also discuss the relations between these three cost metrics in App. A.2. We start by providing a brief introduction to arithmetization techniques used in various ZK proof systems. We directly focus on iterative functions to give an intuition on how to describe a hash function in this context.</p>

      <h3 id="sec-2.1" class="text-xl font-semibold mt-8">2.1 Zero-Knowledge Proofs</h3>

    <p class="text-gray-300">A ZK proof system is a two-player protocol between a prover and a verifier, allowing the prover to convince the verifier that they know a witness w to a statement x without revealing anything about the witness beyond what can be implied by x. For example, the prover can use ZK proofs to convince a verifier that they know a preimage w of a given hash  <span class="math">y = \\mathcal{H}(w)</span>  without revealing anything about w. The proof system needs to be complete and sound with a negligible soundness error  <span class="math">\\epsilon</span> , and it must fulfill the zero-knowledge property, which informally states that the proof is independent of the witness w.</p>

    <p class="text-gray-300">The two major classes of ZK proof systems are zk-SNARKs and zk-STARKs, where zk-SNARKs require a trusted setup and are not post-quantum secure. Recenty, many use cases involving ZK proofs have emerged, two of them mainly relying on hash functions: set membership proofs based on Merkle tree accumulators and verifiable computation based on recursive proofs. In both cases one has to prove the knowledge of preimages of hashes, and thus the overall performance mainly depends on the efficiency of the hash function used in the protocol.</p>

      <h3 id="sec-2.2" class="text-xl font-semibold mt-8">2.2 Arithmetization</h3>

    <p class="text-gray-300">To prove a solution of a computational problem, one has to translate the problem into an algebraic representation. This step is known as arithmetization and it differs between the various proof systems. Many algebraic representations have been proposed in the literature, with rank-1 constraint satisfaction systems (R1CS) and Plonk gates being the most widely used representations in zk-SNARKs, and the algebraic intermediate representation (AIR) being used in zk-STARKs [7].</p>

    <p class="text-gray-300">Concretely, in applications involving preimage proofs, the algebraic representation describes the relation between the preimage and the final hash. The witness of the ZK proof captures all intermediate values (including the preimage) required to satisfy this representation for a given instance of the problem (i.e., a specific hash). For this purpose, let  <span class="math">q = p^n</span>  for a prime  <span class="math">p \\geq 2</span>  and  <span class="math">n \\geq 1</span> , and let  <span class="math">\\mathcal{H}: \\mathbb{F}_q^t \\to \\mathbb{F}_q^t</span> , where  <span class="math">\\mathbb{F}_q</span>  is a field and  <span class="math">t \\geq 1</span> . We focus on an iterative function  <span class="math">\\mathcal{H}(a) = \\mathcal{F}_{r-1} \\circ \\cdots \\circ \\mathcal{F}_1 \\circ \\mathcal{F}_0(a)</span> , where  <span class="math">\\mathcal{F}_0, \\mathcal{F}_1, \\ldots, \\mathcal{F}_{r-1} : \\mathbb{F}_q^t \\to \\mathbb{F}_q^t</span> . Given  <span class="math">a, b \\in \\mathbb{F}_q^t</span> , the goal is to prove  <span class="math">\\mathcal{H}(a) = b</span>  without revealing a. To efficiently determine whether  <span class="math">\\mathcal{H}(a) = b</span> , the prover can use the intermediate values  <span class="math">x_0 \\equiv a, x_1, x_2, \\ldots, x_{r-1} \\equiv b</span>  such that  <span class="math">\\mathcal{F}_i(x_i) - x_{i+1} = 0</span>  for  <span class="math">i \\in \\{0, 1, \\ldots, r-1\\}</span> . In particular, they can prove any equivalent system of equations, i.e., they can introduce functions  <span class="math">\\mathcal{G}_0, \\mathcal{G}_1, \\ldots, \\mathcal{G}_{s-1} : (\\mathbb{F}_q^t)^r \\to \\mathbb{F}_q^t</span>  such that the previous system of equations is satisfied if and only if  <span class="math">\\mathcal{G}_j(x_0, x_1, \\ldots, x_{r-1}) = 0</span>  for  <span class="math">j \\in \\{0, 1, \\ldots, s-1\\}</span> .</p>

    <p class="text-gray-300"><strong>Definition 1 (Zero-Equivalence).</strong> Let  <span class="math">q = p^n</span>  for a prime  <span class="math">p \\ge 2</span>  and  <span class="math">n \\ge 1</span> . Let  <span class="math">\\mathcal{F}_0, \\ldots, \\mathcal{F}_{r-1} : \\mathbb{F}_q^t \\to \\mathbb{F}_q^t</span>  be  <span class="math">r \\ge 1</span>  functions. Let  <span class="math">\\mathcal{G}_0, \\ldots, \\mathcal{G}_{s-1} : (\\mathbb{F}_q^t)^r \\to \\mathbb{F}_q^t</span>  be  <span class="math">s \\ge 1</span>  functions. We say that  <span class="math">\\mathcal{G}_0, \\ldots, \\mathcal{G}_{s-1}</span>  are <strong>zero-equivalent</strong> to  <span class="math">\\mathcal{F}_0, \\ldots, \\mathcal{F}_{r-1}</span>  if for each  <span class="math">x_0, x_1, x_2, \\ldots, x_{r-1} \\in \\mathbb{F}_q^t</span>  the following holds:</p>

    <p class="text-gray-300"><span class="math">$\\forall i \\in \\{0, \\dots, r-1\\} : x_{i+1} = \\mathcal{F}_i(x_i) \\iff \\forall j \\in \\{0, \\dots, s-1\\} : \\mathcal{G}_j(x_0, \\dots, x_{r-1}) = 0.</span>$</p>

    <p class="text-gray-300">This strategy is based on the notion of <em>non-procedural computation</em> introduced in [4], which describes the idea of not only evaluating schemes in the plain direction, but using intermediate relations instead.</p>

    <p class="text-gray-300">The choice of the equivalent functions  <span class="math">\\mathcal{G}_0, \\ldots, \\mathcal{G}_{s-1}</span>  depends on the cost metric of the given proof system. For the following, we say that a scheme is <em>fluid</em> if it admits an equivalent representation which can be proven and/or verified more efficiently.<sup>10</sup> As an example for r = s, we report the ones given in [4].</p>

    <p class="text-gray-300"><strong>Example 1.</strong> An invertible function  <span class="math">\\mathcal{F}(x) = x^{1/d}</span>  over  <span class="math">\\mathbb{F}_q</span>  can be proven via  <span class="math">\\mathcal{G}: \\mathbb{F}_q^2 \\to \\mathbb{F}_q</span>  defined as  <span class="math">\\mathcal{G}(x,y) = x - y^d</span>  by imposing  <span class="math">\\mathcal{G}(x,y) = 0</span> . Similarly, given  <span class="math">\\mathcal{F}(x) = 1/x</span>  over  <span class="math">\\mathbb{F}_q \\setminus \\{0\\}</span> , one can choose  <span class="math">\\mathcal{G}: (\\mathbb{F}_q \\setminus \\{0\\})^2 \\to \\mathbb{F}_q</span>  as  <span class="math">\\mathcal{G}(x,y) = xy - 1</span> .</p>

    <p class="text-gray-300">A scheme that satisfies the condition just given is a fluid scheme. In [16], the authors noticed that  <span class="math">y = x^{1/d}</span>  and  <span class="math">y^d = x</span>  are CCZ-equivalent. For this reason, in [16, Sect. 4.1] they deduce that a function is arithmetization-oriented if it is CCZ-equivalent to a function that can be verified efficiently.</p>

    <p class="text-gray-300">A fluid material continuously deforms (flows) under an applied external force. In our case, the scheme adapts its algebraic representation to the target protocol.</p>

    <p class="text-gray-300"><strong>Definition 2 (CCZ Equivalence).</strong> Two functions  <span class="math">\\mathcal{F}, \\mathcal{G} : \\mathbb{F}_q^t \\to \\mathbb{F}_q^t</span>  are CCZ-equivalent if there exists an affine permutation  <span class="math">\\mathcal{A}</span>  over  <span class="math">(\\mathbb{F}_q^t)^2</span>  such that  <span class="math">\\{(x, \\mathcal{F}(x)) \\mid \\forall x \\in \\mathbb{F}_q^t\\} = \\{\\mathcal{A} \\circ (x, \\mathcal{G}(x)) \\mid \\forall x \\in \\mathbb{F}_q^t\\}.</span></p>

    <p class="text-gray-300">Restricting to CCZ equivalence is not necessary, and there exist fluid schemes that do not satisfy any CCZ equivalence condition, as shown in the following.</p>

    <p class="text-gray-300"><strong>Example 2.</strong> Consider  <span class="math">y = \\mathcal{F}(x) = x^{e/d}</span>  over  <span class="math">\\mathbb{F}_q</span>  such that  <span class="math">d, e \\geq 3</span>  and  <span class="math">\\gcd(q-1,e) = \\gcd(q-1,d) = \\gcd(e,d) = 1</span> . This permutation can be easily verified via  <span class="math">\\mathcal{G}(x,y) = y^d - x^e = 0</span> , but we are not aware of any CCZ equivalence between  <span class="math">y = x^{e/d}</span>  and  <span class="math">y^d = x^e</span> .</p>

    <p class="text-gray-300"><strong>Example 3.</strong> Let  <span class="math">\\mathcal{F}_0, \\mathcal{F}_1 : \\mathbb{F}_q \\to \\mathbb{F}_q</span>  be defined as  <span class="math">y = \\mathcal{F}_0(x) = \\gamma + x^d</span>  and  <span class="math">z = \\mathcal{F}_1(y) = y^{1/d}</span> , where  <span class="math">\\gamma \\neq 0</span>  and where  <span class="math">x \\mapsto x^d</span>  is assumed to be invertible. Then  <span class="math">\\mathcal{H} = \\mathcal{F}_1 \\circ \\mathcal{F}_0</span>  can be efficiently proven via a single function  <span class="math">\\mathcal{G} : \\mathbb{F}_q^3 \\to \\mathbb{F}_q</span>  defined as  <span class="math">\\mathcal{G}(x, y, z) = z^d - (\\gamma + x^d)</span> , which is independent of y.</p>

    <p class="text-gray-300">This resembles the arithmetization of <em>Rescue</em> in zk-STARKs. Both representations are valid and require the same number of multiplications, but they have different degrees when chained together. In this sense, <em>Rescue</em> is a <em>Fluid-SPN</em>.</p>

      <h3 id="sec-2.3" class="text-xl font-semibold mt-8">2.3 Rank-1 Constraint Satisfaction Systems (R1CS)</h3>

    <p class="text-gray-300">Many proof systems (e.g., Groth16 [37], Ligero [5], Aurora [8], Bulletproofs [18]) require to translate the circuit into an R1CS, with Groth16 being the fastest proof system with the smallest proofs to date. An R1CS is a set of  <span class="math">\\eta</span>  equations (i.e.,  <span class="math">\\eta</span>  constraints) on the variables  <span class="math">a_0, \\ldots, a_m \\in \\mathbb{F}_q</span>  (with  <span class="math">a_0 = 1</span> ) such that</p>

    <p class="text-gray-300"><span class="math">$\\forall j \\in \\{0, 1, \\dots, \\eta - 1\\}: \\quad \\left(\\sum_i u_{i,j} \\cdot a_i\\right) \\cdot \\left(\\sum_i v_{i,j} \\cdot a_i\\right) = \\left(\\sum_i w_{i,j} \\cdot a_i\\right),</span>$</p>

    <p class="text-gray-300">where  <span class="math">u_{i,j}</span> ,  <span class="math">v_{i,j}</span> ,  <span class="math">w_{i,j} \\in \\mathbb{F}_q</span>  are constants describing the j-th constraint. These are derived from the hash or compression function when proving the knowledge of an input and are independent of the given output value. An assignment to the variables  <span class="math">a_0, \\ldots, a_m</span>  is the witness of the ZK proof and captures all intermediate values (including the preimage) when computing a given output value. The role of the zk-SNARK is to prove that the witness satisfies the R1CS system without revealing the witness itself. The efficiency then depends on the number of constraints  <span class="math">\\eta</span>  in the constraint system, i.e., the prover complexity is in  <span class="math">\\mathcal{O}(\\eta)</span> .</p>

    <p class="text-gray-300">In R1CS constraints, every statement needs to be translated into multiplications of linear combinations of the witness variables. Consequently, linear operations can be embedded into subsequent constraints and do not require additional constraints. For nonlinear operations, the designer has to find a representation which fully captures the relation between the input and the output of the operation, while minimizing the number of degree-2 equations. Cost Metric. We measure the number of R1CS constraints, i.e., the minimum number of nonlinear operations of linear combinations of witness variables required to fully represent any (equivalent) relation between the input and its output (e.g., a preimage and the corresponding hash). In order to perform an efficient verification, we therefore suggest to work with the zero-equivalent functions that can be computed with the minimum number of nonlinear operations.</p>

      <h3 id="sec-2.4" class="text-xl font-semibold mt-8">2.4 Plonk Arithmetization</h3>

    <p class="text-gray-300">Plonk [29] is a zk-SNARK which does not use R1CS constraints. Its arithmetization is based on Plonk gates with constraints of the form</p>

    <p class="text-gray-300">
<span class="math">$q_{L_i} \\cdot a_{L_i} + q_{R_i} \\cdot a_{R_i} + q_{O_i} \\cdot a_{O_i} + q_{M_i} \\cdot (a_{L_i} \\cdot a_{R_i}) + q_{C_i} = 0, \\tag{3}</span>$</p>

    <p class="text-gray-300">where the a values are again the witness variables and the q values describe a given constraint. Using this equation, one can either describe a 2-fan-in addition (setting  <span class="math">q_{M,i}=0</span> ) or a 2-fan-in multiplication (setting  <span class="math">q_{L,i}=q_{R,i}=0</span> ). Thus, to use the Plonk proof system one needs to describe the given circuit using 2-fan-in addition and multiplication gates. As a result, contrary to R1CS constraints, additions cannot be embedded into subsequent multiplication constraints anymore and require separate Plonk gates.</p>

    <p class="text-gray-300">Cost Metric. We measure the number of Plonk gates, i.e., the minimum number of 2-fan-in additions and multiplications of witness variables required to fully represent any (equivalent) relation between the input and its output.</p>

    <p class="text-gray-300">Remark 1. The Plonk proof system can be modified to use constraints different from Eq. (3). Some implementations of the Plonk system extend Eq. (3) to allow 3-fan-in addition gates which are beneficial in various use cases. In this case the cost metric changes accordingly, i.e., the cost is then the minimum number of 2-fan-in multiplications and 3-fan-in additions of witness variables required to fully represent any (equivalent) relation between the input and the output.</p>

    </section>

    <section id="sec-3" class="mb-10">
      <h2 class="text-2xl font-bold">3 The Road to Griffin</h2>

      <h3 id="sec-3.1" class="text-xl font-semibold mt-8">3.1 Related Work: SPN Schemes for ZK Applications</h3>

    <p class="text-gray-300">We first recall some of the SPN schemes proposed in the literature for zero-knowledge applications, focusing on the evolution of their designs from Poseidon and <em>Rescue</em> to Neptune and Anemoi.</p>

    <p class="text-gray-300"><strong>Poseidon and</strong> <em>Rescue</em>. Two well-known examples of SPN schemes for ZK settings are Poseidon and <em>Rescue</em>. Their round function is defined as in Eq. (1), where all S-boxes  <span class="math">S_0, \\ldots, S_{t-1}</span>  operate over  <span class="math">\\mathbb{F}_p</span>  independently of the others, i.e.,</p>

    <p class="text-gray-300"><span class="math">$S(x_0, x_1, \\dots, x_{t-1}) = S_0(x_0) || S_1(x_1) || \\dots || S_{t-1}(x_{t-1}).</span>$</p>

    <p class="text-gray-300">An important advantage of these SPN schemes is that several techniques such as the wide trail design strategy [22] have been developed in order to study their security. For example, using the branch number of the linear layer and the maximum differential probability of the S-boxes, it is possible to provide a simple and strong security argument against classical differential (and linear) attacks.</p>

    <p class="text-gray-300">At the same time, a strong limitation on the choice of the S-box arises for these schemes. Indeed, as already recalled in the introduction, when working over a prime field the designer is restricted to S-box functions of degree  <span class="math">d \\geq 3</span>  in order to build permutations. At the current state of the art, invertible nonlinear maps over  <span class="math">\\mathbb{F}_p</span>  include only power maps  <span class="math">x \\mapsto x^d</span>  for  <span class="math">\\gcd(d, p-1) = 1</span>  and the Dickson polynomials  <span class="math">D_{\\alpha}(x) = \\sum_{i=0}^{\\left\\lfloor \\frac{d}{d-i} \\right\\rfloor} \\frac{d}{d-i} \\binom{d-i}{i} (-\\alpha)^i x^{d-2i}</span>  for  <span class="math">\\gcd(d, p^2-1) = 1</span> , besides other invertible functions constructed via the Legendre function and the  <span class="math">x \\mapsto (-1)^x</span>  operator proposed in [33]. In particular, quadratic nonlinear components cannot be used. This may not be an issue in more classical use cases, but it leads to performance limitations in the settings we consider.</p>

    <p class="text-gray-300"><strong>Neptune and Anemoi.</strong> One way to gain more flexibility regarding the degree is by considering S-boxes over  <span class="math">\\mathbb{F}_p^n</span>  for  <span class="math">n \\geq 2</span> , that is, SPN schemes in which the nonlinear layer is defined as</p>

    <p class="text-gray-300"><span class="math">$S(x_0, \\ldots, x_{t-1}) = S_0(x_0, \\ldots, x_{n-1}) \\mid\\mid S_1(x_n, \\ldots, x_{2n-1}) \\mid\\mid \\cdots \\mid\\mid S_{t&#x27;-1}(x_{t-n}, \\ldots, x_{t-1})</span>$</p>

    <p class="text-gray-300">for a certain  <span class="math">n \\geq 2</span>  such that t = nt', where  <span class="math">S_0, \\ldots, S_{t&#x27;-1}</span>  over  <span class="math">\\mathbb{F}_{p^n} \\equiv \\mathbb{F}_p^n</span>  are invertible functions. Naturally, it is still possible to instantiate such S-boxes over  <span class="math">\\mathbb{F}_{p^n}</span>  via the power maps or the other invertible maps previously recalled. However, the algebraic representation over  <span class="math">\\mathbb{F}_p^n</span>  becomes more complicated, and the number of multiplications in  <span class="math">\\mathbb{F}_p</span>  increases exponentially. Other invertible degree-2 functions over  <span class="math">\\mathbb{F}_p^n</span>  constructed via a local map have recently been presented in [35], and they include e.g. the Lai&ndash;Massey one [43] as a special case.</p>

    <p class="text-gray-300">Examples of such SPN schemes are Neptune and Anemoi. The hash function Neptune is inspired by Poseidon, but the power maps in the external rounds are replaced by the concatenation of independent S-boxes over  <span class="math">\\mathbb{F}_{p^2} \\equiv \\mathbb{F}_p^2</span>  based on quadratic Lai&ndash;Massey functions. In the Anemoi scheme, the S-boxes over  <span class="math">\\mathbb{F}_{p^2} \\equiv \\mathbb{F}_p^2</span>  are based on a particular instantiation of the Feistel scheme called Flystel and defined as  <span class="math">(x,y)\\mapsto (u,v):=\\left(x-2yz^{1/d}+z^{2/d},y-z^{1/d}\\right)</span>  for  <span class="math">z:=x-y^2</span> , where  <span class="math">d\\geq 3</span>  satisfies  <span class="math">\\gcd(d,p-1)=1.^{11}</span>  Exploiting its CCZ-equivalent function, this can be efficiently verified via  <span class="math">(y^2+(y-v)^d-x,v^2+(y-v)^d-u)=(0,0)</span> .</p>

      <h3 id="sec-3.2" class="text-xl font-semibold mt-8">3.2 Non-SPN Schemes: From Feistel to Horst</h3>

    <p class="text-gray-300">While the strategy exploited by the previous SPN schemes is indeed appealing for designing ZK-friendly schemes, here we explore a different approach. In order to be invertible, the low-degree (quadratic) S-boxes of both Neptune and Anemoi are constructed via a function that is affine equivalent to a Feistel scheme (we</p>

    <p class="text-gray-300"><sup>&amp;</sup>lt;sup&gt;11</sup> The constants  <span class="math">\\beta</span> ,  <span class="math">\\gamma</span> , and  <span class="math">\\delta</span>  are omitted in this description.</p>

    <p class="text-gray-300">recall that [30] recently proved the affine equivalent relation existing between Feistel and Lai&ndash;Massey schemes). Hence, given the functions  <span class="math">\\tilde{F}_0, \\tilde{F}_1, \\ldots, \\tilde{F}_{t-2}</span>  over  <span class="math">\\mathbb{F}_p</span> , we may also directly consider a Feistel scheme, such as Type-I/-II/-III Feistel schemes [62, 52, 38] defined respectively as</p>

    <p class="text-gray-300"><span class="math">$(x_0, x_1, \\dots, x_{t-1}) \\mapsto (x_1 + \\tilde{F}(x_0), x_2, x_3, \\dots, x_{t-1}, x_0),</span>$</p>

    <p class="text-gray-300"><span class="math">$(x_0, x_1, \\dots, x_{t-1}) \\mapsto (x_1 + \\tilde{F}_0(x_0), x_2, x_3 + \\tilde{F}_2(x_2), \\dots, x_{t-1} + \\tilde{F}_{t-2}(x_{t-2}), x_0),</span>$</p>

    <p class="text-gray-300"><span class="math">$(x_0, x_1, \\dots, x_{t-1}) \\mapsto (x_1 + \\tilde{F}_0(x_0), x_2 + \\tilde{F}_1(x_1), \\dots, x_{t-1} + \\tilde{F}_{t-2}(x_{t-2}), x_0),</span>$</p>

    <p class="text-gray-300">in which the circular shift is replaced by a multiplication with an invertible linear layer that accelerates the full diffusion.</p>

    <p class="text-gray-300">An example of a ZK-friendly generalized Feistel scheme is GMiMC (broken in [11]). In order to prevent internal collisions, the round functions of GMiMC are instantiated via invertible power maps. We considered variants of it instantiated via quadratic maps  <span class="math">\\tilde{F}_i(x) = x^2</span>  and with the circular shifts being replaced by multiplications with invertible matrices. As we are going to explain in more detail in the following, practical tests suggest that these schemes may not provide the expected security level against some algebraic attacks like the Gr&ouml;bner basis one. A possible reason for that could be the strong arrangement/alignment/structure existing in the Feistel network. To solve this issue, we propose the following.</p>

    <p class="text-gray-300">Let  <span class="math">q=p^n</span>  for a prime  <span class="math">p\\geq 2</span>  and  <span class="math">n\\geq 1</span>  as before. Given a function  <span class="math">F:\\mathbb{F}_q\\to\\mathbb{F}_q</span> , the nonlinear layer of a Feistel scheme over  <span class="math">\\mathbb{F}_q^2</span>  is defined as  <span class="math">(x,y)\\mapsto (x,y+F(x))</span> , which is invertible independently of F. Instead of considering a linear relation between y and F(x), here we combine y and F(x) in a nonlinear way without losing the advantageous properties of Feistel schemes. The simplest way is to replace the sum with a multiplication, but then the invertibility cannot be guaranteed anymore. We solve this with a stronger assumption on the function.</p>

    <p class="text-gray-300"><strong>Definition 3</strong> (Horst Scheme). Let  <span class="math">G: \\mathbb{F}_q \\to \\mathbb{F}_q \\setminus \\{0\\}</span>  and  <span class="math">F: \\mathbb{F}_q \\to \\mathbb{F}_q</span> . We define the Horst scheme over  <span class="math">\\mathbb{F}_q^2</span>  as in Fig. 1a, i.e.,</p>

    <p class="text-gray-300"><span class="math">$(y,x) \\mapsto (x, y \\cdot G(x) + F(x))</span>$
.</p>

    <p class="text-gray-300">In particular, we call this scheme</p>

    <ul class="list-disc list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li>(1) Feistel or Horst<sup>+</sup> if G is identically equal to 1, i.e.,  <span class="math">G(x) \\equiv 1</span> ,</li>
      <li>(2)  <span class="math">\\operatorname{Horst}^{\\times}</span>  if  <span class="math">F(x) = \\alpha \\cdot G(x) + \\beta</span>  for certain  <span class="math">\\alpha, \\beta \\in \\mathbb{F}_q</span>  (hence,  <span class="math">y \\cdot G(x) + F(x) \\equiv (\\alpha + y) \\cdot G(x) + \\beta</span> ).</li>
    </ul>

    <p class="text-gray-300">Since  <span class="math">\\mathbb{F}_q</span>  is a field and  <span class="math">G(x) \\neq 0</span>  for each  <span class="math">x \\in \\mathbb{F}_q</span> , Horst is invertible.</p>

    <p class="text-gray-300">Feistel Schemes with Nonlinear Diffusion for Constructing S-Boxes. The idea behind Horst is not entirely new in the literature. In the case F(x) = 0 for each  <span class="math">x \\in \\mathbb{F}_q</span> , we note that a Feistel scheme based on a nonlinear relation between the branches was allegedly also used in order to set up the 8-bit S-boxes of Streebog [25] and Kuznyechik [27], two Russian standards of a hash function and a</p>

    <p class="text-gray-300">block cipher, respectively. This was discovered in [13], where the authors reconstructed the design of the S-box from its lookup table definition. The nonlinear diffusion in this case consists of multiplications in  <span class="math">\\mathbb{F}_{2^4}</span>  between the two branches.</p>

    <p class="text-gray-300">Similarly, in [21] the authors construct S-boxes over small fields by a modified version of a Feistel network instantiated with a nonlinear operation between the branches. Also in this case, the components of the round are chosen randomly and tested against various criteria, in order to ensure that the resulting construction is invertible. This approach is feasible when working over small finite fields.</p>

    <p class="text-gray-300">However, to the best of our knowledge, no generalization from e.g.  <span class="math">\\mathbb{F}_{2^4}</span>  to larger binary extension fields or larger prime fields is publicly available. Indeed, given  <span class="math">(x,y) \\mapsto x \\cdot G(y)</span> , while a brute-force approach may be sufficient to achieve invertibility (i.e.,  <span class="math">G(y) \\neq 0</span>  for each y) and efficiency in terms of linear or nonlinear operations for small fields, this does not seem feasible when considering larger fields. We solve this problem in the following, by showing how to construct G in an efficient way for the Horst approach given above.</p>

    <p class="text-gray-300">Generalized Feistel Constructions over Groups. Various independent works discuss generalized Feistel contructions over groups [60, 55, 39]. We emphasize that these are not compatible with our results presented here. In particular, let  <span class="math">(\\mathfrak{G}, \\#)</span>  be a group with respect to an operation #. The generalized Feistel schemes studied in [60, 55, 39] are of the form  <span class="math">(x,y)\\mapsto (y\\#F(x),x)</span>  for a function  <span class="math">F:\\mathfrak{G}\\to\\mathfrak{G}</span> . By the definition of a group, there exists an identity element  <span class="math">\\iota\\in\\mathfrak{G}</span>  such that  <span class="math">z\\#\\iota=\\iota\\#z=z</span>  for each  <span class="math">z\\in\\mathfrak{G}</span> , and for each  <span class="math">z\\in\\mathfrak{G}</span> , there exists  <span class="math">w,y\\in\\mathfrak{G}</span>  such that  <span class="math">w\\#z=z\\#y=\\iota</span>  (where y=w if G is abelian). However,  <span class="math">(\\mathbb{F}_q,\\times)</span> , where  <span class="math">q=p^n</span>  and  <span class="math">\\times</span>  is the multiplication, is not a group. Indeed, 0 does not satisfy the previous condition (e.g., it does not admit any inverse). Hence, the results proposed in [60, 55, 39] do not apply to Horst.</p>

    <p class="text-gray-300"><strong>Initial Security Considerations.</strong> The security of Feistel schemes [45] has been heavily analyzed both from the indistinguishability point of view [53, 54, 48] and from the indifferentiability one [19, 23]. Here we make an initial analogous security analysis for the Horst scheme. In the following,  <span class="math">F^{(i)}: \\mathbb{F}_q \\to \\mathbb{F}_q</span>  and  <span class="math">G^{(i)}: \\mathbb{F}_q \\to \\mathbb{F}_q</span>  denote the functions in the <em>i</em>-th round for  <span class="math">i \\in \\{0, \\ldots, r-1\\}</span> .</p>

    <p class="text-gray-300">It is always possible to set up a distinguisher for one (trivial) and two rounds of the Horst scheme. Consider three inputs of the form  <span class="math">(y_i, x) \\in \\mathbb{F}_q^2</span>  and the corresponding outputs  <span class="math">(z_i, w_i) \\in \\mathbb{F}_q^2</span>  for  <span class="math">i \\in \\{0, 1, 2\\}</span> , where  <span class="math">z_i := y_i \\cdot G^{(0)}(x) + F^{(0)}(x)</span>  and for unknown  <span class="math">w_0, w_1, w_2 \\in \\mathbb{F}_q</span> . In the case of 2-round Horst, we have  <span class="math">(y_2 - y_0) \\cdot (z_1 - z_0) = (z_2 - z_0) \\cdot (y_1 - y_0)</span>  with probability 1, while this occurs with probability 1/q in the case of a pseudo-random permutation (PRP).</p>

    <p class="text-gray-300">In App. B, we present distinguishers for 3 and 4 rounds of  <span class="math">\\mathtt{Horst}^{\\times}</span> , by adapting the analogous attacks on Feistel schemes proposed by Patarin in e.g. [54]. For the particular  <span class="math">\\mathtt{Horst}^{\\times}</span>  defined as  <span class="math">(y,x)\\mapsto (x,y\\cdot G(x))</span>  (i.e., F is identically</p>

    <p class="text-gray-300"><sup>&amp;</sup>lt;sup&gt;12</sup> Roughly speaking, in the first case, the attacker does not have any information about the functions  <span class="math">F_i</span>  that define the round. In the second case, they can e.g. query such functions, which are publicly available.</p>

    <p class="text-gray-300">    <img src="_page_11_Picture_0.jpeg" alt="" class="my-4 max-w-full" />
</p>

    <p class="text-gray-300">Fig. 1: The generalized Horst scheme over  <span class="math">\\mathbb{F}_q^t</span> .</p>

    <p class="text-gray-300">equal to zero), we point out that it is possible to set up a distinguisher on an arbitrary number of rounds, by noting that  <span class="math">(0,x) \\in \\mathbb{F}_q^2</span>  is always mapped to  <span class="math">(x,0) \\in \\mathbb{F}_q^2</span>  after one round and to  <span class="math">(0,\\star) \\in \\mathbb{F}_q^2</span>  after two rounds for each  <span class="math">x \\in \\mathbb{F}_q</span>  and for each  <span class="math">G : \\mathbb{F}_q \\to \\mathbb{F}_q \\setminus \\{0\\}</span> .</p>

    <p class="text-gray-300">The problems of setting up distinguishers for more than 2 rounds of Horst and for more than 6 rounds of Feistel or Horst<sup>&times;</sup> are open for future research.</p>

    <p class="text-gray-300"><strong>Generalized</strong> Horst. Next, we generalize the Horst scheme over  <span class="math">\\mathbb{F}_q^t</span>  for  <span class="math">t \\geq 2</span> .</p>

    <p class="text-gray-300"><strong>Definition 4 (Generalized Horst).</strong> Let  <span class="math">t \\geq 2</span> . For each  <span class="math">i \\in \\{1, 2, \\ldots, t-1\\}</span> , let  <span class="math">G_i : \\mathbb{F}_q^i \\to \\mathbb{F}_q \\setminus \\{0\\}</span>  and  <span class="math">F_i : \\mathbb{F}_q^i \\to \\mathbb{F}_q</span> . We define the Generalized Horst scheme over  <span class="math">\\mathbb{F}_q^t</span>  as  <span class="math">x = (x_0, \\ldots, x_{t-1}) \\mapsto y = (y_0, \\ldots, y_{t-1})</span> , where</p>

    <p class="text-gray-300"><span class="math">$y_i := \\begin{cases} x_{i+1} \\cdot G_{i+1}(x_0, x_1, \\dots, x_i) + F_{i+1}(x_0, x_1, \\dots, x_i) &amp; \\text{if } i \\in \\{0, 1, \\dots, t-2\\}, \\\\ x_0 &amp; \\text{otherwise } (i = t-1). \\end{cases}</span>$
(4)</p>

    <p class="text-gray-300">We refer to Fig. 1b for t=4. The final circular shift is crucial for achieving full diffusion (as in the case of any Feistel scheme), but it can be replaced with a different linear diffusion. The invertibility follows from the fact that</p>

    <p class="text-gray-300">
<span class="math">$x_i := \\begin{cases} y_{t-1} &amp; \\text{if } i = 0, \\\\ \\frac{y_{i-1} - F_i(x_0, x_1, \\dots, x_{i-1})}{G_i(x_0, x_1, \\dots, x_{i-1})} &amp; \\text{otherwise } (i \\in \\{1, 2, \\dots, t-1\\}). \\end{cases}</span>$</p>

    <p class="text-gray-300">We point out that the case  <span class="math">G_1 = G_2 = \\cdots = G_{t-1} = 1</span>  corresponds to the T-function proposed and analyzed in [41]. Moreover, based on [62, 52, 38], we highlight the possibility to set up Type-I/-II/-III, expanding, contracting Horst schemes analogous to Type-I/-II/-III, expanding, contracting Feistel schemes. We give the following concrete examples.</p>

    <ul class="list-disc list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li><p class="text-gray-300">A Type-I Feistel scheme is characterized by  <span class="math">G_i = 1</span>  for  <span class="math">i \\in \\{1, \\ldots, t-1\\}</span> ,  <span class="math">F_j = 0</span>  for  <span class="math">j \\in \\{2, \\ldots, t-1\\}</span> , and without a condition on  <span class="math">F_1</span> . Hence, if  <span class="math">G_i = 1, F_i = 0</span>  for  <span class="math">i \\in \\{2, \\ldots, t-1\\}</span> , and without a condition on  <span class="math">G_1</span>  and  <span class="math">F_1</span> , the scheme resembles a Type-I Horst.</p></li>
      <li><p class="text-gray-300">A Type-III Feistel scheme is characterized by  <span class="math">G_i=1</span>  for  <span class="math">i\\in\\{1,\\ldots,t-1\\}</span>  and  <span class="math">F_j(x_0,\\ldots,x_{j-1})=\\tilde{F}_j(x_{j-1})</span>  for  <span class="math">j\\in\\{1,\\ldots,t-1\\}</span> . Hence, if  <span class="math">G_j(x_0,\\ldots,x_{j-1})=\\tilde{G}_j(x_j)</span>  and  <span class="math">F_j(x_0,\\ldots,x_{j-1})=\\tilde{F}_j(x_{j-1})</span>  for  <span class="math">j\\in\\{1,\\ldots,t-1\\}</span> , the scheme resembles a Type-III Horst.</p></li>
    </ul>

      <h3 id="sec-3.3" class="text-xl font-semibold mt-8">3.3 Constructing Nonzero Functions G</h3>

    <p class="text-gray-300">One way of instantiating G is to exploit the following result.</p>

    <p class="text-gray-300"><strong>Lemma 1.</strong> Let  <span class="math">G: \\mathbb{F}_q \\to \\mathbb{F}_q</span>  such that  <span class="math">G&#x27;(x) := G(x) \\cdot x</span>  is a permutation over  <span class="math">\\mathbb{F}_q</span>  and  <span class="math">G(0) \\neq 0</span> . Then,  <span class="math">G(x) \\neq 0</span>  for each  <span class="math">x \\in \\mathbb{F}_q</span> .</p>

    <p class="text-gray-300"><em>Proof.</em> By definition,  <span class="math">G&#x27;(0) = 0 \\cdot G(0) = 0</span> . Since G' is a permutation by assumption, it follows that  <span class="math">G&#x27;(x) \\neq 0</span>  for each  <span class="math">x \\neq 0</span> . Hence,  <span class="math">G(x) = G&#x27;(x)/x \\neq 0</span>  for each  <span class="math">x \\in \\mathbb{F}_q \\setminus \\{0\\}</span> . Since  <span class="math">G(0) \\neq 0</span> , it follows that  <span class="math">G(x) \\neq 0</span>  for each  <span class="math">x \\in \\mathbb{F}_q</span> .  <span class="math">\\square</span></p>

    <p class="text-gray-300">Let  <span class="math">d \\geq 3</span>  be the smallest integer such that  <span class="math">x \\mapsto x^d</span>  is invertible over  <span class="math">\\mathbb{F}_q</span> , hence  <span class="math">\\gcd(d, q - 1) = 1</span> . Let  <span class="math">\\alpha \\in \\mathbb{F}_q \\setminus \\{0\\}</span> . A concrete example of G over  <span class="math">\\mathbb{F}_q</span>  is</p>

    <p class="text-gray-300"><span class="math">$G(z) = \\frac{(z \\pm \\alpha)^d \\mp \\alpha^d}{z} = \\sum_{i=1}^d \\binom{d}{i} z^{i-1} \\cdot (\\pm \\alpha)^{d-i},</span>$</p>

    <p class="text-gray-300">which satisfies Lemma 1. Indeed,  <span class="math">G(0) = d \\cdot (\\pm \\alpha)^{d-1} \\neq 0</span>  by assumption on  <span class="math">\\alpha</span>  and  <span class="math">z \\mapsto G(z) \\cdot z = (z \\pm \\alpha)^d \\mp \\alpha^d</span>  is invertible by assumption on d.</p>

    <p class="text-gray-300">Result for Binary Fields. In the case of binary fields  <span class="math">\\mathbb{F}_{2^n}</span> , Lemma 1 can be exploited by noting that  <span class="math">x\\mapsto x^{2^i}</span>  are linear operations over  <span class="math">\\mathbb{F}_2^n</span> . Indeed, by defining  <span class="math">G(x)=\\sum_{i=0}^d \\alpha_i\\cdot x^{2^i-1}</span>  for  <span class="math">\\alpha_0\\in\\mathbb{F}_{2^n}\\setminus\\{0\\}</span>  and  <span class="math">\\alpha_1,\\alpha_2,\\ldots,\\alpha_d\\in\\mathbb{F}_{2^n}</span> , due to Lemma 1, G satisfies the required property if and only if the matrix corresponding to  <span class="math">G&#x27;(x)=x\\cdot G(x)=\\sum_{i=0}^d \\alpha_i\\cdot x^{2^i}</span>  rewritten over  <span class="math">\\mathbb{F}_2^n</span>  is invertible.</p>

    <p class="text-gray-300">Result for Prime Fields. In the case of a prime field  <span class="math">\\mathbb{F}_p</span>  for  <span class="math">p\\geq 3</span> , we can also exploit the fact that the quadratic map  <span class="math">x\\mapsto x^2</span>  is not invertible over  <span class="math">\\mathbb{F}_p</span>  in order to construct G. Let  <span class="math">\\alpha,\\beta\\in\\mathbb{F}_p</span>  such that  <span class="math">\\alpha^2-4\\beta</span>  is a quadratic nonresidue modulo p, that is,  <span class="math">\\alpha^2-4\\beta\\neq w^2</span>  for each  <span class="math">w\\in\\mathbb{F}_p</span> . In this case,  <span class="math">G(x)=x^2+\\alpha x+\\beta</span>  satisfies the required property. Indeed, the solutions of  <span class="math">x^2+\\alpha x+\\beta=0</span>  are given by  <span class="math">x_\\pm=-(\\alpha\\pm\\sqrt{\\alpha^2-4\\beta})/2</span> . Since  <span class="math">\\alpha^2-4\\beta</span>  is a quadratic nonresidue, no solution  <span class="math">x_\\pm</span>  exists. Note that the function G just given does in general not satisfy the requirement of Lemma 1. Indeed, a function  <span class="math">H(x)=\\eta x^3+\\psi x^2+\\varphi x</span>  over  <span class="math">\\mathbb{F}_p</span>  is invertible if and only if  <span class="math">p=2\\mod 3</span>  and  <span class="math">\\psi^2=3\\eta\\varphi\\mod p</span>  (we refer to [50, Corollary 2.9] for the proof). As a result,  <span class="math">G&#x27;(x)=G(x)\\cdot x=x^3+\\alpha x^2+\\beta x</span>  is not a permutation either if (i)  <span class="math">p=1\\mod 3</span>  or if (ii)  <span class="math">p=2\\mod 3</span>  and  <span class="math">\\alpha^2=3\\beta</span>  does not satisfy the condition that  <span class="math">\\alpha^2-4\\beta</span>  is a quadratic nonresidue modulo p.</p>

      <h3 id="sec-3.4" class="text-xl font-semibold mt-8">3.4 Combining Horst with a Rescue-like SPN: The Birth of Griffin</h3>

    <p class="text-gray-300">A Fluid-SPN scheme whose nonlinear layer uses both  <span class="math">x \\mapsto x^d</span>  and  <span class="math">x \\mapsto x^{1/d}</span>  (where  <span class="math">d \\geq 3</span>  is the smallest integer ensuring invertibility) can be efficiently proven/verified in ZK protocols. Further, the overall degree of the function increases quickly due to the degree-(1/d) S-boxes, while the round-level constraints remain of degree d. This prevents attacks exploiting the degree of the entire function. However, while this representation is efficient in STARKs, such a nonlinear layer may be too expensive for SNARKs and for the plain performance.</p>

    <p class="text-gray-300">An unarranged scheme based on generalized Horst seems beneficial since it provides diffusion in the nonlinear layer. To minimize the multiplicative complexity, we work with quadratic functions  <span class="math">G_j</span>  in Definition 4, while we fix all  <span class="math">F_i</span>  functions to zero for efficiency reasons. Further, we work with  <span class="math">G_j(x_0, x_1, \\ldots, x_{j-1}) = G&#x27;_j(\\sum_{l=0}^{j-1} \\lambda_l \\cdot x_l)</span> , where  <span class="math">G&#x27;_j : \\mathbb{F}_p \\to \\mathbb{F}_p</span>  for each  <span class="math">j \\in \\{2, \\ldots, t-1\\}</span> .</p>

    <p class="text-gray-300"><strong>Nonlinear Layer.</strong> By combining a <em>Fluid</em>-SPN scheme and Horst in a single nonlinear layer, we get  <span class="math">S: \\mathbb{F}_p^t \\to \\mathbb{F}_p^t</span>  defined as  <span class="math">S(\\cdot) = S&#x27;&#x27; \\circ S&#x27;(\\cdot)</span> , where</p>

    <p class="text-gray-300"><span class="math">$(S&#x27;(x_0, \\dots, x_{t-1}))_i = \\begin{cases} x_0^{1/d} &amp; \\text{if } i = 0, \\\\ x_1^d &amp; \\text{if } i = 1, \\\\ x_i &amp; \\text{otherwise,} \\end{cases}</span>$
<span class="math">$(S&#x27;&#x27;(x_0, \\dots, x_{t-1}))_i = \\begin{cases} x_i &amp; \\text{if } i \\in \\{0, 1\\}, \\\\ x_i \\cdot (z_{i-1}^2 + \\alpha_i z_{i-1} + \\beta_i) &amp; \\text{otherwise,} \\end{cases}</span>$</p>

    <p class="text-gray-300">such that  <span class="math">\\alpha_i^2 - 4\\beta_i</span>  is a quadratic nonresidue and  <span class="math">z_i</span>  is a linear combination of the inputs and outputs  <span class="math">\\{x_0, \\ldots, x_{i-1}\\} \\cup \\{x_0^{1/d}, x_1^d\\}</span> . Clearly, S' is inspired by the nonlinear layer of Rescue, while S'' is based on the Horst function. Further, note that both S' and S'' are invertible if  <span class="math">\\gcd(d, p-1) = 1</span>  and by choosing  <span class="math">(\\alpha_i, \\beta_i)</span>  such that  <span class="math">\\alpha_i^2 - 4\\beta_i</span>  is a quadratic nonresidue.</p>

    <p class="text-gray-300">Number of Multiplications. The number of multiplications per round for the verification process is  <span class="math">2(\\text{hw}(d) + \\lfloor \\log_2(d) \\rfloor - 1)</span>  for S' and 2(t-2) for S'', i.e., <sup>13</sup></p>

    <p class="text-gray-300"><span class="math">$2t + 2(\\text{hw}(d) + |\\log_2(d)| - 3) \\in \\mathcal{O}(t)</span>$</p>

    <p class="text-gray-300">multiplications are needed per round. <sup>14</sup> Hence, for large t, the cost of our design is almost independent of the value of d. For comparison, each external round of POSEIDON and each step of Rescue costs  <span class="math">t(\\operatorname{hw}(d) + \\lfloor \\log_2(d) \\rfloor - 1)</span>  multiplications, while each round of Anemoi costs  <span class="math">\\frac{t}{2}(\\operatorname{hw}(d) + \\lfloor \\log_2(d) \\rfloor - 1 + 2)</span>  multiplications, where t is even. A comparison of the number of multiplication for the most-used case d=5 is given in Table 1.</p>

    <p class="text-gray-300">Given  <span class="math">d = \\sum_{i=0}^{\\lfloor \\log_2(d) \\rfloor} d_i \\cdot 2^i</span>  for  <span class="math">d_i \\in \\{0,1\\}</span> , evaluating  <span class="math">x \\mapsto x^d</span>  may require computing  <span class="math">x^{2^j}</span>  for  <span class="math">j \\in \\{0,1,\\ldots,\\lfloor \\log_2(d) \\rfloor \\}</span>  with  <span class="math">\\lfloor \\log_2(d) \\rfloor</span>  multiplications, plus  <span class="math">\\mathrm{hw}(d)-1</span>  multiplications for  <span class="math">x \\mapsto x^d</span>  (where  <span class="math">\\mathrm{hw}(\\cdot)</span>  is the Hamming weight, given in Definition 6).</p>

    <p class="text-gray-300">Note that  <span class="math">x \\mapsto x^d</span>  costs  <span class="math">\\mathrm{hw}(d) + \\lfloor \\log_2(d) \\rfloor - 1</span>  multiplications (see [35] for details).</p>

    <p class="text-gray-300">Table 1: Number of multiplication per round for the verification process of several ZK-friendly hash functions (instantiated with d=5) proposed in the literature over  <span class="math">\\mathbb{F}_p^t</span> . (*The number given for POSEIDON refers to the external full rounds.)</p>

    <div class="overflow-x-auto my-4">
      <table class="min-w-full text-sm text-gray-300">
        <thead>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">GRIFFIN</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">Anemoi</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">Poseidon*</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">Rescue</th>
        </thead>
        <tbody>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">2t + 2</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">2.5t</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">3t</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">6t</td>
          </tr>
        </tbody>
      </table>
    </div>

    <p class="text-gray-300"><strong>Griffin with Feistel.</strong> To highlight the advantages of Horst, we consider a variant of Griffin instantiated with a classical Feistel, where S'' is replaced by</p>

    <p class="text-gray-300">
<span class="math">$(\\widehat{S&#x27;&#x27;}(x_0, \\dots, x_{t-1}))_i = \\begin{cases} x_i &amp; \\text{if } i \\in \\{0, 1\\}, \\\\ x_i + (z_{i-1}^2 + \\alpha_i \\cdot z_{i-1} + \\beta_i) &amp; \\text{otherwise,} \\end{cases}</span>$
(5)</p>

    <p class="text-gray-300">where as before  <span class="math">\\alpha_i^2 - 4\\beta_i</span>  is a quadratic nonresidue for each i, while  <span class="math">z_i</span>  is a linear combination of the inputs and outputs  <span class="math">\\{x_0, \\ldots, x_{i-1}\\} \\cup \\{y_0, y_1\\}</span> . As we discuss in Section 6.3, the security of this variant against algebraic attacks is smaller and more difficult to argue than in Griffin. Moreover, the diffusion is slower, which leads to a crucial impact on the performance in the target ZK applications. This highlights the importance of the nonlinear combination in the Horst scheme.</p>

    <p class="text-gray-300"><strong>Linear Layer.</strong> In many recent SNARK/STARK-friendly designs, an MDS matrix is used for every state size t, and hence the number of linear operations is an element in  <span class="math">\\mathcal{O}(t^2)</span>  in general. Since our target applications mostly use large primes for a security level of 128 or 256 bits, an MDS matrix for large t is not required from a statistical point of view. For example, security against (classical) differential and linear attacks can also be provided with smaller branch numbers.</p>

    <p class="text-gray-300">In Griffin we only use an MDS matrix for  <span class="math">t \\in \\{3,4\\}</span> , and we use a more efficient linear layer for t &gt; 4. Still, we want to achieve full diffusion over a single round to obtain stronger security against statistical attacks. For this goal and for the case  <span class="math">t = 4 \\cdot t&#x27; \\geq 8</span> , we reconsider the linear layer of AES written over  <span class="math">\\mathbb{F}_{28}^{16}</span>  as the multiplication of two matrices, namely  <span class="math">M = M_{\\text{MC}} \\times M_{\\text{SR}}</span>  where</p>

    <p class="text-gray-300"><span class="math">$M_{\\rm SR} = {\\rm diag}(I, I_2, I_3, I_4), \\qquad M_{\\rm MC} = {\\rm circ}(2 \\cdot I, 3 \\cdot I, I, I),</span>$</p>

    <p class="text-gray-300">where I is the  <span class="math">4 \\times 4</span>  identity matrix,  <span class="math">I_2 = \\text{circ}(0, 1, 0, 0)</span> ,  <span class="math">I_3 = \\text{circ}(0, 0, 1, 0)</span> , and  <span class="math">I_4 = \\text{circ}(0, 0, 0, 1)</span> . As is well-known,  <span class="math">M = M_{\\text{MC}} \\times M_{\\text{SR}}</span>  does not provide full diffusion over a single round, due to the fact that each  <span class="math">I_i</span>  is sparse. In particular,  <span class="math">M_{\\text{SR}}</span>  only changes the position of the input words, without mixing them.</p>

    <p class="text-gray-300">As we will show in detail in Section 5.1, we replaced every  <span class="math">I_i</span>  with an MDS matrix  <span class="math">M_4</span>  and we generalize the matrix  <span class="math">M_{\\rm MC}</span>  via the circulant matrix circ(2 &middot;  <span class="math">I, I, \\ldots, I</span> ). This achieves full diffusion over a single round and efficiency. Indeed, for  <span class="math">t \\geq 8</span>  (and similarly for  <span class="math">t \\in \\{3,4\\}</span> ), the multiplication with  <span class="math">M_4</span>  only needs 12 arithmetic operations, resulting in  <span class="math">12t&#x27; = 12(t/4) \\approx 3t</span>  operations for all  <span class="math">M_4</span></p>

    <p class="text-gray-300">matrices. Further,  <span class="math">\\operatorname{circ}(2 \\cdot I, I, \\dots, I) \\cdot \\boldsymbol{x}</span>  can be computed with 4(t/4) + t = 2t additions. Hence, our linear layer M only requires around  <span class="math">5t \\in \\mathcal{O}(t)</span>  operations.</p>

    <p class="text-gray-300">For our setting, we build a hash function with the sponge construction and a compression function with the feed-forward operation and the truncation. Both use the Griffin- <span class="math">\\pi</span>  permutation proposed in the following section.</p>

    <p class="text-gray-300">The generic hash function using a sponge construction can be used in all parts of modern protocols where hash functions are needed, for example to compute a digest of a message or as a pseudo-random oracle. At the same time, these protocols are instantiated with Merkle trees, where t input elements are mapped into n &lt; t output elements. When building a Merkle tree via a single-call sponge hash function for this purpose, the state needs to be increased in order to include the capacity part, which negatively affects the performance. Hence, we also propose a compression function to be used in Merkle tree constructions.</p>

      <h3 id="sec-4.1" class="text-xl font-semibold mt-8">4.1 Sponge Hash Functions</h3>

    <p class="text-gray-300">The sponge construction (Fig. 2) introduced in [9, 10] builds upon an internal permutation and can be used to achieve various goals such as encryption, authentication, and hashing. Both the input and the output may be of arbitrary size. The state size is split into t=r+c, where r and c denote the number of elements in the rate (outer) and capacity (inner) part, respectively. Given an input message m, we assume the padding rule proposed for Poseidon in [32, Section 4.2], consisting of adding the smallest number &lt; r of zeros such that the size of  <span class="math">m \\mid\\mid 0^*</span>  is a multiple of r and of replacing the initial value  <span class="math">\\mathrm{IV} \\in \\mathbb{F}_p^c</span>  instantiating the inner part with  <span class="math">|m| \\mid\\mid \\mathrm{IV}&#x27; \\in \\mathbb{F}_p^c</span> , where  <span class="math">|m| \\in \\mathbb{F}_p</span>  is the size of the input message m and  <span class="math">\\mathrm{IV}&#x27; \\in \\mathbb{F}_p^{c-1}</span>  is an initial value.</p>

    <p class="text-gray-300"><strong>Security.</strong> As proven in [10], if the inner permutation resembles a random one, the sponge construction is indifferentiable from a random oracle up to around  <span class="math">p^{c/2}</span>  queries. Equivalently, to provide  <span class="math">\\kappa</span>  bits of security,  <span class="math">p^{c/2} \\geq 2^{\\kappa}</span> , i.e.,  <span class="math">c \\geq \\lfloor 2\\kappa \\cdot \\log_p(2) \\rfloor</span> . For such a hash function  <span class="math">\\mathcal{H} : \\mathbb{F}_p^{\\star} \\to \\mathbb{F}_p^{\\infty}</span> , it is hard to find</p>

    <pre><code class="language-text">(collision resistance) x, x&#x27; \\neq x such that \\mathcal{H}(x) = H(x&#x27;), (preimage resistance) x given y such that \\mathcal{H}(x) = y, or (second-preimage resistance) x&#x27; given x \\neq x&#x27; such that \\mathcal{H}(x&#x27;) = \\mathcal{H}(x).
</code></pre>

    <p class="text-gray-300">We assume an output of at least  <span class="math">\\lceil 2\\kappa/\\log_2(p) \\rceil</span>  elements to prevent birthday bound attacks. Further, we require  <span class="math">c \\geq \\lceil 2\\kappa/\\log_2(p) \\rceil</span>  for a  <span class="math">\\kappa</span> -bit security level.</p>

      <h3 id="sec-4.2" class="text-xl font-semibold mt-8">4.2 Compression Functions</h3>

    <p class="text-gray-300">Let  <span class="math">p \\geq 2</span>  be a prime and let  <span class="math">1 \\leq n &lt; t</span> . A cryptographic compression function  <span class="math">\\mathcal{C}</span> :  <span class="math">\\mathbb{F}_p^t \\to \\mathbb{F}_p^n</span>  takes t-element inputs and compresses them to n-element outputs such</p>

    <p class="text-gray-300">that collision resistance and (second-)preimage resistance defined as before are guaranteed. One possible way to set up a compression function via a permutation is to combine the truncation function with the feed-forward operation, i.e.,</p>

    <p class="text-gray-300"><span class="math">$x \\in \\mathbb{F}_p^t \\mapsto \\mathcal{C}(x) := \\operatorname{Tr}_n(\\mathcal{P}(x) + x) \\in \\mathbb{F}_p^n,</span>$</p>

    <p class="text-gray-300">where  <span class="math">\\mathcal{P}</span>  is a permutation over  <span class="math">\\mathbb{F}_p^t</span>  and  <span class="math">\\operatorname{Tr}_n</span>  yields the first n elements, i.e.,  <span class="math">\\operatorname{Tr}_n(x_0, x_1, \\ldots, x_{t-1}) := x_0 \\mid\\mid x_1 \\mid\\mid \\cdots \\mid\\mid x_{n-1}</span> .</p>

    <p class="text-gray-300"><strong>Security.</strong> Let  <span class="math">\\mathcal{E}_k : \\mathbb{F}_p^t \\to \\mathbb{F}_p^t</span>  be a cipher for a key  <span class="math">k \\in \\mathbb{F}_p^t</span> . Assume that for a particular  <span class="math">IV \\in \\mathbb{F}_p^t</span> ,  <span class="math">\\mathcal{E}_{IV}(x) = \\mathcal{P}(x)</span>  for each  <span class="math">x \\in \\mathbb{F}_p^t</span> . Then  <span class="math">x \\mapsto \\mathcal{P}(x) + x</span>  over  <span class="math">\\mathbb{F}_p^t</span>  corresponds to the first round of the Davies-Meyer construction  <span class="math">(x, IV) \\mapsto \\mathcal{E}_{IV}(x) + x</span> . As shown in [57, 14], this compression function provides  <span class="math">\\kappa</span> -bit security against collision and (second-)preimage attacks if  <span class="math">p^t \\geq 2^{2\\kappa}</span> . The final truncation does not decrease the security if  <span class="math">p^n \\geq 2^{2\\kappa}</span>  (due to the birthday bound).</p>

    <p class="text-gray-300">In the following, we consider t=2n for the case we have in mind. From now on, we impose  <span class="math">n=t/2 \\geq \\lceil 2\\kappa/\\log_2(p) \\rceil</span> . Note that  <span class="math">p^{t-n} \\geq 2^{\\kappa}</span>  guarantees that it is infeasible to find the truncated part by exhaustive search.</p>

    <p class="text-gray-300"><strong>Related Work.</strong> A similar compression function has been used in several schemes in the literature, including Haraka [42] and Jive [16]. With respect to the one just defined, the compression function used in there is defined as</p>

    <p class="text-gray-300"><span class="math">$x \\in \\mathbb{F}_q^t \\mapsto \\operatorname{Tr}_n(M_{\\mathcal{C}}&#x27; \\times \\mathcal{P}(x) + M_{\\mathcal{C}} \\times x) \\in \\mathbb{F}_p^n,</span>$</p>

    <p class="text-gray-300">where  <span class="math">M_{\\mathcal{C}}, M&#x27;_{\\mathcal{C}} \\in \\mathbb{F}_p^{t \\times t}</span>  are two invertible functions. For example, in the case of Jive instantiated via t=4 and n=2,</p>

    <p class="text-gray-300"><span class="math">$M_{\\mathcal{C}} = M_{\\mathcal{C}}&#x27; = \\begin{pmatrix} 1 &amp; 0 &amp; 1 &amp; 0 \\\\ 0 &amp; 1 &amp; 0 &amp; 1 \\\\ 0 &amp; 0 &amp; 1 &amp; 0 \\\\ 0 &amp; 0 &amp; 0 &amp; 1 \\end{pmatrix}.</span>$</p>

    <p class="text-gray-300">If no condition is imposed on the inputs of the compression function, the matrix multiplications via  <span class="math">M_{\\mathcal{C}}, M&#x27;_{\\mathcal{C}}</span>  do not affect the security. Indeed, assume the permutation  <span class="math">\\mathcal{P}&#x27;</span>  over  <span class="math">\\mathbb{F}_p^t</span>  defined as  <span class="math">\\mathcal{P}&#x27;(x) := M&#x27;_{\\mathcal{C}} \\times \\mathcal{P}(M_{\\mathcal{C}}^{-1} \\times x)</span> . Since</p>

    <p class="text-gray-300"><span class="math">$\\operatorname{Tr}_n(M&#x27;_{\\mathcal{C}} \\times \\mathcal{P}(x) + M_{\\mathcal{C}} \\times x) = \\operatorname{Tr}_n(\\mathcal{P}&#x27;(x&#x27;) + x&#x27;)</span>$</p>

    <p class="text-gray-300">for  <span class="math">x&#x27; = M_{\\mathcal{C}} \\times x</span> , the security of these constructions is identical.</p>

    </section>

    <section id="sec-5" class="mb-10">
      <h2 class="text-2xl font-bold">5 Griffin and Griffin- <span class="math">\\pi</span></h2>

    <p class="text-gray-300">Griffin-Sponge and Griffin-Compression are respectively a sponge hash function and a compression function over  <span class="math">\\mathbb{F}_p^t</span>  instantiated with the permutation Griffin- <span class="math">\\pi</span> , where  <span class="math">p &gt; 2^{63}</span>  (i.e.,  <span class="math">\\lceil \\log_2(p) \\rceil &gt; 63</span> ) for a prime p and  <span class="math">t \\in \\{3, 4t&#x27;\\}</span>  for a positive integer  <span class="math">t&#x27; \\in \\{1, 2, \\ldots, 6\\}</span> , i.e., t is either 3 or a multiple of 4. We limit</p>

    <p class="text-gray-300">    <img src="_page_17_Figure_0.jpeg" alt="" class="my-4 max-w-full" />
</p>

    <p class="text-gray-300">Fig. 2: GRIFFIN- <span class="math">\\pi</span>  (top) and the GRIFFIN sponge (bottom), where  <span class="math">\\boxplus</span>  and  <span class="math">\\oplus</span>  denote the element-wise addition of two vectors in  <span class="math">\\mathbb{F}_p^t</span>  and  <span class="math">\\mathbb{F}_p^r</span> , respectively.</p>

    <p class="text-gray-300">ourselves to  <span class="math">t \\le 24</span> , since this is sufficient for the applications we have in mind. For the sponge case we assume that the rate r satisfies  <span class="math">r \\ge t/3</span> .</p>

    <p class="text-gray-300">The security level is  <span class="math">\\kappa</span>  bits, where  <span class="math">80 \\le \\kappa \\le \\min \\{256, \\lfloor \\log_2(p) \\cdot t/3 \\rfloor\\}</span> . The condition  <span class="math">2^{\\kappa} \\le p^{t/3}</span>  follows from (i) the analysis just given regarding the security of the sponge hash function and of the compression one, and (ii) the condition on the rate for the sponge case.<sup>15</sup> We assume there exists  <span class="math">d \\in \\{3, 5, 7, 11\\}</span>  such that  <span class="math">\\gcd(d, p - 1) = 1</span> .<sup>16</sup> In the following, we refer to GRIFFIN when we do not distinguish between the modes of operation.</p>

      <h3 id="sec-5.1" class="text-xl font-semibold mt-8">5.1 Specification of Griffin- <span class="math">\\pi</span></h3>

    <p class="text-gray-300">The Griffin- <span class="math">\\pi</span>  permutation  <span class="math">\\mathcal{G}^{\\pi}: \\mathbb{F}_p^t \\to \\mathbb{F}_p^t</span>  is defined by</p>

    <p class="text-gray-300"><span class="math">$\\mathcal{G}^{\\pi}(\\cdot) := \\mathcal{F}_{R-1} \\circ \\cdots \\circ \\mathcal{F}_1 \\circ \\mathcal{F}_0(M \\times \\cdot),</span>$</p>

    <p class="text-gray-300">where  <span class="math">M \\in \\mathbb{F}_p^{t \\times t}</span>  is an invertible matrix and  <span class="math">\\mathcal{F}_i : \\mathbb{F}_p^t \\to \\mathbb{F}_p^t</span>  is a round function of the form  <span class="math">\\mathcal{F}_i(\\cdot) = c^{(i)} + M \\times S(\\cdot)</span>  for a round constant  <span class="math">c^{(i)} \\in \\mathbb{F}_p^t</span> , a nonlinear layer  <span class="math">S : \\mathbb{F}_p^t \\to \\mathbb{F}_p^t</span> , and  <span class="math">i \\in \\{0, 1, \\dots, R-1\\}</span> . The same matrix M is applied to the input and in every round. We assume  <span class="math">c^{(R-1)} = 0</span> .</p>

    <p class="text-gray-300">The Nonlinear Layer S. Let  <span class="math">d \\in \\{3, 5, 7, 11\\}</span>  be the smallest integer such that  <span class="math">\\gcd(d, p-1) = 1</span> . Let  <span class="math">(\\alpha_i, \\beta_i) \\in \\mathbb{F}_p^2 \\setminus \\{(0, 0)\\}</span>  be pairwise distinct such that  <span class="math">\\alpha_i^2 - 4\\beta_i</span>  is a quadratic nonresidue modulo p for  <span class="math">2 \\le i \\le t-1</span> . The nonlinear layer  <span class="math">S(x_0, \\ldots, x_{t-1}) = y_0 \\mid |\\cdots \\mid |y_{t-1}|</span>  is then defined by</p>

    <p class="text-gray-300">
<span class="math">$y_{i} = \\begin{cases} x_{0}^{1/d} &amp; \\text{if } i = 0, \\\\ x_{1}^{d} &amp; \\text{if } i = 1, \\\\ x_{2} \\cdot \\left( (L_{i}(y_{0}, y_{1}, 0))^{2} + \\alpha_{2} \\cdot L_{i}(y_{0}, y_{1}, 0) + \\beta_{2} \\right) &amp; \\text{if } i = 2, \\\\ x_{i} \\cdot \\left( (L_{i}(y_{0}, y_{1}, x_{i-1}))^{2} + \\alpha_{i} \\cdot L_{i}(y_{0}, y_{1}, x_{i-1}) + \\beta_{i} \\right) &amp; \\text{otherwise,} \\end{cases}</span>$</p>

    <p class="text-gray-300"><span class="math">$(6)</span>$</p>

    <p class="text-gray-300">The condition  <span class="math">2^{3\\kappa} \\leq p^t</span>  implies the condition  <span class="math">2^{2\\kappa} \\leq p^t</span>  for the compression case, since  <span class="math">2^{2\\kappa} \\leq 2^{3\\kappa} \\leq p^t</span> . For the sponge case, the combination of  <span class="math">c \\geq \\lceil 2\\kappa / \\log_2(p) \\rceil</span>  and  <span class="math">c \\leq 2t/3</span>  implies  <span class="math">2t/3 \\geq \\lceil 2\\kappa / \\log_2(p) \\rceil</span> , that is,  <span class="math">2^{\\kappa} \\leq p^{t/3}</span> .</p>

    <p class="text-gray-300"><sup>&amp;</sup>lt;sup&gt;16</sup> Griffin- <span class="math">\\pi</span>  may be used also with  <span class="math">d \\notin \\{3, 5, 7, 11\\}</span> . However, the security analysis and the number of rounds must be adapted for this case.</p>

    <p class="text-gray-300">where  <span class="math">y_0 = x_0^d</span> ,  <span class="math">y_1 = x_1^{1/d}</span> , and  <span class="math">L_i : \\mathbb{F}_p^3 \\to \\mathbb{F}_p</span>  are of the form  <span class="math">L_i(z_0, z_1, z_2) = \\gamma_i \\cdot z_0 + z_1 + z_2</span>  for arbitrary pairwise distinct  <span class="math">\\gamma_i \\in \\mathbb{F}_p \\setminus \\{0\\}</span>  (e.g.,  <span class="math">\\gamma_i = i - 1</span> ).</p>

    <p class="text-gray-300">The Linear Layer M. For  <span class="math">t \\in \\{3,4\\}</span> , the matrices must be MDS. We suggest</p>

    <p class="text-gray-300"><span class="math">$M_3 = \\begin{pmatrix} 2 &amp; 1 &amp; 1 \\\\ 1 &amp; 2 &amp; 1 \\\\ 1 &amp; 1 &amp; 2 \\end{pmatrix}, \\quad M_4 = \\begin{pmatrix} 5 &amp; 7 &amp; 1 &amp; 3 \\\\ 4 &amp; 6 &amp; 1 &amp; 1 \\\\ 1 &amp; 3 &amp; 5 &amp; 7 \\\\ 1 &amp; 1 &amp; 4 &amp; 6 \\end{pmatrix},</span>$</p>

    <p class="text-gray-300">where  <span class="math">M_4</span>  corresponds to  <span class="math">M_{4,4}^{8,4}</span>  from [26], setting  <span class="math">\\alpha = 2.17</span>  This allows for an efficient implementation, as further shown in [26, Figure 13]. Indeed, the multiplication by  <span class="math">M_4</span>  can be computed with only 8 additions and 4 multiplications.</p>

    <p class="text-gray-300">For  <span class="math">t = 4t&#x27; \\ge 8</span> , M is defined as</p>

    <p class="text-gray-300">
<span class="math">$M = M&#x27;&#x27; \\times M&#x27; \\equiv M&#x27; \\times M&#x27;&#x27; = \\begin{pmatrix} 2 \\cdot M_4 &amp; M_4 &amp; \\dots &amp; M_4 \\\\ M_4 &amp; 2 \\cdot M_4 &amp; \\dots &amp; M_4 \\\\ \\vdots &amp; \\vdots &amp; \\ddots &amp; \\vdots \\\\ M_4 &amp; M_4 &amp; \\dots &amp; 2 \\cdot M_4 \\end{pmatrix}, \\tag{7}</span>$</p>

    <p class="text-gray-300">where  <span class="math">M&#x27; = \\operatorname{diag}(M_4, M_4, \\dots, M_4) \\in \\mathbb{F}_p^{t \\times t}</span>  and  <span class="math">M&#x27;&#x27; = \\operatorname{circ}(2 \\cdot I, I, \\dots, I) \\in \\mathbb{F}_p^{t \\times t}</span>  for a  <span class="math">4 \\times 4</span>  MDS matrix  <span class="math">M_4</span>  and the  <span class="math">4 \\times 4</span>  identity matrix I.</p>

    <p class="text-gray-300">Choosing the Constants. We use a pseudo-random number generator based on SHAKE [51] in order to choose our round constants  <span class="math">\\{c^{(i)}\\}_{i=0}^{R-2}</span>  and the constants  <span class="math">\\{(\\alpha_2,\\beta_2)\\}</span>  that define the nonlinear layer. The other constants  <span class="math">\\{(\\alpha_i,\\beta_i)\\}_{i=3}^{t-1}</span>  are defined as  <span class="math">\\alpha_i=(i-1)\\cdot\\alpha_2</span>  and  <span class="math">\\beta_i=(i-1)^2\\cdot\\beta_2</span> . Note that  <span class="math">L_p(\\alpha_i^2-4\\cdot\\beta_i)=L_p((i-1)^2\\cdot(\\alpha_2^2-4\\cdot\\beta_2))=L_p(\\alpha_2^2-4\\cdot\\beta_2)=-1</span> .</p>

      <h3 id="sec-5.2" class="text-xl font-semibold mt-8">5.2 Number of Rounds of Griffin- <span class="math">\\pi</span></h3>

    <p class="text-gray-300">For  <span class="math">\\kappa</span> -bit security, the round number R including a margin of 20% must satisfy</p>

    <p class="text-gray-300"><span class="math">$R \\ge \\left\\lceil 1.2 \\cdot \\max \\left\\{ 6, \\left\\lceil \\frac{2.5 \\cdot \\kappa}{\\log_2(p) - \\log_2(d-1)} \\right\\rceil, 1 + R_{\\mathrm{GB}} \\right\\} \\right\\rceil,</span>$</p>

    <p class="text-gray-300">where  <span class="math">R_{\\rm GB} \\geq 1</span>  is the smallest integer such that</p>

    <p class="text-gray-300"><span class="math">$\\min \\left\\{ \\binom{R_{\\rm GB} \\cdot (d+t) + 1}{1 + t \\cdot R_{\\rm GB}}, \\binom{d^{R_{\\rm GB}} + 1 + R_{\\rm GB}}{1 + R_{\\rm GB}} \\right\\} \\ge 2^{\\kappa/2}.</span>$</p>

    <p class="text-gray-300">These numbers are supported by our security analysis given in Section 6. Some instances for GRIFFIN- <span class="math">\\pi</span>  are given in Table 2.</p>

    <p class="text-gray-300"><sup>&amp;</sup>lt;sup&gt;17</sup> We use the smallest  <span class="math">\\alpha \\geq 2</span>  such that the resulting matrix is MDS.</p>

    <p class="text-gray-300">Table 2: Instances of GRIFFIN- <span class="math">\\pi</span>  with security margin. We focus on the most common cases, namely  <span class="math">d \\in \\{3, 5\\}</span> ,  <span class="math">\\kappa = 128</span> ,  <span class="math">p \\approx 2^{256}</span> , and  <span class="math">c = \\lceil 2\\kappa/\\log_2(p) \\rceil</span> .</p>

    <div class="overflow-x-auto my-4">
      <table class="min-w-full text-sm text-gray-300">
        <thead>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"></th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">t=3</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">t = 4</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">t = 8</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"><span class="math">t \\in \\{12, 16, 20, 24\\}</span></th>
        </thead>
        <tbody>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">R (d=3)</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">11</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">10</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">R (d=5)</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">14</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">11</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">9</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">9</td>
          </tr>
        </tbody>
      </table>
    </div>

    <p class="text-gray-300">We aim for GRIFFIN- <span class="math">\\pi</span>  instances that prevent attacks on the hash and compression function. Distinguishers on GRIFFIN- <span class="math">\\pi</span>  that cannot be exploited for an attack on the entire construction (e.g., zero sum partitions) are not taken into account. This approach is largely applied in the literature and similar designs.</p>

      <h3 id="sec-6.1" class="text-xl font-semibold mt-8">6.1 Statistical Attacks on Griffin- <span class="math">\\pi</span></h3>

    <p class="text-gray-300">The best statistical attacks against GRIFFIN- <span class="math">\\pi</span>  include the differential [12] and the rebound attack [49, 47]. Our security analysis is supported by dedicated automatic MILP tools which we designed in order to search for bounds on the minimal number of rounds against rebound attacks. Other attacks such as linear cryptanalysis, impossible differential, zero-correlation, integral/square, multiple-of-n, and mixture differential attacks are analyzed in App. F.1.</p>

    <p class="text-gray-300"><strong>Differential Cryptanalysis.</strong> Differential cryptanalysis [12] and its variations are the most widely used techniques to analyze symmetric-key primitives. Given pairs of inputs with fixed input differences, differential cryptanalysis considers the probability distribution of the corresponding output differences. Let  <span class="math">\\Delta_I, \\Delta_O \\in \\mathbb{F}_p^t</span>  be respectively the input and the output differences through a permutation  <span class="math">\\mathcal{P}</span>  over  <span class="math">\\mathbb{F}_p^t</span> . The differential probability (DP) for  <span class="math">\\Delta_O</span>  given  <span class="math">\\Delta_I</span>  is</p>

    <p class="text-gray-300">
<span class="math">$\\operatorname{Prob}(\\Delta_I \\to \\Delta_O) = (|\\{x \\in \\mathbb{F}_p^t \\mid \\mathcal{P}(x + \\Delta_I) - \\mathcal{P}(x) = \\Delta_O\\}|)/p^t.</span>$</p>

    <p class="text-gray-300">Its maximum DP is  <span class="math">\\mathrm{DP_{max}} = \\mathrm{max}_{\\Delta_I,\\Delta_O \\in \\mathbb{F}_p^t \\setminus \\{0\\}} \\mathrm{Prob}(\\Delta_I \\to \\Delta_O)</span> . As Griffin- <span class="math">\\pi</span>  is an iterated scheme, we search for ordered sequences of differences over any number of rounds, i.e., differential characteristics/trails. Assuming independent rounds, the DP of a differential trail is the product of the DPs of its one-round differences. Our goal is to find the minimum number of rounds such that each characteristic's probability is smaller than  <span class="math">2^{-2.5\\kappa}</span>  in order to also prevent clustering effects. Based on other works published in the literature, we chose this arbitrary value since more characteristics can be used simultaneously to set up a differential attack, and hence each probability must be significantly smaller than  <span class="math">2^{-\\kappa}</span>  for security. For this purpose, we first compute  <span class="math">\\mathrm{DP_{max}}</span>  of the components of the nonlinear layer S, and the branch number of the matrix M.</p>

    <p class="text-gray-300"><strong>Lemma 2.</strong> Let  <span class="math">d \\ge 3</span>  be an integer such that gcd(d, p-1) = 1. Then,  <span class="math">DP_{max}(x \\mapsto x^d) = DP_{max}(x \\mapsto x^{1/d}) = (\\min\\{d, 1/d\\} - 1)/p</span> . <sup>18</sup></p>

    <p class="text-gray-300"><strong>Lemma 3.</strong> Let  <span class="math">\\alpha, \\beta \\in \\mathbb{F}_p \\setminus \\{0\\}</span>  such that  <span class="math">\\alpha^2 - 4\\beta</span>  is a quadratic nonresidue modulo p. Let  <span class="math">F: \\mathbb{F}_p^2 \\to \\mathbb{F}_p</span>  be defined as  <span class="math">F(x,\\ell) = x \\cdot (\\ell^2 + \\alpha \\cdot \\ell + \\beta)</span> . Given an input difference  <span class="math">\\Delta_I = (\\delta_x, \\delta_\\ell) \\neq (0,0)</span>  and an output difference  <span class="math">\\Delta_O</span> , the maximum differential probability of F is given by</p>

    <p class="text-gray-300"><span class="math">$Prob(\\Delta_I \\to \\Delta_O) \\le \\begin{cases} 0 &amp; \\text{if } \\delta_{\\ell} = 0 \\text{ and } \\Delta_O \\neq 0, \\\\ \\frac{2}{p} &amp; \\text{if } \\delta_{\\ell} = 0 \\text{ or } \\delta_x = \\Delta_O = 0, \\\\ \\frac{p-1}{p^2} \\le \\frac{1}{p} &amp; \\text{otherwise.} \\end{cases}</span>$</p>

    <p class="text-gray-300">We emphasize that the probability is zero if  <span class="math">\\delta_{\\ell} = 0</span>  and  <span class="math">\\Delta_{O} \\neq 0</span>  simultaneously.</p>

    <p class="text-gray-300">The previous probabilities are always smaller than d/p for each  <span class="math">d \\ge 3</span> . The proofs for Lemmas 2 and 3 are given in App. C.1.</p>

    <p class="text-gray-300">Since a nonlinear mixing takes place between the  <span class="math">\\mathbb{F}_p</span>  elements, it is not possible to apply the previous two lemmas directly in order to provide an estimation of the differential probability over a single round. For example, in the case of  <span class="math">(x_i, \\ell_i) \\mapsto x_i \\cdot (\\ell_i^2 + \\alpha_i \\cdot \\ell_i + \\beta_i)</span> , where  <span class="math">\\ell_i := L_i(y_0, y_1, x_{i-1})</span> , the values of  <span class="math">\\ell_i</span>  and of the corresponding difference  <span class="math">\\delta_{\\ell_i}</span>  cannot be considered as variables, since they depend on the values of  <span class="math">x_0, x_1, x_{i-1} \\in \\mathbb{F}_p</span>  and on the corresponding differences. Still, the previous results imply that the differential probability over a single round cannot be bigger than (d-1)/p. Hence,</p>

    <p class="text-gray-300"><span class="math">$\\left(\\frac{d-1}{p}\\right)^R \\le 2^{-2.5\\kappa} \\implies R \\ge \\frac{2.5\\kappa}{\\log_2(p) - \\log_2(d-1)}</span>$</p>

    <p class="text-gray-300">rounds are sufficient to achieve a probability smaller than  <span class="math">2^{-2.5\\kappa}</span>  over the entire permutation, where the value 2.5 has been chosen to prevent clustering effect.</p>

    <p class="text-gray-300">We emphasize that we expect that every differential probability has much  <span class="math">smaller\\ probability</span> , since the activation of many S-boxes is helped by our diffusion matrix (besides the diffusion in the nonlinear layer). For this purpose, we prove the following result regarding the branch number of M in App. C.2.</p>

    <p class="text-gray-300"><strong>Proposition 1.</strong> Let  <span class="math">t = 4t&#x27; \\in \\{8, 12, ..., 24\\}</span> . The branch number of the matrix  <span class="math">M \\in \\mathbb{F}_p^{t \\times t}</span>  defined as in Eq. (7) is t' + 4.</p>

    <p class="text-gray-300">We recall that  <span class="math">M \\in \\mathbb{F}_p^{t \\times t}</span>  is an MDS matrix for  <span class="math">t \\in \\{3,4\\}</span>  and its branch number is equal to t+1 in these cases.</p>

    <p class="text-gray-300"><strong>Rebound Attacks.</strong> In a rebound attack [44, 49], the goal of the attacker is to find two (input, output) pairs such that the two inputs and the corresponding</p>

    <p class="text-gray-300"><sup>&amp;</sup>lt;sup&gt;18</sup> Note that  <span class="math">\\min\\{d, 1/d\\} = d</span>  in our case.</p>

    <p class="text-gray-300"><sup>&amp;</sup>lt;sup&gt;19</sup> An analysis for this case is given in Lemma 4.</p>

    <p class="text-gray-300">outputs satisfy certain (truncated) differences. The approach consists of the inbound and the outbound phase. According to these phases, the internal permutation P of the hash function is split into three subparts, that is, P = Pfw&#9702;Pin&#9702;Pbw. The inbound phase is placed in the middle of the permutation and the two outbound phases are placed next to the inbound part. In the outbound phase, two high-probability (truncated) differential trails are constructed, which are then connected in the inbound phase. We claim that 6 rounds are sufficient against this attack. From our analysis, we know that there exist truncated differentials with probability 1 over a single round, but they cannot be extended over more rounds, and any classical differential characteristic over 2 rounds has a probability smaller than 2&minus;<sup>&kappa;</sup> (for common d). Hence, by using an inside-out approach, the attacker can cover less than 4 rounds in the inbound phase. Since one round can be covered with a truncated differential characteristic of probability 1, the attacker can cover two rounds (one in each direction) in the outbound phase. Thus, no rebound attack on 6 rounds of Griffin-&pi; can be set up.</p>

    <p class="text-gray-300">Verification with a Dedicated Tool. Our results have been verified via a dedicated mixed integer linear programming (MILP) tool. The results obtained with the tool for rebound attacks are presented in App. <a href="#page-43-0">D.</a> The tool deduces all necessary word conditions of differential characteristics for making a successful rebound attack and traversing all possible settings of the inbound phase, assuming that the single inbound phase state can be used to modify word conditions of two S layers for free (without costing any degree of freedom). Even under such an impractical assumption, the tool cannot find a feasible rebound attack for 3 or more Griffin-&pi; rounds, which supports the conclusion that 6 rounds are sufficient against rebound attacks.</p>

      <h3 id="sec-6.2" class="text-xl font-semibold mt-8">6.2 Algebraic Attacks</h3>

    <p class="text-gray-300">Algebraic attacks exploit weak algebraic properties of the design (e.g., low degrees or low density). Our analysis suggests that interpolation attacks and Gr&uml;obner basis attacks are the most efficient ones against Griffin. For this purpose, we analyze the algebraic properties of the obtained equation systems and also practically implement Griffin-&pi; to obtain better estimates.</p>

    <p class="text-gray-300">We also claim security against higher-order differentials, which is implied by the security against interpolation attacks. We do not claim security against zero-sum partitions <a href="#page-31-14">[15]</a>. We refer to App. <a href="#page-53-0">F.2</a> for more details.</p>

    <p class="text-gray-300">Interpolation Attacks. The goal of an interpolation attack <a href="#page-33-19">[40]</a> is to construct an interpolation polynomial describing the function. In the case of a hash function, an interpolation polynomial can potentially be exploited to set up collisions or forgery attacks. The cost of the attack grows with the number of different monomials in the interpolation polynomial, where (an upper/lower bound of) the number of different monomials can be estimated given the degree of the function. If the number of unknown monomials is sufficiently large, this cannot be done faster than by exhaustive search. Roughly speaking, if the interpolation polynomial is dense and if its degree is maximum, this attack does not work.</p>

    <p class="text-gray-300">In our case, 3 rounds are sufficient to reach the maximum degree. Indeed, due to Fermat's little theorem,  <span class="math">1/d \\equiv d&#x27;</span>  where  <span class="math">(d \\cdot d&#x27; - 1) \\mod (p - 1) = 0</span> . Since  <span class="math">d \\geq 3</span>  is the smallest integer s.t.  <span class="math">\\gcd(d, p - 1) = 1</span> , d' is of the same order as p. In order to frustrate variants of the interpolation attack like MitM approaches or inside-out approaches starting from the middle of the construction, we double the number of rounds, conjecturing that  <span class="math">2 \\cdot 3 = 6</span>  rounds are sufficient to prevent interpolation attacks and their variants. We further refer to App. E.1 for a more detailed analysis about the density of GRIFFIN- <span class="math">\\pi</span> .</p>

    <p class="text-gray-300">Gr&ouml;bner Basis Attacks. A Gr&ouml;bner basis [17, 20] allows to solve the system of equations that represent the cryptographic construction in a set of variables depending on the attack goals. In general, a Gr&ouml;bner basis attack consists of three steps. First, the attacker needs to set up the equation system and compute a Gr&ouml;bner basis for it. Secondly, they perform a change of term ordering for the basis, usually going to a term order which makes it easier to eliminate variables and find the solutions. Finally, the attacker uses the system obtained in the second step in order to start solving for the variables. As is usually done in the literature, here we focus on the complexity of the first step (i.e., computing a Gr&ouml;bner basis), which can be estimated by</p>

    <p class="text-gray-300"><span class="math">$\\mathcal{O}\\left(\\binom{D_{\\text{reg}} + n_v}{n_v}\\right)^{\\omega}\\right),</span>$</p>

    <p class="text-gray-300">where  <span class="math">D_{\\text{reg}}</span>  is the degree of regularity,  <span class="math">n_v</span>  is the number of variables, and  <span class="math">2 \\le \\omega &lt; 3</span>  is a constant representing the complexity of a matrix multiplication. Theoretical estimations of the degree of regularity are known only for regular and semi-regular equation systems [6]. For example, in the case of a regular system of equations with  <span class="math">n_e = n_v</span> , where  <span class="math">n_e</span>  denotes the number of polynomials in the system, the degree of regularity is estimated by  <span class="math">D_{\\text{reg}} = 1 + \\sum_{i=1}^{n_e} (d_i - 1)</span> , where  <span class="math">d_i</span>  is the degree of the <em>i</em>-th equation. Since most of our equation systems do not exhibit the properties of regular sequences, we compute the actual degrees reached during the computations (the &quot;practical&quot; degree of regularity) for reduced versions of Griffin- <span class="math">\\pi</span> , and use these estimates for the final round numbers.</p>

    <p class="text-gray-300">As largely done in the literature (e.g., [32, 4, 16]), here we claim that the security of Griffin with respect to the Gr&ouml;bner basis attack follows from the infeasibility of solving the CICO problem instantiated by Griffin- <span class="math">\\pi</span> .</p>

    <p class="text-gray-300"><strong>Definition 5.</strong> The invertible function  <span class="math">\\mathcal{P}: \\mathbb{F}_p^t \\to \\mathbb{F}_p^t</span>  is  <span class="math">\\kappa</span> -secure against the CICO  <span class="math">(t_1,t_2)</span> -problem (where  <span class="math">0 &lt; t_1,t_2 &lt; t</span>  and  <span class="math">t_1+t_2=t</span> ) if no algorithm with expected complexity smaller than  <span class="math">2^{\\kappa}</span>  finds  <span class="math">I_2 \\in \\mathbb{F}_p^{t_2}</span>  and  <span class="math">O_2 \\in \\mathbb{F}_p^{t_1}</span>  for given  <span class="math">I_1 \\in \\mathbb{F}_p^{t_1}</span>  and  <span class="math">O_1 \\in \\mathbb{F}_p^{t_2}</span>  such that  <span class="math">\\mathcal{P}(I_1 \\mid\\mid I_2) = O_1 \\mid\\mid O_2</span> .</p>

    <p class="text-gray-300">To support this claim, note that e.g. a preimage attack on the sponge hash function corresponds to solving the CICO problem (by simply reordering the elements). Indeed, the attacker cannot control (i) the inner part of a sponge hash</p>

    <p class="text-gray-300">function corresponding to  <span class="math">I_1</span>  in CICO and (ii) its output  <span class="math">O_1</span> , which depends on the element for which we are searching for a preimage, while no condition is imposed on the message (corresponding to  <span class="math">I_2</span> ) and the truncated part (corresponding to  <span class="math">O_2</span> ). Analogously, an attack on the CICO problem just given corresponds to a preimage attack on the compression function  <span class="math">\\mathcal{P}(I_1 \\mid\\mid I_2) = O_1 + I_1 \\mid\\mid O_2 \\equiv O_1&#x27; \\mid\\mid O_2</span>  (where  <span class="math">I_1, O_1</span>  are fixed).</p>

    <p class="text-gray-300">Intermediate Variables. Using the inputs and outputs of GRIFFIN- <span class="math">\\pi</span>  directly is infeasible since the degree is maximum and the polynomials are dense. A possible strategy to overcome this problem consists of introducing intermediate variables. This is a method to decrease the degrees in the equation system (and thus in general also the number of appearing monomials) at the cost of more variables. For Griffin- <span class="math">\\pi</span> , we can introduce new variables in each round in order to avoid reaching a degree of 1/d. Let  <span class="math">x = x_0 \\parallel \\cdots \\parallel x_{t-1}</span>  and  <span class="math">y = y_0 \\parallel \\cdots \\parallel y_{t-1}</span> be respectively the state before and after a nonlinear layer. Then, the relation between x and y can be described by 2 equations of degree d and t-2 equations of degree 3, using the fact that  <span class="math">y_1 = x_1^{1/d}</span>  can be rewritten as  <span class="math">y_1^d = x_1</span>  and the definition of our nonlinear layer given in Eq. (6). In order to connect two rounds with this approach, we denote the input of the next nonlinear layer by affine functions in  <span class="math">y_0, \\ldots, y_{t-1}</span> , depending on the linear layer matrix M and the round constants. Hence, we add t variables in each round, except for the last one, where we simply use the desired output values. We then have  <span class="math">n_v = r + (R-1)t</span> variables (where r is the rate) and the same number of equations  <span class="math">n_e = n_v</span> . In each round, 2 equations are of degree d and (t-2) equations are of degree 3. We focus on r=1, since by experiments this is the easiest case from the attacker's point of view.</p>

    <p class="text-gray-300">When implementing this system in Sage and Magma, the observed degrees of regularity are  <span class="math">\\geq D_{\\rm est}^{(1)} = dR</span>  for a degree-d nonlinear layer after R rounds (see App. E.2 for details). Using  <span class="math">D_{\\rm est}^{(1)}</span> , we obtain an estimated complexity of  <span class="math">\\binom{D_{\\rm est}^{(1)}+n_v}{n_v}^\\omega = \\binom{dR+n_v}{n_v}^\\omega</span>  operations. By setting  <span class="math">\\omega=2</span>  (optimistic from the attacker's point of view) and for a security level of  <span class="math">\\kappa</span>  bits, R must satisfy</p>

    <p class="text-gray-300">
<span class="math">$\\log_2\\left(\\binom{D_{\\text{est}}^{(1)} + n_v}{n_v}\\right) = \\log_2\\left(\\binom{dR + 1 + tR}{1 + tR}\\right) \\ge \\frac{\\kappa}{2}.</span>$
(8)</p>

    <p class="text-gray-300">Partial Intermediate Variables. Another strategy consists in introducing only a single intermediate variable for each round in order to avoid the high degree growth in the second word. The other state words go through the nonlinear layer without adding any more variables. In particular, we introduce a single new equation  <span class="math">y_1^d - x_1 = 0</span>  in each round, where  <span class="math">y_1</span>  is the new variable. Hence, we have r + R variables in total, and we again focus on r = 1. The degree of the equations increases in each round, however not as fast as it would without adding a variable for the second word. By practical experiments, we found that the degree of regularity can be estimated conservatively by  <span class="math">D_{\\rm est}^{(2)} = d^R</span>  for this strategy (see App. E.2 for details). Even if the equations here have a higher</p>

    <p class="text-gray-300">degree than in the first strategy, the number of variables and equations is smaller, since only one relation is added in each round (instead of t). Still, there is one crucial difference. Adding intermediate variables for all state words leads to a complexity which scales significantly with t. In this case, we add only one variable in each round, regardless of t. This means that we require</p>

    <p class="text-gray-300">
<span class="math">$\\log_2\\left(\\binom{D_{\\text{est}}^{(2)} + n_v}{n_v}\\right) = \\log_2\\left(\\binom{d^R + 1 + R}{1 + R}\\right) \\ge \\frac{\\kappa}{2}.</span>$
(9)</p>

    <p class="text-gray-300">Gr&ouml;bner Basis Summary. Given the results just presented, we require that Eq. (8) and Eq. (9) are fulfilled for a  <span class="math">\\kappa</span> -bit security level. However, due to the particular structure of our nonlinear layer, it is possible to choose the input such that the degrees in the first round are lower than expected. In particular, an attacker may choose the input such that  <span class="math">y_0 = x_0^{1/d} = u_1</span>  and  <span class="math">y_1 = x_1^d = u_2</span> , where  <span class="math">u_1, u_2</span>  are two fixed constants chosen by the attacker. This can be done by simply solving a linear equation system with these constraints. Consequently, the first two words are constant, the third word is linear, and only then the degree starts to grow. In order to protect from this attack, we add 1 round to the final round number needed for preventing Gr&ouml;bner basis attacks.</p>

    <p class="text-gray-300">For completeness, we also describe two additional attack strategies in App. E.3. They are both less efficient than the ones just presented.</p>

      <h3 id="sec-6.3" class="text-xl font-semibold mt-8">6.3 Feistel versus Horst: Security of Griffin Instantiated with Feistel</h3>

    <p class="text-gray-300">We consider the security of GRIFFIN instantiated with a Feistel scheme as in Eq. (5) with respect to the two Gr&ouml;bner basis approaches discussed in Section 6.2.</p>

    <p class="text-gray-300">In the first Gr&ouml;bner basis strategy we introduce intermediate variables for the whole state, i.e., we add t new variables and equations per round. In our experiments with Sage and Magma we could observe that the practical degree of regularity was constant regardless of the number of rounds in our tests for  <span class="math">R \\geq 2</span> . Indeed, we were able to compute Gr&ouml;bner bases in practice for the round numbers proposed for Griffin (with Horst). We emphasize that this does not necessarily mean that the complexity of an attack changes only slightly with increased round numbers, but rather that it is harder for the designer to argue security. A similar behaviour was reported in [1, Section 6.1] for MiMC, where computing the Gr&ouml;bner basis is efficient with intermediate variables, but the other steps in the full attack (monomial reordering, factorization) are not.</p>

    <p class="text-gray-300">For the second strategy, where we only introduce intermediate variables to avoid the degree-(1/d) growth in each round, it is easier to argue security. Still, the maximum degree in each round is reduced due to the missing multiplication. In particular, the difference is  <span class="math">\\deg(R_{i-1})</span>  in each round, where  <span class="math">\\deg(R_i)</span>  is the degree in the <em>i</em>-th round. Additionally, we could observe faster Gr&ouml;bner basis computations for the Feistel version compared to the Horst version. Concretely, the difference is about a factor of 8 between the two versions.</p>

    <p class="text-gray-300">Hence, even with a detailed analysis of the first strategy, the number of rounds would have to be increased due to the second strategy. This suggests</p>

    <p class="text-gray-300">that using the multiplication instead of the addition is better when aiming for security and efficiency in the applications discussed in this paper.</p>

    </section>

    <section id="sec-7" class="mb-10">
      <h2 class="text-2xl font-bold">7 Performance Evaluation</h2>

    <p class="text-gray-300">In this section, we evaluate the performance of Griffin and compare it to Poseidon, Rescue-Prime [59] (a newer variant of Rescue with less security margin), GMiMC<sub>erf</sub>, Grendel, and Neptune. Since GMiMC<sub>erf</sub> was broken in [11], we use the updated round numbers proposed in [24, App. G]. Grendel has been broken too [33], leading to an adaptation of the round numbers by the designers. Our evaluation includes the updated numbers. Further, we compare Griffin to the follow-up design Anemoi [16].</p>

    <p class="text-gray-300">First we evaluate the plain performance, then we compare the efficiency when used in R1CS-based SNARKs and Plonk. For an evaluation in STARKs we refer to App. A.3. We instantiate all hash functions to provide 128 bits of security. All benchmarks were obtained on Linux using an Intel Xeon E5-2699 v4 CPU (2.2 GHz, turboboost up to 3.6 GHz) using stable Rust version 1.59 and the target-cpu=native flag. Each of the individual benchmarks has only access to one thread. We refer to Section 7.3 for the source code.</p>

    <p class="text-gray-300">Remark 2. The target use case plays a crucial role for the state size t. Indeed, while large primes are used in SNARK-based proof systems (and hence t can be small for a certain desired level of security), smaller primes are often preferred in STARK-based proof systems due to efficiency. For example, in Plonky2 [56] a 64-bit prime is used. Therefore, we emphasize that the efficiency with larger state sizes (e.g.,  <span class="math">t \\ge 12</span> ) is as important as the efficiency with smaller ones.</p>

    <p class="text-gray-300">Remark 3. The Pedersen hash function [61, Sec. 5.4.1.7] is also relevant for ZK proof systems. However, since it is not preimage-resistant, uses hardness assumptions vulnerable to quantum computers, and requires more R1CS constraints than Poseidon and Rescue (see [31]), we do not consider it in our benchmarks.</p>

    <p class="text-gray-300">Remark 4. As is often the case in symmetric cryptography, it is difficult to consider versions with equal security margins in the comparisons. For example, adding the same number of rounds or nonlinear functions to two designs with different structures may affect both the security and the performance of the two designs differently. Therefore, we focus on the original specifications given by the designers, noting that the security margins may vary between the different constructions.</p>

      <h3 id="sec-7.1" class="text-xl font-semibold mt-8">7.1 Plain Performance</h3>

    <p class="text-gray-300">In Table 3, we compare the plain performance of the permutations when instantiated with the scalar fields of the commonly used BLS12 and BN254 elliptic curves.<sup>20</sup> In both of these fields d=5 is the smallest value for which</p>

    <p class="text-gray-300">Table 3: Plain performance of different permutations in Rust (measured in  <span class="math">\\mu s</span> ). * Benchmarks run with old instances (12 instead of 14 rounds).</p>

    <div class="overflow-x-auto my-4">
      <table class="min-w-full text-sm text-gray-300">
        <thead>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">Permutation</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">3</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">4</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">5</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">8</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">State size 9</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">t<br>12</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">16</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">20</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">24</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"></th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"></th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"></th>
        </thead>
        <tbody>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">5</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">12</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">16</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">20</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">24</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">12.07*</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">BLS12 (d</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">BLS12 <span class="math">(d=5)</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Griffin 11</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">15.97</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">105.45</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">_</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">89.32</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">_</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">93.76</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">98.19</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">103.78</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">107.96</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">GMiMC_{erf}</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">20.14</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">20.70</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">21.65</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">26.07</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">26.44</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">37.72</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">65.94</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">107.45</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">167.75</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Neptune</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">_</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">19.54</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">_</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">30.87</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">_</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">60.20</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">93.14</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">128.95</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">171.97</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Poseidon</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">18.61</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">24.36</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">30.60</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">55.52</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">63.10</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">95.84</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">149.61</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">212.85</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">286.75</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Rescue-Prime 4</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">412.91</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">434.13</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">451.49</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">645.79</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">739.24</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1005.20</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1363.40</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1759.10</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">2147.80</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Grendel 8</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">822.54</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">959.92</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1001.30</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1154.60</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1215.60</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1283.30</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1425.30</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1411.90</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1459.20</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">BN254 (d</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">= 5)</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Griffin 10</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">06.90*</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">99.33</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">_</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">84.97</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">_</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">88.21</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">92.08</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">96.85</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">100.10</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">GMiMC_{erf}</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">18.67</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">19.34</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">20.08</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">23.44</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">24.63</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">34.05</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">69.49</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">107.82</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">156.35</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Neptune</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">_</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">17.38</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">_</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">29.83</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">58.41</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">89.89</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">125.87</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">166.11</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Poseidon</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">17.56</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">23.23</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">29.37</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">51.06</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">58.96</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">89.20</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">139.68</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">196.64</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">267.80</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Rescue-Prime 3</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">379.78</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">400.87</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">411.16</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">598.86</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">683.81</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">929.89</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1275.50</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1639.30</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">2006.10</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Grendel 7</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">703.36</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">808.78</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">849.89</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">994.20</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1034.30</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1094.20</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1213.30</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1196.00</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1253.50</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
        </tbody>
      </table>
    </div>

    <p class="text-gray-300"><span class="math">x^d</span>  is a permutation. As the table shows, the fastest permutation for  <span class="math">t \\leq 16</span>  is GMiMC<sub>erf</sub>. However, as we show later, it has the worst performance when used with SNARKs and STARKs. Rescue-Prime and Grendel have the worst plain performance due to having t high-degree  <span class="math">x^{1/d}</span>  or Legendre symbol evaluations per round. GRIFFIN also uses  <span class="math">x^{1/d}</span> , but only once per round. Thus, GRIFFIN scales significantly better with larger t than the other designs. Indeed, for small t GRIFFIN is slower than POSEIDON and NEPTUNE, but the differences get smaller for larger t, until GRIFFIN is faster than POSEIDON and NEPTUNE if  <span class="math">t \\geq 16</span> .</p>

    <p class="text-gray-300">Regarding the recent follow-up work Anemoi, we expect that it has a slower plain performance compared to GRIFFIN due to having more of the expensive  <span class="math">x^{1/d}</span>  evaluations per round (which dominate plain performance) while having a similar number of rounds. Furthermore, since in GRIFFIN the number of  <span class="math">x^{1/d}</span>  evaluations is fixed to only one per round while it depends on the statesize t in Anemoi, we expect the performance difference to grow even further in favour of GRIFFIN. These expectations are confirmed by the benchmarks given in [16].</p>

      <h3 id="sec-7.2" class="text-xl font-semibold mt-8">7.2 R1CS-Based SNARKs with Griffin</h3>

    <p class="text-gray-300">Here we evaluate the efficiency of GRIFFIN when used in R1CS-based zk-SNARKs and compare it to its competitors by giving the number of R1CS constraints, as well as concrete runtimes for proving the knowledge of preimages and membership witnesses for Merkle tree accumulators. Our implementation is written in Rust using the bellman_ce library for creating Groth16 [37] proofs.<sup>21</sup></p>

    <p class="text-gray-300">Describing Griffin as a R1CS system is straightforward. The first two words of the nonlinear layer (i.e.,  <span class="math">y_0, y_1</span>  in Eq. (6)) each require  <span class="math">|\\log_2(d)| + \\text{hw}(d) - 1</span></p>

    <p class="text-gray-300"> <span class="math">p_{\\rm BLS381} = {\\tt 0x73eda753299d7d483339d80809a1d80553bda402fffe5bfeffffff00000001}, \\\\ p_{\\rm BN254} = {\\tt 0x30644e72e131a029b85045b68181585d2833e84879b9709143e1f593f0000001}.</span></p>

    <p class="text-gray-300"><sup>21</sup> https://docs.rs/bellman_ce/0.3.5/bellman_ce/</p>

    <p class="text-gray-300">Table 4: Bellman_ce performance of various hash functions in the sponge mode of operation (one permutation per call) for different state sizes t. Performance numbers are for proving the knowledge of preimages of hashes (Perm) and for proving the membership of a Merkle tree accumulator with  <span class="math">2^{24}</span>  elements (MT). Proving times are given in ms.</p>

    <p class="text-gray-300">* Benchmarks run with old instances (12 instead of 14 rounds).</p>

    <div class="overflow-x-auto my-4">
      <table class="min-w-full text-sm text-gray-300">
        <thead>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">State size t (MT arity)</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"></th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"></th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"></th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"></th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"></th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"></th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"></th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"></th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"></th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"></th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"></th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"></th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"></th>
        </thead>
        <tbody>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Hash</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">3 (2:</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1)</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">4 (2</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">&middot; 1)</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">5 (4</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">8 (4</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">9 (8</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">&middot; 1)</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">12 (8</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">&middot; 1)</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Prove</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">R1CS</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Prove</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Prove</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">LS12 (d =</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Perm</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">39.08*</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">112</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">42.46</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">110</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">l (**</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">- /</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">60.54</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">162</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">I</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">_</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">82.29</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">234</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Griffin</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">MT</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">451.88*</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">2760</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">495.74</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">2712</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">_</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">_</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">422.50</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">2136</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">_</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">_</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">424.07</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">\\frac{234}{2192}</span></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">NEPTUNE</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Perm<br>MT</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><em><br></em></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><em><br></em></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">71.53<br>969.71</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">228<br>5544</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><em><br></em></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">95.54<br>728.11</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">264<br>3360</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><em><br></em></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><em><br></em></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">120.55<br>747.22</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">306<br>2768</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Poseidon</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Perm<br>MT</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">75.31<br>1013.70</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">240<br>5832</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">88.29<br>1093.00</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">264<br>6408</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">93.43<br>654.85</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">288<br>3648</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">108.40<br>877.17</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">363<br>4548</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">114.35<br>630.17</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">387<br>3416</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">132.54<br>719.52</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">459<br>3992</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Rescue-Prime</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Perm<br>MT</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">75.12<br>851.56</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">252 <span class="math">6120</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">77.55<br>872.26</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">264<br>6408</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">78.01<br>512.97</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">270 \\\\ 3432</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">96.71<br>726.84</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">384<br>4800</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">106.61<br>541.93</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">432<br>3776</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">138.93<br>737.59</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">576<br>4928</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">\\mathrm{GMiMC}_{\\mathrm{erf}}</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Perm<br>MT</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">173.71<br>3060.80</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">678 <span class="math">16344</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">\\begin{vmatrix} 176.91 \\\\ 2842.40 \\end{vmatrix}</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">684<br>16488</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">180.20<br>1537.40</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">690<br>8472</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">190.01<br>1640.80</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">708<br>8688</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">193.76<br>1118.20</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">714 <span class="math">6032</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">253.53<br>1535.60</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">942<br>7856</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Grendel</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Perm<br>MT</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">148.76<br>2297.70</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">870<br>20952</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">\\begin{vmatrix} 160.50 \\\\ 2535.40 \\end{vmatrix}</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">1000 \\ 24072</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">191.33<br>1403.20</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">1050 \\\\ 12792</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">216.12<br>1505.40</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">\\begin{array}{c c} 1200 \\\\ 14592 \\end{array}</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">\\begin{array}{ c c c c c c c c c c c c c c c c c c c</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1260<br>10400</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">231.53<br>1268.00</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1320<br>10880</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Anemoi</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Perm<br>MT</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">n/a<br>n/a</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">140<br>3432</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><em><br></em></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">n/a<br>n/a</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">\\begin{vmatrix} 240 \\\\ 3072 \\end{vmatrix}</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">n/a<br>n/a</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">300 \\\\ 2720</span></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">&#1042;</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">N254 (d =</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">= 5)</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">_</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">GRIFFIN</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Perm<br>MT</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">22.48^{\\star} \\\\ 266.77^{\\star}</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">112<br>2760</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">\\begin{vmatrix} 24.24 \\\\ 294.07 \\end{vmatrix}</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">110<br>2712</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><em><br></em></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-<br>-</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">\\begin{vmatrix} 35.08 \\\\ 251.90 \\end{vmatrix}</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">162<br>2136</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><em><br></em></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-<br>-</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">\\begin{array}{ c c c }\\hline 48.05 \\\\ 257.31 \\\\ \\hline \\end{array}</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">234 \\\\ 2192</span></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">NEPTUNE</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Perm<br>MT</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><em><br></em></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-<br>-</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">42.75<br>621.76</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">228<br>5544</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-<br>-</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">61.30<br>512.69</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">264<br>3360</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><em><br></em></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-<br>-</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">86.31<br>569.48</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">306<br>2768</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Poseidon</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Perm<br>MT</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">43.47<br>604.91</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">240<br>5832</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">51.58<br>656.77</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">264<br>6408</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">54.35<br>391.55</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">288<br>3648</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">64.46<br>542.02</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">363<br>4548</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">70.82<br>385.03</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">387<br>3416</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">79.86<br>446.87</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">459<br>3992</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Rescue-Prime</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Perm<br>MT</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">43.54<br>510.03</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">252<br>6120</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">44.36<br>520.01</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">264<br>6408</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">44.87<br>306.12</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">270<br>3432</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">54.52<br>436.83</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">384<br>4800</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">61.51<br>323.67</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">432<br>3776</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">80.97<br>445.66</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">576<br>4928</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">\\mathrm{GMiMC}_{\\mathrm{erf}}</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Perm<br>MT</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">101.81<br>2148.60</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">678<br>16344</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">104.95<br>1791.20</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">684<br>16488</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">107.36<br>952.34</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">690<br>8472</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">115.99<br>1049.80</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">708<br>8688</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">119.02<br>717.61</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">714<br>6032</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">164.38<br>1046.70</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">942<br>7856</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Grendel</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Perm<br>MT</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">86.85<br>1401.20</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">870<br>20952</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">94.12<br>1523.60</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">1000 \\\\ 24072</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">113.33<br>854.51</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">1050 \\\\ 12792</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">127.31<br>920.43</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1200<br>14592</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">131.54<br>759.53</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1260<br>10400</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">135.80<br>776.86</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1320<br>10880</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Anemoi</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Perm<br>MT</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><em><br></em></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-<br>-</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">n/a<br>n/a</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">140  <br>3432</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">_</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-<br>-</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">n/a<br>n/a</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">240<br>3072</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-<br>-</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">n/a<br>n/a</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">300<br>2720</td>
          </tr>
        </tbody>
      </table>
    </div>

    <p class="text-gray-300">constraints (2 constraints if d=3, 3 constraints if d=5). The squaring of each  <span class="math">L(\\cdot)</span>  and each word of the remaining state require an additional constraint each. Since the linear layers can be incorporated into the constraints of the subsequent nonlinear layers (see Section 2.3), the total number of R1CS constraints for describing the whole GRIFFIN- <span class="math">\\pi</span>  permutation is</p>

    <p class="text-gray-300"><span class="math">$(2 \\cdot |\\log_2(d)| + 2 \\cdot \\text{hw}(d) + 2 \\cdot t - 6) \\cdot R,</span>$</p>

    <p class="text-gray-300">i.e.,  <span class="math">2 \\cdot R \\cdot t</span>  R1CS constraints if d=3 and  <span class="math">R \\cdot (2 \\cdot t+2)</span>  ones if d=5. In Table 4 we compare the number of R1CS constraints and the concrete runtime to create a ZK proof using the bellman_ce library when instantiated with two different elliptic curves (BLS12-381, BN254) which require d to be  <span class="math">d \\geq 5</span> . We compare</p>

    <p class="text-gray-300">the performance of the hash functions when proving the knowledge of a preimage of a specific hash and when proving membership of a Merkle tree accumulator with  <span class="math">2^{24}</span>  elements. For these benchmarks we instantiate all permutations in a sponge mode of operations. Consequently, when constructing Merkle trees with arity (x:1) we require a state size t which is at least one word larger than x. In all cases, verifying the created ZK proof took &lt; 4 ms which is why we do not explicitly list this runtime in Table 4.</p>

    <p class="text-gray-300">Remark 5. As mentioned above, the hash functions in Table 4 are instantiated using the sponge mode of operation. One can, however, also read the benchmarks from Table 4 when using the compression function from Section 4.2. For a (x:1) compression we require a state size of t=x. As an example, the GRIFFIN benchmark with t=8 is a valid benchmark for a (4:1) compression using the sponge mode of operation and a (8:1) compression using the compression function from Section 4.2. Or, when considering 64-bit field elements and a 128-bit security, a (2:1) compression with GRIFFIN can be achieved either with a sponge and t=12 or with a compression function and t=8.</p>

    <p class="text-gray-300">Table 4 shows that GRIFFIN requires the smallest number of R1CS constraints to prove the knowledge of a preimage of a hash for several state sizes t. However, since GRIFFIN is defined for  <span class="math">t \\in \\{3,4t&#x27;\\}</span> , it cannot be instantiated with t=5 or t=9 (the smallest state sizes for Merkle trees with arities 4 and 8, respectively). Thus, to create trees of this arity, GRIFFIN either requires a larger state size with a sponge compared to its competitors (e.g., more words in the inner part of the sponge), or it has to be used together with the compression function from Section 4.2. As shown in Table 4, even the first approach results in significantly fewer R1CS constraints and smaller proving times compared to the other hash functions. Concretely, using GRIFFIN results in nearly half of the required constraints compared to POSEIDON and Rescue and two third of the constraints compared to the recently proposed Neptune. Only Anemoi comes close, however, it scales worse than GRIFFIN for larger t. Consequently, GRIFFIN has the fastest proving times which also lead to the fastest membership proving times when used as a hash function in Merkle tree accumulators.</p>

      <h3 id="sec-7.3" class="text-xl font-semibold mt-8">7.3 Plonk Performance of Griffin</h3>

    <p class="text-gray-300">Describing Griffin with Plonk gates can be done as follows. Each affine layer usually requires  <span class="math">t\\cdot (t-1)</span>  addition gates. However, due to the specific structure of our linear layers which are optimized for a low number of additions, the number gets reduced significantly (similar to Poseidon and Neptune where the affine layers can be represented with fewer addition gates as well). Regarding the nonlinear layer, the first two words require  <span class="math">\\lfloor \\log_2(d) \\rfloor + \\operatorname{hw}(d) - 1</span>  multiplication gates. Computing  <span class="math">L(\\cdot)</span>  requires one addition gate for i=2 and two gates for i&gt;2. Computing  <span class="math">z_i=L_i(\\cdot)^2+\\alpha_iL_i(\\cdot)+\\beta_i</span>  requires one gate plus an additional multiplication gate for  <span class="math">y_i=x_i\\cdot z_i</span> . Summing up, Griffin requires</p>

    <p class="text-gray-300"><span class="math">$(R+1) \\cdot \\# \\text{mat} + R \\cdot (2 \\cdot |\\log_2(d)| + 2 \\cdot \\text{hw}(d) + 4t - 11)</span>$</p>

    <p class="text-gray-300">Table 5: Number of Plonk gates to describe various hash functions when instantiated with a 256-bit prime field. Numbers are given for Plonk implementations using either 2-fan-in addition gates or 3-fan-in addition gates.</p>

    <div class="overflow-x-auto my-4">
      <table class="min-w-full text-sm text-gray-300">
        <thead>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"></th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"></th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"></th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"></th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"></th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"></th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">State</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">size <span class="math">t</span></th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"></th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"></th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"></th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"></th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"></th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"></th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"></th>
        </thead>
        <tbody>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Hash</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">2-far</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">i-in ad</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">dition</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">gates</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">3-fan-in addition gates</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">3</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">4</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">5</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">8</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">9</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">12</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">3</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">4</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">5</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">8</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">9</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">12</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">d=3</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">GRIFFIN</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">197</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">278</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">_</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">574</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">_</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">904</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">163</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">231</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">_</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">471</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">_</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">704</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Reinforced Concrete</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">372</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">_</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">_</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">_</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">_</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">_</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">270</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">_</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">_</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">_</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">_</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">_</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Rescue-Prime</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">432</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">560</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">720</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1152</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1440</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">2496</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">324</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">448</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">480</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">768</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">\\bf 864</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1536</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Poseidon</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">600</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">844</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1100</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1976</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">2304</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">3420</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">407</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">640</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">674</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1256</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1308</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">2030</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Neptune</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">687</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1435</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">_</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">2451</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">_</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">534</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1074</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">_</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1812</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Grendel</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1485</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1792</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">2040</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">2560</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">2835</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">3456</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1386</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1680</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1800</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">2176</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">2295</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">2736</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">\\mathrm{GMiMC}_{\\mathrm{erf}}</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1312</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1650</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1992</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">3042</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">3400</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">4498</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">984</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1320</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1328</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">2028</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">2040</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">2768</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Anemoi</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">256</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">544</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1080</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><b>200</b></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">396</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">696</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">d</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">= 5</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Griffin</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">201</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">228</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">_</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">492</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">_</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">836</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">171</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">193</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">_</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">407</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">_</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">655</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Reinforced Concrete</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">378</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">_</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">_</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">_</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">_</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">_</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">276</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">_</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">_</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">_</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">_</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">_</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Rescue-Prime</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">420</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">528</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">630</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1280</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1584</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">2688</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">336</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">440</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">450</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">896</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1008</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1728</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Poseidon</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">518</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">708</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">916</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1665</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1947</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">2901</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">379</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">560</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">602</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1107</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1167</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1791</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Neptune</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">755</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1507</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">_</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">2529</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">_</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">602</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1146</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">_</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1890</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Grendel</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1392</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1700</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1890</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">2520</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">2772</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">3300</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1305</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1600</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1680</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">2160</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">2268</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">2640</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">\\mathrm{GMiMC}_{\\mathrm{erf}}</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1130</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1368</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1610</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">2360</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">2618</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">4396</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">904</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1140</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1150</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1652</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1666</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">2826</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Anemoi</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">284</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">592</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">_</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1140</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">_</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">228</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">444</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">_</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">756</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
        </tbody>
      </table>
    </div>

    <p class="text-gray-300">Plonk gates, i.e.,  <span class="math">(R+1) \\cdot \\# \\text{mat} + R \\cdot (4t-5)</span>  gates if d=3 and  <span class="math">(R+1) \\cdot \\# \\text{mat} + R \\cdot (4t-3)</span>  gates if d=5. Depending on t, the gates per linear layer # mat varies: # mat = 5 for t=3, # mat = 8 for t=4, # mat = 24 for t=8, and  <span class="math">\\# \\text{mat} = \\frac{8t}{4} + 2t - 4</span>  otherwise. Further, an intermediate constraint from the nonlinear layer can be reused in the subsequent linear layer calculations, and hence the total number of constraints gets reduced by R for t&gt;4.</p>

    <p class="text-gray-300">Remark 6. Considering 3-fan-in addition gates (see Remark 1), GRIFFIN requires  <span class="math">(R+1)\\cdot\\#\\mathrm{mat}+R\\cdot(2\\cdot\\lfloor\\log_2(d)\\rfloor+2\\cdot\\mathrm{hw}(d)+3t-8)</span>  Plonk gates, with  <span class="math">\\#\\mathrm{mat}=3</span>  for t=3,  <span class="math">\\#\\mathrm{mat}=6</span>  for t=4,  <span class="math">\\#\\mathrm{mat}=20</span>  for t=8, and  <span class="math">\\#\\mathrm{mat}=\\frac{6t}{4}+4\\cdot\\left\\lfloor\\frac{t/4-1}{2}\\right\\rfloor+t</span>  otherwise. As above, one intermediate constraint from the nonlinear layer can be reused in the subsequent linear layer calculations, and hence the total number of constraints gets reduced by R for  <span class="math">t\\geq 4</span> .</p>

    <p class="text-gray-300">In Table 5, we compare the efficiency of different hash functions in Plonk by counting the number of gates required for one permutation. Compared to Poseidon and Rescue, Griffin always requires the smallest number of Plonk gates due to having a small number of multiplications (Section 7.2) and a small number of rounds implying a small number of linear layers. Only Anemoi requires a smaller number of gates for d=3 and small state sizes, due to having more efficient linear layers requiring fewer addition gates. However, Griffin's linear layer becomes more efficient with larger state sizes until Griffin is more</p>

    <p class="text-gray-300">efficient than Anemoi in these configurations as well at around  <span class="math">t \\geq 12</span> . We also compare Griffin to Reinforced Concrete [31], a hash function with a fixed state size t=3 introducing novel techniques to use lookup tables in  <span class="math">\\mathbb{F}_p</span>  designs. This leads to fast plain performances, but potentially also introduces the risk of side-channel attacks. Further, this prevents Reinforced Concrete from (efficiently) being used in R1CS-based SNARKs or AIR-based STARKs. However, it is usable and specifically designed for Plookup [28], an extension to Plonk allowing lookup tables. Interestingly though, Griffin requires fewer Plonk gates than Reinforced Concrete when using Plonk with the Plookup extension.</p>

    <p class="text-gray-300">Acknowledgments. The authors thank all reviewers for their suggestions on how to improve the quality of the paper. We also thank them for the suggestion of the name Horst, for pointing out the similarity between Horst and the Sbox used in Streebog, and for pointing out a mistake in the differential security analysis of Griffin. We thank Danny Willems for pointing out an optimization in the Plonk arithmetization for Griffin. Lorenzo Grassi is supported by the German Research Foundation (DFG) within the framework of the Excellence Strategy of the Federal Government and the States &ndash; EXC 2092 CaSa &ndash; 39078197. Roman Walch is supported by the &quot;DDAI&quot; COMET Module within the COMET - Competence Centers for Excellent Technologies Programme, funded by the Austrian Federal Ministry for Transport, Innovation and Technology (bmvit), the Austrian Federal Ministry for Digital and Economic Affairs (bmdw), the Austrian Research Promotion Agency (FFG), the province of Styria (SFG) and partners from industry and academia. The COMET Programme is managed by FFG. Yonglin Hao is supported by National Natural Science Foundation of China (Grant No. 62002024), National Key Research and Development Program of China (No. 2018YFA0306404). Qingju Wang was funded, in part, by Huawei Technologies Co., Ltd (Agreement No.: YBN2020035184) when she was working at the University of Luxembourg.</p>

    </section>

    <section id="references" class="mb-10">
      <h2 class="text-2xl font-bold">References</h2>

    <ul class="space-y-2 text-gray-400 text-sm list-none">
      <li><p class="text-gray-300">M. R. Albrecht, C. Cid, L. Grassi, D. Khovratovich, R. L&uuml;ftenegger, C. Rechberger, and M. Schofnegger. &quot;Algebraic Cryptanalysis of STARK-Friendly Designs: Application to MARVELlous and MiMC&quot;. In: ASIACRYPT 2019. Vol. 11923. LNCS. 2019, pp. 371&ndash;397.</p></li>
      <li><p class="text-gray-300">[2] M. R. Albrecht, L. Grassi, L. Perrin, S. Ramacher, C. Rechberger, D. Rotaru, A. Roy, and M. Schofnegger. &quot;Feistel Structures for MPC, and More&quot;. In: ESORICS 2019. Vol. 11736. LNCS. 2019, pp. 151&ndash;171.</p></li>
      <li><p class="text-gray-300">[3] M. R. Albrecht, L. Grassi, C. Rechberger, A. Roy, and T. Tiessen. &quot;MiMC: Efficient Encryption and Cryptographic Hashing with Minimal Multiplicative Complexity&quot;. In: ASIACRYPT 2016. Vol. 10031. LNCS. 2016, pp. 191&ndash;219.</p></li>
      <li><p class="text-gray-300">[4] A. Aly, T. Ashur, Eli Ben-Sasson, S. Dhooghe, and A. Szepieniec. &quot;Design of Symmetric-Key Primitives for Advanced Cryptographic Protocols&quot;. In: <em>IACR Trans. Symmetric Cryptol.</em> 2020.3 (2020), pp. 1&ndash;45.</p></li>
      <li><p class="text-gray-300">[5] S. Ames, C. Hazay, Y. Ishai, and M. Venkitasubramaniam. &quot;Ligero: Lightweight Sublinear Arguments Without a Trusted Setup&quot;. In: CCS. ACM, 2017, pp. 2087&ndash; 2104.</p></li>
      <li><p class="text-gray-300">[6] M. Bardet, J.-C. Faug&acute;ere, B. Salvy, and B.-Y. Yang. &quot;Asymptotic behaviour of the degree of regularity of semi-regular polynomial systems&quot;. In: Proc. of MEGA. Vol. 5. 2005.</p></li>
      <li><p class="text-gray-300">[7] E. Ben-Sasson, I. Bentov, Y. Horesh, and M. Riabzev. Scalable, transparent, and post-quantum secure computational integrity. Cryptology ePrint Archive, Report 2018/46. 2018.</p></li>
      <li><p class="text-gray-300">[8] E. Ben-Sasson, A. Chiesa, M. Riabzev, N. Spooner, M. Virza, and N. P. Ward. &quot;Aurora: Transparent Succinct Arguments for R1CS&quot;. In: EUROCRYPT 2019. Vol. 11476. LNCS. 2019, pp. 103&ndash;128.</p></li>
      <li><p class="text-gray-300">[9] G. Bertoni, J. Daemen, M. Peeters, and G. Van Assche. Sponge functions. In: Ecrypt Hash Workshop 2007, [http://www.csrc.nist.gov/pki/HashWorkshop/](http://www.csrc.nist.gov/pki/HashWorkshop/Public Comments/2007_May.html) [PublicComments/2007\\_May.html](http://www.csrc.nist.gov/pki/HashWorkshop/Public Comments/2007_May.html). 2007.</p></li>
      <li><p class="text-gray-300">[10] G. Bertoni, J. Daemen, M. Peeters, and G. Van Assche. &quot;On the Indifferentiability of the Sponge Construction&quot;. In: EUROCRYPT 2008. Vol. 4965. LNCS. 2008, pp. 181&ndash;197.</p></li>
      <li><p class="text-gray-300">[11] T. Beyne, A. Canteaut, I. Dinur, M. Eichlseder, G. Leander, G. Leurent, M. Naya-Plasencia, L. Perrin, Y. Sasaki, Y. Todo, and F. Wiemer. &quot;Out of Oddity - New Cryptanalytic Techniques Against Symmetric Primitives Optimized for Integrity Proof Systems&quot;. In: CRYPTO 2020. Vol. 12172. LNCS. 2020, pp. 299&ndash; 328.</p></li>
      <li><p class="text-gray-300">[12] E. Biham and A. Shamir. &quot;Differential Cryptanalysis of DES-like Cryptosystems&quot;. In: CRYPTO 1990. Vol. 537. LNCS. 1990, pp. 2&ndash;21.</p></li>
      <li><p class="text-gray-300">[13] A. Biryukov, L. Perrin, and A. Udovenko. &quot;Reverse-Engineering the S-Box of Streebog, Kuznyechik and STRIBOBr1&quot;. In: EUROCRYPT (1). Vol. 9665. Lecture Notes in Computer Science. Springer, 2016, pp. 372&ndash;402.</p></li>
      <li><p class="text-gray-300">[14] J. Black, P. Rogaway, and T. Shrimpton. &quot;Black-Box Analysis of the Block-Cipher-Based Hash-Function Constructions from PGV&quot;. In: CRYPTO. Vol. 2442. Lecture Notes in Computer Science. Springer, 2002, pp. 320&ndash;335.</p></li>
      <li><p class="text-gray-300">[15] C. Boura, A. Canteaut, and C. D. Canni\`ere. &quot;Higher-Order Differential Properties of Keccak and Luffa&quot;. In: FSE 2011. Vol. 6733. LNCS. 2011, pp. 252&ndash; 269.</p></li>
      <li><p class="text-gray-300">[16] C. Bouvier, P. Briaud, P. Chaidos, L. Perrin, R. Salen, V. Velichkov, and D. Willems. &quot;New Design Techniques for Efficient Arithmetization-Oriented Hash Functions: Anemoi Permutations and Jive Compression Mode&quot;. In: IACR Cryptol. ePrint Arch. (2022), p. 840.</p></li>
      <li><p class="text-gray-300">[17] B. Buchberger. &quot;Ein Algorithmus zum Auffinden der Basiselemente des Restklassenringes nach einem nulldimensionalen Polynomideal&quot;. PhD thesis. University of Innsbruck, 1965.</p></li>
      <li><p class="text-gray-300">[18] B. B&uml;unz, J. Bootle, D. Boneh, A. Poelstra, P. Wuille, and G. Maxwell. &quot;Bulletproofs: Short Proofs for Confidential Transactions and More&quot;. In: IEEE Symposium on Security and Privacy. IEEE Computer Society, 2018, pp. 315&ndash;334.</p></li>
      <li><p class="text-gray-300">[19] J.-S. Coron, J. Patarin, and Y. Seurin. &quot;The Random Oracle Model and the Ideal Cipher Model Are Equivalent&quot;. In: CRYPTO 2008. Vol. 5157. LNCS. 2008, pp. 1&ndash; 20.</p></li>
      <li><p class="text-gray-300">[20] D. A. Cox, J. Little, and D. O'Shea. Ideals, Varieties, and Algorithms &ndash; An Introduction to Computational Algebraic Geometry and Commutative Algebra. 2nd ed. Undergraduate Texts in Mathematics. Springer, 1997.</p></li>
      <li><p class="text-gray-300">[21] R. A. de la Cruz Jim&acute;enez. &quot;On some methods for constructing almost optimal S-Boxes and their resilience against side-channel attacks&quot;. In: IACR Cryptol. ePrint Arch. (2018), p. 618.</p></li>
      <li><p class="text-gray-300">[22] J. Daemen and V. Rijmen. &quot;The Wide Trail Design Strategy&quot;. In: Cryptography and Coding - IMA International Conference 2001. Vol. 2260. LNCS. 2001, pp. 222&ndash;238.</p></li>
      <li><p class="text-gray-300">[23] Y. Dai and J. P. Steinberger. &quot;Indifferentiability of 8-Round Feistel Networks&quot;. In: Advances in Cryptology - CRYPTO 2016. Vol. 9814. LNCS. 2016, pp. 95&ndash;120.</p></li>
      <li><p class="text-gray-300">[24] C. Dobraunig, L. Grassi, A. Guinet, and D. Kuijsters. &quot;Ciminion: Symmetric Encryption Based on Toffoli-Gates over Large Finite Fields&quot;. In: EUROCRYPT 2021. Vol. 12697. LNCS. 2021, pp. 3&ndash;34.</p></li>
      <li><p class="text-gray-300">[25] V. Dolmatov and A. Degtyarev. &quot;GOST R 34.11-2012: Hash Function&quot;. In: RFC 6986 (2013), pp. 1&ndash;40.</p></li>
      <li><p class="text-gray-300">[26] S. Duval and G. Leurent. &quot;MDS Matrices with Lightweight Circuits&quot;. In: IACR Trans. Symmetric Cryptol. 2018.2 (2018), pp. 48&ndash;78.</p></li>
      <li><p class="text-gray-300">[27] Federal Agency on Technical Regulation and Metrology. GOST R 34.12-2015: Block Cipher. 2015.</p></li>
      <li><p class="text-gray-300">[28] A. Gabizon and Z. J. Williamson. &quot;plookup: A simplified polynomial protocol for lookup tables&quot;. In: IACR Cryptol. ePrint Arch. (2020), p. 315.</p></li>
      <li><p class="text-gray-300">[29] A. Gabizon, Z. J. Williamson, and O. Ciobotaru. PLONK: Permutations over Lagrange-bases for Oecumenical Noninteractive arguments of Knowledge. Cryptology ePrint Archive, Report 2019/953. 2019.</p></li>
      <li><p class="text-gray-300">[30] L. Grassi. &quot;On Generalizations of the Lai-Massey Scheme: the Blooming of Amaryllises&quot;. In: IACR Cryptol. ePrint Arch. (2022), p. 1245.</p></li>
      <li><p class="text-gray-300">[31] L. Grassi, D. Khovratovich, R. L&uml;uftenegger, C. Rechberger, M. Schofnegger, and R. Walch. Reinforced Concrete: Fast Hash Function for Zero Knowledge Proofs and Verifiable Computation. Cryptology ePrint Archive, Report 2021/1038. accpted at ACM CCS 2022. 2021.</p></li>
      <li><p class="text-gray-300">[32] L. Grassi, D. Khovratovich, C. Rechberger, A. Roy, and M. Schofnegger. &quot;Poseidon: A New Hash Function for Zero-Knowledge Proof Systems&quot;. In: USENIX Security Symposium. USENIX Association, 2021, pp. 519&ndash;535.</p></li>
      <li><p class="text-gray-300">[33] L. Grassi, D. Khovratovich, S. R&oslash;njom, and M. Schofnegger. &quot;The Legendre Symbol and the Modulo-2 Operator in Symmetric Schemes over Fnp Preimage Attack on Full Grendel&quot;. In: IACR Trans. Symmetric Cryptol. 2022.1 (2022), pp. 5&ndash;37.</p></li>
      <li><p class="text-gray-300">[34] L. Grassi, R. L&uml;uftenegger, C. Rechberger, D. Rotaru, and M. Schofnegger. &quot;On a Generalization of Substitution-Permutation Networks: The HADES Design Strategy&quot;. In: EUROCRYPT 2020. Vol. 12106. LNCS. 2020, pp. 674&ndash;704.</p></li>
      <li><p class="text-gray-300">[35] L. Grassi, S. Onofri, M. Pedicini, and L. Sozzi. &quot;Invertible Quadratic Non-Linear Layers for MPC-/FHE-/ZK-Friendly Schemes over Fnp: Application to Poseidon&quot;. In: IACR Trans. Symmetric Cryptol. 2022.3 (2022), pp. 20&ndash;72.</p></li>
      <li><p class="text-gray-300">[36] L. Grassi, C. Rechberger, D. Rotaru, P. Scholl, and N. P. Smart. &quot;MPC-Friendly Symmetric Key Primitives&quot;. In: CCS. ACM, 2016, pp. 430&ndash;443.</p></li>
      <li><p class="text-gray-300">[37] J. Groth. &quot;On the Size of Pairing-Based Non-interactive Arguments&quot;. In: EU-ROCRYPT 2016. Vol. 9666. LNCS. 2016, pp. 305&ndash;326.</p></li>
      <li><p class="text-gray-300">[38] V. T. Hoang and P. Rogaway. &quot;On Generalized Feistel Networks&quot;. In: CRYPTO. Vol. 6223. LNCS. 2010, pp. 613&ndash;630.</p></li>
      <li><p class="text-gray-300">[39] H. B. Hougaard. &quot;3-round Feistel is Not Superpseudorandom Over Any Group&quot;. In: IACR Cryptol. ePrint Arch. (2021), p. 675.</p></li>
      <li><p class="text-gray-300">[40] T. Jakobsen and L. R. Knudsen. &quot;The Interpolation Attack on Block Ciphers&quot;. In: FSE 1997. Vol. 1267. LNCS. 1997, pp. 28&ndash;40.</p></li>
      <li><p class="text-gray-300">[41] A. Klimov and A. Shamir. &quot;Cryptographic Applications of T-Functions&quot;. In: SAC 2003. Vol. 3006. LNCS. 2003, pp. 248&ndash;261.</p></li>
      <li><p class="text-gray-300">[42] S. K&uml;olbl, M. M. Lauridsen, F. Mendel, and C. Rechberger. &quot;Haraka v2 - Efficient Short-Input Hashing for Post-Quantum Applications&quot;. In: IACR Trans. Symmetric Cryptol. 2016.2 (2016), pp. 1&ndash;29.</p></li>
      <li><p class="text-gray-300">[43] X. Lai and J. L. Massey. &quot;A Proposal for a New Block Encryption Standard&quot;. In: EUROCRYPT 1990. Vol. 473. LNCS. 1990, pp. 389&ndash;404.</p></li>
      <li><p class="text-gray-300">[44] M. Lamberger, F. Mendel, C. Rechberger, V. Rijmen, and M. Schl&uml;affer. &quot;Rebound Distinguishers: Results on the Full Whirlpool Compression Function&quot;. In: ASIACRYPT 2009. Vol. 5912. LNCS. 2009, pp. 126&ndash;143.</p></li>
      <li><p class="text-gray-300">[45] M. Luby and C. Rackoff. &quot;How to Construct Pseudorandom Permutations from Pseudorandom Functions&quot;. In: SIAM J. Comput. 17.2 (1988), pp. 373&ndash;386.</p></li>
      <li><p class="text-gray-300">[46] M. Matsui. &quot;Linear Cryptanalysis Method for DES Cipher&quot;. In: EUROCRYPT 1993. Vol. 765. LNCS. 1993, pp. 386&ndash;397.</p></li>
      <li><p class="text-gray-300">[47] K. Matusiewicz, M. Naya-Plasencia, I. Nikolic, Y. Sasaki, and M. Schl&uml;affer. &quot;Rebound Attack on the Full Lane Compression Function&quot;. In: ASIACRYPT 2009. Vol. 5912. LNCS. 2009, pp. 106&ndash;125.</p></li>
      <li><p class="text-gray-300">[48] U. M. Maurer and K. Pietrzak. &quot;The Security of Many-Round Luby-Rackoff Pseudo-Random Permutations&quot;. In: EUROCRYPT 2003. Vol. 2656. LNCS. 2003, pp. 544&ndash;561.</p></li>
      <li><p class="text-gray-300">[49] F. Mendel, C. Rechberger, M. Schl&uml;affer, and S. S. Thomsen. &quot;The Rebound Attack: Cryptanalysis of Reduced Whirlpool and Gr&oslash;stl&quot;. In: FSE 2009. Vol. 5665. LNCS. 2009, pp. 260&ndash;276.</p></li>
      <li><p class="text-gray-300">[50] R. Mollin and S. C. &quot;On Permutation Polynomials Over Finite Fields&quot;. In: International Journal of Mathematics and Mathematical Sciences 10 (Jan. 1987).</p></li>
      <li><p class="text-gray-300">[51] National Institute of Standards and Technology. &quot;SHA-3 Standard: Permutation-Based Hash and Extendable-Output Functions&quot;. In: Federal Information Processing Standards Publication (FIPS) (202 2015).</p></li>
      <li><p class="text-gray-300">[52] K. Nyberg. &quot;Generalized Feistel Networks&quot;. In: ASIACRYPT. Vol. 1163. LNCS. 1996, pp. 91&ndash;104.</p></li>
      <li><p class="text-gray-300">[53] J. Patarin. &quot;About Feistel Schemes with Six (or More) Rounds&quot;. In: FSE 1998. Vol. 1372. LNCS. 1998, pp. 103&ndash;121.</p></li>
      <li><p class="text-gray-300">[54] J. Patarin. &quot;Generic Attacks on Feistel Schemes&quot;. In: ASIACRYPT 2001. Vol. 2248. LNCS. 2001, pp. 222&ndash;238.</p></li>
      <li><p class="text-gray-300">[55] S. Patel, Z. Ramzan, and G. S. Sundaram. &quot;Luby-Rackoff Ciphers: Why XOR Is Not So Exclusive&quot;. In: Selected Areas in Cryptography. Vol. 2595. Lecture Notes in Computer Science. Springer, 2002, pp. 271&ndash;290.</p></li>
      <li><p class="text-gray-300">[56] Polygon. Introducing Plonky2. 2022.</p></li>
      <li><p class="text-gray-300">[57] B. Preneel, R. Govaerts, and J. Vandewalle. &quot;Hash Functions Based on Block Ciphers: A Synthetic Approach&quot;. In: CRYPTO. Vol. 773. Lecture Notes in Computer Science. Springer, 1993, pp. 368&ndash;378.</p></li>
      <li><p class="text-gray-300">[58] A. Szepieniec. &quot;On the Use of the Legendre Symbol in Symmetric Cipher Design&quot;. In: IACR Cryptol. ePrint Arch. (2021), p. 984.</p></li>
      <li><p class="text-gray-300">[59] A. Szepieniec, T. Ashur, and S. Dhooghe. Rescue-Prime: a Standard Specification (SoK). Cryptology ePrint Archive, Report 2020/1143. 2020.</p></li>
      <li><p class="text-gray-300">[60] S. Vaudenay. &quot;Decorrelation: A Theory for Block Cipher Security&quot;. In: J. Cryptol. 16.4 (2003), pp. 249&ndash;286.</p></li>
      <li><p class="text-gray-300">[61] Zcash. ZCash protocol specification. https://github.com/zcash/zips/blob/master/protocol/protocol.pdf. 2021.</p></li>
      <li><p class="text-gray-300">[62] Y. Zheng, T. Matsumoto, and H. Imai. &quot;On the Construction of Block Ciphers Provably Secure and Not Relying on Any Unproved Hypotheses&quot;. In: CRYPTO. Vol. 435. LNCS. 1989, pp. 461&ndash;480.</p></li>
    </ul>

    <h3 id="sec-misc-1" class="text-xl font-semibold mt-8">Source Code</h3>

    <p class="text-gray-300">The source code used in our evaluations is publicly available at https://extgit.iaik.tugraz.at/krypto/zkfriendlyhashzoo/-/tree/master/bellman [20].</p>

    </section>

    <section id="app-a" class="mb-10">
      <h2 class="text-2xl font-bold">A STARKs with Griffin</h2>

    <p class="text-gray-300">We first analyze the cost metric in STARKs and then the performance of GRIF-FIN compared to various competitors.</p>

      <h3 id="app-a.1" class="text-xl font-semibold mt-8">A.1 Algebraic Intermediate Representation (AIR)</h3>

    <p class="text-gray-300">zk-STARKs [5] and their implementations, such as the Wintefell library  <span class="math">^{22}</span>  for which an independantly authored Griffin implementation exists, require to translate the computational problem into an algebraic intermediate representation (AIR). The AIR consists of a sequence of machine states (the algebraic execution trace (AET)) and multivariate polynomials describing the transition between those states. The machine states consist of w registers each, and the sequence has a length of T machine states. Thus, the AET is a  <span class="math">T\\times w</span>  matrix, where the i-th row describes the machine state at timestep i. With  <span class="math">d_{\\rm max}</span>  being the maximum degree of all multivariate transition polynomials, the efficiency of the proof system (i.e., proof size, prover/verification time) depends on w,T, and  <span class="math">d_{\\rm max}</span> , where smaller values lead to more efficient proofs. In the literature, several different performance metrics have been proposed to compare the efficiency of different AIRs, such as  <span class="math">w\\cdot T\\cdot d_{\\rm max}</span>  in [1],  <span class="math">8\\cdot w\\cdot T\\cdot d_{\\rm max}\\cdot \\log_2(w\\cdot T)</span>  in [17], or  <span class="math">\\left\\lceil \\frac{\\log_2(|\\mathbb{F}|)}{64}\\right\\rceil^2\\cdot (d_{\\rm max}+w)\\cdot T\\cdot \\log_2(T)</span>  in [6].</p>

    <p class="text-gray-300">There exist many different ways to design an AIR from a given circuit. For arithmetic hash functions purely built with additions and multiplications, an AIR can be built as follows. (1) The AET consists of a machine with a state size of w, which is equal to the state size t of the hash function, and represents the state after each round. (2) The length T of the AET sequence equals the number of rounds r of the hash function. (3) The multivariate update polynomials correspond to the applied round function, which is why  <span class="math">d_{\\text{max}}</span>  corresponds to the maximum degree of the representation of the nonlinear layers.</p>

    <p class="text-gray-300">One can also consider various tradeoffs, e.g., increasing the state size w of the AIR by adding intermediate variables to reduce the maximum degree  <span class="math">d_{\\max}</span>  of</p>

    <p class="text-gray-300">https://github.com/facebook/winterfell</p>

    <p class="text-gray-300">the update polynomials. The designer must find an optimal AIR representation which minimizes the cost. In many cases, though, starting with the straightforward AIR described in this section will give the best result. Indeed, the designers of Poseidon and <em>Rescue</em> propose such AIRs with slight modifications.<sup>23</sup></p>

    <p class="text-gray-300"><strong>Cost Metric.</strong> We approximate the cost metric to be in  <span class="math">\\mathcal{O}(d_{\\text{max}} \\cdot T)</span> , i.e., the number of rounds times the degree of the round function representation. In order to perform an efficient verification, we therefore suggest to work with the zero-equivalent functions that minimize  <span class="math">\\mathcal{O}(d_{\\text{max}} \\cdot T)</span> .</p>

      <h3 id="app-a.2" class="text-xl font-semibold mt-8">A.2 Relations Between SNARK and STARK Cost Metrics</h3>

    <p class="text-gray-300">Similar to e.g. HE or MPC use cases, the performance of the proof systems scales with the number of nonlinear operations. However, the metrics can differ significantly. While for HE it is important to minimize the multiplicative depth, for MPC it is crucial to minimize the total number of multiplications. In ZK proof systems, on the other hand, it is important to find an efficient equivalent representation which minimizes the degree and/or the number of multiplications. Thus, while having to compute  <span class="math">y = x^{1/d}</span>  for small d is inefficient in MPC due to the large number of multiplications, it is efficient in SNARKs/STARKs by switching the representation to  <span class="math">y^d = x</span> . Further, observe that the degree of a nonlinear relation differs from the number of multiplications. The relations  <span class="math">y_3 = x^3</span>  and  <span class="math">y_4 = x^4</span>  have a different degree (i.e.,  <span class="math">y_3</span>  is more beneficial in STARKs), however, they require the same number of multiplications to compute, which make them equivalent in MPC and SNARKs. Similarly, the relations  <span class="math">y_5 = x^5</span>  and  <span class="math">y_5&#x27; = \\sum_{i=0}^5 x^i</span>  have the same degree and are equally beneficial in STARKs, but  <span class="math">y_5&#x27;</span>  requires more multiplications, making it worse for MPC and SNARKs.</p>

      <h3 id="app-a.3" class="text-xl font-semibold mt-8">A.3 STARK Performance of Griffin</h3>

    <p class="text-gray-300">Here we analyze the efficiency of Griffin and its competitors in zk-STARKs by comparing the AIR representations of the different hash functions. For this purpose, we transform Griffin into an efficient AIR representation: We construct a straightforward AIR, where the machine size w equals the state size t and represents the state of Griffin after each round. Thus, the length of the AET sequence T corresponds to the number of rounds R. Describing the nonlinear layer as  <span class="math">y_0^d = x_0</span> ,  <span class="math">y_1 = x_1^d</span> ,  <span class="math">y_2 = x_2 \\cdot \\left( (\\gamma_2 \\cdot y_0 + y_1)^2 + \\alpha_2(\\gamma_2 \\cdot y_0 + y_1) + \\beta_2 \\right)</span> , and  <span class="math">y_i = x_i \\cdot \\left( (\\gamma_i \\cdot y_0 + y_1 + x_{i-1})^2 + \\alpha_i(\\gamma_i \\cdot y_0 + y_1 + x_{i-1}) + \\beta_i \\right)</span>  for  <span class="math">i \\in \\{3, \\ldots, t-1\\}</span> , one can observe that the maximum degree of the multivariate update polynomials is given by d, since per definition  <span class="math">d \\geq 3</span> . As before, the linear layers can be included into the description of the nonlinear layers.</p>

    <p class="text-gray-300">Compared to the AIR representation of Poseidon, Rescue/Rescue-Prime, and Grendel, the structure of the Griffin AIR constraints is simpler. Indeed,</p>

    <p class="text-gray-300">Poseidon uses heavy preprocessing to combine t partial rounds into one to reduce the effective number of partial rounds.</p>

    <p class="text-gray-300">Table 6: Comparison of AIR cost for different permutations instantaited with a 256-bit prime field. The total AIR cost is given as the product of  <span class="math">w \\cdot T \\cdot d_{\\text{max}}</span> .</p>

    <div class="overflow-x-auto my-4">
      <table class="min-w-full text-sm text-gray-300">
        <thead>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"></th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"></th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"></th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">J</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">= 2</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">1</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">1</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"></th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"></th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"><i>d</i> =</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"></th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"></th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"></th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">1</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"></th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"></th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"><i>d</i> =</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">_ 5</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"></th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">max.</th>
        </thead>
        <tbody>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">$ _{R}$</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">211</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">AIR</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">$ <em>{R</em>{\\mathcal{D}}}$</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">R_{\\rm D}</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">_</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">d</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">AIR</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">R.</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">R_{\\rm D}</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">R</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">d</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">AIR</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">10</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><u> </u></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">u_{\\text{max}}</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Ant</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">I t F</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">&#1087;&#1088;</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">11</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">w</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">umax</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Ant</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">ILF</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">&#1087;&#1098;&#1088;</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">11</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">w</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">umax</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">AIII</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">t = 3:</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Griffin</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">_</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">_</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">_</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">_</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">16</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">3</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">16</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">3</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">144</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">_</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">14</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">3</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">14</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">5</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">210</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Rescue-Prime</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">_</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">_</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">_</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">_</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">18</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">3</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">18</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">3</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">162</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">_</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">14</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">3</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">14</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">5</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">210</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Poseidon</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">_</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">_</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">_</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">_</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">_</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">8</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">83</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">_</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">3</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">36</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">3</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">324</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">8</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">56</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">_</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">3</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">27</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">5</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">405</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">GMiMC_{erf}</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">_</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">_</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">_</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">_</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">_</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">_</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">328</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">328</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">3</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">984</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">_</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">256</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">256</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">5</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1280</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Grendel</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">38</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">9</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">38</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">4</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1368</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">33</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">9</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">33</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">4</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1188</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">29</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">9</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">29</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">6</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1566</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">t=4:</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">GRIFFIN</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><br> -</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">_</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">_</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">_</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">l &ndash;</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">_</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">15</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">4</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">15</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">3</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">180</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">_</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">11</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">4</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">11</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">5</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">220</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Rescue-Prime</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">_</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">_</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">_</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">_</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">_</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">_</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">14</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">4</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">14</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">3</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">168</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">_</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">_</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">11</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">4</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">11</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">5</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">220</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Poseidon</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">_</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">_</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">_</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">_</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">_</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">8</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">84</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">_</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">4</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">29</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">3</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">348</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">8</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">56</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">_</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">4</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">22</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">5</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">440</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Neptune</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">_</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">_</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">_</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">_</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">_</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">6</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">68</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">_</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">4</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">23</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">4</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">368</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">6</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">68</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">_</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">4</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">23</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">5</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">460</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">\\mathrm{GMiMC}_{\\mathrm{erf}}</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">_</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">_</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">_</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">_</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">_</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">_</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">_</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">330</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">330</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">3</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">990</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">_</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">_</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">228</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">288</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">5</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1440</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Grendel</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">31</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">12</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">31</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">4</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1488</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">_</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">28</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">12</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">28</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">4</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1344</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">_</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">_</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">25</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">12</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">25</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">6</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1800</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Anemoi</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">_</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">_</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">_</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">_</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">_</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">_</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">14</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">4</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">14</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">3</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">168</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">_</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">14</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">4</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">14</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">5</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">280</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">t = 8:</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">GRIFFIN</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">_</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">_</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">_</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">_</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">_</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">11</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">8</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">11</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">3</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">264</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">_</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">9</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">8</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">9</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">5</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">360</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Rescue-Prime</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">_</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">_</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">_</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">_</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">_</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">_</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">8</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">8</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">8</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">3</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">192</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">_</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">8</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">8</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">8</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">5</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">320</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Neptune</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">_</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">_</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">_</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">_</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">6</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">72</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">_</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">8</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">15</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">4</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">480</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">6</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">72</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">_</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">8</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">15</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">5</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">600</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Poseidon</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">_</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">_</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">_</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">_</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">_</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">8</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">84</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">_</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">8</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">19</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">3</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">456</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">8</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">57</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">_</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">8</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">16</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">5</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">640</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">\\mathrm{GMiMC}_{\\mathrm{erf}}</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">_</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">_</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">_</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">_</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">338</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">338</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">3</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1014</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">_</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">236</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">236</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">5</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1180</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Grendel</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">17</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">24</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">17</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">4</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1632</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">16</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">24</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">16</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">4</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1536</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">15</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">24</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">15</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">6</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">2160</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Anemoi</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">_</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">_</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">_</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">_</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">_</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">12</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">8</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">12</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">3</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">288</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">12</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">8</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">12</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">5</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">480</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">t = 12:</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">GRIFFIN</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><u> </u></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">_</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">_</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">_</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">_</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">_</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">_</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">10</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">12</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">10</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">3</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">360</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">l &ndash;</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">_</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">9</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">12</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">9</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">5</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">540</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Rescue-Prime</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">_</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">_</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">_</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">_</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">_</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">_</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">8</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">12</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">8</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">3</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">288</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">_</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">_</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">8</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">12</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">8</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">5</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">480</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Poseidon</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">_</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">_</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">_</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">_</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">_</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">8</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">85</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">_</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">12</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">16</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">3</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">576</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">8</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">57</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">_</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">12</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">13</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">5</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">780</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Neptune</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">_</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">_</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">_</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">_</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">_</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">6</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">78</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">_</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">12</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">13</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">4</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">624</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">6</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">78</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">_</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">12</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">13</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">5</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">780</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">GMiMC_{erf}</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">_</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">_</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">_</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">_</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">_</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">_</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">346</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">346</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">3</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1038</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">_</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">_</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">314</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">314</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">5</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1570</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Grendel</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">12</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">36</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">12</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">4</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1728</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">_</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">_</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">12</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">36</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">12</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">4</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1728</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">_</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">11</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">36</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">11</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">6</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">2376</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Anemoi</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">_</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">_</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">_</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">_</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">_</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">10</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">12</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">10</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">3</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">360</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">_</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">10</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">12</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">10</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">5</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">600</td>
          </tr>
        </tbody>
      </table>
    </div>

    <p class="text-gray-300">Poseidon requires heavy precomputations to combine its partial rounds for a more compact AIR representation, the AIR of <em>Rescue</em> needs to combine the two nonlinear layers per round with a meet-in-the-middle approach, and <em>Grendel</em> requires to prove the Legendre symbol via introducing additional witness variables. However, the AIR of GRIFFIN is just a straightforward translation, and is therefore easier to use in practice.</p>

    <p class="text-gray-300">In Table 6 we compare the AIRs of the six different permutations when instantiated with 128-bit security, a 256-bit prime field, four different state sizes t, and for the most common cases where d=3 and d=5. For some prime fields, Grendel can be instantiated with d=2 which is why we also give numbers for</p>

    <p class="text-gray-300">this case. We give the AIR numbers by first listing the values for w, T, and  <span class="math">d_{\\text{max}}</span> , and then use their product as metric as in [1].</p>

    <p class="text-gray-300">The optimized AIR representations of all hash functions, with the exception of Grendel and  <span class="math">GMiMC_{erf}</span> , use a machine state with a size w equal to the state size t. Moreover, the maximum degree  <span class="math">d_{\\text{max}}</span>  equals the degree of the nonlinear layers d. Consequently, the length of the AET sequence T, which is equal to the number of rounds in <em>Rescue</em> and Griffin and depends on the number of rounds and the state size t in Poseidon and Neptune, constitutes the performance difference between these four designs, with smaller T yielding a more efficient AIR. In any case, Poseidon and Neptune have the largest T, i.e., a worse AIR compared to Griffin, Rescue, and Anemoi. The difference between the number of rounds of GRIFFIN, Rescue, and Anemoi depends on both t and d. Thus, there are cases, where Griffin has a better AIR (e.g., t=3), cases where Rescue has fewer rounds (e.g.,  <span class="math">t \\in \\{8,12\\}</span> ) and cases for which Rescue and Anemoi all produce the cheapest AIR (e.g., t=4). In all cases, though, GRIFFIN has significantly better plain performance than Rescue (and we expect faster plain performance compared to Anemoi as shown in [11]), reducing the time to build the AET.</p>

    <p class="text-gray-300">Even though <em>Grendel</em> can be instantiated with d=2 in some prime fields, the resulting round numbers, in addition to  <span class="math">d_{\\text{max}} \\geq 4</span> , lead to a significantly worse AIR compared to GRIFFIN and <em>Rescue</em>. Further, even though GMiMC<sub>erf</sub> can be represented with w=1 [6] in an AIR, the large number of rounds make it less efficient than the other designs.</p>

    <p class="text-gray-300">In [27], Patarin proposed distinguishers for 3-/4-round of Feistel. In this section, we propose similar distinguisher for  <span class="math">\\{3, 4, 5\\}</span>  rounds of  <span class="math">\\mathtt{Horst}^{\\times}</span> , where each round is defined as</p>

    <p class="text-gray-300"><span class="math">$(y,x) \\mapsto (x,(y+\\alpha_i)\\cdot H(x)+\\beta_i),</span>$</p>

    <p class="text-gray-300">where  <span class="math">H^{(i)}: \\mathbb{F}_q \\to \\mathbb{F}_q</span>  denotes the <em>i</em>-th round function for each  <span class="math">i \\in \\{0, \\dots, r-1\\}</span> , and where  <span class="math">\\alpha_i, \\beta_i \\in \\mathbb{F}_q</span>  for each  <span class="math">i \\in \\{0, \\dots, r-1\\}</span> . We expect that the distinguisher proposed for 5-/6-round Feistel in [27] can be adapted to 5-round Horst<sup>&times;</sup> as well and leave it as an open problem for future research.</p>

    <p class="text-gray-300">3 Rounds. In the case of Feistel/Horst<sup>&times;</sup>, we can consider inputs of the form  <span class="math">(\\hat{y}, x_i) \\in \\mathfrak{G}^2</span>  for several  <span class="math">i \\in \\mathbb{N}</span>  and the corresponding outputs  <span class="math">(z_i, w_i) \\in \\mathfrak{G}^2</span> . We then have that</p>

    <p class="text-gray-300"><span class="math">$z_i = (x_i + \\alpha_1) \\cdot H^{(1)}((\\hat{y} + \\alpha_0) \\cdot H^{(0)}(x_i) + \\beta_0) + \\beta_1.</span>$</p>

    <p class="text-gray-300">Since  <span class="math">H^{(0)}</span>  and  <span class="math">H^{(1)}</span>  are PRFs, the probability to have a collision of the form</p>

    <p class="text-gray-300"><span class="math">$(z_i - \\beta_1) \\cdot x_j = (z_j - \\beta_1) \\cdot x_i</span>$</p>

    <p class="text-gray-300">for  <span class="math">j \\neq i</span>  is around 2/q in the case of Feistel/Horst<sup>&times;</sup> and around 1/q in the case of a PRP. Indeed, note that  <span class="math">(z_i - \\beta_1) \\cdot x_j = (z_j - \\beta_1) \\cdot x_i</span>  can occur either if</p>

    <ul class="list-disc list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li><span class="math">-(\\hat{y}+\\alpha_0)\\cdot H^{(0)}(x_i)+\\beta_0=(\\hat{y}+\\alpha_0)\\cdot H^{(0)}(x_j)+\\beta_0</span> , that is,  <span class="math">H^{(0)}(x_i)=H^{(0)}(x_j)</span> , which happens with a probability of 1/q, or</li>
      <li><span class="math">-(x_i+\\alpha_1)\\cdot H^{(1)}((\\hat{y}+\\alpha_0)\\cdot H^{(0)}(x_i)+\\beta_0) = (x_j+\\alpha_1)\\cdot H^{(1)}((\\hat{y}+\\alpha_0)\\cdot H^{(0)}(x_j)+\\beta_0)</span>  and  <span class="math">H^{(0)}(x_i) \\neq H^{(0)}(x_j)</span> , for which the probability is  <span class="math">(1-1/q)\\cdot 1/q \\approx 1/q</span> .</li>
    </ul>

    <p class="text-gray-300">In the generic case of a Horst scheme in which  <span class="math">G^{(i)}</span>  and  <span class="math">F^{(i)}</span>  are unrelated, the problem to set up a distinguisher for 3 rounds is open for future research.</p>

    <p class="text-gray-300">4 Rounds. The previous 3-round distinguisher can easily be extended to 4 rounds. Indeed, it is sufficient to start with inputs of the form  <span class="math">(y_i, \\hat{y}) \\in \\mathbb{F}_q^2</span> , and to reuse the previous distinguisher, by noting that the outputs of the first rounds are of the form  <span class="math">(\\hat{y}, x_i) \\in \\mathbb{F}_q^2</span> .</p>

      <h3 id="app-c.1" class="text-xl font-semibold mt-8">C.1 Maximum Differential Probability of S</h3>

    <p class="text-gray-300"><strong>Proof of Lemma 2</strong> &ndash; Maximum Differential Probability of  <span class="math">x \\mapsto x^{1/d}</span> . First we prove that  <span class="math">DP_{\\max}(x \\mapsto x^d) = DP_{\\max}(x \\mapsto x^{1/d})</span> . Given the input and output differences  <span class="math">\\delta_I</span>  and  <span class="math">\\delta_O</span> , we want to analyze the maximal number of solutions x of  <span class="math">(x + \\delta_I)^{1/d} - x^{1/d} = \\delta_O</span> , or equivalently of</p>

    <p class="text-gray-300"><span class="math">$(x+\\delta_I)^{1/d} = x^{1/d} + \\delta_O.</span>$</p>

    <p class="text-gray-300">Computing the power of d of both sides, we have</p>

    <p class="text-gray-300"><span class="math">$x + \\delta_I = (x^{1/d} + \\delta_O)^d \\implies (x^{1/d} + \\delta_O)^d - x = \\delta_I.</span>$</p>

    <p class="text-gray-300">By making use of the change of variable  <span class="math">y=x^{1/d}</span>  or  <span class="math">x=y^d</span>  in the above equation, we get</p>

    <p class="text-gray-300"><span class="math">$(y + \\delta_O)^d - y^d = \\delta_I.</span>$</p>

    <p class="text-gray-300">Since every step is invertible, we have that the number of solutions of  <span class="math">(x + \\delta_I)^{1/d} - x^{1/d} = \\delta_O</span>  for  <span class="math">y = x^d</span>  corresponds to the number of solutions of  <span class="math">(y + \\delta_O)^d - y^d = \\delta_I</span>  for  <span class="math">y = x^{1/d}</span> . That is,  <span class="math">\\mathrm{DP}_{\\mathrm{max}}(x \\mapsto x^d) = \\mathrm{DP}_{\\mathrm{max}}(x \\mapsto x^{1/d})</span>  for each d such that  <span class="math">\\gcd(d, p - 1) = 1</span> .</p>

    <p class="text-gray-300">We then prove that  <span class="math">\\mathrm{DP_{max}}(x\\mapsto x^{d&#x27;})=\\frac{d&#x27;-1}{p}</span>  for a generic d' such that  <span class="math">\\gcd(d&#x27;,p-1)=1</span> . The equation  <span class="math">(x+\\delta_I)^{d&#x27;}-x^{d&#x27;}=\\delta_O</span>  equals to  <span class="math">\\sum_{i=0}^{d&#x27;-1}\\binom{d&#x27;}{i}\\cdot x^i\\cdot \\delta_I^{d&#x27;-i}=\\delta_O</span> . The maximal degree of the left-hand side with respect to x is d'-1, hence the maximal number of solutions x is d'-1, therefore  <span class="math">\\mathrm{DP_{max}}(x\\mapsto x^{d&#x27;})=(d&#x27;-1)/p</span> . This completes the proof.</p>

    <p class="text-gray-300">Proof of Lemma 3 &ndash; Maximum Differential Probability of  <span class="math">(x, \\ell) \\mapsto y = x \\cdot (\\ell^2 + \\alpha \\ell + \\beta)</span> . Given  <span class="math">\\Delta_I = (\\delta_x, \\delta_\\ell)</span>  and  <span class="math">\\Delta_O = \\delta_y</span> , we look for the number of solutions of</p>

    <p class="text-gray-300"><span class="math">$\\delta_y = (\\delta_x + x) \\cdot ((\\delta_\\ell + \\ell)^2 + \\alpha(\\delta_\\ell + \\ell) + \\beta) - x \\cdot (\\ell^2 + \\alpha\\ell + \\beta)</span>$</p>

    <p class="text-gray-300">=  <span class="math">\\delta_x \\cdot (\\delta_\\ell^2 + \\delta_\\ell \\cdot (2\\ell + \\alpha) + (\\ell^2 + \\alpha \\cdot \\ell + \\beta)) + x \\cdot \\delta_\\ell \\cdot (\\delta_\\ell + (2\\ell + \\alpha))</span> .</p>

    <p class="text-gray-300">We analyze the following cases independently.</p>

    <ul class="list-disc list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li>If  <span class="math">\\delta_{\\ell} = 0</span>  and  <span class="math">\\delta_x \\neq 0</span> , then</li>
    </ul>

    <p class="text-gray-300"><span class="math">$\\delta_x \\cdot (\\ell^2 + \\alpha \\cdot \\ell + \\beta) = \\delta_y \\implies \\ell^2 + \\alpha \\cdot \\ell + (\\beta - \\delta_y / \\delta_x) = 0,</span>$</p>

    <p class="text-gray-300">which admits at most two different solutions in  <span class="math">\\ell</span>  (independently of x) if  <span class="math">\\delta_y \\neq 0</span> , i.e.,  <span class="math">\\mathrm{DP_{max}}((\\delta_\\ell = 0, \\delta_x) \\mapsto \\delta_y) \\leq 2/p</span> . If  <span class="math">\\delta_y = 0</span> , then no solution is possible (since  <span class="math">\\ell^2 + \\alpha \\cdot \\ell + \\beta \\neq 0</span>  for each  <span class="math">\\ell \\in \\mathbb{F}_p</span> ), thus  <span class="math">\\mathrm{DP_{max}}((\\delta_\\ell = 0, \\delta_x) \\mapsto \\delta_y = 0) = 0</span> .</p>

    <p class="text-gray-300">&ndash; If  <span class="math">\\delta_{\\ell} \\neq 0</span>  and  <span class="math">\\delta_x = 0</span> , we have</p>

    <p class="text-gray-300"><span class="math">$x \\cdot \\delta_{\\ell} \\cdot (\\delta_{\\ell} + (2\\ell + \\alpha)) = \\delta_{y}.</span>$</p>

    <p class="text-gray-300">If  <span class="math">\\delta_y = 0</span> , this equation admits x = 0 or  <span class="math">\\ell = -(\\alpha + \\delta_\\ell)/2</span>  as possible solutions, which means that  <span class="math">\\mathrm{DP}_{\\mathrm{max}}((\\delta_\\ell, \\delta_x = 0) \\mapsto \\delta_y = 0) \\leq (2p-1)/p^2 \\leq 2/p</span> . Otherwise, if  <span class="math">\\delta_y \\neq 0</span>  and  <span class="math">\\ell \\neq -(\\alpha + \\delta_\\ell)/2</span> ,</p>

    <p class="text-gray-300"><span class="math">$x = \\frac{\\delta_y}{\\delta_\\ell \\cdot (\\delta_\\ell + (2\\ell + \\alpha))}.</span>$</p>

    <p class="text-gray-300">As a result,  <span class="math">DP_{\\max}((\\delta_{\\ell}, \\delta_x = 0) \\mapsto \\delta_y) \\leq (p-1)/p^2 \\leq 1/p</span> .</p>

    <p class="text-gray-300">&ndash; If  <span class="math">\\delta_{\\ell} \\neq 0</span>  and  <span class="math">\\delta_x \\neq 0</span> , the solutions are given by</p>

    <p class="text-gray-300"><span class="math">$x = \\frac{\\delta_y - \\delta_x \\cdot \\left(\\delta_\\ell^2 + \\delta_\\ell \\cdot (2\\ell + \\alpha) + (\\ell^2 + \\alpha \\cdot \\ell + \\beta)\\right)}{\\delta_\\ell \\cdot (\\delta_\\ell + (2\\ell + \\alpha))}</span>$</p>

    <p class="text-gray-300">if  <span class="math">\\ell \\neq -(\\alpha + \\delta_{\\ell})/2</span> . Hence, again  <span class="math">\\mathrm{DP}_{\\mathrm{max}}((\\delta_x, \\delta_{\\ell}) \\mapsto \\delta_y) \\leq (p-1)/p^2 \\leq 1/p</span> . This result also holds for  <span class="math">\\delta_y = 0</span> .</p>

    <p class="text-gray-300">Maximum Differential Probability of  <span class="math">(x, \\ell) \\mapsto y = x \\cdot (\\ell^2 + \\alpha \\ell + \\beta)</span>  with Fixed  <span class="math">\\ell, \\delta_{\\ell}</span> . We assume that  <span class="math">\\ell</span>  and  <span class="math">\\delta_{\\ell}</span>  are fixed and work as before.</p>

    <ul class="list-disc list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li>If  <span class="math">\\delta_{\\ell} = 0</span>  and  <span class="math">\\delta_x \\neq 0</span> , then the equality  <span class="math">\\ell^2 + \\alpha \\cdot \\ell + (\\beta \\delta_y/\\delta_x) = 0</span>  depends on the values of  <span class="math">\\ell</span>  and/or  <span class="math">\\delta_y</span> , but is independent of the values of x.</li>
      <li>If  <span class="math">\\delta_{\\ell} \\neq 0</span>  and  <span class="math">\\delta_{x} = 0</span> , then the equality  <span class="math">x \\cdot \\delta_{\\ell} \\cdot (\\delta_{\\ell} + (2\\ell + \\alpha)) = \\delta_{y}</span>  admits at most 1 solution if  <span class="math">\\delta_{\\ell} + (2\\ell + \\alpha) \\neq 0</span> . If  <span class="math">\\delta_{\\ell} + (2\\ell + \\alpha) = 0</span> , it is satisfied by any x if  <span class="math">\\delta_{y} = 0</span> , and never if  <span class="math">\\delta_{y} \\neq 0</span> .</li>
      <li>If  <span class="math">\\delta_{\\ell} \\neq 0</span>  and  <span class="math">\\delta_{x} \\neq 0</span> , then there is at most one solution if  <span class="math">\\ell \\neq -(\\alpha + \\delta_{\\ell})/2</span> . Otherwise, the equality for any x depends on  <span class="math">\\ell, \\delta_{y}, \\delta_{x}</span>  (that is, if  <span class="math">\\delta_{y} = \\delta_{x} \\cdot (\\ell^{2} + \\alpha \\cdot \\ell + \\beta)</span> ).</li>
    </ul>

    <p class="text-gray-300">As a result, the following holds.</p>

    <p class="text-gray-300"><strong>Lemma 4.</strong> Let  <span class="math">\\alpha, \\beta \\in \\mathbb{F}_p \\setminus \\{0\\}</span>  such that  <span class="math">\\alpha^2 - 4\\beta</span>  is a quadratic nonresidue modulo p. Let  <span class="math">\\ell, \\delta_{\\ell} \\in \\mathbb{F}_p</span>  be arbitrary and fixed. For each  <span class="math">\\delta_x, \\delta_y \\in \\mathbb{F}_p</span> , the number</p>

    <p class="text-gray-300">of solutions  <span class="math">\\#sol_{\\ell,\\delta_{\\ell}}</span>  of  <span class="math">F_{\\ell+\\delta_{\\ell}}(x+\\delta_x)-F_{\\ell}(x)=\\delta_y</span>  where  <span class="math">F_z(x)=x\\cdot(z^2+\\alpha\\cdot z+\\beta)</span>  is given by</p>

    <p class="text-gray-300"><span class="math">$\\#sol_{\\ell,\\delta_{\\ell}} = \\begin{cases} 0 &amp; \\text{if } (1st) \\ \\delta_{\\ell} = 0, \\delta_{x} \\neq 0, \\ell^{2} + \\alpha \\cdot \\ell + (\\beta - \\delta_{y}/\\delta_{x}) \\neq 0, \\\\ &amp; \\text{or } (2nd) \\ \\delta_{\\ell} \\neq 0, \\delta_{x} = 0, \\delta_{y} \\neq 0, \\delta_{\\ell} + (2\\ell + \\alpha) = 0, \\\\ &amp; \\text{or } (3rd) \\ \\delta_{\\ell} \\neq 0, \\delta_{x} \\neq 0, \\ell = -(\\alpha + \\delta_{\\ell})/2, \\delta_{y} \\neq \\delta_{x} \\cdot (\\ell^{2} + \\alpha \\cdot \\ell + \\beta), \\\\ p &amp; \\text{if } (1st) \\ \\delta_{\\ell} = 0, \\delta_{x} \\neq 0, \\ell^{2} + \\alpha \\cdot \\ell + (\\beta - \\delta_{y}/\\delta_{x}) = 0, \\\\ &amp; \\text{or } (2nd) \\ \\delta_{\\ell} \\neq 0, \\delta_{x} = 0, \\delta_{y} = 0, \\delta_{\\ell} + (2\\ell + \\alpha) = 0, \\\\ &amp; \\text{or } (3rd) \\ \\delta_{\\ell} \\neq 0, \\delta_{x} \\neq 0, \\ell = -(\\alpha + \\delta_{\\ell})/2, \\delta_{y} = \\delta_{x} \\cdot (\\ell^{2} + \\alpha \\cdot \\ell + \\beta), \\\\ 1 &amp; \\text{otherwise.} \\end{cases}</span>$</p>

      <h3 id="app-c.2" class="text-xl font-semibold mt-8">C.2 Branch Number of M</h3>

    <p class="text-gray-300">The quality of a linear diffusion layer can be reflected by its branch number. For a vector  <span class="math">\\boldsymbol{x}</span>  over the field  <span class="math">\\mathbb{F}_p</span> , its hamming weight  <span class="math">\\mathrm{hw}(\\boldsymbol{x})</span>  is defined in the following.</p>

    <p class="text-gray-300"><strong>Definition 6.</strong> The Hamming weight of a vector, denoted as  <span class="math">hw(\\cdot)</span> , is defined as the number of nonzero elements.</p>

    <p class="text-gray-300">For an arbitrary matrix  <span class="math">M \\in \\mathbb{F}_p^{n \\times m}</span> , the branch number #b of M is</p>

    <p class="text-gray-300">
<span class="math">$#b(M) := \\min_{\\boldsymbol{x} \\in \\mathbb{F}_n^m \\setminus \\{\\mathbf{0}\\}} \\left\\{ \\text{hw}(\\boldsymbol{x}) + \\text{hw}(M\\boldsymbol{x}) \\right\\}.</span>$
(10)</p>

    <p class="text-gray-300">According to Section 5.1, for  <span class="math">t=8,12,\\ldots,24</span> , we have  <span class="math">M\\in\\mathbb{F}_p^{t\\times t}</span>  and  <span class="math">t&#x27;=t/4\\in\\{2,\\ldots,6\\}</span> . Denoting the column vectors of I as  <span class="math">\\boldsymbol{e}_0,\\ldots,\\boldsymbol{e}_3</span> , where  <span class="math">I\\in\\mathbb{F}_p^{4\\times 4}</span>  is the  <span class="math">4\\times 4</span>  identity matrix, we have  <span class="math">I=(\\boldsymbol{e}_0,\\ldots,\\boldsymbol{e}_3)</span> . We also express a random  <span class="math">4\\times 4</span>  MDS matrix A with its column vectors as  <span class="math">\\boldsymbol{a}_0,\\ldots,\\boldsymbol{a}_3</span>  such that  <span class="math">A=(\\boldsymbol{a}_0,\\ldots,\\boldsymbol{a}_3)</span> , or express  <span class="math">A=(a_{i,j})</span> , with its element  <span class="math">a_{i,j}\\in\\mathbb{F}_p</span>  for  <span class="math">0\\leq i,j&lt;4</span> . Then, the  <span class="math">t\\times t</span>  matrix  <span class="math">M\\in\\mathbb{F}_p^{t\\times t}</span>  can be represented as</p>

    <p class="text-gray-300">
<span class="math">$M = \\begin{pmatrix} 2A &amp; A &amp; \\dots &amp; A \\\\ A &amp; 2A &amp; \\dots &amp; A \\\\ \\vdots &amp; &amp; \\ddots &amp; \\vdots \\\\ A &amp; A &amp; \\dots &amp; 2A \\end{pmatrix}.</span>$</p>

    <p class="text-gray-300">With the column vectors</p>

    <p class="text-gray-300"><span class="math">$\\mathbf{x} = (x_{0,0}, \\dots, x_{0,3}, x_{1,0}, \\dots, x_{1,3}, \\dots, x_{t&#x27;-1,0}, \\dots, x_{t&#x27;-1,3})^T,</span>$
(11)</p>

    <p class="text-gray-300"><span class="math">$\\mathbf{y} = (y_{0,0}, \\dots, y_{0,3}, y_{1,0}, \\dots, y_{1,3}, \\dots, y_{t&#x27;-1,0}, \\dots, y_{t&#x27;-1,3})^T</span>$
(12)</p>

    <p class="text-gray-300">over  <span class="math">\\mathbb{F}_p^{4t&#x27;}</span> , according to the definition of the branch number in Eq. (10), there must be vectors  <span class="math">x, y \\in \\mathbb{F}_p^t</span>  satisfying</p>

    <p class="text-gray-300">
<span class="math">$Mx = y, (13)</span>$</p>

    <p class="text-gray-300">
<span class="math">$hw(\\boldsymbol{x}) + hw(\\boldsymbol{y}) = \\#b(M). \\tag{14}</span>$</p>

    <p class="text-gray-300">In the remainder of this part, without specific instructions, we constantly use  <span class="math">\\boldsymbol{x}, \\boldsymbol{y}</span>  to represent the vectors satisfying Eq. (13) and Eq. (14) simultaneously so as to prove  <span class="math">\\#b(M) = \\text{hw}(\\boldsymbol{x}) + \\text{hw}(\\boldsymbol{y}) = t&#x27; + 4</span>  when  <span class="math">t&#x27; = 2, \\dots, 6</span> .</p>

    <p class="text-gray-300">Inequality:  <span class="math">\\#b(M) \\le t&#x27;+4</span> . For arbitrary t', we can easily prove that  <span class="math">\\#b \\le t&#x27;+4</span> . Indeed, it is sufficient to set  <span class="math">x_{0,0} = 1, x_{1,0} = \\cdots = x_{t&#x27;-1,0} = \\frac{-1}{t&#x27;}, (y_{0,0}, \\dots, y_{0,3}) = (a_{0,0}(1-\\frac{1}{t&#x27;}), a_{1,0}(1-\\frac{1}{t&#x27;}), a_{2,0}(1-\\frac{1}{t&#x27;}), a_{3,0}(1-\\frac{1}{t&#x27;}))</span>  and other entries of  <span class="math">\\boldsymbol{x}, \\boldsymbol{y}</span>  equal to 0 so as to satisfy Eq. (13). Therefore, we have  <span class="math">\\#b(M) \\le t&#x27;+4</span> .</p>

    <p class="text-gray-300">Equality: #b(M) = t' + 4. For j = 0, ..., 3, let us define the summation  <span class="math">s_j</span>  and column vectors  <span class="math">\\boldsymbol{x}_j, \\boldsymbol{x}_j&#x27;</span>  as</p>

    <p class="text-gray-300"><span class="math">$s_j = \\sum_{i=0}^{t&#x27;-1} x_{i,j},\\tag{15}</span>$</p>

    <p class="text-gray-300"><span class="math">$\\mathbf{x}_j = (x_{0,j}, \\dots, x_{t&#x27;-1,j})^T,</span>$
(16)</p>

    <p class="text-gray-300">
<span class="math">$\\mathbf{x}_{j} = (x_{0,j}, \\dots, x_{t&#x27;-1,j}) ,</span>$
(10)
<span class="math">\\mathbf{x}_{j}&#x27; = (x_{0,j} + s_{j}, \\dots, x_{t&#x27;-1,j} + s_{j})^{T}.</span>  (17)</p>

    <p class="text-gray-300"></p>

    <p class="text-gray-300">We prove the following lemma.</p>

    <p class="text-gray-300"><strong>Lemma 5.</strong> For  <span class="math">x_j, x_j&#x27;</span>  (j = 0, ..., 3) in Eq. (16) and Eq. (17), when  <span class="math">hw(x_j&#x27;) \\le \\frac{t_j&#x27;}{2}</span> , there is  <span class="math">hw(x_j) \\ge hw(x_j&#x27;)</span> .</p>

    <p class="text-gray-300"><em>Proof.</em> Without loss of generality, we let  <span class="math">x_{i,j} + s_j = 0</span>  for  <span class="math">i = \\lfloor \\frac{t&#x27;}{2} \\rfloor, \\ldots, t&#x27; - 1</span> , and  <span class="math">(x_{0,j} + s_j, \\ldots, x_{\\lfloor \\frac{t&#x27;}{2} \\rfloor - 1, j} + s_j) \\neq \\mathbf{0}</span> .</p>

    <ul class="list-disc list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li>If  <span class="math">s_j = 0</span> , clearly  <span class="math">\\boldsymbol{x}_j = \\boldsymbol{x}_j&#x27;</span>  and  <span class="math">\\text{hw}(\\boldsymbol{x}_j) = \\text{hw}(\\boldsymbol{x}_j&#x27;)</span> .</li>
      <li>If  <span class="math">s_j \\neq 0</span> , we have  <span class="math">x_{i,j} = -s_j \\neq 0</span>  for  <span class="math">i = \\lfloor \\frac{t&#x27;}{2} \\rfloor, \\ldots, t&#x27;-1</span> . Therefore,  <span class="math">\\operatorname{hw}(\\boldsymbol{x}_j) \\geq \\lfloor \\frac{t&#x27;}{2} \\rfloor + 1 \\geq \\frac{t&#x27;}{2} \\geq \\operatorname{hw}(\\boldsymbol{x}_j&#x27;)</span> .</li>
    </ul>

    <p class="text-gray-300">Note that Eq. (13) can be rewritten as</p>

    <p class="text-gray-300"><span class="math">$\\begin{pmatrix} x_{0,0} + s_0 &amp; x_{0,1} + s_1 &amp; x_{0,2} + s_2 &amp; x_{0,3} + s_3 \\\\ x_{1,0} + s_0 &amp; x_{1,1} + s_1 &amp; x_{1,2} + s_2 &amp; x_{1,3} + s_3 \\\\ \\vdots &amp; \\vdots &amp; \\vdots &amp; \\vdots \\\\ x_{t&#x27;-1,0} + s_0 &amp; x_{t&#x27;-1,1} + s_1 &amp; x_{t&#x27;-1,2} + s_2 &amp; x_{t&#x27;-1,3} + s_3 \\end{pmatrix} \\times \\begin{pmatrix} \\boldsymbol{a}_0 \\\\ \\boldsymbol{a}_1 \\\\ \\boldsymbol{a}_2 \\\\ \\boldsymbol{a}_3 \\end{pmatrix}</span>$</p>

    <p class="text-gray-300"><span class="math">$= \\begin{pmatrix} y_{0,0} &amp; y_{0,1} &amp; y_{0,2} &amp; y_{0,3} \\\\ y_{0,0} &amp; y_{0,1} &amp; y_{1,2} &amp; y_{1,3} \\\\ \\vdots &amp; \\vdots &amp; \\vdots &amp; \\vdots \\\\ y_{t&#x27;-1,0} &amp; y_{t&#x27;-1,1} &amp; y_{t&#x27;-1,2} &amp; y_{t&#x27;-1,3} \\end{pmatrix} \\times \\begin{pmatrix} \\boldsymbol{e}_0 \\\\ \\boldsymbol{e}_1 \\\\ \\boldsymbol{e}_2 \\\\ \\boldsymbol{e}_3 \\end{pmatrix}.</span>$</p>

    <p class="text-gray-300">For  <span class="math">j=0,\\ldots,t&#x27;-1</span> , we define  <span class="math">\\boldsymbol{\\alpha}_j=(x_{j,0}+s_0,\\ldots,x_{j,3}+s_3)</span>  and  <span class="math">\\boldsymbol{\\beta}_j=(y_{j,0},\\ldots,y_{j,3})</span> . Since  <span class="math">A=(\\boldsymbol{a}_0,\\ldots,\\boldsymbol{a}_3),\\ \\boldsymbol{\\alpha}_j\\cdot A=\\boldsymbol{\\beta}_j</span> . Following that A is an MDS matrix and its branch number is 5, we have</p>

    <p class="text-gray-300"><span class="math">$hw(\\boldsymbol{\\alpha}_j) + hw(\\boldsymbol{\\beta}_j) = \\begin{cases} 0 &amp; \\text{if } hw(\\boldsymbol{\\alpha}_j) = 0, \\\\ 5 &amp; \\text{otherwise.} \\end{cases}</span>$</p>

    <p class="text-gray-300">Combining the definition of  <span class="math">\\beta_j</span>  and y in Eq. (12), we can deduce</p>

    <p class="text-gray-300">
<span class="math">$hw(\\boldsymbol{y}) = \\sum_{j=0}^{t&#x27;-1} hw(\\boldsymbol{\\beta}_j).</span>$
(18)</p>

    <p class="text-gray-300">Moreover, from Eq. (16) and Eq. (11),  <span class="math">x_0, \\ldots, x_3</span>  form a partition of x such that</p>

    <p class="text-gray-300">
<span class="math">$hw(\\boldsymbol{x}) = \\sum_{j=0}^{3} hw(\\boldsymbol{x}_{j}). \\tag{19}</span>$</p>

    <p class="text-gray-300"><strong>Lemma 6.</strong> If there is only one k = 0, ..., t' - 1 s.t.  <span class="math">\\beta_k \\neq 0</span> , then  <span class="math">hw(\\beta_k) = 4</span> .</p>

    <p class="text-gray-300"><em>Proof.</em> Without loss of generality, we let  <span class="math">\\beta_0 \\neq \\mathbf{0}</span> . In this situation, for arbitrary  <span class="math">j = 0, \\ldots, 3</span>  and  <span class="math">x_{0,j} + s_j \\neq 0</span> , we can prove that  <span class="math">x_{i,j} \\neq 0</span>  for all  <span class="math">i = 0, \\ldots, t&#x27; - 1</span> .</p>

    <ul class="list-disc list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li>If  <span class="math">s_j = 0</span> , there must be  <span class="math">x_{1,j} = \\cdots = x_{t&#x27;-1,j} = 0</span> . However,  <span class="math">x_{0,j} \\neq 0</span>  contradicts the definition of  <span class="math">s_j</span>  in Eq. (15).</li>
      <li>If  <span class="math">s_j \\neq 0</span> , there must be  <span class="math">x_{1,j} = \\cdots = x_{t&#x27;-1,j} = -s_j \\neq 0</span>  and  <span class="math">x_{0,j} = t&#x27;s_j \\neq 0</span>  according to Eq. (15). Therefore,  <span class="math">\\text{hw}(\\boldsymbol{x})</span>  can be computed as  <span class="math">\\text{hw}(\\boldsymbol{x}) = t&#x27; \\cdot \\text{hw}(\\boldsymbol{\\alpha}_0)</span> . There is also  <span class="math">\\text{hw}(\\boldsymbol{\\beta}_0) + \\text{hw}(\\boldsymbol{\\alpha}_0) \\geq 5</span> . Therefore, we have</li>
    </ul>

    <p class="text-gray-300"><span class="math">$\\#b(M) = \\mathrm{hw}(\\boldsymbol{x}) + \\mathrm{hw}(\\boldsymbol{y}) = t&#x27; \\cdot \\mathrm{hw}(\\boldsymbol{\\alpha}_0) + \\mathrm{hw}(\\boldsymbol{\\beta}_0) \\ge (t&#x27;-1) \\cdot \\mathrm{hw}(\\boldsymbol{\\alpha}_0) + 5.</span>$</p>

    <p class="text-gray-300">Since  <span class="math">\\#b(M) \\le t&#x27; + 4</span> ,  <span class="math">\\text{hw}(\\boldsymbol{\\alpha}_0) = 1</span>  is the only solution when  <span class="math">t&#x27; \\ge 2</span> . It follows that  <span class="math">\\text{hw}(\\boldsymbol{\\beta}_0) = 4</span> .</p>

    <p class="text-gray-300"><strong>Theorem 1.</strong> For  <span class="math">2 \\le t&#x27; \\le 6</span> , the branch number of M is #b(M) = t' + 4.</p>

    <p class="text-gray-300"><em>Proof.</em> Let  <span class="math">\\eta</span>  be the number of nonzero  <span class="math">\\beta_i</span> 's  <span class="math">(j = 0, 1, \\dots, t&#x27; - 1)</span> .</p>

    <ul class="list-disc list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li>If  <span class="math">1 \\leq \\frac{t&#x27;}{2} &lt; \\eta \\leq t&#x27;</span> , there must be some  <span class="math">0 \\leq j \\leq 3</span>  such that  <span class="math">\\text{hw}(\\boldsymbol{x}_j) &gt; 0</span> . Without loss of generality, let  <span class="math">\\boldsymbol{\\beta}_0, \\dots, \\boldsymbol{\\beta}_{\\eta-1}</span>  be the  <span class="math">\\eta</span>  nonzero vectors. In the following we consider four cases depending on the number of nonzero  <span class="math">\\boldsymbol{x}_j</span> 's.    <ul class="list-disc list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li><ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li>There is just one j such that  <span class="math">x_j \\neq 0</span> . There must be  <span class="math">x&#x27;_j \\neq 0</span>  and  <span class="math">\\operatorname{hw}(y) = 4\\eta</span> . If  <span class="math">s_j = 0</span> , we have  <span class="math">\\operatorname{hw}(x_j) = \\operatorname{hw}(x&#x27;_j) = \\eta \\geq t&#x27; \\eta + 1</span>  and that  <span class="math">\\operatorname{hw}(x) + \\operatorname{hw}(y) = \\#b(M) = 5\\eta \\geq 10</span> , contradicting  <span class="math">\\#b(M) \\leq t&#x27; + 4</span> . If  <span class="math">s_j \\neq 0</span> , we have  <span class="math">a_{\\eta,j} = \\cdots = a_{t&#x27;-1,j} = -s_j \\neq 0</span> ,  <span class="math">a_{0,j} \\neq 0</span> . We have  <span class="math">\\operatorname{hw}(x) + \\operatorname{hw}(y) \\geq t&#x27; + 3\\eta + 1 &gt; t&#x27; + 4</span> , contradicting  <span class="math">\\#b(M) \\leq t&#x27; + 4</span> .</li>
    </ol></li>
      <li><ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li>There exist two j's such that  <span class="math">x_j \\neq 0</span> . Then there must be  <span class="math">x&#x27;_j \\neq 0</span>  and  <span class="math">\\text{hw}(y) \\geq 3\\eta</span> . Moreover, there is constantly  <span class="math">\\text{hw}(x_j) \\geq t&#x27; \\eta + 1</span> . We have  <span class="math">\\text{hw}(x) + \\text{hw}(y) \\geq 2t&#x27; + \\eta + 2 \\geq \\frac{5t&#x27;}{2} + 2</span> , contradicting  <span class="math">\\#b(M) \\leq t&#x27; + 4</span> .</li>
    </ol></li>
      <li><ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li>There exist three j's such that  <span class="math">\\bar{x_j} \\neq 0</span> . Then there must be  <span class="math">x&#x27;_j \\neq 0</span>  and  <span class="math">\\text{hw}(y) \\geq 2\\eta</span> . Moreover, there is constantly  <span class="math">\\text{hw}(x_j) \\geq t&#x27; \\eta + 1</span> . We have  <span class="math">\\text{hw}(x) + \\text{hw}(y) \\geq 3t&#x27; \\eta + 3 \\geq 2t&#x27; + 3</span> , contradicting  <span class="math">\\#b(M) \\leq t&#x27; + 4</span> .</li>
    </ol></li>
    </ul></li>
    </ul>

    <ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li>For all j = 0, 1, 2, 3,  <span class="math">x_j \\neq 0</span> . There must be  <span class="math">x&#x27;_j \\neq 0</span>  and  <span class="math">hw(y) \\geq \\eta</span> . Moreover, there is constantly  <span class="math">hw(x_j) \\ge t&#x27; - \\eta + 1</span> . We have hw(x) + 1 <span class="math">hw(y) \\ge 4t&#x27; - 3\\eta + 4 \\ge t&#x27; + 4</span> . Adding the constraint that #b(M) = <span class="math">hw(x) + hw(y) \\le t&#x27; + 4</span> , the only solution is #b(M) = t' + 4 and it can only be acquired when  <span class="math">\\eta = t&#x27;</span> , hw(y) = t', and  <span class="math">hw(x_i) = 1</span>  are all</li>
    </ol>

    <ul class="list-disc list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li><p class="text-gray-300">Therefore, for  <span class="math">\\eta &gt; \\frac{t&#x27;}{2}</span> , the branch number can only be #b(M) = t' + 4.</p>

    <p class="text-gray-300">If  <span class="math">\\eta \\leq \\frac{t&#x27;}{2}</span> , we have  <span class="math">\\text{hw}(\\boldsymbol{x}_j&#x27;) \\leq \\eta \\leq \\frac{t&#x27;}{2}</span>  for all  <span class="math">j = 0, \\ldots, 3</span> . It can be deduced from Lemma 5 that  <span class="math">\\text{hw}(\\boldsymbol{x}_j) \\geq \\text{hw}(\\boldsymbol{x}_j&#x27;)</span>  and according to Eq. (18) and Eq. (19), there is  <span class="math">\\#b \\geq 5\\eta</span> . Adding the constraint that  <span class="math">\\#b(M) \\leq t&#x27; + 4</span> , all possible solutions are the following.</p>

    <ul class="list-disc list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li><ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li>For t'=6, we have  <span class="math">\\eta=1</span>  and  <span class="math">\\eta=2</span> . For  <span class="math">\\eta=1</span>  and t'=6, with Lemma 6, we have  <span class="math">hw(\\boldsymbol{x}) + hw(\\boldsymbol{y}) = t&#x27; + 4 = 10</span> . For  <span class="math">\\eta = 2</span>  and t' = 6, we have  <span class="math">hw(x) + hw(y) \\ge 5\\eta = 10</span> . Therefore, there is #b(M) = t' + 4</li>
    </ol></li>
      <li><ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li>For  <span class="math">2 \\le t&#x27; &lt; 6</span> , there is only one satisfying value  <span class="math">\\eta = 1</span> . So #b(M) = t' + 4is the direct application of Lemma 6.</li>
    </ol></li>
    </ul></li>
    </ul>

    <p class="text-gray-300">To sum up, #b(M) = t' + 4 for all 2 &lt; t' &lt; 6.</p>

    <p class="text-gray-300">To verify the result of rebound attacks on GRIFFIN- <span class="math">\\pi</span>  in Section 6.1, we set up a dedicated mixed integer linear programming (MILP) tool to look for the maximal number of rounds that rebound attack can mount based on truncated differentials [21].</p>

    <p class="text-gray-300">The MILP approach is widely used to derive differential and linear bounds for symmetric primitives [26, 24, 4, 3, 31]. For example, in truncated differential MILP models, a model  <span class="math">\\mathcal{M}</span>  is constructed to describe the truncated differential patterns with the highest probability. First, truncated word differences are represented in  <span class="math">\\mathcal{M}</span>  as binary variables denoted as  <span class="math">\\mathcal{M}</span> .var: 0 for zero differences (also known as <em>inactive</em>) and 1 for nonzero ones (also known as <em>active</em>). Then, the truncated differential propagation rules are described as the linear constraints denoted as  <span class="math">\\mathcal{M}</span> .con. Finally, the objective function  <span class="math">\\mathcal{M}</span> .obj is set so as to upperbound the propagation probability. In the context of rebound attacks, the  <span class="math">\\mathcal{M}.obj</span> is set differently, as we show in details here.</p>

    <p class="text-gray-300">The rebound attacks we considered for GRIFFIN- <span class="math">\\pi</span>  are based on the truncated differentials, therefore the core of our dedicated tool is the construction of MILP models  <span class="math">\\mathcal{M}</span>  capturing the truncated differential propagation of GRIFFIN- <span class="math">\\pi</span> . In the round function  <span class="math">\\mathcal{F}_i(\\cdot) = c^{(i)} + M \\times S(\\cdot)</span> , the round constant addition operation with  <span class="math">c^{(i)}</span>  does not change the difference propagation, so we omit it in the MILP model to simplify the differential propagation of the <em>i</em>-th round as follows:</p>

    <p class="text-gray-300"><span class="math">$\\varDelta X^{(i)} \\xrightarrow{S} \\varDelta Y^{(i)} \\xrightarrow{M} \\varDelta Z^{(i)} \\triangleq \\varDelta X^{(i+1)}.</span>$</p>

    <p class="text-gray-300">The truncated differences of &#8710;X(i) , &#8710;Y (i) and &#8710;Z(i) are represented in the model M as follows:</p>

    <p class="text-gray-300"><span class="math">$\\Delta X^{(i)} = (\\delta_{x_0^{(i)}}, \\dots, \\delta_{x_{t-1}^{(i)}}) \\xrightarrow{S} \\Delta Y^{(i)} = (\\delta_{y_0^{(i)}}, \\dots, \\delta_{y_{t-1}^{(i)}}) \\xrightarrow{M} \\Delta Z^{(i)} = (\\delta_{z_0^{(i)}}, \\dots, \\delta_{z_{t-1}^{(i)}}), \\dots, \\delta_{z_{t-1}^{(i)}}</span>$</p>

    <p class="text-gray-300">where &delta;'s &isin; M.var are binary variables: &delta; = 1 for nonzero difference and &delta; = 0 for zero ones. When the context allows, we omit the index.</p>

    <p class="text-gray-300">Common MILP Constraints on Linear Components. Before explaining the dedicated tool for the rebound attacks, we first introduce our method of modeling the truncated differential propagation for the linear layer M of Griffin-&pi;, which is commonly used in constructing truncated differential MILP models.</p>

    <p class="text-gray-300">MILP Models for Linear Combinations. Let the linear step be z = x + y. It follows exactly the truncated differential propagation rule of ordinary linear combinations, so the available values for (&delta;z, &delta;x, &delta;y) can be easily deduced in Table <a href="#page-44-0">7</a> and can be captured by the MILP model as Eq. <a href="#page-44-1">(20)</a> originated in <a href="#page-55-6">[28]</a>.</p>

    <p class="text-gray-300">Table 7: All possible truncated difference values for the linear step z = x + y.</p>

    <div class="overflow-x-auto my-4">
      <table class="min-w-full text-sm text-gray-300">
        <thead>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">&delta;z</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">&delta;x</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">&delta;y</th>
        </thead>
        <tbody>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">0</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">0</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">0</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">0</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">0</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">0</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1</td>
          </tr>
        </tbody>
      </table>
    </div>

    <p class="text-gray-300"><span class="math">$\\mathcal{M}.\\text{var} \\leftarrow \\delta_x, \\delta_y, \\delta_z \\text{ are binary},</span>$</p>

    <p class="text-gray-300"><span class="math">$\\begin{pmatrix} \\delta_x + \\delta_y - \\delta_y &gt; 0 \\end{pmatrix}</span>$</p>

    <p class="text-gray-300">
<span class="math">$\\mathcal{M}.\\operatorname{con} \\leftarrow \\begin{cases} \\delta_x + \\delta_y - \\delta_z \\ge 0, \\\\ \\delta_x - \\delta_y + \\delta_z \\ge 0, \\\\ -\\delta_x + \\delta_y + \\delta_z \\ge 0. \\end{cases}</span>$
(20)</p>

    <p class="text-gray-300">Note that Eq. <a href="#page-44-1">(20)</a> is the classical MILP description of the truncated differential propagation rule of the ordinary linear combinations. For simplicity, we use Eq. <a href="#page-44-2">(21)</a> to represent the constraints in Eq. <a href="#page-44-1">(20)</a>:</p>

    <p class="text-gray-300">
<span class="math">$\\mathcal{M}.\\mathsf{con} \\leftarrow (\\delta_x, \\delta_y, \\delta_z)_+.</span>$
(21)</p>

    <p class="text-gray-300">MILP Models for Matrix M. Assume the truncated input and output differences of M in the r-th round are &#8710;Y (r) = (&delta;<sup>y</sup><sup>0</sup> , . . . , &delta;<sup>y</sup>t&minus;<sup>1</sup> ) and &#8710;X(r+1) = &#8710;Z(r) = (&delta;<sup>z</sup><sup>0</sup> , . . . , &delta;<sup>z</sup>t&minus;<sup>1</sup> ). For t &isin; {3, 4}, the corresponding M are MDS matrices, so the relationship between &#8710;Y (r) and &#8710;Z(r) can be described simply with the knowledge of the branch number #b(M) = t + 1. The description of the MILP model in this situation is as Eq. <a href="#page-45-0">(22)</a>, where d<sup>M</sup> is a dummy binary variable.</p>

    <p class="text-gray-300"><span class="math">\\mathcal{M}.\\text{var} \\leftarrow \\delta_{y_i}, \\delta_{z_i}, d_M \\text{ as binaries},</span></p>

    <p class="text-gray-300">
<span class="math">$\\mathcal{M}.\\operatorname{con} \\leftarrow \\begin{cases} d_{M} \\leq \\sum_{i=0}^{t-1} \\delta_{y_{i}}, \\sum_{i=0}^{t-1} \\delta_{z_{i}} \\leq t \\cdot d_{M}, \\\\ \\mathcal{M}.\\operatorname{con} \\leftarrow \\sum_{i=0}^{t-1} \\delta_{y_{i}} + \\sum_{i=0}^{t-1} \\delta_{z_{i}} \\geq \\#b(M) \\cdot d_{M}. \\end{cases}</span>$</p>

    <p class="text-gray-300"><span class="math">$(22)</span>$</p>

    <p class="text-gray-300">For  <span class="math">t=4t&#x27;\\geq 8</span> , according to Eq. (7), the linear layer M has branch number #b(M)=t'+4 and can be decomposed as  <span class="math">M&#x27;&#x27;\\times M&#x27;</span> . The branch number property of M can easily be captured by Eq. (22). However, we introduce a new method of describing the decomposition property of M, aiming at deriving more accurate bounds. First, We use an additional variable  <span class="math">\\Delta W^{(r)}</span>  to represent the output truncated difference of M':</p>

    <p class="text-gray-300"><span class="math">$\\Delta Y^{(r)} \\xrightarrow{M&#x27;} \\Delta W^{(r)} \\xrightarrow{M&#x27;&#x27;} \\Delta Z^{(r)}</span>$
.</p>

    <p class="text-gray-300">According to the definition of M', the transformation from  <span class="math">\\Delta Y^{(r)}</span>  to  <span class="math">\\Delta W^{(r)}</span>  can be regarded as t' parallel  <span class="math">4 \\times 4</span>  linear layers, each of which can be described as Eq. (22) with branch number #b(M) = 5. Next, we introduce and combine two methods to describe the truncated differential propagation of M''.</p>

    <p class="text-gray-300">&ndash; Assume  <span class="math">\\Delta W^{(r)} = (\\delta_{w_0}, \\dots, \\delta_{w_{t-1}})</span> . The transformation  <span class="math">\\Delta W^{(r)} \\to \\Delta Z^{(r)}</span>  is additions of words over  <span class="math">\\mathbb{F}_p</span> , so the truncated differential propagation of each word addition can be described by equations in Eq. (20) directly:</p>

    <p class="text-gray-300"><span class="math">$\\mathcal{M}.\\mathsf{con} \\leftarrow (\\delta_{w_i}, \\delta_{w_{i+4}}, \\dots, \\delta_{w_{i+t-4}}, \\delta_{z_i})_+, i = 0, 1, 2, 3; j = i+4 \\cdot k, k = 0, \\dots, t/4-1.</span>$</p>

    <p class="text-gray-300">&ndash; In order to get the tighter bounds, we further decompose M'' as  <span class="math">M&#x27;&#x27; = \\operatorname{circ}(2 \\cdot I, I, \\dots, I) = \\operatorname{circ}(I, I, \\dots, I) + \\operatorname{circ}(I, 0, \\dots, 0) = M_1 + M_2</span> . We express the truncated differential propagation of  <span class="math">M_1</span>  and  <span class="math">M_2</span>  in two steps. Note they follow the propagation rules of ordinary linear combinations, after defining four dummy binary variables  <span class="math">\\delta_{\\operatorname{tmp}_i}</span>  for i = 0, 1, 2, 3, we can use the two MILP descriptions in Eq. (20) to respectively describe them:</p>

    <p class="text-gray-300"><span class="math">$\\mathcal{M}.\\mathsf{con} \\leftarrow \\begin{cases} (\\delta_{w_i}, \\delta_{w_{i+4}}, \\dots, \\delta_{w_{t-4}}, \\delta_{\\mathsf{tmp}_i})_+, &amp; i = 0, 1, 2, 3 \\\\ (\\delta_{w_j}, \\delta_{\\mathsf{tmp}_{(j \\bmod 4)}}, \\delta_{z_j})_+, &amp; j = 0, 1, \\dots, t-1 \\end{cases}</span>$</p>

    <p class="text-gray-300">Finally, we take the maximal value of the objective function of the models using two descriptions. In this way, the differential bound of Griffin- <span class="math">\\pi</span>  can be derived in a more precise manner than simply considering the branch number #b(M)=t'+4 of M.</p>

    <p class="text-gray-300">Word Conditions in Inbound and Outbound Phases. Unlike in differential attacks where only the nonlinear operations contribute to the DP of differentials, in rebound attacks, the complexities are decided by the number of word conditions which can be imposed by both nonlinear and linear operations.</p>

    <p class="text-gray-300">ticular differential propagations can only happen when the corresponding word conditions are satisfied. The word conditions lying in the inbound phase can be satisfied manually with the message modification technique for free while those in the outbound phase can only be satisfied randomly with probability  <span class="math">p^{-1}</span> . In our model, for any operation  <span class="math">f: \\mathbb{F}_p^m \\to \\mathbb{F}_p</span> , a word condition is imposed when such differential propagation  <span class="math">\\mathbf{0} \\neq \\Delta I \\xrightarrow{f} \\Delta O = 0</span>  appears. Such a word condition is tracked in  <span class="math">\\mathcal{M}</span>  with a binary variable. If the word condition lies in the inbound phase, the binary variable has the value 0. Otherwise, it has the value 1. Furthermore, the inbound-outbound manner of rebound attacks considers both forward and backward directions, so the corresponding word condition deduction should involve not only S and M, but their inverses  <span class="math">S^{-1}</span>  and  <span class="math">M^{-1}</span>  as well. For clear interpretation, we use binary variables  <span class="math">\\tau</span> 's to track the word conditions in the nonlinear layer S,  <span class="math">S^{-1}</span>  and  <span class="math">\\mu</span> 's for those in the linear layer M,  <span class="math">M^{-1}</span> . Details are provided in the following.</p>

    <p class="text-gray-300">Word conditions are actually equations of words or word differences because par-</p>

    <p class="text-gray-300">MILP Models for Conditions in S. The nonlinear layer S of Griffin- <span class="math">\\pi</span>  is composed of four nonlinear operations, namely</p>

    <p class="text-gray-300"><span class="math">$x_0 \\mapsto {x_0}^{1/d} = y_0, \\ x_1 \\mapsto {x_1}^d = y_1, \\ (\\ell, x_i) \\mapsto x_i \\cdot (\\ell^2 + \\alpha \\ell + \\beta) = y_i \\text{ for } 2 \\le i \\le t - 1,</span>$</p>

    <p class="text-gray-300">where  <span class="math">\\ell</span>  is a linear function of the first two words  <span class="math">y_0</span>  and  <span class="math">y_1</span>  for i=2, and another linear function of three words  <span class="math">y_0</span> ,  <span class="math">y_1</span>  and  <span class="math">x_{i-1}</span>  for  <span class="math">3 \\le i \\le t-1</span> .</p>

    <p class="text-gray-300">For i=0,1, there is constantly  <span class="math">\\delta_{y_i}=\\delta_{x_i}</span>  and no word condition is introduced, so we set  <span class="math">\\tau_i=0\\in\\mathcal{M}.\\mathsf{con}</span> . For  <span class="math">i=2,\\ldots,t-1</span> , we discuss cases depending on values of  <span class="math">(\\delta_\\ell,\\delta_{x_i},\\delta_{y_i})</span> .</p>

    <ul class="list-disc list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li><span class="math">(\\delta_{\\ell}, \\delta_{x_i}, \\delta_{y_i}) \\in \\{(1, 1, 1), (0, 0, 0), (0, 1, 1)\\}</span> : no word condition is introduced, so we set  <span class="math">\\tau_i = 0</span> .</li>
      <li><span class="math">(\\delta_{\\ell}, \\delta_{x_i}, \\delta_{y_i}) = (1, 0, 0)</span> : one word condition is introduced as  <span class="math">x_i = 0</span> , so we set  <span class="math">\\tau_i = 1</span> .</li>
      <li><span class="math">-(\\delta_{\\ell}, \\delta_{x_i}, \\delta_{y_i}) = (1, 1, 0)</span> : one word condition is introduced from  <span class="math">\\delta_{y_i} = 0</span>  as</li>
    </ul>

    <p class="text-gray-300"><span class="math">$(x_i + \\delta_{x_i})[(\\ell + \\delta_{\\ell})^2 + \\alpha_i(\\ell + \\delta_{\\ell}) + \\beta_i] - x_i(\\ell^2 + \\alpha_i\\ell + \\beta_i) = 0,</span>$</p>

    <p class="text-gray-300">so we set  <span class="math">\\tau_i = 1</span> .</p>

    <p class="text-gray-300">We summarize all possible values for  <span class="math">(\\delta_{\\ell}, \\delta_{x_i}, \\delta_{y_i}, \\tau_i)</span>  in Table 8. The relations of  <span class="math">\\delta_{\\ell}, \\delta_{x_i}, \\delta_{y_i}, \\tau_i</span>  can be represented in a MILP model as</p>

    <p class="text-gray-300"><span class="math">$\\begin{split} \\mathcal{M}.\\text{var} &amp;\\leftarrow \\!\\! \\delta_\\ell, \\delta_{x_i}, \\delta_{y_i}, \\tau_i \\text{ as binaries,} \\\\ \\mathcal{M}.\\text{con} &amp;\\leftarrow \\!\\! - \\delta_{y_i} - \\tau_i + 1 \\geq 0, \\\\ \\mathcal{M}.\\text{con} &amp;\\leftarrow \\!\\! - \\delta_\\ell + \\delta_{y_i} + \\tau_i \\geq 0, \\\\ \\mathcal{M}.\\text{con} &amp;\\leftarrow \\!\\! - \\delta_\\ell + \\delta_{x_i} - \\delta_{y_i} - \\tau_i \\geq 0, \\\\ \\mathcal{M}.\\text{con} &amp;\\leftarrow \\!\\! - \\delta_\\ell - \\tau_i \\geq 0, \\\\ \\mathcal{M}.\\text{con} &amp;\\leftarrow \\!\\! - \\delta_{x_i} + \\delta_{y_i} + \\tau_i \\geq 0. \\end{split}</span>$</p>

    <p class="text-gray-300"><sup>&amp;</sup>lt;sup&gt;24</sup> Such a technique is widely used in collision attacks of hash functions [30].</p>

    <p class="text-gray-300">Table 8: All possible values of  <span class="math">(\\delta_{\\ell}, \\delta_{x_i}, \\delta_{y_i}, \\tau_i)</span>  for S and  <span class="math">(\\delta_{\\ell}, \\delta_{y_i}, \\delta_{x_i}, \\tau_i)</span>  for  <span class="math">S^{-1}</span> .</p>

    <div class="overflow-x-auto my-4">
      <table class="min-w-full text-sm text-gray-300">
        <thead>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"><span class="math">\\delta_\\ell</span></th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"><span class="math">\\delta_{x_i}</span> ,</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"><span class="math">\\delta_{y_i}</span></th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"><span class="math">\\tau_i</span></th>
        </thead>
        <tbody>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">0</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">0</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">0</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">0</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">0</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">0</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">0</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">0</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">0</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">0</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">0</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">0</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
        </tbody>
      </table>
    </div>

    <p class="text-gray-300">MILP Models for Conditions in  <span class="math">S^{-1}</span> . Since  <span class="math">x_0 = y_0^d</span>  and  <span class="math">x_1 = y_1^{1/d}</span> , there is constantly  <span class="math">\\delta_{y_i} = \\delta_{x_i}</span> , no condition is introduced for i = 0, 1. For  <span class="math">i = 2, \\ldots, t-1</span> , similarly to the situation for S, several cases of word conditions can be identified depending on  <span class="math">(\\delta_\\ell, \\delta_{y_i}, \\delta_{x_i})</span> . An additional binary variable  <span class="math">\\tau_i</span>  is also used to represent the number of word conditions for the tuple  <span class="math">(\\delta_\\ell, \\delta_{y_i}, \\delta_{x_i})</span> . We find that values of  <span class="math">(\\delta_\\ell, \\delta_{y_i}, \\delta_{x_i}, \\tau_i)</span>  for  <span class="math">S^{-1}</span>  are exactly the same as those of  <span class="math">(\\delta_\\ell, \\delta_{x_i}, \\delta_{y_i}, \\tau_i)</span>  for S, and they are already given in Table 8.</p>

    <p class="text-gray-300">MILP Models for Conditions in M. We recall the MILP description of the differential propagation of M as  <span class="math">\\Delta Y^{(i)} \\xrightarrow{M} \\Delta Z^{(i)}</span> . Omitting the index of the round, we have  <span class="math">(\\delta_{y_0}, \\ldots, \\delta_{y_{t-1}}) \\xrightarrow{M} (\\delta_{z_0}, \\ldots, \\delta_{z_{t-1}})</span> . The extra word conditions for M are introduced when cancellation happens. Let the matrix of M be  <span class="math">(a_{i,j})_{t \\times t}</span> . If  <span class="math">\\delta_{z_i} = 0</span> , one word condition is introduced as</p>

    <p class="text-gray-300"><span class="math">$\\sum_{j=0}^{t-1} (a_{i,j} \\cdot \\delta_{y_j}) = 0.</span>$</p>

    <p class="text-gray-300">We use a binary variable  <span class="math">\\mu_i</span>  to represent the number of word conditions introduced by  <span class="math">\\delta_{z_i}</span>  as follows.</p>

    <ul class="list-disc list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li><ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li>We add two variables  <span class="math">\\mathcal{M}.var \\leftarrow \\mu_i, d_M</span>  as binaries.</li>
    </ol></li>
      <li><ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li>For j = 0, ..., t 1, if  <span class="math">a_{i,j} \\neq 0</span> , we add a constraint  <span class="math">\\mathcal{M}.\\mathsf{con} \\leftarrow d_M \\geq \\delta_{u_j}</span> .</li>
    </ol></li>
      <li><ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li>We add a constraint  <span class="math">\\mathcal{M}.\\text{con} \\leftarrow \\mu_i = d_M \\delta_{z_i}</span> .</li>
    </ol></li>
    </ul>

    <p class="text-gray-300">MILP Models for Conditions in  <span class="math">M^{-1}</span> . For  <span class="math">M^{-1}</span> , we denote the corresponding matrix as  <span class="math">(b_{i,j})_{t\\times t}</span> . If  <span class="math">\\delta_{y_i}=0</span> , one word condition is introduced as</p>

    <p class="text-gray-300"><span class="math">$\\sum_{j=0}^{t-1} (b_{i,j} \\cdot \\delta_{z_j}) = 0.</span>$</p>

    <p class="text-gray-300">The number of word condition introduced by  <span class="math">\\delta_{y_i}</span>  can be modeled as follows.</p>

    <ul class="list-disc list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li><ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li>We add two variables  <span class="math">\\mathcal{M}.var \\leftarrow \\mu_i, d_M</span>  as binaries.</li>
    </ol></li>
      <li><ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li>For j = 0, ..., t 1, if  <span class="math">b_{i,j} \\neq 0</span>  we add a constraint  <span class="math">\\mathcal{M}.\\mathsf{con} \\leftarrow d_M \\geq \\delta_{z_j}</span> .</li>
    </ol></li>
      <li><ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li>We add a constraint  <span class="math">\\mathcal{M}.\\mathsf{con} \\leftarrow \\mu_i = d_M \\delta_{y_i}</span> .</li>
    </ol></li>
    </ul>

    <p class="text-gray-300">Secure Bounds against Rebound Attacks. In rebound attacks, the adversary aims at constructing a pair of intermediate states at round  <span class="math">r_m</span>  ( <span class="math">1 \\le r_m \\le R-1</span> ), denoted as  <span class="math">(Y^{(r_m)}, \\hat{Y}^{(r_m)})</span> , having nonzero truncated difference  <span class="math">\\Delta Y^{(r_m)}</span>  whose truncated differential propagation follows some predefined characteristic  <span class="math">\\Delta X^{(0)} \\xrightarrow{\\mathcal{F}^R} \\Delta X^R</span> , where  <span class="math">\\mathcal{F}^R</span>  represent R-round of  <span class="math">\\mathcal{F}</span> .</p>

    <p class="text-gray-300">According to the parameters in Table 2, we require c words in  <span class="math">\\Delta X^{(0)}</span>  and  <span class="math">\\left\\lfloor \\frac{\\kappa}{\\log_2 p} \\right\\rfloor</span>  words in  <span class="math">\\Delta X^{(R)}</span>  are 0. Reflected to the MILP model  <span class="math">\\mathcal{M}</span> , we add the following constraints:</p>

    <p class="text-gray-300"><span class="math">$\\begin{split} \\mathcal{M}.\\mathrm{con} \\leftarrow &amp; \\sum_{i=0}^{t-1} \\delta_{x_i^{(0)}} \\leq t - c, \\\\ \\mathcal{M}.\\mathrm{con} \\leftarrow &amp; \\sum_{i=0}^{t-1} \\delta_{x_i^{(R)}} \\leq t - \\left\\lfloor \\frac{\\kappa}{\\log_2 p} \\right\\rfloor. \\end{split}</span>$</p>

    <p class="text-gray-300">We further assume that all the word conditions between  <span class="math">\\Delta Y^{(r_m-1)}</span>  and  <span class="math">\\Delta Y^{(r_m+1)}</span>  can manually be satisfied by modifying words in  <span class="math">Y^{(r_m)}</span> . This has upper-bounded the power of the message modification technique [30] because each word can only be used once and can hardly modify words after S layers. Therefore, the objective function of the MILP model can be defined as follows:</p>

    <p class="text-gray-300"><span class="math">$\\mathcal{M}.\\mathtt{obj} \\leftarrow \\min \\left( \\sum_{i \\leq r_m - 1 \\bigvee i &gt; r_m + 1} \\sum_{j=1}^{t-1} \\tau_j^{(i)} \\right. \\\\ \\left. + \\sum_{i &lt; r_m - 1 \\bigvee i \\geq r_m + 1} \\sum_{j=0}^{t-1} \\mu_j^{(i)} \\right).</span>$</p>

    <p class="text-gray-300">For  <span class="math">r_m = 1, ..., R-1</span> , we construct the model for the  <span class="math">r_m</span> -th round, and the solution is the minimum number of unfixed word conditions, denoted as  <span class="math">\\theta_{R,r_m} = \\mathcal{M}.\\mathtt{obj}</span> . If the condition</p>

    <p class="text-gray-300"><span class="math">$\\left| \\frac{\\kappa}{\\log_2 p} \\right| \\le \\min_{1 \\le r_m \\le R - 1} \\theta_{R, r_m}</span>$</p>

    <p class="text-gray-300">holds for all  <span class="math">r_m</span>  settings, we know that R rounds are sufficient to resist rebound attacks. Otherwise, we may update  <span class="math">R \\leftarrow R + 1</span>  to the model and repeat the process. In this way, we are able to acquire the secure bound.</p>

    <p class="text-gray-300">The number of rounds required to resist rebound attacks for values of p we focus on are listed in Table 9. We claim that it is not possible to mount a rebound attack on more than 3 rounds of GRIFFIN- <span class="math">\\pi</span> . Equivalently, 4 rounds are sufficient for providing security against this attack.</p>

    </section>

    <section id="app-e" class="mb-10">
      <h2 class="text-2xl font-bold">E Algebraic Attacks &ndash; Details</h2>

      <h3 id="app-e.1" class="text-xl font-semibold mt-8">E.1 Density of Griffin- <span class="math">\\pi</span></h3>

    <p class="text-gray-300">Since the only high-degree nonlinear function of GRIFFIN- <span class="math">\\pi</span>  is  <span class="math">x \\mapsto x^{1/d}</span> , it is important to analyze the density of the construction, and in particular the density of the polynomials in each word. First, note that we apply a linear layer in</p>

    <p class="text-gray-300">Table 9: Secure instances of GRIFFIN- <span class="math">\\pi</span>  considering only rebound attacks. The best setting corresponding to R is always  <span class="math">r_m=1</span> , which indicates that any start-from-the-middle strategy  <span class="math">(r_m&gt;1)</span>  cannot provide a result better than a pure random search.</p>

    <div class="overflow-x-auto my-4">
      <table class="min-w-full text-sm text-gray-300">
        <thead>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"><span class="math">\\lceil \\log_2 p \\rceil</span></th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"><span class="math">\\kappa</span></th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">c</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">t</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">R</th>
        </thead>
        <tbody>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">32<br>32</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">\\frac{128}{256}</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">8<br>16</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">3<br>3</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">64<br>64</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">128<br>256</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">4<br>8</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">\\geq 8</span><br><span class="math">\\geq 12</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">3</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">128<br>128</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">128<br>256</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">2<br>4</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">3,4,\\geq 8 \\\\ \\geq 8</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">3</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">256<br>256</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">128<br>256</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1<br>2</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">3, 4, \\ge 8</span><br><span class="math">3, 4, \\ge 8</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">3</td>
          </tr>
        </tbody>
      </table>
    </div>

    <p class="text-gray-300">the beginning, in order to ensure that the variables are mixed before the first nonlinear operation in the sponge setting. Hence, the input  <span class="math">x_1</span>  to the nonlinear function in the second word is a linear combination of all input variables. In practice, we evaluated  <span class="math">x \\mapsto x^{1/d}</span>  and found that it provides (almost) full density over  <span class="math">\\mathbb{F}_p</span> . This behaviour was also observed after a small number of rounds in multiple words for different t due to the mixing. Moreover, we compared GRIF-FIN- <span class="math">\\pi</span>  to the Rescue permutation and could not find any significant differences regarding the polynomial density. Thus, we claim that the polynomial representation of our construction is dense after 3 rounds, and in particular with the round numbers we propose (e.g.,  <span class="math">R \\geq 6</span>  for statistical attacks).</p>

      <h3 id="app-e.2" class="text-xl font-semibold mt-8">E.2 Practical Results for Gr&ouml;bner Bases</h3>

    <p class="text-gray-300"><strong>Intermediate Variables.</strong> Concrete data points for practical Gr&ouml;bner basis computations when introducing t intermediate variables in each round are shown in Fig. 3 for d=3 and in Fig. 4 for d=5. The theoretical estimation for the degree of regularity is given by</p>

    <p class="text-gray-300"><span class="math">$D_{\\text{reg}} = 1 + \\sum_{i=1}^{n_e} (\\deg(f_i) - 1) = 1 + R(2(d-1)) + 2(t-2)).</span>$</p>

    <p class="text-gray-300"><strong>Partial Intermediate Variables.</strong> Concrete data points for practical Gr&ouml;bner basis computations when introducing 1 intermediate variable in each round in order to avoid the high-degree growth are shown in Fig. 5 for d = 3 and in Fig. 6 for d = 5. Since the degree of the equation in the (i - 1)-th round is  <span class="math">\\deg(R_{i-1})</span></p>

    <p class="text-gray-300"><sup>&amp;</sup>lt;sup&gt;25</sup> Skipping this linear layer would only delay the variable mixing for one single round.</p>

    <p class="text-gray-300">    <img src="_page_50_Figure_0.jpeg" alt="" class="my-4 max-w-full" />
</p>

    <p class="text-gray-300">Fig. 3: Comparison of the theoretical estimation Dreg for d = 3, t = 3, the adapted estimation D (1) est using the practical results, and concrete data points from our practical tests with Sage (degree growth is the same in Magma).</p>

    <p class="text-gray-300">    <img src="_page_50_Figure_2.jpeg" alt="" class="my-4 max-w-full" />
</p>

    <p class="text-gray-300">Fig. 4: Comparison of the theoretical estimation Dreg for d = 5, t = 3, the adapted estimation D (1) est using the practical results, and concrete data points from our practical tests with Sage (degree growth is the same in Magma).</p>

    <p class="text-gray-300">for R &ge; 2 and the degree of the equation in the next round is 2d &middot; deg(Ri&minus;1) + deg(Ri&minus;1), we have that</p>

    <p class="text-gray-300"><span class="math">$D_{\\text{reg}}^{(2)} = 1 + \\sum_{i=1}^{n_e} (\\deg(f_i) - 1)</span>$</p>

    <p class="text-gray-300"><span class="math">$= 1 + ((2d+1) - 1) + (2d(2d+1) + 2d + 1 - 1) + \\cdots</span>$</p>

    <p class="text-gray-300"><span class="math">$= 1 + (2d+1) - 1 + (2d+1)^2 - 1 + (2d+1)^3 - 1 + \\cdots</span>$</p>

    <p class="text-gray-300"><span class="math">$= 1 + \\left(\\sum_{i=1}^{R} (2d+1)^i\\right) - R.</span>$</p>

      <h3 id="app-e.3" class="text-xl font-semibold mt-8">E.3 Additional Strategies for Gr&uml;obner Bases</h3>

    <p class="text-gray-300">Apart from the main strategies given in Section <a href="#page-22-0">6.2,</a> there also exist other approaches which we briefly describe here. However, they are in general weaker, and hence we do not use them to determine the final number of rounds.</p>

    <p class="text-gray-300">    <img src="_page_51_Figure_0.jpeg" alt="" class="my-4 max-w-full" />
</p>

    <p class="text-gray-300">Fig. 5: Comparison of the theoretical estimation Dreg for d = 3, t = 3, the adapted estimation D (2) est using the practical results, and concrete data points from our practical tests with Sage.</p>

    <p class="text-gray-300">    <img src="_page_51_Figure_2.jpeg" alt="" class="my-4 max-w-full" />
</p>

    <p class="text-gray-300">Fig. 6: Comparison of the theoretical estimation Dreg for d = 5, t = 3, the adapted estimation D (2) est using the practical results, and concrete data points from our practical tests with Sage.</p>

    <p class="text-gray-300">Full-Round Equation System. When considering the nonlinear layer described in Section <a href="#page-17-5">5.1</a> and given in Eq. <a href="#page-17-4">(6)</a>, we see that y<sup>1</sup> = x<sup>1</sup> <sup>1</sup>/d, and hence the round function exhibits a high degree for low d. However, the starting variables may be chosen such that x<sup>1</sup> is constant. Hence, we need full diffusion in order to inrease the degree of a polynomial containing at least one input variable significantly. Since full diffusion is achieved after only one round and our representation is dense, we conclude that &lceil;&kappa;/ log<sup>2</sup> (p)&rceil; + 1 rounds of Griffin-&pi; are sufficient against this attack. Note that using more than a single input variable increases the complexity in this case.</p>

    <p class="text-gray-300">Adding an Intermediate Variable for L. A technique that can be combined with both main strategies described in Section <a href="#page-22-0">6.2</a> is to add an additional variable for the degree-2 function L. This increases the number of equations and variables by R, while only slightly reducing the overall degrees of the equations. Indeed, in our practical evaluations, we found that combining this technique with any of the above strategies leads to higher solving complexities.</p>

      <h3 id="app-f.1" class="text-xl font-semibold mt-8">F.1 Other Statistical Attacks</h3>

    <p class="text-gray-300"><strong>Linear Attack.</strong> Linear cryptanalysis [25] is often used to deduce distinguishers against the underlying permutation of sponge-based hash functions. It has been introduced by Matsui at EUROCRYPT 1993 for the case of symmetric primitives defined over binary fields, and later on generalized to symmetric primitives over prime fields in [2, 14]. The natural extension of linear cryptanalysis to the case of elements in  <span class="math">\\mathbb{F}_p</span>  regards the search of a linear combination of input, output, and key words that is unbalanced, i.e., biased towards an element of  <span class="math">\\mathbb{F}_p</span>  with probability higher than 1/p.</p>

    <p class="text-gray-300">Due to the same analysis proposed for differential attacks in Section 6.1, linear attacks pose no threat to both the hash function GRIFFIN and the permutation GRIFFIN- <span class="math">\\pi</span>  instantiated with the same number of rounds previously defined for classical differential cryptanalysis.</p>

    <p class="text-gray-300">Impossible Differential and Zero-correlation Attacks. According to the definition of M, the difference of one word can affect the whole t-word state only by one round function call. Therefore, the impossible differential [8, 22] and zero-correlation [9] attacks can hardly be mounted on 3 or more rounds.</p>

    <p class="text-gray-300">Boomerang Attack. The boomerang attack [29] is a variant of a differential attack. Instead of constructing pairs satisfying differential paths, boomerang attacks look for quartets satisfying two differential paths simultaneously. For hash functions using compression functions, where message blocks are involved in the computation of intermediate internal states, the boomerang attack can be effective since the difference in the whole state can be eliminated with specifically designed message block differences. As studied in Section 6.1, differential trails with high probability are rather unlikely to occur for more than 6 rounds. Hence, the number of rounds necessary to prevent the differential attacks and/or the rebound attacks are sufficient to prevent the boomerang attack as well.</p>

    <p class="text-gray-300">Integral/Square Attack, Multiple-of-n &amp; Mixture Differential Crypt-analysis. As a scheme working natively on larger field elements, Griffin could be potentially attacked by all attacks vectors that exploit the strong alignment on symmetric schemes, as the integral and square attacks [13], or more recently the multiple-of-n differential cryptanalysis [18] and the mixture differential one [16]. However, we claim that such attacks become quickly infeasible, since the nonlinear layer S is not aligned and the matrix M provides full diffusion after a single round.</p>

      <h3 id="app-f.2" class="text-xl font-semibold mt-8">F.2 Higher-Order Differentials and Zero-Sum Partitions</h3>

    <p class="text-gray-300">Given a vectorial Boolean function  <span class="math">\\mathcal{F}</span>  over  <span class="math">\\mathbb{F}_2^n</span>  of degree d, the higher-order differential attack [23, 21] exploits the fact that</p>

    <p class="text-gray-300"><span class="math">$\\sum_{x \\in \\mathfrak{V}+v} x = \\sum_{x \\in \\mathfrak{V}+v} \\mathcal{F}(x) = 0</span>$</p>

    <p class="text-gray-300">for any affine subspace  <span class="math">\\mathfrak{V} + v \\subseteq \\mathbb{F}_2^n</span>  of dimension strictly larger than d (i.e.,  <span class="math">\\dim(\\mathfrak{V}) \\geq d+1</span> ). In a binary field  <span class="math">\\mathbb{F}_{2^n}</span> , such an approach has recently been used for MiMC [15, 12].</p>

    <p class="text-gray-300">The corresponding attack in the case of a prime field  <span class="math">\\mathbb{F}_p</span>  has been recently proposed in [7]. Since this result is related to the degree of the polynomial that describes the permutation, we claim that the number of rounds necessary to guarantee security against the interpolation attack provides security against this attack as well.</p>

    <p class="text-gray-300">A possible variant of higher-order sums in the case of permutations is the zero-sum partition attack/distinguisher.</p>

    <p class="text-gray-300"><strong>Definition 7 (Zero-Sum Partition [10]).</strong> Let  <span class="math">\\mathcal{P}</span>  be a permutation over  <span class="math">\\mathbb{F}_q^t</span>  for a prime  <span class="math">q \\geq 2</span> . A zero-sum partition for  <span class="math">\\mathcal{P}</span>  of size l &lt; t is a collection of l disjoint sets  <span class="math">\\{X_1, \\ldots, X_l\\}</span>  with the following properties:</p>

    <p class="text-gray-300"><span class="math">$-X_i \\subset \\mathbb{F}^t \\text{ for each } i \\in \\{1, \\dots, l\\} \\ \\mathscr{E} \\bigcup_{i=1}^l X_i = \\mathbb{F}^t, \\\\ -\\forall i \\in \\{1, \\dots, l\\} : \\sum_{x \\in X_i} x = \\sum_{x \\in X_i} \\mathcal{P}(x) = 0.</span>$</p>

    <p class="text-gray-300">This direction has been investigated e.g. in [10] for two SHA-3 candidates, Luffa and Keccak. Since it is expected that a randomly chosen function does not have many zero sums, the existence of several such sets can be seen as a distinguishing property of the internal function. Here we explicitly state that we do not make claims about the security of Griffin against zero-sum partitions. This choice is motivated by the gap present in the literature between the number of rounds of the internal permutation that can be covered by a zero-sum partition and by the number of rounds in the corresponding sponge hash function that can be broken e.g. via a preimage or a collision attack. As a concrete example, consider the case of Keccak. While 24 rounds of Keccak-f can be distinguished from a random permutation using a zero-sum partition [10] (that is, full Keccak-f), preimage/collision attacks on Keccak can only be set up for up to 6 rounds of Keccak-f [19]. This suggests that zero-sum partitions should be largely ignored for practical applications.</p>

    </section>

    <section id="references" class="mb-10">
      <h2 class="text-2xl font-bold">References for Supplementary Material</h2>

    <ul class="space-y-2 text-gray-400 text-sm list-none">
      <li><p class="text-gray-300">[1] A. Aly, T. Ashur, Eli Ben-Sasson, S. Dhooghe, and A. Szepieniec. &quot;Design of Symmetric-Key Primitives for Advanced Cryptographic Protocols&quot;. In: <em>IACR Trans. Symmetric Cryptol.</em> 2020.3 (2020), pp. 1&ndash;45.</p></li>
      <li><p class="text-gray-300">[2] T. Baign&egrave;res, J. Stern, and S. Vaudenay. &quot;Linear Cryptanalysis of Non Binary Ciphers&quot;. In: SAC 2007. Vol. 4876. LNCS. 2007, pp. 184&ndash;211.</p></li>
      <li><p class="text-gray-300">[3] S. Banik, S. K. Pandey, T. Peyrin, Y. Sasaki, S. M. Sim, and Y. Todo. &quot;GIFT: A Small Present - Towards Reaching the Limit of Lightweight Encryption&quot;. In: CHES 2017. Ed. by W. Fischer and N. Homma. Vol. 10529. LNCS. Springer, 2017, pp. 321&ndash;345.</p></li>
      <li><p class="text-gray-300">[4] C. Beierle, J. Jean, S. K&uml;olbl, G. Leander, A. Moradi, T. Peyrin, Y. Sasaki, P. Sasdrich, and S. M. Sim. &quot;The SKINNY Family of Block Ciphers and Its Low-Latency Variant MANTIS&quot;. In: CRYPTO 2016. Ed. by M. Robshaw and J. Katz. Vol. 9815. LNCS. 2016, pp. 123&ndash;153.</p></li>
      <li><p class="text-gray-300">[5] E. Ben-Sasson, I. Bentov, Y. Horesh, and M. Riabzev. Scalable, transparent, and post-quantum secure computational integrity. Cryptology ePrint Archive, Report 2018/46. 2018.</p></li>
      <li><p class="text-gray-300">[6] E. Ben-Sasson, L. Goldberg, and D. Levit. STARK Friendly Hash - Survey and Recommendation. Cryptology ePrint Archive, Report 2020/948. 2020.</p></li>
      <li><p class="text-gray-300">[7] T. Beyne, A. Canteaut, I. Dinur, M. Eichlseder, G. Leander, G. Leurent, M. Naya-Plasencia, L. Perrin, Y. Sasaki, Y. Todo, and F. Wiemer. &quot;Out of Oddity - New Cryptanalytic Techniques Against Symmetric Primitives Optimized for Integrity Proof Systems&quot;. In: CRYPTO 2020. Vol. 12172. LNCS. 2020, pp. 299&ndash; 328.</p></li>
      <li><p class="text-gray-300">[8] E. Biham, A. Biryukov, and A. Shamir. &quot;Cryptanalysis of Skipjack Reduced to 31 Rounds Using Impossible Differentials&quot;. In: EUROCRYPT 1999. Vol. 1592. LNCS. 1999, pp. 12&ndash;23.</p></li>
      <li><p class="text-gray-300">[9] A. Bogdanov and M. Wang. &quot;Zero Correlation Linear Cryptanalysis with Reduced Data Complexity&quot;. In: FSE 2012. Vol. 7549. LNCS. 2012, pp. 29&ndash;48.</p></li>
      <li><p class="text-gray-300">[10] C. Boura, A. Canteaut, and C. D. Canni\`ere. &quot;Higher-Order Differential Properties of Keccak and Luffa&quot;. In: FSE 2011. Vol. 6733. LNCS. 2011, pp. 252&ndash; 269.</p></li>
      <li><p class="text-gray-300">[11] C. Bouvier, P. Briaud, P. Chaidos, L. Perrin, R. Salen, V. Velichkov, and D. Willems. &quot;New Design Techniques for Efficient Arithmetization-Oriented Hash Functions: Anemoi Permutations and Jive Compression Mode&quot;. In: IACR Cryptol. ePrint Arch. (2022), p. 840.</p></li>
      <li><p class="text-gray-300">[12] C. Bouvier, A. Canteaut, and L. Perrin. &quot;On the Algebraic Degree of Iterated Power Functions&quot;. In: IACR Cryptol. ePrint Arch. (2022), p. 366.</p></li>
      <li><p class="text-gray-300">[13] J. Daemen, L. R. Knudsen, and V. Rijmen. &quot;The Block Cipher Square&quot;. In: FSE. Vol. 1267. LNCS. 1997, pp. 149&ndash;165.</p></li>
      <li><p class="text-gray-300">[14] C. Dobraunig, L. Grassi, A. Guinet, and D. Kuijsters. &quot;Ciminion: Symmetric Encryption Based on Toffoli-Gates over Large Finite Fields&quot;. In: EUROCRYPT 2021. Vol. 12697. LNCS. 2021, pp. 3&ndash;34.</p></li>
      <li><p class="text-gray-300">[15] M. Eichlseder, L. Grassi, R. L&uml;uftenegger, M. &Oslash;ygarden, C. Rechberger, M. Schofnegger, and Q. Wang. &quot;An Algebraic Attack on Ciphers with Low-Degree Round Functions: Application to Full MiMC&quot;. In: ASIACRYPT 2020. Vol. 12491. LNCS. 2020, pp. 477&ndash;506.</p></li>
      <li><p class="text-gray-300">[16] L. Grassi. &quot;Mixture Differential Cryptanalysis: a New Approach to Distinguishers and Attacks on round-reduced AES&quot;. In: IACR Trans. Symmetric Cryptol. 2018.2 (2018), pp. 133&ndash;160.</p></li>
      <li><p class="text-gray-300">[17] L. Grassi, D. Khovratovich, C. Rechberger, A. Roy, and M. Schofnegger. &quot;Poseidon: A New Hash Function for Zero-Knowledge Proof Systems&quot;. In: USENIX Security Symposium. USENIX Association, 2021, pp. 519&ndash;535.</p></li>
      <li><p class="text-gray-300">[18] L. Grassi, C. Rechberger, and S. R&oslash;njom. &quot;A New Structural-Differential Property of 5-Round AES&quot;. In: EUROCRYPT 2017. Vol. 10211. LNCS. 2017, pp. 289&ndash; 317.</p></li>
      <li><p class="text-gray-300">[19] J. Guo, G. Liao, G. Liu, M. Liu, K. Qiao, and L. Song. &quot;Practical Collision Attacks against Round-Reduced SHA-3&quot;. In: J. Cryptol. 33.1 (2020), pp. 228&ndash; 270.</p></li>
      <li><p class="text-gray-300">[20] Hash functions for Zero-Knowledge applications Zoo. <a href="https://extgit.iaik.tugraz.at/krypto/zkfriendlyhashzoo" target="_blank" rel="noopener noreferrer">https://extgit.iaik.</a> <a href="https://extgit.iaik.tugraz.at/krypto/zkfriendlyhashzoo" target="_blank" rel="noopener noreferrer">tugraz.at/krypto/zkfriendlyhashzoo</a>. IAIK, Graz University of Technology. Aug. 2021.</p></li>
      <li><p class="text-gray-300">[21] L. R. Knudsen. &quot;Truncated and Higher Order Differentials&quot;. In: FSE 1994. Vol. 1008. LNCS. 1994, pp. 196&ndash;211.</p></li>
      <li><p class="text-gray-300">[22] L. R. Knudsen. DEAL &ndash; A 128-bit Block Cipher. 1998.</p></li>
      <li><p class="text-gray-300">[23] X. Lai. &quot;Higher Order Derivatives and Differential Cryptanalysis&quot;. In: Communications and Cryptography: Two Sides of One Tapestry. Springer US, 1994, pp. 227&ndash;233.</p></li>
      <li><p class="text-gray-300">[24] X. Ma, L. Hu, S. Sun, K. Qiao, and J. Shan. &quot;Tighter Security Bound of MIBS Block Cipher against Differential Attack&quot;. In: Network and System Security - NSS 2014. Vol. 8792. LNCS. 2014, pp. 518&ndash;525.</p></li>
      <li><p class="text-gray-300">[25] M. Matsui. &quot;Linear Cryptanalysis Method for DES Cipher&quot;. In: EUROCRYPT 1993. Vol. 765. LNCS. 1993, pp. 386&ndash;397.</p></li>
      <li><p class="text-gray-300">[26] N. Mouha, Q. Wang, D. Gu, and B. Preneel. &quot;Differential and Linear Cryptanalysis Using Mixed-Integer Linear Programming&quot;. In: Inscrypt 2011. Vol. 7537. LNCS. 2011, pp. 57&ndash;76.</p></li>
      <li><p class="text-gray-300">[27] J. Patarin. &quot;Generic Attacks on Feistel Schemes&quot;. In: ASIACRYPT 2001. Vol. 2248. LNCS. 2001, pp. 222&ndash;238.</p></li>
      <li><p class="text-gray-300">[28] S. Sun, L. Hu, P. Wang, K. Qiao, X. Ma, and L. Song. &quot;Automatic Security Evaluation and (Related-key) Differential Characteristic Search: Application to SIMON, PRESENT, LBlock, DES(L) and Other Bit-Oriented Block Ciphers&quot;. In: ASIACRYPT 2014. Vol. 8873. LNCS. 2014, pp. 158&ndash;178.</p></li>
      <li><p class="text-gray-300">[29] D. A. Wagner. &quot;The Boomerang Attack&quot;. In: FSE. Vol. 1636. LNCS. 1999, pp. 156&ndash;170.</p></li>
      <li><p class="text-gray-300">[30] X. Wang, Y. L. Yin, and H. Yu. &quot;Finding Collisions in the Full SHA-1&quot;. In: CRYPTO 2005. Vol. 3621. LNCS. 2005, pp. 17&ndash;36.</p></li>
      <li><p class="text-gray-300">[31] H. Wu and T. Huang. TinyJAMBU: A Family of Lightweight Authenticated Encryption Algorithms. Submission to the NIST lightweight cryptographic standardization process (Finalist). 2021.</p></li>
    </ul>

    </section>
`;
---

<BaseLayout title="Horst Meets Fluid-SPN: Griffin for Zero-Knowledge Applicatio... (2022/403)">
  <article class="max-w-4xl mx-auto article-prose">
    <nav class="mb-8">
      <a href="/papers" class="text-blue-400 hover:text-blue-300">
        &larr; Back to Papers
      </a>
    </nav>

    <header class="mb-12">
      <h1 class="text-3xl font-bold mb-4"
        set:html={TITLE_HTML} />
      <p class="text-gray-400 mb-2"
        set:html={AUTHORS_HTML} />
      <p class="text-gray-500 text-sm mb-4">
        2022 &middot; eprint 2022/403
      </p>
      <div class="flex gap-4 text-sm">
        <a
          href={EPRINT_URL}
          target="_blank"
          rel="noopener noreferrer"
          class="text-blue-400 hover:text-blue-300"
        >
          Paper (eprint) &rarr;
        </a>
      </div>
      <PaperDisclaimer eprintUrl={EPRINT_URL} />
      <p class="mt-1 text-xs text-gray-600">
        Converted with: {CRAWLER} &middot; {CONVERTED_DATE}
      </p>
    </header>

    <nav id="toc" class="mb-10 p-6 rounded-lg" style="background: rgba(255,255,255,0.03); border: 1px solid rgba(255,255,255,0.06);">
      <h2 class="text-lg font-bold mb-4">Table of Contents</h2>
      <ol class="space-y-1 text-sm text-gray-300
        list-decimal list-inside">
        <li>
          <a href="#sec-1" class="hover:text-white">Introduction</a>
          <ol class="ml-6 mt-1 space-y-1 list-decimal
            list-inside text-gray-400">
            <li><a href="#sec-1.1" class="hover:text-white">Hash and Compression Functions in ZK Settings</a></li>
            <li><a href="#sec-1.2" class="hover:text-white">Our Contribution</a></li>
          </ol>
        </li>
        <li>
          <a href="#sec-2" class="hover:text-white">Cost Metrics for Zero-Knowledge Proof Systems</a>
          <ol class="ml-6 mt-1 space-y-1 list-decimal
            list-inside text-gray-400">
            <li><a href="#sec-2.1" class="hover:text-white">Zero-Knowledge Proofs</a></li>
            <li><a href="#sec-2.2" class="hover:text-white">Arithmetization</a></li>
            <li><a href="#sec-2.3" class="hover:text-white">Rank-1 Constraint Satisfaction Systems (R1CS)</a></li>
            <li><a href="#sec-2.4" class="hover:text-white">Plonk Arithmetization</a></li>
          </ol>
        </li>
        <li>
          <a href="#sec-3" class="hover:text-white">The Road to Griffin</a>
          <ol class="ml-6 mt-1 space-y-1 list-decimal
            list-inside text-gray-400">
            <li><a href="#sec-3.1" class="hover:text-white">Related Work: SPN Schemes for ZK Applications</a></li>
            <li><a href="#sec-3.2" class="hover:text-white">Non-SPN Schemes: From Feistel to Horst</a></li>
            <li><a href="#sec-3.3" class="hover:text-white">Constructing Nonzero Functions G</a></li>
            <li><a href="#sec-3.4" class="hover:text-white">Combining Horst with a Rescue-like SPN: The Birth of Griffin</a></li>
          </ol>
        </li>
        <li>
          <a href="#sec-4" class="hover:text-white">Modes of Operation</a>
          <ol class="ml-6 mt-1 space-y-1 list-decimal
            list-inside text-gray-400">
            <li><a href="#sec-4.1" class="hover:text-white">Sponge Hash Functions</a></li>
            <li><a href="#sec-4.2" class="hover:text-white">Compression Functions</a></li>
          </ol>
        </li>
        <li>
          <a href="#sec-5" class="hover:text-white">Griffin and Griffin-\pi</a>
          <ol class="ml-6 mt-1 space-y-1 list-decimal
            list-inside text-gray-400">
            <li><a href="#sec-5.1" class="hover:text-white">Specification of Griffin-\pi</a></li>
            <li><a href="#sec-5.2" class="hover:text-white">Number of Rounds of Griffin-\pi</a></li>
          </ol>
        </li>
        <li>
          <a href="#sec-6" class="hover:text-white">Security of Griffin and Griffin-\pi</a>
          <ol class="ml-6 mt-1 space-y-1 list-decimal
            list-inside text-gray-400">
            <li><a href="#sec-6.1" class="hover:text-white">Statistical Attacks on Griffin-\pi</a></li>
            <li><a href="#sec-6.2" class="hover:text-white">Algebraic Attacks</a></li>
            <li><a href="#sec-6.3" class="hover:text-white">Feistel versus Horst: Security of Griffin Instantiated with Feistel</a></li>
          </ol>
        </li>
        <li>
          <a href="#sec-7" class="hover:text-white">Performance Evaluation</a>
          <ol class="ml-6 mt-1 space-y-1 list-decimal
            list-inside text-gray-400">
            <li><a href="#sec-7.1" class="hover:text-white">Plain Performance</a></li>
            <li><a href="#sec-7.2" class="hover:text-white">R1CS-Based SNARKs with Griffin</a></li>
            <li><a href="#sec-7.3" class="hover:text-white">Plonk Performance of Griffin</a></li>
          </ol>
        </li>
      </ol>
      <p class="text-xs text-gray-500 mt-4 mb-1 font-semibold">
        Appendices
      </p>
      <ol class="space-y-1 text-sm text-gray-400
        list-[upper-alpha] list-inside">
        <li>
          <a href="#app-a" class="hover:text-white">STARKs with Griffin</a>
          <ol class="ml-6 mt-1 space-y-1 list-decimal
            list-inside text-gray-400">
            <li><a href="#app-a.1" class="hover:text-white">Algebraic Intermediate Representation (AIR)</a></li>
            <li><a href="#app-a.2" class="hover:text-white">Relations Between SNARK and STARK Cost Metrics</a></li>
            <li><a href="#app-a.3" class="hover:text-white">STARK Performance of Griffin</a></li>
          </ol>
        </li>
        <li><a href="#app-b" class="hover:text-white">Security of Horst Schemes</a></li>
        <li>
          <a href="#app-c" class="hover:text-white">Proofs &ndash; Differential Cryptanalysis</a>
          <ol class="ml-6 mt-1 space-y-1 list-decimal
            list-inside text-gray-400">
            <li><a href="#app-c.1" class="hover:text-white">Maximum Differential Probability of S</a></li>
            <li><a href="#app-c.2" class="hover:text-white">Branch Number of M</a></li>
          </ol>
        </li>
        <li>
          <a href="#app-e" class="hover:text-white">Algebraic Attacks &ndash; Details</a>
          <ol class="ml-6 mt-1 space-y-1 list-decimal
            list-inside text-gray-400">
            <li><a href="#app-e.1" class="hover:text-white">Density of Griffin-\pi</a></li>
            <li><a href="#app-e.2" class="hover:text-white">Practical Results for Gr&ouml;bner Bases</a></li>
            <li><a href="#app-e.3" class="hover:text-white">Additional Strategies for Gr&uml;obner Bases</a></li>
          </ol>
        </li>
        <li>
          <a href="#app-f" class="hover:text-white">Security Analysis &ndash; Other Attacks</a>
          <ol class="ml-6 mt-1 space-y-1 list-decimal
            list-inside text-gray-400">
            <li><a href="#app-f.1" class="hover:text-white">Other Statistical Attacks</a></li>
            <li><a href="#app-f.2" class="hover:text-white">Higher-Order Differentials and Zero-Sum Partitions</a></li>
          </ol>
        </li>
      </ol>
      <p class="text-xs text-gray-500 mt-4 mb-1 font-semibold">
        Additional
      </p>
      <ul class="space-y-1 text-sm text-gray-400
        list-disc list-inside">
        <li><a href="#references" class="hover:text-white">References</a></li>
        <li><a href="#references" class="hover:text-white">References</a></li>
      </ul>
    </nav>


    <Fragment set:html={CONTENT} />

    <PaperHistory slug="horst-meets-fluid-spn-griffin-for-zero-knowledge-2022" />
  </article>
</BaseLayout>
