---
import BaseLayout from '../../layouts/BaseLayout.astro';
import PaperDisclaimer from '../../components/PaperDisclaimer.astro';
import PaperHistory from '../../components/PaperHistory.astro';

const EPRINT_URL = 'https://eprint.iacr.org/2013/301';
const CRAWLER = 'marker';
const CONVERTED_DATE = '2026-02-18';
const TITLE_HTML = 'Impossible Differential-Linear Cryptanalysis of Reduced-Round CLEFIA-128';
const AUTHORS_HTML = 'Zheng Yuan, Xian Li, Bart Preneel';

const CONTENT = `    <section id="abstract" class="mb-10">
      <h2 class="text-2xl font-bold">Abstract</h2>
      <p class="text-gray-300">CLEFIA is a 128-bit block cipher proposed by Sony Corporation in
2007. Our paper introduces a new chosen text attack, the
impossible differential-linear attack, on iterated cryptosystems.
The attack is efficient for $16$-round CLEFIA with whitening keys.
In the paper, we construct a $13$-round impossible
differential-linear distinguisher. Based on the distinguisher, we
present an effective attack on 16-round CLEFIA-$128$ with data
complexity of $2^{122.73}$, recovering $96$-bit subkeys in total.
Our attack can also be applied to CLEFIA-192 and CLEFIA-$256$.</p>
      <p class="text-gray-300"><strong>Keywords:</strong> CLEFIA &middot; impossible differential cryptanalysis &middot; linear approximation.</p>
    </section>

    <section id="sec-1" class="mb-10">
      <h2 class="text-2xl font-bold">1 Introduction</h2>

    <p class="text-gray-300">CLEFIA [8] is a 128-bit block cipher supporting key lengths of 128, 192 and 256 bits; these three versions have 18, 22 and 26 rounds respectively. It achieves enough immunity against known attacks and is flexible enough for efficient implementation in both hardware and software. As a block cipher proposed by Sony Corporation in 2007, CLEFIA has received significant amount of cryptanalytic attention. However, except for the evaluation report [9] from the designers, there are only a few significant cryptanalytic results.</p>

    <p class="text-gray-300">At present, the most powerful attack on CLEFIA is a series of impossible differential attacks on reduced rounds versions. The first one is proposed by its designers in the evaluation report of CLEFIA [9]. In FSE 2008, Tsunoo et al. introduced new 9-round impossible differentials for CLEFIA, and presented a</p>

    <p class="text-gray-300"><sup>&amp;</sup>lt;sup&gt;1</sup> Beijing Electronic Science &amp; Technology Institute, Beijing 100070, P.R. China zyuan@tsinghua.edu.cn,</p>

    <p class="text-gray-300"><sup>&amp;</sup>lt;sup&gt;2</sup> Beijing University of Posts and Telecommunications, Beijing 100876, P.R. China
<sup>3</sup> University of Science and Technology of China, Hefei 230026, P.R. China
<sup>4</sup> State Key Laboratory of Cryptology</p>

    <p class="text-gray-300"><span class="math">&lt;sup&gt;^{\\&lt;/sup&gt;star}</span>  This work is supported by the  <span class="math">13^{th}</span>  Five-year Cryptography Development Foundation of China (No.MMJJ20180217).</p>

    <p class="text-gray-300"><span class="math">&lt;sup&gt;^{\\&lt;/sup&gt;star\\star}</span>  To whom correspondence should be addressed.</p>

    <p class="text-gray-300">12-round attack on CLEFIA-128 with  <span class="math">2^{118.9}</span>  chosen plaintexts and  <span class="math">2^{119}</span>  encryptions [10]. Later, by the same impossible differential distinguisher, Zhang et al. presented an attack on 14-round CLEFIA, in which the design team pointed out a flaw and showed that it is not successful [11]. In IndoCrypt 2010, Tezcan proposed improbable differential cryptanalysis and applied it to 13/14/15-round CLEFIA-128/196/256 by taking advantage of relations among the round keys [5].</p>

    <p class="text-gray-300">Our Contribution. In this paper, we will propose a new method, the impossible differential-linear attack, to analyze the CLEFIA block cipher. By constructing a 13-round distinguisher, using the new method, and combining it with key relations we found, we propose an attack on 16-round CLEFIA-128 with data and time complexity  <span class="math">2^{122.7}</span> . Furthermore, Appendix A presents another distinguisher construction and Appendix B shows another attack on a 16-round version. We present an attack on 15-round CLEFIA-128 in Appendix C. Our attacks are more efficient than earlier work. In Appendix D we also provide some key relations.</p>

    <p class="text-gray-300"><strong>Outline.</strong> This paper is organized as follows. Section 2 provides a brief description of CLEFIA, and Sect. 3 introduces our new method of impossible differential-linear attack. In Sect. 4 we present details of the 13-round impossible differential-linear distinguisher. The 16-round impossible differential-linear attack on CLEFIA-128 is discussed in detail in Sect. 5. We summarize our results in Sect. 6.</p>

    </section>

    <section id="sec-2" class="mb-10">
      <h2 class="text-2xl font-bold">2 Description of CLEFIA</h2>

      <h3 id="sec-2.1" class="text-xl font-semibold mt-8">2.1 Notation</h3>

    <pre><code class="language-text">\\begin{array}{cccccccccccccccccccccccccccccccccccc
</code></pre>

      <h3 id="sec-2.2" class="text-xl font-semibold mt-8">2.2 CLEFIA</h3>

    <p class="text-gray-300">CLEFIA is a 128-bit block cipher with a generalized Feistel structure consisting of four 32-bit data lines. For the key lengths of 128, 192, and 256 bits, CLEFIA has 18, 22, and 26 rounds respectively. The encryption function uses four 32-bit whitening keys  <span class="math">WK_0, WK_1, WK_2, WK_3 \\in \\{0,1\\}^{32}</span>  and 2r 32-bit round keys, where r is the number of rounds.  <span class="math">RK_i \\in \\{0,1\\}^{32} (0 \\le i &lt; 2r)</span>  represents round key, and  <span class="math">WK_0, WK_1, WK_2, WK_3 \\in \\{0,1\\}^{32}</span>  are whitening keys. We denote d-branch r-round generalized Feistel network employed in CLEFIA as  <span class="math">GFN_{d,r}</span> .</p>

    <p class="text-gray-300">    <img src="_page_2_Figure_2.jpeg" alt="" class="my-4 max-w-full" />
</p>

    <p class="text-gray-300">Fig. 1. CLEFIA</p>

    <p class="text-gray-300">The encryption process can be seen in Fig. 1(a). The details of  <span class="math">GFN_{4,r}</span>  are as follows:</p>

    <pre><code class="language-text"> \\begin{array}{l} - \\text{ Step 1. } T_0 \\left| T_1 \\right| T_2 \\left| T_3 \\leftarrow P_0 \\left| \\left( P_1 \\oplus WK_0 \\right) \\right| P_2 \\left| \\left( P_3 \\oplus WK_1 \\right) \\right. \\\\ - \\text{ Step 2. For } i = 0 \\text{ to } r - 1 \\text{ do the following:} \\\\ T_1 \\leftarrow T_1 \\oplus F_0 (T_0, RK_{2i}), \\quad T_3 \\leftarrow T_3 \\oplus F_1 (T_2, RK_{2i+1}) \\\\ T_0 \\left| T_1 \\right| T_2 \\left| T_3 \\leftarrow T_1 \\right| T_2 \\left| T_3 \\right| T_0 \\\\ - \\text{ Step 3. } C_0 \\left| C_1 \\right| C_2 \\left| C_3 \\leftarrow T_3 \\right| \\left( T_0 \\oplus WK_2 \\right) \\left| T_1 \\right| \\left( T_2 \\oplus WK_3 \\right) \\end{array}
</code></pre>

    <p class="text-gray-300">Each round contains two parallel F functions,  <span class="math">F_0</span>  and  <span class="math">F_1</span> , and their structures are shown in Fig. 1(b) where  <span class="math">S_0</span>  and  <span class="math">S_1</span>  are 8 &times; 8-bit S-boxes. The details of  <span class="math">F_0</span>  are as follows:</p>

    <pre><code class="language-text"> \\begin{array}{l} - \\text{ Step 1. } T_0 \\left| T_1 \\right| T_2 \\left| T_3 \\leftarrow RK \\oplus x, \\quad T_i \\in \\{0,1\\}^8, \\ x \\in \\{0,1\\}^{32} \\\\ - \\text{ Step 2. } T_0 \\leftarrow S_0(T_0) \\ , \\ T_1 \\leftarrow S_1(T_1) \\ , \\ T_2 \\leftarrow S_0(T_2) \\ , \\ T_3 \\leftarrow S_1(T_3) \\\\ - \\text{ Step 3. } y = M_0 \\cdot (T_0, T_1, T_2, T_3)^T, \\ y \\in \\{0,1\\}^{32} \\end{array}
</code></pre>

    <p class="text-gray-300"><span class="math">F_1</span>  is defined by replacing the terms in  <span class="math">F_0</span>  as follows:  <span class="math">S_0</span>  is replaced with  <span class="math">S_1</span> ,  <span class="math">S_1</span>  with  <span class="math">S_0</span> , and  <span class="math">M_0</span>  with  <span class="math">M_1</span> .</p>

    <p class="text-gray-300">The two matrices  <span class="math">M_0</span>  and  <span class="math">M_1</span>  used in the F-functions are defined as follows.</p>

    <p class="text-gray-300"><span class="math">$M_0 = \\begin{pmatrix} 0x01 \\ 0x02 \\ 0x04 \\ 0x06 \\ 0x04 \\\\ 0x02 \\ 0x01 \\ 0x06 \\ 0x04 \\\\ 0x04 \\ 0x06 \\ 0x01 \\ 0x02 \\\\ 0x06 \\ 0x04 \\ 0x02 \\ 0x01 \\end{pmatrix}, M_1 = \\begin{pmatrix} 0x01 \\ 0x08 \\ 0x02 \\ 0x0a \\\\ 0x08 \\ 0x01 \\ 0x0a \\ 0x02 \\\\ 0x02 \\ 0x0a \\ 0x01 \\ 0x08 \\\\ 0x0a \\ 0x02 \\ 0x08 \\ 0x01 \\end{pmatrix}.</span>$</p>

      <h3 id="sec-2.3" class="text-xl font-semibold mt-8">2.3 Key Scheduling</h3>

    <p class="text-gray-300">For the 128-bit key, the Double Swap function  <span class="math">\\Sigma:\\{0,1\\}^{128}\\to\\{0,1\\}^{128}</span>  is defined as follows:</p>

    <p class="text-gray-300"><span class="math">$X_{(128)} \\mapsto X[7-63] |X[121-127] |X[0-6] |X[64-120],</span>$</p>

    <p class="text-gray-300">where X[a-b] denotes a bit string cut from the a-th bit to the b-th bit of X.</p>

    <p class="text-gray-300">Let  <span class="math">K = K_0 | K_1 | K_2 | K_3</span>  be the key and L be an intermediate key, the key scheduling consists of the following 3 steps:</p>

    <pre><code class="language-text">- Step 1. L \\leftarrow GFN_{4,12}(CON_0, \\cdots, CON_{23}, K_0, \\cdots, K_3)

- Step 2.WK_0 \\mid WK_1 \\mid WK_2 \\mid WK_3 \\leftarrow K

- Step 3. For i=0 to 8 do the following:

T \\leftarrow L \\oplus (CON_{24+4i} \\mid CON_{24+4i+1} \\mid CON_{24+4i+2} \\mid CON_{24+4i+3})

L \\leftarrow \\Sigma(L)

If i is odd: T \\leftarrow T \\oplus K

RK_{4i} \\mid RK_{4i+1} \\mid RK_{4i+2} \\mid RK_{4i+3} \\leftarrow T
</code></pre>

    <p class="text-gray-300">We need 60 constant values  <span class="math">CON_{(s)} (0 \\le s \\le 59)</span>  in the 128-bit key scheduling algorithm. Let  <span class="math">R = 0xb7e1 (= (e-2) \\cdot 2^{16})</span>  and  <span class="math">Q = 0x243f (= (\\pi-3) \\cdot 2^{16})</span> , where e is the base of the natural logarithm (2.71828...) and  <span class="math">\\pi</span>  is the circle ratio (3.14159...).  <span class="math">CON_{(s)}</span>  are generated by the following way, in which  <span class="math">IV^{128} = 0x428a (= (\\sqrt[3]{2} - 1) \\cdot 2^{16})</span></p>

    <pre><code class="language-text">\\begin{array}{l} - \\text{ Step 1. } T \\leftarrow IV^{128} \\\\ - \\text{ Step 2. For } j = 0 \\text{ to 29 do the following:} \\\\ CON_{2j} \\leftarrow (T \\oplus R) | (\\overline{T} &lt;&lt;&lt;1) \\\\ CON_{2j+1} \\leftarrow (\\overline{T} \\oplus Q) | (T &lt;&lt;&lt;8) \\\\ T \\leftarrow T \\cdot 0x0002^{-1} (\\text{mod } z^{16} + z^{15} + z^{13} + z^{11} + z^5 + z^4 + 1) \\end{array}
</code></pre>

    <p class="text-gray-300">The key relations we found are illustrated in Appendix D.</p>

    </section>

    <section id="sec-3" class="mb-10">
      <h2 class="text-2xl font-bold">3 The Impossible Differential-Linear Attack</h2>

    <p class="text-gray-300">Inspired by the differential-linear attack, first introduced by Langford and Hellman in [4], we propose a new cryptanalytic method called impossible differential-linear attack, because it combines the impossible differential cryptanalysis and linear cryptanalysis together. The attack is not completely new, since the impossible differential attack and linear attack were typical and widely used in previous attacks on several cryptosystems. However, no previous work has been done on combining these two. In this section, we first describe the process of impossible differential-linear attack, then we compare this attack with impossible differential attack.</p>

      <h3 id="sec-3.1" class="text-xl font-semibold mt-8">3.1 Impossible Differential-Linear Distinguisher</h3>

    <p class="text-gray-300">Let a block cipher E is represented as  <span class="math">E = E_1 \\circ E_0</span> , where  <span class="math">E_0</span>  and  <span class="math">E_1</span>  are two subciphers. We use an impossible differential  <span class="math">\\Omega_P \\not\\to \\Omega_T</span>  with probability 1 for  <span class="math">E_0</span> , and a linear approximation  <span class="math">\\lambda_P \\to \\lambda_T</span>  with probability 1/2 + q for  <span class="math">E_1</span> , where  <span class="math">\\lambda_P \\cdot \\Omega_T</span>  is a fixed value (0 or 1). i.e., the probability of  <span class="math">\\Omega_T \\to \\lambda_P</span>  is 1, and the probability of  <span class="math">\\Omega_P \\not\\to \\lambda_P</span>  with the specified difference path is also 1, so we call  <span class="math">\\Omega_P \\not\\to \\lambda_P</span>  an impossible differential-linear distinguisher. In particular, we call  <span class="math">E&#x27;: \\Omega_P \\not\\to \\lambda_T</span>  an extended impossible differential-linear distinguisher.</p>

    <p class="text-gray-300">For the extended impossible differential-linear distinguisher E', the impossible differential  <span class="math">\\Omega_P \\not\\to \\Omega_T</span>  with probability 1, means that both  <span class="math">\\Omega_P \\to \\Omega_M</span>  and  <span class="math">\\Omega&#x27;_M \\to \\Omega_T</span>  with probability 1, and in the same state,  <span class="math">\\Omega_M \\not\\to \\Omega&#x27;_M</span> . Additionally,  <span class="math">\\Omega_T \\to \\lambda_P</span>  with probability 1 and  <span class="math">\\lambda_P \\to \\lambda_T</span>  with probability 1/2 + q, means that the probability of  <span class="math">\\Omega_T \\to \\lambda_T</span>  is 1/2 + q. So,  <span class="math">\\Omega&#x27;_M \\to \\lambda_T</span>  with probability 1/2 + q. We call  <span class="math">\\Omega_P \\to \\Omega_M</span>  'difference part', and call  <span class="math">\\Omega&#x27;_M \\to \\lambda_T</span>  'extended linear part'.</p>

    <p class="text-gray-300">Different from other attack methods, such as a differential attack, linear attack, impossible differential attack and differential-linear attack, our impossible difference-linear distinguisher has an &quot;order&quot;, which means that when using it, first use the 'extended linear part' to select some wrong objects, then filter the wrong object and obtain the correct object with the 'difference part'. For example, if we want recover the key with an (extended) impossible differential-linear distinguisher  <span class="math">E&#x27;: \\Omega_P \\not\\to \\lambda_T</span> , we first need to guess the key set  <span class="math">K_1 = \\{k_1\\}</span>  satisfying the 'extended linear part'  <span class="math">\\Omega&#x27;_M \\to \\lambda_T</span> , then to guess another key set  <span class="math">K_0 = \\{k_0\\}</span>  using the 'difference part'  <span class="math">\\Omega_P \\to \\Omega_M</span> , and to the filter the wrong keys  <span class="math">K&#x27; = \\{k_0\\} \\cap \\{k_1\\}</span> , finally, the correct keys  <span class="math">K = K_0 - K&#x27;</span>  remain. For the following reasons, you cannot reverse the &quot;order&quot;.</p>

    <ul class="list-disc list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li><p class="text-gray-300">In our impossible differential-linear distinguisher  <span class="math">E&#x27;: \\Omega_P \\not\\to \\lambda_P, \\ \\Omega_P \\not\\to \\Omega_T</span>  with probability 1 and  <span class="math">\\lambda_P \\cdot \\Omega_T</span>  is a fixed value (0 or 1). In detail, both  <span class="math">\\Omega_P \\to \\Omega_M</span>  and  <span class="math">\\Omega_M&#x27; \\to \\Omega_T</span>  with probability 1, in the same state,  <span class="math">\\Omega_M \\not\\to \\Omega_M&#x27;</span> , a &quot;contradiction&quot; happens. So our impossible differential-linear distinguisher has the same &quot;contradiction&quot; as the impossible differential distinguisher. In the impossible differential-linear attacks, we also use these &quot;contradictions&quot; to delete the wrong keys.</p></li>
      <li><p class="text-gray-300">Let keys  <span class="math">K_a = \\{k_a\\}</span>  satisfy the differential  <span class="math">\\Omega_P \\to \\Omega_M</span> , let keys  <span class="math">K_b = \\{k_b\\}</span>  satisfy the differential  <span class="math">\\Omega&#x27;_M \\to \\Omega_T</span> , let keys  <span class="math">K_c = \\{k_c\\}</span>  satisfy that  <span class="math">\\lambda_P \\cdot \\Omega_T</span>  is a fixed value (0 or 1), and let keys  <span class="math">K_d = \\{k_d\\}</span>  satisfy the route  <span class="math">\\Omega&#x27;_M \\to \\lambda_P</span> , then  <span class="math">K_d \\supset K_b</span> , because  <span class="math">K_d</span>  includes  <span class="math">K_b</span>  and  <span class="math">K_c</span> .</p></li>
      <li><p class="text-gray-300">In the impossible differential-linear attack, if we first guess  <span class="math">K_d</span> , then guess  <span class="math">K_a</span>  and filter wrong keys  <span class="math">K&#x27;_{il} = K_d \\cap K_a</span> , the correct keys  <span class="math">K_{il} = K_a K&#x27;_{il}</span>  remain. Reverse the &quot;order&quot;, if we first guess  <span class="math">K_a</span> , then guess  <span class="math">K_d</span>  and filter wrong keys  <span class="math">K&#x27;_{il} = K_d \\cap K_a</span> , the correct keys  <span class="math">K_{il}^{-1} = K_d K&#x27;_{il}</span>  remain.</p></li>
      <li><p class="text-gray-300">In fact,  <span class="math">\\Omega_P \\not\\to \\Omega_T</span>  is an impossible differential distinguisher; this distinguisher allows to launch an impossible difference attack and recover the correct keys  <span class="math">K_{id}</span> . We typically guess  <span class="math">K_b</span>  from  <span class="math">\\Omega&#x27;_M \\to \\Omega_T</span> , guess  <span class="math">K_a</span>  from  <span class="math">\\Omega_P \\to \\Omega_M</span> , filter wrong keys  <span class="math">K&#x27;_{id} = K_b \\cap K_a</span> , and obtain correct keys  <span class="math">K_{id} = K_a K&#x27;_{id}</span> . Reversing the &quot;order&quot;, we can obtain the correct keys  <span class="math">K_{id}^{-1} = K_b K&#x27;_{id}</span> .</p></li>
      <li><p class="text-gray-300">Obviously,  <span class="math">K&#x27;_{il} \\supseteq K&#x27;_{id}</span> , so  <span class="math">K_{il} \\subseteq K_{id}</span>  and  <span class="math">K_{il}^{-1} \\supseteq K_{id}^{-1}</span> .  <span class="math">K_{il} \\subseteq K_{id}</span>  means that our impossible difference-linear distinguisher can get the same correct keys or the same number of correct keys as an impossible differential distinguisher.  <span class="math">K_{il}^{-1} \\supseteq K_{id}^{-1}</span>  means that our impossible difference-linear distinguisher cannot be used in a wrong order.</p></li>
    </ul>

      <h3 id="sec-3.2" class="text-xl font-semibold mt-8">3.2 The Impossible Differential-Linear Attack</h3>

    <p class="text-gray-300">By our extended impossible differential-linear distinguisher,  <span class="math">\\Omega_P \\not\\to \\lambda_T</span> , we give an impossible differential-linear attack. Our impossible differential-linear attack procedure can be described as follows:</p>

    <ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li>Encrypting stage: Let M be the set of chosen plaintext pairs whose difference  <span class="math">P \\oplus P^*</span>  is  <span class="math">\\Omega_P</span> ; we encrypt distinct plaintexts in M. In  <span class="math">E_0</span> , we have  <span class="math">E_0(P) \\oplus E_0(P^*) \\neq \\Omega_T</span>  with probability 1. In  <span class="math">E_1</span> , we can get the equations</li>
    </ol>

    <p class="text-gray-300"><span class="math">$\\lambda_P \\cdot E_0(P) \\oplus \\lambda_T \\cdot E_1(E_0(P)) \\oplus \\lambda_K \\cdot K = 0 \\tag{1}</span>$</p>

    <p class="text-gray-300">and  <span class="math">\\lambda_P \\cdot E_0(P^*) \\oplus \\lambda_T \\cdot E_1(E_0(P^*)) \\oplus \\lambda_K \\cdot K = 0</span> . Both have probability 1/2 + q. Consequently, using the piling up lemma presented in [7], we can get</p>

    <p class="text-gray-300">
<span class="math">$\\lambda_P \\cdot (E_0(P) \\oplus E_0(P^*)) = \\lambda_T \\cdot E_1(E_0(P)) \\oplus \\lambda_T \\cdot E_1(E_0(P^*)) \\tag{2}</span>$</p>

    <p class="text-gray-300">with probability  <span class="math">1/2 + 2q^2</span> .</p>

    <ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li>Decrypting stage: In this stage we will guess part of the subkeys. Then we decrypt some rounds of the ciphertext pairs with the guessed subkeys. The decrypting process is also separated into two subciphers  <span class="math">E_1^{-1}</span>  and  <span class="math">E_0^{-1}</span> , i.e.,  <span class="math">D = E_0^{-1} \\circ E_1^{-1}</span> . In the first decrypting subcipher  <span class="math">E_1^{-1}</span> , take  <span class="math">\\lambda_P \\cdot \\Omega_T = \\pi</span>  into Eqn. (2), it can be rewritten as  <span class="math">\\lambda_T \\cdot E_1(E_0(P)) \\oplus \\lambda_T \\cdot E_1(E_0(P^*)) = \\lambda_P \\cdot \\Omega_T = \\pi</span> .</li>
    </ol>

    <p class="text-gray-300">In fact, we only partially decrypt all ciphertext pairs  <span class="math">(C, C^*)=(E_1(E_0(P)), E_1(E_0(P^*)))</span>  with each guessed subkeys in the first decrypting subcipher  <span class="math">E_1^{-1}</span> . The subkeys, with the maximal probability not suiting Eqn. (3)</p>

    <p class="text-gray-300">
<span class="math">$\\lambda_P \\cdot E_1^{-1}(C) \\oplus \\lambda_P \\cdot E_1^{-1}(C^*) = \\pi,</span>$
(3)</p>

    <p class="text-gray-300">is regard as the correct subkeys.</p>

    <p class="text-gray-300">Denote the set of pairs satisfying  <span class="math">E_1^{-1}(C) \\oplus E_1^{-1}(C^*) = \\Omega_T</span>  as T, and denote the set of pairs satisfying  <span class="math">\\lambda_P \\cdot E_1^{-1}(C) \\oplus \\lambda_P \\cdot E_1^{-1}(C^*) = \\pi</span>  as V. It is certain that  <span class="math">T \\subset V</span> .</p>

    <p class="text-gray-300">Property 1. For  <span class="math">T \\subset V</span> , if an impossible map  <span class="math">M \\not\\to V</span> , another impossible map  <span class="math">M \\not\\to T</span>  also holds.</p>

    <p class="text-gray-300"><em>Proof.</em> Assume that there is a map  <span class="math">\\bar{F}: M \\to T</span> . Randomly choose  <span class="math">p \\in M</span> , and compute  <span class="math">t = \\bar{F}(p) \\in T</span> . Since  <span class="math">T \\subset V</span> , we can get  <span class="math">t \\in V</span> , which indicates that there is  <span class="math">t = \\bar{F}(p) \\in V</span> , i.e., the map  <span class="math">\\bar{F}&#x27;: M \\to V</span>  holds. It contradicts to the known condition.</p>

    <ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li>Sieving stage: Guess part of the first rounds subkeys, and eliminate those wrong values by showing that the impossible property holds if these subkeys are used. That is, we eliminate those wrong values in terms of  <span class="math">E_0(P) \\oplus E_0(P^*) \\neq E_1^{-1}(C) \\oplus E_1^{-1}(C^*)</span> , where  <span class="math">\\lambda_P \\cdot E_1^{-1}(C) \\oplus \\lambda_P \\cdot E_1^{-1}(C^*) = \\pi</span> . From Property1, after sieving stage, the right values must satisfy that  <span class="math">E_0(P) \\oplus E_0(P^*) \\neq \\Omega_T</span> .</li>
    </ol>

    <p class="text-gray-300">Property 2. In Sieving stage, the success probability of sieving guessed values by  <span class="math">E_0(P) \\oplus E_0(P^*) \\neq E_1^{-1}(C) \\oplus E_1^{-1}(C^*)</span> , where  <span class="math">\\lambda_P \\cdot E_1^{-1}(C) \\oplus \\lambda_P \\cdot E_1^{-1}(C^*) = \\pi</span> , is much higher than the filtering probability using  <span class="math">E_0(P) \\oplus E_0(P^*) \\neq \\Omega_T</span> .</p>

    <p class="text-gray-300"><em>Proof.</em> In Sieving stage, we eliminate those wrong guessed key values which satisfy Eqn. (3). When the number of eliminated values is less than the total number, the more eliminated values, the higher successful sieving probability. After the first decrypting subcipher  <span class="math">E_1^{-1}</span> , The number of the key values satisfying Eqn. (3) is more than the number of the wrong key values with  <span class="math">E_1^{-1}(C) \\oplus E_1^{-1}(C^*) = \\Omega_T</span> . So <em>Property</em> 2 is established.</p>

    <p class="text-gray-300"><span class="math">\\Diamond</span></p>

    <p class="text-gray-300">We named all the above as an impossible differential-linear distinguisher. The probability of our distinguisher is dominated by the above steps 1-2, which can be estimated separately as follows. The success rates are  <span class="math">1/2+2q^2</span>  and 1 in Encrypting stage and Decrypting stage, respectively. Because our elimination principle is sieving the values using the condition  <span class="math">E_0(P) \\oplus E_0(P^*) \\neq E_1^{-1}(E_1(E_0(P))) \\oplus E_1^{-1}(E_1(E_0(P^*)))</span> , where  <span class="math">\\lambda_P \\cdot E_1^{-1}(E_1(E_0(P))) \\oplus \\lambda_P \\cdot E_1^{-1}(E_1(E_0(P^*))) = \\pi</span> , the total probability of our distinguisher is  <span class="math">1 - (1/2 + 2q^2)</span> , i.e.,  <span class="math">1/2 - 2q^2</span> . The key recovery attack requires about  <span class="math">8 \\times O(q^{-4})</span>  chosen plaintext pairs.</p>

      <h3 id="sec-3.3" class="text-xl font-semibold mt-8">3.3 The Impossible Differential-Linear Attack</h3>

    <p class="text-gray-300">In this section, we first present a 13-round impossible differential-linear distinguisher, which consists of a 9-round impossible differential characteristic followed by a 4-round linear approximation.</p>

      <h3 id="sec-4.1" class="text-xl font-semibold mt-8">4.1 9-Round Impossible Differential Characteristic</h3>

    <p class="text-gray-300">Paper [10] presented several 9-round impossible differential characteristics. We choose the following one that is the most efficient and suitable to our attack:</p>

    <p class="text-gray-300"><span class="math">$(0, \\varpi, 0, 0) \\not\\to (0, \\beta, 0, 0), \\text{ where } \\varpi = (0, 0, 0, x), \\beta = (y, 0, 0, 0)</span>$</p>

    <p class="text-gray-300"><span class="math">\\Diamond</span></p>

    <p class="text-gray-300">    <img src="_page_7_Figure_2.jpeg" alt="" class="my-4 max-w-full" />
</p>

    <p class="text-gray-300">Fig. 2. 13-round extended impossible differential-linear distinguisher</p>

    <p class="text-gray-300">After the encryption of 9 rounds, the input difference of the  <span class="math">10^{th}</span>  round cannot have the following form:</p>

    <p class="text-gray-300">
<span class="math">$\\Delta X_9 = (\\Delta X_9^0, \\Delta X_9^1, \\Delta X_9^2, \\Delta X_9^3) = (\\beta, 0, 0, 0) \\tag{4}</span>$</p>

    <p class="text-gray-300">with probability 1 as illustrated in Fig.2.</p>

      <h3 id="sec-4.2" class="text-xl font-semibold mt-8">4.2 4-Round Linear Characteristic</h3>

    <p class="text-gray-300">Here we will describe the construction of a 4-round linear characteristic illustrated in Fig.2, which is from round 10 to round 13. Details of the 4-round linear characteristic are described as follows.</p>

    <p class="text-gray-300">In the  <span class="math">10^{th}</span>  round, we get  <span class="math">X_9^0=X_{10}^3</span>  .</p>

    <p class="text-gray-300">In the  <span class="math">11^{th}</span>  round, based on the definition of the round function  <span class="math">F_1</span> , we can get the following two equations:</p>

    <p class="text-gray-300"><span class="math">$X_{10}^3 \\oplus F_1(X_{10}^2, RK_{21}) = X_{11}^2, X_{10}^2 = X_{11}^1</span>$</p>

    <p class="text-gray-300">Using linear approximations for the non-linear S-boxes in  <span class="math">F_1</span> , we can get the following equation.</p>

    <p class="text-gray-300"><span class="math">$\\lambda_P \\cdot F_1(X_{11}^1, RK_{21}) = \\lambda_Q \\cdot X_{11}^1 \\oplus \\lambda_Q \\cdot RK_{21}</span>$</p>

    <p class="text-gray-300">As a result, the linear characteristic of the  <span class="math">11^{th}</span>  round can be expressed by the following equation:</p>

    <p class="text-gray-300">
<span class="math">$\\lambda_P \\cdot X_{10}^3 = \\lambda_P \\cdot X_{11}^2 \\oplus \\lambda_Q \\cdot X_{11}^1 \\oplus \\lambda_Q \\cdot RK_{21}, p_1 = 1/2 + q_1 \\tag{5}</span>$</p>

    <p class="text-gray-300">Similarly, the linear characteristic of the  <span class="math">12^{th}</span>  round can be expressed as</p>

    <p class="text-gray-300">
<span class="math">$\\lambda_Q \\cdot X_{11}^1 = \\lambda_Q \\cdot X_{12}^0 \\oplus \\lambda_T \\cdot X_{12}^3 \\oplus \\lambda_T \\cdot RK_{22}, p_2 = 1/2 + q_2 \\tag{6}</span>$</p>

    <p class="text-gray-300">In the  <span class="math">13^{th}</span>  round, we can first get the following equation</p>

    <p class="text-gray-300">
<span class="math">$X_{12}^1 \\oplus F_0(X_{12}^0, RK_{24}) = X_{13}^0, X_{12}^0 = X_{13}^3</span>$</p>

    <p class="text-gray-300">Next, we can choose an appropriate pair of values  <span class="math">(\\lambda_P, \\lambda_Q)</span>  by taking the linear characteristics expressed in Eqn .(5) and Eqn. (6) into account and get the linear characteristic of the  <span class="math">13^{th}</span>  round as follows:</p>

    <p class="text-gray-300">
<span class="math">$\\lambda_P \\cdot X_{12}^1 = \\lambda_P \\cdot X_{13}^0 \\oplus \\lambda_Q \\cdot X_{13}^3 \\oplus \\lambda_Q \\cdot RK_{24}, p_3 = 1/2 + q_3 \\tag{7}</span>$</p>

    <p class="text-gray-300">Finally, by concentrating the above linear characteristics of rounds 10-13 together, we can have the following property:</p>

    <p class="text-gray-300">Property 3. If Eqn .(5)-(7) hold, we can get the following 4-round linear characteristic of CLEFIA from round 10 to round 13:</p>

    <p class="text-gray-300">
<span class="math">$\\lambda_{P} \\cdot X_{9}^{0} = \\lambda_{P} \\cdot X_{10}^{3} = \\lambda_{P} \\cdot X_{13}^{0} \\oplus \\lambda_{T} \\cdot X_{12}^{3} \\oplus \\lambda_{K} \\cdot K&#x27;, p = 1/2 + 2^{2}q_{1}q_{2}q_{3}</span>$
(8)</p>

    <p class="text-gray-300"><em>Proof.</em> If Eqn. (5)-(7) are true, this property is obvious from the CLEFIA structure.</p>

    <p class="text-gray-300"><span class="math">\\Diamond</span></p>

    <p class="text-gray-300">Note 1. Similarly, if we arbitrarily choose a 4-round CLEFIA from round  <span class="math">i(i \\ge 0)</span>  to round i + 3, we can rewrite Eqn. (5)-(7) as following Eqn. (5')-(7'):</p>

    <p class="text-gray-300"><span class="math">$\\lambda_P \\cdot X_{i+1}^3 = \\lambda_P \\cdot X_{i+2}^2 \\oplus \\lambda_Q \\cdot X_{i+2}^1 \\oplus \\lambda_Q \\cdot RK_{2(i+1)+1}, p_1&#x27; = 1/2 + q_1&#x27; \\qquad (5&#x27;)</span>$</p>

    <p class="text-gray-300"><span class="math">$\\lambda_Q \\cdot X_{i+2}^1 = \\lambda_Q \\cdot X_{i+3}^0 \\oplus \\lambda_T \\cdot X_{i+3}^3 \\oplus \\lambda_T \\cdot RK_{2(i+2)}, p_2&#x27; = 1/2 + q_2&#x27;</span>$
(6')</p>

    <p class="text-gray-300"><span class="math">$\\lambda_P \\cdot X_{i+3}^1 = \\lambda_P \\cdot X_{i+4}^0 \\oplus \\lambda_Q \\cdot X_{i+4}^3 \\oplus \\lambda_Q \\cdot RK_{2(i+3)}, p_3&#x27; = 1/2 + q_3&#x27;</span>$
(7')</p>

    <p class="text-gray-300">and we can obtain the following 4-round linear characteristic</p>

    <p class="text-gray-300"><span class="math">$\\lambda_{P} \\cdot X_{i}^{0} = \\lambda_{P} \\cdot X_{i+1}^{3} = \\lambda_{P} \\cdot X_{i+4}^{0} \\oplus \\lambda_{T} \\cdot X_{i+3}^{3} \\oplus \\lambda_{K} \\cdot K^{&#x27;}, p&#x27; = 1/2 + 2^{2}q_{1}&#x27;q_{2}&#x27;q_{3}&#x27;</span>$</p>

    <p class="text-gray-300"><strong>4-Round Linear Approximations.</strong> Furthermore, we can derive the 4-round linear input mask from the above 4-round linear characteristic.</p>

    <p class="text-gray-300">Let  <span class="math">(v, u)_{RK_k}</span>  be an approximation of a 32-bit invertible function  <span class="math">F_s(X_j^i, RK_k)</span> ,  <span class="math">(0 \\le s \\le 1, 0 \\le k \\le 35)</span> . Eqn. (5) suggests that the linear approximation of function  <span class="math">F_1(X_{10}^2, RK_{21})</span>  is</p>

    <p class="text-gray-300">
<span class="math">$(v,u)_{RK_{21}} = (\\lambda_Q, \\lambda_P) \\tag{9}</span>$</p>

    <p class="text-gray-300">Eqn. (6) indicates that the linear approximation of function  <span class="math">F_0(X_{11}^0, RK_{22})</span>  is</p>

    <p class="text-gray-300">
<span class="math">$(v,u)_{RK_{22}} = (\\lambda_T, \\lambda_Q) \\tag{10}</span>$</p>

    <p class="text-gray-300">and Eqn. (7) indicates</p>

    <p class="text-gray-300">
<span class="math">$(v,u)_{RK_{24}} = (\\lambda_Q, \\lambda_P). \\tag{11}</span>$</p>

    <p class="text-gray-300">Denoting the input mask of the  <span class="math">j^{th}</span>  32-bit input data in the  <span class="math">i^{th}</span>  round as  <span class="math">IM_{X_{i-1}^j}(1\\leq i\\leq 16,0\\leq j\\leq 3)</span> , which is also the output mask of the  <span class="math">((j+1)mod4)^{th}</span>  output data in the  <span class="math">(i-1)^{th}</span>  round, we can get  <span class="math">IM_{X_{10}^3}=IM_{X_{11}^2}=\\lambda_P</span>  from Eqn. (9),  <span class="math">IM_{X_{11}^1}=IM_{X_{12}^0}=\\lambda_Q</span>  and  <span class="math">IM_{X_{12}^3}=\\lambda_T</span>  from Eqn. (10), and  <span class="math">IM_{X_{10}^1}=IM_{X_{10}^0}=\\lambda_P</span>  from Eqn. (11). In addition, we can also derive  <span class="math">IM_{X_{10}^2}=0</span> ,  <span class="math">IM_{X_{10}^1}=0</span> , and  <span class="math">IM_{X_{10}^1}=0</span> , and so on.</p>

    <p class="text-gray-300">As a result, we can derive some 128-bit input masks as follows:</p>

    <p class="text-gray-300">Property 4. If Property 3 holds, the 128-bit input masks of 4-round CLEFIA are:</p>

    <p class="text-gray-300">In the 10<sup>th</sup> round:  <span class="math">IM_{X_9} = (IM_{X_0^0}, IM_{X_0^1}, IM_{X_0^2}, IM_{X_0^3}) = (\\lambda_P, 0, 0, 0)</span> .</p>

    <p class="text-gray-300">In the 11<sup>th</sup> round:  <span class="math">IM_{X_{10}} = (IM_{X_{10}}^{\\circ}, IM_{X_{10}}^{\\circ}, IM_{X_{10}}^{\\circ}, IM_{X_{10}}^{\\circ}) = (0, 0, 0, \\lambda_P).</span></p>

    <p class="text-gray-300">In the  <span class="math">12^{th}</span>  round:  <span class="math">IM_{X_{11}} = (IM_{X_{11}^0}, IM_{X_{11}^1}, IM_{X_{11}^2}, IM_{X_{11}^3}) = (\\theta, \\lambda_Q, \\lambda_P, \\theta).</span></p>

    <p class="text-gray-300">In the 13<sup>th</sup> round:  <span class="math">IM_{X_{12}} = (IM_{X_{12}^0}, IM_{X_{12}^1}, IM_{X_{12}^2}, IM_{X_{12}^3}) = (\\lambda_Q, \\lambda_P, \\theta, \\lambda_T).</span></p>

    <p class="text-gray-300">In the 14<sup>th</sup> round,  <span class="math">IM_{X_{13}} = (IM_{X_{13}^0}, IM_{X_{13}^1}, IM_{X_{13}^2}, IM_{X_{13}^3}) = (\\lambda_P, *, \\lambda_T, \\theta)</span> , where &quot;*&quot; denotes an unknow 32-bit input mask.</p>

    <p class="text-gray-300">Note 2. If a 4-round CLEFIA, from round  <span class="math">i(i \\geq 0)</span>  to round i+3, satisfies Eqn. (5')-(7'), their 128-bit input masks are  <span class="math">IM_{X_i} = (\\lambda_P, \\theta, \\theta, \\theta)</span> ,  <span class="math">IM_{X_{i+1}} = (\\theta, \\theta, \\theta, \\lambda_P)</span> ,  <span class="math">IM_{X_{i+2}} = (\\theta, \\lambda_Q, \\lambda_P, \\theta)</span> , and  <span class="math">IM_{X_{i+3}} = (\\lambda_Q, \\lambda_P, \\theta, \\lambda_T)</span> , respectively. Additionally,  <span class="math">IM_{X_{i+4}} = (\\lambda_P, *, \\lambda_T, \\theta)</span> .</p>

      <h3 id="sec-4.3" class="text-xl font-semibold mt-8">4.3 The 13-Round Extended Impossible Differential-Linear Distinguisher</h3>

    <p class="text-gray-300">Here, we first propose a new property, impossible differential-linear property, which is a concatenation of impossible differential characteristic and linear characteristic. To concatenate the above two parts together, the core technology resides in how to link the output differential  <span class="math">\\Delta X_9 = (\\beta, 0, 0, 0)</span>  and the input masks  <span class="math">IM_{X_9} = (\\lambda_P, 0, 0, 0)</span>  of the  <span class="math">10^{th}</span>  round together?</p>

    <p class="text-gray-300">From section 4.1, we have  <span class="math">\\beta = (y, 0, 0, 0), y \\in F_2^8 \\setminus \\{0\\}</span> . If choosing  <span class="math">\\lambda_P = (0, \\lambda_1, \\lambda_1, \\lambda_1), \\lambda_1 \\in \\{01, 02, ...ff\\}</span> , by Eqn. (4), we can get the following equation with probability 1:</p>

    <p class="text-gray-300">
<span class="math">$\\lambda_P \\cdot \\Delta X_9^0 = \\lambda_P \\cdot (X_9^0 \\oplus X_9^{0*}) = 0.</span>$
(12)</p>

    <p class="text-gray-300">As a result, we always have  <span class="math">IM_{X_9} \\cdot \\Delta X_9 = (0,0,0,0)</span>  in the  <span class="math">10^{th}</span>  round, which links the output differential  <span class="math">\\Delta X_9</span>  and the input masks  <span class="math">IM_{X_9}</span>  together.</p>

    <p class="text-gray-300">Property 5. For a pair of plaintexts  <span class="math">(P, P^*)</span>  whose difference is  <span class="math">(0, \\varpi, 0, 0)</span>  with  <span class="math">\\varpi = (0, 0, 0, x)</span> , if we choose  <span class="math">\\lambda_P = (0, \\lambda_1, \\lambda_1, \\lambda_1), \\lambda_1 \\in \\{01, 02, ...ff\\}</span> , the 4-round linear characteristic can be concatenated to the 9-round impossible differential characteristic based on Eqn. (8) and Eqn. (12) to form the following 13-round impossible differential-linear distinguisher.</p>

    <p class="text-gray-300"><span class="math">$\\lambda_P \\cdot (X_{13}^0 \\oplus X_{13}^{0*}) \\oplus \\lambda_T \\cdot (X_{12}^3 \\oplus X_{12}^{3*}) = 0 \\tag{13}</span>$</p>

    <p class="text-gray-300">Details of another 13-round impossible differential distinguisher are discussed in Appendix A.</p>

      <h3 id="sec-4.4" class="text-xl font-semibold mt-8">4.4 Selection of <span class="math">\\lambda</span></h3>

    <p class="text-gray-300">In this subsection, we show how to select the values for  <span class="math">\\lambda_P, \\lambda_Q</span>  and  <span class="math">\\lambda_T</span>  to make the bias of the 4-round linear characteristic as high as possible.</p>

    <p class="text-gray-300">At first, we analyze the linear approximation of  <span class="math">F_1</span>  in the  <span class="math">11^{th}</span>  round as follows.</p>

    <p class="text-gray-300"><span class="math">$\\lambda_P \\cdot F_1(X_{11}^1, RK_{21}) = \\lambda_Q \\cdot X_{11}^1 \\oplus \\lambda_Q \\cdot RK_{21}</span>$</p>

    <p class="text-gray-300">The four bytes output of the S-boxes are denoted as (u, v, z, w). Then the round function can be expressed as:</p>

    <p class="text-gray-300"><span class="math">$F_1(X_{11}^1, RK_{21}) = M_1(S(X_{11}^1 \\oplus RK_{21})) = M_1(u, v, z, w)</span>$</p>

    <p class="text-gray-300">According to the definition in section 2, we can get the following equation:</p>

    <p class="text-gray-300"><span class="math">$M_1(u, v, z, w)^T = \\begin{pmatrix} u \\oplus (08 \\times v) \\oplus (02 \\times z) \\oplus (0a \\times w) \\\\ (08 \\times u) \\oplus v \\oplus (0a \\times z) \\oplus (02 \\times w) \\\\ (02 \\times u) \\oplus (0a \\times v) \\oplus z \\oplus (08 \\times w) \\\\ (0a \\times u) \\oplus (02 \\times v) \\oplus (08 \\times z) \\oplus w \\end{pmatrix}</span>$</p>

    <p class="text-gray-300">Next, based on the discussion in section 4.3 about how to choose value for  <span class="math">\\lambda_P</span> , the left part of the linear approximation can be computed as follows:</p>

    <p class="text-gray-300"><span class="math">$\\lambda_P \\cdot F_1(X_{11}^1, RK_{21}) = \\{00 \\ \\lambda_1 \\ \\lambda_1 \\ \\lambda_1\\} \\cdot M_1(u, v, z, w)^T</span>$
<span class="math">$= \\lambda_1 \\cdot (v \\oplus (08 \\times v) \\oplus z \\oplus (02 \\times z) \\oplus w \\oplus (0a \\times w))</span>$</p>

    <p class="text-gray-300">Note that the primitive polynomial used in the multiplication is  <span class="math">z^8 + z^4 + z^3 + z^2 + 1</span> , which can be denoted as a binary string 100011101. Hence, we can compute the parity of  <span class="math">\\lambda_1 \\cdot (02 \\times z)</span>  as follows:</p>

    <p class="text-gray-300"><span class="math">$\\lambda_1 \\cdot (02 \\times z) = \\begin{cases} \\lambda_1 \\cdot (z &lt;&lt; 1), &amp; z_7 = 0\\\\ \\lambda_1 \\cdot (z &lt;&lt; 1 \\oplus 00011101), &amp; z_7 = 1 \\end{cases}</span>$</p>

    <p class="text-gray-300">where  <span class="math">z_7</span>  denotes the left-most bit of z. By choosing an appropriate value of  <span class="math">\\lambda_1</span>  such that  <span class="math">\\lambda_1 \\cdot 00011101 = 0</span> , the above two cases can both be transformed into the following equation:</p>

    <p class="text-gray-300"><span class="math">$\\lambda_1 \\cdot (02 \\times z) = \\lambda_1 \\cdot (z &lt;&lt; 1) = (\\lambda_1 &gt;&gt; 1) \\cdot z</span>$</p>

    <p class="text-gray-300">no matter what the left-most bit of z is.</p>

    <p class="text-gray-300">Similarly, when  <span class="math">\\lambda_1</span>  also satisfies  <span class="math">(\\lambda_1 &gt;&gt; 1) \\cdot 00011101 = 0</span> , the parity of  <span class="math">\\lambda_1 \\cdot (08 \\cdot v)</span>  and  <span class="math">\\lambda_1 \\cdot (0a \\cdot w)</span>  can be computed respectively as follows:</p>

    <p class="text-gray-300"><span class="math">$\\lambda_1 \\cdot (08 \\times v) = \\lambda_1 \\cdot (v \\ll 3) = (\\lambda_1 \\gg 3) \\cdot v</span>$</p>

    <p class="text-gray-300"><span class="math">$\\lambda_1 \\cdot (0a \\times w) = \\lambda_1 \\cdot ((02 \\times w) \\oplus (08 \\times w)) = ((\\lambda_1 &gt;&gt; 1) \\oplus (\\lambda_1 &gt;&gt; 3)) \\cdot w</span>$</p>

    <p class="text-gray-300">Therefore, the left part of the linear approximation can be transformed into the following equation:</p>

    <p class="text-gray-300"><span class="math">$\\lambda_P \\cdot F_1(X_{11}^1, RK_{21})</span>$</p>

    <p class="text-gray-300"><span class="math">$= (\\lambda_1 \\oplus (\\lambda_1 &gt;&gt; 3)) \\cdot v \\oplus (\\lambda_1 \\oplus (\\lambda_1 &gt;&gt; 1)) \\cdot z \\oplus (\\lambda_1 \\oplus (\\lambda_1 &gt;&gt; 1) \\oplus (\\lambda_1 &gt;&gt; 3)) \\cdot w</span>$</p>

    <p class="text-gray-300">=
<span class="math">$\\{00, \\lambda_1 \\oplus (\\lambda_1 &gt;&gt; 3), \\lambda_1 \\oplus (\\lambda_1 &gt;&gt; 1), \\lambda_1 \\oplus (\\lambda_1 &gt;&gt; 1) \\oplus (\\lambda_1 &gt;&gt; 3)\\} \\cdot (u, v, z, w)</span>$</p>

    <p class="text-gray-300">By utilizing the linear distribution table of each S-box, we use the following linear approximation for each S-box ( <span class="math">\\varepsilon</span>  denotes the bias of the linear approximation).</p>

    <p class="text-gray-300"><span class="math">$(\\lambda_1 \\oplus (\\lambda_1 &gt;&gt; 3)) \\cdot v = \\lambda_2 \\cdot (X_{11}^1 \\oplus RK_{21})_1, \\quad p_4 = 1/2 + \\varepsilon_1</span>$</p>

    <p class="text-gray-300"><span class="math">(\\lambda_1 \\oplus (\\lambda_1 &gt;&gt; 1)) \\cdot z = \\lambda_2 \\cdot (X_{11}^1 \\oplus RK_{21})_2, \\quad p_5 = 1/2 + \\varepsilon_2</span></p>

    <p class="text-gray-300"><span class="math">$(\\lambda_1 \\oplus (\\lambda_1 &gt;&gt; 1) \\oplus (\\lambda_1 &gt;&gt; 3)) \\cdot w = \\lambda_2 \\cdot (X_{11}^1 \\oplus RK_{21})_3, \\quad p_6 = 1/2 + \\varepsilon_3</span>$</p>

    <p class="text-gray-300">where  <span class="math">(X_{11}^1 \\oplus RK_{21})_j</span>  stands for the  <span class="math">j^{th}</span>  byte of  <span class="math">(X_{11}^1 \\oplus RK_{21})(0 \\le j \\le 3)</span> , and (u, v, z, w) denotes the corresponding output of each S-box respectively.</p>

    <p class="text-gray-300">As a result, we get the following linear approximation for the function  <span class="math">F_1</span>  in the  <span class="math">11^{th}</span>  round.</p>

    <p class="text-gray-300"><span class="math">$\\lambda_P \\cdot F_1(X_{11}^1 \\oplus RK_{21}) = \\{00, \\lambda_2, \\lambda_2, \\lambda_2\\} \\cdot (X_{11}^1 \\oplus RK_{21}), \\quad p = 1/2 + 2^2 \\varepsilon_1 \\varepsilon_2 \\varepsilon_3</span>$</p>

    <p class="text-gray-300">Note that we choose  <span class="math">\\lambda_Q</span>  as the form of  <span class="math">\\lambda_Q = \\{00, \\lambda_2, \\lambda_2, \\lambda_2\\}</span> , such that we can make use of the property of the linear transformation as described in section 4.1.</p>

    <p class="text-gray-300">Similar analysis can be applied to the linear approximation used in the  <span class="math">12^{th}</span>  and  <span class="math">13^{th}</span>  round. By running through all the possible values of  <span class="math">\\lambda_P</span> ,  <span class="math">\\lambda_Q</span>  and  <span class="math">\\lambda_T</span>  that satisfies the above conditions, we can choose the following three linear approximations which achieve the highest biases.</p>

    <p class="text-gray-300"><span class="math">$\\{00, f6, f6, f6\\} \\cdot F_1(X_{11}^1 \\oplus RK_{21}) = \\{00, eb, eb, eb\\} \\cdot (X_{11}^1 \\oplus RK_{21})</span>$</p>

    <p class="text-gray-300">whose probability is  <span class="math">p \\approx 1/2 - 2^{-11.61}</span> .</p>

    <p class="text-gray-300"><span class="math">$\\{00, eb, eb, eb\\} \\cdot F_0(X_{12}^3 \\oplus RK_{22}) = \\{00, 49, 49, 49\\} \\cdot (X_{12}^3 \\oplus RK_{22})</span>$</p>

    <p class="text-gray-300">whose probability is  <span class="math">p \\approx 1/2 - 2^{-10.83}</span> .</p>

    <p class="text-gray-300"><span class="math">$\\{00, f6, f6, f6\\} \\cdot F_0(X_{13}^3 \\oplus RK_{24}) = \\{00, eb, eb, eb\\} \\cdot (X_{13}^3 \\oplus RK_{24})</span>$</p>

    <p class="text-gray-300">whose probability is  <span class="math">p \\approx 1/2 - 2^{-10.19}</span> .</p>

    <p class="text-gray-300">Plugging the corresponding values of  <span class="math">\\lambda_P, \\lambda_Q</span>  and  <span class="math">\\lambda_T</span>  into Eqn. (5)-(8), we can get the following 3-round linear characteristic of CLEFIA.</p>

    <p class="text-gray-300"><span class="math">$\\{00, f6, f6, f6\\} \\cdot X_{10}^{3} = \\{00, f6, f6, f6\\} \\cdot X_{13}^{0} \\oplus \\{00, 49, 49, 49\\} \\cdot X_{12}^{3} \\oplus \\lambda_{K} \\cdot K&#x27;</span>$
(14)</p>

    <p class="text-gray-300">whose probability is  <span class="math">p \\approx 1/2 - 2^{-30.63}</span> .</p>

    <p class="text-gray-300">Finally, the decrypting stage of the 13-round impossible differential-linear distinguisher can be expressed as:</p>

    <p class="text-gray-300"><span class="math">$\\{00, f6, f6, f6\\} \\cdot (X_{13}^{0} \\oplus X_{13}^{0*}) \\oplus \\{00, 49, 49, 49\\} \\cdot (X_{12}^{3} \\oplus X_{12}^{3*}) = 0</span>$
(15)</p>

    <p class="text-gray-300">The total probability of the 13-round impossible differential-linear distinguisher can be computed as described in section 3, which is about  <span class="math">1/2 - 2^{-60.26}</span> .</p>

    </section>

    <section id="sec-5" class="mb-10">
      <h2 class="text-2xl font-bold">5 The Impossible Differential-Linear Attack on 16-Round CLEFIA-128</h2>

    <p class="text-gray-300">In this section, we explain our impossible differential-linear attack on 16-round CLEFIA-128 with whitening keys. In this attack, we set the above 13-round impossible differential-linear distinguisher as rounds 3-15, and extend two rounds backward and one round forward as shown in Fig.3.</p>

    <p class="text-gray-300">The expression of the decrypting stage of the 13-round impossible differential-linear distinguisher should be transformed to the following form:</p>

    <p class="text-gray-300">
<span class="math">$\\{00, f6, f6, f6\\} \\cdot (X_{15}^0 \\oplus X_{15}^{0*}) \\oplus \\{00, 49, 49, 49\\} \\cdot (X_{14}^3 \\oplus X_{14}^{3*}) = 0, \\tag{16}</span>$</p>

    <p class="text-gray-300">and the total probability of the 13-round extended impossible differential-linear distinguisher is around  <span class="math">1/2 - 2^{-60.26}</span> , theoretically. Based on the analysis in section 3, we can know that approximately  <span class="math">12 \\times (2^{-61.26})^{-2} \\approx 2^{126.1}</span>  correct pairs are needed to mount the key recovery attack.</p>

    <p class="text-gray-300">In the following, we first introduce how to obtain the plaintext pairs, then describe the attack procedure in detail as illustrated in Fig.3. In the end, we estimate the data complexity and time complexity of our attack.</p>

      <h3 id="sec-5.1" class="text-xl font-semibold mt-8">5.1 Chosen Plaintext</h3>

    <p class="text-gray-300">We choose a structure composed of  <span class="math">2^{72}</span>  plaintexts that is defined as follows:</p>

    <p class="text-gray-300"><span class="math">$S_P = (X_0^0, X_0^1, X_0^2, X_0^3)_j, 1 \\le j \\le 2^{72},</span>$</p>

    <p class="text-gray-300">If we choose plaintext pairs  <span class="math">(P,P^*)</span>  where  <span class="math">P=(X_0^0,X_0^1,X_0^2,X_0^3)</span>  and  <span class="math">P^*=(X_0^{0*},X_0^{1*},X_0^{2*},X_0^{3*})=(X_0^0\\oplus\\delta,X_0^1\\oplus\\gamma,X_0^2,X_0^3\\oplus\\varpi)</span> , whose difference takes the form  <span class="math">\\Delta P=(\\delta,\\gamma,0,\\varpi)</span>  with  <span class="math">\\varpi=(0,0,0,x),\\ \\delta=(aw,2w,8w,w),\\ w=M_0(S(x&#x27;))\\oplus M_0(S(x&#x27;\\oplus x))\\ (x&#x27;\\in F_2^8)</span> , and  <span class="math">\\gamma=(v_0,v_1,v_2,v_3)</span> . We can get  <span class="math">\\Delta X_2=(0,\\varpi,0,0)</span> . For the computations of  <span class="math">\\delta</span>  and  <span class="math">\\gamma</span> , please refer to Fig.3. Thus, we have 255 possible values of both  <span class="math">\\varpi</span>  and  <span class="math">\\delta,2^{32}-1</span>  possible values of  <span class="math">\\gamma</span> , and one structure can produce about  <span class="math">2^{119}</span>  distinct plaintext pairs.</p>

    <p class="text-gray-300">    <img src="_page_13_Figure_2.jpeg" alt="" class="my-4 max-w-full" />
</p>

    <p class="text-gray-300">Fig. 3. 16-round impossible differential-linear attack</p>

      <h3 id="sec-5.2" class="text-xl font-semibold mt-8">5.2 The Impossible Differential-Linear Attack on 16-Round CLEFIA-128 with Whitening Keys</h3>

    <p class="text-gray-300">In the following, we will discuss our impossible differential-linear attack on 16-round CLEFIA-128 with whitening keys in detail. In Fig.3, plaintext  <span class="math">P=X_0</span> , ciphertext  <span class="math">C=X_{16}</span> .</p>

    <p class="text-gray-300">Step 1. Take  <span class="math">2^{50.73}</span>  structures defined above, i.e.  <span class="math">2^{72} \\times 2^{50.73} = 2^{122.73}</span>  plaintexts, so  <span class="math">2^{119} \\times 2^{50.73} = 2^{169.73}</span>  plaintext pairs. Encrypt  <span class="math">2^{122.73}</span>  distinct plaintexts for 16 rounds. Insert all ciphertexts into a table  <span class="math">T_0</span>  indexed by  <span class="math">X_{15}^0</span> ,  <span class="math">(X_{15}^0 = X_{16}^0)</span> .</p>

    <p class="text-gray-300">Step 2. Let 32-bit subkey  <span class="math">RK_{30}</span>  and 24-bit subkey  <span class="math">(RK_{29} \\oplus WK_2)</span>  be indexed by  <span class="math">N_1, \\ldots, N_{2^{56}}</span>  and reset  <span class="math">N_i (1 \\le i \\le 2^{56})</span> .</p>

    <p class="text-gray-300">Create a table  <span class="math">T_1</span>  of  <span class="math">F_0(X_{15}^0,RK_{30})</span> , indexed by all  <span class="math">2^{32}</span>  values of  <span class="math">RK_{30}</span>  and  <span class="math">2^{32}</span>  values of  <span class="math">X_{15}^0</span> . For every guess of  <span class="math">RK_{30}</span>  (32-bit), look up the value of  <span class="math">F_0(X_{15}^0,RK_{30})</span>  in  <span class="math">T_1</span>  for each  <span class="math">X_{15}^0</span> , and obtain the value of  <span class="math">X_{15}^1 \\oplus WK_2 = X_{16}^1 \\oplus F_0(X_{15}^0,RK_{30})</span>  for each  <span class="math">X_{16}^1</span> . Select only the pairs whose difference are equal in the first byte of  <span class="math">(X_{15}^1 \\oplus WK_2)</span> , the expected number of such pairs is  <span class="math">2^{169.73} \\times 2^{-8} = 2^{161.73}</span> .</p>

    <p class="text-gray-300">Then for every guess of the last three bytes of subkey  <span class="math">RK_{29} \\oplus WK_2</span>  (24-bit), we can partially compute the value of  <span class="math">\\lambda_Q \\cdot X_{14}^3 = \\lambda_Q \\cdot (F_1(X_{15}^1 \\oplus WK_2, RK_{29} \\oplus WK_2) \\oplus X_{16}^2)</span>  for each  <span class="math">X_{16}^2</span> , and the value of  <span class="math">\\lambda_P \\cdot X_{15}^0 \\oplus \\lambda_Q \\cdot X_{14}^3</span> . If the pair satisfies Eqn. (16), increment the corresponding  <span class="math">N_i</span>  by 1.</p>

    <p class="text-gray-300">After running all  <span class="math">2^{56}</span>  guesses, we output the minimum value of  <span class="math">N_i</span>  as the 56-bit correct subkeys. Based on the analysis in section 3 and [1,7], we know that approximately  <span class="math">8 \\times (2^{60.26})^2 \\approx 2^{123.52}</span>  plaintext pairs are needed for the 13-round impossible linear distinguisher, we expect to have  <span class="math">2^{38.21}</span>  pairs left with this condition.</p>

    <ul class="list-disc list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li>Step 3. We eliminate those wrong 40-bit values for the first two rounds subkey  <span class="math">(RK_0, RK_3^3)</span>  (The first three zero bytes of  <span class="math">\\varpi</span>  only lead to the last byte of  <span class="math">RK_3</span>  that affects  <span class="math">\\Delta F_1</span> , so 32-bit  <span class="math">RK_0</span>  and 8-bit  <span class="math">RK_3</span> ) by showing that the impossible property holds if these subkeys are used. To do so, we use a precomputation stage. At this precomputation stage, we consider all pairs whose difference  <span class="math">(\\Delta X_2^0, \\Delta X_2^1, \\Delta X_2^2, \\Delta X_2^3) = (0, \\varpi, 0, 0)</span>  after the first two rounds encryption. To achieve this, we need to perform two step, the first step makes sure that  <span class="math">\\Delta X_1^0 = 0</span> , and the second step enables  <span class="math">\\Delta X_2^2 = 0</span> .    <ul class="list-disc list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li>1). If  <span class="math">\\Delta X_1^0 = 0</span> , there are  <span class="math">2^{32}</span>  possible values for  <span class="math">X_1^0</span> . We perform  <span class="math">A_1 = F_0^{-1}(X_1^0 \\oplus WK_0 \\oplus X_0^1)</span>  and create a hash table  <span class="math">H_1</span>  containing one of the outputs of  <span class="math">A_1</span>  and the XOR of the two outputs  <span class="math">(X_0^0 \\oplus RK_0)</span> . There are  <span class="math">2^{32}</span>  possible values for  <span class="math">(X_0^0 \\oplus RK_0)</span> , and on average one value of  <span class="math">X_1^0</span>  corresponds to each value of  <span class="math">(X_0^0 \\oplus RK_0)</span> . Now for each of the  <span class="math">2^{38.21}</span>  remaining pairs we compute  <span class="math">(X_0^0 \\oplus RK_0)</span> , and use the table  <span class="math">H_1</span>  to fetch one possibility of  <span class="math">X_1^0</span>  that corresponds to the computed  <span class="math">(X_0^0 \\oplus RK_0)</span> . The process identifies roughly one wrong value for the subkey  <span class="math">RK_0</span>  by XORing the plaintext and  <span class="math">A_1</span> . The probability of a wrong 32-bit value for  <span class="math">RK_0</span>  is  <span class="math">(1-2^{-32})</span> . After analyzing all  <span class="math">2^{38.21}</span>  pairs, we expect only  <span class="math">2^{32} \\times (1-2^{-32})^{2^{38.21} \\times 1} \\approx 2^{-75}</span>  wrong values of  <span class="math">RK_0</span>  remaining.</li>
      <li>2). In round 2, if  <span class="math">\\Delta X_2^2 = 0</span> , there are  <span class="math">2^{32}</span>  possible values for  <span class="math">X_2^2</span> . We perform  <span class="math">A_2 = F_1^{-1}(X_2^2 \\oplus X_1^3) = F_1^{-1}(X_2^2 \\oplus X_0^0)</span>  and create a hash table  <span class="math">H_2</span>  containing one of the outputs of  <span class="math">A_2</span>  and XOR of the two outputs  <span class="math">(X_1^2 \\oplus RK_3)</span> . There are  <span class="math">2^{32}</span>  possible values for  <span class="math">(X_1^2 \\oplus RK_3)</span>  and  <span class="math">2^8</span>  possible values for  <span class="math">RK_3^3</span> . Now for each of the  <span class="math">2^{38.21}</span>  remaining pairs we compute  <span class="math">(X_1^2 \\oplus RK_3)</span> , and use the table  <span class="math">H_2</span>  to fetch one possibility of  <span class="math">X_2^2</span>  that corresponds to the computed  <span class="math">(X_1^2 \\oplus RK_3)</span> . The process identifies roughly one wrong value for the subkey  <span class="math">RK_3</span>  by XORing the plaintext and  <span class="math">A_2</span> . The probability of a wrong 8-bit value for  <span class="math">RK_3^3</span>  is  <span class="math">(1-2^{-32})</span> . After analyzing all  <span class="math">2^{38.21}</span>  pairs, we expect only  <span class="math">2^8 \\times (1-2^{-32})^{2^{38.21} \\times 1} \\approx 2^{-99}</span>  wrong values of  <span class="math">RK_3^3</span> .</li>
    </ul></li>
    </ul>

    <p class="text-gray-300">Therefore, wrong values of the 40-bit of  <span class="math">(RK_0, RK_3^3)</span>  can be established unless the initial guess of the 32-bit value of  <span class="math">RK_{30}</span>  or 24-bit value of  <span class="math">(RK_{29} \\oplus WK_2)</span>  is correct. It is expected that we can eliminate the whole 40-bit value of  <span class="math">RK_0</span>  and  <span class="math">RK_3</span>  in this step, since the wrong values of  <span class="math">(RK_0, RK_3^3, (RK_{29} \\oplus WK_2), RK_{30})</span>  remains with a small probability of  <span class="math">\\max\\{2^{56} \\times 2^{-75} = 2^{-19}, 2^{56} \\times 2^{-99} = 2^{-43}\\}</span> . Hence if there remains a value of  <span class="math">(RK_0, RK_3^3)</span> , we can assume that the guessed 56-bit values for  <span class="math">(RK_{29} \\oplus WK_2)</span>  and  <span class="math">RK_{30}</span>  are correct. Our attack can recover 96-bit subkeys.</p>

    <p class="text-gray-300"><strong>Complexity Analysis.</strong> According to the above analysis, a structure has  <span class="math">2^{72}</span>  plaintexts, we need about  <span class="math">2^{50.73}</span>  structures, so the data complexity of our attack is about  <span class="math">2^{72} \\times 2^{50.73} = 2^{122.73}</span> .</p>

    <p class="text-gray-300">Step 1 need  <span class="math">2^{122.73}</span>  encrypting operations, Step 2 requires  <span class="math">(2 \\times 2^{32} \\times 2^{32} \\times 2^{32}) \\approx 2^{97}</span>  F operations, which is equal to  <span class="math">2^{96}</span>  one round operation. The required time for memory access in step 3 is less than  <span class="math">(2^{32} \\times 2^{32}) \\times 2^{38.21} + (2^8 \\times 2^{32}) \\times 2^{38.21} \\approx 2^{102.21}</span>  F operations, i.e.  <span class="math">2^{101.21}</span>  operations one round. Therefore, the total time complexity of our attack can be estimate as about  <span class="math">2^{122.73} + (2^{96} + 2^{101.21})/16 \\approx 2^{122.73}</span> .</p>

    <p class="text-gray-300"><span class="math">2^{122.73}/2^3 = 2^{119.73}</span>  bytes of memory are needed to store the table  <span class="math">T_0</span> ,  <span class="math">2^{96}/2^3 = 2^{93}</span>  bytes of memory are needed to store the list of deleted key values  <span class="math">(RK_{30}, RK_{29}, RK_0, RK_3^3)</span> ,  <span class="math">2 \\times 2^{31} = 2^{32}</span>  bytes of memory are needed to store the hash table  <span class="math">(H_1, H_2)</span> , and  <span class="math">2^{64}/2^3 = 2^{61}</span>  bytes of memory are needed to store table  <span class="math">T_1</span> . Our attack can recover 96-bit subkeys  <span class="math">(RK_0, RK_3^3, RK_{29} \\oplus WK_2, RK_{30})</span> .</p>

    <p class="text-gray-300">Note 3. For another 13-round extended impossible differential-linear distinguisher and another 16-round attack to CLEFIA-128, please refer to Appendix A and Appendix B, respectively. For attacks to 15-round CLEFIA-128, please refer to Appendix C. Our attack is also effective to CLEFIA-192 and CLEFIA-256.</p>

    </section>

    <section id="sec-6" class="mb-10">
      <h2 class="text-2xl font-bold">6 Conclusion</h2>

    <p class="text-gray-300">In this paper, we present a new attack, impossible differential-linear attack, and achieve a result of 16-round CLEFIA-128 with  <span class="math">2^{122.73}</span>  CP, and time complexity is also  <span class="math">2^{122.73}</span> . The comparison of cryptanalytic results with CLEFIA is illustrated in Table 1, which shows that our attack is more efficient than the present results. The attack is also effective to 15-round CLEFIA-128, given in Appendix C.</p>

    </section>

    <section id="references" class="mb-10">
      <h2 class="text-2xl font-bold">References</h2>

    <ul class="space-y-2 text-gray-400 text-sm list-none">
      <li>1. E. Biham, O. Dunkelman, N. Keller. Enhancing Differential-Linear Cryptanalysis, Advances in Cryptology, Proceedings of ASIACRYPT 2002, Lecture Notes in Computer Science 2501, pp. 254-266, Springer, (2002)</li>
      <li><ul class="space-y-2 text-gray-400 text-sm list-none">
      <li>A. Bogdanov, V. Rijmen. Linear Hulls with Correlation Zero and Linear Cryptanalysis of Block Ciphers. In: http://eprint.iacr.org/2011/123.</li>
    </ul></li>
      <li>3. S. Emami, S. Ling, I. Nikoli, J. Pieprzyk and H. Wang. Low Probability Differentials and the Cryptanalysis of Full-Round CLEFIA-128. In: <em>ASIACRYPT 2014</em>, PART I, LNCS 8873, pp. 141C157.(2014)</li>
    </ul>

    <p class="text-gray-300">Reference Rounds Recover Key Data Complexity Time Complexity  <span class="math">2^{100}</span> 14 104-bit [6]  <span class="math">2^{122}</span> a weak-key pair [3] 16(hashing mode)  <span class="math">2^{102}</span>  <span class="math">2^{101.7}</span> [8.9]10 32-bit  <span class="math">2^{119}</span>  <span class="math">2^{118.9}</span> [10] 12 72-bit  <span class="math">2^{118.9}</span>  <span class="math">2^{82}</span> 12 80-bit [11] <span class="math">2^{122.73}</span>  <span class="math">2^{122.73}</span> this paper 16 96-bit  <span class="math">2^{124.52}</span>  <span class="math">2^{121}</span> this paper 16 104-bit  <span class="math">2^{124.52}</span>  <span class="math">2^{93.1}</span> this paper 15 64-bit  <span class="math">2^{99.1}</span>  <span class="math">2^{124.52}</span> 15 64-bit this paper</p>

    <p class="text-gray-300">Table 1. Comparison of Cryptanalysis Results of CLEFIA-128</p>

    <ul class="space-y-2 text-gray-400 text-sm list-none">
      <li>4. S. K. Langford, M. E. Hellman. Differential-Linear Cryptanalysis, Advances in Cryptology. In: <em>Proceedings of CRYPTO94</em>. LNCS, vol. 839, pp. 17-25. Springer, Heidelberg (1994)</li>
      <li>5. C. Langford. Improbable Differential Attack-Cryptanalysis of Reduced Round CLEFIA, Advances in Cryptology. In:<em>Proceedings of INDOCRYPT2010</em>. LNCS, vol. 6498, pp. 197-209. Springer, Heidelberg (2010)</li>
      <li>6. L. Li, K. Jia, X. Wang, X. Dong. Meet-in-the-Middle Technique for Truncated Differential and Its Applications to CLEFIA and Camellia. In: Fast Software Encryption-FSE 2015, LNCS, vol. 9054, pp. 48-70.(2015)</li>
      <li>7. M. Matsui. Linear Cryptanalysis Method for DES Cipher, Advances in Cryptology. In: <em>Proceedings of EUROCRYPT93</em>. LNCS, vol. 765, pp. 386-397. Spinger, Heidelberg (1994)</li>
      <li>8. T. Shirai, K. Shibutani, T. Akishita, S. Moriai, T. Iwata. The 128-bit Blockcipher CLEFIA. In: <em>Proceedings of Fast Software Encryption 2007</em>, LNCS, vol. 4593, pp. 181-195.(2007)</li>
      <li>9. Sony Corporation. The 128-bit blockcipher CLEFIA: Security and performance evaluations. Revision 1.0, On-Line document, 2007.June 1 (2007), http://www.sony.co.jp/Products/clefia/technical/data/clefia-eval-1.0.pdf</li>
      <li>Y. Tsunoo, E. Tsujihara, M. Shigeri, T. Saito, T. Suzaki and H. Kubo. Impossible Differential Cryptanalysis of CLEFIA. In: Fast Software Encryption-FSE 2008, LNCS, vol. 5086, pp. 398-411. Springer, Verlag (2008).</li>
      <li>11. W. Zhang , J. Han. Impossible Differential Analysis of Reduced Round CLEFIA. In: Beijing, China. Proc of Inscrypt'08 . pp. 181-191. (2008)</li>
    </ul>

    <h2 id="sec-misc-1" class="text-2xl font-bold">Appendix A. Another 13-round extended impossible differential-linear distinguisher</h2>

    <p class="text-gray-300">Another 13-round extended impossible differential-linear distinguisher concatenates an impossible differential</p>

    <p class="text-gray-300"><span class="math">$(0,0,0,\\varpi) \\not\\to (0,0,0,\\beta)^{[3]}</span>$</p>

    <p class="text-gray-300">with a 4-round linear characteristic. For details please refer to Fig.4.</p>

    <p class="text-gray-300">    <img src="_page_18_Figure_2.jpeg" alt="" class="my-4 max-w-full" />
</p>

    <p class="text-gray-300"><span class="math">\\textbf{Fig. 4.} \\ 13\\text{-round extended impossible differential-linear distinguisher}</span></p>

    <h2 id="sec-misc-2" class="text-2xl font-bold">Appendix B. Another Attack on 16-round CLEFIA-128</h2>

    <p class="text-gray-300">Another 16-round attack on CLEFIA-128 is illustrated in Fig.5 with the 13 round impossible differential-linear distinguisher in section 4, and three rounds extension on plaintext side. Its main ideas is: Choose a structure composed of 2<sup>104</sup> plaintexts, whose corresponding plaintext pairs are of the form &#8710;P = (&#799;, &xi;, &gamma;, &theta;). Encrypt all 2<sup>183</sup> plaintext pairs, select only the pairs whose ciphertexts are equal in the first byte of X<sup>2</sup> <sup>16</sup>. According to section 5.2, we can recover 104-bit subkeys.</p>

    <p class="text-gray-300">The data complexity is about</p>

    <p class="text-gray-300"><span class="math">$2^{104} \\times \\left[8 \\times \\left(2^{60.26}\\right)^2 / \\left(2^{183} \\times 2^{-8} \\times 2^{-32} \\times 2^{-32} \\times 2^{-8}\\right)\\right] \\approx 2^{124.52}.</span>$</p>

    <p class="text-gray-300">The time complexity is</p>

    <p class="text-gray-300"><span class="math">$[(2^{32}\\times 2^{32})\\big/2 + ((2^{32}\\times 2^{32})\\times 2^{72} + (2^{32}\\times 2^{32})\\times 2^{72} + (2^8\\times 2^{32})\\times 2^{72})\\big/2]\\big/16 \\approx 2^{131}</span>$</p>

    <p class="text-gray-300">    <img src="_page_20_Figure_2.jpeg" alt="" class="my-4 max-w-full" />
</p>

    <p class="text-gray-300">Fig. 5. 16-round impossible differential-linear attack</p>

    <h3 id="sec-misc-3" class="text-xl font-semibold mt-8">Appendix C. Attacks on 15-round CLEFIA-128</h3>

    <p class="text-gray-300">The attacks to 15-round CLEFIA-128 below are all with whitening keys. The details of the attack can be divided into two cases.</p>

    <p class="text-gray-300">The first extension is one round on plaintext side, and one round on ciphertext side as illustrated in Fig.6. We can choose a structure composed of 2<sup>40</sup> plaintexts, whose plaintext differences is of the form &#8710;P = (0, 0, &#799;, &delta;). Obviously, one structure can produce about 2<sup>55</sup> different plaintext pairs. Similar to the section 5.2, we can recover 64-bit subkey composed of RK<sup>0</sup> 1 (8bit), RK27(24bit), and RK28(32bit), with impossible differential-linear attack.</p>

    <p class="text-gray-300">The data complexity is</p>

    <p class="text-gray-300"><span class="math">$2^{40} \\times [8 \\times (2^{60.26})^2 / (2^{55} \\cdot 2^{-8} \\cdot 2^{-8})] \\approx 2^{124.52}</span>$</p>

    <p class="text-gray-300">The time complexity is</p>

    <p class="text-gray-300"><span class="math">$[(2\\times 2^{32}\\times 2^{32}\\times 2^{32})\\big/2 + ((2^8\\times 2^{32})\\times 2^8)\\big/2]\\big/15\\approx 2^{93.1}</span>$</p>

    <p class="text-gray-300">The second extension is two rounds on plaintext side, illustrated in Fig. 7. We can choose a structure composed of 2<sup>72</sup> plaintexts, whose plaintext differences is of the form &#8710;P = (&delta;, &gamma;, 0, &#799;). Obviously, one structure can produce about 2<sup>119</sup> distinct plaintext pairs. Similar to section 5.2, we can recover 64-bit subkey, that is RK0(32bit), RK<sup>0</sup> 3 (8bit), and RK29(24bit), with impossible differential-linear attack.</p>

    <p class="text-gray-300">The data complexity is</p>

    <p class="text-gray-300"><span class="math">$2^{72} \\times [8 \\times (2^{60.26})^2 / (2^{119} \\cdot 2^{-8} \\cdot 2^{-32} \\cdot 2^{-8})] \\approx 2^{124.52}</span>$</p>

    <p class="text-gray-300">The time complexity is</p>

    <p class="text-gray-300"><span class="math">$[(2^{32}\\times 2^{32})\\big/2 + ((2^{32}\\times 2^{32})\\times 2^{40} + (2^8\\times 2^{32})\\times 2^{40})\\big/2]\\big/15 \\approx 2^{99.1}</span>$</p>

    <p class="text-gray-300">    <img src="_page_22_Figure_2.jpeg" alt="" class="my-4 max-w-full" />
</p>

    <p class="text-gray-300"><span class="math">{\\bf Fig.\\,6.}\\ 15\\text{-round impossible differential-linear attack}</span></p>

    <p class="text-gray-300">    <img src="_page_23_Figure_2.jpeg" alt="" class="my-4 max-w-full" />
</p>

    <p class="text-gray-300">Fig. 7. 15-round impossible differential-linear attack</p>

    <h3 id="sec-misc-4" class="text-xl font-semibold mt-8">Appendix D. Round Key Relation</h3>

    <p class="text-gray-300">According to the description in section 2, we can get the relationship between generated round keys and related data as follows:</p>

    <pre><code class="language-text">RK_0 | RK_1 | RK_2 | RK_3 \\leftarrow L \\oplus CON_{24} | CON_{25} | CON_{26} | CON_{27}
           RK_4 | RK_5 | RK_6 | RK_7 \\leftarrow \\Sigma(L) \\oplus K \\oplus CON_{28} | CON_{29} | CON_{30} | CON_{31}
          RK_{8} | RK_{9} | RK_{10} | RK_{11} \\leftarrow \\Sigma^{2}(L) \\oplus CON_{32} | CON_{33} | CON_{34} | CON_{35}
          \\begin{array}{l} RK_{12} \\left| RK_{13} \\right| RK_{14} \\left| RK_{15} \\leftarrow \\Sigma^{3}(L) \\oplus K \\oplus CON_{36} \\left| CON_{37} \\right| CON_{38} \\left| CON_{39} \\right| \\\\ RK_{16} \\left| RK_{17} \\right| RK_{18} \\left| RK_{19} \\leftarrow \\Sigma^{4}(L) \\oplus CON_{40} \\left| CON_{41} \\right| CON_{42} \\left| CON_{43} \\right| \\end{array}
           RK_{20} | RK_{21} | RK_{22} | RK_{23} \\leftarrow \\Sigma^{5}(L) \\oplus K \\oplus CON_{44} | CON_{45} | CON_{46} | CON_{47} | CON_{47} | CON_{48} | CON_{48} | CON_{48} | CON_{48} | CON_{48} | CON_{48} | CON_{48} | CON_{48} | CON_{48} | CON_{48} | CON_{48} | CON_{48} | CON_{48} | CON_{48} | CON_{48} | CON_{48} | CON_{48} | CON_{48} | CON_{48} | CON_{48} | CON_{48} | CON_{48} | CON_{48} | CON_{48} | CON_{48} | CON_{48} | CON_{48} | CON_{48} | CON_{48} | CON_{48} | CON_{48} | CON_{48} | CON_{48} | CON_{48} | CON_{48} | CON_{48} | CON_{48} | CON_{48} | CON_{48} | CON_{48} | CON_{48} | CON_{48} | CON_{48} | CON_{48} | CON_{48} | CON_{48} | CON_{48} | CON_{48} | CON_{48} | CON_{48} | CON_{48} | CON_{48} | CON_{48} | CON_{48} | CON_{48} | CON_{48} | CON_{48} | CON_{48} | CON_{48} | CON_{48} | CON_{48} | CON_{48} | CON_{48} | CON_{48} | CON_{48} | CON_{48} | CON_{48} | CON_{48} | CON_{48} | CON_{48} | CON_{48} | CON_{48} | CON_{48} | CON_{48} | CON_{48} | CON_{48} | CON_{48} | CON_{48} | CON_{48} | CON_{48} | CON_{48} | CON_{48} | CON_{48} | CON_{48} | CON_{48} | CON_{48} | CON_{48} | CON_{48} | CON_{48} | CON_{48} | CON_{48} | CON_{48} | CON_{48} | CON_{48} | CON_{48} | CON_{48} | CON_{48} | CON_{48} | CON_{48} | CON_{48} | CON_{48} | CON_{48} | CON_{48} | CON_{48} | CON_{48} | CON_{48} | CON_{48} | CON_{48} | CON_{48} | CON_{48} | CON_{48} | CON_{48} | CON_{48} | CON_{48} | CON_{48} | CON_{48} | CON_{48} | CON_{48} | CON_{48} | CON_{48} | CON_{48} | CON_{48} | CON_{48} | CON_{48} | CON_{48} | CON_{48} | CON_{48} | CON_{48} | CON_{48} | CON_{48} | CON_{48} | CON_{48} | CON_{48} | CON_{48} | CON_{48} | CON_{48} | CON_{48} | CON_{48} | CON_{48} | CON_{48} | CON_{48} | CON_{48} | CON_{48} | CON_{48} | CON_{48} | CON_{48} | CON_{48} | CON_{48} | CON_{48} | CON_{48} | CON_{48} | CON_{48} | CON_{48} | CON_{48} | CON_{48} | CON_{48} | CON_{48} | CON_{48} | CON_{48} | CON_{48} | CON_{48} | CON_{48} | CON_{48} | CON_{48} | CON_{48} | CON_{48} | CON_{48} | CON_{48} | CON_{48} | CON_{48} | CON_{48} | CON_{48} | CON_{48} | CON_{48} | CON_{48} | CON_{48}
           RK_{32} | RK_{33} | RK_{34} | RK_{35} \\leftarrow \\Sigma^{8}(L) \\oplus CON_{56} | CON_{57} | CON_{58} | CON_{59}
          Based on the properties proved in [5], we get the following key relations:
           RK_{32} \\oplus C_1 = RK_1[56 - 63] |RK_3[100 - 102] |RK_3[107 - 127]
          RK_{33} \\oplus C_2 = RK_2[72 - 95] |RK_3[96 - 99] |RK_3[103 - 106]
          RK_{34} \\oplus C_3 = RK_0[21 - 24] |RK_0[28 - 31] |RK_1[32 - 55]
           RK_{35} \\oplus C_4 = RK_0[0-20] |RK_0[25-27] |RK_2[64-71]
where
          C_1 = CON_{56} \\oplus (CON_{25}[56 - 63] | CON_{27}[100 - 102] | CON_{27}[107 - 127] )
          C_2 = CON_{57} \\oplus (CON_{26}[72 - 95] | CON_{27}[96 - 99] | CON_{27}[103 - 106] )
          C_3 = CON_{58} \\oplus (CON_{24}[21 - 24] | CON_{24}[28 - 31] | CON_{25}[32 - 55] )
          C_4 = CON_{59} \\oplus (CON_{24}[0-20] | CON_{24}[25-27] | CON_{26}[64-71] )
          Thus we get the following properties from the above derivations:
</code></pre>

    <p class="text-gray-300">Property 6. . If 32 bits  <span class="math">RK_{33}</span>  are known, we can get 24 bits  <span class="math">RK_2[72-95]</span> , and 8 bits  <span class="math">RK_3[96-99]\\,|RK_3[103-106]</span> .</p>

    <p class="text-gray-300">Property 7. . If 32 bits  <span class="math">RK_{34}</span>  are known, then we can get 8 bits  <span class="math">RK_0[21-24]</span>   <span class="math">|RK_0[28-31]</span> , and 24 bits  <span class="math">RK_1[32-55]</span> .</p>

    </section>
`;
---

<BaseLayout title="Impossible Differential-Linear Cryptanalysis of Reduced-Roun... (2013/301)">
  <article class="max-w-4xl mx-auto article-prose">
    <nav class="mb-8">
      <a href="/papers" class="text-blue-400 hover:text-blue-300">
        &larr; Back to Papers
      </a>
    </nav>

    <header class="mb-12">
      <h1 class="text-3xl font-bold mb-4"
        set:html={TITLE_HTML} />
      <p class="text-gray-400 mb-2"
        set:html={AUTHORS_HTML} />
      <p class="text-gray-500 text-sm mb-4">
        2013 &middot; eprint 2013/301
      </p>
      <div class="flex gap-4 text-sm">
        <a
          href={EPRINT_URL}
          target="_blank"
          rel="noopener noreferrer"
          class="text-blue-400 hover:text-blue-300"
        >
          Paper (eprint) &rarr;
        </a>
      </div>
      <PaperDisclaimer eprintUrl={EPRINT_URL} />
      <p class="mt-1 text-xs text-gray-600">
        Converted with: {CRAWLER} &middot; {CONVERTED_DATE}
      </p>
    </header>

    <nav id="toc" class="mb-10 p-6 rounded-lg" style="background: rgba(255,255,255,0.03); border: 1px solid rgba(255,255,255,0.06);">
      <h2 class="text-lg font-bold mb-4">Table of Contents</h2>
      <ol class="space-y-1 text-sm text-gray-300
        list-decimal list-inside">
        <li><a href="#sec-1" class="hover:text-white">Introduction</a></li>
        <li>
          <a href="#sec-2" class="hover:text-white">Description of CLEFIA</a>
          <ol class="ml-6 mt-1 space-y-1 list-decimal
            list-inside text-gray-400">
            <li><a href="#sec-2.1" class="hover:text-white">Notation</a></li>
            <li><a href="#sec-2.2" class="hover:text-white">CLEFIA</a></li>
            <li><a href="#sec-2.3" class="hover:text-white">Key Scheduling</a></li>
          </ol>
        </li>
        <li>
          <a href="#sec-3" class="hover:text-white">The Impossible Differential-Linear Attack</a>
          <ol class="ml-6 mt-1 space-y-1 list-decimal
            list-inside text-gray-400">
            <li><a href="#sec-3.1" class="hover:text-white">Impossible Differential-Linear Distinguisher</a></li>
            <li><a href="#sec-3.2" class="hover:text-white">The Impossible Differential-Linear Attack</a></li>
            <li><a href="#sec-3.3" class="hover:text-white">The Impossible Differential-Linear Attack</a></li>
          </ol>
        </li>
        <li>
          <a href="#sec-4" class="hover:text-white">The 13-Round Impossible Differential-Linear Distinguisher</a>
          <ol class="ml-6 mt-1 space-y-1 list-decimal
            list-inside text-gray-400">
            <li><a href="#sec-4.1" class="hover:text-white">9-Round Impossible Differential Characteristic</a></li>
            <li><a href="#sec-4.2" class="hover:text-white">4-Round Linear Characteristic</a></li>
            <li><a href="#sec-4.3" class="hover:text-white">The 13-Round Extended Impossible Differential-Linear Distinguisher</a></li>
            <li><a href="#sec-4.4" class="hover:text-white">Selection of \lambda</a></li>
          </ol>
        </li>
        <li>
          <a href="#sec-5" class="hover:text-white">The Impossible Differential-Linear Attack on 16-Round CLEFIA-128</a>
          <ol class="ml-6 mt-1 space-y-1 list-decimal
            list-inside text-gray-400">
            <li><a href="#sec-5.1" class="hover:text-white">Chosen Plaintext</a></li>
            <li><a href="#sec-5.2" class="hover:text-white">The Impossible Differential-Linear Attack on 16-Round CLEFIA-128 with Whitening Keys</a></li>
          </ol>
        </li>
        <li><a href="#sec-6" class="hover:text-white">Conclusion</a></li>
      </ol>
      <p class="text-xs text-gray-500 mt-4 mb-1 font-semibold">
        Additional
      </p>
      <ul class="space-y-1 text-sm text-gray-400
        list-disc list-inside">
        <li><a href="#references" class="hover:text-white">References</a></li>
      </ul>
    </nav>


    <Fragment set:html={CONTENT} />

    <PaperHistory slug="impossible-differential-linear-cryptanalysis-of-reduced-2013" />
  </article>
</BaseLayout>
