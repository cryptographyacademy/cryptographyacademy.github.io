---
import BaseLayout from '../../layouts/BaseLayout.astro';
import PaperDisclaimer from '../../components/PaperDisclaimer.astro';

const EPRINT_URL = 'https://eprint.iacr.org/2019/614';
const CRAWLER = 'marker';
const CONVERTED_DATE = '2026-02-14';
---

<BaseLayout title="Quantum Attacks without Superposition Queries: the Offline Simon's Algorithm (2019/614)">
  <article class="max-w-4xl mx-auto article-prose">
    <nav class="mb-8">
      <a href="/papers" class="text-blue-400 hover:text-blue-300">
        &larr; Back to Papers
      </a>
    </nav>

    <!-- ============================================================ -->
    <!-- HEADER                                                       -->
    <!-- ============================================================ -->

    <header class="mb-12">
      <h1 class="text-3xl font-bold mb-4">
        Quantum Attacks without Superposition Queries: the Offline
        Simon&rsquo;s Algorithm
      </h1>
      <p class="text-gray-400 mb-2">
        Xavier Bonnetain, Akinori Hosoyamada,
        Mar&iacute;a Naya-Plasencia, Yu Sasaki,
        and Andr&eacute; Schrottenloher
      </p>
      <p class="text-gray-500 text-sm mb-4">
        2019 &middot; Full Version &middot; eprint 2019/614
      </p>
      <div class="flex gap-4 text-sm">
        <a
          href={EPRINT_URL}
          target="_blank"
          rel="noopener noreferrer"
          class="text-blue-400 hover:text-blue-300"
        >
          Paper (eprint) &rarr;
        </a>
      </div>
      <PaperDisclaimer eprintUrl={EPRINT_URL} />
      <p class="mt-1 text-xs text-gray-600">Converted with: {CRAWLER} &middot; {CONVERTED_DATE}</p>
    </header>

    <!-- ============================================================ -->
    <!-- TABLE OF CONTENTS                                            -->
    <!-- ============================================================ -->

    <nav id="toc" class="mb-10 p-6 rounded-lg"
      style="background: rgba(255,255,255,0.03);
             border: 1px solid rgba(255,255,255,0.06);">
      <h2 class="text-lg font-bold mb-4">Table of Contents</h2>
      <ol class="space-y-1 text-sm text-gray-300
        list-decimal list-inside">
        <li>
          <a href="#abstract"
            class="hover:text-white">Abstract</a>
        </li>
        <li>
          <a href="#sec-1"
            class="hover:text-white">Introduction</a>
        </li>
        <li>
          <a href="#sec-2"
            class="hover:text-white">Preliminaries</a>
          <ol class="ml-6 mt-1 space-y-1 list-decimal
            list-inside text-gray-400">
            <li>
              <a href="#sec-2.1"
                class="hover:text-white">
                The Quantum Circuit Model</a>
            </li>
            <li>
              <a href="#sec-2.2"
                class="hover:text-white">
                Simon&rsquo;s Algorithm</a>
            </li>
            <li>
              <a href="#sec-2.3"
                class="hover:text-white">
                Grover&rsquo;s Algorithm</a>
            </li>
          </ol>
        </li>
        <li>
          <a href="#sec-3"
            class="hover:text-white">
            Simon&rsquo;s Algorithm with Asymmetric Queries</a>
          <ol class="ml-6 mt-1 space-y-1 list-decimal
            list-inside text-gray-400">
            <li>
              <a href="#sec-3.1"
                class="hover:text-white">
                Existing Techniques to Solve the Problem</a>
            </li>
            <li>
              <a href="#sec-3.2"
                class="hover:text-white">
                An Algorithm for Asymmetric Search of a Shift</a>
            </li>
            <li>
              <a href="#sec-3.3"
                class="hover:text-white">
                Asymmetric Search with Q1 Queries</a>
            </li>
          </ol>
        </li>
        <li>
          <a href="#sec-4"
            class="hover:text-white">
            Q2 Attacks on Symmetric Schemes with Reduced Query
            Complexity</a>
          <ol class="ml-6 mt-1 space-y-1 list-decimal
            list-inside text-gray-400">
            <li>
              <a href="#sec-4.1"
                class="hover:text-white">
                An Attack on the FX Construction</a>
            </li>
          </ol>
        </li>
        <li>
          <a href="#sec-5"
            class="hover:text-white">
            Q1 Attacks on Symmetric Schemes</a>
          <ol class="ml-6 mt-1 space-y-1 list-decimal
            list-inside text-gray-400">
            <li>
              <a href="#sec-5.1"
                class="hover:text-white">
                Tradeoffs for the Even-Mansour Construction</a>
            </li>
            <li>
              <a href="#sec-5.2"
                class="hover:text-white">
                Tradeoffs for the FX Construction</a>
            </li>
            <li>
              <a href="#sec-5.3"
                class="hover:text-white">
                Other Applications</a>
            </li>
          </ol>
        </li>
        <li>
          <a href="#sec-6"
            class="hover:text-white">Discussion</a>
          <ol class="ml-6 mt-1 space-y-1 list-decimal
            list-inside text-gray-400">
            <li>
              <a href="#sec-6.1"
                class="hover:text-white">Related Keys</a>
            </li>
            <li>
              <a href="#sec-6.2"
                class="hover:text-white">Slide Attacks</a>
            </li>
          </ol>
        </li>
        <li>
          <a href="#sec-7"
            class="hover:text-white">Conclusion</a>
        </li>
      </ol>
      <p class="text-xs text-gray-500 mt-4 mb-1 font-semibold">
        Additional
      </p>
      <ul class="space-y-1 text-sm text-gray-400 list-disc
        list-inside">
        <li>
          <a href="#appendix-a"
            class="hover:text-white">Appendix A: Proofs for
            Propositions 2 and 3</a>
        </li>
        <li>
          <a href="#appendix-b"
            class="hover:text-white">Appendix B: Adaptive Attacks
            and Non-Adaptive Attacks</a>
        </li>
        <li>
          <a href="#acknowledgements"
            class="hover:text-white">Acknowledgements</a>
        </li>
        <li>
          <a href="#references"
            class="hover:text-white">References</a>
        </li>
      </ul>
    </nav>

    <!-- ============================================================ -->
    <!-- ABSTRACT                                                     -->
    <!-- ============================================================ -->

    <section id="abstract" class="mb-10">
      <h2 class="text-2xl font-bold">Abstract</h2>
      <p class="text-gray-300">
        In symmetric cryptanalysis, the model of superposition queries
        has led to surprising results, with many constructions being
        broken in polynomial time thanks to Simon&rsquo;s period-finding
        algorithm. But the practical implications of these attacks
        remain blurry. In contrast, the results obtained so far for a
        quantum adversary making classical queries only are less
        impressive.
      </p>
      <p class="text-gray-300">
        In this paper, we introduce a new quantum algorithm which uses
        Simon&rsquo;s subroutines in a novel way. We manage to leverage
        the algebraic structure of cryptosystems in the context of a
        quantum attacker limited to classical queries and offline
        quantum computations. We obtain improved quantum-time/classical-data
        tradeoffs with respect to the current literature, while using
        only as much hardware requirements (quantum and classical) as a
        standard exhaustive search with Grover&rsquo;s algorithm. In
        particular, we are able to break the Even-Mansour construction
        in quantum time
        <span class="math">\tilde&#123;O&#125;(2^&#123;n/3&#125;)</span>,
        with
        <span class="math">O(2^&#123;n/3&#125;)</span>
        classical queries and
        <span class="math">O(n^2)</span>
        qubits only. In addition, we improve some previous superposition
        attacks by reducing the data complexity from exponential to
        polynomial, with the same time complexity.
      </p>
      <p class="text-gray-300">
        Our approach can be seen in two complementary ways: reusing
        superposition queries during the iteration of a search using
        Grover&rsquo;s algorithm, or alternatively, removing the memory
        requirement in some quantum attacks based on a collision search,
        thanks to their algebraic structure. We provide a list of
        cryptographic applications, including the Even-Mansour
        construction, the FX construction, some Sponge authenticated
        modes of encryption, and many more.
      </p>
      <p class="text-gray-300">
        <strong>Keywords:</strong> Simon&rsquo;s algorithm, classical
        queries, symmetric cryptography, quantum cryptanalysis,
        Even-Mansour construction, FX construction.
      </p>
    </section>

    <!-- ============================================================ -->
    <!-- 1. INTRODUCTION                                              -->
    <!-- ============================================================ -->

    <section id="sec-1" class="mb-10">
      <h2 class="text-2xl font-bold">1. Introduction</h2>
      <p class="text-gray-300">
        Ever since Shor [SP94] introduced his celebrated quantum
        polynomial-time algorithm for solving factorization and Discrete
        Logarithms, both problems believed to be classically
        intractable, post-quantum cryptography has become a subject of
        wide interest. Indeed, the security of classical cryptosystems
        relies on computational assumptions, which until recently, were
        made with respect to classical adversaries; if quantum
        adversaries are to be taken into account, the landscape of
        security is bound to change dramatically.
      </p>
      <p class="text-gray-300">
        In symmetric cryptography, the impact of quantum computing
        seems, at first sight, much more limited. This is because the
        security of most symmetric-key schemes is not predicated on
        structured problems. Grover&rsquo;s quantum search algorithm
        [GL96] speeds up by a quadratic factor exhaustive search
        procedures. This has led to the common saying that
        &ldquo;doubling the key sizes&rdquo; should ensure a similar
        level of post-quantum security.
      </p>
      <p class="text-gray-300">
        <strong>Quantum Generic Attacks in Q1 and Q2 Models.</strong>
        Quantum attacks can be mainly classified into two types
        [20, 25, 23], Q1 model and Q2 model, assuming different
        abilities for the attacker. In the Q1 model, attackers have
        access to a quantum computer to perform any offline computation,
        while they are only allowed to make online queries in a
        classical manner. In the Q2 model, besides the offline quantum
        computation, attackers are allowed to make superposition queries
        to a quantum cryptographic oracle.
      </p>
      <p class="text-gray-300">
        The Q2 model is particularly interesting as it yields some
        attacks with a very low cost. Kuwakado and Morii [29, 30]
        showed that the Even-Mansour cipher and the three-round Feistel
        networks, classically proven secure if their underlying
        building blocks are ideal, were broken in polynomial time.
        This exponential speedup was obtained thanks to Simon&rsquo;s
        algorithm [SD94] for recovering a Boolean hidden shift.
      </p>
      <p class="text-gray-300">
        <strong>Our Main Contribution.</strong> The breakthrough we
        present in this paper is the first application of
        Simon&rsquo;s algorithm [SD94] in the Q1 model, which requires
        significantly less than
        <span class="math">O(2^&#123;n/2&#125;)</span> classical
        queries and offline quantum computations, only with
        <span class="math">\mathrm&#123;poly&#125;(n)</span>
        qubits, and no qRAM access. Namely, we remove the
        superposition queries in previous attacks.
      </p>
      <p class="text-gray-300">
        The first application is the key recovery on the Even-Mansour
        construction. Our attack in the Q1 model only uses polynomially
        many qubits, yet only requires
        <span class="math">O(2^&#123;n/3&#125;)</span>
        classical queries,
        <span class="math">O(n^3 \cdot 2^&#123;n/3&#125;)</span>
        quantum computations and
        <span class="math">\mathrm&#123;poly&#125;(n)</span>
        classical memory.
      </p>
      <p class="text-gray-300">
        The second application is the key recovery on the
        FX-construction
        <span class="math">\mathrm&#123;FX&#125;_&#123;k,k_&#123;\mathrm&#123;in&#125;&#125;,k_&#123;\mathrm&#123;out&#125;&#125;&#125;</span>,
        which computes a ciphertext
        <span class="math">c</span> from a plaintext
        <span class="math">p</span> by
        <span class="math">c \leftarrow E_k(p \oplus k_&#123;\mathrm&#123;in&#125;&#125;) \oplus k_&#123;\mathrm&#123;out&#125;&#125;</span>,
        where <span class="math">E</span> is a block cipher,
        <span class="math">k</span> is an
        <span class="math">m</span>-bit key and
        <span class="math">k_&#123;\mathrm&#123;in&#125;&#125;, k_&#123;\mathrm&#123;out&#125;&#125;</span>
        are two <span class="math">n</span>-bit keys.
      </p>
      <p class="text-gray-300">
        <strong>Our New Observation.</strong> Our core observation
        is that we can judge whether a function
        <span class="math">f \oplus g</span> has a period (i.e., we
        can apply Simon&rsquo;s algorithm) without any quantum query
        to <span class="math">g</span>, if we have the quantum state
        <span class="math">|\psi_g\rangle := (\sum_x |x\rangle |g(x)\rangle)^&#123;\otimes cn&#125;</span>.
        This enables us to separate the online phase (preparing
        <span class="math">|\psi_g\rangle</span>) from offline
        computations (the Grover search), achieving exponential
        improvements in query complexity.
      </p>
      <p class="text-gray-300">
        <strong>Paper organization.</strong> Section 2 gives
        preliminaries. Section 3 describes the main algorithms.
        Section 4 shows applications in the Q2 model. Section 5 shows
        applications in the Q1 model. Section 6 discusses further
        applications. Section 7 concludes the paper.
      </p>
    </section>

    <!-- ============================================================ -->
    <!-- 2. PRELIMINARIES                                             -->
    <!-- ============================================================ -->

    <section id="sec-2" class="mb-10">
      <h2 class="text-2xl font-bold">2. Preliminaries</h2>
      <p class="text-gray-300">
        This section introduces some quantum computing notions and
        reviews Simon&rsquo;s and Grover&rsquo;s algorithms.
      </p>

      <h3 id="sec-2.1" class="text-xl font-semibold mt-8 mb-3">
        2.1 The Quantum Circuit Model
      </h3>
      <p class="text-gray-300">
        It has become standard in the cryptographic literature to write
        quantum algorithms in the circuit model, which is universal for
        quantum computing. We only consider the logical level of
        quantum circuits, with logical qubits, not their implementation
        level. Although it is difficult to estimate the cost of a
        physical implementation which does not yet exist, we can compare
        security levels as quantum operation counts in this model.
      </p>
      <p class="text-gray-300">
        <strong>Qubits and Operations.</strong> A quantum circuit
        represents a sequence of quantum operations, denoted as quantum
        gates, applied to a set of qubits. An individual qubit is a
        quantum object whose state is an element of a two-dimensional
        Hilbert space, with basis
        <span class="math">|0\rangle, |1\rangle</span>. Hence, the
        state is described as a linear combination
        <span class="math">\alpha|0\rangle + \beta|1\rangle</span>
        with
        <span class="math">|\alpha|^2 + |\beta|^2 = 1</span>.
      </p>
      <p class="text-gray-300">
        <strong>Quantum RAM.</strong> Many algorithms require quantum
        random-access memory (qRAM). Our algorithm has no such
        requirement, which puts it on the same level of practicality
        as Grover&rsquo;s algorithm for attacking symmetric
        primitives.
      </p>

      <h3 id="sec-2.2" class="text-xl font-semibold mt-8 mb-3">
        2.2 Simon&rsquo;s Algorithm
      </h3>
      <p class="text-gray-300">
        Simon&rsquo;s algorithm [SD94] gives an exponential speedup on
        the following problem.
      </p>

      <div class="formal-block formal-block-definition">
        <div class="formal-block-title text-blue-400">
          Problem 1 (Simon&rsquo;s problem)
        </div>
        <div class="formal-block-content">
          <p class="text-gray-300">
            Suppose given access to a function
            <span class="math">f : \&#123;0,1\&#125;^n \to \&#123;0,1\&#125;^n</span>
            that is either injective, or such that there exists
            <span class="math">s \in \&#123;0,1\&#125;^n</span> with:
          </p>
          <div class="math-block">
            \forall x,\; f(x) = f(y) \iff y = x \text&#123; or &#125; y = x \oplus s,
          </div>
          <p class="text-gray-300">
            then find <span class="math">s</span>.
          </p>
        </div>
      </div>

      <p class="text-gray-300">
        Solving this problem with classical oracle access to
        <span class="math">f</span> requires
        <span class="math">\Omega(2^&#123;n/2&#125;)</span> queries,
        as we need to find a collision. Simon [SD94] gives an algorithm
        which only requires
        <span class="math">O(n)</span> superposition queries. We fix
        <span class="math">c \geq 1</span> a small constant to
        ensure a good success probability and repeat
        <span class="math">cn</span> times the quantum subroutine.
      </p>

      <p class="text-gray-300">
        <strong>Algorithm 1</strong> (Quantum subroutine of
        Simon&rsquo;s algorithm): Start in the all-zero state
        <span class="math">|0\rangle|0\rangle</span>. Apply
        Hadamard gates to obtain
        <span class="math">\sum_&#123;x \in \&#123;0,1\&#125;^n&#125; |x\rangle|0\rangle</span>.
        Query <span class="math">O^f</span> to obtain
        <span class="math">\sum_x |x\rangle|f(x)\rangle</span>.
        Apply Hadamard gates and measure
        <span class="math">y</span>. If
        <span class="math">f</span> hides a period
        <span class="math">s</span>, then measuring gives a random
        <span class="math">y</span> such that
        <span class="math">y \cdot s = 0</span>.
      </p>

      <div class="formal-block formal-block-theorem">
        <div class="formal-block-title text-green-400">
          Proposition 1 (Theorem 2 in [KLL+16])
        </div>
        <div class="formal-block-content">
          <p class="text-gray-300">
            Suppose that
            <span class="math">f : \&#123;0,1\&#125;^n \to X</span>
            has a period
            <span class="math">s \neq 0^n</span>, i.e.,
            <span class="math">f(x \oplus s) = f(x)</span> for all
            <span class="math">x \in \&#123;0,1\&#125;^n</span>,
            and satisfies
          </p>
          <div class="math-block">
            \max_&#123;t \neq \&#123;s, 0^n\&#125;&#125; \Pr_x\left[f(x \oplus t) = f(x)\right] \leq \frac&#123;1&#125;&#123;2&#125;.
          </div>
          <p class="text-gray-300">
            When we apply Simon&rsquo;s algorithm to
            <span class="math">f</span>, it returns
            <span class="math">s</span> with a probability at least
            <span class="math">1 - 2^n \cdot (3/4)^&#123;cn&#125;</span>.
          </p>
        </div>
      </div>

      <h3 id="sec-2.3" class="text-xl font-semibold mt-8 mb-3">
        2.3 Grover&rsquo;s Algorithm
      </h3>
      <p class="text-gray-300">
        Grover&rsquo;s algorithm [GL96] allows a quadratic speedup on
        classical exhaustive search.
      </p>

      <div class="formal-block formal-block-definition">
        <div class="formal-block-title text-blue-400">
          Problem 2 (Grover&rsquo;s problem)
        </div>
        <div class="formal-block-content">
          <p class="text-gray-300">
            Consider a set <span class="math">X</span> (the
            &ldquo;search space&rdquo;) whose elements are represented
            on
            <span class="math">\lceil \log_2(|X|) \rceil</span>
            qubits, such that the uniform superposition
            <span class="math">\sum_&#123;x \in X&#125; |x\rangle</span>
            is computable in
            <span class="math">O(1)</span> time. Given oracle access
            to a function
            <span class="math">f: X \to \&#123;0,1\&#125;</span>
            (the &ldquo;test&rdquo;), find
            <span class="math">x \in X</span> such that
            <span class="math">f(x) = 1</span>.
          </p>
        </div>
      </div>

      <p class="text-gray-300">
        Classically, if there are
        <span class="math">2^t</span> preimages of 1, we expect one
        to be found in time
        <span class="math">O(|X|/2^t)</span>. Quantumly,
        Grover&rsquo;s algorithm finds one in time
        <span class="math">\tilde&#123;O&#125;(\sqrt&#123;|X|/2^t&#125;)</span>.
        If the superposition oracle for
        <span class="math">f</span> uses
        <span class="math">a</span> ancilla qubits, then
        Grover&rsquo;s algorithm requires
        <span class="math">a + \lceil \log_2(|X|) \rceil</span>
        qubits only.
      </p>
    </section>

    <!-- ============================================================ -->
    <!-- 3. SIMON'S ALGORITHM WITH ASYMMETRIC QUERIES                 -->
    <!-- ============================================================ -->

    <section id="sec-3" class="mb-10">
      <h2 class="text-2xl font-bold">
        3. Simon&rsquo;s Algorithm with Asymmetric Queries
      </h2>
      <p class="text-gray-300">
        In this section, we introduce a problem that can be seen as a
        general combination of Simon&rsquo;s and Grover&rsquo;s
        problems, and that will be solved by an according combination
        of algorithmic ideas. The problem has many cryptographic
        applications.
      </p>

      <div class="formal-block formal-block-definition">
        <div class="formal-block-title text-blue-400">
          Problem 3 (Asymmetric Search of a Period)
        </div>
        <div class="formal-block-content">
          <p class="text-gray-300">
            Let
            <span class="math">F:\&#123;0,1\&#125;^m \times \&#123;0,1\&#125;^n \to \&#123;0,1\&#125;^\ell</span>
            and
            <span class="math">g:\&#123;0,1\&#125;^n \to \&#123;0,1\&#125;^\ell</span>
            be two functions. We consider
            <span class="math">F</span> as a family of functions
            indexed by
            <span class="math">\&#123;0,1\&#125;^m</span> and write
            <span class="math">F(i,\cdot) = f_i(\cdot)</span>.
            Assume that we are given quantum oracle access to
            <span class="math">F</span>, and classical or quantum
            oracle access to <span class="math">g</span>.
          </p>
          <p class="text-gray-300">
            Assume that there exists exactly one
            <span class="math">i_0 \in \&#123;0,1\&#125;^m</span>
            such that
            <span class="math">f_&#123;i_0&#125; \oplus g</span>
            has a hidden period, i.e.:
            <span class="math">\forall x \in \&#123;0,1\&#125;^n,\; f_&#123;i_0&#125;(x) \oplus g(x) = f_&#123;i_0&#125;(x \oplus s) \oplus g(x \oplus s)</span>
            for some <span class="math">s</span>. Furthermore,
            assume that:
          </p>
          <div class="math-block">
            \max_&#123;\substack&#123;i \in \&#123;0,1\&#125;^m \setminus \&#123;i_0\&#125; \\ t \in \&#123;0,1\&#125;^n \setminus \&#123;0^n\&#125;&#125;&#125; \Pr_&#123;x \leftarrow \&#123;0,1\&#125;^n&#125;\left[(f_i \oplus g)(x \oplus t) = (f_i \oplus g)(x)\right] \leq \frac&#123;1&#125;&#123;2&#125;
          </div>
          <p class="text-gray-300">
            Then find <span class="math">i_0</span> and
            <span class="math">s</span>.
          </p>
        </div>
      </div>

      <p class="text-gray-300">
        In our cryptographic applications,
        <span class="math">g</span> will be a keyed function such
        that adversaries have to make online queries to evaluate it,
        while <span class="math">F</span> will be a function such
        that adversaries can evaluate it offline. For example, the
        problem of recovering keys of the FX construction can be
        regarded as a simple cryptographic instantiation of Problem 3.
      </p>

      <h3 id="sec-3.1" class="text-xl font-semibold mt-8 mb-3">
        3.1 Existing Techniques to Solve the Problem
      </h3>
      <p class="text-gray-300">
        <strong>The model Q1.</strong> In the Q1 model, when we are
        allowed to make only classical queries, there exists a Q1
        algorithm using a kind of meet-in-the-middle technique [HS18].
        However, it does not make use of the exponential speed-up of
        Simon&rsquo;s algorithm, and its time/query complexity is
        <span class="math">O(2^&#123;3(n+m)/7&#125;)</span>.
      </p>
      <p class="text-gray-300">
        <strong>The model Q2.</strong> Problem 3 can be solved with
        <span class="math">O(n \cdot 2^&#123;m/2&#125;)</span>
        superposition queries and in time
        <span class="math">O(n^3 \cdot 2^&#123;m/2&#125;)</span>,
        using the Grover-meet-Simon algorithm of [LM17].
      </p>

      <h3 id="sec-3.2" class="text-xl font-semibold mt-8 mb-3">
        3.2 An Algorithm for Asymmetric Search of a Shift
      </h3>
      <p class="text-gray-300">
        <strong>Two observations.</strong> Our first observation is
        that, when doing the Grover search over
        <span class="math">i</span> for Problem 3, each time a new
        <span class="math">i</span> is tested, a new function
        <span class="math">f_i</span> is queried. But, in contrast,
        the function <span class="math">g</span> is always the same.
        We would like to take this asymmetry into account.
      </p>
      <p class="text-gray-300">
        Our second observation is that, for each
        <span class="math">i \in I</span>, once we have a
        superposition
        <span class="math">|\psi_g\rangle = \bigotimes^&#123;cn&#125; \sum_&#123;x \in \&#123;0,1\&#125;^n&#125; |x\rangle|g(x)\rangle</span>
        and given quantum oracle access to
        <span class="math">f_i</span>, we can determine if
        <span class="math">f_i \oplus g</span> has a period without
        making queries to <span class="math">g</span>.
      </p>

      <p class="text-gray-300">
        <strong>Algorithm Alg-PolyQ2 (informal).</strong>
        (1) Online phase: Make <span class="math">cn</span> quantum
        queries to <span class="math">g</span> to prepare
        <span class="math">|\psi_g\rangle</span>.
        (2) Offline computations: Run the Grover search over
        <span class="math">i \in \&#123;0,1\&#125;^m</span>. For each
        fixed <span class="math">i</span>, run a testing procedure
        <strong>test</strong> that checks if
        <span class="math">f_i \oplus g</span> has a period using
        <span class="math">|\psi_g\rangle</span> and queries to
        <span class="math">f_i</span>, then recovers
        <span class="math">|\psi_g\rangle</span>.
      </p>

      <p class="text-gray-300">
        <strong>Algorithm 3</strong> (the procedure
        <strong>test</strong>): Starting with the g-database
        <span class="math">|\psi_g\rangle</span>, use
        <span class="math">cn</span> superposition queries to
        <span class="math">f</span> to build
        <span class="math">|\psi_&#123;f \oplus g&#125;\rangle</span>.
        Apply
        <span class="math">(H^&#123;\otimes n&#125; \otimes I_m)^&#123;cn&#125; \otimes I_1</span>
        and compute
        <span class="math">d := \dim(\mathrm&#123;Span&#125;(u_1, \ldots, u_&#123;cn&#125;))</span>.
        Set <span class="math">r := 0</span> if
        <span class="math">d = n</span> and
        <span class="math">r := 1</span> if
        <span class="math">d &lt; n</span>. Then uncompute and revert
        <span class="math">|\psi_&#123;f \oplus g&#125;\rangle</span>
        to <span class="math">|\psi_g\rangle</span> using
        <span class="math">cn</span> new queries to
        <span class="math">f</span>.
      </p>

      <div class="formal-block formal-block-theorem">
        <div class="formal-block-title text-green-400">
          Proposition 2
        </div>
        <div class="formal-block-content">
          <p class="text-gray-300">
            Suppose that <span class="math">m</span> is in
            <span class="math">O(n)</span>. Let
            <span class="math">c</span> be a sufficiently large
            constant. Consider the setting of Problem 3: let
            <span class="math">i_0 \in \&#123;0,1\&#125;^m</span>
            be the good element such that
            <span class="math">g \oplus f_&#123;i_0&#125;</span>
            is periodic and assume that Condition (2) holds. Then
            Alg-PolyQ2 finds
            <span class="math">i_0</span> with a probability in
            <span class="math">\Theta(1)</span> by making
            <span class="math">O(n)</span> quantum queries to
            <span class="math">g</span> and
            <span class="math">O(n \cdot 2^&#123;m/2&#125;)</span>
            quantum queries to
            <span class="math">F</span>. The offline computation
            is done in time
            <span class="math">O((n^3 + nT_F) \cdot 2^&#123;m/2&#125;)</span>,
            where <span class="math">T_F</span> is the time required
            to evaluate <span class="math">F</span> once.
          </p>
        </div>
      </div>

      <h3 id="sec-3.3" class="text-xl font-semibold mt-8 mb-3">
        3.3 Asymmetric Search with Q1 Queries
      </h3>
      <p class="text-gray-300">
        In Alg-PolyQ2, (online) queries to <span class="math">g</span>
        and (offline) queries to <span class="math">F</span> are
        separated, and only <span class="math">cn</span>
        superposition queries to <span class="math">g</span> are
        made. Hence another tradeoff is at our reach: removing
        superposition queries to <span class="math">g</span>
        completely, by querying the whole codebook classically.
      </p>
      <p class="text-gray-300">
        <strong>Algorithm Alg-ExpQ1 (informal).</strong>
        (1) Online phase: Make
        <span class="math">2^n</span> classical queries to
        <span class="math">g</span> and prepare the state
        <span class="math">|\psi_g\rangle</span>.
        (2) Offline computations: Run the Grover search over
        <span class="math">i \in \&#123;0,1\&#125;^m</span>,
        using the same testing procedure as Alg-PolyQ2.
      </p>

      <div class="formal-block formal-block-theorem">
        <div class="formal-block-title text-green-400">
          Proposition 3
        </div>
        <div class="formal-block-content">
          <p class="text-gray-300">
            Suppose that <span class="math">m</span> is in
            <span class="math">O(n)</span>. Let
            <span class="math">c</span> be a sufficiently large
            constant. Consider the setting of Problem 3: let
            <span class="math">i_0 \in \&#123;0,1\&#125;^m</span>
            be the good element such that
            <span class="math">g \oplus f_&#123;i_0&#125;</span>
            is periodic and assume that Condition (2) holds. Then
            Alg-ExpQ1 finds
            <span class="math">i_0</span> with a probability in
            <span class="math">\Theta(1)</span> by making
            <span class="math">O(2^n)</span> classical queries to
            <span class="math">g</span> and
            <span class="math">O(n \cdot 2^&#123;m/2&#125;)</span>
            quantum queries to
            <span class="math">F</span>. The offline computation
            is done in time
            <span class="math">O((n^3 + nT_F) \cdot 2^&#123;m/2&#125;)</span>,
            where <span class="math">T_F</span> is the time required
            to evaluate <span class="math">F</span> once.
          </p>
        </div>
      </div>

      <p class="text-gray-300">
        <strong>Finding actual periods.</strong> The algorithm
        Alg-ExpQ1 returns the index
        <span class="math">i_0</span> but not the actual period.
        A separate algorithm SimQ1 can find the period of
        <span class="math">f_&#123;i_0&#125; \oplus g</span> using
        <span class="math">O(2^n)</span> classical queries and
        <span class="math">cn</span> quantum queries to
        <span class="math">f_&#123;i_0&#125;</span>.
      </p>

      <div class="formal-block formal-block-theorem">
        <div class="formal-block-title text-green-400">
          Proposition 4
        </div>
        <div class="formal-block-content">
          <p class="text-gray-300">
            Suppose that
            <span class="math">f_&#123;i_0&#125; \oplus g</span>
            has a period
            <span class="math">s \neq 0^n</span> and satisfies
          </p>
          <div class="math-block">
            \max_&#123;t \neq \&#123;s, 0^n\&#125;&#125; \Pr_x\left[(f_&#123;i_0&#125; \oplus g)(x \oplus t) = (f_&#123;i_0&#125; \oplus g)(x)\right] \leq \frac&#123;1&#125;&#123;2&#125;.
          </div>
          <p class="text-gray-300">
            Then SimQ1 returns <span class="math">s</span> with a
            probability at least
            <span class="math">1 - 2^n \cdot (3/4)^&#123;cn&#125;</span>
            by making
            <span class="math">O(2^n)</span> classical queries to
            <span class="math">g</span> and
            <span class="math">cn</span> quantum queries to
            <span class="math">f_&#123;i_0&#125;</span>. The offline
            computation runs in time
            <span class="math">O(n^3 + nT_f)</span>.
          </p>
        </div>
      </div>

      <div class="formal-block formal-block-theorem">
        <div class="formal-block-title text-green-400">
          Proposition 5 (Concrete cost estimates)
        </div>
        <div class="formal-block-content">
          <p class="text-gray-300">
            In practice, for Propositions 2 and 3,
            <span class="math">c \simeq m/(n \log_2(4/3))</span>
            is sufficient.
          </p>
        </div>
      </div>
    </section>

    <!-- ============================================================ -->
    <!-- 4. Q2 ATTACKS ON SYMMETRIC SCHEMES                           -->
    <!-- ============================================================ -->

    <section id="sec-4" class="mb-10">
      <h2 class="text-2xl font-bold">
        4. Q2 Attacks on Symmetric Schemes with Reduced Query
        Complexity
      </h2>
      <p class="text-gray-300">
        This section shows that Alg-PolyQ2 can be used to construct
        Q2 attacks on various symmetric schemes. By using Alg-PolyQ2
        we can exponentially reduce the number of quantum queries to
        the keyed oracle compared to previous Q2 attacks, with the
        same time cost. We assume that one evaluation of each
        primitive can be done in time
        <span class="math">O(1)</span>.
      </p>

      <h3 id="sec-4.1" class="text-xl font-semibold mt-8 mb-3">
        4.1 An Attack on the FX Construction
      </h3>
      <p class="text-gray-300">
        The FX construction builds an
        <span class="math">n</span>-bit block cipher
        <span class="math">\mathrm&#123;FX&#125;_&#123;k,k_&#123;\mathrm&#123;in&#125;&#125;,k_&#123;\mathrm&#123;out&#125;&#125;&#125;</span>
        with <span class="math">(2n+m)</span>-bit keys from another
        <span class="math">n</span>-bit block cipher
        <span class="math">E_k</span> with
        <span class="math">m</span>-bit keys as
      </p>
      <div class="math-block">
        \mathrm&#123;FX&#125;_&#123;k,k_&#123;\mathrm&#123;in&#125;&#125;,k_&#123;\mathrm&#123;out&#125;&#125;&#125;(x) := E_k(x \oplus k_&#123;\mathrm&#123;in&#125;&#125;) \oplus k_&#123;\mathrm&#123;out&#125;&#125;.
      </div>
      <p class="text-gray-300">
        <strong>Attack idea.</strong> The key recovery reduces to
        Problem 3 by defining
        <span class="math">F(i,x) = E_i(x) \oplus E_i(x \oplus 1)</span>
        and
        <span class="math">g(x) = \mathrm&#123;FX&#125;_&#123;k,k_&#123;\mathrm&#123;in&#125;&#125;,k_&#123;\mathrm&#123;out&#125;&#125;&#125;(x) \oplus \mathrm&#123;FX&#125;_&#123;k,k_&#123;\mathrm&#123;in&#125;&#125;,k_&#123;\mathrm&#123;out&#125;&#125;&#125;(x \oplus 1)</span>.
        Then
        <span class="math">f_k \oplus g</span> has period
        <span class="math">k_&#123;\mathrm&#123;in&#125;&#125;</span>.
      </p>
      <p class="text-gray-300">
        Our attack recovers the keys of the FX construction with
        <span class="math">O(n)</span> quantum queries to the
        (keyed) online oracle, and runs in time
        <span class="math">O(n^3 \cdot 2^&#123;m/2&#125;)</span>.
        Applications include DESX (needing roughly 135 quantum queries
        and
        <span class="math">2^&#123;29&#125;</span> quantum
        computations), PRINCE, and PRIDE.
      </p>
    </section>

    <!-- ============================================================ -->
    <!-- 5. Q1 ATTACKS ON SYMMETRIC SCHEMES                           -->
    <!-- ============================================================ -->

    <section id="sec-5" class="mb-10">
      <h2 class="text-2xl font-bold">
        5. Q1 Attacks on Symmetric Schemes
      </h2>
      <p class="text-gray-300">
        This section shows that Alg-ExpQ1 can be used to construct
        Q1 attacks on various symmetric schemes, with a tradeoff
        between online classical queries, denoted
        <span class="math">D</span>, and offline quantum
        computations, denoted <span class="math">T</span>.
      </p>

      <h3 id="sec-5.1" class="text-xl font-semibold mt-8 mb-3">
        5.1 Tradeoffs for the Even-Mansour Construction
      </h3>
      <p class="text-gray-300">
        The Even-Mansour construction [EM97] is a simple construction
        to make an <span class="math">n</span>-bit block cipher
        <span class="math">E_&#123;k_1,k_2&#125;</span> from an
        <span class="math">n</span>-bit public permutation
        <span class="math">P</span> and two
        <span class="math">n</span>-bit keys
        <span class="math">k_1, k_2</span>. The encryption is
        defined as
        <span class="math">E_&#123;k_1,k_2&#125;(x) := P(x \oplus k_1) \oplus k_2</span>.
        In the classical setting, it is proven secure up to
        <span class="math">O(2^&#123;n/2&#125;)</span> online queries
        and offline computations [EM97].
      </p>
      <p class="text-gray-300">
        <strong>Application of Alg-ExpQ1.</strong> The tradeoff we
        obtain is
        <span class="math">T^2 \cdot D = 2^n</span>, which balances
        at
        <span class="math">T = D = \tilde&#123;O&#125;(2^&#123;n/3&#125;)</span>,
        using only
        <span class="math">\mathrm&#123;poly&#125;(n)</span> qubits
        and
        <span class="math">\mathrm&#123;poly&#125;(n)</span>
        classical memory.
      </p>
      <p class="text-gray-300">
        <strong>Attack description.</strong> Let
        <span class="math">u</span> be an integer with
        <span class="math">0 \leq u \leq n</span>. We divide
        <span class="math">k_1</span> into
        <span class="math">k_1^&#123;(1)&#125;</span> of
        <span class="math">u</span> bits and
        <span class="math">k_1^&#123;(2)&#125;</span> of
        <span class="math">n - u</span> bits. Define
        <span class="math">F(i,x) = P(x \| i)</span> and
        <span class="math">g(x) = E_&#123;k_1,k_2&#125;(x \| 0^&#123;n-u&#125;)</span>.
        Note that
        <span class="math">F(k_1^&#123;(2)&#125;, x) \oplus g(x)</span>
        has the period
        <span class="math">k_1^&#123;(1)&#125;</span>. Our attack
        proceeds:
      </p>
      <ol class="list-decimal list-inside space-y-1 text-gray-300
        text-sm ml-4">
        <li>
          Run Alg-ExpQ1 for the above
          <span class="math">F</span> and
          <span class="math">g</span> to recover
          <span class="math">k_1^&#123;(2)&#125;</span>.
        </li>
        <li>
          Recover <span class="math">k_1^&#123;(1)&#125;</span>
          by applying SimQ1 to
          <span class="math">f_&#123;k_1^&#123;(2)&#125;&#125;</span>
          and <span class="math">g</span>.
        </li>
        <li>
          Compute
          <span class="math">k_2 = E_&#123;k_1,k_2&#125;(0^n) \oplus P(k_1)</span>.
        </li>
      </ol>
      <p class="text-gray-300">
        In summary, our attack recovers keys with
        <span class="math">D = O(2^u)</span> classical queries and
        <span class="math">T = O(n^3 \cdot 2^&#123;(n-u)/2&#125;)</span>
        offline computations, which balances at
        <span class="math">T = D = \tilde&#123;O&#125;(2^&#123;n/3&#125;)</span>.
      </p>

      <h3 id="sec-5.2" class="text-xl font-semibold mt-8 mb-3">
        5.2 Tradeoffs for the FX Construction
      </h3>
      <p class="text-gray-300">
        For the FX construction
        <span class="math">\mathrm&#123;FX&#125;_&#123;k,k_&#123;\mathrm&#123;in&#125;&#125;,k_&#123;\mathrm&#123;out&#125;&#125;&#125;</span>,
        we divide the <span class="math">n</span>-bit key
        <span class="math">k_&#123;\mathrm&#123;in&#125;&#125;</span>
        into
        <span class="math">k_&#123;\mathrm&#123;in&#125;&#125;^&#123;(1)&#125;</span>
        of <span class="math">u</span> bits and
        <span class="math">k_&#123;\mathrm&#123;in&#125;&#125;^&#123;(2)&#125;</span>
        of <span class="math">(n-u)</span> bits. We apply
        Simon&rsquo;s algorithm to recover
        <span class="math">k_&#123;\mathrm&#123;in&#125;&#125;^&#123;(1)&#125;</span>
        while performing Grover search on
        <span class="math">k</span> in addition to
        <span class="math">k_&#123;\mathrm&#123;in&#125;&#125;^&#123;(2)&#125;</span>.
      </p>
      <p class="text-gray-300">
        <strong>Attack description.</strong> Define
        <span class="math">F(i \| j, x) = E_i(x \| j)</span> and
        <span class="math">g(x) = \mathrm&#123;FX&#125;_&#123;k,k_&#123;\mathrm&#123;in&#125;&#125;,k_&#123;\mathrm&#123;out&#125;&#125;&#125;(x \| 0^&#123;n-u&#125;)</span>.
        Our new tradeoff is
        <span class="math">T^2 \cdot D = 2^&#123;n+m&#125;</span>
        for <span class="math">D \leq 2^n</span>, which balances at
        <span class="math">T = D = \tilde&#123;O&#125;(2^&#123;(n+m)/3&#125;)</span>
        (for <span class="math">m \leq 2n</span>), using only
        <span class="math">\mathrm&#123;poly&#125;(n)</span> qubits.
      </p>
      <p class="text-gray-300">
        Applications include DESX (roughly
        <span class="math">2^&#123;42&#125;</span> classical queries
        and <span class="math">2^&#123;40&#125;</span> quantum
        computations), PRINCE and PRIDE (roughly
        <span class="math">2^&#123;45&#125;</span> queries and
        <span class="math">2^&#123;43&#125;</span> computations),
        and encryption modes such as XTS and Adiantum.
      </p>

      <h3 id="sec-5.3" class="text-xl font-semibold mt-8 mb-3">
        5.3 Other Applications
      </h3>
      <p class="text-gray-300">
        <strong>Chaskey.</strong> The lightweight MAC Chaskey [MMV+14]
        is very close to an Even-Mansour construction. With a data
        limit of <span class="math">2^&#123;48&#125;</span>, the
        attack requires roughly
        <span class="math">2^&#123;59&#125;</span> quantum gates.
      </p>
      <p class="text-gray-300">
        <strong>Sponges.</strong> The attack can be used on sponges
        if there is an input injected on a fixed state. The cost is at
        least
        <span class="math">2^&#123;c/2&#125;</span> with
        <span class="math">c</span> the capacity. This applies to
        the Beetle mode of lightweight authenticated encryption [CDN+18].
        In Beetle[Light+], with rate
        <span class="math">r = 64</span> bits and capacity
        <span class="math">c = 80</span> bits, we can recover the
        secret key with
        <span class="math">2^&#123;48&#125;</span> classical queries
        and <span class="math">2^&#123;48&#125;</span> Grover
        iterations. In Beetle[Secure+] with
        <span class="math">r = c = 128</span>, key recovery takes
        <span class="math">2^&#123;85&#125;</span> messages and
        Grover iterations.
      </p>
    </section>

    <!-- ============================================================ -->
    <!-- 6. DISCUSSION                                                -->
    <!-- ============================================================ -->

    <section id="sec-6" class="mb-10">
      <h2 class="text-2xl font-bold">6. Discussion</h2>
      <p class="text-gray-300">
        This section discusses the application of the attack idea to
        related-key attacks, to some slide attacks, and to an extension
        of Problem 3.
      </p>

      <h3 id="sec-6.1" class="text-xl font-semibold mt-8 mb-3">
        6.1 Related Keys
      </h3>
      <p class="text-gray-300">
        Consider a block cipher
        <span class="math">E_k</span> with a key and block size of
        <span class="math">n</span> bits. In the related-key setting
        [WRH+87], we can query
        <span class="math">E_&#123;k \oplus \ell&#125;(m)</span>
        for any <span class="math">n</span>-bit difference
        <span class="math">\ell</span> and message
        <span class="math">m</span>. R&ouml;tteler and Steinwandt
        [RS15] noticed that a quantum adversary with superposition
        access can mount a key-recovery in polynomial time using
        Simon&rsquo;s algorithm on the function
        <span class="math">f(x) = E_&#123;k \oplus x&#125;(m) \oplus E_x(m)</span>,
        which has <span class="math">k</span> as hidden period.
      </p>
      <p class="text-gray-300">
        With Alg-ExpQ1, we translate this into an attack where the
        related-key oracle is queried only classically: write
        <span class="math">k = k_1 \| k_2</span> where
        <span class="math">k_1</span> has
        <span class="math">n/3</span> bits and
        <span class="math">k_2</span> has
        <span class="math">2n/3</span> bits. The classical
        related-key security level of
        <span class="math">2^&#123;n/2&#125;</span> is reduced
        quantumly to
        <span class="math">2^&#123;n/3&#125;</span>. For
        Saturnin (256-bit blocks), the Q1 related-key security
        level is at least
        <span class="math">2^&#123;256/3&#125; = 2^&#123;85&#125;</span>.
      </p>

      <h3 id="sec-6.2" class="text-xl font-semibold mt-8 mb-3">
        6.2 Slide Attacks
      </h3>
      <p class="text-gray-300">
        Some quantum slide attacks use a partial exhaustive search.
        This is the case of the slide attack against 2-round
        self-similar ciphers of [LM17] and the slide attacks against
        whitened Feistels of [BNS20]. The authors show how a 2-round
        self-similar cipher can be seen as an iterated FX cipher, and
        the attack can recover
        <span class="math">k_1</span> and
        <span class="math">k_2</span> using
        <span class="math">O(|k_1|)</span> queries and
        <span class="math">O(|k_1|^3 \cdot 2^&#123;|k_2|/2&#125;)</span>
        time.
      </p>

      <div class="formal-block formal-block-definition">
        <div class="formal-block-title text-blue-400">
          Problem 4 (Constructing and Finding a Hidden Period)
        </div>
        <div class="formal-block-content">
          <p class="text-gray-300">
            Let
            <span class="math">g:\&#123;0,1\&#125;^n \to \&#123;0,1\&#125;^\ell</span>
            be a function,
            <span class="math">i \in I</span>,
            <span class="math">p_i:\&#123;0,1\&#125;^n \to \&#123;0,1\&#125;^n</span>
            be a permutation and
            <span class="math">F_i:\&#123;0,1\&#125;^n \times \&#123;0,1\&#125;^\ell \to \&#123;0,1\&#125;^\ell</span>
            be a function such that
            <span class="math">F_i(x,\cdot)</span> is a permutation.
            Assume that there exists
            <span class="math">i_0 \in I</span> such that
            <span class="math">f_&#123;i_0&#125;(x) = F_&#123;i_0&#125;(x, g(p_&#123;i_0&#125;(x)))</span>
            has a period. Then find
            <span class="math">i_0</span> and
            <span class="math">s</span>.
          </p>
        </div>
      </div>

      <p class="text-gray-300">
        This problem generalizes Problem 3. The transformation from
        the graph of <span class="math">g</span> to the graph of
        <span class="math">f_i</span> can be seen as a generalization
        of the CCZ equivalence [CCZ98].
      </p>
    </section>

    <!-- ============================================================ -->
    <!-- 7. CONCLUSION                                                -->
    <!-- ============================================================ -->

    <section id="sec-7" class="mb-10">
      <h2 class="text-2xl font-bold">7. Conclusion</h2>
      <p class="text-gray-300">
        In this paper, we have introduced a new quantum algorithm, in
        which we make use of Simon&rsquo;s algorithm in an offline
        way. The idea of making
        <span class="math">\mathrm&#123;poly&#125;(n)</span>
        superposition queries to the oracle, storing them as some
        compressed database on
        <span class="math">n^2</span> qubits, and reusing them
        during the iterations of a Grover search, yielded surprising
        results. This idea, initially targeting the query complexity
        of some Q2 attacks, enabled us to find new quantum-time /
        classical-data tradeoffs.
      </p>
      <p class="text-gray-300">
        <strong>Simon&rsquo;s Algorithm can be Used in An Offline
        Setting.</strong> We provided the first example of use of
        Simon&rsquo;s algorithm (or more precisely, its core idea) in
        an offline setting, without quantum oracle queries.
      </p>
      <p class="text-gray-300">
        <strong>Improving More than the Time Complexity.</strong>
        Consider the example of our attack on the Even-Mansour
        construction in quantum time
        <span class="math">\tilde&#123;O&#125;(2^&#123;n/3&#125;)</span>
        and classical queries
        <span class="math">O(2^&#123;n/3&#125;)</span>. With the
        same number of queries, the classical attack requires
        <span class="math">O(2^&#123;2n/3&#125;)</span> time and
        <span class="math">O(2^&#123;n/3&#125;)</span> classical
        memory to store the queries. In our attack, we do not need
        this storage. To the best of our knowledge, this is the first
        time that a quantum Q1 attack provides a quadratic speedup
        while the needs of hardware are also reduced.
      </p>
      <p class="text-gray-300">
        <strong>Q2 Attacks Make a Difference.</strong> Schemes which
        do not have an attack in the superposition model cannot be
        attacked by our algorithm. We showed that their algebraic
        structure, which makes the superposition attack possible,
        indeed made a practical difference when it came to Q1 attacks.
      </p>
    </section>

    <!-- ============================================================ -->
    <!-- APPENDIX A                                                   -->
    <!-- ============================================================ -->

    <section id="appendix-a" class="mb-10">
      <h2 class="text-2xl font-bold">
        Appendix A: Proofs for Propositions 2 and 3
      </h2>
      <p class="text-gray-300">
        The appendix provides error and complexity analyses for
        Alg-ExpQ1 and Alg-PolyQ2, requiring two kinds of analyses:
        (1) analyses on the error of the procedure
        <strong>test</strong>, and (2) analyses on how much the error
        of <strong>test</strong> affects the success probability of
        the entire Grover search.
      </p>

      <h3 class="text-xl font-semibold mt-8 mb-3">
        A.1 Error Analyses for the Testing Procedure test
      </h3>

      <div class="formal-block formal-block-lemma">
        <div class="formal-block-title text-amber-400">Lemma 1</div>
        <div class="formal-block-content">
          <p class="text-gray-300">
            It holds that
          </p>
          <div class="math-block">
            \mathrm&#123;test&#125;\left(\sum_&#123;f_i \in F_1&#125; \beta_i |i\rangle |\psi_g\rangle |b\rangle\right) = \sum_&#123;f_i \in F_1&#125; \beta_i |i\rangle |\psi_g\rangle |b \oplus 1\rangle
          </div>
          <p class="text-gray-300">
            for <span class="math">b \in \&#123;0,1\&#125;</span>.
            In addition, suppose that there exists a constant
            <span class="math">0 \leq \epsilon &lt; 1</span> such
            that
          </p>
          <div class="math-block">
            \max_&#123;\substack&#123;t \in \&#123;0,1\&#125;^n \setminus \&#123;0^n\&#125; \\ f_i \in F_0&#125;&#125; \Pr_&#123;x \leftarrow \&#123;0,1\&#125;^n&#125;\left[(f_i \oplus g)(x \oplus t) = (f_i \oplus g)(x)\right] \leq \epsilon
          </div>
          <p class="text-gray-300">
            Then, for arbitrary
            <span class="math">b \in \&#123;0,1\&#125;</span>, there
            exists a vector
            <span class="math">|\delta_b\rangle</span> such that
            <span class="math">\||\delta_b\rangle\| &lt; 2^&#123;(n+1)/2&#125;((1+\epsilon)/2)^&#123;cn/2&#125;</span>
            and
          </p>
          <div class="math-block">
            \mathrm&#123;test&#125;\left(\sum_&#123;f_i \in F_0&#125; \alpha_i |i\rangle |\psi_g\rangle |b\rangle\right) = \sum_&#123;f_i \in F_0&#125; \alpha_i |i\rangle |\psi_g\rangle |b\rangle + |\delta_b\rangle
          </div>
          <p class="text-gray-300">holds.</p>
        </div>
      </div>

      <h3 class="text-xl font-semibold mt-8 mb-3">
        A.2 Error Propagation Analyses for QAA
      </h3>
      <p class="text-gray-300">
        The appendix analyzes the quantum amplitude amplification
        (QAA) technique by Brassard et al. [BHM+02] with uncertain
        checking procedures. The key result is the following:
      </p>

      <div class="formal-block formal-block-lemma">
        <div class="formal-block-title text-amber-400">Lemma 2
          (Lemma 1 in [BHM+02])</div>
        <div class="formal-block-content">
          <p class="text-gray-300">
            It holds that
          </p>
          <div class="math-block">
            Q|\phi_1\rangle = \cos 2\theta_a |\phi_1\rangle - \sin 2\theta_a |\phi_0\rangle,
          </div>
          <div class="math-block">
            Q|\phi_0\rangle = \sin 2\theta_a |\phi_1\rangle + \cos 2\theta_a |\phi_0\rangle.
          </div>
        </div>
      </div>

      <div class="formal-block formal-block-theorem">
        <div class="formal-block-title text-green-400">
          Proposition 6 (Theorem 2 in [BHM+02])
        </div>
        <div class="formal-block-content">
          <p class="text-gray-300">
            Set
            <span class="math">r := \lfloor \pi/4\theta_a \rfloor</span>,
            where <span class="math">\theta_a</span> is the parameter
            such that
            <span class="math">\sin^2 \theta_a = a</span> and
            <span class="math">0 &lt; \theta_a \leq \pi/2</span>.
            When we measure
            <span class="math">Q^r \mathcal&#123;A&#125;|0^n\rangle</span>,
            we obtain
            <span class="math">x \in \&#123;0,1\&#125;^n</span>
            such that
            <span class="math">\chi(x) = 1</span> with a probability
            at least
            <span class="math">\max(1-a, a)</span>.
          </p>
        </div>
      </div>

      <div class="formal-block formal-block-lemma">
        <div class="formal-block-title text-amber-400">Lemma 3</div>
        <div class="formal-block-content">
          <p class="text-gray-300">
            There exist vectors
            <span class="math">|\delta_0'\rangle, |\delta_1'\rangle</span>
            such that
            <span class="math">\||\delta_0'\rangle\|, \||\delta_1'\rangle\| \leq 2\epsilon</span>
            and
          </p>
          <div class="math-block">
            Q'|\phi_1\rangle|\psi\rangle = (\cos 2\theta_a|\phi_1\rangle - \sin 2\theta_a|\phi_0\rangle)|\psi\rangle + |\delta_1'\rangle,
          </div>
          <div class="math-block">
            Q'|\phi_0\rangle|\psi\rangle = (\sin 2\theta_a|\phi_1\rangle + \cos 2\theta_a|\phi_0\rangle)|\psi\rangle + |\delta_0'\rangle.
          </div>
        </div>
      </div>

      <div class="formal-block formal-block-theorem">
        <div class="formal-block-title text-green-400">
          Proposition 7 (QAA with uncertain checking procedures)
        </div>
        <div class="formal-block-content">
          <p class="text-gray-300">
            Let <span class="math">\epsilon</span> be the error of
            <span class="math">\widehat&#123;\mathcal&#123;S&#125;'_\chi&#125;</span>.
            Then we have that
          </p>
          <div class="math-block">
            \left| \Pr\left[x \leftarrow \left(\mathrm&#123;measure&#125;\; Q'^&#123;j&#125; \mathcal&#123;A&#125;|0^n\rangle|\psi\rangle\right) : \chi(x) = 1\right] - \Pr\left[x \leftarrow \left(\mathrm&#123;measure&#125;\; Q^j \mathcal&#123;A&#125;|0^n\rangle\right) : \chi(x) = 1\right] \right| \leq 4j\epsilon
          </div>
          <p class="text-gray-300">
            for all
            <span class="math">x \in \&#123;0,1\&#125;^n</span>. In
            particular, for
            <span class="math">r := \lfloor \pi / 4\theta_a \rfloor</span>,
            we obtain
            <span class="math">x</span> such that
            <span class="math">\chi(x) = 1</span> with a probability
            at least
            <span class="math">\max(1-a,a) - 4r\epsilon</span>.
          </p>
        </div>
      </div>

      <h3 class="text-xl font-semibold mt-8 mb-3">
        A.3 Finishing the Proofs
      </h3>

      <div class="formal-block formal-block-lemma">
        <div class="formal-block-title text-amber-400">Lemma 4</div>
        <div class="formal-block-content">
          <p class="text-gray-300">
            Suppose that <span class="math">m</span> is in
            <span class="math">O(n)</span>. Let
            <span class="math">c</span> be a sufficiently large
            constant, and let
            <span class="math">i_0 \in \&#123;0,1\&#125;^m</span>
            be the good element such that
            <span class="math">g \oplus f_&#123;i_0&#125;</span>
            is periodic. Assume that Condition (2) holds, and the
            quantum state
            <span class="math">|\psi_g\rangle</span> is given. Then,
            the offline phase of Alg-ExpQ1 and Alg-PolyQ2 finds a
            good
            <span class="math">i \in \&#123;0,1\&#125;^m</span>
            with a probability in
            <span class="math">\Theta(1)</span> by making
            <span class="math">O(n \cdot 2^&#123;m/2&#125;)</span>
            quantum queries to
            <span class="math">F</span>. The offline computation is
            done in time
            <span class="math">O((n^3 + nT_F) \cdot 2^&#123;m/2&#125;)</span>.
          </p>
        </div>
      </div>
    </section>

    <!-- ============================================================ -->
    <!-- APPENDIX B                                                   -->
    <!-- ============================================================ -->

    <section id="appendix-b" class="mb-10">
      <h2 class="text-2xl font-bold">
        Appendix B: Adaptive Attacks and Non-Adaptive Attacks
      </h2>
      <p class="text-gray-300">
        The attack on the FX construction in the Q2 model is
        non-adaptive since the online queries required to make the
        state <span class="math">|\psi_g\rangle</span> are just the
        uniform superposition of plaintexts. On the other hand, the
        previous Q2 attack on the construction by Leander and May is
        adaptive since quantum queries made to keyed online oracles
        are changed depending on the results for previous quantum
        queries. For Q1 attacks, both existing quantum attacks and the
        authors&rsquo; attacks are non-adaptive.
      </p>
    </section>

    <!-- ============================================================ -->
    <!-- ACKNOWLEDGEMENTS                                             -->
    <!-- ============================================================ -->

    <section id="acknowledgements" class="mb-10">
      <h2 class="text-2xl font-bold">Acknowledgements</h2>
      <p class="text-gray-300">
        The authors thank L&eacute;o Perrin for proofreading this
        article and Elena Kirshanova for helpful remarks. This
        project has received funding from the European Research
        Council (ERC) under the European Union&rsquo;s Horizon 2020
        research and innovation programme (grant agreement
        n&deg; 714294 &ndash; acronym QUASYModo).
      </p>
    </section>

    <!-- ============================================================ -->
    <!-- REFERENCES                                                   -->
    <!-- ============================================================ -->

    <section id="references" class="mb-10">
      <h2 class="text-2xl font-bold">References</h2>
      <ul class="space-y-2 text-gray-400 text-sm list-none">
        <li>
          <span class="text-gray-500">[AMD+14]</span>
          Albrecht, M.R., Driessen, B., Kavun, E.B., Leander, G.,
          Paar, C., Yal&ccedil;in, T.: Block ciphers &ndash; focus on
          the linear layer (feat. PRIDE). In: <em>CRYPTO 2014</em>.
          LNCS, vol. 8616, pp. 57&ndash;76. Springer (2014).
        </li>
        <li>
          <span class="text-gray-500">[BDH+17]</span>
          Bertoni, G., Daemen, J., Hoffert, S., Peeters, M.,
          Van Assche, G., Van Keer, R.: Farfalle: parallel
          permutation-based cryptography. <em>IACR Trans. Symmetric
          Cryptol.</em> 2017(4), 1&ndash;38 (2017).
        </li>
        <li>
          <span class="text-gray-500">[BWD99]</span>
          Biryukov, A., Wagner, D.A.: Slide attacks. In:
          <em>FSE 1999</em>. LNCS, vol. 1636, pp. 245&ndash;259.
          Springer (1999).
        </li>
        <li>
          <span class="text-gray-500">[Bon18]</span>
          Bonnetain, X.: Quantum key-recovery on full AEZ. In:
          <em>SAC 2017</em>. LNCS, vol. 10719, pp. 394&ndash;406.
          Springer (2018).
        </li>
        <li>
          <span class="text-gray-500">[BN18]</span>
          Bonnetain, X., Naya-Plasencia, M.: Hidden shift quantum
          cryptanalysis and implications. In: <em>ASIACRYPT
          2018</em>. LNCS, vol. 11272, pp. 560&ndash;592. Springer
          (2018).
        </li>
        <li>
          <span class="text-gray-500">[BNS20]</span>
          Bonnetain, X., Naya-Plasencia, M., Schrottenloher, A.:
          On quantum slide attacks. In: <em>SAC 2019</em>. LNCS.
          Springer (2020).
        </li>
        <li>
          <span class="text-gray-500">[BCG+12]</span>
          Borghoff, J., Canteaut, A., G&uuml;neysu, T., Kavun,
          E.B., Knezevic, M., Knudsen, L.R., Leander, G., Nikov, V.,
          Paar, C., Rechberger, C., Rombouts, P., Thomsen, S.S.,
          Yal&ccedil;in, T.: PRINCE &ndash; A low-latency block
          cipher for pervasive computing applications. In:
          <em>ASIACRYPT 2012</em>. LNCS, vol. 7658, pp.
          208&ndash;225. Springer (2012).
        </li>
        <li>
          <span class="text-gray-500">[BHM+02]</span>
          Brassard, G., H&oslash;yer, P., Mosca, M., Tapp, A.:
          Quantum amplitude amplification and estimation.
          <em>Contemporary Mathematics</em> 305, 53&ndash;74 (2002).
        </li>
        <li>
          <span class="text-gray-500">[BHT98]</span>
          Brassard, G., H&oslash;yer, P., Tapp, A.: Quantum
          cryptanalysis of hash and claw-free functions. In:
          <em>LATIN 1998</em>. LNCS, vol. 1380, pp. 163&ndash;169.
          Springer (1998). doi:
          <a
            href="https://doi.org/10.1007/BFb0054319"
            target="_blank"
            rel="noopener noreferrer"
            class="text-blue-400 hover:text-blue-300"
          >10.1007/BFb0054319</a>.
        </li>
        <li>
          <span class="text-gray-500">[CDL+19]</span>
          Canteaut, A., Duval, S., Leurent, G.,
          Naya-Plasencia, M., Perrin, L., Pornin, T.,
          Schrottenloher, A.: Saturnin: a suite of lightweight
          symmetric algorithms for post-quantum security (2019).
        </li>
        <li>
          <span class="text-gray-500">[CCZ98]</span>
          Carlet, C., Charpin, P., Zinoviev, V.: Codes, bent
          functions and permutations suitable for DES-like
          cryptosystems. <em>Designs, Codes and Cryptography</em>
          15(2), 125&ndash;156 (1998).
        </li>
        <li>
          <span class="text-gray-500">[CNS17]</span>
          Chailloux, A., Naya-Plasencia, M., Schrottenloher, A.:
          An efficient quantum collision search algorithm and
          implications on symmetric cryptography. In:
          <em>ASIACRYPT 2017</em>. LNCS, vol. 10625, pp.
          211&ndash;240. Springer (2017).
        </li>
        <li>
          <span class="text-gray-500">[CDN+18]</span>
          Chakraborti, A., Datta, N., Nandi, M., Yasuda, K.:
          Beetle family of lightweight and secure authenticated
          encryption ciphers. <em>IACR Trans. Cryptogr. Hardw. Embed.
          Syst.</em> 2018(2), 218&ndash;241 (2018). doi:
          <a
            href="https://doi.org/10.13154/tches.v2018.i2.218-241"
            target="_blank"
            rel="noopener noreferrer"
            class="text-blue-400 hover:text-blue-300"
          >10.13154/tches.v2018.i2.218-241</a>.
        </li>
        <li>
          <span class="text-gray-500">[CB18]</span>
          Crowley, P., Biggers, E.: Adiantum: length-preserving
          encryption for entry-level processors. <em>IACR Trans.
          Symmetric Cryptol.</em> 2018(4), 39&ndash;61 (2018). doi:
          <a
            href="https://doi.org/10.13154/tosc.v2018.i4.39-61"
            target="_blank"
            rel="noopener noreferrer"
            class="text-blue-400 hover:text-blue-300"
          >10.13154/tosc.v2018.i4.39-61</a>.
        </li>
        <li>
          <span class="text-gray-500">[Dae91]</span>
          Daemen, J.: Limitations of the Even-Mansour
          construction. In: <em>ASIACRYPT 1991</em>. LNCS, vol. 739,
          pp. 495&ndash;498. Springer (1991).
        </li>
        <li>
          <span class="text-gray-500">[DHV+18]</span>
          Daemen, J., Hoffert, S., Van Assche, G., Van Keer, R.:
          The design of Xoodoo and Xoofff. <em>IACR Trans. Symmetric
          Cryptol.</em> 2018(4), 1&ndash;38 (2018). doi:
          <a
            href="https://doi.org/10.13154/tosc.v2018.i4.1-38"
            target="_blank"
            rel="noopener noreferrer"
            class="text-blue-400 hover:text-blue-300"
          >10.13154/tosc.v2018.i4.1-38</a>.
        </li>
        <li>
          <span class="text-gray-500">[Din15]</span>
          Dinur, I.: Cryptanalytic time-memory-data tradeoffs for
          FX-constructions with applications to PRINCE and PRIDE. In:
          <em>EUROCRYPT 2015</em>. LNCS, vol. 9056, pp.
          231&ndash;253. Springer (2015).
        </li>
        <li>
          <span class="text-gray-500">[DDK+14]</span>
          Dinur, I., Dunkelman, O., Keller, N., Shamir, A.:
          Cryptanalysis of iterated Even-Mansour schemes with two
          keys. In: <em>ASIACRYPT 2014</em>. LNCS, vol. 8873, pp.
          439&ndash;457. Springer (2014).
        </li>
        <li>
          <span class="text-gray-500">[EM97]</span>
          Even, S., Mansour, Y.: A construction of a cipher from
          a single pseudorandom permutation. <em>J. Cryptology</em>
          10(3), 151&ndash;162 (1997). doi:
          <a
            href="https://doi.org/10.1007/s001459900025"
            target="_blank"
            rel="noopener noreferrer"
            class="text-blue-400 hover:text-blue-300"
          >10.1007/s001459900025</a>.
        </li>
        <li>
          <span class="text-gray-500">[Gag17]</span>
          Gagliardoni, T.: Quantum Security of Cryptographic
          Primitives. Ph.D. thesis, Darmstadt University of
          Technology, Germany (2017).
        </li>
        <li>
          <span class="text-gray-500">[GLR+16]</span>
          Grassl, M., Langenberg, B., Roetteler, M.,
          Steinwandt, R.: Applying Grover&rsquo;s algorithm to AES:
          quantum resource estimates. In: <em>PQCrypto 2016</em>.
          LNCS, vol. 9606, pp. 29&ndash;43. Springer (2016).
        </li>
        <li>
          <span class="text-gray-500">[GL96]</span>
          Grover, L.K.: A fast quantum mechanical algorithm for
          database search. In: <em>STOC 1996</em>. pp. 212&ndash;219.
          ACM (1996). doi:
          <a
            href="https://doi.org/10.1145/237814.237866"
            target="_blank"
            rel="noopener noreferrer"
            class="text-blue-400 hover:text-blue-300"
          >10.1145/237814.237866</a>.
        </li>
        <li>
          <span class="text-gray-500">[HS18]</span>
          Hosoyamada, A., Sasaki, Y.: Cryptanalysis against
          symmetric-key schemes with online classical queries and
          offline quantum computations. In: <em>CT-RSA 2018</em>.
          LNCS, vol. 10808, pp. 198&ndash;218. Springer (2018).
        </li>
        <li>
          <span class="text-gray-500">[KLL+16]</span>
          Kaplan, M., Leurent, G., Leverrier, A.,
          Naya-Plasencia, M.: Breaking symmetric cryptosystems using
          quantum period finding. In: <em>CRYPTO 2016</em>. LNCS,
          vol. 9815, pp. 207&ndash;237. Springer (2016).
        </li>
        <li>
          <span class="text-gray-500">[KLL+16b]</span>
          Kaplan, M., Leurent, G., Leverrier, A.,
          Naya-Plasencia, M.: Quantum differential and linear
          cryptanalysis. <em>IACR Trans. Symmetric Cryptol.</em>
          2016(1), 71&ndash;94 (2016).
        </li>
        <li>
          <span class="text-gray-500">[KR96]</span>
          Kilian, J., Rogaway, P.: How to protect DES against
          exhaustive key search. In: <em>CRYPTO 1996</em>. LNCS,
          vol. 1109, pp. 252&ndash;267. Springer (1996).
        </li>
        <li>
          <span class="text-gray-500">[Kup05]</span>
          Kuperberg, G.: A subexponential-time quantum algorithm
          for the dihedral hidden subgroup problem. <em>SIAM J.
          Comput.</em> 35(1), 170&ndash;188 (2005). doi:
          <a
            href="https://doi.org/10.1137/S0097539703436345"
            target="_blank"
            rel="noopener noreferrer"
            class="text-blue-400 hover:text-blue-300"
          >10.1137/S0097539703436345</a>.
        </li>
        <li>
          <span class="text-gray-500">[Kup13]</span>
          Kuperberg, G.: Another subexponential-time quantum
          algorithm for the dihedral hidden subgroup problem. In:
          <em>TQC 2013</em>. LIPIcs, vol. 22, pp. 20&ndash;34.
          Schloss Dagstuhl (2013).
        </li>
        <li>
          <span class="text-gray-500">[KM10]</span>
          Kuwakado, H., Morii, M.: Quantum distinguisher between
          the 3-round Feistel cipher and the random permutation. In:
          <em>ISIT 2010</em>. pp. 2682&ndash;2685. IEEE (2010).
        </li>
        <li>
          <span class="text-gray-500">[KM12]</span>
          Kuwakado, H., Morii, M.: Security on the quantum-type
          Even-Mansour cipher. In: <em>ISITA 2012</em>. pp.
          312&ndash;316. IEEE (2012).
        </li>
        <li>
          <span class="text-gray-500">[LM17]</span>
          Leander, G., May, A.: Grover meets Simon &ndash;
          quantumly attacking the FX-construction. In:
          <em>ASIACRYPT 2017</em>. LNCS, vol. 10625, pp.
          161&ndash;178. Springer (2017).
        </li>
        <li>
          <span class="text-gray-500">[Mar10]</span>
          Martin, L.: XTS: A mode of AES for encrypting hard
          disks. <em>IEEE Security &amp; Privacy</em> 8(3),
          68&ndash;69 (2010). doi:
          <a
            href="https://doi.org/10.1109/MSP.2010.111"
            target="_blank"
            rel="noopener noreferrer"
            class="text-blue-400 hover:text-blue-300"
          >10.1109/MSP.2010.111</a>.
        </li>
        <li>
          <span class="text-gray-500">[MMV+14]</span>
          Mouha, N., Mennink, B., Van Herrewege, A.,
          Watanabe, D., Preneel, B., Verbauwhede, I.: Chaskey: An
          efficient MAC algorithm for 32-bit microcontrollers. In:
          <em>SAC 2014</em>. LNCS, vol. 8781, pp. 306&ndash;323.
          Springer (2014).
        </li>
        <li>
          <span class="text-gray-500">[NEM18]</span>
          National Academies of Sciences, Engineering, and
          Medicine: Quantum Computing: Progress and Prospects. The
          National Academies Press, Washington, DC (2018).
        </li>
        <li>
          <span class="text-gray-500">[Nat16]</span>
          National Institute of Standards and Technology:
          Submission requirements and evaluation criteria for the
          post-quantum cryptography standardization process (2016).
        </li>
        <li>
          <span class="text-gray-500">[NMC02]</span>
          Nielsen, M.A., Chuang, I.: Quantum computation and
          quantum information. AAPT (2002).
        </li>
        <li>
          <span class="text-gray-500">[RS15]</span>
          R&ouml;tteler, M., Steinwandt, R.: A note on quantum
          related-key attacks. <em>Inf. Process. Lett.</em> 115(1),
          40&ndash;44 (2015). doi:
          <a
            href="https://doi.org/10.1016/j.ipl.2014.08.009"
            target="_blank"
            rel="noopener noreferrer"
            class="text-blue-400 hover:text-blue-300"
          >10.1016/j.ipl.2014.08.009</a>.
        </li>
        <li>
          <span class="text-gray-500">[STA+15]</span>
          Sasaki, Y., Todo, Y., Aoki, K., Naito, Y.,
          Sugawara, T., Murakami, Y., Matsui, M., Hirose, S.:
          Minalpher v1.1. CAESAR competition (2015).
        </li>
        <li>
          <span class="text-gray-500">[SP94]</span>
          Shor, P.W.: Algorithms for quantum computation:
          Discrete logarithms and factoring. In: <em>35th Annual
          Symposium on Foundations of Computer Science</em>. pp.
          124&ndash;134. IEEE Computer Society (1994).
        </li>
        <li>
          <span class="text-gray-500">[SD94]</span>
          Simon, D.R.: On the power of quantum computation. In:
          <em>35th Annual Symposium on Foundations of Computer
          Science</em>. pp. 116&ndash;123 (1994).
        </li>
        <li>
          <span class="text-gray-500">[WRH+87]</span>
          Winternitz, R.S., Hellman, M.E.: Chosen-key attacks on
          a block cipher. <em>Cryptologia</em> 11(1), 16&ndash;20
          (1987). doi:
          <a
            href="https://doi.org/10.1080/0161-118791861749"
            target="_blank"
            rel="noopener noreferrer"
            class="text-blue-400 hover:text-blue-300"
          >10.1080/0161-118791861749</a>.
        </li>
      </ul>
    </section>

  </article>
</BaseLayout>
