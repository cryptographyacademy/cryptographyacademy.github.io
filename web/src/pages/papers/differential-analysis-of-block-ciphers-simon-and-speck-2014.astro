---
import BaseLayout from '../../layouts/BaseLayout.astro';
import PaperDisclaimer from '../../components/PaperDisclaimer.astro';
import PaperHistory from '../../components/PaperHistory.astro';

const EPRINT_URL = 'https://eprint.iacr.org/2014/922';
const CRAWLER = 'marker';
const CONVERTED_DATE = '2026-02-18';
const TITLE_HTML = 'Differential Analysis of Block Ciphers SIMON and SPECK';
const AUTHORS_HTML = 'Alex Biryukov, Arnab Roy, and Vesselin Velichkov';

const CONTENT = `    <p class="text-gray-300">Alex Biryukov, Arnab Roy, and Vesselin Velichkov</p>

    <p class="text-gray-300">Laboratory of Algorithmics, Cryptology and Security (LACS) University of Luxembourg {Alex.Biryukov,Arnab.Roy,Vesselin.Velichkov}@uni.lu</p>

    <p class="text-gray-300">Abstract. In this paper we continue the previous line of research on the analysis of the differential properties of the lightweight block ciphers Simon and Speck. We apply a recently proposed technique for automatic search for differential trails in ARX ciphers and improve the trails in Simon32 and Simon48 previously reported as best. We further extend the search technique for the case of differentials and improve the best previously reported differentials on Simon32, Simon48 and Simon64 by exploiting more effectively the strong differential effect of the cipher. We also present improved trails and differentials on Speck32, Speck48 and Speck64. Using these new results we improve the currently best known attacks on several versions of Simon and Speck. A second major contribution of the paper is a graph based algorithm (linear time) for the computation of the exact differential probability of the main building block of Simon: an AND operation preceded by two bitwise shift operations. This gives us a better insight into the differential property of the Simon round function and differential effect in the cipher. Our algorithm is general and works for any rotation constants. The presented techniques are generic and are therefore applicable to a broader class of ARX designs.</p>

    <p class="text-gray-300">Keywords: symmetric-key, differential trail, tools for cryptanalysis, automatic search, ARX, Simon, Speck, lightweight ciphers</p>

    <p class="text-gray-300">The past decade in technology has been marked by the ever decreasing size of computing devices. This, in combination with their increasingly ubiquitous use e.g. as smart devices, wearable systems, as part of the Internet of Things <a href="#page-19-0">[13]</a>, has enabled humans to perform everyday activities more efficiently. At the same time these new technologies have also created new security challenges.</p>

    <p class="text-gray-300">An important problem today is the design of cryptographic algorithms that are both efficient and secure, have small memory footprint and are low-cost and easy to implement and deploy on multiple platforms. Finding an optimal compromise between these, often conflicting, requirements is the difficult area researched by the field of lightweight cryptography. The applications of lightweight cryptographic algorithms vary from mobile devices, through RFID tags to electronic locks and their importance is likely to continue increasing in the future.</p>

    <p class="text-gray-300">To address the persistent need for secure and efficient lightweight primitives, numerous proposals have been made in the past few years. In the area of symmetric-key encryption some of the more prominent block ciphers that were proposed are: Present <a href="#page-19-1">[7]</a>, Piccolo <a href="#page-19-2">[18]</a>, Klein <a href="#page-19-3">[10]</a>, Twine <a href="#page-19-4">[20]</a>, Katan and Ktantan <a href="#page-19-5">[8]</a>, LED <a href="#page-19-6">[11]</a>, HIGHT <a href="#page-19-7">[12]</a> and CLEFIA <a href="#page-19-8">[19]</a>.</p>

    <p class="text-gray-300">Most recently, in June 2013, yet two more algorithms have been put forth by researchers from the National Security Agency (NSA) of the USA – the block ciphers Simon and Speck <a href="#page-19-9">[4]</a>. Compared to their predecessors, the latter two have very competitive performance, small memory footprint and beat most existing lightweight ciphers in terms of efficiency and compactness. Furthermore, the two designs are very simple and elegant. They are both built on the ARX philosophy <a href="#page-19-10">[21,</a><a href="#page-19-11">14]</a>, using only basic arithmetic operations such as modular addition, XOR, bitwise AND and bit rotation.</p>

    <p class="text-gray-300">Evidence of the performance and implementation advantages of Simon and Speck exists in the form of extensive results and comparisons to existing lightweight algorithms described in the design document <a href="#page-19-9">[4]</a>. However the latter does not provide any security evaluation of the two ciphers and no analysis of their cryptographic strength is given. Recently several external cryptanalytic results on Simon and Speck became available: <a href="#page-19-12">[3,</a><a href="#page-19-13">2</a><a href="#page-19-14">,1]</a>. The first two in particular analyze the differential properties of the ciphers and describe key-recovery attacks on reduced round variants.</p>

    <p class="text-gray-300">Our Contribution. In this paper we further investigate the differential behavior of block ciphers Simon and Speck. We apply a recently proposed technique for automatic search for differential trails in ARX ciphers called threshold search <a href="#page-19-15">[6]</a>. We find better differential trails on Simon32 and Simon48 than the ones reported by <a href="#page-19-13">[2]</a> and claimed to be the best and, we confirm the trail on Simon64. Improved trails that cover one round more than the previously reported best trails <a href="#page-19-14">[1]</a> on Speck32, Speck48 and Speck64 are found. We further extend the threshold search technique for finding differentials. With the new tool we improve the differentials on Simon32, Simon48 and Simon64 reported by <a href="#page-19-13">[2]</a> and we present new differentials on Speck32, Speck48 and Speck64. We use these new results to improve the currently best known attacks on several versions of Simon and Speck.</p>

    <p class="text-gray-300">The second major contribution of the paper is an efficient algorithm for the computation of the differential probabilities (DP) of the bitwise AND operation – the single source of non-linearity in the round function of Simon. We describe algorithms for the computation of the exact DP of AND with independent inputs and rotationally dependent inputs (one input is equal to the rotation of the other one) as used in Simon. In addition, methods for computing the maximum DP over all inputs and over all outputs of the AND operation are also proposed. All described algorithms have linear time complexity in the word size. These algorithms are used in the threshold search and in the differential search tool for Simon.</p>

    <p class="text-gray-300">Finally, we briefly comment on the strong differential effect in Simon – a property already noted in <a href="#page-19-12">[3]</a>. In addition we provide new insights into the clustering of differential trails that causes this effect. A summary of the main results from the search on trails and differentials is provided in Table <a href="#page-3-0">2.</a> Note that in this table is mentioned a figure for the time complexity of the attacks on Simon32 and Simon64 described in <a href="#page-19-13">[2]</a> that we were not able to verify. <a href="#page-1-0">a</a></p>

    <p class="text-gray-300">The outline of the paper is as follows. We begin with Sect. <a href="#page-2-0">2</a> where the XOR differential probability of the AND operation is analyzed. Next in Sect. <a href="#page-6-0">3</a> are presented techniques for searching for trails and differentials in ARX algorithms. The block ciphers Simon and Speck are briefly described in Sect. <a href="#page-9-0">4.</a> Full differential trails are presented in Sect. <a href="#page-9-1">5.</a> Finally, in Sect. <a href="#page-10-0">6</a> we comment on the strong differential effect of Simon. Sect. <a href="#page-17-0">9</a> concludes the paper.</p>

    <p class="text-gray-300">A few words on notation: with x&lt;sup&gt;i&lt;/sup&gt; is denoted the i-th bit of the n-bit word x (x&lt;sup&gt;0&lt;/sup&gt; is the LSB); x&lt;sup&gt;i&lt;/sup&gt; represents the modulo-2 complementation of x&lt;sup&gt;i&lt;/sup&gt; i.e. x&lt;sup&gt;i&lt;/sup&gt; = x&lt;sup&gt;i&lt;/sup&gt; ⊕ 1; the symbols ∧ and ∨ denote respectively bitwise logical AND and OR operations; the left and right rotation of the bits of x by r positions is denoted respectively with x ≪ r and x ≫ r; |S| represents the cardinality of the set S. The concatenation of the bit strings x and y is denoted by x|y.</p>

    <p class="text-gray-300">&lt;span id=&quot;page-1-0&quot;&gt;&lt;/span&gt;&lt;sup&gt;a&lt;/sup&gt; Since with one good pair in all the data the counting phase does not give the attacker unique partial key.</p>

    <div class="overflow-x-auto my-4">
      <table class="min-w-full text-sm text-gray-300">
        <thead>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">Table 1. Summary of attacks on Simon&lt;br&gt;and Speck. All listed attacks are chosen-plaintext.a,b,cDiffers from [2].</th>
        </thead>
        <tbody>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-------------------------------------------------------------------------------------------------------------------</td>
          </tr>
        </tbody>
      </table>
    </div>

    <div class="overflow-x-auto my-4">
      <table class="min-w-full text-sm text-gray-300">
        <thead>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">Cipher</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">Key&lt;br&gt;Size</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">#Rounds&lt;br&gt;Total</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">#Rounds&lt;br&gt;Attacked</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">Time&lt;br&gt;Sect. 7, 8</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">Data&lt;br&gt;Sect. 7, 8</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">Time&lt;br&gt;[2,1]</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">Data&lt;br&gt;[2,1]</th>
        </thead>
        <tbody>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Simon32</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">64</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">32</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">18</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">62 a&lt;br&gt;2</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">31.2&lt;br&gt;2</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">64</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">32</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">19</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">34&lt;br&gt;2</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">31.5&lt;br&gt;2</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">64</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">32</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">19</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">40&lt;br&gt;2</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">31&lt;br&gt;2</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Simon48</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">72</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">36</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">19</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">46&lt;br&gt;2</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">46&lt;br&gt;2</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">52&lt;br&gt;2</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">46&lt;br&gt;2</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">72</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">36</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">20</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">52&lt;br&gt;2</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">46&lt;br&gt;2</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">96</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">36</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">19</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">69&lt;br&gt;2</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">46&lt;br&gt;2</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">76&lt;br&gt;2</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">46&lt;br&gt;2</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">96</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">36</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">20</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">75&lt;br&gt;2</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">46&lt;br&gt;2</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Simon64</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">96</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">42</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">26</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">89&lt;br&gt;2</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">63&lt;br&gt;2</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">94 b&lt;br&gt;2</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">63&lt;br&gt;2</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">128</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">44</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">26</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">121&lt;br&gt;2</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">63&lt;br&gt;2</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">126 c&lt;br&gt;2</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">63&lt;br&gt;2</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Speck32</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">64</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">22</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">10</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">29.2&lt;br&gt;2</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">29&lt;br&gt;2</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">64</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">22</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">11</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">55&lt;br&gt;2</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">31&lt;br&gt;2</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Speck48</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">72/96</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">22</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">12</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">43&lt;br&gt;2</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">43&lt;br&gt;2</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">45.3&lt;br&gt;2</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">45&lt;br&gt;2</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Speck64</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">96/128</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">26</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">15</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">61.1&lt;br&gt;2</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">61&lt;br&gt;2</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">96</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">26</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">16</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">80&lt;br&gt;2</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">63&lt;br&gt;2</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">96</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">26</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">16</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">73&lt;br&gt;2</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">64&lt;br&gt;2</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">128</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">27</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">16</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">80&lt;br&gt;2</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">63&lt;br&gt;2</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">128</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">27</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">16</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">73&lt;br&gt;2</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">64&lt;br&gt;2</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
        </tbody>
      </table>
    </div>

    <p class="text-gray-300">&lt;span id=&quot;page-2-2&quot;&gt;&lt;/span&gt;Definition 1 (xdp&amp; with independent inputs). Let α, β and γ be fixed n-bit XOR differences. The XOR differential probability (DP) of the logical AND operation (xdp&amp;) is the probability with which α and β propagate to γ through the AND operation, computed over all pairs of n-bit inputs (x, y):</p>

    <p class="text-gray-300"><span class="math">$\\operatorname{xdp}^{\\&amp;}(\\alpha,\\beta\\to\\gamma) = 2^{-2n} \\cdot |\\{(x,y) : ((x\\oplus\\alpha) \\land (y\\oplus\\beta)) \\oplus (x\\land y) = \\gamma\\}| . \\tag{1}</span>$</p>

    <p class="text-gray-300">In the remaining of the text the acronym DP will be used to denote XOR differential probability unless specified otherwise. When the input differences α and β are independent, the DP xdp&lt;sup&gt;∧&lt;/sup&gt; (α, β → γ) can be efficiently computed according to the following theorem.</p>

    <p class="text-gray-300">&lt;span id=&quot;page-2-3&quot;&gt;&lt;/span&gt;Theorem 1. For fixed n-bit XOR differences α, β and γ the probability xdp&amp;(α, β → γ) is equal to</p>

    <p class="text-gray-300">&lt;span id=&quot;page-2-1&quot;&gt;&lt;/span&gt;
<span class="math">$\\operatorname{xdp}^{\\&amp;}(\\alpha,\\beta\\to\\gamma) = 2^{-n} \\cdot \\prod_{i=0}^{n-1} \\left( \\left( 2 \\cdot (\\overline{\\alpha}_i \\wedge \\overline{\\beta}_i \\wedge \\overline{\\gamma}_i) \\right) \\vee (\\overline{\\overline{\\alpha}_i \\wedge \\overline{\\beta}_i}) \\right) \\wedge \\overline{\\left(\\overline{\\alpha}_i \\wedge \\overline{\\beta}_i \\wedge \\gamma_i\\right)} \\ . \\tag{2}</span>$</p>

    <p class="text-gray-300">Proof. Note that xdp&amp;(α, β → γ) = 0 ⇐⇒ ∃i : 0 ≤ i &lt; n : (α&lt;sup&gt;i&lt;/sup&gt; ∧β&lt;sup&gt;i&lt;/sup&gt; ∧γi) = 1. Therefore whenever the probability is zero, the term (α&lt;sup&gt;i&lt;/sup&gt; ∧ β&lt;sup&gt;i&lt;/sup&gt; ∧ γi) evaluates to zero and hence the right hand-side of <a href="#page-2-1">(2)</a> is also zero. If the probability is non-zero and α&lt;sup&gt;i&lt;/sup&gt; = β&lt;sup&gt;i&lt;/sup&gt; = γ&lt;sup&gt;i&lt;/sup&gt; = 0 at bit position i then (αi∧βi∧γ&lt;sup&gt;i&lt;/sup&gt; ) = 1 which is multiplied by the number of valid pairs (x&lt;sup&gt;i&lt;/sup&gt; , yi) (cf. Definition <a href="#page-2-2">1)</a> i.e. 4 . If α&lt;sup&gt;i&lt;/sup&gt; 6= β&lt;sup&gt;i&lt;/sup&gt; then exactly two pairs (x&lt;sup&gt;i&lt;/sup&gt; , yi) satisfy the differential at bit position i irrespective of the value of γ&lt;sup&gt;i&lt;/sup&gt; . In this case (α&lt;sup&gt;i&lt;/sup&gt; ∧ β&lt;sup&gt;i&lt;/sup&gt; ) = 1 and it is multiplied by the number of valid pairs (x&lt;sup&gt;i&lt;/sup&gt; , yi) which is 2. Therefore</p>

    <p class="text-gray-300">&lt;span id=&quot;page-3-0&quot;&gt;&lt;/span&gt;Table 2. Summary of the best found differential trails and differentials in SIMON and SPECK; &lt;sup&gt;a&lt;/sup&gt;Measured as the average prob. over 128 keys chosen at random and using the full codebook.</p>

    <div class="overflow-x-auto my-4">
      <table class="min-w-full text-sm text-gray-300">
        <thead>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">Cipher</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"><span class="math">\\mid \\# \\text{ rounds} \\mid</span></th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"><span class="math">\\left \\log_2 p,  \\mathrm{trail} \\right </span></th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"><span class="math">\\log_2 p</span> , diff.</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"># trails</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">ref.</th>
        </thead>
        <tbody>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Simon32</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">12</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">\\begin{vmatrix} -34 \\\\ -36 \\end{vmatrix}</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Sect. 5 [2]</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">13</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-36&lt;br&gt;-36</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">45083&lt;br&gt;experimental &lt;sup&gt;a&lt;/sup&gt;</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Sect. 5&lt;br&gt;Sect. 5&lt;br&gt;[2]</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Simon48</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">15</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">\\begin{vmatrix} -48 \\\\ -52 \\end{vmatrix}</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-42.11 <span class="math">-43.01</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">112573</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Sect. 5 [2]</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Simon64</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">20</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">\\begin{vmatrix} -70 \\\\ -70 \\end{vmatrix}</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-58.07 <span class="math">-59.01</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">533163</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Sect. 5 [2]</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">21</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">\\begin{vmatrix} -72 \\\\ -72 \\end{vmatrix}</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">450536</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Sect. 5 [2]</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Speck32</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">8</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">\\begin{vmatrix} -24 \\\\ -24 \\end{vmatrix}</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">$ \\begin{array}{c c} -24 \\ -24 \\end{array} $</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1&lt;br&gt;1</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Sect. 5&lt;br&gt;[1]</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">9</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-31</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-31</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Sect. 5</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Speck48</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">10</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-40</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">$ \\begin{array}{r r} -39.75 \\ -40.55 \\end{array} $</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">137</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Sect. 5&lt;br&gt;[1]</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">11</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-47</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-46.48</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">384</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Sect. 5</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">SPECK64</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">13</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-58</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-57.67 <span class="math">-58.90</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">198</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Sect. 5&lt;br&gt;[1]</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">14</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-60</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-59.02</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">934</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Sect. 5</td>
          </tr>
        </tbody>
      </table>
    </div>

    <p class="text-gray-300">for non-zero probability, the product on the right-hand size of (2) is a multiple of  <span class="math">2^n</span> . The latter cancels with the term  <span class="math">2^{-2n}</span>  (cf. Definition 1) and so the final expression is multiplied by  <span class="math">2^{-n}</span> .</p>

    <p class="text-gray-300">Theorem 1 implies the following corollary.</p>

    <p class="text-gray-300">Corollary 1. Given n-bit input differences  <span class="math">\\alpha, \\beta</span>  and output difference  <span class="math">\\gamma</span> , the probability  <span class="math">xdp^{\\&amp;}(\\alpha, \\beta \\rightarrow \\gamma)</span>  can be computed in  <span class="math">\\mathcal{O}(n)</span>  time.</p>

    <p class="text-gray-300">&lt;span id=&quot;page-3-2&quot;&gt;&lt;/span&gt;</p>

    <p class="text-gray-300"><em>Proof.</em> Follows directly from Theorem 1.</p>

    <h3 id="sec-1" class="text-xl font-semibold mt-8">&lt;span id=&quot;page-3-3&quot;&gt;&lt;/span&gt;2.2 Rotationally Dependent Inputs</h3>

    <p class="text-gray-300">Note that when the inputs to the AND operation are dependent on each other, the DP computed with Theorem 1 is not accurate. In particular, let the two inputs x, y to AND be such that  <span class="math">y = (x \\ll r)</span> . So, an input XOR difference  <span class="math">\\alpha</span>  applied to x will result into an input difference  <span class="math">(\\alpha \\ll r)</span>  to y. Considering the dependencies between the input variables, the DP in this case is defined as follows:</p>

    <p class="text-gray-300"><strong>Definition 2</strong> (xdp&lt;sup&gt;&amp;&lt;/sup&gt; with dependent inputs). For a fixed rotation constant r and n-bit input difference  <span class="math">\\alpha</span> , the DP of the bitwise AND operation is defined as</p>

    <p class="text-gray-300">&lt;span id=&quot;page-3-1&quot;&gt;&lt;/span&gt;
<span class="math">$\\operatorname{xdp}^{\\&amp;}(\\alpha, (\\alpha \\ll r) \\to \\gamma) = 2^{-n} \\cdot \\left| \\left\\{ x : \\left( x \\land (x \\ll r) \\right) \\oplus \\left( (x \\oplus \\alpha) \\land ((x \\oplus \\alpha) \\ll r) \\right) = \\gamma \\right\\} \\right| . \\tag{3}</span>$</p>

    <p class="text-gray-300">In the following part of this section we describe a method for the computation of the probability xdp&amp;(α,(α ≪ r) → γ) <a href="#page-3-1">(3)</a> in linear time in the word size n. We begin by stating several necessary definitions and lemmas.</p>

    <p class="text-gray-300">A cycle of length t is a special subset of the set of indices I = {0, 1, . . . , n − 1}(= Zn) indicating the bit positions of an n-bit word x (index 0 denotes the LS bit of x). More formally:</p>

    <p class="text-gray-300">Definition 3. A cycle of length t is a set of bit indices C&lt;sup&gt;i&lt;/sup&gt; = {i, i + r, i + 2r, . . . , i + (t − 1)r} ⊆ I, where t ∈ N is such that i + tr = i mod (n) and i is the smallest element of Ci.</p>

    <p class="text-gray-300">In a cycle C&lt;sup&gt;i&lt;/sup&gt; of length t, i + (s − 1)r is said to be preceding element to i + sr (1 &lt; s &lt; t). Moreover, i + (t − 1)r is preceding element to i. Since each C&lt;sup&gt;i&lt;/sup&gt; for i ∈ I is an equivalence class, I can be partitioned into disjoint cycles:</p>

    <p class="text-gray-300">&lt;span id=&quot;page-4-1&quot;&gt;&lt;/span&gt;Lemma 1. For fixed r ∈ I, C&lt;sup&gt;i&lt;/sup&gt; ∩ C&lt;sup&gt;j&lt;/sup&gt; = ∅ iff i 6= j : 0 ≤ i, j &lt; n and, I = S Ci.</p>

    <p class="text-gray-300">Example 1. For n = 8 and r = 2 there are exactly 2 cycles each having length t = 4: C&lt;sup&gt;0&lt;/sup&gt; = {0, 2, 4, 6} and C&lt;sup&gt;1&lt;/sup&gt; = {1, 3, 5, 7}.</p>

    <p class="text-gray-300">By Definition <a href="#page-3-2">2,</a> computing the probability xdp&amp; is equivalent to counting the number of values x that satisfy the differential (α,(α ≪ r) → γ). For simplicity, let r be such that the set of bit indices I of x has a single cycle C&lt;sup&gt;0&lt;/sup&gt; = {0, r, 2r, . . . , n − r}. Within this cycle the bits of the input and output differences are represented as a sequence of 3-tuples in the following way:</p>

    <p class="text-gray-300">&lt;span id=&quot;page-4-2&quot;&gt;&lt;/span&gt;&lt;span id=&quot;page-4-0&quot;&gt;&lt;/span&gt;
<span class="math">$(\\alpha_0, \\alpha_{(n-r)}, \\gamma_0), (\\alpha_r, \\alpha_0, \\gamma_r), (\\alpha_{2r}, \\alpha_r, \\gamma_{2r}), \\dots, (\\alpha_{(n-r)}, \\alpha_{(t-1)r}, \\gamma_{(n-r)}) . \\tag{4}</span>$</p>

    <p class="text-gray-300">Note that in sequence<a href="#page-4-0">(4)</a>, for each 3-tuple the index of the second element is a preceding index of the index of the first element.</p>

    <p class="text-gray-300">Example 2. Let n = 5 and r = 2. Consider the input differences α = α4α3α2α1α&lt;sup&gt;0&lt;/sup&gt; and (α ≪ 2) = α2α1α0α4α&lt;sup&gt;3&lt;/sup&gt; and the output difference γ = γ4γ3γ2γ1γ0. In this case there is a single cycle C&lt;sup&gt;0&lt;/sup&gt; of length t = 5: C&lt;sup&gt;0&lt;/sup&gt; = {0, 1, 2, 3, 4}. The corresponding sequence of 3-tuples is:</p>

    <p class="text-gray-300">&lt;span id=&quot;page-4-3&quot;&gt;&lt;/span&gt;
<span class="math">$(\\alpha_0, \\alpha_3, \\gamma_0), (\\alpha_2, \\alpha_0, \\gamma_2), (\\alpha_4, \\alpha_2, \\gamma_4), (\\alpha_1, \\alpha_4, \\gamma_1), (\\alpha_3, \\alpha_1, \\gamma_3)</span>$
(5)</p>

    <p class="text-gray-300">The difference 3-tuples in <a href="#page-4-0">(4)</a> are satisfied by a number of possible bit assignments of x at the corresponding positions: (x0, xn−r), (xr, x0), (x2r, xr), . . . ,(xn−r, x(t−1)&lt;sup&gt;r&lt;/sup&gt; ). In order to efficiently count the number of such assignments we use a variant of the technique proposed in <a href="#page-19-16">[16]</a> for the computation of the DP of modular addition and XOR.</p>

    <p class="text-gray-300">Any 2-tuple of bits of the form (xsr, x(s−1)&lt;sup&gt;r&lt;/sup&gt; ) can have 4 values {(0, 0),(0, 1),(1, 0),(1, 1)}, where (0 ≤ s ≤ n − 1). These are viewed as a nodes of a graph. In total, for the full word length n the graph has 4n nodes. A valid assignment of two consecutive 2-tuples (xsr, x(s−1)&lt;sup&gt;r&lt;/sup&gt; ) and (x(s+1)&lt;sup&gt;r&lt;/sup&gt; , xsr), (0 ≤ s &lt; n − 1) is represented as a directed edge between the corresponding nodes. In this way we can construct a directed acyclic graph (DAG) composed of (n−1) edge-disjoint bipartite subgraphs. Each bipartite subgraph is formed by the nodes from two consecutive 2-tuples of bits of x and the edges between them. A valid path from an initial node (x0, xn−r) to a final node (xn−r, xn−2r) in the DAG corresponds to a value of x that satisfies the differential (α,(α ≪ r) → γ). A path is said to be valid iff the initial and final nodes (x0, xn−r) and (xn−r, xn−2r) are consistent i.e. the value assigned to xn−&lt;sup&gt;r&lt;/sup&gt; in both nodes is the same.</p>

    <p class="text-gray-300">The DAG constructed as explained above is represented as a sequence of  <span class="math">4\\times 4</span>  adjacency matrices, each corresponding to one bipartite subgraph. Computing the probability  <span class="math">\\mathrm{xdp}^{\\wedge}</span>  is then equivalent to counting the number of valid paths in the DAG. This can be performed in linear time in the word size by a sequence of (n-1) multiplications of adjacency matrices. If the number of such paths is N, the final probability  <span class="math">\\mathrm{xdp}^{\\&amp;}(\\alpha,\\beta\\to\\gamma)</span>  is  <span class="math">\\frac{N}{2^n}</span> . This process is further illustrated with the Example 3.</p>

    <p class="text-gray-300">In case of more than one cycle the described process can be performed independently for each cycle  <span class="math">C^j, 0 \\leq j &lt; m</span>  due to the fact that all cycles are disjoint (cf. Lemma 1). Let  <span class="math">N_j</span>  be the number of paths in the DAG for the j-th cycle. Then the DP is given by  <span class="math">\\frac{\\prod_{1}^{m} N_j}{2^n}</span> .</p>

    <p class="text-gray-300">&lt;span id=&quot;page-5-0&quot;&gt;&lt;/span&gt;Example 3. Assume the same setting as in Example 2: n=5, r=2 and let  <span class="math">\\alpha=00110_2</span>  and  <span class="math">\\gamma=00000_2</span> . Consider the resulting sequence of 3-tuples (5). In the DAG (Fig 1), the dependency between the bits of x corresponding to two consecutive 3-tuples must be satisfied. For example, an edge between  <span class="math">(x_0, x_3) = (0, 1)</span>  corresponding to  <span class="math">(\\alpha_0, \\alpha_3, \\gamma_0) = (1, 0, 0)</span>  and  <span class="math">(x_2, x_0) = (1, 0, 0)</span>  corresponding to  <span class="math">(\\alpha_2, \\alpha_0, \\gamma_2) = (0, 1, 0)</span>  is drawn, because  <span class="math">x_0 = 0</span>  for both the nodes. However there is no edge between  <span class="math">(x_2, x_0) = (0, 0)</span>  and  <span class="math">(x_4, x_2) = (0, 1)</span>  since,  <span class="math">x_0</span>  is is not equal for both the nodes. A valid path from an initial node (corresponding to the first 3-tuple  <span class="math">(\\alpha_0, \\alpha_3, \\gamma_0)</span>  in the sequence (5))</p>

    <p class="text-gray-300">&lt;span id=&quot;page-5-1&quot;&gt;&lt;/span&gt;    <img src="_page_5_Figure_3.jpeg" alt="" class="my-4 max-w-full" />
</p>

    <p class="text-gray-300"><strong>Fig. 1.</strong> DAG used in the computation of  <span class="math">\\operatorname{xdp}^{\\&amp;}(\\alpha, (\\alpha \\ll r) \\to \\gamma)</span>  for  <span class="math">n = 5, r = 2, \\alpha = 00110_2, \\gamma = 00000_2</span> . Every path composed of thick edges is a valid path and hence a valid assignment of bits of x. The fading nodes denote the bit assignments of x which do not satisfy the input output difference</p>

    <p class="text-gray-300">to a final node (corresponding to the last 3-tuple  <span class="math">(\\alpha_3, \\alpha_1, \\gamma_3)</span> ) in this graph is equivalent to a value of x that satisfies the differential. A valid path implies that the initial and final nodes are consistent with each other. For example, no path from the initial node  <span class="math">(x_0, x_3) = (0, 1)</span>  is valid, because, all final node have  <span class="math">x_3 = 0</span> . Since the total number of valid paths in the graph is N = 4 the DP is  <span class="math">\\frac{4}{2^5} = 0.125</span> .</p>

    <p class="text-gray-300">The method for the computation of the probability  <span class="math">xdp^{\\&amp;}(\\alpha, \\beta \\to \\gamma)</span>  described above supports the following proposition.</p>

    <p class="text-gray-300"><strong>Proposition 1.</strong> For fixed n-bit differences  <span class="math">\\alpha</span>  and  <span class="math">\\gamma</span> , the probability  <span class="math">xdp^{\\&amp;}(\\alpha, (\\alpha \\ll r) \\rightarrow \\gamma)</span>  can be computed in  <span class="math">\\mathcal{O}(n)</span>  time.</p>

    <p class="text-gray-300">Impossible Input-Output Difference For a given (α, γ) an impossible difference can be of two types. Any input/output difference which leads to a difference 3-tuple (α&lt;sup&gt;i&lt;/sup&gt; , αi−r, γi) = (0, 0, 1), is an impossible input/output difference. The other types of input difference can be detected while computing the probability of the corresponding difference. Note that in the corresponding DAG, a path can be invalid even if every bipartite directed subgraph valid, e.g. (α, γ) = (111112, 000002). The following DAG shows this case.</p>

    <p class="text-gray-300">    <img src="_page_6_Figure_1.jpeg" alt="" class="my-4 max-w-full" />
</p>

    <p class="text-gray-300">Fig. 2. DAG used in the computation of xdp&amp;(111112,(11111&lt;sup&gt;2&lt;/sup&gt; ≪ 2) → 000002). Both the paths, composed of thick edges and dashed edges, are invalid path, since there is contradiction in the bit value x3. However, each directed bipartite subgraph is independently valid.</p>

    <p class="text-gray-300">Proposition 2. For a fixed n-bit input difference α and rotation r,</p>

    <p class="text-gray-300">&lt;span id=&quot;page-6-1&quot;&gt;&lt;/span&gt;
<span class="math">$DP_{\\max}(\\alpha) = \\max_{\\gamma} xdp^{\\&amp;}(\\alpha, \\alpha \\ll r \\to \\gamma)</span>$
(6)</p>

    <p class="text-gray-300">can be computed in O(n) time.</p>

    <p class="text-gray-300">Finally, we note that the approach described above bears some similarity to the technique proposed in <a href="#page-19-16">[16]</a> for the computation of the DP of modular addition and XOR. Similarly to <a href="#page-19-16">[16]</a> we also map the problem of computing differential probabilities to the well-studied problem in graph theory of counting the number of paths in a graph. Apart from this similarity however, we would like to stress that the described method is fundamentally different than <a href="#page-19-16">[16]</a>. In the latter the nodes of the graph represent information that is propagated over the bit positions (namely, the carries and borrows resulting from the modular addition) and the edges represent the actual values of the pairs. In our case, the nodes of the graph represent the values of the pairs, while the edges describe the valid connections between the bits of those values so that the correct dependence due to the rotation operation is preserved.</p>

    <p class="text-gray-300">In <a href="#page-19-17">[15]</a> Matsui proposed a practical algorithm for finding the best differential trail for the DES block cipher. Given the best trail on i rounds and an over-estimation of the best probability for i+ 1 rounds the algorithm finds the best trail on i+1 rounds. Starting from i = 1 these steps are repeated recursively until i+ 1 = n. In the process, the differential probabilities of the non-linear components of the target cipher (the S-boxes in the case of DES) are obtained from a pre-computed difference distribution table (DDT). The differentials for the i-th round are then processed in sorted order by probability. For each, the recursion proceeds to round i + 1) only if the estimated probability of the trail for n rounds is equal to- or greater than the initial estimate.</p>

    <p class="text-gray-300">Recently, in <a href="#page-19-15">[6]</a> a variant of Matsui's algorithm is proposed which is applicable to the class of ARX ciphers. What is special about the latter is that they do not have S-boxes. Instead they rely on basic arithmetic operations such as addition modulo n to achieve non-linearity. Computing a full DDT for the modular addition operation would require 4 × 2 &lt;sup&gt;3&lt;/sup&gt;&lt;sup&gt;n&lt;/sup&gt; bytes of memory and is therefore impractical for n &gt; 16. To address this, in <a href="#page-19-15">[6]</a> a partial DDT (pDDT) rather than the full DDT is computed. A pDDT contains (a fraction of) all differentials that have probability above a fixed probability threshold (hence the name – threshold search).</p>

    <p class="text-gray-300">Since some (possibly many) differentials are missing from the initial (also called primary) pDDT, at some point during the search it is likely that for a given input difference the algorithm will require a matching differential that is not present in the primary pDDT. Such differentials are computed on-demand and are stored in a secondary pDDT maintained dynamically during the search.</p>

    <p class="text-gray-300">In order to prevent the size of the secondary pDDT from exploding while at the same time keeping the probability of the constructed trails high, <a href="#page-19-15">[6]</a> further introduce the notion of highways and country roads – resp. high and low probability differentials (w.r.t. the fixed threshold). Every differential from the primary pDDT is a highway while every differential from the secondary pDDT is a country road.</p>

    <p class="text-gray-300">To further control the size of the country roads table, additional restrictions on the considered differences can be added. For example, it may be required that every country road at given round i is such that there is at least one transition at round i+ 1 that is a highway. This reduces the number of possible country roads while at the same time ensures that the considered paths have relatively high probability. This condition has been applied in the trail search for Simon. Another restriction can be on the Hamming weight of the considered differences. Such restriction has been applied in the differential search on Speck.</p>

    <p class="text-gray-300">Several parameters control the performance of the threshold search technique. The most important ones are the probability threshold, which determines which differentials are considered as highways and the maximum size of the primary pDDT (note that it may be infeasible to compute and/or store all differentials that have probability above the threshold). The probability threshold influences the probability of the final trail: the lower the threshold, the more paths are considered and hence the more likely to find a high probability trail. At the same time, with the increase of the number of explored paths, the complexity of the algorithm also grows and hence it takes longer to terminate. The maximum size of the primary pDDT determines the precomputation time and the memory requirements for the algorithm.</p>

    <p class="text-gray-300">We further extend the method outlined above to the case of differentials. Given the best trail found by the threshold search and the corresponding array of best found probabilities for each round, a differential search proceeds according to the above strategy but always starting from the same input difference (corresponding to the best found trail). At every round are explored only paths whose estimated probabilities are by at most a factor ε away from best probability (e.g. ε = 2−15). For example, let B&lt;sup&gt;i&lt;/sup&gt; : 1 ≤ i ≤ n be the probabilities of the best found differentials resp. for 1, 2, . . . , n rounds computed with the threshold search. Denote with p1, p2, . . . , pr−&lt;sup&gt;1&lt;/sup&gt; the probabilities of a partially constructed trail up to round r − 1. At round r the differential search will explore all transitions that have probability p&lt;sup&gt;r&lt;/sup&gt; ≥ (εBn)/(p&lt;sup&gt;1&lt;/sup&gt; . . . pr−1Bn−r). A pseudocode of this procedure applied to Simon is listed in Algorithm <a href="#page-8-0">1.</a></p>

    <p class="text-gray-300">&lt;span id=&quot;page-8-0&quot;&gt;&lt;/span&gt;Input: T = (T0, . . . , Tn): the best found trail for n rounds with prob. Bn; B = (B1, B2, . . . , Bn): probs. of best found trails for up to n rounds; r: current round; H: pDDT (the highway table) for the non-linear component f of the round function (e.g. for SIMON f(x) = (x ≪ 1) ∧ (x ≪ 8); for SPECK f is the modular addition); ε: the algorithm searches for trails with probs. at most ε times worse than the best found prob.</p>

    <p class="text-gray-300">Output: Cluster of trails Ω for the differential (T&lt;sup&gt;0&lt;/sup&gt; = (α0, β0) → T&lt;sup&gt;n&lt;/sup&gt; = (αn, βn)) and probabilitty pΩ(T&lt;sup&gt;0&lt;/sup&gt; → Tn) ≥ Bn.</p>

    <pre><code class="language-text">1: (α0, β0) ← T0; (αn, βn) ← Tn; Ω ← T; T ← ∅; pΩ ← Bn; r ← 1// Initialization
2: procedure cluster_trails(n, r, αr−1, βr−1, H, T, Ω, pΩ) do
3: if r = n then
4: // If at last round and trail matches output diff. add it to cluster and update the probability
5: if Tn = (αn, βn) then
6: add T to Ω; pΩ ← pΩ + Bn; T ← ∅
7: return
8: if r = 0 then
9: p0 = 1; T ← T0 = (α0, β0, p0).
10: C ← ∅ // Initialize the country roads table
11: pr,min ← (εBn)/(p1p2 · · · pr−1Bn−r) // The min. permissible probability for the new trail
12: for all γr : (pr(αr−1
                         f
                         −→ γr) ≥ pr,min) ∧ ((αr−1, γr, pr) ∈/ H) do
13: add (αr−1, γr, pr) to C // Update country roads table
14: for all (α, γ, p) : α = αr−1 in H and all (α, γ, p) in C do
15: pr ← p, Bn ← p1p2 . . . prBn−r
16: // Proceed to next round only if the estimated prob. is at most ε times worse than the best
17: if Bn ≥ (εBn) then
18: αr = γr ⊕ βr−1 ⊕ (αr−1 ≪ 2); βr ← αr−1
19: add Tr = (αr, βr, pr) to T
20: call cluster_trails(n, r + 1, αr, βr, H, T, Ω, pΩ)
21: return Ω, pΩ
</code></pre>

    <p class="text-gray-300">Note that a somewhat similar branch-and-bound approach has been applied by <a href="#page-19-12">[3,</a><a href="#page-19-13">2,</a><a href="#page-19-14">1]</a> to search for differentials in Simon. The main difference is that according to the cited technique, at every round is maintained an array of the best differentials encountered so far ranked by probability. The search proceeds to the next round by considering the top N such differentials.</p>

    <p class="text-gray-300">In our approach instead of storing intermediate differentials, we prune the search tree by limiting the search to an ε region within the best found probability, since the latter is already known from the threshold search.</p>

    <p class="text-gray-300">Note that although the proposed technique searches for differentials starting with best trail found with the threshold search, it can easily be modified to search for multiple input and output differences, while keeping track of the best one. Finally, in order to improve the efficiency, the differential search can be further parametrized by limiting the maximum Hamming weight of the differences.</p>

    <p class="text-gray-300">The Simon and Speck families of lightweight block ciphers are defined for word sizes n = 16, 24, 32, 48 and 64 bits. The key is composed of m n-bit words for m = 2, 3, 4 (i.e. the key size mn varies between 64 and 256 bits) depending on the word size n. The block cipher instances corresponding to a fixed word size n (block size 2n) and key size mn are denoted by Simon2n/mn and Speck2n/mn.</p>

    <p class="text-gray-300">    <img src="_page_9_Picture_2.jpeg" alt="" class="my-4 max-w-full" />
</p>

    <p class="text-gray-300">Fig. 3. SIMON round function</p>

    <p class="text-gray-300">&lt;span id=&quot;page-9-3&quot;&gt;&lt;/span&gt;&lt;span id=&quot;page-9-2&quot;&gt;&lt;/span&gt;Fig. 4. SPECK round function</p>

    <p class="text-gray-300">Block cipher Simon has Feistel structure and its round function under a fixed round key k is defined on inputs x and y as:</p>

    <p class="text-gray-300"><span class="math">$R_k(x,y) = ((y \\oplus f(x) \\oplus k), x) . (7)</span>$</p>

    <p class="text-gray-300">The function f(·) is defined as f(x) = ((x ≪ 1)∧(x ≪ 8))⊕(x ≪ 2), where the symbol ∧ denotes the logical AND operation.</p>

    <p class="text-gray-300">Block cipher Speck has structure similar to Threefish – the block cipher used in the hash function Skein <a href="#page-19-18">[9]</a>. Its round function under a fixed round key k is defined on inputs x and y as:</p>

    <p class="text-gray-300"><span class="math">$R_k(x,y) = (f_k(x,y), f_k(x,y) \\oplus (y \\ll \\beta)) , \\qquad (8)</span>$</p>

    <p class="text-gray-300">where the function fk(·, ·) is defined as fk(x, y) = ((x ≫ α) + y) ⊕ k. The rotation constants are α = 7, β = 2 for block size 32 bits and α = 8, β = 3 for all other block sizes. Although Speck is not a Feistel cipher itself, it can be represented as a composition of two Feistel maps as described in <a href="#page-19-9">[4]</a>. The round functions of Simon and Speck are shown in Fig. <a href="#page-9-2">3</a> and Fig. <a href="#page-9-3">4</a> respectively. The number of rounds, block size and key size of the block ciphers are summarized in the following table</p>

    <p class="text-gray-300">The trails obtained by using the threshold search technique and the differentials found with differential search tool (both described in Sect. <a href="#page-6-0">3)</a> are presented in this section. The best found trails for Simon and Speck are shown respectively on Table <a href="#page-11-0">5</a> and Table <a href="#page-12-1">6.</a> In the tables, P r log2p&lt;sup&gt;r&lt;/sup&gt;</p>

    <div class="overflow-x-auto my-4">
      <table class="min-w-full text-sm text-gray-300">
        <thead>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">Block size</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">Key size</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">Key words</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">Rounds</th>
        </thead>
        <tbody>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">32</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">64</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">4</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">32</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">48</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">72</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">3</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">36</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">96</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">4</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">36</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">64</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">96</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">3</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">42</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">128</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">4</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">44</td>
          </tr>
        </tbody>
      </table>
    </div>

    <div class="overflow-x-auto my-4">
      <table class="min-w-full text-sm text-gray-300">
        <thead>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">Tabla</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">2</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">Parameters</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">for</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">CIMON</th>
        </thead>
        <tbody>
        </tbody>
      </table>
    </div>

    <div class="overflow-x-auto my-4">
      <table class="min-w-full text-sm text-gray-300">
        <thead>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">Block size</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">Key size</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">Key words</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">Rounds</th>
        </thead>
        <tbody>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">32</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">64</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">4</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">22</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">48</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">72</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">3</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">22</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">96</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">4</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">23</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">64</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">96</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">3</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">26</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">128</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">4</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">27</td>
          </tr>
        </tbody>
      </table>
    </div>

    <p class="text-gray-300">Table 4. Parameters for Speck</p>

    <p class="text-gray-300">represents the probability of a single trail obtained as the sum of the probabilities of its transitions;  <span class="math">p_{\\text{diff}}</span>  is the probability of the corresponding differential and #trails is the number of trails clustered in the differential; max HW is the maximum Hamming weight allowed for the differences during the search;  <span class="math">p_{\\text{thres}}</span>  is the probability threshold used in the threshold search algorithm and pDDT denotes the number of elements in the partial DDT.</p>

    <p class="text-gray-300">Note that all trails shown in Table 5 and Table 6 were found using the technique described in Sect. 3 by starting the search from the top round and proceeding downwards. The only exception is the trail on Speck48. Since this trail begins with a very low probability transition, when starting the search from the first round, it was computationally feasible to construct the shown trail only up to round 6. The full trail on 11 rounds shown in Table 6 was found by starting the search from a middle round (round 6) as has also been done in [1].</p>

    <h2 id="sec-2" class="text-2xl font-bold">&lt;span id=&quot;page-10-0&quot;&gt;&lt;/span&gt;6 Differential Effect in SIMON</h2>

    <p class="text-gray-300">The clustering of multiple trails satisfying the same input/output difference (differential effect) in SIMON can be visualized by the digraph in Fig. 9. It depicts a cluster of more than 275 000 trails satisfying the 21 round differential (4000000, 11000000)  <span class="math">\\xrightarrow{21R}</span>  (11000000, 4000000). The thickness of an edge in the digraph is proportional to the probability of the corresponding input and output difference connected by this edge.</p>

    <p class="text-gray-300">An interesting property clearly visible in the digraph in Fig. 9 is that it is composed of multiple smaller subgraphs positioned at alternate levels. Each such subgraph represents a biclique. Clearly, the bigger the number and size of such bicliques, the stronger the differential effect would be and hence the larger the probability of the differential. Therefore, the ability to obtain good estimation of the probability of a given differential for SIMON is intimately related to the ability to identify and characterize such complete bipartite subgraphs. Thus we take a closer look into those special structures below.</p>

    <p class="text-gray-300">    <img src="_page_10_Figure_9.jpeg" alt="" class="my-4 max-w-full" />
</p>

    <p class="text-gray-300">&lt;span id=&quot;page-10-1&quot;&gt;&lt;/span&gt;Fig. 5. Example of a bipartite subgraph embedded in the differential (graph) of Simon32.</p>

    <p class="text-gray-300">Table 5. Differential trails for Simon32, Simon48 and Simon64.</p>

    <p class="text-gray-300">&lt;span id=&quot;page-11-0&quot;&gt;&lt;/span&gt;</p>

    <div class="overflow-x-auto my-4">
      <table class="min-w-full text-sm text-gray-300">
        <thead>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"></th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">Simon32</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"></th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"></th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">Simon32</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"></th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"></th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">SIMON48</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"></th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"></th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">Simon64</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"></th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"></th>
        </thead>
        <tbody>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">\\overline{r}</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">\\Delta_{\\rm L}</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">\\it \\Delta_{\\rm R}</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">\\log_2 p</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">$ \\Delta_{\\rm L} $</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">\\it \\Delta_{\\rm R}</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">\\log_2 p</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">$ $ <span class="math">\\Delta_{\\rm L}</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">\\it \\Delta_{\\rm R}</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">\\log_2 p</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">\\big </span> <span class="math">\\Delta_{\\rm L}</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">\\it \\Delta_{\\rm R}</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">\\log_2 p</span></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">0</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">400</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1900</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-0</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">0</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">40</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-0</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">200020</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">80088</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-0</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">4000000</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">11000000</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-0</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">100</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">400</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-2</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">40</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">0</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-0</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">880008</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">200020</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-4</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1000000</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">4000000</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-2</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">2</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">0</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">100</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-2</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">100</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">40</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-2</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">2</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">880008</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-6</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">0</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1000000</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-2</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">3</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">100</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">0</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-0</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">440</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">100</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-2</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">880000</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">2</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-2</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1000000</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">0</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-0</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">4</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">400</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">100</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-2</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1000</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">440</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-4</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">200000</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">880000</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-4</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">4000000</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1000000</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-2</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">5</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1100</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">400</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-2</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">4440</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1000</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-2</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">80000</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">200000</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-2</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">11000000</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">4000000</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-2</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">6</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">4200</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1100</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-4</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">101</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">4440</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-6</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">0</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">80000</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-2</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">60000000</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">11000000</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-4</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">7</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1D01</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">4200</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-4</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">4044</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">101</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-4</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">80000</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">0</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-0</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">51000001</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">60000000</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-4</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">8</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">500</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1D01</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-8</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">10</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">4044</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-6</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">200000</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">80000</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-2</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">4000004</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">51000001</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-8</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">9</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">100</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">500</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-3</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">4004</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">10</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-2</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">880000</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">200000</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-2</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">41000011</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">4000004</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-4</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">10</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">100</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">100</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-2</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">4004</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-4</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">2</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">880000</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-4</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">0</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">41000011</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-8</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">11</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">500</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">100</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-2</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">4000</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-2</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">880008</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">2</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-2</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">41000011</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">0</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-0</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">12</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1500</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">500</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-3</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">0</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">4000</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-2</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">200020</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">880008</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-6</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">4000004</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">41000011</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-8</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">13</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">4000</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">0</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-0</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">80088</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">200020</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-4</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">51000001</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">4000004</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-4</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">14</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">200</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">88008</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-6</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">60000000</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">51000001</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-8</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">15</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">80888</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">200</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-2</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">11000000</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">60000000</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-4</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">16</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">4000000</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">11000000</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-4</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">17</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1000000</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">4000000</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-2</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">18</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">0</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1000000</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-2</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">19</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1000000</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">0</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-0</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">20</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">4000000</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1000000</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-2</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">21</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">11000000</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">4000000</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-2</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">\\sum_r \\log_2 p_r</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-34</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-36</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-48</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-72</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">\\log_2 p_{\\mathrm{diff}}</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-34.00</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-29.69</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-42.11</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-60.40</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">#trails</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">45083</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">112573</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">450536</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">\\log_2 p_{\\mathrm{thres}}</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-4.05</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-4.05</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-4.05</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-4.05</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">pDDT</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">128</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">128</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">128</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">128</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Time:</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">36 min.</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">47 min.</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">132 min.</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">&gt;778 min.</td>
          </tr>
        </tbody>
      </table>
    </div>

    <p class="text-gray-300">In Fig. 5 is shown an example of a complete bipartite subgraph (biclique) similar to the ones composing the digraph in Fig. 9. Note that each node has the same left input difference  <span class="math">\\Delta_L</span>  due to the Feistel structure of Simon.</p>

    <p class="text-gray-300">Consider the pair of left and right input differences  <span class="math">(\\Delta_L^i, \\Delta_R^i) = (11, 106)</span>  (hexadecimal values). Through the non-linear component  <span class="math">f(x) = (x \\ll 1) \\land (x \\ll 8)</span>  of the round function, the difference  <span class="math">\\Delta_L^i = 11</span>  propagates to a set of output differences. This set has the form  <span class="math">\\nabla = 000*000*00*00*00*00*00*00*00*00*00*00*0</span></p>

    <p class="text-gray-300">Another node with the same input difference  <span class="math">\\Delta_L^i</span>  to the round function, but with different right difference  <span class="math">\\Delta_R^i</span>  e.g.  <span class="math">(\\Delta_L^i, \\Delta_R^i) = (11, 104)</span>  (see Fig. 5) produces a corresponding set of output differences  <span class="math">\\nabla&#x27;</span> , which may or may not have common elements with  <span class="math">\\nabla</span>  in general. For example, in this case  <span class="math">\\nabla&#x27; = \\{0100, 0120, 0122\\}</span>  produced by the node (11, 104). In either case though,  <span class="math">\\nabla</span>  and  <span class="math">\\nabla&#x27;</span>  may still produce the same set of output differences  <span class="math">(\\Delta_L^{i+1}, \\Delta_R^{i+1})</span> . When this happens then a</p>

    <p class="text-gray-300">Table 6. Differential trails for Speck32, Speck48 and Speck64.</p>

    <p class="text-gray-300">&lt;span id=&quot;page-12-1&quot;&gt;&lt;/span&gt;</p>

    <div class="overflow-x-auto my-4">
      <table class="min-w-full text-sm text-gray-300">
        <thead>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"></th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">Speck32</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"></th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"></th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"></th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">Sреск48</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">3</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">Speck64</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"></th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"></th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"></th>
        </thead>
        <tbody>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">r</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">\\vert</span> <span class="math">\\varDelta_{\\rm L}</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">\\it \\Delta_{\\rm R}</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">{\\rm log}_2 p</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">\\big </span> <span class="math">\\varDelta_{\\rm L}</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">\\it \\Delta_{\\rm R}</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">{\\rm log}_2 p</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">\\big </span> <span class="math">\\varDelta_{\\rm L}</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">\\it \\Delta_{\\rm R}</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">{\\rm log}_2 p</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">0</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">8054</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">A900</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-0</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">202040</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">82921</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-0</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">9</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1000000</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-0</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">0</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">A402</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-3</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">480901</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">94009</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-7</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">8000000</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">0</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-2</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">2</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">A402</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">3408</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-3</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">80802</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">42084A</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-7</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">80000</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">80000</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-1</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">3</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">50C0</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">80E0</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-8</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">400052</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">504200</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-7</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">80800</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">480800</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-2</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">4</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">181</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">203</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-4</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">820200</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1202</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-5</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">480008</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">2084008</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-4</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">5</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">C</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">800</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-5</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">9000</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">10</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-4</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">6080808</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">164A0848</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-7</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">6</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">2000</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">0</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-3</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">80</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">0</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-2</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">F2400040</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">40104200</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-13</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">7</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">40</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">40</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-1</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">800000</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">800000</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-0</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">820200</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1202</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-8</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">8</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">8040</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">8140</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-1</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">808000</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">808004</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-1</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">9000</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">10</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-4</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">9</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">40</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">542</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-2</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">800084</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">8400A0</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-3</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">80</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">0</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-2</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">10</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">80A0</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">2085A4</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-4</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">80000000</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">80000000</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-0</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">11</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">808424</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">84A905</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-7</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">80800000</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">80800004</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-1</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">12</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">80008004</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">84008020</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-3</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">13</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">808080A0</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">A08481A4</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-5</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">14</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">40024</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">4200D01</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-8</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">\\sum_{r} \\log_2 p_r</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-30</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-47</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-60</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">\\log_2 p_{\\mathrm{diff}}</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-30.00</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-46.48</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-59.02</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">#trails</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">384</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">934</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">max HW</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">7</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">7</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">7</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">\\log_2 p_{\\mathrm{thres}}</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-5.00</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-5.00</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-5.00</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">\\rm pDDT</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">2^{30}</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">2^{30}</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">2^{30}</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Time:</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">\\approx 240</span> min.</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">\\approx 260</span> min.</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">&gt; 207 min.</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
        </tbody>
      </table>
    </div>

    <p class="text-gray-300">biclique is formed. This is shown in Fig. 5 where both  <span class="math">\\nabla</span>  and  <span class="math">\\nabla&#x27;</span>  result in the same set of output differences  <span class="math">(\\Delta_L^{i+1}, \\Delta_R^{i+1}) \\in \\{(4,11), (26,11), (6,11)\\}.</span></p>

    <p class="text-gray-300">In general, when the sets  <span class="math">\\nabla</span> ,  <span class="math">\\nabla&#x27;</span>  produced from two different pairs of input differences have high (and possibly equal) probabilities, the complete subgraphs that are formed as a result, have thick edges (corresponding to high probability). Such subgraphs contribute to the clustering of differential trails in SIMON.</p>

    <p class="text-gray-300">Note that the described subgraphs may not be formed for all possible elements in  <span class="math">\\nabla</span>  of an arbitrary node since, as already mentioned, some of them may propagate with 0 probability through the non-linear component f. Furthermore, because the complete bipartite subgraphs depend on the input differences, they can not occur at arbitrary positions in the digraph (Fig. 9). The frequent occurrence of such special subgraph structures in SIMON in large numbers is the main cause for the strong differential effect observed experimentally using the tool for differential search.</p>

    <p class="text-gray-300">In this section we describe a key recovery attack on SIMON32 with 64 bit key. The input difference to Round-r is denoted as  <span class="math">\\Delta^{r-1}</span>  and, bit positions  <span class="math">i_1, i_2, ..., i_t</span>  of x as  <span class="math">x[i_1, i_2, ..., i_t]</span> . Also  <span class="math">K^r</span>  denotes the round key for the Round-(r+1) and  <span class="math">\\mathcal{E}_r</span>  denotes the encryption function used with r rounds.</p>

    <h4 id="sec-3" class="text-lg font-semibold mt-6">7.1 Attack on 19 Rounds</h4>

    <p class="text-gray-300">To attack 19 rounds of SIMON32 we add 2 rounds on top and 4 rounds at the bottom of a set of four 13 round differentials. For this attack consider the following 13 round differentials</p>

    <pre><code class="language-text">\\begin{split} \\mathcal{D}_1: (0000,0020) &amp;\\to (2000,0) \\\\ \\mathcal{D}_2: (0000,0040) &amp;\\to (4000,0) \\\\ \\mathcal{D}_3: (0000,0400) &amp;\\to (0004,0) \\\\ \\mathcal{D}_4: (0000,0800) &amp;\\to (0008,0) \\end{split}
</code></pre>

    <p class="text-gray-300">The truncated difference at the beginning of Round-0, for the above mentioned differentials look as following:</p>

    <pre><code class="language-text">(00*0 0000 1*00 0000, **00 001* *0*0 0000)
(0*00 0001 *000 0000, *000 01** 0*00 000*)
(0001 *000 0000 0*00, 01** 0*00 000* *000)
(001* 0000 0000 *000, 1**0 *000 00** 0000)
</code></pre>

    <p class="text-gray-300">Observing the active and inactive bit positions of the above truncated differentials we can construct a set  <span class="math">2^{23}</span>  plaintexts where each  <span class="math">\\mathcal{P} = (P_L, P_R) \\in \\mathcal{P}</span>  has 9 bits, e.g.  <span class="math">P_L[0, 5, 6, 10, 11, 14, 15], P_R[13, 14]</span>  fixed to an arbitrary value. We can identify  <span class="math">2^{25}</span>  pairs of plaintexts (for each differential) from  <span class="math">\\mathcal{P}</span>  so that the pairs satisfy the corresponding  <span class="math">(\\Delta_L^2, \\Delta_R^2)</span>  after two rounds of encryption. For this we need to guess the following round-key bits  <span class="math">-(\\mathcal{D}_1)K^0[12, 14], (\\mathcal{D}_2)K^0[13, 15], (\\mathcal{D}_3)K^0[1, 3], (\\mathcal{D}_4)K^0[2, 4]</span> . Hence with 4 key guesses, 4 sets of  <span class="math">2^{23}</span>  pairs of plaintexts corresponding to a differential  <span class="math">\\mathcal{D}_i</span>  can be identified (where each pair in a set follows the top 2-round differential obtained from  <span class="math">\\mathcal{D}_i</span> ). Note that by varying some fixed bits of plaintexts in  <span class="math">\\mathcal{P}</span>  we can identify  <span class="math">2^{30.5}</span>  pairs for each differential and for each (2 bits) key guess.</p>

    <p class="text-gray-300">Each set of identified  <span class="math">2^{30.5}</span>  pairs of plaintexts is filtered by verifying the fixed bits of the corresponding truncated difference  <span class="math">\\Delta^{18}</span> . This reduces the number of pairs to  <span class="math">2^{30.5-18} = 2^{12.5}</span>  for each differential. In order to partially decrypt each pair of ciphertext it is necessary to guess the following key bits (and linear combinations of key bits) from last 3 rounds.</p>

    <p class="text-gray-300"><span class="math">$\\mathcal{D}_{1}^{K} = \\{K^{18}, K^{17}[3, 5 - 8, 12, 14], K^{16}[6] \\oplus K^{17}[4], K^{16}[4] \\oplus K^{17}[2]\\}</span>$
(9)</p>

    <p class="text-gray-300"><span class="math">$\\mathcal{D}_2^K = \\{ K^{18}, K^{17}[4, 6 - 9, 13, 15], K^{16}[7] \\oplus K^{17}[5], K^{16}[5] \\oplus K^{17}[3] \\}</span>$
(10)</p>

    <p class="text-gray-300"><span class="math">$\\mathcal{D}_{3}^{K} = \\{K^{18}, K^{17}[8, 10 - 13, 1, 3], K^{16}[11] \\oplus K^{17}[9], K^{16}[9] \\oplus K^{17}[7]\\}</span>$
(11)</p>

    <p class="text-gray-300"><span class="math">$\\mathcal{D}_4^K = \\{ K^{18}, K^{17}[9, 11 - 14, 2, 4], K^{16}[12] \\oplus K^{17}[10], K^{16}[10] \\oplus K^{17}[8] \\}</span>$
(12)</p>

    <p class="text-gray-300">In each differential we need to guess 25 bits (and linear combination of bits) from last 3 round-keys. So, for any differential  <span class="math">\\mathcal{D}_i</span>  it is necessary to guess: 25+2 (from  <span class="math">K^0</span> ) = 27 bits. For key recovery attack let us first consider the two differentials  <span class="math">\\mathcal{D}_1</span>  and  <span class="math">\\mathcal{D}_2</span> . Note that there are 19 bits common between  <span class="math">\\mathcal{D}_1^K</span>  and  <span class="math">\\mathcal{D}_2^K</span> . For detecting the correct key we maintain an array of counters of size  <span class="math">2^{27}</span>  for each  <span class="math">\\mathcal{D}_1</span>  and  <span class="math">\\mathcal{D}_2</span> . A counter is incremented when it is correctly verified using a partially decrypted pair of plaintexts by comparing with corresponding  <span class="math">\\Delta^{15}</span> . For each differential  <span class="math">\\mathcal{D}_1</span>  and  <span class="math">\\mathcal{D}_2</span> , we expect to have  <span class="math">(2^{27} \\times 2^{12.5})/2^{14} = 2^{25.5}</span>  increments. We expect approximately 4 correct pairs for each</p>

    <p class="text-gray-300">differential and the probability of a counter being incremented is  <span class="math">1/2^2</span> . So, it is expected to have  <span class="math">(\\frac{1}{4})^4 \\times 2^{25.5} = 2^{17.5}</span>  counters with 4 increments for each case. Let these two sets of counters be  <span class="math">T_1</span>  and  <span class="math">T_2</span> . Since  <span class="math">\\mathcal{D}_1^K</span>  and  <span class="math">\\mathcal{D}_2^K</span>  has 19 common key bits, after combining  <span class="math">T_1</span>  and  <span class="math">T_2</span>  we expect to obtain  <span class="math">2^{17.5} \\times (2^{17.5}/2^{19}) = 2^{16}</span>  candidates for 19 + 6 + 6 + 4 = 35 bits. Let us denote this set of counters as T'.</p>

    <p class="text-gray-300">Next we partially decrypt  <span class="math">2^{12}</span>  pairs of ciphertexts corresponding to  <span class="math">\\mathcal{D}_3</span>  to verify the difference  <span class="math">\\Delta^{15}</span>  for each 27 bit key guess. As described previously, we maintain an array of  <span class="math">2^{27}</span>  counters. A counter is incremented when it is verified correctly by a pair of ciphertexts. The expected number of counters having value 4 is  <span class="math">2^{17.5}</span> . Let us denote this set of counters as  <span class="math">T_3</span> .  <span class="math">\\mathcal{D}_3^K</span>  and  <span class="math">\\mathcal{D}_1^K \\cup \\mathcal{D}_2^K</span>  has 20 common round-key bits. Hence, combining  <span class="math">T_3</span>  and T' we expect to get  <span class="math">2^{16} \\times (2^{17.5}/2^{20}) = 2^{13.5}</span>  candidates for 35 + (25 + 2 - 20) = 42 round-key bits (out of which 36 bits correspond to last 3 round keys).</p>

    <p class="text-gray-300">Using the fourth differential  <span class="math">\\mathcal{D}_4</span>  in a similar way we obtain  <span class="math">2^9</span>  candidates for 42+(25-22)+2=47 bits of round-keys, from which we can determine 39 bits of last 3 round-keys.</p>

    <p class="text-gray-300">In order to recover the key we should know all the last 4 round-keys. For the remaining 64-39=25 bits of last four round-keys we use exhaustive search. Hence the total number of key guesses is  <span class="math">2^{9+25}=2^{34}</span> .</p>

    <p class="text-gray-300">Attack Complexity The time complexity for encrypting plaintexts is  <span class="math">2^{31.5}</span> . In the key guessing phase  <span class="math">2^{12}</span>  filtered pairs are decrypted for last 4 rounds for each  <span class="math">2^{25}</span>  key guesses. This is done for each differential. The partial decryption of ciphertext pairs (and increment of the counters) can be done in steps with partial key guess at each step of the last four rounds. This is done by filtering (due to the fixed bits of the truncated differences) at the beginning of Round-16 to Round-18. The complexity for this process is given as:</p>

    <p class="text-gray-300"><span class="math">$4 \\cdot 4 \\cdot (2^{12.5} \\cdot 2^{16} + 2^{12.5} \\cdot 2^9 \\cdot 2^7 + 2^{12.5} \\cdot 2^2 \\cdot 2^2) \\cdot \\frac{1}{19} \\approx 2^{33}</span>$
(13)</p>

    <p class="text-gray-300">For identifying the  <span class="math">2^{30.5}</span>  pairs with 4 key guesses for each differential requires  <span class="math">2^{31.5} \\cdot 2^2 = 2^{33.5}</span>  two round encryptions. The complexity due to this part is  <span class="math">2^{33.5} \\times 4 \\times (2/19) \\approx 2^{32}</span> . Hence the total complexity of the attack is  <span class="math">\\approx 2^{34}</span> .</p>

    <p class="text-gray-300">We also show attacks on round-reduced Simon48 and Simon64. The details of these attacks are described in appendix (C and D).</p>

    <p class="text-gray-300">In this section we describe a chosen plaintext (CP) attack on 11 rounds of Speck32 using the same notations as in Section 7. To attack Speck32 we use the 9 round differential trail with probability  <span class="math">2^{-30}</span>  given in Table 6. We add one round (Round-1) at the top of the trail and one round at the bottom (Round-11) of the trail to cover 11 rounds in total. If we encrypt  <span class="math">2^{30}</span>  pairs of plaintexts such that ( <span class="math">\\Delta_L^1 = 8054</span> ,  <span class="math">\\Delta_R^1 = A900</span> ), then it is expected to produce  <span class="math">2^{30} \\times \\frac{1}{2^{30}} = 1</span>  pair of plaintext satisfying the input/output differences at Round-2 and Round-10 and,  <span class="math">2^{30} \\times \\frac{1}{2^{28}} = 4</span>  pairs of plaintexts satisfying the input/output differences at Round-2 and Round-9.</p>

    <p class="text-gray-300">The key recovery attack is performed according to the following steps:</p>

    <p class="text-gray-300">    <img src="_page_15_Figure_0.jpeg" alt="" class="my-4 max-w-full" />
</p>

    <p class="text-gray-300">Fig. 6. Truncated difference (in binary notation) in the last 4 rounds of the 18 and 19 round key-recovery attacks on Simon32.</p>

    <p class="text-gray-300">    <img src="_page_16_Figure_0.jpeg" alt="" class="my-4 max-w-full" />
</p>

    <p class="text-gray-300">Fig. 7. Top 2 rounds in the attack of Simon32</p>

    <p class="text-gray-300">    <img src="_page_16_Figure_2.jpeg" alt="" class="my-4 max-w-full" />
</p>

    <p class="text-gray-300">Fig. 8. Differential trail for Round-10 and Round-11 in SPECK32</p>

    <ul class="list-disc list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li><ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li>Filtering: The least significant 7 bits of difference after the modular addition at Round-10 are always 100 0000. This implies that  <span class="math">\\Delta^{10}</span>  should be of the form **** **** *100 0000, where * denotes unknown bit values. Hence  <span class="math">2^{30}</span>  pairs of plaintext/ciphertexts can be filtered by unrolling the output difference of ciphertexts and verifying the 7 bits of  <span class="math">\\Delta^{10}</span> . This reduces the number of pairs to  <span class="math">2^{30-7} = 2^{23}</span> .</li>
    </ol></li>
      <li><ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li>Partial Key Guessing: For the filtered pairs, we guess all 16 bits of  <span class="math">K^{10}</span>  and 11 bits of  <span class="math">K^{9}</span>  (e.g.  <span class="math">K^{9}[5-15]</span> ) and, one carry bit at bit position 5 (in the modular addition at Round-10). For each of these  <span class="math">2^{28}</span>  partial key (and carry bit) guess we keep a counter. A counter is incremented if after partially decrypting (last 2 rounds) a pair of ciphertexts satisfies the difference  <span class="math">(\\Delta_L^9, \\Delta_R^9) = (8040, 8140)</span> . This will result in  <span class="math">(2^{28} \\times 2^{23})/2^{25} = 2^{26}</span>  increments of all the counters. Probability of a counter getting incremented is  <span class="math">2^{26}/2^{28} = \\frac{1}{2^2}</span>  and, 4 pairs are expected to satisfy the condition at the end of Round-9. Hence, number of counters incremented by 4 are  <span class="math">2^{26} \\times (\\frac{1}{2^2})^4 = 2^{18}</span> .</li>
    </ol></li>
      <li><ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li>Exhaustive Search: For the remaining 64 27 = 37 bits from the last rounds keys  <span class="math">K^9, K^8, K^7</span>  we use exhaustive search.</li>
    </ol></li>
    </ul>

    <p class="text-gray-300">Attack Complexity The complexity for decrypting of  <span class="math">2^{23}</span>  ciphertext pairs for each  <span class="math">2^{28}</span>  guesses of key bits and carry bit is,  <span class="math">(2^{28} \\cdot 2^{23}) \\cdot \\frac{1}{11} \\approx 2^{47}</span> . The total number of key guesses is  <span class="math">2^{18} \\cdot 2^{37} = 2^{55}</span> . Hence, total complexity is dominated by  <span class="math">\\approx 2^{55}</span> .</p>

    <p class="text-gray-300">With the same attack strategy, we also attack SPECK48 and SPECK64. The details of those attacks are described in appendix (A and B).</p>

    <p class="text-gray-300">In this paper were presented new results on the differential analysis of lightweight block ciphers Simon and Speck. In particular, by applying new techniques for the automatic search of trails and differentials in ARX ciphers, several previous results were improved. Those improvements were further used to mount the currently best known attacks on several versions of Simon and Speck. In addition an efficient algorithm for the computation of the DP of the AND operation was presented. A detailed analysis of the strong differential effect in Simon was given and the reason for it was analyzed. The described methods are general and are therefore applicable to other ARX designs.</p>

    <p class="text-gray-300">Acknowledgments. We thank our colleagues from the laboratory of algorithmics, cryptology and security (LACS) at the university of Luxembourg for the useful discussions. We are especially thankful to Yann Le Corre for pointing out several inconsistencies in the experimental results on Simon32. We further thank the anonymous reviewers for their time and useful comments. Some of the experiments presented in this paper were carried out using the HPC facility of the University of Luxembourg.</p>

    <p class="text-gray-300">    <img src="_page_18_Figure_0.jpeg" alt="" class="my-4 max-w-full" />
</p>

    <p class="text-gray-300">&lt;span id=&quot;page-18-0&quot;&gt;&lt;/span&gt;Fig. 9. Clustering of multiple trails satisfying the 21 round differential (4000000, 11000000) → (11000000, 4000000) in Simon64. The thickness of the edges between two nodes is proportional to the number of right pairs that follow the differential. The graph depicts more than 275 000 differential trails in total.</p>

    <ul class="list-disc list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li>&lt;span id=&quot;page-19-14&quot;&gt;&lt;/span&gt;1. F. Abed, E. List, S. Lucks, and J. Wenzel. Cryptanalysis of the speck family of block ciphers. Cryptology ePrint Archive, Report 2013/568, 2013. <a href="http://eprint.iacr.org/">http://eprint.iacr.org/</a>.</li>
      <li>&lt;span id=&quot;page-19-13&quot;&gt;&lt;/span&gt;2. F. Abed, E. List, S. Lucks, and J. Wenzel. Differential and linear cryptanalysis of reduced-round simon. Cryptology ePrint Archive, Report 2013/526, 2013. <a href="http://eprint.iacr.org/">http://eprint.iacr.org/</a>.</li>
      <li>&lt;span id=&quot;page-19-12&quot;&gt;&lt;/span&gt;3. H. A. Alkhzaimi and M. M. Lauridsen. Cryptanalysis of the simon family of block ciphers. Cryptology ePrint Archive, Report 2013/543, 2013. <a href="http://eprint.iacr.org/">http://eprint.iacr.org/</a>.</li>
      <li>&lt;span id=&quot;page-19-9&quot;&gt;&lt;/span&gt;4. R. Beaulieu, D. Shors, J. Smith, S. Treatman-Clark, B. Weeks, and L. Wingers. The SIMON and SPECK Families of Lightweight Block Ciphers. Cryptology ePrint Archive, Report 2013/404, 2013. <a href="http://eprint.iacr.org/">http://eprint.iacr.org/</a>.</li>
      <li><ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li>E. Biham and A. Shamir. Differential Cryptanalysis of DES-like Cryptosystems. J. Cryptology, 4(1):3–72, 1991.</li>
    </ol></li>
      <li>&lt;span id=&quot;page-19-15&quot;&gt;&lt;/span&gt;6. A. Biryukov and V. Velichkov. A Method for Automatic Search for Differential Trails in ARX Ciphers. Under Submission, 2013.</li>
      <li>&lt;span id=&quot;page-19-1&quot;&gt;&lt;/span&gt;7. A. Bogdanov, L. R. Knudsen, G. Leander, C. Paar, A. Poschmann, M. J. B. Robshaw, Y. Seurin, and C. Vikkelsoe. Present: An ultra-lightweight block cipher. In P. Paillier and I. Verbauwhede, editors, CHES, volume 4727 of Lecture Notes in Computer Science, pages 450–466. Springer, 2007.</li>
      <li>&lt;span id=&quot;page-19-5&quot;&gt;&lt;/span&gt;8. C. De Cannière, O. Dunkelman, and M. Knezevic. Katan and ktantan - a family of small and efficient hardwareoriented block ciphers. In C. Clavier and K. Gaj, editors, CHES, volume 5747 of Lecture Notes in Computer Science, pages 272–288. Springer, 2009.</li>
      <li>&lt;span id=&quot;page-19-18&quot;&gt;&lt;/span&gt;9. N. Ferguson, S. Lucks, B. Schneier, D. Whiting, M. Bellare, T. Kohno, J. Callas, and J. Walker. The Skein Hash Function Family. Submission to the NIST SHA-3 Competition (Round 2), 2009.</li>
      <li>&lt;span id=&quot;page-19-3&quot;&gt;&lt;/span&gt;10. Z. Gong, S. Nikova, and Y. W. Law. Klein: A new family of lightweight block ciphers. In A. Juels and C. Paar, editors, RFIDSec, volume 7055 of Lecture Notes in Computer Science, pages 1–18. Springer, 2011.</li>
      <li>&lt;span id=&quot;page-19-6&quot;&gt;&lt;/span&gt;11. J. Guo, T. Peyrin, A. Poschmann, and M. J. B. Robshaw. The led block cipher. In Preneel and Takagi <a href="#page-19-20">[17]</a>, pages 326–341.</li>
      <li>&lt;span id=&quot;page-19-7&quot;&gt;&lt;/span&gt;12. D. Hong, J. Sung, S. Hong, J. Lim, S. Lee, B. Koo, C. Lee, D. Chang, J. Lee, K. Jeong, H. Kim, J. Kim, and S. Chee. Hight: A new block cipher suitable for low-resource device. In L. Goubin and M. Matsui, editors, CHES, volume 4249 of Lecture Notes in Computer Science, pages 46–59. Springer, 2006.</li>
      <li>&lt;span id=&quot;page-19-0&quot;&gt;&lt;/span&gt;13. Internet Resource. Internet of Things. Wikipedia, retrieved in July 2013. <a href="http://www.en.wikipedia.org/wiki/Internet_of_Things">http://www.en.wikipedia.org/wiki/</a> <a href="http://www.en.wikipedia.org/wiki/Internet_of_Things">Internet\\_of\\_Things</a>.</li>
      <li>&lt;span id=&quot;page-19-11&quot;&gt;&lt;/span&gt;14. D. Khovratovich and I. Nikolic. Rotational Cryptanalysis of ARX. In S. Hong and T. Iwata, editors, FSE, volume 6147 of Lecture Notes in Computer Science, pages 333–346. Springer, 2010.</li>
      <li>&lt;span id=&quot;page-19-17&quot;&gt;&lt;/span&gt;15. M. Matsui. On Correlation Between the Order of S-boxes and the Strength of DES. In A. D. Santis, editor, EUROCRYPT, volume 950 of Lecture Notes in Computer Science, pages 366–375. Springer, 1994.</li>
      <li>&lt;span id=&quot;page-19-16&quot;&gt;&lt;/span&gt;16. N. Mouha, V. Velichkov, C. De Cannière, and B. Preneel. The Differential Analysis of S-Functions. In A. Biryukov, G. Gong, and D. R. Stinson, editors, Selected Areas in Cryptography, volume 6544 of Lecture Notes in Computer Science, pages 36–56. Springer, 2010.</li>
      <li>&lt;span id=&quot;page-19-20&quot;&gt;&lt;/span&gt;17. B. Preneel and T. Takagi, editors. Cryptographic Hardware and Embedded Systems - CHES 2011 - 13th International Workshop, Nara, Japan, September 28 - October 1, 2011. Proceedings, volume 6917 of Lecture Notes in Computer Science. Springer, 2011.</li>
      <li>&lt;span id=&quot;page-19-2&quot;&gt;&lt;/span&gt;18. K. Shibutani, T. Isobe, H. Hiwatari, A. Mitsuda, T. Akishita, and T. Shirai. Piccolo: An ultra-lightweight blockcipher. In Preneel and Takagi <a href="#page-19-20">[17]</a>, pages 342–357.</li>
      <li>&lt;span id=&quot;page-19-8&quot;&gt;&lt;/span&gt;19. T. Shirai, K. Shibutani, T. Akishita, S. Moriai, and T. Iwata. The 128-bit blockcipher clefia (extended abstract). In A. Biryukov, editor, FSE, volume 4593 of Lecture Notes in Computer Science, pages 181–195. Springer, 2007.</li>
      <li>&lt;span id=&quot;page-19-4&quot;&gt;&lt;/span&gt;20. T. Suzaki, K. Minematsu, S. Morioka, and E. Kobayashi. \${{twine}}$ : A lightweight block cipher for multiple platforms. In L. R. Knudsen and H. Wu, editors, Selected Areas in Cryptography, volume 7707 of Lecture Notes in Computer Science, pages 339–354. Springer, 2012.</li>
      <li>&lt;span id=&quot;page-19-10&quot;&gt;&lt;/span&gt;21. R.-P. Weinmann. AXR - Crypto Made from Modular Additions, XORs and Word Rotations. Dagstuhl Seminar 09031, January 2009.</li>
    </ul>

    <p class="text-gray-300">To attack Speck48, with key size 72, we use 10 round differential in table with probability 2 −39.46 . By adding one round at the top and one round at the bottom we can attack 12 rounds of the cipher. We encrypt  <span class="math">2^{42}</span>  pairs of plaintext so that they satisfy the input difference (202040,82921) at the beginning of Round-2. The expected number of good pairs at the end of Round-11 is  <span class="math">\\approx 4</span> . By partially decrypt the last round,  <span class="math">2^{42}</span>  pairs of plaintext is filtered to yield  <span class="math">2^{42-25}=2^{17}</span>  pairs of plaintexts. Next, we guess 24 bits of the last round key and decrypt the last round. If we keep a counter for each key guess, which are incremented when a key is suggested as correct candidate by a pair of cipher texts, then the total number of increment is  <span class="math">(2^{24} \\times 2^{17})/2^{23} = 2^{18}</span> . Since, the probability of a counter having an increment is  <span class="math">2^{18}/2^{24} = \\frac{1}{2^6}</span> , we expect exactly one counter having 4 increments, which corresponds to the correct key. By guessing the next two round key successively in the same way we can recover the whole key. The complexity due to the key guessing phase of attack is:  <span class="math">2^{18} \\times 2^{24} \\times \\frac{1}{12} + 2^{18} \\times 2^{24} \\times \\frac{2}{12} + 2^{18} \\times 2^{24} \\times \\frac{3}{12} = 2^{41}</span> . Hence, the total complexity is  <span class="math">2^{41} + 2^{43} \\approx 2^{43}</span></p>

    <p class="text-gray-300">In order to attack SPECK48 with key size 96 bit, we should recover the last four round keys. The attack can be performed in the similar way as described above. However, we need to proceed one more round from the bottom during the key guessing phase. The complexity for this phase is:  <span class="math">2^{18} \\times 2^{24} \\times \\frac{1}{12} + 2^{18} \\times 2^{24} \\times \\frac{2}{12} + 2^{18} \\times 2^{24} \\times \\frac{3}{12} + 2^{18} \\times 2^{24} \\times \\frac{4}{12} \\approx 2^{42}</span> . Hence, the overall complexity remains the same as before.</p>

    <h3 id="sec-4" class="text-xl font-semibold mt-8">&lt;span id=&quot;page-20-0&quot;&gt;&lt;/span&gt;B Attack on Speck64</h3>

    <p class="text-gray-300">To attack Speck64 with key size 96, we use the 14 round differential trail obtained by threshold search method. To attack 16 rounds of the cipher we add one round at the top and one round at the bottom. 2&lt;sup&gt;62&lt;/sup&gt; pairs of plaintexts are chosen so that they satisfy the input difference (9, 1000000) to Round-2. Since probability of 14 round differential is  <span class="math">2^{-60}</span> , it is expected to have approximately 4 good pairs at the end of Round-15. Note that the difference at the end of Round-15 is  <span class="math">(\\Delta_L, \\Delta_R)</span> (40024, 4200d01). So, the difference after modular addition at Round-16 should have the least significant bit active. Using this together with  <span class="math">\\Delta_R^{15}</span>  (input difference on the right to round-16) we filter out some pairs of cipher texts (obtained from the  <span class="math">2^{62}</span>  chosen plaintext pairs) by using the partial difference at the end of Round-15.  <span class="math">2^{62-33} = 2^{29}</span>  pairs are left after filtering. We guess the round key  <span class="math">K^{15}</span>  by keeping an array of counter for each guess and, a counter is incremented when it is verified with the fixed difference after partial decryption of pair of cipher texts. Total number of increments is given as  <span class="math">(2^{32} \\times 2^{29})/2^{31} = 2^{30}</span> . Since probability of a counter being incremented once is  <span class="math">2^2</span> , we expect  <span class="math">\\frac{1}{(2^2)^4} \\times 2^{30} = 2^{22}</span>  counters having 4 increments. Each of these  <span class="math">2^{22}</span>  counter corresponds to a candidate for round key  <span class="math">K^{15}</span> . In order to recover the key we need to know the round keys  <span class="math">K^{14}</span> and  <span class="math">K^{13}</span> . So, we proceed by guessing  <span class="math">K^{14}</span> . But, in this phase we maintain an array of  <span class="math">2^{54}</span>  counters, each for  <span class="math">2^{22+32} = 2^{54}</span>  possible key candidates for  <span class="math">K^{15}</span> ,  <span class="math">K^{14}</span> . Expected number of increments of the counters is:  <span class="math">(2^{22} \\times 2^{29} \\times 2^{32})/2^{32} = 2^{51}</span> . The number of correct pair after decrypting the cipher-text pairs for last two rounds is expected to be  <span class="math">2^2 \\cdot 2^8 = 2^{10}</span> . Hence, after this phase we will get one key candidate for  <span class="math">K^{15}</span> ,  <span class="math">K^{14}</span>  (total 64 bits). Recall that for recovering the key we need to know the last 3 round-keys. For  <span class="math">K^{13}</span>  we use exhaustive search which requires  <span class="math">2^{32}</span>  key guessings.</p>

    <p class="text-gray-300"><strong>Attack Complexity</strong> The complexity of the attack is dominated by the key guessing phase. The complexity during this process is given as</p>

    <p class="text-gray-300"><span class="math">$2^{32} \\times 2^{30} \\times \\frac{1}{16} + 2^{22} \\times 2^{30} \\times 2^{32} \\times \\frac{1.5}{16} \\approx 2^{80}</span>$</p>

    <p class="text-gray-300">Hence the attack complexity is dominated by  <span class="math">2^{80}</span> .</p>

    <p class="text-gray-300">The attack on Speck64 with 128 bit key can be performed in a similar way as described above. However, in this case we need to know the last four round keys. Hence, we perform the partial decryption of ciphertext pairs by guessing a round-key for one more round. The complexity for the key guessing and verifying with fixed difference after partial decryption is</p>

    <p class="text-gray-300"><span class="math">$(2^{32} \\times 2^{30} \\times \\frac{1}{16} + 2^{22} \\times 2^{30} \\times 2^{32} \\times \\frac{1.5}{16} + 2^{32} \\times 2^{22} \\times \\frac{3}{16}) \\approx 2^{80}</span>$</p>

    <p class="text-gray-300">Hence in this case also the complexity of the attack is  <span class="math">\\approx 2^{80}</span> .</p>

    <p class="text-gray-300">Note that for both 128 bit and 96 bit key sizes the complexity can be reduced to  <span class="math">\\approx 2^{73}</span>  if we use the full code book i.e.  <span class="math">2^{64}</span>  data.</p>

    <h3 id="sec-5" class="text-xl font-semibold mt-8">&lt;span id=&quot;page-21-0&quot;&gt;&lt;/span&gt;C Attack on Simon48</h3>

    <p class="text-gray-300">We use the 15 round differential in Table 5 to attack 19 rounds of SIMON48, with key size 72. We add one round on top of this differential and 3 rounds at the end. Since, the probability of the differential is  <span class="math">2^{-42.11}</span> , using  <span class="math">2^{45}</span>  pairs of chosen plaintexts we expect to get approximately 8 good pairs at end of Round-16. Propagating the difference (80888,200) through Round-17 and Round-18 we get a truncated difference  <span class="math">\\Delta_L^{17} = (001**000*01**000*001**000)</span>  and  <span class="math">\\Delta&#x27; = (******00**0*****0**0**1*****000)</span> , where  <span class="math">\\Delta&#x27;</span>  is the output difference before XORing of round-key and  <span class="math">\\Delta_L^{17} \\ll 2</span> . Using this truncated difference and unrolling the differences from Round-19 we can filter the plaintext/ciphertext pairs. This leaves  <span class="math">2^{45-25} = 2^{20}</span>  pairs of plaintexts.</p>

    <p class="text-gray-300">By guessing 29 round-key bits  <span class="math">K^{18}[1-6,8-23]</span> ,  <span class="math">K^{17}[0,4,10,12,14,18,20]</span>  and, a linear combination  <span class="math">K^{17}[2] \\oplus K^{18}[0]</span>  we can partially decrypt a pair of ciphertexts to verify  <span class="math">\\Delta^{16} = (80888,200)</span>  This is done by maintaining an array of  <span class="math">2^{30}</span>  counters. A counter is incremented when it is suggested by a plaintext pair. Hence, the total number of increment is  <span class="math">(2^{30} \\times 2^{20})/2^{23} = 2^{27}</span> , implying that the number of counters incremented by 8 is expected to be  <span class="math">(\\frac{1}{2^3})^8 \\times 2^{27} = 2^3</span> . For the remaining (72-30)=42 bits of the last three round-keys we use exhaustive search. Hence the total number of key guesses is  <span class="math">2^{42} \\cdot 2^3 = 2^{45}</span> .</p>

    <p class="text-gray-300">Attack Complexity The complexity for encrypting plaintexts is  <span class="math">2^{46}</span> . During the guessing process of 30 bits of key(and linear combination) complexity is given as</p>

    <p class="text-gray-300"><span class="math">$(2^{21} \\times 2^{22} + 2^{21} \\times 2^7 \\times 2^7) \\times \\frac{1}{19} \\approx 2^{39}</span>$</p>

    <p class="text-gray-300">Hence the complexity is  <span class="math">\\approx 2^{46}</span> .</p>

    <p class="text-gray-300">For attacking SIMON48 with key size 96 bits, we use the same technique described above. However in this case we need to know last 4 round-keys. So, after the first stage of the key guessing, we will be left with 96-30=66 bits to guess. For this we use exhaustive search and, the total number of key guesses is  <span class="math">2^{66+3}=2^{69}</span> .</p>

    <p class="text-gray-300">To attack 20 rounds of the cipher we use the same technique used for SIMON32. The idea is to add 2 rounds on top of the 15 round differential instead of 1 round. If the difference to Round-3  <span class="math">\\Delta^3 = (200020, 80088)</span> , is propagated through Round-2 and Round-1, the we get</p>

    <p class="text-gray-300"><span class="math">$\\Delta_L^0 =</span>$
000* 0000 *000 *01* 000* *000
<span class="math">$\\Delta_R^0 =</span>$
***0 *0** 00** ***0 1*** 1000</p>

    <p class="text-gray-300">We construct a set of plaintexts  <span class="math">\\mathcal{P}</span>  of size  <span class="math">2^{20}</span>  by varying the bit positions in  <span class="math">P=(P_L,P_R)</span>  corresponding to * in all possible ways and keeping other bit positions fixed to an arbitrary value. Using this set  <span class="math">\\mathcal{P}</span>  and guessing 6 bits of the round key  <span class="math">K^0</span>  we can identify  <span class="math">2^{20}</span>  pairs which satisfy the input difference to Round-3. Now by varying the fixed bit positions ( <span class="math">2^{25}</span>  times) we can identify  <span class="math">2^{45}</span>  pairs of plaintexts satisfying the input difference to Round-3. Next we perform the attack as described before (on 19 rounds) for each key guess of  <span class="math">K^0</span> . The complexity of the attack will be roughly  <span class="math">2^6 \\times 2^{46} = 2^{52}</span>  and  <span class="math">2^6 \\times 2^{69} = 2^{75}</span>  for key size 72 and 96 respectively.</p>

    <h2 id="sec-6" class="text-2xl font-bold">D.1 Attack on 26 rounds</h2>

    <p class="text-gray-300">To attack SIMON64, with key size 96, we use the 21 round differential with probability  <span class="math">2^{-60.53}</span>  (see Table 2). We add one round on the top and 4 rounds at the bottom of the differential. Since the probability of the differential is  <span class="math">2^{-60.53}</span> , using  <span class="math">2^{62}</span>  pairs of chosen plaintexts we expect to get approximately 2-3 good pairs at end of Round-22. Propagating the difference  <span class="math">(\\Delta_L^{22}, \\Delta_R^{22}) = (11000000, 4000000)</span>  through Round-23, Round-24 and Round-25 we get a truncated difference with 35 known bits, input to Round-26:</p>

    <p class="text-gray-300"><span class="math">$\\begin{split} &amp; \\varDelta_R^{25} = (**01\\ **01\\ 0000\\ 0000\\ 000*\\ 000*\\ 0**0\\ 0**1) \\\\ &amp; \\varDelta_L^{25} = (*0**\\ *1*0\\ 000*\\ 000*\\ 0**0\\ 0***\\ ****) \\end{split}</span>$</p>

    <p class="text-gray-300">Using this truncated difference and unrolling the differences from Round-26 we can filter the plaintext/ciphertext pairs. This leaves  <span class="math">2^{62-35}=2^{27}</span>  pairs of plaintexts. By guessing 49 round-key bits</p>

    <pre><code class="language-text">\\begin{aligned} &amp; \\text{Round} - 26: K^{25}[0-15,17-31] \\\\ &amp; \\text{Round} - 25: K^{24}[0,2-5,7,9,11,13,16,20,22,23,25,27,29,30] \\\\ &amp; \\text{Round} - 24: K^{23}[31] \\end{aligned}
</code></pre>

    <p class="text-gray-300">and linear combinations of round-key bits  <span class="math">K^{23}[3] \\oplus K^{24}[1]</span> ,  <span class="math">K^{23}[17] \\oplus K^{24}[15]</span> ,  <span class="math">K^{23}[21] \\oplus K^{24}[19]</span>  we can partially decrypt a pair of ciphertexts to verify  <span class="math">(\\Delta_L^{22}, \\Delta_R^{22}) = (11000000, 4000000)</span> . This is done by maintaining an array of  <span class="math">2^{52}</span>  counters. A counter is incremented when it is suggested by a plaintext pair. Hence, the total number of increments is  <span class="math">(2^{52} \\times 2^{27})/2^{29} = 2^{50}</span> , implying that the number of counters incremented by 2 is expected to be  <span class="math">(2^{50}/2^{52})^2 = (\\frac{1}{2^2})^2 \\times 2^{49} = 2^{45}</span> . For the remaining 44 bits of the last three round-keys we use exhaustive search. Hence the total number of key guesses is  <span class="math">2^{45} \\cdot 2^{44} = 2^{89}</span> .</p>

    <p class="text-gray-300">Attack Complexity For partial decryption part of the attack the complexity is</p>

    <p class="text-gray-300"><span class="math">$(2^{28} \\times 2^{31} + 2^{28} \\times 2^{16} \\times 2^{17} + 2^{28} \\times 2^{16} \\times 2^{7} \\times 2^{4}) \\times \\frac{1}{26} \\approx 2^{59}.</span>$</p>

    <p class="text-gray-300">Hence the complexity is dominated by the total number of key guessing part, which is ≈ 2 89 .</p>

    <p class="text-gray-300">For attacking Simon64 with key size 128 bits, we use the same technique described above. However in this case we need to know the last 4 round-keys. So, after the first stage of the key guessing, we will be left with 128 − 52 = 76 bits to guess. For this we use exhaustive search and, the total number of key guesses is 2 45+76 = 2&lt;sup&gt;121&lt;/sup&gt; .</p>

`;
---

<BaseLayout title="Differential Analysis of Block Ciphers SIMON and SPECK (2014/922)">
  <article class="max-w-4xl mx-auto article-prose">
    <nav class="mb-8">
      <a href="/papers" class="text-blue-400 hover:text-blue-300">
        &larr; Back to Papers
      </a>
    </nav>

    <header class="mb-12">
      <h1 class="text-3xl font-bold mb-4"
        set:html={TITLE_HTML} />
      <p class="text-gray-400 mb-2"
        set:html={AUTHORS_HTML} />
      <p class="text-gray-500 text-sm mb-4">
        2014 &middot; eprint 2014/922
      </p>
      <div class="flex gap-4 text-sm">
        <a
          href={EPRINT_URL}
          target="_blank"
          rel="noopener noreferrer"
          class="text-blue-400 hover:text-blue-300"
        >
          Paper (eprint) &rarr;
        </a>
      </div>
      <PaperDisclaimer eprintUrl={EPRINT_URL} />
      <p class="mt-1 text-xs text-gray-600">
        Converted with: {CRAWLER} &middot; {CONVERTED_DATE}
      </p>
    </header>

    <Fragment set:html={CONTENT} />

    <PaperHistory slug="differential-analysis-of-block-ciphers-simon-and-speck-2014" />
  </article>
</BaseLayout>
