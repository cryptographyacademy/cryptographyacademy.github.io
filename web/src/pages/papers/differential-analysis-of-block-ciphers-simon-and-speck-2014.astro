---
import BaseLayout from '../../layouts/BaseLayout.astro';

const EPRINT_URL = 'https://eprint.iacr.org/2014/922';
const CRAWLER = 'mistral';
const CONVERTED_DATE = '2026-02-16';
const TITLE_HTML = 'Differential Analysis of Block Ciphers SIMON and SPECK';
const AUTHORS_HTML = 'Alex Biryukov, Arnab Roy, Vesselin Velichkov';

const CONTENT = `    <p class="text-gray-300">Alex Biryukov Arnab Roy Vesselin Velichkov</p>

    <h6 id="sec-2" class="text-base font-medium mt-4">Abstract</h6>

    <p class="text-gray-300">In this paper we continue the previous line of research on the analysis of the differential properties of the lightweight block ciphers Simon and Speck. We apply a recently proposed technique for automatic search for differential trails in ARX ciphers and improve the trails in Simon32 and Simon48 previously reported as best. We further extend the search technique for the case of differentials and improve the best previously reported differentials on Simon32, Simon48 and Simon64 by exploiting more effectively the strong differential effect of the cipher. We also present improved trails and differentials on Speck32, Speck48 and Speck64. Using these new results we improve the currently best known attacks on several versions of Simon and Speck. A second major contribution of the paper is a graph based algorithm (linear time) for the computation of the exact differential probability of the main building block of Simon: an AND operation preceded by two bitwise shift operations. This gives us a better insight into the differential property of the Simon round function and differential effect in the cipher. Our algorithm is general and works for any rotation constants. The presented techniques are generic and are therefore applicable to a broader class of ARX designs.</p>

    <h6 id="sec-3" class="text-base font-medium mt-4">Keywords:</h6>

    <p class="text-gray-300">symmetric-key, differential trail, tools for cryptanalysis, automatic search, ARX, Simon, Speck, lightweight ciphers</p>

    <h2 id="sec-4" class="text-2xl font-bold">1 Introduction</h2>

    <p class="text-gray-300">The past decade in technology has been marked by the ever decreasing size of computing devices. This, in combination with their increasingly ubiquitous use e.g. as smart devices, wearable systems, as part of the <em>Internet of Things</em> <em>[13]</em>, has enabled humans to perform everyday activities more efficiently. At the same time these new technologies have also created new security challenges.</p>

    <p class="text-gray-300">An important problem today is the design of cryptographic algorithms that are both efficient and secure, have small memory footprint and are low-cost and easy to implement and deploy on multiple platforms. Finding an optimal compromise between these, often conflicting, requirements is the difficult area researched by the field of <em>lightweight cryptography</em>. The applications of lightweight cryptographic algorithms vary from mobile devices, through RFID tags to electronic locks and their importance is likely to continue increasing in the future.</p>

    <p class="text-gray-300">To address the persistent need for secure and efficient lightweight primitives, numerous proposals have been made in the past few years. In the area of symmetric-key encryption some of the more prominent block ciphers that were proposed are: Present <em>[7]</em>, Piccolo <em>[18]</em>, Klein <em>[10]</em>, Twine <em>[20]</em>, Katan and Ktantan <em>[8]</em>, LED <em>[11]</em>, HIGHT <em>[12]</em> and CLEFIA <em>[19]</em>.</p>

    <p class="text-gray-300">Most recently, in June 2013, yet two more algorithms have been put forth by researchers from the National Security Agency (NSA) of the USA – the block ciphers Simon and Speck <em>[4]</em>. Compared to their predecessors, the latter two have very competitive performance, small memory footprint and beat most existing lightweight ciphers in terms of efficiency and compactness. Furthermore, the two designs are very simple and elegant. They are both built on the ARX philosophy <em>[21, 14]</em>, using only basic arithmetic operations such as modular addition, XOR, bitwise AND and bit rotation.</p>

    <p class="text-gray-300">Evidence of the performance and implementation advantages of Simon and Speck exists in the form of extensive results and comparisons to existing lightweight algorithms described in the design document <em>[4]</em>. However the latter does not provide any security evaluation of the two ciphers and no analysis of their cryptographic strength is given. Recently several external cryptanalytic results on Simon and Speck became available: <em>[3, 2, 1]</em>. The first two in particular analyze the differential properties of the ciphers and describe key-recovery attacks on reduced round variants.</p>

    <p class="text-gray-300">Our Contribution. In this paper we further investigate the differential behavior of block ciphers Simon and Speck. We apply a recently proposed technique for automatic search for differential trails in ARX ciphers called threshold search <em>[6]</em>. We find better differential trails on Simon32 and Simon48 than the ones reported by <em>[2]</em> and claimed to be the best and, we confirm the trail on Simon64. Improved trails that cover one round more than the previously reported best trails <em>[1]</em> on Speck32, Speck48 and Speck64 are found. We further extend the threshold search technique for finding differentials. With the new tool we improve the differentials on Simon32, Simon48 and Simon64 reported by <em>[2]</em> and we present new differentials on Speck32, Speck48 and Speck64. We use these new results to improve the currently best known attacks on several versions of Simon and Speck.</p>

    <p class="text-gray-300">The second major contribution of the paper is an efficient algorithm for the computation of the differential probabilities (DP) of the bitwise AND operation – the single source of non-linearity in the round function of Simon. We describe algorithms for the computation of the exact DP of AND with independent inputs and rotationally dependent inputs (one input is equal to the rotation of the other one) as used in Simon. In addition, methods for computing the maximum DP over all inputs and over all outputs of the AND operation are also proposed. All described algorithms have linear time complexity in the word size. These algorithms are used in the threshold search and in the differential search tool for Simon.</p>

    <p class="text-gray-300">Finally, we briefly comment on the strong differential effect in Simon – a property already noted in <em>[3]</em>. In addition we provide new insights into the clustering of differential trails that causes this effect. A summary of the main results from the search on trails and differentials is provided in Table 2. Note that in this table is mentioned a figure for the time complexity of the attacks on Simon32 and Simon64 described in <em>[2]</em> that we were not able to verify.</p>

    <p class="text-gray-300">The outline of the paper is as follows. We begin with Sect. 2 where the XOR differential probability of the AND operation is analyzed. Next in Sect. 3 are presented techniques for searching for trails and differentials in ARX algorithms. The block ciphers Simon and Speck are briefly described in Sect. 4. Full differential trails are presented in Sect. 5. Finally, in Sect. 6 we comment on the strong differential effect of Simon. Sect. 9 concludes the paper.</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">A few words on notation: with <span class="math">x_{i}</span> is denoted the <span class="math">i</span>-th bit of the <span class="math">n</span>-bit word <span class="math">x</span> (<span class="math">x_{0}</span> is the LSB); <span class="math">\\overline{x_{i}}</span> represents the modulo-2 complementation of <span class="math">x_{i}</span> i.e. <span class="math">\\overline{x_{i}}=x_{i}\\oplus 1</span>; the symbols <span class="math">\\wedge</span> and <span class="math">\\vee</span> denote respectively bitwise logical AND and OR operations; the left and right rotation of the bits of <span class="math">x</span> by <span class="math">r</span> positions is denoted respectively with <span class="math">x\\lll r</span> and <span class="math">x\\ggg r</span>; $</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">S</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"><span class="math"> represents the cardinality of the set </span>S<span class="math">. The concatenation of the bit strings </span>x<span class="math"> and </span>y<span class="math"> is denoted by </span>x</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">y$.</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">##</p>

    <p class="text-gray-300">Table 1. Summary of attacks on SIMON and SPECK. All listed attacks are chosen-plaintext. <span class="math">^{a,b,c}</span>  Differs from [2].</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Cipher</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Key Size</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">#Rounds Total</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">#Rounds Attacked</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Time Sect. 7, 8</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Data Sect. 7, 8</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Time [2,1]</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Data [2,1]</th>

          </tr>

        </thead>

        <tbody>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">SIMON32</td>

            <td class="px-3 py-2 border-b border-gray-700">64</td>

            <td class="px-3 py-2 border-b border-gray-700">32</td>

            <td class="px-3 py-2 border-b border-gray-700">18</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">262 a</td>

            <td class="px-3 py-2 border-b border-gray-700">231.2</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">64</td>

            <td class="px-3 py-2 border-b border-gray-700">32</td>

            <td class="px-3 py-2 border-b border-gray-700">19</td>

            <td class="px-3 py-2 border-b border-gray-700">234</td>

            <td class="px-3 py-2 border-b border-gray-700">231.5</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">64</td>

            <td class="px-3 py-2 border-b border-gray-700">32</td>

            <td class="px-3 py-2 border-b border-gray-700">19</td>

            <td class="px-3 py-2 border-b border-gray-700">240</td>

            <td class="px-3 py-2 border-b border-gray-700">231</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">SIMON48</td>

            <td class="px-3 py-2 border-b border-gray-700">72</td>

            <td class="px-3 py-2 border-b border-gray-700">36</td>

            <td class="px-3 py-2 border-b border-gray-700">19</td>

            <td class="px-3 py-2 border-b border-gray-700">246</td>

            <td class="px-3 py-2 border-b border-gray-700">246</td>

            <td class="px-3 py-2 border-b border-gray-700">252</td>

            <td class="px-3 py-2 border-b border-gray-700">246</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">72</td>

            <td class="px-3 py-2 border-b border-gray-700">36</td>

            <td class="px-3 py-2 border-b border-gray-700">20</td>

            <td class="px-3 py-2 border-b border-gray-700">252</td>

            <td class="px-3 py-2 border-b border-gray-700">246</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">96</td>

            <td class="px-3 py-2 border-b border-gray-700">36</td>

            <td class="px-3 py-2 border-b border-gray-700">19</td>

            <td class="px-3 py-2 border-b border-gray-700">269</td>

            <td class="px-3 py-2 border-b border-gray-700">246</td>

            <td class="px-3 py-2 border-b border-gray-700">276</td>

            <td class="px-3 py-2 border-b border-gray-700">246</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">96</td>

            <td class="px-3 py-2 border-b border-gray-700">36</td>

            <td class="px-3 py-2 border-b border-gray-700">20</td>

            <td class="px-3 py-2 border-b border-gray-700">275</td>

            <td class="px-3 py-2 border-b border-gray-700">246</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">SIMON64</td>

            <td class="px-3 py-2 border-b border-gray-700">96</td>

            <td class="px-3 py-2 border-b border-gray-700">42</td>

            <td class="px-3 py-2 border-b border-gray-700">26</td>

            <td class="px-3 py-2 border-b border-gray-700">289</td>

            <td class="px-3 py-2 border-b border-gray-700">263</td>

            <td class="px-3 py-2 border-b border-gray-700">294 b</td>

            <td class="px-3 py-2 border-b border-gray-700">263</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">128</td>

            <td class="px-3 py-2 border-b border-gray-700">44</td>

            <td class="px-3 py-2 border-b border-gray-700">26</td>

            <td class="px-3 py-2 border-b border-gray-700">2121</td>

            <td class="px-3 py-2 border-b border-gray-700">263</td>

            <td class="px-3 py-2 border-b border-gray-700">2126 c</td>

            <td class="px-3 py-2 border-b border-gray-700">263</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">SPECK32</td>

            <td class="px-3 py-2 border-b border-gray-700">64</td>

            <td class="px-3 py-2 border-b border-gray-700">22</td>

            <td class="px-3 py-2 border-b border-gray-700">10</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">229.2</td>

            <td class="px-3 py-2 border-b border-gray-700">229</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">64</td>

            <td class="px-3 py-2 border-b border-gray-700">22</td>

            <td class="px-3 py-2 border-b border-gray-700">11</td>

            <td class="px-3 py-2 border-b border-gray-700">255</td>

            <td class="px-3 py-2 border-b border-gray-700">231</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">SPECK48</td>

            <td class="px-3 py-2 border-b border-gray-700">72/96</td>

            <td class="px-3 py-2 border-b border-gray-700">22</td>

            <td class="px-3 py-2 border-b border-gray-700">12</td>

            <td class="px-3 py-2 border-b border-gray-700">243</td>

            <td class="px-3 py-2 border-b border-gray-700">243</td>

            <td class="px-3 py-2 border-b border-gray-700">245.3</td>

            <td class="px-3 py-2 border-b border-gray-700">245</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">SPECK64</td>

            <td class="px-3 py-2 border-b border-gray-700">96/128</td>

            <td class="px-3 py-2 border-b border-gray-700">26</td>

            <td class="px-3 py-2 border-b border-gray-700">15</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">261.1</td>

            <td class="px-3 py-2 border-b border-gray-700">261</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">96</td>

            <td class="px-3 py-2 border-b border-gray-700">26</td>

            <td class="px-3 py-2 border-b border-gray-700">16</td>

            <td class="px-3 py-2 border-b border-gray-700">280</td>

            <td class="px-3 py-2 border-b border-gray-700">263</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">96</td>

            <td class="px-3 py-2 border-b border-gray-700">26</td>

            <td class="px-3 py-2 border-b border-gray-700">16</td>

            <td class="px-3 py-2 border-b border-gray-700">273</td>

            <td class="px-3 py-2 border-b border-gray-700">264</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">128</td>

            <td class="px-3 py-2 border-b border-gray-700">27</td>

            <td class="px-3 py-2 border-b border-gray-700">16</td>

            <td class="px-3 py-2 border-b border-gray-700">280</td>

            <td class="px-3 py-2 border-b border-gray-700">263</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">128</td>

            <td class="px-3 py-2 border-b border-gray-700">27</td>

            <td class="px-3 py-2 border-b border-gray-700">16</td>

            <td class="px-3 py-2 border-b border-gray-700">273</td>

            <td class="px-3 py-2 border-b border-gray-700">264</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

          </tr>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">Definition 1 (xdp <span class="math">^{\\&amp;amp;}</span>  with independent inputs). Let  <span class="math">\\alpha, \\beta</span>  and  <span class="math">\\gamma</span>  be fixed  <span class="math">n</span> -bit XOR differences. The XOR differential probability (DP) of the logical AND operation (xdp <span class="math">^{\\&amp;amp;}</span> ) is the probability with which  <span class="math">\\alpha</span>  and  <span class="math">\\beta</span>  propagate to  <span class="math">\\gamma</span>  through the AND operation, computed over all pairs of  <span class="math">n</span> -bit inputs  <span class="math">(x,y)</span> :</p>

    <div class="my-4 text-center"><span class="math-block"></span></div>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\operatorname {x d p} ^ {\\&amp;} (\\alpha , \\beta \\rightarrow \\gamma) = 2 ^ {- 2 n} \\cdot</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\{(x, y): ((x \\oplus \\alpha) \\wedge (y \\oplus \\beta)) \\oplus (x \\wedge y) = \\gamma \\}</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">. \\tag {1}</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <div class="my-4 text-center"><span class="math-block"></span></div>

    <p class="text-gray-300">In the remaining of the text the acronym DP will be used to denote XOR differential probability unless specified otherwise. When the input differences  <span class="math">\\alpha</span>  and  <span class="math">\\beta</span>  are independent, the DP  <span class="math">\\mathrm{xdp}^{\\wedge}(\\alpha ,\\beta \\rightarrow \\gamma)</span>  can be efficiently computed according to the following theorem.</p>

    <p class="text-gray-300">Theorem 1. For fixed  <span class="math">n</span> -bit XOR differences  <span class="math">\\alpha, \\beta</span>  and  <span class="math">\\gamma</span>  the probability  <span class="math">\\mathrm{xdp}^{\\&amp;amp;}(\\alpha, \\beta \\to \\gamma)</span>  is equal to</p>

    <div class="my-4 text-center"><span class="math-block">\\operatorname {x d p} ^ {\\&amp;amp;} (\\alpha , \\beta \\rightarrow \\gamma) = 2 ^ {- n} \\cdot \\prod_ {i = 0} ^ {n - 1} \\left(\\left(2 \\cdot \\left(\\bar {\\alpha} _ {i} \\wedge \\bar {\\beta} _ {i} \\wedge \\bar {\\gamma} _ {i}\\right)\\right) \\vee \\left(\\overline {{\\bar {\\alpha} _ {i} \\wedge \\bar {\\beta} _ {i}}}\\right)\\right) \\wedge \\overline {{\\left(\\bar {\\alpha} _ {i} \\wedge \\bar {\\beta} _ {i} \\wedge \\gamma_ {i}\\right)}}. \\tag {2}</span></div>

    <p class="text-gray-300">Proof. Note that  <span class="math">\\mathrm{xdp}^{\\&amp;amp;}(\\alpha, \\beta \\to \\gamma) = 0 \\iff \\exists i: 0 \\leq i &amp;lt; n: (\\overline{\\alpha}_i \\wedge \\overline{\\beta}_i \\wedge \\gamma_i) = 1</span> . Therefore whenever the probability is zero, the term  <span class="math">(\\overline{\\alpha}_i \\wedge \\overline{\\beta}_i \\wedge \\gamma_i)</span>  evaluates to zero and hence the right hand-side of (2) is also zero. If the probability is non-zero and  <span class="math">\\alpha_i = \\beta_i = \\gamma_i = 0</span>  at bit position  <span class="math">i</span>  then  <span class="math">(\\overline{\\alpha}_i \\wedge \\overline{\\beta}_i \\wedge \\overline{\\gamma}_i) = 1</span>  which is multiplied by the number of valid pairs  <span class="math">(x_i, y_i)</span>  (cf. Definition 1) i.e. 4. If  <span class="math">\\alpha_i \\neq \\beta_i</span>  then exactly two pairs  <span class="math">(x_i, y_i)</span>  satisfy the differential at bit position  <span class="math">i</span>  irrespective of the value of  <span class="math">\\gamma_i</span> . In this case  <span class="math">(\\overline{\\alpha}_i \\wedge \\overline{\\beta}_i) = 1</span>  and it is multiplied by the number of valid pairs  <span class="math">(x_i, y_i)</span>  which is 2. Therefore</p>

    <p class="text-gray-300">Table 2. Summary of the best found differential trails and differentials in SIMON and SPECK;  <span class="math">{}^{a}</span>  Measured as the average prob. over 128 keys chosen at random and using the full codebook.</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Cipher</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"># rounds</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">log2p, trail</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">log2p, diff.</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"># trails</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">ref.</th>

          </tr>

        </thead>

        <tbody>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">SIMON32</td>

            <td class="px-3 py-2 border-b border-gray-700">12</td>

            <td class="px-3 py-2 border-b border-gray-700">-34</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">Sect. 5 [2]</td>

          </tr>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">|   |   |  -36 |  |   |   |</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">13</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">-36</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">-29.69</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">45083</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Sect. 5</th>

          </tr>

        </thead>

        <tbody>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">-36</td>

            <td class="px-3 py-2 border-b border-gray-700">-30.20</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">SIMON48</td>

            <td class="px-3 py-2 border-b border-gray-700">15</td>

            <td class="px-3 py-2 border-b border-gray-700">-48</td>

            <td class="px-3 py-2 border-b border-gray-700">-42.11</td>

            <td class="px-3 py-2 border-b border-gray-700">112573</td>

            <td class="px-3 py-2 border-b border-gray-700">Sect. 5 [2]</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">-52</td>

            <td class="px-3 py-2 border-b border-gray-700">-43.01</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">SIMON64</td>

            <td class="px-3 py-2 border-b border-gray-700">20</td>

            <td class="px-3 py-2 border-b border-gray-700">-70</td>

            <td class="px-3 py-2 border-b border-gray-700">-58.07</td>

            <td class="px-3 py-2 border-b border-gray-700">533163</td>

            <td class="px-3 py-2 border-b border-gray-700">Sect. 5 [2]</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">-70</td>

            <td class="px-3 py-2 border-b border-gray-700">-59.01</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">21</td>

            <td class="px-3 py-2 border-b border-gray-700">-72</td>

            <td class="px-3 py-2 border-b border-gray-700">-60.40</td>

            <td class="px-3 py-2 border-b border-gray-700">450536</td>

            <td class="px-3 py-2 border-b border-gray-700">Sect. 5 [2]</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">-72</td>

            <td class="px-3 py-2 border-b border-gray-700">-61.01</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">SPECK32</td>

            <td class="px-3 py-2 border-b border-gray-700">8</td>

            <td class="px-3 py-2 border-b border-gray-700">-24</td>

            <td class="px-3 py-2 border-b border-gray-700">-24</td>

            <td class="px-3 py-2 border-b border-gray-700">1</td>

            <td class="px-3 py-2 border-b border-gray-700">Sect. 5 [1]</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">-24</td>

            <td class="px-3 py-2 border-b border-gray-700">-24</td>

            <td class="px-3 py-2 border-b border-gray-700">1</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">9</td>

            <td class="px-3 py-2 border-b border-gray-700">-31</td>

            <td class="px-3 py-2 border-b border-gray-700">-31</td>

            <td class="px-3 py-2 border-b border-gray-700">1</td>

            <td class="px-3 py-2 border-b border-gray-700">Sect. 5</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">SPECK48</td>

            <td class="px-3 py-2 border-b border-gray-700">10</td>

            <td class="px-3 py-2 border-b border-gray-700">-40</td>

            <td class="px-3 py-2 border-b border-gray-700">-39.75</td>

            <td class="px-3 py-2 border-b border-gray-700">137</td>

            <td class="px-3 py-2 border-b border-gray-700">Sect. 5 [1]</td>

          </tr>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">|   |   |   | -40.55 |  |   |</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">11</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">-47</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">-46.48</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">384</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Sect. 5</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">|   |   |   | -58.90 |  |   |</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">14</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">-60</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">-59.02</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">934</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Sect. 5</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">for non-zero probability, the product on the right-hand size of (2) is a multiple of  <span class="math">2^n</span> . The latter cancels with the term  <span class="math">2^{-2n}</span>  (cf. Definition 1) and so the final expression is multiplied by  <span class="math">2^{-n}</span> .</p>

    <p class="text-gray-300">Theorem 1 implies the following corollary.</p>

    <p class="text-gray-300">Corollary 1. Given  <span class="math">n</span> -bit input differences  <span class="math">\\alpha, \\beta</span>  and output difference  <span class="math">\\gamma</span> , the probability  <span class="math">\\mathrm{xdp}^{\\&amp;amp;}(\\alpha, \\beta \\to \\gamma)</span>  can be computed in  <span class="math">\\mathcal{O}(n)</span>  time.</p>

    <p class="text-gray-300">Proof. Follows directly from Theorem 1.</p>

    <p class="text-gray-300">Note that when the inputs to the AND operation are dependent on each other, the DP computed with Theorem 1 is not accurate. In particular, let the two inputs  <span class="math">x</span> ,  <span class="math">y</span>  to AND be such that  <span class="math">y = (x \\ll r)</span> . So, an input XOR difference  <span class="math">\\alpha</span>  applied to  <span class="math">x</span>  will result into an input difference  <span class="math">(\\alpha \\ll r)</span>  to  <span class="math">y</span> . Considering the dependencies between the input variables, the DP in this case is defined as follows:</p>

    <p class="text-gray-300">Definition 2 (xdp <span class="math">^{\\&amp;amp;}</span>  with dependent inputs). For a fixed rotation constant  <span class="math">r</span>  and  <span class="math">n</span> -bit input difference  <span class="math">\\alpha</span> , the DP of the bitwise AND operation is defined as</p>

    <div class="my-4 text-center"><span class="math-block"></span></div>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\mathrm {x d p} ^ {\\&amp;} (\\alpha , (\\alpha \\ll r) \\rightarrow \\gamma) = 2 ^ {- n} \\cdot \\left</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\left\\{x: (x \\wedge (x \\ll r)) \\oplus ((x \\oplus \\alpha) \\wedge ((x \\oplus \\alpha) \\ll r)) = \\gamma \\right\\}\\right</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">. \\tag {3}</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <div class="my-4 text-center"><span class="math-block"></span></div>

    <p class="text-gray-300">In the following part of this section we describe a method for the computation of the probability <span class="math">\\mathrm{xdp}^{\\&amp;}(\\alpha,(\\alpha\\lll r)\\to\\gamma)</span> (3) in linear time in the word size <span class="math">n</span>. We begin by stating several necessary definitions and lemmas.</p>

    <p class="text-gray-300">A <em>cycle</em> of <em>length</em> <span class="math">t</span> is a special subset of the set of indices <span class="math">\\mathcal{I}=\\{0,1,\\ldots,n-1\\}(=\\mathbf{Z}_{n})</span> indicating the bit positions of an <span class="math">n</span>-bit word <span class="math">x</span> (index 0 denotes the LS bit of <span class="math">x</span>). More formally:</p>

    <h6 id="sec-8" class="text-base font-medium mt-4">Definition 3</h6>

    <p class="text-gray-300">A cycle of length <span class="math">t</span> is a set of bit indices <span class="math">C_{i}=\\{i,i+r,i+2r,\\ldots,i+(t-1)r\\}\\subseteq\\mathcal{I}</span>, where <span class="math">t\\in\\mathbf{N}</span> is such that <span class="math">i+tr=i\\mod(n)</span> and <span class="math">i</span> is the smallest element of <span class="math">C_{i}</span>.</p>

    <p class="text-gray-300">In a cycle <span class="math">C_{i}</span> of length <span class="math">t</span>, <span class="math">i+(s-1)r</span> is said to be <em>preceding</em> element to <span class="math">i+sr</span> (<span class="math">1&lt;s&lt;t</span>). Moreover, <span class="math">i+(t-1)r</span> is <em>preceding</em> element to <span class="math">i</span>. Since each <span class="math">C_{i}</span> for <span class="math">i\\in\\mathcal{I}</span> is an equivalence class, <span class="math">\\mathcal{I}</span> can be partitioned into disjoint cycles:</p>

    <h6 id="sec-9" class="text-base font-medium mt-4">Lemma 1</h6>

    <p class="text-gray-300">For fixed <span class="math">r\\in\\mathcal{I}</span>, <span class="math">C_{i}\\cap C_{j}=\\emptyset</span> iff <span class="math">i\\neq j:\\ 0\\leq i,j&lt;n</span> and, <span class="math">\\mathcal{I}=\\bigcup C_{i}</span>.</p>

    <h6 id="sec-10" class="text-base font-medium mt-4">Example 1</h6>

    <p class="text-gray-300">For <span class="math">n=8</span> and <span class="math">r=2</span> there are exactly 2 cycles each having length <span class="math">t=4</span>: <span class="math">C_{0}=\\{0,2,4,6\\}</span> and <span class="math">C_{1}=\\{1,3,5,7\\}</span>.</p>

    <p class="text-gray-300">By Definition 2, computing the probability <span class="math">\\mathrm{xdp}^{\\&amp;}</span> is equivalent to counting the number of values <span class="math">x</span> that satisfy the differential <span class="math">(\\alpha,(\\alpha\\lll r)\\to\\gamma)</span>. For simplicity, let <span class="math">r</span> be such that the set of bit indices <span class="math">\\mathcal{I}</span> of <span class="math">x</span> has a single cycle <span class="math">C_{0}=\\{0,r,2r,\\ldots,n-r\\}</span>. Within this cycle the bits of the input and output differences are represented as a sequence of 3-tuples in the following way:</p>

    <p class="text-gray-300"><span class="math">(\\alpha_{0},\\alpha_{(n-r)},\\gamma_{0}),\\ (\\alpha_{r},\\alpha_{0},\\gamma_{r}),\\ (\\alpha_{2r},\\alpha_{r},\\gamma_{2r}),\\ldots,(\\alpha_{(n-r)},\\alpha_{(t-1)r},\\gamma_{(n-r)})\\ \\ .</span> (4)</p>

    <p class="text-gray-300">Note that in sequence(4), for each 3-tuple the index of the second element is a preceding index of the index of the first element.</p>

    <h6 id="sec-11" class="text-base font-medium mt-4">Example 2</h6>

    <p class="text-gray-300">Let <span class="math">n=5</span> and <span class="math">r=2</span>. Consider the input differences <span class="math">\\alpha=\\alpha_{4}\\alpha_{3}\\alpha_{2}\\alpha_{1}\\alpha_{0}</span> and <span class="math">(\\alpha\\lll 2)=\\alpha_{2}\\alpha_{1}\\alpha_{0}\\alpha_{4}\\alpha_{3}</span> and the output difference <span class="math">\\gamma=\\gamma_{4}\\gamma_{3}\\gamma_{2}\\gamma_{1}\\gamma_{0}</span>. In this case there is a single cycle <span class="math">C_{0}</span> of length <span class="math">t=5</span>: <span class="math">C_{0}=\\{0,1,2,3,4\\}</span>. The corresponding sequence of 3-tuples is:</p>

    <p class="text-gray-300"><span class="math">(\\alpha_{0},\\alpha_{3},\\gamma_{0}),\\ (\\alpha_{2},\\alpha_{0},\\gamma_{2}),\\ (\\alpha_{4},\\alpha_{2},\\gamma_{4}),\\ (\\alpha_{1},\\alpha_{4},\\gamma_{1}),\\ (\\alpha_{3},\\alpha_{1},\\gamma_{3})\\ \\ .</span> (5)</p>

    <p class="text-gray-300">The difference 3-tuples in (4) are satisfied by a number of possible bit assignments of <span class="math">x</span> at the corresponding positions: <span class="math">(x_{0},x_{n-r}),\\ (x_{r},x_{0}),\\ (x_{2r},x_{r}),\\ldots,(x_{n-r},x_{(t-1)r})</span>. In order to efficiently count the number of such assignments we use a variant of the technique proposed in <em>[16]</em> for the computation of the DP of modular addition and XOR.</p>

    <p class="text-gray-300">Any 2-tuple of bits of the form <span class="math">(x_{sr},x_{(s-1)r})</span> can have 4 values <span class="math">\\{(0,0),(0,1),(1,0),(1,1)\\}</span>, where <span class="math">(0\\leq s\\leq n-1)</span>. These are viewed as a nodes of a graph. In total, for the full word length <span class="math">n</span> the graph has <span class="math">4n</span> nodes. A <em>valid</em> assignment of two consecutive 2-tuples <span class="math">(x_{sr},x_{(s-1)r})</span> and <span class="math">(x_{(s+1)r},x_{sr})</span>, <span class="math">(0\\leq s&lt;n-1)</span> is represented as a directed edge between the corresponding nodes. In this way we can construct a <em>directed acyclic graph</em> (DAG) composed of <span class="math">(n-1)</span> edge-disjoint <em>bipartite</em> subgraphs. Each bipartite subgraph is formed by the nodes from two consecutive 2-tuples of bits of <span class="math">x</span> and the edges between them. A <em>valid</em> path from an initial node <span class="math">(x_{0},x_{n-r})</span> to a final node <span class="math">(x_{n-r},x_{n-2r})</span> in the DAG corresponds to a value of <span class="math">x</span> that satisfies the differential <span class="math">(\\alpha,(\\alpha\\lll r)\\to\\gamma)</span>. A path is said to be <em>valid</em> iff the initial and final nodes <span class="math">(x_{0},x_{n-r})</span> and <span class="math">(x_{n-r},x_{n-2r})</span> are consistent i.e. the value assigned to <span class="math">x_{n-r}</span> in both nodes is the same.</p>

    <p class="text-gray-300">The DAG constructed as explained above is represented as a sequence of  <span class="math">4 \\times 4</span>  adjacency matrices, each corresponding to one bipartite subgraph. Computing the probability  <span class="math">\\mathrm{xdp}^{\\wedge}</span>  is then equivalent to counting the number of valid paths in the DAG. This can be performed in linear time in the word size by a sequence of  <span class="math">(n - 1)</span>  multiplications of adjacency matrices. If the number of such paths is  <span class="math">N</span> , the final probability  <span class="math">\\mathrm{xdp}^{\\&amp;amp;}(\\alpha, \\beta \\to \\gamma)</span>  is  <span class="math">\\frac{N}{2^n}</span> . This process is further illustrated with the Example 3.</p>

    <p class="text-gray-300">In case of more than one cycle the described process can be performed independently for each cycle  <span class="math">C^j, 0 \\leq j &amp;lt; m</span>  due to the fact that all cycles are disjoint (cf. Lemma 1). Let  <span class="math">N_j</span>  be the number of paths in the DAG for the  <span class="math">j</span> -th cycle. Then the DP is given by  <span class="math">\\frac{\\prod_{i}^{m} N_j}{2^n}</span> .</p>

    <p class="text-gray-300">Example 3. Assume the same setting as in Example 2:  <span class="math">n = 5</span> ,  <span class="math">r = 2</span>  and let  <span class="math">\\alpha = 00110_2</span>  and  <span class="math">\\gamma = 00000_2</span> . Consider the resulting sequence of 3-tuples (5). In the DAG (Fig 1), the dependency between the bits of  <span class="math">x</span>  corresponding to two consecutive 3-tuples must be satisfied. For example, an edge between  <span class="math">(x_0, x_3) = (0, 1)</span>  corresponding to  <span class="math">(\\alpha_0, \\alpha_3, \\gamma_0) = (1, 0, 0)</span>  and  <span class="math">(x_2, x_0) = (1, 0)</span>  corresponding to  <span class="math">(\\alpha_2, \\alpha_0, \\gamma_2) = (0, 1, 0)</span>  is drawn, because  <span class="math">x_0 = 0</span>  for both the nodes. However there is no edge between  <span class="math">(x_2, x_0) = (0, 0)</span>  and  <span class="math">(x_4, x_2) = (0, 1)</span>  since,  <span class="math">x_0</span>  is not equal for both the nodes. A valid path from an initial node (corresponding to the first 3-tuple  <span class="math">(\\alpha_0, \\alpha_3, \\gamma_0)</span>  in the sequence (5))</p>

    <p class="text-gray-300">!<a href="img-0.jpeg">img-0.jpeg</a> Fig. 1. DAG used in the computation of  <span class="math">\\mathrm{xdp}^{\\&amp;amp;}(\\alpha, (\\alpha \\ll r) \\to \\gamma)</span>  for  <span class="math">n = 5</span> ,  <span class="math">r = 2</span> ,  <span class="math">\\alpha = 00110_2</span> ,  <span class="math">\\gamma = 00000_2</span> . Every path composed of thick edges is a valid path and hence a valid assignment of bits of  <span class="math">x</span> . The fading nodes denote the bit assignments of  <span class="math">x</span>  which do not satisfy the input output difference</p>

    <p class="text-gray-300">to a final node (corresponding to the last 3-tuple  <span class="math">(\\alpha_{3},\\alpha_{1},\\gamma_{3}))</span>  in this graph is equivalent to a value of  <span class="math">x</span>  that satisfies the differential. A valid path implies that the initial and final nodes are consistent with each other. For example, no path from the initial node  <span class="math">(x_0,x_3) = (0,1)</span>  is valid, because, all final node have  <span class="math">x_{3} = 0</span> . Since the total number of valid paths in the graph is  <span class="math">N = 4</span>  the DP is  <span class="math">\\frac{4}{2^5} = 0.125</span> .</p>

    <p class="text-gray-300">The method for the computation of the probability  <span class="math">\\mathrm{xdp}^{\\&amp;amp;}(\\alpha, \\beta \\to \\gamma)</span>  described above supports the following proposition.</p>

    <p class="text-gray-300">Proposition 1. For fixed  <span class="math">n</span> -bit differences  <span class="math">\\alpha</span>  and  <span class="math">\\gamma</span> , the probability  <span class="math">\\mathrm{xdp}^{\\&amp;amp;}(\\alpha, (\\alpha \\ll r) \\to \\gamma)</span>  can be computed in  <span class="math">\\mathcal{O}(n)</span>  time.</p>

    <p class="text-gray-300">Impossible Input-Output Difference For a given <span class="math">(\\alpha, \\gamma)</span> an impossible difference can be of two types. Any input/output difference which leads to a difference 3-tuple <span class="math">(\\alpha_i, \\alpha_{i-r}, \\gamma_i) = (0,0,1)</span>, is an impossible input/output difference. The other types of input difference can be detected while computing the probability of the corresponding difference. Note that in the corresponding DAG, a path can be invalid even if every bipartite directed subgraph valid, e.g. <span class="math">(\\alpha, \\gamma) = (11111_2, 00000_2)</span>. The following DAG shows this case.</p>

    <p class="text-gray-300">!<a href="img-1.jpeg">img-1.jpeg</a> Fig. 2. DAG used in the computation of <span class="math">\\mathrm{xdp}^{\\&amp;amp;}(11111_2, (11111_2 \\ll 2) \\to 00000_2)</span>. Both the paths, composed of thick edges and dashed edges, are invalid path, since there is contradiction in the bit value <span class="math">x_3</span>. However, each directed bipartite subgraph is independently valid.</p>

    <p class="text-gray-300">Proposition 2. For a fixed <span class="math">n</span>-bit input difference <span class="math">\\alpha</span> and rotation <span class="math">r</span>,</p>

    <div class="my-4 text-center"><span class="math-block">\\mathrm{DP}_{\\max}(\\alpha) = \\max_{\\gamma} \\mathrm{xdp}^{\\&amp;amp;}(\\alpha, \\alpha \\ll r \\rightarrow \\gamma) \\tag{6}</span></div>

    <p class="text-gray-300">can be computed in <span class="math">\\mathcal{O}(n)</span> time.</p>

    <p class="text-gray-300">Finally, we note that the approach described above bears some similarity to the technique proposed in [16] for the computation of the DP of modular addition and XOR. Similarly to [16] we also map the problem of computing differential probabilities to the well-studied problem in graph theory of counting the number of paths in a graph. Apart from this similarity however, we would like to stress that the described method is fundamentally different than [16]. In the latter the nodes of the graph represent information that is propagated over the bit positions (namely, the carries and borrows resulting from the modular addition) and the edges represent the actual values of the pairs. In our case, the nodes of the graph represent the values of the pairs, while the edges describe the valid connections between the bits of those values so that the correct dependence due to the rotation operation is preserved.</p>

    <h2 id="sec-13" class="text-2xl font-bold">3.1 Threshold Search</h2>

    <p class="text-gray-300">In [15] Matsui proposed a practical algorithm for finding the best differential trail for the DES block cipher. Given the best trail on <span class="math">i</span> rounds and an over-estimation of the best probability for <span class="math">i + 1</span></p>

    <p class="text-gray-300">rounds the algorithm finds the best trail on <span class="math">i+1</span> rounds. Starting from <span class="math">i=1</span> these steps are repeated recursively until <span class="math">i+1=n</span>. In the process, the differential probabilities of the non-linear components of the target cipher (the S-boxes in the case of DES) are obtained from a pre-computed difference distribution table (DDT). The differentials for the <span class="math">i</span>-th round are then processed in sorted order by probability. For each, the recursion proceeds to round <span class="math">i+1</span>) only if the estimated probability of the trail for <span class="math">n</span> rounds is equal to- or greater than the initial estimate.</p>

    <p class="text-gray-300">Recently, in <em>[6]</em> a variant of Matsui’s algorithm is proposed which is applicable to the class of ARX ciphers. What is special about the latter is that they do not have S-boxes. Instead they rely on basic arithmetic operations such as addition modulo <span class="math">n</span> to achieve non-linearity. Computing a full DDT for the modular addition operation would require <span class="math">4\\times 2^{3n}</span> bytes of memory and is therefore impractical for <span class="math">n&gt;16</span>. To address this, in <em>[6]</em> a partial DDT (pDDT) rather than the full DDT is computed. A pDDT contains (a fraction of) all differentials that have probability above a fixed probability threshold (hence the name – threshold search).</p>

    <p class="text-gray-300">Since some (possibly many) differentials are missing from the initial (also called primary) pDDT, at some point during the search it is likely that for a given input difference the algorithm will require a matching differential that is not present in the primary pDDT. Such differentials are computed on-demand and are stored in a secondary pDDT maintained dynamically during the search.</p>

    <p class="text-gray-300">In order to prevent the size of the secondary pDDT from exploding while at the same time keeping the probability of the constructed trails high, <em>[6]</em> further introduce the notion of highways and country roads – resp. high and low probability differentials (w.r.t. the fixed threshold). Every differential from the primary pDDT is a highway while every differential from the secondary pDDT is a country road.</p>

    <p class="text-gray-300">To further control the size of the country roads table, additional restrictions on the considered differences can be added. For example, it may be required that every country road at given round <span class="math">i</span> is such that there is at least one transition at round <span class="math">i+1</span> that is a highway. This reduces the number of possible country roads while at the same time ensures that the considered paths have relatively high probability. This condition has been applied in the trail search for Simon. Another restriction can be on the Hamming weight of the considered differences. Such restriction has been applied in the differential search on Speck.</p>

    <p class="text-gray-300">Several parameters control the performance of the threshold search technique. The most important ones are the probability threshold, which determines which differentials are considered as highways and the maximum size of the primary pDDT (note that it may be infeasible to compute and/or store all differentials that have probability above the threshold). The probability threshold influences the probability of the final trail: the lower the threshold, the more paths are considered and hence the more likely to find a high probability trail. At the same time, with the increase of the number of explored paths, the complexity of the algorithm also grows and hence it takes longer to terminate. The maximum size of the primary pDDT determines the precomputation time and the memory requirements for the algorithm.</p>

    <h3 id="sec-14" class="text-xl font-semibold mt-8">3.2 Extension to Differentials</h3>

    <p class="text-gray-300">We further extend the method outlined above to the case of differentials. Given the best trail found by the threshold search and the corresponding array of best found probabilities for each round, a differential search proceeds according to the above strategy but always starting from the same input difference (corresponding to the best found trail). At every round are explored only paths whose</p>

    <p class="text-gray-300">estimated probabilities are by at most a factor  <span class="math">\\varepsilon</span>  away from best probability (e.g.  <span class="math">\\varepsilon = 2^{-15}</span> ). For example, let  <span class="math">B_{i}: 1 \\leq i \\leq n</span>  be the probabilities of the best found differentials resp. for  <span class="math">1, 2, \\ldots, n</span>  rounds computed with the threshold search. Denote with  <span class="math">p_{1}, p_{2}, \\ldots, p_{r-1}</span>  the probabilities of a partially constructed trail up to round  <span class="math">r-1</span> . At round  <span class="math">r</span>  the differential search will explore all transitions that have probability  <span class="math">p_{r} \\geq (\\varepsilon B_{n}) / (p_{1} \\ldots p_{r-1} B_{n-r})</span> . A pseudocode of this procedure applied to SIMON is listed in Algorithm 1.</p>

    <p class="text-gray-300">Algorithm 1 Search for clusters of trails belonging to the same differential. Input:  <span class="math">\\mathbf{T} = (\\mathbf{T}_0,\\dots ,\\mathbf{T}_n)</span>  : the best found trail for  <span class="math">n</span>  rounds with prob.  <span class="math">B_{n}</span>  .  <span class="math">\\mathbf{B} = (\\mathbf{B_1},\\mathbf{B_2},\\dots ,\\mathbf{B}_n)</span>  : prob. of best found trails for up to  <span class="math">n</span>  rounds; r: current round; H: pDDT (the highway table) for the non-linear component  <span class="math">f</span>  of the round function (e.g. for SIMON  <span class="math">f(x) = (x\\ll 1)\\wedge (x\\ll 8)</span>  ; for SPECK  <span class="math">f</span>  is the modular addition);  <span class="math">\\varepsilon</span>  : the algorithm searches for trails with prob. at most  <span class="math">\\varepsilon</span>  times worse than the best found prob. Output: Cluster of trails  <span class="math">\\Omega</span>  for the differential  <span class="math">(T_0 = (\\alpha_0,\\beta_0)\\to T_n = (\\alpha_n,\\beta_n))</span>  and probability  <span class="math">p_{\\Omega}(T_0\\rightarrow T_n)\\geq B_n</span> 1:  <span class="math">(\\alpha_0,\\beta_0)\\gets T_0</span>  .  <span class="math">(\\alpha_{n},\\beta_{n})\\gets T_{n}</span>  .  <span class="math">\\Omega \\leftarrow T</span>  .  <span class="math">T\\gets \\emptyset</span>  .  <span class="math">p_{\\Omega}\\gets B_{n}</span>  .  <span class="math">r\\gets 1 / /</span>  Initialization 2: procedure cluster_trails(n,r,  <span class="math">\\alpha_{r - 1},\\beta_{r - 1},H,T,\\Omega ,p_{\\Omega})</span>  do 3: if  <span class="math">r = n</span>  then 4: // If at last round and trail matches output diff. add it to cluster and update the probability 5: if  <span class="math">T_{n} = (\\alpha_{n},\\beta_{n})</span>  then 6: add  <span class="math">T</span>  to  <span class="math">\\Omega</span>  .  <span class="math">p_{\\Omega}\\gets p_{\\Omega} + \\overline{B}_{n}</span>  .  <span class="math">T\\gets \\emptyset</span> 7: return 8: if  <span class="math">r = 0</span>  then 9:  <span class="math">p_0 = 1</span>  .  <span class="math">T\\gets T_0 = (\\alpha_0,\\beta_0,p_0)</span> 10:  <span class="math">C\\gets \\emptyset</span>  // Initialize the country roads table 11:  <span class="math">p_{r,\\min}\\gets (\\varepsilon B_n) / (p_1p_2\\dots p_{r - 1}B_{n - r})</span>  // The min. permissible probability for the new trail 12: for all  <span class="math">\\gamma_r:(p_r(\\alpha_{r - 1}\\xrightarrow{f}\\gamma_r)\\geq p_{r,\\min})\\wedge ((\\alpha_{r - 1},\\gamma_r,p_r)\\notin H)</span>  do 13: add  <span class="math">(\\alpha_{r - 1},\\gamma_r,p_r)</span>  to  <span class="math">C</span>  // Update country roads table 14: for all  <span class="math">(\\alpha ,\\gamma ,p):\\alpha = \\alpha_{r - 1}</span>  in  <span class="math">H</span>  and all  <span class="math">(\\alpha ,\\gamma ,p)</span>  in  <span class="math">C</span>  do 15:  <span class="math">p_r\\gets p,\\quad \\overline{B}_n\\gets p_1p_2\\dots p_rB_{n - r}</span> 16: // Proceed to next round only if the estimated prob. is at most  <span class="math">\\varepsilon</span>  times worse than the best 17: if  <span class="math">\\overline{B}_n\\geq (\\varepsilon B_n)</span>  then 18:  <span class="math">\\alpha_r = \\gamma_r\\oplus \\beta_{r - 1}\\oplus (\\alpha_{r - 1}\\ll 2);\\beta_r\\gets \\alpha_{r - 1}</span> 19: add  <span class="math">T_{r} = (\\alpha_{r},\\beta_{r},p_{r})</span>  to  <span class="math">T</span> 20: call cluster_trails(n,r+1,  <span class="math">\\alpha_r,\\beta_r,H,T,\\Omega ,p_\\Omega)</span> 21: return  <span class="math">\\Omega ,p_{\\Omega}</span></p>

    <p class="text-gray-300">Note that a somewhat similar branch-and-bound approach has been applied by [3,2,1] to search for differentials in SIMON. The main difference is that according to the cited technique, at every round is maintained an array of the best differentials encountered so far ranked by probability. The search proceeds to the next round by considering the top  <span class="math">N</span>  such differentials.</p>

    <p class="text-gray-300">In our approach instead of storing intermediate differentials, we prune the search tree by limiting the search to an  <span class="math">\\varepsilon</span>  region within the best found probability, since the latter is already known from the threshold search.</p>

    <p class="text-gray-300">Note that although the proposed technique searches for differentials starting with best trail found with the threshold search, it can easily be modified to search for multiple input and output differences, while keeping track of the best one. Finally, in order to improve the efficiency, the differential search can be further parametrized by limiting the maximum Hamming weight of the differences.</p>

    <p class="text-gray-300">The SIMON and SPECK families of lightweight block ciphers are defined for word sizes <span class="math">n=16,24,32,48</span> and <span class="math">64</span> bits. The key is composed of <span class="math">m</span> <span class="math">n</span>-bit words for <span class="math">m=2,3,4</span> (i.e. the key size <span class="math">mn</span> varies between <span class="math">64</span> and <span class="math">256</span> bits) depending on the word size <span class="math">n</span>. The block cipher instances corresponding to a fixed word size <span class="math">n</span> (block size <span class="math">2n</span>) and key size <span class="math">mn</span> are denoted by <span class="math">\\textsc{Simon}2n/mn</span> and <span class="math">\\textsc{Speck}2n/mn</span>.</p>

    <p class="text-gray-300">!<a href="img-2.jpeg">img-2.jpeg</a> Fig. 3. SIMON round function</p>

    <p class="text-gray-300">!<a href="img-3.jpeg">img-3.jpeg</a> Fig. 4. SPECK round function</p>

    <p class="text-gray-300">Block cipher SIMON has Feistel structure and its round function under a fixed round key <span class="math">k</span> is defined on inputs <span class="math">x</span> and <span class="math">y</span> as:</p>

    <p class="text-gray-300"><span class="math">R_{k}(x,y)=((y\\oplus f(x)\\oplus k),x)\\enspace.</span> (7)</p>

    <p class="text-gray-300">The function <span class="math">f(\\cdot)</span> is defined as <span class="math">f(x)=((x\\lll 1)\\land(x\\lll 8))\\oplus(x\\lll 2)</span>, where the symbol <span class="math">\\land</span> denotes the logical AND operation.</p>

    <p class="text-gray-300">Block cipher SPECK has structure similar to Threefish – the block cipher used in the hash function Skein <em>[9]</em>. Its round function under a fixed round key <span class="math">k</span> is defined on inputs <span class="math">x</span> and <span class="math">y</span> as:</p>

    <p class="text-gray-300"><span class="math">R_{k}(x,y)=(f_{k}(x,y),\\ f_{k}(x,y)\\oplus(y\\lll\\beta))\\enspace,</span> (8)</p>

    <p class="text-gray-300">where the function <span class="math">f_{k}(\\cdot,\\cdot)</span> is defined as <span class="math">f_{k}(x,y)=((x\\ggg\\alpha)+y)\\oplus k</span>. The rotation constants are <span class="math">\\alpha=7,\\beta=2</span> for block size <span class="math">32</span> bits and <span class="math">\\alpha=8,\\beta=3</span> for all other block sizes. Although SPECK is not a Feistel cipher itself, it can be represented as a composition of two Feistel maps as described in <em>[4]</em>. The round functions of SIMON and SPECK are shown in Fig. 3 and Fig. 4 respectively. The number of rounds, block size and key size of the block ciphers are summarized in the following table</p>

    <h2 id="sec-16" class="text-2xl font-bold">5 Application to SIMON and SPECK</h2>

    <p class="text-gray-300">The trails obtained by using the threshold search technique and the differentials found with differential search tool (both described in Sect. 3) are presented in this section. The best found trails for SIMON and SPECK are shown respectively on Table 5 and Table 6. In the tables, <span class="math">\\sum_{r}\\log_{2}p_{r}</span></p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Block size</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Key size</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Key words</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Rounds</th>

          </tr>

        </thead>

        <tbody>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">32</td>

            <td class="px-3 py-2 border-b border-gray-700">64</td>

            <td class="px-3 py-2 border-b border-gray-700">4</td>

            <td class="px-3 py-2 border-b border-gray-700">32</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">48</td>

            <td class="px-3 py-2 border-b border-gray-700">72</td>

            <td class="px-3 py-2 border-b border-gray-700">3</td>

            <td class="px-3 py-2 border-b border-gray-700">36</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">96</td>

            <td class="px-3 py-2 border-b border-gray-700">4</td>

            <td class="px-3 py-2 border-b border-gray-700">36</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">64</td>

            <td class="px-3 py-2 border-b border-gray-700">96</td>

            <td class="px-3 py-2 border-b border-gray-700">3</td>

            <td class="px-3 py-2 border-b border-gray-700">42</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">128</td>

            <td class="px-3 py-2 border-b border-gray-700">4</td>

            <td class="px-3 py-2 border-b border-gray-700">44</td>

          </tr>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">Table 3. Parameters for SIMON</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Block size</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Key size</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Key words</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Rounds</th>

          </tr>

        </thead>

        <tbody>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">32</td>

            <td class="px-3 py-2 border-b border-gray-700">64</td>

            <td class="px-3 py-2 border-b border-gray-700">4</td>

            <td class="px-3 py-2 border-b border-gray-700">22</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">48</td>

            <td class="px-3 py-2 border-b border-gray-700">72</td>

            <td class="px-3 py-2 border-b border-gray-700">3</td>

            <td class="px-3 py-2 border-b border-gray-700">22</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">96</td>

            <td class="px-3 py-2 border-b border-gray-700">4</td>

            <td class="px-3 py-2 border-b border-gray-700">23</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">64</td>

            <td class="px-3 py-2 border-b border-gray-700">96</td>

            <td class="px-3 py-2 border-b border-gray-700">3</td>

            <td class="px-3 py-2 border-b border-gray-700">26</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">128</td>

            <td class="px-3 py-2 border-b border-gray-700">4</td>

            <td class="px-3 py-2 border-b border-gray-700">27</td>

          </tr>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">Table 4. Parameters for SPECK</p>

    <p class="text-gray-300">represents the probability of a single trail obtained as the sum of the probabilities of its transitions;  <span class="math">p_{\\mathrm{diff}}</span>  is the probability of the corresponding differential and #trails is the number of trails clustered in the differential; max HW is the maximum Hamming weight allowed for the differences during the search;  <span class="math">p_{\\mathrm{thres}}</span>  is the probability threshold used in the threshold search algorithm and pDDT denotes the number of elements in the partial DDT.</p>

    <p class="text-gray-300">Note that all trails shown in Table 5 and Table 6 were found using the technique described in Sect. 3 by starting the search from the top round and proceeding downwards. The only exception is the trail on SPECK48. Since this trail begins with a very low probability transition, when starting the search from the first round, it was computationally feasible to construct the shown trail only up to round 6. The full trail on 11 rounds shown in Table 6 was found by starting the search from a middle round (round 6) as has also been done in [1].</p>

    <p class="text-gray-300">The clustering of multiple trails satisfying the same input/output difference (differential effect) in SIMON can be visualized by the digraph in Fig. 9. It depicts a cluster of more than 275000 trails satisfying the 21 round differential (4000000, 11000000)  <span class="math">\\xrightarrow{21R}</span>  (11000000, 4000000). The thickness of an edge in the digraph is proportional to the probability of the corresponding input and output difference connected by this edge.</p>

    <p class="text-gray-300">An interesting property clearly visible in the digraph in Fig. 9 is that it is composed of multiple smaller subgraphs positioned at alternate levels. Each such subgraph represents a biclique. Clearly, the bigger the number and size of such bicliques, the stronger the differential effect would be and hence the larger the probability of the differential. Therefore, the ability to obtain good estimation of the probability of a given differential for SIMON is intimately related to the ability to identify and characterize such complete bipartite subgraphs. Thus we take a closer look into those special structures below.</p>

    <p class="text-gray-300">!<a href="img-4.jpeg">img-4.jpeg</a> Fig. 5. Example of a bipartite subgraph embedded in the differential (graph) of SIMON32.</p>

    <p class="text-gray-300">Table 5. Differential trails for SIMON32, SIMON48 and SIMON64.</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">SIMON32</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">SIMON32</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">SIMON48</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">SIMON64</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

          </tr>

        </thead>

        <tbody>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">r</td>

            <td class="px-3 py-2 border-b border-gray-700">ΔL</td>

            <td class="px-3 py-2 border-b border-gray-700">ΔR</td>

            <td class="px-3 py-2 border-b border-gray-700">log2p</td>

            <td class="px-3 py-2 border-b border-gray-700">ΔL</td>

            <td class="px-3 py-2 border-b border-gray-700">ΔR</td>

            <td class="px-3 py-2 border-b border-gray-700">log2p</td>

            <td class="px-3 py-2 border-b border-gray-700">ΔL</td>

            <td class="px-3 py-2 border-b border-gray-700">ΔR</td>

            <td class="px-3 py-2 border-b border-gray-700">log2p</td>

            <td class="px-3 py-2 border-b border-gray-700">ΔL</td>

            <td class="px-3 py-2 border-b border-gray-700">ΔR</td>

            <td class="px-3 py-2 border-b border-gray-700">log2p</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">0</td>

            <td class="px-3 py-2 border-b border-gray-700">400</td>

            <td class="px-3 py-2 border-b border-gray-700">1900</td>

            <td class="px-3 py-2 border-b border-gray-700">-0</td>

            <td class="px-3 py-2 border-b border-gray-700">0</td>

            <td class="px-3 py-2 border-b border-gray-700">40</td>

            <td class="px-3 py-2 border-b border-gray-700">-0</td>

            <td class="px-3 py-2 border-b border-gray-700">200020</td>

            <td class="px-3 py-2 border-b border-gray-700">80088</td>

            <td class="px-3 py-2 border-b border-gray-700">-0</td>

            <td class="px-3 py-2 border-b border-gray-700">4000000</td>

            <td class="px-3 py-2 border-b border-gray-700">11000000</td>

            <td class="px-3 py-2 border-b border-gray-700">-0</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">1</td>

            <td class="px-3 py-2 border-b border-gray-700">100</td>

            <td class="px-3 py-2 border-b border-gray-700">400</td>

            <td class="px-3 py-2 border-b border-gray-700">-2</td>

            <td class="px-3 py-2 border-b border-gray-700">40</td>

            <td class="px-3 py-2 border-b border-gray-700">0</td>

            <td class="px-3 py-2 border-b border-gray-700">-0</td>

            <td class="px-3 py-2 border-b border-gray-700">880008</td>

            <td class="px-3 py-2 border-b border-gray-700">200020</td>

            <td class="px-3 py-2 border-b border-gray-700">-4</td>

            <td class="px-3 py-2 border-b border-gray-700">1000000</td>

            <td class="px-3 py-2 border-b border-gray-700">4000000</td>

            <td class="px-3 py-2 border-b border-gray-700">-2</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">2</td>

            <td class="px-3 py-2 border-b border-gray-700">0</td>

            <td class="px-3 py-2 border-b border-gray-700">100</td>

            <td class="px-3 py-2 border-b border-gray-700">-2</td>

            <td class="px-3 py-2 border-b border-gray-700">100</td>

            <td class="px-3 py-2 border-b border-gray-700">40</td>

            <td class="px-3 py-2 border-b border-gray-700">-2</td>

            <td class="px-3 py-2 border-b border-gray-700">2</td>

            <td class="px-3 py-2 border-b border-gray-700">880008</td>

            <td class="px-3 py-2 border-b border-gray-700">-6</td>

            <td class="px-3 py-2 border-b border-gray-700">0</td>

            <td class="px-3 py-2 border-b border-gray-700">1000000</td>

            <td class="px-3 py-2 border-b border-gray-700">-2</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">3</td>

            <td class="px-3 py-2 border-b border-gray-700">100</td>

            <td class="px-3 py-2 border-b border-gray-700">0</td>

            <td class="px-3 py-2 border-b border-gray-700">-0</td>

            <td class="px-3 py-2 border-b border-gray-700">440</td>

            <td class="px-3 py-2 border-b border-gray-700">100</td>

            <td class="px-3 py-2 border-b border-gray-700">-2</td>

            <td class="px-3 py-2 border-b border-gray-700">880000</td>

            <td class="px-3 py-2 border-b border-gray-700">2</td>

            <td class="px-3 py-2 border-b border-gray-700">-2</td>

            <td class="px-3 py-2 border-b border-gray-700">1000000</td>

            <td class="px-3 py-2 border-b border-gray-700">0</td>

            <td class="px-3 py-2 border-b border-gray-700">-0</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">4</td>

            <td class="px-3 py-2 border-b border-gray-700">400</td>

            <td class="px-3 py-2 border-b border-gray-700">100</td>

            <td class="px-3 py-2 border-b border-gray-700">-2</td>

            <td class="px-3 py-2 border-b border-gray-700">1000</td>

            <td class="px-3 py-2 border-b border-gray-700">440</td>

            <td class="px-3 py-2 border-b border-gray-700">-4</td>

            <td class="px-3 py-2 border-b border-gray-700">200000</td>

            <td class="px-3 py-2 border-b border-gray-700">880000</td>

            <td class="px-3 py-2 border-b border-gray-700">-4</td>

            <td class="px-3 py-2 border-b border-gray-700">4000000</td>

            <td class="px-3 py-2 border-b border-gray-700">1000000</td>

            <td class="px-3 py-2 border-b border-gray-700">-2</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">5</td>

            <td class="px-3 py-2 border-b border-gray-700">1100</td>

            <td class="px-3 py-2 border-b border-gray-700">400</td>

            <td class="px-3 py-2 border-b border-gray-700">-2</td>

            <td class="px-3 py-2 border-b border-gray-700">4440</td>

            <td class="px-3 py-2 border-b border-gray-700">1000</td>

            <td class="px-3 py-2 border-b border-gray-700">-2</td>

            <td class="px-3 py-2 border-b border-gray-700">80000</td>

            <td class="px-3 py-2 border-b border-gray-700">200000</td>

            <td class="px-3 py-2 border-b border-gray-700">-2</td>

            <td class="px-3 py-2 border-b border-gray-700">11000000</td>

            <td class="px-3 py-2 border-b border-gray-700">4000000</td>

            <td class="px-3 py-2 border-b border-gray-700">-2</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">6</td>

            <td class="px-3 py-2 border-b border-gray-700">4200</td>

            <td class="px-3 py-2 border-b border-gray-700">1100</td>

            <td class="px-3 py-2 border-b border-gray-700">-4</td>

            <td class="px-3 py-2 border-b border-gray-700">101</td>

            <td class="px-3 py-2 border-b border-gray-700">4440</td>

            <td class="px-3 py-2 border-b border-gray-700">-6</td>

            <td class="px-3 py-2 border-b border-gray-700">0</td>

            <td class="px-3 py-2 border-b border-gray-700">80000</td>

            <td class="px-3 py-2 border-b border-gray-700">-2</td>

            <td class="px-3 py-2 border-b border-gray-700">60000000</td>

            <td class="px-3 py-2 border-b border-gray-700">11000000</td>

            <td class="px-3 py-2 border-b border-gray-700">-4</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">7</td>

            <td class="px-3 py-2 border-b border-gray-700">1D01</td>

            <td class="px-3 py-2 border-b border-gray-700">4200</td>

            <td class="px-3 py-2 border-b border-gray-700">-4</td>

            <td class="px-3 py-2 border-b border-gray-700">4044</td>

            <td class="px-3 py-2 border-b border-gray-700">101</td>

            <td class="px-3 py-2 border-b border-gray-700">-4</td>

            <td class="px-3 py-2 border-b border-gray-700">80000</td>

            <td class="px-3 py-2 border-b border-gray-700">0</td>

            <td class="px-3 py-2 border-b border-gray-700">-0</td>

            <td class="px-3 py-2 border-b border-gray-700">51000001</td>

            <td class="px-3 py-2 border-b border-gray-700">60000000</td>

            <td class="px-3 py-2 border-b border-gray-700">-4</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">8</td>

            <td class="px-3 py-2 border-b border-gray-700">500</td>

            <td class="px-3 py-2 border-b border-gray-700">1D01</td>

            <td class="px-3 py-2 border-b border-gray-700">-8</td>

            <td class="px-3 py-2 border-b border-gray-700">10</td>

            <td class="px-3 py-2 border-b border-gray-700">4044</td>

            <td class="px-3 py-2 border-b border-gray-700">-6</td>

            <td class="px-3 py-2 border-b border-gray-700">200000</td>

            <td class="px-3 py-2 border-b border-gray-700">80000</td>

            <td class="px-3 py-2 border-b border-gray-700">-2</td>

            <td class="px-3 py-2 border-b border-gray-700">4000004</td>

            <td class="px-3 py-2 border-b border-gray-700">51000001</td>

            <td class="px-3 py-2 border-b border-gray-700">-8</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">9</td>

            <td class="px-3 py-2 border-b border-gray-700">100</td>

            <td class="px-3 py-2 border-b border-gray-700">500</td>

            <td class="px-3 py-2 border-b border-gray-700">-3</td>

            <td class="px-3 py-2 border-b border-gray-700">4004</td>

            <td class="px-3 py-2 border-b border-gray-700">10</td>

            <td class="px-3 py-2 border-b border-gray-700">-2</td>

            <td class="px-3 py-2 border-b border-gray-700">880000</td>

            <td class="px-3 py-2 border-b border-gray-700">200000</td>

            <td class="px-3 py-2 border-b border-gray-700">-2</td>

            <td class="px-3 py-2 border-b border-gray-700">41000011</td>

            <td class="px-3 py-2 border-b border-gray-700">4000004</td>

            <td class="px-3 py-2 border-b border-gray-700">-4</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">10</td>

            <td class="px-3 py-2 border-b border-gray-700">100</td>

            <td class="px-3 py-2 border-b border-gray-700">100</td>

            <td class="px-3 py-2 border-b border-gray-700">-2</td>

            <td class="px-3 py-2 border-b border-gray-700">1</td>

            <td class="px-3 py-2 border-b border-gray-700">4004</td>

            <td class="px-3 py-2 border-b border-gray-700">-4</td>

            <td class="px-3 py-2 border-b border-gray-700">2</td>

            <td class="px-3 py-2 border-b border-gray-700">880000</td>

            <td class="px-3 py-2 border-b border-gray-700">-4</td>

            <td class="px-3 py-2 border-b border-gray-700">0</td>

            <td class="px-3 py-2 border-b border-gray-700">41000011</td>

            <td class="px-3 py-2 border-b border-gray-700">-8</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">11</td>

            <td class="px-3 py-2 border-b border-gray-700">500</td>

            <td class="px-3 py-2 border-b border-gray-700">100</td>

            <td class="px-3 py-2 border-b border-gray-700">-2</td>

            <td class="px-3 py-2 border-b border-gray-700">4000</td>

            <td class="px-3 py-2 border-b border-gray-700">1</td>

            <td class="px-3 py-2 border-b border-gray-700">-2</td>

            <td class="px-3 py-2 border-b border-gray-700">880008</td>

            <td class="px-3 py-2 border-b border-gray-700">2</td>

            <td class="px-3 py-2 border-b border-gray-700">-2</td>

            <td class="px-3 py-2 border-b border-gray-700">41000011</td>

            <td class="px-3 py-2 border-b border-gray-700">0</td>

            <td class="px-3 py-2 border-b border-gray-700">-0</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">12</td>

            <td class="px-3 py-2 border-b border-gray-700">1500</td>

            <td class="px-3 py-2 border-b border-gray-700">500</td>

            <td class="px-3 py-2 border-b border-gray-700">-3</td>

            <td class="px-3 py-2 border-b border-gray-700">0</td>

            <td class="px-3 py-2 border-b border-gray-700">4000</td>

            <td class="px-3 py-2 border-b border-gray-700">-2</td>

            <td class="px-3 py-2 border-b border-gray-700">200020</td>

            <td class="px-3 py-2 border-b border-gray-700">880008</td>

            <td class="px-3 py-2 border-b border-gray-700">-6</td>

            <td class="px-3 py-2 border-b border-gray-700">4000004</td>

            <td class="px-3 py-2 border-b border-gray-700">41000011</td>

            <td class="px-3 py-2 border-b border-gray-700">-8</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">13</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">4000</td>

            <td class="px-3 py-2 border-b border-gray-700">0</td>

            <td class="px-3 py-2 border-b border-gray-700">-0</td>

            <td class="px-3 py-2 border-b border-gray-700">80088</td>

            <td class="px-3 py-2 border-b border-gray-700">200020</td>

            <td class="px-3 py-2 border-b border-gray-700">-4</td>

            <td class="px-3 py-2 border-b border-gray-700">51000001</td>

            <td class="px-3 py-2 border-b border-gray-700">4000004</td>

            <td class="px-3 py-2 border-b border-gray-700">-4</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">14</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">200</td>

            <td class="px-3 py-2 border-b border-gray-700">80088</td>

            <td class="px-3 py-2 border-b border-gray-700">-6</td>

            <td class="px-3 py-2 border-b border-gray-700">60000000</td>

            <td class="px-3 py-2 border-b border-gray-700">51000001</td>

            <td class="px-3 py-2 border-b border-gray-700">-8</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">15</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">80888</td>

            <td class="px-3 py-2 border-b border-gray-700">200</td>

            <td class="px-3 py-2 border-b border-gray-700">-2</td>

            <td class="px-3 py-2 border-b border-gray-700">11000000</td>

            <td class="px-3 py-2 border-b border-gray-700">60000000</td>

            <td class="px-3 py-2 border-b border-gray-700">-4</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">16</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">4000000</td>

            <td class="px-3 py-2 border-b border-gray-700">11000000</td>

            <td class="px-3 py-2 border-b border-gray-700">-4</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">17</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">1000000</td>

            <td class="px-3 py-2 border-b border-gray-700">4000000</td>

            <td class="px-3 py-2 border-b border-gray-700">-2</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">18</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">0</td>

            <td class="px-3 py-2 border-b border-gray-700">1000000</td>

            <td class="px-3 py-2 border-b border-gray-700">-2</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">19</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">1000000</td>

            <td class="px-3 py-2 border-b border-gray-700">0</td>

            <td class="px-3 py-2 border-b border-gray-700">-0</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">20</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">4000000</td>

            <td class="px-3 py-2 border-b border-gray-700">1000000</td>

            <td class="px-3 py-2 border-b border-gray-700">-2</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">21</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">11000000</td>

            <td class="px-3 py-2 border-b border-gray-700">4000000</td>

            <td class="px-3 py-2 border-b border-gray-700">-2</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">∑r log2pr</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">-34</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">-36</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">-48</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">-72</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">log2pdiff</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">-34.00</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">-29.69</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">-42.11</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">-60.40</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">#trails</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">1</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">45083</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">112573</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">450536</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">log2pthres</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">-4.05</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">-4.05</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">-4.05</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">-4.05</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">pDDT</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">128</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">128</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">128</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">128</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">Time:</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">36 min.</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">47 min.</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">132 min.</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">>778 min.</td>

          </tr>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">In Fig. 5 is shown an example of a complete bipartite subgraph (biclique) similar to the ones composing the digraph in Fig. 9. Note that each node has the same left input difference  <span class="math">\\Delta_L</span>  due to the Feistel structure of SIMON.</p>

    <p class="text-gray-300">Consider the pair of left and right input differences  <span class="math">(\\varDelta_L^i,\\varDelta_R^i)=(11,106)</span>  (hexadecimal values). Through the non-linear component  <span class="math">f(x)=(x\\ll 1)\\wedge(x\\ll 8)</span>  of the round function, the difference  <span class="math">\\varDelta_L^i=11</span>  propagates to a set of output differences. This set has the form  <span class="math">\\nabla=000<em>000</em>00<em>000</em>0</span> , where  <span class="math"><em></span>  can take values  <span class="math">0/1</span> . Note that for some assignments of the  <span class="math"></em></span>  bits, the resulting difference may have zero probability as was explained in Sect. 2.2, Fig 2. For  <span class="math">\\nabla=\\{0122,0102,0120\\}</span>  three distinct output differences  <span class="math">\\varDelta_L^{i+1}</span>  from one round of SIMON are produced. They are shown as the three lower level nodes in Fig. 5 and are obtained as  <span class="math">\\nabla\\oplus((\\varDelta_L^i\\ll 2)\\oplus\\varDelta_R^i)=\\nabla\\oplus(44)\\oplus\\varDelta_R^i</span> .</p>

    <p class="text-gray-300">Another node with the same input difference  <span class="math">\\varDelta_L^i</span>  to the round function, but with different right difference  <span class="math">\\varDelta_R^i</span>  e.g.  <span class="math">(\\varDelta_L^i,\\varDelta_R^i)=(11,104)</span>  (see Fig. 5) produces a corresponding set of output differences  <span class="math">\\nabla&#x27;</span> , which may or may not have common elements with  <span class="math">\\nabla</span>  in general. For example, in this case  <span class="math">\\nabla&#x27; = \\{0100,0120,0122\\}</span>  produced by the node (11,104). In either case though,  <span class="math">\\nabla</span>  and  <span class="math">\\nabla&#x27;</span>  may still produce the same set of output differences  <span class="math">(\\varDelta_L^{i+1},\\varDelta_R^{i+1})</span> . When this happens then a</p>

    <p class="text-gray-300">Table 6. Differential trails for SPECK32, SPECK48 and SPECK64.</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">SPECK32</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">SPECK48</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">SPECK64</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

          </tr>

        </thead>

        <tbody>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">r</td>

            <td class="px-3 py-2 border-b border-gray-700">ΔL</td>

            <td class="px-3 py-2 border-b border-gray-700">ΔR</td>

            <td class="px-3 py-2 border-b border-gray-700">log2p</td>

            <td class="px-3 py-2 border-b border-gray-700">ΔL</td>

            <td class="px-3 py-2 border-b border-gray-700">ΔR</td>

            <td class="px-3 py-2 border-b border-gray-700">log2p</td>

            <td class="px-3 py-2 border-b border-gray-700">ΔL</td>

            <td class="px-3 py-2 border-b border-gray-700">ΔR</td>

            <td class="px-3 py-2 border-b border-gray-700">log2p</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">0</td>

            <td class="px-3 py-2 border-b border-gray-700">8054</td>

            <td class="px-3 py-2 border-b border-gray-700">A900</td>

            <td class="px-3 py-2 border-b border-gray-700">-0</td>

            <td class="px-3 py-2 border-b border-gray-700">202040</td>

            <td class="px-3 py-2 border-b border-gray-700">82921</td>

            <td class="px-3 py-2 border-b border-gray-700">-0</td>

            <td class="px-3 py-2 border-b border-gray-700">9</td>

            <td class="px-3 py-2 border-b border-gray-700">1000000</td>

            <td class="px-3 py-2 border-b border-gray-700">-0</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">1</td>

            <td class="px-3 py-2 border-b border-gray-700">0</td>

            <td class="px-3 py-2 border-b border-gray-700">A402</td>

            <td class="px-3 py-2 border-b border-gray-700">-3</td>

            <td class="px-3 py-2 border-b border-gray-700">480901</td>

            <td class="px-3 py-2 border-b border-gray-700">94009</td>

            <td class="px-3 py-2 border-b border-gray-700">-7</td>

            <td class="px-3 py-2 border-b border-gray-700">8000000</td>

            <td class="px-3 py-2 border-b border-gray-700">0</td>

            <td class="px-3 py-2 border-b border-gray-700">-2</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">2</td>

            <td class="px-3 py-2 border-b border-gray-700">A402</td>

            <td class="px-3 py-2 border-b border-gray-700">3408</td>

            <td class="px-3 py-2 border-b border-gray-700">-3</td>

            <td class="px-3 py-2 border-b border-gray-700">80802</td>

            <td class="px-3 py-2 border-b border-gray-700">42084A</td>

            <td class="px-3 py-2 border-b border-gray-700">-7</td>

            <td class="px-3 py-2 border-b border-gray-700">80000</td>

            <td class="px-3 py-2 border-b border-gray-700">80000</td>

            <td class="px-3 py-2 border-b border-gray-700">-1</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">3</td>

            <td class="px-3 py-2 border-b border-gray-700">50C0</td>

            <td class="px-3 py-2 border-b border-gray-700">80E0</td>

            <td class="px-3 py-2 border-b border-gray-700">-8</td>

            <td class="px-3 py-2 border-b border-gray-700">400052</td>

            <td class="px-3 py-2 border-b border-gray-700">504200</td>

            <td class="px-3 py-2 border-b border-gray-700">-7</td>

            <td class="px-3 py-2 border-b border-gray-700">80800</td>

            <td class="px-3 py-2 border-b border-gray-700">480800</td>

            <td class="px-3 py-2 border-b border-gray-700">-2</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">4</td>

            <td class="px-3 py-2 border-b border-gray-700">181</td>

            <td class="px-3 py-2 border-b border-gray-700">203</td>

            <td class="px-3 py-2 border-b border-gray-700">-4</td>

            <td class="px-3 py-2 border-b border-gray-700">820200</td>

            <td class="px-3 py-2 border-b border-gray-700">1202</td>

            <td class="px-3 py-2 border-b border-gray-700">-5</td>

            <td class="px-3 py-2 border-b border-gray-700">480008</td>

            <td class="px-3 py-2 border-b border-gray-700">2084008</td>

            <td class="px-3 py-2 border-b border-gray-700">-4</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">5</td>

            <td class="px-3 py-2 border-b border-gray-700">C</td>

            <td class="px-3 py-2 border-b border-gray-700">800</td>

            <td class="px-3 py-2 border-b border-gray-700">-5</td>

            <td class="px-3 py-2 border-b border-gray-700">9000</td>

            <td class="px-3 py-2 border-b border-gray-700">10</td>

            <td class="px-3 py-2 border-b border-gray-700">-4</td>

            <td class="px-3 py-2 border-b border-gray-700">6080808</td>

            <td class="px-3 py-2 border-b border-gray-700">164A0848</td>

            <td class="px-3 py-2 border-b border-gray-700">-7</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">6</td>

            <td class="px-3 py-2 border-b border-gray-700">2000</td>

            <td class="px-3 py-2 border-b border-gray-700">0</td>

            <td class="px-3 py-2 border-b border-gray-700">-3</td>

            <td class="px-3 py-2 border-b border-gray-700">80</td>

            <td class="px-3 py-2 border-b border-gray-700">0</td>

            <td class="px-3 py-2 border-b border-gray-700">-2</td>

            <td class="px-3 py-2 border-b border-gray-700">F2400040</td>

            <td class="px-3 py-2 border-b border-gray-700">40104200</td>

            <td class="px-3 py-2 border-b border-gray-700">-13</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">7</td>

            <td class="px-3 py-2 border-b border-gray-700">40</td>

            <td class="px-3 py-2 border-b border-gray-700">40</td>

            <td class="px-3 py-2 border-b border-gray-700">-1</td>

            <td class="px-3 py-2 border-b border-gray-700">800000</td>

            <td class="px-3 py-2 border-b border-gray-700">800000</td>

            <td class="px-3 py-2 border-b border-gray-700">-0</td>

            <td class="px-3 py-2 border-b border-gray-700">820200</td>

            <td class="px-3 py-2 border-b border-gray-700">1202</td>

            <td class="px-3 py-2 border-b border-gray-700">-8</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">8</td>

            <td class="px-3 py-2 border-b border-gray-700">8040</td>

            <td class="px-3 py-2 border-b border-gray-700">8140</td>

            <td class="px-3 py-2 border-b border-gray-700">-1</td>

            <td class="px-3 py-2 border-b border-gray-700">808000</td>

            <td class="px-3 py-2 border-b border-gray-700">808004</td>

            <td class="px-3 py-2 border-b border-gray-700">-1</td>

            <td class="px-3 py-2 border-b border-gray-700">9000</td>

            <td class="px-3 py-2 border-b border-gray-700">10</td>

            <td class="px-3 py-2 border-b border-gray-700">-4</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">9</td>

            <td class="px-3 py-2 border-b border-gray-700">40</td>

            <td class="px-3 py-2 border-b border-gray-700">542</td>

            <td class="px-3 py-2 border-b border-gray-700">-2</td>

            <td class="px-3 py-2 border-b border-gray-700">800084</td>

            <td class="px-3 py-2 border-b border-gray-700">8400A0</td>

            <td class="px-3 py-2 border-b border-gray-700">-3</td>

            <td class="px-3 py-2 border-b border-gray-700">80</td>

            <td class="px-3 py-2 border-b border-gray-700">0</td>

            <td class="px-3 py-2 border-b border-gray-700">-2</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">10</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">80A0</td>

            <td class="px-3 py-2 border-b border-gray-700">2085A4</td>

            <td class="px-3 py-2 border-b border-gray-700">-4</td>

            <td class="px-3 py-2 border-b border-gray-700">80000000</td>

            <td class="px-3 py-2 border-b border-gray-700">80000000</td>

            <td class="px-3 py-2 border-b border-gray-700">-0</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">11</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">808424</td>

            <td class="px-3 py-2 border-b border-gray-700">84A905</td>

            <td class="px-3 py-2 border-b border-gray-700">-7</td>

            <td class="px-3 py-2 border-b border-gray-700">80800000</td>

            <td class="px-3 py-2 border-b border-gray-700">80800004</td>

            <td class="px-3 py-2 border-b border-gray-700">-1</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">12</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">80008004</td>

            <td class="px-3 py-2 border-b border-gray-700">84008020</td>

            <td class="px-3 py-2 border-b border-gray-700">-3</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">13</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">808080A0</td>

            <td class="px-3 py-2 border-b border-gray-700">A08481A4</td>

            <td class="px-3 py-2 border-b border-gray-700">-5</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">14</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">40024</td>

            <td class="px-3 py-2 border-b border-gray-700">4200D01</td>

            <td class="px-3 py-2 border-b border-gray-700">-8</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">∑r log2pr</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">-30</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">-47</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">-60</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">log2pDiff</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">-30.00</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">-46.48</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">-59.02</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">#trails</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">1</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">384</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">934</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">max HW</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">7</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">7</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">7</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">log2pthres</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">-5.00</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">-5.00</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">-5.00</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">pDDT</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">230</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">230</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">230</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">Time:</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">≈ 240 min.</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">≈ 260 min.</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">> 207 min.</td>

          </tr>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">biclique is formed. This is shown in Fig. 5 where both  <span class="math">\\nabla</span>  and  <span class="math">\\nabla&#x27;</span>  result in the same set of output differences  <span class="math">(\\Delta_L^{i+1}, \\Delta_R^{i+1}) \\in \\{(4,11), (26,11), (6,11)\\}</span> .</p>

    <p class="text-gray-300">In general, when the sets  <span class="math">\\nabla</span> ,  <span class="math">\\nabla&#x27;</span>  produced from two different pairs of input differences have high (and possibly equal) probabilities, the complete subgraphs that are formed as a result, have thick edges (corresponding to high probability). Such subgraphs contribute to the clustering of differential trails in SIMON.</p>

    <p class="text-gray-300">Note that the described subgraphs may not be formed for all possible elements in  <span class="math">\\nabla</span>  of an arbitrary node since, as already mentioned, some of them may propagate with 0 probability through the non-linear component  <span class="math">f</span> . Furthermore, because the complete bipartite subgraphs depend on the input differences, they can not occur at arbitrary positions in the digraph (Fig. 9). The frequent occurrence of such special subgraph structures in SIMON in large numbers is the main cause for the strong differential effect observed experimentally using the tool for differential search.</p>

    <p class="text-gray-300">In this section we describe a key recovery attack on SIMON32 with 64 bit key. The input difference to Round-  <span class="math">r</span>  is denoted as  <span class="math">\\varDelta^{r-1}</span>  and, bit positions  <span class="math">i_1, i_2, \\ldots, i_t</span>  of  <span class="math">x</span>  as  <span class="math">x[i_1, i_2, \\ldots, i_t]</span> . Also  <span class="math">K^r</span>  denotes the round key for the Round- <span class="math">(r+1)</span>  and  <span class="math">\\mathcal{E}_r</span>  denotes the encryption function used with  <span class="math">r</span>  rounds.</p>

    <p class="text-gray-300">7.1 Attack on 19 Rounds</p>

    <p class="text-gray-300">To attack 19 rounds of SIMON32 we add 2 rounds on top and 4 rounds at the bottom of a set of four 13 round differentials. For this attack consider the following 13 round differentials</p>

    <p class="text-gray-300"><span class="math">\\mathcal{D}_{1}:(0000,0020)\\rightarrow(2000,0)</span> <span class="math">\\mathcal{D}_{2}:(0000,0040)\\rightarrow(4000,0)</span> <span class="math">\\mathcal{D}_{3}:(0000,0400)\\rightarrow(0004,0)</span> <span class="math">\\mathcal{D}_{4}:(0000,0800)\\rightarrow(0008,0)</span></p>

    <p class="text-gray-300">The truncated difference at the beginning of Round-0, for the above mentioned differentials look as following:</p>

    <p class="text-gray-300"><span class="math">(00<em>0\\ 0000\\ 1</em>00\\ 0000,\\ <strong>00\\ 001<em>\\ </em>0<em>0\\ 0000)</span> <span class="math">(0</em>00\\ 0001\\ <em>000\\ 0000,\\ </em>000\\ 01</strong>\\ 0<em>00\\ 000</em>)</span> <span class="math">(0001\\ <em>000\\ 0000\\ 0</em>00,\\ 01<strong>\\ 0<em>00\\ 000</em>\\ <em>000)</span> <span class="math">(001</em>\\ 0000\\ 0000\\ <em>000,\\ 1</strong>0\\ </em>0000\\ 00**\\ 0000)</span></p>

    <p class="text-gray-300">Observing the active and inactive bit positions of the above truncated differentials we can construct a set <span class="math">2^{23}</span> plaintexts where each <span class="math">\\mathcal{P}=(P_{L},P_{R})\\in\\mathcal{P}</span> has 9 bits, e.g. <span class="math">P_{L}[0,5,6,10,11,14,15],P_{R}[13,14]</span> fixed to an arbitrary value. We can identify <span class="math">2^{25}</span> pairs of plaintexts (for each differential) from <span class="math">\\mathcal{P}</span> so that the pairs satisfy the corresponding <span class="math">(\\Delta_{L}^{2},\\Delta_{R}^{2})</span> after two rounds of encryption. For this we need to guess the following round-key bits – <span class="math">(\\mathcal{D}_{1})K^{0}[12,14]</span>, <span class="math">(\\mathcal{D}_{2})K^{0}[13,15],(\\mathcal{D}_{3})K^{0}[1,3],(\\mathcal{D}_{4})K^{0}[2,4]</span>. Hence with 4 key guesses, 4 sets of <span class="math">2^{23}</span> pairs of plaintexts corresponding to a differential <span class="math">\\mathcal{D}_{i}</span> can be identified (where each pair in a set follows the top 2-round differential obtained from <span class="math">\\mathcal{D}_{i}</span>). Note that by varying some fixed bits of plaintexts in <span class="math">\\mathcal{P}</span> we can identify <span class="math">2^{30.5}</span> pairs for each differential and for each (2 bits) key guess. Each set of identified <span class="math">2^{30.5}</span> pairs of plaintexts is filtered by verifying the fixed bits of the corresponding truncated difference <span class="math">\\Delta^{18}</span>. This reduces the number of pairs to <span class="math">2^{30.5-18}=2^{12.5}</span> for each differential. In order to partially decrypt each pair of ciphertext it is necessary to guess the following key bits (and linear combinations of key bits) from last 3 rounds.</p>

    <p class="text-gray-300"><span class="math">\\mathcal{D}_{1}^{K}=\\{K^{18},K^{17}[3,5-8,12,14],K^{16}[6]\\oplus K^{17}[4],K^{16}[4]\\oplus K^{17}[2]\\}</span> (9) <span class="math">\\mathcal{D}_{2}^{K}=\\{K^{18},K^{17}[4,6-9,13,15],K^{16}[7]\\oplus K^{17}[5],K^{16}[5]\\oplus K^{17}[3]\\}</span> (10) <span class="math">\\mathcal{D}_{3}^{K}=\\{K^{18},K^{17}[8,10-13,1,3],K^{16}[11]\\oplus K^{17}[9],K^{16}[9]\\oplus K^{17}[7]\\}</span> (11) <span class="math">\\mathcal{D}_{4}^{K}=\\{K^{18},K^{17}[9,11-14,2,4],K^{16}[12]\\oplus K^{17}[10],K^{16}[10]\\oplus K^{17}[8]\\}</span> (12)</p>

    <p class="text-gray-300">In each differential we need to guess 25 bits (and linear combination of bits) from last 3 round-keys. So, for any differential <span class="math">\\mathcal{D}_{i}</span> it is necessary to guess: <span class="math">25+2</span> (from <span class="math">K^{0})=27</span> bits. For key recovery attack let us first consider the two differentials <span class="math">\\mathcal{D}_{1}</span> and <span class="math">\\mathcal{D}_{2}</span>. Note that there are 19 bits common between <span class="math">\\mathcal{D}_{1}^{K}</span> and <span class="math">\\mathcal{D}_{2}^{K}</span>. For detecting the correct key we maintain an array of counters of size <span class="math">2^{27}</span> for each <span class="math">\\mathcal{D}_{1}</span> and <span class="math">\\mathcal{D}_{2}</span>. A counter is incremented when it is correctly verified using a partially decrypted pair of plaintexts by comparing with corresponding <span class="math">\\Delta^{15}</span>. For each differential <span class="math">\\mathcal{D}_{1}</span> and <span class="math">\\mathcal{D}_{2}</span>, we expect to have <span class="math">(2^{27}\\times 2^{12.5})/2^{14}=2^{25.5}</span> increments. We expect approximately 4 correct pairs for each</p>

    <p class="text-gray-300">differential and the probability of a counter being incremented is <span class="math">1/2^{2}</span>. So, it is expected to have <span class="math">(\\frac{1}{4})^{4}\\times 2^{25.5}=2^{17.5}</span> counters with 4 increments for each case. Let these two sets of counters be <span class="math">T_{1}</span> and <span class="math">T_{2}</span>. Since <span class="math">\\mathcal{D}_{1}^{K}</span> and <span class="math">\\mathcal{D}_{2}^{K}</span> has 19 common key bits, after combining <span class="math">T_{1}</span> and <span class="math">T_{2}</span> we expect to obtain <span class="math">2^{17.5}\\times(2^{17.5}/2^{19})=2^{16}</span> candidates for <span class="math">19+6+6+4=35</span> bits. Let us denote this set of counters as <span class="math">T^{\\prime}</span>.</p>

    <p class="text-gray-300">Next we partially decrypt <span class="math">2^{12}</span> pairs of ciphertexts corresponding to <span class="math">\\mathcal{D}_{3}</span> to verify the difference <span class="math">\\Delta^{15}</span> for each 27 bit key guess. As described previously, we maintain an array of <span class="math">2^{27}</span> counters. A counter is incremented when it is verified correctly by a pair of ciphertexts. The expected number of counters having value 4 is <span class="math">2^{17.5}</span>. Let us denote this set of counters as <span class="math">T_{3}</span>. <span class="math">\\mathcal{D}_{3}^{K}</span> and <span class="math">\\mathcal{D}_{1}^{K}\\cup\\mathcal{D}_{2}^{K}</span> has 20 common round-key bits. Hence, combining <span class="math">T_{3}</span> and <span class="math">T^{\\prime}</span> we expect to get <span class="math">2^{16}\\times(2^{17.5}/2^{20})=2^{13.5}</span> candidates for <span class="math">35+(25+2-20)=42</span> round-key bits (out of which 36 bits correspond to last 3 round keys).</p>

    <p class="text-gray-300">Using the fourth differential <span class="math">\\mathcal{D}_{4}</span> in a similar way we obtain <span class="math">2^{9}</span> candidates for <span class="math">42+(25-22)+2=47</span> bits of round-keys, from which we can determine 39 bits of last 3 round-keys.</p>

    <p class="text-gray-300">In order to recover the key we should know all the last 4 round-keys. For the remaining <span class="math">64-39=25</span> bits of last four round-keys we use exhaustive search. Hence the total number of key guesses is <span class="math">2^{9+25}=2^{34}</span>.</p>

    <h4 id="sec-19" class="text-lg font-semibold mt-6">6.2.2 Attack Complexity</h4>

    <p class="text-gray-300">The time complexity for encrypting plaintexts is <span class="math">2^{31.5}</span>. In the key guessing phase <span class="math">2^{12}</span> filtered pairs are decrypted for last 4 rounds for each <span class="math">2^{25}</span> key guesses. This is done for each differential. The partial decryption of ciphertext pairs (and increment of the counters) can be done in steps with partial key guess at each step of the last four rounds. This is done by filtering (due to the fixed bits of the truncated differences) at the beginning of Round-16 to Round-18. The complexity for this process is given as:</p>

    <p class="text-gray-300"><span class="math">4\\cdot 4\\cdot(2^{12.5}\\cdot 2^{16}+2^{12.5}\\cdot 2^{9}\\cdot 2^{7}+2^{12.5}\\cdot 2^{2}\\cdot 2^{2})\\cdot\\frac{1}{19}\\approx 2^{33}</span> (13)</p>

    <p class="text-gray-300">For identifying the <span class="math">2^{30.5}</span> pairs with 4 key guesses for each differential requires <span class="math">2^{31.5}\\cdot 2^{2}=2^{33.5}</span> two round encryptions. The complexity due to this part is <span class="math">2^{33.5}\\times 4\\times(2/19)\\approx 2^{32}</span>. Hence the total complexity of the attack is <span class="math">\\approx 2^{34}</span>.</p>

    <p class="text-gray-300">We also show attacks on round-reduced Simon48 and Simon64. The details of these attacks are described in appendix (C and D).</p>

    <h2 id="sec-20" class="text-2xl font-bold">8 Key Recovery Attack on Speck32</h2>

    <p class="text-gray-300">In this section we describe a chosen plaintext (CP) attack on 11 rounds of Speck32 using the same notations as in Section 7. To attack Speck32 we use the 9 round differential trail with probability <span class="math">2^{-30}</span> given in Table 6. We add one round (Round-1) at the top of the trail and one round at the bottom (Round-11) of the trail to cover 11 rounds in total. If we encrypt <span class="math">2^{30}</span> pairs of plaintexts such that <span class="math">(\\Delta_{L}^{1}=\\texttt{8054},\\ \\Delta_{R}^{1}=\\texttt{A900})</span>, then it is expected to produce <span class="math">2^{30}\\times\\frac{1}{2^{30}}=1</span> pair of plaintext satisfying the input/output differences at Round-2 and Round-10 and, <span class="math">2^{30}\\times\\frac{1}{2^{28}}=4</span> pairs of plaintexts satisfying the input/output differences at Round-2 and Round-9.</p>

    <p class="text-gray-300">The key recovery attack is performed according to the following steps:</p>

    <p class="text-gray-300">!<a href="img-5.jpeg">img-5.jpeg</a> Fig. 6. Truncated difference (in binary notation) in the last 4 rounds of the 18 and 19 round key-recovery attacks on SIMON32.</p>

    <p class="text-gray-300">!<a href="img-6.jpeg">img-6.jpeg</a> Fig. 7. Top 2 rounds in the attack of SIMON32</p>

    <p class="text-gray-300">!<a href="img-7.jpeg">img-7.jpeg</a> Fig. 8. Differential trail for Round-10 and Round-11 in SPECK32</p>

    <ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">

      <li>Filtering: The least significant 7 bits of difference after the modular addition at Round-10 are always 100 0000. This implies that <span class="math">\\Delta^{10}</span> should be of the form <strong>** </strong>** <em>100 0000, where </em> denotes unknown bit values. Hence <span class="math">2^{30}</span> pairs of plaintext/ciphertexts can be filtered by unrolling the output difference of ciphertexts and verifying the 7 bits of <span class="math">\\Delta^{10}</span>. This reduces the number of pairs to <span class="math">2^{30-7}=2^{23}</span>.</li>

      <li>Partial Key Guessing: For the filtered pairs, we guess all 16 bits of <span class="math">K^{10}</span> and 11 bits of <span class="math">K^{9}</span>(e.g. <span class="math">K^{9}[5-15]</span>) and, one carry bit at bit position 5 (in the modular addition at Round-10). For each of these <span class="math">2^{28}</span> partial key (and carry bit) guess we keep a counter. A counter is incremented if after partially decrypting (last 2 rounds) a pair of ciphertexts satisfies the difference <span class="math">(\\Delta^{9}_{L},\\Delta^{9}_{R})=(8040,8140)</span>. This will result in <span class="math">(2^{28}\\times 2^{23})/2^{25}=2^{26}</span> increments of all the counters. Probability of a counter getting incremented is <span class="math">2^{26}/2^{28}=\\frac{1}{2^{2}}</span> and, 4 pairs are expected to satisfy the condition at the end of Round-9. Hence, number of counters incremented by 4 are <span class="math">2^{26}\\times(\\frac{1}{2^{2}})^{4}=2^{18}</span>.</li>

      <li>Exhaustive Search: For the remaining <span class="math">64-27=37</span> bits from the last rounds keys <span class="math">K^{9},K^{8},K^{7}</span> we use exhaustive search.</li>

    </ol>

    <h4 id="sec-21" class="text-lg font-semibold mt-6">6.2.2 Attack Complexity</h4>

    <p class="text-gray-300">The complexity for decrypting of <span class="math">2^{23}</span> ciphertext pairs for each <span class="math">2^{28}</span> guesses of key bits and carry bit is, <span class="math">(2^{28}\\cdot 2^{23})\\cdot\\frac{1}{11}\\approx 2^{47}</span>. The total number of key guesses is <span class="math">2^{18}\\cdot 2^{37}=2^{55}</span>. Hence, total complexity is dominated by <span class="math">\\approx 2^{55}</span>.</p>

    <p class="text-gray-300">With the same attack strategy, we also attack Speck48 and Speck64. The details of those attacks are described in appendix (A and B).</p>

    <h2 id="sec-22" class="text-2xl font-bold">9 Conclusion</h2>

    <p class="text-gray-300">In this paper were presented new results on the differential analysis of lightweight block ciphers Simon and Speck. In particular, by applying new techniques for the automatic search of trails and differentials in ARX ciphers, several previous results were improved. Those improvements were further used to mount the currently best known attacks on several versions of Simon and Speck. In addition an efficient algorithm for the computation of the DP of the AND operation was presented. A detailed analysis of the strong differential effect in Simon was given and the reason for it was analyzed. The described methods are general and are therefore applicable to other ARX designs.</p>

    <h4 id="sec-23" class="text-lg font-semibold mt-6">9.9.1 Acknowledgments.</h4>

    <p class="text-gray-300">We thank our colleagues from the laboratory of algorithmics, cryptology and security (LACS) at the university of Luxembourg for the useful discussions. We are especially thankful to Yann Le Corre for pointing out several inconsistencies in the experimental results on Simon32. We further thank the anonymous reviewers for their time and useful comments. Some of the experiments presented in this paper were carried out using the HPC facility of the University of Luxembourg.</p>

    <p class="text-gray-300">!<a href="img-8.jpeg">img-8.jpeg</a> Fig. 9. Clustering of multiple trails satisfying the 21 round differential (4000000, 11000000)  <span class="math">\\rightarrow</span>  (11000000, 4000000) in SIMON64. The thickness of the edges between two nodes is proportional to the number of right pairs that follow the differential. The graph depicts more than 275000 differential trails in total.</p>

    <p class="text-gray-300">References</p>

    <ul class="list-disc list-inside space-y-1 text-gray-300 my-2 ml-4">

      <li>[1] F. Abed, E. List, S. Lucks, and J. Wenzel. Cryptanalysis of the speck family of block ciphers. Cryptology ePrint Archive, Report 2013/568, 2013. http://eprint.iacr.org/.</li>

      <li>[2] F. Abed, E. List, S. Lucks, and J. Wenzel. Differential and linear cryptanalysis of reduced-round simon. Cryptology ePrint Archive, Report 2013/526, 2013. http://eprint.iacr.org/.</li>

      <li>[3] H. A. Alkhzaimi and M. M. Lauridsen. Cryptanalysis of the simon family of block ciphers. Cryptology ePrint Archive, Report 2013/543, 2013. http://eprint.iacr.org/.</li>

      <li>[4] R. Beaulieu, D. Shors, J. Smith, S. Treatman-Clark, B. Weeks, and L. Wingers. The SIMON and SPECK Families of Lightweight Block Ciphers. Cryptology ePrint Archive, Report 2013/404, 2013. http://eprint.iacr.org/.</li>

      <li>[5] E. Biham and A. Shamir. Differential Cryptanalysis of DES-like Cryptosystems. J. Cryptology, 4(1):3–72, 1991.</li>

      <li>[6] A. Biryukov and V. Velichkov. A Method for Automatic Search for Differential Trails in ARX Ciphers. Under Submission, 2013.</li>

      <li>[7] A. Bogdanov, L. R. Knudsen, G. Leander, C. Paar, A. Poschmann, M. J. B. Robshaw, Y. Seurin, and C. Vikkelsoe. Present: An ultra-lightweight block cipher. In P. Paillier and I. Verbauwhede, editors, CHES, volume 4727 of Lecture Notes in Computer Science, pages 450–466. Springer, 2007.</li>

      <li>[8] C. De Cannière, O. Dunkelman, and M. Knezevic. Katan and ktantan - a family of small and efficient hardware-oriented block ciphers. In C. Clavier and K. Gaj, editors, CHES, volume 5747 of Lecture Notes in Computer Science, pages 272–288. Springer, 2009.</li>

      <li>[9] N. Ferguson, S. Lucks, B. Schneier, D. Whiting, M. Bellare, T. Kohno, J. Callas, and J. Walker. The Skein Hash Function Family. Submission to the NIST SHA-3 Competition (Round 2), 2009.</li>

      <li>[10] Z. Gong, S. Nikova, and Y. W. Law. Klein: A new family of lightweight block ciphers. In A. Juels and C. Paar, editors, RFIDSec, volume 7055 of Lecture Notes in Computer Science, pages 1–18. Springer, 2011.</li>

      <li>[11] J. Guo, T. Peyrin, A. Poschmann, and M. J. B. Robshaw. The led block cipher. In Preneel and Takagi <em>[17]</em>, pages 326–341.</li>

      <li>[12] D. Hong, J. Sung, S. Hong, J. Lim, S. Lee, B. Koo, C. Lee, D. Chang, J. Lee, K. Jeong, H. Kim, J. Kim, and S. Chee. Hight: A new block cipher suitable for low-resource device. In L. Goubin and M. Matsui, editors, CHES, volume 4249 of Lecture Notes in Computer Science, pages 46–59. Springer, 2006.</li>

      <li>[13] Internet Resource. Internet of Things. Wikipedia, retrieved in July 2013. http://www.en.wikipedia.org/wiki/Internet_of_Things.</li>

      <li>[14] D. Khovratovich and I. Nikolic. Rotational Cryptanalysis of ARX. In S. Hong and T. Iwata, editors, FSE, volume 6147 of Lecture Notes in Computer Science, pages 333–346. Springer, 2010.</li>

      <li>[15] M. Matsui. On Correlation Between the Order of S-boxes and the Strength of DES. In A. D. Santis, editor, EUROCRYPT, volume 950 of Lecture Notes in Computer Science, pages 366–375. Springer, 1994.</li>

      <li>[16] N. Mouha, V. Velichkov, C. De Cannière, and B. Preneel. The Differential Analysis of S-Functions. In A. Biryukov, G. Gong, and D. R. Stinson, editors, Selected Areas in Cryptography, volume 6544 of Lecture Notes in Computer Science, pages 36–56. Springer, 2010.</li>

      <li>[17] B. Preneel and T. Takagi, editors. Cryptographic Hardware and Embedded Systems - CHES 2011 - 13th International Workshop, Nara, Japan, September 28 - October 1, 2011. Proceedings, volume 6917 of Lecture Notes in Computer Science. Springer, 2011.</li>

      <li>[18] K. Shibutani, T. Isobe, H. Hiwatari, A. Mitsuda, T. Akishita, and T. Shirai. Piccolo: An ultra-lightweight blockcipher. In Preneel and Takagi <em>[17]</em>, pages 342–357.</li>

      <li>[19] T. Shirai, K. Shibutani, T. Akishita, S. Moriai, and T. Iwata. The 128-bit blockcipher clefia (extended abstract). In A. Biryukov, editor, FSE, volume 4593 of Lecture Notes in Computer Science, pages 181–195. Springer, 2007.</li>

      <li>[20] T. Suzaki, K. Minematsu, S. Morioka, and E. Kobayashi. <span class="math">{{\\{}{\\rm{twine}\\}}}</span>: A lightweight block cipher for multiple platforms. In L. R. Knudsen and H. Wu, editors, Selected Areas in Cryptography, volume 7707 of Lecture Notes in Computer Science, pages 339–354. Springer, 2012.</li>

      <li>[21] R.-P. Weinmann. AXR - Crypto Made from Modular Additions, XORs and Word Rotations. Dagstuhl Seminar 09031, January 2009.</li>

    </ul>

    <h2 id="sec-24" class="text-2xl font-bold">Appendix</h2>

    <h2 id="sec-25" class="text-2xl font-bold">Appendix A Attack on Speck48</h2>

    <p class="text-gray-300">To attack Speck48, with key size 72, we use 10 round differential in table with probability <span class="math">2^{-39.46}</span>. By adding one round at the top and one round at the bottom we can attack 12 rounds of the</p>

    <p class="text-gray-300">cipher. We encrypt <span class="math">2^{42}</span> pairs of plaintext so that they satisfy the input difference <span class="math">(202040,82921)</span> at the beginning of Round-2. The expected number of good pairs at the end of Round-11 is <span class="math">\\approx 4</span>. By partially decrypt the last round, <span class="math">2^{42}</span> pairs of plaintext is filtered to yield <span class="math">2^{42-25}=2^{17}</span> pairs of plaintexts. Next, we guess 24 bits of the last round key and decrypt the last round. If we keep a counter for each key guess, which are incremented when a key is suggested as correct candidate by a pair of cipher texts, then the total number of increment is <span class="math">(2^{24}\\times 2^{17})/2^{23}=2^{18}</span>. Since, the probability of a counter having an increment is <span class="math">2^{18}/2^{24}=\\frac{1}{2^{6}}</span>, we expect exactly one counter having 4 increments, which corresponds to the correct key. By guessing the next two round key successively in the same way we can recover the whole key. The complexity due to the key guessing phase of attack is: <span class="math">2^{18}\\times 2^{24}\\times\\frac{1}{12}+2^{18}\\times 2^{24}\\times\\frac{2}{12}+2^{18}\\times 2^{24}\\times\\frac{3}{12}=2^{41}</span>. Hence, the total complexity is <span class="math">2^{41}+2^{43}\\approx 2^{43}</span></p>

    <p class="text-gray-300">In order to attack Speck48 with key size 96 bit, we should recover the last four round keys. The attack can be performed in the similar way as described above. However, we need to proceed one more round from the bottom during the key guessing phase. The complexity for this phase is: <span class="math">2^{18}\\times 2^{24}\\times\\frac{1}{12}+2^{18}\\times 2^{24}\\times\\frac{2}{12}+2^{18}\\times 2^{24}\\times\\frac{3}{12}+2^{18}\\times 2^{24}\\times\\frac{4}{12}\\approx 2^{42}</span>. Hence, the overall complexity remains the same as before.</p>

    <h2 id="sec-26" class="text-2xl font-bold">Appendix B Attack on Speck64</h2>

    <p class="text-gray-300">To attack Speck64 with key size 96, we use the 14 round differential trail obtained by threshold search method. To attack 16 rounds of the cipher we add one round at the top and one round at the bottom. <span class="math">2^{62}</span> pairs of plaintexts are chosen so that they satisfy the input difference <span class="math">(9,1000000)</span> to Round-2. Since probability of 14 round differential is <span class="math">2^{-60}</span>, it is expected to have approximately 4 good pairs at the end of Round-15. Note that the difference at the end of Round-15 is <span class="math">(\\Delta_{L},\\Delta_{R})=(40024,4200d01)</span>. So, the difference after modular addition at Round-16 should have the least significant bit active. Using this together with <span class="math">\\Delta_{R}^{15}</span> (input difference on the right to round-16) we filter out some pairs of cipher texts (obtained from the <span class="math">2^{62}</span> chosen plaintext pairs) by using the partial difference at the end of Round-15. <span class="math">2^{62-33}=2^{29}</span> pairs are left after filtering. We guess the round key <span class="math">K^{15}</span> by keeping an array of counter for each guess and, a counter is incremented when it is verified with the fixed difference after partial decryption of pair of cipher texts. Total number of increments is given as <span class="math">(2^{32}\\times 2^{29})/2^{31}=2^{30}</span>. Since probability of a counter being incremented once is <span class="math">2^{2}</span>, we expect <span class="math">\\frac{1}{(2^{2})^{4}}\\times 2^{30}=2^{22}</span> counters having 4 increments. Each of these <span class="math">2^{22}</span> counter corresponds to a candidate for round key <span class="math">K^{15}</span>. In order to recover the key we need to know the round keys <span class="math">K^{14}</span> and <span class="math">K^{13}</span>. So, we proceed by guessing <span class="math">K^{14}</span>. But, in this phase we maintain an array of <span class="math">2^{54}</span> counters, each for <span class="math">2^{22+32}=2^{54}</span> possible key candidates for <span class="math">K^{15}</span>, <span class="math">K^{14}</span>. Expected number of increments of the counters is: <span class="math">(2^{22}\\times 2^{29}\\times 2^{32})/2^{32}=2^{51}</span>. The number of correct pair after decrypting the cipher-text pairs for last two rounds is expected to be <span class="math">2^{2}\\cdot 2^{8}=2^{10}</span>. Hence, after this phase we will get one key candidate for <span class="math">K^{15},K^{14}</span> (total 64 bits). Recall that for recovering the key we need to know the last 3 round-keys. For <span class="math">K^{13}</span> we use exhaustive search which requires <span class="math">2^{32}</span> key guessings.</p>

    <h4 id="sec-27" class="text-lg font-semibold mt-6">Attack Complexity</h4>

    <p class="text-gray-300">The complexity of the attack is dominated by the key guessing phase. The complexity during this process is given as</p>

    <p class="text-gray-300"><span class="math">2^{32}\\times 2^{30}\\times\\frac{1}{16}+2^{22}\\times 2^{30}\\times 2^{32}\\times\\frac{1.5}{16}\\approx 2^{80}</span></p>

    <p class="text-gray-300">Hence the attack complexity is dominated by <span class="math">2^{80}</span>.</p>

    <p class="text-gray-300">The attack on Speck64 with 128 bit key can be performed in a similar way as described above. However, in this case we need to know the last four round keys. Hence, we perform the partial decryption of ciphertext pairs by guessing a round-key for one more round. The complexity for the key guessing and verifying with fixed difference after partial decryption is</p>

    <p class="text-gray-300"><span class="math">(2^{32}\\times 2^{30}\\times\\frac{1}{16}+2^{22}\\times 2^{30}\\times 2^{32}\\times\\frac{1.5}{16}+2^{32}\\times 2^{22}\\times\\frac{3}{16})\\approx 2^{80}</span></p>

    <p class="text-gray-300">Hence in this case also the complexity of the attack is <span class="math">\\approx 2^{80}</span>.</p>

    <p class="text-gray-300">Note that for both 128 bit and 96 bit key sizes the complexity can be reduced to <span class="math">\\approx 2^{73}</span> if we use the full code book i.e. <span class="math">2^{64}</span> data.</p>

    <h2 id="sec-28" class="text-2xl font-bold">Appendix C Attack on Simon48</h2>

    <h3 id="sec-29" class="text-xl font-semibold mt-8">C.1 Attacking 19 Rounds</h3>

    <p class="text-gray-300">We use the 15 round differential in Table 5 to attack 19 rounds of Simon48, with key size 72. We add one round on top of this differential and 3 rounds at the end. Since, the probability of the differential is <span class="math">2^{-42.11}</span>, using <span class="math">2^{45}</span> pairs of chosen plaintexts we expect to get approximately 8 good pairs at end of Round-16. Propagating the difference <span class="math">(80888,200)</span> through Round-17 and Round-18 we get a truncated difference <span class="math">\\Delta_{L}^{17}=(001<em> </em>000 <em>01</em> <em>00</em> 001<em> </em>000)</span> and <span class="math">\\Delta^{\\prime}=(\\ast\\ast\\ast<em> </em>00<em> 0\\ast\\ast</em> <em>0</em>0 1\\ast\\ast<em> </em>000)</span>, where <span class="math">\\Delta^{\\prime}</span> is the output difference before XORing of round-key and <span class="math">\\Delta_{L}^{17}\\lll 2</span>. Using this truncated difference and unrolling the differences from Round-19 we can filter the plaintext/ciphertext pairs. This leaves <span class="math">2^{45-25}=2^{20}</span> pairs of plaintexts. By guessing 29 round-key bits <span class="math">K^{18}[1-6,8-23],K^{17}[0,4,10,12,14,18,20]</span> and, a linear combination <span class="math">K^{17}[2]\\oplus K^{18}[0]</span> we can partially decrypt a pair of ciphertexts to verify <span class="math">\\Delta^{16}=(80888,200)</span> This is done by maintaining an array of <span class="math">2^{30}</span> counters. A counter is incremented when it is suggested by a plaintext pair. Hence, the total number of increment is <span class="math">(2^{30}\\times 2^{20})/2^{23}=2^{27}</span>, implying that the number of counters incremented by 8 is expected to be <span class="math">(\\frac{1}{2^{3}})^{8}\\times 2^{27}=2^{3}</span>. For the remaining <span class="math">(72-30)=42</span> bits of the last three round-keys we use exhaustive search. Hence the total number of key guesses is <span class="math">2^{42}\\cdot 2^{3}=2^{45}</span>.</p>

    <h4 id="sec-30" class="text-lg font-semibold mt-6">Attack Complexity</h4>

    <p class="text-gray-300">The complexity for encrypting plaintexts is <span class="math">2^{46}</span>. During the guessing process of 30 bits of key(and linear combination) complexity is given as</p>

    <p class="text-gray-300"><span class="math">(2^{21}\\times 2^{22}+2^{21}\\times 2^{7}\\times 2^{7})\\times\\frac{1}{19}\\approx 2^{39}</span></p>

    <p class="text-gray-300">Hence the complexity is <span class="math">\\approx 2^{46}</span>.</p>

    <p class="text-gray-300">For attacking Simon48 with key size 96 bits, we use the same technique described above. However in this case we need to know last 4 round-keys. So, after the first stage of the key guessing, we will be left with <span class="math">96-30=66</span> bits to guess. For this we use exhaustive search and, the total number of key guesses is <span class="math">2^{66+3}=2^{69}</span>.</p>

    <h2 id="sec-31" class="text-2xl font-bold">Appendix</h2>

    <p class="text-gray-300">C.2 Attacking 20 Rounds</p>

    <p class="text-gray-300">To attack 20 rounds of the cipher we use the same technique used for Simon32. The idea is to add 2 rounds on top of the 15 round differential instead of 1 round. If the difference to Round-3 <span class="math">\\Delta^{3}=(200020,80088)</span>, is propagated through Round-2 and Round-1, the we get</p>

    <p class="text-gray-300"><span class="math">\\Delta^{0}_{L}</span> <span class="math">=000<em>~{}0000~{}</em>000~{}<em>01</em>~{}000<em>~{}</em>000</span> <span class="math">\\Delta^{0}_{R}</span> <span class="math">=<strong><em>0~{}</em>0</strong>~{}00<strong>~{}</strong>*0~{}1***~{}1000</span></p>

    <p class="text-gray-300">We construct a set of plaintexts <span class="math">\\mathcal{P}</span> of size <span class="math">2^{20}</span> by varying the bit positions in <span class="math">P=(P_{L},P_{R})</span> corresponding to <span class="math">\\ast</span> in all possible ways and keeping other bit positions fixed to an arbitrary value. Using this set <span class="math">\\mathcal{P}</span> and guessing 6 bits of the round key <span class="math">K^{0}</span> we can identify <span class="math">2^{20}</span> pairs which satisfy the input difference to Round-3. Now by varying the fixed bit positions( <span class="math">2^{25}</span> times ) we can identify <span class="math">2^{45}</span> pairs of plaintexts satisfying the input difference to Round-3. Next we perform the attack as described before (on 19 rounds) for each key guess of <span class="math">K^{0}</span>. The complexity of the attack will be roughly <span class="math">2^{6}\\times 2^{46}=2^{52}</span> and <span class="math">2^{6}\\times 2^{69}=2^{75}</span> for key size 72 and 96 respectively.</p>

    <h2 id="sec-32" class="text-2xl font-bold">Appendix 0.D Attack on Simon64</h2>

    <h3 id="sec-33" class="text-xl font-semibold mt-8">0.D.1 Attack on 26 rounds</h3>

    <p class="text-gray-300">To attack Simon64, with key size 96, we use the 21 round differential with probability <span class="math">2^{-60.53}</span> (see Table 2). We add one round on the top and 4 rounds at the bottom of the differential. Since the probability of the differential is <span class="math">2^{-60.53}</span>, using <span class="math">2^{62}</span> pairs of chosen plaintexts we expect to get approximately <span class="math">2-3</span> good pairs at end of Round-22. Propagating the difference <span class="math">(\\Delta^{22}_{L},\\Delta^{22}_{R})=(11000000,4000000)</span> through Round-23, Round-24 and Round-25 we get a truncated difference with 35 known bits, input to Round-26:</p>

    <p class="text-gray-300"><span class="math">\\Delta^{25}_{R}</span> <span class="math">=(<strong>01~{}</strong>01~{}0000~{}0000~{}000<em>~{}000</em>~{}0<strong>0~{}0</strong>1)</span> <span class="math">\\Delta^{25}_{L}</span> <span class="math">=(<em>0<strong>~{}</em>1<em>0~{}000</em>~{}000<em>~{}0</strong>0~{}0<strong></em>~{}</strong>0***)</span></p>

    <p class="text-gray-300">Using this truncated difference and unrolling the differences from Round-26 we can filter the plaintext/ciphertext pairs. This leaves <span class="math">2^{62-35}=2^{27}</span> pairs of plaintexts. By guessing 49 round-key bits</p>

    <p class="text-gray-300"><span class="math">\\text{Round}-26:K^{25}[0-15,17-31]</span> <span class="math">\\text{Round}-25:K^{24}[0,2-5,7,9,11,13,16,20,22,23,25,27,29,30]</span> <span class="math">\\text{Round}-24:K^{23}[31]</span></p>

    <p class="text-gray-300">and linear combinations of round-key bits <span class="math">K^{23}[3]\\oplus K^{24}[1]</span>, <span class="math">K^{23}[17]\\oplus K^{24}[15]</span>, <span class="math">K^{23}[21]\\oplus K^{24}[19]</span> we can partially decrypt a pair of ciphertexts to verify <span class="math">(\\Delta^{22}_{L},\\Delta^{22}_{R})=(11000000,4000000)</span>. This is done by maintaining an array of <span class="math">2^{52}</span> counters. A counter is incremented when it is suggested by a plaintext pair. Hence, the total number of increments is <span class="math">(2^{52}\\times 2^{27})/2^{29}=2^{50}</span>, implying that the number of counters incremented by 2 is expected to be <span class="math">(2^{50}/2^{52})^{2}=(\\frac{1}{2^{2}})^{2}\\times 2^{49}=2^{45}</span>. For the remaining 44 bits of the last three round-keys we use exhaustive search. Hence the total number of key guesses is <span class="math">2^{45}\\cdot 2^{44}=2^{89}</span>.</p>

    <p class="text-gray-300">###</p>

    <h5 id="sec-34" class="text-base font-semibold mt-4">Attack Complexity</h5>

    <p class="text-gray-300">For partial decryption part of the attack the complexity is</p>

    <p class="text-gray-300"><span class="math">(2^{28}\\times 2^{31}+2^{28}\\times 2^{16}\\times 2^{17}+2^{28}\\times 2^{16}\\times 2^{7}\\times 2^{4})\\times\\frac{1}{26}\\approx 2^{59}.</span></p>

    <p class="text-gray-300">Hence the complexity is dominated by the total number of key guessing part, which is <span class="math">\\approx 2^{89}</span>.</p>

    <p class="text-gray-300">For attacking Simon64 with key size 128 bits, we use the same technique described above. However in this case we need to know the last 4 round-keys. So, after the first stage of the key guessing, we will be left with <span class="math">128-52=76</span> bits to guess. For this we use exhaustive search and, the total number of key guesses is <span class="math">2^{45+76}=2^{121}</span>.</p>`;
---

<BaseLayout title="Differential Analysis of Block Ciphers SIMON and SPECK (2014/922)">
  <article class="max-w-4xl mx-auto article-prose">
    <nav class="mb-8">
      <a href="/papers" class="text-blue-400 hover:text-blue-300">
        &larr; Back to Papers
      </a>
    </nav>

    <header class="mb-12">
      <h1 class="text-3xl font-bold mb-4"
        set:html={TITLE_HTML} />
      <p class="text-gray-400 mb-2"
        set:html={AUTHORS_HTML} />
      <p class="text-gray-500 text-sm mb-4">
        2014 &middot; eprint 2014/922
      </p>
      <div class="flex gap-4 text-sm">
        <a
          href={EPRINT_URL}
          target="_blank"
          rel="noopener noreferrer"
          class="text-blue-400 hover:text-blue-300"
        >
          Paper (eprint) &rarr;
        </a>
      </div>
      <p class="mt-4 text-xs text-gray-500">
        All content below belongs to the original authors. This page
        reproduces the paper for educational purposes. Always
        <a
          href={EPRINT_URL}
          target="_blank"
          rel="noopener noreferrer"
          class="text-blue-400 hover:text-blue-300"
        >cite the original</a>.
      </p>
      <p class="mt-1 text-xs text-gray-600">
        Converted with: {CRAWLER} &middot; {CONVERTED_DATE}
      </p>
    </header>

    <Fragment set:html={CONTENT} />

  </article>
</BaseLayout>
