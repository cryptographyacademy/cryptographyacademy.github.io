---
import BaseLayout from '../../layouts/BaseLayout.astro';

const EPRINT_URL = 'https://eprint.iacr.org/2004/305';
const CRAWLER = 'mistral';
const CONVERTED_DATE = '2026-02-16';
const TITLE_HTML = 'A note on efficient computation of cube roots in characteristic 3';
const AUTHORS_HTML = 'Paulo S.  L.  M.  Barreto';

const CONTENT = `    <p class="text-gray-300">Paulo S. L. M. Barreto¹</p>

    <p class="text-gray-300">Escola Politécnica, Universidade de São Paulo. Av. Prof. Luciano Gualberto, tr. 3, 158. BR 05508-900, São Paulo(SP), Brazil. pbarreto@larc.usp.br</p>

    <p class="text-gray-300">Abstract. The cost of the folklore algorithm for computing cube roots in <span class="math">\\mathbb{F}_{3^m}</span> in standard polynomial basis is less than one multiplication, but still <span class="math">O(m^2)</span>. Here we show that, if <span class="math">\\mathbb{F}_{3^m}</span> is represented in trinomial basis as <span class="math">\\mathbb{F}_3[x] / (x^m + ax^k + b)</span> with <span class="math">a, b = \\pm 1</span>, the actual cost of computing cube roots in <span class="math">\\mathbb{F}_{3^m}</span> is only <span class="math">O(m)</span>.</p>

    <p class="text-gray-300">The fastest method known for computing the Tate pairing on supersingular elliptic curves over <span class="math">\\mathbb{F}_{3^m}</span> is the Duursma-Lee algorithm [1], which involves the computation of cube roots in that finite field. An efficient folklore algorithm for cube root extraction in standard polynomial basis (described e.g. in [3, section 5.2], whereby taking roots reduces to two multiplications by constant field elements. Since the degree of one of the involved factors in each multiplication is at most <span class="math">m/3</span>, the overall cost of the "folklore" algorithm is actually about two thirds of one <span class="math">\\mathbb{F}_{3^m}</span> multiplication.</p>

    <p class="text-gray-300">While this algorithm improves upon other methods like solving a linear equation, it still takes <span class="math">O(m^2)</span> operations. It turns out, however, that further improvements are possible when <span class="math">\\mathbb{F}_{3^m}</span> is represented as <span class="math">\\mathbb{F}_3[x] / (x^m + ax^k + b)</span> with <span class="math">k \\equiv m \\pmod{3}</span>. Specifically, we will show that the other factors involved in the multiplications are a binomial and a trinomial, so that the incurred cost is only five shifts. Better yet, the degrees and the shift amounts are such that no reduction is needed (that is, all terms resulting from these operations have degrees smaller than <span class="math">m</span>).</p>

    <p class="text-gray-300">A similar technique has been devised to take square roots in characteristic 2 by Fong et al. [2]. Clearly, it also generalizes to higher characteristic <span class="math">p</span>, although the number of relevant cases allowed by the condition <span class="math">k \\equiv m \\pmod{p}</span> becomes quite restricted.</p>

    <p class="text-gray-300">We assume throughout this note that <span class="math">m</span> is prime and that <span class="math">\\mathbb{F}_{3^m}</span> is represented as <span class="math">\\mathbb{F}_3[x] / (x^m + ax^k + b)</span>, with <span class="math">a, b = \\pm 1</span>. As we will see, the folklore algorithm</p>

    <p class="text-gray-300">involves multiplications by <span class="math">x^{1/3}</span> and <span class="math">x^{2/3}</span>. The other factor in these products has degree not exceeding <span class="math">m/3</span>.</p>

    <p class="text-gray-300">For any <span class="math">c \\in \\mathbb{F}_{3^m}</span>, we denote by <span class="math">c^{\\ll n}</span> the value <span class="math">cx^n</span>, which is <span class="math">c</span> left-shifted by <span class="math">n</span> positions and suitably reduced when necessary.</p>

    <p class="text-gray-300">Let <span class="math">r = \\sum_{i=0}^{m-1} r_i x^i \\in \\mathbb{F}_{3^m}</span>. The goal is to compute <span class="math">\\sqrt[3]{r}</span>.</p>

    <h2 id="sec-4" class="text-2xl font-bold">2.1 Case <span class="math">m \\equiv 1</span> (mod 3)</h2>

    <p class="text-gray-300">Let <span class="math">m = 3u + 1</span>. The folklore algorithm reads:</p>

    <div class="my-4 text-center"><span class="math-block">\\begin{array}{l} r = \\sum_{i=0}^{m-1} r_i x^i \\\\ = \\sum_{i=0}^{u} r_{3i} x^{3i} + x \\cdot \\sum_{i=0}^{u-1} r_{3i+1} x^{3i} + x^2 \\cdot \\sum_{i=0}^{u-1} r_{3i+2} x^{3i}. \\end{array}</span></div>

    <div class="my-4 text-center"><span class="math-block">\\therefore \\sqrt[3]{r} = \\sum_{i=0}^{u} r_{3i} x^i + x^{1/3} \\cdot \\sum_{i=0}^{u-1} r_{3i+1} x^i + x^{2/3} \\cdot \\sum_{i=0}^{u-1} r_{3i+2} x^i.</span></div>

    <p class="text-gray-300">Defining <span class="math">c_0 = \\sum_{i=0}^{u} r_{3i} x^i</span>, <span class="math">c_1 = \\sum_{i=0}^{u-1} r_{3i+1} x^i</span>, <span class="math">c_2 = \\sum_{i=0}^{u-1} r_{3i+2} x^i</span>, we have simply <span class="math">\\sqrt[3]{r} = c_0 + x^{1/3} \\cdot c_1 + x^{2/3} \\cdot c_2</span>.</p>

    <h2 id="sec-5" class="text-2xl font-bold">2.2 Case <span class="math">m \\equiv 2</span> (mod 3)</h2>

    <p class="text-gray-300">Let <span class="math">m = 3u + 2</span>. The folklore algorithm reads:</p>

    <div class="my-4 text-center"><span class="math-block">\\begin{array}{l} r = \\sum_{i=0}^{m-1} r_i x^i \\\\ = \\sum_{i=0}^{u} r_{3i} x^{3i} + x \\cdot \\sum_{i=0}^{u} r_{3i+1} x^{3i} + x^2 \\cdot \\sum_{i=0}^{u} r_{3i+2} x^{3i}. \\end{array}</span></div>

    <div class="my-4 text-center"><span class="math-block">\\therefore \\sqrt[3]{r} = \\sum_{i=0}^{u} r_{3i} x^i + x^{1/3} \\cdot \\sum_{i=0}^{u} r_{3i+1} x^i + x^{2/3} \\cdot \\sum_{i=0}^{u} r_{3i+2} x^i.</span></div>

    <p class="text-gray-300">Defining <span class="math">c_0 = \\sum_{i=0}^{u} r_{3i} x^i</span>, <span class="math">c_1 = \\sum_{i=0}^{u} r_{3i+1} x^i</span>, <span class="math">c_2 = \\sum_{i=0}^{u} r_{3i+2} x^i</span>, we have simply <span class="math">\\sqrt[3]{r} = c_0 + x^{1/3} \\cdot c_1 + x^{2/3} \\cdot c_2</span>.</p>

    <h2 id="sec-6" class="text-2xl font-bold">3 Exploiting trinomial representation</h2>

    <p class="text-gray-300">Using a trinomial representation is advantageous for implementing modular reduction. We now show that a careful trinomial choice is also advantageous for taking cube roots when <span class="math">k \\equiv m \\pmod{3}</span>. We consider separately the cases <span class="math">m \\equiv 1 \\pmod{3}</span> and <span class="math">m \\equiv 2 \\pmod{3}</span>. Notice that in either case no modular reduction is needed, since all terms are smaller than <span class="math">m</span>.</p>

    <p class="text-gray-300">Let  <span class="math">m = 3u + 1</span>  and  <span class="math">k = 3v + 1</span> . We observe that  <span class="math">x^{3u + 1} + ax^{3v + 1} + b = 0 \\Rightarrow x^{2/3} = -bx^{u + 1} - abx^{v + 1} \\Rightarrow x^{1/3} = x^{2u + 1} - ax^{u + v + 1} + x^{2v + 1}</span> .</p>

    <p class="text-gray-300">Thus  <span class="math">\\sqrt[3]{r} = c_0 + x^{1/3} \\cdot c_1 + x^{2/3} \\cdot c_2 = c_0 + c_1 (x^{2u+1} - ax^{u+v+1} + x^{2v+1}) - c_2 (bx^{u+1} + abx^{v+1}) = c_0 + c_1^{\\ll 2u+1} - ac_1^{\\ll u+v+1} + c_1^{\\ll 2v+1} - bc_2^{\\ll u+1} - abc_2^{\\ll v+1}</span> .</p>

    <p class="text-gray-300">Let  <span class="math">m = 3u + 2</span>  and  <span class="math">k = 3v + 2</span> . We observe that  <span class="math">x^{3u + 2} + ax^{3v + 2} + b = 0 \\Rightarrow x^{1/3} = -bx^{u + 1} - abx^{v + 1} \\Rightarrow x^{2/3} = x^{2u + 2} - ax^{u + v + 2} + x^{2v + 2}</span> .</p>

    <p class="text-gray-300">Thus  <span class="math">\\sqrt[3]{r} = c_0 + x^{1/3} \\cdot c_1 + x^{2/3} \\cdot c_2 = c_0 - c_1 (bx^{u+1} + abx^{v+1}) + c_2 (x^{2u+2} - ax^{u+v+2} + x^{2v+2}) = c_0 - bc_1^{\\ll u+1} - abc_1^{\\ll v+1} + c_2^{\\ll 2u+2} - ac_2^{\\ll u+v+2} + c_2^{\\ll 2v+2}</span> .</p>

    <p class="text-gray-300">Several fields of interest for pairing-based cryptosystems admit an irreducible trinomial  <span class="math">x^{m} + ax^{k} + b</span>  with the optimal property  <span class="math">k \\equiv m \\pmod{3}</span> ; in table 1 we list a few with  <span class="math">a = 1</span>  and  <span class="math">b = -1</span> .</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">finite field</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">irreducible trinomial</th>

          </tr>

        </thead>

        <tbody>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">F397</td>

            <td class="px-3 py-2 border-b border-gray-700">x97 + x16 - 1</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">F3167</td>

            <td class="px-3 py-2 border-b border-gray-700">x167 + x92 - 1</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">F3193</td>

            <td class="px-3 py-2 border-b border-gray-700">x193 + x64 - 1</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">F3239</td>

            <td class="px-3 py-2 border-b border-gray-700">x239 + x26 - 1</td>

          </tr>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">Timings for the Duursma-Lee algorithm are given in table 2. These timings refer to a  <span class="math">\\mathrm{C}++</span>  implementation running on an Athlon XP 2GHz; the pairing algorithm itself was implemented according to the guidelines in [4]. We see that the overall pairing time decreases by about  <span class="math">10\\%</span>  with the use of trinomials.</p>

    <p class="text-gray-300">Table 1. Trinomials  <span class="math">{x}^{m} + {x}^{k} - 1</span>  such that  <span class="math">k \\equiv  m</span>  (mod 3).</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">finite field</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">plain</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">trinomial</th>

          </tr>

        </thead>

        <tbody>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">F397</td>

            <td class="px-3 py-2 border-b border-gray-700">4.828</td>

            <td class="px-3 py-2 border-b border-gray-700">4.328</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">F3167</td>

            <td class="px-3 py-2 border-b border-gray-700">27.047</td>

            <td class="px-3 py-2 border-b border-gray-700">24.625</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">F3193</td>

            <td class="px-3 py-2 border-b border-gray-700">33.922</td>

            <td class="px-3 py-2 border-b border-gray-700">31.062</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">F3239</td>

            <td class="px-3 py-2 border-b border-gray-700">63.562</td>

            <td class="px-3 py-2 border-b border-gray-700">57.344</td>

          </tr>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">Table 2. Timings of the Duursma-Lee (in ms).</p>

    <p class="text-gray-300">5 Conclusion</p>

    <p class="text-gray-300">We described an improvement for the folklore cube root algorithm in characteristic 3, an important operation for the efficient computation of the Tate pairing on supersingular elliptic curves. The complexity of our technique is only <span class="math">O(m)</span> rather than <span class="math">O(m^{2})</span>.</p>

    <h2 id="sec-10" class="text-2xl font-bold">6 Acknowledgements</h2>

    <p class="text-gray-300">We are grateful to Mike Scott for bringing <em>[2]</em> to our attention, and to Fré Vercauteren for pointing out the folklore status of the basic cube root algorithm.</p>

    <h2 id="sec-11" class="text-2xl font-bold">References</h2>

    <ul class="list-disc list-inside space-y-1 text-gray-300 my-2 ml-4">

      <li>[1] I. Duursma and H.-S. Lee. Tate pairing implementation for hyperelliptic curves <span class="math">y^{2}=x^{p}-x+d</span>. In Advances in Cryptology – Asiacrypt’2003, volume 2894 of Lecture Notes in Computer Science, pages 111–123, Taipei, Taiwan, 2003. Springer-Verlag.</li>

      <li>[2] K. Fong, D. Hankerson, J. López, and A. Menezes. Field inversion and point halving revisited. Technical report CORR 2003-18, University of Waterloo, 2002.</li>

      <li>[3] R. Granger, D. Page, and M. Stam. Hardware and software normal basis arithmetic for pairing based cryptography in characteristic three. Cryptology ePrint Archive, Report 2004/157, 2004.</li>

      <li>[4] M. Scott and Paulo S. L. M. Barreto. Compressed pairings. In Proceedings, Lecture Notes in Computer Science, Santa Barbara, USA, 2004. Advances in Cryptology – Crypto’2004, Springer-Verlag. to appear.</li>

    </ul>`;
---

<BaseLayout title="A note on efficient computation of cube roots in characteris... (2004/305)">
  <article class="max-w-4xl mx-auto article-prose">
    <nav class="mb-8">
      <a href="/papers" class="text-blue-400 hover:text-blue-300">
        &larr; Back to Papers
      </a>
    </nav>

    <header class="mb-12">
      <h1 class="text-3xl font-bold mb-4"
        set:html={TITLE_HTML} />
      <p class="text-gray-400 mb-2"
        set:html={AUTHORS_HTML} />
      <p class="text-gray-500 text-sm mb-4">
        2004 &middot; eprint 2004/305
      </p>
      <div class="flex gap-4 text-sm">
        <a
          href={EPRINT_URL}
          target="_blank"
          rel="noopener noreferrer"
          class="text-blue-400 hover:text-blue-300"
        >
          Paper (eprint) &rarr;
        </a>
      </div>
      <p class="mt-4 text-xs text-gray-500">
        All content below belongs to the original authors. This page
        reproduces the paper for educational purposes. Always
        <a
          href={EPRINT_URL}
          target="_blank"
          rel="noopener noreferrer"
          class="text-blue-400 hover:text-blue-300"
        >cite the original</a>.
      </p>
      <p class="mt-1 text-xs text-gray-600">
        Converted with: {CRAWLER} &middot; {CONVERTED_DATE}
      </p>
    </header>

    <Fragment set:html={CONTENT} />

  </article>
</BaseLayout>
