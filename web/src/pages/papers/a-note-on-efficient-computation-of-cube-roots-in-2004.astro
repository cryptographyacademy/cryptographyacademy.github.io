---
import BaseLayout from '../../layouts/BaseLayout.astro';
import PaperDisclaimer from '../../components/PaperDisclaimer.astro';
import PaperHistory from '../../components/PaperHistory.astro';

const EPRINT_URL = 'https://eprint.iacr.org/2004/305';
const CRAWLER = 'modal-marker';
const CONVERTED_DATE = '2026-02-17';
const TITLE_HTML = 'A note on efficient computation of cube roots in characteristic 3';
const AUTHORS_HTML = 'Paulo S. L. M. Barreto&lt;sup&gt;1&lt;/sup&gt;';

const CONTENT = `    <p class="text-gray-300">Paulo S. L. M. Barreto&lt;sup&gt;1&lt;/sup&gt;</p>

    <p class="text-gray-300">Escola Politécnica, Universidade de São Paulo. Av. Prof. Luciano Gualberto, tr. 3, 158. BR 05508-900, São Paulo(SP), Brazil. pbarreto@larc.usp.br</p>

    <p class="text-gray-300"><strong>Abstract.</strong> The cost of the folklore algorithm for computing cube roots in  <span class="math">\\mathbb{F}_{3^m}</span>  in standard polynomial basis is less that one multiplication, but still  <span class="math">O(m^2)</span> . Here we show that, if  <span class="math">\\mathbb{F}_{3^m}</span>  is represented in trinomial basis as  <span class="math">\\mathbb{F}_3[x]/(x^m + ax^k + b)</span>  with  <span class="math">a, b = \\pm 1</span> , the actual cost of computing cube roots in  <span class="math">\\mathbb{F}_{3^m}</span>  is only O(m).</p>

    <h4 id="sec-1" class="text-lg font-semibold mt-6">1 Introduction</h4>

    <p class="text-gray-300">The fastest method known for computing the Tate pairing on supersingular elliptic curves over  <span class="math">\\mathbb{F}_{3^m}</span>  is the Duursma-Lee algorithm [1], which involves the computation of cube roots in that finite field. An efficient foklore algorithm for cube root extraction in standard polynomial basis (described e.g. in [3, section 5.2], whereby taking roots reduces to two multiplications by constant field elements. Since the degree of one of the involved factors in each multiplication is at most m/3, the overall cost of the &quot;folklore&quot; algorithm is actually about two thirds of one  <span class="math">\\mathbb{F}_{3^m}</span>  multiplication.</p>

    <p class="text-gray-300">While this algorithm improves upon other methods like solving a linear equation, it still takes  <span class="math">O(m^2)</span>  operations. It turns out, however, that further improvements are possible when  <span class="math">\\mathbb{F}_{3^m}</span>  is represented as  <span class="math">\\mathbb{F}_3[x]/(x^m + ax^k + b)</span>  with  <span class="math">k \\equiv m \\pmod{3}</span> . Specifically, we will show that the <em>other</em> factors involved in the multiplications are a binomial and a trinomial, so that the incurred cost is only five shifts. Better yet, the degrees and the shift amounts are such that no reduction is needed (that is, all terms resulting from these operations have degrees smaller than m).</p>

    <p class="text-gray-300">A similar technique has been devised to take square roots in characteristic 2 by Fong et al. [2]. Clearly, it also generalizes to higher characteristic p, although the number of relevant cases allowed by the condition  <span class="math">k \\equiv m \\pmod p</span>  becomes quite restricted.</p>

    <h3 id="sec-2" class="text-xl font-semibold mt-8">2 The folklore algorithm</h3>

    <p class="text-gray-300">We assume throughout this note that m is prime and that  <span class="math">\\mathbb{F}_{3^m}</span>  is represented as  <span class="math">\\mathbb{F}_3[x]/(x^m + ax^k + b)</span> , with  <span class="math">a, b = \\pm 1</span> . As we will see, the folklore algorithm</p>

    <p class="text-gray-300">involves multiplications by  <span class="math">x^{1/3}</span>  and  <span class="math">x^{2/3}</span> . The other factor in these products has degree not exceeding m/3.</p>

    <p class="text-gray-300">For any  <span class="math">c \\in \\mathbb{F}_{3^m}</span> , we denote by  <span class="math">c^{\\ll n}</span>  the value  <span class="math">cx^n</span> , which is c left-shifted by n positions and suitably reduced when necessary. Let  <span class="math">r = \\sum_{i=0}^{m-1} r_i x^i \\in \\mathbb{F}_{3^m}</span> . The goal is to compute  <span class="math">\\sqrt[3]{r}</span> .</p>

    <h4 id="sec-3" class="text-lg font-semibold mt-6">Case <span class="math">m \\equiv 1 \\pmod{3}</span></h4>

    <p class="text-gray-300">Let m = 3u + 1. The folklore algorithm reads:</p>

    <p class="text-gray-300"><span class="math">$r = \\sum_{i=0}^{m-1} r_i x^i</span>$</p>

    <p class="text-gray-300"><span class="math">$= \\sum_{i=0}^{u} r_{3i} x^{3i} + x \\cdot \\sum_{i=0}^{u-1} r_{3i+1} x^{3i} + x^2 \\cdot \\sum_{i=0}^{u-1} r_{3i+2} x^{3i}.</span>$</p>

    <p class="text-gray-300"><span class="math">$\\therefore \\sqrt[3]{r} = \\sum_{i=0}^{u} r_{3i} x^i + x^{1/3} \\cdot \\sum_{i=0}^{u-1} r_{3i+1} x^i + x^{2/3} \\cdot \\sum_{i=0}^{u-1} r_{3i+2} x^i.</span>$</p>

    <p class="text-gray-300">Defining  <span class="math">c_0 = \\sum_{i=0}^u r_{3i} x^i</span> ,  <span class="math">c_1 = \\sum_{i=0}^{u-1} r_{3i+1} x^i</span> ,  <span class="math">c_2 = \\sum_{i=0}^{u-1} r_{3i+2} x^i</span> , we have simply  <span class="math">\\sqrt[3]{r} = c_0 + x^{1/3} \\cdot c_1 + x^{2/3} \\cdot c_2</span> .</p>

    <h2 id="sec-4" class="text-2xl font-bold">2.2 Case <span class="math">m \\equiv 2 \\pmod{3}</span></h2>

    <p class="text-gray-300">Let m = 3u + 2. The folklore algorithm reads:</p>

    <p class="text-gray-300"><span class="math">$r = \\sum_{i=0}^{m-1} r_i x^i</span>$</p>

    <p class="text-gray-300"><span class="math">$= \\sum_{i=0}^{u} r_{3i} x^{3i} + x \\cdot \\sum_{i=0}^{u} r_{3i+1} x^{3i} + x^2 \\cdot \\sum_{i=0}^{u} r_{3i+2} x^{3i}.</span>$</p>

    <p class="text-gray-300"><span class="math">$\\therefore \\sqrt[3]{r} = \\sum_{i=0}^{u} r_{3i} x^i + x^{1/3} \\cdot \\sum_{i=0}^{u} r_{3i+1} x^i + x^{2/3} \\cdot \\sum_{i=0}^{u} r_{3i+2} x^i.</span>$</p>

    <p class="text-gray-300">Defining  <span class="math">c_0 = \\sum_{i=0}^u r_{3i} x^i</span> ,  <span class="math">c_1 = \\sum_{i=0}^u r_{3i+1} x^i</span> ,  <span class="math">c_2 = \\sum_{i=0}^u r_{3i+2} x^i</span> , we have simply  <span class="math">\\sqrt[3]{r} = c_0 + x^{1/3} \\cdot c_1 + x^{2/3} \\cdot c_2</span> .</p>

    <h4 id="sec-5" class="text-lg font-semibold mt-6">Exploiting trinomial representation</h4>

    <p class="text-gray-300">Using a trinomial representation is advantageous for implementing modular reduction. We now show that a careful trinomial choice is also advantageous for taking cube roots when  <span class="math">k \\equiv m \\pmod{3}</span> . We consider separately the cases  <span class="math">m \\equiv 1</span>  <span class="math">\\pmod{3}</span>  and  <span class="math">m \\equiv 2 \\pmod{3}</span> . Notice that in either case no modular reduction is needed, since all terms are smaller than m.</p>

    <h4 id="sec-6" class="text-lg font-semibold mt-6">3.1 Case <span class="math">m \\equiv 1 \\pmod{3}</span> , <span class="math">k \\equiv 1 \\pmod{3}</span></h4>

    <p class="text-gray-300">Let m=3u+1 and k=3v+1. We observe that  <span class="math">x^{3u+1}+ax^{3v+1}+b=0 \\implies x^{2/3}=-bx^{u+1}-abx^{v+1} \\implies x^{1/3}=x^{2u+1}-ax^{u+v+1}+x^{2v+1}.</span> Thus  <span class="math">\\sqrt[3]{r}=c_0+x^{1/3}\\cdot c_1+x^{2/3}\\cdot c_2=c_0+c_1(x^{2u+1}-ax^{u+v+1}+x^{2v+1})-c_2(bx^{u+1}+abx^{v+1})=c_0+c_1^{\\ll 2u+1}-ac_1^{\\ll u+v+1}+c_1^{\\ll 2v+1}-bc_2^{\\ll u+1}-abc_2^{\\ll v+1}.</span></p>

    <h2 id="sec-7" class="text-2xl font-bold">3.2 Case <span class="math">m \\equiv 2 \\pmod{3}</span> , <span class="math">k \\equiv 2 \\pmod{3}</span></h2>

    <p class="text-gray-300">Let
<span class="math">$m=3u+2</span>$
and  <span class="math">k=3v+2</span> . We observe that  <span class="math">x^{3u+2}+ax^{3v+2}+b=0 \\implies x^{1/3}=-bx^{u+1}-abx^{v+1} \\implies x^{2/3}=x^{2u+2}-ax^{u+v+2}+x^{2v+2}.</span>  Thus  <span class="math">\\sqrt[3]{r}=c_0+x^{1/3}\\cdot c_1+x^{2/3}\\cdot c_2=c_0-c_1(bx^{u+1}+abx^{v+1})+c_2(x^{2u+2}-ax^{u+v+2}+x^{2v+2})=c_0-bc_1^{\\leqslant u+1}-abc_1^{\\leqslant v+1}+c_2^{\\leqslant 2u+2}-ac_2^{\\leqslant u+v+2}+c_2^{\\leqslant 2v+2}.</span></p>

    <h2 id="sec-8" class="text-2xl font-bold">4 Examples</h2>

    <p class="text-gray-300">Several fields of interest for pairing-based cryptosystems admit an irreducible trinomial  <span class="math">x^m + ax^k + b</span>  with the optimal property  <span class="math">k \\equiv m \\pmod 3</span> ; in table 1 we list a few with a = 1 and b = -1.</p>

    <div class="overflow-x-auto my-4">
      <table class="min-w-full text-sm text-gray-300">
        <thead>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">finite field</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">irreducible trinomial</th>
        </thead>
        <tbody>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">\\mathbb{F}_{3^{97}}</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">x^{97} + x^{16} - 1</span></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">\\mathbb{F}_{3^{167}}</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">x^{167} + x^{92} - 1</span></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">\\mathbb{F}_{3^{193}}</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">x^{193} + x^{64} - 1</span></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">\\mathbb{F}_{3^{239}}</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">x^{239} + x^{26} - 1</span></td>
          </tr>
        </tbody>
      </table>
    </div>

    <p class="text-gray-300"><strong>Table 1.</strong> Trinomials  <span class="math">x^m + x^k - 1</span>  such that  <span class="math">k \\equiv m \\pmod{3}</span> .</p>

    <p class="text-gray-300">Timings for the Duursma-Lee algorithm are given in table 2. These timings refer to a C++ implementation running on an Athlon XP 2GHz; the pairing algorithm itself was implemented according to the guidelines in [4]. We see that the overall pairing time decreases by about 10% with the use of trinomials.</p>

    <div class="overflow-x-auto my-4">
      <table class="min-w-full text-sm text-gray-300">
        <thead>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">finite field</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">plain</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">trinomial</th>
        </thead>
        <tbody>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">\\mathbb{F}_{3^{97}}</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">4.828</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">4.328</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">\\mathbb{F}_{3^{167}}</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">27.047</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">24.625</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">\\mathbb{F}_{3^{193}}</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">33.922</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">31.062</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">\\mathbb{F}_{3^{239}}</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">63.562</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">57.344</td>
          </tr>
        </tbody>
      </table>
    </div>

    <p class="text-gray-300">Table 2. Timings of the Duursma-Lee (in ms).</p>

    <p class="text-gray-300">We described an improvement for the folklore cube root algorithm in characteristic 3, an important operation for the efficient computation of the Tate pairing on supersingular elliptic curves. The complexity of our technique is only O(m) rather than O(m&lt;sup&gt;2&lt;/sup&gt; ).</p>

    <p class="text-gray-300">We are grateful to Mike Scott for bringing [2] to our attention, and to Fr´e Vercauteren for pointing out the folklore status of the basic cube root algorithm.</p>

    <ul class="list-disc list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li><ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li>I. Duursma and H.-S. Lee. Tate pairing implementation for hyperelliptic curves y &lt;sup&gt;2&lt;/sup&gt; = x &lt;sup&gt;p&lt;/sup&gt; − x + d. In Advances in Cryptology – Asiacrypt'2003, volume 2894 of Lecture Notes in Computer Science, pages 111–123, Taipei, Taiwan, 2003. Springer-Verlag.</li>
    </ol></li>
      <li><ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li>K. Fong, D. Hankerson, J. L´opez, and A. Menezes. Field inversion and point halving revisited. Technical report CORR 2003-18, University of Waterloo, 2002.</li>
    </ol></li>
      <li><ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li>R. Granger, D. Page, and M. Stam. Hardware and software normal basis arithmetic for pairing based cryptography in characteristic three. Cryptology ePrint Archive, Report 2004/157, 2004.</li>
    </ol></li>
      <li><ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li>M. Scott and Paulo S. L. M. Barreto. Compressed pairings. In Proceedings, Lecture Notes in Computer Science, Santa Barbara, USA, 2004. Advances in Cryptology – Crypto'2004, Springer-Verlag. to appear.</li>
    </ol></li>
    </ul>

`;
---

<BaseLayout title="A note on efficient computation of cube roots in characteris... (2004/305)">
  <article class="max-w-4xl mx-auto article-prose">
    <nav class="mb-8">
      <a href="/papers" class="text-blue-400 hover:text-blue-300">
        &larr; Back to Papers
      </a>
    </nav>

    <header class="mb-12">
      <h1 class="text-3xl font-bold mb-4"
        set:html={TITLE_HTML} />
      <p class="text-gray-400 mb-2"
        set:html={AUTHORS_HTML} />
      <p class="text-gray-500 text-sm mb-4">
        2004 &middot; eprint 2004/305
      </p>
      <div class="flex gap-4 text-sm">
        <a
          href={EPRINT_URL}
          target="_blank"
          rel="noopener noreferrer"
          class="text-blue-400 hover:text-blue-300"
        >
          Paper (eprint) &rarr;
        </a>
      </div>
      <PaperDisclaimer eprintUrl={EPRINT_URL} />
      <p class="mt-1 text-xs text-gray-600">
        Converted with: {CRAWLER} &middot; {CONVERTED_DATE}
      </p>
    </header>

    <Fragment set:html={CONTENT} />

    <PaperHistory slug="a-note-on-efficient-computation-of-cube-roots-in-2004" />
  </article>
</BaseLayout>
