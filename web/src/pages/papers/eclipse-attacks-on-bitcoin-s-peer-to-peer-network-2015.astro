---
import BaseLayout from '../../layouts/BaseLayout.astro';
import PaperDisclaimer from '../../components/PaperDisclaimer.astro';
import PaperHistory from '../../components/PaperHistory.astro';

const EPRINT_URL = 'https://eprint.iacr.org/2015/263';
const CRAWLER = 'marker';
const CONVERTED_DATE = '2026-02-19';
const TITLE_HTML = 'Eclipse Attacks on Bitcoin&rsquo;s Peer-to-Peer Network';
const AUTHORS_HTML = 'Ethan Heilman, Alison Kendler, Aviv Zohar, Sharon Goldberg';

const CONTENT = `    <section id="abstract" class="mb-10">
      <h2 class="text-2xl font-bold">Abstract</h2>
      <p class="text-gray-300">We present eclipse attacks on bitcoin&rsquo;s peer-to-peer network. Our attack allows an adversary controlling a sufficient number of IP addresses to monopolize all connections to and from a victim bitcoin node. The attacker can then exploit the victim for attacks on bitcoin&rsquo;s mining and consensus system, including N-confirmation double spending, selfish mining, and adversarial forks in the blockchain. We take a detailed look at bitcoin&rsquo;s peer-to-peer network, and quantify the resources involved in our attack via probabilistic analysis, Monte Carlo simulations, measurements and experiments with live bitcoin nodes. Finally, we present countermeasures, inspired by botnet architectures, that are designed to raise the bar for eclipse attacks while preserving the openness and decentralization of bitcoin&rsquo;s current network architecture.</p>
      <p class="text-gray-300"><strong>Keywords:</strong> Bitcoin &middot; P2P &middot; Networking &middot; Eclipse &middot; Double-spend</p>
    </section>

    <section id="sec-1" class="mb-10">
      <h2 class="text-2xl font-bold">1 Introduction</h2>

    <p class="text-gray-300">While cryptocurrency has been studied since the 1980s <a href="#page-14-0">[22,</a> <a href="#page-14-1">25,</a> <a href="#page-14-2">28]</a>, bitcoin is the first to see widespread adoption.A key reason for bitcoin's success is its bakedin decentralization. Instead of using a central bank to regulate currency, bitcoin uses a decentralized network of nodes that use computational proofs-of-work to reach consensus on a distributed public ledger of transactions, <em>aka.,</em> the <em>blockchain</em>. Satoshi Nakamoto <a href="#page-15-0">[52]</a> argues that bitcoin is secure against attackers that seek to shift the blockchain to an inconsistent/incorrect state, as long as these attackers control less than half of the computational power in the network. But underlying this security analysis is the crucial assumption of <em>perfect information</em>; namely, that all members of the bitcoin ecosystem can observe the proofs-of-work done by their peers.</p>

    <p class="text-gray-300">&lowast;This is the full version of a paper that appeared at 24th USENIX Security Symposium, Washington, DC., August 2015. First posted March 20, 2015; updated July 2, 2015.</p>

    <p class="text-gray-300">While the last few years have seen extensive research into the security of bitcoin's computational proof-ofwork protocol <em>e.g.,</em> <a href="#page-14-3">[14,</a> <a href="#page-14-4">29,</a> <a href="#page-14-5">36,</a> <a href="#page-14-6">37,</a> <a href="#page-15-1">45,</a> <a href="#page-15-2">49,</a> <a href="#page-15-3">50,</a> <a href="#page-15-0">52,</a> <a href="#page-15-4">58,</a> <a href="#page-15-5">60]</a>, less attention has been paid to the peer-to-peer network used to broadcast information between bitcoin nodes (see Section <a href="#page-13-0">8)</a>. The bitcoin peer-to-peer network, which is bundled into the core bitcoind implementation, <em>aka.,</em> the Satoshi client, is designed to be open, decentralized, and independent of a public-key infrastructure. As such, cryptographic authentication between peers is not used, and nodes are identified by their IP addresses (Section <a href="#page-2-0">2)</a>. Each node uses a randomized protocol to select eight peers with which it forms long-lived <em>outgoing connections</em>, and to propagate and store addresses of other potential peers in the network. Nodes with public IPs also accept up to 117 <em>unsolicited incoming connections</em> from any IP address. Nodes exchange views of the state of the blockchain with their incoming and outgoing peers.</p>

    <p class="text-gray-300">Eclipse attacks. This openness, however, also makes it possible for adversarial nodes to join and attack the peerto-peer network. In this paper, we present and quantify the resources required for <em>eclipse attacks</em> on nodes with public IPs running bitcoind version 0.9.3. In an eclipse attack <a href="#page-14-7">[27,</a> <a href="#page-15-6">61,</a> <a href="#page-15-7">62]</a>, the attacker monopolizes all of the victim's incoming and outgoing connections, thus isolating the victim from the rest of its peers in the network. The attacker can then filter the victim's view of the blockchain, force the victim to waste compute power on obsolete views of the blockchain, or coopt the victim's compute power for its own nefarious purposes (Section <a href="#page-1-0">1.1)</a>. We present <em>off-path</em> attacks, where the attacker controls endhosts, but not key network infrastructure between the victim and the rest of the bitcoin network. Our attack involves rapidly and repeatedly forming unsolicited incoming connections to the victim from a set of endhosts at attacker-controlled IP addresses, sending bogus network information, and waiting until the victim restarts (Section <a href="#page-4-0">3)</a>. With high probability, the victim then forms all eight of its outgoing connections to</p>

    <p class="text-gray-300">attacker-controlled addresses, and the attacker also monopolizes the victim's 117 incoming connections.</p>

    <p class="text-gray-300">Our eclipse attack uses extremely low-rate TCP connections, so the main challenge for the attacker is to obtain a sufficient number of IP addresses (Section 4). We consider two attack types: (1) infrastructure attacks, modeling the threat of an ISP, company, or nation-state that holds several contiguous IP address blocks and seeks to subvert bitcoin by attacking its peer-to-peer network, and (2) botnet attacks, launched by bots with addresses in diverse IP address ranges. We use probabilistic analysis, (Section 4) measurements (Section 5), and experiments on our own live bitcoin nodes (Section 6) to find that while botnet attacks require far fewer IP addresses, there are hundreds of organizations that have sufficient IP resources to launch eclipse attacks (Section 4.2.1). For example, we show how an infrastructure attacker with 32 distinct /24 IP address blocks (8192 address total), or a botnet of 4600 bots, can always eclipse a victim with at least 85% probability; this is independent of the number of nodes in the network. Moreover, 400 bots sufficed in tests on our live bitcoin nodes. To put this in context, if 8192 attack nodes joined today's network (containing  <span class="math">\\approx</span>  7200 public-IP nodes [4]) and honestly followed the peer-to-peer protocol, they could eclipse a target with probability about  <span class="math">(\\frac{8192}{7200+8192})^8 = 0.6\\%</span> .</p>

    <p class="text-gray-300">Our attack is only for nodes with public IPs; nodes with private IPs may be affected if all of their outgoing connections are to eclipsed public-IP nodes.</p>

    <p class="text-gray-300">Countermeasures. Large miners, merchant clients and online wallets have been known to modify bitcoin's networking code to reduce the risk of networkbased attacks. Two countermeasures are typically recommended [3]: (1) disabling incoming connections, and (2) choosing 'specific' outgoing connections to well-connected peers or known miners (<em>i.e.</em>, use whitelists). However, there are several problems with scaling this to the full bitcoin network. First, if incoming connections are banned, how do new nodes join the network? Second, how does one decide which 'specific' peers to connect to? Should bitcoin nodes form a private network? If so, how do they ensure compute power is sufficiently decentralized to prevent mining attacks?</p>

    <p class="text-gray-300">Indeed, if bitcoin is to live up to its promise as an open and decentralized cryptocurrency, we believe its peer-to-peer network should be open and decentralized as well. Thus, our next contribution is a set of countermeasures that preserve openness by allowing unsolicited incoming connections, while raising the bar for eclipse attacks (Section 7). Today, an attacker with enough addresses can eclipse <em>any</em> victim that accepts incoming connections and then restarts. Our countermeasures ensure that, with high probability, if a victim stores enough legitimate addresses that accept incoming connections, then the vic-</p>

    <p class="text-gray-300">tim be cannot eclipsed <em>regardless of the number of IP</em> addresses the attacker controls. Our countermeasures 1, 2, and 6 have been deployed in bitcoind v0.10.1; we also developed a patch [40] with Countermeasures 3,4.</p>

    <p class="text-gray-300">Apart from disrupting the bitcoin network or selectively filtering a victim's view of the blockchain, eclipse attacks are a useful building block for other attacks.</p>

    <p class="text-gray-300">Engineering block races. A block race occurs when two miners discover blocks at the same time; one block will become part of the blockchain, while the other &quot;orphan block&quot; will be ignored, yielding no mining rewards for the miner that discovered it. An attacker that eclipses many miners can engineer block races by hording blocks discovered by eclipsed miners, and releasing blocks to both the eclipsed and non-eclipsed miners once a competing block has been found. Thus, the eclipsed miners waste effort on orphan blocks.</p>

    <p class="text-gray-300"><strong>Splitting mining power.</strong> Eclipsing an <em>x</em>-fraction of miners eliminates their mining power from the rest of the network, making it easier to launch mining attacks (<em>e.g.</em>, the 51% attack [52]). To hide the change in mining power under natural variations [19], miners could be eclipsed gradually or intermittently.</p>

    <p class="text-gray-300"><strong>Selfish mining.</strong> With selfish mining [14, 29, 37, 60], the attacker strategically withholds blocks to win more than its fair share of mining rewards. The attack's success is parameterized by two values:  <span class="math">\\alpha</span> , the ratio of mining power controlled by the attacker, and  <span class="math">\\gamma</span> , the ratio of honest mining power that will mine on the attacker's blocks during a block race. If  <span class="math">\\gamma</span>  is large, then  <span class="math">\\alpha</span>  can be small. By eclipsing miners, the attacker increases  <span class="math">\\gamma</span> , and thus decreases  <span class="math">\\alpha</span>  so that selfish mining is easier. To do this, the attacker drops any blocks discovered by eclipsed miners that compete with the blocks discovered by the selfish miners. Next, the attacker increases  <span class="math">\\gamma</span>  by feeding only the selfish miner's view of the blockchain to the eclipsed miner; this coopts the eclipsed miner's compute power, using it to mine on the selfish-miner's blockchain.</p>

    <p class="text-gray-300">Attacks on miners can harm the entire bitcoin ecosystem; mining pools are also vulnerable if their gateways to the public bitcoin network can be eclipsed. Eclipsing can also be used for double-spend attacks on non-miners, where the attacker spends some bitcoins multiple times:</p>

    <p class="text-gray-300"><strong>0-confirmation double spend.</strong> In a 0-confirmation transaction, a customer pays a transaction to a merchant who releases goods to the customer <em>before</em> seeing a block confirmation <em>i.e.</em>, seeing the transaction in the blockchain [18]. These transactions are used when it is inappropriate to wait the 5-10 minutes typically needed</p>

    <p class="text-gray-300">to for a block confirmation <a href="#page-14-12">[20]</a>, <em>e.g.,</em> in retail point-ofsale systems like BitPay <a href="#page-14-13">[5]</a>, or online gambling sites like Betcoin <a href="#page-15-9">[57]</a>. To launch a double-spend attack against the merchant <a href="#page-15-10">[46]</a>, the attacker eclipses the merchant's bitcoin node, sends the merchant a transaction <em>T</em> for goods, and sends transaction <em>T</em> <sup>0</sup> double-spending those bitcoins to the rest of the network. The merchant releases the goods to the attacker, but since the attacker controls all of the merchant's connections, the merchant cannot tell the rest of the network about <em>T</em>, which meanwhile confirms <em>T</em> 0 . The attacker thus obtains the goods without paying. 0-confirmation double-spends have occurred in the wild <a href="#page-15-9">[57]</a>. This attack is as effective as a Finney attack <a href="#page-15-11">[39]</a>, but uses eclipsing instead of mining power.</p>

    <p class="text-gray-300"><em>N</em>-confirmation double spend. If the attacker has eclipsed an <em>x</em>-fraction of miners, it can also launch <em>N</em>-confirmation double-spending attacks on an eclipsed merchant. In an <em>N</em>-confirmation transaction, a merchant releases goods only after the transaction is confirmed in a block of depth <em>N</em> &minus;1 in the blockchain <a href="#page-14-11">[18]</a>. The attacker sends its transaction to the eclipsed miners, who incorporate it into their (obsolete) view of the blockchain. The attacker then shows this view of blockchain to the eclipsed merchant, receives the goods, and sends both the merchant and eclipsed miners the (non-obsolete) view of blockchain from the non-eclipsed miners. The eclipsed miners' blockchain is orphaned, and the attacker obtains goods without paying. This is similar to an attack launched by a mining pool <a href="#page-14-14">[10]</a>, but our attacker eclipses miners instead of using his own mining power.</p>

    <p class="text-gray-300">Other attacks exist, <em>e.g.,</em> a transaction hiding attack on nodes running in SPV mode <a href="#page-14-15">[16]</a>.</p>

    <p class="text-gray-300">We now describe bitcoin's peer-to-peer network, based on bitcoind version 0.9.3, the most current release from 9/27/2014 to 2/16/2015, whose networking code was largely unchanged since 2013. This client was originally written by Satoshi Nakamoto, and has near universal market share for public-IP nodes (97% of public-IP nodes according to Bitnode.io on 2/11/2015 <a href="#page-14-8">[4]</a>).</p>

    <p class="text-gray-300">Peers in the bitcoin network are identified by their IP addresses. A node with a public IP can initiate up to <em>eight outgoing connections</em> with other bitcoin nodes, and accept up to 117 <em>incoming connections</em>. <a href="#page-2-1">1</a> A node with a private IP only initiates eight outgoing connections. Connections are over TCP. Nodes only propagate and store public IPs; a node can determine if its peer has a public IP by comparing the IP packet header with the bitcoin VERSION message. A node can also connect via Tor; we do not study this, see <a href="#page-14-15">[16,</a> <a href="#page-14-16">17]</a> instead. We now describe how nodes propagate and store network information, and how they select outgoing connections.</p>

    <p class="text-gray-300">Network information propagates through the bitcoin network via DNS seeders and ADDR messages.</p>

    <p class="text-gray-300">DNS seeders. A DNS seeder is a server that responds to DNS queries from bitcoin nodes with a (not cryptographically-authenticated) list of IP addresses for bitcoin nodes. The size of the list is limited by constraints on DNS; it turns that the maximum possible number of IP addresses that can be returned by a single DNS query is around 4000 <a href="#page-15-13">[41]</a>. The seeder obtains these addresses by periodically crawling the bitcoin network. The bitcoin network has six seeders which are queried in two cases only. The first when a new node joins the network for the first time; it tries to connect to the seeders to get a list of active IPs, and otherwise fails over to a hardcoded list of about 600 IP addresses. The second is when an existing node restarts and reconnects to new peers; here, the seeder is queried only if 11 seconds have elapsed since the node began attempting to establish connections and the node has less than two outgoing connections.</p>

    <p class="text-gray-300">ADDR messages. ADDR messages, containing up to 1000 IP address and their timestamps, are used to obtain network information from peers. If more than 1000 addresses are sent in a ADDR message, the peer who sent the message is blacklisted. Nodes accept unsolicited ADDR messages. An ADDR message is solicited <em>only</em> upon establishing a outgoing connection with a peer; the peer responds with up to three ADDR message each containing up to 1000 addresses randomly selected from its tables.<a href="#page-2-2">2</a></p>

    <p class="text-gray-300">Nodes push ADDR messages to peers in two cases. Each day, a node sends its own IP address in a ADDR message to each peer. Also, when a node receives an ADDR message with no more than 10 addresses, it forwards the ADDR message to two randomly-selected connected peers.<a href="#page-2-3">3</a> To choose these peers, the node takes the hash of each connected peer's IP address and a secret nonce associated with the day, selects the peers with the lexicographically first and second hash values. Finally, to prevent stale ADDR messages from endlessly propagating, each node keeps a known list of the addresses it has sent to or learned from each of its connected peers, and never sends address on the known list to its peer. The known lists are flushed daily.</p>

    <p class="text-gray-300"><sup>1</sup>This is a configurable. Our analysis only assumes that nodes have 8 outgoing connections, which was confirmed by <a href="#page-15-12">[51]</a>'s measurements.</p>

    <p class="text-gray-300"><sup>2</sup>The peer sends a total of <em>n</em> randomly selected addresses from the peer's tried and new tables, where <em>n</em> is a random number between <em>x</em> and 2500, where <em>x</em> is 23% of the addresses the peer has stored.</p>

    <p class="text-gray-300"><sup>3</sup>Actually, if the ADDR message contains addresses that are unroutable for the peer (<em>e.g.,</em> a peer with IPv4 address gets an IPv6 address, it will forward the ADDR message to one peer only.</p>

      <h3 id="sec-2.2" class="text-xl font-semibold mt-8">2.2 Storing network information</h3>

    <p class="text-gray-300">Public IPs are stored in a node's tried and new tables. Tables are stored on disk and persist when a node restarts.</p>

    <p class="text-gray-300"><strong>The</strong> tried <strong>table.</strong> The tried table consists of 64 <em>buckets</em>, each of which can store up to 64 unique addresses for peers to whom the node has successfully established an incoming or outgoing connection. Along with each stored peer's address, the node keeps the timestamp for the most recent successful connection to this peer.</p>

    <p class="text-gray-300">Each peer's address is mapped to a bucket in tried by taking the hash of the peer's (a) IP address and (b) <em>group</em>, where the group defined is the /16 IPv4 prefix containing the peer's IP address. <sup>4</sup>A bucket is selected as follows:</p>

    <pre><code class="language-text">SK = random value chosen when node is born. IP = the peer&#x27;s IP address and port number. Group = the peer&#x27;s group
</code></pre>

    <pre><code class="language-text">i = Hash( SK, IP ) % 4
Bucket = Hash( SK, Group, i ) % 64
return Bucket
</code></pre>

    <p class="text-gray-300">Thus, every IP address maps to a single bucket in tried, and each group maps to up to four buckets.</p>

    <p class="text-gray-300">When a node successfully connects to a peer, the peer's address is inserted into the appropriate tried bucket. If the bucket is full (<em>i.e.</em>, contains 64 addresses), then <em>bitcoin eviction</em> is used: four addresses are randomly selected from the bucket, and the oldest is (1) replaced by the new peer's address in tried, and then (2) inserted into the new table. If the peer's address is already present in the bucket, the timestamp associated with the peer's address is updated. The timestamp is also updated when an actively connected peer sends a VERSION, ADDR, INVENTORY, GETDATA or PING message and more than 20 minutes elapsed since the last update.</p>

    <p class="text-gray-300">The new table. The new table consists of 256 buckets, each of which can hold up 64 addresses for peers to whom the node has not yet initiated a successful connection. A node populates the new table with information learned from the DNS seeders, or from ADDR messages. Addresses in the new table also have an associated timestamp; addresses learned from DNS seeders are stamped with a random timestamp between 3 and 7 days old, while addresses learned from ADDR messages are stamped with their timestamp from the ADDR message plus two hours.</p>

    <p class="text-gray-300">Every address <em>a</em> inserted in new belongs to (1) a <em>group</em>, defined in our description of the tried table, and (2) a</p>

    <p class="text-gray-300"><em>source group</em>, the group the contains the IP address of the connected peer or DNS seeder from which the node learned address <em>a</em>. The bucket is selected as follows:</p>

    <pre><code class="language-text">SK = random value chosen when node is born.
Group = /16 containing IP to be inserted.
Src_Group = /16 containing IP of peer sending IP.\\ni = Hash( SK, Src_Group, Group ) % 32
Bucket = Hash( SK, Src_Group, i) % 256
return Bucket
</code></pre>

    <p class="text-gray-300">Each (group, source group) pair hashes to a single new bucket, while each group selects up to 32 buckets in new. Each bucket holds unique addresses. If a bucket is full, then a function called isTerrible is run over all 64 addresses in the bucket; if any one of the addresses is terrible, in that it is (a) more than 30 days old, or (b) has had too many failed connection attempts, then the terrible address is evicted in favor of the new address; otherwise, bitcoin eviction is used with the small change that the evicted address is discarded. A single address can map to multiple buckets if it is advertised by multiple peers; because it is unnecessary for our attacks, we omit description of the elaborate routine is used to insert duplicate addresses.</p>

    <p class="text-gray-300">New outgoing connections are selected if a node restarts or if an outgoing connection is dropped by the network. A bitcoin node never deliberately drops a connection, except when a blacklisting condition is met (<em>e.g.</em>, the peer sends ADDR messages that are too large).</p>

    <p class="text-gray-300">A node with  <span class="math">\\omega \\in [0,7]</span>  outgoing connections selects the  <span class="math">\\omega + 1^{th}</span>  connection as follows:</p>

    <p class="text-gray-300">(1) Decide whether to select from tried or new, where</p>

    <p class="text-gray-300">
<span class="math">$\\Pr[\\text{Select from tried}] = \\frac{\\sqrt{\\rho}(9-\\omega)}{(\\omega+1) + \\sqrt{\\rho}(9-\\omega)} \\quad (1)</span>$</p>

    <p class="text-gray-300">and  <span class="math">\\rho</span>  is the ratio between the number of addresses stored in tried and the number of addresses stored in new. Figure 1 plots the relationship between p and  <span class="math">\\omega</span>  for different values of  <span class="math">\\rho</span> . The address is more likely to be selected from tried when there are few outgoing connections or the tried table is large.</p>

    <p class="text-gray-300">(2) Select a random address from the table, with a bias towards addresses with fresher timestamps: (i) Choose a random non-empty bucket in the table. (ii) Choose a random position in that bucket. (ii) If there is an address at that position, return the address with probability</p>

    <p class="text-gray-300">
<span class="math">$p(r,\\tau) = \\min(1, \\frac{1.2^r}{1+\\tau})</span>$
(2)</p>

    <p class="text-gray-300"><sup>&amp;</sup>lt;sup&gt;4</sup>For IPv6 addresses matching prefix 2001:0470* (which is allocated to Hurricane Electric), the group is the /36 IP prefix that contains IPv6 address of the peer. For all other IPv6 addresses,the group is the /32 IP prefix that contains IPv6 address of the peer. For OnionCat Tor addresses, the group is the first 4 bits of the OnionCat address.</p>

    <p class="text-gray-300">    <img src="_page_4_Figure_0.jpeg" alt="" class="my-4 max-w-full" />
</p>

    <p class="text-gray-300">Figure 1: Plot of Pr[Select from tried] vs. &omega; (the number of outgoing connections) for different values of &rho; (the ratio between the number of addresses in tried and the number of addresses stored in new) per equation <a href="#page-3-1">(1)</a>.</p>

    <p class="text-gray-300">else, reject the address and return to (i). The acceptance probability <em>p</em>(<em>r</em>, &tau;) is a function of <em>r</em>, the number of addresses that have been rejected so far, and &tau;, the difference between the address's timestamp and the current time in measured in ten minute increments.<a href="#page-4-2">5</a></p>

    <p class="text-gray-300">(3) Connect to the address. If connection fails, go to (1).</p>

    <p class="text-gray-300">Our attack is for a victim with a public IP. Our attacker (1) populates the tried table with addresses for its attack nodes, and (2) overwrites addresses in the new table with &quot;trash&quot; IP addresses that are not part of the bitcoin network. The &quot;trash&quot; addresses are unallocated (<em>e.g.,</em> listed as &quot;available&quot; by <a href="#page-15-14">[56]</a>) or as &quot;reserved for future use&quot; by <a href="#page-15-15">[43]</a> (<em>e.g.,</em> 252.0.0.0/8). We fill new with &quot;trash&quot; because, unlike attacker addresses, &quot;trash&quot; is not a scarce resource. The attack continues until (3) the victim node restarts and chooses new outgoing connections from the tried and new tables in its persistant storage (Section <a href="#page-3-2">2.3)</a>. With high probability, the victim establishes all eight outgoing connections to attacker addresses; all eight addresses will be from tried, since the victim cannot connect to the &quot;trash&quot; in new. Finally, the attacker (5) occupies the victim's remaining 117 incoming connections. We now detail each step of our attack.</p>

      <h3 id="sec-3.1" class="text-xl font-semibold mt-8">3.1 Populating tried and new</h3>

    <p class="text-gray-300">The attacker exploits the following to fill tried and new:</p>

    <ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li>Addresses from unsolicited incoming connections are stored in the tried table; thus, the attacker can insert an address into the victim's tried table simply by</li>
    </ol>

    <p class="text-gray-300">connecting to the victim from that address. Moreover, the <em>bitcoin eviction</em> discipline means that the attacker's fresher addresses are likely to evict any older legitimate addresses stored in the tried table (Section <a href="#page-3-3">2.2)</a>.</p>

    <ul class="list-disc list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li><ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li>A node accepts unsolicited ADDR messages; these addresses are inserted directly into the new table without testing their connectivity (Section <a href="#page-3-3">2.2)</a>. Thus, when our attacker connects to the victim from an adversarial address, it can also send ADDR messages with 1000 &quot;trash&quot; addresses. Eventually, the trash overwrites all legitimate addresses in new. We use &quot;trash&quot; because we do not want to waste our IP address resources on overwriting new.</li>
    </ol></li>
      <li><ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li>Nodes only rarely solicit network information from peers and DNS seeders (Section <a href="#page-2-4">2.1)</a>. Thus, while the attacker overwrites the victim's tried and new tables, the victim almost never counteracts the flood of adversarial information by querying legitimate peers or seeders.</li>
    </ol></li>
    </ul>

    <p class="text-gray-300">Our attack requires the victim to restart so it can connect to adversarial addresses. There are several reasons why a bitcoin node could restart, including ISP outages, power failures, and upgrades, failures or attacks on the host OS; indeed, <a href="#page-14-15">[16]</a> found that a node with a public IP has a 25% chance of going offline after 10 hours. Another predictable reason to restart is a software update; on 1/10/2014, for example, bitnodes.io saw 942 nodes running Satoshi client version 0.9.3, and by 29/12/2014, that number had risen to 3018 nodes, corresponding to over 2000 restarts. Since updating is often <em>not</em> optional, especially when it corresponds to critical security issues; 2013 saw three such bitcoin upgrades, and the heartbleed bug <a href="#page-15-16">[53]</a> caused one in 2014. Also, since the community needs to be notified about an upgrade in advance, the attacker could watch for notifications and then commence its attack <a href="#page-14-17">[2]</a>. Restarts can also be deliberately elicited via DDoS <a href="#page-15-17">[47,</a> <a href="#page-15-18">65]</a>, memory exhaustion <a href="#page-14-15">[16]</a>, or packetsof-death (which have been found for bitcoind <a href="#page-14-18">[6,</a><a href="#page-14-19">7]</a>). The bottom line is that the security of the peer-to-peer network should not rely on 100% node uptime.</p>

    <p class="text-gray-300">Our attack succeeds if, upon restart, the victim makes all its outgoing connections to attacker addresses. To do this, we exploit the bias towards selecting addresses with fresh timestamps from tried; by investing extra time into the attack, our attacker ensures its addresses are fresh, while all legitimate addresses become increasingly stale. We analyze this with few simple assumptions:</p>

    <p class="text-gray-300"><em>1.</em> An <em>f</em>-fraction of the addresses in the victim's tried table are controlled by the adversary and the remaining</p>

    <p class="text-gray-300"><sup>5</sup>The algorithm also considers the number of failed connections to this address; we omit this because it does not affect our analysis.</p>

    <ul class="list-disc list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li>1-f-fraction are legitimate. (Section 4 analyzes how many addresses the adversary therefore must control.)</li>
      <li><ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li>All addresses in new are &quot;trash&quot;; all connections to addresses in new fail, and the victim is forced to connect to addresses from tried (Section 2.3).</li>
    </ol></li>
      <li><ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li>The attack proceeds in <em>rounds</em>, and repeats each round until the moment that the victim restarts. During a single round, the attacker connects to the victim from each of its adversarial IP addresses. A round takes time  <span class="math">\\tau_a</span> , so all adversarial addresses in tried are younger than  <span class="math">\\tau_a</span> .</li>
    </ol></li>
      <li><ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li>An f'-fraction addresses in tried are actively connected to the victim before the victim restarts. The timestamps on these legitimate addresses are updated every 20 minute or more (Section 2.2). We assume these timestamps are fresh (<em>i.e.</em>,  <span class="math">\\tau = 0</span> ) when the victim restarts; this is the worst case for the attacker.</li>
    </ol></li>
      <li><ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li>The time invested in the attack  <span class="math">\\tau_\\ell</span>  is the time elapsed from the moment the adversary starts the attack, until the victim restarts. If the victim did not obtain new legitimate network information during of the attack, then, excluding the f'-fraction described above, the legitimate addresses in tried are older than  <span class="math">\\tau_\\ell</span> .</li>
    </ol></li>
    </ul>

    <p class="text-gray-300"><strong>Success probability.</strong> If the adversary owns an f-fraction of the addresses in tried, the probability that an adversarial address is accepted on the first try is  <span class="math">p(1,\\tau_a) \\cdot f</span>  where  <span class="math">p(1,\\tau_a)</span>  is as in equation (2); here we use the fact that the adversary's addresses are no older than  <span class="math">\\tau_a</span> , the length of the round. If r-1 addresses were rejected during this attempt to select an address from tried, then the probability that an adversarial address is accepted on the  <span class="math">r^{th}</span>  try is bounded by</p>

    <p class="text-gray-300"><span class="math">$p(r, \\tau_a) \\cdot f \\prod_{i=1}^{r-1} g(i, f, f&#x27;, \\tau_a, \\tau_\\ell)</span>$</p>

    <p class="text-gray-300">where</p>

    <p class="text-gray-300"><span class="math">$\\begin{split} g(i,f,f&#x27;,\\tau_a,\\tau_\\ell) &amp;= (1-p(i,\\tau_a)) \\cdot f + (1-p(i,0)) \\cdot f&#x27; \\\\ &amp;+ (1-p(i,\\tau_\\ell)) \\cdot (1-f-f&#x27;) \\end{split}</span>$</p>

    <p class="text-gray-300">is the probability that an address was rejected on the  <span class="math">i^{th}</span>  try given that it was also rejected on the  <span class="math">i-1^{th}</span>  try. An adversarial address is thus accepted with probability</p>

    <p class="text-gray-300">
<span class="math">$q(f, f&#x27;, \\tau_a, \\tau_\\ell) = \\sum_{r=1}^{\\infty} p(r, \\tau_a) \\cdot f \\prod_{i=1}^{r-1} g(i, f, f&#x27;, \\tau_a, \\tau_\\ell)</span>$
(3)</p>

    <p class="text-gray-300">and the victim is eclipsed if all eight outgoing connections are to adversarial addresses, which happens with probability  <span class="math">q(f,f&#x27;,\\tau_a,\\tau_\\ell)^8</span> . Figure 2 plots  <span class="math">q(f,f&#x27;,\\tau_a,\\tau_\\ell)^8</span>  vs f for  <span class="math">\\tau_a=27</span>  minutes and different choices of  <span class="math">\\tau_\\ell</span> ; we assume that  <span class="math">f&#x27;=\\frac{8}{64\\times 64}</span> , which corresponds to a full tried table containing eight addresses that are actively connected before the victim restarts.</p>

    <p class="text-gray-300">    <img src="_page_5_Figure_12.jpeg" alt="" class="my-4 max-w-full" />
</p>

    <p class="text-gray-300">Figure 2: Probability of eclipsing a node  <span class="math">q(f,f&#x27;,\\tau_a,\\tau_\\ell)^8</span>  (equation (3)) vs f the fraction of adversarial addresses in tried, for different values of time invested in the attack  <span class="math">\\tau_\\ell</span> . Round length is  <span class="math">\\tau_a=27</span>  minutes, and  <span class="math">f&#x27;=\\frac{8}{64\\times64}</span> . The dotted line shows the probability of eclipsing a node if random selection is used instead.</p>

    <p class="text-gray-300"><strong>Random selection.</strong> Figure 2 also shows success probability if addresses were just selected uniformly at random from each table. We do this by plotting  <span class="math">f^8</span>  vs f. Without random selection, the adversary has a 90% success probability even if it only fills f=72% of tried, as long as it attacks for  <span class="math">\\tau_\\ell=48</span>  hours with  <span class="math">\\tau_a=27</span>  minute rounds. With random selection, 90% success probability requires f=98.7% of tried to be attacker addresses.</p>

    <p class="text-gray-300">Figure 2 assumes that the victim has exactly eight <em>outgoing connections</em>; all we require in terms of <em>incoming connections</em> is that the victim has a few open slots to accept incoming TCP connections from the attacker.</p>

    <p class="text-gray-300">While it is often assumed that the number of TCP connections a computer can make is limited by the OS or the number of source ports, this applies only when OS-provided TCP sockets are used; a dedicated attacker can open an arbitrary number of TCP connections using a custom TCP stack. A custom TCP stack (see <em>e.g.</em>, zmap [35]) requires minimal CPU and memory, and is typically bottlenecked only by bandwidth, and the bandwidth cost of our attack is minimal:</p>

    <p class="text-gray-300">Attack connections. To fill the tried table, our attacker repeatedly connects to the victim from each of its addresses. Each connection consists of a TCP handshake, bitcoin VERSION message, and then disconnection via TCP RST; this costs 371 bytes upstream and 377 bytes downstream. Some attack connections also send one ADDR message containing 1000 addresses; these ADDR messages cost 120087 bytes upstream and 437 bytes downstream including TCP ACKs.</p>

    <p class="text-gray-300"><strong>Monopolizing connections.</strong> If that attack succeeds,</p>

    <p class="text-gray-300">the victim has eight outgoing connections to the attack nodes, and the attacker must occupy the victim's remaining incoming connections. To prevent others from connecting to the victim, these TCP connections could be maintained for 30 days, at which point the victim's address is terrible and forgotten by the network. While bitcoin supports block inventory requests and the sending of blocks and transactions, this consumes significant bandwidth; our attacker thus does not to respond to inventory requests. As such, setting up each TCP connection costs 377 bytes upstream and 377 bytes downstream, and is maintained by ping-pong packets and TCP ACKs consuming 164 bytes every 80 minutes.</p>

    <p class="text-gray-300">We experimentally confirmed that a bitcoin node will accept all incoming connections from the same IP address. (We presume this is done to allow multiple nodes behind a NAT to connect to the same node.) Maintaining the default 117 incoming TCP connections costs  <span class="math">\\frac{164\\times117}{80\\times60}\\approx4</span>  bytes per second, easily allowing one computer to monopolize multiple victims at the same time. As an aside, this also allows for <em>connection starvation attacks</em> [32], where an attacker monopolizes all the incoming connections in the peer-to-peer network, making it impossible for new nodes to connect to new peers.</p>

    <p class="text-gray-300">Section 3.3 showed that the success of our attack depends heavily on  <span class="math">\\tau_\\ell</span> , the time invested in the attack, and f, the fraction of attacker addresses in the victim's tried table. We now use probabilistic analysis to determine how many addresses the attacker must control for a given value of f; it's important to remember, however, that even if f is small, our attacker can still succeed by increasing  <span class="math">\\tau_\\ell</span> . Recall from Section 2.2 that bitcoin is careful to ensure that a node does not store too many IP addresses from the same group (i.e., /16 IPv4 address block). We therefore consider two attack variants:</p>

    <p class="text-gray-300"><strong>Botnet attack</strong> (Section 4.1). The attacker holds several IP addresses, each in a <em>distinct</em> group. This models attacks by a botnet of hosts scattered in diverse IP address blocks. Section 4.1.1 explains why many botnets have enough IP address diversity for this attack.</p>

    <p class="text-gray-300">Infrastructure attack (Section 4.2). The attacker controls several IP address blocks, and can intercept bitcoin traffic sent to any IP address in the block, <em>i.e.</em>, the attacker holds multiple sets of addresses in the same <em>group</em>. This models a company or nation-state that seeks to undermine bitcoin by attacking its network. Section 4.2.1 discusses organizations that can launch this attack.</p>

    <p class="text-gray-300">We focus here on tried; Appendix B considers how to send &quot;trash&quot;-filled ADDR messages that overwrite new.</p>

    <p class="text-gray-300">    <img src="_page_6_Figure_7.jpeg" alt="" class="my-4 max-w-full" />
</p>

    <p class="text-gray-300">Figure 3: Botnet attack: the expected number of addresses stored in tried for different scenarios vs the number of addresses (bots) t. Values were computed from equations (4), (7) and (8), and confirmed by Monte Carlo simulations (with 100 trials/data point).</p>

      <h3 id="sec-4.1" class="text-xl font-semibold mt-8">4.1 Botnet attack</h3>

    <p class="text-gray-300">The botnet attacker holds t addresses in distinct groups. We model each address as hashing to a uniformly-random bucket in tried, so the number of addresses hashing to each bucket is binomally distributed<sup>6</sup> as  <span class="math">B(t, \\frac{1}{64})</span> . How many of the  <span class="math">64 \\times 64</span>  entries in tried can the attacker occupy? We model various scenarios, and plot results in Figure 3.</p>

    <p class="text-gray-300"><strong>1. Initially empty.</strong> In the best case for the attacker, all 64 buckets are initially empty and the expected number of adversarial addresses stored in the tried table is</p>

    <p class="text-gray-300">
<span class="math">$64E[\\min(64, B(t, \\frac{1}{64}))] \\tag{4}</span>$</p>

    <p class="text-gray-300"><strong>2. Bitcoin eviction.</strong> Now consider the worst case for the attacker, where each bucket i is full of 64 legitimate addresses. These addresses, however, will be <em>older</em> than all  <span class="math">A_i</span>  distinct adversarial addresses that the adversary attempts to insert into to bucket i.<sup>7</sup> Since the bitcoin eviction discipline requires each newly inserted address to select four random addresses stored in the bucket and to evict the oldest, if one of the four selected addresses is a legitimate address (which will be older than all of the adversary's addresses), the legitimate address will be overwritten by the adversarial addresses.</p>

    <p class="text-gray-300">For  <span class="math">a = 0...A_i</span> , let  <span class="math">Y_a</span>  be the number of adversarial addresses actually stored in bucket i, given that the adversary inserted a unique addresses into bucket i. Let  <span class="math">X_a = 1</span>  if the  <span class="math">a^{th}</span>  inserted address successfully overwrites a legitimate address, and  <span class="math">X_a = 0</span>  otherwise. Then,</p>

    <p class="text-gray-300"><span class="math">$E[X_a|Y_{a-1}] = 1 - (\\frac{Y_{a-1}}{64})^4</span>$</p>

    <p class="text-gray-300"> <span class="math">&lt;sup&gt;^6&lt;/sup&gt;B(n,p)</span>  is a binomial distribution counting successes in a sequence of n independent yes/no trials, each yielding 'yes' with probability p.</p>

    <p class="text-gray-300"><sup>&amp;</sup>lt;sup&gt;7</sup>Actually, the addresses of the nodes that are actively connected to the victim are not necessarily older; we already accounted for these in Section 3.3.</p>

    <p class="text-gray-300">and it follows that</p>

    <p class="text-gray-300"><span class="math">$E[Y_a|Y_{a-1}] = Y_{a-1} + 1 - \\left(\\frac{Y_{a-1}}{64}\\right)^4 \\tag{5}</span>$</p>

    <p class="text-gray-300"><span class="math">$E[Y_1] = 1 \\tag{6}</span>$</p>

    <p class="text-gray-300">where (6) follows because the bucket is initially full of legitimate addresses. We now have a recurrence relation for  <span class="math">E[Y_a]</span> , which we can solve numerically. We find that  <span class="math">E[Y_a] &gt; 63</span>  for  <span class="math">a \\ge 101</span> , so the adversary can expect to overwrite 63 of the 64 legitimate addresses in the bucket after inserting 101 unique addresses. The expected number of adversarial addresses in all buckets is thus</p>

    <p class="text-gray-300">
<span class="math">$64\\sum_{a=1}^{t} E[Y_a] \\Pr[B(t, \\frac{1}{64}) = a]</span>$
(7)</p>

    <p class="text-gray-300"><strong>3. Random eviction.</strong> We again consider the attacker's worst case, where each bucket is full of legitimate addresses, but now we assume that each inserted address evicts a randomly-selected address. (This is not what bitcoin does, but we analyze it for comparison.) Applying Lemma A.1 (Appendix A) we find the expected number of adversarial addresses in all buckets is</p>

    <p class="text-gray-300">
<span class="math">$4096(1 - (\\frac{4095}{4096})^t) \\tag{8}</span>$</p>

    <p class="text-gray-300"><strong>4. Exploiting multiple rounds.</strong> Our eclipse attack proceeds in <em>rounds</em>; in each round the attacker repeatedly inserts each of his <em>t</em> addresses into the tried table. While each address always maps to the same bucket in tried in each round, bitcoin eviction maps each address to a <em>different slot</em> in that bucket in every round. Thus, an adversarial address that is not stored into its tried bucket at the end of one round, might still be successfully stored into that bucket in a future round. Thus far, this section has only considered a single round. But, more addresses can be stored in tried by repeating the attack for multiple rounds. After sufficient rounds, the expected number of addresses is given by equation (4), <em>i.e.</em>, the attack performs as in the best-case for the attacker!</p>

      <h4 id="sec-4.1.1" class="text-lg font-semibold mt-6">4.1.1 Who can launch a botnet attack?</h4>

    <p class="text-gray-300">The 'initially empty' line in Figure 3 indicates that a botnet exploiting multiple rounds can completely fill tried with  <span class="math">\\approx 6000</span>  addresses. While such an attack cannot easily be launched from a legitimate cloud service (which typically allocates &lt; 20 addresses per tenant [1, 8, 9]), botnets of this size and larger than this have attacked bitcoin [45, 47, 65]; the Miner botnet, for example, had 29,000 hosts with public IPs [54]. While some botnet infestations concentrate in a few IP address ranges [63], it is important to remember that our botnet attack requires no more than  <span class="math">\\approx 6000</span>  groups; many botnets are orders of magnitude larger [59]. For example, the Walowdac botnet was mostly in ranges 58.x-100.x and 188.x-233.x [63], which creates  <span class="math">42 \\times 2^8 + 55 \\times 2^8 = 24832</span></p>

    <p class="text-gray-300">    <img src="_page_7_Figure_10.jpeg" alt="" class="my-4 max-w-full" />
</p>

    <p class="text-gray-300">Figure 4: Infrastructure attack.  <span class="math">E[\\Gamma]</span>  (expected number of non-empty buckets) in tried vs s (number of groups).</p>

    <p class="text-gray-300">    <img src="_page_7_Figure_12.jpeg" alt="" class="my-4 max-w-full" />
</p>

    <p class="text-gray-300">Figure 5: Infrastructure attack with s=32 groups: the expected number of addresses stored in tried for different scenarios vs the number of addresses per group t. Results obtained by taking the product of equation (9) and equation (16) or (17), and confirmed by Monte Carlo simulations (100 trials/data point). The horizontal line assumes all  <span class="math">E[\\Gamma]</span>  buckets per (9) are full.</p>

    <p class="text-gray-300">groups. Randomly sampling from the list of hosts in the Carna botnet [26] 5000 times, we find that 1250 bots gives on average 402 distinct groups, enough to attack our live bitcoin nodes (Section 6). Furthermore, we soon show in Figure 4 that an infrastructure attack with s&gt;200 groups easily fills every bucket in tried; thus, with s&gt;400 groups, the attack performs as in Figure 3, even if many bots are in the same group.</p>

      <h3 id="sec-4.2" class="text-xl font-semibold mt-8">4.2 Infrastructure attack</h3>

    <p class="text-gray-300">The attacker holds addresses in s distinct groups. We determine how much of tried can be filled by an attacker controlling s groups s containing t IP addresses/group.</p>

    <p class="text-gray-300"><strong>How many groups?</strong> We model the process of populating tried (per Section 2.2) by supposing that four independent hash functions map each of the s groups to one of 64 buckets in tried. Thus, if  <span class="math">\\Gamma \\in [0,64]</span>  counts the number of non-empty buckets in tried, we use Lemma A.1 to find that</p>

    <p class="text-gray-300">
<span class="math">$E[\\Gamma] = 64 \\left(1 - \\left(\\frac{63}{64}\\right)^{4s}\\right) \\approx \\left(1 - e^{-\\frac{4s}{64}}\\right)</span>$
(9)</p>

    <p class="text-gray-300">Figure 4 plots  <span class="math">E[\\Gamma]</span> ; we expect to fill 55.5 of 64 buckets with s=32, and all but one bucket with s&gt;67 groups.</p>

    <p class="text-gray-300"><strong>How full is the tried table?</strong> Appendix C determines the expected number of addresses stored per bucket for</p>

    <p class="text-gray-300">    <img src="_page_8_Figure_0.jpeg" alt="" class="my-4 max-w-full" />
</p>

    <p class="text-gray-300">Figure 6: Histogram of the number of organizations with <em>s</em> groups. For the /24 data, we require <em>t</em> = 256 addresses per group; for /23, we require <em>t</em> = 512.</p>

    <p class="text-gray-300">the first three scenarios described in Section <a href="#page-6-1">4.1;</a> the expected fraction <em>E</em>[ <em>f</em> ] of tried filled by adversarial addresses is plotted in in Figure <a href="#page-7-7">5.</a> The horizontal line in Figure <a href="#page-7-7">5</a> show what happens if each of <em>E</em>[&Gamma;] buckets per equation <a href="#page-7-5">(9)</a> is full of attack addresses.</p>

    <p class="text-gray-300">The adversary's task is easiest when all buckets are initially empty, or when a sufficient number of rounds are used; a single /24 address block of 256 addresses suffices to fill each bucket when <em>s</em> = 32 grouips is used. Moreover, as in Section <a href="#page-6-1">4.1,</a> an attack that exploits multiple rounds performs as in the 'initially empty' scenario. Concretely, with 32 groups of 256 addresses each (8192 addresses in total) an adversary can expect to fill about <em>f</em> = 86% of the tried table after a sufficient number of rounds. The attacker is almost as effective in the bitcoineviction scenario with only one round; meanwhile, one round is much less effective with random eviction.</p>

      <h4 id="sec-4.2.1" class="text-lg font-semibold mt-6">4.2.1 Who can launch an infrastructure attack?</h4>

    <p class="text-gray-300">Which organizations have enough IP address resources to launch infrastructure attacks? We compiled data mapping IPv4 address allocation to organizations, using CAIDA's AS to organization dataset <a href="#page-14-26">[23]</a> and AS to prefix dataset <a href="#page-14-27">[24]</a> from July 2014, supplementing our data with information from the RIPE database <a href="#page-15-25">[55]</a>. We determined how many groups (<em>i.e.,</em> addresses in the same /16 IPv4 address block) and addresses per group are allocated to each organization; see Figure <a href="#page-8-2">6.</a> There are 448 organizations with over<em>s</em> = 32 groups and at least <em>t</em> = 256 addresses per group; if these organizations invest &tau;\` = 5 hours into an attack with a &tau;<em><sup>a</sup></em> = 27-minute round, then they eclipse the victim with probability greater than 80%.</p>

    <p class="text-gray-300">National ISPs in various countries hold a sufficient number of groups (<em>s</em> &ge; 32) for this purpose; for example, in Sudan (Sudanese Mobile), Columbia (ETB), UAE (Etisalat), Guatemala (Telgua), Tunisia (Tunisia Telecom), Saudi Arabia (Saudi Telecom Company) and Dominica (Cable and Wireless). The United States Department of the Interior has enough groups (<em>s</em> = 35), as does the S. Korean Ministry of Information and Communication (<em>s</em> = 41), as do hundreds of others.</p>

    <div class="overflow-x-auto my-4">
      <table class="min-w-full text-sm text-gray-300">
        <thead>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">oldest</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">#</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"></th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">Age of addresses (in days)</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"></th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"></th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"></th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"></th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"></th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"></th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"></th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"></th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"></th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"></th>
        </thead>
        <tbody>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">addr</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">addr</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">% live</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">&lt; 1</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1&minus;5</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">5&minus;10</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">10&minus;30</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">&gt; 30</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">38 d*</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">243</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">28%</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">36</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">71</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">28</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">79</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">29</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">41 d*</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">162</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">28%</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">23</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">29</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">27</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">44</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">39</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">42 d*</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">244</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">19%</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">25</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">45</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">29</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">95</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">50</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">42 d*</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">195</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">23%</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">23</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">40</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">23</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">64</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">45</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">43 d*</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">219</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">20%</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">66</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">57</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">23</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">50</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">23</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">103 d</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">4096</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">8%</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">722</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">645</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">236</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">819</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1674</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">127 d</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">4096</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">8%</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">90</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">290</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">328</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">897</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">2491</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">271 d</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">4096</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">8%</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">750</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">693</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">356</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">809</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1488</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">240 d</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">4096</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">6%</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">419</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">445</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">32</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">79</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">3121</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">373 d</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">4096</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">5%</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">9</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">14</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">216</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">3856</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
        </tbody>
      </table>
    </div>

    <p class="text-gray-300">Table 1: Age and churn of addresses in tried for our nodes (marked with *) and donated peers files.</p>

    <p class="text-gray-300">Figures <a href="#page-7-7">5,</a> <a href="#page-6-4">3</a> show that the botnet attack is far superior to the infrastructure attack. Filling <em>f</em> = 98% of the victim's tried table requires a 4600 node botnet (attacking for a sufficient number of rounds, per equation <a href="#page-6-2">(4)</a>). By contrast, an infrastructure attacker needs 16,000 addresses, consisting of <em>s</em> = 63 groups (equation <a href="#page-7-5">(9)</a>) with <em>t</em> = 256 addresses per group. However, per Section <a href="#page-4-3">3.3,</a> if our attacker increases the time invested in the attack &tau;<code> , it can be far less aggressive about filling tried. For example, per Figure [2,](#page-5-0) attacking for &tau;</code> = 24 hours with &tau;<em><sup>a</sup></em> = 27 minute rounds, our success probability exceeds 85% with just <em>f</em> = 72%; in the worst case for the attacker, this requires only 3000 bots, or an infrastructure attack of <em>s</em> = 20 groups and <em>t</em> = 256 addresses per group (5120 addresses). The same attack (<em>f</em> = 72%, &tau;<em><sup>a</sup></em> = 27 minutes) running for just 4 hours still has &gt; 55% success probability. To put this in context, if 3000 bots joined today's network (with &lt; 7200 public-IP nodes <a href="#page-14-8">[4]</a>) and honestly followed the peer-to-peer protocol, they could eclipse a victim with probability &asymp; ( 3000 <sup>7200</sup>+<sup>3000</sup> ) <sup>8</sup> = 0.006%.</p>

    </section>

    <section id="sec-5" class="mb-10">
      <h2 class="text-2xl font-bold">5 Measuring Live Bitcoin Nodes</h2>

    <p class="text-gray-300">We briefly consider how parameters affecting the success of our eclipse attacks look on &quot;typical&quot; bitcoin nodes. We thus instrumented five bitcoin nodes with public IPs that we ran (continuously, without restarting) for 43 days from 12/23/2014 to 2/4/2015. We also analyze several peers files that others donated to us on 2/15/2015. Note that there is evidence of wide variations in metrics for nodes of different ages and in different regions <a href="#page-15-10">[46]</a>; as such, our analysis (Section <a href="#page-4-0">3</a><a href="#page-6-0">-4)</a> and some of our experiments (Section <a href="#page-9-0">6)</a> focus on the attacker's worst-case scenario, where tables are initially full of fresh addresses.</p>

    <p class="text-gray-300">Number of connections. Our attack requires the victim to have available slots for incoming connections. Figure <a href="#page-9-1">7</a> shows the number of connections over time for one of our bitcoin nodes, broken out by connections to public or private IPs. There are plenty of available slots; while our node can accommodate 125 connections, we never see more than 60 at a time. Similar measurements in <a href="#page-14-16">[17]</a> indicate that 80% of bitcoin peers allow at least 40 incoming connections. Our node saw, on average, 9.9 connections to public IPs over the course of its lifetime; of these, 8 correspond to <em>outgoing</em> connections, which means we rarely see incoming connections from public IPs. Results for our other nodes are similar.</p>

    <p class="text-gray-300">Connection length. Because public bitcoin nodes rarely drop outgoing connections to their peers (except upon restart, network failure, or due to blacklisting, see Section <a href="#page-3-2">2.3)</a>, many connections are fairly long lived. When we sampled our nodes on 2/4/2015, across all of our nodes, 17% of connections had lasted more than 15 days, and of these, 65.6% were to public IPs. On the other hand, many bitcoin nodes restart frequently; we saw that 43% of connections lasted less than two days and of these, 97% were to nodes with private IPs. This may explain why we see so few incoming connections from public IPs; many public-IP nodes stick to their mature long-term peers, rather than our young-ish nodes.</p>

    <p class="text-gray-300">Size of tried and new tables. In our worst case attack, we supposed that the tried and new tables were completely full of fresh addresses. While our Bitcoin nodes' new tables filled up quite quickly (99% within 48 hours), Table <a href="#page-8-3">1</a> reveals that their tried tables were far from full of fresh addresses. Even after 43 days, the tried tables for our nodes were no more than 300/4096 &asymp; 8% full. This likely follows because our nodes had very few incoming connections from public IPs; thus, most addresses in tried result from successful outgoing connections to public IPs (infrequently) drawn from new.</p>

    <p class="text-gray-300">Freshness of tried. Even those few addresses in tried are not especially fresh. Table <a href="#page-8-3">1</a> shows the age distribution of the addresses in tried for our nodes and from donated peers files. For our nodes, 17% of addresses were more than 30 days old, and 48% were more than 10 days old; these addresses will therefore be less preferred than the adversarial ones inserted during an eclipse attack, even if the adversary does not invest much time &tau;\` in attacking the victim.</p>

    <p class="text-gray-300">Churn. Table <a href="#page-8-3">1</a> also shows that a small fraction of addresses in tried were online when we tried connecting to them on 2/17/2015.<a href="#page-9-2">8</a> This suggests further vulnerability to eclipse attacks, because if most legitimate addresses in tried are offline when a victim resets, the victim is likely to connect to an adversarial address.</p>

    <p class="text-gray-300">    <img src="_page_9_Figure_6.jpeg" alt="" class="my-4 max-w-full" />
</p>

    <p class="text-gray-300">Figure 7: (Top) Incoming + outgoing connections vs time for one of our nodes. (Bottom) Number of addresses in tried vs time for all our nodes.</p>

    </section>

    <section id="sec-6" class="mb-10">
      <h2 class="text-2xl font-bold">6 Experiments</h2>

    <p class="text-gray-300">We now validate our analysis with experiments.</p>

    <p class="text-gray-300">Methodology. In each of our experiments, the victim (bitcoind) node is on a virtual machine on the attacking machine; we also instrument the victim's code. The victim node runs on the public bitcoin network (<em>aka,</em> mainnet). The attacking machine can read all the victim's packets to/from the public bitcoin network, and can therefore forge TCP connections from arbitrary IP addresses. To launch the attack, the attacking machine forges TCP connections from each of its attacker addresses, making an incoming connection to the victim, sending a VERSION message and sometimes also an ADDR message (per Appendix <a href="#page-15-19">B)</a> and then disconnecting; the attack connections, which are launched at regular intervals, rarely occupy all of the victim's available slots for incoming connections. To avoid harming the public bitcoin network, (1) we use &quot;reserved for future use&quot; <a href="#page-15-15">[43]</a> IPs in 240.0.0.0/8-249.0.0.0/8 as attack addresses, and 252.0.0.0/8 as &quot;trash&quot; sent in ADDR messages, and (2) we drop any ADDR messages the (polluted) victim attempts to send to the public network.</p>

    <p class="text-gray-300">At the end of the attack, we repeatedly restart the victim and see what outgoing connections it makes, dropping connections to the &quot;trash&quot; addresses and forging connections for the attacker addresses. If all 8 outgoing connections are to attacker addresses, the attack succeeds, and otherwise it fails. Each experiment restarts the victim 50 times, and reports the fraction of successes. At each restart, we revert the victim's tables to their state at the end of the attack, and rewind the victim's system time to the moment the attack ended (to avoid dating timestamps in tried and new). We restart the victim 50 times to measure the success rate of our (probabilistic) attack; in a real attack, the victim would only restart once.</p>

    <p class="text-gray-300">Initial conditions. We try various initial conditions:</p>

    <ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li>Worst case. In the attacker's worst-case scenario, the victim initially has tried and new tables that are</li>
    </ol>

    <p class="text-gray-300"><sup>8</sup>For consistency with the rest of this section, we tested our nodes tables from 2/4/2015. We also repeated this test for tables taken from our nodes on 2/17/2015, and the results did not deviate more than 6% from those of Table <a href="#page-8-3">1.</a></p>

    <div class="overflow-x-auto my-4">
      <table class="min-w-full text-sm text-gray-300">
        <thead>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"></th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">Attacker resources</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"></th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"></th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"></th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"></th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">Experiment</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"></th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"></th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"></th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"></th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"></th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"></th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">Predicted</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"></th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"></th>
        </thead>
        <tbody>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">grps</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">addrs/</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">total</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">, time<br>&tau;\`</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">&tau;a,</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Total pre-attack</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Total post-attack</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Attack addrs</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Attack addrs</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Attack Type</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">s</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">grp t</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">addrs</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">invest</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">round</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">new</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">tried</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">new</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">tried</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">new</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">tried</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Wins</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">new</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">tried</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Wins</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Infra (Worstcase)</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">32</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">256</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">8192</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">10 h</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">43 m</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">16384</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">4090</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">16384</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">4096</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">15871</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">3404</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">98%</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">16064</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">3501</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">87%</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Infra (Transplant)</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">20</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">256</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">5120</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1 hr</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">27 m</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">16380</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">278</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">16383</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">3087</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">14974</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">2947</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">82%</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">15040</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">2868</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">77%</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Infra (Transplant)</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">20</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">256</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">5120</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">2 hr</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">27 m</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">16380</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">278</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">16383</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">3088</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">14920</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">2966</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">78%</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">15040</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">2868</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">87%</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Infra (Transplant)</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">20</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">256</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">5120</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">4 hr</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">27 m</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">16380</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">278</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">16384</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">3088</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">14819</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">2972</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">86%</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">15040</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">2868</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">91%</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Infra (Live)</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">20</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">256</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">5120</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1 hr</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">27 m</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">16381</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">346</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">16384</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">3116</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">14341</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">2942</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">84%</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">15040</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">2868</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">75%</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Bots (Worstcase)</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">2300</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">2</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">4600</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">5 h</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">26 m</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">16080</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">4093</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">16384</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">4096</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">16383</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">4015</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">100%</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">16384</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">4048</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">96%</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Bots (Transplant)</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">200</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">200</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1 hr</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">74 s</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">16380</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">278</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">16384</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">448</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">16375</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">200</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">60%</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">16384</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">200</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">11%</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Bots (Transplant)</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">400</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">400</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1 hr</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">90 s</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">16380</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">278</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">16384</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">648</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">16384</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">400</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">88%</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">16384</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">400</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">34%</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Bots (Transplant)</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">400</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">400</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">4 hr</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">90 s</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">16380</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">278</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">16384</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">650</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">16383</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">400</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">84%</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">16384</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">400</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">61%</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Bots (Transplant)</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">600</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">600</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1 hr</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">209 s</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">16380</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">278</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">16384</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">848</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">16384</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">600</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">96%</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">16384</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">600</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">47%</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Bots (Live)</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">400</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">400</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1 hr</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">90 s</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">16380</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">298</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">16384</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">698</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">16384</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">400</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">84%</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">16384</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">400</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">28%</td>
          </tr>
        </tbody>
      </table>
    </div>

    <p class="text-gray-300">Table 2: Summary of our experiments.</p>

    <p class="text-gray-300">completely full of legitimate addresses with fresh timestamps. To set up the initial condition, we run our attack for no longer than one hour on a freshly-born victim node, filling tried and new with IP addresses from 251.0.0.0/8, 253.0.0.0/8 and 254.0.0.0/8, which we designate as &quot;legitimate addresses&quot;; these addresses are no older than one hour when the attack starts. We then restart the victim and commence attacking it.</p>

    <ul class="list-disc list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li><ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li>Transplant case. In our transplant experiments, we copied the tried and new tables from one of our five live bitcoin nodes on 8/2/2015, installed them in a fresh victim with a different public IP address, restarted the victim, waited for it to establish eight outgoing connections, and then commenced attacking. This allowed us to try various attacks with a consistent initial condition.</li>
    </ol></li>
      <li><ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li>Live case. Finally, on 2/17/2015 and 2/18/2015 we attacked our live bitcoin nodes while they were connected to the public bitcoin network; at this point our nodes had been online for 52 or 53 days.</li>
    </ol></li>
    </ul>

    <p class="text-gray-300">Results (Table <a href="#page-10-0">2)</a>. Results are in Table <a href="#page-10-0">2.</a> The first five columns summarize attacker resources (the number of groups <em>s</em>, addresses per group <em>t</em>, time invested in the attack &tau;\` , and length of a round &tau;<em><sup>a</sup></em> per Sections <a href="#page-4-0">3</a><a href="#page-6-0">-4)</a>. The next two columns present the initial condition: the number of addresses in tried and new prior to the attack. The following four columns give the size of tried and new, and the number of attacker addresses they store, at the end of the attack (when the victim first restarts). The <em>wins</em> columns counts the fraction of times our attack succeeds after restarting the victim 50 times.</p>

    <p class="text-gray-300">The final three columns give predictions from Sections <a href="#page-4-3">3.3,</a> <a href="#page-6-0">4.</a> The <em>attack addrs</em> columns give the expected number of addresses in new (Appendix <a href="#page-15-19">B)</a> and tried. For tried, we assume that the attacker runs his attack for enough rounds so that the expected number of addresses in tried is governed by equation <a href="#page-6-2">(4)</a> for the botnet, and <a href="#page-7-5">(9)</a> multiplied by <a href="#page-17-0">(16)</a> for the infrastructure attack. The final column predicts success per Section <a href="#page-4-3">3.3</a> using <em>experimental values</em> of &tau;<em>a</em>, &tau;\` , <em>f</em> , <em>f</em> 0 .</p>

    <p class="text-gray-300">Observations. Our results indicate the following:</p>

    <ul class="list-disc list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li><ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li>Success in worst case. Our experiments confirm that an infrastructure attack with 32 groups of size /24 (8192 attack addresses total) succeeds in the worst case with very high probability. We also confirm that botnets are superior to infrastructure attacks; 4600 bots had 100% success even with a worst-case initial condition.</li>
    </ol></li>
      <li><ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li>Accuracy of predictions. Almost all of our attacks had an experimental success rate that was <em>higher</em> than the predicted success rate. To explain this, recall that our predictions from Section <a href="#page-4-3">3.3</a> assume that legitimate addresses are exactly &tau;<code> old (where &tau;</code> is the time invested in the attack); in practice, legitimate addresses are likely to be even older, especially when we work with tried tables of real nodes (Table <a href="#page-8-3">1)</a>. Less importantly, our predictions also assume that adversarial addresses are exactly &tau;<em><sup>a</sup></em> old; in practice, an adversarial address inserted at the end of a round could be even younger. Thus, Section <a href="#page-4-3">3.3'</a>s predictions are a lower bound on the success rate.</li>
    </ol></li>
    </ul>

    <p class="text-gray-300">Our experimental botnet attacks were dramatically more successful than their predictions (<em>e.g.,</em> 88% actual vs. 34% predicted), most likely because the addresses initially in tried were already very stale prior to the attack (Table <a href="#page-8-3">1)</a>. Our infrastructure attacks were also more successful then their predictions, but here the difference was much less dramatic. To explain this, we look to the new table. While our success-rate predictions assume that new is completely overwritten, our infrastructure attacks failed to completely overwrite the new table;<a href="#page-10-1">9</a> thus, we have some extra failures because the victim made outgoing connections to addresses in new.</p>

    <p class="text-gray-300">Finally, note that we decided our attack failed even if the victim tried to connect to a legitimate address that was offline. With high churn rates (per Table <a href="#page-8-3">1)</a>, our success rates could be even higher than that in Table <a href="#page-10-0">2.</a></p>

    <ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li>Success in a 'typical' case. Our attacks are successful with even fewer addresses when we test them on our live nodes, or on tables taken from those live nodes.</li>
    </ol>

    <p class="text-gray-300"><sup>9</sup>The new table holds 16384 addresses and from 6<em>th</em> last column of Table <a href="#page-10-0">2</a> we see the new is not full for our infrastructure attacks. Indeed, we predict this in Appendix <a href="#page-15-19">B.</a></p>

    <p class="text-gray-300">Most strikingly, a small botnet of 400 bots succeeds with very high probability; while this botnet completely overwrites new, it fills only 400/650 = 62% of tried, and still manages to win with more than 80% probability.</p>

    </section>

    <section id="sec-7" class="mb-10">
      <h2 class="text-2xl font-bold">7 Countermeasures</h2>

    <p class="text-gray-300">We have shown how an attacker with enough IP addresses and time can eclipse any target victim, regardless of the state of the victim's tried and new tables. We now present countermeasures that make eclipse attacks more difficult. Our countermeasures are inspired by botnet architectures (Section <a href="#page-13-0">8)</a>, and designed to be faithful to bitcoin's network architecture.</p>

    <p class="text-gray-300">The following five countermeasures ensure that: (1) If the victim has <em>h</em> legitimate addresses in tried before the attack, and a <em>p</em>-fraction of them accept incoming connections during the attack when the victim restarts, then even an attacker <em>with an unbounded number of addresses</em> cannot eclipse the victim with probability exceeding equation <a href="#page-11-1">(10)</a>. (2) If the victim's oldest outgoing connection is to a legitimate peer before the attack, then the eclipse attack <em>fails</em> if that peer accepts incoming connections when the victim restarts.</p>

    <ul class="list-disc list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li><ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li>Deterministic random eviction. Replace bitcoin eviction as follows: just as each address deterministically hashes to a single bucket in tried and new (Section <a href="#page-3-3">2.2)</a>, an address also deterministically hashes to a single slot in that bucket. This way, an attacker cannot increase the number of addresses stored by repeatedly inserting the same address in multiple rounds (Section <a href="#page-6-1">4.1)</a>. Instead, addresses stored in tried are given by the 'random eviction' curves in Figures <a href="#page-6-4">3,</a> <a href="#page-7-7">5,</a> reducing the attack addresses stored in tried.</li>
    </ol></li>
      <li><ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li>Random selection. Our attacks also exploit the heavy bias towards forming outgoing connections to addresses with fresh timestamps, so that an attacker that owns only a small fraction <em>f</em> = 30% of the victim's tried table can increase its success probability (to say 50%) by increasing &tau;\` , the time it invests in the attack (Section <a href="#page-4-3">3.3)</a>. We can eliminate this advantage for the attacker if addresses are selected at random from tried and new; this way, a success rate of 50% always requires the adversary to fill <sup>&radic;</sup><sup>8</sup> 0.5 = 91.7% of tried, which requires 40 groups in an infrastructure attack, or about 3680 peers in a botnet attack. Combining this with deterministic random eviction, the figure jumps to 10194 bots for 50% success probability.</li>
    </ol></li>
    </ul>

    <p class="text-gray-300">These countermeasures harden the network, but still allow an attacker with enough addresses to overwrite all of tried. The next countermeasure remedies this:</p>

    <ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li>Test before evict. Before storing an address in its (deterministically-chosen) slot in a bucket in tried, first</li>
    </ol>

    <p class="text-gray-300">check if there is an older address stored in that slot. If so, briefly attempt to connect to the older address, and if connection is successful, then the older address is <em>not</em> evicted from the tried table; the new address is stored in tried only if the connection fails.</p>

    <p class="text-gray-300">We analyze these three countermeasures. Suppose that there are <em>h</em> legitimate addresses in the tried table prior to the attack, and model network churn by supposing that each of the <em>h</em> legitimate addresses in tried is live (<em>i.e.,</em> accepts incoming connections) independently with probability <em>p</em>. With test-before-evict, the adversary cannot evict <em>p</em>&times;<em>h</em> legitimate addresses (in expectation) from tried, regardless of the number of distinct addresses it controls. Thus, even if the rest of tried is full of adversarial addresses, the probability of eclipsing the victim is bounded to about</p>

    <p class="text-gray-300">
<span class="math">$\\Pr[\\text{eclipse}] = f^8 &lt; \\left(1 - \\frac{p \\times h}{64 \\times 64}\\right)^8 \\tag{10}</span>$</p>

    <p class="text-gray-300">This is in stark contrast to today's protocol, where attackers with enough addresses have <em>unbounded</em> success probability even if tried is <em>full</em> of legitimate addresses.</p>

    <p class="text-gray-300">We perform Monte-Carlo simulations assuming churn <em>p</em>, <em>h</em> legitimate addresses initially stored in tried, and a botnet inserting <em>a</em> addresses into tried via unsolicited incoming connections. The area below each curve in Figure <a href="#page-12-0">8</a> is the number of bots <em>a</em> that can eclipse a victim with probability at least 50%, given that there are initially <em>h</em> legitimate addresses in tried. With test-before-evict, the curves plateau horizontally at <em>h</em> = 4096(1&minus; &radic;8 0.5)/<em>p</em>; as long as <em>h</em> is greater than this quantity, even a botnet <em>with an infinite number of addresses</em> has success probability bounded by 50%. Importantly, the plateau is absent without test-before-evict; a botnet with enough addresses can eclipse a victim <em>regardless</em> of the number of legitimate addresses <em>h</em> initially in tried.</p>

    <p class="text-gray-300">There is one problem, however. Our bitcoin nodes saw high churn rates (Table <a href="#page-8-3">1)</a>. With a <em>p</em> = 28% churn rate, for example, bounding the adversary's success probability to 10% requires about <em>h</em> = 3700 addresses in tried; our nodes had <em>h</em> &lt; 400. Our next countermeasure thus adds more legitimate addresses to tried:</p>

    <ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li>Feeler Connections. Add an outgoing connection that establish short-lived test connections to randomlyselected addresses in new. If connection succeeds, the address is evicted from new and inserted into tried; otherwise, the address is evicted from new.</li>
    </ol>

    <p class="text-gray-300">Feeler connections clean trash out of new while increasing the number of fresh address in tried that are likely to be online when a node restarts. Our fifth countermeasure is orthogonal to those above:</p>

    <ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li>Anchor connections. Inspired by Tor entry guard rotation rates <a href="#page-14-28">[33]</a>, we add two connections that persist</li>
    </ol>

    <p class="text-gray-300">    <img src="_page_12_Figure_0.jpeg" alt="" class="my-4 max-w-full" />
</p>

    <p class="text-gray-300">Figure 8: The area below each curve corresponds to a number of bots a that can eclipse a victim with probability at least 50%, given that the victim initially has h legitimate addresses in tried. We show one curve per churn rate p. (Top) With test before evict. (Bottom) Without.</p>

    <p class="text-gray-300">between restarts. Thus, we add an anchor table, recording addresses of current outgoing connections and the time of first connection to each address. Upon restart, the node dedicates two extra outgoing connections to the oldest anchor addresses that accept incoming connections. Now, in addition to defeating our other countermeasures, a successful attacker must also disrupt anchor connections; eclipse attacks fail if the victim connects to an anchor address not controlled by the attacker.</p>

    <p class="text-gray-300">Apart from these five countermeasures, a few other ideas can raise the bar for eclipse attacks:</p>

    <ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li>More buckets. Among the most obvious countermeasure is to increase the size of the tried and new tables. Suppose we doubled the number of buckets in the tried table. If we consider the infrastructure attack, the buckets filled by s groups jumps from  <span class="math">(1 - e^{-\\frac{4s}{64}})</span>  (per equation (9) to  <span class="math">(1 - e^{-\\frac{4s}{128}})</span> . Thus, an infrastructure attacker needs double the number of groups in order to expect to fill the same fraction of tried. Similarly, a botnet needs to double the number of bots. Importantly, however, this countermeasure is helpful only when tried already contains many legitimate addresses, so that attacker owns a smaller fraction of the addresses in tried. However, if tried is mostly empty (or contains mostly stale addresses for nodes that are no longer online), the attacker will still own a large fraction of the addresses in tried, even though the number of tried buckets has increased. Thus, this countermeasure should also be accompanied by another countermeasure (e.g., feeler connections) that increases the number of legitimate addresses stored in tried.</li>
    </ol>

    <p class="text-gray-300"><strong>7. More outgoing connections.</strong> Figure 7 indicates</p>

    <p class="text-gray-300">our test bitcoin nodes had at least 65 connections slots available, and [17] indicates that 80% of bitcoin peers allow at least 40 incoming connections. Thus, we can require nodes to make a few additional outgoing connections without risking that the network will run out of connection capacity. Indeed, recent measurements [51] indicate that certain nodes (<em>e.g.</em>, mining-pool gateways) do this already. For example, using twelve outgoing connections instead of eight (in addition to the feeler connection and two anchor connections), decreases the attack's success probability from  <span class="math">f^8</span>  to  <span class="math">f^{12}</span> ; to achieve 50% success probability the infrastructure attacker now needs 46 groups, and the botnet needs 11796 bots. While this improvement is not as dramatic Countermeasures 1-5, it is still a simple way to raise the bar for eclipse attacks.</p>

    <ul class="list-disc list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li><ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li>Ban unsolicited ADDR messages. A node could choose not to accept large unsolicited ADDR messages (with &gt; 10 addresses) from incoming peers, and only solicit ADDR messages from outgoing connections when its new table is too empty. This prevents adversarial incoming connections from flooding a victim's new table with trash addresses. We argue that this change is not harmful, since even in the current network, there is no shortage of address in the new table (Section 5). To make this more concrete, note that a node request ADDR messages upon establishing an outgoing connection. The peer responds with <em>n</em> randomly selected addresses from its tried and new tables, where n is a random number between x and 2500 and x is 23% of the addresses the peer has stored. If each peer sends, say, about n = 1700 addresses, then new is already 8n/16384 = 83% full the moment that the bitcoin node finishing establishing outgoing connections.</li>
    </ol></li>
      <li><strong>9.</strong> Diversify incoming connections. Today, a bitcoin node can have all of its incoming connections come from the same IP address, making it far too easy for a single computer to monopolize a victim's incoming connections during an eclipse attack or connection-starvation attack [32]. We suggest a node accept only a limited number of connections from the same IP address.</li>
      <li><ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li>Anomaly detection. Our attack has several specific &quot;signatures&quot; that make it detectable including: (1) a flurry of short-lived incoming TCP connections from diverse IP addresses, that send (2) large ADDR messages (3) containing &quot;trash&quot; IP addresses. An attacker that suddenly connects a large number of nodes to the bitcoin network could also be detected, as could one that uses eclipsing per Section 1.1 to dramatically decrease the network's mining power. Thus, monitoring and anomaly detection systems that look for this behavior are also be useful; at the very least, they would force an eclipse attacker to attack at low rate, or to waste resources on overwriting new (instead of using &quot;trash&quot; IP addresses).</li>
    </ol></li>
    </ul>

    <p class="text-gray-300"><strong>Status of our countermeasures.</strong> We disclosed our</p>

    <p class="text-gray-300">    <img src="_page_13_Figure_0.jpeg" alt="" class="my-4 max-w-full" />
</p>

    <p class="text-gray-300">Figure 9: Probability of eclipsing a node vs the number of addresses (bots) <em>t</em> for bitcoind v0.10.1 (with Countermeasures 1,2 and 6) when tried is initially full of legitimate addresses per equation (11).</p>

    <p class="text-gray-300">results to the bitcoin core developers in 02/2015. They deployed Countermeasures 1, 2, and 6 in the bitcoind v0.10.1 release, which now uses deterministic random eviction, random selection, and scales up the number of buckets in tried and new by a factor of four. To illustrate the efficacy of this, consider the worst-case scenario for the attacker where tried is completely full of legitimate addresses. We use Lemma A.1 to estimate the success rate of a botnet with t IP addresses as</p>

    <p class="text-gray-300">
<span class="math">$Pr[Eclipse] \\approx \\left(1 - \\left(\\frac{16383}{16384}\\right)^t\\right)^8</span>$
(11)</p>

    <p class="text-gray-300">Plotting (11) in Figure 9, we see that this botnet requires 163K addresses for a 50% success rate, and 284K address for a 90% success rate. This is good news, but we caution that ensuring that tried is full of legitimate address is still a challenge (Section 5), especially since there may be fewer than 16384 public-IP nodes in the bitcoin network at a given time. Countermeasures 3 and 4 are designed to deal with this, and so we have also developed a patch with these two countermeasures; see [40] for our implementation and its documentation.</p>

    </section>

    <section id="sec-8" class="mb-10">
      <h2 class="text-2xl font-bold">8 Related Work</h2>

    <p class="text-gray-300">The bitcoin peer-to-peer (p2p) network. Recent work considers how bitcoin's network can delay or prevent block propagation [31] or be used to deanonymize bitcoin users [16, 17, 48]. These works discuss aspects of bitcoin's networking protocol, with [16] providing an excellent description of ADDR message propagation; we focus instead on the structure of the tried and new tables, timestamps and their impact on address selection (Section 2). [17] shows that nodes connecting over Tor can be eclipsed by a Tor exit node that manipulates both bitcoin and Tor. Other work has mapped bitcoin peers to autonomous systems [38], geolocated peers and measured churn [34], and used side channels to learn the bitcoin network topology [16, 51].</p>

    <p class="text-gray-300"><strong>p2p and botnet architectures.</strong> There has been extensive research on eclipse attacks [27, 61, 62] in</p>

    <p class="text-gray-300">structured p2p networks built upon distributed hash tables (DHTs); see [64] for a survey. Many proposals defend against eclipse attacks by adding more structure; [61] constrains peer degree, while others use constraints based on distance metrics like latency [42] or DHT identifiers [13]. Bitcoin, by contrast, uses an unstructured network. While we have focused on exploiting specific quirks in bitcoin's existing network, other works e.g., [11, 15, 21, 44] design new unstructured networks that are robust to Byzantine attacks. [44] blacklists misbehaving peers. Puppetcast's [15] centralized solution is based on public-key infrastructure [15], which is not appropriate for bitcoin. Brahms [21] is fully decentralized, and instead constrains the rate at which peers exchange network information&mdash;a useful idea that is a significant departure from bitcoin's current approach. Meanwhile, our goals are also more modest than those in these works; rather than requiring that each node is equally likely to be sampled by an honest node, we just want to limit eclipse attacks on initially well-connected nodes. Thus, our countermeasures are inspired by botnet architectures, which share this same goal. Rossow et al. [59] finds that many botnets, like bitcoin, use unstructured peer-to-peer networks and gossip (i.e., ADDR messages), and describes how botnets defend against attacks that flood local address tables with bogus information. The Sality botnet refuses to evict &quot;high-reputation&quot; addresses; our anchor countermeasure is similar (Section 7). Storm uses testbefore-evict [30], which we have also recommended for bitcoin. Zeus [12] disallows connections from multiple IP in the same /20, and regularly clean tables by testing if peers are online; our feeler connections are similar.</p>

    </section>

    <section id="sec-9" class="mb-10">
      <h2 class="text-2xl font-bold">9 Conclusion</h2>

    <p class="text-gray-300">We presented an eclipse attack on bitcoin's peer-to-peer network that undermines bitcoin's core security guarantees, allowing attacks on the mining and consensus system, including N-confirmation double spending and adversarial forks in the blockchain. Our attack is for nodes with public IPs. We developed mathematical models of our attack, and validated them with Monte Carlo simulations, measurements and experiments. We demonstrated the practically of our attack by performing it on our own live bitcoin nodes, finding that an attacker with 32 distinct /24 IP address blocks, or a 4600-node botnet, can eclipse a victim with over 85% probability in the attacker's worst case. Moreover, even a 400-node botnet sufficed to attack our own live bitcoin nodes. Finally, we proposed countermeasures that make eclipse attacks more difficult while still preserving bitcoin's openness and decentralization; several of these were incorporated in a recent bitcoin software upgrade.</p>

    </section>

    <section id="acknowledgements" class="mb-10">
      <h2 class="text-2xl font-bold">Acknowledgements</h2>

    <p class="text-gray-300">We thank Foteini Baldimtsi, Wil Koch, and the USENIX Security reviewers for comments on this paper, various bitcoin users for donating their peers files, and the bitcoin core devs for discussions and for implementing Countermeasures 1,2,6. E.H., A.K., S.G. were supported in part by NSF award 1350733, and A.Z. by ISF Grants 616/13, 1773/13, and the Israel Smart Grid (ISG) Consortium.</p>

    </section>

    <section id="references" class="mb-10">
      <h2 class="text-2xl font-bold">References</h2>

    <ul class="space-y-2 text-gray-400 text-sm list-none">
      <li><p class="text-gray-300">[1] Amazon web services elastic ip. <a href="http://aws.amazon.com/ec2/faqs/#elastic-ip" target="_blank" rel="noopener noreferrer">http://aws.amazon.com/</a> <a href="http://aws.amazon.com/ec2/faqs/#elastic-ip" target="_blank" rel="noopener noreferrer">ec2/faqs/#elastic-ip</a>. Accessed: 2014-06-18.</p></li>
      <li><p class="text-gray-300">[2] Bitcoin: Common vulnerabilities and exposures. <a href="https://en.bitcoin.it/wiki/Common_Vulnerabilities_and_Exposures" target="_blank" rel="noopener noreferrer">https:</a> <a href="https://en.bitcoin.it/wiki/Common_Vulnerabilities_and_Exposures" target="_blank" rel="noopener noreferrer">//en.bitcoin.it/wiki/Common\\<em>Vulnerabilities\\_and\\</em></a> <a href="https://en.bitcoin.it/wiki/Common_Vulnerabilities_and_Exposures" target="_blank" rel="noopener noreferrer">Exposures</a>. Accessed: 2014-02-11.</p></li>
      <li><p class="text-gray-300">[3] Bitcoin wiki: Double-spending. <a href="https://en.bitcoin.it/wiki/Double-spending" target="_blank" rel="noopener noreferrer">https://en.bitcoin.it/</a> <a href="https://en.bitcoin.it/wiki/Double-spending" target="_blank" rel="noopener noreferrer">wiki/Double-spending</a>. Accessed: 2014-02-09.</p></li>
      <li><p class="text-gray-300">[4] Bitnode.io snapshot of reachable nodes. <a href="https://getaddr.bitnodes.io/nodes/" target="_blank" rel="noopener noreferrer">https://getaddr.</a> <a href="https://getaddr.bitnodes.io/nodes/" target="_blank" rel="noopener noreferrer">bitnodes.io/nodes/</a>. Accessed: 2014-02-11.</p></li>
      <li><p class="text-gray-300">[5] Bitpay: What is transaction speed? <a href="https://support.bitpay.com/hc/en-us/articles/202943915-What-is-Transaction-Speed-" target="_blank" rel="noopener noreferrer">https:</a> <a href="https://support.bitpay.com/hc/en-us/articles/202943915-What-is-Transaction-Speed-" target="_blank" rel="noopener noreferrer">//support.bitpay.com/hc/en-us/articles/</a> <a href="https://support.bitpay.com/hc/en-us/articles/202943915-What-is-Transaction-Speed-" target="_blank" rel="noopener noreferrer">202943915-What-is-Transaction-Speed-</a>. Accessed: 2014-02-09.</p></li>
      <li><p class="text-gray-300">[6] Bug bounty requested: 10 btc for huge dos bug in all current bitcoin clients. Bitcoin Forum. <a href="https://bitcointalk.org/index.php?topic=944369.msg10376763#msg10376763" target="_blank" rel="noopener noreferrer">https://bitcointalk.org/</a> <a href="https://bitcointalk.org/index.php?topic=944369.msg10376763#msg10376763" target="_blank" rel="noopener noreferrer">index.php?topic=944369.msg10376763#msg10376763</a>. Accessed: 2014-06-17.</p></li>
      <li><p class="text-gray-300">[7] CVE-2013-5700: Remote p2p crash via bloom filters. <a href="https://en.bitcoin.it/wiki/Common_Vulnerabilities_and_Exposures" target="_blank" rel="noopener noreferrer">https:</a> <a href="https://en.bitcoin.it/wiki/Common_Vulnerabilities_and_Exposures" target="_blank" rel="noopener noreferrer">//en.bitcoin.it/wiki/Common\\<em>Vulnerabilities\\_and\\</em></a> <a href="https://en.bitcoin.it/wiki/Common_Vulnerabilities_and_Exposures" target="_blank" rel="noopener noreferrer">Exposures</a>. Accessed: 2014-02-11.</p></li>
      <li><p class="text-gray-300">[8] Microsoft azure ip address pricing. <a href="http://azure.microsoft.com/en-us/pricing/details/ip-addresses/" target="_blank" rel="noopener noreferrer">http://</a> <a href="http://azure.microsoft.com/en-us/pricing/details/ip-addresses/" target="_blank" rel="noopener noreferrer">azure.microsoft.com/en-us/pricing/details/</a> <a href="http://azure.microsoft.com/en-us/pricing/details/ip-addresses/" target="_blank" rel="noopener noreferrer">ip-addresses/</a>. Accessed: 2014-06-18.</p></li>
      <li><p class="text-gray-300">[9] Rackspace: Requesting additional ipv4 addresses for cloud servers. <a href="http://www.rackspace.com/knowledge_center/article/requesting-additional-ipv4-addresses-for-cloud-servers" target="_blank" rel="noopener noreferrer">http://www.</a> <a href="http://www.rackspace.com/knowledge_center/article/requesting-additional-ipv4-addresses-for-cloud-servers" target="_blank" rel="noopener noreferrer">rackspace.com/knowledge\\_center/article/</a> <a href="http://www.rackspace.com/knowledge_center/article/requesting-additional-ipv4-addresses-for-cloud-servers" target="_blank" rel="noopener noreferrer">requesting-additional-ipv4-addresses-for-cloud-servers</a>. Accessed: 2014-06-18.</p></li>
      <li><p class="text-gray-300">[10] Ghash.io and double-spending against betcoin dice, October 30 2013.</p></li>
      <li><p class="text-gray-300">[11] ANCEAUME, E., BUSNEL, Y., AND GAMBS, S. On the power of the adversary to solve the node sampling problem. In <em>Transactions on Large-Scale Data-and Knowledge-Centered Systems XI</em>. Springer, 2013, pp. 102&ndash;126.</p></li>
      <li><p class="text-gray-300">[12] ANDRIESSE, D., AND BOS, H. An analysis of the zeus peer-topeer protocol, April 2014.</p></li>
      <li><p class="text-gray-300">[13] AWERBUCH, B., AND SCHEIDELER, C. Robust random number generation for peer-to-peer systems. In <em>Principles of Distributed Systems</em>. Springer, 2006, pp. 275&ndash;289.</p></li>
      <li><p class="text-gray-300">[14] BAHACK, L. Theoretical bitcoin attacks with less than half of the computational power (draft). <em>arXiv preprint arXiv:1312.7013</em> (2013).</p></li>
      <li><p class="text-gray-300">[15] BAKKER, A., AND VAN STEEN, M. Puppetcast: A secure peer sampling protocol. In <em>European Conference on Computer Network Defense (EC2ND)</em> (2008), IEEE, pp. 3&ndash;10.</p></li>
      <li><p class="text-gray-300">[16] BIRYUKOV, A., KHOVRATOVICH, D., AND PUSTOGAROV, I. Deanonymisation of clients in Bitcoin P2P network. In <em>Proceedings of the 2014 ACM SIGSAC Conference on Computer and Communications Security</em> (2014), ACM, pp. 15&ndash;29.</p></li>
      <li><p class="text-gray-300">[17] BIRYUKOV, A., AND PUSTOGAROV, I. Bitcoin over tor isn't a good idea. <em>arXiv preprint arXiv:1410.6079</em> (2014).</p></li>
      <li><p class="text-gray-300">[18] BITCOIN WIKI. Confirmation. <a href="https://en.bitcoin.it/wiki/Confirmation" target="_blank" rel="noopener noreferrer">https://en.bitcoin.it/</a> <a href="https://en.bitcoin.it/wiki/Confirmation" target="_blank" rel="noopener noreferrer">wiki/Confirmation</a>, February 2015.</p></li>
      <li><p class="text-gray-300">[19] BITCOIN WISDOM. Bitcoin difficulty and hash rate chart. <a href="https://bitcoinwisdom.com/bitcoin/difficulty" target="_blank" rel="noopener noreferrer">https://bitcoinwisdom.com/bitcoin/difficulty</a>, February 2015.</p></li>
      <li><p class="text-gray-300">[20] BLOCKCHAIN.IO. Average transaction confirmation time. <a href="https://blockchain.info/charts/avg-confirmation-time" target="_blank" rel="noopener noreferrer">https://blockchain.info/charts/</a> <a href="https://blockchain.info/charts/avg-confirmation-time" target="_blank" rel="noopener noreferrer">avg-confirmation-time</a>, February 2015.</p></li>
      <li><p class="text-gray-300">[21] BORTNIKOV, E., GUREVICH, M., KEIDAR, I., KLIOT, G., AND SHRAER, A. Brahms: Byzantine resilient random membership sampling. <em>Computer Networks 53</em>, 13 (2009), 2340&ndash;2359.</p></li>
      <li><p class="text-gray-300">[22] BRANDS, S. Untraceable off-line cash in wallets with observers (extended abstract). In <em>CRYPTO</em> (1993).</p></li>
      <li><p class="text-gray-300">[23] CAIDA. AS to Organization Mapping Dataset, July 2014.</p></li>
      <li><p class="text-gray-300">[24] CAIDA. Routeviews prefix to AS Mappings Dataset for IPv4 and IPv6, July 2014.</p></li>
      <li><p class="text-gray-300">[25] CAMENISCH, J., HOHENBERGER, S., AND LYSYANSKAYA, A. Compact e-cash. In <em>EUROCRYPT</em> (2005).</p></li>
      <li><p class="text-gray-300">[26] CARNABOTNET. Internet census 2012. <a href="http://internetcensus2012.bitbucket.org/paper.html" target="_blank" rel="noopener noreferrer">http:</a> <a href="http://internetcensus2012.bitbucket.org/paper.html" target="_blank" rel="noopener noreferrer">//internetcensus2012.bitbucket.org/paper.html</a>, 2012.</p></li>
      <li><p class="text-gray-300">[27] CASTRO, M., DRUSCHEL, P., GANESH, A., ROWSTRON, A., AND WALLACH, D. S. Secure routing for structured peer-topeer overlay networks. <em>ACM SIGOPS Operating Systems Review 36</em>, SI (2002), 299&ndash;314.</p></li>
      <li><p class="text-gray-300">[28] CHAUM, D. Blind signature system. In <em>CRYPTO</em> (1983).</p></li>
      <li><p class="text-gray-300">[29] COURTOIS, N. T., AND BAHACK, L. On subversive miner strategies and block withholding attack in bitcoin digital currency. <em>arXiv preprint arXiv:1402.1718</em> (2014).</p></li>
      <li><p class="text-gray-300">[30] DAVIS, C. R., FERNANDEZ, J. M., NEVILLE, S., AND MCHUGH, J. Sybil attacks as a mitigation strategy against the storm botnet. In <em>3rd International Conference on Malicious and Unwanted Software, 2008.</em> (2008), IEEE, pp. 32&ndash;40.</p></li>
      <li><p class="text-gray-300">[31] DECKER, C., AND WATTENHOFER, R. Information propagation in the bitcoin network. In <em>IEEE Thirteenth International Conference on Peer-to-Peer Computing (P2P)</em> (2013), IEEE, pp. 1&ndash;10.</p></li>
      <li><p class="text-gray-300">[32] DILLON, J. Bitcoin-development mailinglist: Protecting bitcoin against network-wide dos attack. <a href="http://sourceforge.net/p/bitcoin/mailman/message/31168096/" target="_blank" rel="noopener noreferrer">http://sourceforge.net/</a> <a href="http://sourceforge.net/p/bitcoin/mailman/message/31168096/" target="_blank" rel="noopener noreferrer">p/bitcoin/mailman/message/31168096/</a>, 2013. Accessed: 2014-02-11.</p></li>
      <li><p class="text-gray-300">[33] DINGLEDINE, R., HOPPER, N., KADIANAKIS, G., AND MATH-EWSON, N. One fast guard for life (or 9 months). In <em>7th Workshop on Hot Topics in Privacy Enhancing Technologies (HotPETs 2014)</em> (2014).</p></li>
      <li><p class="text-gray-300">[34] DONET, J. A. D., PEREZ &acute; -SOLA, C., AND HERRERA-JOANCOMART&acute;I, J. The bitcoin p2p network. In <em>Financial Cryptography and Data Security</em>. Springer, 2014, pp. 87&ndash;102.</p></li>
      <li><p class="text-gray-300">[35] DURUMERIC, Z., WUSTROW, E., AND HALDERMAN, J. A. ZMap: Fast Internet-wide scanning and its security applications. In <em>Proceedings of the 22nd USENIX Security Symposium</em> (Aug. 2013).</p></li>
      <li><p class="text-gray-300">[36] EYAL, I. The miner's dilemma. <em>arXiv preprint arXiv:1411.7099</em> (2014).</p></li>
      <li><p class="text-gray-300">[37] EYAL, I., AND SIRER, E. G. Majority is not enough: Bitcoin mining is vulnerable. In <em>Financial Cryptography and Data Security</em>. Springer, 2014, pp. 436&ndash;454.</p></li>
      <li><p class="text-gray-300">[38] FELD, S., SCHONFELD &uml; , M., AND WERNER, M. Analyzing the deployment of bitcoin's p2p network under an as-level perspective. <em>Procedia Computer Science 32</em> (2014), 1121&ndash;1126.</p></li>
      <li><p class="text-gray-300">[39] FINNEY, H. Bitcoin talk: Finney attack. //bitcointalk.org/index.php?topic=3441.msg48384# msg48384, 2011. Accessed: 2014-02-12.</p></li>
      <li><p class="text-gray-300">[40] HEILMAN, E. Bitcoin: Added test-before-evict discipline in addrman, feeler connections. https://github.com/bitcoin/ bitcoin/pull/6355.</p></li>
      <li><p class="text-gray-300">[41] HEILMAN, How addresses many ip dns query return? http:// ethanheilman.tumblr.com/post/110920218915/  <span class="math">\\verb|how-many-ip-addresses-can-a-dns-query-return|,</span> 2015. Accessed: 2014-02-13.</p></li>
      <li><p class="text-gray-300">[42] HILDRUM, K., AND KUBIATOWICZ, J. Asymptotically efficient approaches to fault-tolerance in peer-to-peer networks. In Distributed Computing. Springer, 2003, pp. 321-336.</p></li>
      <li><p class="text-gray-300">Iana ipv4 address space registry. //www.iana.org/assignments/ipv4-address-space/ ipv4-address-space.xhtml, January 2015.</p></li>
      <li><p class="text-gray-300">[44] JESI, G. P., MONTRESOR, A., AND VAN STEEN, M. Secure peer sampling. Computer Networks 54, 12 (2010), 2086&ndash;2098.</p></li>
      <li><p class="text-gray-300">[45] JOHNSON, B., LASZKA, A., GROSSKLAGS, J., VASEK, M., AND MOORE, T. Game-theoretic analysis of ddos attacks against bitcoin mining pools. In Financial Cryptography and Data Security. Springer, 2014, pp. 72-86.</p></li>
      <li><p class="text-gray-300">[46] KARAME, G., ANDROULAKI, E., AND CAPKUN, S. Two bitcoins at the price of one? double-spending attacks on fast payments in bitcoin. IACR Cryptology ePrint Archive 2012 (2012), 248.</p></li>
      <li><p class="text-gray-300">[47] KING, L. Bitcoin hit by 'massive' ddos at-Forbes http://www. tack as tensions rise. forbes. com/sites/leoking/2014/02/12/ bitcoin-hit-by-massive-ddos-attack-as-tensions-rise/ Lemma~A.1.~ If k items are randomly and independently (December 2 2014).</p></li>
      <li><p class="text-gray-300">[48] KOSHY, P., KOSHY, D., AND MCDANIEL, P. An analysis of anonymity in bitcoin using p2p network traffic. In Financial Cryptography and Data Security. 2014.</p></li>
      <li><p class="text-gray-300">[49] KROLL, J. A., DAVEY, I. C., AND FELTEN, E. W. The economics of bitcoin mining, or bitcoin in the presence of adversaries. In Proceedings of WEIS (2013), vol. 2013.</p></li>
      <li><p class="text-gray-300">[50] LASZKA, A., JOHNSON, B., AND GROSSKLAGS, J. When bitcoin mining pools run dry. 2nd Workshop on Bitcoin Research (BITCOIN) (2015).</p></li>
      <li><p class="text-gray-300">[51] MILLER, A., LITTON, J., PACHULSKI, A., GUPTA, N., LEVIN, D., SPRING, N., AND BHATTACHARJEE, B. Discovering bitcoin's network topology and influential nodes. Tech. rep., University of Maryland, 2015.</p></li>
      <li><p class="text-gray-300">[52] NAKAMOTO, S. Bitcoin: A peer-to-peer electronic cash system.</p></li>
      <li><p class="text-gray-300">[53] OPENSSL. TLS heartbeat read overrun (CVE-2014-0160). https://www.openssl.org/news/secadv_20140407.txt, April 7 2014.</p></li>
      <li><p class="text-gray-300">[54] PLOHMANN, D., AND GERHARDS-PADILLA, E. Case study of the miner botnet. In Cyber Conflict (CYCON), 2012 4th International Conference on (2012), IEEE, pp. 1-16.</p></li>
      <li><p class="text-gray-300">Ripestat. https://stat.ripe.net/data/ announced-prefixes, October 2014.</p></li>
      <li><p class="text-gray-300">[56] RIPE. Latest delegations. ftp://ftp.ripe.net/pub/stats/ ripencc/delegated-ripencc-extended-latest, 2015.</p></li>
      <li><p class="text-gray-300">[57] ROADTRAIN. Bitcoin-talk: Ghash.io and double-spending against betcoin dice. https://bitcointalk.org/index. php?topic=321630.msg3445371#msg3445371, 2013. Accessed: 2014-02-14.</p></li>
      <li><p class="text-gray-300">[58] ROSENFELD, M. Analysis of hashrate-based double spending. arXiv preprint arXiv:1402.2009 (2014).</p></li>
      <li><p class="text-gray-300">[59] ROSSOW, C., ANDRIESSE, D., WERNER, T., STONE-GROSS, B., PLOHMANN, D., DIETRICH, C. J., AND BOS, H. Sok: P2pwned-modeling and evaluating the resilience of peer-to-peer botnets. In IEEE Symposium on Security and Privacy (2013), IEEE, pp. 97-111.</p></li>
      <li><p class="text-gray-300">[60] SHOMER, A. On the phase space of block-hiding strategies. IACR Cryptology ePrint Archive 2014 (2014), 139.</p></li>
      <li><p class="text-gray-300">[61] SINGH, A., NGAN, T.-W. J., DRUSCHEL, P., AND WALLACH, D. S. Eclipse attacks on overlay networks: Threats and defenses. In In IEEE INFOCOM (2006).</p></li>
      <li><p class="text-gray-300">[62] SIT, E., AND MORRIS, R. Security considerations for peer-topeer distributed hash tables. In Peer-to-Peer Systems. Springer, 2002, pp. 261-269.</p></li>
      <li><p class="text-gray-300">[63] STOCK, B., GOBEL, J., ENGELBERTH, M., FREILING, F. C., AND HOLZ, T. Walowdac: Analysis of a peer-to-peer botnet. In European Conference on Computer Network Defense (EC2ND) (2009), IEEE, pp. 13-20.</p></li>
      <li><p class="text-gray-300">[64] URDANETA, G., PIERRE, G., AND STEEN, M. V. A survey of dht security techniques. ACM Computing Surveys (CSUR) 43, 2 (2011), 8.</p></li>
      <li><p class="text-gray-300">[65] VASEK, M., THORNTON, M., AND MOORE, T. Empirical analysis of denial-of-service attacks in the bitcoin ecosystem. In Financial Cryptography and Data Security. Springer, 2014, pp. 57-</p></li>
    </ul>

    </section>

    <section id="app-a" class="mb-10">
      <h2 class="text-2xl font-bold">A Useful Lemma</h2>

    <p class="text-gray-300">inserted into n buckets, and X is a random variable counting the number of non-empty buckets, then</p>

    <p class="text-gray-300"><span class="math">$E[X] = n\\left(1 - (\\frac{n-1}{n})^k\\right) \\approx n(1 - e^{-\\frac{k}{n}})</span>$
(12)</p>

    <p class="text-gray-300"><em>Proof.</em> Let  <span class="math">X_i = 1</span>  if bucket i is non-empty, and  <span class="math">X_i = 0</span> otherwise. The probability that the bucket i is empty after the first item is inserted is  <span class="math">(\\frac{n-1}{n})</span> . After inserting k items</p>

    <p class="text-gray-300">
<span class="math">$\\Pr[X_i = 1] = 1 - \\left(\\frac{n-1}{n}\\right)^k</span>$</p>

    <p class="text-gray-300">It follows that</p>

    <p class="text-gray-300"><span class="math">$E[X] = \\sum_{i=1}^{n} E[X_i] = \\sum_{i=1}^{n} \\Pr[X_i = 1] = n(1 - (\\frac{n-1}{n})^k)</span>$</p>

    <p class="text-gray-300">(12) follows since
<span class="math">$\\left(\\frac{n-1}{n}\\right) \\approx e^{-1/n}</span>$
for  <span class="math">n \\gg 1</span> .</p>

    <h4 id="sec-misc-1" class="text-lg font-semibold mt-6"><strong>Overwriting the New Table</strong></h4>

    <p class="text-gray-300">How should the attacker send ADDR messages that overwrite the new table with &quot;trash&quot; IP addresses? Our &quot;trash&quot; is from the unallocated Class A IPv4 address block 252.0.0.0/8, designated by IANA as &quot;reserved for future use&quot; [43]; any connections these addresses will fail, forcing the victim to choose an address from tried. Next, recall (Section 2.2) that the pair (group, source</p>

    <p class="text-gray-300">    <img src="_page_16_Figure_0.jpeg" alt="" class="my-4 max-w-full" />
</p>

    <p class="text-gray-300">Figure 10: E[N] vs s (the number of source groups) for different choices of g (number of groups per source group) when overwriting the new table per equation (13).</p>

    <p class="text-gray-300">group) determines the bucket in which an address in an ADDR message is stored. Thus, if the attacker controls nodes in s different groups, then s is the number of source groups. We suppose that nodes in each source group can push ADDR messages containing addresses from g distinct groups; the &quot;trash&quot; 252.0.0.0/8 address block give an upper bound on g of  <span class="math">2^8 = 256</span> . Each group contains a distinct addresses. How large should s, g, and a be so that the new table is overwritten by &quot;trash&quot; addresses?</p>

    <p class="text-gray-300">In an infrastructure attack, the number of source groups <em>s</em> is constrained, and the number of groups <em>g</em> is essentially unconstrained. By Lemma A.1, the expected number of buckets filled by a <em>s</em> source groups is</p>

    <p class="text-gray-300">
<span class="math">$E[N] = 256(1 - (\\frac{255}{256})^{32s}) \\tag{13}</span>$</p>

    <p class="text-gray-300">We expect to fill  <span class="math">\\approx 251</span>  of 256 new buckets with s = 32. Each (group, source group) pair maps to a unique bucket in new, and each bucket in new can hold 64 addresses. Bitcoin eviction is used, and we suppose each new bucket is completely full of legitimate addresses that are older than all the addresses inserted by the adversary via ADDR messages. Since all a addresses in a particular (group, source group) pair map to a single bucket, it follows that the number of addresses that actually stored in that bucket is given by  <span class="math">E[Y_a]</span>  in the recurrence relation of equations of (5)-(6). With a = 125 addresses, the adversary expects to overwrite  <span class="math">E[Y_a] = 63.8</span>  of the 64 legitimate addresses in the bucket. We thus require each source group to have 32 peers, and each peer to send ADDR messages with 8 distinct groups of a = 125addresses. Thus, there are  <span class="math">g = 32 \\times 8 = 256</span>  groups per source group, which is exactly the maximum number of groups available in our trash IP address block. Each peer sends exactly one ADDR message with  <span class="math">8 \\times 125 = 1000</span>  address, for a total of  <span class="math">256 \\times 125 \\times s</span>  distinct addresses sent by all peers. (There are  <span class="math">2^{24}</span>  addresses in the 252.0.0.0/8 block, so all these addresses are distinct if s &lt; 524.)</p>

      <h3 id="app-b.2" class="text-xl font-semibold mt-8"><strong>B.2</strong> Botnet strategy</h3>

    <p class="text-gray-300">In a botnet attack, each of the attacker's t nodes is in a distinct source group. For s=t&gt;200, which is the case for all our botnet attacks, equation (13) shows that the number of source groups s=t is essentially unconstrained. We thus require each peer to send a single ADDR message containing 1000 addresses with 250 distinct groups of four addresses each. Since s=t is so large, we can model this by assuming that each (group, source group) pair selects a bucket in new uniformly at random, and inserts 4 addresses into that bucket; thus, the expected number of addresses inserted per bucket will be tightly concentrated around</p>

    <p class="text-gray-300"><span class="math">$4 \\times E[B(250t, \\frac{1}{256})] = 3.9t</span>$</p>

    <p class="text-gray-300">For t &gt; 200, we expect at least 780 address to be inserted into each bucket. From equations (5) and (6), we find  <span class="math">E[Y_{780}] \\approx 64</span> , so that each new bucket is likely to be full.</p>

    </section>

    <section id="app-c" class="mb-10">
      <h2 class="text-2xl font-bold">C Infrastructure Attack on Tried Table</h2>

    <p class="text-gray-300">In Section 4.2 we found the distribution of  <span class="math">\\Gamma</span> , the number of non-empty buckets in tried, given that an infrastructure attacker has addresses in s distinct groups. We now determine the expected number of attacker addresses stored in each tried bucket, given t addresses per group. To do this, we first find how many distinct addresses hash to a given a bucket, and then find how many of these addresses will actually be stored in the bucket.</p>

    <p class="text-gray-300">How many addresses hash to a bucket? Recall that each group makes 4 uniform random draws of one of 64 possible buckets in tried. Considering a single bucket i, the probability that a single group hashes to bucket i is</p>

    <p class="text-gray-300">
<span class="math">$\\frac{1}{\\alpha} = 1 - (\\frac{63}{64})^4 \\approx \\frac{1}{16} \\tag{14}</span>$</p>

    <p class="text-gray-300">If  <span class="math">G_i</span>  counts the number of distinct groups hashing to bucket i, then  <span class="math">G_i</span>  is binomially distributed as  <span class="math">G_i \\sim B(s,\\frac{1}{\\alpha})</span> . If  <span class="math">G_i=g</span>  groups hash to bucket i, and each group contains t addresses hashing to up to 4 distinct buckets,  <span class="math">^{10}</span>  then the number of addresses hashing to bucket i is the random variable  <span class="math">A_i \\sim B(gt,\\frac{1}{4})</span> , with distribution</p>

    <p class="text-gray-300"><span class="math">$\\Pr[A_i = a] = \\sum_{g=0}^{s} \\Pr[B(gt, \\frac{1}{4}) = a] \\Pr[B(s, \\frac{1}{\\alpha}) = g]</span>$
(15)</p>

    <p class="text-gray-300">and expected value  <span class="math">E[A_i] = \\frac{t}{4} \\frac{s}{\\alpha}</span> . We plot the probability distribution of  <span class="math">A_i</span>  in Figure 11; the distribution has a</p>

    <p class="text-gray-300"> <span class="math">&lt;sup&gt;^{10}&lt;/sup&gt;</span>  Actually this is an underestimate that assumes that each group hashes to exactly 4 buckets; in practice a group can maps to Z buckets, where Z is a random variable with range  <span class="math">\\{1,2,3,4\\}</span> . The random variable  <span class="math">Z-1\\approx B(3,\\frac{63}{64})</span>  is has a binomial distribution and  <span class="math">E[Z]=1+3\\frac{63}{64}=3.95</span> . But an underestimate is fine here, since we need to know how many attacker addresses are needed to fill a bucket.</p>

    <p class="text-gray-300">    <img src="_page_17_Figure_0.jpeg" alt="" class="my-4 max-w-full" />
</p>

    <p class="text-gray-300">Figure 11: Distribution of <em>A<sup>i</sup></em> , for different choices of <em>s</em> (the number of groups) and with <em>t</em> = 256 (addresses per group), per equation <a href="#page-16-3">(15)</a>.</p>

    <p class="text-gray-300">multi-peaked shape, where the first peak corresponds to <em>G<sup>i</sup></em> = 1, <em>i.e.,</em> a single group hashes to bucket <em>i</em>, the second peak corresponds to <em>G<sup>i</sup></em> = 2, and so on. Moreover, while difficult to see in the plot, there is also a non-negligible probability that <em>A<sup>i</sup></em> = 0, which occurs when <em>G<sup>i</sup></em> = 0.</p>

    <p class="text-gray-300">How many addresses are stored in a bucket? Now that we know that <em>A<sup>i</sup></em> addresses hash to bucket <em>i</em>, we need to figure out how many of these addresses will actually be <em>stored</em> in the bucket. We consider a variety of situations.</p>

    <ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li>Initially empty. In the best case for the attacker, bucket <em>i</em> is initially empty. The expected number of addresses that end up getting stored in bucket <em>i</em>, given that <em>at least one group hashes to bucket i</em> is</li>
    </ol>

    <p class="text-gray-300">
<span class="math">$E[\\min(64, A_i)|G_i &gt; 0] \\tag{16}</span>$</p>

    <p class="text-gray-300">This is the quantity of interest, since if no groups map to bucket <em>i</em>, we cannot fill the bucket by increasing <em>t</em>, the number of addresses per group; instead we must increase <em>s</em>, the number of groups.</p>

    <ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li>Bitcoin eviction. In the worst-case for the attacker, we suppose that bucket <em>i</em> is completely full of 64 legitimate addresses. Let <em>Y<sup>a</sup></em> be the number of adversarial addresses actually stored in bucket <em>i</em>, given that the adversary inserted <em>a</em> unique addresses into bucket <em>i</em>; if bitcoin eviction is used, <em>E</em>[<em>Ya</em>] is given by the recurrence relation in equations <a href="#page-7-8">(5)</a>-<a href="#page-7-4">(6)</a>. The expected number of addresses stored in bucket <em>i</em>, given that at least one group hashes to bucket <em>i</em>, is</li>
    </ol>

    <p class="text-gray-300">
<span class="math">$\\sum_{a=0}^{st} E[Y_a] \\Pr[A_i = a | G_i &gt; 0]</span>$
(17)</p>

    <p class="text-gray-300">which we can compute numerically by combining the recurrence for <em>E</em>[<em>Ya</em>] with the distribution of <em>A<sup>i</sup></em> from <a href="#page-16-3">(15)</a>.</p>

    <ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li>Random eviction. We once again assume that bucket <em>i</em> is completely full of legitimate addresses, but now we assume that each time an address is inserted it evicts a</li>
    </ol>

    <p class="text-gray-300">randomly-selected address. If <em>Y<sup>a</sup></em> is defined as above, then by Lemma <a href="#page-15-20">A.1</a></p>

    <p class="text-gray-300">
<span class="math">$E[Y_a] = 64(1 - (\\frac{63}{64})^a) \\tag{18}</span>$</p>

    <p class="text-gray-300">and substituting equation <a href="#page-17-3">(18)</a> into <a href="#page-17-1">(17)</a> we get the expected number of addresses stored in bucket <em>i</em>, given that at least one group hashes to bucket <em>i</em>.</p>

    <p class="text-gray-300">How full is tried? <em>f</em> is the fraction of tried filled by by adversarial addresses. The exact value of <em>E</em>[ <em>f</em> ] is</p>

    <p class="text-gray-300"><span class="math">$E[f] = \\sum_{\\gamma=1}^{s} \\sum_{a=0}^{st} E[Y_a] \\Pr[A_i = a | G_i &gt; 0] \\Pr[\\Gamma = \\gamma]</span>$</p>

    <p class="text-gray-300">in the random and bitcoin evictions scenarios, and</p>

    <p class="text-gray-300"><span class="math">$E[f] = \\sum_{\\gamma=1}^{s} \\sum_{a=0}^{st} E[\\min(64, A_i) | G_i &gt; 0] \\Pr[A_i = a | G_i &gt; 0] \\Pr[\\Gamma = \\gamma]</span>$</p>

    <p class="text-gray-300">in the initially empty scenario. But to keep things simple, Figure <a href="#page-7-7">5</a> in Section <a href="#page-6-0">4</a> estimates <em>E</em>[ <em>f</em> ] for each scenario simply by taking the product of the expected number of attacker addresses stored per bucket (given that at least one attacker group maps to that bucket) and the expected number of non-empty buckets <em>E</em>[&Gamma;] from <a href="#page-7-5">(9)</a>; we verified numerically that this provides an accurate estimate.</p>

    </section>
`;
---

<BaseLayout title="Eclipse Attacks on Bitcoins Peer-to-Peer Network (2015/263)">
  <article class="max-w-4xl mx-auto article-prose">
    <nav class="mb-8">
      <a href="/papers" class="text-blue-400 hover:text-blue-300">
        &larr; Back to Papers
      </a>
    </nav>

    <header class="mb-12">
      <h1 class="text-3xl font-bold mb-4"
        set:html={TITLE_HTML} />
      <p class="text-gray-400 mb-2"
        set:html={AUTHORS_HTML} />
      <p class="text-gray-500 text-sm mb-4">
        2015 &middot; eprint 2015/263
      </p>
      <div class="flex gap-4 text-sm">
        <a
          href={EPRINT_URL}
          target="_blank"
          rel="noopener noreferrer"
          class="text-blue-400 hover:text-blue-300"
        >
          Paper (eprint) &rarr;
        </a>
      </div>
      <PaperDisclaimer eprintUrl={EPRINT_URL} />
      <p class="mt-1 text-xs text-gray-600">
        Converted with: {CRAWLER} &middot; {CONVERTED_DATE}
      </p>
    </header>

    <nav id="toc" class="mb-10 p-6 rounded-lg" style="background: rgba(255,255,255,0.03); border: 1px solid rgba(255,255,255,0.06);">
      <h2 class="text-lg font-bold mb-4">Table of Contents</h2>
      <ol class="space-y-1 text-sm text-gray-300
        list-decimal list-inside">
        <li><a href="#abstract" class="hover:text-white">Abstract</a></li>
        <li>
          <a href="#sec-1" class="hover:text-white">Introduction</a>
          <ol class="ml-6 mt-1 space-y-1 list-decimal
            list-inside text-gray-400">
            <li><a href="#sec-1.1" class="hover:text-white">Implications of eclipse attacks</a></li>
          </ol>
        </li>
        <li>
          <a href="#sec-2" class="hover:text-white">Bitcoin&#x27;s Peer-to-Peer Network</a>
          <ol class="ml-6 mt-1 space-y-1 list-decimal
            list-inside text-gray-400">
            <li><a href="#sec-2.1" class="hover:text-white">Propagating network information</a></li>
            <li><a href="#sec-2.2" class="hover:text-white">Storing network information</a></li>
            <li><a href="#sec-2.3" class="hover:text-white">Selecting peers</a></li>
          </ol>
        </li>
        <li>
          <a href="#sec-3" class="hover:text-white">The Eclipse Attack</a>
          <ol class="ml-6 mt-1 space-y-1 list-decimal
            list-inside text-gray-400">
            <li><a href="#sec-3.1" class="hover:text-white">Populating tried and new</a></li>
            <li><a href="#sec-3.2" class="hover:text-white">Restarting the victim</a></li>
            <li><a href="#sec-3.3" class="hover:text-white">Selecting outgoing connections</a></li>
            <li><a href="#sec-3.4" class="hover:text-white">Monopolizing the eclipsed victim</a></li>
          </ol>
        </li>
        <li>
          <a href="#sec-4" class="hover:text-white">How Many Attack Addresses?</a>
          <ol class="ml-6 mt-1 space-y-1 list-decimal
            list-inside text-gray-400">
            <li><a href="#sec-4.1" class="hover:text-white">Botnet attack</a></li>
            <li><a href="#sec-4.1.1" class="hover:text-white">Who can launch a botnet attack?</a></li>
            <li><a href="#sec-4.2" class="hover:text-white">Infrastructure attack</a></li>
            <li><a href="#sec-4.2.1" class="hover:text-white">Who can launch an infrastructure attack?</a></li>
            <li><a href="#sec-4.3" class="hover:text-white">Summary: infrastructure or botnet?</a></li>
          </ol>
        </li>
        <li><a href="#sec-5" class="hover:text-white">Measuring Live Bitcoin Nodes</a></li>
        <li><a href="#sec-6" class="hover:text-white">Experiments</a></li>
        <li><a href="#sec-7" class="hover:text-white">Countermeasures</a></li>
        <li><a href="#sec-8" class="hover:text-white">Related Work</a></li>
        <li><a href="#sec-9" class="hover:text-white">Conclusion</a></li>
      </ol>
      <p class="text-xs text-gray-500 mt-4 mb-1 font-semibold">
        Appendices
      </p>
      <ol class="space-y-1 text-sm text-gray-400
        list-[upper-alpha] list-inside">
        <li>
          <a href="#app-a" class="hover:text-white">Useful Lemma</a>
          <ol class="ml-6 mt-1 space-y-1 list-decimal
            list-inside text-gray-400">
            <li><a href="#app-b.1" class="hover:text-white">Infrastructure strategy</a></li>
            <li><a href="#app-b.2" class="hover:text-white">Botnet strategy</a></li>
          </ol>
        </li>
        <li><a href="#app-c" class="hover:text-white">Infrastructure Attack on Tried Table</a></li>
      </ol>
      <p class="text-xs text-gray-500 mt-4 mb-1 font-semibold">
        Additional
      </p>
      <ul class="space-y-1 text-sm text-gray-400
        list-disc list-inside">
        <li><a href="#acknowledgements" class="hover:text-white">Acknowledgements</a></li>
        <li><a href="#references" class="hover:text-white">References</a></li>
      </ul>
    </nav>


    <Fragment set:html={CONTENT} />

    <PaperHistory slug="eclipse-attacks-on-bitcoin-s-peer-to-peer-network-2015" />
  </article>
</BaseLayout>
