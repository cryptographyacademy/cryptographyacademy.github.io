---
import BaseLayout from '../../layouts/BaseLayout.astro';
import PaperDisclaimer from '../../components/PaperDisclaimer.astro';
import PaperHistory from '../../components/PaperHistory.astro';

const EPRINT_URL = 'https://eprint.iacr.org/2019/951';
const CRAWLER = 'marker';
const CONVERTED_DATE = '2026-02-16';
const TITLE_HTML = 'Collisions on Feistel-MiMC and univariate GMiMC';
const AUTHORS_HTML = 'Xavier Bonnetain';

const CONTENT = `    <section id="abstract" class="mb-10">
      <h2 class="text-2xl font-bold">Abstract</h2>
      <p class="text-gray-300">MiMC and GMiMC are families of MPC-friendly block ciphers and hash functions. In this note, we show that the block ciphers MiMC-$2n/n$ (or Feistel-MiMC) and univariate GMiMC are vulnerable to an attack which allows
a key recovery in $2^{n/2}$ operations. This attack, which is reminiscent of a slide attack, only relies on their weak key schedules, and is independent of the round function ($x^3$ here) and the number of rounds.</p>
      <p class="text-gray-300"><strong>Keywords:</strong> MiMC &middot; MPC &middot; symmetric cryptanalysis</p>
    </section>

    <section id="sec-2" class="mb-10">
      <h2 class="text-2xl font-bold">2 Attacks</h2>

      <h3 id="sec-2.1" class="text-xl font-semibold mt-8">2.1 Attack on MiMC-2n/n</h3>

    <p class="text-gray-300">The attack relies on an invariant property of the round function, and can be seen as a slight generalization of a slide attack presented in [BNPS19]. The invariant property is described in Figure 2.</p>

    <p class="text-gray-300">    <img src="_page_1_Picture_12.jpeg" alt="" class="my-4 max-w-full" />
</p>

    <p class="text-gray-300">Figure 2: Illustration of Lemma 1</p>

    <p class="text-gray-300"><strong>Lemma 1.</strong> Let  <span class="math">R_k^i</span>  be the round function of MiMC-2n/n with the key k for round i. Then for all x, y, k, i,  <span class="math">R_k^i(x, y) \\oplus (k, k) = R_0^i(x \\oplus k, y \\oplus k)</span></p>

    <p class="text-gray-300">Proof.
<span class="math">$R_0^i(x \\oplus k, y \\oplus k) = (y \\oplus k \\oplus (x \\oplus k \\oplus c_i)^3, x \\oplus k) = (y \\oplus (x \\oplus k \\oplus c_i)^3, x) \\oplus (k, k) = R_k^i(x, y) \\oplus (k, k)</span>$</p>

    <p class="text-gray-300"><strong>Theorem 1.</strong> Let  <span class="math">E_k</span>  be MiMC-2n/n with the key k. Then, for all x, y, k,  <span class="math">E_k(x, y) \\oplus (k, k) = E_0(x \\oplus k, y \\oplus k)</span> .</p>

    <p class="text-gray-300"><em>Proof.</em> By induction over the number of rounds. The base case is Lemma 1. If the property holds after i-1 rounds, then</p>

    <p class="text-gray-300"><span class="math">$(R_k^{i-1} \\circ R_k^{i-2} \\cdots \\circ R_k^1)(x,y) \\oplus (k,k) = (R_0^{i-1} \\circ R_0^{i-2} \\cdots \\circ R_0^1)(x \\oplus k, y \\oplus k).</span>$</p>

    <p class="text-gray-300">Xavier Bonnetain 3</p>

    <p class="text-gray-300">By <a href="#page-1-1">Lemma 1,</a></p>

    <p class="text-gray-300"><span class="math">$\\begin{split} &amp;(R_0^i \\circ R_0^{i-1} \\cdots \\circ R_0^1)(x \\oplus k, y \\oplus k) = R_0^i((R_0^{i-1} \\circ R_0^{i-2} \\cdots \\circ R_0^1)(x \\oplus k, y \\oplus k)) \\\\ = &amp;R_0^i((R_k^{i-1} \\circ R_k^{i-2} \\cdots \\circ R_k^1)(x, y) \\oplus (k, k)) = (R_k^i \\circ R_k^{i-1} \\cdots \\circ R_k^1)(x, y) \\oplus (k, k) \\end{split}</span>$</p>

    <p class="text-gray-300"><strong>Corollary 1.</strong> <em>Let E<sup>k</sup> be MiMC-</em>2<em>n/n with the key k. Let f</em>(<em>x</em>) = <em>Ek</em>(<em>x, x</em>) &oplus; (<em>x, x</em>) <em>and g</em>(<em>x</em>) = <em>E</em>0(<em>x, x</em>) &oplus; (<em>x, x</em>)<em>. Then f</em>(<em>x</em>) = <em>g</em>(<em>x</em> &oplus; <em>k</em>)<em>.</em></p>

    <p class="text-gray-300"><em>Proof.</em></p>

    <p class="text-gray-300"><span class="math">$g(x \\oplus k) = E_0(x \\oplus k, x \\oplus k) \\oplus (x \\oplus k, x \\oplus k) = E_k(x, x) \\oplus (k, k) \\oplus (x \\oplus k, x \\oplus k)</span>$
<span class="math">$= E_k(x, x) \\oplus (x, x) = f(x)</span>$</p>

    <p class="text-gray-300"><strong>Key recovery.</strong> The key recovery simply consists in looking for a collision between <em>f</em> and <em>g</em> from <a href="#page-2-0">Corollary 1,</a> which can be done in time 2 <em>n/</em><sup>2</sup> as the two functions have an <em>n</em>-bit input. This contradicts the claim of <em>n</em> bits of security of MiMC-2<em>n/n</em>.</p>

    <p class="text-gray-300"><strong>Hash function.</strong> MiMC can be used keyless as a permutation for a sponge-based hash function. As there is no key in this construction, it is unclear how <a href="#page-1-2">Theorem 1</a> could be used to attack the hash function.</p>

      <h3 id="sec-2.2" class="text-xl font-semibold mt-8"><strong>2.2 Attacks on GMiMC</strong></h3>

    <p class="text-gray-300">In most cases ,the same property can be found in univariate GMiMC, that is, <em>Ek</em>(<em>x</em>1<em>, . . . , xt</em>)&oplus; (<em>k, . . . , k</em>) = <em>E</em>0(<em>x</em><sup>1</sup> &oplus; <em>k, . . . , x<sup>t</sup></em> &oplus; <em>k</em>), which allows to apply the same attack as in the MiMC-2<em>n/n</em> case.</p>

    <p class="text-gray-300"><strong>GMiMC-Nyb and GMiMC-mrf.</strong> One round of GMiMC-Nyb and GMiMC-mrf can be seen, up to a permutation of the branches, as <em>t</em> Feistel in parallel. Hence, the property holds.</p>

    <p class="text-gray-300"><strong>GMiMC-erf.</strong> The added function only depends on one input branch, hence the property also holds.</p>

    <p class="text-gray-300"><strong>GMiMC-crf.</strong> The function is slightly different in that case, as it depends on more than one branch. For the property to hold, we must have that</p>

    <p class="text-gray-300"><span class="math">$\\left(\\left(\\bigoplus_{j=2}^t x_j\\right) \\oplus k \\oplus c_i\\right)^3 = \\left(\\bigoplus_{j=2}^t (x_j \\oplus k) \\oplus c_i\\right)^3.</span>$</p>

    <p class="text-gray-300">Hence, the property holds only if <em>t</em> is even.</p>

      <h3 id="sec-2.3" class="text-xl font-semibold mt-8"><strong>2.3 Variants in large characteristics</strong></h3>

    <p class="text-gray-300">MiMC and GMiMC can also be defined over a finite field of large characteristic. In that case, the property we have is <em>Ek</em>(<em>x</em>1<em>, . . . , xt</em>) + (<em>k, . . . , k</em>) = <em>E</em>0(<em>x</em><sup>1</sup> + <em>k, . . . , x<sup>t</sup></em> + <em>k</em>), and the same attack can be applied. The only exception is GMiMC-crf, where we need to have <em>k</em> + <em>k</em> = 0 for the property to hold.</p>

      <h3 id="sec-2.4" class="text-xl font-semibold mt-8"><strong>2.4 Quantum attacks</strong></h3>

    <p class="text-gray-300">The collision property corresponds to a hidden period, and as such, permits a key recovery in O(<em>n</em>) quantum queries. With a restriction to classical queries, these attacks happens to be in a form suitable for the offline Simon's algorithm <a href="#page-3-3">[Bon+19]</a>, which allows to make a key recovery in O(2<em>n/</em><sup>3</sup> ) classical queries and quantum time.</p>

    </section>

    <section id="sec-3" class="mb-10">
      <h2 class="text-2xl font-bold"><strong>3 Conclusion</strong></h2>

    <p class="text-gray-300">We have shown that MiMC-2<em>n/n</em> and all the versions of univariate GMiMC except some instances of GMiMC-crf are vulnerable to a collision attack. More generally, this demonstrates that using round constants is not enough for a key schedule to secure a Feistel or generalized Feistel construction.</p>

    <p class="text-gray-300">This attack does not appear to be applicable to the other MiMC construction, MiMC<em>n/n</em>, nor to the hash functions based on any version of MiMC or GMiMC.</p>

    <p class="text-gray-300"><strong>Acknowledgements.</strong> The author would like to thank Chaoyun Li for his presentation of MiMC and for suggesting to apply the attack to GMiMC. The author would also like to thank the authors of MiMC and GMiMC for their comments and discussions on this result. This project has received funding from the European Research Council (ERC) under the European Union's Horizon 2020 research and innovation programme (grant agreement no. 714294 - acronym QUASYModo).</p>

    <ul class="list-disc list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li>[Alb+16] Martin R. Albrecht et al. &quot;MiMC: Efficient Encryption and Cryptographic Hashing with Minimal Multiplicative Complexity&quot;. In: <em>ASIACRYPT 2016, Part I</em>. Ed. by Jung Hee Cheon and Tsuyoshi Takagi. Vol. 10031. LNCS. Springer, Heidelberg, Dec. 2016, pp. 191&ndash;219. doi: <a href="http://dx.doi.org/10.1007/978-3-662-53887-6_7" target="_blank" rel="noopener noreferrer">10.1007/978- 3- 662-</a> <a href="http://dx.doi.org/10.1007/978-3-662-53887-6_7" target="_blank" rel="noopener noreferrer">53887-6\\_7</a>.</li>
      <li>[Alb+19] Martin R. Albrecht et al. &quot;Feistel Structures for MPC, and More&quot;. In: <em>ESORICS 2019</em>. 2019.</li>
      <li>[BNPS19] Xavier Bonnetain, Mar&iacute;a Naya-Plasencia, and Andr&eacute; Schrottenloher. &quot;On Quantum Slide Attacks&quot;. In: <em>SAC 2019</em>. Ed. by Kenneth G. Paterson and Douglas Stebila: LNCS. Springer, Heidelberg, Aug. 2019.</li>
      <li>[Bon+19] Xavier Bonnetain et al. &quot;Quantum Attacks without Superposition Queries: the Offline Simon Algorithm&quot;. In: <em>ASIACRYPT 2019</em>. Ed. by Steven Galbraith and Shiho Moriai. LNCS. Springer, Heidelberg, Dec. 2019. url: <a href="https://eprint.iacr.org/2019/614" target="_blank" rel="noopener noreferrer">https://</a> <a href="https://eprint.iacr.org/2019/614" target="_blank" rel="noopener noreferrer">eprint.iacr.org/2019/614</a>.</li>
    </ul>

    </section>
`;
---

<BaseLayout title="Collisions on Feistel-MiMC and univariate GMiMC (2019/951)">
  <article class="max-w-4xl mx-auto article-prose">
    <nav class="mb-8">
      <a href="/papers" class="text-blue-400 hover:text-blue-300">
        &larr; Back to Papers
      </a>
    </nav>

    <header class="mb-12">
      <h1 class="text-3xl font-bold mb-4"
        set:html={TITLE_HTML} />
      <p class="text-gray-400 mb-2"
        set:html={AUTHORS_HTML} />
      <p class="text-gray-500 text-sm mb-4">
        2019 &middot; eprint 2019/951
      </p>
      <div class="flex gap-4 text-sm">
        <a
          href={EPRINT_URL}
          target="_blank"
          rel="noopener noreferrer"
          class="text-blue-400 hover:text-blue-300"
        >
          Paper (eprint) &rarr;
        </a>
      </div>
      <PaperDisclaimer eprintUrl={EPRINT_URL} />
      <p class="mt-1 text-xs text-gray-600">
        Converted with: {CRAWLER} &middot; {CONVERTED_DATE}
      </p>
    </header>

    <nav id="toc" class="mb-10 p-6 rounded-lg" style="background: rgba(255,255,255,0.03); border: 1px solid rgba(255,255,255,0.06);">
      <h2 class="text-lg font-bold mb-4">Table of Contents</h2>
      <ol class="space-y-1 text-sm text-gray-300
        list-decimal list-inside">
        <li>
          <a href="#sec-1" class="hover:text-white">Description of the ciphers</a>
          <ol class="ml-6 mt-1 space-y-1 list-decimal
            list-inside text-gray-400">
            <li><a href="#sec-1.1" class="hover:text-white">MiMC-2n/n</a></li>
            <li><a href="#sec-1.2" class="hover:text-white">GMiMC</a></li>
          </ol>
        </li>
        <li>
          <a href="#sec-2" class="hover:text-white">Attacks</a>
          <ol class="ml-6 mt-1 space-y-1 list-decimal
            list-inside text-gray-400">
            <li><a href="#sec-2.1" class="hover:text-white">Attack on MiMC-2n/n</a></li>
            <li><a href="#sec-2.2" class="hover:text-white">Attacks on GMiMC</a></li>
            <li><a href="#sec-2.3" class="hover:text-white">Variants in large characteristics</a></li>
            <li><a href="#sec-2.4" class="hover:text-white">Quantum attacks</a></li>
          </ol>
        </li>
        <li><a href="#sec-3" class="hover:text-white">Conclusion</a></li>
      </ol>
      <p class="text-xs text-gray-500 mt-4 mb-1 font-semibold">
        Additional
      </p>
      <ul class="space-y-1 text-sm text-gray-400
        list-disc list-inside">
        <li><a href="#references" class="hover:text-white">References</a></li>
      </ul>
    </nav>


    <Fragment set:html={CONTENT} />

    <PaperHistory slug="collisions-on-feistel-mimc-and-univariate-gmimc-2019" />
  </article>
</BaseLayout>
