---
import BaseLayout from '../../layouts/BaseLayout.astro';
import PaperDisclaimer from '../../components/PaperDisclaimer.astro';
import PaperHistory from '../../components/PaperHistory.astro';

const EPRINT_URL = 'https://eprint.iacr.org/2018/182';
const CRAWLER = 'marker';
const CONVERTED_DATE = '2026-02-16';
const TITLE_HTML = 'Truncated Differential Properties of the Diagonal Set of Inputs for 5-round AES';
const AUTHORS_HTML = 'Lorenzo Grassi, Christian Rechberger';

const CONTENT = `    <section id="abstract" class="mb-10">
      <h2 class="text-2xl font-bold">Abstract</h2>
      <p class="text-gray-300">In the last couple of years, a new wave of results appeared, proposing and exploiting new properties of round-reduced AES.
In this paper we survey and combine some of  these results (namely, the multiple-of-n property and the mixture differential cryptanalysis) in a systematic way in order to answer more general questions regarding the probability distribution of encrypted diagonal sets.
This allows to analyze this special set of inputs, and report on new properties regarding the probability distribution of the number of different pairs of corresponding ciphertexts are equal in certain anti-diagonal(s) after 5 rounds.

An immediate corollary of the multiple-of-8 property is that the variance of such a distribution can be shown to be higher
than for a random permutation. Surprisingly, also the mean of the distribution is significantly different from
random, something which cannot be explained by the multiple-of-8 property.
We propose a theoretical explanation of this, by assuming an APN-like assumption on the S-Box which closely resembles the AES-Sbox.
By combining the multiple-of-8 property, the mixture differential approach, and the results just mentioned about the mean and the variance, we are finally able to  formulate the probability distribution of the diagonal set after 5-round AES as a sum of independent binomial distributions.</p>
      <p class="text-gray-300"><strong>Keywords:</strong> AES &middot; Truncated-Differential Cryptanalysis &middot; Distinguisher &middot; Attack</p>
    </section>

    <section id="sec-1" class="mb-10">
      <h2 class="text-2xl font-bold">1 Introduction</h2>

    <p class="text-gray-300">AES (Advanced Encryption Standard) [16] is probably the most used and studied block cipher. Since the development of cryptanalysis of AES and AES-like constructions in the late 1990s, the set of input which differ only in one diagonal has special importance. Indeed, it appears in several attacks and distinguishers, including various (truncated) differential [24, 23], integral [14], and impossible differential attacks [6], among others. In particular, given a diagonal set of plaintexts and the corresponding ciphertexts after 4 rounds, it is well known that the XOR-sum of the ciphertexts is equal to zero [14], or that each pair of ciphertexts</p>

    <p class="text-gray-300">Table 1. Expected properties of a diagonal set after 5-round encryption. Given a set of  <span class="math">2^{32}</span>  chosen plaintexts all equal in three diagonals (that is, a diagonal set), we consider the distribution of the number of different pairs of ciphertexts that are equal in one anti-diagonal (equivalently, that lie in a particular subspace  <span class="math">\\mathcal{ID}_I</span>  for  <span class="math">I \\subseteq \\{0, 1, 2, 3\\}</span>  fixed with |I| = 3). Expected values for mean and variance of these distributions are given in this table for 5-round AES and for a random permutation. Practical results on AES are close and are discussed in Sect. 7.2.</p>

    <div class="overflow-x-auto my-4">
      <table class="min-w-full text-sm text-gray-300">
        <thead>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"></th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">Random Permutation</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">5-round AES</th>
        </thead>
        <tbody>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Mean <sup>&#8902;</sup> (Theorem 4)</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">2147483647.5\\approx 2^{31}</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">2147484685.6 \\approx 2^{31} + 2^{10}</span></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Variance (Theorem 4)</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">2147483647\\approx 2^{31}</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">76842293834.905 \\approx 2^{36.161}</span></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Multiple-of-8 [21]</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">&#10003;</td>
          </tr>
        </tbody>
      </table>
    </div>

    <p class="text-gray-300"><span class="math">&lt;sup&gt;^{\\&lt;/sup&gt;star}</span>  = assuming an &quot;APN-like&quot; S-Box (for the 5-round AES case)</p>

    <p class="text-gray-300">cannot be equal in any of the four anti-diagonals, as shown by Biham and Keller in [7].</p>

    <p class="text-gray-300">While a lot is known about the encryption of a diagonal set of plaintexts &ndash; that is, a set of plaintexts with one (or more) active diagonal(s) &ndash; for up to 4-round AES, an analysis for 5 or more rounds AES is still missing. At Eurocrypt 2017, a new property which is independent of the secret key has been found for 5-round AES [21]. By appropriate choices of a number of input pairs, it is possible to make sure that the number of times that the difference of the resulting output pairs lie in a particular subspace  <span class="math">\\mathcal{ID}</span>  is always a multiple of 8. Such a distinguisher has then been exploited in, e.g., [4,19] for setting up new competitive distinguishers and key-recovery attacks on round-reduced AES.</p>

    <p class="text-gray-300">At the same time, some open questions arise from the result provided in [21]: does this property influence the average number of output pairs that lie in such a particular subspace (i.e., the mean)? Are other parameters (including the variance and the skewness) affected by the multiple-of-8 property?</p>

    <p class="text-gray-300">In this paper, given a diagonal set of plaintexts, we consider the probability distribution of the corresponding number of pairs of ciphertexts that are equal in one fixed anti-diagonal after 5-round AES (without the final MixColumns operation) &ndash; equivalently, that belong to the same coset of a particular subspace  <span class="math">\\mathcal{ID}</span>  &ndash; denoted in the following as the &quot;(average) number of collisions&quot;.</p>

      <h3 id="sec-1.1" class="text-xl font-semibold mt-8">1.1 Contributions</h3>

    <p class="text-gray-300">As the main contribution, we perform for the first time a differential analysis of such distribution after 5-round AES, and find significant deviations from random, supported by practical implementations and verification. For a theoretical explanation we have to resort to an APN-like assumption on the S-Box, which closely resembles the AES-Sbox. A numerical summary is given in Table 1. All the results presented in this paper are independent of the secret-key.</p>

    <p class="text-gray-300"><strong>Mean of 5-round AES.</strong> Firstly, by an appropriate choice of  <span class="math">2^{32}</span>  plaintexts in a diagonal space  <span class="math">\\mathcal{D}</span> , we prove for the first time that the average number of times</p>

    <p class="text-gray-300">that the resulting output pairs are equal in one fixed anti-diagonal (equivalently, the average number of times that the difference of the resulting output pairs lie in a particular subspace  <span class="math">\\mathcal{ID}</span> ) is (a little) bigger for 5-round AES than for a random permutation, independently of the secret key. A complete proof of this result &ndash; under an &quot;APN-like&quot; assumption on the S-Box which closely resembles the AES S-Box &ndash; can be found in Sect. 6.</p>

    <p class="text-gray-300">Variance of 5-round AES. Secondly, we theoretically compute the variance of the probability distribution just defined, and we show that it is higher (by a factor of approximately 36) for 5-round AES than for a random permutation. As we are going to show, this result is mainly due to the &quot;multiple-of-8&quot; result [21] proposed at Eurocrypt 2017. For this reason, with respect to the mean value, the variance is independent of the details of the S-Box.</p>

    <p class="text-gray-300">Practical Verification &amp; Influence of the S-Box Details on the Mean. We practically verified the mean on small-scale 5-round AES (namely, AES defined over  <span class="math">\\mathbb{F}_{2^4}^{4\\times 4}</span>  as proposed in [13]), and the variance both for small-scale and real 5-round AES. As discussed in Sect. 7, practical results are close to the theoretical ones in both cases. Before going on, we mention that the theoretical and the practical results regarding the mean (almost) match if the the S-Box satisfies an &quot;APN-like&quot; assumption on the S-Box which closely resembles the AES S-Box, namely, if the solutions of the equality S-Box <span class="math">(\\cdot \\oplus \\Delta_I) \\oplus S</span> -Box <span class="math">(\\cdot) = \\Delta_O</span>  are uniformly distributed for each non-zero input/output differences  <span class="math">\\Delta_I, \\Delta_O \\neq 0</span> . In the case in which this assumption &ndash; also used in other related works as [3,5] &ndash; is not satisfied, then a gap between the theoretical and the practical results can</p>

    <p class="text-gray-300">occur, as showed and discussed in details in App. C.</p>

    <p class="text-gray-300"><strong>Probability Distribution of 5-round AES.</strong> By combining the multiple-of-8 property presented in [21], the mixture differential cryptanalysis [19, 20] and the results just mentioned about the mean and the variance, in Sect. 3 we show the following: given a diagonal space of  <span class="math">2^{32}</span>  plaintexts with one active diagonal, the probability distribution of the number of different pairs of ciphertexts which are equal in one fixed anti-diagonal after 5-round AES (without the final MixColumns operation) with respect to (1st) all possible secret keys and (2nd) all possible initial diagonal spaces is well described by a sum of independent binomial distributions  <span class="math">\\mathfrak{B}(n,p)</span> , that is</p>

    <p class="text-gray-300"><span class="math">$2^3 \\times \\mathfrak{B}(n_3, p_3) + 2^{10} \\times \\mathfrak{B}(n_{10}, p_{10}) + 2^{17} \\times \\mathfrak{B}(n_{17}, p_{17})</span>$</p>

    <p class="text-gray-300">where the values of  <span class="math">n_3</span> ,  <span class="math">n_{10}</span> ,  <span class="math">n_{17}</span>  and  <span class="math">p_3</span> ,  <span class="math">p_{10}</span> ,  <span class="math">p_{17}</span>  are provided in the following.</p>

      <h3 id="sec-1.2" class="text-xl font-semibold mt-8">1.2 Follow-Up Works: Truncated Differentials for 5-/6-round AES</h3>

    <p class="text-gray-300">Before going on, we recall the other results concerning truncated differentials for 5- or 6-round AES present in the literature.</p>

    <p class="text-gray-300">In [3], Bao, Guo and List presented &quot;extended expectation cryptanalysis&quot; (or &quot;extended truncated differential&quot;) on round-reduced AES. By making use</p>

    <p class="text-gray-300">of expectation-based distinguishers, they are able to show how to extend the well-known 3-round integral distinguisher to truncated differential secret-key distinguishers over 4, 5 and even 6 rounds. The technique exploited to derive such a result is based on results by Patarin [27], who observed that the expected (average) number of collisions differs slightly for a sum of permutations from the ideal. At the same time, authors showed that their results (namely, the expectation distinguishers over 4-, 5- and 6-round AES proposed in the main part of [3]) can be derived exploiting the same technique/strategy that we are going to propose in this paper in Sect. 6, as showed in details in [3, App. C].</p>

    <p class="text-gray-300">Later on, in [5] Bardeh and R&oslash;njom developed another technique in order to set an equivalent truncated differential distinguishers for up to 6-round AES. Such technique &ndash; called the &quot;exchange equivalence attack&quot; &ndash; resembles the yoyo technique [28] and the mixture differential cryptanalaysis [19], and it allows to give a precise estimation of the average number of pairs of ciphertexts that are equal in fixed anti-diagonal(s), given a particular set of chosen plaintexts. The corresponding secret-key distinguisher on 6-round AES has complexity of about 2 88.2 computations and chosen texts.</p>

    <p class="text-gray-300">Remark. Before going on, we remark that all these results are valid only under the &quot;APN&quot; assumption of the S-Box previously mentioned. Namely, both our and the theoretical results proposed in [3, 5] regarding the average number of collisions after 5 or more rounds of AES hold only in the case in which the solutions of the equality S-Box(&middot;&oplus;&#8710;<sup>I</sup> )&oplus;S-Box(&middot;) = &#8710;<sup>O</sup> are uniformly distributed for each non-zero input/output differences &#8710;<sup>I</sup> , &#8710;<sup>O</sup> 6= 0, an assumption that is (almost) satisfied by the AES S-Box. More details about this are provided in the following.</p>

    </section>

    <section id="sec-2" class="mb-10">
      <h2 class="text-2xl font-bold">2 Preliminary</h2>

      <h3 id="sec-2.1" class="text-xl font-semibold mt-8">2.1 Advanced Encryption Standard (AES)</h3>

    <p class="text-gray-300">AES [16] is a Substitution-Permutation network based on the &quot;Wide Trail Design&quot; strategy [17], that supports key size of 128, 192 and 256 bits. The 128-bit plaintext initializes the internal state as a 4 &times; 4 matrix of bytes as values in the finite field F<sup>2</sup> <sup>8</sup> . Depending on the version of AES, N<sup>r</sup> rounds are applied to the state: N<sup>r</sup> = 10 for AES-128, N<sup>r</sup> = 12 for AES-192 and N<sup>r</sup> = 14 for AES-256. An AES round applies four operations to the state matrix:</p>

    <ul class="list-disc list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li>SubBytes (S-Box) applying the same 8-bit to 8-bit invertible S-Box 16 times in parallel on each byte of the state (provides non-linearity in the cipher);</li>
      <li>ShiftRows (SR) cyclic shift of each row to the left;</li>
      <li>MixColumns (MC) multiplication of each column by a constant 4 &times; 4 invertible matrix (MC and SR provide diffusion in the cipher);</li>
      <li>AddRoundKey (ARK) XORing the state with a 128-bit subkey k.</li>
    </ul>

    <p class="text-gray-300">One round of AES can be described as R(x) = k &oplus; MC &#9702; SR &#9702; S-Box(x). In the first round an additional AddRoundKey operation (using a whitening key) is applied, and in the last round the MixColumns operation is omitted.</p>

    <p class="text-gray-300">Notation Used in the Paper. Let x denote a plaintext, a ciphertext, an intermediate state or a key. Then,  <span class="math">x_{i,j}</span>  with  <span class="math">i,j \\in \\{0,\\ldots,3\\}</span>  denotes the byte in the row i and in the column j. We denote by R one round of AES (and  <span class="math">R_f</span>  if the Mix-Columns operation is omitted), while we denote r rounds of AES by  <span class="math">R^r</span>  (where we use the notation  <span class="math">R_f^r</span>  in the case in which the last MixColumns operation is omitted). We also define the diagonal and the anti-diagonal of a text as follows. The i-th diagonal of a  <span class="math">4 \\times 4</span>  matrix A is defined as the elements that lie on row r and column c such that  <span class="math">r - c \\equiv_4 i</span> . The i-th anti-diagonal of a  <span class="math">4 \\times 4</span>  matrix A is defined as the elements that lie on row r and column c such that  <span class="math">r + c \\equiv_4 i</span> .</p>

      <h3 id="sec-2.2" class="text-xl font-semibold mt-8">2.2 Properties of an S-Box</h3>

    <p class="text-gray-300">Given a bijective S-Box function on  <span class="math">\\mathbb{F}_{2^n}</span> , let  <span class="math">\\Delta_I, \\Delta_O \\in \\mathbb{F}_{2^n}</span> . Let  <span class="math">N_{\\Delta_I, \\Delta_O}</span>  denotes the number of solutions of the equation</p>

    <p class="text-gray-300"><span class="math">$S-Box(x \\oplus \\Delta_I) \\oplus S-Box(x) = \\Delta_O</span>$
(1)</p>

    <p class="text-gray-300">for each  <span class="math">\\Delta_I \\neq 0</span>  and  <span class="math">\\Delta_O \\neq 0</span> . Obviously, (i) x is a solution if and only if  <span class="math">x \\oplus \\Delta_I</span>  is a solution, and (ii) if  <span class="math">\\Delta_O = 0</span> , then any  <span class="math">x \\in \\mathbb{F}_{2^n}</span>  is a solution if and only if  <span class="math">\\Delta_I = 0</span>  (the S-Box is bijective).</p>

    <p class="text-gray-300">Let's analyze the probability distribution related to  <span class="math">N_{\\Delta_I,\\Delta_O}</span> .</p>

    <p class="text-gray-300"><strong>Mean Value.</strong> Independently of the details of the S-Box, the mean value (or the average value) of  <span class="math">N_{\\Delta_I,\\Delta_O}</span>  is equal to  <span class="math">\\mathbb{E}[N_{\\Delta_I,\\Delta_O}] = \\frac{2^n}{2^n-1}</span> . Indeed, observe that for each x and for each  <span class="math">\\Delta_I \\neq 0</span>  there exists  <span class="math">\\Delta_O \\neq 0</span>  (since S-Box is bijective) that satisfies Eq. (1). Thus, the average number of solutions is  <span class="math">\\frac{2^n \\cdot (2^n-1)}{(2^n-1)^2} = \\frac{2^n}{(2^n-1)}</span>  independently of the details of the (bijective) S-Box.</p>

    <p class="text-gray-300">Variance. The variance  <span class="math">\\operatorname{Var}(N_{\\Delta_I,\\Delta_O})</span>  depends on the details of the S-Box. For the AES S-Box case, for each  <span class="math">\\Delta_I \\neq 0</span>  there are 128 values of  <span class="math">\\Delta_O \\neq 0</span>  for which Eq. (1) has no solution, 126 values of  <span class="math">\\Delta_O \\neq 0</span>  for which Eq. (1) has 2 solutions ( <span class="math">\\hat{x}</span>  is a solution if and only if  <span class="math">\\hat{x} \\oplus \\Delta_I</span>  is a solution) and finally 1 value of  <span class="math">\\Delta_O \\neq 0</span>  for which Eq. (1) has 4 solutions. The variance for the AES S-Box is so equal to  <span class="math">\\operatorname{Var}_{AES}(N_{\\Delta_I,\\Delta_O}) = 2^2 \\cdot \\frac{126}{255} + 4^2 \\cdot \\frac{1}{255} - \\left(\\frac{256}{255}\\right)^2 = \\frac{67064}{65025}</span> .</p>

    <p class="text-gray-300">Maximum Differential Probability. The Maximum Differential Probability  <span class="math">DP_{max}</span>  of an S-Box is defined as</p>

    <p class="text-gray-300"><span class="math">$DP_{\\max} = 2^{-n} \\cdot \\max_{\\Delta_I \\neq 0, \\Delta_O} N_{\\Delta_I, \\Delta_O}. \\tag{2}</span>$</p>

    <p class="text-gray-300">Since  <span class="math">\\max_{\\Delta_I \\neq 0, \\Delta_O} N_{\\Delta_I, \\Delta_O} \\geq 2</span> ,  <span class="math">\\mathtt{DP_{max}}</span>  is always bigger than or equal to  <span class="math">2^{-n+1}</span> . Permutations with  <span class="math">\\mathtt{DP_{max}} = 2^{-n+1}</span>  are called Almost Perfect Nonlinear (APN).</p>

    <p class="text-gray-300">&quot;Homogeneous&quot; S-Box. Finally, given  <span class="math">\\Delta_I \\neq 0</span>  (respectively,  <span class="math">\\Delta_O \\neq 0</span> ), consider the probability distribution of  <span class="math">N_{\\Delta_I,\\Delta_O}</span>  with respect to  <span class="math">\\Delta_O \\neq 0</span>  (respectively,  <span class="math">\\Delta_I \\neq 0</span> ): we say that the S-Box is (differential) &quot;homogeneous&quot; if such distribution is independent of  <span class="math">\\Delta_I</span>  (respectively,  <span class="math">\\Delta_O</span> ). Some examples include:</p>

    <ul class="list-disc list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li>the AES S-Box, which is differential &quot;homogeneous&quot;, since for each  <span class="math">\\Delta_I \\neq 0</span> (fixed),  <span class="math">\\Pr(N_{\\Delta_I,\\Delta_O}=2)=\\frac{126}{255}</span>  and  <span class="math">\\Pr(N_{\\Delta_I,\\Delta_O}=4)=\\frac{1}{255}</span> ; the PRINCE S-Box, which is <em>not</em> differential &quot;homogeneous&quot;, since e.g. the</li>
      <li>probability  <span class="math">\\Pr(N_{\\Delta_I,\\Delta_O}=4)</span>  depends on the value of  <span class="math">\\Delta_I\\neq 0.1</span></li>
    </ul>

    <h4 id="sec-misc-1" class="text-lg font-semibold mt-6">Probability Distribution for 5-round AES 3</h4>

    <p class="text-gray-300">In this section, we first recall some results already published in the literature about round-reduced AES. Then, given a diagonal space of 2<sup>32</sup> plaintexts with one active diagonal, we present the probability distribution of the number of different pairs of ciphertexts which are equal in one fixed anti-diagonal after 5-round AES (without the final MixColumns operation).</p>

      <h3 id="sec-3.1" class="text-xl font-semibold mt-8">3.1 Truncated Differentials for 2-round AES</h3>

    <p class="text-gray-300">Here we recall the truncated differential for 2-round AES using the subspace trail notation introduced in [22]&mdash;see also App. A for more details. In the following, we only work with vectors and vector spaces over  <span class="math">\\mathbb{F}_{2^n}^{4\\times 4}</span> , and we denote by  <span class="math">\\{e_{0,0},\\ldots,e_{3,3}\\}</span>  the unit vectors of  <span class="math">\\mathbb{F}_{2^n}^{4\\times 4}</span>  (e.g.,  <span class="math">e_{i,j}</span>  has a single 1 in row i and column i).</p>

    <p class="text-gray-300"><strong>Definition 1.</strong> <em>For each</em>  <span class="math">i \\in \\{0, 1, 2, 3\\}</span> <em>:</em></p>

    <ul class="list-disc list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li>The column spaces  <span class="math">C_i</span>  are defined as  <span class="math">C_i = \\langle e_{0,i}, e_{1,i}, e_{2,i}, e_{3,i} \\rangle</span> .</li>
      <li>The diagonal spaces  <span class="math">\\mathcal{D}_i</span>  are defined as  <span class="math">\\mathcal{D}_i = SR^{-1}(\\mathcal{C}_i)</span> . Similarly, the inversediagonal spaces  <span class="math">\\mathcal{ID}_i</span>  are defined as  <span class="math">\\mathcal{ID}_i = SR(\\mathcal{C}_i)</span> .</li>
      <li>The i-th mixed spaces  <span class="math">\\mathcal{M}_i</span>  are defined as  <span class="math">\\mathcal{M}_i = MC(\\mathcal{ID}_i)</span> .</li>
    </ul>

    <p class="text-gray-300"><strong>Definition 2.</strong> For each  <span class="math">I \\subseteq \\{0, 1, 2, 3\\}</span> , let  <span class="math">C_I</span> ,  <span class="math">D_I</span> ,  <span class="math">ID_I</span>  and  <span class="math">M_I</span>  be defined as</p>

    <p class="text-gray-300"><span class="math">$\\mathcal{C}_I = \\bigoplus_{i \\in I} \\mathcal{C}_i \\,, \\qquad \\mathcal{D}_I = \\bigoplus_{i \\in I} \\mathcal{D}_i \\,, \\qquad \\mathcal{I} \\mathcal{D}_I = \\bigoplus_{i \\in I} \\mathcal{I} \\mathcal{D}_i \\,, \\qquad \\mathcal{M}_I = \\bigoplus_{i \\in I} \\mathcal{M}_i \\,.</span>$</p>

    <p class="text-gray-300"><strong>Definition 3.</strong> Let  <span class="math">t \\in \\mathbb{F}_{2^n}^{4\\times 4}</span>  be a text in a coset of a space  <span class="math">\\mathcal{X} \\subseteq \\mathbb{F}_{2^n}^{4\\times 4}</span>  such that  <span class="math">\\mathcal{X} = \\langle x_0, x_1, \\dots, x_{d-1} \\rangle</span>  where  <span class="math">\\dim(\\mathcal{X}) = d</span> , namely  <span class="math">t \\in \\mathcal{X} \\oplus \\gamma</span> . Given  <span class="math">\\gamma</span> ,  <span class="math">(t_0, t_1, \\ldots, t_{d-1}) \\in \\mathbb{F}_{2^n}^d</span>  are the generating variables of t if the following holds:</p>

    <p class="text-gray-300"><span class="math">$t \\equiv (t_0, t_1, \\dots, t_{d-1})</span>$
if and only if  <span class="math">t = \\gamma \\oplus \\bigoplus_{j=0}^{d-1} t_j \\cdot x_j</span> .</p>

    <p class="text-gray-300">As shown in detail in [22], for any coset  <span class="math">\\mathcal{D}_I \\oplus \\alpha</span>  there exists  <span class="math">\\beta \\in \\mathbb{F}_{28}^{4 \\times 4}</span>  such that  <span class="math">R(\\mathcal{D}_I \\oplus \\alpha) = \\mathcal{C}_I \\oplus \\beta</span> . In a similar way, for any coset  <span class="math">\\mathcal{C}_I \\oplus \\beta</span>  there exists  <span class="math">\\gamma \\in \\mathbb{F}_{2^8}^{4 \\times 4}</span>  such that  <span class="math">R(\\mathcal{C}_I \\oplus \\beta) = \\mathcal{M}_I \\oplus \\gamma</span> .</p>

    <p class="text-gray-300">In more details,  <span class="math">\\Pr(N_{\\Delta_I,\\Delta_O} = 4 \\mid \\Delta_I = 0 \\text{x} F) = 0</span>  (i.e.,  <span class="math">N_{0 \\text{x} F, \\Delta_O} \\neq 4</span>  for all  <span class="math">\\Delta_O</span> ) while  <span class="math">\\Pr(N_{\\Delta_I,\\Delta_O} = 4 \\mid \\Delta_I = 0 \\text{x} A) = \\frac{2}{15}</span>  (two values of  <span class="math">\\Delta_O</span>  satisfy  <span class="math">N_{0 \\text{x} A, \\Delta_O} = 4</span> ). We refer to App. C for more details.</p>

    <p class="text-gray-300"><strong>Theorem 1</strong> ([22]). For each  <span class="math">I \\subseteq \\{0,1,2,3\\}</span>  and for each  <span class="math">\\alpha \\in \\mathbb{F}_{2^8}^{4 \\times 4}</span> , there exists  <span class="math">\\beta \\in \\mathbb{F}_{28}^{4 \\times 4}</span>  such that  <span class="math">R^2(\\mathcal{D}_I \\oplus \\alpha) = \\mathcal{M}_I \\oplus \\beta</span> . Equivalently:</p>

    <p class="text-gray-300"><span class="math">$Prob(R^2(x) \\oplus R^2(y) \\in \\mathcal{M}_I \\mid x \\oplus y \\in \\mathcal{D}_I) = 1.</span>$
(3)</p>

    <h4 id="sec-misc-2" class="text-lg font-semibold mt-6">Multiple-of-8 Property and Mixture Differential Cryptanalysis</h4>

    <p class="text-gray-300">As already recalled in the introduction, the first known property independent of the secret-key for 5-round AES &ndash; called &quot;multiple-of-8&quot; property [21] &ndash; has been presented at Eurocrypt 2017.</p>

    <p class="text-gray-300"><strong>Theorem 2</strong> ([21]). Let  <span class="math">\\{p^i\\}_{i \\in \\{0,1,\\ldots,2^{32 \\cdot d}-1\\}}</span>  be  <span class="math">2^{32 \\cdot d}</span>  plaintexts with  <span class="math">1 \\leq d \\leq 3</span> active diagonals, or equivalently in the same coset of a diagonal subspace  <span class="math">\\mathcal{D}_I</span>  for a certain  <span class="math">I \\subseteq \\{0,1,2,3\\}</span>  with |I| = d. Consider the corresponding ciphertexts after 5 rounds (without the final MixColumns operation), that is,  <span class="math">(p^i, c^i)</span>  for  <span class="math">i \\in \\{0,\\ldots,2^{32\\cdot |I|}-1\\}</span>  where  <span class="math">c^i=R_f^5(p^i)</span> . The number of different pairs of ciphertexts  <span class="math">(c^i, c^j)</span>  that are equal in  <span class="math">1 \\le a \\le 3</span>  anti-diagonals (i.e., that belong to the same coset of a subspace  <span class="math">\\mathcal{ID}_J</span>  for a certain  <span class="math">J \\subseteq \\{0,1,2,3\\}</span>  with |J| = 4-ais always a multiple of 8, independently of the secret key, of the details of the S-Box and of the MixColumns matrix.</p>

    <p class="text-gray-300">We refer to [21, 19, 12] for details. Such a result is strictly related to the mixture differential cryptanalysis [19] proposed at FSE/ToSC'19.</p>

    <p class="text-gray-300"><strong>Theorem 3</strong> ([19]). Let  <span class="math">t^1, t^2</span>  be two texts in  <span class="math">C_i \\oplus \\gamma</span>  for a certain  <span class="math">i \\in \\{0, 1, 2, 3\\}</span> , namely two plaintexts that differ in the i-th column only. Let  <span class="math">t^1 \\equiv (x_0^1, x_1^1, x_2^1, x_3^1)</span> and  <span class="math">t^2 \\equiv (x_0^2, x_1^2, x_2^2, x_3^2)</span>  be their generating variables. Let  <span class="math">s^1, s^2 \\in \\mathcal{C}_i \\oplus \\gamma</span>  be defined</p>

    <ul class="list-disc list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li><span class="math">\\begin{array}{l} \\ \\textit{if} \\ x_i^1 \\neq x_i^2 \\ \\textit{for a certain} \\ i \\in \\{0,1,2,3\\} \\text{: the </span>i<span class="math">-th generating variable} \\ s_i^1 \\ \\textit{of} \\ s^1 \\\\ \\ \\textit{is either} \\ x_i^1 \\ \\textit{or} \\ x_i^2, \\ \\textit{and the </span>i<span class="math">-th generating variable} \\ \\textit{of} \\ s^2 \\ \\textit{is} \\ \\{x_i^1, x_i^2\\} \\setminus s_i^1; \\\\ \\ \\ \\textit{if} \\ x_i^1 = x_i^2 \\ \\textit{for a certain} \\ i \\in \\{0,1,2,3\\} \\text{: the </span>i<span class="math">-th generating variable} \\ s_i^1 \\ \\textit{of} \\ s^1 \\end{array}</span></li>
      <li>is equal to the i-th generating variable of  <span class="math">s^2</span>  (no condition on the value).</li>
    </ul>

    <p class="text-gray-300">The following holds:</p>

    <ul class="list-disc list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li><ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li><span class="math">R^2(t^1) \\oplus R^2(t^2) = R^2(s^1) \\oplus R^2(s^2)</span> ;</li>
    </ol></li>
      <li><ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li>for each  <span class="math">J \\subseteq \\{0, 1, 2, 3\\}</span> :</li>
    </ol></li>
    </ul>

    <p class="text-gray-300"><span class="math">$R^4(t^1) \\oplus R^4(t^2) \\in \\mathcal{M}_J</span>$
if and only if  <span class="math">R^4(s^1) \\oplus R^4(s^2) \\in \\mathcal{M}_J</span> .</p>

    <h4 id="sec-misc-3" class="text-lg font-semibold mt-6">Main Result: Probability Distribution for 5-round AES</h4>

    <p class="text-gray-300">Given a set of  <span class="math">2^{32 \\cdot d}</span>  plaintexts with  <span class="math">1 \\leq d \\leq 3</span>  active diagonal(s), consider the probability distribution of the number of pairs of ciphertexts which are equal in  <span class="math">1 \\le a \\le 3</span>  fixed anti-diagonal(s) (without the final MixColumns operation):</p>

    <p class="text-gray-300"><span class="math">&lt;sup&gt;\\&lt;/sup&gt;overline{\\ }^2</span>  Two pairs (s,t) and (t,s) are considered to be equivalent (i.e., they count per 1).</p>

    <ul class="list-disc list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li>what can we say about the mean, the variance and the skewness of this distribution?</li>
      <li>does the multiple-of-8 property influence the average number of output pairs that lie in a particular subspace (i.e., the mean)? Are other parameters (as the variance and the skewness) affected by the multiple-of-8 property?</li>
    </ul>

    <p class="text-gray-300">Here we answer these questions.</p>

    <p class="text-gray-300"><strong>Theorem 4.</strong> Given an AES-like cipher that works with texts in  <span class="math">\\mathbb{F}_{2s}^{4\\times4}</span> , assume that (1st) the MixColumns matrix is an MDS matrix and that (2nd) the solutions of the equation S-Box <span class="math">(x \\oplus \\Delta_I) \\oplus</span>  S-Box <span class="math">(x) = \\Delta_O</span>  are uniformly distributed for each non-zero input/output difference  <span class="math">\\Delta_I \\neq 0</span>  and  <span class="math">\\Delta_O \\neq 0</span> .</p>

    <p class="text-gray-300">Given  <span class="math">2^{32}</span>  plaintexts  <span class="math">\\{p^i\\}_{i\\in\\{0,1,\\ldots,2^{32}-1\\}}</span>  with one active diagonal (i.e., in a coset of a diagonal subspace  <span class="math">\\mathcal{D}_i</span>  for  <span class="math">i\\in\\{0,1,2,3\\}</span> ), consider the number of different pairs of ciphertexts  <span class="math">(c^h,c^j)</span>  for  <span class="math">h\\neq j</span>  that belong into the same coset of  <span class="math">\\mathcal{ID}_J</span>  for any fixed  <span class="math">J\\subseteq\\{0,1,2,3\\}</span>  with |J|=3. The corresponding probability distribution &ndash; denoted in the following by  <span class="math">\\mathfrak{D}_{5\\text{-}AES}</span>  &ndash; with respect to</p>

    <ul class="list-disc list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li>all possible initial coset of the diagonal space  <span class="math">\\mathcal{D}_i</span> , and</li>
      <li>all possible secret keys</li>
    </ul>

    <p class="text-gray-300">is given by</p>

    <p class="text-gray-300"><span class="math">$\\mathfrak{D}_{5-AES} = 2^3 \\times \\mathfrak{B}(n_3, p_3) + 2^{10} \\times \\mathfrak{B}(n_{10}, p_{10}) + 2^{17} \\times \\mathfrak{B}(n_{17}, p_{17}), \\tag{4}</span>$</p>

    <p class="text-gray-300">where  <span class="math">\\mathfrak{B}_i \\sim \\mathfrak{B}(n_i, p_i)</span>  for  <span class="math">i \\in \\{3, 10, 17\\}</span>  are binomial distributions, and where  <span class="math">n_i</span>  and  <span class="math">p_i</span>  for  <span class="math">i \\in \\{3, 10, 17\\}</span>  are equal to</p>

    <p class="text-gray-300"><span class="math">$n_3 = 2^{28} \\cdot (2^8 - 1)^4</span>$
,  <span class="math">p_3 = 2^{-32} + 2^{-53.983}</span> ;  <span class="math">n_{10} = 2^{23} \\cdot (2^8 - 1)^3</span> ,  <span class="math">p_{10} = 2^{-32} - 2^{-45.989}</span> ;  <span class="math">n_{17} = 3 \\cdot 2^{15} \\cdot (2^8 - 1)^2</span> ,  <span class="math">p_{17} = 2^{-32} + 2^{-37.986}</span> .</p>

    <p class="text-gray-300">Such distribution has mean value  <span class="math">\\mu=2\\,147\\,484\\,685.6</span> , and standard deviation  <span class="math">\\sigma=277\\,204.426.</span></p>

    <p class="text-gray-300">In order to prove Theorem 4, we first derive the values  <span class="math">n_i</span>  for i = 3, 10, 17 and prove the result given in Eq. (4). In the next sections, we formally compute the probabilities  <span class="math">p_i</span>  for  <span class="math">i \\in \\{3, 10, 17\\}</span> , the value of the mean and the variance.</p>

    <p class="text-gray-300">An immediate corollary of the previous result is the following.</p>

    <p class="text-gray-300"><strong>Corollary 1.</strong> Given an AES-like cipher that works with texts in  <span class="math">\\mathbb{F}_{2s}^{4\\times4}</span> , assume that (1st) the MixColumns matrix is an MDS matrix and that (2nd) the solutions of the equation S-Box <span class="math">(x \\oplus \\Delta_I) \\oplus</span>  S-Box <span class="math">(x) = \\Delta_O</span>  are uniformly distributed for each non-zero input/output difference  <span class="math">\\Delta_I \\neq 0</span>  and  <span class="math">\\Delta_O \\neq 0</span> .</p>

    <p class="text-gray-300">Given  <span class="math">2^{32}</span>  plaintexts  <span class="math">\\{p^i\\}_{i\\in\\{0,1,\\ldots,2^{32}-1\\}}</span>  with one active diagonal (i.e., in a coset of a diagonal subspace  <span class="math">\\mathcal{D}_i</span>  for  <span class="math">i\\in\\{0,1,2,3\\}</span> ), the probability that  <span class="math">n\\in\\mathbb{N}</span>  different pairs of ciphertexts  <span class="math">(c^h,c^j)</span>  for  <span class="math">h\\neq j</span>  are equal in one fixed anti-diagonal</p>

    <p class="text-gray-300">(equivalently, that belong to the same coset of  <span class="math">\\mathcal{ID}_J</span>  for  <span class="math">J \\subseteq \\{0, 1, 2, 3\\}</span>  fixed with |J| = 3) is given by:</p>

    <p class="text-gray-300"><span class="math">$Prob(n) = \\begin{cases} 0 &amp; \\text{if } n \\text{ mod } 8 \\neq 0 \\\\ \\sum_{(x_3, x_{10}, x_{17}) \\in X_n} \\left( \\prod_{i \\in \\{3, 10, 17\\}} \\binom{n_i}{x_i} \\cdot (p_i)^{x_i} \\cdot (1 - p_i)^{n_i - x_i} \\right) &amp; \\text{otherwise} \\end{cases}</span>$
(5)</p>

    <p class="text-gray-300">where</p>

    <p class="text-gray-300"><span class="math">$X_n = \\left\\{ (x_3, x_{10}, x_{17}) \\in \\mathbb{N} \\times \\mathbb{N} \\times \\mathbb{N} \\middle| 0 \\le x_i \\le n_i \\text{ and } 2^3 \\cdot x_3 + 2^{10} \\cdot x_{10} + 2^{17} \\cdot x_{17} = n \\right\\}</span>$</p>

    <p class="text-gray-300">and where  <span class="math">n_i</span>  and  <span class="math">p_i</span>  for  <span class="math">i \\in \\{3, 10, 17\\}</span>  are as in Theorem 4.</p>

    <p class="text-gray-300">Note that
<span class="math">$\\text{Prob}(n &gt; (2^3 \\cdot n_3 + 2^{10} \\cdot n_{10} + 2^{17} \\cdot n_{17})) = 0</span>$
, since  <span class="math">X_n = \\emptyset</span>  for  <span class="math">n &gt; (2^3 \\cdot n_3 + 2^{10} \\cdot n_{10} + 2^{17} \\cdot n_{17})</span> .</p>

    </section>

    <section id="sec-4" class="mb-10">
      <h2 class="text-2xl font-bold">4 Initial Considerations</h2>

    <p class="text-gray-300">About the S-Box: &quot;Uniform Distribution of the Solutions of S-Box  <span class="math">(\\cdot \\oplus \\Delta_I) \\oplus \\text{S-Box}(\\cdot) = \\Delta_O</span> &quot;. Before going further, we discuss the assumptions of Theorem 4, focusing on the one related to the properties/details of the S-Box. The fact that &quot;the solutions of Eq. (1) are uniformly distributed for each  <span class="math">\\Delta_I \\neq 0</span>  and  <span class="math">\\Delta_O \\neq 0</span> &quot; basically corresponds to an S-Box that satisfies the following properties:</p>

    <ul class="list-disc list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li><ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li>it is &quot;homogeneous&quot; (defined in Sect. 2.2);</li>
    </ol></li>
      <li><ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li>its variance  <span class="math">Var(N_{\\Delta_I,\\Delta_O})</span>  is as &quot;lower&quot; as possible.<sup>3</sup></li>
    </ol></li>
    </ul>

    <p class="text-gray-300">This is close to being true if the S-Box is APN, or if the S-Box is &quot;close&quot; to be APN. Although much is known for (bijective) APN permutations in odd dimension, it is known that there is no APN permutation of dimension 4 [25], there is at least one APN permutation, up to equivalence, of dimension 6 (that is, the Dillon's permutation), while the question of finding an APN bijective (n, n)-function for even  <span class="math">n \\geq 8</span>  is still open. As a result, in the case of dimensions equal to a power of 2 (e.g.,  <span class="math">\\mathbb{F}_{2^4}</span>  or  <span class="math">\\mathbb{F}_{2^8}</span> ), the only (known) S-Box that (approximately) matches the assumptions of the Theorem in dimensions 4 or 8 is the one generated by the multiplicative-inverse permutation<sup>4</sup>, as for example the AES S-Box, which is not APN but differentially 4-uniform [26] (e.g., note that the variance of the AES S-Box is 67 064/65 025 vs 64 004/65 025 of an APN S-Box). As we are going to show, our practical results on small-scale AES (for which the S-Box has the same property as the full-size AES one) are very close to the one predicted by the previous Theorem.</p>

    <p class="text-gray-300"><sup>&amp;</sup>lt;sup&gt;3</sup> Note that even if the variance  <span class="math">Var(N_{\\Delta_I,\\Delta_O})</span>  is related to  <span class="math">DP_{max}</span> , S-Boxes with equal  <span class="math">DP_{max}</span>  can have very different variance. Moreover, the variance of an S-Box  <span class="math">S_1</span>  can be bigger than the corresponding variance of an S-Box  <span class="math">S_2</span>  even if  <span class="math">DP_{max}</span>  of  <span class="math">S_1</span>  is lower than  <span class="math">DP_{max}</span>  of  <span class="math">S_2</span>  (see Table 3 in App. C for concrete examples).</p>

    <p class="text-gray-300"><sup>&amp;</sup>lt;sup&gt;4</sup> Variance, homogeneous differential property and  <span class="math">DP_{max}</span>  of an S-Box S remain unchanged if affine transformations are applied in the domain or co-domain of S.</p>

    <p class="text-gray-300">We remark that even if the assumptions on the S-Box of Theorem 4 are restrictive, they match criteria used to design an S-Box which is strong against differential and linear cryptanalysis. As a result, many ciphers in the literature are built using S-Boxes which (are close to) satisfy the assumptions of Theorem 4.</p>

    <p class="text-gray-300">Influence of the S-Box. If the S-Box does not satisfy the required properties related to the assumption of the Theorem, then the average number of collisions can be different from the one previously given. To be more concrete, in App. C we provide several practical examples of the dependency of the average number of collisions for small-scale AES-like ciphers with respect to the properties of the S-Box. We also mention that, in the case in which the assumption about the S-Box is not fulfilled, it turned out (by practical tests) that also the details of the MixColumns matrix can influence the average number of collisions.</p>

    <p class="text-gray-300"><strong>Probability Distribution of a Random Permutation.</strong> Here we briefly compare the probability distribution for 5-round AES and the one of a random permutation. This fact can be used to set up new truncated differential distinguishers for 5-round AES, as we are going to show concretely in Sect. 8.</p>

    <p class="text-gray-300"><strong>Proposition 1.</strong> Consider  <span class="math">2^{32}</span>  plaintexts  <span class="math">\\{p^i\\}_{i\\in\\{0,1,\\dots,2^{32}-1\\}}</span>  with one active diagonal (equivalently, a coset of a diagonal space  <span class="math">\\mathcal{D}_i</span>  for  <span class="math">i\\in\\{0,1,2,3\\}</span> ), and the corresponding (cipher)texts generated by a random permutation  <span class="math">\\Pi</span> , that is  <span class="math">c^i = \\Pi(p^i)</span> . The probability distribution of the number of different pairs of ciphertexts  <span class="math">(c^h, c^j)</span>  that belong to the same coset of  <span class="math">\\mathcal{I}\\mathcal{D}_J</span>  for any fixed  <span class="math">J\\subseteq\\{0,1,2,3\\}</span>  with |J|=3 is given by a binomial distribution  <span class="math">\\mathfrak{B}(n,p)</span> , where  <span class="math">n=\\binom{2^{32}}{2}=2^{31}\\cdot(2^{32}-1)</span>  and  <span class="math">p=\\frac{2^{96}-1}{2^{128}-1}\\approx 2^{-32}</span> . The average number of collisions of such distribution is equal to  <span class="math">2^{31}-0.5=2</span>  147 483 647.5, while its variance is equal to  <span class="math">2^{14}</span> 7 483 647  <span class="math">\\simeq 2^{31}</span> .</p>

    <h4 id="sec-misc-4" class="text-lg font-semibold mt-6">It follows that:</h4>

    <ul class="list-disc list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li>independently of the secret key, the average number of pairs of ciphertexts which are equal in one fixed anti-diagonal is (a little) bigger for 5-round AES than for a random permutation (approximately 1038.1 more collisions);</li>
      <li>independently of the secret key, the variance of the probability distribution of the number of collisions is much bigger for 5-round AES than for a random permutation (approximately of a factor 36).</li>
    </ul>

    <p class="text-gray-300">To highlight this difference, Fig. 1 proposes a comparison between the probability distribution of the number of collisions for the AES case (approximated here for simplicity by a normal distribution) in red and of the random case in blue.</p>

    </section>

    <section id="sec-5" class="mb-10">
      <h2 class="text-2xl font-bold">5 Proof of Theorem 4: Sum of Binomial Distributions</h2>

    <p class="text-gray-300">Consider a set of  <span class="math">2^{32}</span>  plaintexts with one active diagonal and the corresponding ciphertexts after 5-round AES (without the final MixColumns operation). As</p>

    <p class="text-gray-300">    <img src="_page_10_Figure_0.jpeg" alt="" class="my-4 max-w-full" />
</p>

    <p class="text-gray-300">Fig. 1. Comparison between the theoretical probability distribution of the number of collisions between 5-round AES (approximated &ndash; only here &ndash; by a normal distribution) and a random permutation. Remark: since the AES probability distribution &ndash; in red &ndash; satisfies the multiple-of-8 property, then the probability in the case in which the number of collision n is not a multiple of 8 is equal to zero, namely P rob(n 6= 8 &middot; n 0 ) = 0.</p>

    <p class="text-gray-300">shown by the multiple-of-8 property [21] and by the mixture differential cryptanalysis [19], the corresponding pairs of ciphertexts of such set of plaintexts are not independent/unrelated. In particular, these pairs of texts can be divided in n<sup>3</sup> + n<sup>10</sup> + n<sup>17</sup> + n<sup>24</sup> sets defined as in [19] (recalled in Theorem 3) such that</p>

    <ul class="list-disc list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li><ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li>for each i &isin; {3, 10, 17, 24}, exactly n<sup>i</sup> sets have cardinality 2<sup>i</sup> ;</li>
    </ol></li>
      <li><ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li>each one of these sets contains pairs of texts for which i out of the four generating variables are equal (and 4&minus;i are different) after 1-round encryption;</li>
    </ol></li>
      <li><ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li>given each one of such sets, it is not possible that some pairs of ciphertexts are equal in 1 &le; a &le; 3 anti-diagonals (i.e., that belong to the same coset of ID<sup>J</sup> ) after 5-round, while other pairs of ciphertexts in the same set are not equal in those a anti-diagonals;</li>
    </ol></li>
      <li><ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li>pairs of texts of different sets are independent (in the sense that pairs of texts of different sets do not satisfy the property just given for the case of pairs of texts that belong to the same set).</li>
    </ol></li>
    </ul>

    <p class="text-gray-300">The values of n3, n10, n17, n<sup>24</sup> are computed in details in the next paragraph.</p>

    <p class="text-gray-300">Due to the impossible differential trail on 4-round AES [7, 22], if three out of the four generating variables of the input plaintexts are equal after 1-round encryption, then the corresponding ciphertexts cannot be equal in any antidiagonal. In other words, the probability p<sup>24</sup> is equal to zero. For this reason, we will only focus on n3, n10, n<sup>17</sup> in the following.</p>

    <p class="text-gray-300">About the Values of n3, n10, n17. Given a set of 2<sup>32</sup> chosen texts with one active column<sup>5</sup> , the number of pairs of texts with 0 &le; v &le; 3 equal generating variables (and 4 &minus; v different generating variables) after one round is given by</p>

    <p class="text-gray-300"><span class="math">$\\binom{4}{v} \\cdot 2^{31} \\cdot (2^8 - 1)^{4-v} \\,. \\tag{6}</span>$</p>

    <p class="text-gray-300"><sup>5</sup> One active diagonal is mapped to one active column after 1-round AES encryption.</p>

    <p class="text-gray-300">Indeed, note that if v variables are equal for the two texts of the given pair, then these variables can take  <span class="math">(2^8)^v</span>  different values. For each one of the remaining 4-v variables, the variables must be different for the two texts. Thus, these 4-v variables can take exactly  <span class="math">\\left[2^8\\cdot(2^8-1)\\right]^{4-v}/2</span>  different values. The result follows from the fact that there are  <span class="math">\\binom{4}{v}</span>  different combinations of v variables.</p>

    <p class="text-gray-300">Due to Eq. (6), the number  <span class="math">n_v</span>  of the sets of pairs of texts with &quot;no equal generating variables&quot; (namely, v = 0), the set of of pairs of texts with &quot;one equal and three different generating variable(s)&quot; (namely, v = 1) and finally the set of of pairs of texts with &quot;two equal and two different generating variable&quot; (namely, v = 2) are given by:</p>

    <p class="text-gray-300"><span class="math">$\\forall v \\in \\{0, 1, 2\\}: \\qquad n_{7 \\cdot v + 3} = \\binom{4}{v} \\cdot \\frac{2^{31} \\cdot (2^8 - 1)^{4 - v}}{2^{7 \\cdot v + 3}}. \\tag{7}</span>$</p>

    <p class="text-gray-300">About Binomial Distributions  <span class="math">B_i \\sim \\mathfrak{B}(n_i, p_i)</span>  for  <span class="math">i \\in \\{3, 10, 17\\}</span> . Due to the previous facts, it follows that the probability of the event &quot; <span class="math">n = 8 \\cdot n&#x27;</span>  pairs of ciphertexts equal in one fixed anti-diagonal&quot; for  <span class="math">n&#x27; \\in \\mathbb{N}</span>  &ndash; equivalently, &quot; <span class="math">n = 8 \\cdot n&#x27;</span>  collisions&quot; in a coset of  <span class="math">\\mathcal{ID}_J</span>  for  <span class="math">J \\subseteq \\{0, 1, 2, 3\\}</span>  with |J| = 3 &ndash; corresponds to the sum of the probabilities to have &quot; <span class="math">2^3 \\cdot k_3</span>  collisions in the first set and  <span class="math">2^{10} \\cdot k_{10}</span>  collisions in the second set and  <span class="math">2^{17} \\cdot k_{17}</span>  collisions in the third set&quot; for each  <span class="math">k_3, k_{10}, k_{17}</span>  such that  <span class="math">2^3 \\cdot k_3 + 2^{10} \\cdot k_{10} + 2^{17} \\cdot k_{17} = n</span> .</p>

    <p class="text-gray-300">Each one of these (independent) events is well characterized by a binomial distribution. By definition, a binomial distribution with parameters n and p is the discrete probability distribution of the number of successes in a sequence of n independent yes/no experiments, each of which yields success with probability p. In our case, given n pairs of texts, each one of them satisfies or not the above property/requirement with the same probability p.</p>

    <p class="text-gray-300"><strong>Probability Distribution.</strong> Due to all these initial considerations (based on the multiple-of-8 property and on the mixture differential cryptanalysis), it follows that the distribution 5-AES of the number of collisions for the AES case is well described by</p>

    <p class="text-gray-300"><span class="math">$\\mathfrak{D}_{5\\text{-AES}} = 2^3 \\times \\mathfrak{B}_3 + 2^{10} \\times \\mathfrak{B}_{10} + 2^{17} \\times \\mathfrak{B}_{17}</span>$</p>

    <p class="text-gray-300">where  <span class="math">\\mathfrak{B}_i \\sim \\mathfrak{B}(n_i, p_i)</span>  for i = 3, 10, 17 are independent binomial distributions. In the following, we formally compute the values of  <span class="math">n_i</span>  and of  <span class="math">p_i</span> .</p>

    <p class="text-gray-300">Based on this fact, we can also compute the probability that  <span class="math">n \\in \\mathbb{N}</span>  different pairs of ciphertexts  <span class="math">(c^h, c^j)</span>  for  <span class="math">h \\neq j</span>  are equal in one fixed anti-diagonal, as given in (5). Given  <span class="math">n \\in \\mathbb{N}</span> , we can immediately conclude that  <span class="math">\\operatorname{Prob}(\\mathfrak{D}_{5\\text{-AES}} = n) = 0</span>  if  <span class="math">n \\neq 8 \\cdot n&#x27;</span> , that is, if n is not a multiple of 8 (due to the multiple-of-8 property). Otherwise, if  <span class="math">n = 8 \\cdot n&#x27;</span>  for  <span class="math">n&#x27; \\in \\mathbb{N}</span> , then:</p>

    <p class="text-gray-300">$$\\operatorname{Prob}(\\mathfrak{D}<em>{5\\text{-AES}} = n) = \\operatorname{Prob}(2^{3} \\cdot \\mathfrak{B}</em>{3} + 2^{10} \\cdot \\mathfrak{B}<em>{10} + 2^{17} \\cdot \\mathfrak{B}</em>{17} = n) = \\
= \\sum_{\\substack{m_{3}, m_{10}, m_{17} \\in \\mathbb{N} \\text{ s.t.} \\ m_{3} + m_{10} + m_{17} = n}} \\operatorname{Prob}(2^{3} \\cdot \\mathfrak{B}<em>{3} = m</em>{3}) \\times \\operatorname{Prob}(2^{10} \\cdot \\mathfrak{B}<em>{10} = m</em>{10}) \\
\\times \\operatorname{Prob}(2^{17} \\cdot \\mathfrak{B}<em>{17} = m</em>{17}),$$</p>

    <p class="text-gray-300">where remember that the distributions  <span class="math">\\mathfrak{B}_3, \\mathfrak{B}_{10}</span>  and  <span class="math">\\mathfrak{B}_{17}</span>  are independent.</p>

    <p class="text-gray-300">Since  <span class="math">\\operatorname{Prob}(2^i \\cdot B_i = m_i) = 0</span>  if  <span class="math">m_i</span>  is not a multiple of  <span class="math">2^i</span>  for each  <span class="math">i \\in \\{3, 10, 17\\}</span>  (namely, if there is no  <span class="math">x_i \\in \\mathbb{N}</span>  such that  <span class="math">m_i \\neq 2^i \\cdot x_i</span> ), it follows that</p>

    <p class="text-gray-300"><span class="math">$\\begin{aligned} &amp; \\operatorname{Prob}\\left(\\mathfrak{D}_{5\\text{-AES}} = n\\right) = \\operatorname{Prob}\\left(2^{3} \\cdot \\mathfrak{B}_{3} + 2^{10} \\cdot \\mathfrak{B}_{10} + 2^{17} \\cdot \\mathfrak{B}_{17} = n\\right) = \\\\ &amp; = \\sum_{\\substack{m_{3}, m_{10}, m_{17} \\in \\mathbb{N} \\text{ s.t.} \\\\ m_{3} + m_{10} + m_{17} = n}} \\operatorname{Prob}(2^{3} \\cdot \\mathfrak{B}_{3} = m_{3}) \\times \\operatorname{Prob}(2^{10} \\cdot \\mathfrak{B}_{10} = m_{10}) \\\\ &amp; \\times \\operatorname{Prob}(2^{17} \\cdot \\mathfrak{B}_{17} = m_{17}) \\\\ &amp; = \\sum_{x_{3}, x_{10}, x_{17} \\in X_{n}} \\operatorname{Prob}(\\mathfrak{B}_{3} = x_{3}) \\times \\operatorname{Prob}(\\mathfrak{B}_{10} = x_{10}) \\times \\operatorname{Prob}(\\mathfrak{B}_{17} = x_{17}) \\end{aligned}</span>$</p>

    <p class="text-gray-300">where</p>

    <p class="text-gray-300"><span class="math">$X_n = \\left\\{ (x_3, x_{10}, x_{17}) \\in \\mathbb{N} \\times \\mathbb{N} \\times \\mathbb{N} \\mid 0 \\le x_i \\le n_i \\text{ and } 2^3 \\cdot x_3 + 2^{10} \\cdot x_{10} + 2^{17} \\cdot x_{17} = n \\right\\}.</span>$</p>

    <p class="text-gray-300">The probability given in (5) finally follows from the fact that  <span class="math">\\mathfrak{B}_i</span>  are binomial distributions, i.e.,</p>

    <p class="text-gray-300"><span class="math">$\\operatorname{Prob}(\\mathfrak{B}_i = x) = \\binom{n_i}{x} \\cdot (p_i)^x \\cdot (1 - p_i)^{n_i - x},</span>$</p>

    <p class="text-gray-300">where  <span class="math">n_i</span>  and  <span class="math">p_i</span>  for  <span class="math">i \\in \\{3, 10, 17\\}</span>  are given in Theorem 4.</p>

    <p class="text-gray-300">Mean Value and Variance. Due to the results just presented, it follows that the mean value  <span class="math">\\mu</span>  of 5-AES is given by</p>

    <p class="text-gray-300"><span class="math">$\\begin{split} \\mu = &amp; \\mathbb{E}[\\mathfrak{D}_{\\text{5-AES}}] = \\mathbb{E}[2^3 \\times \\mathfrak{B}_3 + 2^{10} \\times \\mathfrak{B}_{10} + 2^{17} \\times \\mathfrak{B}_{17}] \\\\ = &amp; 2^3 \\cdot \\mathbb{E}[\\mathfrak{B}_3] + 2^{10} \\cdot \\mathbb{E}[\\mathfrak{B}_{10}] + 2^{17} \\cdot \\mathbb{E}[\\mathfrak{B}_{17}] \\\\ = &amp; 2^3 \\cdot n_3 \\cdot p_3 + 2^{10} \\cdot n_{10} \\cdot p_{10} + 2^{17} \\cdot n_{17} \\cdot p_{17} \\,, \\end{split}</span>$</p>

    <p class="text-gray-300">where  <span class="math">\\mathbb{E}[a \\cdot X + b \\cdot Y + c] = a \\cdot \\mathbb{E}[X] + b \\cdot \\mathbb{E}[Y] + c</span>  for each  <span class="math">a, b, c \\in \\mathbb{R}</span>  and for each random variable X and Y. Similarly, the variance  <span class="math">\\sigma^2</span>  is given by</p>

    <p class="text-gray-300"><span class="math">$\\begin{split} \\sigma^2 &amp;= \\operatorname{Var}(\\mathfrak{D}_{\\text{5-AES}}) = \\operatorname{Var}(2^3 \\times \\mathfrak{B}_3 + 2^{10} \\times \\mathfrak{B}_{10} + 2^{17} \\times \\mathfrak{B}_{17}) \\\\ &amp;= 2^6 \\cdot \\operatorname{Var}(\\mathfrak{B}_3) + 2^{20} \\cdot \\operatorname{Var}(\\mathfrak{B}_{10}) + 2^{34} \\cdot \\operatorname{Var}(\\mathfrak{B}_{17}) \\\\ &amp;= 2^6 \\cdot n_3 \\cdot p_3 \\cdot (1 - p_3) + 2^{10} \\cdot n_{10} \\cdot p_{10} \\cdot (1 - p_{10}) + 2^{17} \\cdot n_{17} \\cdot p_{17} \\cdot (1 - p_{17}), \\end{split}</span>$</p>

    <p class="text-gray-300">where  <span class="math">\\operatorname{Var}(a \\cdot X + b \\cdot Y + c) = a^2 \\cdot \\operatorname{Var}(X) + b^2 \\cdot \\operatorname{Var}(Y)</span>  for each  <span class="math">a, b, c \\in \\mathbb{R}</span>  under the assumption that X and Y are independent random variables (remember that  <span class="math">\\mathfrak{B}_3, \\mathfrak{B}_{10}, \\mathfrak{B}_{17}</span>  are independent).</p>

    </section>

    <section id="sec-6" class="mb-10">
      <h2 class="text-2xl font-bold">6 Proof of Theorem 4: About the Probabilities <span class="math">p_3, p_{10}, p_{17}</span></h2>

      <h3 id="sec-6.1" class="text-xl font-semibold mt-8">6.1 Reduction to the Middle Round</h3>

    <p class="text-gray-300">In order to compute the probabilities  <span class="math">p_3, p_{10}</span>  and  <span class="math">p_{17}</span>  given before for 5 rounds AES, the idea is to work on an equivalent result on a single round. Due to the</p>

    <p class="text-gray-300">2-round truncated differential with prob. 1 recalled in Sect. 3.1, we have that</p>

    <p class="text-gray-300"><span class="math">$\\mathcal{D}_i \\oplus \\delta \\xrightarrow{R^2(\\cdot)} \\mathcal{M}_i \\oplus \\omega \\xrightarrow{R(\\cdot)} \\mathcal{D}_J \\oplus \\delta&#x27; \\xrightarrow{R_f^2(\\cdot)} \\mathcal{I}\\mathcal{D}_J \\oplus \\omega&#x27;. \\tag{8}</span>$</p>

    <p class="text-gray-300">For this reason, it is sufficient to focus on the middle round  <span class="math">\\mathcal{M}_i \\oplus \\omega \\xrightarrow{R(\\cdot)} \\mathcal{D}_J \\oplus \\delta&#x27;</span>  in order to compute the desired result.</p>

    <p class="text-gray-300">Sketch &amp; Organization of the Proof. W.l.o.g., we limit ourselves to consider plaintexts in the same coset of  <span class="math">\\mathcal{M}_0</span>  and to count the number of texts which are equal in the first diagonal after one round (the other cases are analogous). By definition of  <span class="math">\\mathcal{M}_0</span> , if  <span class="math">p^1, p^2 \\in \\mathcal{M}_0 \\oplus \\omega</span> , then there exist  <span class="math">x^i, y^i, z^i, w^i \\in \\mathbb{F}_{2^8}</span>  for  <span class="math">i \\in \\{1, 2\\}</span>  such that:</p>

    <p class="text-gray-300"><span class="math">$p^i = \\omega \\oplus \\begin{bmatrix} 2 \\cdot x^i &amp; y^i &amp; z^i &amp; 3 \\cdot w^i \\\\ x^i &amp; y^i &amp; 3 \\cdot z^i &amp; 2 \\cdot w^i \\\\ x^i &amp; 3 \\cdot y^i &amp; 2 \\cdot z^i &amp; w^i \\\\ 3 \\cdot x^i &amp; 2 \\cdot y^i &amp; z^i &amp; w^i \\end{bmatrix} \\,,</span>$</p>

    <p class="text-gray-300">where  <span class="math">2 \\equiv 0 \\times 02</span>  and  <span class="math">3 \\equiv 0 \\times 03</span> . In the following, we say that  <span class="math">p^1</span>  is &quot;generated&quot; by the generating variables  <span class="math">(x^1, y^1, z^1, w^1)</span>  and that  <span class="math">p^2</span>  is &quot;generated&quot; by the generating variables  <span class="math">(x^2, y^2, z^2, w^2)</span> . As before, we use the notation  <span class="math">p^i \\equiv (x^i, y^i, z^i, w^i)</span> . The proof is organized as follows:</p>

    <ul class="list-disc list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li><ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li>first of all, we limit ourselves to consider a subset of 2<sup>16</sup> texts with only 2 active bytes. Since this case is much simpler to analyze than the generic one, it allows us to highlight the crucial points of the proof;</li>
    </ol></li>
      <li><ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li>we then present the complete proof for the case of  <span class="math">2^{32}</span>  texts in the same coset of  <span class="math">\\mathcal{M}_0</span> . Roughly speaking, this case is split in various sub-cases: each one of them is studied/analyzed independently of the others using the same strategy proposed for the simplest case of  <span class="math">2^{16}</span>  texts. The final result is obtained by simply combining the results of each one of these sub-cases.</li>
    </ol></li>
    </ul>

    <p class="text-gray-300">We emphasize that the following computations are <em>not</em> influenced by neither the value of the secret key nor the value of the initial coset of the diagonal subspace  <span class="math">\\mathcal{D}_i</span> . That is, the following results are the average with respect to these two values.</p>

    <p class="text-gray-300">As a first case, we consider  <span class="math">2^{16}</span>  texts for which two generating variables are equal, e.g.,  <span class="math">z^1 = z^2</span>  and  <span class="math">w^1 = w^2</span> . Given two texts  <span class="math">p^1</span>  generated by  <span class="math">(x^1, y^1, 0, 0)</span>  and  <span class="math">p^2</span>  generated by  <span class="math">(x^2, y^2, 0, 0)</span> , they are equal in the first diagonal after one round if</p>

    <p class="text-gray-300">and only if the following four equations are satisfied</p>

    <p class="text-gray-300"><span class="math">$\\begin{split} (R(p^1) \\oplus R(p^2))_{0,0} = &amp; 2 \\cdot (\\text{S-Box}(2 \\cdot x^1 \\oplus a_{0,0}) \\oplus \\text{S-Box}(2 \\cdot x^2 \\oplus a_{0,0})) \\\\ &amp; \\oplus 3 \\cdot (\\text{S-Box}(y^1 \\oplus a_{1,1}) \\oplus \\text{S-Box}(y^2 \\oplus a_{1,1})) = 0 \\,, \\\\ (R(p^1) \\oplus R(p^2))_{1,1} = &amp; \\text{S-Box}(3 \\cdot x^1 \\oplus a_{3,0}) \\oplus \\text{S-Box}(3 \\cdot x^2 \\oplus a_{3,0}) \\\\ &amp; \\oplus \\text{S-Box}(y^1 \\oplus a_{0,1}) \\oplus \\text{S-Box}(y^2 \\oplus a_{0,1}) = 0 \\,, \\\\ (R(p^1) \\oplus R(p^2))_{2,2} = &amp; 2 \\cdot (\\text{S-Box}(x^1 \\oplus a_{2,0}) \\oplus \\text{S-Box}(x^2 \\oplus a_{2,0})) \\\\ &amp; \\oplus 3 \\cdot (\\text{S-Box}(2 \\cdot y^1 \\oplus a_{3,1}) \\oplus \\text{S-Box}(2 \\cdot y^2 \\oplus a_{3,1})) = 0 \\,, \\\\ (R(p^1) \\oplus R(p^2))_{3,3} = &amp; \\text{S-Box}(x^1 \\oplus a_{1,0}) \\oplus \\text{S-Box}(x^2 \\oplus a_{1,0}) \\\\ &amp; \\oplus \\text{S-Box}(3 \\cdot y^1 \\oplus a_{2,1}) \\oplus \\text{S-Box}(3 \\cdot y^2 \\oplus a_{2,1}) = 0 \\,, \\end{split}</span>$</p>

    <p class="text-gray-300">where  <span class="math">a_{\\cdot,\\cdot} \\in \\mathbb{F}_{2^8}</span>  depends on the initial key and on the constant  <span class="math">\\omega \\in \\mathbb{F}_{2^8}^{4 \\times 4}</span>  that defines the coset. Equivalently, four equations of the form</p>

    <p class="text-gray-300"><span class="math">$A \\cdot \\left( \\text{S-Box}(B \\cdot x^1 \\oplus a) \\oplus \\text{S-Box}(B \\cdot x^2 \\oplus a) \\right)</span>$</p>

    <p class="text-gray-300"><span class="math">$\\oplus C \\cdot \\left( \\text{S-Box}(D \\cdot y^1 \\oplus c) \\oplus \\text{S-Box}(D \\cdot y^2 \\oplus c) \\right) = 0</span>$
(9)</p>

    <p class="text-gray-300">must be satisfied, where  <span class="math">A, B, C, D \\in \\mathbb{F}_{2^8}</span>  depend on the MixColumns matrix, while  <span class="math">a, c \\in \\mathbb{F}_{2^8}</span>  depend on the secret key and on the initial constant  <span class="math">\\omega</span> .</p>

    <p class="text-gray-300">Number of Solutions of Each Equation. Consider one of these four equations. By simple observation, Eq. (9) is satisfied if and only if the following system of equations is satisfied</p>

    <p class="text-gray-300"><span class="math">$S-Box(\\hat{x} \\oplus \\Delta_I) \\oplus S-Box(\\hat{x}) = \\Delta_O</span>$</p>

    <p class="text-gray-300"><span class="math">$S-Box(\\hat{y} \\oplus \\Delta_I&#x27;) \\oplus S-Box(\\hat{y}) = \\Delta_O&#x27;</span>$</p>

    <p class="text-gray-300"><span class="math">$\\Delta_O&#x27; = C^{-1} \\cdot A \\cdot \\Delta_O</span>$
(10)</p>

    <p class="text-gray-300">for each value of  <span class="math">\\Delta_O</span> , where  <span class="math">\\hat{x} = B \\cdot x^1 \\oplus a</span> ,  <span class="math">\\Delta_I = B \\cdot (x^1 \\oplus x^2)</span> ,  <span class="math">\\hat{y} = D \\cdot y^1 \\oplus c</span>  and  <span class="math">\\Delta_I&#x27; = D \\cdot (y^1 \\oplus y^2)</span> . We emphasize that we exclude null solutions.</p>

    <p class="text-gray-300">What is the number of different (not null) solutions  <span class="math">\\{(x^1, y^1), (x^2, y^2)\\}</span>  of Eq. (9)? Given  <span class="math">\\Delta_O \\neq 0</span> , each one of the first two equations of (10) admits 256 different solutions  <span class="math">(\\hat{x}, \\Delta_I)</span>  (respectively,  <span class="math">(\\hat{y}, \\Delta_I&#x27;)</span> ), since for each value of  <span class="math">\\hat{x} \\in \\mathbb{F}_{2^8}</span> , there exists  <span class="math">\\Delta_I \\neq 0</span>  that satisfies the first equation (similar for  <span class="math">\\hat{y}</span>  and  <span class="math">\\Delta_I&#x27;</span> ). It follows that the number of different solutions  <span class="math">\\{(x^1, y^1), (x^2, y^2)\\}</span>  of Eq. (9) considering all the 255 possible values of  <span class="math">\\Delta_O</span>  is exactly equal to</p>

    <p class="text-gray-300"><span class="math">$\\frac{1}{2} \\cdot 255 \\cdot (256)^2 = 255 \\cdot 2^{15} \\,,</span>$</p>

    <p class="text-gray-300">independent of the details of the S-Box. The factor 1/2 is due to the fact that we consider only different solutions, that is, two solutions of the form  <span class="math">(p^1 \\equiv (x^1, y^1), p^2 \\equiv (x^2, y^2))</span>  and  <span class="math">(p^2 \\equiv (x^1, y^1), p^1 \\equiv (x^2, y^2))</span>  are equivalent. In other words, a solution  <span class="math">\\{(x^1, y^1), (x^2, y^2)\\}</span>  is valid if  <span class="math">x^2 \\neq x^1</span>  and  <span class="math">y^1 &lt; y^2</span> .</p>

    <p class="text-gray-300">Probability of Common Solutions. Knowing the number of solutions of Eq. (9), what is the number of common (different) solutions  <span class="math">\\{(x^1,y^1),(x^2,y^2)\\}</span>  of four equations of the form (9)? We have just seen that each equation of the form (9) has exactly  <span class="math">255 \\cdot 2^{15}</span>  different (not null) solutions  <span class="math">\\{(x^1,y^1),(x^2,y^2)\\}</span> . Assuming the APN-like assumption on the S-Box and the fact that the MixColumns is defined by an MDS matrix, the probability that two equations admit the same solution (i.e., that  <span class="math">\\{(x^1,y^1),(x^2,y^2)\\}</span>  &ndash; solution of one equation &ndash; is equal to  <span class="math">\\{(\\hat{x}^1,\\hat{y}^1),(\\hat{x}^2,\\hat{y}^2)\\}</span>  &ndash; solution of another equation) is</p>

    <p class="text-gray-300"><span class="math">$(256 \\cdot 255)^{-1} \\cdot (255 \\cdot 128)^{-1} = 255^{-2} \\cdot 2^{-15}. \\tag{11}</span>$</p>

    <p class="text-gray-300">To explain this probability, the first term  <span class="math">(256 \\cdot 255)^{-1}</span>  is due to the fact that  <span class="math">x^1 = \\hat{x}^1</span>  with probability  <span class="math">256^{-1}</span> , while  <span class="math">x^2 = \\hat{x}^2</span>  with probability  <span class="math">255^{-1}</span> , since by assumption  <span class="math">x^2</span>  (respectively,  <span class="math">\\hat{x}^2</span> ) cannot be equal to  <span class="math">x^1</span>  (respectively,  <span class="math">\\hat{x}^1</span> ). The second term  <span class="math">(128 \\cdot 255)^{-1}</span>  is due to the assumption on the second variable, that is  <span class="math">y^1 &lt; y^2</span> . To explain it, note that the possible number of pairs  <span class="math">(y^1, y^2)</span>  with  <span class="math">y^1 &lt; y^2</span>  is  <span class="math">\\sum_{i=0}^{255} i = \\frac{255 \\cdot (255+1)}{2} = 255 \\cdot 128</span> . It follows that  <span class="math">y^1</span>  and  <span class="math">y^2</span>  are equal to  <span class="math">\\hat{y}^1</span>  and  <span class="math">\\hat{y}^2</span>  with probability  <span class="math">(128 \\cdot 255)^{-1}</span> .</p>

    <p class="text-gray-300">Total Number of (Different) Common Solutions. In conclusion, the average number of common (different) solutions  <span class="math">\\{(x^1, y^1), (x^2, y^2)\\}</span>  of 4 equations of the form (9) is given by</p>

    <p class="text-gray-300"><span class="math">$(255 \\cdot 2^{15})^4 \\cdot (255^{-2} \\cdot 2^{-15})^3 = \\frac{2^{15}}{255^2} \\simeq 0.503929258 \\simeq 2^{-1} + 2^{-7.992} \\,.</span>$</p>

    <p class="text-gray-300">For comparison, in the case in which the ciphertexts are generated by a random permutation, the average number of pairs of ciphertexts that satisfy the previous property is approximately given by</p>

    <p class="text-gray-300"><span class="math">$\\binom{2^{16}}{2} \\cdot (2^{-8})^4 = \\frac{2^{16} - 1}{2^{17}} \\simeq 0.499992371 \\simeq 2^{-1} - 2^{-17} \\,.</span>$</p>

    <p class="text-gray-300">Remark: About the MDS Assumption. We highlight that the probability (11) strongly depends on the assumptions that</p>

    <ul class="list-disc list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li>the solutions of Eq. (1) hence, the numbers  <span class="math">N_{\\Delta_I,\\Delta_O}</span>  are uniformly distributed for each  <span class="math">\\Delta_I \\neq 0</span>  and  <span class="math">\\Delta_O \\neq 0</span> ;</li>
      <li>there is &quot;no (obvious/non-trivial) relation&quot; between the solutions of the studied system of four equations of the form (9). This means that the four Equations (9) must be independent/unrelated, in the sense that the solution of one equation is not a solution of another one with probability different than the one given in (11).</li>
    </ul>

    <p class="text-gray-300"><sup>&amp;</sup>lt;sup&gt;6</sup> E.g., if  <span class="math">y^1 = 0</span> x0 then  <span class="math">y^2</span>  can take 255 different values (all values except 0), if  <span class="math">y^1 = 0</span> x1 then  <span class="math">y^2</span>  can take 254 different values (all values except 0x0, 0x1) and so on. Given  <span class="math">y^1 = d</span>  with  <span class="math">0 \\le d \\le 255</span> , then  <span class="math">y^2</span>  can take 255 - d different values.</p>

    <p class="text-gray-300">Focusing here on this second requirement, a relation among solutions of different equations can arise if some relations hold between the coefficients A, B, C, D of different equations of the form (9). Since these are the coefficients of the MixColumns matrix and since such matrix is MDS, no non-trivial linear relation among the rows/columns of any submatrix exists.</p>

      <h3 id="sec-6.3" class="text-xl font-semibold mt-8">6.3 Generic Case: 2<sup>32</sup> Texts</h3>

    <p class="text-gray-300">As next step, we adapt the strategy just presented in order to analyze the case of  <span class="math">2^{32}</span>  texts in the same coset of  <span class="math">\\mathcal{M}_0</span> . Two texts  <span class="math">p^1, p^2</span>  are equal in one diagonal after one round if and only if four equations of the form</p>

    <p class="text-gray-300"><span class="math">$A \\cdot \\left( \\text{S-Box}(B \\cdot x^{1} \\oplus b) \\oplus \\text{S-Box}(B \\cdot x^{2} \\oplus b) \\right)</span>$</p>

    <p class="text-gray-300"><span class="math">$\\oplus C \\cdot \\left( \\text{S-Box}(D \\cdot y^{1} \\oplus d) \\oplus \\text{S-Box}(D \\cdot y^{2} \\oplus d) \\right)</span>$</p>

    <p class="text-gray-300"><span class="math">$\\oplus E \\cdot \\left( \\text{S-Box}(F \\cdot z^{1} \\oplus f) \\oplus \\text{S-Box}(F \\cdot z^{2} \\oplus f) \\right)</span>$</p>

    <p class="text-gray-300"><span class="math">$\\oplus G \\cdot \\left( \\text{S-Box}(H \\cdot w^{1} \\oplus h) \\oplus \\text{S-Box}(H \\cdot w^{2} \\oplus h) \\right) = 0</span>$</p>

    <p class="text-gray-300"><span class="math">$(12)</span>$</p>

    <p class="text-gray-300">are satisfied, where  <span class="math">A, B, C, D, E, F, G, H \\in \\mathbb{F}_{2^8}</span>  depend only on the MixColumns matrix, while  <span class="math">b, d, f, h \\in \\mathbb{F}_{2^8}</span>  depend on the secret key and on the constant  <span class="math">\\omega</span>  that defined the initial coset, as before. Each one of these equations is equivalent to a system of equations like (10), that is:</p>

    <p class="text-gray-300"><span class="math">$S-Box(\\hat{x} \\oplus \\Delta_I) \\oplus S-Box(\\hat{x}) = \\Delta_O \\qquad S-Box(\\hat{y} \\oplus \\Delta_I&#x27;) \\oplus S-Box(\\hat{y}) = \\Delta_O&#x27;&#x27;</span>$</p>

    <p class="text-gray-300"><span class="math">$S-Box(\\hat{z} \\oplus \\Delta_I&#x27;&#x27;) \\oplus S-Box(\\hat{z}) = \\Delta_O&#x27;&#x27;</span>$</p>

    <p class="text-gray-300"><span class="math">$S-Box(\\hat{y} \\oplus \\Delta_I&#x27;&#x27;) \\oplus S-Box(\\hat{y}) = \\Delta_O&#x27;&#x27;</span>$</p>

    <p class="text-gray-300">together with one of the following conditions</p>

    <ul class="list-disc list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li><ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li><span class="math">\\Delta_O^{&#x27;&#x27;&#x27;} = \\Delta_O^{&#x27;&#x27;} = 0</span>  and  <span class="math">\\Delta_O&#x27; = C^{-1} \\cdot A \\cdot \\Delta_O \\neq 0</span> , or analogous (six possibilities in total);</li>
    </ol></li>
      <li><ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li><span class="math">\\Delta_O^{&#x27;&#x27;&#x27;}=0</span>  and  <span class="math">\\Delta_O, \\Delta_O^{&#x27;}, \\Delta_O^{&#x27;&#x27;}\\neq 0</span>  and  <span class="math">\\Delta_O^{&#x27;&#x27;}=E^{-1}\\cdot (A\\cdot \\Delta_O\\oplus C\\cdot \\Delta_O^{&#x27;})</span> , or analogous (four possibilities in total);</li>
    </ol></li>
      <li><ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li><span class="math">\\Delta_O, \\Delta_O&#x27;, \\Delta_O&#x27;&#x27;, \\Delta_O&#x27;&#x27;&#x27; \\neq 0</span>  and  <span class="math">\\Delta_O&#x27;&#x27;&#x27; = G^{-1} \\cdot (A \\cdot \\Delta_O \\oplus C \\cdot \\Delta_O&#x27; \\oplus E \\cdot \\Delta_O&#x27;&#x27;)</span> .</li>
    </ol></li>
    </ul>

    <p class="text-gray-300">First Case. Since the first case  <span class="math">(\\Delta_O^{&#x27;&#x27;&#x27;}=\\Delta_O^{&#x27;&#x27;}=0)</span>  is analogous to the case in which two generating variables are equal, we can limit ourselves to re-use the previous computation. In the case  <span class="math">\\Delta_O^{&#x27;&#x27;&#x27;}=\\Delta_O^{&#x27;&#x27;}=0</span>  and  <span class="math">\\Delta_O&#x27;=C^{-1}\\cdot A\\cdot \\Delta_O\\neq 0</span> , the only possible solutions of the third and fourth equations are of the form  <span class="math">(\\hat{z},\\Delta_I^{&#x27;&#x27;&#x27;}=0)</span>  and  <span class="math">(\\hat{w},\\Delta_I^{&#x27;&#x27;&#x27;}=0)</span>  for each possible value of  <span class="math">\\hat{z},\\hat{w}\\in\\mathbb{F}_{2^8}</span> . Using the same computation as before, the average number of common solutions for this case is</p>

    <p class="text-gray-300"><span class="math">$\\binom{4}{2} \\cdot 256^2 \\cdot \\frac{2^{15}}{255^2} = \\frac{2^{32}}{21675} \\simeq 198153.047. \\tag{13}</span>$</p>

    <p class="text-gray-300">About Probability  <span class="math">p_{17}</span> . By definition of probability, the probability  <span class="math">p_{17}</span>  &ndash; given in Theorem 4 &ndash; that pairs of texts with two equal (and two different) generating variables are equal in one diagonal after one round is given by:</p>

    <p class="text-gray-300"><span class="math">$p_{17} = \\frac{1}{2^{17} \\times n_{17}} \\cdot \\frac{2^{32}}{21675} = 2^{-32} + 2^{-37.98588}, \\tag{14}</span>$</p>

    <p class="text-gray-300">where  <span class="math">2^{17} \\times n_{17}</span>  is the <em>total</em> number of pairs of texts with two equal (and two different) generating variables.</p>

    <p class="text-gray-300"><strong>Second Case.</strong> Consider now the case  <span class="math">\\Delta_O^{&#x27;&#x27;&#x27;}=0</span>  and  <span class="math">\\Delta_O,\\Delta_O&#x27;,\\Delta_O&#x27;&#x27;\\neq 0</span>  (i.e.,  <span class="math">\\Delta_I,\\Delta_I&#x27;,\\Delta_I&#x27;&#x27;\\neq 0</span> ). First of all, note that  <span class="math">\\Delta_O\\neq 0</span>  can take 255 different values, while  <span class="math">\\Delta_O&#x27;\\neq 0</span>  can take only 254 different values (since it must be different from 0 and from  <span class="math">C^{-1}\\cdot A\\cdot \\Delta_O</span> ).</p>

    <p class="text-gray-300">Using the same argumentation given before, for each Eq. (12) the number of different solutions  <span class="math">\\{(x^1,y^1,z^1,w^1),(x^2,y^2,z^2,w^2)\\}</span>  &ndash; with  <span class="math">z^1 &lt; z^2</span>  and where  <span class="math">w^1 = w^2</span>  &ndash; is given by  <span class="math">\\binom{4}{1} \\cdot 256 \\cdot \\left(\\frac{1}{2} \\cdot 255 \\cdot 254 \\cdot (256)^3\\right) = 2^{10} \\cdot \\left(32\\,385 \\cdot 2^{24}\\right)</span> , where the initial factor  <span class="math">\\binom{4}{1} \\cdot 256</span>  is due to the condition  <span class="math">w^1 = w^2</span>  and on the fact that there are four analogous cases (namely,  <span class="math">x^1 = x^2</span>  or  <span class="math">y^1 = y^2</span>  or  <span class="math">z^1 = z^2</span> ). Similar to before, the probability that two equations of the form (12) &ndash; where  <span class="math">w^1 = w^2</span>  &ndash; have a common solution is given by  <span class="math">(256 \\cdot 255)^{-2} \\cdot (128 \\cdot 255)^{-1} = 2^{-23} \\cdot 255^{-3}</span>  under (1st) the assumption of uniform distribution of the solutions  <span class="math">n_{\\Delta_I,\\Delta_O}</span>  of Eq. (1) and (2nd) the assumption that there is &quot;no (obvious/non-trivial) relation&quot; between the solutions of the studied system of four equations of the form (12). It follows that the average number of common solutions for the four equations of the form (12) is</p>

    <p class="text-gray-300"><span class="math">$\\binom{4}{1} \\cdot 256 \\cdot (32385 \\cdot 2^{24})^4 \\cdot (2^{-23} \\cdot 255^{-3})^3 = \\frac{127^4 \\cdot 2^{37}}{255^5} \\simeq 33160710.047. \\quad (15)</span>$</p>

    <p class="text-gray-300">About Probability  <span class="math">p_{10}</span> . As before, the probability  <span class="math">p_{10}</span>  &ndash; given in Theorem 4 &ndash; that pairs of texts with one equal (and three different) generating variable(s) are equal in one diagonal after one round is given by:</p>

    <p class="text-gray-300"><span class="math">$p_{10} = \\frac{1}{2^{10} \\times n_{10}} \\cdot \\frac{127^4 \\cdot 2^{37}}{255^5} = 2^{-32} - 2^{-45.98874}. \\tag{16}</span>$</p>

    <p class="text-gray-300">Third Case. We finally consider the case  <span class="math">\\Delta_O, \\Delta&#x27;_O, \\Delta&#x27;_O, \\Delta&#x27;&#x27;_O \\neq 0</span> . By simple computation, the number of different values that satisfy  <span class="math">\\Delta&#x27;&#x27;_O = G^{-1} \\cdot (A \\cdot \\Delta_O \\oplus C \\cdot \\Delta&#x27;_O \\oplus E \\cdot \\Delta&#x27;&#x27;_O)</span> . is given by  <span class="math">255^3 - (255 \\cdot 254) = 16516605</span> . Indeed, the total number of  <span class="math">\\Delta_O, \\Delta&#x27;_O, \\Delta&#x27;&#x27;_O \\neq 0</span>  is  <span class="math">255^3</span> , while  <span class="math">255 \\cdot 254</span>  is the total number of values  <span class="math">\\Delta_O, \\Delta&#x27;_O, \\Delta&#x27;&#x27;_O \\neq 0</span>  for which  <span class="math">\\Delta&#x27;&#x27;&#x27;_O</span>  is equal to zero (which is not possible since  <span class="math">\\Delta&#x27;&#x27;&#x27;_O \\neq 0</span>  by assumption). In more detail, firstly observe that for each value of  <span class="math">\\Delta_O</span>  there is a value of  <span class="math">\\Delta&#x27;_O</span>  that satisfies  <span class="math">A \\cdot \\Delta_O = C \\cdot \\Delta&#x27;_O</span> . For this pair of values  <span class="math">(\\Delta_O, \\Delta&#x27;_O = C^{-1} \\cdot A \\cdot \\Delta_O)</span> , the previous equation  <span class="math">\\Delta&#x27;&#x27;&#x27;_O = G^{-1} \\cdot E \\cdot \\Delta&#x27;&#x27;_O</span>  is always</p>

    <p class="text-gray-300">different from zero, since  <span class="math">\\Delta_O&#x27;&#x27; \\neq 0</span> . Secondly, for each one of the 255 &middot; 254 values of the pair  <span class="math">(\\Delta_O, \\Delta_O&#x27; \\neq C^{-1} \\cdot A \\cdot \\Delta_O)</span> , there is only one value of  <span class="math">\\Delta_O&#x27;&#x27;</span>  such that the previous equation is equal to zero.</p>

    <p class="text-gray-300">Hence, the total number of different solutions  <span class="math">\\{(x^1,y^1,z^1,w^1),(x^2,y^2,z^2,w^2)\\}</span>  with  <span class="math">w^1 &lt; w^2</span>  of each equation corresponding to (12) is  <span class="math">\\frac{1}{2} \\cdot 16 \\cdot 516 \\cdot 605 \\cdot (256)^4 = 16 \\cdot 516 \\cdot 605 \\cdot 2^{31}</span> . Since the probability that two solutions  <span class="math">\\{(x^1,y^1,z^1,w^1),(x^2,y^2,z^2,w^2)\\}</span>  and  <span class="math">\\{(\\hat{x}^1,\\hat{y}^1,\\ \\hat{z}^1,\\hat{w}^1),(\\hat{x}^2,\\hat{y}^2,\\hat{z}^2,\\hat{w}^2)\\}</span>  are equal is  <span class="math">(255 \\cdot 256)^{-3} \\cdot (255 \\cdot 128)^{-1} = 255^{-4} \\cdot 2^{-31}</span>  under (1st) the assumption of uniform distribution of the solutions of Eq. (1) and (2nd) the assumption that that there is &quot;no (obvious/non-trivial) relation&quot; between the solutions of the studied system of four equations of the form (12), the average number of common solutions (with no equal generating variables) is</p>

    <p class="text-gray-300"><span class="math">$(16516605 \\cdot 2^{31})^4 \\cdot (255^{-4} \\cdot 2^{-31})^3 = \\frac{64771^4 \\cdot 2^{31}}{255^8} \\simeq 2114125822.5.</span>$
(17)</p>

    <p class="text-gray-300">About Probability  <span class="math">p_3</span> . As before, the probability  <span class="math">p_3</span>  given in Theorem 4 that pairs of texts with no equal generating variable are equal in one diagonal after one round is given by:</p>

    <p class="text-gray-300"><span class="math">$p_3 = \\frac{1}{2^3 \\times n_3} \\cdot \\frac{64771^4 \\cdot 2^{31}}{255^8} = 2^{-32} + 2^{-53.98306}. \\tag{18}</span>$</p>

    <p class="text-gray-300">Total Number of (Different) Common Solutions. Based on the results just proposed, given plaintexts in the same coset of  <span class="math">\\mathcal{M}_0</span> , the number of different pairs of ciphertexts that are equal in one fixed diagonal after 1-round (equivalently, the number of collisions in  <span class="math">\\mathcal{D}_J</span>  for |J|=3) is</p>

    <p class="text-gray-300"><span class="math">$2\\,114\\,125\\,822.5 + 33\\,160\\,710.047 + 198\\,153.047 \\simeq 2\\,147\\,484\\,685.594 \\simeq 2^{31} + 2^{10.02}\\,2000000000000000000000000000000000</span>$</p>

    <p class="text-gray-300">Since the total number of pairs of texts is  <span class="math">2^{31} \\cdot (2^{32} - 1)</span> , the probability for the AES case that a couple of ciphertexts  <span class="math">(c^1, c^2)</span>  satisfies  <span class="math">c^1 \\oplus c^2 \\in \\mathcal{D}_J</span>  for |J| = 3 fixed is equal to</p>

    <p class="text-gray-300"><span class="math">$p_{AES} \\simeq \\frac{2\\,147\\,484\\,685.594}{2^{31}\\cdot(2^{32}-1)} \\simeq 2^{-32} + 2^{-52.9803}</span>$</p>

    <p class="text-gray-300">versus  <span class="math">\\approx 2^{-32} - 2^{-128}</span>  for the case of a random permutation.</p>

    </section>

    <section id="sec-7" class="mb-10">
      <h2 class="text-2xl font-bold">7 Practical Results for 5-round AES</h2>

    <p class="text-gray-300">We have practically verified the mean and the variance for 5-round AES given above (in Theorem 4) using a C/C++ implementation<sup>7</sup>. In particular, we have verified the mean value on a small-scale AES as proposed in [13], and the variance value both on full-size and on the small-scale AES.</p>

    <p class="text-gray-300"><sup>&amp;</sup>lt;sup&gt;7</sup> The source codes of the distinguishers/attacks can be found at https://github.com/Krypto-iaik/TruncatedDiff5roundAES.</p>

      <h3 id="sec-7.1" class="text-xl font-semibold mt-8">7.1 Probability Distribution of 5-round AES over <span class="math">(\\mathbb{F}_{2^n})^{4\\times 4}</span></h3>

    <p class="text-gray-300">Firstly, we generalize Theorem 4 for the case of 5-round AES defined over  <span class="math">\\mathbb{F}_{2^n}^{4\\times 4}</span> .</p>

    <p class="text-gray-300"><strong>Proposition 2.</strong> Consider an AES-like cipher that works with texts in  <span class="math">\\mathbb{F}_{2^n}^{4\\times 4}</span> , such that (1st) the MixColumns matrix is an MDS matrix and such that (2nd) the solutions of Eq. (1) are uniformly distributed for each input/output difference  <span class="math">\\Delta_I \\neq 0</span>  and  <span class="math">\\Delta_O \\neq 0</span> . Given  <span class="math">2^{4n}</span>  plaintexts  <span class="math">\\{p^i\\}_{i\\in\\{0,1,\\dots,2^{4n}-1\\}}</span>  with one active diagonal (equivalently, in a coset of a diagonal space  <span class="math">\\mathcal{D}_i</span>  for  <span class="math">i\\in\\{0,1,2,3\\}</span> ), consider the corresponding ciphertexts after 5 rounds without the final MixColumns operation, that is,  <span class="math">c^i = R_f^i(p^i)</span> . Independently of</p>

    <ul class="list-disc list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li>the initial coset of  <span class="math">\\mathcal{D}_i</span> , and</li>
      <li>the value of the secret key,</li>
    </ul>

    <p class="text-gray-300">the average number of different pairs of ciphertexts  <span class="math">(c^h, c^j)</span>  for  <span class="math">h \\neq j</span>  that belong to the same coset of  <span class="math">\\mathcal{ID}_J</span>  for any fixed  <span class="math">J \\subseteq \\{0, 1, 2, 3\\}</span>  with |J| = 3 is equal to</p>

    <p class="text-gray-300"><span class="math">$\\frac{2^{4n-1} \\cdot (2^{2n} - 3 \\cdot 2^n + 3)^4}{(2^n - 1)^8} + \\frac{(2^{n-1} - 1)^4 \\cdot 2^{4n+5}}{(2^n - 1)^5} + 3 \\cdot \\frac{2^{4n}}{(2^n - 1)^2},\\tag{19}</span>$</p>

    <p class="text-gray-300">and the variance of such distribution is given by</p>

    <p class="text-gray-300"><span class="math">$\\frac{2^{4n+2} \\cdot (2^{2n} - 3 \\cdot 2^n + 3)^4}{(2^n - 1)^8} + \\frac{(2^{n-1} - 1)^4 \\cdot 2^{5n+7}}{(2^n - 1)^5} + \\frac{3 \\cdot 2^{6n+1}}{(2^n - 1)^2}.</span>$
(20)</p>

    <p class="text-gray-300">The proof is analogous to the one just given for  <span class="math">\\mathbb{F}_{2^8}^{4\\times 4}</span> , and it is provided in App. B.</p>

      <h3 id="sec-7.2" class="text-xl font-semibold mt-8">7.2 Practical Results for 5-round AES over <span class="math">\\mathbb{F}_{2^n}^{4\\times 4}</span> for <span class="math">n\\in\\{4,8\\}</span></h3>

    <p class="text-gray-300">Practical Results: Variance of 5-round AES over  <span class="math">\\mathbb{F}_{28}^{4\\times4}</span> . Our practical results regarding the variance  <span class="math">\\sigma^2</span>  for full-size AES over 320 different initial cosets and keys are</p>

    <p class="text-gray-300"><span class="math">$\\sigma_T^2 = 76\\,842\\,293\\,834.905 \\simeq 2^{36.161}</span>$
versus  <span class="math">\\sigma_P^2 = 73\\,288\\,132\\,411.36 \\simeq 2^{36.093}</span></p>

    <p class="text-gray-300">where the subscript  <span class="math">\\cdot_T</span>  denotes the theoretical value and the subscript  <span class="math">\\cdot_P</span>  the practical one.</p>

    <p class="text-gray-300">Practical Results for 5-round AES over  <span class="math">\\mathbb{F}_{2^4}^{4\\times 4}</span> . Our practical results for small-scale AES regarding the mean  <span class="math">\\mu</span>  over  <span class="math">125\\,000\\simeq 2^{17}</span>  different initial cosets and keys are</p>

    <p class="text-gray-300"><span class="math">$\\begin{split} \\mu_{AES}^T &amp;= 32\\,847.124 &amp; \\textit{versus} &amp; \\mu_{AES}^P &amp;= 32\\,848.57 \\,; \\\\ \\mu_{rand}^T &amp;= 32\\,767.5 &amp; \\textit{versus} &amp; \\mu_{rand}^P &amp;= 32\\,768.2 \\,. \\end{split}</span>$</p>

    <p class="text-gray-300">Our practical results for small-scale AES regarding the standard deviation  <span class="math">\\sigma</span>  over 100 different initial cosets and keys are</p>

    <p class="text-gray-300"><span class="math">$\\begin{split} \\sigma_{AES}^T &amp;= 1036.58 &amp; versus &amp; \\sigma_{AES}^P &amp;= 1027.93 \\,; \\\\ \\sigma_{rand}^T &amp;= 181.02 &amp; versus &amp; \\sigma_{rand}^P &amp;= 182.42 \\,. \\end{split}</span>$</p>

    <p class="text-gray-300">    <img src="_page_20_Figure_0.jpeg" alt="" class="my-4 max-w-full" />
</p>

    <p class="text-gray-300">Fig. 2. Comparison between the probability distribution of the number of collisions between theoretical small-scale 5-round AES (approximated by a normal distribution) and the practical one. Remark: since the AES probability distribution satisfies the multiple-of-8 property, then the probability in the case in which the number of collisions n is not a multiple of 8 is equal to zero.</p>

    <p class="text-gray-300">The probability distribution for 5-round AES is not Symmetric. Fig. 2 highlights the difference between the practical probability distribution of the number of collisions for small-scale AES and for a random permutation.</p>

    <p class="text-gray-300">By Fig. 2, it turns out that small-scale 5-round AES distribution has a positive skew, while the skew of the random distribution is approximately equal to zero. The skewness is the parameter that measures the asymmetry of the probability distribution of a real-valued random variable about its mean. We practically derived the values of the skewness &gamma; both for full-size AES and for small-scale one using 2<sup>9</sup> initial cosets, and we got the following results:</p>

    <p class="text-gray-300"><span class="math">$\\gamma^{AES} \\simeq 0.43786 \\qquad and \\qquad \\gamma^{AES}_{\\rm small-scale} \\simeq 0.4687 \\, ,</span>$</p>

    <p class="text-gray-300">where the skew of a random permutation is close to zero. We leave the open problem to theoretically compute the skew for small/real-size AES (and to set up a corresponding distinguisher if possible) as a future work.</p>

    </section>

    <section id="sec-8" class="mb-10">
      <h2 class="text-2xl font-bold">8 Truncated Differential Distinguishers for 5-round AES</h2>

    <p class="text-gray-300">Differential attacks [8] exploit the fact that pairs of plaintexts with certain differences yield other differences in the corresponding ciphertexts with a non-uniform probability distribution. A variant of this attack/distinguisher is the truncated differential one [23], in which the attacker can predict only part of the difference between pairs of texts. Using the subspace terminology [9], given pairs of plaintexts that belong to the same coset of a subspace X , one considers the probability that the corresponding ciphertexts belong to the same coset of a subspace Y.</p>

    <p class="text-gray-300">The truncated differential distinguishers that we present in this section for 5-round AES are based on the same principle. For the first time in the literature, we also present a truncated differential distinguisher based on the variance.</p>

    <p class="text-gray-300"><strong>Table 2.</strong> Secret-key distinguishers for 5-round AES. The complexity is measured in minimum number of chosen plaintexts/ciphertexts (CP/CC) or/and adaptive chosen plaintexts/ciphertexts (ACP/ACC) which are needed to distinguish 5-round AES from a random permutation with probability bigger than 95%. Time complexity is measured in equivalent encryptions (E) or memory accesses (M) or XOR operations (XOR) &ndash; using the common approximation 20 M  <span class="math">\\approx</span>  1-round E. Our distinguishers are in bold.</p>

    <div class="overflow-x-auto my-4">
      <table class="min-w-full text-sm text-gray-300">
        <thead>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">Property</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">Data (CP/CC)</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">Cost</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">Reference</th>
        </thead>
        <tbody>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Yoyo</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">2^{12} \\text{ CP} + 2^{25.8} \\text{ ACC}</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">2^{24.8}</span> XOR</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">[28]</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Multiple-of-8</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">2^{32}</span> CP</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">2^{35.6} \\text{ M} \\approx 2^{29} \\text{ E}</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">[21]</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Truncated Variance Differential</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">2^{34}</span> CP</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">2^{37.6} \\; \\mathrm{M} \\approx 2^{31} \\; \\mathrm{E}</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Sect. 8.1</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Truncated Mean Differential</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">2^{48.96} \\text{ CP}</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">\\mathbf{2^{52.6}~M} \\approx \\mathbf{2^{46}~E}</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Sect. 8.3</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Prob. Mixture Differential</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">2^{52}</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">2^{71.5} \\text{ M} \\approx 2^{64.9} \\text{ E}</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">[20]</td>
          </tr>
        </tbody>
      </table>
    </div>

    <p class="text-gray-300">    <img src="_page_21_Figure_2.jpeg" alt="" class="my-4 max-w-full" />
</p>

    <p class="text-gray-300"><strong>Fig. 3.</strong> Ratio between the variance for 5-round AES and for the case of a random permutation given texts in  <span class="math">\\mathbb{F}_{2^n}^{4\\times 4}</span>  for  <span class="math">n\\geq 3</span> .</p>

      <h3 id="sec-8.1" class="text-xl font-semibold mt-8">8.1 Truncated Differential Distinguisher based on the Variance</h3>

    <p class="text-gray-300">Since the variance of the AES case is different from the one of the random case independently of the secret-key, we can exploit this fact in order to set up a new secret-key distinguisher for 5-round AES.</p>

    <p class="text-gray-300">We practically tested this distinguisher on a small-scale AES. By practical tests (the following probability of success have been computed over  <span class="math">2\\,500</span>  tests) on small-scale AES:</p>

    <ul class="list-disc list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li>given a single initial coset of  <span class="math">\\mathcal{D}_i</span> , it is possible to distinguish small-scale AES from a random permutation with probability 98%;</li>
      <li>given two initial cosets of  <span class="math">\\mathcal{D}_i</span> , it is possible to distinguish small-scale AES from a random permutation with probability 99.9%.</li>
    </ul>

    <p class="text-gray-300">Note that for each initial coset of  <span class="math">\\mathcal{D}_i</span> , it is possible to compute the number of collisions with respect to four different anti-diagonals, or equivalently four different subspaces  <span class="math">\\mathcal{ID}_J</span> . We emphasize that the goal is not to compute the exact value of the variance for the two cases, but just to distinguish the two permutations.</p>

    <p class="text-gray-300">Since the ratio between the variances for full-size 5-round AES and for a random permutation  <span class="math">\\Pi</span>  is similar to the same ratio for the case of small-scale</p>

    <p class="text-gray-300">Data:  <span class="math">2^{32}</span>  (plaintext, ciphertext) pairs  <span class="math">(p^i,c^i)</span>  for  <span class="math">i=0,\\dots,2^{32}-1</span>  with one active diagonal (eq., in a coset of a diagonal subspace  <span class="math">\\mathcal{D}_I</span>  with |I|=1). Result: Number n of pairs of ciphertexts which are equal in the j-th anti-diagonal (equivalently, that belong in the same coset of  <span class="math">\\mathcal{ID}_J</span>  where  <span class="math">J \\equiv \\{0,1,2,3\\} \\setminus j</span> )</p>

    <p class="text-gray-300">Let  <span class="math">A[0,\\dots,2^{32}-1]</span>  an array initialized to zero; for i from 0 to  <span class="math">2^{32}-1</span>  do  <span class="math">\\begin{vmatrix} x \\leftarrow \\sum_{k=0}^3 c_{k,j-k}^i \\cdot 256^k; &amp; // c_{k,j-k}^i \\text{ denotes the byte of } c^i \\text{ in row } k \\\\ \\text{and column } j-k \\mod 4 \\\\ A[x] \\leftarrow A[x]+1; &amp; // A[x] \\text{ denotes the value stored in the } x\\text{-th} \\\\ \\text{address of the array } A \\end{vmatrix}</span> \\nend  <span class="math">n \\leftarrow \\sum_{i=0}^{2^{32}-1} A[i] \\cdot (A[i]-1)/2; &amp; // n \\equiv \\text{Number of Collisions}</span> return n.</p>

    <p class="text-gray-300"><strong>Algorithm 1:</strong> Secret-Key Distinguisher for 5 Rounds of AES. It returns the number of pairs of ciphertexts which are equal in the j-th anti-diagonal (eq., the number of collisions in the same coset of  <span class="math">\\mathcal{ID}_J</span>  such that  <span class="math">J \\equiv \\{0, 1, 2, 3\\} \\setminus j</span> ).</p>

    <p class="text-gray-300">AES (see Fig. 3), that is,</p>

    <p class="text-gray-300"><span class="math">$\\frac{{\\rm Var}({\\rm AES^{8\\text{-}bit}})}{{\\rm Var}(\\Pi^{8\\text{-}bit})} \\simeq \\frac{2^{36.161}}{2^{31}} \\approx 35.8 \\qquad \\textit{versus} \\qquad \\frac{{\\rm Var}({\\rm AES^{4\\text{-}bit}})}{{\\rm Var}(\\Pi^{4\\text{-}bit})} \\simeq \\frac{2^{20.035}}{2^{15}} \\approx 32.8 \\,,</span>$</p>

    <p class="text-gray-300">we conjecture that the results obtained for the small-scale AES are applicable as well to full-size AES. That is, due to the relation between small-scale AES and full-size AES, we conjecture that the same number of initial cosets (namely, two) is sufficient to distinguish (full-size) AES from a random permutation (using this distinguisher based on the variance). However, just to have more confidence, we recommend 4 initial cosets in order to set up the distinguisher, for a data cost of  <span class="math">4 \\cdot 2^{32} = 2^{34}</span>  chosen plaintexts distributed in 4 initial cosets of  <span class="math">\\mathcal{D}_i</span> . The computational cost is well approximated by the cost to compute the number of collisions. Using Algorithm 1, the cost is well approximated by 4 (initial cosets)  <span class="math">\\times 4</span>  (anti-diagonals)  <span class="math">\\times 3 \\cdot 2^{32}</span>  (table look-ups)  <span class="math">\\approx 2^{37.6}</span>  table look-ups, that is, approximately  <span class="math">2^{31}</span>  five-round encryptions.</p>

    <p class="text-gray-300">For some concrete use cases (e.g., for setting up a truncated differential distinguisher based on the mean), we propose an approximation of the probability distribution for 5-round AES given in Theorem 4. In particular, we propose a normal approximation that can turn out to be (very) useful in all applications where the skewness does <em>not</em> play a crucial role (hence, that are (almost) independent of the bias in the skew).</p>

    <p class="text-gray-300">As given in Theorem 4, the probability distribution for 5-round AES is well described by  <span class="math">\\mathfrak{D}_{5\\text{-AES}} = 2^3 \\times \\mathfrak{B}(n_3, p_3) + 2^{10} \\times \\mathfrak{B}(n_{10}, p_{10}) + 2^{17} \\times \\mathfrak{B}(n_{17}, p_{17}),</span></p>

    <p class="text-gray-300">where  <span class="math">\\mathfrak{B}(n,p)</span>  are binomial distributions. De Moivre-Laplace Theorem claims that the normal distribution is a good approximation of the binomial one if the skewness of the binomial distribution is close to zero. In our case,  <span class="math">\\mathfrak{B}_3 \\equiv \\mathfrak{B}(n_3, p_3)</span>  and  <span class="math">\\mathfrak{B}_{10} \\equiv \\mathfrak{B}(n_{10}, p_{10})</span>  can be well approximated by a normal distribution, since their skewnesses are close to zero (skew( <span class="math">\\mathfrak{B}_3</span> )  <span class="math">\\approx 2^{-14}</span>  and skew( <span class="math">\\mathfrak{B}_{10}</span> )  <span class="math">\\approx 2^{-7.5}</span> ). Unfortunately, this is not the case of  <span class="math">\\mathfrak{B}_{17} \\equiv \\mathfrak{B}(n_{17}, p_{17})</span> , since skew( <span class="math">\\mathfrak{B}_{17}</span> )  <span class="math">\\approx 0.813 \\approx 2^{-0.3}</span> . On the other hand, the number of pairs represented by  <span class="math">X_{17}</span>  (that is, the pairs of texts with two equal generating variables) is very small compared to the number of all possible pairs of texts, precisely  <span class="math">\\frac{3 \\cdot 2^{15} \\cdot (2^8 - 1)^2}{2^{31} \\cdot (2^{32} - 1)} \\approx 2^{-30.4} \\approx 10^{-7.15} \\%</span> . For this reason, and only in the case in which the skewness does not play a crucial role, we can approximate such binomial distribution with a normal one as well.</p>

    <p class="text-gray-300">By exploiting the fact that the sum of normally distributed random variables is also normally distributed, that is, if  <span class="math">X \\sim \\mathfrak{N}(\\mu_X, \\sigma_X^2)</span>  and  <span class="math">Y \\sim \\mathfrak{N}(\\mu_Y, \\sigma_Y^2)</span> , then  <span class="math">X + Y \\sim \\mathfrak{N}(\\mu_X + \\mu_Y, \\sigma_X^2 + \\sigma_Y^2)</span> , we get the following approximation:</p>

    <p class="text-gray-300"><strong>Lemma 1.</strong> Consider an AES-like cipher that works with texts in  <span class="math">\\mathbb{F}_{2^8}^{4\\times 4}</span>  and for which the assumptions of Theorem 4 hold.</p>

    <p class="text-gray-300">Consider  <span class="math">2^{32}</span>  plaintexts  <span class="math">\\{p^i\\}_{i\\in\\{0,1,\\dots,2^{32}-1\\}}</span>  with one active diagonal (equivalently, a coset of a diagonal space  <span class="math">\\mathcal{D}_i</span>  for  <span class="math">i\\in\\{0,1,2,3\\}</span> ), and the corresponding ciphertexts after 5 rounds without the final MixColumns operation, that is,  <span class="math">c^i=R_f^5(p^i)</span> . The probability distribution of the number of different pairs of ciphertexts  <span class="math">(c^h,c^j)</span>  for  <span class="math">h\\neq j</span>  that are equal in one anti-diagonal (equivalently, that belong to the same coset of  <span class="math">\\mathcal{ID}_J</span>  for  <span class="math">J\\subseteq\\{0,1,2,3\\}</span>  fixed with |J|=3) is approximated by a normal distribution  <span class="math">\\mathfrak{N}(\\mu,\\sigma^2)</span> , where the mean value is equal to  <span class="math">\\mu=2147\\,484\\,685.6=2^{32}+1\\,037.6</span>  and the standard deviation is equal to  <span class="math">\\sigma=277\\,204.426</span> .</p>

    <p class="text-gray-300">In other words, given  <span class="math">2^{32}</span>  plaintexts with one active diagonal, the probability distribution of the number of collisions of the corresponding ciphertexts for 5-round AES is well approximated by  <span class="math">8 \\times X</span> , where X is a normal distribution with mean value and variance as given in Lemma 1. That is, the (discrete) probability to have  <span class="math">n \\in \\mathbb{N}</span>  collisions is given by:</p>

    <p class="text-gray-300"><span class="math">$\\operatorname{Prob}(\\mathfrak{D}_{5\\text{-AES}} = n \\mid \\mu, \\sigma^2) \\approx \\begin{cases} 0 &amp; \\text{if } n \\bmod 8 \\neq 0 \\\\ \\frac{8}{\\sqrt{2 \\cdot \\pi \\cdot \\sigma^2}} \\cdot e^{-\\frac{(n-\\mu)^2}{2 \\cdot \\sigma^2}} &amp; \\text{otherwise} \\end{cases}</span>$</p>

    <p class="text-gray-300">About the factor 8 in the probability  <span class="math">\\operatorname{Prob}(n \\mid \\mu, \\sigma^2)</span> . Let  <span class="math">\\operatorname{Prob}(n)</span>  be the probability to have n collisions for 5-round AES. Since  <span class="math">\\operatorname{Prob}(n \\neq 8 \\cdot n&#x27;) = 0</span> , the factor 8 guarantees that the total probability is equal to 1:</p>

    <p class="text-gray-300"><span class="math">$\\sum_{n} \\text{Prob}(n) = \\sum_{n=8 \\cdot n&#x27;} \\frac{8}{\\sqrt{2 \\cdot \\pi \\cdot \\sigma^2}} \\cdot e^{-\\frac{(n-\\mu)^2}{2 \\cdot \\sigma^2}} = \\sum_{n&#x27;} \\frac{1}{\\sqrt{2 \\cdot \\pi \\cdot (\\sigma/8)^2}} \\cdot e^{-\\frac{(n&#x27; - (\\mu/8))^2}{2 \\cdot (\\sigma/8)^2}} = 1.</span>$</p>

      <h3 id="sec-8.3" class="text-xl font-semibold mt-8">8.3 Truncated Differential Distinguisher based on the Mean</h3>

    <p class="text-gray-300">Using the previous results, we are now able to present and set up a new distinguisher based on the average mean of the presented truncated differential trails for 5-round AES. As we have just seen, the number of collisions for 5-round AES and for the random permutation can be described by normal distributions. For deriving concrete numbers for our distinguisher, we can simply consider the difference of the two distributions, which is again a normal distribution. That is, given  <span class="math">X \\sim \\mathfrak{N}(\\mu_1, \\sigma_1^2)</span>  and  <span class="math">Y \\sim \\mathfrak{N}(\\mu_2, \\sigma_2^2)</span> , then  <span class="math">X - Y \\sim \\mathfrak{N}(\\mu, \\sigma^2) = \\mathfrak{N}(\\mu_1 - \\mu_2, \\sigma_1^2 + \\sigma_2^2)</span> . As a result, the mean  <span class="math">\\mu</span>  and the variance  <span class="math">\\sigma^2</span>  of the difference between the AES and the random distributions are</p>

    <p class="text-gray-300"><span class="math">$\\mu = |\\mu_{AES} - \\mu_{rand}| = n \\cdot |p_{AES} - p_{rand}|,</span>$</p>

    <p class="text-gray-300"><span class="math">$\\sigma^2 = \\sigma_{rand}^2 + \\sigma_{AES}^2 = n \\cdot (p_{rand} \\cdot (1 - p_{rand}) + 35.593 \\cdot p_{AES} \\cdot (1 - p_{AES})),</span>$</p>

    <p class="text-gray-300">where we make used of the approximation  <span class="math">\\sigma_{AES}^2 \\approx 35.593 \\cdot n \\cdot p_{AES} \\cdot (1-p_{AES})</span>  introduced in Sect. 8.1. Since the probability density of the normal distribution is  <span class="math">f(x \\mid \\mu, \\sigma^2) = \\frac{1}{\\sigma \\sqrt{2\\pi}} \\, e^{-\\frac{(x-\\mu)^2}{2\\sigma^2}}</span> , it follows that</p>

    <p class="text-gray-300"><span class="math">$\\operatorname{prob} = \\int_{-\\infty}^{0} \\frac{1}{\\sigma\\sqrt{2\\pi}} e^{-\\frac{(x-\\mu)^2}{2\\sigma^2}} dx = \\frac{1}{2} \\left( 1 + \\operatorname{erf}\\left(\\frac{-\\mu}{\\sigma\\sqrt{2}}\\right) \\right)</span>$</p>

    <p class="text-gray-300">where  <span class="math">\\operatorname{erf}(x)</span>  is the error function, defined as the probability of a random variable with normal distribution of mean 0 and variance 1/2 falling in the range [-x, x]. We emphasize that the integral is computed in the range  <span class="math">(-\\infty, 0]</span>  since we are interested only in the case in which the average number of pairs with the required property in the random case is smaller than in the AES case.</p>

    <p class="text-gray-300">In order to have a probability of success bigger than &quot;prob&quot;, n must satisfy</p>

    <p class="text-gray-300"><span class="math">$n \\ge \\frac{73.186 \\cdot \\max(p_{rand}, p_{AES})}{(p_{rand} - p_{AES})^2} \\cdot \\left(\\text{erfinv}(2 \\cdot \\text{prob} - 1)\\right)^2.</span>$
(21)</p>

    <p class="text-gray-300">It follows that in order to have a probability of success bigger than 95%, the number of pairs must satisfy  <span class="math">n \\geq 2^{78.374}</span>  and since  <span class="math">p_{rand} \\approx p_{AES} \\approx 2^{-30}</span>  and  <span class="math">|p_{rand} - p_{AES}| \\approx 2^{-50.98}</span> . Given  <span class="math">2^{32}</span>  chosen plaintexts with one active diagonal (equivalently, a coset of a diagonal space  <span class="math">\\mathcal{D}_i</span> ), it is possible to construct approximately  <span class="math">2^{63}</span>  different pairs of texts, which means that the distinguisher requires  <span class="math">2^{15.374}</span>  different cosets for a data cost of  <span class="math">2^{47.374}</span>  chosen plaintexts.</p>

    <p class="text-gray-300">Practical Results on small-scale AES. Since the previous result has been obtained under the assumption that the distribution of AES is well approximated by a normal distribution, we practically tested the probability of success of such distinguisher on a small-scale AES. Using the same computation as before, it turns out that for small-scale AES for which</p>

    <p class="text-gray-300"><span class="math">$\\mu_{AES^{4\\text{-bit}}} = n \\cdot p_{AES^{4\\text{-bit}}} \\quad \\text{ and } \\quad \\sigma_{AES^{4\\text{-bit}}}^2 = 29.983 \\cdot n \\cdot p_{AES^{4\\text{-bit}}} \\cdot \\left(1 - p_{AES^{4\\text{-bit}}}\\right),</span>$</p>

    <p class="text-gray-300">one needs</p>

    <p class="text-gray-300"><span class="math">$n &gt; \\frac{59.965 \\cdot \\max(p_{rand^{4\\text{-bit}}}, \\, p_{AES^{4\\text{-bit}}})}{(p_{rand^{4\\text{-bit}}} - p_{AES^{4\\text{-bit}}})^2} \\cdot \\left(\\text{erfinv}\\big(2 \\cdot \\text{prob} - 1\\big)\\right)^2.</span>$</p>

    <p class="text-gray-300">different pairs of texts to set up the distinguisher with probability &quot;prob&quot;. For a probability of success bigger than 95% and since  <span class="math">p_{rand^{4\\text{-bit}}} \\approx p_{AES^{4\\text{-bit}}} \\approx 2^{-14}</span>  and  <span class="math">|p_{rand^{4\\text{-bit}}} - p_{AES^{4\\text{-bit}}}| \\approx 2^{-22.68485}</span> , the number of pairs must satisfy  <span class="math">n \\geq 2^{37.48}</span> . Since each coset of  <span class="math">\\mathcal{D}_i</span>  contains  <span class="math">2^{16}</span>  different texts and approximately  <span class="math">2^{31}</span>  different pairs, this means that the distinguisher requires  <span class="math">2^{6.48} \\simeq 90</span>  cosets for a data cost of  <span class="math">2^{22.48}</span>  chosen plaintexts. By practical tests on small-scale AES:</p>

    <ul class="list-disc list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li>90 initial cosets of  <span class="math">\\mathcal{D}_i</span>  allows to distinguish small-scale AES from a random permutation with probability 92% (close to 95% used before);</li>
      <li>180 initial cosets of  <span class="math">\\mathcal{D}_i</span>  allows to distinguish small-scale AES from a random permutation with probability 98.5%;</li>
      <li>270 initial cosets of  <span class="math">\\mathcal{D}_i</span>  allows to distinguish small-scale AES from a random permutation with probability 99.9%;</li>
    </ul>

    <p class="text-gray-300">where the previous probability of success have been computed over 2500 tests. The fact that the probability of success is a little smaller than expected is justified by the use of the normal approximation for the AES probability distribution.</p>

    <p class="text-gray-300">Based on these practical results, due to the similarity between small-scale AES and AES (e.g., the value of the skewness is similar for these two cases &ndash; see Sect. 7) and just to have more confidence, we recommend  <span class="math">3 \\cdot 2^{15.375} = 2^{16.96}</span>  initial cosets of  <span class="math">\\mathcal{D}_j</span>  in order to set up the distinguisher for AES, for a data cost of  <span class="math">2^{16.96} \\cdot 2^{32} = 2^{48.96}</span>  chosen plaintexts.</p>

    <p class="text-gray-300">Data and Computational Costs. As we have just seen,  <span class="math">2^{48.96}</span>  chosen plaintexts (that is,  <span class="math">2^{16.96}</span>  cosets of a diagonal subspace  <span class="math">\\mathcal{D}_i</span>  for  <span class="math">i \\in \\{0,1,2,3\\}</span> ) are sufficient to distinguish a random permutation from 5 rounds of AES. Using Algorithm 1, the total computational cost can be well approximated by  <span class="math">2^{52.6}</span>  table look-ups, or equivalently  <span class="math">2^{46}</span>  five-round encryptions of AES (using the approximation &ndash; largely used in the literature &ndash; 20 table look-ups  <span class="math">\\approx 1</span>  round of AES).</p>

    <p class="text-gray-300">Acknowledgements. This work was accomplished when L. Grassi was at IAIK, Graz University of Technology, Austria. Authors thank also anonymous reviewers for their valuable comments and suggestions. Authors thank Matthias Niel for implementing on C/C++ the truncated differential distinguishers on 6- and 8-bit AES presented in this paper. Authors also thank Anne Canteaut for pointing out the constant of the ratio between the variances for 5-round AES and for a random permutation given in Fig. 3. L. Grassi is currently supported by the European Research Council under the ERC advanced grant agreement under grant ERC-2017-ADG Nr. 788980 ESCADA.</p>

    </section>

    <section id="references" class="mb-10">
      <h2 class="text-2xl font-bold">References</h2>

    <ul class="space-y-2 text-gray-400 text-sm list-none">
      <li><ul class="space-y-2 text-gray-400 text-sm list-none">
      <li>M. R. Albrecht, B. Driessen, E. B. Kavun, G. Leander, C. Paar, and T. Yal&cedil;c&#305;n, &quot;Block Ciphers - Focus on the Linear Layer (feat. PRIDE),&quot; in CRYPTO 2014, ser. LNCS, vol. 8616, 2014, pp. 57&ndash;76.</li>
    </ul></li>
      <li><ul class="space-y-2 text-gray-400 text-sm list-none">
      <li>S. Banik, A. Bogdanov, T. Isobe, K. Shibutani, H. Hiwatari, T. Akishita, and F. Regazzoni, &quot;Midori: A Block Cipher for Low Energy,&quot; in ASIACRYPT 2015, ser. LNCS, vol. 9453, 2015, pp. 411&ndash;436.</li>
    </ul></li>
      <li><ul class="space-y-2 text-gray-400 text-sm list-none">
      <li>Z. Bao, J. Guo, and E. List, &quot;Extended Truncated-differential Distinguishers on Round-reduced AES,&quot; IACR Trans. Symmetric Cryptol., vol. 2020, no. 3, pp. 197&ndash; 261, 2020.</li>
    </ul></li>
      <li><ul class="space-y-2 text-gray-400 text-sm list-none">
      <li>A. Bar-On, O. Dunkelman, N. Keller, E. Ronen, and A. Shamir, &quot;Improved Key Recovery Attacks on Reduced-Round AES with Practical Data and Memory Complexities,&quot; in CRYPTO 2018, ser. LNCS, vol. 10992, 2018, pp. 185&ndash;212.</li>
    </ul></li>
      <li><ul class="space-y-2 text-gray-400 text-sm list-none">
      <li>N. G. Bardeh and S. R&oslash;njom, &quot;The Exchange Attack: How to Distinguish 6 Rounds of AES with 2<sup>88</sup>.<sup>2</sup> chosen plaintexts,&quot; in ASIACRYPT 2019, ser. LNCS, vol. 11923, 2019, pp. 347&ndash;370.</li>
    </ul></li>
      <li><ul class="space-y-2 text-gray-400 text-sm list-none">
      <li>E. Biham, A. Biryukov, and A. Shamir, &quot;Cryptanalysis of Skipjack Reduced to 31 Rounds Using Impossible Differentials,&quot; in EUROCRYPT 1999, ser. LNCS, vol. 1592, 1999, pp. 12&ndash;23.</li>
    </ul></li>
      <li><ul class="space-y-2 text-gray-400 text-sm list-none">
      <li>E. Biham and N. Keller, &quot;Cryptanalysis of Reduced Variants of Rijndael,&quot; 2001, unpublished, http://csrc.nist.gov/archive/aes/round2/conf3/papers/35-ebiham.pdf.</li>
    </ul></li>
      <li><ul class="space-y-2 text-gray-400 text-sm list-none">
      <li>E. Biham and A. Shamir, &quot;Differential cryptanalysis of DES-like cryptosystems,&quot; Journal of Cryptology, vol. 4, no. 1, pp. 3&ndash;72, Jan 1991.</li>
    </ul></li>
      <li><ul class="space-y-2 text-gray-400 text-sm list-none">
      <li>C. Blondeau, G. Leander, and K. Nyberg, &quot;Differential-Linear Cryptanalysis Revisited,&quot; Journal of Cryptology, vol. 30, no. 3, pp. 859&ndash;888, 2017.</li>
    </ul></li>
      <li><ul class="space-y-2 text-gray-400 text-sm list-none">
      <li>A. Bogdanov, L. R. Knudsen, G. Leander, C. Paar, A. Poschmann, M. J. B. Robshaw, Y. Seurin, and C. Vikkelsoe, &quot;PRESENT: An Ultra-Lightweight Block Cipher,&quot; in CHES 2007, ser. LNCS, vol. 4727, 2007, pp. 450&ndash;466.</li>
    </ul></li>
      <li><ul class="space-y-2 text-gray-400 text-sm list-none">
      <li>J. Borghoff, A. Canteaut, T. G&uml;uneysu, E. B. Kavun, M. Knezevic, L. R. Knudsen, G. Leander, V. Nikov, C. Paar, C. Rechberger, P. Rombouts, S. S. Thomsen, and T. Yal&cedil;c&#305;n, &quot;PRINCE &ndash; A Low-Latency Block Cipher for Pervasive Computing Applications,&quot; in ASIACRYPT 2012, ser. LNCS, vol. 7658, 2012, pp. 208&ndash;225.</li>
    </ul></li>
      <li><ul class="space-y-2 text-gray-400 text-sm list-none">
      <li>C. Boura, A. Canteaut, and D. Coggia, &quot;A General Proof Framework for Recent AES Distinguishers,&quot; IACR Trans. Symmetric Cryptol., vol. 2019, no. 1, pp. 170&ndash; 191, 2019.</li>
    </ul></li>
      <li><ul class="space-y-2 text-gray-400 text-sm list-none">
      <li>C. Cid, S. Murphy, and M. J. B. Robshaw, &quot;Small Scale Variants of the AES,&quot; in FSE 2005, ser. LNCS, vol. 9054, 2005, pp. 145&ndash;162.</li>
    </ul></li>
      <li><ul class="space-y-2 text-gray-400 text-sm list-none">
      <li>J. Daemen, L. R. Knudsen, and V. Rijmen, &quot;The Block Cipher Square,&quot; in FSE 1997, ser. LNCS, vol. 1267, 1997, pp. 149&ndash;165.</li>
    </ul></li>
      <li><ul class="space-y-2 text-gray-400 text-sm list-none">
      <li>J. Daemen, M. Peeters, G. V. Assche, and V. Rijmen, &quot;Nessie proposal: the block cipher Noekeon,&quot; Nessie submission, 2000, http://gro.noekeon.org/.</li>
    </ul></li>
      <li><ul class="space-y-2 text-gray-400 text-sm list-none">
      <li>J. Daemen and V. Rijmen, The Design of Rijndael: AES The Advanced Encryption Standard, ser. Information Security and Cryptography. Springer, 2002.</li>
    </ul></li>
      <li><ul class="space-y-2 text-gray-400 text-sm list-none">
      <li>&mdash;&mdash;, &quot;Security of a Wide Trail Design,&quot; in INDOCRYPT 2002, ser. LNCS, vol. 2551, 2002, pp. 1&ndash;11.</li>
    </ul></li>
      <li><ul class="space-y-2 text-gray-400 text-sm list-none">
      <li>Z. Gong, S. Nikova, and Y. W. Law, &quot;KLEIN: A New Family of Lightweight Block Ciphers,&quot; in RFID 2011, ser. LNCS, vol. 7055, 2012, pp. 1&ndash;18.</li>
    </ul></li>
      <li><ul class="space-y-2 text-gray-400 text-sm list-none">
      <li>L. Grassi, &quot;Mixture Differential Cryptanalysis: a New Approach to Distinguishers and Attacks on round-reduced AES,&quot; IACR Trans. Symmetric Cryptol., vol. 2018, no. 2, pp. 133&ndash;160, 2018.</li>
    </ul></li>
      <li><ul class="space-y-2 text-gray-400 text-sm list-none">
      <li>&mdash;&mdash;, &quot;Probabilistic Mixture Differential Cryptanalysis on Round-Reduced AES,&quot; in SAC 2019, ser. LNCS, vol. 11959, 2019, pp. 53&ndash;84.</li>
    </ul></li>
      <li><ul class="space-y-2 text-gray-400 text-sm list-none">
      <li>L. Grassi, C. Rechberger, and S. R&oslash;njom, &quot;A New Structural-Differential Property of 5-Round AES,&quot; in EUROCRYPT 2017, ser. LNCS, vol. 10211, 2017, pp. 289&ndash; 317.</li>
    </ul></li>
      <li><ul class="space-y-2 text-gray-400 text-sm list-none">
      <li>&mdash;&mdash;, &quot;Subspace Trail Cryptanalysis and its Applications to AES,&quot; IACR Trans. Symmetric Cryptol., vol. 2016, no. 2, pp. 192&ndash;225, 2017.</li>
    </ul></li>
      <li><ul class="space-y-2 text-gray-400 text-sm list-none">
      <li>L. R. Knudsen, &quot;Truncated and higher order differentials,&quot; in FSE 1994, ser. LNCS, vol. 1008, 1995, pp. 196&ndash;211.</li>
    </ul></li>
      <li><ul class="space-y-2 text-gray-400 text-sm list-none">
      <li>X. Lai, Higher Order Derivatives and Differential Cryptanalysis. Springer US, 1994, pp. 227&ndash;233.</li>
    </ul></li>
      <li><ul class="space-y-2 text-gray-400 text-sm list-none">
      <li>G. Leander and A. Poschmann, &quot;On the Classification of 4 Bit S-Boxes,&quot; in Arithmetic of Finite Fields - WAIFI 2007, ser. LNCS, vol. 4547, 2007, pp. 159&ndash;176.</li>
    </ul></li>
      <li><ul class="space-y-2 text-gray-400 text-sm list-none">
      <li>K. Nyberg, &quot;Perfect nonlinear S-boxes,&quot; in EUROCRYPT 1991, ser. LNCS, vol. 547, 1991, pp. 378&ndash;386.</li>
    </ul></li>
      <li><ul class="space-y-2 text-gray-400 text-sm list-none">
      <li>J. Patarin, &quot;Generic Attacks for the Xor of k Random Permutations,&quot; in ACNS 2013, ser. LNCS, vol. 7954, 2013, pp. 154&ndash;169.</li>
    </ul></li>
      <li><ul class="space-y-2 text-gray-400 text-sm list-none">
      <li>S. R&oslash;njom, N. G. Bardeh, and T. Helleseth, &quot;Yoyo Tricks with AES,&quot; in ASI-ACRYPT 2017, ser. LNCS, vol. 10624, 2017, pp. 217&ndash;243.</li>
    </ul></li>
      <li><ul class="space-y-2 text-gray-400 text-sm list-none">
      <li>W. Zhang, Z. Bao, D. Lin, V. Rijmen, B. Yang, and I. Verbauwhede, &quot;RECTAN-GLE: a bit-slice lightweight block cipher suitable for multiple platforms,&quot; Science China Information Sciences, vol. 58, no. 12, pp. 1&ndash;15, Dec 2015.</li>
    </ul></li>
    </ul>

    </section>

    <section id="app-a" class="mb-10">
      <h2 class="text-2xl font-bold">A Subspace Trail for AES &ndash; Details</h2>

    <p class="text-gray-300">The concept of trails of subspaces has been introduced in [22] as a generalization of invariant subspace trails.</p>

    <p class="text-gray-300">Definition 4. Let F denote a round function in an iterative block cipher and let (V1, V2, . . . , Vr+1) denote a set of r + 1 subspaces with dim(Vi) &le; dim(Vi+1). If for each i &isin; {1, . . . , r} and for each a<sup>i</sup> there exists ai+1 such that F(V<sup>i</sup> &oplus;ai) &sube; Vi+1 &oplus; ai+1, then (V1, V2, . . . , Vr+1) is subspace trail of length r for the function F.</p>

    <p class="text-gray-300">Here we briefly recall the subspace trails of AES presented in [22]. As already recalled in Sect. 3.1, for each i &isin; {0, 1, 2, 3}:</p>

    <ul class="list-disc list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li>The column spaces C<sup>i</sup> are defined as C<sup>i</sup> = he0,i, e1,i, e2,i, e3,ii.</li>
      <li>The diagonal spaces D<sup>i</sup> are defined as D<sup>i</sup> = SR<sup>&minus;</sup><sup>1</sup> (Ci). Similarly, the inversediagonal spaces ID<sup>i</sup> are defined as ID<sup>i</sup> = SR(Ci).</li>
      <li>The i-th mixed spaces M<sup>i</sup> are defined as M<sup>i</sup> = MC(IDi).</li>
    </ul>

    <p class="text-gray-300">For I &sube; {0, 1, 2, 3}, let C<sup>I</sup> , D<sup>I</sup> , ID<sup>I</sup> and M<sup>I</sup> be defined as</p>

    <p class="text-gray-300"><span class="math">$C_I = \\bigoplus_{i \\in I} C_i</span>$
,  <span class="math">D_I = \\bigoplus_{i \\in I} D_i</span> ,  <span class="math">D_I = \\bigoplus_{i \\in I} D_i</span> ,  <span class="math">D_I = \\bigoplus_{i \\in I} D_i</span> ,</p>

    <p class="text-gray-300">Concrete examples are the following:</p>

    <p class="text-gray-300">&bull;  <span class="math">C_0</span>  corresponds to the symbolic matrix</p>

    <p class="text-gray-300"><span class="math">$\\mathcal{C}_{0} = \\left\\{ \\begin{bmatrix} x_{1} &amp; 0 &amp; 0 &amp; 0 \\\\ x_{2} &amp; 0 &amp; 0 &amp; 0 \\\\ x_{3} &amp; 0 &amp; 0 &amp; 0 \\\\ x_{4} &amp; 0 &amp; 0 &amp; 0 \\end{bmatrix} \\middle| \\forall x_{1}, x_{2}, x_{3}, x_{4} \\in \\mathbb{F}_{2^{8}} \\right\\} \\equiv \\begin{bmatrix} x_{1} &amp; 0 &amp; 0 &amp; 0 \\\\ x_{2} &amp; 0 &amp; 0 &amp; 0 \\\\ x_{3} &amp; 0 &amp; 0 &amp; 0 \\\\ x_{4} &amp; 0 &amp; 0 &amp; 0 \\end{bmatrix};</span>$</p>

    <p class="text-gray-300">&bull;  <span class="math">\\mathcal{D}_0</span>  and  <span class="math">\\mathcal{I}\\mathcal{D}_0</span>  correspond to symbolic matrix</p>

    <p class="text-gray-300"><span class="math">$\\mathcal{D}_0 \\equiv \\begin{bmatrix} x_1 &amp; 0 &amp; 0 &amp; 0 \\\\ 0 &amp; x_2 &amp; 0 &amp; 0 \\\\ 0 &amp; 0 &amp; x_3 &amp; 0 \\\\ 0 &amp; 0 &amp; 0 &amp; x_4 \\end{bmatrix}, \\qquad \\mathcal{ID}_0 \\equiv \\begin{bmatrix} x_1 &amp; 0 &amp; 0 &amp; 0 \\\\ 0 &amp; 0 &amp; 0 &amp; x_2 \\\\ 0 &amp; 0 &amp; x_3 &amp; 0 \\\\ 0 &amp; x_4 &amp; 0 &amp; 0 \\end{bmatrix}</span>$</p>

    <p class="text-gray-300">for all  <span class="math">x_1, x_2, x_3, x_4 \\in \\mathbb{F}_{2^8}</span> ;</p>

    <p class="text-gray-300">&bull;  <span class="math">\\mathcal{M}_0</span>  corresponds to symbolic matrix</p>

    <p class="text-gray-300"><span class="math">$\\mathcal{M}_0 \\equiv \\begin{bmatrix} 0 \\text{x} 02 \\cdot x_1 &amp; x_4 &amp; x_3 &amp; 0 \\text{x} 03 \\cdot x_2 \\\\ x_1 &amp; x_4 &amp; 0 \\text{x} 03 \\cdot x_3 &amp; 0 \\text{x} 02 \\cdot x_2 \\\\ x_1 &amp; 0 \\text{x} 03 \\cdot x_4 &amp; 0 \\text{x} 02 \\cdot x_3 &amp; x_2 \\\\ 0 \\text{x} 03 \\cdot x_1 &amp; 0 \\text{x} 02 \\cdot x_4 &amp; x_3 &amp; x_2 \\end{bmatrix}</span>$</p>

    <p class="text-gray-300">for all  <span class="math">x_1, x_2, x_3, x_4 \\in \\mathbb{F}_{2^8}</span> .</p>

    <p class="text-gray-300">As shown in detail in [22]:</p>

    <ul class="list-disc list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li>For any coset  <span class="math">\\mathcal{D}_I \\oplus a</span> , there exists a unique  <span class="math">b \\in \\mathcal{C}_I^{\\perp}</span>  such that  <span class="math">R(\\mathcal{D}_I \\oplus a) = \\mathcal{C}_I \\oplus b</span> .</li>
      <li>For any coset  <span class="math">C_I \\oplus a</span> , there exists a unique  <span class="math">b \\in \\mathcal{M}_I^{\\perp}</span>  such that  <span class="math">R(C_I \\oplus a) = \\mathcal{M}_I \\oplus b</span> .</li>
    </ul>

    <p class="text-gray-300">It follows that for each  <span class="math">I \\subseteq \\{0, 1, 2, 3\\}</span>  and for each  <span class="math">a \\in \\mathcal{D}_I^{\\perp}</span> , there exists one and only one  <span class="math">b \\in \\mathcal{M}_I^{\\perp}</span>  such that  <span class="math">R^2(\\mathcal{D}_I \\oplus a) = \\mathcal{M}_I \\oplus b</span> .</p>

    <p class="text-gray-300">Observe that if X is a subspace and if x and y are two elements of the same coset  <span class="math">X \\oplus a</span> , then  <span class="math">x \\oplus y \\in X</span> . It follows that for all  <span class="math">I \\subseteq \\{0, 1, 2, 3\\}</span> :</p>

    <p class="text-gray-300"><span class="math">$\\operatorname{Prob}(R^2(x) \\oplus R^2(y) \\in \\mathcal{M}_I \\mid x \\oplus y \\in \\mathcal{D}_I) = 1.</span>$</p>

    <p class="text-gray-300">We also recall that for each  <span class="math">I, J \\subseteq \\{0, 1, 2, 3\\}</span>  then  <span class="math">\\mathcal{M}_I \\cap \\mathcal{D}_J = \\{0\\}</span>  if and only if  <span class="math">|I| + |J| \\le 4</span> , as demonstrated in [22]. It follows that:</p>

    <p class="text-gray-300"><strong>Theorem 5</strong> ([22]). Let  <span class="math">I, J \\subseteq \\{0, 1, 2, 3\\}</span>  such that  <span class="math">|I| + |J| \\le 4</span> . For all x, y:</p>

    <p class="text-gray-300"><span class="math">$Prob(R^4(x) \\oplus R^4(y) \\in \\mathcal{M}_I \\mid x \\oplus y \\in \\mathcal{D}_J, \\quad x \\neq y) = 0.</span>$
(22)</p>

    <p class="text-gray-300">Finally, we remark that all these results can be re-described using a more &quot;classical&quot; truncated differential notation. For example, if two texts  <span class="math">t^1</span>  and  <span class="math">t^2</span>  are equal except for the bytes in the i-th diagonal for each  <span class="math">i \\in I</span> , then they belong to the same coset of  <span class="math">\\mathcal{D}_I</span> . A coset of  <span class="math">\\mathcal{D}_I</span>  corresponds to a set of  <span class="math">2^{32 \\cdot |I|}</span>  texts with |I| active diagonals. Again, two texts  <span class="math">t^1</span>  and  <span class="math">t^2</span>  belong to the same coset of  <span class="math">\\mathcal{ID}_I</span>  if the difference of the bytes that lie in the i-th anti-diagonal for each  <span class="math">i \\notin I</span>  is equal to zero. Similar considerations hold for the column space  <span class="math">\\mathcal{C}_I</span>  and the mixed space  <span class="math">\\mathcal{M}_I</span> .</p>

    </section>

    <section id="app-b" class="mb-10">
      <h2 class="text-2xl font-bold">B Probability Distribution for 5-round AES over <span class="math">(\\mathbb{F}_{2^n})^{4\\times 4}</span></h2>

    <p class="text-gray-300">Preliminary Considerations. First of all, given a coset of  <span class="math">C_i</span>  of  <span class="math">2^{4n}</span>  chosen texts with one active column, we compute the number of different pairs of texts with v equal generating variables for  <span class="math">0 \\le v \\le 3</span> . Note that given a coset of  <span class="math">C_i</span>  of  <span class="math">2^{4n}</span>  chosen plaintexts, one can construct  <span class="math">2^{4n-1} \\cdot (2^{4n}-1) \\simeq 2^{8n-1}</span>  different pairs. Among them, the number of pairs of texts with  <span class="math">0 \\le v \\le 3</span>  equal generating variables (and 4-v different generating variables) after one round is given by</p>

    <p class="text-gray-300"><span class="math">$\\binom{4}{v} \\cdot 2^{4n-1} \\cdot (2^n - 1)^{4-v} .</span>$</p>

    <p class="text-gray-300">For the follow-up:</p>

    <p class="text-gray-300"><span class="math">$n_3 = {4 \\choose 0} \\cdot 2^{4n-1} \\cdot (2^n - 1)^4,</span>$</p>

    <p class="text-gray-300"><span class="math">$n_{n+2} = {4 \\choose 1} \\cdot 2^{4n-1} \\cdot (2^n - 1)^3,</span>$</p>

    <p class="text-gray-300"><span class="math">$n_{2n+1} = {4 \\choose 2} \\cdot 2^{4n-1} \\cdot (2^n - 1)^2.</span>$</p>

      <h3 id="app-b.1" class="text-xl font-semibold mt-8"><strong>B.1</strong> Average Number of Collisions</h3>

    <p class="text-gray-300">In this section we compute the average number of collisions for 5-round AES defined over  <span class="math">(\\mathbb{F}_{2^n})^{4\\times 4}</span> . Since the idea of the proof is the same of the one given in Sect. 6, we limit ourselves to adapt it to the case of AES defined over  <span class="math">(\\mathbb{F}_{2^n})^{4\\times 4}</span> . Since</p>

    <p class="text-gray-300"><span class="math">$\\mathcal{D}_I \\oplus a&#x27; \\xrightarrow{R^2(\\cdot)} \\mathcal{M}_I \\oplus b&#x27; \\xrightarrow{R(\\cdot)} \\mathcal{D}_J \\oplus a&#x27;&#x27; \\xrightarrow{R_f^2(\\cdot)} \\mathcal{I}\\mathcal{D}_J \\oplus b&#x27;&#x27;,</span>$</p>

    <p class="text-gray-300">in the following we consider  <span class="math">2^{4n}</span>  plaintexts in the same coset of  <span class="math">\\mathcal{M}_i</span>  for  <span class="math">i \\in \\{0,1,2,3\\}</span>  and we compute the average number of collisions after one round in the same coset of  <span class="math">\\mathcal{D}_J</span>  for |J|=3 fixed. For simplicity, we limit ourselves to consider plaintexts in the same coset of  <span class="math">\\mathcal{M}_0</span>  and the diagonal space  <span class="math">\\mathcal{D}_{1,2,3}</span>  (the other cases are analogous).</p>

    <p class="text-gray-300">Case:  <span class="math">2^{2 \\cdot n}</span>  Texts with Two Equal Generating Variables. As first case, we consider the case of  <span class="math">2^{2n}</span>  plaintexts in the same coset of  <span class="math">\\mathcal{C}_{0,1} \\cap \\mathcal{M}_0</span>  (the other cases are equivalent). This is equivalent to consider texts with 2 equal generating variables, e.g.,  <span class="math">x^1 \\neq x^2</span> ,  <span class="math">y^1 \\neq y^2</span> ,  <span class="math">z^1 = z^2</span>  and  <span class="math">w^1 = w^2</span> .</p>

    <p class="text-gray-300">Thus, consider two plaintexts  <span class="math">p^1</span>  generated by  <span class="math">(x^1, y^1, 0, 0)</span>  and  <span class="math">p^2</span>  generated by  <span class="math">(x^2, y^2, 0, 0)</span>  in  <span class="math">(\\mathcal{C}_{0,1} \\cap \\mathcal{M}_0) \\oplus b&#x27;</span> . By simple computation,  <span class="math">R(p^1) \\oplus R(p^2) \\in \\mathcal{D}_{1,2,3}</span>  if four equations of the form</p>

    <p class="text-gray-300"><span class="math">$A \\cdot (\\text{S-Box}(B \\cdot x^1 \\oplus a) \\oplus \\text{S-Box}(B \\cdot x^2 \\oplus a))</span>$</p>

    <p class="text-gray-300"><span class="math">$\\oplus C \\cdot (\\text{S-Box}(D \\cdot y^1 \\oplus c) \\oplus \\text{S-Box}(D \\cdot y^2 \\oplus c)) = 0</span>$
(23)</p>

    <p class="text-gray-300">are satisfied, where A, B, C, D depend only on the MixColumns matrix definition, while a, c depend on the secret key and on the initial constant that defines the coset. Equivalently, four systems of two equations as follows must be satisfied</p>

    <p class="text-gray-300">S-Box
<span class="math">$(\\hat{x} \\oplus \\Delta_I) \\oplus</span>$
S-Box <span class="math">(\\hat{x}) = \\Delta_O</span>
S-Box <span class="math">(\\hat{y} \\oplus \\Delta&#x27;_I) \\oplus</span>  S-Box <span class="math">(\\hat{y}) = \\Delta&#x27;_O</span>  (24)</p>

    <p class="text-gray-300"><span class="math">$\\Delta_O = C^{-1} \\cdot A \\cdot \\Delta&#x27;&#x27;_O.</span>$</p>

    <p class="text-gray-300">Due to the same argumentation given in Sect. 6, the number of different (not null) solutions  <span class="math">\\{(x^1, y^1), (x^2, y^2)\\}</span>  of Eq. (24) is approximately given by</p>

    <p class="text-gray-300"><span class="math">$\\frac{1}{2} \\cdot (2^n - 1) \\cdot \\left(\\frac{2^n}{2^n - 1} \\cdot (2^n - 1)\\right)^2 = (2^n - 1) \\cdot 2^{2n - 1}</span>$</p>

    <p class="text-gray-300">independently of the details of the S-Box. Indeed, observe that given  <span class="math">\\Delta_O \\neq 0</span> , each one of the two equations (24) for small-scale AES admit  <span class="math">\\frac{2^n}{2^n-1} \\cdot (2^n-1) = 2^n</span>  different solutions  <span class="math">(\\hat{x}, \\Delta_I)</span>  &ndash; respectively,  <span class="math">(\\hat{y}, \\Delta_I&#x27;)</span>  &ndash; where  <span class="math">\\Delta_I, \\Delta_I&#x27; \\neq 0</span>  and  <span class="math">2^n/(2^n-1)</span>  is the average number of solutions. Moreover, note that there are  <span class="math">(2^n-1)</span>  values of  <span class="math">\\Delta_O \\neq 0</span>  and that the condition  <span class="math">y^1 &lt; y^2</span>  holds.</p>

    <p class="text-gray-300">Due to the same argumentation given in Sect. 6, the probability that two solutions of two different equations of the form (23) are equal is  <span class="math">(2^n \\cdot (2^n - 1))^{-1} \\cdot ((2^n - 1) \\cdot 2^{n-1})^{-1} = (2^n - 1)^{-2} \\cdot 2^{-2n+1}</span> . As a result, the number of common different (not null) solutions  <span class="math">\\{(x^1, y^1), (x^2, y^2)\\}</span>  of four equations of the form (23) is approximately given by</p>

    <p class="text-gray-300"><span class="math">$\\left( (2^n - 1) \\cdot 2^{2n-1} \\right)^4 \\cdot \\left( (2^n - 1)^{-2} \\cdot 2^{-2n+1} \\right)^3 = \\frac{2^{2n-1}}{(2^n - 1)^2}.</span>$</p>

    <p class="text-gray-300">Generic Case:  <span class="math">2^{4 \\cdot n}</span>  Texts. Next, we consider the case of  <span class="math">2^{4n}</span>  texts in a coset of  <span class="math">\\mathcal{M}_0</span> . As before, given two plaintexts  <span class="math">p^1, p^2 \\in \\mathcal{M}_0 \\oplus b&#x27;</span> , they belong to the same coset of  <span class="math">\\mathcal{D}_{1,2,3}</span>  after one round if four equations of the form</p>

    <p class="text-gray-300"><span class="math">$\\begin{split} A \\cdot (\\operatorname{S-Box}(B \\cdot x^1 \\oplus b) \\oplus \\operatorname{S-Box}(B \\cdot x^2 \\oplus b)) \\\\ \\oplus C \\cdot (\\operatorname{S-Box}(D \\cdot y^1 \\oplus d) \\oplus \\operatorname{S-Box}(D \\cdot y^2 \\oplus d)) \\\\ \\oplus E \\cdot (\\operatorname{S-Box}(F \\cdot z^1 \\oplus f) \\oplus \\operatorname{S-Box}(F \\cdot z^2 \\oplus f)) \\\\ \\oplus G \\cdot (\\operatorname{S-Box}(H \\cdot w^1 \\oplus h) \\oplus \\operatorname{S-Box}(H \\cdot w^2 \\oplus h)) = 0 \\end{split}</span>$</p>

    <p class="text-gray-300">are satisfied, where A, B, C, D, E, F, G, H depend only on the MixColumns matrix definition, while b, d, f, h depend on the secret key and on the constant that defined the initial coset. Each one of these equations is equivalent to:</p>

    <p class="text-gray-300"><span class="math">$\\begin{split} &amp; \\operatorname{S-Box}(\\hat{x} \\oplus \\Delta_I) \\oplus \\operatorname{S-Box}(\\hat{x}) = \\Delta_O \\\\ &amp; \\operatorname{S-Box}(\\hat{y} \\oplus \\Delta_I&#x27;) \\oplus \\operatorname{S-Box}(\\hat{y}) = \\Delta_O&#x27; \\\\ &amp; \\operatorname{S-Box}(\\hat{z} \\oplus \\Delta_I&#x27;&#x27;) \\oplus \\operatorname{S-Box}(\\hat{z}) = \\Delta_O&#x27;&#x27; \\\\ &amp; \\operatorname{S-Box}(\\hat{w} \\oplus \\Delta_I&#x27;&#x27;) \\oplus \\operatorname{S-Box}(\\hat{w}) = \\Delta_O&#x27;&#x27; \\end{split}</span>$</p>

    <p class="text-gray-300">together with one of the following conditions</p>

    <ul class="list-disc list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li><span class="math">\\begin{array}{l} 1. \\ \\ \\Delta_O^{&#x27;&#x27;&#x27;} = \\Delta_O^{&#x27;&#x27;} = 0 \\ \\text{and} \\ \\ \\Delta_O&#x27; = C^{-1} \\cdot A \\cdot \\Delta_O \\neq 0 \\ \\text{or analogous} \\ \\ (6 \\ \\text{possibilities}); \\\\ 2. \\ \\ \\Delta_O^{&#x27;&#x27;&#x27;} = 0, \\ \\Delta_O, \\Delta_O^{&#x27;}, \\Delta_O^{&#x27;&#x27;} \\neq 0 \\ \\text{and} \\ \\ \\Delta_O^{&#x27;&#x27;} = E^{-1} \\cdot (A \\cdot \\Delta_O \\oplus C \\cdot \\Delta_O&#x27;) \\ \\text{or analogous} \\\\ \\ \\ (4 \\ \\text{possibilities}); \\\\ 3. \\ \\ \\Delta_O, \\Delta_O^{&#x27;}, \\Delta_O^{&#x27;&#x27;}, \\Delta_O^{&#x27;&#x27;&#x27;} \\neq 0 \\ \\text{and} \\ \\ \\Delta_O^{&#x27;&#x27;&#x27;} = G^{-1} \\cdot (A \\cdot \\Delta_O \\oplus C \\cdot \\Delta_O&#x27; \\oplus E \\cdot \\Delta_O&#x27;&#x27;). \\end{array}</span></li>
    </ul>

    <p class="text-gray-300">First Condition. In the first case,  <span class="math">\\Delta_O^{&quot;}=0</span>  implies  <span class="math">\\Delta_I^{&quot;}=0</span> , and z can take each possible value (similar for w). Using the same computations as before, it follows that the average number  <span class="math">n_{2n+1}</span>  of (not null) common solutions for this case is</p>

    <p class="text-gray-300"><span class="math">$\\binom{4}{2} \\cdot (2^n)^2 \\cdot \\frac{2^{2n-1}}{(2^n-1)^2} = 3 \\cdot \\frac{2^{4n}}{(2^n-1)^2},</span>$</p>

    <p class="text-gray-300">and that the probability  <span class="math">p_{2n+1}</span>  is given by</p>

    <p class="text-gray-300"><span class="math">$p_{2n+1} = \\frac{1}{n_{2n+1}} \\cdot \\frac{3 \\cdot 2^{4n}}{(2^n - 1)^2} = \\frac{1}{(2^n - 1)^4}.</span>$</p>

    <p class="text-gray-300">Second Condition. In the second case, the number of different solutions  <span class="math">\\{(x^1, y^1, z^1, z^1, z^1, z^1, z^1, z^1, z^1, z</span>  <span class="math">\\{w\\}, \\{x^2, y^2, z^2, w\\}</span>  where  <span class="math">z^1 &lt; z^2</span>  for each fixed w is given by  <span class="math">(2^n - 1) \\cdot (2^n - 2) \\cdot (2^n - 2)</span>  <span class="math">\\frac{1}{2} \\cdot (2^n)^3 = 2^{3n} \\cdot (2^n - 1) \\cdot (2^{n-1} - 1)</span> . Moreover, the probability to have a common solution for two equations of the previous form is given by  <span class="math">(2^n \\cdot (2^n - 1))^{-2}</span> .  <span class="math">(2^{n-1} \\cdot (2^n - 1))^{-1} = (2^n - 1)^{-3} \\cdot 2^{-3n+1}</span>  under the given assumptions of the S-Box. It follows that the average number  <span class="math">n_{n+2}</span>  of (not null) common solutions for this case is</p>

    <p class="text-gray-300"><span class="math">$\\binom{4}{1} \\cdot 2^n \\cdot \\frac{(2^{n-1}-1)^4 \\cdot 2^{3n+3}}{(2^n-1)^5} = \\frac{(2^{n-1}-1)^4 \\cdot 2^{4n+5}}{(2^n-1)^5} \\,,</span>$</p>

    <p class="text-gray-300">and that the probability  <span class="math">p_{n+2}</span>  is given by</p>

    <p class="text-gray-300"><span class="math">$p_{n+2} = \\frac{1}{n_{n+2}} \\cdot \\frac{(2^{n-1} - 1)^4 \\cdot 2^{4n+5}}{(2^n - 1)^5} = \\frac{(2^{n-1} - 1)^4 \\cdot 2^4}{(2^n - 1)^8}.</span>$</p>

    <p class="text-gray-300">Third Condition. We finally consider the case  <span class="math">\\Delta_O, \\Delta_O&#x27;, \\Delta_O&#x27;&#x27;, \\Delta_O&#x27;&#x27;&#x27; \\neq 0</span> . As explained in the main text, the idea is to consider the total number of values of  <span class="math">(\\Delta_O, \\Delta_O&#x27;, \\Delta_O&#x27;&#x27;)</span>  that satisfy the equation  <span class="math">C \\cdot \\Delta_O&#x27; \\oplus A \\cdot \\Delta_O \\oplus E \\cdot \\Delta_O&#x27;&#x27; \\neq 0</span>  and such that  <span class="math">\\Delta_O \\neq 0, \\Delta&#x27;_O \\neq 0, \\Delta&#x27;&#x27;_O \\neq 0</span> . By simple computation, this number is equal to  <span class="math">(2^n - 1)^3 - (2^n - 1) \\cdot (2^n - 2) = (2^n - 1) \\cdot (2^{2n} - 3 \\cdot 2^n + 3)</span> , since  <span class="math">(2^n - 1)^3</span>  is the total number of values and  <span class="math">(2^n-1)\\cdot(2^n-2)</span>  is the number of values for which the previous equation is equal to 0 (note that if  <span class="math">C \\cdot \\Delta&#x27;_O \\oplus A \\cdot \\Delta_O = 0</span> , then the previous equation cannot be equal zero since  <span class="math">\\Delta_O^{&quot;} \\neq 0</span> ). As a result, the total number of solutions for this case is</p>

    <p class="text-gray-300"><span class="math">$\\frac{1}{2} \\cdot (2^n - 1) \\cdot (2^{2n} - 3 \\cdot 2^n + 3) \\cdot (2^n)^4 = 2^{4n - 1} \\cdot (2^n - 1) \\cdot (2^{2n} - 3 \\cdot 2^n + 3) \\,.</span>$</p>

    <p class="text-gray-300">Since the probability that  <span class="math">\\{(x^1, y^1, z^1, w^1), (x^2, y^2, z^2, w^2)\\}</span>  and  <span class="math">\\{(\\hat{x}^1, \\hat{y}^1, \\hat{z}^1, \\hat{w}^1), (\\hat{x}^2, y^2, z^2, w^2)\\}</span>  <span class="math">(\\hat{x}^2, \\hat{y}^2, \\hat{z}^2, \\hat{w}^2)</span>  is equal to  <span class="math">((2^n - 1) \\cdot 2^n)^{-3} \\cdot ((2^n - 1) \\cdot 2^{n-1})^{-1} = (2^n - 1)^{-4}</span> .</p>

    <p class="text-gray-300"><span class="math">2^{-4n+1}</span> , the average number  <span class="math">n_3</span>  of (non null) common solutions with no equal generating variables is</p>

    <p class="text-gray-300"><span class="math">$= \\frac{\\left(2^{4n-1} \\cdot (2^n - 1) \\cdot (2^{2n} - 3 \\cdot 2^n + 3)\\right)^4 \\cdot \\left((2^n - 1)^{-4} \\cdot 2^{-4n+1}\\right)^3}{(2^n - 1)^8}.</span>$</p>

    <p class="text-gray-300">Similar to before, the probability  <span class="math">p_3</span>  is given by</p>

    <p class="text-gray-300"><span class="math">$p_3 = \\frac{1}{n_3} \\cdot \\frac{2^{4n-1} \\cdot (2^{2n} - 3 \\cdot 2^n + 3)^4}{(2^n - 1)^8} = \\frac{(2^{2n} - 3 \\cdot 2^n + 3)^4}{(2^n - 1)^{12}}.</span>$</p>

    <p class="text-gray-300">Total Number of Different (not null) Common Solutions &ndash;  <span class="math">2^{4n}</span>  Texts in a Coset of  <span class="math">\\mathcal{M}_0</span> . By simple computation, given plaintexts in the same coset of  <span class="math">\\mathcal{M}_0</span> , the number of different pairs of ciphertexts that belong to the same coset of  <span class="math">\\mathcal{D}_{1,2,3}</span>  is approximately</p>

    <p class="text-gray-300"><span class="math">$\\frac{2^{4n-1} \\cdot (2^{2n} - 3 \\cdot 2^n + 3)^4}{(2^n - 1)^8} + \\frac{(2^{n-1} - 1)^4 \\cdot 2^{4n+5}}{(2^n - 1)^5} + 3 \\cdot \\frac{2^{4n}}{(2^n - 1)^2}.</span>$</p>

      <h3 id="app-b.2" class="text-xl font-semibold mt-8">B.2 Variance</h3>

    <p class="text-gray-300">As already proved, the probability distribution of 5-round AES in  <span class="math">(\\mathbb{F}_{2^n})^{4\\times 4}</span>  is well described by</p>

    <p class="text-gray-300"><span class="math">$\\mathfrak{D}_{5-AES} = 2^3 \\cdot \\mathfrak{B}_3 + 2^{n+2} \\cdot \\mathfrak{B}_{n+2} + 2^{2n+1} \\cdot \\mathfrak{B}_{2n+1}</span>$</p>

    <p class="text-gray-300">where  <span class="math">\\mathfrak{B}_i</span>  are binomial distributions. The pairs of texts with no equal generating variables are represented by  <span class="math">2^3 \\cdot \\mathfrak{B}_3</span> , the pairs of texts with 1 equal generating variable are represented by  <span class="math">2^{n+2} \\cdot \\mathfrak{B}_{n+2}</span>  and finally the pairs of texts with 2 equal generating variables are represented by  <span class="math">2^{2n+1} \\cdot \\mathfrak{B}_{2n+1}</span> . We recall that given two plaintexts with three equal generating variables, then they cannot belong to the same coset of  <span class="math">\\mathcal{D}_J</span>  for  <span class="math">|J| \\leq 3</span>  after one round.</p>

    <p class="text-gray-300">Since all the previous cases (namely,  <span class="math">\\mathfrak{B}_3</span> ,  <span class="math">\\mathfrak{B}_{n+2}</span>  and  <span class="math">\\mathfrak{B}_{2n+1}</span> ) are independent, the total variance of the probability distribution for 5-round AES case is given by</p>

    <p class="text-gray-300"><span class="math">$\\begin{split} \\operatorname{Var}(\\mathfrak{D}_{5-AES}) &amp;= \\operatorname{Var}(2^3 \\cdot \\mathfrak{B}_3) + \\operatorname{Var}(2^{n+2} \\cdot \\mathfrak{B}_{n+2}) + \\operatorname{Var}(2^{2n+1} \\cdot \\mathfrak{B}_{2n+1}) \\\\ &amp;= 2^6 \\cdot \\operatorname{Var}(\\mathfrak{B}_3) + 2^{2n+4} \\cdot \\operatorname{Var}(\\mathfrak{B}_{n+2}) + 2^{4n+2} \\cdot \\operatorname{Var}(\\mathfrak{B}_{2n+1}) + 2^{4n+2} \\cdot \\operatorname{Var}(\\mathfrak{B}_{2n+1}) + 2^{4n+2} \\cdot \\operatorname{Var}(\\mathfrak{B}_{2n+1}) + 2^{4n+2} \\cdot \\operatorname{Var}(\\mathfrak{B}_{2n+1}) + 2^{4n+2} \\cdot \\operatorname{Var}(\\mathfrak{B}_{2n+1}) + 2^{4n+2} \\cdot \\operatorname{Var}(\\mathfrak{B}_{2n+1}) + 2^{4n+2} \\cdot \\operatorname{Var}(\\mathfrak{B}_{2n+1}) + 2^{4n+2} \\cdot \\operatorname{Var}(\\mathfrak{B}_{2n+1}) + 2^{4n+2} \\cdot \\operatorname{Var}(\\mathfrak{B}_{2n+1}) + 2^{4n+2} \\cdot \\operatorname{Var}(\\mathfrak{B}_{2n+1}) + 2^{4n+2} \\cdot \\operatorname{Var}(\\mathfrak{B}_{2n+1}) + 2^{4n+2} \\cdot \\operatorname{Var}(\\mathfrak{B}_{2n+1}) + 2^{4n+2} \\cdot \\operatorname{Var}(\\mathfrak{B}_{2n+1}) + 2^{4n+2} \\cdot \\operatorname{Var}(\\mathfrak{B}_{2n+1}) + 2^{4n+2} \\cdot \\operatorname{Var}(\\mathfrak{B}_{2n+1}) + 2^{4n+2} \\cdot \\operatorname{Var}(\\mathfrak{B}_{2n+1}) + 2^{4n+2} \\cdot \\operatorname{Var}(\\mathfrak{B}_{2n+1}) + 2^{4n+2} \\cdot \\operatorname{Var}(\\mathfrak{B}_{2n+1}) + 2^{4n+2} \\cdot \\operatorname{Var}(\\mathfrak{B}_{2n+1}) + 2^{4n+2} \\cdot \\operatorname{Var}(\\mathfrak{B}_{2n+1}) + 2^{4n+2} \\cdot \\operatorname{Var}(\\mathfrak{B}_{2n+1}) + 2^{4n+2} \\cdot \\operatorname{Var}(\\mathfrak{B}_{2n+1}) + 2^{4n+2} \\cdot \\operatorname{Var}(\\mathfrak{B}_{2n+1}) + 2^{4n+2} \\cdot \\operatorname{Var}(\\mathfrak{B}_{2n+1}) + 2^{4n+2} \\cdot \\operatorname{Var}(\\mathfrak{B}_{2n+1}) + 2^{4n+2} \\cdot \\operatorname{Var}(\\mathfrak{B}_{2n+1}) + 2^{4n+2} \\cdot \\operatorname{Var}(\\mathfrak{B}_{2n+1}) + 2^{4n+2} \\cdot \\operatorname{Var}(\\mathfrak{B}_{2n+1}) + 2^{4n+2} \\cdot \\operatorname{Var}(\\mathfrak{B}_{2n+1}) + 2^{4n+2} \\cdot \\operatorname{Var}(\\mathfrak{B}_{2n+1}) + 2^{4n+2} \\cdot \\operatorname{Var}(\\mathfrak{B}_{2n+1}) + 2^{4n+2} \\cdot \\operatorname{Var}(\\mathfrak{B}_{2n+1}) + 2^{4n+2} \\cdot \\operatorname{Var}(\\mathfrak{B}_{2n+1}) + 2^{4n+2} \\cdot \\operatorname{Var}(\\mathfrak{B}_{2n+1}) + 2^{4n+2} \\cdot \\operatorname{Var}(\\mathfrak{B}_{2n+1}) + 2^{4n+2} \\cdot \\operatorname{Var}(\\mathfrak{B}_{2n+1}) + 2^{4n+2} \\cdot \\operatorname{Var}(\\mathfrak{B}_{2n+1}) + 2^{4n+2} \\cdot \\operatorname{Var}(\\mathfrak{B}_{2n+1}) + 2^{4n+2} \\cdot \\operatorname{Var}(\\mathfrak{B}_{2n+1}) + 2^{4n+2} \\cdot \\operatorname{Var}(\\mathfrak{B}_{2n+1}) + 2^{4n+2} \\cdot \\operatorname{Var}(\\mathfrak{B}_{2n+1}) + 2^{4n+2} \\cdot \\operatorname{Var}(\\mathfrak{B}_{2n+1}) + 2^{4n+2} \\cdot \\operatorname{Var}(\\mathfrak{B}_{2n+1}) + 2^{4n+2} \\cdot \\operatorname{Var}(\\mathfrak{B}_{2n+1}) + 2^{4n+2} \\cdot \\operatorname{Var}(\\mathfrak{B}_{2n+1}) + 2^{4n+2} \\cdot \\operatorname{Var}(\\mathfrak{B}_{2n+1}) + 2^{4n+2} \\cdot \\operatorname{Var}(\\mathfrak{B}_{2n+1}) + 2^{4n+2} \\cdot \\operatorname{Var}(\\mathfrak{B}_{2n+1}) + 2^{4n+2} \\cdot \\operatorname{Var}(\\mathfrak{B}_{2n+1}) + 2^{4n+2} \\cdot \\operatorname{Var}(\\mathfrak{B}_{2n+1}) + 2^{4n+2} \\cdot \\operatorname{Var}(\\mathfrak{B}_{2n+1}) + 2^{4n+2} \\cdot \\operatorname{Var}(\\mathfrak{B}_{2n+1}) + 2^{4n+2} \\cdot \\operatorname{Var}(\\mathfrak{B}_{2n+1}) + 2^{4n+2} \\cdot \\operatorname{Var}(\\mathfrak{B}_{2n+1}) + 2^{4n+2} \\cdot \\operatorname{Var}(\\mathfrak{B}_{2n+1}) + 2^{4n+2} \\cdot \\operatorname{Var}(\\mathfrak{B}_{2n+1}) + 2^{4n+2} \\cdot \\operatorname{Var}(\\mathfrak{B}_{2</span>$</p>

    <p class="text-gray-300">where  <span class="math">\\operatorname{Var}(\\alpha \\cdot X) = \\alpha^2 \\cdot \\operatorname{Var}(X)</span> . Since  <span class="math">\\mathfrak{B}_i</span>  are binomial distribution, it follows that</p>

    <p class="text-gray-300">&bull;  <span class="math">Var(\\mathfrak{B}_3)</span>  is equal to</p>

    <p class="text-gray-300"><span class="math">$\\begin{aligned} \\operatorname{Var}(\\mathfrak{B}_3) &amp;= \\frac{n_3}{2^3} \\cdot p_3 \\cdot (1 - p_3) = 2^{4n - 4} \\cdot (2^n - 1)^4 \\cdot \\frac{(2^{2n} - 3 \\cdot 2^n + 3)^4}{(2^n - 1)^{12}} \\cdot \\\\ &amp;\\cdot \\left(1 - \\frac{(2^{2n} - 3 \\cdot 2^n + 3)^4}{(2^n - 1)^{12}}\\right) \\simeq \\frac{2^{4n - 4} \\cdot (2^{2n} - 3 \\cdot 2^n + 3)^4}{(2^n - 1)^8} \\, ; \\end{aligned}</span>$</p>

    <p class="text-gray-300">&bull;  <span class="math">Var(\\mathfrak{B}_{n+2})</span>  is equal to</p>

    <p class="text-gray-300"><span class="math">$\\operatorname{Var}(\\mathfrak{B}_{n+2}) = \\frac{n_{n+2}}{2^{n+2}} \\cdot p_{n+2} \\cdot (1 - p_{n+2}) = 2^{3n-1} \\cdot (2^n - 1)^3 \\cdot \\frac{(2^{n-1} - 1)^4 \\cdot 2^4}{(2^n - 1)^8} \\cdot \\left(1 - \\frac{(2^{n-1} - 1)^4 \\cdot 2^4}{(2^n - 1)^8}\\right) \\simeq \\frac{(2^{n-1} - 1)^4 \\cdot 2^{3n+3}}{(2^n - 1)^5};</span>$</p>

    <p class="text-gray-300">&bull;  <span class="math">Var(\\mathfrak{B}_{2n+1})</span>  is equal to</p>

    <p class="text-gray-300"><span class="math">$\\begin{split} \\operatorname{Var}(\\mathfrak{B}_{2n+1}) &amp;= \\frac{n_{2n+1}}{2^{2n+1}} \\cdot p_{2n+1} \\cdot (1-p_{2n+1}) = 3 \\cdot 2^{2n-1} \\cdot (2^n-1)^2 \\cdot \\frac{1}{(2^n-1)^4} \\cdot \\\\ &amp; \\cdot \\left(1 - \\frac{1}{(2^n-1)^4}\\right) \\simeq \\frac{3 \\cdot 2^{2n-1}}{(2^n-1)^2} \\,. \\end{split}</span>$</p>

    <p class="text-gray-300">By combining all the previous results, it follows that  <span class="math">Var(\\mathfrak{D}_{5-AES})</span>  is (approximately) equal to</p>

    <p class="text-gray-300"><span class="math">$2^6 \\cdot \\underbrace{\\frac{2^{4n-4} \\cdot (2^{2n} - 3 \\cdot 2^n + 3)^4}{(2^n - 1)^8}}_{\\simeq \\operatorname{Var}(\\mathfrak{B}_3)} + 2^{2n+4} \\cdot \\underbrace{\\frac{(2^{n-1} - 1)^4 \\cdot 2^{3n+3}}{(2^n - 1)^5}}_{\\simeq \\operatorname{Var}(\\mathfrak{B}_{n+2})} + 2^{4n+2} \\cdot \\underbrace{\\frac{3 \\cdot 2^{2n-1}}{(2^n - 1)^2}}_{\\simeq \\operatorname{Var}(\\mathfrak{B}_{2n+1})} = \\underbrace{\\frac{2^{4n+2} \\cdot (2^{2n} - 3 \\cdot 2^n + 3)^4}{(2^n - 1)^8}}_{\\simeq \\operatorname{Var}(\\mathfrak{B}_{2n+1})} + \\underbrace{\\frac{3 \\cdot 2^{6n+1}}{(2^n - 1)^2}}_{\\simeq \\operatorname{Var}(\\mathfrak{B}_{2n+1})} = \\underbrace{\\frac{2^{4n+2} \\cdot (2^{2n} - 3 \\cdot 2^n + 3)^4}{(2^n - 1)^8}}_{\\simeq \\operatorname{Var}(\\mathfrak{B}_{2n+1})} + \\underbrace{\\frac{3 \\cdot 2^{6n+1}}{(2^n - 1)^2}}_{\\simeq \\operatorname{Var}(\\mathfrak{B}_{2n+1})}.</span>$</p>

    </section>

    <section id="app-c" class="mb-10">
      <h2 class="text-2xl font-bold">C Influence of the Details of the S-Box and of the MixColumns Matrix on the 5-round Truncated Distinguisher based on the Mean</h2>

      <h3 id="app-c.1" class="text-xl font-semibold mt-8">C.1 Influence of the Details of the S-Box</h3>

    <p class="text-gray-300">In this paper, we have presented a new truncated differential property for 5-round AES-like ciphers in the case in which &quot;the solutions of Eq. (1) are uniformly distributed for each input/output difference  <span class="math">\\Delta_I \\neq 0</span>  and  <span class="math">\\Delta_O \\neq 0</span> &quot;, which is close to being true if the S-Box is APN, or if the SBox is &quot;close&quot; to be APN. Even if no S-Box can (completely) satisfy this assumption, the theoretically results of Theorem 4 are matched by the practical results obtained for the AES S-Box, which approximately satisfies the assumptions of such Proposition (as discussed in Sect. 4). Thus, natural questions arise: What happens when the AES S-Box is changed with an S-Box that does not satisfy (at all) the assumptions of Theorem 4? Is it possible to naturally extend our results to any general case?</p>

    <p class="text-gray-300">We have studied this problem working on small-scale AES, and by practical results the answer to the second question seems to be negative. In other words, our theory does not extend naturally to generic S-Boxes, but it should be modified depending on the particular properties/details of the S-Box function.</p>

    <p class="text-gray-300">Here we limit ourselves to present our practical results that allow to better understand which properties of the S-Box play a crucial role when computing</p>

    <p class="text-gray-300">Table 3. Given (4-bit) 5-round AES, we provide the results of our practical tests about the number of different pairs of ciphertexts that belong to the same coset of M<sup>J</sup> for J fixed with |J| = 3 when the AES S-Box is replaced by the S-Box of other ciphers. Together with the number of collisions, we give the variance Var of the probability distribution that describes the number of solutions of S-Box(x&oplus; &#8710;<sup>I</sup> )&oplus; S-Box(x) = &#8710;<sup>O</sup> and the &quot;Diff.&quot; (= Difference) between the practical and the theoretical number (= 32 847.124) of collisions (under the assumptions of Theorem 4).</p>

    <div class="overflow-x-auto my-4">
      <table class="min-w-full text-sm text-gray-300">
        <thead>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">Cipher S-Box</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">Numb. Collisions</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">Diff.</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">4<br>2<br>&middot;DPmax</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">Var</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">Homogeneous</th>
        </thead>
        <tbody>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">AES S-Box</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">32 848.6</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">+1.5</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">4</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">344/225</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">&#10003;</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">KLEIN S-Box</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">32 849.8</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">+2.7</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">4</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">344/225</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">MIDORI SB1<br>S-Box</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">32 843.0</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">&minus;4.10</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">4</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">344/225</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">PRINCE S-Box</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">32 852.7</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">+5.5</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">4</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">344/225</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Toy-6 S-Box</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">32 840.1</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">&minus;7.1</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">6</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">392/225</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">RECTANGLE S-Box</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">32 861.2</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">+14.0</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">4</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">416/225</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">NOEKEON S-Box</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">32 878.7</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">+31.6</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">4</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">416/225</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">MIDORI SB0<br>S-Box</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">32 882.8</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">+35.7</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">4</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">416/225</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">PRESENT S-Box</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">32 886.3</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">+39.2</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">4</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">416/225</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">PRIDE S-Box</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">32 806.6</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">&minus;40.5</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">4</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">416/225</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Toy-8 S-Box</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">32 815.7</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">&minus;31.5</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">8</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">464/225</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Toy-10 S-Box</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">32 919.0</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">+71.9</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">10</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">864/225</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Toy-12 S-Box</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">32 684.1</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">&minus;163.0</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">12</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">896/225</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
        </tbody>
      </table>
    </div>

    <p class="text-gray-300">the average number of collisions for 5-round AES. We leave the problem to theoretically explain such results open for future work.</p>

    <p class="text-gray-300">In more details, we did several practical tests by counting the average number of collisions in the case in which the AES S-Box is replaced with other S-Box permutations present in the literature, including PRINCE [11], MIDORI [2], KLEIN [18], PRESENT [10], RECTANGLE [29], NOEKEON [15], and PRIDE [1], and with some &quot;toy&quot; S-Boxes (all details are given in Tables 4 &ndash; 5). For our tests, given 2<sup>16</sup> plaintexts with one active diagonal (equivalently, in the same coset of D<sup>i</sup> for i &isin; {0, 1, 2, 3}), we counted the average number of pairs of ciphertexts that are equal in one fixed anti-diagonal (equivalently, that belong in the same coset of ID<sup>J</sup> for J fixed with |J| = 3), and we computed the mean. The obtained results are listed in Table 3, where we also highlight the difference between the number of collisions found by experiments and the theoretical number 32 847.124 under the assumptions of Theorem 4 (while the average number of collisions for a random permutation is 32 767.5). For each AES-like cipher, we used 125 000 ' 2 17 different initial cosets (given values are the average ones), where new (random) keys are generated for each test.</p>

    <p class="text-gray-300">We emphasize that, while all AES-like ciphers satisfy the multiple-of-8 property, for some of them the average number of collisions is bigger than for the case of a random permutation (e.g., AES S-Box), while for others it is smaller (e.g., Toy-12 S-Box): this seems to suggest the independence between the multiple-of-8 property and the value of the mean.</p>

    <p class="text-gray-300">Table 4. S-Box definitions. All the values in the table are in Hexadecimal.</p>

    <div class="overflow-x-auto my-4">
      <table class="min-w-full text-sm text-gray-300">
        <thead>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">x</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"></th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"></th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"></th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"></th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"></th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"></th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"></th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">0 1 2 3 4 5 6 7 8 9 A B C D E F</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"></th>
        </thead>
        <tbody>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">AES</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">6 B 5 4 2 E 7 A 9 D F C 3 1 0 8</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">PRINCE</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">B F 3 2 A C 9 1 6 7 8 0 E 5 D 4</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">KLEIN</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">7 4 A 9 1 F B 0 C 3 2 6 8 E D 5</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Midori SB0</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">C A D 3 E B F 7 8 9 1 5 0 2 4 6</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Midori SB1</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1 0 5 3 E 2 F 7 D A 9 B C 8 4 6</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">PRESENT</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">C 5 6 B 9 0 A D 3 E F 8 4 7 1 2</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">RECTANGLE</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">6 5 C A 1 E 7 9 B 0 3 D 8 F 4 2</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">NOEKEON</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">7 A 2 C 4 8 F 0 5 9 1 e 3 D B 6</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">PRIDE</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">0 4 8 F 1 5 E 9 2 7 A C B D 6 3</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Toy-6 S-Box</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1 3 6 4 2 5 9 A 0 F 7 E C B D 8</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Toy-8 S-Box</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1 3 6 4 2 5 A C 0 F 7 8 E B D 9</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Toy-10 S-Box</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">6 4 C 5 0 7 2 E 1 F 3 D 8 A 9 B</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Toy-12 S-Box</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1 3 6 4 A F D 8 2 9 5 E 0 7 B C</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
        </tbody>
      </table>
    </div>

    <p class="text-gray-300">Table 5. Differential Spectrum of the S-Boxes used in our experiments, that is probability that given an arbitrary &#8710;<sup>I</sup> 6= 0 and &#8710;<sup>O</sup> 6= 0, the equation &quot;S-Box(x &oplus; &#8710;IN ) &oplus; S-Box(x) = &#8710;OUT &quot; has n different solutions x (remember n is even).</p>

    <div class="overflow-x-auto my-4">
      <table class="min-w-full text-sm text-gray-300">
        <thead>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">S-Box</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">0 sol.</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"></th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"></th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"></th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"></th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">2 sol. 4 sol. 6 sol. 8 sol. 10 sol. 12 sol.</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"></th>
        </thead>
        <tbody>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">AES</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">8/15</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">6/15</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1/15</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">0</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">0</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">0</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">0</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">PRINCE</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">8/15</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">6/15</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1/15</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">0</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">0</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">0</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">0</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">KLEIN</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">8/15</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">6/15</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1/15</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">0</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">0</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">0</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">0</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">MIDORI SB1</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">8/15</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">6/15</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1/15</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">0</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">0</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">0</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">0</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">MIDORI SB0</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">43/75</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">24/75</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">8/75</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">0</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">0</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">0</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">0</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">PRESENT</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">43/75</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">24/75</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">8/75</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">0</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">0</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">0</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">0</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">RECTANGLE</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">43/75</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">24/75</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">8/75</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">0</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">0</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">0</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">0</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">NOEKEON</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">43/75</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">24/75</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">8/75</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">0</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">0</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">0</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">0</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">PRIDE</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">43/75</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">24/75</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">8/75</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">0</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">0</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">0</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">0</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Toy-6 S-Box</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">125/225 81/225 18/225 1/225</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">0</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">0</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">0</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Toy-8 S-Box</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">130/225 74/225 18/225 2/225 1/225</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">0</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">0</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Toy-10 S-Box 140/225 60/225 17/225 7/225</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">0</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1/225</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">0</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Toy-12 S-Box 162/225 24/225 27/225 8/225 3/225</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">0</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1/225</td>
          </tr>
        </tbody>
      </table>
    </div>

    <p class="text-gray-300">Observations and (initial) Considerations. As expected, the (absolute) difference between the found number of collisions and the theoretical one seems to increase when the variance (of the S-Box) increases, while it seems to be independent of the maximum differential probability DPmax. Moreover, the difference between the theoretical number of collisions (given under the assumptions of Theorem 4, i.e., that the number of solutions N<sup>&#8710;</sup><sup>I</sup> ,&#8710;<sup>O</sup> of Eq. (1) are uniformly distributed) and the practical one is minimum when the S-Box almost satisfies the assumption of Theorem 4 (e.g., the AES S-Box).</p>

    <p class="text-gray-300">To explain these results, we must refer to the proof of Theorem 4 given in Sect. 6. The idea is to consider a system of 4 equations of the generic form (12), and to look for common solutions. In the case in which the solutions (in particular, the number of solutions N&#8710;<sup>I</sup> ,&#8710;<sup>O</sup> ) of Eq. (1) are uniformly distributed, the probability that a possible solution satisfies all the 4 equations of the system is well approximated by (255&minus;<sup>4</sup> &middot;2 <sup>&minus;</sup>31) 3 , as explained in the proof of Sect. 6. This allows to (theoretically) predict the average number of common solutions, and so of collisions. Instead, in the case in which the solutions (in particular, the number of solutions N&#8710;<sup>I</sup> ,&#8710;<sup>O</sup> ) of Eq. (1) are not uniform distributed (e.g. if the variance of the S-Box is not &quot;small&quot;), the probability to have a common solution is in general different from the one just given. As a result, the number of solutions of a system of equations like (12) can be bigger or smaller with respect to the one given in Theorem 4 (and the difference can be also non-negligible). It follows that the number of collisions is influenced by the details of the S-Box (as expected). As future work, an open problem is to theoretically prove this conjecture about the link between the average number of collisions and the variance of the S-Box, and to theoretically derive the numbers given in Table 3.</p>

    <p class="text-gray-300">What about the distinguisher based on the variance (Sect. 8.1)? To compute the value of the variance, we have exploited the &quot;multiple-of-8&quot; property [21], the properties of the Variance (if X is a random variable and a a scalar, then Var(&alpha;&middot;X) = &alpha; 2 &middot;Var(X)) and the probability that &ndash; given a pair of plaintexts in a coset of D<sup>i</sup> &ndash; two ciphertexts are equal in one fixed anti-diagonal (equivalently, belong to the same coset of ID<sup>J</sup> ) after 5 rounds. Since such probability depends on the details of the S-Box, it follows that also the value of the variance depends on it. On the other hand, we found by practical tests that the value of the variance changes much less than the corresponding value of the mean when the S-Box changes. In general, the value of the variance is &quot;almost&quot; independent of the details of the S-Box. Moreover, since the variance for an AES-like cipher is much bigger than the one of a random permutation, the proposed distinguisher works even if the value of the variance is (a little) different than the one given in Theorem 4.</p>

      <h3 id="app-c.2" class="text-xl font-semibold mt-8">C.2 Influence of the Details of the MixColumns Matrix</h3>

    <p class="text-gray-300">Until now, we have focused only on the details of the S-Box. How does the average number of collisions depend on the details of the MixColumns matrix?</p>

    <p class="text-gray-300">MDS Matrix: &quot;Good&quot; vs &quot;Bad&quot; S-Box. We start by focusing on the case in which the MixColumns matrix is MDS, and then we briefly discuss the other cases. If the S-Box satisfies the assumptions of Theorem 4, then the average number of collisions is (almost) independent of the MixColumns matrix details. Instead, if the S-Box does not satisfy the previous requirement, this number depends also on the details of the MixColumns matrix. In particular, in this last case the solutions (and the corresponding number n<sup>&#8710;</sup><sup>I</sup> ,&#8710;<sup>O</sup> ) of Eq. (1) are not uniformly distributed with respect to &#8710;<sup>I</sup> 6= 0 and &#8710;<sup>O</sup> 6= 0, and so the number of solutions of a system of 4 equations of the generic form (12) depends both on the details of the S-Box and of the linear layer. Indeed, remember that a system of equations of the generic form (12) depends on the coefficients of the MixColumns matrix, and so also the fact that a common solution exists.</p>

    <p class="text-gray-300">To give a practical example, consider the circulant MixColumns matrix defined as MC = circ(0x01, 0x03, 0x02, 0x02), that is, the AES MixColumns matrix where 0x01 is replaced by 0x02 and vice-versa. We got that the number of collisions in the case of AES S-Box is 32 850.32, while in the case of PRESENT S-Box is 32 872.95. Thus, a difference in the MixColumns matrix implies almost no difference for the AES S-Box case (on average, there are +1.75 collisions for this new MDS matrix), while a higher difference occurs for the PRESENT S-Box case (on average, there are &minus;13.37 collisions for this new MDS matrix). Again, this is due to the fact that the probability that a system of 4 equations of the generic form (12) admits a common solution depends both on the details of the S-Box and of the linear layer, in the case in which the S-Box is not &quot;good&quot; (with respect to the assumptions of Theorem 4). Similar results can be obtained using different MDS MixColumns matrices.</p>

    <p class="text-gray-300">Non-MDS Matrix. Finally, if the AES MixColumns matrix is replaced by a non-MDS matrix (which does not satisfy the assumptions of Theorem 4), then the number of collisions can be different with respect to the one predicted by Theorem 4 also in the case of &quot;good&quot; S-Box:</p>

    <ul class="list-disc list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li>in the case of the circulant Midori matrix MCM idori = circ(0x00, 0x01, 0x01, 0x01) &ndash; where some coefficients are equal to zero &ndash; and the AES S-Box, the number of collisions after 5 rounds is on average 31 883.27 (instead of a theoretical number of 32 847.124);</li>
      <li>using the circulant matrix circ(0x02, 0x01, 0x01, 0x01) where all coefficients are non-zero &ndash; and the AES S-Box, the number of collisions after 5 rounds is on average 33 377.93 (instead of a theoretical number of 32 847.124).</li>
    </ul>

    </section>
`;
---

<BaseLayout title="Truncated Differential Properties of the Diagonal Set of Inp... (2018/182)">
  <article class="max-w-4xl mx-auto article-prose">
    <nav class="mb-8">
      <a href="/papers" class="text-blue-400 hover:text-blue-300">
        &larr; Back to Papers
      </a>
    </nav>

    <header class="mb-12">
      <h1 class="text-3xl font-bold mb-4"
        set:html={TITLE_HTML} />
      <p class="text-gray-400 mb-2"
        set:html={AUTHORS_HTML} />
      <p class="text-gray-500 text-sm mb-4">
        2018 &middot; eprint 2018/182
      </p>
      <div class="flex gap-4 text-sm">
        <a
          href={EPRINT_URL}
          target="_blank"
          rel="noopener noreferrer"
          class="text-blue-400 hover:text-blue-300"
        >
          Paper (eprint) &rarr;
        </a>
      </div>
      <PaperDisclaimer eprintUrl={EPRINT_URL} />
      <p class="mt-1 text-xs text-gray-600">
        Converted with: {CRAWLER} &middot; {CONVERTED_DATE}
      </p>
    </header>

    <nav id="toc" class="mb-10 p-6 rounded-lg" style="background: rgba(255,255,255,0.03); border: 1px solid rgba(255,255,255,0.06);">
      <h2 class="text-lg font-bold mb-4">Table of Contents</h2>
      <ol class="space-y-1 text-sm text-gray-300
        list-decimal list-inside">
        <li>
          <a href="#sec-1" class="hover:text-white">Introduction</a>
          <ol class="ml-6 mt-1 space-y-1 list-decimal
            list-inside text-gray-400">
            <li><a href="#sec-1.1" class="hover:text-white">Contributions</a></li>
            <li><a href="#sec-1.2" class="hover:text-white">Follow-Up Works: Truncated Differentials for 5-/6-round AES</a></li>
          </ol>
        </li>
        <li>
          <a href="#sec-2" class="hover:text-white">Preliminary</a>
          <ol class="ml-6 mt-1 space-y-1 list-decimal
            list-inside text-gray-400">
            <li><a href="#sec-2.1" class="hover:text-white">Advanced Encryption Standard (AES)</a></li>
            <li><a href="#sec-2.2" class="hover:text-white">Properties of an S-Box</a></li>
            <li><a href="#sec-3.1" class="hover:text-white">Truncated Differentials for 2-round AES</a></li>
          </ol>
        </li>
        <li><a href="#sec-4" class="hover:text-white">Initial Considerations</a></li>
        <li><a href="#sec-5" class="hover:text-white">Proof of Theorem 4: Sum of Binomial Distributions</a></li>
        <li>
          <a href="#sec-6" class="hover:text-white">Proof of Theorem 4: About the Probabilities p_3, p_&#123;10&#125;, p_&#123;17&#125;</a>
          <ol class="ml-6 mt-1 space-y-1 list-decimal
            list-inside text-gray-400">
            <li><a href="#sec-6.1" class="hover:text-white">Reduction to the Middle Round</a></li>
            <li><a href="#sec-6.2" class="hover:text-white">A &quot;Simpler&quot; Case: 2^&#123;16&#125; Texts with Two Equal Generating Variables</a></li>
            <li><a href="#sec-6.3" class="hover:text-white">Generic Case: 2&lt;sup&gt;32&lt;/sup&gt; Texts</a></li>
          </ol>
        </li>
        <li>
          <a href="#sec-7" class="hover:text-white">Practical Results for 5-round AES</a>
          <ol class="ml-6 mt-1 space-y-1 list-decimal
            list-inside text-gray-400">
            <li><a href="#sec-7.1" class="hover:text-white">Probability Distribution of 5-round AES over (\mathbb&#123;F&#125;_&#123;2^n&#125;)^&#123;4\times 4&#125;</a></li>
            <li><a href="#sec-7.2" class="hover:text-white">Practical Results for 5-round AES over \mathbb&#123;F&#125;_&#123;2^n&#125;^&#123;4\times 4&#125; for n\in\&#123;4,8\&#125;</a></li>
          </ol>
        </li>
        <li>
          <a href="#sec-8" class="hover:text-white">Truncated Differential Distinguishers for 5-round AES</a>
          <ol class="ml-6 mt-1 space-y-1 list-decimal
            list-inside text-gray-400">
            <li><a href="#sec-8.1" class="hover:text-white">Truncated Differential Distinguisher based on the Variance</a></li>
            <li><a href="#sec-8.2" class="hover:text-white">Useful Approximation of the Probability Distribution for 5-round AES</a></li>
            <li><a href="#sec-8.3" class="hover:text-white">Truncated Differential Distinguisher based on the Mean</a></li>
          </ol>
        </li>
      </ol>
      <p class="text-xs text-gray-500 mt-4 mb-1 font-semibold">
        Appendices
      </p>
      <ol class="space-y-1 text-sm text-gray-400
        list-[upper-alpha] list-inside">
        <li><a href="#app-a" class="hover:text-white">Subspace Trail for AES &ndash; Details</a></li>
        <li>
          <a href="#app-b" class="hover:text-white">Probability Distribution for 5-round AES over (\mathbb&#123;F&#125;_&#123;2^n&#125;)^&#123;4\times 4&#125;</a>
          <ol class="ml-6 mt-1 space-y-1 list-decimal
            list-inside text-gray-400">
            <li><a href="#app-b.1" class="hover:text-white">Average Number of Collisions</a></li>
            <li><a href="#app-b.2" class="hover:text-white">Variance</a></li>
          </ol>
        </li>
        <li>
          <a href="#app-c" class="hover:text-white">Influence of the Details of the S-Box and of the MixColumns Matrix on the 5-round Truncated Distinguisher based on the Mean</a>
          <ol class="ml-6 mt-1 space-y-1 list-decimal
            list-inside text-gray-400">
            <li><a href="#app-c.1" class="hover:text-white">Influence of the Details of the S-Box</a></li>
            <li><a href="#app-c.2" class="hover:text-white">Influence of the Details of the MixColumns Matrix</a></li>
          </ol>
        </li>
      </ol>
      <p class="text-xs text-gray-500 mt-4 mb-1 font-semibold">
        Additional
      </p>
      <ul class="space-y-1 text-sm text-gray-400
        list-disc list-inside">
        <li><a href="#references" class="hover:text-white">References</a></li>
      </ul>
    </nav>


    <Fragment set:html={CONTENT} />

    <PaperHistory slug="6-2-a-simpler-case-texts-with-two-equal-generating-variables-2018" />
  </article>
</BaseLayout>
