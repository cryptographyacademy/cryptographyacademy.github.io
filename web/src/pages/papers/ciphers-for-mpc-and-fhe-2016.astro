---
import BaseLayout from '../../layouts/BaseLayout.astro';

const EPRINT_URL = 'https://eprint.iacr.org/2016/687';
const CRAWLER = 'mistral';
const CONVERTED_DATE = '2026-02-16';
const TITLE_HTML = 'Ciphers for MPC and FHE';
const AUTHORS_HTML = 'Martin Albrecht, Christian Rechberger, Thomas Schneider, Tyge Tiessen, Michael Zohner';

const CONTENT = `    <p class="text-gray-300">Martin Albrecht¹, Christian Rechberger²,⁴, Thomas Schneider³, Tyge Tiessen², and Michael Zohner³</p>

    <p class="text-gray-300">¹ Royal Holloway, University of London, UK martinralbrecht@googlemail.com ² DTU Compute, Technical University of Denmark, Denmark {crec,tyti}@dtu.dk ³ TU Darmstadt, Darmstadt, Germany {thomas.schneider,michael.zohner}@ec-spride.de ⁴ IAIK, Graz University of Technology, Austria christian.rechberger@iaik.tugraz.at</p>

    <p class="text-gray-300">Abstract. Designing an efficient cipher was always a delicate balance between linear and non-linear operations. This goes back to the design of DES, and in fact all the way back to the seminal work of Shannon.</p>

    <p class="text-gray-300">Here we focus, for the first time, on an extreme corner of the design space and initiate a study of symmetric-key primitives that minimize the multiplicative size and depth of their descriptions. This is motivated by recent progress in practical instantiations of secure multi-party computation (MPC), fully homomorphic encryption (FHE), and zero-knowledge proofs (ZK) where linear computations are, compared to non-linear operations, essentially "free".</p>

    <p class="text-gray-300">We focus on the case of a block cipher, and propose the family of block ciphers "LowMC", beating all existing proposals with respect to these metrics. As examples, we give concrete instantiations for 80-bit, 128-bit, and 256-bit security. We sketch several applications for such ciphers and give implementation comparisons suggesting that when encrypting larger amounts of data the new design strategy translates into improvements in computation and communication complexity by up to a factor of 5 compared to AES-128, which incidentally is one of the most competitive classical designs. Furthermore, we identify cases where "free XORs" can no longer be regarded as such but represent a bottleneck, hence refuting this commonly held belief with a practical example.</p>

    <p class="text-gray-300">Keywords: block cipher, multiplicative complexity, multiplicative depth, secure multiparty computation, fully homomorphic encryption</p>

    <p class="text-gray-300">¹ Introduction</p>

    <p class="text-gray-300">Motivation. Modern cryptography developed many techniques that go well beyond solving traditional confidentiality and authenticity problems in two-party communication. Secure multiparty computation (MPC), zero-knowledge proofs (ZK) and fully homomorphic encryption (FHE) are some of the most striking examples.</p>

    <p class="text-gray-300">In recent years, especially the area of secure multi-party computation has moved from a science that largely concerned itself with the mere existence of solutions towards considerations of a more practical nature, such as costs of actual implementations for proposed protocols in terms of computational time, memory, and communication.</p>

    <p class="text-gray-300">Despite important progress and existing proof-of-concept implementations, e.g. [MNPS04, PSSW09, HEKM11, NNOB12, KSS12, FN13, SS13], there exists a huge cost gap between employing cryptographic primitives in a traditional way and using them in the more versatile MPC context. As an example, consider implementations of the AES block cipher, a global standard for the bulk encryption of data. Modern processors achieve a single execution of the block</p>

    <p class="text-gray-300">¹ An earlier version appeared in the proceedings of Eurocrypt 2015 [ARS⁺15]. This is an updated and extended version.</p>

    <p class="text-gray-300">cipher within a few hundred clock cycles (or even less than 100 clock cycles using AES-NI). However, realizing the same cipher execution in the context of an MPC protocol takes many billions of clock cycles and high communication volumes between the participating parties, e.g. several hundreds of Megabytes for two-party AES with security against malicious adversaries <em>[x21, x19, x20, x13, x22, x14, x15, x16]</em>.</p>

    <p class="text-gray-300">Traditionally, ciphers are built from linear and non-linear building blocks. These two have roughly similar costs in hardware and software implementations. In CMOS hardware, the smallest linear gate (XOR) is about 2-3 times larger than the smallest non-linear gate (typically, NAND). When implemented in an MPC protocol or a homomorphic encryption scheme, however, the situation is radically different: linear operations come almost for free, since they only incur local computation (resp. do not increase the noise much), whereas the bottleneck are non-linear operations that involve symmetric cryptographic operations and communication between parties (resp. increase the noise considerably). Our motivation hence comes from implementations of ciphers in the context of MPC, ZK, or FHE schemes where linear parts are much cheaper than non-linear parts.</p>

    <p class="text-gray-300">This cost metric suggests a new way of designing a cipher where most of the cryptographically relevant work would be performed as linear operations and the use of non-linear operations is minimized. This design philosophy is related to the fundamental theoretical question of the minimal multiplicative complexity (MC) <em>[x1]</em> of certain tasks. Such extreme trade-offs were not studied before, as all earlier designs – due to their target platforms – faired better with obtaining a balance between linear and non-linear operations.</p>

    <p class="text-gray-300">In this work we propose to start studying symmetric cryptography primitives with low multiplicative complexity in earnest. Earlier steps in this direction <em>[x12, x20, x14]</em> were aimed at good cost and performance when implemented with side-channel attack countermeasures, and are not extreme enough for our purpose. Our question hence is: what is the minimum number of multiplications for building a secure block cipher? We limit ourselves to multiplications in GF(2) and motivate this as follows:</p>

    <ul class="list-disc list-inside space-y-1 text-gray-300 my-2 ml-4">

      <li>By using Boolean circuits we decouple the underlying protocol / primitive (MPC protocol / ZK protocol / FHE scheme) from that of the cipher. Hence, the same cipher can be used for multiple applications.</li>

      <li>GF(2) is a natural choice for MPC protocols based on Yao or GMW (in the semi-honest setting, but also for their extensions to stronger adversaries), ZK protocols, as well as for fully or somewhat homomorphic encryption schemes (cf. Section 2 for details).</li>

    </ul>

    <p class="text-gray-300">By nature of the problem, we are interested in two different metrics. One metric refers to what is commonly called multiplicative complexity (MC), which is simply the number of multiplications (AND gates) in a circuit, see e.g. <em>[x1]</em>. The second metric refers to the multiplicative depth of the circuit, which we will subsequently call ANDdepth. We note that already in <em>[x10]</em> it was observed that using ciphers with low ANDdepth is of central importance for efficient evaluations within homomorphic encryption schemes. Therefore, the authors of <em>[x10]</em> suggest to study block cipher designs that are optimized for low ANDdepth, a task to which we provide a first answer. Our work is somehow orthogonal to Applebaum et. al <em>[x1]</em>, where the question of what can in principle be achieved in cryptography with shallow circuits was addressed.</p>

    <p class="text-gray-300">While our design approach is not specific to block ciphers but can be equally applied to other primitives like hash functions or stream ciphers, in this work we focus on the block cipher case. This all motivates the following guiding hypothesis which we will test in this paper: “When implemented in practice, a block cipher design with lower MC and lower ANDdepth will result in lower executing times”. We note that the relatively low execution times often reported in</p>

    <p class="text-gray-300">the literature are amortized times, i.e. averaged over many calls of a cipher (in parallel). This, however, neglects the often important latency. Hence, another design goal in this work is to reduce this latency.</p>

    <h4 id="sec-2" class="text-lg font-semibold mt-6">Outline and contribution.</h4>

    <p class="text-gray-300">In Section 2 we describe several schemes with “free XORs”and use-cases where block ciphers with a low ANDdepth and MC are required. Then, in Section 3, we focus on an extreme corner of the design space of block ciphers and propose a new block-cipher design strategy that minimizes the multiplicative size and depth of the circuit describing it, beating all existing candidates with respect to these metrics. In terms of ANDdepth, the closest competitor is PRINCE and Noekeon. In terms of MC, the closest competitor turns out to be Simon. We give a high-level overview over a larger field of competing designs in Section 4. We analyse the security of our constructions in Section 5 and provide experimental evidence for the soundness of our approach in Section 6. In particular, our implementations outperform previously reported results in the literature, often by more than a factor 5 in MPC and FHE implementation settings. They also indicate that in the design space we consider, “free XORs” can no longer be regarded as free but significantly contribute to the overall cost, hence refuting this commonly held belief with a practical example. Finally, we describe our optimisation strategies for implementing our designs in the MPC and FHE case, which might be of independent interest.</p>

    <h4 id="sec-3" class="text-lg font-semibold mt-6">Main features and advantages of LowMC.</h4>

    <p class="text-gray-300">LowMC is a very parameterizable design approach. Given any blocksize, a choice for the number of Sboxes per round, and security expectations in terms of time and data complexity, a concrete instantiation can be created easily. Notable features include:</p>

    <ul class="list-disc list-inside space-y-1 text-gray-300 my-2 ml-4">

      <li>Low ANDdepth, and low MC, which positively impacts the latency and throughput of the FHE, MPC, or ZK evaluation of the cipher. We give example instatiations that minimize the ANDdepth, others that minimize the number of ANDs overall, and again others that minimize the number of ANDs per encrypted bit.</li>

      <li>Partial Sbox layer, which is partially responsible for the low multiplicative complexity (MC). Together with Armadillo<em>[BDJ^{+}10]</em>, Zorro <em>[x13]</em> is the first SPN cipher in the literature that uses a non-full Sbox layer and is related to LowMC in this respect. However, recent attacks on Zorro that exploit this particular property <em>[x37, x29, BDD^{+}15]</em>, highlight the need to be very careful with this design strategy. In our analysis of LowMC in Section 5 we are able to take these into account.</li>

      <li>Security arguments against large classes of statistical attacks like differential attacks, similar to other state-of-the-art designs are given in Section 5.</li>

      <li>In contrast to many other constructions, it is easy to obtain tight bounds on the MC and ANDdepth.</li>

      <li>The design is very flexible and allows for a unified description regardless of the blocksize. In fact it would even allow an asymptotic study of the design and analysis of this class of ciphers, and is as such the first practical construction after this was proposed for SPN constructions in <em>[x32]</em>.</li>

      <li>We explicitly de-couple the security claim of a block cipher from the block size.</li>

      <li>We do not add an explicit security margin, but base our choice for the number of rounds on attack vectors known to us and our bounds on them.</li>

    </ul>

    <h4 id="sec-4" class="text-lg font-semibold mt-6">Version history of LowMC.</h4>

    <p class="text-gray-300">A first parameter set for LowMC (called v0 in this paper) was circulated since end of 2014 and after a seminar presentation at ESC 2015, Dmitry Khovratovich point out the omission of combined attacks in our formula to compute the number of</p>

    <p class="text-gray-300">rounds, which led to a new set of parameters (called v1 in this paper) which also appear in the proceedings version of this paper at Eurocrypt 2015 <em>[ARS+15]</em>. After its presentation a number of works gave new insights on how higher-order properties can get extended because of non-full Sbox layers <em>[DLMW15, DEM16]</em> and novel optimization of interpolation attacks <em>[DLMW15]</em>. Results show that for LowMCv1 for fraktion of weak choices of the affine layer, attacks much better than brute-force are possible. For LowMC a concrete choice for the used affine layers should follow a “nothing-up-my-sleeves approach” and not be in the hand of a malicious party. Attacks are also extended to work for any choice of affine layer for our parameterset aiming at 128-bit security. In this more interesting case, attacks reported in <em>[DLMW15]</em> are estimated to have a time complexity that is about 1000 times faster than a naive brute-force key search. We note that as the memory complexity of that attack is very high, even a variant of a brute force key search that could use the same amount of memory would also be sped up noticeably, perhaps by a factor 10 to 100. Insights of these two cryptanalysis papers have been taken into account in this paper, and the new parameter sets for LowMC are now referred to as LowMCv2. For reference, the earlier parameter-sets for v0 and v1 can be found in Appendix A and B.</p>

    <h4 id="sec-5" class="text-lg font-semibold mt-6">Subsequent work.</h4>

    <p class="text-gray-300">For the FHE/SHE use-case, a number of designs followed-up on LowMC and provided alternatives. Keyvrium <em>[CCF+15]</em> is a proposal aimin at 128-bit security and is based on the stream-cipher design approach Trivium <em>[DP08]</em> which has 80-bit security and has in terms of AND-related metrics similar properties as LowMC, albeit LowMC can be parameterized in many ways whereas the the Keyvrium design is fixed. The very recent proposal FLIP <em>[MJSC16]</em> has a much lower depth (especially important for the FHE use-case), but a much higher number of ANDs per encrypted bit. All of them use operations in GF(2) as their main building block. The only cipher design in this domain which deviates, with basic operations either in <span class="math">GF(2^{n})</span> or <span class="math">GF(p)</span>, is MiMC <em>[AGR+16, GRR+16]</em>, which aims for a small number of multiplications in larger fields, and finds applications in MPC and ZK protocols.</p>

    <h2 id="sec-6" class="text-2xl font-bold">2 Schemes and Applications</h2>

    <p class="text-gray-300">In this section we list several schemes and applications for MPC, FHE, and ZK that benefit from evaluating our cipher. In all the example applications below, the complexity of the functionality being evaluated within the protocol is dominated by the complexity of the block cipher and hence using our cipher instead of AES or any other cipher results in immediate performance gains.</p>

    <h3 id="sec-7" class="text-xl font-semibold mt-8">2.1 Multi-Party Computation (MPC)</h3>

    <h4 id="sec-8" class="text-lg font-semibold mt-6">Schemes.</h4>

    <p class="text-gray-300">There are two classes of practically efficient secure multi-party computation (MPC) protocols for securely evaluating Boolean circuits where XOR gates are considerably cheaper (no communication and less computation) than AND gates.</p>

    <p class="text-gray-300">The first class of MPC protocols has a constant number of rounds and their total amount of communication depends on the MC of the circuit (each AND gate requires communication). Examples are protocols based on Yao’s garbled circuits <em>[Yao86]</em> with the free XOR technique <em>[KS08]</em>. To achieve security against stronger (i.e., malicious or covert) adversaries, garbled circuit-based protocols apply the cut-and-choose technique where multiple garbled circuits are evaluated, e.g., <em>[LP07, AL07, LPS08, PSSW09, LP11, SS11, KSS12, FN13, Lin13, HKE13, SS13, FJN14, HKK+14, LR14]</em>; also MiniLEGO <em>[FJN+13]</em> falls into this class.</p>

    <p class="text-gray-300">The second class of MPC protocols has a round complexity that is linear in the ANDdepth of the evaluated circuit (each AND gate requires interaction) and hence the performance depends</p>

    <p class="text-gray-300">on both, the MC and ANDdepth of the circuit. Examples are the semi-honest secure version of the GMW protocol <em>[x13, x32]</em> implemented in <em>[CHK^{+}12, x32]</em>, and tiny-OT <em>[x30]</em> with security against malicious adversaries.</p>

    <h4 id="sec-9" class="text-lg font-semibold mt-6">Server-side one-time passwords.</h4>

    <p class="text-gray-300">The following application is being commercialized by Dyadic Security. In one-time password authentication schemes, a user authenticates with a freshly generated short 6-8 digit password. This helps alleviate the problem of users choosing bad passwords. The one-time password is generated by a device that contains a cryptographic key and computes the new password by applying a function like AES to the time or some other transient value. In order to verify the one-time password, a server has to compute the cryptographic function itself, derive the password and compare. The problem with this system is that if a server breach occurs, then all of the cryptographic keys can be stolen. In such a case, all user devices have to be replaced, which is extremely expensive (most of these devices cannot even be reprogrammed with a new key). This exact scenario happened to RSA, and Lockheed-Martin reported attacks on their systems that can be traced back to the server breach at RSA (note that devices were not replaced after this breach, probably because it was not clear exactly what was stolen and the cost would be too great). Using MPC, it is possible to mitigate the danger of such a server breach by splitting the server into two or more parts and giving each server a share of the cryptographic key for computing the one-time passwords. Then, one-time passwords can be verified by running a secure computation to compute AES. This forces the attacker to break into both servers which is much harder (of course, in order to ensure that it is indeed harder, they should be given different protection mechanisms and/or be at different locations; in addition, the shares should be refreshed periodically so that an attacker has to break into both simultaneously).</p>

    <h4 id="sec-10" class="text-lg font-semibold mt-6">Oblivious pseudorandom functions and applications.</h4>

    <p class="text-gray-300">An example for privacy-preserving keyword search is based on Oblivious Pseudorandom Functions (OPRFs), introduced in <em>[x11]</em>, where one party inputs a key and the other party obliviously obtains an encryption under the key. OPRFs have further applications in set intersection <em>[x15]</em> and secure database join <em>[x21]</em>. Another interesting application of OPRFs was proposed in<em>[x1]</em> in the area of brokered identification systems. When evaluated as a circuit, the OPRF could be instantiated with our cipher instead of AES resulting in better performance.</p>

    <h4 id="sec-11" class="text-lg font-semibold mt-6">Secure storage.</h4>

    <p class="text-gray-300"><em>[x10]</em> describe further applications of evaluating a block cipher (AES in their case) within an MPC protocol, e.g., to allow the servers involved in an MPC computation to store symmetrically encrypted information in untrusted (cloud) storage. Dyadic Security builds on this idea for their “Application-Layer Data Encryption”.</p>

    <h3 id="sec-12" class="text-xl font-semibold mt-8">2.2 Fully homomorphic encryption (FHE)</h3>

    <h4 id="sec-13" class="text-lg font-semibold mt-6">Schemes.</h4>

    <p class="text-gray-300">In all somewhat and fully homomorphic encryption schemes known so far XOR (addition) gates are considerably cheaper than AND (multiplication) gates. Moreover, XOR gates do not increase the noise much, whereas AND gates increase the noise considerably (cf. <em>[x14]</em>). Hence, as in somewhat homomorphic encryption schemes the parameters must be chosen such that the noise of the result is low enough to permit decryption, the overall complexity depends on the ANDdepth.</p>

    <h4 id="sec-14" class="text-lg font-semibold mt-6">Sending data to the cloud.</h4>

    <p class="text-gray-300">Today’s FHE schemes still have a very high ciphertext expansion rate. Therefore, as described in <em>[x21, x18]</em>, it is beneficial for privacy-preserving applications based on FHE that outsource computations on sensitive data to the cloud to make use of hybrid encryption: Instead of encrypting client’s data directly with FHE, the client encrypts its data using symmetric encryption, e.g., with a block cipher such as LowMC, and then sends the encrypted data along with the FHE-encrypted symmetric key to the cloud. The cloud then decrypts the symmetrically encrypted data under FHE. Using this method, the network communication is lowered to the data size, which is optimal, plus a one-time setup for sending the FHE-encrypted symmetric key.</p>

    <h4 id="sec-15" class="text-lg font-semibold mt-6">Verifiable computing.</h4>

    <p class="text-gray-300">Another use case of our cipher is <em>verifiable computing</em> proposed in <em>[x10]</em> which allows to outsource computation to untrusted workers (such as the cloud) and verify that the result was computed correctly. <em>[x10]</em> propose to evaluate a garbled circuit within fully homomorphic encryption. Today’s most efficient construction of garbled circuits of <em>[x3]</em> requires one evaluation of a block cipher per AND gate. The block cipher can be instantiated with our cipher instead of AES for better efficiency.</p>

    <h3 id="sec-16" class="text-xl font-semibold mt-8">2.3 Zero-Knowledge proof of knowledge (ZK)</h3>

    <h4 id="sec-17" class="text-lg font-semibold mt-6">Schemes.</h4>

    <p class="text-gray-300">In several zero-knowledge proof protocols XOR relations can be proven for free and the complexity essentially depends on the number of AND gates of the relation to be proven. Examples for such protocols are <em>[x2, x4]</em> and the recently proposed highly efficient protocol of <em>[x13]</em> that requires only one evaluation of a garbled circuit <em>[x24]</em> and can make use of the free XOR technique <em>[x15]</em>.</p>

    <h4 id="sec-18" class="text-lg font-semibold mt-6">ZK proof of knowledge of symmetric encryption key.</h4>

    <p class="text-gray-300">The following application was described in <em>[x13]</em>: In 2010 Julian Assange released a “thermonuclear file insurance”, i.e., a 1.4GB file which was an AES encryption of highly sensitive information as a countermeasure to protect WikiLeaks from being shut down by the U.S. government. The file was widely distributed over peer-to-peer networks and simply releasing the short encryption key would have allowed a great number of people to have access to the information. In order to prove that the file actually contains sensitive information without releasing the decryption key, one needs a block cipher that “works well” with a zero-knowledge protocol.</p>

    <h4 id="sec-19" class="text-lg font-semibold mt-6">ZK proof of knowledge of MAC key.</h4>

    <p class="text-gray-300">Another application of our cipher would be to prove in zero-knowledge that one knows the key corresponding to a message and a MAC for a block cipher-based MAC, e.g., CBC-MAC.</p>

    <h2 id="sec-20" class="text-2xl font-bold">3 Description of LowMC</h2>

    <p class="text-gray-300">LowMC is a flexible block cipher based on an SPN structure where the block size <span class="math">n</span>, the key size <span class="math">k</span>, the number of Sboxes <span class="math">m</span> in the substitution layer and the allowed data complexity <span class="math">d</span> of attacks can independently be chosen. The number of rounds needed to reach the security claims is then derived from these parameters.</p>

    <p class="text-gray-300">To reduce the multiplicative complexity, the number of Sboxes applied in parallel can be reduced, leaving part of the substitution layer as the identity mapping. Despite concerns raised regarding this strategy <em>[x22, x11, BDD^{+}15]</em>, we will show that security is</p>

    <p class="text-gray-300">viable. To reach security in spite of a low multiplicative complexity, pseudorandomly generated binary matrices are used in the linear layer to introduce a very high degree of diffusion. A method to accountably instantiate LowMC is given in Section 3.3.</p>

    <p class="text-gray-300">Encryption with LowMC starts with a key whitening, followed by several rounds of encryption where the exact number of rounds depends on the chosen parameter set. A single round is composed as follows:</p>

    <p class="text-gray-300"><span class="math">\\textsc{LowMCround}(i)=</span></p>

    <p class="text-gray-300"><span class="math">\\textsc{KeyAddition}(i)\\circ\\textsc{ConstantAddition}(i)\\circ\\textsc{LinearLayer}(i)\\circ\\textsc{SboxLayer}</span></p>

    <p class="text-gray-300">In the following we give a detailed description of the individual steps.</p>

    <p class="text-gray-300">!<a href="img-0.jpeg">img-0.jpeg</a> Figure 1: Depiction of one round of encryption with LowMC.</p>

    <p class="text-gray-300">SboxLayer is an <span class="math">m</span>-fold parallel application of the same 3-bit Sbox on the first <span class="math">3m</span> bits of the state. If <span class="math">n&amp;gt;3m</span> then for the remaining <span class="math">n-3m</span> bits, the SboxLayer is the identity. The selection criteria for the Sbox were as follows:</p>

    <ul class="list-disc list-inside space-y-1 text-gray-300 my-2 ml-4">

      <li>Maximum differential probability: <span class="math">2^{-2}</span></li>

      <li>Maximum square correlation: <span class="math">2^{-2}</span></li>

      <li>Simple circuit description involving only 3 AND gates, with ANDdepth=1</li>

      <li>Algebraic degree 2 in each of the 8 non-zero component functions</li>

    </ul>

    <p class="text-gray-300">The Sbox is specified in Figure 2, and coincides with the Sbox used for PRINTcipher <em>[x13]</em>. A table representation of the Sbox can be found in Section C of the Appendix.</p>

    <p class="text-gray-300">LinearLayer(<span class="math">i</span>) is the multiplication in GF(2) of the state with the binary <span class="math">n\\times n</span> matrix Lmatrix[i]. The matrices are chosen independently and uniformly at random from all invertible binary <span class="math">n\\times n</span> matrices during the specification of a LowMC instantiation and are then fixed.</p>

    <p class="text-gray-300">ConstantAddition(<span class="math">i</span>) is the addition in GF(2) of roundconstant[i] to the state. The constants are chosen independently and uniformly at random from all binary vectors of length <span class="math">n</span> during the specification of a LowMC instantiation and are then fixed.</p>

    <p class="text-gray-300">KeyAddition(<span class="math">i</span>) is the addition in GF(2) of roundkey[i] to the state. To generate roundkey[i], the master key key is multiplied in GF(2) with the binary <span class="math">n\\times k</span> matrix Kmatrix[i]. The matrices are chosen independently and uniformly at random from all binary <span class="math">n\\times k</span> matrices of rank min(<span class="math">n,k</span>) during the specification of a LowMC instantiation and are then fixed.</p>

    <p class="text-gray-300">Decryption is done in the straightforward manner by an inversion of these steps.</p>

    <p class="text-gray-300"><span class="math">S(a,b,c)=(a\\oplus bc,a\\oplus b\\oplus ac,a\\oplus b\\oplus c\\oplus ab)</span></p>

    <p class="text-gray-300">Figure 2: Specification of the 3-bit Sbox.</p>

    <h3 id="sec-21" class="text-xl font-semibold mt-8">3.1 Pseudocode</h3>

    <p class="text-gray-300">plaintext and state are <span class="math">n</span>-bit quantities. key is a <span class="math">k</span>-bit quantity, which can both be larger or smaller than <span class="math">n</span>. r is the number of rounds.</p>

    <pre><code class="language-text">ciphertext = encrypt (plaintext,key)
//initial whitening
state = plaintext + MultiplyWithGF2Matrix(KMatrix(0),key)

for (i = 1 to r)
//m computations of 3-bit sbox,
//remaining n-3m bits remain the same
state = Sboxlayer (state)

//affine layer
state = MultiplyWithGF2Matrix(LMatrix(i),state)
state = state + Constants(i)

//generate round key and add to the state
state = state + MultiplyWithGF2Matrix(KMatrix(i),key)
end
ciphertext = state</code></pre>

    <h3 id="sec-22" class="text-xl font-semibold mt-8">3.2 Parameters</h3>

    <p class="text-gray-300">As the design goal of LowMC is to be minimal with respect to complexity metrics based on the AND gates, we tried to minimize the number of rounds necessary to reach security. To this end we evaluated and estimated the security of LowMC with respect to a range of different attack vectors (see Section 5), and used this as a base to derive a formula that determines for any set of block size <span class="math">n</span>, number of Sboxes <span class="math">m</span>, key size <span class="math">k</span> and allowed data complexity <span class="math">d</span>, the number of rounds <span class="math">r</span> necessary for security. Our selection of parameter sets offering different trade-offs can be found in Table 1. The formula used to derive the number of rounds can be found in Section 5.7.</p>

    <h3 id="sec-23" class="text-xl font-semibold mt-8">3.3 Instantiation of LowMC</h3>

    <p class="text-gray-300">To maximize the amount of diffusion achieved by the linear layer, we rely on randomly generated, invertible binary matrices. As there exist no binary matrices of size larger than <span class="math">1\\times 1</span> that are MDS, and as it is generally an NP-complete problem to determine the branching number of a binary matrix <em>[x1]</em>, there is no obviously better method to reach this goal. The problem in the instantiation of LowMC is to find an accountable way of constructing the random matrices and vectors that leaves no room for the designer to plant backdoors.</p>

    <p class="text-gray-300">Our recommended instantiation is a compromise between randomness, accountability and ease of implementation. It uses the Grain LSFR as a self-shrinking generator (see <em>[x10]</em></p>

    <p class="text-gray-300">Table 1. A range of different parameter sets for LowMC instantiations offering different trade-offs. The first set is for PRESENT-like security parameters, the second set for AES-like security parameters. The third aims at a 128-bit post-quantum security level with  <span class="math">k = d = 256</span> . The ANDdepth corresponds to the number of rounds.</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">blocksize n</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">sboxes m</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">keysize k</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">data d</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">rounds r</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"># of ANDs</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">ANDs per bit</th>

          </tr>

        </thead>

        <tbody>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">256</td>

            <td class="px-3 py-2 border-b border-gray-700">49</td>

            <td class="px-3 py-2 border-b border-gray-700">80</td>

            <td class="px-3 py-2 border-b border-gray-700">64</td>

            <td class="px-3 py-2 border-b border-gray-700">12</td>

            <td class="px-3 py-2 border-b border-gray-700">1764</td>

            <td class="px-3 py-2 border-b border-gray-700">6.89</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">128</td>

            <td class="px-3 py-2 border-b border-gray-700">31</td>

            <td class="px-3 py-2 border-b border-gray-700">80</td>

            <td class="px-3 py-2 border-b border-gray-700">64</td>

            <td class="px-3 py-2 border-b border-gray-700">12</td>

            <td class="px-3 py-2 border-b border-gray-700">1116</td>

            <td class="px-3 py-2 border-b border-gray-700">8.72</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">64</td>

            <td class="px-3 py-2 border-b border-gray-700">1</td>

            <td class="px-3 py-2 border-b border-gray-700">80</td>

            <td class="px-3 py-2 border-b border-gray-700">64</td>

            <td class="px-3 py-2 border-b border-gray-700">164</td>

            <td class="px-3 py-2 border-b border-gray-700">492</td>

            <td class="px-3 py-2 border-b border-gray-700">7.69</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">1024</td>

            <td class="px-3 py-2 border-b border-gray-700">20</td>

            <td class="px-3 py-2 border-b border-gray-700">80</td>

            <td class="px-3 py-2 border-b border-gray-700">64</td>

            <td class="px-3 py-2 border-b border-gray-700">45</td>

            <td class="px-3 py-2 border-b border-gray-700">2700</td>

            <td class="px-3 py-2 border-b border-gray-700">2.64</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">1024</td>

            <td class="px-3 py-2 border-b border-gray-700">10</td>

            <td class="px-3 py-2 border-b border-gray-700">80</td>

            <td class="px-3 py-2 border-b border-gray-700">64</td>

            <td class="px-3 py-2 border-b border-gray-700">85</td>

            <td class="px-3 py-2 border-b border-gray-700">2550</td>

            <td class="px-3 py-2 border-b border-gray-700">2.49</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">256</td>

            <td class="px-3 py-2 border-b border-gray-700">63</td>

            <td class="px-3 py-2 border-b border-gray-700">128</td>

            <td class="px-3 py-2 border-b border-gray-700">128</td>

            <td class="px-3 py-2 border-b border-gray-700">14</td>

            <td class="px-3 py-2 border-b border-gray-700">2646</td>

            <td class="px-3 py-2 border-b border-gray-700">10.34</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">196</td>

            <td class="px-3 py-2 border-b border-gray-700">63</td>

            <td class="px-3 py-2 border-b border-gray-700">128</td>

            <td class="px-3 py-2 border-b border-gray-700">128</td>

            <td class="px-3 py-2 border-b border-gray-700">14</td>

            <td class="px-3 py-2 border-b border-gray-700">2646</td>

            <td class="px-3 py-2 border-b border-gray-700">13.50</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">128</td>

            <td class="px-3 py-2 border-b border-gray-700">3</td>

            <td class="px-3 py-2 border-b border-gray-700">128</td>

            <td class="px-3 py-2 border-b border-gray-700">128</td>

            <td class="px-3 py-2 border-b border-gray-700">88</td>

            <td class="px-3 py-2 border-b border-gray-700">792</td>

            <td class="px-3 py-2 border-b border-gray-700">6.19</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">128</td>

            <td class="px-3 py-2 border-b border-gray-700">2</td>

            <td class="px-3 py-2 border-b border-gray-700">128</td>

            <td class="px-3 py-2 border-b border-gray-700">128</td>

            <td class="px-3 py-2 border-b border-gray-700">128</td>

            <td class="px-3 py-2 border-b border-gray-700">768</td>

            <td class="px-3 py-2 border-b border-gray-700">6.00</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">128</td>

            <td class="px-3 py-2 border-b border-gray-700">1</td>

            <td class="px-3 py-2 border-b border-gray-700">128</td>

            <td class="px-3 py-2 border-b border-gray-700">128</td>

            <td class="px-3 py-2 border-b border-gray-700">252</td>

            <td class="px-3 py-2 border-b border-gray-700">756</td>

            <td class="px-3 py-2 border-b border-gray-700">5.91</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">1024</td>

            <td class="px-3 py-2 border-b border-gray-700">20</td>

            <td class="px-3 py-2 border-b border-gray-700">128</td>

            <td class="px-3 py-2 border-b border-gray-700">128</td>

            <td class="px-3 py-2 border-b border-gray-700">49</td>

            <td class="px-3 py-2 border-b border-gray-700">2940</td>

            <td class="px-3 py-2 border-b border-gray-700">2.87</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">1024</td>

            <td class="px-3 py-2 border-b border-gray-700">10</td>

            <td class="px-3 py-2 border-b border-gray-700">128</td>

            <td class="px-3 py-2 border-b border-gray-700">128</td>

            <td class="px-3 py-2 border-b border-gray-700">92</td>

            <td class="px-3 py-2 border-b border-gray-700">2760</td>

            <td class="px-3 py-2 border-b border-gray-700">2.70</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">512</td>

            <td class="px-3 py-2 border-b border-gray-700">66</td>

            <td class="px-3 py-2 border-b border-gray-700">256</td>

            <td class="px-3 py-2 border-b border-gray-700">256</td>

            <td class="px-3 py-2 border-b border-gray-700">18</td>

            <td class="px-3 py-2 border-b border-gray-700">3564</td>

            <td class="px-3 py-2 border-b border-gray-700">6.96</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">256</td>

            <td class="px-3 py-2 border-b border-gray-700">10</td>

            <td class="px-3 py-2 border-b border-gray-700">256</td>

            <td class="px-3 py-2 border-b border-gray-700">256</td>

            <td class="px-3 py-2 border-b border-gray-700">52</td>

            <td class="px-3 py-2 border-b border-gray-700">1560</td>

            <td class="px-3 py-2 border-b border-gray-700">6.09</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">256</td>

            <td class="px-3 py-2 border-b border-gray-700">1</td>

            <td class="px-3 py-2 border-b border-gray-700">256</td>

            <td class="px-3 py-2 border-b border-gray-700">256</td>

            <td class="px-3 py-2 border-b border-gray-700">458</td>

            <td class="px-3 py-2 border-b border-gray-700">1374</td>

            <td class="px-3 py-2 border-b border-gray-700">5.37</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">1024</td>

            <td class="px-3 py-2 border-b border-gray-700">10</td>

            <td class="px-3 py-2 border-b border-gray-700">256</td>

            <td class="px-3 py-2 border-b border-gray-700">256</td>

            <td class="px-3 py-2 border-b border-gray-700">103</td>

            <td class="px-3 py-2 border-b border-gray-700">3090</td>

            <td class="px-3 py-2 border-b border-gray-700">3.02</td>

          </tr>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">and [MS94]) as a source of random bits. The exact procedure can be found in Section G in the Appendix. <span class="math">^{8}</span></p>

    <p class="text-gray-300">It must be mentioned though that it is principally possible to use any sufficiently random source to generate the matrices and constants. It is also not necessary that the source is cryptographically secure. Note that this of course assumes that no malicious party has influence over the choice of these constants.</p>

    <p class="text-gray-300">In the following we survey a larger number of existing cipher designs and study their ANDdepth and MC per encrypted bit which we summarize in Table 2. We both choose representative candidates from various design strategies, as well as the designs that are most competitive in terms of our metrics. We do this in two distinct categories: AES-like security (with key sizes of 128-bits and more and data security and block size of 128-bits and more), and lightweight security (data security and block size of 96 bits or below). Note that data security refers to the  <span class="math">\\log_2</span>  of the allowable data complexity up to which a cipher is expected to give the claimed security against shortcut attacks. For LowMC we explicitly de-couple the data security from the block size of the cipher as the proposed design strategy favour larger block sizes but we don't see a new for larger data security than 128. For size-optimized variants we instantiate  <span class="math">\\ell</span> -bit adders using a ripple-carry adder which has  <span class="math">\\ell - 1</span>  ANDs and ANDdepth  <span class="math">\\ell - 1</span> ; for depth-optimized variants we instantiate them with a Ladner-Fischer adder that has  <span class="math">\\ell + 1.25\\ell \\log_2\\ell</span>  ANDs and ANDdepth  <span class="math">1 + 2\\log_2\\ell</span> , cf. [SZ13].</p>

    <p class="text-gray-300">We first survey AES versions and then ciphers with related security properties. The Sbox construction of [BP12] has 34 AND gates and ANDdepth 4 (the size optimized Sbox construction of [BMP13] has only 32 AND gates, but higher ANDdepth 6). See also Canright [Can05]. To encrypt a 128-bit block, AES-128 has 10 rounds and uses 160 calls to the Sbox (40 for key</p>

    <p class="text-gray-300">schedule), hence 5 440 AND gates, or 42.5 AND gates per encrypted bit. To encrypt a 128-bit block, AES-192 has 12 rounds and uses 192 calls to the Sbox (32 for key schedule), hence 6 528 AND gates, or 51 AND gates per encrypted bit. To encrypt a 128-bit block, AES-256 has 14 rounds and uses 224 calls to the Sbox (56 for key schedule), hence 7 616 AND gates, or 59.5 AND gates per encrypted bit.</p>

    <p class="text-gray-300">AES is actually comparatively efficient. Other ciphers with a different design strategy can have very different properties. Threefish <em>[FLS^{+}10]</em> is a cipher with large block size. Threefish with its 512-bit block size has 72 rounds with 4 additions modulo <span class="math">2^{64}</span> each resulting in 35.438 AND gates per encrypted bit and ANDdepth=4 536 (63 per round). Threefish with its 1 024-bit block size has 80 rounds with 8 additions each resulting in 39.375 AND gates per bit and ANDdepth=5 040 (63 per round). The recently proposed NSA cipher Simon <em>[BSS^{+}13]</em> is also a good candidate to be of low multiplicative complexity. If <span class="math">b</span> is the block size, it does <span class="math">b/2</span> AND gates per round, and ANDdepth is equal to the number of rounds. For a key size of 128 bit (comparable to AES) and block size 128 bit, it needs 68 rounds. This means, 4 352 AND gates, or 34 AND gates per bit.</p>

    <p class="text-gray-300">In the lightweight category, we consider Present, but also Simon. The Present Sbox can be implemented with as little as 4 AND gates which is optimal <em>[x11]</em> and has ANDdepth 3. With <span class="math">16\\cdot 31=496</span> Sbox applications per 64 bit block we arrive at 31 AND gates per bit. A depth-optimized version of the Present Sbox with ANDdepth 2 and 8 ANDs is given in the full version of this paper. The 128bit secure version of Present differs only in the key schedule. Simon-64/96 has a 96 bit key, block size 64 bit and 42 rounds and Simon-32/64 has a 64 bit key, block size 32 bit and 32 rounds; see above for MC and ANDdepth. As another data point, the DES circuit of <em>[x17]</em> has 18 175 AND gates and ANDdepth 261. KATAN <em>[x10]</em> has 254 rounds. In KATAN32, the ANDdepth increases by two every 8 rounds resulting in an ANDdepth of 64; with 3 AND gates per round and a block size of 32 bit this results in 23.81 ANDs per bit, but similar to Simon-32/64 applications are limited due to the small block size. In KATAN48 and KATAN64 the ANDdepth increases by 2 every 7 rounds resulting in an ANDdepth of 74. KATAN48 has 6 ANDs per round and a block size of 48 bit resulting in 31.75 ANDs per bit. KATAN64 has 9 ANDs per round and a block size of 64 bit resulting in 35.72 ANDs per bit. Prince <em>[BCG^{+}12]</em> has 12 rounds and each round can be implemented with ANDdepth 2, and each Sbox with 10 AND gates, cf. <em>[x12]</em>. The low-latency design goal ends up making Prince the most competitive when it comes to the ANDdepth. NOEKEON <em>[x12]</em> is a competitive block cipher with 16 rounds and each round applies 32 S-boxes consisting of 4 AND gates with ANDdepth 2 each.</p>

    <p class="text-gray-300">LowMC is easily parameterizable to all these settings, see also Table 1 in Section 3. It has at most (if <span class="math">3m=n</span>) one AND gate per bit per round which results, together with a moderate number of rounds to make it secure, in the lowest ANDdepth and lowest MC per encrypted bit, cf. Table 2.</p>

    <h2 id="sec-25" class="text-2xl font-bold">5 Resistance against cryptanalytic attacks</h2>

    <p class="text-gray-300">The ANDdepth, the number of ANDs per encrypted bit, and the total number of ANDs all critically depend on the number of rounds. As the goal of LowMC is to optimize the cipher with regard to these metrics, the goal of this security analysis is to determine the minimal number of rounds required to grant security for a given fixed set of parameters, i.e., for any choice of block size <span class="math">n</span>, number of Sboxes <span class="math">m</span>, allowed data complexity <span class="math">d</span>, and key size <span class="math">k</span>.</p>

    <p class="text-gray-300">To determine the number of rounds needed for LowMC to be secure, we evaluate its vulnerability under a range of different attack vectors that cover a large portion of standard attacks. In particular, we will discuss differential cryptanalysis, linear cryptanalysis, boomerang attacks,</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Cipher</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Key size</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Block size</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Data sec.</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">ANDdepth</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">ANDs/bit</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Sbox representation</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">|  AES-like security  |   |   |   |   |   |   |</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">AES-128</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">128</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">128</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">128</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">40 (60)</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">43 (40)</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">[BP12] ([BMP13])</th>

          </tr>

        </thead>

        <tbody>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">AES-256</td>

            <td class="px-3 py-2 border-b border-gray-700">256</td>

            <td class="px-3 py-2 border-b border-gray-700">128</td>

            <td class="px-3 py-2 border-b border-gray-700">128</td>

            <td class="px-3 py-2 border-b border-gray-700">56 (84)</td>

            <td class="px-3 py-2 border-b border-gray-700">60 (56)</td>

            <td class="px-3 py-2 border-b border-gray-700">[BP12] ([BMP13])</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">Simon</td>

            <td class="px-3 py-2 border-b border-gray-700">128</td>

            <td class="px-3 py-2 border-b border-gray-700">128</td>

            <td class="px-3 py-2 border-b border-gray-700">128</td>

            <td class="px-3 py-2 border-b border-gray-700">68</td>

            <td class="px-3 py-2 border-b border-gray-700">34</td>

            <td class="px-3 py-2 border-b border-gray-700">[BSS+13]</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">Simon</td>

            <td class="px-3 py-2 border-b border-gray-700">192</td>

            <td class="px-3 py-2 border-b border-gray-700">128</td>

            <td class="px-3 py-2 border-b border-gray-700">128</td>

            <td class="px-3 py-2 border-b border-gray-700">69</td>

            <td class="px-3 py-2 border-b border-gray-700">35</td>

            <td class="px-3 py-2 border-b border-gray-700">[BSS+13]</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">Simon</td>

            <td class="px-3 py-2 border-b border-gray-700">256</td>

            <td class="px-3 py-2 border-b border-gray-700">128</td>

            <td class="px-3 py-2 border-b border-gray-700">128</td>

            <td class="px-3 py-2 border-b border-gray-700">72</td>

            <td class="px-3 py-2 border-b border-gray-700">36</td>

            <td class="px-3 py-2 border-b border-gray-700">[BSS+13]</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">Noekeon</td>

            <td class="px-3 py-2 border-b border-gray-700">128</td>

            <td class="px-3 py-2 border-b border-gray-700">128</td>

            <td class="px-3 py-2 border-b border-gray-700">128</td>

            <td class="px-3 py-2 border-b border-gray-700">32</td>

            <td class="px-3 py-2 border-b border-gray-700">16</td>

            <td class="px-3 py-2 border-b border-gray-700">[DPVAR00]</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">Robin</td>

            <td class="px-3 py-2 border-b border-gray-700">128</td>

            <td class="px-3 py-2 border-b border-gray-700">128</td>

            <td class="px-3 py-2 border-b border-gray-700">128</td>

            <td class="px-3 py-2 border-b border-gray-700">96</td>

            <td class="px-3 py-2 border-b border-gray-700">24</td>

            <td class="px-3 py-2 border-b border-gray-700">[GLSV14]</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">Fantomas</td>

            <td class="px-3 py-2 border-b border-gray-700">128</td>

            <td class="px-3 py-2 border-b border-gray-700">128</td>

            <td class="px-3 py-2 border-b border-gray-700">128</td>

            <td class="px-3 py-2 border-b border-gray-700">48</td>

            <td class="px-3 py-2 border-b border-gray-700">16.5</td>

            <td class="px-3 py-2 border-b border-gray-700">[GLSV14]</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">Threefish</td>

            <td class="px-3 py-2 border-b border-gray-700">512</td>

            <td class="px-3 py-2 border-b border-gray-700">512</td>

            <td class="px-3 py-2 border-b border-gray-700">512</td>

            <td class="px-3 py-2 border-b border-gray-700">936 (4536)</td>

            <td class="px-3 py-2 border-b border-gray-700">306 (36)</td>

            <td class="px-3 py-2 border-b border-gray-700">[FLS+10]</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">Threefish</td>

            <td class="px-3 py-2 border-b border-gray-700">512</td>

            <td class="px-3 py-2 border-b border-gray-700">1024</td>

            <td class="px-3 py-2 border-b border-gray-700">1024</td>

            <td class="px-3 py-2 border-b border-gray-700">1040 (5040)</td>

            <td class="px-3 py-2 border-b border-gray-700">340 (40)</td>

            <td class="px-3 py-2 border-b border-gray-700">[FLS+10]</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">LowMC</td>

            <td class="px-3 py-2 border-b border-gray-700">128</td>

            <td class="px-3 py-2 border-b border-gray-700">256</td>

            <td class="px-3 py-2 border-b border-gray-700">128</td>

            <td class="px-3 py-2 border-b border-gray-700">14</td>

            <td class="px-3 py-2 border-b border-gray-700">10.34</td>

            <td class="px-3 py-2 border-b border-gray-700">AppendixC</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">LowMC</td>

            <td class="px-3 py-2 border-b border-gray-700">128</td>

            <td class="px-3 py-2 border-b border-gray-700">1024</td>

            <td class="px-3 py-2 border-b border-gray-700">128</td>

            <td class="px-3 py-2 border-b border-gray-700">92</td>

            <td class="px-3 py-2 border-b border-gray-700">2.7</td>

            <td class="px-3 py-2 border-b border-gray-700">AppendixC</td>

          </tr>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">|  Lightweight security  |   |   |   |   |   |   |</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">---</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">---</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">---</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">---</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">---</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">---</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">---</th>

          </tr>

        </thead>

        <tbody>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">PrintCipher-48</td>

            <td class="px-3 py-2 border-b border-gray-700">80</td>

            <td class="px-3 py-2 border-b border-gray-700">48</td>

            <td class="px-3 py-2 border-b border-gray-700">48</td>

            <td class="px-3 py-2 border-b border-gray-700">48</td>

            <td class="px-3 py-2 border-b border-gray-700">48</td>

            <td class="px-3 py-2 border-b border-gray-700">AppendixC</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">Present</td>

            <td class="px-3 py-2 border-b border-gray-700">80 or 128</td>

            <td class="px-3 py-2 border-b border-gray-700">64</td>

            <td class="px-3 py-2 border-b border-gray-700">64</td>

            <td class="px-3 py-2 border-b border-gray-700">62 (93)</td>

            <td class="px-3 py-2 border-b border-gray-700">62 (31)</td>

            <td class="px-3 py-2 border-b border-gray-700">AppendixF ([CHM11])</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">Simon</td>

            <td class="px-3 py-2 border-b border-gray-700">96</td>

            <td class="px-3 py-2 border-b border-gray-700">64</td>

            <td class="px-3 py-2 border-b border-gray-700">64</td>

            <td class="px-3 py-2 border-b border-gray-700">42</td>

            <td class="px-3 py-2 border-b border-gray-700">21</td>

            <td class="px-3 py-2 border-b border-gray-700">[BSS+13]</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">Simon</td>

            <td class="px-3 py-2 border-b border-gray-700">64</td>

            <td class="px-3 py-2 border-b border-gray-700">32</td>

            <td class="px-3 py-2 border-b border-gray-700">32</td>

            <td class="px-3 py-2 border-b border-gray-700">32</td>

            <td class="px-3 py-2 border-b border-gray-700">16</td>

            <td class="px-3 py-2 border-b border-gray-700">[BSS+13]</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">Prince</td>

            <td class="px-3 py-2 border-b border-gray-700">128</td>

            <td class="px-3 py-2 border-b border-gray-700">64</td>

            <td class="px-3 py-2 border-b border-gray-700">64</td>

            <td class="px-3 py-2 border-b border-gray-700">24</td>

            <td class="px-3 py-2 border-b border-gray-700">30</td>

            <td class="px-3 py-2 border-b border-gray-700">[DSES14b]</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">KATAN64</td>

            <td class="px-3 py-2 border-b border-gray-700">80</td>

            <td class="px-3 py-2 border-b border-gray-700">64</td>

            <td class="px-3 py-2 border-b border-gray-700">64</td>

            <td class="px-3 py-2 border-b border-gray-700">74</td>

            <td class="px-3 py-2 border-b border-gray-700">36</td>

            <td class="px-3 py-2 border-b border-gray-700">[CDK09]</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">KATAN48</td>

            <td class="px-3 py-2 border-b border-gray-700">80</td>

            <td class="px-3 py-2 border-b border-gray-700">48</td>

            <td class="px-3 py-2 border-b border-gray-700">48</td>

            <td class="px-3 py-2 border-b border-gray-700">74</td>

            <td class="px-3 py-2 border-b border-gray-700">32</td>

            <td class="px-3 py-2 border-b border-gray-700">[CDK09]</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">KATAN32</td>

            <td class="px-3 py-2 border-b border-gray-700">80</td>

            <td class="px-3 py-2 border-b border-gray-700">32</td>

            <td class="px-3 py-2 border-b border-gray-700">32</td>

            <td class="px-3 py-2 border-b border-gray-700">64</td>

            <td class="px-3 py-2 border-b border-gray-700">24</td>

            <td class="px-3 py-2 border-b border-gray-700">[CDK09]</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">DES</td>

            <td class="px-3 py-2 border-b border-gray-700">56</td>

            <td class="px-3 py-2 border-b border-gray-700">64</td>

            <td class="px-3 py-2 border-b border-gray-700">56</td>

            <td class="px-3 py-2 border-b border-gray-700">261</td>

            <td class="px-3 py-2 border-b border-gray-700">284</td>

            <td class="px-3 py-2 border-b border-gray-700">[TS]</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">LowMC</td>

            <td class="px-3 py-2 border-b border-gray-700">80</td>

            <td class="px-3 py-2 border-b border-gray-700">256</td>

            <td class="px-3 py-2 border-b border-gray-700">64</td>

            <td class="px-3 py-2 border-b border-gray-700">12</td>

            <td class="px-3 py-2 border-b border-gray-700">6.89</td>

            <td class="px-3 py-2 border-b border-gray-700">AppendixC</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">LowMC</td>

            <td class="px-3 py-2 border-b border-gray-700">80</td>

            <td class="px-3 py-2 border-b border-gray-700">1024</td>

            <td class="px-3 py-2 border-b border-gray-700">64</td>

            <td class="px-3 py-2 border-b border-gray-700">85</td>

            <td class="px-3 py-2 border-b border-gray-700">2.49</td>

            <td class="px-3 py-2 border-b border-gray-700">AppendixC</td>

          </tr>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">|  Allowing attacks with data and time complexity up to 2256  |   |   |   |   |   |   |</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">---</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">---</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">---</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">---</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">---</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">---</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">---</th>

          </tr>

        </thead>

        <tbody>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">LowMC</td>

            <td class="px-3 py-2 border-b border-gray-700">256</td>

            <td class="px-3 py-2 border-b border-gray-700">1024</td>

            <td class="px-3 py-2 border-b border-gray-700">256</td>

            <td class="px-3 py-2 border-b border-gray-700">103</td>

            <td class="px-3 py-2 border-b border-gray-700">3.02</td>

            <td class="px-3 py-2 border-b border-gray-700">AppendixC</td>

          </tr>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">Table 2. Comparison of ciphers (excluding key schedule). We list the depth-optimized variants; size-optimized variants are given in () if available. Best in class are marked in bold.</p>

    <p class="text-gray-300">higher-order attacks and interpolation attacks. The discussion is accompanied by experimental evaluation of small-scale version of LowMC.</p>

    <p class="text-gray-300">Building up on this, we will finally formulate a relatively simple expression for deriving an estimate for the number of rounds needed for a desired security level.</p>

    <p class="text-gray-300">In differential cryptanalysis [BS91], the principal goal is to find a pair  <span class="math">(\\alpha, \\beta)</span>  of an input difference  <span class="math">\\alpha</span>  and an output difference  <span class="math">\\beta</span>  for the cipher such that pairs of input texts with difference  <span class="math">\\alpha</span>  have an unusual high probability to produce output texts with difference  <span class="math">\\beta</span> . Such a pair of differences is called a differential. A good differential can be used to mount distinguishing attacks as well as key recovery attacks on the cipher. For this it suffices if the differential does not cover the whole cipher but all except one or a few rounds.</p>

    <p class="text-gray-300">As it is infeasible to calculate the probability of differentials for most ciphers, the cryptanalyst often has to be content with finding good differential characteristics i.e., paths of differences through the cipher for which the probability can directly be calculated. Note that a differential is made up of all differential characteristics that have the same input and output difference as the differential. The probability of a good differential characteristic is thus a lower bound for the related differential.</p>

    <p class="text-gray-300">Allowing parts of the state to go unchanged through the Sbox layer clearly increases the chance of good differential characteristics. It is for example always possible to find a one round characteristic of probability 1. In fact, it is even possible to find  <span class="math">\\lceil \\frac{l}{3m} \\rceil</span> -round characteristics of probability 1 where  <span class="math">l</span>  is the width of the identity part and  <span class="math">m</span>  the number of 3-bit Sboxes. Nonetheless, as we will prove in the following, this poses no threat. This is because of the</p>

    <p class="text-gray-300">randomness of the linear layer which maps a fixed subspace to a random subspace of the same dimension: Most “good” differences i.e., differences that activate none or only few Sboxes, are mapped to “bad” differences that activate most of the Sboxes per layer. This causes the number of characteristics that only use “good” differences to decay exponentially with the number of rounds. In the case of a <span class="math">\\lceil\\frac{l}{3m}\\rceil</span>-round characteristic of probability 1, this means that the output difference is fixed to very few options, which makes it then already in the next round extremely unlikely that any one of the options is mapped onto a “good” difference.</p>

    <p class="text-gray-300">We will now prove that good differential characteristics exist only with negligible probability in LowMC after a low number of rounds. The basic idea behind the proof is the following. We calculate for each possible good differential characteristic over <span class="math">r</span> rounds the probability that it is realized in an instantiation of LowMC under the assumption that the binary matrices of the linear layer were chosen independently and uniformly at random. By evaluating the sum of these probabilities, which is an upper bound for the probability that any good characteristic exists, we can test that this probability is negligible for a given number of rounds.</p>

    <p class="text-gray-300">Recall that <span class="math">m</span> is the number of Sboxes in one Sbox layer in LowMC and that <span class="math">l</span> is the bit-length of the identity part of the Sbox layer. We thus have <span class="math">n=3m+l</span>. Let <span class="math">V(i)</span> be the number of bit vectors of length <span class="math">n</span> that correspond to differences that activate exactly <span class="math">i</span> Sboxes. As we can choose <span class="math">i</span> out of the <span class="math">m</span> Sboxes, as for each active 3-bit Sbox there are 7 possible non-zero input differences, and as the bits of the identity part can be chosen freely, we have</p>

    <p class="text-gray-300"><span class="math">V(i)=\\binom{m}{i}\\cdot 7^{i}\\cdot 2^{l}\\enspace.</span> (1)</p>

    <p class="text-gray-300">Let <span class="math">\\alpha_{0}</span> be an input difference and let <span class="math">\\alpha_{1}</span> be an output difference for one round of LowMC. Let <span class="math">a_{0}</span> be the number of Sboxes activated by <span class="math">\\alpha_{0}</span>. As an active Sbox maps its non-zero input difference to four possible output differences each with probability <span class="math">\\frac{1}{4}</span>, and as a uniformly randomly chosen invertible binary <span class="math">n\\times n</span> matrix maps a given non-zero <span class="math">n</span>-bit vector with probability <span class="math">\\frac{1}{2^{n}-1}</span> to another given non-zero output vector, the probability that the one-round characteristic <span class="math">(\\alpha_{0},\\alpha_{1})</span> has a non-zero probability in a random instantiation of LowMC is</p>

    <p class="text-gray-300"><span class="math">\\frac{4^{a_{0}}}{2^{n}-1}\\enspace.</span> (2)</p>

    <p class="text-gray-300">Let <span class="math">(\\alpha_{0},\\alpha_{1},\\ldots,\\alpha_{r})</span> now be a given characteristic over <span class="math">r</span> rounds where the differences <span class="math">\\alpha_{i}</span> are the output differences of round <span class="math">i</span> and <span class="math">\\alpha_{0}</span> is the starting difference. Let <span class="math">(a_{0},a_{1},\\ldots,a_{r-1})</span> be the numbers of Sboxes activated by each <span class="math">\\alpha_{0}</span>, <span class="math">\\alpha_{1}</span>,…, and <span class="math">\\alpha_{r-1}</span>. We can now calculate the probability that this characteristic has a non-zero probability in a random instantiation of LowMC as</p>

    <p class="text-gray-300"><span class="math">\\frac{4^{a_{0}}}{2^{n}-1}\\cdot\\frac{4^{a_{1}}}{2^{n}-1}\\cdots\\frac{4^{a_{r-1}}}{2^{n}-1}=\\frac{4^{a_{0}+a_{1}+\\cdots+a_{r-1}}}{(2^{n}-1)^{r}}\\enspace.</span> (3)</p>

    <p class="text-gray-300">Summing this probability now for all possible characteristics over <span class="math">r</span> rounds that activate at most <span class="math">d</span> Sboxes, gives us an upper bound for the probability that there exists any <span class="math">r</span>-round characteristic with <span class="math">d</span> or fewer active Sboxes. This sum is then</p>

    <p class="text-gray-300">\\[ \\sum_{\\begin{subarray}{c}0\\leq a_{0},a_{1},\\ldots,a_{r-1}\\leq m\\\\ a_{0}+a_{1}+\\cdots+a_{r-1}\\leq d\\end{subarray}}V(a_{0})\\cdot V(a_{1})\\cdots V(a_{r-1})\\cdot(2^{n}-1)\\cdot\\frac{4^{a_{0}+a_{1}+\\cdots+a_{r-1}}}{(2^{n}-1)^{r}} \\] (4)</p>

    <p class="text-gray-300">where the factor <span class="math">(2^{n}-1)</span> is the number of choices for the last difference <span class="math">\\alpha_{r}</span> that can take any non-zero value.</p>

    <p class="text-gray-300">With the knowledge that each active Sbox reduces the probability of a characteristic by a factor of <span class="math">2^{-2}</span>, we can now calculate for each parameter set of LowMC the number of rounds</p>

    <p class="text-gray-300">after which any good differential characteristic is present only with a negligible probability. We consider as good differential characteristics those with a probability higher than  <span class="math">2^{-d}</span> , where  <span class="math">d</span>  is the allowed data complexity in the respective parameter set. We call a negligible probability a probability lower than  <span class="math">2^{-100}</span> . Note that this probability only comes into play once when fixing an instantiation of LowMC. <span class="math">^9</span>  The calculated bound for our choice of parameters can be found in Table 4.</p>

    <p class="text-gray-300">Table 3. Example of how the probability bound  <span class="math">p_{\\mathrm{stat}}</span> , for the existence of differential or linear characteristic of probability at least  <span class="math">2^{-d}</span> , evolves. The parameters are here  <span class="math">m = 42</span> ,  <span class="math">d = 128</span> .</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Rounds</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">1 - 6</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">7</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">8</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">9</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">10</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">11</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">12</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">13</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">14</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">15</th>

          </tr>

        </thead>

        <tbody>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">n = 256</td>

            <td class="px-3 py-2 border-b border-gray-700">1.0</td>

            <td class="px-3 py-2 border-b border-gray-700">2-100</td>

            <td class="px-3 py-2 border-b border-gray-700">2-212</td>

            <td class="px-3 py-2 border-b border-gray-700">2-326</td>

            <td class="px-3 py-2 border-b border-gray-700">2-442</td>

            <td class="px-3 py-2 border-b border-gray-700">2-558</td>

            <td class="px-3 py-2 border-b border-gray-700">2-676</td>

            <td class="px-3 py-2 border-b border-gray-700">2-794</td>

            <td class="px-3 py-2 border-b border-gray-700">2-913</td>

            <td class="px-3 py-2 border-b border-gray-700">-</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">n = 1024</td>

            <td class="px-3 py-2 border-b border-gray-700">1.0</td>

            <td class="px-3 py-2 border-b border-gray-700">1.0</td>

            <td class="px-3 py-2 border-b border-gray-700">1.0</td>

            <td class="px-3 py-2 border-b border-gray-700">1.0</td>

            <td class="px-3 py-2 border-b border-gray-700">1.0</td>

            <td class="px-3 py-2 border-b border-gray-700">1.0</td>

            <td class="px-3 py-2 border-b border-gray-700">1.0</td>

            <td class="px-3 py-2 border-b border-gray-700">2-26</td>

            <td class="px-3 py-2 border-b border-gray-700">2-145</td>

            <td class="px-3 py-2 border-b border-gray-700">2-264</td>

          </tr>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">In linear cryptanalysis [Mat93], the goal of the cryptanalyst is to find affine approximations of the cipher that hold sufficiently well. As with differential cryptanalysis, these can be used to mount distinguishing and key recovery attacks. The approximation is done by finding so-called linear characteristics, a concatenation of linear approximations for the consecutive rounds of the cipher. Similar to differential characteristics, linear characteristics activate Sboxes that are involved in the approximations.</p>

    <p class="text-gray-300">The proof for the absence of good differential characteristics is directly transferable to linear characteristics because of two facts. Firstly, the maximal square correlation of an approximation over one Sbox is  <span class="math">2^{-2}</span> , just the same as the maximal differential probability. Secondly, the transpose of a uniformly randomly chosen invertible binary matrix is still a uniformly randomly chosen invertible binary matrix. Thus we can use equation 4 to calculate the bounds for good linear characteristics as well.</p>

    <p class="text-gray-300">In boomerang attacks [Wag99], good partial differential characteristics that cover only part of the cipher can be combined to attack ciphers that might be immune to standard differential cryptanalysis. In these attacks, two differential characteristics are combined, one that covers the first part of the cipher and another that covers the second part. If both have about the same probability, the complexity corresponds roughly to the inverse of the product of the square of each of their probabilities [Wag99]. Thus to calculate the number of rounds sufficient to ensure that no good boomerang exists, we determine the number of rounds after which we cannot separate the cipher into two parts and find a differential for each such that the product of their probabilities is less than  <span class="math">2^{-d/2}</span> .</p>

    <p class="text-gray-300">To prevent higher-order attacks such as [Knu94] and [DS09] ideally we would like to be able to make a statement such as</p>

    <p class="text-gray-300"><span class="math">r</span> rounds there is no output bit and no input subspace of dimension <span class="math">d</span> such that the derivative of the polynomial representation of the output bit with respect to this subspace is the zero-polynomial.</p>

    <p class="text-gray-300">As it seems very difficult to determine whether such a statement holds, we approximate it in the following.</p>

    <p class="text-gray-300">First we determine a bound on the number of rounds needed for terms of degree <span class="math">d</span> to appear. As we will see later, an upper bound for the degree of the encryption function dependent on the number of rounds can be stated recursively as follows. If the degree after <span class="math">r</span> rounds is <span class="math">d</span> then the degree after <span class="math">r+1</span> rounds is at most</p>

    <p class="text-gray-300"><span class="math">\\min\\left(2d,m+d,\\frac{n}{2}+\\frac{d}{2}\\right).</span> (5)</p>

    <p class="text-gray-300">We believe that this bound is tight (or at least close to tight) in LowMC in the following way: If the bound suggests that after <span class="math">r</span> rounds the degree is at most <span class="math">d</span>, the polynomial representation of any output bit will contain at least one term of degree <span class="math">d</span>. While clearly there are terms of degree <span class="math">d</span> that can impossibly be realized, we believe that the large number of possible ways to construct terms of degree <span class="math">d</span> and the random nature of the linear layer will cause at least one to be realized.</p>

    <p class="text-gray-300">Now one problem remains. If we know that a term of degree <span class="math">d</span> exists, we can still take the derivative with respect to one variable that is not in the term to ensure that it vanishes. Thus we need to prepend a certain number of rounds that ensures that the term of degree <span class="math">d</span> depends on all input bits. Or in other words, that all terms of order <span class="math">d</span> are realized in the polynomial of the output bit with some probability.</p>

    <p class="text-gray-300">As such an estimate for the number of rounds which need to be prepended, we use the number of rounds needed for one input bit to influence all output bits. We approximate this as follows. An average input bit activates <span class="math">\\frac{7}{8}</span> of all <span class="math">m</span> S-boxes. Thus after one round the dimension of the linear space that this bit influences is on average <span class="math">\\frac{7m}{8}</span>. As the linear layer is random, we can assume that this bound grows linearly, such that after <span class="math">\\left\\lceil\\frac{8n}{7m}\\right\\rceil</span> rounds, we expect that on average all bits are influenced. Prepending this number of rounds should give a good estimate for the number of rounds needed so that no higer-order derivatives of our chosen degree give us a zero-polynomial in any output bit.</p>

    <h4 id="sec-30" class="text-lg font-semibold mt-6">Estimating the growth of the degree</h4>

    <p class="text-gray-300">Due to its small width of only 3-bit, the degree of the Sbox in its algebraic representation is only two. Since in one round the Sboxes are applied in parallel and since the affine layer does not change the algebraic degree, the algebraic degree of one round is two as well. As a low degree could be used as a lever for a higher-order attack, let us take a look at how the algebraic degree of LowMC develops over several rounds.</p>

    <p class="text-gray-300">Clearly the algebraic degree of the cipher after <span class="math">r</span> rounds is bounded from above by <span class="math">2^{r}</span>. It is furthermore generally bounded from above by <span class="math">n-1</span> since the cipher is a permutation. A second upper bound, that is better suited and certainly more realistic for the later rounds, was found by Boura, Canteaut, and De Cannière <em>[x1]</em>. In our case it is stated as following: If the cipher has degree <span class="math">d_{r}</span> after <span class="math">r</span> rounds, the degree after round <span class="math">r+1</span> is at most <span class="math">\\frac{n}{2}+\\frac{d_{r}}{2}</span>. Differing from <em>[x1]</em>, in LowMC the Sbox layer only partially consists of Sboxes and partially of the identity mapping. This must be accounted for and requires a third bound: If the cipher has degree <span class="math">d_{r}</span> after <span class="math">r</span> rounds, the degree after round <span class="math">r+1</span> is at most <span class="math">m+d_{r}</span>. A proof of this can be found in Secion E. This can be summarized as follows:</p>

    <h6 id="sec-31" class="text-base font-medium mt-4">Lemma 1.</h6>

    <p class="text-gray-300">If the algebraic degree of LowMC with <span class="math">m</span> Sboxes and length <span class="math">l</span> of the identity part in the Sbox layer is <span class="math">d_{r}</span> after <span class="math">r</span> rounds, the degree in round <span class="math">r+1</span> is at most</p>

    <p class="text-gray-300"><span class="math">\\min\\left(2d_{r},m+d_{r},\\frac{n}{2}+\\frac{d_{r}}{2}\\right)</span> (6)</p>

    <p class="text-gray-300">where <span class="math">n=3m+l</span> is the block width of LowMC.</p>

    <p class="text-gray-300">Combining these three bounds, we can easily calculate lower bounds for the number of rounds <span class="math">r</span> needed for different parameter sets <span class="math">l</span> and <span class="math">m</span> of LowMC to reach a degree that is at least as large as the allowed data complexity <span class="math">d</span> minus 1. The results of this for LowMC’s parameters are displayed in Table 4.</p>

    <p class="text-gray-300">Table 4: For the different sets of LowMC parameters, bounds are given for the number of rounds for which no good differential or linear characteristics exist (<span class="math">r_{\\text{stat}}</span>), to avoid good boomerangs (<span class="math">r_{\\text{bmrg}}</span>), and the number of rounds needed to have a sufficiently high algebraic degree (<span class="math">r_{\\text{deg}}</span>). The bounds were calculated using Equations 4 and 6.</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Sboxes</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">blocksize</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">data complexity</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"><span class="math">r_{\\text{stat}}</span></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"><span class="math">r_{\\text{bmrg}}</span></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"><span class="math">r_{\\text{deg}}</span></th>

          </tr>

        </thead>

        <tbody>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">49</td>

            <td class="px-3 py-2 border-b border-gray-700">256</td>

            <td class="px-3 py-2 border-b border-gray-700">64</td>

            <td class="px-3 py-2 border-b border-gray-700">5</td>

            <td class="px-3 py-2 border-b border-gray-700">6</td>

            <td class="px-3 py-2 border-b border-gray-700">6</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">63</td>

            <td class="px-3 py-2 border-b border-gray-700">256</td>

            <td class="px-3 py-2 border-b border-gray-700">128</td>

            <td class="px-3 py-2 border-b border-gray-700">5</td>

            <td class="px-3 py-2 border-b border-gray-700">6</td>

            <td class="px-3 py-2 border-b border-gray-700">7</td>

          </tr>

        </tbody>

      </table>

    </div>

    <h3 id="sec-32" class="text-xl font-semibold mt-8">5.5 Interpolation attack</h3>

    <p class="text-gray-300">The bound derived in this section is based on the attack on LowMC by Dinur, Liu, Meier and Wang <em>[x10]</em>.</p>

    <p class="text-gray-300">In an interpolation attack <em>[x20]</em>, we determine the polynomial representation of a state bit. This is done by combining knowledge about restrictions of this polynomial with a sufficient number of evaluations of this polynomial. More concretely, let us suppose we can determine the value of some intermediate bit in LowMC by choosing the right plaintexts. Let us furthermore assume that the polynomial representation of this bit in the ciphertext bits can only contain a restricted set of terms. When we now regard the coefficients of these terms as the unknown variables, a pair of plaintext and ciphertext will correspond to a linear equation in these variables. Using sufficiently many plaintext-ciphertext pairs, we can create enough linear independent equations to be able to solve the system of equations and hence deduce the polynomial. As the coefficients usually depend on the key bits, we gain knowledge about the key bits.</p>

    <p class="text-gray-300">Let us now estimate the time complexity of this attack. When we consider the intermediate state bits before the last round, we see that the only quadratic terms that appear are those produced by the S-boxes. As any S-box output bit contains only quadratic term, there are thus only <span class="math">3m</span> quadratic terms available. For rounds farther away from the last round, we determine the number of terms of a given degree by considering all combinations of terms of the previous round that, when multiplied, give terms of that degree.</p>

    <p class="text-gray-300">We thus receive an estimate of the number of terms of each degree for a given number of rounds before the last round. But for the correct estimate, we also need to consider the number of possible coefficients for these terms. We note that the maximal degree in the key bits of a coefficient depends on the degree of its term. For example, let us consider the polynomial of a bit</p>

    <p class="text-gray-300">before the second to last round. The maximal degree of the terms is then 4. But the coefficients cannot depend on the key bits. For the terms of the degree 3, the coefficients can only be linear in the key bits. And the terms of degree 2 can only depend quadratically on the key bits. As this limits the number of possible coefficients and thus the number of equations needed for an attack, we estimate the number of equations needed as follows: for each possible term degree, we determine how many possible terms and how many possible coefficients for these terms there are and take the minimum of both.</p>

    <p class="text-gray-300">Lastly we need to note that the complexity of the interpolation attacks depends on solving a linear system of equations in the variables. We estimate thus that a number of <span class="math">\\frac{k}{2.3}</span> variables is sufficient to make the attack more complex than bruteforcing the <span class="math">k</span> key bits since the best methods for solving a system of linear equations (which have a large overhead) have a limit exponent of 2.3.</p>

    <h3 id="sec-33" class="text-xl font-semibold mt-8">5.6 Experimental Cryptanalysis</h3>

    <p class="text-gray-300">We proved that no good differential or linear characteristic can cover sufficiently many rounds to be usable as an attack vector in LowMC. This does not exclude though the possibility of good differentials or linear hulls for which a large number of characteristics combine. Given the highly diffusive, random linear layers, this seems very unlikely.</p>

    <p class="text-gray-300">Likewise we were able to find lower bounds on the number of rounds needed for the algebraic degree of LowMC to be sufficiently high. Even though this is state-of-the art also for traditional designs to date, this gives us no guarantee that it will indeed be high. Unfortunately it is not possible to directly calculate the algebraic degree for any large block size.</p>

    <p class="text-gray-300">To nevertheless strengthen our confidence in the design, we numerically examined the properties of small-scale versions of LowMC. In Table 5, we find the results for a 24-bit wide version with 4 Sboxes. For testing its resistance against differential cryptanalysis, we calculated the full codebook under 100 randomly chosen keys and used the distribution of differences to estimate the probabilities of the differentials. To reduce the computational complexity, we restricted the search space to differentials with one active bit in the input difference.</p>

    <p class="text-gray-300">It can clearly be seen that the probability of differentials quickly saturates to values too low to allow an attack. Clearly, the bound calculated with equation 4 (<span class="math">p_{\\text{stat}}</span> in the table) overestimates the probability of good characteristics. Even though we were not able to search the whole space of differentials there is little reason to assume that there are other differentials that fare considerably better. It is important to note that the number of impossible differentials goes to 0 after only few rounds. Thus impossible differentials cannot be used to attack any relevant number of rounds. At the same time this assures the absence of any truncated differentials of probability 1.</p>

    <p class="text-gray-300">The minimal algebraic degree is tight for this version when compared with the theoretic upper bound as determined with equation 6.</p>

    <p class="text-gray-300">For the version with only 2 Sboxes the degree deviates for some round numbers from the theoretic bound which is not too surprising considering the size of the cipher. It can beexpected that with increasing block size – and with the thereby quadraticallyincreasing random matrices – the bound is more likely to hold.</p>

    <h3 id="sec-34" class="text-xl font-semibold mt-8">5.7 Determining the number of rounds needed for security</h3>

    <p class="text-gray-300">The design goal of LowMC is to offer a cipher optimized for schemes whose performance critically depends on the ANDdepth, the number of ANDs or the number of ANDs per bit. We thus tried</p>

    <p class="text-gray-300">Table 5. Experimental results of full codebook encryption over 100 random keys for a set of small parameters are given.  <span class="math">p_{\\mathrm{best}}</span>  and  <span class="math">p_{\\mathrm{worst}}</span>  are the best and the worst approximate differential probability of any differential with one active bit in the input difference.  <span class="math">n_{\\mathrm{imposs}}</span>  is the number of impossible differentials with one active bit in the input difference.  <span class="math">\\deg_{\\mathrm{exp}}</span>  is the minimal algebraic degree in any of the output bits.  <span class="math">\\deg_{\\mathrm{theor}}</span>  is the upper bound for the algebraic degree as determined from equation 6.  <span class="math">p_{\\mathrm{stat}}</span>  is the probability that a differential or linear characteristic of probability at least  <span class="math">2^{-12}</span>  exists (see eq. 4).</p>

    <p class="text-gray-300">|  n = 24, m = 4, k = 12, d = 12  |   |   |   |   |   |   |</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">---</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">---</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">---</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">---</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">---</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">---</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">---</th>

          </tr>

        </thead>

        <tbody>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">2</td>

            <td class="px-3 py-2 border-b border-gray-700">2-8.64</td>

            <td class="px-3 py-2 border-b border-gray-700">0</td>

            <td class="px-3 py-2 border-b border-gray-700">228.58</td>

            <td class="px-3 py-2 border-b border-gray-700">4</td>

            <td class="px-3 py-2 border-b border-gray-700">4</td>

            <td class="px-3 py-2 border-b border-gray-700">-</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">3</td>

            <td class="px-3 py-2 border-b border-gray-700">2-12.64</td>

            <td class="px-3 py-2 border-b border-gray-700">0</td>

            <td class="px-3 py-2 border-b border-gray-700">228.00</td>

            <td class="px-3 py-2 border-b border-gray-700">8</td>

            <td class="px-3 py-2 border-b border-gray-700">8</td>

            <td class="px-3 py-2 border-b border-gray-700">-</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">4</td>

            <td class="px-3 py-2 border-b border-gray-700">2-14.64</td>

            <td class="px-3 py-2 border-b border-gray-700">0</td>

            <td class="px-3 py-2 border-b border-gray-700">24.25</td>

            <td class="px-3 py-2 border-b border-gray-700">12</td>

            <td class="px-3 py-2 border-b border-gray-700">12</td>

            <td class="px-3 py-2 border-b border-gray-700">-</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">5</td>

            <td class="px-3 py-2 border-b border-gray-700">2-18.60</td>

            <td class="px-3 py-2 border-b border-gray-700">2-26.06</td>

            <td class="px-3 py-2 border-b border-gray-700">0</td>

            <td class="px-3 py-2 border-b border-gray-700">16</td>

            <td class="px-3 py-2 border-b border-gray-700">16</td>

            <td class="px-3 py-2 border-b border-gray-700">-</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">6</td>

            <td class="px-3 py-2 border-b border-gray-700">2-20.49</td>

            <td class="px-3 py-2 border-b border-gray-700">2-25.84</td>

            <td class="px-3 py-2 border-b border-gray-700">0</td>

            <td class="px-3 py-2 border-b border-gray-700">20</td>

            <td class="px-3 py-2 border-b border-gray-700">20</td>

            <td class="px-3 py-2 border-b border-gray-700">-</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">7</td>

            <td class="px-3 py-2 border-b border-gray-700">2-23.03</td>

            <td class="px-3 py-2 border-b border-gray-700">2-25.74</td>

            <td class="px-3 py-2 border-b border-gray-700">0</td>

            <td class="px-3 py-2 border-b border-gray-700">22</td>

            <td class="px-3 py-2 border-b border-gray-700">22</td>

            <td class="px-3 py-2 border-b border-gray-700">-</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">8</td>

            <td class="px-3 py-2 border-b border-gray-700">2-23.06</td>

            <td class="px-3 py-2 border-b border-gray-700">2-25.74</td>

            <td class="px-3 py-2 border-b border-gray-700">0</td>

            <td class="px-3 py-2 border-b border-gray-700">23</td>

            <td class="px-3 py-2 border-b border-gray-700">23</td>

            <td class="px-3 py-2 border-b border-gray-700">-</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">10</td>

            <td class="px-3 py-2 border-b border-gray-700">-</td>

            <td class="px-3 py-2 border-b border-gray-700">-</td>

            <td class="px-3 py-2 border-b border-gray-700">-</td>

            <td class="px-3 py-2 border-b border-gray-700">-</td>

            <td class="px-3 py-2 border-b border-gray-700">-</td>

            <td class="px-3 py-2 border-b border-gray-700">2-5.91</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">11</td>

            <td class="px-3 py-2 border-b border-gray-700">-</td>

            <td class="px-3 py-2 border-b border-gray-700">-</td>

            <td class="px-3 py-2 border-b border-gray-700">-</td>

            <td class="px-3 py-2 border-b border-gray-700">-</td>

            <td class="px-3 py-2 border-b border-gray-700">-</td>

            <td class="px-3 py-2 border-b border-gray-700">2-16.00</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">12</td>

            <td class="px-3 py-2 border-b border-gray-700">-</td>

            <td class="px-3 py-2 border-b border-gray-700">-</td>

            <td class="px-3 py-2 border-b border-gray-700">-</td>

            <td class="px-3 py-2 border-b border-gray-700">-</td>

            <td class="px-3 py-2 border-b border-gray-700">-</td>

            <td class="px-3 py-2 border-b border-gray-700">2-26.28</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">19</td>

            <td class="px-3 py-2 border-b border-gray-700">-</td>

            <td class="px-3 py-2 border-b border-gray-700">-</td>

            <td class="px-3 py-2 border-b border-gray-700">-</td>

            <td class="px-3 py-2 border-b border-gray-700">-</td>

            <td class="px-3 py-2 border-b border-gray-700">-</td>

            <td class="px-3 py-2 border-b border-gray-700">2-101.5</td>

          </tr>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">|  n = 24, m = 2, k = 12, d = 12  |   |   |   |   |   |   |</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">---</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">---</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">---</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">---</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">---</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">---</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">---</th>

          </tr>

        </thead>

        <tbody>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">4</td>

            <td class="px-3 py-2 border-b border-gray-700">2-8.64</td>

            <td class="px-3 py-2 border-b border-gray-700">0</td>

            <td class="px-3 py-2 border-b border-gray-700">228.55</td>

            <td class="px-3 py-2 border-b border-gray-700">6</td>

            <td class="px-3 py-2 border-b border-gray-700">8</td>

            <td class="px-3 py-2 border-b border-gray-700">-</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">5</td>

            <td class="px-3 py-2 border-b border-gray-700">2-12.62</td>

            <td class="px-3 py-2 border-b border-gray-700">0</td>

            <td class="px-3 py-2 border-b border-gray-700">228.17</td>

            <td class="px-3 py-2 border-b border-gray-700">10</td>

            <td class="px-3 py-2 border-b border-gray-700">10</td>

            <td class="px-3 py-2 border-b border-gray-700">-</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">6</td>

            <td class="px-3 py-2 border-b border-gray-700">2-12.64</td>

            <td class="px-3 py-2 border-b border-gray-700">0</td>

            <td class="px-3 py-2 border-b border-gray-700">224.93</td>

            <td class="px-3 py-2 border-b border-gray-700">10</td>

            <td class="px-3 py-2 border-b border-gray-700">12</td>

            <td class="px-3 py-2 border-b border-gray-700">-</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">7</td>

            <td class="px-3 py-2 border-b border-gray-700">2-14.64</td>

            <td class="px-3 py-2 border-b border-gray-700">0</td>

            <td class="px-3 py-2 border-b border-gray-700">24.75</td>

            <td class="px-3 py-2 border-b border-gray-700">14</td>

            <td class="px-3 py-2 border-b border-gray-700">14</td>

            <td class="px-3 py-2 border-b border-gray-700">-</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">8</td>

            <td class="px-3 py-2 border-b border-gray-700">2-16.63</td>

            <td class="px-3 py-2 border-b border-gray-700">2-26.47</td>

            <td class="px-3 py-2 border-b border-gray-700">0</td>

            <td class="px-3 py-2 border-b border-gray-700">14</td>

            <td class="px-3 py-2 border-b border-gray-700">16</td>

            <td class="px-3 py-2 border-b border-gray-700">-</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">9</td>

            <td class="px-3 py-2 border-b border-gray-700">2-16.64</td>

            <td class="px-3 py-2 border-b border-gray-700">2-26.06</td>

            <td class="px-3 py-2 border-b border-gray-700">0</td>

            <td class="px-3 py-2 border-b border-gray-700">16</td>

            <td class="px-3 py-2 border-b border-gray-700">18</td>

            <td class="px-3 py-2 border-b border-gray-700">-</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">10</td>

            <td class="px-3 py-2 border-b border-gray-700">2-20.34</td>

            <td class="px-3 py-2 border-b border-gray-700">2-25.84</td>

            <td class="px-3 py-2 border-b border-gray-700">0</td>

            <td class="px-3 py-2 border-b border-gray-700">18</td>

            <td class="px-3 py-2 border-b border-gray-700">20</td>

            <td class="px-3 py-2 border-b border-gray-700">-</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">11</td>

            <td class="px-3 py-2 border-b border-gray-700">2-20.50</td>

            <td class="px-3 py-2 border-b border-gray-700">2-25.84</td>

            <td class="px-3 py-2 border-b border-gray-700">0</td>

            <td class="px-3 py-2 border-b border-gray-700">22</td>

            <td class="px-3 py-2 border-b border-gray-700">22</td>

            <td class="px-3 py-2 border-b border-gray-700">-</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">12</td>

            <td class="px-3 py-2 border-b border-gray-700">2-22.94</td>

            <td class="px-3 py-2 border-b border-gray-700">2-26.06</td>

            <td class="px-3 py-2 border-b border-gray-700">0</td>

            <td class="px-3 py-2 border-b border-gray-700">22</td>

            <td class="px-3 py-2 border-b border-gray-700">23</td>

            <td class="px-3 py-2 border-b border-gray-700">-</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">20</td>

            <td class="px-3 py-2 border-b border-gray-700">-</td>

            <td class="px-3 py-2 border-b border-gray-700">-</td>

            <td class="px-3 py-2 border-b border-gray-700">-</td>

            <td class="px-3 py-2 border-b border-gray-700">-</td>

            <td class="px-3 py-2 border-b border-gray-700">-</td>

            <td class="px-3 py-2 border-b border-gray-700">2-5.91</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">21</td>

            <td class="px-3 py-2 border-b border-gray-700">-</td>

            <td class="px-3 py-2 border-b border-gray-700">-</td>

            <td class="px-3 py-2 border-b border-gray-700">-</td>

            <td class="px-3 py-2 border-b border-gray-700">-</td>

            <td class="px-3 py-2 border-b border-gray-700">-</td>

            <td class="px-3 py-2 border-b border-gray-700">2-10.93</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">22</td>

            <td class="px-3 py-2 border-b border-gray-700">-</td>

            <td class="px-3 py-2 border-b border-gray-700">-</td>

            <td class="px-3 py-2 border-b border-gray-700">-</td>

            <td class="px-3 py-2 border-b border-gray-700">-</td>

            <td class="px-3 py-2 border-b border-gray-700">-</td>

            <td class="px-3 py-2 border-b border-gray-700">2-16.00</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">38</td>

            <td class="px-3 py-2 border-b border-gray-700">-</td>

            <td class="px-3 py-2 border-b border-gray-700">-</td>

            <td class="px-3 py-2 border-b border-gray-700">-</td>

            <td class="px-3 py-2 border-b border-gray-700">-</td>

            <td class="px-3 py-2 border-b border-gray-700">-</td>

            <td class="px-3 py-2 border-b border-gray-700">2-101.5</td>

          </tr>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">to be as close to the number of rounds needed for security as possible. Based on our discussion of different attack vectors above, our recommendation for the number of rounds is hence the following:</p>

    <div class="my-4 text-center"><span class="math-block">r \\geq \\max  \\left(r _ {\\text {s t a t}}, r _ {\\text {b m r g}}, r _ {\\text {d e g}} + r _ {\\text {d i f f}}\\right) + r _ {\\text {o u t e r}}</span></div>

    <p class="text-gray-300">where  <span class="math">r_{\\mathrm{stat}}</span>  is a bound for statistical attack vectors such as differentials and linear characteristics as discussed in Section 5.1,  <span class="math">r_{\\mathrm{bmrng}}</span>  is the bound for boomerang attacks as discussed in Section 5.3,  <span class="math">r_{\\mathrm{deg}}</span>  indicates the number of rounds needed for the cipher to have sufficient degree and where  <span class="math">r_{\\mathrm{diff}}</span>  denotes the number of rounds needed for full diffusion as discussed in Section 5.4. Values of these for the parameters of LowMC can be found in Table 4. For the number of rounds which can be peeled off at the beginning and end of the cipher by key guessing and other strategies, we use the ad-hoc formula  <span class="math">r_{\\mathrm{outer}} = r_{\\mathrm{interpol}}</span>  where  <span class="math">r_{\\mathrm{interpol}}</span>  denotes number of rounds that can be peeled off by an interpolation attack as discussed in Section 5.5.</p>

    <p class="text-gray-300">In the following we report on experiments when evaluating LowMC with MPC protocols in Section 6.1 and with FHE in Section 6.2. The performance of both implementations is independent of the specific choice of the random matrices and vectors used in LowMC (cf. Section 3.3) as we do not use any optimizations that are based on their specific structure.</p>

    <p class="text-gray-300">In both the FHE and MPC settings, for more efficient matrix multiplication, we use a method that is generically better than a naive approach: the "method of the four Russians" [ABH10]. This method reduces the complexity of the matrix-vector product from  <span class="math">O(n^{2})</span>  to  <span class="math">O(n^{2} / \\log (n))</span> , i.e. it's an asymptotically faster algorithm and is also fast in practice for the dimensions we face in LowMC. Asymptotically faster methods like the Strassen-Winograd method method make no sense however, for the dimensions we are considering.</p>

    <p class="text-gray-300">It turns out that considering design-optimizations of the linear layer by introducing structure and thereby lowering the density of the matrices and in turn reducing the number of XOR computations will not improve performance of all these implementations. On the contrary,</p>

    <p class="text-gray-300">as the application of the security analysis suggests, the number of rounds would need to be increased in such a case.</p>

    <h3 id="sec-36" class="text-xl font-semibold mt-8">6.1 MPC Setting</h3>

    <p class="text-gray-300">As an example for both classes of MPC protocols described in Section 2.1 we use the GMW protocol <em>[x14]</em> in the semi-honest setting. As described in <em>[CHK^{+}12]</em>, this protocol can be partitioned into 1) a <em>setup phase</em> with a constant number of rounds and communication linear in the MC of the circuit (<span class="math">2\\kappa</span> bits per AND gate for <span class="math">\\kappa</span>-bit security), and 2) an <em>online phase</em> whose round complexity is linear in the ANDdepth of the circuit. Hence, we expect that the setup time grows linearly in the MC while the online time grows mostly with increasing ANDdepth when network latency is high.</p>

    <h4 id="sec-37" class="text-lg font-semibold mt-6">Benchmark Settings.</h4>

    <p class="text-gray-300">For our MPC experiments we compare LowMC against other ciphers with a comparable level of security. We compare LowMC with the two standardized ciphers Present and AES and also with the NSA cipher Simon which previously had the lowest number of ANDs per encrypted bit (cf. Table 2). More specifically, for lightweight security with at least <span class="math">\\kappa=80</span> bit security we compare LowMC with 80 bit keys against Present with 80 bit key (using the Sbox of <em>[x6]</em>) and Simon with 96 bit keys (the Simon specification does not include a variant with 80 bit keys); for long-term security with <span class="math">\\kappa=128</span> bit security we compare LowMC with 128 bit keys against AES-128 (using the Sbox of <em>[x3]</em>) and Simon with 128 bit key; we set the security parameters for the underlying MPC protocol to <span class="math">\\kappa=80</span> bit for lightweight security and to <span class="math">\\kappa=128</span> bit for long-term security. We exclude the key schedule and directly input the pre-computed round keys. We use the GMW implementation that is available in the ABY-framework <em>[x10]</em> which uses the efficient oblivious transfer extensions of <em>[x1]</em>. We run our MPC experiments on two desktop PCs, each equipped with an Intel Haswell i7-4770K CPU with 3.5 GHz and 16GB of RAM, that are connected by Gigabit LAN. To see the impact of the reduced ANDdepth in the online phase, we measured the times in a LAN scenario (0.2 ms latency) and also a trans-atlantic WAN scenario (50 ms latency) which we simulated using the Linux command tc.</p>

    <p class="text-gray-300">In our first experiment depicted in Table 6 we encrypt a single block, whereas in our second experiment depicted in Table 7 we encrypt multiple blocks in parallel to encrypt 12.8 Mbit of data.</p>

    <h4 id="sec-38" class="text-lg font-semibold mt-6">Single-Block Results.</h4>

    <p class="text-gray-300">From our single-block experiments in Table 6 we see that the communication of LowMC is factor 1.6 lower than the next best cipher for lightweight security and factor 6 for long-term security. In terms of total runtime, for lightweight security LowMC is slower than Present and Simon by factor 3 in the LAN setting but outperforms both by factor 3 to 7 in the WAN setting. For long-term security, LowMC is slower than AES and Simon by factor 4 in the LAN setting, but again outperforms both in the WAN setting by factor 3 to 4. These results can be explained by the high number of XOR gates of LowMC compared to AES, which impact the run-time higher than the communication for the AND gates. In the WAN setting, the higher ANDdepth of AES outweighs the local overhead of the XOR gates for LowMC, yielding a faster run-time for LowMC.</p>

    <p class="text-gray-300">|  Lightweight Security  |   |   |   |   |   |   |</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">---</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">---</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">---</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">---</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">---</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">---</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">---</th>

          </tr>

        </thead>

        <tbody>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">Communication [kB]</td>

            <td class="px-3 py-2 border-b border-gray-700">39</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">26</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">16</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">Runtime</td>

            <td class="px-3 py-2 border-b border-gray-700">LAN</td>

            <td class="px-3 py-2 border-b border-gray-700">WAN</td>

            <td class="px-3 py-2 border-b border-gray-700">LAN</td>

            <td class="px-3 py-2 border-b border-gray-700">WAN</td>

            <td class="px-3 py-2 border-b border-gray-700">LAN</td>

            <td class="px-3 py-2 border-b border-gray-700">WAN</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">Setup [s]</td>

            <td class="px-3 py-2 border-b border-gray-700">0.001</td>

            <td class="px-3 py-2 border-b border-gray-700">0.05</td>

            <td class="px-3 py-2 border-b border-gray-700">0.001</td>

            <td class="px-3 py-2 border-b border-gray-700">0.05</td>

            <td class="px-3 py-2 border-b border-gray-700">0.001</td>

            <td class="px-3 py-2 border-b border-gray-700">0.05</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">Online [s]</td>

            <td class="px-3 py-2 border-b border-gray-700">0.008</td>

            <td class="px-3 py-2 border-b border-gray-700">9.31</td>

            <td class="px-3 py-2 border-b border-gray-700">0.005</td>

            <td class="px-3 py-2 border-b border-gray-700">4.21</td>

            <td class="px-3 py-2 border-b border-gray-700">0.033</td>

            <td class="px-3 py-2 border-b border-gray-700">1.23</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">Total [s]</td>

            <td class="px-3 py-2 border-b border-gray-700">0.009</td>

            <td class="px-3 py-2 border-b border-gray-700">9.36</td>

            <td class="px-3 py-2 border-b border-gray-700">0.006</td>

            <td class="px-3 py-2 border-b border-gray-700">4.26</td>

            <td class="px-3 py-2 border-b border-gray-700">0.034</td>

            <td class="px-3 py-2 border-b border-gray-700">1.29</td>

          </tr>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">|  Long-Term Security  |   |   |   |   |   |   |</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">---</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">---</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">---</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">---</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">---</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">---</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">---</th>

          </tr>

        </thead>

        <tbody>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">Communication [kB]</td>

            <td class="px-3 py-2 border-b border-gray-700">170</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">136</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">23</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">Runtime</td>

            <td class="px-3 py-2 border-b border-gray-700">LAN</td>

            <td class="px-3 py-2 border-b border-gray-700">WAN</td>

            <td class="px-3 py-2 border-b border-gray-700">LAN</td>

            <td class="px-3 py-2 border-b border-gray-700">WAN</td>

            <td class="px-3 py-2 border-b border-gray-700">LAN</td>

            <td class="px-3 py-2 border-b border-gray-700">WAN</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">Setup [s]</td>

            <td class="px-3 py-2 border-b border-gray-700">0.003</td>

            <td class="px-3 py-2 border-b border-gray-700">0.05</td>

            <td class="px-3 py-2 border-b border-gray-700">0.003</td>

            <td class="px-3 py-2 border-b border-gray-700">0.05</td>

            <td class="px-3 py-2 border-b border-gray-700">0.002</td>

            <td class="px-3 py-2 border-b border-gray-700">0.05</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">Online [s]</td>

            <td class="px-3 py-2 border-b border-gray-700">0.006</td>

            <td class="px-3 py-2 border-b border-gray-700">4.01</td>

            <td class="px-3 py-2 border-b border-gray-700">0.009</td>

            <td class="px-3 py-2 border-b border-gray-700">6.81</td>

            <td class="px-3 py-2 border-b border-gray-700">0.038</td>

            <td class="px-3 py-2 border-b border-gray-700">1.44</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">Total [s]</td>

            <td class="px-3 py-2 border-b border-gray-700">0.009</td>

            <td class="px-3 py-2 border-b border-gray-700">4.06</td>

            <td class="px-3 py-2 border-b border-gray-700">0.012</td>

            <td class="px-3 py-2 border-b border-gray-700">6.86</td>

            <td class="px-3 py-2 border-b border-gray-700">0.040</td>

            <td class="px-3 py-2 border-b border-gray-700">1.49</td>

          </tr>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">Multi-Block Results. From our multi-block experiments in Table 7 we see that LowMC needs less communication than all other ciphers: at least factor 6 for lightweight security and factor 12 for long-term security. Also the total runtime of LowMC is the lowest among all ciphers, ranging from factor 3 when compared to Simon for lightweight security to factor 8 when compared to AES for long-term security.</p>

    <p class="text-gray-300">Table 6. GMW benchmarking results for single block. Best in class marked in bold.</p>

    <p class="text-gray-300">|  Lightweight Security  |   |   |   |   |   |   |</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">---</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">---</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">---</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">---</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">---</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">---</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">---</th>

          </tr>

        </thead>

        <tbody>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">Comm. [GB]</td>

            <td class="px-3 py-2 border-b border-gray-700">7.4</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">5.0</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">0.8</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">Runtime</td>

            <td class="px-3 py-2 border-b border-gray-700">LAN</td>

            <td class="px-3 py-2 border-b border-gray-700">WAN</td>

            <td class="px-3 py-2 border-b border-gray-700">LAN</td>

            <td class="px-3 py-2 border-b border-gray-700">WAN</td>

            <td class="px-3 py-2 border-b border-gray-700">LAN</td>

            <td class="px-3 py-2 border-b border-gray-700">WAN</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">Setup [s]</td>

            <td class="px-3 py-2 border-b border-gray-700">68.08</td>

            <td class="px-3 py-2 border-b border-gray-700">83.89</td>

            <td class="px-3 py-2 border-b border-gray-700">45.16</td>

            <td class="px-3 py-2 border-b border-gray-700">55.49</td>

            <td class="px-3 py-2 border-b border-gray-700">14.6</td>

            <td class="px-3 py-2 border-b border-gray-700">18.85</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">Online [s]</td>

            <td class="px-3 py-2 border-b border-gray-700">0.91</td>

            <td class="px-3 py-2 border-b border-gray-700">10.00</td>

            <td class="px-3 py-2 border-b border-gray-700">0.59</td>

            <td class="px-3 py-2 border-b border-gray-700">5.82</td>

            <td class="px-3 py-2 border-b border-gray-700">0.91</td>

            <td class="px-3 py-2 border-b border-gray-700">1.29</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">Total [s]</td>

            <td class="px-3 py-2 border-b border-gray-700">68.99</td>

            <td class="px-3 py-2 border-b border-gray-700">93.89</td>

            <td class="px-3 py-2 border-b border-gray-700">45.75</td>

            <td class="px-3 py-2 border-b border-gray-700">61.31</td>

            <td class="px-3 py-2 border-b border-gray-700">15.5</td>

            <td class="px-3 py-2 border-b border-gray-700">20.14</td>

          </tr>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">|  Long-Term Security  |   |   |   |   |   |</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">---</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">---</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">---</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">---</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">---</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">---</th>

          </tr>

        </thead>

        <tbody>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">Comm. [GB]</td>

            <td class="px-3 py-2 border-b border-gray-700">16</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">13</td>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">1.1</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">Runtime</td>

            <td class="px-3 py-2 border-b border-gray-700">LAN</td>

            <td class="px-3 py-2 border-b border-gray-700">WAN</td>

            <td class="px-3 py-2 border-b border-gray-700">LAN</td>

            <td class="px-3 py-2 border-b border-gray-700">WAN</td>

            <td class="px-3 py-2 border-b border-gray-700">WAN</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">Setup [s]</td>

            <td class="px-3 py-2 border-b border-gray-700">101.63</td>

            <td class="px-3 py-2 border-b border-gray-700">198.53</td>

            <td class="px-3 py-2 border-b border-gray-700">73.42</td>

            <td class="px-3 py-2 border-b border-gray-700">87.13</td>

            <td class="px-3 py-2 border-b border-gray-700">22.09</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">Online [s]</td>

            <td class="px-3 py-2 border-b border-gray-700">1.29</td>

            <td class="px-3 py-2 border-b border-gray-700">4.27</td>

            <td class="px-3 py-2 border-b border-gray-700">0.95</td>

            <td class="px-3 py-2 border-b border-gray-700">7.71</td>

            <td class="px-3 py-2 border-b border-gray-700">1.58</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">Total [s]</td>

            <td class="px-3 py-2 border-b border-gray-700">102.85</td>

            <td class="px-3 py-2 border-b border-gray-700">202.85</td>

            <td class="px-3 py-2 border-b border-gray-700">74.38</td>

            <td class="px-3 py-2 border-b border-gray-700">94.84</td>

            <td class="px-3 py-2 border-b border-gray-700">23.70</td>

          </tr>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">Table 7. GMW benchmarking results for multiple blocks to encrypt 12.8 Mbit of data. Best in class marked in bold.</p>

    <p class="text-gray-300">Summary of the Results. To summarize our MPC experiments, the benefits of LowMC w.r.t. the online time depend on the network latency: over the low-latency LAN network existing ciphers achieve faster online runtimes than LowMC, whereas in the higher latency WAN network LowMC achieves the fastest online runtime. W.r.t. the total runtime, LowMC's benefit in the single-block application again depends on the latency (comparable or slightly less efficient over LAN, but more efficient over WAN), whereas in the multi-block application LowMC significantly improves over existing ciphers by factor 4 to 8. For secure computation protocols with security against malicious adversaries, the benefit of using LowMC would be even more significant, since there the costs per AND gate are at least an order of magnitude higher than in the semi-honest GMW protocol, cf. [NNOB12, LOS14].</p>

    <p class="text-gray-300">We implemented LowMC using the homomorphic encryption library HELib [HS13,HS14], which implements the BGV homomorphic encryption scheme [BGV11] and which was also used to</p>

    <p class="text-gray-300">evaluate AES-128 [GHS12a,GHS12b]. Our implementation represents each plaintext, ciphertext and key bits as individual HE ciphertexts on which XOR and AND operations are performed. Due to the nature of the BGV system this means that we can evaluate many such instances in parallel, typically a few hundred. We found this representation to be more efficient than our other "compact" implementation which packs these bits into the slots of HE ciphertexts.</p>

    <p class="text-gray-300">In the homomorphic encryption setting the number of AND gates is not the main determinant of complexity. Instead, the ANDdepth of the circuit largely determines the cost of XOR and AND, where AND is more expensive than XOR. However, due to the high number of XORs in LowMC, the cost of the linear layer is not negligible. In our implementation we use the "method of the four Russians" [ABH10] to reduce the number of HE ciphertext additions from  <span class="math">\\mathcal{O}(n^2)</span>  to  <span class="math">\\mathcal{O}(n^2 / \\log(n))</span> .</p>

    <p class="text-gray-300">In our experiments we chose the depth for the homomorphic encryption scheme such that the "base level" of fresh ciphertexts is at least the number of rounds, i.e. we consume one level per round. Our implementation also does not precompute round keys in advance, but deriving round keys is considered part of the evaluation (cost).</p>

    <p class="text-gray-300">We consider LowMC instances for Present-80 and AES-128 like security. We always choose a homomorphic encryption security level of 80 for compatibility with [GHS12b]. Our results are given in Table 8. Our implementation is available at https://bitbucket.org/malb/lowmc-helib.</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">d</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">m</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">r</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">n</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">#blocks</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">tsetup</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">teval</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">tsbox</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">tkey</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">tblock</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">tbit</th>

          </tr>

        </thead>

        <tbody>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">128</td>

            <td class="px-3 py-2 border-b border-gray-700">63</td>

            <td class="px-3 py-2 border-b border-gray-700">14</td>

            <td class="px-3 py-2 border-b border-gray-700">256</td>

            <td class="px-3 py-2 border-b border-gray-700">504</td>

            <td class="px-3 py-2 border-b border-gray-700">6.7</td>

            <td class="px-3 py-2 border-b border-gray-700">854.0</td>

            <td class="px-3 py-2 border-b border-gray-700">605.6</td>

            <td class="px-3 py-2 border-b border-gray-700">2.2</td>

            <td class="px-3 py-2 border-b border-gray-700">1.6945</td>

            <td class="px-3 py-2 border-b border-gray-700">0.0066</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">64</td>

            <td class="px-3 py-2 border-b border-gray-700">31</td>

            <td class="px-3 py-2 border-b border-gray-700">12</td>

            <td class="px-3 py-2 border-b border-gray-700">128</td>

            <td class="px-3 py-2 border-b border-gray-700">600</td>

            <td class="px-3 py-2 border-b border-gray-700">11.8</td>

            <td class="px-3 py-2 border-b border-gray-700">217.7</td>

            <td class="px-3 py-2 border-b border-gray-700">166.9</td>

            <td class="px-3 py-2 border-b border-gray-700">0.6</td>

            <td class="px-3 py-2 border-b border-gray-700">0.3629</td>

            <td class="px-3 py-2 border-b border-gray-700">0.0028</td>

          </tr>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">For comparison with previous results in the literature we reproduce those results in Table 9 which demonstrates the benefit of a dedicated block cipher for homomorphic evaluation.</p>

    <p class="text-gray-300">Table 8. LowMC (commit f6a086e) in HElib [HS13] (commit be9d3785e) on Intel i7-4850HQ CPU @ 2.30GHz;  <span class="math">d</span>  is the allowed data complexity,  <span class="math">m</span>  is the number of Sboxes,  <span class="math">n</span>  is the blocksize,  <span class="math">r</span>  is the number of rounds, # blocks is the number of blocks computed in parallel,  <span class="math">t_{setup}</span>  is the total setup time,  <span class="math">t_{eval}</span>  is the total running time of the encryption,  <span class="math">t_{sbox}</span>  the total time spent in the S-Box layer,  <span class="math">t_{key}</span>  the total time spent in the key schedule,  <span class="math">t_{block} = t_{eval} / \\# \\text{blocks}</span>  and  <span class="math">t_{bit} = t_{block} / n</span> . All times are in seconds.</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">d</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">ANDdepth</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">#blocks</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">teval</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">tblock</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">tbit</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Cipher</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Reference</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Key Schedule</th>

          </tr>

        </thead>

        <tbody>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">128</td>

            <td class="px-3 py-2 border-b border-gray-700">40</td>

            <td class="px-3 py-2 border-b border-gray-700">120</td>

            <td class="px-3 py-2 border-b border-gray-700">3m</td>

            <td class="px-3 py-2 border-b border-gray-700">1.5s</td>

            <td class="px-3 py-2 border-b border-gray-700">0.0119s</td>

            <td class="px-3 py-2 border-b border-gray-700">AES-128</td>

            <td class="px-3 py-2 border-b border-gray-700">[GHS12b]</td>

            <td class="px-3 py-2 border-b border-gray-700">excluded</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">128</td>

            <td class="px-3 py-2 border-b border-gray-700">40</td>

            <td class="px-3 py-2 border-b border-gray-700">2048</td>

            <td class="px-3 py-2 border-b border-gray-700">31h</td>

            <td class="px-3 py-2 border-b border-gray-700">55s</td>

            <td class="px-3 py-2 border-b border-gray-700">0.2580s</td>

            <td class="px-3 py-2 border-b border-gray-700">AES-128</td>

            <td class="px-3 py-2 border-b border-gray-700">[DHS14]</td>

            <td class="px-3 py-2 border-b border-gray-700">excluded</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">128</td>

            <td class="px-3 py-2 border-b border-gray-700">40</td>

            <td class="px-3 py-2 border-b border-gray-700">1</td>

            <td class="px-3 py-2 border-b border-gray-700">22m</td>

            <td class="px-3 py-2 border-b border-gray-700">22m</td>

            <td class="px-3 py-2 border-b border-gray-700">10.313s</td>

            <td class="px-3 py-2 border-b border-gray-700">AES-128</td>

            <td class="px-3 py-2 border-b border-gray-700">[MS13]</td>

            <td class="px-3 py-2 border-b border-gray-700">excluded</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">128</td>

            <td class="px-3 py-2 border-b border-gray-700">40</td>

            <td class="px-3 py-2 border-b border-gray-700">12</td>

            <td class="px-3 py-2 border-b border-gray-700">2h47m</td>

            <td class="px-3 py-2 border-b border-gray-700">14m</td>

            <td class="px-3 py-2 border-b border-gray-700">6.562s</td>

            <td class="px-3 py-2 border-b border-gray-700">AES-128</td>

            <td class="px-3 py-2 border-b border-gray-700">[MS13]</td>

            <td class="px-3 py-2 border-b border-gray-700">excluded</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">128</td>

            <td class="px-3 py-2 border-b border-gray-700">14</td>

            <td class="px-3 py-2 border-b border-gray-700">504</td>

            <td class="px-3 py-2 border-b border-gray-700">14.2m</td>

            <td class="px-3 py-2 border-b border-gray-700">1.7s</td>

            <td class="px-3 py-2 border-b border-gray-700">0.0066s</td>

            <td class="px-3 py-2 border-b border-gray-700">LowMC</td>

            <td class="px-3 py-2 border-b border-gray-700">this work</td>

            <td class="px-3 py-2 border-b border-gray-700">included</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">64</td>

            <td class="px-3 py-2 border-b border-gray-700">24</td>

            <td class="px-3 py-2 border-b border-gray-700">1024</td>

            <td class="px-3 py-2 border-b border-gray-700">57m</td>

            <td class="px-3 py-2 border-b border-gray-700">3.3s</td>

            <td class="px-3 py-2 border-b border-gray-700">0.0520s</td>

            <td class="px-3 py-2 border-b border-gray-700">PRINCE</td>

            <td class="px-3 py-2 border-b border-gray-700">[DSES14b]</td>

            <td class="px-3 py-2 border-b border-gray-700">excluded</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">64</td>

            <td class="px-3 py-2 border-b border-gray-700">12</td>

            <td class="px-3 py-2 border-b border-gray-700">600</td>

            <td class="px-3 py-2 border-b border-gray-700">3.6m</td>

            <td class="px-3 py-2 border-b border-gray-700">0.36s</td>

            <td class="px-3 py-2 border-b border-gray-700">0.0028s</td>

            <td class="px-3 py-2 border-b border-gray-700">LowMC</td>

            <td class="px-3 py-2 border-b border-gray-700">this work</td>

            <td class="px-3 py-2 border-b border-gray-700">included</td>

          </tr>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">Table 9. Comparison of various block cipher evaluations in the literature and this work; Notation as in Table 8. Memory requirements are not listed as they are usually not provided in the literature. The first row is based on experimental data obtained on the same machine and the same instance of HELib as in Table 8.</p>

    <p class="text-gray-300">We proposed block ciphers with an small number of AND gates and an shallow AND depth, demonstrated the soundness of our design through experimental evidence and provided a se</p>

    <p class="text-gray-300">curity analysis of these constructions. Of course, as with any other block cipher, more security analysis is needed to firmly establish the security provided by this new design. Furthermore, with the proposal of the LowMC family, we bring together the areas of symmetric cryptographic design and analysis research with new developments around MPC and FHE. Finally, in contrast to current folklore belief, in some implementation scenarios, we identified practical cases where “free XORs” can no longer be considered free and where local computations in an MPC protocol represent a considerable bottleneck.</p>

    <p class="text-gray-300">To finish, we highlight a number of open problems related to the LowMC family of ciphers in the areas of cryptanalysis, design, and implementation. We start with cryptanalysis, as analyzing such an extreme corner of the design space for a symmetric cipher is an interesting endeavor in itself.</p>

    <ul class="list-disc list-inside space-y-1 text-gray-300 my-2 ml-4">

      <li>In Eq(4) we give an approach to calculate, for any number of Sboxes per round, block size, and security level, a number of rounds for which we believe and our analysis suggests that LowMC is secure. We on purpose do not add an additional security margin. Are there attack vectors for which those <span class="math">r</span> rounds are not enough? Or is perhaps the opposite true: is it possible to reduce the number of rounds in LowMC, which in turn would further reduce MC and ANDdepth?</li>

      <li>Security of LowMC, or variants of it, in other use-cases for which we do not claim security, i.e. against related-key attacks, or its use in a key-less settings like block-cipher-based compression or hash functions, or sponge-based hash functions.</li>

    </ul>

    <p class="text-gray-300">There are also various open questions related to the design of LowMC-like ciphers:</p>

    <ul class="list-disc list-inside space-y-1 text-gray-300 my-2 ml-4">

      <li>Affine layer (1): Can we add more structure into the linear layers in order to reduce the necessary computational effort in those cases where the number of AND gates is no longer the bottleneck? Do such approaches beat applying asymptotically faster linear algebra techniques for applying linear layers as done in Section 6? As we argue in the paper, simply lowering the density of the matrices by several factors of two will not be enough to change performance at all.</li>

      <li>Affine layer (2): For breaking up symmetries it seems to suffice to have sufficiently distinct linear layers in every round, i.e. distinct random matrices Lmatrix[i]. We however chose to add distinct round constants, also because the cost of doing so is very low, even though we don’t know of an attack. An interesting question hence is: Could LowMC without the ConstantAddition(i) step be secure, perhaps equally so?</li>

      <li>Affine layer (3): Can we add more structure into the linear layer in order to improve the security? Our strategy to use random linear layers gives good <em>expected</em> properties, but a small probability for unlucky choices remains. For that reason we introduced an analysis technique in the paper that can quantify this risk, and set the threshold for our concrete instantiations to <span class="math">2^{-100}</span>. It will be interesting to study what techniques for constructing concrete affine layers (using e.g. linear codes as it is usually done) can achieve. The advantage would be to <em>remove that chance of being unlucky</em>, but we conjecture it to be unlikely that it will be possible to e.g. at the same time get close to our bounds on the probability of linear or differential characteristics.</li>

      <li>Sbox-layer: It would be interesting to study Sboxes (larger than 3 bits) with low ANDdepth and Sboxes with low multiplicative complexity.</li>

    </ul>

    <p class="text-gray-300">Currently, the multiplicative complexity and ANDdepth of various cipher constructions is poorly understood. For example, it would be interesting to find efficient algorithms along the lines of <em>[x1]</em> for the various ciphers in the literature. While our choice for GF(2) is well motivated, there are scenarios where larger fields might be beneficial. What designs minimize</p>

    <p class="text-gray-300">MC and multiplicative depth under such constraints? In a follow-up work MiMC[AGR^{+}16, GRR^{+}16] was proposed that aims to minimize the number of multiplications in GF(p). Finding designs in GF(p) that minimize multiplicative depth is still an interesting option problem.</p>

    <p class="text-gray-300">Acknowledgements. We thank Dmitry Khovratovich for pointing out to us that an earlier version of our parameter sets for LowMC instantiations was too optimistic. We thank Orr Dunkelman for helpful clarifications on the cipher KATAN. We thank Gaëtan Leurent and François-Xavier Standaert for helpful clarifications regarding the ciphers Fantomas and Robin.</p>

    <p class="text-gray-300">The work of Albrecht was supported by EPSRC grant EP/L018543/1 “Multilinear Maps in Cryptography”. The work of co-authors from TU Darmstadt was supported by the European Union’s 7^{th} Framework Program (FP7/2007-2013) under grant agreement n. 609611 (PRAC-TICE), by the DFG as part of project E3 within the CRC 1119 CROSSING, by the German Federal Ministry of Education and Research (BMBF) within EC SPRIDE, and by the Hessian LOEWE excellence initiative within CASED.</p>

    <h2 id="sec-41" class="text-2xl font-bold">References</h2>

    <ul class="list-disc list-inside space-y-1 text-gray-300 my-2 ml-4">

      <li>[ABH10] Martin R. Albrecht, Gregory V. Bard, and William Hart. Algorithm 898: Efficient multiplication of dense matrices over GF(2). ACM Transactions on Mathematical Software, 37(1), 2010.</li>

      <li>[AGR^{+}16] Martin Albrecht, Lorenzo Grassi, Christian Rechberger, Arnab Roy, and Tyge Tiessen. MiMC: Efficient encryption and cryptographic hashing with minimal multiplicative complexity. Cryptology ePrint Archive, Report 2016/492, 2016. http://eprint.iacr.org/.</li>

      <li>[AIK06] Benny Applebaum, Yuval Ishai, and Eyal Kushilevitz. Cryptography in NC^{0}. SIAM Journal on Computing, 36(4):845–888, 2006.</li>

      <li>[AL07] Yonatan Aumann and Yehuda Lindell. Security against covert adversaries: Efficient protocols for realistic adversaries. In Theory of Cryptography Conference (TCC), volume 4392 of LNCS, pages 137–156. Springer, 2007.</li>

      <li>[ALSZ13] Gilad Asharov, Yehuda Lindell, Thomas Schneider, and Michael Zohner. More efficient oblivious transfer and extensions for faster secure computation. In Computer and Communications Security (CCS), pages 535–548. ACM, 2013. Code: http://github.com/encryptogroup/OTExtension.</li>

      <li>[ARS^{+}15] Martin R. Albrecht, Christian Rechberger, Thomas Schneider, Tyge Tiessen, and Michael Zohner. Ciphers for MPC and FHE. In Advances in Cryptology – EUROCRYPT, volume 9056 of LNCS, pages 430–454. Springer, 2015.</li>

      <li>[BC86] Gilles Brassard and Claude Crépeau. Zero-knowledge simulation of Boolean circuits. In Advances in Cryptology – CRYPTO, volume 263 of LNCS, pages 223–233. Sringer, 1986.</li>

      <li>[BCC11] Christina Boura, Anne Canteaut, and Christophe De Cannière. Higher-order differential properties of Keccak and Luffa. In Fast Software Encryption (FSE), volume 6733 of LNCS, pages 252–269. Springer, 2011.</li>

      <li>[BCDa15] Luís T. A. N. Brandão, Nicolas Christin, George Danezis, and anonymous. Toward Mending Two Nation-Scale Brokered Identification Systems. PoPETs, 2015(2):135–155, 2015.</li>

      <li>[BCG^{+}12] Julia Borghoff, Anne Canteaut, Tim Güneysu, Elif Bilge Kavun, Miroslav Knezevic, Lars R. Knudsen, Gregor Leander, Ventzislav Nikov, Christof Paar, Christian Rechberger, Peter Rombouts, Søren S. Thomsen, and Tolga Yalçın. PRINCE - a low-latency block cipher for pervasive computing applications - extended abstract. In Advances in Cryptology – ASIACRYPT, volume 7658 of LNCS, pages 208–225. Springer, 2012.</li>

      <li>[BDD^{+}15] Achiya Bar-On, Itai Dinur, Orr Dunkelman, Virginie Lallemand, Nathan Keller, and Boaz Tsaban. Cryptanalysis of SP networks with partial non-linear layers. In Advances in Cryptology – EUROCRYPT, volume 9056 of LNCS, pages 315–342. Springer, 2015.</li>

      <li>[BDJ^{+}10] Stéphane Badel, Nilay Dagtekin, Jorge Nakahara Jr., Khaled Ouafi, Nicolas Reffé, Pouyan Sepehrdad, Petr Susil, and Serge Vaudenay. ARMADILLO: A multi-purpose cryptographic primitive dedicated to hardware. In Cryptographic Hardware and Embedded Systems (CHES), volume 6225 of LNCS, pages 398–412. Springer, 2010.</li>

      <li>[BDK02] Eli Biham, Orr Dunkelman, and Nathan Keller. Enhancing differential-linear cryptanalysis. In Advances in Cryptology – ASIACRYPT, volume 2501 of LNCS, pages 254–266. Springer, 2002.</li>

      <li>[BDP00] Joan Boyar, Ivan Damgård, and René Peralta. Short non-interactive cryptographic proofs. Journal of Cryptology, 13(4):449–472, 12 2000.</li>

      <li>[</li>

    </ul>

    <p class="text-gray-300">BGV11. Zvika Brakerski, Craig Gentry, and Vinod Vaikuntanathan. Fully homomorphic encryption without bootstrapping. Electronic Colloquium on Computational Complexity (ECCC), 18:111, 2011.</p>

    <ul class="list-disc list-inside space-y-1 text-gray-300 my-2 ml-4">

      <li>BHKR13. Mihir Bellare, Viet Tung Hoang, Sriram Keelveedhi, and Phillip Rogaway. Efficient garbling from a fixed-key blockcipher. In IEEE Symposium on Security and Privacy, pages 478–492. IEEE, 2013.</li>

      <li>BMP13. Joan Boyar, Philip Matthews, and René Peralta. Logic minimization techniques with applications to cryptology. Journal of Cryptology, 26(2):280–312, 2013.</li>

      <li>BMvT78. Elwyn R. Berlekamp, Robert J. McEliece, and Henk C. A. van Tilborg. On the inherent intractability of certain coding problems (corresp.). IEEE Transactions on Information Theory, 24(3):384–386, 1978.</li>

      <li>BP12. Joan Boyar and René Peralta. A small depth-16 circuit for the AES S-box. In Information Security and Privacy Conference (SEC), volume 376 of IFIP Advances in Information and Communication Technology, pages 287–298. Springer, 2012.</li>

      <li>BPP00. Joan Boyar, René Peralta, and Denis Pochuev. On the multiplicative complexity of Boolean functions over the basis <span class="math">(\\wedge,\\oplus,1)</span>. Theoretical Computer Science, 235(1):43–57, 2000.</li>

      <li>BS91. Eli Biham and Adi Shamir. Differential cryptanalysis of des-like cryptosystems. Journal of Cryptology, 4(1):3–72, 1991.</li>

      <li>BSS^{+}13. Ray Beaulieu, Douglas Shors, Jason Smith, Stefan Treatman-Clark, Bryan Weeks, and Louis Wingers. The SIMON and SPECK Families of Lightweight Block Ciphers. Cryptology ePrint Archive, Report 2013/404, 2013. http://eprint.iacr.org/2013/404.</li>

      <li>BW99. Alex Biryukov and David Wagner. Slide Attacks. In Fast Software Encryption (FSE), volume 1636 of LNCS, pages 245–259. Springer, 1999.</li>

      <li>BW00. Alex Biryukov and David Wagner. Advanced Slide Attacks. In Advances in Cryptology – EURO-CRYPT, volume 1807 of LNCS, pages 589–606. Springer, 2000.</li>

      <li>Can05. David Canright. A very compact S-box for AES. In Cryptographic Hardware and Embedded Systems (CHES), volume 3659 of LNCS, pages 441–455. Springer, 2005.</li>

      <li>CCF^{+}15. Anne Canteaut, Sergiu Carpov, Caroline Fontaine, Tancrède Lepoint, María Naya-Plasencia, Pascal Paillier, and Renaud Sirdey. Stream ciphers: A practical solution for efficient homomorphic-ciphertext compression. Cryptology ePrint Archive, Report 2015/113, to appear in the Proceedings of FSE 2016, 2015. http://eprint.iacr.org/.</li>

      <li>CDK09. Christophe De Cannière, Orr Dunkelman, and Miroslav Knezevic. KATAN and KTANTAN - A Family of Small and Efficient Hardware-Oriented Block Ciphers. In Cryptographic Hardware and Embedded Systems (CHES), volume 5747 of LNCS, pages 272–288. Springer, 2009.</li>

      <li>CE85. David Chaum and Jan-Hendrik Evertse. Crytanalysis of DES with a Reduced Number of Rounds: Sequences of Linear Factors in Block Ciphers. In Advances in Cryptology – CRYPTO, volume 218 of LNCS, pages 192–211. Springer, 1985.</li>

      <li>CHK^{+}12. Seung G. Choi, Kyung-Wook Hwang, Jonathan Katz, Tal Malkin, and Dan Rubenstein. Secure multi-party computation of Boolean circuits with applications to privacy in on-line marketplaces. In Cryptographers’ Track at the RSA Conference (CT-RSA), volume 7178 of LNCS, pages 416–432. Springer, 2012. Code: http://www.ee.columbia.edu/%7ekwhwang/projects/gmw.html.</li>

      <li>CHM11. Nicolas T. Courtois, Daniel Hulme, and Theodosis Mourouzis. Solving circuit optimisation problems in cryptography and cryptanalysis. Cryptology ePrint Archive, Report 2011/475, 2011. http://eprint.iacr.org/2011/475.</li>

      <li>DBL08. New Stream Cipher Designs - The eSTREAM Finalists, volume 4986 of LNCS. Springer, 2008.</li>

      <li>DEM16. Christoph Dobraunig, Maria Eichlseder, and Florian Mendel. Higher-order cryptanalysis of LowMC. In Information Security and Cryptology (ICISC), volume 9558 of LNCS, pages 87–101. Springer, 2016.</li>

      <li>DH77. Whitfield Diffie and Martin E. Hellman. Exhaustive Cryptanalysis of the NBS Data Encryption Standard. Computer, 10(6):74–84, June 1977.</li>

      <li>DHS14. Yarkin Doroz, Yin Hu, and Berk Sunar. Homomorphic AES evaluation using NTRU. Cryptology ePrint Archive, Report 2014/039, 2014. http://eprint.iacr.org/2014/039.</li>

      <li>DK10. Ivan Damgård and Marcel Keller. Secure multiparty AES. In Financial Cryptography (FC), volume 6052 of LNCS, pages 367–374. Springer, 2010.</li>

      <li>DLMW15. Itai Dinur, Yunwen Liu, Willi Meier, and Qingju Wang. Optimized interpolation attacks on LowMC. In Advances in Cryptology – ASIACRYPT, volume 9453 of LNCS, pages 535–560. Springer, 2015.</li>

      <li>DLT14. Ivan Damgård, Rasmus Lauritsen, and Tomas Toft. An empirical study and some improvements of the MiniMac protocol for secure computation. In Security and Cryptography for Networks (SCN), volume 8642 of LNCS, pages 398–415. Springer, 2014.</li>

      <li>DP08. Christophe De Cannière and Bart Preneel. Trivium. In New Stream Cipher Designs - The eSTREAM Finalists [DBL08], pages 244–266.</li>

      <li>DPVAR00. Joan Daemen, Michaël Peeters, Gilles Van Assche, and Vincent Rijmen. Nessie proposal: Noekeon. In First Open NESSIE Workshop, 2000.</li>

    </ul>

    <p class="text-gray-300">DS09. Itai Dinur and Adi Shamir. Cube Attacks on Tweakable Black Box Polynomials. In Advances in Cryptology – EUROCRYPT, volume 5479 of LNCS, pages 278–299. Springer, 2009.</p>

    <p class="text-gray-300">DSES14a. Yarkin Doröz, Aria Shahverdi, Thomas Eisenbarth, and Berk Sunar. Toward practical homomorphic evaluation of block ciphers using Prince. In Financial Cryptography and Data Security (FC) Workshops, BITCOIN and WAHC, volume 8438 of LNCS, pages 208–220. Springer, 2014.</p>

    <p class="text-gray-300">DSES14b. Yarkın Doröz, Aria Shahverdi, Thomas Eisenbarth, and Berk Sunar. Toward practical homomorphic evaluation of block ciphers using Prince. Cryptology ePrint Archive, Report 2014/233, 2014. http://eprint.iacr.org/2014/233, presented at Workshop on Applied Homomorphic Cryptography and Encrypted Computing (WAHC’14).</p>

    <p class="text-gray-300">DSZ15. Daniel Demmler, Thomas Schneider, and Michael Zohner. Aby - a framework for efficient mixed-protocol secure two-party computation. In Network and Distributed System Security (NDSS). The Internet Society, 2015. Code: https://github.com/encryptogroup/ABY.</p>

    <p class="text-gray-300">DZ13. Ivan Damgård and Sarah Zakarias. Constant-overhead secure computation of boolean circuits using preprocessing. In Theory of Cryptology Conference (TCC), volume 7785 of LNCS, pages 621–641. Springer, 2013.</p>

    <p class="text-gray-300">FIPR05. Michael J. Freedman, Yuval Ishai, Benny Pinkas, and Omer Reingold. Keyword search and oblivious pseudorandom functions. In Theory of Cryptography Conference (TCC), volume 3378 of LNCS, pages 303–324. Springer, 2005.</p>

    <p class="text-gray-300">FJN^{+}13. Tore K. Frederiksen, Thomas P. Jakobsen, Jesper B. Nielsen, Peter S. Nordholt, and Claudio Orlandi. MiniLEGO: Efficient secure two-party computation from general assumptions. In Advances in Cryptology – EUROCRYPT, volume 7881 of LNCS, pages 537–556. Springer, 2013.</p>

    <p class="text-gray-300">FJN14. Tore K. Frederiksen, Thomas P. Jakobsen, and Jesper B. Nielsen. Faster maliciously secure two-party computation using the GPU. In Security and Cryptography for Networks (SCN), volume 8642 of LNCS, pages 358–379. Springer, 2014.</p>

    <p class="text-gray-300">FLS^{+}10. Niels Ferguson, Stefan Lucks, Bruce Schneier, Doug Whiting, Mihir Bellare, Tadayoshi Kohno, Jon Callas, and Jesse Walker. The Skein Hash Function Family. Submission to NIST (Round 3), 2010.</p>

    <p class="text-gray-300">FN13. Tore K. Frederiksen and Jesper B. Nielsen. Fast and maliciously secure two-party computation using the GPU. In Applied Cryptography and Network Security (ACNS), volume 7954 of LNCS, pages 339–356. Springer, 2013.</p>

    <p class="text-gray-300">GGNPS13. Benoît Gérard, Vincent Grosso, María Naya-Plasencia, and François-Xavier Standaert. Block ciphers that are easier to mask: How far can we go? In Cryptographic Hardware and Embedded Systems (CHES), volume 8086 of LNCS, pages 383–399. Springer, 2013.</p>

    <p class="text-gray-300">GGP10. Rosario Gennaro, Craig Gentry, and Bryan Parno. Non-interactive verifiable computing: Outsourcing computation to untrusted workers. In Advances in Cryptology – CRYPTO, volume 6223 of LNCS, pages 465–482. Springer, 2010.</p>

    <p class="text-gray-300">GHS12a. Craig Gentry, Shai Halevi, and Nigel P. Smart. Homomorphic evaluation of the AES circuit. In Advances in Cryptology – CRYPTO, volume 7417 of LNCS, pages 850–867. Springer, 2012.</p>

    <p class="text-gray-300">GHS12b. Craig Gentry, Shai Halevi, and Nigel P. Smart. Homomorphic evaluation of the AES circuit. Cryptology ePrint Archive, Report 2012/099, 2012. http://eprint.iacr.org/.</p>

    <p class="text-gray-300">GLSV14. Vicente Grosso, Gaëtan Leurent, François-Xavier Standaert, and Kerem Varici. LS-designs: Bitslice encryption for efficient masked software implementations. In Fast Software Encryption (FSE), volume 8540 of LNCS, pages 18–37. Springer, 2014.</p>

    <p class="text-gray-300">GMW87. Oded Goldreich, Silvio Micali, and Avi Wigderson. How to play any mental game or a completeness theorem for protocols with honest majority. In Symposium on Theory of Computing (STOC), pages 218–229. ACM, 1987.</p>

    <p class="text-gray-300">GNPW13. Jian Guo, Ivica Nikolic, Thomas Peyrin, and Lei Wang. Cryptanalysis of Zorro. Cryptology ePrint Archive, Report 2013/713, 2013. http://eprint.iacr.org/2013/713.</p>

    <p class="text-gray-300">GRR^{+}16. Lorenzo Grassi, Christian Rechberger, Dragos Rotaru, Peter Scholl, and Nigel P. Smart. Mpc-friendly symmetric key primitives. Cryptology ePrint Archive, Report 2016/542, 2016. http://eprint.iacr.org/2016/542.</p>

    <p class="text-gray-300">HEKM11. Yan Huang, David Evans, Jonathan Katz, and Lior Malka. Faster secure two-party computation using garbled circuits. In USENIX Security. USENIX, 2011.</p>

    <p class="text-gray-300">HJMM08. Martin Hell, Thomas Johansson, Alexander Maximov, and Willi Meier. The Grain Family of Stream Ciphers. In New Stream Cipher Designs - The eSTREAM Finalists [DBL08], pages 179–190.</p>

    <p class="text-gray-300">HKE13. Yan Huang, Jonathan Katz, and David Evans. Efficient secure two-party computation using symmetric cut-and-choose. In Advances in Cryptology – CRYPTO, volume 8043 of LNCS, pages 18–35. Springer, 2013.</p>

    <p class="text-gray-300">HKK^{+}14. Yan Huang, Jonathan Katz, Vladimir Kolesnikov, Ranjit Kumaresan, and Alex J. Malozemoff. Amortizing garbled circuits. In Advances in Cryptology – CRYPTO, volume 8617 of LNCS, pages 458–475. Springer, 2014.</p>

    <p class="text-gray-300">HL08. Carmit Hazay and Yehuda Lindell. Efficient protocols for set intersection and pattern matching with security against malicious and covert adversaries. In Theory of Cryptography Conference (TCC), volume 4948 of LNCS, pages 155–175. Springer, 2008.</p>

    <p class="text-gray-300">HS13. Shai Halevi and Victor Shoup. Design and implementation of a homomorphic-encryption library. https://github.com/shaih/HElib/, 2013.</p>

    <p class="text-gray-300">HS14. Shai Halevi and Victor Shoup. Algorithms in HElib. In Advances in Cryptology – CRYPTO, volume 8616 of LNCS, pages 554–571. Springer, 2014.</p>

    <p class="text-gray-300">JK97. Thomas Jakobsen and Lars R. Knudsen. The interpolation attack on block ciphers. In Fast Software Encryption (FSE), volume 1267 of LNCS, pages 28–40. Springer, 1997.</p>

    <p class="text-gray-300">JKO13. Marek Jawurek, Florian Kerschbaum, and Claudio Orlandi. Zero-knowledge using garbled circuits: How to prove non-algebraic statements efficiently. In Computer and Communications Security (CCS), pages 955–966. ACM, 2013.</p>

    <p class="text-gray-300">KLPR10. Lars R. Knudsen, Gregor Leander, Axel Poschmann, and Matthew J. B. Robshaw. PRINTcipher: A block cipher for IC-printing. In Cryptographic Hardware and Embedded Systems (CHES), volume 6225 of LNCS, pages 16–32. Springer, 2010.</p>

    <p class="text-gray-300">Knu94. Lars R. Knudsen. Truncated and higher order differentials. In Fast Software Encryption (FSE), volume 1008 of LNCS, pages 196–211. Springer, 1994.</p>

    <p class="text-gray-300">KS08. Vladimir Kolesnikov and Thomas Schneider. Improved garbled circuit: Free XOR gates and applications. In International Colloquium on Automata, Languages and Programming (ICALP), volume 5126 of LNCS, pages 486–498. Springer, 2008.</p>

    <p class="text-gray-300">KSS12. Benjamin Kreuter, Abhi Shelat, and Chih-Hao Shen. Billion-gate secure computation with malicious adversaries. In USENIX Security. USENIX, 2012.</p>

    <p class="text-gray-300">LH94. Susan K. Langford and Martin E. Hellman. Differential-Linear Cryptanalysis. In Advances in Cryptology – CRYPTO, volume 839 of LNCS, pages 17–25. Springer, 1994.</p>

    <p class="text-gray-300">Lin13. Yehuda Lindell. Fast cut-and-choose based protocols for malicious and covert adversaries. In Advances in Cryptology – CRYPTO, volume 8043 of LNCS, pages 1–17. Springer, 2013.</p>

    <p class="text-gray-300">LN14. Tancrède Lepoint and Michael Naehrig. A comparison of the homomorphic encryption schemes FV and YASHE. In Progress in Cryptology – AFRICACRYPT, volume 8469 of LNCS, pages 318–335. Springer, 2014.</p>

    <p class="text-gray-300">LOS14. Enrique Larraia, Emmanuela Orsini, and Nigel P. Smart. Dishonest majority multi-party computation for binary circuits. In Advances in Cryptology – CRYPTO, volume 8617 of LNCS, pages 495–512. Springer, 2014.</p>

    <p class="text-gray-300">LP07. Yehuda Lindell and Benny Pinkas. An efficient protocol for secure two-party computation in the presence of malicious adversaries. In Advances in Cryptology – EUROCRYPT, volume 4515 of LNCS, pages 52–78. Springer, 2007.</p>

    <p class="text-gray-300">LP11. Yehuda Lindell and Benny Pinkas. Secure two-party computation via cut-and-choose oblivious transfer. In Theory of Cryptography Conference (TCC), volume 6597 of LNCS, pages 329–346. Springer, 2011.</p>

    <p class="text-gray-300">LPS08. Yehuda Lindell, Benny Pinkas, and Nigel P. Smart. Implementing two-party computation efficiently with security against malicious adversaries. In Security and Cryptography for Networks (SCN), volume 5229 of LNCS, pages 2–20. Springer, 2008.</p>

    <p class="text-gray-300">LR14. Yehuda Lindell and Ben Riva. Cut-and-choose Yao-based secure computation in the online/offline and batch settings. In Advances in Cryptology – CRYPTO, volume 8617 of LNCS, pages 476–494. Springer, 2014.</p>

    <p class="text-gray-300">LTW13. Sven Laur, Riivo Talviste, and Jan Willemson. From oblivious AES to efficient and secure database join in the multiparty setting. In Applied Cryptography and Network Security (ACNS), volume 7954 of LNCS, pages 84–101. Springer, 2013.</p>

    <p class="text-gray-300">Mat93. Mitsuru Matsui. Linear Cryptoanalysis Method for DES Cipher. In Advances in Cryptology – EUROCRYPT, volume 765 of LNCS, pages 386–397. Springer, 1993.</p>

    <p class="text-gray-300">MJSC16. Pierrick Méaux, Anthony Journault, François-Xavier Standaert, and Claude Carlet. Towards stream ciphers for efficient FHE with low-noise ciphertexts. In Advances in Cryptology – EUROCRYPT, volume 9665 of LNCS, pages 311–343. Springer, 2016.</p>

    <p class="text-gray-300">MNPS04. Dahlia Malkhi, Noam Nisan, Benny Pinkas, and Yaron Sella. Fairplay — a secure two-party computation system. In USENIX Security, pages 287–302. USENIX, 2004.</p>

    <p class="text-gray-300">MS94. Willi Meier and Othmar Staffelbach. The self-shrinking generator. In Advances in Cryptology – EUROCRYPT, volume 950 of LNCS, pages 205–214. Springer, 1994.</p>

    <p class="text-gray-300">MS13. Silvia Mella and Ruggero Susella. On the homomorphic computation of symmetric cryptographic primitives. In Cryptography and Coding, volume 8308 of LNCS, pages 28–44. Springer, 2013.</p>

    <p class="text-gray-300">MV12. Eric Miles and Emanuele Viola. Substitution-Permutation Networks, Pseudorandom Functions, and Natural Proofs. In Advances in Cryptology – CRYPTO, volume 7417 of LNCS, pages 68–85. Springer, 2012.</p>

    <p class="text-gray-300">NLV11. Michael Naehrig, Kristin Lauter, and Vinod Vaikuntanathan. Can homomorphic encryption be practical? In Cloud Computing Security Workshop (CCSW), pages 113–124. ACM, 2011.</p>

    <ul class="list-disc list-inside space-y-1 text-gray-300 my-2 ml-4">

      <li>NNOB12. Jesper B. Nielsen, Peter S. Nordholt, Claudio Orlandi, and Sai Sheshank Burra. A new approach to practical active-secure two-party computation. In Advances in Cryptology – CRYPTO, volume 7417 of LNCS, pages 681–700. Springer, 2012.</li>

      <li>PRC12. Gilles Piret, Thomas Roche, and Claude Carlet. PICARO - a block cipher allowing efficient higher-order side-channel resistance. In Applied Cryptography and Network Security (ACNS), volume 7341 of LNCS, pages 311–328. Springer, 2012.</li>

      <li>PSSW09. Benny Pinkas, Thomas Schneider, Nigel P. Smart, and Stephen C. Williams. Secure two-party computation is practical. In Advances in Cryptology – ASIACRYPT, volume 5912 of LNCS, pages 250–267. Springer, 2009.</li>

      <li>RASA14. Shahram Rasoolzadeh, Zahra Ahmadian, Mahmood Salmasizadeh, and Mohammad Reza Aref. Total Break of Zorro using Linear and Differential Attacks. Cryptology ePrint Archive, Report 2014/220, 2014. http://eprint.iacr.org/2014/220.</li>

      <li>Sol14. Hadi Soleimany. Probabilistic slide cryptanalysis and its applications to LED-64 and Zorro. In Fast Software Encryption (FSE), volume 8540 of LNCS, pages 373–389. Springer, 2014.</li>

      <li>SS11. Abhi Shelat and Chih-Hao Shen. Two-output secure computation with malicious adversaries. In Advances in Cryptology – EUROCRYPT, volume 6632 of LNCS, pages 386–405. Springer, 2011.</li>

      <li>SS13. Abhi Shelat and Chih-Hao Shen. Fast two-party secure computation with minimal assumptions. In Computer and Communications Security (CCS), pages 523–534. ACM, 2013.</li>

      <li>SZ13. Thomas Schneider and Michael Zohner. GMW vs. Yao? Efficient secure two-party computation with low depth circuits. In Financial Cryptography (FC), LNCS, pages 275–292. Springer, 2013.</li>

      <li>TS. Stefan Tillich and Nigel Smart. Circuits of basic functions suitable for MPC and FHE. http://www.cs.bris.ac.uk/Research/CryptographySecurity/MPC/.</li>

      <li>Wag99. David Wagner. The Boomerang Attack. In Fast Software Encryption (FSE), volume 1636 of LNCS, pages 156–170. Springer, 1999.</li>

      <li>WWGY13. Yanfeng Wang, Wenling Wu, Zhiyuan Guo, and Xiaoli Yu. Differential Cryptanalysis and Linear Distinguisher of Full-Round Zorro. Cryptology ePrint Archive, Report 2013/775, 2013. http://eprint.iacr.org/2013/775.</li>

      <li>Yao86. Andrew C.-C. Yao. How to generate and exchange secrets. In IEEE Symposium on Foundations of Computer Science (FOCS), pages 162–167. IEEE, 1986.</li>

    </ul>

    <p class="text-gray-300">In the first version of this paper, we proposed a number of parameter sets for LowMC instantiations that turned out to be too optimistic. The formula for deriving the number of rounds needed for security did not yet contain a bound against boomerang attacks which can pose a strong threat due to the partial non-linear layer. We thank Dmitry Khovratovich for pointing that out to us. Apart from this the formula was identical to the one of version 1.</p>

    <p class="text-gray-300">You can find the parameters which we suggested for LowMC version 0 in Table 10.</p>

    <p class="text-gray-300">Table 10. Parameter sets of LowMC version 0 instantiations. LowMC-S are shallow instances minimizing AND-depth. LowMC-W are wide instances minimizing the ANDs per encrypted bit.</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">sboxes m</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">keysize k</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">blocksize n</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">data d</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">rounds r</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">ANDdepth</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">ANDs per bit</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

          </tr>

        </thead>

        <tbody>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">21</td>

            <td class="px-3 py-2 border-b border-gray-700">80</td>

            <td class="px-3 py-2 border-b border-gray-700">128</td>

            <td class="px-3 py-2 border-b border-gray-700">64</td>

            <td class="px-3 py-2 border-b border-gray-700">13</td>

            <td class="px-3 py-2 border-b border-gray-700">13</td>

            <td class="px-3 py-2 border-b border-gray-700">6.4</td>

            <td class="px-3 py-2 border-b border-gray-700">LowMC-S with 80-bit PRESENT-like security</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">21</td>

            <td class="px-3 py-2 border-b border-gray-700">80</td>

            <td class="px-3 py-2 border-b border-gray-700">1024</td>

            <td class="px-3 py-2 border-b border-gray-700">64</td>

            <td class="px-3 py-2 border-b border-gray-700">28</td>

            <td class="px-3 py-2 border-b border-gray-700">28</td>

            <td class="px-3 py-2 border-b border-gray-700">1.72</td>

            <td class="px-3 py-2 border-b border-gray-700">LowMC-W with 80-bit PRESENT-like security</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">42</td>

            <td class="px-3 py-2 border-b border-gray-700">128</td>

            <td class="px-3 py-2 border-b border-gray-700">256</td>

            <td class="px-3 py-2 border-b border-gray-700">128</td>

            <td class="px-3 py-2 border-b border-gray-700">13</td>

            <td class="px-3 py-2 border-b border-gray-700">13</td>

            <td class="px-3 py-2 border-b border-gray-700">6.4</td>

            <td class="px-3 py-2 border-b border-gray-700">LowMC-S with AES-128-like security</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">42</td>

            <td class="px-3 py-2 border-b border-gray-700">128</td>

            <td class="px-3 py-2 border-b border-gray-700">1024</td>

            <td class="px-3 py-2 border-b border-gray-700">128</td>

            <td class="px-3 py-2 border-b border-gray-700">19</td>

            <td class="px-3 py-2 border-b border-gray-700">19</td>

            <td class="px-3 py-2 border-b border-gray-700">2.33</td>

            <td class="px-3 py-2 border-b border-gray-700">LowMC-W with AES-128-like security</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">42</td>

            <td class="px-3 py-2 border-b border-gray-700">192</td>

            <td class="px-3 py-2 border-b border-gray-700">256</td>

            <td class="px-3 py-2 border-b border-gray-700">128</td>

            <td class="px-3 py-2 border-b border-gray-700">14</td>

            <td class="px-3 py-2 border-b border-gray-700">14</td>

            <td class="px-3 py-2 border-b border-gray-700">6.9</td>

            <td class="px-3 py-2 border-b border-gray-700">LowMC-S with AES-192-like security</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">42</td>

            <td class="px-3 py-2 border-b border-gray-700">192</td>

            <td class="px-3 py-2 border-b border-gray-700">1024</td>

            <td class="px-3 py-2 border-b border-gray-700">128</td>

            <td class="px-3 py-2 border-b border-gray-700">20</td>

            <td class="px-3 py-2 border-b border-gray-700">20</td>

            <td class="px-3 py-2 border-b border-gray-700">2.46</td>

            <td class="px-3 py-2 border-b border-gray-700">LowMC-W with AES-192-like security</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">42</td>

            <td class="px-3 py-2 border-b border-gray-700">256</td>

            <td class="px-3 py-2 border-b border-gray-700">256</td>

            <td class="px-3 py-2 border-b border-gray-700">128</td>

            <td class="px-3 py-2 border-b border-gray-700">15</td>

            <td class="px-3 py-2 border-b border-gray-700">15</td>

            <td class="px-3 py-2 border-b border-gray-700">7.4</td>

            <td class="px-3 py-2 border-b border-gray-700">LowMC-S with AES-256-like security</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">42</td>

            <td class="px-3 py-2 border-b border-gray-700">256</td>

            <td class="px-3 py-2 border-b border-gray-700">1024</td>

            <td class="px-3 py-2 border-b border-gray-700">128</td>

            <td class="px-3 py-2 border-b border-gray-700">21</td>

            <td class="px-3 py-2 border-b border-gray-700">21</td>

            <td class="px-3 py-2 border-b border-gray-700">2.58</td>

            <td class="px-3 py-2 border-b border-gray-700">LowMC-W with AES-256-like security</td>

          </tr>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">Version 1 of LowMC was published at EUROCRYPT 2015. While the formula for calculating the rounds was improved compared to version 0, it was still not sufficient. In particular, the bound used for calculating the security against higher-order attacks was insufficient. This has been exploited in two attacks [DLMW15, DEM16]. This has been amended in this version by taking the number of rounds needed for full diffusion into account. Furthermore the number of outer rounds was independent of the key size. The formula used to be</p>

    <div class="my-4 text-center"><span class="math-block">r \\geq \\max  \\left(r _ {\\text {s t a t}}, r _ {\\text {b m r g}}, r _ {\\text {d e g}}\\right) + r _ {\\text {o u t e r}}</span></div>

    <p class="text-gray-300">where  <span class="math">r_{\\mathrm{outer}} = r_{\\mathrm{stat}}</span></p>

    <p class="text-gray-300">The suggested parameters for LowMC version 1 can be found in Table 11.</p>

    <p class="text-gray-300">Table 11. Parameter sets of LowMC version 1 instantiations. The first set has PRESENT-like security parameters, the second set has AES-like security parameters.</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">blocksize n</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">sboxes m</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">keysize k</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">data d</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">rounds r</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">ANDdepth</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">ANDs per bit</th>

          </tr>

        </thead>

        <tbody>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">256</td>

            <td class="px-3 py-2 border-b border-gray-700">49</td>

            <td class="px-3 py-2 border-b border-gray-700">80</td>

            <td class="px-3 py-2 border-b border-gray-700">64</td>

            <td class="px-3 py-2 border-b border-gray-700">11</td>

            <td class="px-3 py-2 border-b border-gray-700">11</td>

            <td class="px-3 py-2 border-b border-gray-700">6.3</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">256</td>

            <td class="px-3 py-2 border-b border-gray-700">63</td>

            <td class="px-3 py-2 border-b border-gray-700">128</td>

            <td class="px-3 py-2 border-b border-gray-700">128</td>

            <td class="px-3 py-2 border-b border-gray-700">12</td>

            <td class="px-3 py-2 border-b border-gray-700">12</td>

            <td class="px-3 py-2 border-b border-gray-700">8.86</td>

          </tr>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">C Table representation of LowMC Sbox</p>

    <p class="text-gray-300">The representation of the Sbox in algebraic normal form is given as</p>

    <p class="text-gray-300"><span class="math">(a\\oplus bc,a\\oplus b\\oplus ac,a\\oplus b\\oplus c\\oplus ab)</span></p>

    <p class="text-gray-300">(see also Figure 2). Alternatively it can be given in table form as following:</p>

    <pre><code class="language-text">ABC DEF
000 000
001 001
010 011
011 110
100 111
101 100
110 101
111 010</code></pre>

    <h3 id="sec-44" class="text-xl font-semibold mt-8">Appendix D Other attack vectors</h3>

    <p class="text-gray-300">Slide attacks and their variants are ruled-out by the choice of random i.e., high Hamming-weight round constants and distinct linear layers <em>[x1, x2, x12]</em>. Meet-in-the-middle (MITM) attacks and their variants <em>[x10, x13]</em> should be thwarted by the larger number of round-key additions. It is straightforward to transfer the proof of the absence good boomerangs to to differential-linear structures <em>[x14, x3]</em>. Integral attacks <em>[x14]</em> can be formulated as higher-order differential attacks. As shown in Section 5.4, we do not expect such attacks to exist.</p>

    <h2 id="sec-45" class="text-2xl font-bold">Appendix E A lower bound for the algebraic degree of an SPN</h2>

    <p class="text-gray-300">The following theorem and proof lends heavily from Boura, Canteaut, and De Cannière <em>[x2]</em>.</p>

    <h6 id="sec-46" class="text-base font-medium mt-4">Theorem 1.</h6>

    <p class="text-gray-300">Let <span class="math">F</span> be a function that corresponds to the parallel application of <span class="math">m</span> balanced <span class="math">d</span>-bit Sboxes and an identity function of width <span class="math">l</span>. Thus <span class="math">F</span> is from <span class="math">\\mbox{\\rm I\\kern-1.79993ptF}_{2}^{dm+l}</span> into <span class="math">\\mbox{\\rm I\\kern-1.79993ptF}_{2}^{dm+l}</span>. Let <span class="math">\\delta_{k}</span> be the maximal degree of the product of any <span class="math">k</span> output bits of the Sbox. Then for any function <span class="math">G</span> from <span class="math">\\mbox{\\rm I\\kern-1.79993ptF}^{md+l}</span> into <span class="math">\\mbox{\\rm I\\kern-1.79993ptF}_{2}^{k}</span>, we have</p>

    <p class="text-gray-300"><span class="math">\\deg(G\\circ F)\\leq\\beta m+deg(G)</span></p>

    <p class="text-gray-300">where</p>

    <p class="text-gray-300"><span class="math">\\beta=\\max_{1\\leq i\\leq d}(\\delta_{i}-i)\\enspace.</span></p>

    <h6 id="sec-47" class="text-base font-medium mt-4">Proof.</h6>

    <p class="text-gray-300">Let <span class="math">\\pi</span> be the product of <span class="math">j</span> output bits of <span class="math">F</span>. Let <span class="math">x_{i}</span>, <span class="math">1\\leq i\\leq d</span> denote the number of Sboxes that give exactly <span class="math">i</span> bits to the product <span class="math">\\pi</span> and let <span class="math">x_{0}</span> be the number of bits taken from identity. We then have</p>

    <p class="text-gray-300"><span class="math">\\deg(\\pi)\\leq\\max_{(x_{0},\\ldots,x_{d})}\\sum_{i=1}^{d}\\delta_{i}x_{i}+x_{0}=\\sum_{i=1}^{d}\\delta_{i}x_{i}+j-\\sum_{i=1}^{d}ix_{i}=\\sum_{i=1}^{d}(\\delta_{i}-i)x_{i}+j\\leq\\beta m+j</span> as <span class="math">\\sum_{i=1}^{d}ix_{i}+x_{0}=j</span> and <span class="math">\\sum_{i=1}^{d}x_{i}\\leq m</span>. ∎</p>

    <p class="text-gray-300">F Sbox representation of PRESENT with low depth</p>

    <p class="text-gray-300">Let <span class="math">S(A,B,C,D)=(E,F,G,H)</span> be the Sbox of PRESENT. We used Mathematica’s BooleanConvert function to convert the Sbox of PRESENT into Algebraic Normal Form (ANF). This yields the following Sbox representation which can be represented by 8 AND gates and has ANDdepth 2:</p>

    <p class="text-gray-300"><span class="math">E=A\\oplus C\\oplus D\\oplus BC\\oplus ABD\\oplus ACD\\oplus BCD\\oplus 1</span> <span class="math">F=A\\oplus B\\oplus AC\\oplus AD\\oplus CD\\oplus ABD\\oplus ACD\\oplus 1</span> <span class="math">G=A\\oplus C\\oplus AB\\oplus AC\\oplus ABD\\oplus ACD\\oplus BCD</span> <span class="math">H=A\\oplus B\\oplus D\\oplus BC.</span></p>

    <h3 id="sec-48" class="text-xl font-semibold mt-8">G Specification</h3>

    <p class="text-gray-300">Here we give detailed specifications of the operations of LowMC and its instantiation. A reference implementation of LowMC including functionality to generate instances as described above and a program to compute the number of rounds can be found at https://github.com/tyti/lowmc.</p>

    <p class="text-gray-300">Let <span class="math">\\mathbf{w}</span> be an <span class="math">n</span>-bit word. We denote by <span class="math">\\mathbf{w}_{i}</span> the <span class="math">(i+1)</span>th least significant bit i.e., <span class="math">\\mathbf{w}_{0}</span> is the least significant bit, <span class="math">\\mathbf{w}_{1}</span> is the second least significant bit and so forth. By <span class="math">\\mathbf{w}_{i:i+2}</span> we denote the 3-bit substring of <span class="math">\\mathbf{w}</span> that starts with <span class="math">\\mathbf{w}_{i}</span> and ends with <span class="math">\\mathbf{w}_{i+2}</span>. With a superscript we index quantities that are round-dependent e.g., KeyAddition^{t} is the round key addition in round <span class="math">t</span>.</p>

    <p class="text-gray-300">As before <span class="math">n</span> denotes the block width in bits, <span class="math">m</span> denotes the number of Sboxes in the Sbox layer. The number of rounds is denoted as <span class="math">r</span>, the key length as <span class="math">k</span>. Bold lower letters denote bit strings i.e. elements of <span class="math">\\mathbb{F}_{2}^{n}</span> or <span class="math">\\mathbb{F}_{2}^{k}</span>, bold capital letters denote matrices over <span class="math">\\mathbb{F}_{2}</span>.</p>

    <p class="text-gray-300">The state <span class="math">\\mathbf{s}</span> is thus an <span class="math">n</span>-bit quantity, the key <span class="math">\\mathbf{k}</span> a <span class="math">k</span>-bit quantity. The round keys <span class="math">\\mathbf{r}\\mathbf{k}^{t}</span>, indexed with <span class="math">0\\leq t\\leq r</span>, are <span class="math">n</span>-bit quantities. The round constants <span class="math">\\mathbf{b}^{t}</span>, indexed with <span class="math">0&lt;t\\leq r</span>, are likewise <span class="math">n</span>-bit quantities. The linear layer matrices <span class="math">\\mathbf{L}\\mathbf{M}^{t}</span>, indexed with <span class="math">0&lt;t\\leq r</span>, are invertible <span class="math">n\\times n</span> matrices over <span class="math">\\mathbb{F}_{2}</span>. The round key generation matrices <span class="math">\\mathbf{K}\\mathbf{M}^{t}</span>, indexed with <span class="math">0\\leq t\\leq r</span>, are <span class="math">n\\times k</span> matrices over <span class="math">\\mathbb{F}_{2}</span> of rank <span class="math">\\min(n,k)</span>.</p>

    <h4 id="sec-49" class="text-lg font-semibold mt-6">Encryption</h4>

    <p class="text-gray-300">The encryption is now defined through the following functions. Some of the functions depend on the round <span class="math">t</span>, some definitions are given bitwise, depending on bit <span class="math">i</span>. For the definition of the Sbox, see the table in Appendix C. Note though that the bits are counted from the right there.</p>

    <p class="text-gray-300"><span class="math">\\textsc{Encrypt}(\\mathbf{s})</span> <span class="math">=\\textsc{LowMCRound}^{r}\\circ\\cdots\\circ\\textsc{LowMCRound}^{1}\\circ\\textsc{KeyAddition}^{0}(\\mathbf{s})</span> <span class="math">\\textsc{LowMCRound}^{t}(\\mathbf{s})</span> <span class="math">=\\textsc{KeyAddition}^{t}\\circ\\textsc{ConstantAddition}^{t}\\circ\\textsc{LinearLayer}^{t}\\circ\\textsc{SboxLayer}(\\mathbf{s})</span> \\[ \\textsc{SboxLayer}_{i}(\\mathbf{s})=\\begin{cases}\\textsc{Sbox}(\\mathbf{s}_{3p:3p+2})_{q}\\text{ where }p=\\lfloor i/3\\rfloor,\\;\\;q=i\\ \\text{mod}\\ 3&\\text{if }i<3m\\\\ \\mathbf{s}_{i}&\\text{if }i\\geq 3m\\end{cases} \\] <span class="math">\\textsc{LinearLayer}_{i}^{t}(\\mathbf{s})=\\bigoplus_{0\\leq j&lt;n}\\mathbf{L}\\mathbf{M}_{i,j}^{t}\\cdot\\mathbf{s}_{j}</span> <span class="math">\\textsc{ConstantAddition}^{t}(\\mathbf{s})=\\mathbf{s}\\oplus\\mathbf{b}^{t}</span> <span class="math">\\textsc{KeyAddition}^{t}(\\mathbf{s})=\\mathbf{s}\\oplus\\mathbf{r}\\mathbf{k}^{t}</span></p>

    <h4 id="sec-50" class="text-lg font-semibold mt-6">Key schedule</h4>

    <p class="text-gray-300">The round keys <span class="math">\\mathbf{r}\\mathbf{k}^{t}</span> are derived from the main key <span class="math">\\mathbf{k}</span> via multiplication with the binary matrices <span class="math">\\mathbf{K}\\mathbf{M}^{t}</span>:</p>

    <p class="text-gray-300"><span class="math">\\mathbf{r}\\mathbf{k}_{i}^{t}=\\bigoplus_{0\\leq j&lt;k}\\mathbf{K}\\mathbf{M}_{i,j}^{t}\\cdot\\mathbf{k}_{j}</span></p>

    <p class="text-gray-300">Instantiation</p>

    <p class="text-gray-300">To use the cipher, the matrices <span class="math">\\mathbf{L}\\mathbf{M}^{t}</span>, used in the linear layer, the round constants <span class="math">\\mathbf{b}^{t}</span> and the matrices <span class="math">\\mathbf{K}\\mathbf{M}^{t}</span>, used in the round key generation, must be specified.</p>

    <p class="text-gray-300">In principal any sufficiently random instantiation method is suitable for the instantiation of the matrices and the constants. As a middle ground between accountability, randomness and ease of implementation, we chose the LFSR from the Grain cipher <em>[x10]</em> as self-shrinking generator <em>[x16]</em>. The LFSR generates a stream of random bits <span class="math">a_{i}</span> via the following recursion relation</p>

    <p class="text-gray-300"><span class="math">a_{i+80}=a_{i+62}\\oplus a_{i+51}\\oplus a_{i+38}\\oplus a_{i+23}\\oplus a_{i+13}\\oplus a_{i}.</span></p>

    <p class="text-gray-300">The initial 80 bits <span class="math">a_{0}</span> to <span class="math">a_{79}</span> are all set to 1. The first 160 bits generated from this starting state are discarded, as is done in Grain as well. Thus the first bit that is used is <span class="math">a_{240}</span>. To use the LFSR as a self-shrinking generator, the output bits of the LFST are evaluated in pairs. When the first bit is equal to 1, the second bit is produced. When the first bit is 0 though, the second bit is just discarded.</p>

    <p class="text-gray-300">This stream of bits is then used to generate the <span class="math">\\mathbf{L}\\mathbf{M}^{t}</span>, the <span class="math">\\mathbf{b}^{t}</span> and the <span class="math">\\mathbf{K}\\mathbf{M}^{t}</span>.</p>

    <p class="text-gray-300">We begin by creating the <span class="math">\\mathbf{L}\\mathbf{M}^{t}</span>. Let <span class="math">s=240</span>. We now fill the matrix with the bits from the bit stream row by row: <span class="math">\\mathbf{L}\\mathbf{M}^{0}_{i,j}=a_{s+ni+j}</span>. Now we check whether the <span class="math">\\mathbf{L}\\mathbf{M}^{0}</span>, we generated this way, is invertible. If it is not, we discard it and redo the same procedure with the next bits from the bit stream. Otherwise we continue to create the next matrix.</p>

    <p class="text-gray-300">Once we have generated all <span class="math">\\mathbf{L}\\mathbf{M}^{t}</span>, we create the round constants <span class="math">\\mathbf{b}^{t}</span>. Let <span class="math">a_{s-1}</span> be the last used bit from the bit stream. We then set <span class="math">\\mathbf{b}^{0}_{i}=a_{s+i}</span> and continue likewise until all round constants are set.</p>

    <p class="text-gray-300">Finally the matrices <span class="math">\\mathbf{K}\\mathbf{M}^{t}</span> for the key generation are created. Let again <span class="math">a_{s-1}</span> be the last used bit from the bit stream. We then set <span class="math">\\mathbf{K}\\mathbf{M}^{0}_{i,j}=a_{s+ni+j}</span>. If the rank of this matrix is not equal to <span class="math">\\min(n,k)</span>, we discard it and redo the same procedure with the next bits from the bit stream. Otherwise we continue to create the next matrix in the same manner.</p>`;
---

<BaseLayout title="Ciphers for MPC and FHE (2016/687)">
  <article class="max-w-4xl mx-auto article-prose">
    <nav class="mb-8">
      <a href="/papers" class="text-blue-400 hover:text-blue-300">
        &larr; Back to Papers
      </a>
    </nav>

    <header class="mb-12">
      <h1 class="text-3xl font-bold mb-4"
        set:html={TITLE_HTML} />
      <p class="text-gray-400 mb-2"
        set:html={AUTHORS_HTML} />
      <p class="text-gray-500 text-sm mb-4">
        2016 &middot; eprint 2016/687
      </p>
      <div class="flex gap-4 text-sm">
        <a
          href={EPRINT_URL}
          target="_blank"
          rel="noopener noreferrer"
          class="text-blue-400 hover:text-blue-300"
        >
          Paper (eprint) &rarr;
        </a>
      </div>
      <p class="mt-4 text-xs text-gray-500">
        All content below belongs to the original authors. This page
        reproduces the paper for educational purposes. Always
        <a
          href={EPRINT_URL}
          target="_blank"
          rel="noopener noreferrer"
          class="text-blue-400 hover:text-blue-300"
        >cite the original</a>.
      </p>
      <p class="mt-1 text-xs text-gray-600">
        Converted with: {CRAWLER} &middot; {CONVERTED_DATE}
      </p>
    </header>

    <Fragment set:html={CONTENT} />

  </article>
</BaseLayout>
