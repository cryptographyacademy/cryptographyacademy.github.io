---
import BaseLayout from '../../layouts/BaseLayout.astro';

const EPRINT_URL = 'https://eprint.iacr.org/2014/111';
const CRAWLER = 'mistral';
const CONVERTED_DATE = '2026-02-16';
const TITLE_HTML = 'A Note on the CLRW2 Tweakable Block Cipher Construction';
const AUTHORS_HTML = 'Gordon Procter';

const CONTENT = `    <p class="text-gray-300">Gordon Procter</p>

    <p class="text-gray-300">Information Security Group, Royal Holloway, University of London gordon.procter.2011@rhul.ac.uk</p>

    <p class="text-gray-300">Abstract. In this note, we describe an error in the proof for CLRW2 given by Landecker et al. in their paper at CRYPTO 2012 on the beyond-birthday-bound security for tweakable block ciphers. We are able to resolve the issue, give a new bound for the security of CLRW2, and identify a potential limitation of this proof technique when looking to extend the scheme to provide asymptotic security.</p>

    <p class="text-gray-300">Tweakable block ciphers were formalised by Liskov, Rivest, and Wagner at CRYPTO 2002 [18]. A tweakable block cipher is a block cipher that admits an additional input (the tweak) to introduce extra variability at the message-block level, in the same way that a nonce or IV introduces variability at the message level. The Hasty Pudding Cipher [23] and Mercy [7] are early examples of ciphers that natively support a tweak; in the case of the Hasty Pudding Cipher, this was called Spice. The tweak may be public and, informally, the security aim is that, for a single key, the permutations indexed by the tweaks are independent; appropriate security notions are defined more formally in Section 2.2.</p>

    <p class="text-gray-300">Liskov et al. [18] describe the syntax and security requirements for tweakable block ciphers and describe two methods for building a tweakable block cipher from a standard block cipher. They also give a method to construct a strong tweakable block cipher¹ from a standard block cipher.</p>

    <p class="text-gray-300">Several tweakable block ciphers have been proposed including Goldenberg et al.'s work on tweaking Luby-Rackoff ciphers [9]; Rogaway's XE and XEX modes [22], which are closely related to the OCB mode of operation [14]; and Threefish [8], which forms part of the hash function Skein [8].</p>

    <p class="text-gray-300">Many block-cipher-based encryption and authentication schemes are secure up to the birthday bound, i.e. provided that fewer than <span class="math">2^{\\frac{n}{2}}</span> queries are made, where <span class="math">n</span> is the width of the block cipher (in bits). Beyond this point, one would expect a collision in the input to the block cipher to occur and for this to perhaps leak some information or simplify forgery attempts (as described in, for example, [1,3,4,20]). Several works have studied the security of schemes beyond the birthday bound (for examples, see [10,12]); one related question is how to achieve beyond-birthday-bound security for tweakable block ciphers.</p>

    <p class="text-gray-300">At FSE 2009, Minematsu [21] suggested a method to build a <span class="math">2n</span>-bit tweakable block cipher that provides <span class="math">\\mathcal{O}(2^{\\frac{n + m}{2}})</span> security from an <span class="math">n</span>-bit block cipher (where <span class="math">m</span> is the size of the tweak). This scheme has a Luby-Rackoff or Feistel structure, but has the disadvantage of only supporting short tweaks and requiring per-invocation block-cipher rekeying which makes changing the tweak computationally expensive.</p>

    <p class="text-gray-300">At CRYPTO 2012 Landecker, Shrimpton, and Terashima [16] continued the study of tweakable block ciphers. Their paper has two main contributions: specifying CLRW2, a tweakable block cipher construction that remains secure beyond the birthday bound (up to approximately</p>

    <p class="text-gray-300">¹ Informally, a strong tweakable block cipher is one that remains secure when the adversary is given also access to a decryption oracle.</p>

    <p class="text-gray-300"><span class="math">2^{\\frac{2n}{3}}</span> queries); and giving a proof that TBC-MAC (the analogue of CBC-MAC defined in terms of tweakable block ciphers) is both a PRF and unforgeable. CLRW2 allows arbitrarily long tweaks and does not require excessive rekeying of the block cipher.</p>

    <p class="text-gray-300">The CLRW2 construction was extended by Lampe and Seurin at FSE 2013 <em>[15]</em> who consider longer chains of the LRW2 construction and are able to show (asymptotically in the number of rounds, using a coupling argument) that this provides greater security further beyond the birthday bound than the CLRW2 construction. Their bounds agree with Landecker et al.’s bound in the case of non-adaptive CPA adversaries and they prove a weaker bound for CCA adversaries; they conjecture that the bound proved for non-adaptive CPA adversaries also holds for CCA adversaries.</p>

    <h4 id="sec-3" class="text-lg font-semibold mt-6">Contributions</h4>

    <p class="text-gray-300">This is an early draft in which we identify a flaw in the proof given by Landecker et al. for CLRW2 <em>[16, 17]</em> and are able to resolve it. We describe modifications that correct the proof and give new bounds for the security of CLRW2. We also identify a potential issue which may prevent this proof technique being used to extend these results asymptotically, although this issue does not appear to affect Lampe and Seurin’s results.</p>

    <p class="text-gray-300">Landecker et al. have independently identified and corrected the error in their proof <em>[24]</em>; they correct the proof using a neat coupling argument which results in a tighter bound.</p>

    <h4 id="sec-4" class="text-lg font-semibold mt-6">Structure</h4>

    <p class="text-gray-300">This note is structured as follows: In Section 2, we introduce the notation, syntax, and security models used in this note; in Section 3, we give a brief summary of Landecker et al.’s scheme and corresponding proof; in Section 4, we describe and demonstrate the error that we have identified in the proof; in Section 5, we give one possible method to fix this error and derive new bounds for the security of CLRW2; and Section 6 contains a description of some issues that may prevent this proof technique being extended asymptotically.</p>

    <h2 id="sec-5" class="text-2xl font-bold">2 Preliminaries</h2>

    <h3 id="sec-6" class="text-xl font-semibold mt-8">2.1 Notation</h3>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">For a set <span class="math">\\mathcal{X}</span>, we write <span class="math">x\\stackrel{{\\scriptstyle\\S}}{{\\leftarrow}}\\mathcal{X}</span> to represent an element <span class="math">x</span> being uniformly sampled from <span class="math">\\mathcal{X}</span>. For a bitstring <span class="math">x\\in\\{0,1\\}^{*}</span> we use $</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">x</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"><span class="math"> to denote its length. We use </span>\\xi(p)<span class="math"> to represent a Bernoulli random variable that is </span>1<span class="math"> with probability </span>p<span class="math"> and </span>0<span class="math"> with probability </span>1-p<span class="math">. For a set </span>S\\subseteq\\{0,1\\}^{n}<span class="math"> and an element </span>x\\in\\{0,1\\}^{n}<span class="math"> we define </span>S\\oplus x=\\{s\\oplus x:s\\in S\\}$.</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">We follow the code-based game paradigm of Bellare and Rogaway <em>[5]</em>. We will use <span class="math">X_{i}</span> to denote plaintext input to a tweakable block cipher and <span class="math">Y_{i}</span> for ciphertext output. Queries made by an adversary and the value of random variables related to those queries are be indexed by a counter <span class="math">i</span>. In games, all boolean flags are initialised to false and arrays are initially undefined at every point.</p>

    <h3 id="sec-7" class="text-xl font-semibold mt-8">2.2 Block Cipher Syntax and Security</h3>

    <p class="text-gray-300">A block cipher is a family of functions: <span class="math">E:\\mathcal{K}\\times\\{0,1\\}^{n}\\rightarrow\\{0,1\\}^{n}</span>, where <span class="math">\\mathcal{K}</span> is the keyspace. We require that <span class="math">E(k,\\cdot)</span> is a permutation on <span class="math">\\{0,1\\}^{n}</span> for every choice of key <span class="math">k</span>. We will often denote <span class="math">E(k,\\cdot)</span> by <span class="math">E_{k}(\\cdot)</span> and the inverse of this permutation by <span class="math">E_{k}^{-1}(\\cdot)</span>.</p>

    <p class="text-gray-300">We follow Bellare, Kilian, and Rogaway <em>[2]</em> and say that a block cipher is secure if it is a pseudo-random permutation family (PRP). A pseudo-random permutation family is a set of</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">permutations $\\{E_{k}</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">k\\in\\mathcal{K}\\}<span class="math"> that is indistinguishable from a random permutation family </span>\\Pi<span class="math"> also indexed by elements of </span>\\mathcal{K}$. A strong pseudo-random permutation family (SPRP) is a pseudo-random permutation family that remains indistinguishable from a random permutation family when an adversary is also given access to either a decryption oracle, or to the random permutation’s inverse.</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">Consider an adversary <span class="math">\\mathcal{A}</span> and define their SPRP advantage against <span class="math">E</span> as</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">$\\mathrm{Adv}^{\\mathrm{sprp}}_{E}(\\mathcal{A})=\\left</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\Pr[1\\leftarrow\\mathcal{A}^{(E_{k},E_{k}^{-1})}]-\\Pr[1\\leftarrow\\mathcal{A}^{(\\pi,\\pi^{-1})}]\\right</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">$</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">where <span class="math">k\\stackrel{{\\scriptstyle\\</span>}}{{\\leftarrow}}\\mathcal{K}<span class="math"> and </span>\\pi\\stackrel{{\\scriptstyle\\<span class="math">}}{{\\leftarrow}}\\Pi</span>. Define <span class="math">\\mathrm{Adv}^{\\mathrm{sprp}}_{E}(q,t)</span> to be the maximum advantage that can be realised by an adversary asking no more than <span class="math">q</span> queries and running in time at most <span class="math">t</span>. We say that <span class="math">E</span> is a strong pseudo-random permutation if <span class="math">\\mathrm{Adv}^{\\mathrm{sprp}}_{E}(q,t)</span> is sufficiently small.</p>

    <p class="text-gray-300">A tweakable block cipher is a family of functions: <span class="math">\\widetilde{E}:\\mathcal{K}\\times\\mathcal{T}\\times\\{0,1\\}^{n}\\rightarrow\\{0,1\\}^{n}</span>, where <span class="math">\\mathcal{K}</span> is the keyspace and <span class="math">\\mathcal{T}</span> is the tweakspace. We require that, for every <span class="math">k\\in\\mathcal{K}</span> and <span class="math">T_{i}\\in\\mathcal{T}</span>, <span class="math">\\widetilde{E}_{k}(T_{i},\\cdot)</span> is a permutation on <span class="math">\\{0,1\\}^{n}</span> and we denote the inverse of this permutation by <span class="math">\\widetilde{E}_{k}^{-1}\\left(T_{i},\\cdot\\right)</span>. We remark that in the case of CLRW2, a tweakable block cipher key includes two keys for the underlying block cipher and two keys for the universal hash function family, i.e. <span class="math">k=(k_{1},H_{1},k_{2},H_{2})</span>.</p>

    <p class="text-gray-300">We use the definition of tweakable block cipher security given by Liskov et al. <em>[18, 19]</em>. A secure tweakable block cipher is one that is indistinguishable from a tweaked random permutation family <span class="math">\\widetilde{\\Pi}</span>, where <span class="math">\\widetilde{\\Pi}</span> is a set of random permutations on <span class="math">\\{0,1\\}^{n}</span> indexed by elements of <span class="math">\\mathcal{K}\\times\\mathcal{T}</span>. A strong tweakable block cipher is one that is indistinguishable from a tweaked random permutation family when an adversary is given either access to encryption and decryption oracles for the tweakable block cipher or access to a family of tweaked random permutations and their inverses. In the definition of both tweakable block ciphers and strong tweakable block ciphers, the adversary is able to choose both the input and the tweak for each query.</p>

    <p class="text-gray-300">Consider an adversary <span class="math">\\mathcal{A}</span> and define their tweakable-SPRP advantage against <span class="math">\\widetilde{E}</span> as</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">$\\mathrm{Adv}^{\\mathrm{sprp}}_{\\widetilde{E}}(\\mathcal{A})=\\left</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\Pr[1\\leftarrow\\mathcal{A}^{(\\widetilde{E}_{k},\\widetilde{E}_{k}^{-1})}]-\\Pr[1\\leftarrow\\mathcal{A}^{(\\widetilde{\\pi},\\widetilde{\\pi}^{-1})}]\\right</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">$</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">where <span class="math">k\\stackrel{{\\scriptstyle\\</span>}}{{\\leftarrow}}\\mathcal{K}<span class="math"> and </span>\\widetilde{\\pi}=\\{\\pi(k,T_{i},\\cdot)\\in\\widetilde{\\Pi}:T_{i}\\in\\mathcal{T}\\}<span class="math">. Define </span>\\mathrm{Adv}^{\\mathrm{sprp}}_{\\widetilde{E}}(q,t)<span class="math"> to be the maximum advantage that can be realised by an adversary making no more than </span>q<span class="math"> queries and running in time at most </span>t<span class="math">. We say that </span>\\widetilde{E}<span class="math"> is a strong tweakable block cipher if </span>\\mathrm{Adv}^{\\mathrm{sprp}}_{\\widetilde{E}}(q,t)$ is sufficiently small.</p>

    <h3 id="sec-8" class="text-xl font-semibold mt-8">2.3 Universal Hash Functions</h3>

    <p class="text-gray-300">A family of hash functions will be denoted <span class="math">\\mathcal{H}=\\{h_{H}:\\{0,1\\}^{\\star}\\rightarrow\\{0,1\\}^{n}\\mid H\\in\\mathcal{K}_{\\mathcal{H}}\\}</span> with each hash function <span class="math">h_{H}</span> indexed by a key <span class="math">H\\in\\mathcal{K}_{\\mathcal{H}}</span>. For simplicity and clarity, we will abbreviate <span class="math">h_{H_{j}}</span> to <span class="math">h_{j}</span>.</p>

    <p class="text-gray-300">A family of hash functions is said to be <span class="math">\\epsilon</span>–almost XOR universal <em>[13]</em> if for every <span class="math">M,M^{\\prime}\\in\\{0,1\\}^{\\star}</span> with <span class="math">M\\neq M^{\\prime}</span> and for every <span class="math">c\\in\\{0,1\\}^{n}</span>, <span class="math">\\Pr_{H\\in\\mathcal{K}_{\\mathcal{H}}}\\left[h_{H}(M)\\oplus h_{H}(M^{\\prime})=c\\right]&lt;\\epsilon</span>. Throughout this paper <span class="math">\\epsilon</span>–almost XOR universal will be abbreviated to <span class="math">\\epsilon</span>–AXU.</p>

    <h2 id="sec-9" class="text-2xl font-bold">3 Description of the CLRW2 Tweakable Block Cipher Construction</h2>

    <p class="text-gray-300">The scheme proposed by Landecker et al. <em>[16]</em> combines an <span class="math">\\epsilon</span>-AXU hash function and a block cipher. The ciphertext <span class="math">Y_{i}</span> is computed from plaintext <span class="math">X_{i}</span> using key <span class="math">k=(k_{1},H_{1},k_{2},H_{2})</span> and tweak <span class="math">T_{i}</span> as follows:</p>

    <p class="text-gray-300"><span class="math">Y_{i}=E_{k_{2}}\\left(E_{k_{1}}(X_{i}\\oplus h_{1}(T_{i}))\\oplus h_{1}(T_{i})\\oplus h_{2}(T_{i})\\right)\\oplus h_{2}(T_{i})</span></p>

    <p class="text-gray-300">!<a href="img-0.jpeg">img-0.jpeg</a> Fig. 1. The CLRW2 tweakable block cipher construction.</p>

    <p class="text-gray-300">This construction is illustrated in Figure 1. The intuition behind the security of CLRW2 is that an adversary can only obtain a 'birthday-bound-style' advantage by causing a collision at both inputs to the block cipher. The reduction given by Landecker et al. (which relies on the SPRP security of the block cipher to show the strong tweakable block cipher security of CLRW2) proceeds via a series of games. The aim of these games is to show that the output of CLRW2 is close to that of an ideal tweakable block cipher, in the absence of a query that causes a collision at both block cipher inputs and that the likelihood of such a query is sufficiently low.</p>

    <p class="text-gray-300">We largely follow the notation used by Landecker et al. [16,17] to avoid introducing confusion.</p>

    <p class="text-gray-300">Throughout this paper, we will lazy-sample random permutations instead of defining the permutation up front. When referring to the domain and range of a permutation  <span class="math">\\pi : \\{0,1\\}^n \\to \\{0,1\\}^n</span> , we will use  <span class="math">\\mathsf{Dom}_{\\mathrm{full}}(\\pi)</span>  and  <span class="math">\\mathsf{Rng}_{\\mathrm{full}}(\\pi)</span>  to denote the set  <span class="math">\\{0,1\\}^n</span>  in order to make clear the context that this set relates to. When lazy-sampling a permutation  <span class="math">\\pi : \\{0,1\\}^n \\to \\{0,1\\}^n</span>  we will use the sets  <span class="math">\\mathsf{Dom}_{\\mathrm{lazy}}(\\pi) \\subseteq \\mathsf{Dom}_{\\mathrm{full}}(\\pi) = \\{0,1\\}^n</span>  and  <span class="math">\\mathsf{Rng}_{\\mathrm{lazy}}(\\pi) \\subseteq \\mathsf{Rng}_{\\mathrm{full}}(\\pi) = \\{0,1\\}^n</span>  to keep track of which values have been defined in the domain and range (respectively) of  <span class="math">\\pi</span> . We will often drop the subscript for the sets  <span class="math">\\mathsf{Dom}_{\\mathrm{lazy}}(\\pi)</span>  and  <span class="math">\\mathsf{Rng}_{\\mathrm{lazy}}(\\pi)</span>  provided that the meaning is clear. The 'lazy' sets have an implicit query index because they are only defined relative to the previous queries and random choices within them.</p>

    <p class="text-gray-300">We use  <span class="math">\\mathcal{Y}_i = \\{0,1\\}^n \\setminus \\{Y_j : j &amp;lt; i \\text{ and } T_j = T_i\\}</span>  and  <span class="math">\\overline{\\mathcal{Y}_i} = \\{0,1\\}^n \\setminus \\mathcal{Y}_i</span> . That is, if  <span class="math">Y_i \\in \\overline{\\mathcal{Y}_i}</span>  then  <span class="math">Y_i</span>  is not a possible output from an ideal tweakable block cipher given the output from previous queries (recalling that  <span class="math">\\widetilde{E}(k,T_i,\\cdot)</span>  is a permutation). Hence,  <span class="math">\\mathcal{Y}_i</span>  is the set of possible output values from an ideal tweakable block cipher.</p>

    <p class="text-gray-300">We define the sets  <span class="math">S_{j}</span>  as they are defined in Landecker et al.'s paper and present them graphically in Figure 2. These sets partition  <span class="math">\\{0,1\\}^{n}</span>  for a particular input  <span class="math">(X_{i},T_{i})</span>  according to the whether the corresponding inputs and outputs of each permutation have already been defined. As above, these sets have an implicit query index.</p>

    <p class="text-gray-300"><span class="math">S_{1} = \\{Y_{i}\\in \\mathcal{Y}_{i}:Y_{i}\\oplus h_{2}(T_{i})\\notin \\mathsf{Rng}(\\pi_{2})\\}</span></p>

    <p class="text-gray-300"><span class="math">S_{2} = \\{Y_{i}\\in \\mathcal{Y}_{i}:Y_{i}\\oplus h_{2}(T_{i})\\in \\mathsf{Rng}(\\pi_{2})\\wedge \\pi_{2}^{-1}(Y_{i}\\oplus h_{2}(T_{i}))\\oplus h_{1}(T_{i})\\oplus h_{2}(T_{i})\\notin \\mathsf{Rng}(\\pi_{1})\\}</span></p>

    <p class="text-gray-300"><span class="math">S_{3} = \\{Y_{i}\\in \\mathcal{Y}_{i}:Y_{i}\\oplus h_{2}(T_{i})\\in \\mathsf{Rng}(\\pi_{2})\\wedge \\pi_{2}^{-1}(Y_{i}\\oplus h_{2}(T_{i}))\\oplus h_{1}(T_{i})\\oplus h_{2}(T_{i})\\in \\mathsf{Rng}(\\pi_{1})\\}</span></p>

    <p class="text-gray-300"><span class="math">S_{4} = \\{Y_{i}\\in \\overline{\\mathcal{Y}_{i}}\\}</span></p>

    <p class="text-gray-300">That is,  <span class="math">S_{1}</span>  is the set of output values that correspond to undefined outputs from  <span class="math">\\pi_{2}</span>  and  <span class="math">S_{2}</span>  is the set of output values corresponding to defined outputs from  <span class="math">\\pi_{2}</span> , but for which the output of  <span class="math">\\pi_{1}</span>  is undefined. The set  <span class="math">S_{3}</span>  contains output values for which the all inputs and outputs to the block cipher are defined. Because we only consider these sets when  <span class="math">L_{i} \\notin \\mathsf{Rng}(\\pi_{1})</span> , these</p>

    <p class="text-gray-300">!<a href="img-1.jpeg">img-1.jpeg</a> Fig. 2. An illustration of the definition for sets  <span class="math">S_{i}</span> . The domain and range of each permutation are divided into two sets: the input/output pairs that are 'Old' (in  <span class="math">\\mathsf{Dom}(\\pi_j)</span>  and  <span class="math">\\mathsf{Rng}(\\pi_j)</span> ), shown above the dashed line; and the points that are 'New' (in  <span class="math">\\overline{\\mathsf{Dom}(\\pi_j)}</span>  and  <span class="math">\\overline{\\mathsf{Rng}(\\pi_j)}</span> ), shown below the dashed line. In the case that  <span class="math">L_{i} \\notin \\mathsf{Dom}(\\pi_{1})</span> , any value corresponding to a black box in the above diagram is impossible. Fig. 3. Game 0 defines the scheme when it is instantiated with a specific block cipher. It is included here to introduce the random variables corresponding to inputs and outputs to the random permutations in later games.</p>

    <p class="text-gray-300">output values are inconsistent with the responses to previous queries. Finally,  <span class="math">S_4 = \\overline{\\mathcal{Y}_i}</span>  is the set of values that are not possible for either an ideal tweakable block cipher or the CLRW2 construction; responding to a query with an element of this set would violate the requirement for each  <span class="math">\\widetilde{E}(k, T_i, \\cdot)</span>  to be a permutation.</p>

    <p class="text-gray-300">At a first glance,  <span class="math">S_{3}</span>  is appears to be the difference between CLRW2 and an ideal tweakable block cipher: elements in  <span class="math">S_{4}</span>  are not possible in either case; elements in  <span class="math">S_{1}</span>  and  <span class="math">S_{2}</span>  are possible in both cases; while elements in  <span class="math">S_{3}</span>  are not excluded from the output of an ideal tweakable block cipher but are impossible if CLRW2 is used. This informal summary does not give the full detail – if the situation were this simple, the original proof would be correct.</p>

    <p class="text-gray-300">We use  <span class="math">p_{TBC}(Y_i)</span>  to denote the probability that  <span class="math">Y_i</span>  is the output of the ideal tweakable block cipher and  <span class="math">p_{G3}(Y_i)</span>  for the probability that  <span class="math">Y_i</span>  is the output of the intermediate cipher defined in Game 3 of the proof; these probabilities are both conditioned on all previous queries and responses.</p>

    <p class="text-gray-300">We give a brief overview of Landecker et al.'s proof below but refer to the original papers [16,17] for the full details.</p>

    <p class="text-gray-300">Game 0 defines the scheme when it is instantiated with a particular block cipher and is given in Figure 3, to introduce the random variables corresponding to inputs and outputs to the random permutations in later games.</p>

    <p class="text-gray-300">Game 0</p>

    <p class="text-gray-300">1: procedure  <span class="math">\\widetilde{E} (T,X)</span> 2:  <span class="math">i\\gets i + 1;X_{i}\\gets X;T_{i}\\gets T</span> 3:  <span class="math">L_{i}\\gets X_{i}\\oplus h_{1}(T_{i})</span> 4:  <span class="math">Z_{i}\\gets E_{k_{1}}(L_{i})</span> 5:  <span class="math">M_{i}\\gets Z_{i}\\oplus h_{1}(T_{i})\\oplus h_{2}(T_{i})</span> 6:  <span class="math">Y_{i}\\gets E_{k_{2}}(M_{i})\\oplus h_{2}(T_{i})</span></p>

    <p class="text-gray-300">return  <span class="math">Y_{i}</span></p>

    <p class="text-gray-300">Games 1 to 3 consider the case in which there is a collision at the input to the first block cipher. The conclusion of this analysis is that in the absence of a collision at both block ciphers</p>

    <p class="text-gray-300">on the same query, the output of CLRW2 is indistinguishable from an ideal tweakable block cipher and that the probability of two block cipher collisions being caused by the same query is sufficiently small that the scheme remains secure up to approximately <span class="math">2^{\\frac{2n}{3}}</span> queries.</p>

    <p class="text-gray-300">In Game 1, the block cipher is replaced with a random permutation, which is lazy-sampled. The security of this scheme relies on the assumption that the block cipher used to instantiate the scheme is a strong pseudorandom permutation and the distinguishing advantage between Game 0 and Game 1 is bounded above by <span class="math">2\\text{Adv}^{\\text{aprp}}_{E}(\\mathcal{A})</span>.</p>

    <p class="text-gray-300">Between Games 1 and 3, the only changes to the definition of these games are in section of code that is executed when the image of <span class="math">L_{i}</span> under <span class="math">\\pi_{1}</span> has already been defined. The differences between these games are as follows. In Game 1, the existing definition of <span class="math">\\pi_{2}(M_{i})</span> is used. In Game 2, <span class="math">Y_{i}</span> is sampled from <span class="math">\\mathcal{Y}_{i}</span> (the set of possible values) and this definition is checked to ensure that it does not contradict any existing definition of <span class="math">\\pi_{2}(M_{i})</span> or <span class="math">\\pi_{2}^{-1}(Y_{i}\\oplus h_{2}(T_{i}))</span>. If the sampling of <span class="math">Y_{i}</span> from <span class="math">\\mathcal{Y}_{i}</span> does cause a contradiction, one of <span class="math">\\mathsf{bad}_{1}</span> and <span class="math">\\mathsf{bad}_{2}</span> is set to true and <span class="math">Y_{i}</span> is redefined. Game 3 is identical to Game 2, except that in <span class="math">Y_{i}</span> is never redefined in Game 4, even if a bad flag is set to true. The difference between Game 1 and Game 2 is purely syntactic; the distribution of all random variables in the two games are identical. The distributions of all random variables in Games 2 and 3 are identical unless either <span class="math">\\mathsf{bad}_{1}</span> or <span class="math">\\mathsf{bad}_{2}</span> is set to true.</p>

    <p class="text-gray-300">Games 4 to 6 address the case in which there is no first round collision; it is in this case that we have identified the problem with the proof. In these games, no changes are made to the code that is executed when <span class="math">\\pi_{1}(L_{i})</span> is already defined.</p>

    <p class="text-gray-300">Between Game 3 and Game 4, the order in which <span class="math">Z_{i}</span> and <span class="math">Y_{i}</span> are sampled is changed, however the joint distribution is not changed. Between Games 4 and 5, the method used to sample <span class="math">Z_{i}</span> and <span class="math">Y_{i}</span> is changed, with the aim that the final joint distribution is unchanged. We will see that this aim is not achieved and that this is where the error in the proof occurs.</p>

    <p class="text-gray-300">Game 5 and Game 6 are identical unless it is necessary to redefine <span class="math">Y_{i}</span>. If it is necessary to redefine <span class="math">Y_{i}</span> in Game 5, then <span class="math">\\mathsf{bad}_{3}</span> is set to true and so these two games are identical until bad, in a similar way to Game 2 and Game 3. Game 6 and Game 7 are functionally identical and Game 7 realises an ideal tweakable block cipher.</p>

    <p class="text-gray-300">Game 8 is essentially identical to Game 7, but gives the adversary control over the <span class="math">Y_{i}</span> values. The motivation for this step is that this makes it no harder for an adversary to trigger any of the bad events, but makes it easier to reason about the probability of a bad event occurring.</p>

    <h2 id="sec-12" class="text-2xl font-bold">4 The Error in the Proof</h2>

    <h3 id="sec-13" class="text-xl font-semibold mt-8">4.1 Games 4 and 5 are not Identical</h3>

    <p class="text-gray-300">In the proof of security given for CLRW2 <em>[16, 17]</em>, Landecker et al. assert that the output distributions of Games 4 and 5 are identical. However, this is only the case if <span class="math">p_{G3}(Y_{i})-p_{TBC}(Y_{i})</span> is non-negative for <span class="math">Y_{i}\\in S_{1}\\cup S_{2}</span>. This is because the resampling step in Game 5 (at Lines 618-9) only produces an identical distribution to that of Game 4 if <span class="math">p_{G3}(Y_{i})\\geq p_{TBC}(Y_{i})</span> for <span class="math">Y_{i}\\in S_{1}\\cup S_{2}</span>.</p>

    <p class="text-gray-300">It is possible for a series of queries to result in <span class="math">p_{G3}(Y_{i})-p_{TBC}(Y_{i})</span> being negative for all <span class="math">Y_{i}\\in S_{1}</span>. This results in a contradiction to the claim that the output distributions of Games 4 and 5 are always identical.</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">In Section 5 we describe one method of modifying Games 5-8 to fix this issue with the proof. We redefine <span class="math">\\Delta_{i}=\\sum_{Y_{i}\\in S_{i}}p_{G3}(Y_{i})-p_{TBC}(Y_{i})</span> (without the modulus signs from Landecker et al.’s definition) and note that $</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\Delta_{i}</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">=\\sum_{Y_{i}\\in S_{i}}</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">p_{G3}(Y_{i})-p_{TBC}(Y_{i})</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"><span class="math"> because for a given set </span>S_{j}<span class="math"> either </span>p_{G3}(Y_{i})-p_{TBC}(Y_{i})\\geq 0<span class="math"> for every </span>Y_{i}<span class="math"> in </span>S_{j}<span class="math"> or </span>p_{G3}(Y_{i})-p_{TBC}(Y_{i})<0<span class="math"> for every </span>Y_{i}<span class="math"> in </span>S_{j}<span class="math">. Using our definition, </span></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\Delta_{j}</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"><span class="math"> corresponds precisely with Landecker et al.’s definition of </span>\\Delta_{j}$.</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">We briefly describe the differences between the sampling methods employed when <span class="math">L_{i}</span> is new in the relevant games. The resulting probability distributions are illustrated in Figures 7 to 9.</p>

    <p class="text-gray-300">In Game 3, <span class="math">Z_{i}</span> is chosen uniformly at random from <span class="math">\\overline{\\mathsf{Dom}(\\pi_{1})}</span> and <span class="math">Y_{i}</span> is defined to be consistent with this choice of <span class="math">Z_{i}</span>. In Game 4, an appropriately weighted coin is tossed and <span class="math">Y_{i}</span> is chosen from either <span class="math">S_{1}</span> or <span class="math">S_{2}</span> so that the distributions of <span class="math">Z_{i}</span> and <span class="math">Y_{i}</span> are identical to the distribution in Game 3. In Game 5, <span class="math">Y_{i}</span> is chosen uniformly from <span class="math">\\mathcal{Y}_{i}</span> and if <span class="math">Y_{i}</span> is in <span class="math">S_{3}</span> then it is resampled, from either <span class="math">S_{1}</span> or <span class="math">S_{2}</span>.</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">When <span class="math">Y_{i}</span> is resampled in Game 5, the probability that it is chosen in <span class="math">S_{2}</span> is $\\frac{</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\Delta_{2}</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">}{</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\Delta_{1}</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">+</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\Delta_{2}</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">}<span class="math">. This probability is used because if </span></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\Delta_{1}</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">+</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\Delta_{2}</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">=</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\Delta_{3}</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"><span class="math"> then the distribution of </span>Y_{i}<span class="math"> does not change between Games 4 and 5 <em>[17, p. 9]</em>. However, if </span>p_{G3}(Y_{i})-p_{TBC}(Y_{i})<0<span class="math"> then </span></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\Delta_{2}</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">=</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\Delta_{1}</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">+</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\Delta_{3}</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"><span class="math">, so </span></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\Delta_{1}</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">+</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\Delta_{2}</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\Delta_{3}</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"><span class="math"> and the distribution of </span>Y_{i}$ does change.</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">In fact, the difference between the distributions in Games 4 and 5 is exaggerated by the method used by Landecker et al. to resample from <span class="math">S_{1}\\cup S_{2}</span> if <span class="math">Y_{i}\\in S_{3}</span>, as illustrated in Figure 11. In the case that <span class="math">p_{G3}(Y_{i})-p_{TBC}(Y_{i})&lt;0</span> for <span class="math">Y_{i}\\in S_{1}</span>, the desired difference between the distributions in Game 4 and Game 5 for <span class="math">Y_{i}\\in S_{1}</span> is $-</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\Delta_{1}</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">$, i.e.</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">$\\sum_{Y_{i}\\in S_{1}}p_{G3}(Y_{i})=\\sum_{Y_{i}\\in S_{1}}p_{TBC}(Y_{i})-</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\Delta_{1}</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">$</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">but using the sampling method described, this increases this to $</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\Delta_{1}</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\cdot\\frac{</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\Delta_{3}</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">}{</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\Delta_{1}</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">+</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\Delta 2</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">}$, so that</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">$\\sum_{Y_{i}\\in S_{1}}p_{G3}(Y_{i})=\\sum_{Y_{i}\\in S_{1}}p_{TBC}(Y_{i})+</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\Delta_{1}</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\cdot\\frac{</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\Delta_{3}</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">}{</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\Delta_{1}</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">+</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\Delta 2</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">}.$</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Similarly, the difference for <span class="math">Y_{i}\\in S_{2}</span> is decreased from $</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\Delta_{2}</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"><span class="math"> to </span></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\Delta_{2}</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\cdot\\frac{</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\Delta_{3}</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">}{</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\Delta_{1}</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">+</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\Delta 2</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">}$.</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <h3 id="sec-14" class="text-xl font-semibold mt-8">4.2 How to make <span class="math">p_{G3}(Y_{i})-p_{TBC}(Y_{i})&lt;0</span></h3>

    <p class="text-gray-300">The proof given by Landecker et al. <em>[16, 17]</em> is correct provided that <span class="math">p_{G3}(Y_{i})-p_{TBC}(Y_{i})\\geq 0</span> when <span class="math">Y_{i}\\in S_{1}\\cup S_{2}</span>. We will call the situation in which <span class="math">p_{G3}(Y_{i})-p_{TBC}(Y_{i})&lt;0</span> for some <span class="math">Y_{i}\\in S_{i}\\cup S_{2}</span> an <em>inversion</em>. To demonstrate an inversion, first recall that:</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"><span class="math">p_{TBC}(Y_{i})</span> $=\\frac{1}{2^{n}-</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">S_{4}</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">}\\text{ for }Y_{i}\\notin S_{4},$</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300"><span class="math">p_{G3}(Y_{i})</span> <span class="math">=\\frac{1}{N}\\text{ for }Y_{i}\\in S_{2},</span></p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">where $N=</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\overline{\\mathsf{Dom}(\\pi_{1})}</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">$.</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <h4 id="sec-15" class="text-lg font-semibold mt-6"><span class="math">Y_{i}\\in S_{1}</span></h4>

    <p class="text-gray-300">We consider the possibility of an inversion occurring for <span class="math">Y_{i}\\in S_{1}</span> and show that an adversary can force an inversion to happen for <span class="math">Y_{i}</span> in <span class="math">S_{1}</span> with high probability. In this case, an inversion occurs when</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">$\\frac{1}{2^{n}-</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">S_{4}</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">}=p_{TBC}(Y_{i})>p_{G3}(Y_{i})=\\frac{N-</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">S_{2}</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">}{N</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">S_{1}</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">}$</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Suppose that the adversary asks a number of queries so that $</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\mathsf{Dom}(\\pi_{1})</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">=a<span class="math"> and </span></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\mathsf{Dom}(\\pi_{2})</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">=b<span class="math">, with no restrictions on how </span>X_{i}<span class="math"> and </span>T_{i}<span class="math"> are chosen. Then, one way that an inversion can occur with high probability is if: the adversary uses a new tweak for the next query; </span>L_{i}<span class="math"> is new; and for every </span>Z_{i}\\in\\mathsf{Rng}(\\pi_{1})<span class="math">, </span>Z_{i}\\oplus h_{1}(T_{i})\\oplus h_{2}(T_{i})\\in\\overline{\\mathsf{Dom}(\\pi_{2})}$.</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">In this case:</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">$N=2^{n}-a,\\quad</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">S_{1}</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">=2^{n}-b,\\quad</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">S_{2}</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">=b,\\text{ and }</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">S_{3}</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">=</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">S_{4}</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">=0.$</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">Starting with the observation that <span class="math">ab&gt;0</span>, the following statements are equivalent:</p>

    <p class="text-gray-300"><span class="math">ab&gt;0</span> <span class="math">2^{2n}-(a+b)2^{n}+ab&gt;2^{2n}-(a+b)2^{n}</span> <span class="math">(2^{n}-a)(2^{n}-b)&gt;2^{n}(2^{n}-a-b)</span> <span class="math">\\frac{1}{2^{n}}&gt;\\frac{2^{n}-a-b}{(2^{n}-a)(2^{n}-b)}</span></p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">$\\frac{1}{2^{n}-</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">S_{4}</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">}>\\frac{N-</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">S_{2}</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">}{N</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">S_{1}</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">}$</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300"><span class="math">p_{TBC}(Y_{i})&gt;p_{G3}(Y_{i})</span></p>

    <p class="text-gray-300">which is the condition for an inversion.</p>

    <p class="text-gray-300">This situation can occur and indeed it is easy for an adversary to force this event to happen. If <span class="math">T_{1}\\neq T_{2}</span> then an inversion occurs on the second query (where <span class="math">a=b=1</span>) with probability <span class="math">1-\\epsilon\\approx\\frac{2^{n}-1}{2^{n}}</span>, which is the probability that <span class="math">h_{j}(T_{1})\\neq h_{j}(T_{2})</span> when <span class="math">T_{1}\\neq T_{2}</span> (this probability is conditioned on the event <span class="math">L_{i}\\in\\overline{\\mathsf{Dom}(\\pi_{1})}</span> having occurred).</p>

    <h4 id="sec-16" class="text-lg font-semibold mt-6"><span class="math">Y_{i}\\in S_{2}</span></h4>

    <p class="text-gray-300">We also consider the possibility of an inversion occurring for <span class="math">Y_{i}\\in S_{2}</span>. For an inversion to occur we need</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">$\\frac{1}{2^{n}-</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">S_{4}</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">}=p_{TBC}(Y_{i})>p_{G3}(Y_{i})=\\frac{1}{N}$</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">Now note that</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">$2^{n}-</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">S_{4}</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\geq</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">S_{1}</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">+</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">S_{2}</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\geq N$</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">and so</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">$\\frac{1}{2^{n}-</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">S_{4}</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">}\\leq\\frac{1}{</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">S_{1}</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">+</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">S_{2}</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">}\\leq\\frac{1}{N}$</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">Therefore, for <span class="math">Y_{i}\\in S_{2}</span>, there is no situation in which <span class="math">p_{TBC}(Y_{i})\\geq p_{G3}(Y_{i})</span>.</p>

    <h4 id="sec-17" class="text-lg font-semibold mt-6">A Minor Issue with Landecker et al.’s Graph</h4>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">We also make the minor remark that the graph given by Landecker et al. <em>[16, Fig.3]</em> shows <span class="math">p_{G3}(Y_{1})\\geq p_{G3}(Y_{2})</span>, where <span class="math">Y_{1}\\in S_{1}</span> and <span class="math">Y_{2}\\in S_{2}</span>, when in fact this situation can never occur as $N-</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">S_{2}</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"><span class="math"> is never any larger than </span></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">S_{1}</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">$ and</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">$N-</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">S_{2}</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\leq</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">S_{1}</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\Leftrightarrow\\frac{N-</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">S_{2}</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">}{</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">S_{1}</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">}\\leq 1\\Leftrightarrow\\frac{N-</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">S_{2}</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">}{N</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">S_{1}</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">}\\leq\\frac{1}{N}\\Leftrightarrow p_{G3}(Y_{1})\\leq p_{G3}(Y_{2}).$</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <h2 id="sec-18" class="text-2xl font-bold">5 How to Fix Landecker et al.’s Proof</h2>

    <p class="text-gray-300">The proof given by Landecker et al. can be fixed by modifying Games 5 to 8. The strategy we have adopted is to not change the distribution of <span class="math">Y_{i}</span> between Games 4 and 5, then to bound the distance between the distributions that result from an ideal tweakable block cipher and from Game 5. This is the same strategy followed by Landecker et al. but we are careful to ensure that the distribution of <span class="math">Y_{i}</span> does not change between Games 4 and 5 when <span class="math">p_{G3}(Y_{i})-p_{TBC}(Y_{i})&lt;0</span>. This requires us to reduce the probability of <span class="math">Y_{i}</span> being sampled from <span class="math">S_{1}</span> when <span class="math">\\Delta_{1}&lt;0</span> in Game 5; we do this naïvely by tossing an appropriately weighted coin to decide whether to resample</p>

    <p class="text-gray-300"><span class="math">Y_{i}</span> from <span class="math">S_{2}</span>. We add conditional branches to differentiate between the cases <span class="math">\\Delta_{1}\\geq 0</span> and <span class="math">\\Delta_{1}&lt;0</span>; this is a simple approach, but appears to work well and we lose only a small factor in the bound.</p>

    <p class="text-gray-300">In Appendix A, we give the revised games (Figures 4, 5, and 6) and graphically represent the probability distributions realised by each of these games (Figures 7, 8, 9, 10, 11, and 12). We have only specified the encryption algorithm for each of game; it is straightforward to derive the corresponding decryption algorithms.</p>

    <p class="text-gray-300">The distributions of all random variables in Games 4 and <span class="math">5^{\\prime}</span> are identical. Games <span class="math">5^{\\prime}</span> and <span class="math">6^{\\prime}</span> are identical unless either <span class="math">\\mathsf{bad}_{3}</span> or <span class="math">\\mathsf{bad}_{4}</span> gets set to true. The distributions of random varibles in Games <span class="math">6^{\\prime}</span> and <span class="math">7^{\\prime}</span> are identical, with Game <span class="math">7^{\\prime}</span> simplifying some of the program flow. Game <span class="math">8^{\\prime}</span> gives the adversary control over <span class="math">Y_{i}</span> values, so the <span class="math">\\mathsf{bad}</span> flags can be set at least as easily as they can in Game <span class="math">7^{\\prime}</span>. We note that Game 8 and Game <span class="math">8^{\\prime}</span> are identical except for the addition of lines 14 to 17, so a large majority of the original analysis still applies.</p>

    <p class="text-gray-300">Landecker et al. have independently identified an alternative method to correct the error in their proof <em>[24]</em>, using a coupling argument which results in a tighter bound.</p>

    <h3 id="sec-19" class="text-xl font-semibold mt-8">5.1 A Bound on <span class="math">\\bm{\\Delta_{1}}</span></h3>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">To bound the advantage an adversary gains when we change from Game <span class="math">5^{\\prime}</span> to Game <span class="math">6^{\\prime}</span>, we need to bound $</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\Delta_{1}</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\frac{(2^{n}-</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">S_{4}</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">)}{</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">S_{1}</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">}<span class="math"> in the case that </span>\\Delta_{1}<0$.</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">By noting that</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">$N\\geq 2^{n}-q,\\quad</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">S_{1}</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\geq 2^{n}-q,\\quad</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">S_{2}</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\leq q,\\quad</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">S_{3}</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\geq 0,\\text{ and }</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">S_{4}</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\geq 0$</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">we can bound $</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\Delta_{1}</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"><span class="math"> and </span></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\Delta_{1}</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\cdot\\frac{(2^{n}-</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">S_{4}</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">)}{</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">S_{1}</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">}$:</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">$</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\Delta_{1}</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\leq\\frac{q^{2}}{2^{n}(2^{n}-q)}\\quad\\text{ and }\\quad</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\Delta_{1}</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\cdot\\frac{(2^{n}-</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">S_{4}</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">)}{</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">S_{1}</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">}\\leq\\frac{q^{2}}{(2^{n}-q)^{2}}$</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">More details are given in Appendix B. This bound is tight, in the sense that it is possible for an adversary to ask a series of <span class="math">q</span> queries and for $</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\Delta_{1}</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\cdot\\frac{(2^{n}-</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">S_{4}</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">)}{</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">S_{1}</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">}<span class="math"> to be as large as described by this bound. For this to occur we require that </span></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">S_{4}</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">=</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">S_{3}</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">=0<span class="math">, </span></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">S_{2}</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">=q<span class="math">, and </span>N=2^{n}-q$.</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">We also need to compare this to <span class="math">\\beta_{1}+\\Pr[Q]</span> as calculated by Landecker et al., who show that <span class="math">\\beta_{1}+\\Pr[Q]\\leq\\frac{2q^{3}\\hat{\\epsilon}^{2}}{1-q^{3}\\hat{\\epsilon}^{2}}</span>.</p>

    <p class="text-gray-300">Now, note that <span class="math">\\frac{1}{2^{n}-q}\\leq\\frac{1}{2^{n}-2q}\\leq\\hat{\\epsilon}</span> and that <span class="math">1-q^{3}\\hat{\\epsilon}^{2}\\leq 1</span>. So</p>

    <p class="text-gray-300"><span class="math">\\frac{q^{2}}{(2^{n}-q)^{2}}\\leq q^{2}\\hat{\\epsilon}^{2}\\leq\\frac{q^{3}\\hat{\\epsilon}^{2}}{1-q^{3}\\hat{\\epsilon}^{2}}</span></p>

    <p class="text-gray-300">and we can see that</p>

    <p class="text-gray-300"><span class="math">\\Pr\\left[\\mathcal{A}^{G8^{\\prime}}:\\mathsf{bad}_{4}\\right]\\leq\\frac{q^{2}}{(2^{n}-q)^{2}}\\leq q^{3}\\hat{\\epsilon}^{2}\\leq\\frac{q^{3}\\hat{\\epsilon}^{2}}{1-q^{3}\\hat{\\epsilon}^{2}}.</span></p>

    <h3 id="sec-20" class="text-xl font-semibold mt-8">5.2 Game Hopping Probabilities</h3>

    <p class="text-gray-300">Recalling Landecker et al.’s observation <em>[16, 17]</em> that</p>

    <p class="text-gray-300"><span class="math">2\\Pr\\left[\\mathcal{A}^{G8^{\\prime}}:\\mathsf{bad}_{3}\\right]+\\Pr\\left[\\mathcal{A}^{G8^{\\prime}}:\\mathsf{bad}_{1}\\vee\\mathsf{bad}_{2}\\right]\\leq\\frac{6q^{3}\\hat{\\epsilon}^{2}}{1-q^{3}\\hat{\\epsilon}^{2}},</span></p>

    <p class="text-gray-300">we are able to compute the adversary’s advantage, using the Fundamental Lemma of Game Playing *[5]</p>

    <p class="text-gray-300"><span class="math">\\Pr\\left[\\mathcal{A}^{G1}\\rightarrow 1\\right]</span> <span class="math">\\leq</span> <span class="math">\\Pr\\left[\\mathcal{A}^{G4}\\rightarrow 1\\right]+\\Pr\\left[\\mathcal{A}^{G4}:\\mathsf{bad}_{1}\\vee\\mathsf{bad}_{2}\\right]</span> <span class="math">\\leq</span> <span class="math">\\Pr\\left[\\mathcal{A}^{G5^{\\prime}}\\rightarrow 1\\right]+\\Pr\\left[\\mathcal{A}^{G5^{\\prime}}:\\mathsf{bad}_{1}\\vee\\mathsf{bad}_{2}\\right]</span> <span class="math">\\leq</span> <span class="math">\\Pr\\left[\\mathcal{A}^{G6^{\\prime}}\\rightarrow 1\\wedge\\neg(\\mathsf{bad}_{3}\\vee\\mathsf{bad}_{4})\\right]+\\Pr\\left[\\mathcal{A}^{G6^{\\prime}}\\rightarrow 1\\wedge(\\mathsf{bad}_{3}\\vee\\mathsf{bad}_{4})\\right]</span> <span class="math">+\\Pr\\left[\\mathcal{A}^{G6^{\\prime}}:(\\mathsf{bad}_{1}\\vee\\mathsf{bad}_{2})\\wedge(\\mathsf{bad}_{3}\\vee\\mathsf{bad}_{4})\\right]</span> <span class="math">+\\Pr\\left[\\mathcal{A}^{G6^{\\prime}}:(\\mathsf{bad}_{1}\\vee\\mathsf{bad}_{2})\\wedge\\neg(\\mathsf{bad}_{3}\\vee\\mathsf{bad}_{4})\\right]</span> <span class="math">\\leq</span> <span class="math">\\Pr\\left[\\mathcal{A}^{G6^{\\prime}}\\rightarrow 1\\right]+2\\Pr\\left[\\mathcal{A}^{G6^{\\prime}}:\\mathsf{bad}_{3}\\vee\\mathsf{bad}_{4}\\right]+\\Pr\\left[\\mathcal{A}^{G6^{\\prime}}:\\mathsf{bad}_{1}\\vee\\mathsf{bad}_{2}\\right]</span> <span class="math">\\leq</span> <span class="math">\\Pr\\left[\\mathcal{A}^{(\\widetilde{\\pi},\\widetilde{\\pi}^{-1})}\\rightarrow 1\\right]+2\\Pr\\left[\\mathcal{A}^{G8^{\\prime}}:\\mathsf{bad}_{3}\\right]+2\\Pr\\left[\\mathcal{A}^{G8^{\\prime}}:\\mathsf{bad}_{4}\\right]</span> <span class="math">+\\Pr\\left[\\mathcal{A}^{G8^{\\prime}}:\\mathsf{bad}_{1}\\vee\\mathsf{bad}_{2}\\right]</span> <span class="math">\\leq</span> <span class="math">\\Pr\\left[\\mathcal{A}^{(\\widetilde{\\pi},\\widetilde{\\pi}^{-1})}\\rightarrow 1\\right]+\\frac{6q^{3}\\ell^{2}}{1-q^{3}\\ell^{2}}+2\\frac{q^{2}}{(2^{n}-q)^{2}}</span> <span class="math">\\leq</span> <span class="math">\\Pr\\left[\\mathcal{A}^{(\\widetilde{\\pi},\\widetilde{\\pi}^{-1})}\\rightarrow 1\\right]+\\frac{8q^{3}\\ell^{2}}{1-q^{3}\\ell^{2}}</span></p>

    <p class="text-gray-300">So, there is an adversary <span class="math">\\mathcal{B}</span> against the SPRP security of <span class="math">E</span>, such that:</p>

    <p class="text-gray-300"><span class="math">\\mathrm{Adv}^{\\mathrm{sprp}}_{E}(\\mathcal{A})\\leq\\mathrm{Adv}^{\\mathrm{sprp}}_{E}(\\mathcal{B})+\\frac{8q^{3}\\ell^{2}}{1-q^{3}\\ell^{2}}.</span></p>

    <p class="text-gray-300">This is in contrast to the orginal result, which concludes that there is an adversary <span class="math">\\mathcal{B}</span> against the SPRP security of <span class="math">E</span>, such that:</p>

    <p class="text-gray-300"><span class="math">\\mathrm{Adv}^{\\mathrm{sprp}}_{E}(\\mathcal{A})\\leq\\mathrm{Adv}^{\\mathrm{sprp}}_{E}(\\mathcal{B})+\\frac{6q^{3}\\ell^{2}}{1-q^{3}\\ell^{2}}.</span></p>

    <h2 id="sec-21" class="text-2xl font-bold">6 A Limitation of this Proof Technique</h2>

    <p class="text-gray-300">A natural extension of the work of Landecker et al. <em>[16]</em> is to consider longer chains of the LRW2 construction, as Lampe and Seurin have done at FSE 2013 <em>[15]</em>. The naïve approach to proving results in this case, which we emphasise is not the approach taken by Lampe and Seurin, would be to mimic Landecker et al.’s proof but to increase the number of sets <span class="math">S_{i}</span> to describe where the last non-colliding input to a permutation occurs. This technique does not seem to succeed in the presence of the errors described in this note. A second remark about this approach is that it fundamentally depends on the ability to sample from a set <span class="math">\\overline{\\mathsf{Rng}_{\\mathrm{lazy}}(\\pi_{i})}\\cap(\\overline{\\mathsf{Dom}_{\\mathrm{lazy}}(\\pi_{i+1})}\\oplus h_{i}(T_{i})\\oplus h_{i+1}(T_{i}))</span>. If this set is ever empty, it will be possible for an adversary to make a query that cannot be answered using the method described and a different proof method will be required. If this set is ever empty, it will be possible for an adversary to make a query that cannot be answered using the method described and a different proof method will be required.</p>

    <p class="text-gray-300">We bound the number of queries that may be asked before the sampling method described above fails by <span class="math">q&lt;2^{n-1}</span>. We emphasise that this does not constitute an error in Landecker et al.’s proof and does not appear to be an issue in Lampe and Seurin’s work <em>[15]</em>, it simply prevents Landecker et al.’s technique being naïvely extended asymptotically.</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">This bound is obtained as follows: Note that for every <span class="math">j</span>, $</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\mathsf{Dom}_{\\mathrm{lazy}}(\\pi_{j})</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">=</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\mathsf{Rng}_{\\mathrm{lazy}}(\\pi_{j})</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"><span class="math"> after every query and, for every tweak, </span>h_{j}(T_{i})\\oplus h_{j+1}(T_{i})<span class="math"> defines a perfect matching </span>\\{0,1\\}^{n}\\rightarrow\\{0,1\\}^{n}$</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">(representing <span class="math">\\mathsf{Rng}_{\\mathrm{full}}(\\pi_j)</span> and <span class="math">\\mathsf{Dom}_{\\mathrm{full}}(\\pi_{j+1})</span>). Suppose that we remove (up to) two edges from every matching when answering each query: one edges that matches the output of <span class="math">\\pi_j</span> and one edge matching the input to <span class="math">\\pi_{j+1}</span>. Then it is possible to respond to any later query, as long as every matching has at least one edge remaining. If there is a matching with no remaining edges, then there is a tweak for which <span class="math">\\overline{\\mathsf{Rng}_{\\mathrm{lazy}}(\\pi_j)}\\cap(\\overline{\\mathsf{Dom}_{\\mathrm{lazy}}(\\pi_{j+1})}\\oplus h_j(T_i)\\oplus h_{j+1}(T_i))</span> is empty and an input value <span class="math">X_i</span> such that <span class="math">X_i\\oplus h_1(T_i)\\notin\\mathsf{Dom}_{\\mathrm{lazy}}(\\pi_1)</span>. If there is a matching with no remaining edges, then there is a tweak for which <span class="math">\\overline{\\mathsf{Rng}_{\\mathrm{lazy}}(\\pi_j)}\\cap(\\overline{\\mathsf{Dom}_{\\mathrm{lazy}}(\\pi_{j+1})}\\oplus h_j(T_i)\\oplus h_{j+1}(T_i))</span> is empty and an input value <span class="math">X_i</span> such that <span class="math">X_i\\oplus h_1(T_i)\\notin\\mathsf{Dom}_{\\mathrm{lazy}}(\\pi_1)</span>.</p>

    <p class="text-gray-300">We can guarantee that <span class="math">\\overline{\\mathsf{Rng}_{\\mathrm{lazy}}(\\pi_j)}\\cap(\\overline{\\mathsf{Dom}_{\\mathrm{lazy}}(\\pi_{j+1})}\\oplus h_j(T_i)\\oplus h_{j+1}(T_i))</span> is not empty for every <span class="math">i</span> and <span class="math">j</span>, provided that <span class="math">q &amp;lt; 2^{n-1}</span>. While it may remain possible to sample from this set beyond this bound, it is not guaranteed and depends on both the adversary's queries and the random choices in the lazy sampling of the functions.</p>

    <p class="text-gray-300">This does not cause a problem until <span class="math">n - 1</span> block ciphers are chained together because up to that point security is only provided for <span class="math">q &amp;lt; 2^{n - 1}</span>. However if <span class="math">n - 1</span> block ciphers are chained together using the CLRW2 construction, then this issue can occur and it may not be possible to respond to queries using this method.</p>

    <h2 id="sec-22" class="text-2xl font-bold">7 Discussion and Conclusions</h2>

    <p class="text-gray-300">We have shown that a minor error exists in the proof given for the tweakable block cipher CLRW2 [16,17]. Fortunately it is possible for this error to be corrected and the scheme still provides a similar level of security.</p>

    <p class="text-gray-300">We also identify a potential limitation to extending this result asymptotically, by bounding the number of queries that can be made before it may be impossible to use Landecker et al.'s sampling method. We emphasise that this does not constitute an error in Landecker et al.'s proof and does not appear to be an issue in Lampe and Seurin's work; it simply prevents Landecker et al.'s technique being naively extended asymptotically.</p>

    <p class="text-gray-300">Recently, flaws have been found in the proofs for two high-profile ciphers: GCM [11] and XCB [6]. In order for the community to have faith in the proofs given for schemes, it is important that security proofs are correct and any errors are removed. The factor lost by correcting the bound in this case is significantly smaller than for these errors, however it remains important that any errors in a security reduction are removed.</p>

    <h2 id="sec-23" class="text-2xl font-bold">References</h2>

    <ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">

      <li>M. Bellare, A. Desai, E. Jokipii, and P. Rogaway. A concrete security treatment of symmetric encryption. In <em>Foundations of Computer Science, 1997. Proceedings., 38th Annual Symposium on</em>, pages 394-403, Oct 1997.</li>

      <li>Mihir Bellare, Joe Kilian, and Phillip Rogaway. The security of cipher block chaining. In Yvo G. Desmedt, editor, <em>Advances in Cryptology CRYPTO 94</em>, volume 839 of <em>Lecture Notes in Computer Science</em>, pages 341-358. Springer Berlin Heidelberg, 1994.</li>

      <li>Mihir Bellare, Ted Krovetz, and Phillip Rogaway. Luby-Rackoff backwards: Increasing security by making block ciphers non-invertible. In Kaisa Nyberg, editor, <em>Advances in Cryptology EUROCRYPT'98</em>, volume 1403 of <em>Lecture Notes in Computer Science</em>, pages 266-280. Springer Berlin Heidelberg, 1998.</li>

      <li>Mihir Bellare, Krzysztof Pietrzak, and Phillip Rogaway. Improved Security Analyses for CBC MACs. In Victor Shoup, editor, <em>Advances in Cryptology CRYPTO 2005</em>, volume 3621 of <em>Lecture Notes in Computer Science</em>, pages 527-545. Springer Berlin Heidelberg, 2005.</li>

      <li>Mihir Bellare and Phillip Rogaway. The Security of Triple Encryption and a Framework for Code-Based Game-Playing Proofs. In Serge Vaudenay, editor, <em>Advances in Cryptology - EUROCRYPT 2006</em>, volume 4004 of <em>Lecture Notes in Computer Science</em>, pages 409-426. Springer Berlin Heidelberg, 2006.</li>

      <li>Debrup Chakraborty, Vicente Hernandez-Jimenez, and Palash Sarkar. Another Look at XCB. Cryptology ePrint Archive, Report 2013/823, 2013.</li>

    </ol>

    <ul class="list-disc list-inside space-y-1 text-gray-300 my-2 ml-4">

      <li>[7] Paul Crowley. Mercy: A Fast Large Block Cipher for Disk Sector Encryption. In Gerhard Goos, Juris Hartmanis, Jan Leeuwen, and Bruce Schneier, editors, Fast Software Encryption, volume 1978 of Lecture Notes in Computer Science, pages 49–63. Springer Berlin Heidelberg, 2001.</li>

      <li>[8] Niels Ferguson, Stefan Lucks, Bruce Schneier, Doug Whiting, Mihir Bellare, Tadayoshi Kohno, Jon Callas, and Jesse Walker. The Skein Hash Function Family. http://www.skein-hash.info/sites/default/files/skein1.3.pdf, 2010.</li>

      <li>[9] David Goldenberg, Susan Hohenberger, Moses Liskov, Elizabeth Crump Schwartz, and Hakan Seyalioglu. On Tweaking Luby-Rackoff Blockciphers. In Kaoru Kurosawa, editor, Advances in Cryptology – ASIACRYPT 2007, volume 4833 of Lecture Notes in Computer Science, pages 342–356. Springer Berlin Heidelberg, 2007.</li>

      <li>[10] Tetsu Iwata. New Blockcipher Modes of Operation with Beyond the Birthday Bound Security. In Matthew Robshaw, editor, Fast Software Encryption, volume 4047 of Lecture Notes in Computer Science, pages 310–327. Springer Berlin Heidelberg, 2006.</li>

      <li>[11] Tetsu Iwata, Keisuke Ohashi, and Kazuhiko Minematsu. Breaking and Repairing GCM Security Proofs. In Reihaneh Safavi-Naini and Ran Canetti, editors, Advances in Cryptology CRYPTO 2012, volume 7417 of Lecture Notes in Computer Science, pages 31–49. Springer Berlin Heidelberg, 2012.</li>

      <li>[12] A. Joux. On the security of blockwise secure modes of operation beyond the birthday bound. Information Theory, IEEE Transactions on, 56(3):1239–1246, March 2010.</li>

      <li>[13] Hugo Krawczyk. LFSR-based Hashing and Authentication. In Yvo G. Desmedt, editor, Advances in Cryptology CRYPTO 4, volume 839 of Lecture Notes in Computer Science, pages 129–139. Springer Berlin Heidelberg, 1994.</li>

      <li>[14] Ted Krovetz and Phillip Rogaway. The Software Performance of Authenticated-Encryption Modes. In Antoine Joux, editor, Fast Software Encryption, volume 6733 of Lecture Notes in Computer Science, pages 306–327. Springer Berlin Heidelberg, 2011.</li>

      <li>[15] Rodolphe Lampe and Yannick Seurin. Tweakable Blockciphers with Asymptotically Optimal Security. Fast Software Encryption 2013 (to appear).</li>

      <li>[16] Will Landecker, Thomas Shrimpton, and R. Seth Terashima. Tweakable Blockciphers with Beyond Birthday-Bound Security. In Reihaneh Safavi-Naini and Ran Canetti, editors, Advances in Cryptology, CRYPTO 2012, volume 7417 of Lecture Notes in Computer Science, pages 14–30. Springer Berlin Heidelberg, 2012.</li>

      <li>[17] Will Landecker, Thomas Shrimpton, and R. Seth Terashima. Tweakable Blockciphers with Beyond Birthday-Bound Security. Cryptology ePrint Archive, Report 2012/450, 2012. Version 20120808:065419.</li>

      <li>[18] Moses Liskov, Ronald L. Rivest, and David Wagner. Tweakable Block Ciphers. In Moti Yung, editor, Advances in Cryptology, CRYPTO 2002, volume 2442 of Lecture Notes in Computer Science, pages 31–46. Springer Berlin Heidelberg, 2002.</li>

      <li>[19] Moses Liskov, Ronald L. Rivest, and David Wagner. Tweakable Block Ciphers. Journal of Cryptology, 24(3):588–613, 2011.</li>

      <li>[20] David McGrew. Impossible plaintext cryptanalysis and probable-plaintext collision attacks of 64-bit block cipher modes. Cryptology ePrint Archive, Report 2013/623, 2013.</li>

      <li>[21] Kazuhiko Minematsu. Beyond-Birthday-Bound Security Based on Tweakable Block Cipher. In Orr Dunkelman, editor, Fast Software Encryption, volume 5665 of Lecture Notes in Computer Science, pages 308–326. Springer Berlin Heidelberg, 2009.</li>

      <li>[22] Phillip Rogaway. Efficient Instantiations of Tweakable Blockciphers and Refinements to Modes OCB and PMAC. In Pil Joong Lee, editor, Advances in Cryptology - ASIACRYPT 2004, volume 3329 of Lecture Notes in Computer Science, pages 16–31. Springer Berlin Heidelberg, 2004.</li>

      <li>[23] Rich Schroeppel. Hasty Pudding Cipher Specification. http://web.archive.org/web/20070206162154/http://www.cs.arizona.edu/people/rcs/hpc/hpc-spec, 1999.</li>

      <li>[24] Thomas Shrimpton and R. Seth Terashima. personal communication, Jan 2014.</li>

    </ul>

    <p class="text-gray-300">Appendix A More Details on the Fix for the Proof</p>

    <p class="text-gray-300">Game 5', 6'</p>

    <p class="text-gray-300">1: procedure  <span class="math">\\widetilde{E}(T, X)</span></p>

    <p class="text-gray-300">2:  <span class="math">i\\gets i + 1;X_i\\gets X;T_i\\gets T</span></p>

    <p class="text-gray-300">3:  <span class="math">L_{i}\\gets X_{i}\\oplus h_{1}(T_{i})</span></p>

    <p class="text-gray-300">4: if  <span class="math">L_{i}\\in \\mathrm{Dom}(\\pi_{1})</span>  then</p>

    <p class="text-gray-300">5:  <span class="math">M_{i}\\gets \\pi_{1}(L_{i})\\oplus h_{1}(T_{i})\\oplus h_{2}(T_{i})</span></p>

    <p class="text-gray-300">6:  <span class="math">Y_{i}\\stackrel {\\S}{\\leftarrow}\\mathcal{Y}_{i}</span></p>

    <p class="text-gray-300">7: if  <span class="math">M_{i} \\in \\mathrm{Dom}(\\pi_{2})</span>  then</p>

    <p class="text-gray-300">8: bad1  <span class="math">\\leftarrow</span>  true</p>

    <p class="text-gray-300">9: else if  <span class="math">Y_{i} \\oplus h_{2}(T_{i}) \\in \\mathsf{Rng}(\\pi_{2})</span>  then</p>

    <p class="text-gray-300">10: bad2  <span class="math">\\leftarrow</span>  true</p>

    <p class="text-gray-300">11:  <span class="math">\\pi_2(M_i)\\gets Y_i\\oplus h_2(T_i)</span></p>

    <p class="text-gray-300">12: else</p>

    <p class="text-gray-300">13:  <span class="math">Y_{i}\\stackrel {\\S}{\\leftarrow}\\mathcal{Y}_{i}</span></p>

    <p class="text-gray-300">14: if  <span class="math">\\varDelta_{1}\\geq 0</span>  then</p>

    <p class="text-gray-300">15: if  <span class="math">Y_{i}\\in S_{1}</span>  then</p>

    <p class="text-gray-300">16:  <span class="math">V_{i}\\gets 0</span></p>

    <p class="text-gray-300">17: else if  <span class="math">Y_{i} \\in S_{2}</span>  then</p>

    <p class="text-gray-300">18:  <span class="math">V_{i}\\gets 1</span></p>

    <p class="text-gray-300">19: else if  <span class="math">Y_{i}\\in S_{3}</span>  then</p>

    <p class="text-gray-300">20: bad3  <span class="math">\\leftarrow</span>  true</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">21:  $V_{i}\\stackrel {\\S}{\\leftarrow}\\xi (\\frac{</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\Delta_{2}</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">}{</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\Delta_{1}</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">+</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\Delta_{2}</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">})$</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">22:  <span class="math">Z_{i}\\gets \\pi_{2}^{-1}(Y_{i}\\oplus h_{2}(T_{i}))\\oplus h_{1}(T_{i})\\oplus h_{2}(T_{i})</span></p>

    <p class="text-gray-300">23: if  <span class="math">V_{i} = 1</span>  then</p>

    <p class="text-gray-300">24:  <span class="math">Y_{i}\\stackrel {\\S}{\\leftarrow}S_{2}</span></p>

    <p class="text-gray-300">25: else if  <span class="math">V_{i} = 0</span>  then</p>

    <p class="text-gray-300">26:  <span class="math">Y_{i}\\stackrel {\\S}{\\leftarrow}S_{1}</span></p>

    <p class="text-gray-300">27: else if  <span class="math">\\varDelta_{1}&amp;lt; 0</span>  then</p>

    <p class="text-gray-300">28: if  <span class="math">Y_{i}\\in S_{3}</span>  then</p>

    <p class="text-gray-300">29: bad3  <span class="math">\\leftarrow</span>  true</p>

    <p class="text-gray-300">30:  <span class="math">Y_{i}\\stackrel {\\S}{\\leftarrow}S_{2}</span></p>

    <p class="text-gray-300">31: if  <span class="math">Y_{i}\\in S_{1}</span>  then</p>

    <p class="text-gray-300">32:  <span class="math">V_{i}\\gets 0</span></p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">33:  $U_{i}\\stackrel {\\S}{\\leftarrow}\\xi (\\frac{</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\Delta_{1}</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">(2^{n} -</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">S_{4}</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">)}{</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">S_{1}</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">})$</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">34: if  <span class="math">U_{i} = 1</span>  then</p>

    <p class="text-gray-300">35: bad4  <span class="math">\\leftarrow</span>  true</p>

    <p class="text-gray-300">36:  <span class="math">Y_{i}\\stackrel {\\S}{\\leftarrow}S_{2}</span></p>

    <p class="text-gray-300">37: if  <span class="math">Y_{i}\\in S_{2}</span>  then</p>

    <p class="text-gray-300">38:  <span class="math">V_{i}\\gets 1</span></p>

    <p class="text-gray-300">39: if  <span class="math">Y_{i}\\in S_{2}</span>  then</p>

    <p class="text-gray-300">40:  <span class="math">Z_{i}\\gets \\pi_{2}^{-1}(Y_{i}\\oplus h_{2}(T_{i}))\\oplus h_{2}(T_{i})\\oplus h_{1}(T_{i})</span></p>

    <p class="text-gray-300">41: else if  <span class="math">Y_{i}\\in S_{1}</span>  then</p>

    <p class="text-gray-300">42:  <span class="math">Z_{i}\\stackrel {\\S}{\\leftarrow}\\overline{\\mathsf{Rng}(\\pi_{1})}\\setminus (\\mathsf{Dom}(\\pi_{2})\\oplus h_{2}(T_{i})\\oplus h_{1}(T_{i})</span></p>

    <p class="text-gray-300">43:  <span class="math">\\pi_2(Z_i\\oplus h_1(T_i)\\oplus h_2(T_i))\\gets Y_i\\oplus h_2(T_i)</span></p>

    <p class="text-gray-300">44:  <span class="math">\\pi_1(L_i)\\gets Z_i</span></p>

    <p class="text-gray-300">45:  <span class="math">M_{i}\\gets \\pi_{1}(L_{i})\\oplus h_{1}(T_{i})\\oplus h_{2}(T_{i})</span></p>

    <p class="text-gray-300">return  <span class="math">Y_{i}</span></p>

    <p class="text-gray-300">Fig. 4. Between Game 4 and Game  <span class="math">5&#x27;</span> , the order in which  <span class="math">V_{i}</span>  and  <span class="math">Y_{i}</span>  are sampled is reversed. Game  <span class="math">5&#x27;</span>  is identical to Game 5 and Game  <span class="math">6&#x27;</span>  is identical to Game 6, except for the addition of lines 27 to 38. Game  <span class="math">6&#x27;</span>  is identical to Game  <span class="math">5&#x27;</span>  until one of  <span class="math">\\mathsf{bad}_3</span>  or  <span class="math">\\mathsf{bad}_4</span>  is set to true.</p>

    <p class="text-gray-300">Game  <span class="math">7^{\\prime}</span> 1: procedure  <span class="math">\\widetilde{E} (T,X)</span> 2:  <span class="math">i\\gets i + 1;X_i\\gets X;T_i\\gets T</span> 3:  <span class="math">Y_{i}\\stackrel {\\</span>}{\\leftarrow}\\mathcal{Y}_{i}<span class="math"> 4:  </span>L_{i}\\gets X_{i}\\oplus h_{1}(T_{i})<span class="math"> 5: if  </span>L_{i}\\in \\mathrm{Dom}(\\pi_{1})<span class="math">  then 6:  </span>M_{i}\\gets \\pi_{1}(L_{i})\\oplus h_{1}(T_{i})\\oplus h_{2}(T_{i})<span class="math"> 7: if  </span>M_{i}\\in \\mathrm{Dom}(\\pi_{2})<span class="math">  then 8: bad1  </span>\\leftarrow<span class="math">  true 9: else if  </span>Y_{i}\\oplus h_{2}(T_{i})\\in \\mathsf{Rng}(\\pi_{2})<span class="math">  then 10: bad2  </span>\\leftarrow<span class="math">  true 11:  </span>\\pi_2(M_i)\\gets Y_i\\oplus h_2(T_i)<span class="math"> 12: else 13: if  </span>Y_{i}\\in S_{1}<span class="math">  then 14:  </span>V_{i}\\gets 0<span class="math"> 15: if  </span>\\Delta_1 &lt;   0$  then</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">16:  <span class="math">U_{i}\\stackrel {\\</span>}{\\leftarrow}\\xi (\\frac{</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\Delta_{1}</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">(2^{n} -</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">S_{4}</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">)}{</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">S_{1}</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">})$</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">17: if  <span class="math">U_{i} = 1</span>  then 18: bad3  <span class="math">\\leftarrow</span>  true 19: else if  <span class="math">Y_{i}\\in S_{2}</span>  then 20:  <span class="math">V_{i}\\gets 1</span> 21: else if  <span class="math">Y_{i}\\in S_{3}</span>  then 22: bad3  <span class="math">\\leftarrow</span>  true 23:  <span class="math">Z_{i}\\gets \\pi_{2}^{-1}(Y_{i}\\oplus h_{2}(T_{i}))\\oplus h_{1}(T_{i})\\oplus h_{2}(T_{i})</span> 24: if  <span class="math">V_{i} = 1</span>  then 25:  <span class="math">Z_{i}\\gets \\pi_{2}^{-1}(Y_{i}\\oplus h_{2}(T_{i}))\\oplus h_{2}(T_{i})\\oplus h_{1}(T_{i})</span> 26: else if  <span class="math">V_{i} = 0</span>  then 27:  <span class="math">Z_{i}\\stackrel {\\</span>}{\\leftarrow}\\overline{\\mathsf{Rng}(\\pi_{1})}\\setminus (\\mathsf{Dom}(\\pi_{2})\\oplus h_{2}(T_{i})\\oplus h_{1}(T_{i}))<span class="math"> 28:  </span>\\pi_2(Z_i\\oplus h_1(T_i)\\oplus h_2(T_i))\\gets Y_i\\oplus h_2(T_i)<span class="math"> 29:  </span>\\pi_1(L_i)\\gets Z_i<span class="math"> 30:  </span>M_{i}\\gets \\pi_{1}(L_{i})\\oplus h_{1}(T_{i})\\oplus h_{2}(T_{i})<span class="math"> return  </span>Y_{i}$</p>

    <p class="text-gray-300">Fig. 5. The distributions of random variables in Games  <span class="math">6^{\\prime}</span>  and  <span class="math">7^{\\prime}</span>  are identical, with Game  <span class="math">7^{\\prime}</span>  simplifying some of the program flow. Game  <span class="math">7^{\\prime}</span>  is identical to Game 7, except for the addition of lines 15 to 18.</p>

    <p class="text-gray-300">Game  <span class="math">8^{\\prime}</span></p>

    <p class="text-gray-300">1: procedure  <span class="math">\\widetilde{E} (T,X,Y)</span> 2:  <span class="math">i\\gets i + 1;X_{i}\\gets X;T_{i}\\gets T</span> 3:  <span class="math">Y_{i}\\gets Y</span> 4:  <span class="math">L_{i}\\gets X_{i}\\oplus h_{1}(T_{i})</span> 5: if  <span class="math">L_{i}\\in \\mathrm{Dom}(\\pi_{1})</span>  then 6:  <span class="math">M_{i}\\gets \\pi_{1}(L_{i})\\oplus h_{1}(T_{i})\\oplus h_{2}(T_{i})</span> 7: if  <span class="math">M_{i}\\in \\mathrm{Dom}(\\pi_{2})</span>  then 8: bad1  <span class="math">\\leftarrow</span>  true 9: else if  <span class="math">Y_{i}\\oplus h_{2}(T_{i})\\in \\mathsf{Rng}(\\pi_{2})</span>  then 10: bad2  <span class="math">\\leftarrow</span>  true 11:  <span class="math">\\pi_2(M_i)\\gets Y_i\\oplus h_2(T_i)</span> 12: else 13: if  <span class="math">Y_{i}\\in S_{1}</span>  then 14: if  <span class="math">\\Delta_1 &amp;lt; 0</span>  then</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">15:  $U_{i}\\stackrel {\\S}{\\leftarrow}\\xi (\\frac{</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\Delta_{1}</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">(2^{n} -</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">S_{4}</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">)}{</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">S_{1}</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">})$</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">16: if  <span class="math">U_{i} = 1</span>  then 17: bad4  <span class="math">\\leftarrow</span>  true 18:  <span class="math">Z_{i}\\stackrel {\\S}{\\leftarrow}\\overline{\\mathsf{Rng}(\\pi_{1})}\\setminus (\\mathsf{Dom}(\\pi_{2})\\oplus h_{2}(T_{i})\\oplus h_{1}(T_{i})</span> 19:  <span class="math">\\pi_2(Z_i\\oplus h_1(T_i)\\oplus h_2(T_i))\\gets Y_i\\oplus h_2(T_i)</span> 20: else if  <span class="math">Y_{i}\\in S_{2}</span>  then 21:  <span class="math">Z_{i}\\gets \\pi_{2}^{-1}(Y_{i}\\oplus h_{2}(T_{i}))\\oplus h_{1}(T_{i})\\oplus h_{2}(T_{i})</span> 22: else if  <span class="math">Y_{i}\\in S_{3}</span>  then 23: bad3  <span class="math">\\leftarrow</span>  true 24:  <span class="math">Z_{i}\\gets \\pi_{2}^{-1}(Y_{i}\\oplus h_{2}(T_{i}))\\oplus h_{1}(T_{i})\\oplus h_{2}(T_{i})</span> 25:  <span class="math">\\pi_1(L_i)\\gets Z_i</span> 26:  <span class="math">M_{i}\\gets \\pi_{1}(L_{i})\\oplus h_{1}(T_{i})\\oplus h_{2}(T_{i})</span> return  <span class="math">Y_{i}</span></p>

    <p class="text-gray-300">Fig. 6. Game  <span class="math">8&#x27;</span>  gives the adversary control over  <span class="math">Y_{i}</span>  values, so the 'bad flags' can be set at least as easily as they can in Game  <span class="math">7&#x27;</span> . Game  <span class="math">8&#x27;</span>  is identical to Game 8, except for the addition of lines 14 to 17.</p>

    <p class="text-gray-300">!<a href="img-2.jpeg">img-2.jpeg</a> Fig. 7. Game 4, when  <span class="math">\\Delta_1 \\geq 0</span> . The output of CLRW2 is denoted by solid, black lines. The dashed line indicates the behaviour of an ideal tweakable block cipher. The shaded areas correspond to the  <span class="math">\\Delta_i</span> s We do not need to redefine Game 4 when  <span class="math">\\Delta_1 \\geq 0</span> .</p>

    <p class="text-gray-300">!<a href="img-3.jpeg">img-3.jpeg</a> Fig. 8. Game 5, when  <span class="math">\\Delta_1 \\geq 0</span> . The solid, grey line denotes the distribution from which the output is initially sampled; this is the output distribution according to an ideal tweakable block cipher. The output is resampled according to the bold arrows. The solid, black lines represent the final distribution, which is identical to that of Game 4. Game 5 is identical to Game  <span class="math">5&#x27;</span>  when  <span class="math">\\Delta_1 \\geq 0</span> .</p>

    <p class="text-gray-300">!<a href="img-4.jpeg">img-4.jpeg</a> Fig. 9. Game 6, when  <span class="math">\\Delta_1 \\geq 0</span> . The solid, black line denotes the distribution of CLRW2 in Game 6, which coincides with the distribution of outputs from an ideal tweakable block cipher.  <span class="math">\\mathsf{bad}_3</span>  is set to true if the output is sampled from the labelled region. The dashed line indicates the behaviour of an CLRW2 in previous games; Game 6 is identical to Game 5 unless  <span class="math">\\mathsf{bad}_3</span>  is set to true. Game 6 is identical to Game  <span class="math">6&#x27;</span>  when  <span class="math">\\Delta_1 \\geq 0</span> .</p>

    <p class="text-gray-300">!<a href="img-5.jpeg">img-5.jpeg</a> Fig. 10. Game 4, when  <span class="math">\\Delta_1 &amp;lt; 0</span> . The output of CLRW2 is denoted by solid, black lines. The dashed line indicates the behaviour of an ideal tweakable block cipher. We do not need to redefine Game 4 when  <span class="math">\\Delta_1 &amp;lt; 0</span> .</p>

    <p class="text-gray-300">!<a href="img-6.jpeg">img-6.jpeg</a> Fig. 11. Game  <span class="math">5&#x27;</span> , when  <span class="math">\\Delta_1 &amp;lt; 0</span> . The solid, grey line denotes the distribution from which the output is initially sampled; this is the output distribution according to an ideal tweakable block cipher. The output is resampled according to the bold arrows. The solid, black lines represent the final distribution, which is identical to that of Game 4. The dashed lines labelled by  <span class="math">\\star</span>  indicate the incorrect probabilities realised in Game 5 from Landecker et al.'s paper if  <span class="math">\\Delta_1 &amp;lt; 0</span> .</p>

    <p class="text-gray-300">!<a href="img-7.jpeg">img-7.jpeg</a> Fig. 12. Game  <span class="math">6&#x27;</span> , when  <span class="math">\\Delta_1 &amp;lt; 0</span> . The solid, black line denotes the distribution of CLRW2 in Game 6, which coincides with the distribution of outputs from an ideal tweakable block cipher.  <span class="math">\\mathsf{bad}_3</span>  and  <span class="math">\\mathsf{bad}_4</span>  are set to true if the output is sampled from the respectively labelled regions. The dashed line indicates the behaviour of an CLRW2 in previous games; Game  <span class="math">6&#x27;</span>  is identical to Game  <span class="math">5&#x27;</span>  unless  <span class="math">\\mathsf{bad}_3</span>  or  <span class="math">\\mathsf{bad}_4</span>  is set to true.</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">As described in Section 5.1, we can bound $</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\Delta_1</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"><span class="math"> in the case that </span>\\Delta_1 &lt; 0$ as follows:</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">$$ \\begin{aligned}</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\Delta_1</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">&amp;= \\frac{</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">S_1</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">}{2^n -</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">S_4</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">} - \\frac{N -</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">S_2</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">}{N} \\\\</th>

          </tr>

        </thead>

        <tbody>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">&amp;= \\frac{</td>

            <td class="px-3 py-2 border-b border-gray-700">S_1</td>

            <td class="px-3 py-2 border-b border-gray-700">- (2^n -</td>

            <td class="px-3 py-2 border-b border-gray-700">S_4</td>

            <td class="px-3 py-2 border-b border-gray-700">)}{2^n -</td>

            <td class="px-3 py-2 border-b border-gray-700">S_4</td>

            <td class="px-3 py-2 border-b border-gray-700">} + \\frac{</td>

            <td class="px-3 py-2 border-b border-gray-700">S_2</td>

            <td class="px-3 py-2 border-b border-gray-700">}{N} \\\\</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">&amp;= \\frac{-</td>

            <td class="px-3 py-2 border-b border-gray-700">S_2</td>

            <td class="px-3 py-2 border-b border-gray-700">-</td>

            <td class="px-3 py-2 border-b border-gray-700">S_3</td>

            <td class="px-3 py-2 border-b border-gray-700">}{2^n -</td>

            <td class="px-3 py-2 border-b border-gray-700">S_4</td>

            <td class="px-3 py-2 border-b border-gray-700">} + \\frac{</td>

            <td class="px-3 py-2 border-b border-gray-700">S_2</td>

            <td class="px-3 py-2 border-b border-gray-700">}{N} \\\\</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">&amp;\\leq -\\frac{</td>

            <td class="px-3 py-2 border-b border-gray-700">S_2</td>

            <td class="px-3 py-2 border-b border-gray-700">+</td>

            <td class="px-3 py-2 border-b border-gray-700">S_3</td>

            <td class="px-3 py-2 border-b border-gray-700">}{2^n} + \\frac{</td>

            <td class="px-3 py-2 border-b border-gray-700">S_2</td>

            <td class="px-3 py-2 border-b border-gray-700">}{N} \\\\</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">&amp;=</td>

            <td class="px-3 py-2 border-b border-gray-700">S_2</td>

            <td class="px-3 py-2 border-b border-gray-700">\\left( \\frac{1}{N} - \\frac{1}{2^n} \\right) - \\frac{</td>

            <td class="px-3 py-2 border-b border-gray-700">S_3</td>

            <td class="px-3 py-2 border-b border-gray-700">}{2^n} \\\\</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">&amp;\\leq</td>

            <td class="px-3 py-2 border-b border-gray-700">S_2</td>

            <td class="px-3 py-2 border-b border-gray-700">\\left( \\frac{1}{N} - \\frac{1}{2^n} \\right) \\\\</td>

          </tr>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">&amp;\\leq q \\left( \\frac{1}{N} - \\frac{1}{2^n} \\right) \\\\ &amp;\\leq q \\left( \\frac{1}{2^n - q} - \\frac{1}{2^n} \\right) \\\\ &amp;= \\frac{q^2}{2^n(2^n - q)} \\end{aligned} $$</p>

    <p class="text-gray-300">So:</p>

    <p class="text-gray-300">$$ \\begin{aligned}</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\Delta_1</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\cdot \\frac{(2^n -</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">S_4</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">)}{</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">S_1</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">} &amp;\\leq \\frac{q^2}{2^n(2^n - q)} \\cdot \\frac{(2^n -</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">S_4</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">)}{</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">S_1</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">} \\\\</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">&amp;\\leq \\frac{q^2}{2^n(2^n - q)} \\cdot \\frac{2^n}{(2^n - q)} \\\\ &amp;= \\frac{q^2}{(2^n - q)^2} \\end{aligned} $$</p>`;
---

<BaseLayout title="A Note on the CLRW2 Tweakable Block Cipher Construction (2014/111)">
  <article class="max-w-4xl mx-auto article-prose">
    <nav class="mb-8">
      <a href="/papers" class="text-blue-400 hover:text-blue-300">
        &larr; Back to Papers
      </a>
    </nav>

    <header class="mb-12">
      <h1 class="text-3xl font-bold mb-4"
        set:html={TITLE_HTML} />
      <p class="text-gray-400 mb-2"
        set:html={AUTHORS_HTML} />
      <p class="text-gray-500 text-sm mb-4">
        2014 &middot; eprint 2014/111
      </p>
      <div class="flex gap-4 text-sm">
        <a
          href={EPRINT_URL}
          target="_blank"
          rel="noopener noreferrer"
          class="text-blue-400 hover:text-blue-300"
        >
          Paper (eprint) &rarr;
        </a>
      </div>
      <p class="mt-4 text-xs text-gray-500">
        All content below belongs to the original authors. This page
        reproduces the paper for educational purposes. Always
        <a
          href={EPRINT_URL}
          target="_blank"
          rel="noopener noreferrer"
          class="text-blue-400 hover:text-blue-300"
        >cite the original</a>.
      </p>
      <p class="mt-1 text-xs text-gray-600">
        Converted with: {CRAWLER} &middot; {CONVERTED_DATE}
      </p>
    </header>

    <Fragment set:html={CONTENT} />

  </article>
</BaseLayout>
