---
import BaseLayout from '../../layouts/BaseLayout.astro';

const EPRINT_URL = 'https://eprint.iacr.org/2020/500';
---

<BaseLayout title="Subspace Trails (2020/500)">
  <article class="max-w-4xl mx-auto article-prose">
    <nav class="mb-8">
      <a href="/papers" class="text-blue-400 hover:text-blue-300">
        &larr; Back to Papers
      </a>
    </nav>

    <!-- ============================================================ -->
    <!-- HEADER                                                       -->
    <!-- ============================================================ -->

    <header class="mb-12">
      <h1 class="text-3xl font-bold mb-4">
        Proving Resistance Against Infinitely Long Subspace Trails:
        How to Choose the Linear Layer
      </h1>
      <p class="text-gray-400 mb-2">
        Lorenzo Grassi, Christian Rechberger, Markus Schofnegger
      </p>
      <p class="text-gray-500 text-sm mb-4">
        2020 &middot; eprint 2020/500
      </p>
      <div class="flex gap-4 text-sm">
        <a
          href={EPRINT_URL}
          target="_blank"
          rel="noopener noreferrer"
          class="text-blue-400 hover:text-blue-300"
        >
          Paper (eprint) &rarr;
        </a>
      </div>
      <p class="mt-4 text-xs text-gray-500">
        All content below belongs to the original authors. This page
        reproduces the paper for educational purposes. Always
        <a
          href={EPRINT_URL}
          target="_blank"
          rel="noopener noreferrer"
          class="text-blue-400 hover:text-blue-300"
        >cite the original</a>.
      </p>
    </header>

    <!-- ============================================================ -->
    <!-- TABLE OF CONTENTS                                            -->
    <!-- ============================================================ -->

    <nav id="toc" class="mb-10 p-6 rounded-lg"
      style="background: rgba(255,255,255,0.03);
             border: 1px solid rgba(255,255,255,0.06);">
      <h2 class="text-lg font-bold mb-4">Table of Contents</h2>
      <ol class="space-y-1 text-sm text-gray-300
        list-decimal list-inside">
        <li>
          <a href="#abstract"
            class="hover:text-white">Abstract</a>
        </li>
        <li>
          <a href="#sec-1"
            class="hover:text-white">Introduction</a>
          <ol class="ml-6 mt-1 space-y-1 list-decimal
            list-inside text-gray-400">
            <li>
              <a href="#sec-1.1"
                class="hover:text-white">
                Choosing the Linear Layer in Partial SPN
                Schemes</a>
            </li>
            <li>
              <a href="#sec-1.2"
                class="hover:text-white">
                Our Contribution and Related Work</a>
            </li>
          </ol>
        </li>
        <li>
          <a href="#sec-2"
            class="hover:text-white">Preliminaries</a>
          <ol class="ml-6 mt-1 space-y-1 list-decimal
            list-inside text-gray-400">
            <li>
              <a href="#sec-2.1"
                class="hover:text-white">
                Partial SPN Schemes</a>
            </li>
            <li>
              <a href="#sec-2.2"
                class="hover:text-white">
                Invariant Subspaces and Subspace Trails</a>
            </li>
            <li>
              <a href="#sec-2.3"
                class="hover:text-white">
                Decomposition Theorem &amp; Frobenius Normal
                Form</a>
            </li>
          </ol>
        </li>
        <li>
          <a href="#sec-3"
            class="hover:text-white">
            Infinitely Long Invariant Subspace Trails
            (Without Active S-Boxes)</a>
          <ol class="ml-6 mt-1 space-y-1 list-decimal
            list-inside text-gray-400">
            <li>
              <a href="#sec-3.1"
                class="hover:text-white">
                Preliminary Results</a>
            </li>
            <li>
              <a href="#sec-3.2"
                class="hover:text-white">
                Infinitely Long Invariant Subspace Trails via
                Eigenspaces of M</a>
            </li>
            <li>
              <a href="#sec-3.3"
                class="hover:text-white">
                Necessary and Sufficient Condition</a>
            </li>
          </ol>
        </li>
        <li>
          <a href="#sec-4"
            class="hover:text-white">
            Iterative Subspace Trails Without Active
            S-Boxes</a>
          <ol class="ml-6 mt-1 space-y-1 list-decimal
            list-inside text-gray-400">
            <li>
              <a href="#sec-4.1"
                class="hover:text-white">
                Linear Layers with Low Multiplicative
                Order</a>
            </li>
            <li>
              <a href="#sec-4.2"
                class="hover:text-white">
                Linear Layers with Low-Degree Minimal
                Polynomials</a>
            </li>
          </ol>
        </li>
        <li>
          <a href="#sec-5"
            class="hover:text-white">
            Practical Tests (Without Active S-Boxes)</a>
          <ol class="ml-6 mt-1 space-y-1 list-decimal
            list-inside text-gray-400">
            <li>
              <a href="#sec-5.1"
                class="hover:text-white">
                Algorithm for Detecting Weak Matrices</a>
            </li>
            <li>
              <a href="#sec-5.2"
                class="hover:text-white">
                Percentage of Weak Linear Layers</a>
            </li>
          </ol>
        </li>
        <li>
          <a href="#sec-6"
            class="hover:text-white">
            Infinitely Long Subspace Trails (Active
            S-Boxes)</a>
          <ol class="ml-6 mt-1 space-y-1 list-decimal
            list-inside text-gray-400">
            <li>
              <a href="#sec-6.1"
                class="hover:text-white">
                Preliminary Results</a>
            </li>
            <li>
              <a href="#sec-6.2"
                class="hover:text-white">
                Invariant Subspace Trails via Eigenspaces</a>
            </li>
            <li>
              <a href="#sec-6.3"
                class="hover:text-white">
                Necessary and Sufficient Condition (Active
                S-Boxes)</a>
            </li>
            <li>
              <a href="#sec-6.4"
                class="hover:text-white">
                Iterative Subspace Trails with Active
                S-Boxes</a>
            </li>
          </ol>
        </li>
        <li>
          <a href="#sec-7"
            class="hover:text-white">
            Practical Tests (Active S-Boxes)</a>
          <ol class="ml-6 mt-1 space-y-1 list-decimal
            list-inside text-gray-400">
            <li>
              <a href="#sec-7.1"
                class="hover:text-white">
                Related Strategies in the Literature</a>
            </li>
            <li>
              <a href="#sec-7.2"
                class="hover:text-white">
                Algorithms for Detecting Weak Matrices</a>
            </li>
            <li>
              <a href="#sec-7.3"
                class="hover:text-white">
                Percentage of Weak Linear Layers</a>
            </li>
          </ol>
        </li>
        <li>
          <a href="#sec-8"
            class="hover:text-white">
            Security Against Infinitely Long Subspace
            Trails</a>
          <ol class="ml-6 mt-1 space-y-1 list-decimal
            list-inside text-gray-400">
            <li>
              <a href="#sec-8.1"
                class="hover:text-white">
                Sufficient Condition for Preventing Infinitely
                Long Subspace Trails</a>
            </li>
            <li>
              <a href="#sec-8.2"
                class="hover:text-white">
                Open Problems</a>
            </li>
          </ol>
        </li>
      </ol>
      <p class="text-xs text-gray-500 mt-4 mb-1 font-semibold">
        Appendices
      </p>
      <ol class="space-y-1 text-sm text-gray-400
        list-[upper-alpha] list-inside">
        <li>
          <a href="#app-a"
            class="hover:text-white">
            Truncated Differentials and Subspace Trails</a>
        </li>
        <li>
          <a href="#app-b"
            class="hover:text-white">
            Infinitely Long Iterative Subspace Trails with
            Active S-Boxes</a>
        </li>
        <li>
          <a href="#app-c"
            class="hover:text-white">
            Results Using the Tool and More Examples</a>
        </li>
      </ol>
      <p class="text-xs text-gray-500 mt-4 mb-1 font-semibold">
        Additional
      </p>
      <ul class="space-y-1 text-sm text-gray-400 list-disc
        list-inside">
        <li>
          <a href="#references"
            class="hover:text-white">References</a>
        </li>
      </ul>
    </nav>

    <!-- ============================================================ -->
    <!-- ABSTRACT                                                     -->
    <!-- ============================================================ -->

    <section id="abstract" class="mb-10">
      <h2 class="text-2xl font-bold">Abstract</h2>
      <p class="text-gray-300">
        Designing cryptographic permutations and block ciphers using a
        substitution-permutation network (SPN) approach where the
        nonlinear part does not cover the entire state has recently
        gained attention due to favorable implementation
        characteristics in various scenarios.
      </p>
      <p class="text-gray-300">
        For word-oriented partial SPN (P-SPN) schemes with a fixed
        linear layer, the goal is to better understand how the details
        of the linear layer affect the security of the construction.
        In this paper, the authors derive conditions that allow to
        either set up or prevent attacks based on infinitely long
        truncated differentials with probability 1. The analysis
        considers <em>(1)</em> both invariant and
        non-invariant/iterative trails, and <em>(2)</em> trails with
        and without active S-boxes.
      </p>
      <p class="text-gray-300">
        For these cases, rigorous sufficient and necessary conditions
        are provided for the matrix that defines the linear layer to
        prevent the analyzed attacks. A tool is presented that can
        determine whether a given linear layer is vulnerable based on
        these results. Furthermore, a sufficient condition for the
        linear layer is proposed that, if satisfied, ensures that no
        infinitely long truncated differential exists. This condition
        is related to the degree and the irreducibility of the minimal
        polynomial of the matrix that defines the linear layer.
      </p>
      <p class="text-gray-300">
        Besides P-SPN schemes, the observations may also have a
        crucial impact on the Hades design strategy, which mixes
        rounds with full S-box layers and rounds with partial S-box
        layers.
      </p>
      <p class="text-gray-300">
        <strong>Keywords:</strong> Partial SPN, Linear Layer, Subspace
        Trails, Hades Schemes
      </p>
    </section>

    <!-- ============================================================ -->
    <!-- 1. INTRODUCTION                                              -->
    <!-- ============================================================ -->

    <section id="sec-1" class="mb-10">
      <h2 class="text-2xl font-bold">1. Introduction</h2>
      <p class="text-gray-300">
        Modern cryptography developed many techniques that go well
        beyond solving traditional confidentiality and authenticity
        problems in two-party communications. This includes practical
        applications of secure multi-party computation (MPC), (fully)
        homomorphic encryption (FHE), and zero-knowledge (ZK) proofs
        using symmetric primitives. Designs of primitives in symmetric
        cryptography for these applications are usually led by
        heuristics such as simplifying their arithmetic representations
        or linear operations being more efficient than nonlinear ones
        in these scenarios. The latter example is also used in the
        context of masking, a widespread countermeasure against
        side-channel attacks.
      </p>
      <p class="text-gray-300">
        Driven by all these application areas, many new symmetric
        primitives have recently been proposed. They include on one
        hand masking-friendly designs like NOEKEON [DPAR00], PICARO
        [PRC12], Zorro [GGNPS13], LS-designs [GLSV14], and candidates
        from the currently ongoing effort of choosing a next
        "lightweight" generation of primitives. On the other hand,
        there is an increasing number of MPC-/FHE-/ZK-friendly
        proposals, including LowMC [ARS<sup>+</sup>15], FLIP
        [MJSC16], Kreyvium [CCF<sup>+</sup>18], Rasta
        [DEG<sup>+</sup>18], MiMC [AGR<sup>+</sup>16],
        GMiMC [AGP<sup>+</sup>19], HADESMiMC
        [GLR<sup>+</sup>20b], Ciminion [DGGK19], JARVIS and
        FRIDAY [AD18], <em>Vision</em> and <em>Rescue</em>
        [AAB<sup>+</sup>20], and POSEIDON [GKR<sup>+</sup>21].
      </p>

      <!-- 1.1 Choosing the Linear Layer -->

      <h3 id="sec-1.1" class="text-xl font-semibold">
        1.1 Choosing the Linear Layer in Partial SPN Schemes
      </h3>
      <p class="text-gray-300">
        Some of the recalled designs (e.g., LowMC, Zorro, HADESMiMC
        and POSEIDON) reach the goal of minimizing the total number of
        multiplications by making use of rounds with a partial S-box
        layer. These designs are called partial
        substitution-permutation network (P-SPN) schemes. They are a
        variant of SPN schemes, in which an input block is transformed
        into an output block by applying several alternating rounds of
        substitution boxes and affine permutations. For a
        <span class="math">t</span>-word SPN scheme over a fixed
        finite field, the substitution layer usually consists of
        <span class="math">t</span> parallel (independent) nonlinear
        functions, called S-boxes. In many cases, the permutation layer
        is a linear operation defined by the multiplication of the
        state with a
        <span class="math">t \times t</span> matrix. In the case of a
        P-SPN, however, part of the substitution layer is replaced by
        an identity mapping, leading to practical advantages for
        applications in which nonlinear operations are more expensive
        than linear operations.
      </p>
      <p class="text-gray-300">
        Many strategies proposed in the literature to guarantee
        security for SPN schemes are no longer applicable to P-SPN
        schemes and have to be replaced by more ad-hoc approaches.
        This includes the well-known wide trail strategy [DR02], which
        is one of the main techniques for achieving security against
        various statistical attacks. In the case of Zorro, the
        heuristic argument proposed by the designers turned out to be
        insufficient, as iterative differential and linear
        characteristics were later found [WWGY14,
        BDD<sup>+</sup>15]. Similarly, the authors of LowMC chose
        the number of rounds to guarantee that no differential or
        linear characteristic can cover the entire function with
        non-negligible probability. However, they do not provide
        similarly strong security arguments against other attack
        vectors, and key-recovery attacks on LowMC have been found
        [DLMW15].
      </p>

      <!-- 1.2 Our Contribution and Related Work -->

      <h3 id="sec-1.2" class="text-xl font-semibold">
        1.2 Our Contribution and Related Work
      </h3>
      <p class="text-gray-300">
        Automated characteristic search tools and dedicated
        key-recovery algorithms for SP networks with partial nonlinear
        layers have been presented in [BDD<sup>+</sup>15]. As a
        main result, this tool can be used to understand how many
        rounds a <em>given</em> scheme requires to be secure.
        However, focusing on the matrix that defines the fixed linear
        layer in a P-SPN scheme, it is not clear which properties this
        matrix must satisfy to prevent cryptanalytic attacks in
        general.
      </p>
      <p class="text-gray-300">
        <strong>Our Goal.</strong> The authors aim at a relevant subset
        of undesirable properties that can lead to attacks: infinitely
        long truncated differentials with probability 1 [Knu94], or
        equivalently <em>infinitely long subspace trails</em>
        [GRR16a, GRR17], i.e., the existence of a nontrivial subspace
        <span class="math">\mathcal&#123;U&#125; \subseteq \mathbb&#123;F&#125;_q^t</span>
        of inputs that is mapped into a proper (affine) subspace of
        the state space over any number of rounds.
      </p>
      <p class="text-gray-300">
        <strong>Impact of Subspace Trails on Hades-Like
        Schemes.</strong> While such a subspace trail on its own
        represents a distinguisher, it can also be the starting point
        for an attack. A preimage attack on the hash function Poseidon
        based on the existence of such trails has recently been shown
        in [BCD<sup>+</sup>20, Sect. 6.2]. The attacked hash
        function is based on the Hades design strategy
        [GLR<sup>+</sup>20b], which uses external rounds with full
        S-box layers and middle rounds with partial S-box layers.
      </p>
      <p class="text-gray-300">
        <strong>Infinitely Long Subspace Trails: Necessary &amp;
        Sufficient Conditions for P-SPN Schemes.</strong> The authors
        present sufficient and necessary conditions that the matrix
        defining the linear layer must satisfy to guarantee that no
        infinitely long (nontrivial) subspace trails exist.
        Specifically, they analyze:
      </p>
      <ol class="list-decimal list-inside text-gray-300 mb-4
        space-y-1">
        <li>
          the case without active S-boxes in which the input of the
          S-box is constant (Sections 3 and 4), and
        </li>
        <li>
          the case with active S-boxes in which the input of the
          S-box can take any possible value (Section 6).
        </li>
      </ol>
      <p class="text-gray-300">
        In both cases, the analysis is independent of the round keys
        and round constants. In the particular case in which the
        matrix is diagonalizable, the infinitely long subspace trail
        (if existent) is always related to the eigenspaces of the
        matrix. More generally, the infinitely long subspace trails
        are always related to the invariant subspaces of the matrix
        <span class="math">M</span> defining the linear layer, which
        can be found via the <em>primary decomposition theorem</em>.
      </p>
      <p class="text-gray-300">
        <strong>Dedicated Tool.</strong> Together with the theoretical
        observations, practical Sage implementations are also provided.
        Given a square matrix, the tool can detect the vulnerabilities
        described in this paper (invariant and iterative trails), both
        in the case with and without active S-boxes and for binary and
        prime fields.
      </p>
    </section>

    <!-- ============================================================ -->
    <!-- 2. PRELIMINARIES                                             -->
    <!-- ============================================================ -->

    <section id="sec-2" class="mb-10">
      <h2 class="text-2xl font-bold">2. Preliminaries</h2>
      <p class="text-gray-300">
        <strong>Notation.</strong> The finite fields are denoted by
        <span class="math">\mathbb&#123;F&#125;_q</span>, where
        <span class="math">q = 2^n</span> or
        <span class="math">q = p^n</span> for a prime
        <span class="math">p \geq 3</span> and
        <span class="math">n \in \mathbb&#123;N&#125;</span>. For
        brevity, <span class="math">\mathbb&#123;F&#125;</span> is
        used instead of
        <span class="math">\mathbb&#123;F&#125;_q</span>. Subspaces
        are denoted with calligraphic letters (e.g.,
        <span class="math">\mathcal&#123;S&#125;</span>). Given a
        subspace
        <span class="math">\mathcal&#123;S&#125; \subseteq \mathbb&#123;F&#125;^t</span>,
        <span class="math">\mathcal&#123;S&#125;^c</span> denotes a
        complementary subspace such that
        <span class="math">\mathcal&#123;S&#125; \oplus \mathcal&#123;S&#125;^c = \mathbb&#123;F&#125;^t</span>.
        The symbol <span class="math">\oplus</span> denotes the direct
        sum. The unit vectors of
        <span class="math">\mathbb&#123;F&#125;_q^t</span> are
        <span class="math">\&#123;e_1, \ldots, e_t\&#125;</span>.
      </p>

      <!-- 2.1 Partial SPN Schemes -->

      <h3 id="sec-2.1" class="text-xl font-semibold">
        2.1 Partial SPN Schemes
      </h3>
      <p class="text-gray-300">
        The paper focuses on P-SPN block ciphers and permutations over
        <span class="math">(\mathbb&#123;F&#125;_q^t, +, \cdot)</span>.
        All results are independent of the round keys and constants.
      </p>
      <p class="text-gray-300">
        <strong>Partial SPN (P-SPN) Schemes.</strong> The application
        of <span class="math">r</span> rounds of a
        <span class="math">t</span>-word P-SPN scheme is denoted by
        <span class="math">E^r : \mathbb&#123;F&#125;^t \to \mathbb&#123;F&#125;^t</span>.
        Let <span class="math">1 \leq s &lt; \lceil t/2 \rceil</span>
        be the number of S-boxes per round. The composition of the
        S-box layer and of the linear layer is:
      </p>
      <div class="math-block">
        R(x) = (M \circ S)(x)
             = M(S_1(x_1), \dots, S_s(x_s), x_&#123;s+1&#125;,
               \dots, x_t)
      </div>
      <p class="text-gray-300">
        where <span class="math">S_i : \mathbb&#123;F&#125; \to \mathbb&#123;F&#125;</span>
        for <span class="math">i \in \&#123;1, \ldots, s\&#125;</span>
        is a nonlinear permutation, and hence
        <span class="math">t - s</span> input words are unaffected by
        the S-box layer. The linear layer is defined by the
        multiplication with an invertible matrix
        <span class="math">M \in \mathbb&#123;F&#125;^&#123;t \times t&#125;</span>.
      </p>
      <p class="text-gray-300">
        <strong>Hades-Like Schemes.</strong> The recently proposed
        HADES strategy [GLR<sup>+</sup>20b] combines both SPN and
        partial SPN schemes. The initial
        <span class="math">R_f</span> and the final
        <span class="math">R_f</span> rounds contain full S-box
        layers, for a total of
        <span class="math">R_F = 2R_f</span> rounds. In the middle,
        <span class="math">R_P</span> rounds with partial S-box
        layers are used.
      </p>

      <!-- 2.2 Invariant Subspaces and Subspace Trails -->

      <h3 id="sec-2.2" class="text-xl font-semibold">
        2.2 Invariant Subspaces and Subspace Trails
      </h3>

      <div class="formal-block formal-block-definition">
        <div class="formal-block-title text-blue-400">
          Definition 1 (Subspace Trail)
        </div>
        <div class="formal-block-content">
          <p class="text-sm text-gray-300">
            Let
            <span class="math">(\mathcal&#123;U&#125;_1, \ldots, \mathcal&#123;U&#125;_&#123;r+1&#125;)</span>
            denote a collection of
            <span class="math">r+1</span> nontrivial subspaces with
            <span class="math">\dim(\mathcal&#123;U&#125;_i) \leq \dim(\mathcal&#123;U&#125;_&#123;i+1&#125;) &lt; t</span>.
            If for each
            <span class="math">i \in \&#123;1, \ldots, r\&#125;</span>
            and for each
            <span class="math">a_i \in \mathbb&#123;F&#125;^t</span>
            there exists
            <span class="math">a_&#123;i+1&#125; \in \mathcal&#123;U&#125;_&#123;i+1&#125;^c</span>
            such that
          </p>
          <div class="math-block">
            R_i(\mathcal&#123;U&#125;_i + a_i)
            \subseteq \mathcal&#123;U&#125;_&#123;i+1&#125; + a_&#123;i+1&#125;,
          </div>
          <p class="text-sm text-gray-300">
            then
            <span class="math">(\mathcal&#123;U&#125;_1, \ldots, \mathcal&#123;U&#125;_&#123;r+1&#125;)</span>
            is a <em>subspace trail</em> of length
            <span class="math">r</span>. If the relations hold with
            equality, the subspace trail is called a
            <em>constant-dimensional subspace trail</em>.
          </p>
        </div>
      </div>

      <div class="formal-block formal-block-definition">
        <div class="formal-block-title text-blue-400">
          Definition 2 (Invariant Subspace Trail)
        </div>
        <div class="formal-block-content">
          <p class="text-sm text-gray-300">
            Let
            <span class="math">\mathcal&#123;U&#125; \subset \mathbb&#123;F&#125;^t</span>
            be a subspace.
            <span class="math">\mathcal&#123;U&#125;</span> generates
            an <span class="math">r</span>-round invariant subspace
            trail for the function
            <span class="math">F(\cdot) = R_r \circ \cdots \circ R_1(\cdot)</span>
            if for each
            <span class="math">i \in \&#123;1, \ldots, r\&#125;</span>
            and for each
            <span class="math">a_i \in \mathbb&#123;F&#125;^t</span>
            there exists
            <span class="math">a_&#123;i+1&#125;</span> such that
            <span class="math">R_i(\mathcal&#123;U&#125; + a_i) = \mathcal&#123;U&#125; + a_&#123;i+1&#125;</span>.
          </p>
        </div>
      </div>

      <div class="formal-block formal-block-definition">
        <div class="formal-block-title text-blue-400">
          Definition 3 (Iterative Subspace Trail)
        </div>
        <div class="formal-block-content">
          <p class="text-sm text-gray-300">
            Let
            <span class="math">(\mathcal&#123;V&#125;_1, \mathcal&#123;V&#125;_2, \ldots, \mathcal&#123;V&#125;_l)</span>
            be a constant-dimensional subspace trail for
            <span class="math">l</span> rounds with
            <span class="math">\dim(\mathcal&#123;V&#125;_i) &lt; t</span>.
            This subspace trail is an <em>infinitely long iterative
            (constant-dimensional) subspace trail</em> of period
            <span class="math">l</span> if it repeats itself an
            arbitrary number of times, i.e., if
          </p>
          <div class="math-block">
            (\mathcal&#123;V&#125;_1, \mathcal&#123;V&#125;_2,
            \ldots, \mathcal&#123;V&#125;_l,
            \mathcal&#123;V&#125;_1, \mathcal&#123;V&#125;_2,
            \ldots, \mathcal&#123;V&#125;_l, \ldots)
          </div>
          <p class="text-sm text-gray-300">
            is a subspace trail.
          </p>
        </div>
      </div>

      <div class="formal-block formal-block-proposition">
        <div class="formal-block-title text-violet-400">
          Proposition 1
        </div>
        <div class="formal-block-content">
          <p class="text-sm text-gray-300">
            Working over
            <span class="math">\mathbb&#123;F&#125;^t</span>, let
            <span class="math">(\mathcal&#123;V&#125;_1, \ldots, \mathcal&#123;V&#125;_l)</span>
            be an infinitely long iterative subspace trail of period
            <span class="math">l</span>. If
            <span class="math">\dim(\langle \mathcal&#123;V&#125;_1, \ldots, \mathcal&#123;V&#125;_l \rangle) &lt; t</span>,
            then
            <span class="math">\langle \mathcal&#123;V&#125;_1, \ldots, \mathcal&#123;V&#125;_l \rangle</span>
            generates an infinitely long invariant subspace trail.
          </p>
        </div>
      </div>

      <!-- 2.3 Decomposition Theorem & Frobenius Normal Form -->

      <h3 id="sec-2.3" class="text-xl font-semibold">
        2.3 Decomposition Theorem &amp; Frobenius Normal Form
      </h3>

      <div class="formal-block formal-block-definition">
        <div class="formal-block-title text-blue-400">
          Definition 4 (Eigenspace)
        </div>
        <div class="formal-block-content">
          <p class="text-sm text-gray-300">
            Given an invertible matrix
            <span class="math">M \in \mathbb&#123;F&#125;^&#123;t \times t&#125;</span>,
            the subspace
            <span class="math">\mathcal&#123;P&#125; = \langle \rho_1, \ldots, \rho_d \rangle \subseteq \mathbb&#123;F&#125;^t</span>
            is the (right) eigenspace of
            <span class="math">M</span> for the eigenvalue
            <span class="math">\lambda \in \mathbb&#123;F&#125; \setminus \&#123;0\&#125;</span>
            if
            <span class="math">M \cdot \rho_i = \lambda \cdot \rho_i</span>
            is satisfied for all
            <span class="math">i \in \&#123;1, \ldots, d\&#125;</span>.
          </p>
        </div>
      </div>

      <div class="formal-block formal-block-definition">
        <div class="formal-block-title text-blue-400">
          Definition 5 (Diagonalizable Matrix)
        </div>
        <div class="formal-block-content">
          <p class="text-sm text-gray-300">
            <span class="math">M \in \mathbb&#123;F&#125;^&#123;t \times t&#125;</span>
            is a diagonalizable matrix if and only if there exists an
            invertible matrix
            <span class="math">P</span> and eigenvalues
            <span class="math">\lambda_1, \ldots, \lambda_t</span>
            such that
            <span class="math">P^&#123;-1&#125; \cdot M \cdot P = \operatorname&#123;diag&#125;(\lambda_1, \ldots, \lambda_t)</span>.
          </p>
        </div>
      </div>

      <div class="formal-block formal-block-definition">
        <div class="formal-block-title text-blue-400">
          Definition 7 (Characteristic and Minimal Polynomial)
        </div>
        <div class="formal-block-content">
          <p class="text-sm text-gray-300">
            Let
            <span class="math">M \in \mathbb&#123;F&#125;^&#123;t \times t&#125;</span>
            be an invertible matrix. The characteristic polynomial
            <span class="math">\psi \in \mathbb&#123;F&#125;[x]</span>
            is defined as
            <span class="math">\psi(x) = \det(xI - M)</span>. The
            minimal polynomial
            <span class="math">\phi \in \mathbb&#123;F&#125;[x]</span>
            is the monic polynomial of minimal degree such that
            <span class="math">\phi(M) \cdot v = 0^t</span> for each
            <span class="math">v \in \mathbb&#123;F&#125;^t</span>,
            and for each annihilating polynomial
            <span class="math">p</span>,
            <span class="math">\phi</span> divides
            <span class="math">p</span>.
          </p>
        </div>
      </div>

      <div class="formal-block formal-block-definition">
        <div class="formal-block-title text-blue-400">
          Definition 8 (M-invariant Subspace)
        </div>
        <div class="formal-block-content">
          <p class="text-sm text-gray-300">
            Let
            <span class="math">M \in \mathbb&#123;F&#125;^&#123;t \times t&#125;</span>
            be invertible and
            <span class="math">\mathcal&#123;V&#125; \subseteq \mathbb&#123;F&#125;^t</span>.
            <span class="math">\mathcal&#123;V&#125;</span> is
            <span class="math">M</span>-invariant if and only if
            <span class="math">M \cdot \mathcal&#123;V&#125; = \mathcal&#123;V&#125;</span>.
          </p>
        </div>
      </div>

      <div class="formal-block formal-block-definition">
        <div class="formal-block-title text-blue-400">
          Definition 10 (Frobenius Normal Form)
        </div>
        <div class="formal-block-content">
          <p class="text-sm text-gray-300">
            Let
            <span class="math">M \in \mathbb&#123;F&#125;^&#123;t \times t&#125;</span>.
            The Frobenius normal form of
            <span class="math">M</span> is the matrix
            <span class="math">F \in \mathbb&#123;F&#125;^&#123;t \times t&#125;</span>
            for which there exists an invertible matrix
            <span class="math">Q</span> such that
            <span class="math">F = Q \cdot M \cdot Q^&#123;-1&#125; = \operatorname&#123;diag&#125;(C_1, C_2, \ldots, C_l)</span>,
            where each
            <span class="math">C_i</span> is the companion matrix
            associated to a monic polynomial
            <span class="math">p_i(x)</span> such that
            <span class="math">p_i</span> divides
            <span class="math">p_&#123;i+1&#125;</span>, and
            <span class="math">p_l</span> corresponds to the minimal
            polynomial <span class="math">\phi</span> of
            <span class="math">M</span>.
          </p>
        </div>
      </div>

      <div class="formal-block formal-block-theorem">
        <div class="formal-block-title text-green-400">
          Theorem 1 (Primary Decomposition Theorem)
        </div>
        <div class="formal-block-content">
          <p class="text-sm text-gray-300">
            Let
            <span class="math">M \in \mathbb&#123;F&#125;^&#123;t \times t&#125;</span>
            be invertible with minimal polynomial
            <span class="math">\phi(x) = [p_1(x)]^&#123;\alpha_1&#125; \cdot [p_2(x)]^&#123;\alpha_2&#125; \cdots [p_m(x)]^&#123;\alpha_m&#125;</span>,
            where
            <span class="math">p_i(\cdot), p_j(\cdot)</span> are
            monic, irreducible, and relatively prime. Then
          </p>
          <div class="math-block">
            \mathbb&#123;F&#125;^t = \mathcal&#123;A&#125;_1 \oplus
            \mathcal&#123;A&#125;_2 \oplus \cdots \oplus
            \mathcal&#123;A&#125;_m,
          </div>
          <p class="text-sm text-gray-300">
            where
            <span class="math">\mathcal&#123;A&#125;_j := \ker([p_j(M)]^&#123;\alpha_j&#125;)</span>,
            such that all
            <span class="math">\mathcal&#123;A&#125;_i</span> are
            <span class="math">M</span>-invariant, and the minimal
            polynomial of the operator induced on
            <span class="math">\mathcal&#123;A&#125;_i</span> by
            <span class="math">M</span> is
            <span class="math">(p_i(\cdot))^&#123;\alpha_i&#125;</span>.
          </p>
        </div>
      </div>
    </section>

    <!-- ============================================================ -->
    <!-- 3. INVARIANT SUBSPACE TRAILS (WITHOUT ACTIVE S-BOXES)        -->
    <!-- ============================================================ -->

    <section id="sec-3" class="mb-10">
      <h2 class="text-2xl font-bold">
        3. Infinitely Long Invariant Subspace Trails for P-SPN
        Schemes (Without Active S-Boxes)
      </h2>
      <p class="text-gray-300">
        Focusing on P-SPN schemes which use the same linear layer in
        each round, this section studies the properties that the matrix
        defining the linear layer must satisfy in order to prevent
        infinitely long invariant subspace trails without active
        S-boxes.
      </p>

      <h3 id="sec-3.1" class="text-xl font-semibold">
        3.1 Preliminary Results
      </h3>

      <div class="formal-block formal-block-definition">
        <div class="formal-block-title text-blue-400">
          Definition 11
        </div>
        <div class="formal-block-content">
          <p class="text-sm text-gray-300">
            Consider a P-SPN scheme over
            <span class="math">\mathbb&#123;F&#125;^t</span> with
            <span class="math">1 \leq s &lt; t</span> S-boxes. Let
            <span class="math">\mathcal&#123;S&#125;^&#123;(i)&#125;</span>
            be defined as
            <span class="math">\mathbb&#123;F&#125;^t</span> if
            <span class="math">i = 0</span>, and
            <span class="math">\&#123; v \in \mathbb&#123;F&#125;^t \mid (M^j \cdot v)[1, \ldots, s] = 0, \; 0 \leq j &lt; i \&#125;</span>
            otherwise.
          </p>
        </div>
      </div>

      <div class="formal-block formal-block-lemma">
        <div class="formal-block-title text-amber-400">
          Lemma 1
        </div>
        <div class="formal-block-content">
          <p class="text-sm text-gray-300">
            For each <span class="math">i \geq 1</span>,
            <span class="math">\mathcal&#123;S&#125;^&#123;(i+1)&#125; = \mathcal&#123;S&#125;^&#123;(i)&#125; \cap (M^&#123;-1&#125; \cdot \mathcal&#123;S&#125;^&#123;(i)&#125;) \subseteq \mathcal&#123;S&#125;^&#123;(i)&#125;</span>,
            where
            <span class="math">t - i \cdot s \leq \dim(\mathcal&#123;S&#125;^&#123;(i)&#125;) \leq t</span>.
          </p>
        </div>
      </div>

      <div class="formal-block formal-block-lemma">
        <div class="formal-block-title text-amber-400">
          Lemma 2
        </div>
        <div class="formal-block-content">
          <p class="text-sm text-gray-300">
            Let
            <span class="math">\mathfrak&#123;R&#125; \geq \lfloor (t-s)/s \rfloor</span>
            be such that
            <span class="math">\dim(\mathcal&#123;S&#125;^&#123;(\mathfrak&#123;R&#125;)&#125;) \geq 1</span>
            and
            <span class="math">\dim(\mathcal&#123;S&#125;^&#123;(\mathfrak&#123;R&#125;+1)&#125;) = 0</span>.
            For each
            <span class="math">r \leq \mathfrak&#123;R&#125;</span>,
            <span class="math">(\mathcal&#123;S&#125;^&#123;(r)&#125;, M \cdot \mathcal&#123;S&#125;^&#123;(r)&#125;, \ldots, M^&#123;r-1&#125; \cdot \mathcal&#123;S&#125;^&#123;(r)&#125;)</span>
            is a subspace trail for the first
            <span class="math">r</span> rounds without active S-boxes.
          </p>
        </div>
      </div>

      <h3 id="sec-3.2" class="text-xl font-semibold">
        3.2 Infinitely Long Invariant Subspace Trails via Eigenspaces
        of <span class="math">M</span>
      </h3>

      <div class="formal-block formal-block-proposition">
        <div class="formal-block-title text-violet-400">
          Proposition 3
        </div>
        <div class="formal-block-content">
          <p class="text-sm text-gray-300">
            Let
            <span class="math">\lambda_1, \ldots, \lambda_\tau</span>
            be the eigenvalues of
            <span class="math">M</span> and
            <span class="math">\mathcal&#123;P&#125;_1, \ldots, \mathcal&#123;P&#125;_\tau</span>
            the corresponding eigenspaces. Let
            <span class="math">\mathcal&#123;I&#125; = \langle \mathcal&#123;P&#125;_1 \cap \langle e_&#123;s+1&#125;, \ldots, e_t \rangle, \ldots, \mathcal&#123;P&#125;_\tau \cap \langle e_&#123;s+1&#125;, \ldots, e_t \rangle \rangle</span>.
            If
            <span class="math">1 \leq \dim(\mathcal&#123;I&#125;) &lt; t</span>,
            then
            <span class="math">\mathcal&#123;I&#125;</span> generates
            an infinitely long invariant subspace trail without active
            S-boxes.
          </p>
        </div>
      </div>

      <h3 id="sec-3.3" class="text-xl font-semibold">
        3.3 Necessary and Sufficient Condition
      </h3>

      <div class="formal-block formal-block-theorem">
        <div class="formal-block-title text-green-400">
          Theorem 2
        </div>
        <div class="formal-block-content">
          <p class="text-sm text-gray-300">
            A subspace
            <span class="math">\mathcal&#123;I&#125;</span> with
            <span class="math">1 \leq \dim(\mathcal&#123;I&#125;) &lt; t</span>
            generates an infinitely long invariant subspace trail
            without active S-boxes <strong>if and only if</strong>
            <span class="math">\mathcal&#123;I&#125; \subseteq \mathcal&#123;S&#125;^&#123;(1)&#125;</span>
            and
            <span class="math">\mathcal&#123;I&#125; = M \cdot \mathcal&#123;I&#125;</span>.
          </p>
        </div>
      </div>

      <div class="formal-block formal-block-theorem">
        <div class="formal-block-title text-green-400">
          Theorem 3
        </div>
        <div class="formal-block-content">
          <p class="text-sm text-gray-300">
            Let
            <span class="math">\&#123;\mathcal&#123;A&#125;_1, \ldots, \mathcal&#123;A&#125;_m\&#125;</span>
            be the primary decomposition of
            <span class="math">\mathbb&#123;F&#125;^t</span> w.r.t.
            <span class="math">M</span>, and
            <span class="math">\mathcal&#123;X&#125;_i := \mathcal&#123;A&#125;_i \cap \langle e_&#123;s+1&#125;, \ldots, e_t \rangle</span>.
            Then
            <span class="math">\mathcal&#123;I&#125;</span> generates
            such a trail <strong>iff</strong>
            <span class="math">\mathcal&#123;I&#125; = \langle \mathcal&#123;P&#125;_1, \ldots, \mathcal&#123;P&#125;_m \rangle</span>
            where each
            <span class="math">\mathcal&#123;P&#125;_i \subseteq \mathcal&#123;X&#125;_i</span>
            is <span class="math">M</span>-invariant.
          </p>
        </div>
      </div>

      <div class="formal-block formal-block-proposition">
        <div class="formal-block-title text-violet-400">
          Proposition 4
        </div>
        <div class="formal-block-content">
          <p class="text-sm text-gray-300">
            Define
            <span class="math">\mathcal&#123;X&#125;_i^&#123;(j)&#125; = \mathcal&#123;X&#125;_i^&#123;(j-1)&#125; \cap (M \cdot \mathcal&#123;X&#125;_i^&#123;(j-1)&#125;)</span>.
            The biggest
            <span class="math">M</span>-invariant subspace
            <span class="math">\mathcal&#123;P&#125;_i</span> of
            <span class="math">\mathcal&#123;X&#125;_i</span>
            satisfying Theorem 3 equals
            <span class="math">\mathcal&#123;X&#125;_i^&#123;(l_i)&#125;</span>
            where <span class="math">l_i</span> is the smallest
            integer with
            <span class="math">\mathcal&#123;X&#125;_i^&#123;(l_i)&#125; = \mathcal&#123;X&#125;_i^&#123;(l_i+1)&#125;</span>.
          </p>
        </div>
      </div>

      <div class="formal-block formal-block-proposition">
        <div class="formal-block-title text-violet-400">
          Corollary 1
        </div>
        <div class="formal-block-content">
          <p class="text-sm text-gray-300">
            The trail from Proposition 3 satisfies Theorem 3. The two
            results are equivalent if the matrix is diagonalizable.
          </p>
        </div>
      </div>
    </section>

    <!-- ============================================================ -->
    <!-- 4. ITERATIVE SUBSPACE TRAILS (WITHOUT ACTIVE S-BOXES)        -->
    <!-- ============================================================ -->

    <section id="sec-4" class="mb-10">
      <h2 class="text-2xl font-bold">
        4. Iterative Subspace Trails Without Active S-Boxes
      </h2>

      <div class="formal-block formal-block-proposition">
        <div class="formal-block-title text-violet-400">
          Proposition 5
        </div>
        <div class="formal-block-content">
          <p class="text-sm text-gray-300">
            <span class="math">\mathcal&#123;I&#125;</span> generates
            an infinitely long iterative subspace trail of period
            <span class="math">l \geq 2</span> without active S-boxes
            <strong>iff</strong>
            <span class="math">\mathcal&#123;I&#125; \subseteq \mathcal&#123;S&#125;^&#123;(l)&#125;</span>
            and
            <span class="math">\mathcal&#123;I&#125; = M^l \cdot \mathcal&#123;I&#125;</span>.
          </p>
        </div>
      </div>

      <div class="formal-block formal-block-proposition">
        <div class="formal-block-title text-violet-400">
          Proposition 6
        </div>
        <div class="formal-block-content">
          <p class="text-sm text-gray-300">
            Let
            <span class="math">\&#123;\mathcal&#123;A&#125;_i^&#123;(l)&#125;\&#125;</span>
            be the primary decomposition w.r.t.
            <span class="math">M^l</span>. Then
            <span class="math">\mathcal&#123;I&#125;</span> generates
            such a trail <strong>iff</strong>
            <span class="math">\mathcal&#123;I&#125; = \langle \mathcal&#123;P&#125;_1, \ldots, \mathcal&#123;P&#125;_m \rangle</span>
            where
            <span class="math">\mathcal&#123;P&#125;_i \subseteq \mathcal&#123;A&#125;_i^&#123;(l)&#125; \cap \mathcal&#123;S&#125;^&#123;(l)&#125;</span>
            is <span class="math">M^l</span>-invariant.
          </p>
        </div>
      </div>

      <div class="formal-block formal-block-proposition">
        <div class="formal-block-title text-violet-400">
          Proposition 7
        </div>
        <div class="formal-block-content">
          <p class="text-sm text-gray-300">
            An infinitely long iterative subspace trail without active
            S-boxes can only exist if there exists an infinitely long
            invariant subspace trail without active S-boxes.
          </p>
        </div>
      </div>

      <h3 id="sec-4.1" class="text-xl font-semibold">
        4.1 Linear Layers with Low Multiplicative Order
      </h3>

      <div class="formal-block formal-block-definition">
        <div class="formal-block-title text-blue-400">
          Definition 12 (Multiplicative Order)
        </div>
        <div class="formal-block-content">
          <p class="text-sm text-gray-300">
            <span class="math">M</span> has multiplicative order
            <span class="math">l \geq 1</span> if
            <span class="math">l</span> is the smallest positive
            integer such that
            <span class="math">M^l = \mu \cdot I</span> for some
            <span class="math">\mu \neq 0</span>.
          </p>
        </div>
      </div>

      <div class="formal-block formal-block-proposition">
        <div class="formal-block-title text-violet-400">
          Proposition 8
        </div>
        <div class="formal-block-content">
          <p class="text-sm text-gray-300">
            If the multiplicative order of
            <span class="math">M</span> is
            <span class="math">l</span> with
            <span class="math">2 \leq l \leq \mathfrak&#123;R&#125;</span>,
            then
            <span class="math">\mathcal&#123;S&#125;^&#123;(l)&#125;</span>
            generates an infinitely long iterative subspace trail of
            period <span class="math">l</span>.
          </p>
        </div>
      </div>

      <p class="text-gray-300">
        <strong>Cauchy Matrices in [GKR<sup>+</sup>21].</strong>
        The Cauchy matrix proposed for Starkad/Poseidon over
        <span class="math">\mathbb&#123;F&#125;_&#123;2^n&#125;</span>
        with
        <span class="math">t = 2^\tau</span> has multiplicative order
        2, enabling iterative trails as shown in [KR21,
        BCD<sup>+</sup>20].
      </p>

      <h3 id="sec-4.2" class="text-xl font-semibold">
        4.2 Linear Layers with Low-Degree Minimal Polynomials
      </h3>

      <div class="formal-block formal-block-proposition">
        <div class="formal-block-title text-violet-400">
          Proposition 9
        </div>
        <div class="formal-block-content">
          <p class="text-sm text-gray-300">
            Let <span class="math">\phi</span> be the minimal
            polynomial of <span class="math">M</span> of degree
            <span class="math">l</span> with
            <span class="math">2 \leq l \leq \mathfrak&#123;R&#125;</span>.
            If <span class="math">\phi</span> has only monomials whose
            exponents are multiples of
            <span class="math">h</span> (a divisor of
            <span class="math">l</span>), then
            <span class="math">\mathcal&#123;I&#125; = \langle \mathcal&#123;S&#125;^&#123;(l)&#125;, M^h \cdot \mathcal&#123;S&#125;^&#123;(l)&#125;, \ldots, M^&#123;l-h&#125; \cdot \mathcal&#123;S&#125;^&#123;(l)&#125; \rangle</span>
            generates an infinitely long iterative trail of period
            <span class="math">h</span> without active S-boxes (if
            <span class="math">1 \leq \dim(\mathcal&#123;I&#125;) &lt; t</span>).
          </p>
        </div>
      </div>

      <div class="formal-block formal-block-lemma">
        <div class="formal-block-title text-amber-400">
          Lemma 3
        </div>
        <div class="formal-block-content">
          <p class="text-sm text-gray-300">
            Let
            <span class="math">\mathcal&#123;P&#125;_1^&#123;(l)&#125;, \ldots, \mathcal&#123;P&#125;_\tau^&#123;(l)&#125;</span>
            be eigenspaces of
            <span class="math">M^l</span>. The subspace
            <span class="math">\mathcal&#123;I&#125; := \langle \mathcal&#123;S&#125;^&#123;(l)&#125; \cap \mathcal&#123;P&#125;_1^&#123;(l)&#125;, \ldots, \mathcal&#123;S&#125;^&#123;(l)&#125; \cap \mathcal&#123;P&#125;_\tau^&#123;(l)&#125; \rangle</span>
            generates an infinitely long iterative subspace trail of
            period <span class="math">l</span>.
          </p>
        </div>
      </div>
    </section>

    <!-- ============================================================ -->
    <!-- 5. PRACTICAL TESTS (WITHOUT ACTIVE S-BOXES)                  -->
    <!-- ============================================================ -->

    <section id="sec-5" class="mb-10">
      <h2 class="text-2xl font-bold">
        5. Practical Tests (Without Active S-Boxes)
      </h2>

      <h3 id="sec-5.1" class="text-xl font-semibold">
        5.1 Algorithm for Detecting Weak Matrices
      </h3>
      <p class="text-gray-300">
        <strong>Algorithm 1</strong> uses Theorem 3 and Proposition 4.
        First, the full space is decomposed into
        <span class="math">M</span>-invariant subspaces via Theorem 1.
        Then intersection with identity positions is taken:
        <span class="math">\mathcal&#123;X&#125;_i^&#123;(0)&#125; = \mathcal&#123;A&#125;_i \cap \langle e_&#123;s+1&#125;, \ldots, e_t \rangle</span>.
        Proposition 4 is applied iteratively until the dimension
        stabilizes or reaches zero. The matrix is vulnerable if
        <span class="math">\dim(\mathcal&#123;I&#125;) > 0</span>.
        Computational cost is
        <span class="math">\mathcal&#123;O&#125;(t^3)</span>.
      </p>

      <h3 id="sec-5.2" class="text-xl font-semibold">
        5.2 Percentage of Weak Linear Layers
      </h3>
      <p class="text-gray-300">
        With a sample size of 100,000, focusing on
        <span class="math">s = 1</span>, both random invertible and
        random Cauchy matrices were tested over prime and binary
        fields.
      </p>

      <div id="table-1" class="overflow-x-auto my-6">
        <p class="text-sm text-gray-400 mb-2">
          <strong>Table 1.</strong> Percentage of vulnerable matrices
          (Algorithm 1) over prime fields
          <span class="math">\mathbb&#123;F&#125;_p</span>.
        </p>
        <table class="w-full text-sm">
          <thead>
            <tr class="border-b border-gray-700">
              <th class="text-left py-2 pr-4">
                <span class="math">\lceil\log_2(p)\rceil</span>
                / <span class="math">t</span>
              </th>
              <th class="text-left py-2 pr-4">8/3</th>
              <th class="text-left py-2 pr-4">4/4</th>
              <th class="text-left py-2 pr-4">6/4</th>
              <th class="text-left py-2 pr-4">16/4</th>
              <th class="text-left py-2 pr-4">8/8</th>
              <th class="text-left py-2 pr-4">12/8</th>
              <th class="text-left py-2 pr-4">16/8</th>
              <th class="text-left py-2">8/12</th>
            </tr>
          </thead>
          <tbody class="text-gray-300">
            <tr class="border-b border-gray-800">
              <td class="py-2 pr-4">Random Inv.</td>
              <td class="py-2 pr-4">0.46</td>
              <td class="py-2 pr-4">8.94</td>
              <td class="py-2 pr-4">2.06</td>
              <td class="py-2 pr-4">&lt;0.01</td>
              <td class="py-2 pr-4">0.51</td>
              <td class="py-2 pr-4">0.03</td>
              <td class="py-2 pr-4">&lt;0.01</td>
              <td class="py-2">0.50</td>
            </tr>
            <tr class="border-b border-gray-800">
              <td class="py-2 pr-4">MDS Cauchy</td>
              <td class="py-2 pr-4">0.49</td>
              <td class="py-2 pr-4">6.12</td>
              <td class="py-2 pr-4">2.03</td>
              <td class="py-2 pr-4">&lt;0.01</td>
              <td class="py-2 pr-4">0.49</td>
              <td class="py-2 pr-4">0.03</td>
              <td class="py-2 pr-4">&lt;0.01</td>
              <td class="py-2">0.52</td>
            </tr>
          </tbody>
        </table>
      </div>

      <p class="text-gray-300">
        Increasing <span class="math">p</span> (or
        <span class="math">n</span>) tends to produce more secure
        matrices. Even for small fields, a secure matrix can easily be
        found by testing a small number of candidates.
      </p>
    </section>

    <!-- ============================================================ -->
    <!-- 6. SUBSPACE TRAILS (ACTIVE S-BOXES)                          -->
    <!-- ============================================================ -->

    <section id="sec-6" class="mb-10">
      <h2 class="text-2xl font-bold">
        6. Infinitely Long Subspace Trails for P-SPN Schemes
        (Active S-Boxes)
      </h2>
      <p class="text-gray-300">
        <strong>Assumption on the S-Box.</strong> From now on, only
        S-boxes without any nontrivial linear structures are
        considered. That is, it is not possible to find nontrivial
        subspaces
        <span class="math">\mathcal&#123;U&#125;, \mathcal&#123;V&#125; \subset \mathbb&#123;F&#125;</span>
        such that for each <span class="math">u</span> there exists
        <span class="math">v</span> with
        <span class="math">S(\mathcal&#123;U&#125; + u) = \mathcal&#123;V&#125; + v</span>.
        Both the AES S-box and the cube map
        <span class="math">x \mapsto x^3</span> satisfy this.
      </p>

      <h3 id="sec-6.1" class="text-xl font-semibold">
        6.1 Preliminary Results: Subspace Trails &amp; Truncated
        Differentials
      </h3>

      <div class="formal-block formal-block-proposition">
        <div class="formal-block-title text-violet-400">
          Proposition 10
        </div>
        <div class="formal-block-content">
          <p class="text-sm text-gray-300">
            Let
            <span class="math">\mathfrak&#123;R&#125; &lt; \infty</span>.
            There exists a subspace trail with probability 1 on at
            least
            <span class="math">\mathfrak&#123;R&#125; + \lfloor (t-s)/s \rfloor</span>
            rounds, defined by
            <span class="math">(\mathcal&#123;S&#125;^&#123;(\mathfrak&#123;R&#125;)&#125;, M \cdot \mathcal&#123;S&#125;^&#123;(\mathfrak&#123;R&#125;)&#125;, \ldots, M^&#123;\mathfrak&#123;R&#125;-1&#125; \cdot \mathcal&#123;S&#125;^&#123;(\mathfrak&#123;R&#125;)&#125;, \mathcal&#123;A&#125;^&#123;(1)&#125;, \ldots)</span>,
            where
            <span class="math">\mathcal&#123;A&#125;^&#123;(i)&#125; := \langle M(e_1), \ldots, M(e_s), M \cdot \mathcal&#123;A&#125;^&#123;(i-1)&#125; \rangle</span>.
          </p>
        </div>
      </div>

      <h3 id="sec-6.2" class="text-xl font-semibold">
        6.2 Infinitely Long Invariant Subspace Trails with Active
        S-Boxes via Eigenspaces of <span class="math">M</span>
      </h3>

      <div class="formal-block formal-block-definition">
        <div class="formal-block-title text-blue-400">
          Definition 13 (I-compatible Subspace)
        </div>
        <div class="formal-block-content">
          <p class="text-sm text-gray-300">
            Let
            <span class="math">I \subseteq \&#123;1, \ldots, s\&#125;</span>.
            A subspace
            <span class="math">\mathcal&#123;V&#125; \subseteq \mathbb&#123;F&#125;^t</span>
            is <span class="math">I</span>-compatible if:
            when <span class="math">I = \emptyset</span>,
            <span class="math">\mathcal&#123;V&#125; \subseteq \langle e_&#123;s+1&#125;, \ldots, e_t \rangle</span>;
            when
            <span class="math">I = \&#123;\iota_1, \ldots, \iota_&#123;|I|&#125;\&#125;</span>,
            then (1)
            <span class="math">\mathcal&#123;V&#125; \subseteq \langle e_&#123;\iota_1&#125;, \ldots, e_&#123;\iota_&#123;|I|&#125;&#125;, e_&#123;s+1&#125;, \ldots, e_t \rangle</span>
            and (2)
            <span class="math">\langle e_&#123;\iota_1&#125;, \ldots, e_&#123;\iota_&#123;|I|&#125;&#125; \rangle \subseteq \mathcal&#123;V&#125;</span>.
          </p>
        </div>
      </div>

      <div class="formal-block formal-block-proposition">
        <div class="formal-block-title text-violet-400">
          Proposition 11
        </div>
        <div class="formal-block-content">
          <p class="text-sm text-gray-300">
            Let
            <span class="math">\mathcal&#123;P&#125;_1, \ldots, \mathcal&#123;P&#125;_\tau</span>
            be eigenspaces of <span class="math">M</span>. Let
            <span class="math">\mathcal&#123;I&#125; = \langle \mathcal&#123;P&#125;'_1, \ldots, \mathcal&#123;P&#125;'_\tau \rangle</span>
            where each
            <span class="math">\mathcal&#123;P&#125;'_h</span> is a
            subspace of
            <span class="math">\mathcal&#123;P&#125;_h</span>. If
            <span class="math">1 \leq \dim(\mathcal&#123;I&#125;) &lt; t</span>
            and
            <span class="math">\mathcal&#123;I&#125;</span> is
            <span class="math">I</span>-compatible, then
            <span class="math">\mathcal&#123;I&#125;</span> generates
            an infinitely long invariant subspace trail with active
            S-boxes.
          </p>
        </div>
      </div>

      <h3 id="sec-6.3" class="text-xl font-semibold">
        6.3 Necessary and Sufficient Condition (Active S-boxes)
      </h3>

      <div class="formal-block formal-block-theorem">
        <div class="formal-block-title text-green-400">
          Theorem 4
        </div>
        <div class="formal-block-content">
          <p class="text-sm text-gray-300">
            Assume the S-box has no nontrivial linear structure. Let
            <span class="math">I \subseteq \&#123;1, \ldots, s\&#125;</span>.
            A subspace
            <span class="math">\mathcal&#123;I&#125;</span> with
            <span class="math">1 \leq \dim(\mathcal&#123;I&#125;) &lt; t</span>
            generates an infinitely long invariant subspace trail (with
            active S-boxes if
            <span class="math">|I| \geq 1</span>)
            <strong>if and only if</strong>
            <span class="math">\mathcal&#123;I&#125;</span> is both
            <span class="math">M</span>-invariant and
            <span class="math">I</span>-compatible.
          </p>
        </div>
      </div>

      <div class="formal-block formal-block-theorem">
        <div class="formal-block-title text-green-400">
          Theorem 5
        </div>
        <div class="formal-block-content">
          <p class="text-sm text-gray-300">
            Let
            <span class="math">\&#123;\mathcal&#123;A&#125;_1, \ldots, \mathcal&#123;A&#125;_m\&#125;</span>
            be the primary decomposition w.r.t.
            <span class="math">M</span>.
            <span class="math">\mathcal&#123;I&#125;</span> generates
            an infinitely long invariant subspace trail with active
            S-boxes in positions
            <span class="math">I</span> <strong>iff</strong>
            <span class="math">\mathcal&#123;I&#125; = \langle \mathcal&#123;P&#125;_1, \ldots, \mathcal&#123;P&#125;_m \rangle</span>
            where each
            <span class="math">\mathcal&#123;P&#125;_i \subseteq \mathcal&#123;A&#125;_i \cap \langle e_&#123;\iota_1&#125;, \ldots, e_&#123;\iota_&#123;|I|&#125;&#125;, e_&#123;s+1&#125;, \ldots, e_t \rangle</span>
            is <span class="math">M</span>-invariant, and
            <span class="math">\mathcal&#123;I&#125;</span> is
            <span class="math">I</span>-compatible.
          </p>
        </div>
      </div>

      <div class="formal-block formal-block-proposition">
        <div class="formal-block-title text-violet-400">
          Corollary 3
        </div>
        <div class="formal-block-content">
          <p class="text-sm text-gray-300">
            If there exists
            <span class="math">I \subseteq \&#123;1, \ldots, s\&#125;</span>
            such that a subspace
            <span class="math">\mathcal&#123;A&#125;_i</span> from the
            primary decomposition is
            <span class="math">I</span>-compatible, then
            <span class="math">\mathcal&#123;A&#125;_i</span>
            generates an infinitely long invariant subspace trail with
            active S-boxes.
          </p>
        </div>
      </div>

      <h3 id="sec-6.4" class="text-xl font-semibold">
        6.4 Infinitely Long Iterative Subspace Trails with Active
        S-Boxes
      </h3>

      <div class="formal-block formal-block-theorem">
        <div class="formal-block-title text-green-400">
          Theorem 6
        </div>
        <div class="formal-block-content">
          <p class="text-sm text-gray-300">
            Assume the S-box has no nontrivial linear structure. Let
            <span class="math">l \geq 1</span> be the period. For each
            <span class="math">j \in \&#123;1, \ldots, l\&#125;</span>,
            let
            <span class="math">I_j \subseteq \&#123;1, \ldots, s\&#125;</span>
            be the active S-box positions. A subspace
            <span class="math">\mathcal&#123;I&#125;</span> generates
            an infinitely long iterative subspace trail of period
            <span class="math">l</span> <strong>iff</strong>
            (1) <span class="math">M^j \cdot \mathcal&#123;I&#125;</span>
            is <span class="math">I_j</span>-compatible for
            <span class="math">j \in \&#123;0, \ldots, l-1\&#125;</span>,
            and (2)
            <span class="math">\mathcal&#123;I&#125;</span> is
            <span class="math">M^l</span>-invariant.
          </p>
        </div>
      </div>

      <div class="formal-block formal-block-theorem">
        <div class="formal-block-title text-green-400">
          Theorem 7
        </div>
        <div class="formal-block-content">
          <p class="text-sm text-gray-300">
            Let
            <span class="math">\&#123;\mathcal&#123;A&#125;_i^&#123;(l)&#125;\&#125;</span>
            be the primary decomposition w.r.t.
            <span class="math">M^l</span>.
            <span class="math">\mathcal&#123;I&#125;</span> generates
            an infinitely long iterative subspace trail of period
            <span class="math">l</span> with active S-boxes in
            positions
            <span class="math">I_j</span> <strong>iff</strong>
            <span class="math">\mathcal&#123;I&#125; = \langle \mathcal&#123;P&#125;_1, \ldots, \mathcal&#123;P&#125;_m \rangle</span>
            where each
            <span class="math">\mathcal&#123;P&#125;_i</span> is
            <span class="math">M^l</span>-invariant, and
            <span class="math">M^j \cdot \mathcal&#123;I&#125;</span>
            is <span class="math">I_j</span>-compatible for each
            <span class="math">j</span>.
          </p>
        </div>
      </div>

      <p class="text-gray-300">
        <strong>About Iterative Subspace Trails with Active
        S-Boxes.</strong> There exist P-SPN schemes with iterative
        subspace trails with active S-boxes but no invariant trails.
        For example, the
        <span class="math">3 \times 3</span> matrix
      </p>
      <div class="math-block">
        M = \begin&#123;pmatrix&#125;
        0 &amp; 1 &amp; -1 \\
        1 &amp; -2 &amp; 1 \\
        1 &amp; -4 &amp; 2
        \end&#123;pmatrix&#125;
      </div>
      <p class="text-gray-300">
        over <span class="math">\mathbb&#123;F&#125;_p^3</span> with
        <span class="math">s = 1</span> admits the iterative trail
        <span class="math">(\langle (1,0,0)^T \rangle, \langle (0,1,1)^T \rangle, \langle (0,1,2)^T \rangle)</span>
        of period 3 with active S-boxes. Since
        <span class="math">\dim(\langle \mathcal&#123;V&#125;_0, \mathcal&#123;V&#125;_1, \mathcal&#123;V&#125;_2 \rangle) = 3</span>,
        no invariant subspace trail can be set up.
      </p>
    </section>

    <!-- ============================================================ -->
    <!-- 7. PRACTICAL TESTS (ACTIVE S-BOXES)                          -->
    <!-- ============================================================ -->

    <section id="sec-7" class="mb-10">
      <h2 class="text-2xl font-bold">
        7. Practical Tests (Active S-Boxes)
      </h2>
      <p class="text-gray-300">
        This section proposes two algorithms: one for infinitely long
        invariant subspace trails with active S-boxes, and one for
        iterative trails. Several matrices are tested over
        <span class="math">\mathbb&#123;F&#125;_p</span> and
        <span class="math">\mathbb&#123;F&#125;_&#123;2^n&#125;</span>.
      </p>

      <h3 id="sec-7.1" class="text-xl font-semibold">
        7.1 Related Strategies in the Literature
      </h3>
      <p class="text-gray-300">
        The algorithms are based on the approach from [LMR15]. Given
        an SPN-like permutation, the goal is to find a subspace
        <span class="math">\mathcal&#123;U&#125;</span> and offset
        <span class="math">u</span> that is invariant under the
        keyless round function. The approach guesses a one-dimensional
        subspace and increases the space by computing
        <span class="math">\mathcal&#123;A&#125;_&#123;i+1&#125; = \langle R(\mathcal&#123;A&#125;_i + u) - v, \mathcal&#123;A&#125;_i \rangle</span>
        until stabilization.
      </p>

      <h3 id="sec-7.2" class="text-xl font-semibold">
        7.2 Algorithms for Detecting Weak Matrices
      </h3>
      <p class="text-gray-300">
        <strong>Algorithm 2</strong> (invariant trails with active
        S-boxes): For each non-empty subset
        <span class="math">I_s \subseteq \&#123;1, \ldots, s\&#125;</span>,
        start with the subspace generated by the unit vectors at
        active S-box positions. Keep including
        <span class="math">M^j \cdot e_i</span> to the space until
        stabilization. Runtime is
        <span class="math">\mathcal&#123;O&#125;(2^s \cdot s \cdot t)</span>.
      </p>
      <p class="text-gray-300">
        <strong>Algorithm 3</strong> (iterative trails with active
        S-boxes): Replaces the single set
        <span class="math">I_s</span> by
        <span class="math">l</span> potentially different sets
        <span class="math">I_1, \ldots, I_l</span>. Total runtime is
        <span class="math">\mathcal&#123;O&#125;(ls(2^s t + l))</span>.
      </p>

      <h3 id="sec-7.3" class="text-xl font-semibold">
        7.3 Percentage of Weak Linear Layers
      </h3>
      <p class="text-gray-300">
        Results across Algorithms 1, 2, and 3 show that the
        vulnerability percentages are generally small. A similar amount
        of matrices is vulnerable w.r.t. Algorithm 2 as w.r.t.
        Algorithm 1. Matrices vulnerable only to Algorithm 3 (but not
        1 or 2) are extremely rare (&lt; 0.01% in nearly all cases).
      </p>

      <div id="table-3" class="overflow-x-auto my-6">
        <p class="text-sm text-gray-400 mb-2">
          <strong>Table 3.</strong> Percentage of vulnerable matrices
          (Algorithms 1, 2, 3) over prime fields
          <span class="math">\mathbb&#123;F&#125;_p</span>.
          "V<em>x</em>" = vulnerable w.r.t. Algorithm <em>x</em>,
          "S<em>x</em>" = secure w.r.t. Algorithm <em>x</em>.
        </p>
        <table class="w-full text-sm">
          <thead>
            <tr class="border-b border-gray-700">
              <th class="text-left py-2 pr-4">
                <span class="math">\lceil\log_2(p)\rceil</span>
                / <span class="math">t</span>
              </th>
              <th class="text-left py-2 pr-4">8/3</th>
              <th class="text-left py-2 pr-4">4/4</th>
              <th class="text-left py-2 pr-4">6/4</th>
              <th class="text-left py-2 pr-4">16/4</th>
              <th class="text-left py-2 pr-4">8/8</th>
              <th class="text-left py-2 pr-4">12/8</th>
              <th class="text-left py-2 pr-4">16/8</th>
              <th class="text-left py-2">8/12</th>
            </tr>
          </thead>
          <tbody class="text-gray-300">
            <tr class="border-b border-gray-800">
              <td class="py-2 pr-4">V2 (Rand.)</td>
              <td class="py-2 pr-4">0.48</td>
              <td class="py-2 pr-4">8.94</td>
              <td class="py-2 pr-4">2.02</td>
              <td class="py-2 pr-4">&lt;0.01</td>
              <td class="py-2 pr-4">0.47</td>
              <td class="py-2 pr-4">0.03</td>
              <td class="py-2 pr-4">&lt;0.01</td>
              <td class="py-2">0.51</td>
            </tr>
            <tr class="border-b border-gray-800">
              <td class="py-2 pr-4">V2 &and; S1</td>
              <td class="py-2 pr-4">0.48</td>
              <td class="py-2 pr-4">7.46</td>
              <td class="py-2 pr-4">1.94</td>
              <td class="py-2 pr-4">&lt;0.01</td>
              <td class="py-2 pr-4">0.46</td>
              <td class="py-2 pr-4">0.03</td>
              <td class="py-2 pr-4">&lt;0.01</td>
              <td class="py-2">0.51</td>
            </tr>
            <tr class="border-b border-gray-800">
              <td class="py-2 pr-4">V2 &or; V1</td>
              <td class="py-2 pr-4">0.94</td>
              <td class="py-2 pr-4">16.41</td>
              <td class="py-2 pr-4">4.00</td>
              <td class="py-2 pr-4">&lt;0.01</td>
              <td class="py-2 pr-4">0.97</td>
              <td class="py-2 pr-4">0.06</td>
              <td class="py-2 pr-4">&lt;0.01</td>
              <td class="py-2">1.01</td>
            </tr>
            <tr class="border-b border-gray-800">
              <td class="py-2 pr-4">V3 &and; S2</td>
              <td class="py-2 pr-4">&lt;0.01</td>
              <td class="py-2 pr-4">0.01</td>
              <td class="py-2 pr-4">&lt;0.01</td>
              <td class="py-2 pr-4">&lt;0.01</td>
              <td class="py-2 pr-4">&lt;0.01</td>
              <td class="py-2 pr-4">&lt;0.01</td>
              <td class="py-2 pr-4">&lt;0.01</td>
              <td class="py-2">&lt;0.01</td>
            </tr>
          </tbody>
        </table>
      </div>
    </section>

    <!-- ============================================================ -->
    <!-- 8. SECURITY AGAINST INFINITELY LONG SUBSPACE TRAILS          -->
    <!-- ============================================================ -->

    <section id="sec-8" class="mb-10">
      <h2 class="text-2xl font-bold">
        8. Security Against Infinitely Long Subspace Trails
      </h2>
      <p class="text-gray-300">
        This section presents a sufficient condition on the matrix
        defining the linear layer that -- if satisfied -- ensures that
        no infinitely long (invariant/iterative) subspace trail
        (with/without active S-boxes) exists. The condition involves
        only the minimal polynomial of the matrix and is independent
        of the number of S-boxes per round.
      </p>

      <h3 id="sec-8.1" class="text-xl font-semibold">
        8.1 Sufficient Condition for Preventing Infinitely Long
        Subspace Trails
      </h3>

      <div class="formal-block formal-block-proposition">
        <div class="formal-block-title text-violet-400">
          Proposition 12
        </div>
        <div class="formal-block-content">
          <p class="text-sm text-gray-300">
            Let <span class="math">\phi</span> be the minimal
            polynomial of an invertible matrix
            <span class="math">M</span>. Assume
            <span class="math">\phi</span> is irreducible and let
            <span class="math">v \in \mathbb&#123;F&#125;^t \setminus \&#123;0\&#125;</span>.
            For each monic polynomial
            <span class="math">\phi'</span> such that
            <span class="math">\phi'(M) \cdot v = 0</span> and
            <span class="math">\deg(\phi') \leq \deg(\phi)</span>,
            it follows that
            <span class="math">\phi' = \phi</span>.
          </p>
        </div>
      </div>

      <div class="formal-block formal-block-proposition">
        <div class="formal-block-title text-violet-400">
          Proposition 13
        </div>
        <div class="formal-block-content">
          <p class="text-sm text-gray-300">
            Assume the S-box has no nontrivial linear structure. If
            the minimal polynomial <span class="math">\phi</span> of
            <span class="math">M</span> has maximum degree
            <span class="math">t</span> and is irreducible, there is
            no infinitely long invariant subspace trail with or without
            active S-boxes.
          </p>
        </div>
      </div>

      <div class="formal-block formal-block-theorem">
        <div class="formal-block-title text-green-400">
          Theorem 8
        </div>
        <div class="formal-block-content">
          <p class="text-sm text-gray-300">
            If all the minimal polynomials of
            <span class="math">M, M^2, \ldots, M^l</span> are of
            maximum degree <span class="math">t</span> and
            irreducible, then there is no infinitely long subspace
            trail with or without active S-boxes of period less than
            or equal to <span class="math">l</span>.
          </p>
        </div>
      </div>

      <p class="text-gray-300">
        <strong>Discussion.</strong> Given an irreducible polynomial
        <span class="math">\phi \in \mathbb&#123;F&#125;[x]</span> of
        degree <span class="math">t</span>, all matrices similar to
        the companion matrix of <span class="math">\phi</span> satisfy
        Proposition 13. The percentage of Cauchy MDS matrices
        satisfying this condition ranges from approximately 8% (for
        <span class="math">t = 12</span>) to over 33% (for
        <span class="math">t = 3</span>). Since this is only a
        sufficient condition, matrices that do not satisfy it may still
        be secure.
      </p>

      <h3 id="sec-8.2" class="text-xl font-semibold">
        8.2 Open Problems
      </h3>
      <ul class="list-disc list-inside text-gray-300 mb-4
        space-y-2">
        <li>
          Given a matrix for which no infinitely long subspace trail
          exists, how many rounds are needed to activate at least one
          S-box? Practical tests suggest
          <span class="math">t + \varepsilon</span> rounds for
          <span class="math">\varepsilon \in \&#123;0, 1\&#125;</span>.
        </li>
        <li>
          If the S-box has a nontrivial linear structure, the results
          for active S-boxes may be extendable.
        </li>
        <li>
          In the binary case, extending results to linear layers
          defined via linearized polynomials.
        </li>
      </ul>
    </section>

    <!-- ============================================================ -->
    <!-- APPENDIX A                                                   -->
    <!-- ============================================================ -->

    <section id="app-a" class="mb-10">
      <h2 class="text-2xl font-bold">
        Appendix A. Truncated Differentials and Subspace Trails
      </h2>
      <p class="text-gray-300">
        Differential attacks [BS91] exploit pairs of inputs with
        certain differences yielding other differences in the outputs
        with a non-uniform probability distribution. Truncated
        differential attacks [Knu94] predict only part of the
        difference. Using subspace terminology: given pairs of inputs
        in the same coset of
        <span class="math">\mathcal&#123;X&#125;</span>, one considers
        the probability that outputs belong to the same coset of
        <span class="math">\mathcal&#123;Y&#125;</span>.
      </p>
      <p class="text-gray-300">
        The proof of Proposition 10 shows that the subspace trail over
        the first
        <span class="math">\mathfrak&#123;R&#125;</span> rounds (no
        active S-boxes) can be extended by increasing the subspace
        dimension: at each subsequent round, the S-box outputs are
        absorbed into the subspace, adding
        <span class="math">s</span> dimensions per round. The trail
        persists for at least
        <span class="math">\mathfrak&#123;R&#125; + \lfloor (t-s)/s \rfloor</span>
        rounds total.
      </p>
    </section>

    <!-- ============================================================ -->
    <!-- APPENDIX B                                                   -->
    <!-- ============================================================ -->

    <section id="app-b" class="mb-10">
      <h2 class="text-2xl font-bold">
        Appendix B. Infinitely Long Iterative Subspace Trails with
        Active S-Boxes
      </h2>
      <p class="text-gray-300">
        <strong>Algorithm 3</strong> searches for iterative trails of
        maximum period <span class="math">l = 2t</span>. For each
        period <span class="math">r</span> from 2 to
        <span class="math">l</span>, and for each non-empty subset of
        S-box positions, Algorithm 2 is applied to
        <span class="math">M^r</span>. If a meaningful subspace
        <span class="math">\mathcal&#123;I&#125;</span> is found
        (i.e., not invariant under
        <span class="math">M</span> itself), the algorithm checks
        that
        <span class="math">M^j \cdot \mathcal&#123;I&#125;</span> is
        compatible with valid S-box positions at each step. Total
        runtime is
        <span class="math">\mathcal&#123;O&#125;(ls(2^s t + l))</span>.
      </p>
    </section>

    <!-- ============================================================ -->
    <!-- APPENDIX C                                                   -->
    <!-- ============================================================ -->

    <section id="app-c" class="mb-10">
      <h2 class="text-2xl font-bold">
        Appendix C. Results Using the Tool and More Examples
      </h2>
      <p class="text-gray-300">
        <strong>C.1 Starkad and Poseidon Matrices.</strong> The
        Cauchy matrices from the Starkad and Poseidon specifications
        were tested. The Starkad matrix
        <span class="math">M'</span> over
        <span class="math">\mathbb&#123;F&#125;_&#123;2^n&#125;</span>
        and the Poseidon matrix
        <span class="math">M''</span> over
        <span class="math">\mathbb&#123;F&#125;_p</span> are defined
        as
        <span class="math">M'_&#123;i,j&#125; = 1/(x_i \oplus y_j)</span>
        and
        <span class="math">M''_&#123;i,j&#125; = 1/(x_i + y_j)</span>
        where
        <span class="math">x_i = i, y_i = i + t</span>.
      </p>

      <div id="table-6" class="overflow-x-auto my-6">
        <p class="text-sm text-gray-400 mb-2">
          <strong>Table 6.</strong> Vulnerable matrices (Algorithm 1)
          for Starkad and Poseidon specifications.
        </p>
        <table class="w-full text-sm">
          <thead>
            <tr class="border-b border-gray-700">
              <th class="text-left py-2 pr-4">Spec</th>
              <th class="text-left py-2 pr-4">
                <span class="math">t</span>=3
              </th>
              <th class="text-left py-2 pr-4">
                <span class="math">t</span>=4
              </th>
              <th class="text-left py-2 pr-4">
                <span class="math">t</span>=8
              </th>
              <th class="text-left py-2">
                <span class="math">t</span>=12
              </th>
            </tr>
          </thead>
          <tbody class="text-gray-300">
            <tr class="border-b border-gray-800">
              <td class="py-2 pr-4">
                Poseidon
                (<span class="math">\mathbb&#123;F&#125;_p</span>)
              </td>
              <td class="py-2 pr-4">No</td>
              <td class="py-2 pr-4">No</td>
              <td class="py-2 pr-4">No</td>
              <td class="py-2">No</td>
            </tr>
            <tr class="border-b border-gray-800">
              <td class="py-2 pr-4">
                Starkad
                (<span class="math">\mathbb&#123;F&#125;_&#123;2^n&#125;</span>)
              </td>
              <td class="py-2 pr-4">No</td>
              <td class="py-2 pr-4">Yes</td>
              <td class="py-2 pr-4">Yes</td>
              <td class="py-2">Yes</td>
            </tr>
          </tbody>
        </table>
      </div>

      <p class="text-gray-300">
        These results confirm findings from [KR21,
        BCD<sup>+</sup>20]. The fix proposed in [KR21] (changing
        starting sequences for Cauchy generation) produces matrices
        with no infinitely long subspace trails.
      </p>
      <p class="text-gray-300">
        <strong>C.2 Zorro Matrix.</strong> The Zorro matrix (a P-SPN
        over
        <span class="math">(\mathbb&#123;F&#125;_&#123;2^8&#125;)^&#123;16&#125;</span>
        with <span class="math">s = 4</span>) was also evaluated. No
        infinitely long (iterative or invariant) subspace trail was
        found, neither with nor without active S-boxes. The known
        attacks on Zorro exploit differentials with higher-than-expected
        probability, not infinitely long subspace trails.
      </p>
    </section>

    <!-- ============================================================ -->
    <!-- REFERENCES                                                   -->
    <!-- ============================================================ -->

    <section id="references" class="mb-10">
      <h2 class="text-2xl font-bold">References</h2>
      <ul class="text-sm text-gray-400 space-y-2">
        <li>
          [AAB<sup>+</sup>20] Aly, Ashur, Ben-Sasson, Dhooghe,
          Szepieniec.
          <em>Design of Symmetric-Key Primitives for Advanced
          Cryptographic Protocols</em>. IACR Trans. Symmetric
          Cryptol. 2020(3):1-45.
        </li>
        <li>
          [ABL12] Abdelraheem, gren, Beelen, Leander.
          <em>On the Distribution of Linear Biases: Three Instructive
          Examples</em>. CRYPTO 2012, LNCS 7417, pp. 50-67.
        </li>
        <li>
          [AD18] Ashur, Dhooghe.
          <em>MARVELlous: a STARK-Friendly Family of Cryptographic
          Primitives</em>. ePrint 2018/1098.
        </li>
        <li>
          [AGP<sup>+</sup>19] Albrecht, Grassi, Perrin, Ramacher,
          Rechberger, Rotaru, Roy, Schofnegger.
          <em>Feistel Structures for MPC, and More</em>. ESORICS
          2019, LNCS 11736, pp. 151-171.
        </li>
        <li>
          [AGR<sup>+</sup>16] Albrecht, Grassi, Rechberger, Roy,
          Tiessen.
          <em>MiMC: Efficient Encryption and Cryptographic Hashing
          with Minimal Multiplicative Complexity</em>. ASIACRYPT
          2016, LNCS 10031, pp. 191-219.
        </li>
        <li>
          [ARS<sup>+</sup>15] Albrecht, Rechberger, Schneider,
          Tiessen, Zohner.
          <em>Ciphers for MPC and FHE</em>. EUROCRYPT 2015, LNCS
          9056, pp. 430-454.
        </li>
        <li>
          [BBI<sup>+</sup>15] Banik et al.
          <em>Midori: A Block Cipher for Low Energy</em>.
          ASIACRYPT 2015, LNCS 9453, pp. 411-436.
        </li>
        <li>
          [BCD<sup>+</sup>20] Beyne, Canteaut, Dinur, Eichlseder,
          Leander, Leurent, Naya-Plasencia, Perrin, Sasaki, Todo,
          Wiemer.
          <em>Out of Oddity -- New Cryptanalytic Techniques Against
          Symmetric Primitives Optimized for Integrity Proof
          Systems</em>. CRYPTO 2020, LNCS 12172, pp. 299-328.
        </li>
        <li>
          [BCLR17] Beierle, Canteaut, Leander, Rotella.
          <em>Proving Resistance Against Invariant Attacks</em>.
          CRYPTO 2017, LNCS 10402, pp. 647-678.
        </li>
        <li>
          [BDD<sup>+</sup>15] Bar-On, Dinur, Dunkelman, Lallemand,
          Keller, Tsaban.
          <em>Cryptanalysis of SP Networks with Partial Non-Linear
          Layers</em>. EUROCRYPT 2015, LNCS 9056, pp. 315-342.
        </li>
        <li>
          [Bey18] Beyne.
          <em>Block Cipher Invariants as Eigenvectors of Correlation
          Matrices</em>. ASIACRYPT 2018, LNCS 11272, pp. 3-31.
        </li>
        <li>
          [BS91] Biham, Shamir.
          <em>Differential Cryptanalysis of DES-like
          Cryptosystems</em>. J. Cryptology 4(1):3-72.
        </li>
        <li>
          [CCF<sup>+</sup>18] Canteaut, Carpov, Fontaine, Lepoint,
          Naya-Plasencia, Paillier, Sirdey.
          <em>Stream Ciphers: A Practical Solution for Efficient
          Homomorphic-Ciphertext Compression</em>. J. Cryptology
          31(3):885-916.
        </li>
        <li>
          [DEG<sup>+</sup>18] Dobraunig, Eichlseder, Grassi,
          Lallemand, Leander, List, Mendel, Rechberger.
          <em>Rasta: A Cipher with Low ANDdepth and Few ANDs per
          Bit</em>. CRYPTO 2018, LNCS 10991, pp. 662-692.
        </li>
        <li>
          [DGGK19] Dobraunig, Grassi, Guinet, Kuijsters.
          <em>Ciminion: Symmetric Encryption Based on Toffoli-Gates
          over Large Finite Fields</em>. EUROCRYPT 2021.
        </li>
        <li>
          [DLMW15] Dinur, Liu, Meier, Wang.
          <em>Optimized Interpolation Attacks on LowMC</em>.
          ASIACRYPT 2015, LNCS 9453, pp. 535-560.
        </li>
        <li>
          [DPAR00] Daemen, Peeters, Van Assche, Rijmen.
          <em>Nessie Proposal: NOEKEON</em>. 2000.
        </li>
        <li>
          [DR02] Daemen, Rijmen.
          <em>AES and the Wide Trail Design Strategy</em>.
          EUROCRYPT 2002, LNCS 2332, pp. 108-109.
        </li>
        <li>
          [GGNPS13] Gerard, Grosso, Naya-Plasencia, Standaert.
          <em>Block Ciphers That Are Easier to Mask</em>. CHES
          2013, LNCS 8086, pp. 383-399.
        </li>
        <li>
          [GKR<sup>+</sup>21] Grassi, Khovratovich, Rechberger,
          Roy, Schofnegger.
          <em>Poseidon: A New Hash Function for Zero-Knowledge Proof
          Systems</em>. USENIX Security 2021.
        </li>
        <li>
          [GLR<sup>+</sup>20a] Grassi, Leander, Rechberger, Tezcan,
          Wiemer.
          <em>Weak-Key Distinguishers for AES</em>. SAC 2020.
        </li>
        <li>
          [GLR<sup>+</sup>20b] Grassi, Luftenegger, Rechberger,
          Rotaru, Schofnegger.
          <em>On a Generalization of Substitution-Permutation
          Networks: The HADES Design Strategy</em>. EUROCRYPT 2020,
          LNCS 12106, pp. 674-704.
        </li>
        <li>
          [GLSV14] Grosso, Leurent, Standaert, Varici.
          <em>LS-Designs: Bitslice Encryption for Efficient Masked
          Software Implementations</em>. FSE 2014, LNCS 8540.
        </li>
        <li>
          [GRR16a] Grassi, Rechberger, Ronjom.
          <em>Subspace Trail Cryptanalysis and its Applications to
          AES</em>. IACR Trans. Symmetric Cryptol. 2016(2):192-225.
        </li>
        <li>
          [GRR17] Grassi, Rechberger, Ronjom.
          <em>A new structural-differential property of 5-round
          AES</em>. EUROCRYPT 2017, LNCS 10211, pp. 289-317.
        </li>
        <li>
          [Hog16] Hogben.
          <em>Handbook of Linear Algebra</em>. CRC Press, 2nd ed.
        </li>
        <li>
          [Kai08] Kaiser.
          <em>Advanced Linear Algebra</em>. 2008.
        </li>
        <li>
          [Knu94] Knudsen.
          <em>Truncated and Higher Order Differentials</em>. FSE
          1994, LNCS 1008, pp. 196-211.
        </li>
        <li>
          [KR21] Keller, Rosemarin.
          <em>Mind the Middle Layer: The HADES Design Strategy
          Revisited</em>. EUROCRYPT 2021.
        </li>
        <li>
          [LAAZ11] Leander, Abdelraheem, AlKhzaimi, Zenner.
          <em>A Cryptanalysis of PRINTcipher: The Invariant Subspace
          Attack</em>. CRYPTO 2011, LNCS 6841, pp. 206-221.
        </li>
        <li>
          [LMR15] Leander, Minaud, Ronjom.
          <em>A Generic Approach to Invariant Subspace Attacks</em>.
          EUROCRYPT 2015, LNCS 9056, pp. 254-283.
        </li>
        <li>
          [LTW18] Leander, Tezcan, Wiemer.
          <em>Searching for Subspace Trails and Truncated
          Differentials</em>. IACR Trans. Symmetric Cryptol.
          2018(1):74-100.
        </li>
        <li>
          [Mat93] Matsui.
          <em>Linear Cryptanalysis Method for DES Cipher</em>.
          EUROCRYPT 1993, LNCS 765, pp. 386-397.
        </li>
        <li>
          [MJSC16] Meaux, Journault, Standaert, Carlet.
          <em>Towards Stream Ciphers for Efficient FHE with
          Low-Noise Ciphertexts</em>. EUROCRYPT 2016, LNCS 9665.
        </li>
        <li>
          [PRC12] Piret, Roche, Carlet.
          <em>PICARO -- A Block Cipher Allowing Efficient
          Higher-Order Side-Channel Resistance</em>. ACNS 2012.
        </li>
        <li>
          [PW20] Peyrin, Wang.
          <em>The MALICIOUS Framework: Embedding Backdoors into
          Tweakable Block Ciphers</em>. CRYPTO 2020.
        </li>
        <li>
          [Sto98] Storjohann.
          <em>An O(<span class="math">n^3</span>) algorithm for the Frobenius normal
          form</em>. ISSAC 1998, pp. 101-105.
        </li>
        <li>
          [TLS16] Todo, Leander, Sasaki.
          <em>Nonlinear Invariant Attack</em>. ASIACRYPT 2016, LNCS
          10032, pp. 3-33.
        </li>
        <li>
          [WWGY14] Wang, Wu, Guo, Yu.
          <em>Differential Cryptanalysis and Linear Distinguisher of
          Full-Round Zorro</em>. ACNS 2014, LNCS 8479, pp. 308-323.
        </li>
        <li>
          [YMT97] Youssef, Mister, Tavares.
          <em>On the Design of Linear Transformations for
          Substitution Permutation Encryption Networks</em>. SAC
          1996, pp. 40-48.
        </li>
      </ul>
    </section>

  </article>
</BaseLayout>
