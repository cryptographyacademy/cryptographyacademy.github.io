---
import BaseLayout from '../../layouts/BaseLayout.astro';

const EPRINT_URL = 'https://eprint.iacr.org/2015/481';
const CRAWLER = 'mistral';
const CONVERTED_DATE = '2026-02-16';
const TITLE_HTML = 'Advanced Differential Cryptanalysis of Reduced-Round SIMON64/128 Using Large-Round Statistical Distinguishers';
const AUTHORS_HTML = 'Theodosis Mourouzis, Guangyan Song, Nicolas Courtois, Michalis Christofii';

const CONTENT = `    <p class="text-gray-300">Theodosis Mourouzis^{1}, Guangyan Song^{1}, Nicolas Courtois ^{1} and Michalis Christofi ^{2} ^{1}Department of Computer Science, University College London, London, United Kingdom ^{2}Department of Informatics, Kingâ€™s College London, London, United Kingdom {tmourouz, g.song,n.<span class="math">\\dot{c}</span>ourtois}@cs.ucl.ac.uk, mc556@kings.ac.uk</p>

    <h6 id="sec-2" class="text-base font-medium mt-4">Abstract</h6>

    <p class="text-gray-300">lightweight cryptography, hardware performance, multiplicative complexity, internet of things (IoT), block-ciphers, Feistel Network, SIMON, differential cryptanalysis, truncated differentials, statistical distinguisher, Type I Error, Type II error, Gauss Error Function, depth-first search</p>

    <p class="text-gray-300">Abstract: Lightweight cryptography is a rapidly evolving area of research and it has great impact especially on the new computing environment called the Internet of Things (IoT) or the Smart Object networks <em>(Holler et al., 2014)</em>, where lots of constrained devices are connected on the Internet and exchange information on a daily basis. Every year there are many new submissions of cryptographic primitives which are optimized towards both software and hardware implementation so that they can operate in devices which have limited resources of hardware and are subject to both power and energy consumption constraints. In 2013, two families of ultra-lightweight block ciphers were proposed, SIMON and SPECK, which come in a variety of block and key sizes and were designed to be optimized in hardware and software implementation respectively <em>(Beaulieu et al., 2013)</em>. In this paper, we study the security of the 64-bit SIMON with 128-bit key against advanced forms of differential cryptanalysis using truncated differentials <em>(Knudsen, 1995; Courtois et al., 2014a)</em>. We follow similar method as the one proposed in SECRYPT 2013 <em>(Courtois and Mourouzis, 2013)</em> in order to heuristically discover sets of differences that propagate with sufficiently good probability and allow us to combine them efficiently in order to construct large-round statistical distinguishers. We present a 22-round distinguisher which we use it in a depth-first key search approach to develop an attack against 24 and 26 rounds with complexity <span class="math">2^{124.5}</span> and <span class="math">2^{126}</span> SIMON encryptions respectively. Our methodology provides a framework for extending distinguishers to attacks to a larger number of rounds assuming truncated differential properties of relatively high probability were discovered.</p>

    <h2 id="sec-3" class="text-2xl font-bold">1 INTRODUCTION</h2>

    <p class="text-gray-300">The new computing environment of Internet of Things (IoT) is the network of physical objects embedded with electronics, software, sensors and connectivity to achieve greater value and user experience <em>(Holler et al., 2014; Mark, 2014)</em>. All these inter-connected devices will exchange lots of data with the manufacturer or operator or any other connected device in a daily basis in order to improve performance and decrease power consumption. On the same time all these data will be aggregated and being used for building fault prediction models and other models that could be used to benefit our the experience.</p>

    <p class="text-gray-300">In order to enjoy this new environment we need to guarantee the security of the nodes of the network up to a desired level. The challenge in this space lies in the implementation of secure enough cryptographic functions on constrained devices due to the limitation of their resources such as hardware availability and power and energy consumption constraints. Lightweight cryptography is the area of cryptography which aims to develop more efficient cryptographic primitives in response to typical constraints in hardware and optimized towards both power and energy consumption. As a result of this great demand of optimizing the performance, every year there are many submissions of lightweight cryptosystems which are designed towards both hardware and software implementation.</p>

    <p class="text-gray-300">In July 2013, a team of cryptographers from National Security Agency (NSA) has proposed two new interesting lightweight block ciphers, SIMON and SPECK <em>(Beaulieu et al., 2013)</em>. Both ciphers come in a variety of block and key sizes and were designed towards optimization in hardware and software re</p>

    <p class="text-gray-300">spectively. In the same paper there was no advanced analysis of the security of these ciphers against well-known cryptanalytic attacks such as differential, linear and algebraic cryptanalysis. In the same year of submission, we had many different attacks against reduced-round versions of both ciphers such as; differential cryptanalysis, linear cryptanalysis, impossible differentials and combined differential algebraic techniques (cf. Table 1 and Table 2).</p>

    <p class="text-gray-300">It is very important to note that SIMON has very low multiplicative complexity, 32 multiplications per round, which implies low non-linearity. Courtois et al demonstrated that several rounds (10/44) of this cipher can be attacked by pure algebraic attacks without even guessing any key bits (Courtois et al., 2014b). This is somehow reconfirms the heuristical approach that multiplicative complexity reduction can reduce the complexity of the underlying algebraic system and thus a solution can be recovered by a solver software, such as a SAT solver, in a more reasonable time (Courtois and Bard, 2007; Courtois et al., 2011).</p>

    <p class="text-gray-300">Table 1: Cryptanalysis of SIMON64/128</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Authors</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Rounds</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Time</th>

          </tr>

        </thead>

        <tbody>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">(Alkhzaimi and Lauridsen, 2013)</td>

            <td class="px-3 py-2 border-b border-gray-700">26</td>

            <td class="px-3 py-2 border-b border-gray-700">294</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">(Farzaneh et al., 2013)</td>

            <td class="px-3 py-2 border-b border-gray-700">24</td>

            <td class="px-3 py-2 border-b border-gray-700">258.4</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">(Farzaneh et al., 2013)</td>

            <td class="px-3 py-2 border-b border-gray-700">16</td>

            <td class="px-3 py-2 border-b border-gray-700">292.0</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">(Courtois et al., 2014b)</td>

            <td class="px-3 py-2 border-b border-gray-700">10</td>

            <td class="px-3 py-2 border-b border-gray-700">298.8</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">This paper</td>

            <td class="px-3 py-2 border-b border-gray-700">26</td>

            <td class="px-3 py-2 border-b border-gray-700">2126</td>

          </tr>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">Table 2: Type of attacks against SIMON64/128</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Authors</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Type</th>

          </tr>

        </thead>

        <tbody>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">(Alkhzaimi and Lauridsen, 2013)</td>

            <td class="px-3 py-2 border-b border-gray-700">Differential</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">(Farzaneh et al., 2013)</td>

            <td class="px-3 py-2 border-b border-gray-700">Differential</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">(Farzaneh et al., 2013)</td>

            <td class="px-3 py-2 border-b border-gray-700">Imp-Diff</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">(Courtois et al., 2014b)</td>

            <td class="px-3 py-2 border-b border-gray-700">Alg-Trunc</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">This paper</td>

            <td class="px-3 py-2 border-b border-gray-700">Trunc</td>

          </tr>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">In this paper, we evaluate the security of 64-bit version of SIMON with 128-bit key against advanced forms of differential cryptanalysis using large-round statistical distinguishers. We employ a simple heuristical approach in order to discover truncated differential properties that hold with sufficiently high probability, similar to the method proposed in (Courtois and Mourouzis, 2013; Courtois et al., 2014a). Our heuristical approach includes analysis of patterns of several transitions of low Hamming-distance pairs.</p>

    <p class="text-gray-300">We manage to construct a 22-round distinguisher by combining several truncated differential properties and then we use this distinguisher to attack 24 and 26 rounds of the cipher in a depth-first search style approach as proposed in (Mourouzis, 2014). This</p>

    <p class="text-gray-300">method involves several key guessing for several outer rounds and measuring the number of plaintext and ciphertext pairs that follow the specified input-output differences of the statistical distinguisher.</p>

    <p class="text-gray-300">The rest of this paper is organized as follows:</p>

    <ul class="list-disc list-inside space-y-1 text-gray-300 my-2 ml-4">

      <li>Section 2: We provide an introduction to SIMON cipher and we study especially its round function and key schedule algorithm for the particular 64-bit version.</li>

      <li>Section 3: We provide an introduction to differential cryptanalysis and in particular truncated differentials.</li>

      <li>Section 4: We discuss construction of large-round statistical distinguishers using truncated differential properties.</li>

      <li>Section 5: We present a 22-round distinguisher for SIMON64/128.</li>

      <li>Section 6: We mount a differential attacks against 24 and 26 rounds of SIMON using statistical distinguishers.</li>

      <li>Section 7: Conclusions and Future Research</li>

    </ul>

    <p class="text-gray-300">SIMON is a lightweight block cipher designed by NSA. with the aim to have optimal hardware performance (Beaulieu et al., 2013). It follows the classical Feistel design paradigm and operates on two  <span class="math">n</span> -bit halves in each round.</p>

    <p class="text-gray-300">Each round of SIMON applies a non-linear, non-bijective function  <span class="math">F:GF(2)^n\\to GF(2)^n</span>  to the left half of the state which is repeated for 44 rounds. The operations used are as follows:</p>

    <ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">

      <li>bitwise XOR,</li>

      <li>bitwise AND and</li>

      <li>left circular shift,  <span class="math">S^j</span>  by  <span class="math">j</span>  bits.</li>

    </ol>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">We denote the input to the  <span class="math">i</span> -th round by  $L^{i-1}</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">R^{i-1}<span class="math">  and in each round the left word  </span>L^{i-1}<span class="math">  is used as input to the round function  </span>\\mathbf{F}$  defined by,</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <div class="my-4 text-center"><span class="math-block">F \\left(L ^ {i - 1}\\right) = \\left(L ^ {i - 1} &amp;lt;   &amp;lt;   &amp;lt;   1\\right). \\left(L ^ {i - 1} &amp;lt;   &amp;lt;   &amp;lt;   8\\right) \\oplus \\left(L ^ {i - 1} &amp;lt;   &amp;lt;   &amp;lt;   2\\right), \\tag {1}</span></div>

    <p class="text-gray-300">where . is the bitwise AND operator.</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">The next state  $L_{i}</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">R_{i}$  is computed in the following way (cf. Figure 1),</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <div class="my-4 text-center"><span class="math-block">L ^ {i} = R ^ {i - 1} \\oplus F \\left(L ^ {i - 1}\\right) \\oplus K ^ {i - 1} \\tag {2}</span></div>

    <div class="my-4 text-center"><span class="math-block">R ^ {i} = L ^ {i - 1} \\tag {3}</span></div>

    <p class="text-gray-300">!<a href="img-0.jpeg">img-0.jpeg</a> Figure 1: The round function of the SIMON block cipher.</p>

    <p class="text-gray-300">The output of the last round is the ciphertext after applying the round function for 44 times for the particular variant SIMON64/128.</p>

    <p class="text-gray-300">Note that SIMON cipher has a very low multiplicative complexity since the only non-linear part is the bitwise multiplication, resulting in 32 multiplications per round. Multiplicative complexity is known to be a measure of non-linearity and hence a (heuristic) measure against resistance to known forms of cryptanalytics attacks against hash functions (Boyar et al., 2013) and block ciphers (Courtois et al., 2011).</p>

    <p class="text-gray-300">SIMON's key schedule is based on an LSFR-like procedure (cf. Figure 2). The <span class="math">nm</span>-bits of the key are used to generate the keys <span class="math">K_{0}, K_{1}, \\ldots, K_{r-1}</span> to be used as round keys. There are three different key schedule procedures depending on the number of words that the secret key consists of (<span class="math">m = 2, 3, 4</span>). In the particular version of the cipher we study, we are interested in the version where <span class="math">m = 4</span>.</p>

    <p class="text-gray-300">Furthermore, at the beginning <span class="math">K^0, K^1, \\ldots, K^{m-1}</span> are initialized keys, while the remaining are generated by the LSFR-like construction which is depicted on Figure 2. For the variant of our interest, where <span class="math">m = 4</span>, the rest of the keys are generated as follows:</p>

    <div class="my-4 text-center"><span class="math-block">Y = K ^ {i + 1} \\oplus \\left(K ^ {i + 3} &amp;gt; &amp;gt; &amp;gt; 3\\right) \\tag {4}</span></div>

    <div class="my-4 text-center"><span class="math-block">K ^ {i + 4} = K ^ {i} \\oplus Y \\oplus (Y &amp;gt; &amp;gt; &amp;gt; 1) \\oplus c \\oplus (z _ {j}) _ {i} \\tag {5}</span></div>

    <p class="text-gray-300">The constant <span class="math">c = 0xff\\ldots fc</span> is used for preventing slide attacks and attacks exploiting rotational symmetries (Beaulieu et al., 2013).</p>

    <p class="text-gray-300">In addition, the generated subkeys are xored with a bit (zj)i, that denotes the i-th bit from the one of the five constant sequences <span class="math">z_0,\\dots,z_4</span>. These sequences are defined in (Beaulieu et al., 2013) and for our variant we use <span class="math">z_{3}</span>.</p>

    <p class="text-gray-300">The way that the key schedule operates it implies that if we recover lots of key bits from the very first</p>

    <p class="text-gray-300">rounds, then we have higher chances of recovering next bits since they are generated in a LSFR-like approach. In the methodology we describe in the next sections we focus on recovering several key bits from the very first rounds of encryption.</p>

    <p class="text-gray-300">!<a href="img-1.jpeg">img-1.jpeg</a> Figure 2: The SIMON two, three and four-word key expansions.</p>

    <p class="text-gray-300">Differential Cryptanalysis is a general form of probabilistic or statistical cryptanalytic technique that is primarily applicable to block ciphers but also to stream ciphers and cryptographic hash functions. It belongs to the category of chosen-plaintext attacks and its discovery was attributed to Eli Biham and Adi Shamir in the later 1980s (Biham and Shamir, 1993; Biham and Shamir, 1990).</p>

    <p class="text-gray-300">However, around 1994, Don Coppersmith as a member pf the original IBM DES team, confirmed that the technique of DC was known to IBM, as early as 1974. In addition, he said that one of the security criteria used to design DES was the resistance against this particular type of attack and this attack was known as T-attack or Tickle attack.</p>

    <p class="text-gray-300">In this type of attack, the main task is to study the propagation of differences of inputs from round to round inside the cipher, and discover specific differences that propagate with comparatively higher prob</p>

    <p class="text-gray-300">ability as the probability expected assuming a uniform distribution. In this way, an attacker discovers where the cipher exhibits non-random behavior and by exploiting these properties further can recover parts of the secret key or the full key with time complexity lower than an exhaustive search on the key length which is the reference time complexity in case of block ciphers.</p>

    <p class="text-gray-300">In differential attacks, the first task is to find series of input and output differences over several rounds, which appear with relatively high probability. For each pair of input-output difference, we need to determine the probability of propagation for each round individually. For the linear components, we can predict the propagation of the difference with probability one. However, in non-linear components, such as S-boxes, a probabilistic analysis is needed.</p>

    <p class="text-gray-300">!<a href="img-2.jpeg">img-2.jpeg</a> Figure 3: The diagram on the left illustrates the propagation of differences  <span class="math">(0),(1),\\ldots,(r)</span>  through different rounds, which is called differential characteristic. The diagram on the right illustrates a differential, where only input-output differences are considered, while middle differences are ignored.</p>

    <p class="text-gray-300">!<a href="img-3.jpeg">img-3.jpeg</a></p>

    <p class="text-gray-300">We can either construct round to round paths and join them together to form a larger round differential characteristic or we can search directly for specific input-output differences after a certain number of rounds and this is called differential. Figure 3 illustrates both differential characteristic and differential.</p>

    <p class="text-gray-300">Truncated Differential Cryptanalysis is a generalization of differential cryptanalysis developed by Lars Knudsen (Knudsen, 1995). Usually, in DC we study the propagation of single differences between two plaintexts, while in truncated DC we consider differences that are partially determined (i.e we are interested only in some parts of the difference). This technique has been successfully applied to many block ciphers such as SAFER, IDEA, Skipjack, Twofish and many others. We define the truncation  <span class="math">TRUNC(a)</span>  of a  <span class="math">n</span> -bit string  <span class="math">a</span>  as in Definition 1.</p>

    <p class="text-gray-300">Let  <span class="math">a = a_0a_1\\ldots a_{n - 1}</span>  be an  <span class="math">n</span> -bit string, then its truncation is the  <span class="math">n</span> -bit string  <span class="math">b</span>  given by  <span class="math">b_{0}b_{1}\\dots b_{n - 1} = TRUNC(a_{0}a_{1}\\dots a_{n - 1})</span> , where either  <span class="math">b_{i} = a_{i}</span>  or  <span class="math">b_{i} = <em></span> , for all  <span class="math">0\\leq i\\leq n - 1</span>  and  <span class="math"></em></span>  is an unknown value</p>

    <p class="text-gray-300">The notion of truncated differentials (cf. Definition 2) extends naturally to differences.</p>

    <p class="text-gray-300">Definition 2. (Truncated Differentials, (Knudsen, 1995))</p>

    <p class="text-gray-300">Let  <span class="math">(\\alpha, \\beta)</span>  be an  <span class="math">i</span> -round differential, then if  <span class="math">\\alpha&#x27;</span>  and  <span class="math">\\beta&#x27;</span>  are truncations of  <span class="math">\\alpha</span>  and  <span class="math">\\beta</span>  respectively, then  <span class="math">(\\alpha&#x27;, \\beta&#x27;)</span>  is an  <span class="math">i</span> -round truncated differential.</p>

    <p class="text-gray-300">Remark 1. Note that we need to exclude the zero difference from our set.</p>

    <p class="text-gray-300">Example 1. The truncated differential on 8 bytes of the form  <span class="math">0000000000 <em> 00000</span>  (in hexadecimal representation), where  <span class="math"></em> = x_{1}x_{2}x_{3}x_{4}</span> , is a set of differences of size  <span class="math">16 - 1</span>  (excluding the zero difference).</p>

    <p class="text-gray-300">Given an  <span class="math">s</span> -round characteristic  <span class="math">\\Delta_0 \\to \\Delta_1 \\to \\ldots \\to \\Delta_s</span> , then  <span class="math">\\Delta_0&#x27; \\to \\Delta_1&#x27; \\to \\ldots \\to \\Delta_s&#x27;</span>  is a truncated characteristic, if  <span class="math">\\Delta_i&#x27; = TRUNC(\\Delta_i)</span>  for  <span class="math">0 \\leq i \\leq s</span> . A truncated characteristic predicts only part of the difference in a pair of texts after each round of encryption. A truncated differential is a collection of truncated characteristics. Truncated differentials proved to be a very useful cryptanalytic tool against many block ciphers which at first glance seem secure against basic differential cryptanalysis.</p>

    <p class="text-gray-300">In the next section we employ a simple heuristic discovery algorithm for discovering truncated differential properties which propagate with sufficiently high probability. In a later stage we combine these properties to construct a large round distinguisher which we use to mount a differential attack on a larger number of rounds.</p>

    <h4 id="sec-9" class="text-lg font-semibold mt-6">4.0.2 Hypothesis Testing</h4>

    <p class="text-gray-300">In cryptanalysis, we very often study the problem of distinguishing distributions, one distribution that describes the variable of the number of certain events that occur at random and another distribution that describes the same variable but due to propagation inside the cipher. Thus, we would like to design a clever distinguisher which would be able to distinguish a given a cipher from a random permutation by capturing as much as possible of its mathematical structure. Such a distinguishing attack might reveal information which can be used to reduce the space of the key candidates and thus lead to an attack faster than exhaustive search. In cryptographic literature, there are several examples of succesful attacks against either the full block cipher or some reduced-round version or more frequently against stream ciphers.</p>

    <p class="text-gray-300">Thus, this can be seen as a hypothesis testing problem of distinguishing the two distributions as shown in Figure 2. Suppose that a source is used to generate independent random samples in some given finite set with some distribution <span class="math">\\mathcal{P}</span>, which is either <span class="math">\\mathcal{P}=\\mathcal{P}_{0}</span> or <span class="math">\\mathcal{P}=\\mathcal{P}_{1}</span>. A distinguisher is a construction used to determine which one is the most likely the one which was used to generate the sample. Hence, the overall attack based on the distinguishers considers the following underlying statistical hypothesis testing problem, where we have either a null hypothesis <span class="math">H_{0}:\\mathcal{P}=\\mathcal{P}_{0}</span> or an alternative hypothesis <span class="math">H_{1}:\\mathcal{P}=\\mathcal{P}_{1}</span>.</p>

    <p class="text-gray-300">Our scope is to study this hypothesis problem applied to differential cryptanalysis and its variants. The variable of our interest is the number of plaintext pairs whose output difference after <span class="math">r</span> rounds lies in a particular truncated differential set <span class="math">\\Delta Y</span> given that their difference lies in another truncated differential set <span class="math">\\Delta X</span>. We aim to use particular sets of differences which capture the mathematical structure of the cipher and these are known as general open sets and we described them in the previous section.</p>

    <p class="text-gray-300">Assuming that we have two random variables <span class="math">\\mathcal{W}</span> and <span class="math">\\mathcal{R}</span> which are described by Gaussian distributions with parameters <span class="math">(E(W),V(W))</span> and <span class="math">(E(R),V(R))</span> respectively. Our task is given a measurement of the variable of our interest to determine from which distribution this sample is more likely to be taken. Thus, we have the following hypothesis testing problem, <span class="math">H_{0}:P=\\mathcal{W}</span> and <span class="math">H_{1}:P=\\mathcal{R}</span>. For cryptanalytic purposes, we assume that distribution <span class="math">\\mathcal{W}</span> corresponds to a wrong key, while <span class="math">\\mathcal{R}</span> corresponds to the right key. In case of a Gaussian distribution, the probability density function of distribution <span class="math">\\mathcal{W}</span> is given by the following equation,</p>

    <p class="text-gray-300"><span class="math">f_{\\mathcal{W}}(x)=\\frac{1}{\\sqrt{2\\pi V(W)}}exp^{-\\frac{1}{2V(W)}(x-E(W))^{2}}.</span> (6)</p>

    <p class="text-gray-300">Assume that we were given a sample <span class="math">P</span> from which we can observe <span class="math">x</span> events of our interest, in the particular case of differential cryptanalysis is the number of pairs which follow the differential <span class="math">\\alpha\\rightarrow\\beta</span> after <span class="math">r</span> rounds. Then, from Figure 2 we observe that if <span class="math">x</span> is greater than <span class="math">E(R)</span> then we can assume that that this observation corresponds to the right key with probability set to <span class="math">\\frac{1}{2}</span>. On the other hand, the probability of a false positive, for example accepting the key as correct while it is wrong, which is also known as Type I error, is represented by the red-shaded region in Figure 4 and given by the following formulae,</p>

    <p class="text-gray-300"><span class="math">P(\\mathcal{W}&amp;gt;\\mathcal{R})=\\int_{E(R)}^{\\infty}f_{\\mathcal{W}}(x)dx=\\frac{1}{2}(1-erf(\\frac{E(R)-E(W)}{\\sqrt{2V(W)}})</span> (7)</p>

    <p class="text-gray-300">where <span class="math">erf(x)</span> is the Gaussian error function given by</p>

    <p class="text-gray-300"><span class="math">erf(x)=\\frac{2}{\\sqrt{\\pi}}\\int_{0}^{x}exp^{-t^{2}}dt.</span> (8)</p>

    <p class="text-gray-300">!<a href="img-4.jpeg">img-4.jpeg</a> Figure 4: The two Gaussian distributions corresponding to wrong key guess (red) and right key guess (green). The red-shaded region corresponds to the probability of false positives or Type I error value.</p>

    <p class="text-gray-300">In terms of Type II error (right key rejection) we set it to constant probability <span class="math">\\frac{1}{2}</span>. This is achieved by simply accepting a certain key bits assumptios as correct if the number of observed pairs of our interest (truncated differential propertied verified) exceeds the mean of the Gauss distribution corresponding to the right key which is <span class="math">E(R)</span> in our example.</p>

    <p class="text-gray-300">In the next section we describe how to construct a 22-round distinguisher for SIMON cipher. Then, we use this distinguisher to mount an attack against a larger number of rounds.</p>

    <p class="text-gray-300">In this section we combine several truncated differential properties in order to construct a 22-round distinguisher. In particular, we combine two transitions discovered to propagate with sufficiently high probability for 10 and 2 rounds. The transitions are shown on Figure 5.</p>

    <p class="text-gray-300">In order to compute the probability of a transition we use a very simple algorithm that simply counts the number of events of our interest for a given fixed number of trials. We assume that the distribution of the number of events of our interest follows (approximately) a Poisson distribution. We use this distribution as we have experimentally observed that for all cases we have tried,</p>

    <ul class="list-disc list-inside space-y-1 text-gray-300 my-2 ml-4">

      <li>We have a discrete distribution of small integers</li>

      <li>In all cases we have tried and are included in this thesis the variance is relatively close to the mean.</li>

    </ul>

    <p class="text-gray-300">For a sample of size <span class="math">N</span>  if <span class="math">x</span> denotes the number of events that were observed (approximated by Poisson with parameter Poisson mean <span class="math">Np</span> where <span class="math">p</span> is the true mean), then the approximated Standard Deviation (SD) of the variable <span class="math">\\frac{x}{N}</span>, where <span class="math">N</span> is assumed to be constant and <span class="math">p</span> the observed mean, is given by <span class="math">\\sqrt{Np} / N = \\sqrt{p / N}</span>. This is because the variance equals to the mean in case of a Poisson distribution.</p>

    <p class="text-gray-300">Let <span class="math">I_{1}</span> be the interval <span class="math">[pt\\sqrt{p&#x27; / N}, p + t\\sqrt{p / N}]</span>. In our simulations we would like <span class="math">I_{1}</span> to be contained in the interval <span class="math">I_{2} = [p, 2^{a}, p, 2^{a}]</span>, where <span class="math">a</span> is an error we allow in the exponent of the mean as a power of 2. We assume that the true mean that we are aiming to approximate by simulations is bigger than some probability value <span class="math">p_{0}</span> in order to ensure that our algorithm terminates in reasonable time. The inclusion of sets implies that we need to run <span class="math">N &amp;gt; N_{0}</span> simulations, where <span class="math">N_{0}</span> is given by</p>

    <div class="my-4 text-center"><span class="math-block">N _ {0} = \\frac {2 ^ {2 a} t ^ {2}}{(2 ^ {a} - 1) ^ {2}} \\cdot \\frac {1}{p _ {0}} \\tag {9}</span></div>

    <p class="text-gray-300">in order to achieve the desired precision. Since we record the mean <span class="math">\\frac{a}{N}</span> we expect by Central Limit Theorem that the distribution of our mean converges to a Normal Distribution.</p>

    <p class="text-gray-300">Following precisely this methodology we end up in the problem of distinguishing the following two Gaussian distributions.</p>

    <ul class="list-disc list-inside space-y-1 text-gray-300 my-2 ml-4">

      <li>Natural Propagation: X: N <span class="math">(2^{12}, 2^6)</span></li>

      <li>SIMON: Y: N <span class="math">(2^{12} + 2^7, \\sqrt{(2^{12} + 2^7)})</span></li>

    </ul>

    <p class="text-gray-300">!<a href="img-5.jpeg">img-5.jpeg</a> Figure 5: A 22-round statistical distinguisher.</p>

    <p class="text-gray-300">Explanation: We have in total <span class="math">2^{63}.2^{3} = 2^{66}</span> pairs of plaintexts <span class="math">(P, P&#x27;)</span> that satisfy <span class="math">P \\oplus P&#x27; \\in [0000002200000080]</span>. A proportion <span class="math">2^{10} / 2^{64}</span> is expected to have a ciphertext difference <span class="math">C \\oplus C&#x27; \\in [0A50002209010008]</span> by accident (random permutation) after either a large number of rounds or by simply at random, which implies <span class="math">2^{12}</span> pairs. Now in case of SIMOn we expect <span class="math">2^{66 - 17.0 - 38.0 - 4.0} = 2^7</span> to follow this truncated differential path with the specified differences in the middle. Since these distributions converge to Gauss distributions, but the underlying source of generating samples is approximated by Poisson, we can assume that the standard deviation can be computed by the square root of the mean.</p>

    <p class="text-gray-300">The other problem that we need to consider is the problem of the number of pairs that by accident have also this intermediate differences after 10 and 20 rounds as specified by the distinguisher. For this particular example, we have that <span class="math">2^{16}.2^{-17 - 38}</span> are ex</p>

    <p class="text-gray-300">pected to have these intermediate differences which implies it is zero and thus the two sets of events are completely disjoint.</p>

    <p class="text-gray-300">Note that we follow the following hypothesis testing; if the number of pairs observed during the attack exceeds <span class="math">2^{12}+2^{7}</span> then we accept the key assumption as correct, otherwise we reject it. This implies that the Type II error of our attack is automatically set to half. That implies that we have to repeat twice our attack in order to retrieve the correct key, More details about Type II error (false key assumption acceptance) is analyzed in the next chapter.</p>

    <h2 id="sec-11" class="text-2xl font-bold">6 DIFFERENTIAL ATTACKS AGAINST 24 AND 26 ROUNDS OF SIMON</h2>

    <p class="text-gray-300">In this section we present attacks against reduced round versions of SIMON64/128 using the statistical distinguisher we have constructed and presented in the previous section. Our distinguisher combines several truncated differential properties for 10+10+2 rounds, resulting in a 22-round distinguisher with Type I error <span class="math">2^{-4.5}</span> while Type II error is set to half.</p>

    <p class="text-gray-300">To sum up, Type I error corresponds to false positives, i.e. the number of wrongly accepted keys as correct by following the distinguisher construction for given pairs of plaintext and ciphertexts. The attack that we describe is a depth-first key search like approach, where we guess a specified set of key bits for each round in order to determine the number of plaintext-ciphertext pairs that follows the differences as specified by the statistical distinguisher.</p>

    <p class="text-gray-300">As we have already mentioned in the previous section we are interested in distinguishing the following two Gauss distributions,</p>

    <ul class="list-disc list-inside space-y-1 text-gray-300 my-2 ml-4">

      <li>Natural Propagation: X: N <span class="math">(2^{12},2^{6})</span></li>

      <li>SIMON: Y: N <span class="math">(2^{12}+2^{7},\\sqrt{(2^{12}+2^{7})})</span></li>

    </ul>

    <p class="text-gray-300">The Type I error for this case can be computed by computing the ration <span class="math">\\frac{2^{7}}{2^{6}}=2</span> which corresponds to Type I error <span class="math">2^{-4.5}</span> by computing the associated Gauss Error function.</p>

    <p class="text-gray-300">We present two attacks, one against 24 rounds of SIMON and another one, but essentially weaker attack, on 26 rounds of SIMON. The aim of these attacks is to show the generic nature of our attack that makes use of a well-constructed distinguisher to attack several number of rounds. Importantly, the performance of this distinguisher can be improved if better ad-hoc heuristics regarding the structure of the cipher are discovered or there is a significant improvement in the discovery method. Figure 6 illustrates precisely our steps in our attack.</p>

    <h4 id="sec-12" class="text-lg font-semibold mt-6">6.0.3 Attack against 24 rounds</h4>

    <p class="text-gray-300">Consider a partition of 24 rounds of SIMON as 2+22, where 22 is the distinguisher but inverted. Note that we do not have to guess full round keys but we are only interested in guessing the key bits which allows to check if the path of the plaintext pairs gives collisions on the 0s of the truncated differential masks in the input of the distinguisher.</p>

    <ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">

      <li>For each of the 28+26 key bits of <span class="math">k_{1},k_{2}</span> do the following</li>

      <li>Compute the partial encryption of all <span class="math">2^{64}</span> plaintexts for the first two rounds under the selected key bits defined in the previous step.</li>

      <li>Set a counter <span class="math">T=0</span>.</li>

      <li>If all corresponding bits after 2 rounds of encryption equal to 0 for the selected key bits as specified in the truncated differential mask, then increase <span class="math">T</span> by 1.</li>

      <li>Repeat this for all <span class="math">2^{64}</span> P-C pairs.</li>

      <li>If <span class="math">T&amp;gt;2^{12}+2^{6}</span> accept the key bits as correct for the round keys <span class="math">k_{1},k_{2}</span>.</li>

      <li>Out of the total <span class="math">2^{28+26}</span> key assumption we expect to filter out <span class="math">2^{49.5}</span> cases to continue the attack</li>

      <li>Brute force on the rest <span class="math">128-28-26=74</span> key bits by requesting more pairs of plaintext-ciphertext.</li>

      <li>Repeat the attack for another time</li>

    </ol>

    <p class="text-gray-300">The time complexity of this attack is computed by computing the complexity in each step. Intially we have to perform <span class="math">2^{28+26}\\,2^{64}=2^{118}</span> encryptions. We are left with <span class="math">2^{49.5}</span> cases to continue the attack. The complexity for the rest steps is <span class="math">2^{54-4.5-74}=2^{123.5}</span>. Thus, the total time complexity is <span class="math">2^{123.5}</span> and data complexity <span class="math">2^{64}</span>. The overall complexity due to Type II error is <span class="math">2^{124.5}</span>.</p>

    <h4 id="sec-13" class="text-lg font-semibold mt-6">6.0.4 Attack against 26 rounds</h4>

    <p class="text-gray-300">In this section we use a partition of 26 rounds as 2+22+2, where the middle 22 rounds is the statistical distinguisher. The attack is summarized below.</p>

    <ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">

      <li>For each of the (28+26)+(30+31) key bits of <span class="math">k_{1},k_{2},k_{25},k_{26}</span> do the following</li>

      <li>Compute the partial encryption of all <span class="math">2^{64}</span> plaintexts for the first two and last two rounds under the selected key bits defined in the previous step.</li>

      <li>Set a counter <span class="math">T=0</span>.</li>

    </ol>

    <ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">

      <li>If all corresponding bits aequal to 0 for the selected key bits as specified in the truncated differential masks, then increase <span class="math">T</span> by 1.</li>

      <li>Repeat this for all <span class="math">2^{64}</span> P-C pairs.</li>

      <li>If <span class="math">T&gt;2^{12}+2^{6}</span> accept the key bits as correct for the round keys <span class="math">k_{1},k_{2},k_{25},k+_{26}</span>.</li>

      <li>Out of the total <span class="math">2^{28+26+30+31}</span> key assumption we expect to filter out <span class="math">2^{110.5}</span> cases to continue the attack</li>

      <li>Brute force on the rest <span class="math">128-28-26=74</span> key bits by requesting more pairs of plaintext-ciphertext.</li>

      <li>Repeat the attack for another time</li>

    </ol>

    <p class="text-gray-300">The data complexity for this attack is <span class="math">2^{64}</span> as we again use the entire codebook. The time complexity of the first step is <span class="math">(2^{28+26}+2^{30+31}).2^{64}=2^{125}</span> SIMON encryptions. Then, we have to bruteforce on the rest <span class="math">2^{54-4.5+74}=2^{123.5}</span> to get the correct key. The total time complexity turns out to be <span class="math">2^{126}</span> due to Type II error.</p>

    <p class="text-gray-300">Note that we have not optimized the number of key bits required to be guessed in the final steps to recover <span class="math">k_{3},k_{4}</span> by knowning lots of key bits from <span class="math">k_{1},k_{2},k_{25},k_{26}</span>. In order to do this we need to analyze the LFSR-like key schedule and this could be our future work.</p>

    <h2 id="sec-14" class="text-2xl font-bold">7 CONCLUSIONS</h2>

    <p class="text-gray-300">Lightweight cryptography is the field of cryptography that studies the level of security of cryptographic algorithms designed to be implemented and run efficiently on constrained devices. Nowadays, as we move closer to the evolution of Internet of Things (IoT) network <em>[Holler et al., 2014]</em>, where a lot of constrained devices will be connected on the internet and exchange information, the concept of lightweight cryptography gets even more attraction. Constructing an algorithm with the aim to run efficiently on limited hardware constraints, optimal power consumption and simultaneously offer a desired level of security is a highly non-trivial optimization task. Every year researchers are proposing new lightweight ciphers that are designed based on the security and limitation in hardware optimization task in mind. In 2013, a team of researchers from NSA published two new families of lightweight ciphers, SIMON and Speck, which are designed towards hardware and software implementation respectively. In this paper, our aim is to evaluate the level of security that the 64-bit version of SIMON that uses a 128-bit key offers, against advanced forms of differential cryptanalysis and especially against truncated differentials <em>[Knudsen.,1995]</em>. Truncated differentials is a powerful form of advanced differential cryptanalysis and it was used to break ciphers which initially seem to be secure against nave differential cryptanalysis, such as for example GOST <em>[Courtois et al., 2013]</em>. In this paper, we follow the idea suggested by Courtois et al in SECRYPT 2013 to extend statistical distinguishers to attacks against either the full number of rounds of the cipher or a selected number of rounds. We achieve in obtaining a 26-round attack against 26(/44) rounds of SIMON with time complexity <span class="math">2^{126}</span> SIMON encryptions and <span class="math">2^{64}</span> plaintext-ciphertext pairs. Importantly, this attack is not optimized as we can update the discovery method to obtain even better truncated differential properties which will enable us to either build stronger statistical distinguishers or extend our distinguishers to more than 22 rounds and this would be a topic of our future research.</p>

    <p class="text-gray-300">Alkhzaimi, H. and Lauridsen, M. (2013). Differential and linear cryptanalysis of reduced-round simon. Cryptology ePrint Archive, Report 2013/543. Beaulieu, R., Shors, D., Smith, J., Treatman-Clark, S., Weeks, B., and Wingers, L. (2013). The simon and speck families of lightweight block ciphers. In Cryptology ePrint Archive, Report 2013/404. Biham, E. and Shamir, A. (1990). Differential cryptanalysis of des-like cryptosystems. Advances in Cryptology - CRYPTO 90. Biham, E. and Shamir, A. (1993). Differential cryptanalysis of the data encryption standard. Springer, Verlag. Boyar, J., Find, M., and Peralta, R. (2013). Four measures of nonlinearity. Algorithms and Complexity, pp. 61-72. Springer Berlin Heidelberg. Courtois, N. and Bard, G. (2007). Algebraic cryptanalysis of the data encryption standard. IMA Int. Conf. volume 4887, Springer. Courtois, N., Hulme, D., and T.Mourouzis (2011). Solving circuit optimisation problems in cryptography and cryptanalysis. electronic proceedings of 2nd IMA Conference Mathematics in Defence 2011. Courtois, N. and Mourouzis, T. (2013). Enhanced truncated differential cryptanalysis of gost. SECRYPT 2013, 10th International Conference on Security and Cryptography, Reykjavik, Iceland, July 29-31. Courtois, N., Mourouzis, T., Grocholewska-Czurylo, A., and Quisquater, J. (2014a). On optimal size in truncated differential attacks. CECC 2014. Courtois, N., Mourouzis, T., Song, G., Sepehrdad, P., and Susil, P. (2014b). Combined algebraic and truncated differential cryptanalysis on reduced-round simon. SECRYPT 2014, 10th International Conference on Security and Cryptography. Farzaneh, A., E. List, S. L., and Wenzel, J. (2013). Differential and linear cryptanalysis of reduced-round simon. In Cryptology ePrint Archive, Report 2013/526. Holler, J., Tsiatsis, V., Mulligan, C., Karnouskos, S., Aves, S., and Boyle, D. (2014). From machine-to-machine to the internet of things: Introductions to a new age of intelligence. Elsevier, ISBN 978-0-12-407684-6. Knudsen, L. (1995). Truncated and higher order differentials. In Fast Software Encryption, Springer Berlin Heidelberg. Mark, F. (2014). Roadmap for the emerging internet of things - its impact, architecture and future governance. Carre Strauss, United Kington. Mourouzis, T. (2014). Optimizations in algebraic and differential cryptanalysis. UCL PhD Thesis.</p>

    <p class="text-gray-300">!<a href="img-6.jpeg">img-6.jpeg</a> Figure 6: Illustration of an attack against 26 rounds of GOST in the form of a depth-first key search approach. The red circle represents guessing of well-chosen sets of bits which are 0 which is equivalent to searching for collisions.</p>`;
---

<BaseLayout title="Advanced Differential Cryptanalysis of Reduced-Round SIMON64... (2015/481)">
  <article class="max-w-4xl mx-auto article-prose">
    <nav class="mb-8">
      <a href="/papers" class="text-blue-400 hover:text-blue-300">
        &larr; Back to Papers
      </a>
    </nav>

    <header class="mb-12">
      <h1 class="text-3xl font-bold mb-4"
        set:html={TITLE_HTML} />
      <p class="text-gray-400 mb-2"
        set:html={AUTHORS_HTML} />
      <p class="text-gray-500 text-sm mb-4">
        2015 &middot; eprint 2015/481
      </p>
      <div class="flex gap-4 text-sm">
        <a
          href={EPRINT_URL}
          target="_blank"
          rel="noopener noreferrer"
          class="text-blue-400 hover:text-blue-300"
        >
          Paper (eprint) &rarr;
        </a>
      </div>
      <p class="mt-4 text-xs text-gray-500">
        All content below belongs to the original authors. This page
        reproduces the paper for educational purposes. Always
        <a
          href={EPRINT_URL}
          target="_blank"
          rel="noopener noreferrer"
          class="text-blue-400 hover:text-blue-300"
        >cite the original</a>.
      </p>
      <p class="mt-1 text-xs text-gray-600">
        Converted with: {CRAWLER} &middot; {CONVERTED_DATE}
      </p>
    </header>

    <Fragment set:html={CONTENT} />

  </article>
</BaseLayout>
