---
import BaseLayout from '../../layouts/BaseLayout.astro';

const EPRINT_URL = 'https://eprint.iacr.org/2019/945';
const CRAWLER = 'marker';
const CONVERTED_DATE = '2026-02-14';
---

<BaseLayout title="Key-Independent 6-round AES Distinguisher (2019/945)">
  <article class="max-w-4xl mx-auto article-prose">
    <nav class="mb-8">
      <a href="/papers" class="text-blue-400 hover:text-blue-300">
        &larr; Back to Papers
      </a>
    </nav>

    <!-- ============================================================ -->
    <!-- HEADER                                                       -->
    <!-- ============================================================ -->

    <header class="mb-12">
      <h1 class="text-3xl font-bold mb-4">
        A Key-Independent Distinguisher for 6-round AES
        in an Adaptive Setting
      </h1>
      <p class="text-gray-400 mb-2">
        Navid Ghaedi Bardeh
      </p>
      <p class="text-gray-500 text-sm mb-4">
        2019 &middot; Full Version &middot; eprint 2019/945
      </p>
      <div class="flex gap-4 text-sm">
        <a
          href={EPRINT_URL}
          target="_blank"
          rel="noopener noreferrer"
          class="text-blue-400 hover:text-blue-300"
        >
          Paper (eprint) &rarr;
        </a>
      </div>
      <p class="mt-4 text-xs text-gray-500">
        All content below belongs to the original authors. This page
        reproduces the paper for educational purposes. Always
        <a
          href={EPRINT_URL}
          target="_blank"
          rel="noopener noreferrer"
          class="text-blue-400 hover:text-blue-300"
        >cite the original</a>.
      </p>
      <p class="mt-1 text-xs text-gray-600">Converted with: {CRAWLER} &middot; {CONVERTED_DATE}</p>
    </header>

    <!-- ============================================================ -->
    <!-- TABLE OF CONTENTS                                            -->
    <!-- ============================================================ -->

    <nav id="toc" class="mb-10 p-6 rounded-lg"
      style="background: rgba(255,255,255,0.03);
             border: 1px solid rgba(255,255,255,0.06);">
      <h2 class="text-lg font-bold mb-4">Table of Contents</h2>
      <ol class="space-y-1 text-sm text-gray-300
        list-decimal list-inside">
        <li>
          <a href="#abstract"
            class="hover:text-white">Abstract</a>
        </li>
        <li>
          <a href="#sec-1"
            class="hover:text-white">Introduction</a>
          <ol class="ml-6 mt-1 space-y-1 list-decimal
            list-inside">
            <li>
              <a href="#sec-1.1"
                class="hover:text-white">
                Overview of 6-round distinguishers on AES
              </a>
            </li>
            <li>
              <a href="#sec-1.2"
                class="hover:text-white">Our Contribution</a>
            </li>
            <li>
              <a href="#sec-1.3"
                class="hover:text-white">
                Overview of This Paper and Main Results
              </a>
            </li>
          </ol>
        </li>
        <li>
          <a href="#sec-2"
            class="hover:text-white">Preliminaries</a>
        </li>
        <li>
          <a href="#sec-3"
            class="hover:text-white">
            5-round ACC Distinguisher
          </a>
        </li>
        <li>
          <a href="#sec-4"
            class="hover:text-white">
            6-round ACC Distinguisher
          </a>
        </li>
        <li>
          <a href="#sec-5"
            class="hover:text-white">Acknowledgments</a>
        </li>
        <li>
          <a href="#sec-6"
            class="hover:text-white">Conclusion</a>
        </li>
        <li>
          <a href="#references"
            class="hover:text-white">References</a>
        </li>
      </ol>
    </nav>

    <!-- ============================================================ -->
    <!-- ABSTRACT                                                     -->
    <!-- ============================================================ -->

    <section id="abstract" class="mb-10">
      <h2 class="text-2xl font-bold mb-4">Abstract</h2>
      <p class="text-gray-300">
        In this paper, we study the results of the recently proposed
        exchange attack in an adaptive setting. As expected, it leads
        to present a better 6-round key-independent distinguisher in
        terms of data and computational complexities. More
        specifically, our 6-round adaptive distinguisher requires
        <span class="math">2^&#123;83&#125;</span> chosen plaintexts
        and
        <span class="math">2^&#123;83&#125;</span> adaptively chosen
        ciphertexts and has a computational cost of
        <span class="math">2^&#123;83&#125;</span> encryption.
      </p>
      <p class="text-gray-400 text-sm mt-2">
        <strong>Keywords:</strong> SPN, AES, Exchange Attack,
        Secret-Key model, Difference Cryptanalysis
      </p>
    </section>

    <!-- ============================================================ -->
    <!-- 1  INTRODUCTION                                              -->
    <!-- ============================================================ -->

    <section id="sec-1" class="mb-10">
      <h2 class="text-2xl font-bold mb-4">1 &ensp; Introduction</h2>

      <p class="text-gray-300">
        In 2000, Rijndael block cipher is accepted as AES (Advance
        Encryption Standard) by NIST. AES is provably resistant
        against differential and linear cryptanalysis. During the
        last 20 years, among to large amount researches [Rij97, BK00, KW02,
        DR06, DR07, Bou+12, DF16]), there is only the biclique attack [BKR11] which
        can break AES faster than exhaustive search. Up to now, the
        best known key recovery attack in secret key model can break
        7-round of AES.
      </p>

      <p class="text-gray-300">
        Integral and impossible differential distinguishers on
        4-round AES, in secret key model, were best distinguishers
        (in term of reaching highest rounds) for several years.
        Recently, since 2016, new developments has been presented for
        round-reduced AES. These developments showed several basic
        and unexplored properties for round-reduced AES. First
        5-round distinguishers have been appeared in several
        studies [Sun+16, GRR16, RBH17, BR19b, GR18, BGL19, BR19a]. Some of these 5-round
        distinguishers have gained more attentions since they can be
        extended to 6-round distinguishers.
      </p>

      <!-- 1.1 -->
      <section id="sec-1.1" class="mb-8">
        <h3 class="text-xl font-bold mb-3">
          1.1 &ensp; Overview of 6-round distinguishers on AES
        </h3>

        <p class="text-gray-300">
          At Asiacrypt 2017, the authors of [RBH17] presented the first
          6-round secret-key distinguishers for AES which requires
          <span class="math">2^&#123;122.8&#125;</span> adaptive
          chosen plaintexts/ciphertexts and a computational cost of
          <span class="math">2^&#123;121.8&#125;</span> XORs. The
          authors introduced a new deterministic 4-round property in
          AES, which states that sets of pairs of plaintexts that are
          equivalent by exchange of any subset of diagonals encrypts
          to a set of pairs of ciphertexts after four rounds that all
          have a difference of zero in exactly the same columns
          before the final linear layer.
        </p>

        <p class="text-gray-300">
          Then, Bardeh and R&oslash;njom [BR19a] presented a new
          technique called exchange attack. They showed that 6-round
          of AES is biased when the plaintexts are chosen from a
          certain set (exchange equivalence sets). Their 6-round
          distinguisher requires
          <span class="math">2^&#123;88.2&#125;</span> chosen
          plaintexts and a computational cost of
          <span class="math">2^&#123;88.2&#125;</span> encryption.
        </p>

        <p class="text-gray-300">
          Later, Bao, Guo and List [BGL19] presented a 6-round
          distinguisher requires
          <span class="math">2^&#123;89.43&#125;</span> chosen
          plaintexts and a computational cost of
          <span class="math">2^&#123;96.52&#125;</span> look-ups
          into memory. The authors extended a known integral
          distinguisher to the exception distinguisher.
        </p>
      </section>

      <!-- 1.2 -->
      <section id="sec-1.2" class="mb-8">
        <h3 class="text-xl font-bold mb-3">
          1.2 &ensp; Our Contribution
        </h3>

        <p class="text-gray-300">
          We investigate the results of exchange attack in an
          adaptive setting. As results, we present a 5-round adaptive
          chosen ciphertext distinguisher which it&rsquo;s data
          complexity is higher than the best current adaptive chosen
          ciphertext distinguisher. However, it can be extended to a
          6-round adaptive chosen ciphertext distinguisher which
          requires
          <span class="math">2^&#123;83&#125;</span> chosen
          plaintexts and
          <span class="math">2^&#123;83&#125;</span> adaptive chosen
          ciphertexts, which is as far as we know a new record.
        </p>
      </section>

      <!-- 1.3 -->
      <section id="sec-1.3" class="mb-8">
        <h3 class="text-xl font-bold mb-3">
          1.3 &ensp; Overview of This Paper and Main Results
        </h3>

        <p class="text-gray-300">
          In Section 2 we briefly describe the exchange attack and
          its results on reduced-round of AES. In Section 3 we
          present a key independent 5-round ACC distinguisher. In
          Section 4 we introduce an efficient 6-round key-independent
          ACC distinguisher. The currently best secret-key
          distinguishers for 5- and 6-round AES are given in
          Table 1. We adopt that data complexity is measured in a
          minimum number of chosen plaintexts/ciphertexts CP/CC or
          adaptively chosen plaintexts/ciphertexts ACP/ACC. Time
          complexity is measured in equivalent number of AES
          encryptions (E), memory accesses (M) and/or XOR
          operations (XOR) &ndash; adopting that
          <span class="math">2^0</span> M
          <span class="math">\approx</span> 1 round of AES.
        </p>

        <!-- Table 1 -->
        <div class="overflow-x-auto my-6">
          <p class="text-sm text-gray-400 mb-2">
            <strong>Table 1:</strong> Secret-Key Distinguishers
            for AES
          </p>
          <table class="w-full text-sm">
            <thead>
              <tr class="border-b border-gray-700">
                <th class="text-left py-2 pr-4">Property</th>
                <th class="text-left py-2 pr-4">Rounds</th>
                <th class="text-left py-2 pr-4">Data</th>
                <th class="text-left py-2 pr-4">Cost</th>
                <th class="text-left py-2">Ref.</th>
              </tr>
            </thead>
            <tbody class="text-gray-300">
              <tr class="border-b border-gray-800">
                <td class="py-2 pr-4">Integral</td>
                <td class="py-2 pr-4">5</td>
                <td class="py-2 pr-4">
                  <span class="math">2^&#123;128&#125;</span> CP
                </td>
                <td class="py-2 pr-4">
                  <span class="math">2^&#123;129.6&#125;</span> XORs
                </td>
                <td class="py-2">[Sun+16]</td>
              </tr>
              <tr class="border-b border-gray-800">
                <td class="py-2 pr-4">Expectation of TD</td>
                <td class="py-2 pr-4">5</td>
                <td class="py-2 pr-4">
                  <span class="math">2^&#123;65&#125;</span> CP
                </td>
                <td class="py-2 pr-4">
                  <span class="math">2^&#123;70.2&#125;</span> M
                </td>
                <td class="py-2">[BGL19]</td>
              </tr>
              <tr class="border-b border-gray-800">
                <td class="py-2 pr-4">Expectation of TD</td>
                <td class="py-2 pr-4">5</td>
                <td class="py-2 pr-4">
                  <span class="math">2^&#123;48.96&#125;</span> CP
                </td>
                <td class="py-2 pr-4">
                  <span class="math">2^&#123;46&#125;</span> E
                </td>
                <td class="py-2">[GR18]</td>
              </tr>
              <tr class="border-b border-gray-800">
                <td class="py-2 pr-4">Exchange Attack</td>
                <td class="py-2 pr-4">5</td>
                <td class="py-2 pr-4">
                  <span class="math">2^&#123;35.5&#125;</span> CP +
                  <span class="math">2^&#123;39&#125;</span> ACC
                </td>
                <td class="py-2 pr-4">
                  <span class="math">2^&#123;35.5&#125;</span> E
                </td>
                <td class="py-2">Sect. 3</td>
              </tr>
              <tr class="border-b border-gray-800">
                <td class="py-2 pr-4">Multiple-8</td>
                <td class="py-2 pr-4">5</td>
                <td class="py-2 pr-4">
                  <span class="math">2^&#123;32&#125;</span> CP
                </td>
                <td class="py-2 pr-4">
                  <span class="math">2^&#123;35.6&#125;</span> M
                </td>
                <td class="py-2">[GRR17]</td>
              </tr>
              <tr class="border-b border-gray-800">
                <td class="py-2 pr-4">Exchange Attack</td>
                <td class="py-2 pr-4">5</td>
                <td class="py-2 pr-4">
                  <span class="math">2^&#123;30&#125;</span> CP
                </td>
                <td class="py-2 pr-4">
                  <span class="math">2^&#123;30&#125;</span> E
                </td>
                <td class="py-2">[BR19a]</td>
              </tr>
              <tr class="border-b border-gray-800">
                <td class="py-2 pr-4">Zero difference</td>
                <td class="py-2 pr-4">5</td>
                <td class="py-2 pr-4">
                  <span class="math">2^&#123;12.2&#125;</span> CP +
                  <span class="math">2^&#123;27.2&#125;</span> ACC
                </td>
                <td class="py-2 pr-4">
                  <span class="math">2^&#123;26.2&#125;</span> XOR
                </td>
                <td class="py-2">[BR19b]</td>
              </tr>
              <tr class="border-b border-gray-800">
                <td class="py-2 pr-4">Zero difference</td>
                <td class="py-2 pr-4">5</td>
                <td class="py-2 pr-4">
                  <span class="math">2^&#123;26.8&#125;</span> ACC
                </td>
                <td class="py-2 pr-4">
                  <span class="math">2^&#123;25.8&#125;</span> XOR
                </td>
                <td class="py-2">[RBH17]</td>
              </tr>
              <tr class="border-b border-gray-800">
                <td class="py-2 pr-4">Zero difference</td>
                <td class="py-2 pr-4">6</td>
                <td class="py-2 pr-4">
                  <span class="math">2^&#123;122.8&#125;</span> ACC
                </td>
                <td class="py-2 pr-4">
                  <span class="math">2^&#123;121.8&#125;</span> XOR
                </td>
                <td class="py-2">[RBH17]</td>
              </tr>
              <tr class="border-b border-gray-800">
                <td class="py-2 pr-4">Expectation of TD</td>
                <td class="py-2 pr-4">6</td>
                <td class="py-2 pr-4">
                  <span class="math">2^&#123;89.43&#125;</span> CP
                </td>
                <td class="py-2 pr-4">
                  <span class="math">2^&#123;96.52&#125;</span> M
                </td>
                <td class="py-2">[BGL19]</td>
              </tr>
              <tr class="border-b border-gray-800">
                <td class="py-2 pr-4">Exchange Attack</td>
                <td class="py-2 pr-4">6</td>
                <td class="py-2 pr-4">
                  <span class="math">2^&#123;88.2&#125;</span> CP
                </td>
                <td class="py-2 pr-4">
                  <span class="math">2^&#123;88.2&#125;</span> E
                </td>
                <td class="py-2">[BR19a]</td>
              </tr>
              <tr class="border-b border-gray-800">
                <td class="py-2 pr-4">Exchange Attack</td>
                <td class="py-2 pr-4">6</td>
                <td class="py-2 pr-4">
                  <span class="math">2^&#123;83&#125;</span> CP +
                  <span class="math">2^&#123;83&#125;</span> ACC
                </td>
                <td class="py-2 pr-4">
                  <span class="math">2^&#123;83&#125;</span> E
                </td>
                <td class="py-2">Sect. 4</td>
              </tr>
            </tbody>
          </table>
        </div>
      </section>
    </section>

    <!-- ============================================================ -->
    <!-- 2  PRELIMINARIES                                             -->
    <!-- ============================================================ -->

    <section id="sec-2" class="mb-10">
      <h2 class="text-2xl font-bold mb-4">
        2 &ensp; Preliminaries
      </h2>

      <p class="text-gray-300">
        The Advanced Encryption Standard (AES) [DR02] is the most
        widely adopted block cipher in the world today and is a
        critical component in protecting information in both
        commercial and high-assurance communication. The AES internal
        state is typically represented by a 4 by 4 matrix in
        <span class="math">
          \mathbb&#123;F&#125;_&#123;2^8&#125;^&#123;4 \times 4&#125;
        </span>.
        The matrix representation is for the most part purely
        representational as the actual properties of the matrix
        (e.g. rank, order etc.) are not actually exploited for
        anything. One full round of AES consists of SubBytes (SB),
        ShiftRows (SR), MixColumns (MC) and AddKey (AK). The
        SB-layer applies a fixed permutation over
        <span class="math">
          \mathbb&#123;F&#125;_&#123;2^8&#125;
        </span>
        independently to each byte of the state, the SR-layer
        cyclically shifts the
        <span class="math">i</span>-th row by
        <span class="math">i</span> positions, while the MC-layer
        applies a fixed linear transformation to each column. The key
        addition adds a secret round-dependent value to the state.
        One full round is composed as
        <span class="math">
          R = AK \circ MC \circ SR \circ SB
        </span>.
        We follow standard convention and simplify notation by
        writing
        <span class="math">R^t(x)</span>
        to mean
        <span class="math">t</span> rounds of AES where each round
        key is fixed to some random value.
      </p>

      <p class="text-gray-300">
        We recall the exchange attack presented in [BR19a]. Here, we
        recall the basic definitions and Theorems presented in the
        exchange attack to use them for presenting our results.
      </p>

      <!-- Definition 1 -->
      <div class="formal-block formal-block-definition">
        <div class="flex items-start justify-between mb-2">
          <span class="text-sm font-bold text-blue-400">
            Definition 1 (Column Exchange Difference)
          </span>
        </div>
        <p class="text-sm text-gray-300 mb-3">
          [BR19a] For a vector
          <span class="math">
            v \in \mathbb&#123;F&#125;_2^4
          </span>
          and a pair of states
          <span class="math">
            \alpha, \beta \in
            \mathbb&#123;F&#125;_&#123;2^8&#125;^&#123;4 \times 4&#125;
          </span>
          define the column exchange difference
          <span class="math">
            \Delta_v \stackrel&#123;def&#125;&#123;=&#125;
            \Delta_v^&#123;\alpha,\beta&#125; \in
            \mathbb&#123;F&#125;_&#123;2^8&#125;^&#123;4 \times 4&#125;
          </span>
          where the
          <span class="math">i</span>-th column is defined by
        </p>
        <div class="math-block">
          (\Delta_v)_i = (\alpha_i \oplus \beta_i) v_i
        </div>
        <p class="text-sm text-gray-300 mt-3">
          where
          <span class="math">\alpha_i</span> and
          <span class="math">\beta_i</span> are the
          <span class="math">i</span>-th columns of
          <span class="math">\alpha</span> and
          <span class="math">\beta</span>.
        </p>
      </div>

      <p class="text-gray-300">
        A pair of states define a set of
        <span class="math">
          2^&#123;wt_c(\alpha \oplus \beta)&#125;
        </span>
        possible column exchange differences where
        <span class="math">wt_c(x)</span> denotes the number of
        non-zero columns of
        <span class="math">x</span>. We can now define three related
        operators that exchange diagonal, column and mixed values
        between a pair of AES states.
      </p>

      <!-- Definition 2 -->
      <div class="formal-block formal-block-definition">
        <div class="flex items-start justify-between mb-2">
          <span class="text-sm font-bold text-blue-400">
            Definition 2 (Column Exchange)
          </span>
        </div>
        <p class="text-sm text-gray-300 mb-3">
          [BR19a] For a vector
          <span class="math">
            v \in \mathbb&#123;F&#125;_2^4
          </span>
          and a pair of states
          <span class="math">
            \alpha, \beta \in
            \mathbb&#123;F&#125;_&#123;2^8&#125;^&#123;4 \times 4&#125;
          </span>,
          define column exchange according to
          <span class="math">v</span> as
        </p>
        <div class="math-block">
          \rho_c^v(\alpha, \beta) = \alpha \oplus \Delta_v.
        </div>
        <p class="text-sm text-gray-300 mt-3">
          It is easy to see that the pair of states
          <span class="math">
            (\rho_c^v(\alpha, \beta),\;
            \rho_c^v(\beta, \alpha)) =
            (\alpha \oplus \Delta_v,\;
            \beta \oplus \Delta_v)
          </span>
          are formed by exchanging individual columns between
          <span class="math">\alpha</span> and
          <span class="math">\beta</span> according to the binary
          coefficients of
          <span class="math">v</span>. Thus, for any
          <span class="math">v</span> it is easy to see that
        </p>
        <div class="math-block">
          \alpha \oplus \beta =
          \rho_c^v(\alpha, \beta) \oplus
          \rho_c^v(\beta, \alpha).
        </div>
      </div>

      <!-- Definition 3 -->
      <div class="formal-block formal-block-definition">
        <div class="flex items-start justify-between mb-2">
          <span class="text-sm font-bold text-blue-400">
            Definition 3 (Diagonal Exchange)
          </span>
        </div>
        <p class="text-sm text-gray-300 mb-3">
          [BR19a] For a vector
          <span class="math">
            v \in \mathbb&#123;F&#125;_2^4
          </span>
          and a pair of states
          <span class="math">
            \alpha, \beta \in
            \mathbb&#123;F&#125;_&#123;2^8&#125;^&#123;4 \times 4&#125;
          </span>,
          define diagonal exchange according to
          <span class="math">v</span> as
        </p>
        <div class="math-block">
          \rho_d^v(\alpha, \beta) =
          \alpha \oplus SR^&#123;-1&#125;
          (\Delta_v^&#123;SR(\alpha), SR(\beta)&#125;).
        </div>
        <p class="text-sm text-gray-300 mt-3">
          The new pair
          <span class="math">
            (\rho_d^v(\alpha, \beta),\;
            \rho_d^v(\beta, \alpha))
          </span>
          is formed by exchanging individual diagonals between
          <span class="math">\alpha</span> and
          <span class="math">\beta</span> according to the binary
          coefficients of
          <span class="math">v</span>. The relationship between
          exchange of diagonals and exchange of columns is intuitively
          straightforward.
        </p>
      </div>

      <!-- Lemma 1 -->
      <div class="formal-block formal-block-lemma">
        <div class="flex items-start justify-between mb-2">
          <span class="text-sm font-bold text-amber-400">
            Lemma 1
          </span>
        </div>
        <p class="text-sm text-gray-300 mb-3">
          [BR19a] From the definition of
          <span class="math">\rho_d^v</span> and
          <span class="math">\rho_c^v</span> it follows that
        </p>
        <div class="math-block">
          R(\rho_d^v(\alpha, \beta)) =
          \rho_c^v(R(\alpha), R(\beta)).
        </div>
      </div>

      <!-- Definition 4 -->
      <div class="formal-block formal-block-definition">
        <div class="flex items-start justify-between mb-2">
          <span class="text-sm font-bold text-blue-400">
            Definition 4 (Mixed Exchange)
          </span>
        </div>
        <p class="text-sm text-gray-300 mb-3">
          [BR19a] For a vector
          <span class="math">
            v \in \mathbb&#123;F&#125;_2^4
          </span>
          and a pair of states
          <span class="math">
            \alpha, \beta \in
            \mathbb&#123;F&#125;_&#123;2^8&#125;^&#123;4 \times 4&#125;
          </span>
          define mixed exchange according to
          <span class="math">v</span> as
        </p>
        <div class="math-block">
          \rho_m^v(\alpha, \beta) =
          \alpha \oplus
          L(\Delta_v^&#123;L^&#123;-1&#125;(\alpha),\;
          L^&#123;-1&#125;(\beta)&#125;)
        </div>
        <p class="text-sm text-gray-300 mt-3">
          where
          <span class="math">L = MC \circ SR</span>.
        </p>
      </div>

      <!-- Lemma 2 -->
      <div class="formal-block formal-block-lemma">
        <div class="flex items-start justify-between mb-2">
          <span class="text-sm font-bold text-amber-400">
            Lemma 2
          </span>
        </div>
        <p class="text-sm text-gray-300 mb-3">
          [BR19a] From the definition of
          <span class="math">\rho_c^v</span> and
          <span class="math">\rho_m^v</span> it follows that
        </p>
        <div class="math-block">
          R(\rho_c^v(\alpha, \beta)) =
          \rho_m^v(R(\alpha), R(\beta)).
        </div>
      </div>

      <!-- Lemma 3 -->
      <div class="formal-block formal-block-lemma">
        <div class="flex items-start justify-between mb-2">
          <span class="text-sm font-bold text-amber-400">
            Lemma 3
          </span>
        </div>
        <p class="text-sm text-gray-300 mb-3">
          [BR19a] For two random states
          <span class="math">\alpha, \beta</span> and some non-zero
          vector
          <span class="math">
            v \in \mathbb&#123;F&#125;_2^4
          </span>,
          we have that
        </p>
        <div class="math-block">
          R^&#123;2&#125;(\rho_d^v(\alpha, \beta)) =
          \rho_m^v(R^&#123;2&#125;(\alpha),\;
          R^&#123;2&#125;(\beta)).
        </div>
      </div>

      <p class="text-gray-300">
        To indicate the zero column(s) of a state
        <span class="math">
          x \in
          \mathbb&#123;F&#125;_&#123;2^8&#125;^&#123;4 \times 4&#125;
        </span>,
        we define
        <span class="math">\nu(x)</span> which denotes the binary
        indicator vector which is 0 in position
        <span class="math">i</span> if the
        <span class="math">i</span>-th column of
        <span class="math">x</span> is zero and 1 otherwise. We also
        are interested to know the zero column of a state after/before
        the first and last linear layer so we define,
        <span class="math">L = SR \circ MC</span>,
        <span class="math">
          \nu_m(x) = \nu(L^&#123;-1&#125;(x))
        </span>
        and
        <span class="math">\nu_d(x) = \nu(SR(x))</span>.
        For a subset
        <span class="math">
          I \subset \&#123;0, 1, 2, 3\&#125;
        </span>,
        we write
        <span class="math">
          v^I \in \mathbb&#123;F&#125;_2^4
        </span>
        to mean the indicator vector which has value
        <span class="math">v^I_i = 1</span> if
        <span class="math">i \in I</span> and 0 otherwise.
      </p>

      <!-- Theorem 1 -->
      <div class="formal-block formal-block-theorem">
        <div class="flex items-start justify-between mb-2">
          <span class="text-sm font-bold text-green-400">
            Theorem 1
          </span>
        </div>
        <p class="text-sm text-gray-300 mb-3">
          [BR19a] Let
          <span class="math">
            I, J, K \subset \&#123;0, 1, 2, 3\&#125;
          </span>
          and
          <span class="math">
            \alpha, \beta \in
            \mathbb&#123;F&#125;_&#123;2^8&#125;^&#123;4 \times 4&#125;
          </span>
          be two random states. Then the probability that a set of
          diagonals
          <span class="math">J</span> are exchanged, given that a set
          of columns
          <span class="math">I</span> are exchanged when the
          difference
          <span class="math">\alpha \oplus \beta</span> is zero in
          columns indicated by
          <span class="math">K</span>, i.e.
        </p>
        <div class="math-block">
          \Pr\big((\rho_d^&#123;v^J&#125;(\alpha, \beta),\;
          \rho_d^&#123;v^J&#125;(\beta, \alpha)) =
          (\rho_c^&#123;v^I&#125;(\alpha, \beta),\;
          \rho_c^&#123;v^I&#125;(\beta, \alpha))\big)
        </div>
        <p class="text-sm text-gray-300 mt-3">
          is given by
        </p>
        <div class="math-block">
          p(|I|, |J|, |K|) =
          (2^&#123;-8&#125;)^&#123;4(|I| + |J|) - |K| \cdot |J| -
          2|I| \cdot |J|&#125;.
        </div>
      </div>

      <!-- Theorem 2 -->
      <div class="formal-block formal-block-theorem">
        <div class="flex items-start justify-between mb-2">
          <span class="text-sm font-bold text-green-400">
            Theorem 2
          </span>
        </div>
        <p class="text-sm text-gray-300 mb-3">
          [BR19a] Let
          <span class="math">
            \alpha, \beta \in
            \mathbb&#123;F&#125;_&#123;2^8&#125;^&#123;4 \times 4&#125;
          </span>
          denote two plaintexts equal in
          <span class="math">|K|</span> diagonals indicated by
          <span class="math">
            K \subset \&#123;0, 1, 2, 3\&#125;
          </span>
          and assume
          <span class="math">
            0 &lt; \operatorname&#123;wt&#125;
            (\nu(R^5(\alpha) \oplus R^5(\beta))) &lt; 4
          </span>.
          Then for a non-trivial choice of
          <span class="math">
            I \subset \&#123;0, 1, 2, 3\&#125; \setminus K
          </span>
          the relation
        </p>
        <div class="math-block">
          \nu_m(R^5(\alpha) \oplus R^5(\beta)) =
          \nu_m(R^5(\rho_d^&#123;v^I&#125;(\alpha, \beta))
          \oplus R^5(\rho_d^&#123;v^I&#125;(\beta, \alpha)))
        </div>
        <p class="text-sm text-gray-300 mt-3">
          holds with probability
        </p>
        <div class="math-block">
          p_5(|I|, |K|) = \sum_&#123;d=1&#125;^&#123;3&#125;
          \binom&#123;4&#125;&#123;d&#125; \,
          p(|I|, d, |K|).
        </div>
      </div>

      <p class="text-gray-300">
        We remark that the result of previous Theorem works as well
        in decryption direction by applying an appropriate exchange
        operation considering the corresponding linear layer.
      </p>
    </section>

    <!-- ============================================================ -->
    <!-- 3  5-ROUND ACC DISTINGUISHER                                 -->
    <!-- ============================================================ -->

    <section id="sec-3" class="mb-10">
      <h2 class="text-2xl font-bold mb-4">
        3 &ensp; 5-round ACC Distinguisher
      </h2>

      <p class="text-gray-300">
        In this section we show how one can use the result of
        Theorem 2 in an adaptive setting.
      </p>

      <!-- Theorem 3 -->
      <div class="formal-block formal-block-theorem">
        <div class="flex items-start justify-between mb-2">
          <span class="text-sm font-bold text-green-400">
            Theorem 3
          </span>
        </div>
        <p class="text-sm text-gray-300 mb-3">
          Let
          <span class="math">
            p^0, p^1 \in
            \mathbb&#123;F&#125;_&#123;2^8&#125;^&#123;4 \times 4&#125;
          </span>
          denote two plaintexts and assume
          <span class="math">
            0 &lt;
            \operatorname&#123;wt&#125;(\nu_d(p^0 \oplus p^1))
            &lt; 4
          </span>.
          Then for a non-trivial choice of
          <span class="math">
            I \subset \&#123;0, 1, 2, 3\&#125;
          </span>
          the relation
        </p>
        <div class="math-block">
          \nu_d(p^0 \oplus p^1) =
          \nu_d\big(R^&#123;-5&#125;
          (\rho_m^&#123;v^I&#125;(R^5(p^0), R^5(p^1)))
          \oplus
          R^&#123;-5&#125;
          (\rho_m^&#123;v^I&#125;(R^5(p^1), R^5(p^0)))\big)
        </div>
        <p class="text-sm text-gray-300 mt-3">
          holds with probability
        </p>
        <div class="math-block">
          p_5(|I|, 0) = \sum_&#123;d=1&#125;^&#123;3&#125;
          \binom&#123;4&#125;&#123;d&#125; \,
          p(|I|, d, 0).
        </div>
      </div>

      <p class="text-gray-300">
        Since ciphertexts are random, we consider only the case
        <span class="math">|K| = 0</span> in Theorem 3. We can set
        up a 5-round distinguisher based on the result of Theorem 3.
        The idea is to generate a new plaintext pair adaptively such
        that:
      </p>
      <div class="math-block">
        \nu_d(p^0 \oplus p^1) =
        \nu_d\big(R^&#123;-5&#125;
        (\rho_m^&#123;v^I&#125;(R^5(p^0), R^5(p^1)))
        \oplus
        R^&#123;-5&#125;
        (\rho_m^&#123;v^I&#125;(R^5(p^1), R^5(p^0)))\big)
        = \nu_d(p'^&#123;0&#125; \oplus p'^&#123;1&#125;)
      </div>

      <p class="text-gray-300">
        Let
        <span class="math">
          \operatorname&#123;wt&#125;(\nu_d(p^0 \oplus p^1)) = d
        </span>,
        then if
        <span class="math">p_5(|I|, 0)</span> is higher than
        <span class="math">2^&#123;-32 \cdot (4 - d)&#125;</span>,
        the probability of this event at random, we can distinguish
        5-round AES from a random permutation. If we set
        <span class="math">d = 2</span> (i.e. the difference of the
        plaintexts is zero in two diagonals) and
        <span class="math">|I| = 1</span> then we get that
        <span class="math">
          p_5(|I|, 0) = 2^&#123;-46&#125;
        </span>
        while it is
        <span class="math">2^&#123;-64&#125;</span> for random case.
      </p>

      <p class="text-gray-300">
        Now, to set up a 5-round distinguisher, adversary prepares
        <span class="math">2^&#123;23.5&#125;</span> plaintexts where
        bytes in the first two diagonals take random values and other
        diagonals take a random constant. Then he can generate
        <span class="math">2^&#123;46&#125;</span> pairs and at least
        one of them verifies the upper trail of Figure 1. Then he
        applies the Mixed exchange operator to all ciphertext pairs
        and decrypts new ciphertext pairs. So he expects to observe a
        new plaintext pair such that
      </p>
      <div class="math-block">
        \nu_d(p^i \oplus p^j) =
        \nu_d(p'^&#123;i&#125; \oplus p'^&#123;j&#125;)
        = (1, 1, 0, 0)
      </div>

      <p class="text-gray-300">
        Thus adversary can distinguish 5-round AES from a random
        permutation using
        <span class="math">2^&#123;23.5&#125;</span> chosen
        plaintexts and
        <span class="math">
          2 \cdot 2^&#123;46&#125; = 2^&#123;47&#125;
        </span>
        adaptively chosen ciphertexts. The data complexity can be
        reduced by adding a certain condition on the ciphertext
        pairs. Suppose that after 3-round encryption, the
        <span class="math">k</span>-th diagonal in the difference
        of states,
        <span class="math">
          R^3(p^i) \oplus R^3(p^j)
        </span>,
        is zero then adversary can filter ciphertext pairs which have
        a zero column in their difference before last linear layer.
        So the probability of exchange trail is
        <span class="math">
          2^&#123;-46-24&#125; = 2^&#123;-70&#125;
        </span>.
        Now adversary prepares
        <span class="math">2^&#123;35.5&#125;</span> plaintexts where
        the first two diagonals take
        <span class="math">2^&#123;35.5&#125;</span> random values,
        and the remaining diagonals are fixed to a constant. Thus he
        can construct
        <span class="math">2^&#123;70&#125;</span> ciphertext pairs
        and filter the ciphertext pairs such that only
        <span class="math">
          2^&#123;70-32&#125; = 2^&#123;38&#125;
        </span>
        of them are remained. For each of remaining pairs, he
        decrypts the new ciphertext pair formed by applying the mixed
        exchange operation on them,
        <span class="math">\rho_m^&#123;v^I&#125;</span>,
        and estimates one of new generated plaintext pair is differ
        in the first two diagonals. Hence, he can distinguish
        5-round AES from a random permutation using
        <span class="math">2^&#123;35.5&#125;</span> chosen
        plaintexts and
        <span class="math">
          2 \cdot 2^&#123;38&#125; = 2^&#123;39&#125;
        </span>
        adaptively chosen ciphertexts.
      </p>
    </section>

    <!-- ============================================================ -->
    <!-- 4  6-ROUND ACC DISTINGUISHER                                 -->
    <!-- ============================================================ -->

    <section id="sec-4" class="mb-10">
      <h2 class="text-2xl font-bold mb-4">
        4 &ensp; 6-round ACC Distinguisher
      </h2>

      <p class="text-gray-300">
        In this section we present a 6-round key-independent
        distinguisher for AES in an adaptive setting. We extend the
        5-round distinguisher to 6-round one by adding one round at
        beginning of it. Now, the idea of setting up a distinguisher
        is as follows. Suppose a plaintext pair, which differ in only
        a diagonal, verifies the upper trail in Figure 2. Then we
        generate two new ciphertexts by
      </p>
      <div class="math-block">
        (c'^&#123;0&#125;, c'^&#123;1&#125;) =
        (\rho_m^&#123;v^I&#125;(R^6(p^1), R^6(p^0)),\;
        \rho_m^&#123;v^I&#125;(R^6(p^0), R^6(p^1)))
      </div>

      <p class="text-gray-300">
        and decrypt them. Then according to Theorem 3, we have that
      </p>
      <div class="math-block">
        \operatorname&#123;wt&#125;
        (\nu_d(R(p^0) \oplus R(p^1))) =
        \operatorname&#123;wt&#125;
        (\nu_d(R^&#123;-5&#125;(c'^&#123;0&#125;)
        \oplus R^&#123;-5&#125;(c'^&#123;1&#125;))) = 1
      </div>

      <p class="text-gray-300">
        with probability
        <span class="math">2^&#123;-46&#125;</span>. Also we are
        interested in the following condition:
      </p>
      <div class="math-block">
        \operatorname&#123;wt&#125;
        (\nu_d(p^0 \oplus p^1)) =
        \operatorname&#123;wt&#125;
        (\nu_d(R^&#123;-6&#125;(c'^&#123;0&#125;)
        \oplus R^&#123;-6&#125;(c'^&#123;1&#125;))) =
        \operatorname&#123;wt&#125;
        (\nu_d(p'^&#123;0&#125; \oplus p'^&#123;1&#125;))
        = 1
      </div>

      <p class="text-gray-300">
        This condition happens with probability
        <span class="math">2^&#123;-22&#125; \cdot 2^&#123;-22&#125;</span>
        (<span class="math">2^&#123;-22&#125;</span> for each pair).
        So, in total, with probability
        <span class="math">
          (2^&#123;-22&#125;)^2 \cdot 2^&#123;-46&#125; =
          2^&#123;-90&#125;
        </span>
        we expect that we have two new plaintexts,
        <span class="math">p'^&#123;0&#125;</span> and
        <span class="math">p'^&#123;1&#125;</span>, such that they
        differ in only one diagonal. For a random permutation, the
        probability that two plaintexts differ in only one diagonal
        is
        <span class="math">
          4 \cdot 2^&#123;-96&#125; = 2^&#123;-94&#125;
        </span>.
        Now, we prepare a structure of
        <span class="math">2^&#123;32&#125;</span> plaintexts where
        the first diagonal takes all possible
        <span class="math">2^&#123;32&#125;</span> values, and the
        remaining diagonals are fixed to some constants. Thus we can
        construct
        <span class="math">2^&#123;63&#125;</span> plaintext pairs
        and thus we will need to encrypt
        <span class="math">
          2^&#123;90-63&#125; = 2^&#123;27&#125;
        </span>
        structures. Hence, we can distinguish 6-round AES from a
        random permutation using
        <span class="math">
          2^&#123;32+27&#125; = 2^&#123;59&#125;
        </span>
        chosen plaintexts and
        <span class="math">
          2 \cdot 2^&#123;90&#125; = 2^&#123;91&#125;
        </span>
        adaptively chosen ciphertexts.
      </p>

      <p class="text-gray-300">
        Similar to the 5-round distinguisher, the data complexity can
        be reduced by adding a certain condition on the ciphertext
        pairs. Suppose that after 4-round encryption, the
        <span class="math">k</span>-th diagonal in state difference
        is zero. Then we can decrypt ciphertext pairs which the
        <span class="math">k</span>-th column of
        <span class="math">
          L^&#123;-1&#125;(c^i \oplus c^j)
        </span>
        is zero. So the total probability changes to
        <span class="math">
          (2^&#123;-22&#125;)^2 \cdot 2^&#123;-46&#125;
          \cdot 2^&#123;-24&#125; = 2^&#123;-114&#125;
        </span>.
        The structure of plaintexts can take
        <span class="math">2^&#123;32&#125;</span> values, and so we
        can construct
        <span class="math">2^&#123;63&#125;</span> pairs. Now we need
        to encrypt
        <span class="math">
          2^&#123;114-63&#125; = 2^&#123;51&#125;
        </span>
        structures and filter the ciphertext pairs such that only
        <span class="math">
          2^&#123;114-32&#125; = 2^&#123;82&#125;
        </span>
        of them are remained. For each of remaining pairs we decrypt
        the new pair formed by applying the mixed exchange operation
        on them,
        <span class="math">\rho_m^&#123;v^I&#125;</span>.
        Now, we expect that there is a new plaintext pair which
        differ in a diagonal and thus we can distinguish 6-round AES
        from a random permutation using
        <span class="math">
          2^&#123;32+51&#125; = 2^&#123;83&#125;
        </span>
        chosen plaintexts and
        <span class="math">
          2 \cdot 2^&#123;82&#125; = 2^&#123;83&#125;
        </span>
        adaptive chosen ciphertexts.
      </p>

      <!-- Algorithm 1 -->
      <div class="my-6 p-4 rounded-lg"
        style="background: rgba(255,255,255,0.03);
               border: 1px solid rgba(255,255,255,0.06);">
        <p class="text-sm font-bold text-gray-300 mb-3">
          Algorithm 1: Pseudo-code for 6-round ACC distinguisher
        </p>
        <p class="text-sm text-gray-300 mb-2">
          <strong>Input:</strong> Ask for
          <span class="math">2^&#123;51&#125;</span> structures each
          structure has
          <span class="math">2^&#123;32&#125;</span> plaintexts
        </p>
        <p class="text-sm text-gray-300 mb-3">
          <strong>Result:</strong> 1 for an AES permutation, &minus;1
          otherwise.
        </p>
        <pre class="text-xs text-gray-300 overflow-x-auto"><code>for each structure do
  C &larr; &#123;&#125;
  T = &#123;&#125;;  // empty hash table containing
            // unordered sets (e.g. unordered multisets)

  Ask for a structure P of 2^32 plaintexts p^i
  where bytes in diagonal 0 take all values

  C &larr; C &cup; &#123;c^i&#125;
  z &larr; |L^(-1)(c^i)_k|
    // |L^(-1)(c^i)_k| is an integer value of k-th column
  T[z] &larr; T[z] &cup; &#123;i&#125;

  for each c^i in C do    // 2^31 pairs are remained
    for a in T[|c^i|] do
      j &larr; T[|c^i|][a]
      c'^i = rho_m^(v^I)(c^i, c^j)
      c'^j = rho_m^(v^I)(c^j, c^i) for a fixed I with |I|=1

      Ask for decryption of c'^i and c'^j
      if wt(nu_d(p'^i xor p'^j)) equals 1 then
        return 1
      end
    end
  end
end
return -1</code></pre>
      </div>
    </section>

    <!-- ============================================================ -->
    <!-- 5  ACKNOWLEDGMENTS                                           -->
    <!-- ============================================================ -->

    <section id="sec-5" class="mb-10">
      <h2 class="text-2xl font-bold mb-4">
        5 &ensp; Acknowledgments
      </h2>
      <p class="text-gray-300">
        The author would like thank Sondre R&oslash;njom for fruitful
        discussions and helpful comments.
      </p>
    </section>

    <!-- ============================================================ -->
    <!-- 6  CONCLUSION                                                -->
    <!-- ============================================================ -->

    <section id="sec-6" class="mb-10">
      <h2 class="text-2xl font-bold mb-4">
        6 &ensp; Conclusion
      </h2>
      <p class="text-gray-300">
        In this paper we have investigated the results of exchange
        attack in an adaptive setting. So, we improve the current
        best 6-round key-independent distinguisher. Our proposed
        distinguisher requires
        <span class="math">2^&#123;83&#125;</span> chosen plaintexts
        and
        <span class="math">2^&#123;83&#125;</span> adaptively chosen
        ciphertexts and has a computational cost of
        <span class="math">2^&#123;83&#125;</span> encryption.
      </p>
    </section>

    <!-- ============================================================ -->
    <!-- REFERENCES                                                   -->
    <!-- ============================================================ -->

    <section id="references" class="mb-10">
      <h2 class="text-2xl font-bold mb-4">References</h2>
      <ul class="space-y-2 text-gray-300 text-sm list-none">
        <li>
          <span class="text-gray-500">[BGL19]</span>
          Zhenzhen Bao, Jian Guo, and Eik List. Extended expectation
          cryptanalysis on round-reduced AES. Cryptology ePrint
          Archive, Report 2019/622, 2019.
        </li>
        <li>
          <span class="text-gray-500">[BR19a]</span>
          Navid Ghaedi Bardeh and Sondre R&oslash;njom. The exchange
          attack: How to distinguish 6 rounds of AES with
          <span class="math">2^&#123;88.2&#125;</span> chosen
          plaintexts. Cryptology ePrint Archive, Report 2019/652,
          2019.
          <a href="/papers/exchange-attack-2019"
            class="text-blue-400 hover:text-blue-300">
            [page on this site]</a>
        </li>
        <li>
          <span class="text-gray-500">[BR19b]</span>
          Navid Ghaedi Bardeh and Sondre R&oslash;njom. Practical
          attacks on reduced-round AES. Cryptology ePrint Archive,
          Report 2019/770, 2019.
        </li>
        <li>
          <span class="text-gray-500">[BK00]</span>
          Eli Biham and Nathan Keller. Cryptanalysis of reduced
          variants of Rijndael. In 3rd AES Conference, volume 230,
          2000.
        </li>
        <li>
          <span class="text-gray-500">[BKR11]</span>
          Andrey Bogdanov, Dmitry Khovratovich, and Christian
          Rechberger. Biclique cryptanalysis of the full AES. In
          Advances in Cryptology &ndash; ASIACRYPT 2011, pages
          344&ndash;371, 2011.
        </li>
        <li>
          <span class="text-gray-500">[Bou+12]</span>
          C. Bouillaguet, P. Derbez, O. Dunkelman, P. A. Fouque,
          N. Keller, and V. Rijmen. Low-data complexity attacks on
          AES. Volume 58, pages 7002&ndash;7017, Nov 2012.
        </li>
        <li>
          <span class="text-gray-500">[DR07]</span>
          J. Daemen and V. Rijmen. Plateau characteristics.
          Volume 1, pages 11&ndash;17, 2007.
        </li>
        <li>
          <span class="text-gray-500">[DR02]</span>
          Joan Daemen and Vincent Rijmen. The design of Rijndael:
          AES &ndash; the Advanced Encryption Standard. Springer,
          2002.
        </li>
        <li>
          <span class="text-gray-500">[DR06]</span>
          Joan Daemen and Vincent Rijmen. Understanding two-round
          differentials in AES. In Security and Cryptography for
          Networks: 5th International Conference, SCN 2006, pages
          78&ndash;94, 2006.
        </li>
        <li>
          <span class="text-gray-500">[DF16]</span>
          Patrick Derbez and Pierre-Alain Fouque. Automatic search
          of meet-in-the-middle and impossible differential attacks.
          In Advances in Cryptology &ndash; CRYPTO 2016, pages
          157&ndash;184, 2016.
        </li>
        <li>
          <span class="text-gray-500">[GR18]</span>
          Lorenzo Grassi and Christian Rechberger. Rigorous analysis
          of truncated differentials for 5-round AES. Cryptology
          ePrint Archive, Report 2018/182, 2018.
          <a href="/papers/truncated-diff-diagonal-aes-2018"
            class="text-blue-400 hover:text-blue-300">
            [page on this site]</a>
        </li>
        <li>
          <span class="text-gray-500">[GRR16]</span>
          Lorenzo Grassi, Christian Rechberger, and Sondre
          R&oslash;njom. Subspace trail cryptanalysis and its
          applications to AES. IACR Trans. Symmetric Cryptol.,
          2016(2):192&ndash;225, 2016.
          <a href="/papers/subspace-trails-2020"
            class="text-blue-400 hover:text-blue-300">
            [page on this site]</a>
        </li>
        <li>
          <span class="text-gray-500">[GRR17]</span>
          Lorenzo Grassi, Christian Rechberger, and Sondre
          R&oslash;njom. A new structural-differential property of
          5-round AES. In Advances in Cryptology &ndash; EUROCRYPT
          2017, pages 289&ndash;317, 2017.
        </li>
        <li>
          <span class="text-gray-500">[KW02]</span>
          Lars R. Knudsen and David Wagner. Integral cryptanalysis.
          In Fast Software Encryption, FSE 2002, pages 112&ndash;127,
          2002.
        </li>
        <li>
          <span class="text-gray-500">[Rij97]</span>
          Vincent Rijmen. Cryptanalysis and design of iterated block
          ciphers. Doctoral Dissertation, K.U.Leuven, 1997.
        </li>
        <li>
          <span class="text-gray-500">[RBH17]</span>
          Sondre R&oslash;njom, Navid Ghaedi Bardeh, and Tor
          Helleseth. Yoyo tricks with AES. In Advances in Cryptology
          &ndash; ASIACRYPT 2017, pages 217&ndash;243, 2017.
        </li>
        <li>
          <span class="text-gray-500">[Sun+16]</span>
          Bing Sun, Meicheng Liu, Jian Guo, Longjiang Qu, and
          Vincent Rijmen. New insights on AES-like SPN ciphers. In
          Advances in Cryptology &ndash; CRYPTO 2016, pages
          605&ndash;624, 2016.
        </li>
      </ul>
    </section>
  </article>
</BaseLayout>
