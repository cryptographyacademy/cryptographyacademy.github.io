---
import BaseLayout from '../../layouts/BaseLayout.astro';

const EPRINT_URL = 'https://eprint.iacr.org/2004/161';
const CRAWLER = 'mistral';
const CONVERTED_DATE = '2026-02-16';
const TITLE_HTML = 'Improvement of Thériault Algorithm of Index Calculus for Jacobian of Hyperelliptic Curves of Small Genus';
const AUTHORS_HTML = 'Ko-ichi Nagao';

const CONTENT = `    <p class="text-gray-300">Koh-ichi Nagao, Dept. of Engineering, Kanto-Gakuin Univ.</p>

    <h6 id="sec-2" class="text-base font-medium mt-4">Abstract</h6>

    <p class="text-gray-300">Gaudry present a variation of index calculus attack for solving the DLP in the Jacobian of hyperelliptic curves. Harley and Thérialut improve these kind of algorithm. Here, we will present a variation of these kind of algorithm, which is faster than previous ones. Keywords Index calculus attack, Jacobian, Hyperelliptic curve, DLP,</p>

    <h2 id="sec-3" class="text-2xl font-bold">1 Introduction</h2>

    <p class="text-gray-300">Gaudry <em>[3]</em> first present a variation of index calculus attack for hyperelliptic curves that could solve the DLP on the Jacobian of an hyperelliptic curve of small genus. Later, Harley(cf. <em>[2]</em>) and Thériault <em>[1]</em> improve this algorithm. In <em>[1]</em>, these algorithms work in time <span class="math">O(q^{2-\\frac{2}{p+1}+\\epsilon})</span>, and <span class="math">O(q^{2-\\frac{4}{2p+1}+\\epsilon})</span> respectively. Thériault’s algorithm uses the almost-smooth divisor <span class="math">D=\\sum D(P_{i})</span> that all but one of the <span class="math">P_{i}</span>’s are in the set <span class="math">B</span> called factor base. This technique was often used in the number field sieve factorization algorithm, which uses the almost-smooth integer <span class="math">n=\\prod p_{i}</span>, that all but one of the <span class="math">p_{i}</span>’s are in the factor base <span class="math">B</span>, which is the set of small primes. In factorization algorithm, the cost of factorizing integer is larger than that of primary testing. So, the cost of factorizing almost-smooth integer is larger than that of normal integer of the same size, and the number that <span class="math">p_{i}\\not\\in B</span> must be one. However, for the index calculus for the Jacobian of curves, we first compute the point of Jacobian and later consult whether it is almost smooth or not. So that, the new algorithm that use the 2-almost smooth divisors, that all but 2 of the <span class="math">P_{i}</span>’s are in the set <span class="math">B</span>, is useful. For example, the almost smooth divisor of the form <span class="math">v_{1}=\\sum\\mbox{terms of }B+D(P_{1})</span>, and the 2-almost smooth divisors of the form <span class="math">v_{2}=\\sum\\mbox{terms of }B+D(P_{1})+D(P_{2})</span>,</p>

    <p class="text-gray-300">^{*} nagao@kanto-gakuin.ac.jp</p>

    <p class="text-gray-300"><span class="math">v_{3}=\\sum\\text{terms of }B+D(P_{2})+D(P_{3})</span> are given, <span class="math">v_{1}-v_{2}=\\sum\\text{terms of }B-D(P_{2})</span>, <span class="math">v_{1}-v_{2}+v_{3}=\\sum\\text{terms of }B+D(P_{3})</span> are other almost smooth divisors. So, we can get much more almost smooth divisors from gathering 2-almost smooth divisors. From this improvement, we get an attack of a running time of <span class="math">O(q^{2-\\frac{2}{g}+\\epsilon})</span>.</p>

    <h2 id="sec-4" class="text-2xl font-bold">2 Jacobian arithmetic</h2>

    <p class="text-gray-300">Let <span class="math">C</span> be a hyperelliptic curve of genus <span class="math">g</span> over <span class="math">\\mathbb{F}_{q}</span> of the form <span class="math">y^{2}+h(x)y=f(x)</span> with <span class="math">\\deg f=2g+1</span> and <span class="math">\\deg h\\leq g</span>.</p>

    <h6 id="sec-5" class="text-base font-medium mt-4">Notation 1.</h6>

    <p class="text-gray-300">Use <span class="math">J_{q}</span> for <span class="math">\\mathbf{Jac}_{C}(\\mathbb{F}_{q})</span>.</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Further, we will assume that $</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">J_{q}</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">$ is odd prime number, for simplicity.</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <h6 id="sec-6" class="text-base font-medium mt-4">Definition 1.</h6>

    <p class="text-gray-300">Given <span class="math">D_{1},D_{2}\\in J_{q}</span> such that <span class="math">D_{2}\\in&lt;D_{1}&gt;</span>, DLP for <span class="math">(D_{1},D_{2})</span> on <span class="math">J_{q}</span> is computing <span class="math">\\lambda</span> such that <span class="math">D_{2}=\\lambda D_{1}</span>.</p>

    <p class="text-gray-300">For an element <span class="math">P=(x,y)</span> in <span class="math">C(\\bar{\\mathbb{F}}_{q})</span>, put <span class="math">-P:=(x,-h(x)-y)</span>.</p>

    <h6 id="sec-7" class="text-base font-medium mt-4">Lemma 1.</h6>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"><span class="math">C(\\mathbb{F}_{q})</span> is written by the union of disjoint sets <span class="math">\\mathcal{P}\\cup-\\mathcal{P}\\cup\\{\\infty\\}</span>, where $\\mathcal{P}:=\\{-P</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">P\\in\\mathcal{P}\\}$.</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <h6 id="sec-8" class="text-base font-medium mt-4">Proof.</h6>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Since $</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">J_{q}</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"><span class="math"> is odd prime, we have </span>2\\not\\parallel J_{q}</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"><span class="math"> and there are no point </span>P\\in C(\\mathbb{F}_{q})<span class="math"> such that </span>P=-P$. ∎</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">Further, we will fix <span class="math">\\mathcal{P}</span>.</p>

    <p class="text-gray-300">Point of <span class="math">\\mathbf{Jac}_{C}</span> can be represented uniquely by the reduced divisor of the form</p>

    <p class="text-gray-300"><span class="math">\\sum_{i=1}^{k}n_{i}P_{i}-\\sum_{i=1}^{k}n_{i}\\infty,\\quad P_{i}\\in C(\\bar{\\mathbb{F}}_{q}),\\quad P_{i}\\neq-P_{j}\\text{ for }i\\neq j</span></p>

    <p class="text-gray-300">with <span class="math">n_{i}\\geq 0</span> and <span class="math">\\sum n_{i}\\leq g</span>.</p>

    <h6 id="sec-9" class="text-base font-medium mt-4">Definition 2.</h6>

    <p class="text-gray-300">The reduced divisor of a point of Jacobian <span class="math">J_{q}</span> is written by the elements of <span class="math">C(\\mathbb{F}_{q})</span> i.e.</p>

    <p class="text-gray-300"><span class="math">\\sum_{i=1}^{k}n_{i}P_{i}-\\sum_{i=1}^{k}n_{i}\\infty,\\quad P_{i}\\in C(\\mathbb{F}_{q}).</span></p>

    <p class="text-gray-300">Then the point is said to be potentially smooth point.</p>

    <p class="text-gray-300">Let <span class="math">D(P):=P-\\infty</span>. Note that <span class="math">P+(-P)\\sim 2\\infty</span>. From lemma 1, potentially smooth point <span class="math">v</span> of <span class="math">J_{q}</span> can be represented of the form</p>

    <p class="text-gray-300"><span class="math">\\sum_{P\\in\\mathcal{P}}n_{P}^{(v)}D(P)</span></p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">with <span class="math">n_{P}^{(v)}\\in\\mathbb{Z}</span> and $\\sum_{P\\in\\mathcal{P}}</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">n_{P}^{(v)}</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\leq g$. Further, we will use this representation to potentially smooth points.</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <h6 id="sec-10" class="text-base font-medium mt-4">Definition 3.</h6>

    <p class="text-gray-300">A subset <span class="math">B</span> of <span class="math">\\mathcal{P}</span> used to define smoothness is called factor base.</p>

    <h6 id="sec-11" class="text-base font-medium mt-4">Definition 4.</h6>

    <p class="text-gray-300">A point <span class="math">P\\in\\mathcal{P}\\backslash B</span> is called large prime.</p>

    <h6 id="sec-12" class="text-base font-medium mt-4">Definition 5.</h6>

    <p class="text-gray-300">A divisor <span class="math">v</span> of the form</p>

    <p class="text-gray-300"><span class="math">\\sum_{P\\in B}n_{P}^{(v)}D(P)</span></p>

    <p class="text-gray-300">is called smooth divisor.</p>

    <h6 id="sec-13" class="text-base font-medium mt-4">Definition 6.</h6>

    <p class="text-gray-300">A divisor <span class="math">v</span> of the form</p>

    <p class="text-gray-300"><span class="math">\\sum_{P\\in B}n_{P}^{(v)}D(P)+n_{P^{\\prime}}^{(v)}P^{\\prime},</span></p>

    <p class="text-gray-300">where <span class="math">P^{\\prime}</span> is a large prime, is called <span class="math">1</span>-almost smooth divisor or almost smooth divisor.</p>

    <h6 id="sec-14" class="text-base font-medium mt-4">Definition 7.</h6>

    <p class="text-gray-300">A divisor <span class="math">v</span> of the form</p>

    <p class="text-gray-300"><span class="math">\\sum_{P\\in B}n_{P}^{(v)}D(P)+n_{P^{\\prime}}^{(v)}P^{\\prime}+n_{P^{\\prime\\prime}}^{(v)}P^{\\prime\\prime},</span></p>

    <p class="text-gray-300">where <span class="math">P^{\\prime},P^{\\prime\\prime}</span> are large primes, is called <span class="math">2</span>-almost smooth divisor.</p>

    <h6 id="sec-15" class="text-base font-medium mt-4">Definition 8.</h6>

    <p class="text-gray-300">An element <span class="math">J\\in J_{q}</span> is called <span class="math">c</span> point, if the reduced divisor representing <span class="math">J</span> is smooth (resp. almost smooth, resp. <span class="math">2</span>-almost smooth) divisor.</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Further, we will consider the coefficients <span class="math">n_{P}</span> of a smooth (resp. almost smooth, resp. <span class="math">2</span>-almost smooth) divisor modulo $</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">J_{q}</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"><span class="math">. For a smooth (resp. almost smooth, resp. </span>2<span class="math">-almost smooth) divisor </span>v$, put</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">$l(v):=\\#\\{P\\in B</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">n_{P}^{(v)}\\neq 0\\}.$</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <h6 id="sec-16" class="text-base font-medium mt-4">Lemma 2.</h6>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Let <span class="math">v_{1},v_{2}</span> be smooth (resp. almost smooth, resp. <span class="math">2</span>-almost smooth) divisors and let <span class="math">r_{1},r_{2}</span> be integers modulo $</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">J_{q}</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"><span class="math">. Then the cost for computing </span>r_{1}v_{1}+r_{2}v_{2}<span class="math"> is </span>O(g^{2}(\\log q)^{2}(l(v_{1})+l(v_{2}))$.</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <h6 id="sec-17" class="text-base font-medium mt-4">Proof.</h6>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">It requires <span class="math">l(v_{1})+l(v_{2})</span>-time products and additions modulo $</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">J_{q}</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"><span class="math">. Note that </span></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">J_{q}</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\doteq q^{g}<span class="math">. Since the cost of one elementary operation modulo </span></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">J_{q}</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"><span class="math"> is </span>\\log</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">J_{q}</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">=(g\\log q)^{2}$, we have this estimation. ∎</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <h2 id="sec-18" class="text-2xl font-bold">3 Outline of algorithm</h2>

    <p class="text-gray-300">In this section, we present the outline of the proposed algorithm. Let <span class="math">k</span> be a real number satisfying <span class="math">0&lt;k&lt;1/2g</span>. Further in this paper, we will use <span class="math">k</span> as a parameter of this algorithm. Put</p>

    <p class="text-gray-300"><span class="math">r:=r(k)=\\frac{g-1+k}{g}.</span></p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">We will fix a set of factor base <span class="math">B</span> with $</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">B</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">=q^{r}$.</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">######</p>

    <p class="text-gray-300">Lemma 3.</p>

    <div class="my-4 text-center"><span class="math-block">2r &amp;gt; 1 + k &amp;gt; 1 &amp;gt; \\frac{1 + r}{2} = \\frac{2g + k - 1}{2g} &amp;gt; \\frac{(g - 1) + (g + 1)k}{g}.</span></div>

    <p class="text-gray-300">Proof. trivial.</p>

    <p class="text-gray-300">The whole algorithm consists of the following 7 parts.</p>

    <p class="text-gray-300">Input <span class="math">C / \\mathbb{F}_q</span> hyper elliptic curve of small genus <span class="math">g</span>, <span class="math">D_1, D_2 \\in J_q</span> such that <span class="math">D_2 \\in \\langle D_1 \\rangle</span>.</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Output Integer <span class="math">\\lambda</span> modulo $</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">J_q</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"><span class="math"> such that </span>D_2 = \\lambda D_1$.</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">1 Computing all points of <span class="math">C(\\mathbb{F}_q)</span> and making <span class="math">\\mathcal{P}</span> and fix <span class="math">B \\subset \\mathcal{P}</span> with $</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">B</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">= q^r$.</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">2 Gathering 2-almost smooth divisors and almost smooth divisors</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Computing a set <span class="math">V_2</span> of 2-almost smooth points and a set <span class="math">V_1</span> of almost smooth points of <span class="math">J_q</span>, of the form <span class="math">\\alpha D_1 + \\beta D_2</span> with $</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">V_1</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">&gt; 2q^{\\frac{(g - 1) + (g + 1)k}{g}}<span class="math"> and </span></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">V_2</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">&gt; q^{1 + k}$.</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">3 Computing a set of almost smooth divisor <span class="math">H_m</span> with $</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">H_m</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">&gt; q^{(1 + r) / 2}$.</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">4 Computing a set of smooth divisor <span class="math">H</span> with $</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">H</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">&gt; q^r$.</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">5 Solving linear algebra of the size <span class="math">q^r \\times q^r</span></p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Computing integers <span class="math">\\{r_h\\}_{h\\in H}</span> modulo $</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">J_q</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"><span class="math">, satisfying </span>\\sum_{h\\in H}r_hh\\equiv 0\\bmod</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">J_q</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">$.</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">6 Computing integers <span class="math">\\{s_v\\}_{v\\in V_1\\cup V_2}</span> modulo $</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">J_q</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"><span class="math">, satisfying </span>\\sum_{v\\in V_1\\cup V_2}s_vv\\equiv 0\\bmod</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">J_q</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">$.</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">7 Computing <span class="math">\\lambda</span></p>

    <p class="text-gray-300">|  Algorithm 1 Gathering the 2-almost smooth pts and almost smooth pts  |   |</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">---</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">---</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">|  Input: C/ Fq curve of genus g, D1, D2 ∈ JacC(Fq)  |   |</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Output: V1 a set of almost smooth divisors, V2 a set of 2-almost smooth divisors such that</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">A2</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">> q1+k,</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">V1</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">> 2q(q-1)+(g+1)k/g, Inte-gers {(αv,βv)}v∈V1∪V2 such that v = αvD1 + βvD2</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">|  1: V1←{}, V2←{}  |   |</p>

    <p class="text-gray-300">|  2: repeat  |   |</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">3: Let α,β be random numbers modulo</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Jq</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">|  4: Compute v = αJ1 + βJ2  |   |</p>

    <p class="text-gray-300">|  5: if v is almost smooth then  |   |</p>

    <p class="text-gray-300">|  6: V1← V1 ∪ {v}  |   |</p>

    <p class="text-gray-300">|  7: (αv,βv)← (α,β)  |   |</p>

    <p class="text-gray-300">|  8: end if  |   |</p>

    <p class="text-gray-300">|  9: if v is 2-almost smooth then  |   |</p>

    <p class="text-gray-300">|  10: V2← V2 ∪ {v}  |   |</p>

    <p class="text-gray-300">|  11: (αv,βv)← (α,β)  |   |</p>

    <p class="text-gray-300">|  12: end if  |   |</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">13: until</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">A2</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">> q1+k and</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">V1</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">> 2q(q-1)+(g+1)k/g</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">|  14: return V1,V2,{ (αv,βv)}v∈V1∪V2  |   |</p>

    <p class="text-gray-300">Lemma 4. The probability that a point in  <span class="math">J_{q}</span>  is almost smooth is</p>

    <div class="my-4 text-center"><span class="math-block">\\frac {1}{(g - 1) !} q ^ {(- 1 + r) (g - 1)}</span></div>

    <p class="text-gray-300">and the probability that a point is 2-almost smooth is</p>

    <div class="my-4 text-center"><span class="math-block">\\frac {1}{2 (g - 2) !} q ^ {(- 1 + r) (g - 2)}.</span></div>

    <p class="text-gray-300">Proof. We can get above lemma similarly from proposition 3,4,5 in [1]. For example, the probability of 2-almost smooth points is roughly estimated by</p>

    <div class="my-4 text-center"><span class="math-block"></span></div>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\frac {(2</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">B</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">) ^ {g - 2} (2</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\mathcal {P} \\backslash B</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">) ^ {2}}{2 ! (g - 2) !} \\div</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">J _ {q}</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\doteq \\frac {(q ^ {r}) ^ {g - 2} q ^ {2}}{2 ! (g - 2) ! q ^ {g}} = \\frac {1}{2 (g - 2) !} q ^ {(- 1 + r) (g - 2)}.</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <div class="my-4 text-center"><span class="math-block"></span></div>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">From this lemma, the number of the loops that  $</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">V_2</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">&gt; q^{1 + k}$  is estimated by</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <div class="my-4 text-center"><span class="math-block">q ^ {(1 + k)} \\cdot 2 (g - 2)! q ^ {(1 - r) (g - 2)} = 2 (g - 2)! q ^ {2 r},</span></div>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">and the number of the loops that $</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">V_{1}</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">>2q^{\\frac{(g-1)+(g+1)k}{g}}$ is estimated by</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300"><span class="math">2q^{\\frac{(g-1)+(g+1)k}{g}}\\cdot(g-1)!q^{(1-r)(g-1)}=2(g-1)!q^{2r}.</span></p>

    <p class="text-gray-300">Since the cost of computing Jacobian <span class="math">v=\\alpha D_{1}+\\beta D_{2}</span> is <span class="math">O(g^{2}(\\log q)^{2})</span> and the cost of judging whether <span class="math">v</span> is potentially smooth or not is <span class="math">O(g^{2}(\\log q)^{3})</span>, the total cost of this part is estimated by</p>

    <p class="text-gray-300"><span class="math">O(g^{2}(g-1)!(\\log q)^{3}q^{2r}).</span></p>

    <p class="text-gray-300">Here, we will estimate the required storage. Note that the bit-length of one relative smooth point is <span class="math">2g\\,\\log q</span>. So, the storage for <span class="math">V_{1}</span>, the set of almost smooth divisors, is <span class="math">O(g\\,\\log q\\,q^{\\frac{(g-1)+(g+1)k}{g}})</span> and the storage for <span class="math">V_{2}</span>, the set of 2-almost smooth divisors, is <span class="math">O(g\\,\\log q\\,q^{(1+k)})</span>. From lemma 3, we have <span class="math">g\\,\\log q\\,q^{(1+k)}&gt;&gt;g\\,\\log q\\,q^{\\frac{(g-1)+(g+1)k}{g}}</span>. So the total required storage can be estimated by</p>

    <p class="text-gray-300"><span class="math">O(g\\,\\log q\\,q^{(1+k)}).</span></p>

    <h2 id="sec-20" class="text-2xl font-bold">5 Elimination of large prime (Flame work)</h2>

    <p class="text-gray-300">Let <span class="math">E</span> be a set of smooth divisors, and let <span class="math">F</span> be a set of 2-almost smooth divisors or a set of smooth divisors. Note that element <span class="math">e\\in E</span> and <span class="math">f\\in F</span> are written by</p>

    <p class="text-gray-300"><span class="math">e=\\sum_{P\\in B}n_{P}^{(e)}P+n_{P_{1}}^{(e)}P_{1},</span> <span class="math">f=\\sum_{P\\in B}n_{P}^{(f)}P+n_{P_{2}}^{(f)}P_{2}(+n_{P_{3}}^{(f)}P_{3}).</span></p>

    <p class="text-gray-300">Put <span class="math">\\sup(e):=\\{P_{1}\\}</span> and <span class="math">\\sup(f):=\\{P_{2},(P_{3})\\}</span>. When <span class="math">P\\in\\sup(e)\\cap\\sup(f)</span>, put</p>

    <p class="text-gray-300"><span class="math">\\phi(e,f,P):=n_{p}^{(f)}e-n_{p}^{(e)}f.</span></p>

    <p class="text-gray-300">Trivially, <span class="math">\\phi(e,f,P)</span> is almost smooth divisor, if <span class="math">F</span> is a set of 2-almost smooth divisors and <span class="math">\\phi(e,f,P)</span> is smooth divisor, if <span class="math">F</span> is a set of almost smooth divisors and <span class="math">e</span> is not of the form constant times <span class="math">f</span>.</p>

    <h6 id="sec-21" class="text-base font-medium mt-4">Definition 9.</h6>

    <p class="text-gray-300">\\[ e\\mathbb{O}f:=\\begin{cases}\\phi(e,f,P)&\\text{if }P\\in\\mathbf{sup}(a)\\cap\\mathbf{sup}(b)\\text{ and }e\\neq\\text{Const}\\times f\\\\ \\emptyset&\\text{otherwise.}\\end{cases} \\] <span class="math">E\\mathbb{O}F:=\\cup_{e\\in E,f\\in F}\\,e\\mathbb{O}f.</span></p>

    <h6 id="sec-22" class="text-base font-medium mt-4">Lemma 5.</h6>

    <p class="text-gray-300"><span class="math">E\\mathbb{O}F</span> is a set of almost smooth (resp. smooth) divisors, if <span class="math">F</span> is a set of <span class="math">2</span>-almost smooth (resp. almost smooth) divisors.</p>

    <h6 id="sec-23" class="text-base font-medium mt-4">Proof.</h6>

    <p class="text-gray-300">Trivial!</p>

    <p class="text-gray-300">We will estimate the size of  <span class="math">E \\heartsuit F</span> .</p>

    <p class="text-gray-300">Lemma 6. The size of  <span class="math">E \\heartsuit F</span>  is estimated by</p>

    <div class="my-4 text-center"><span class="math-block"></span></div>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">E \\heartsuit F</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">= \\left\\{ \\begin{array}{l l}</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">E</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">F</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">/ q &amp; \\text {i f F i s 2 - a l m o s t s m o o t h} \\\\ \\frac {1}{2}</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">E</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">F</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">/ q &amp; \\text {i f F i s a l m o s t s m o o t h} \\end{array} \\right.</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <div class="my-4 text-center"><span class="math-block"></span></div>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Proof. Let  <span class="math">e \\in E</span> ,  <span class="math">f \\in F</span>  be randomly chosen elements. Put  <span class="math">P \\coloneqq \\sup(e)</span> . If  <span class="math">F</span>  is a set of 2-almost smooth divisors (resp. almost smooth divisors), the probability that  <span class="math">P \\in \\sup(f)</span>  is  $\\frac{2}{</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\mathcal{P} \\setminus B</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">} \\doteq \\frac{1}{q}<span class="math">  (resp.  </span>\\frac{1}{</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\mathcal{P} \\setminus B</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">} \\doteq \\frac{1}{2q}<span class="math"> ), and the size is estimated by  </span>\\frac{1}{q} \\times</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">E</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">F</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"><span class="math">  (resp.  </span>\\frac{1}{2q} \\times</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">E</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">F</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">$ ).</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">In order to compute  <span class="math">E \\heartsuit F</span> , we use this algorithm.</p>

    <p class="text-gray-300">Algorithm 2 Heartsuit operator Input:  <span class="math">E,F</span> Output:  <span class="math">E\\heartsuit F</span></p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">1: set  $\\mathcal{P}\\backslash B = \\{R_1,R_2,\\dots ,R_{</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\mathcal{P}\\backslash B</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">}\\}$</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">3:  <span class="math">st[i]\\gets \\{\\}</span> 4: od 5: for all  <span class="math">e\\in E</span>  do 6:  <span class="math">P = \\sup (e)</span> 7: Compute i s.t.  <span class="math">P = R_{i}</span> 8:  <span class="math">st[i]\\gets st[i]\\cup \\{e\\}</span> 9: od 10:  <span class="math">V\\gets \\{\\}</span> 11: for all  <span class="math">f\\in F</span>  do 12: for all  <span class="math">P\\in \\sup (f)</span>  do 13: Compute i s.t.  <span class="math">P = R_{i}</span> 14: if  <span class="math">st[i]\\neq \\emptyset</span>  then 15: for all  <span class="math">e\\in st[i]</span>  s.t.  <span class="math">e\\neq Const\\times f</span>  do 16:  <span class="math">V\\gets V\\cup \\{\\phi (e,f,P)\\}</span> 17: od 18: end if 19: od 20: od 21: return H</p>

    <p class="text-gray-300">We will estimate the cost and the storage for computing  <span class="math">E \\heartsuit F</span> .</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Lemma 7. Put  $c_{1} \\coloneqq \\max \\{l(e)</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">e \\in E\\}<span class="math">  and  </span>c_{2} \\coloneqq \\max \\{l(f)</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">f \\in F\\}<span class="math"> . Assume that  </span></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">E</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">&lt; q<span class="math"> . Then the cost of computing  </span>E \\heartsuit F$  is</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">$O(c_{1}(\\log q)^{2}</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">E</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">) + O((\\log q)^{2}</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">F</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">) + O((c_{1} + c_{2})(\\log q)^{2}</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">E</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">F</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">/ q)$</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">and the required storage is</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">$O(c_{1}\\log q</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">E</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">) + O((c_{1} + c_{2})\\log q</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">E</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">F</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">/ q).$</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Proof. The required storage for  <span class="math">st[i]</span>  is  $O(c_{1} \\log q</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">E</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">)<span class="math">  and the required storage for  </span>V<span class="math">  is  </span>O((c_{1} + c_{2}) \\log q</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">E</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">F</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">/ q)<span class="math"> , since  </span></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">V</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\doteq</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">E</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">F</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">/ q<span class="math">  and  </span>\\max \\{l(v)</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">v \\in V\\} = c_{1} + c_{2}$  from lemma 2.</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Note that the cost of the routine "Computing index  <span class="math">i</span> " is  $\\log q \\log</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\mathcal{P} \\backslash B</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">= O((\\log q)^2)<span class="math"> . Also note that  </span></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">E \\heartsuit F</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">= O(</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">E</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">F</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">/ q)<span class="math">  and remark that the probability of  </span>st[i] \\neq \\emptyset<span class="math">  is very small, since  </span></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">E</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">&lt;&lt; q<span class="math"> . Thus, we see that the cost of the 1st loop is  </span>O(c_1(\\log q)^2</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">E</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">)<span class="math"> , the cost of the part &quot;Computing index  </span>i<span class="math"> &quot; of the 2nd loop is  </span>O((\\log q)^2</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">F</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">)<span class="math"> , and the cost of the part &quot;Computing the elements of  </span>V<span class="math"> &quot; of the 2nd loop is  </span>O((c_1 + c_2)(\\log q)^2</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">E</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">F</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">/ q)$  from lemma 2.</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">In this section, we will construct  <span class="math">H_{m}</span>  a set of almost smooth divisors  $</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">H_{m}</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">&gt; 2q^{(1 + r) / 2}$ .</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">Algorithm 3 Computing  <span class="math">H_{m}</span></p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Input:  <span class="math">V_{1}</span>  a set of almost smooth divisors s.t.  $</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">V_{1}</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">&gt; 2q^{\\frac{(g - 1) + (g + 1)k}{g}}<span class="math"> </span>V_{2}<span class="math">  a set of 2-almost smooth divisors s.t.  </span></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">V_{2}</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">&gt; q^{(1 + k)}$</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">1:  <span class="math">H_{1}\\gets V_{1}</span> 2:  <span class="math">i\\gets 1</span> 3: repeat 4:  <span class="math">i + +</span> 5:  <span class="math">H_{i}\\gets H_{i - 1}\\heartsuit V_{2}</span></p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">6: until  $</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">H_i</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">&gt; 2q^{(1 + r) / 2}$</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">7:  <span class="math">m\\gets i</span> 8: return  <span class="math">m,H_{m}</span></p>

    <p class="text-gray-300">From lemma 6, the size of  <span class="math">H_{i}</span>  is estimated by</p>

    <div class="my-4 text-center"><span class="math-block"></span></div>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">H _ {i}</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">=</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">H _ {1}</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\times (q ^ {k}) ^ {i - 1} = 2 q ^ {\\frac {(g - 1) + (g i + 1) k}{g}}.</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <div class="my-4 text-center"><span class="math-block"></span></div>

    <p class="text-gray-300">So, solving the equation  <span class="math">\\frac{(g - 1) + (g i + 1)k}{g} = (1 + r(k)) / 2</span>  for  <span class="math">i</span> , we have the following.</p>

    <p class="text-gray-300">Lemma 8.  <span class="math">m</span>  is estimated by</p>

    <div class="my-4 text-center"><span class="math-block">\\frac {1 - k}{2 g k}.</span></div>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Further, we will assume  <span class="math">m = O\\left(\\frac{1}{gk}\\right)</span> . Note that  $\\{l(v)</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">v\\in \\cup_{i\\leq m}H_i\\} \\leq mg<span class="math"> . From lemma 7, the cost for computing  </span>H_{m}$  is</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <div class="my-4 text-center"><span class="math-block">m \\times (O ((\\log q) ^ {2} q ^ {(1 + k)}) + O (m g (\\log q) ^ {2} q ^ {(1 + r) / 2})))</span></div>

    <p class="text-gray-300">and the required storage is</p>

    <p class="text-gray-300"><span class="math">O(mg\\log q\\,q^{(1+r)/2}).</span></p>

    <h2 id="sec-25" class="text-2xl font-bold">7 Computing <span class="math">H</span></h2>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">In this section, we compute <span class="math">H</span> a set of smooth divisors for $</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">H</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">>q^{r}$.</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">Algorithm 4 Computing <span class="math">H</span></p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Input: <span class="math">H_{m}</span> a set of almost smooth divisors s.t. $</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">H_{m}</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">>2q^{(1+r)/2}$</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">1: <span class="math">H\\leftarrow H_{m}\\heartsuit H_{m}</span> 2: return <span class="math">H</span></p>

    <p class="text-gray-300">From lemma 6, the size of <span class="math">H</span> is estimated by</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">$</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">H</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">=</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">H_{m}</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">^{2}/2q=2q^{r}.$</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Note that $\\{l(v)</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">v\\in\\cup_{i\\leq m}H\\}\\leq 2mg<span class="math">. From lemma 7, the cost for computing </span>H$ is</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300"><span class="math">O((\\log q)^{2}q^{(1+r)/2})+O(mg(\\log q)^{2}q^{r})</span></p>

    <p class="text-gray-300">and the required storage is</p>

    <p class="text-gray-300"><span class="math">O(mg\\log q\\,q^{(1+r)/2}).</span></p>

    <h2 id="sec-26" class="text-2xl font-bold">8 Two ways representation of <span class="math">h\\in H</span></h2>

    <p class="text-gray-300">An element <span class="math">h\\in H</span> is written by the form</p>

    <p class="text-gray-300"><span class="math">h=\\sum_{P\\in B}a_{P}^{(h)}D(P),</span></p>

    <p class="text-gray-300">since it is a smooth divisor. Moreover, form its construction, we see easily that</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">$l(h)=\\#\\{P\\in B\\,</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\,a_{P}^{(h)}\\neq 0\\}\\leq 2mg.$</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Set $B=\\{R_{1},R_{2},...,R_{</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">B</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">}\\}$.</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <h6 id="sec-27" class="text-base font-medium mt-4">Definition 10.</h6>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">$Put\\qquad\\text{\\bf vec}(h):=(a_{R_{1}}^{(h)},a_{R_{2}}^{(h)},...,a_{R_{</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">B</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">}}^{(h)}).$</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">The computation of <span class="math">h(=\\text{\\bf vec}(h))</span> means the set of pairs <span class="math">\\{(a_{R_{i}}^{(h)},R_{i})\\}</span> for non-zero <span class="math">a_{R_{i}}^{(h)}</span>. Note that the required storage for one <span class="math">h</span> is <span class="math">O(m\\,g\\,\\log q)</span>.</p>

    <p class="text-gray-300">On the other hands, form its construction, <span class="math">h</span> is written by linear sum of <span class="math">2m</span> elements of <span class="math">V_{1}\\cup V_{2}</span>. i.e.</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">$h=\\sum_{v\\in V_{1}\\cup V_{2}}b_{v}^{(h)}v,\\qquad\\#\\{v\\,</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\,b_{v}^{(h)}\\neq 0\\}=2m.$</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">Definition 11.</p>

    <div class="my-4 text-center"><span class="math-block">P u t \\qquad \\mathbf {v} (h) := \\{(b _ {v} ^ {(h)}, v) \\mid b _ {v} ^ {(h)} \\neq 0 \\}.</span></div>

    <p class="text-gray-300">Note that the required storage for one  <span class="math">\\mathbf{v}(h)</span>  is  <span class="math">O(m\\log q)</span> .</p>

    <p class="text-gray-300">Important Remark By little modifying the algorithm 3,4, we can obtain both representations of  <span class="math">h</span>  of the forms  <span class="math">\\mathbf{vec}(h)</span>  and  <span class="math">\\mathbf{v}(h)</span> . (The order of the cost and the order of the storage for computing  <span class="math">H</span>  is essentially the same.)</p>

    <p class="text-gray-300">Further, we will assume that the computations of  <span class="math">\\mathbf{vec}(h)</span>  and  <span class="math">\\mathbf{v}(h)</span>  are done.</p>

    <h2 id="sec-28" class="text-2xl font-bold">9 Linear algebra</h2>

    <p class="text-gray-300">In this section, we will solve the linear algebra and finding a linear relation of  <span class="math">H</span> .</p>

    <p class="text-gray-300">Algorithm 5 Linear algebra</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Input:  <span class="math">H</span>  a set of smooth divisors such that  $</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">H</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">&gt; q^r$</th>

          </tr>

        </thead>

        <tbody>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">1: Set  $H = \\{h_1,h_2,\\dots,h_{</td>

            <td class="px-3 py-2 border-b border-gray-700">H</td>

            <td class="px-3 py-2 border-b border-gray-700">}\\}$</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">2: Set matrix  $M = (^t\\mathbf{vec}(h_1),^t\\mathbf{vec}(h_2),\\dots,^t\\mathbf{vec}(h_{</td>

            <td class="px-3 py-2 border-b border-gray-700">H</td>

            <td class="px-3 py-2 border-b border-gray-700">}))$</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">3: Solve linear algebra of  <span class="math">M</span>  and compute  $(\\gamma_{1},\\gamma_{2},\\dots,\\gamma_{</td>

            <td class="px-3 py-2 border-b border-gray-700">H</td>

            <td class="px-3 py-2 border-b border-gray-700">})<span class="math">  such that  </span>\\sum_{i = 1}^{</td>

            <td class="px-3 py-2 border-b border-gray-700">H</td>

            <td class="px-3 py-2 border-b border-gray-700">}\\gamma_i\\mathbf{vec}(h_i) = \\vec{0}$</td>

          </tr>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">4: return  <span class="math">\\{\\gamma_i\\}</span></p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Note that the elements of matrix is integers modulo  $</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">J_q</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\doteq q^g<span class="math"> . So the cost of elementary operation modulo  </span>J_q<span class="math">  is  </span>O(g^2 (\\log q)^2)$ .</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300"><span class="math">M</span>  is a sparse matrix of the size  <span class="math">q^r \\times q^r</span> . Note that the number of non-zero elements in one column is  <span class="math">2mg</span> . So, using [4] [5], we can compute  <span class="math">\\{\\gamma_i\\}</span> . Its cost is</p>

    <div class="my-4 text-center"><span class="math-block">O (g ^ {2} (\\log q) ^ {2} \\cdot 2 m g \\cdot q ^ {r} q ^ {r}) = O (m g ^ {3} (\\log q) ^ {2} q ^ {2 r})</span></div>

    <p class="text-gray-300">and the required storage is</p>

    <div class="my-4 text-center"><span class="math-block">O (\\log (q ^ {g}) m g \\cdot q ^ {r}) = O (m g ^ {2} \\log q q ^ {r}).</span></div>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">(The required storage for sparse linear algebra is essentially the storage for non-zero data. Note that the bit length of integer modulo  $</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">J_q</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"><span class="math">  is  </span>\\log (q^g)<span class="math"> , the number of nonzero elements of one row is  </span>mg$ .)</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <h2 id="sec-29" class="text-2xl font-bold">10 Computing  <span class="math">s_v</span></h2>

    <p class="text-gray-300">Remember that each element  <span class="math">h \\in H</span>  is of the form  <span class="math">h = \\sum_{v \\in V_1 \\cup V_2} b_v^{(h)} v</span> . In the previous section, we found  <span class="math">\\{\\gamma_h\\}</span>  such that  <span class="math">\\sum_{h \\in H} \\gamma_h h \\equiv 0 \\mod</span></p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">$</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">J_q</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">$ . So, put</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <div class="my-4 text-center"><span class="math-block"></span></div>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">s _ {v} := \\sum_ {h \\in H} \\gamma_ {h} b _ {v} ^ {(h)} \\bmod</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">J _ {q}</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\quad \\text {f o r a l l} v \\in V _ {1} \\cup V _ {2}</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <div class="my-4 text-center"><span class="math-block"></span></div>

    <p class="text-gray-300">and we have</p>

    <div class="my-4 text-center"><span class="math-block"></span></div>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\sum_ {v \\in V _ {1} \\cup V _ {2}} s _ {v} v \\equiv 0 \\bmod</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">J _ {q}</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">.</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <div class="my-4 text-center"><span class="math-block"></span></div>

    <p class="text-gray-300">Input:  <span class="math">V_{1}, V_{2}, H, \\{\\gamma_{h}\\}_{h \\in H}</span>  s.t.  <span class="math">\\sum_{h \\in H} \\gamma_{h} h \\equiv 0</span></p>

    <p class="text-gray-300">Output:  <span class="math">\\{s_v\\}_{v\\in V_1\\cup V_2}</span></p>

    <p class="text-gray-300">1: for all  <span class="math">v \\in V_1 \\cup V_2</span>  do 2:  <span class="math">s_v \\gets 0</span> 3: od 4: for all  <span class="math">h \\in H</span>  do 5: for all  <span class="math">v \\in V_1 \\cup V_2</span>  s.t  <span class="math">b_v^{(h)} \\neq 0</span>  do 6:  <span class="math">s_v \\gets s_v + \\gamma_h b_v^{(h)}</span> 7: od 8: od 9: return  <span class="math">\\{s_v\\}</span></p>

    <p class="text-gray-300">The cost of this part is</p>

    <div class="my-4 text-center"><span class="math-block">O (g \\log q q ^ {1 + k}) + O (m g ^ {2} (\\log q) ^ {2} q ^ {(1 + r) / 2})</span></div>

    <p class="text-gray-300">and the storage is</p>

    <div class="my-4 text-center"><span class="math-block">O (g \\log q q ^ {1 + k}).</span></div>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">In the previous section, we found  <span class="math">\\{s_v\\}</span>  such that  $\\sum s_v v \\equiv 0 \\mod</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">J_q</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"><span class="math"> . In the part 2 of the algorithm, we have computed  </span>(\\alpha_v, \\beta_v)$  such that</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <div class="my-4 text-center"><span class="math-block">v = \\alpha_ {v} D _ {1} + \\beta_ {v} D _ {2}.</span></div>

    <p class="text-gray-300">So, we have</p>

    <div class="my-4 text-center"><span class="math-block"></span></div>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\sum_ {v \\in V _ {1} \\cup V _ {2}} s _ {v} (\\alpha_ {v} D _ {1} + \\beta_ {v} D _ {2}) = (\\sum_ {v \\in V _ {1} \\cup V _ {2}} s _ {v} \\alpha_ {v}) D _ {1} + (\\sum_ {v \\in V _ {1} \\cup V _ {2}} s _ {v} \\beta_ {v}) D _ {2} \\equiv 0. \\bmod</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">J _ {q}</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <div class="my-4 text-center"><span class="math-block"></span></div>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">So,  $-(\\sum_{v\\in V_1\\cup V_2}s_v\\alpha_v) / (\\sum_{v\\in V_1\\cup V_2}s_v\\beta_v)\\bmod</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">J_q</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">$  is required discreet log.</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">Input:  <span class="math">V_{1}, V_{2}, \\{\\alpha_{v}, \\beta_{v}\\}</span> ,  <span class="math">\\{s_{v}\\}</span></p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Output: Integer  <span class="math">\\lambda</span>  mod  $</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">J_q</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"><span class="math">  s.t.  </span>D_1 = \\lambda D_2$</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">1: return  $-\\left(\\sum_{v \\in V_1 \\cup V_2} s_v \\alpha_v\\right) / \\left(\\sum_{v \\in V_1 \\cup V_2} s_v \\beta_v\\right) \\bmod</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">J_q</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">$</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">Note that the cost of this part is <span class="math">O(g^{2}\\ (\\log q)^{2}\\ q^{1+k})</span>.</p>

    <h2 id="sec-33" class="text-2xl font-bold">12 Cost estimation</h2>

    <p class="text-gray-300">In this section, we will estimate the cost and the required storage of whole algorithm under the assumption of</p>

    <p class="text-gray-300"><span class="math">k=\\frac{1}{\\log q}.</span></p>

    <p class="text-gray-300">First, remember that <span class="math">m=O(\\frac{1}{gk})=O(\\frac{\\log g}{g})</span>. By a direct computation, we have</p>

    <p class="text-gray-300"><span class="math">r=r(k)=\\frac{g-1+k}{g}=1-\\frac{1}{g}+\\frac{1}{g\\log q},</span></p>

    <p class="text-gray-300">and</p>

    <p class="text-gray-300"><span class="math">q^{2r}=q^{2-\\frac{2}{g}}\\times\\exp(\\frac{2}{g})=O(q^{2-\\frac{2}{g}}).</span></p>

    <p class="text-gray-300">From our cost estimation, the cost of the routine except part 2 and part 5 is written by the form</p>

    <p class="text-gray-300"><span class="math">O(g^{a}\\ (\\log q)^{b}\\ q^{c})\\quad a,b\\leq 4,\\ c\\leq 1+k.</span></p>

    <p class="text-gray-300">On the other hands, the cost of the routine part 2 and part 5 is written by</p>

    <p class="text-gray-300"><span class="math">O(g^{2}(g-1)!(\\log q)^{3}q^{2r})\\ \\mbox{and}\\ O(mg^{3}\\ (\\log q)^{2}q^{2r}).</span></p>

    <p class="text-gray-300">From lemma 3, we see <span class="math">1+k&lt;2r</span> and the cost of the whole parts can be estimated by</p>

    <p class="text-gray-300"><span class="math">O(g^{2}(g-1)!(\\log q)^{3}\\ q^{2r})=O(g^{2}(g-1)!(\\log q)^{3}q^{2-\\frac{2}{g}}).</span></p>

    <p class="text-gray-300">Similarly, we see that the required storage (dominant part is part 2 and part 7, since <span class="math">1+k&gt;1&gt;(1+r)/2</span> from lemma 3) is</p>

    <p class="text-gray-300"><span class="math">O(g\\ \\log q\\,q^{1+k})=O(g\\log q\\,q^{1+k})=O(g\\log q\\,q\\ \\mbox{exp}(1))=O(g\\log q\\,q).</span></p>

    <h2 id="sec-34" class="text-2xl font-bold">13 Conclusion</h2>

    <p class="text-gray-300">In ASIACRYPT2003, Thériault presented a variant of index calculus for the Jacobian of hyperelliptic curve of small genus, using almost smooth divisors. Here, we improve Thériault’s result, using 2-almost divisors and propose an attack for DLP of the Jacobian of hyperelliptic curves of small genus, which works <span class="math">O(q^{2-\\frac{2}{g}+e})</span> running time.</p>

    <p class="text-gray-300">##</p>

    <p class="text-gray-300">References</p>

    <ul class="list-disc list-inside space-y-1 text-gray-300 my-2 ml-4">

      <li>[1] N. Thériault, Index calculus attack for hyperelliptic curves of small genus, ASIACRYPT2003, LNCS 2894, Springer-Verlag, 2003, pp. 75–92.</li>

      <li>[2] A. Enge, P. Gaudry, A general framework for subexponential discrete logarithm algorithms, Acta Arith., 102, no. 1, pp. 83–103,2002.</li>

      <li>[3] P.Gaudry, An algorithm for solving the discrete log problem on hyperelliptic curves, Eurocrypt 2000, LNCS 1807, Springer-Verlag, 2000, pp. 19–34.</li>

      <li>[4] B. A. LaMacchia, A. M. Odlyzko, Solving large sparse linear systems over finite fields, Crypto ’90, LNCS 537, Springer-Verlag, 1990, pp. 109–133.</li>

      <li>[5] D. H. Wiedemann, Solving sparse linear equations over finite fields, IEEE Trans. Inform. Theory, IT-32, no.1, pp.54–62, 1986.</li>

    </ul>`;
---

<BaseLayout title="Improvement of Thériault Algorithm of Index Calculus for Jac... (2004/161)">
  <article class="max-w-4xl mx-auto article-prose">
    <nav class="mb-8">
      <a href="/papers" class="text-blue-400 hover:text-blue-300">
        &larr; Back to Papers
      </a>
    </nav>

    <header class="mb-12">
      <h1 class="text-3xl font-bold mb-4"
        set:html={TITLE_HTML} />
      <p class="text-gray-400 mb-2"
        set:html={AUTHORS_HTML} />
      <p class="text-gray-500 text-sm mb-4">
        2004 &middot; eprint 2004/161
      </p>
      <div class="flex gap-4 text-sm">
        <a
          href={EPRINT_URL}
          target="_blank"
          rel="noopener noreferrer"
          class="text-blue-400 hover:text-blue-300"
        >
          Paper (eprint) &rarr;
        </a>
      </div>
      <p class="mt-4 text-xs text-gray-500">
        All content below belongs to the original authors. This page
        reproduces the paper for educational purposes. Always
        <a
          href={EPRINT_URL}
          target="_blank"
          rel="noopener noreferrer"
          class="text-blue-400 hover:text-blue-300"
        >cite the original</a>.
      </p>
      <p class="mt-1 text-xs text-gray-600">
        Converted with: {CRAWLER} &middot; {CONVERTED_DATE}
      </p>
    </header>

    <Fragment set:html={CONTENT} />

  </article>
</BaseLayout>
