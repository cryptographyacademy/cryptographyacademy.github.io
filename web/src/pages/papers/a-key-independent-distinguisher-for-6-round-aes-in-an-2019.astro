---
import BaseLayout from '../../layouts/BaseLayout.astro';
import PaperDisclaimer from '../../components/PaperDisclaimer.astro';
import PaperHistory from '../../components/PaperHistory.astro';

const EPRINT_URL = 'https://eprint.iacr.org/2019/945';
const CRAWLER = 'marker';
const CONVERTED_DATE = '2026-02-16';
const TITLE_HTML = 'A Key-Independent Distinguisher for 6-round AES in an Adaptive Setting';
const AUTHORS_HTML = 'Navid Ghaedi Bardeh';

const CONTENT = `    <section id="abstract" class="mb-10">
      <h2 class="text-2xl font-bold">Abstract</h2>
      <p class="text-gray-300">In this paper, we study the results of the recently proposed exchange attack in an adaptive setting. As expected, it leads to present a better 6-round key-independent distinguisher in terms of data and computational complexities. More specifically, our 6-round adaptive distinguisher requires $2^{83}$ chosen plaintexts and $2^{83}$ adaptively chosen ciphertexts and has a computational cost of $2^{83}$ encryption.</p>
      <p class="text-gray-300"><strong>Keywords:</strong> SPN &middot; AES &middot; Exchange Attack &middot; Secret-Key model &middot; Difference Cryptanalysis</p>
    </section>

    <p class="text-gray-300">In 2000, Rijndael block cipher is accepted as AES (Advance Encryption Standard) by NIST. AES is provably resistant against differential and linear cryptanalysis. During the last 20 years, among to large amount researches [15, 4, 14, 9, 7, 6, 10]), there is only the biclique attack [5] which can break AES faster than exhaustive search. Up to now, the best known key recovery attack in secret key model can break 7-round of AES.</p>

    <p class="text-gray-300">Integral and impossible differential distinguishers on 4-round AES, in secret key model, were best distinguishers (in term of reaching highest rounds) for several years. Recently, since 2016, new developments has been presented for roundreduced AES. These developments showed several basic and unexplored properties for round-reduced AES. First 5-round distinguishers have been appeared in several studies[17, 12, 16, 3, 11, 1, 2]. Some of these 5-round distinguishers have gained more attentions since they can be extended to 6-round distinguishers.</p>

      <h3 id="sec-1.1" class="text-xl font-semibold mt-8">1.1 Overview of 6-round distinguishers on AES</h3>

    <p class="text-gray-300">At Asiacrypt 2017, the authors of [16] presented the first 6-round secret-key distinguishers for AES which requires 2<sup>122</sup>.<sup>8</sup> adaptive chosen plaintexts/ciphertexts and a computational cost of 2<sup>121</sup>.<sup>8</sup> XORs. The authors introduced a new deterministic 4-round property in AES, which states that sets of pairs of plaintexts that are equivalent by exchange of any subset of diagonals encrypts to a set of pairs of ciphertexts after four rounds that all have a difference of zero in exactly the same columns before the final linear layer.</p>

    <p class="text-gray-300">Then, Bardeh and R&oslash;njom [2] presented a new technique called exchange attack. They showed that 6-round of AES is biased when the plaintexts are chosen from a certain set (exchange equivalence sets). Their 6-round distinguisher requires 288.<sup>2</sup> chosen plaintexts and a computational cost of 288.<sup>2</sup> encryption.</p>

    <p class="text-gray-300">Later, Bao, Guo and List [1] presented a 6-round distinguisher requires 289.<sup>43</sup> chosen plaintexts and a computational cost of 296.<sup>52</sup> look-ups into memory. The authors extended a known integral distinguisher to the exception distinguisher.</p>

      <h3 id="sec-1.2" class="text-xl font-semibold mt-8">1.2 Our Contribution</h3>

    <p class="text-gray-300">We investigate the results of exchange attack in an adaptive setting. As results, we present a 5-round adaptive chosen ciphertext distinguisher which it's data complexity is higher than the best current adaptive chosen ciphertext distinguisher. However, it can be extended to a 6-round adaptive chosen ciphertext distinguisher which requires 2<sup>83</sup> chosen plaintexts and 2<sup>83</sup> adaptive chosen ciphertexts, which is as far as we know a new record.</p>

      <h3 id="sec-1.3" class="text-xl font-semibold mt-8">1.3 Overview of This Paper and Main Results</h3>

    <p class="text-gray-300">In Section 2 we briefly describe the exchange attack and it's results on reducedround of AES. In section 3 we present a key independent 5-round ACC distinguisher. In section 4 we introduce an efficient 6-round key-independent ACC distinguisher. The currently best secret-key distinguishers for 5- and 6-round AES are given in Table 1. We adopt that data complexity is measured in a minimum number of chosen plaintexts/ciphertexts CP/CC or adaptively chosen plaintexts/ciphertexts ACP/ACC. Time complexity is measured in equivalent number of AES encryptions (E), memory accesses (M) and/or XOR operations (XOR) - adopting that 20M &asymp; 1 round of AES.</p>

    <p class="text-gray-300">Table 1: Secret-Key Distinguishers for AES</p>

    <div class="overflow-x-auto my-4">
      <table class="min-w-full text-sm text-gray-300">
        <thead>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">Property</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">Rounds</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">Data</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">Cost</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">Ref.</th>
        </thead>
        <tbody>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Integral</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">5</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">128 CP<br>2</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">129.6 XORs<br>2</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">[17]</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Expectation of TD</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">5</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">65 CP<br>2</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">70.2 M<br>2</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">[1]</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Expectation of TD</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">5</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">48.96 CP<br>2</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">46 E<br>2</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">[11]</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Exchange Attack</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">5</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">35.5 CP + 239 ACC<br>2</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">35.5 E<br>2</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Sect. 3</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Multiple-8</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">5</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">32 CP<br>2</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">35.6 M<br>2</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">[13]</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Exchange Attack</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">5</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">30 CP<br>2</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">30E<br>2</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">[2]</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Zero difference</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">5</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">12.2 CP + 227.2 ACC<br>2</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">26.2 XOR<br>2</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">[3]</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Zero difference</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">5</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">26.8 ACC<br>2</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">25.8 XOR<br>2</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">[16]</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Zero difference</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">6</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">122.8 ACC<br>2</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">121.8 XOR<br>2</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">[16]</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Expectation of TD</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">6</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">89.43 CP<br>2</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">96.52 M<br>2</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">[1]</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Exchange Attack</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">6</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">88.2 CP<br>2</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">88.2E<br>2</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">[2]</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Exchange Attack</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">6</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">83 CP + 283 ACC<br>2</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">83 E<br>2</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Sect. 4</td>
          </tr>
        </tbody>
      </table>
    </div>

    <section id="sec-2" class="mb-10">
      <h2 class="text-2xl font-bold">2 Preliminaries</h2>

    <p class="text-gray-300">The Advanced Encryption Standard (AES)[8] is the most widely adopted block cipher in the world today and is a critical component in protecting information in both commercial and high-assurance communication. The AES internal state is typically represented by a 4 by 4 matrix in  <span class="math">\\mathbb{F}_{2^8}^{4\\times4}</span> . The matrix representation is for the most part purely representational as the actual properties of the matrix (e.g. rank, order etc.) are not actually exploited for anything. One full round of AES consists of SubBytes (SB), ShiftRows (SR), MixColumns (MC) and AddKey (AK). The SB-layer applies a fixed permutation over  <span class="math">\\mathbb{F}_{2^8}</span>  independently to each byte of the state, the SR-layer cyclically shifts the <em>i</em>-th row by <em>i</em> positions, while the MC-layer applies a fixed linear transformation to each column. The key addition adds a secret round-dependent value to the state. One full round is composed as  <span class="math">R = AK \\circ MC \\circ SR \\circ SB</span> . We follow standard convention and simplify notation by writing  <span class="math">R^t(x)</span>  to mean t rounds of AES where each round key is fixed to some random value.</p>

    <p class="text-gray-300">We recall the exchange attack presented in [2]. Here, we recall the basic definitions and Theorems presented in the exchange attack to use them for presenting our results.</p>

    <p class="text-gray-300"><strong>Definition 1.</strong> [2] For a vector  <span class="math">v \\in \\mathbb{F}_2^4</span>  and a pair of states  <span class="math">\\alpha, \\beta \\in \\mathbb{F}_{2^8}^{4 \\times 4}</span>  define the column exchange difference  <span class="math">\\Delta_v \\stackrel{def}{=} \\Delta_v^{\\alpha,\\beta} \\in \\mathbb{F}_{2^8}^{4 \\times 4}</span>  where the i-th column is defined by</p>

    <p class="text-gray-300"><span class="math">$(\\Delta_v)_i = (\\alpha_i \\oplus \\beta_i)v_i</span>$</p>

    <p class="text-gray-300">where  <span class="math">\\alpha_i</span>  and  <span class="math">\\beta_i</span>  are the i-th columns of  <span class="math">\\alpha</span>  and  <span class="math">\\beta</span> .</p>

    <p class="text-gray-300">A pair of states define a set of  <span class="math">2^{wt_c(\\alpha \\oplus \\beta)}</span>  possible column exchange differences where  <span class="math">wt_c(x)</span>  denotes the number of non-zero columns of x. We can now define three related operators that exchange diagonal, column and mixed values between a pair of AES states.</p>

    <p class="text-gray-300"><strong>Definition 2</strong> (Column exchange). [2] For a vector  <span class="math">v \\in \\mathbb{F}_2^4</span>  and a pair of states  <span class="math">\\alpha, \\beta \\in \\mathbb{F}_{2^8}^{4 \\times 4}</span> , define column exchange according to v as</p>

    <p class="text-gray-300"><span class="math">$\\rho_c^v(\\alpha,\\beta) = \\alpha \\oplus \\Delta_v.</span>$</p>

    <p class="text-gray-300">It is easy to see that the pair of states  <span class="math">(\\rho_c^v(\\alpha, \\beta), \\rho_c^v(\\beta, \\alpha)) = (\\alpha \\oplus \\Delta_v, \\beta \\oplus \\Delta_v)</span>  are formed by exchanging individual columns between  <span class="math">\\alpha</span>  and  <span class="math">\\beta</span>  according to the binary coefficients of v. Thus, for any v it is easy to see that</p>

    <p class="text-gray-300"><span class="math">$\\alpha \\oplus \\beta = \\rho_c^v(\\alpha, \\beta) \\oplus \\rho_c^v(\\beta, \\alpha).</span>$</p>

    <p class="text-gray-300"><strong>Definition 3</strong> (<em>Diagonal exchange</em>). [2] For a vector  <span class="math">v \\in \\mathbb{F}_2^4</span>  and a pair of states  <span class="math">\\alpha, \\beta \\in \\mathbb{F}_{2^8}^{4 \\times 4}</span> , define diagonal exchange according to v as</p>

    <p class="text-gray-300"><span class="math">$\\rho_d^v(\\alpha, \\beta) = \\alpha \\oplus SR^{-1}(\\Delta_v^{SR(\\alpha)), SR(\\beta)}).</span>$</p>

    <p class="text-gray-300">The new pair  <span class="math">(\\rho_d^v(\\alpha, \\beta), \\rho_d^v(\\beta, \\alpha))</span>  is formed by exchanging individual diagonals between  <span class="math">\\alpha</span>  and  <span class="math">\\beta</span>  according to the binary coefficients of v. The relationship between exchange of diagonals and exchange of columns is intuitively straightforward.</p>

    <p class="text-gray-300"><strong>Lemma 1.</strong> [2] From the definition of  <span class="math">\\rho_d^v</span>  and  <span class="math">\\rho_c^v</span>  it follows that</p>

    <p class="text-gray-300"><span class="math">$R(\\rho_d^v(\\alpha, \\beta)) = \\rho_c^v(R(\\alpha), R(\\beta)).</span>$</p>

    <p class="text-gray-300"><strong>Definition 4 (Mixed exchange).</strong> [2] For a vector  <span class="math">v \\in \\mathbb{F}_2^4</span>  and a pair of states  <span class="math">\\alpha, \\beta \\in \\mathbb{F}_{28}^{4 \\times 4}</span>  define mixed exchange according to v as</p>

    <p class="text-gray-300"><span class="math">$\\rho_m^v(\\alpha,\\beta) = a \\oplus L(\\Delta_v^{L^{-1}(\\alpha),L^{-1}(\\beta)})</span>$</p>

    <p class="text-gray-300">where  <span class="math">L = MC \\circ SR</span> .</p>

    <p class="text-gray-300"><strong>Lemma 2.</strong> [2] From the definition of  <span class="math">\\rho_c^v</span>  and  <span class="math">\\rho_m^v</span>  it follows that</p>

    <p class="text-gray-300"><span class="math">$R(\\rho_c^v(\\alpha,\\beta)) = \\rho_m^v(R(\\alpha),R(\\beta)).</span>$</p>

    <p class="text-gray-300"><strong>Lemma 3.</strong> [2] For two random states  <span class="math">\\alpha, \\beta</span>  and some non-zero vector  <span class="math">v \\in \\mathbb{F}_2^4</span> , we have that</p>

    <p class="text-gray-300"><span class="math">$R^{2}(\\rho_{d}^{v}(\\alpha,\\beta)) = \\rho_{m}^{v}(R^{2}(\\alpha), R^{2}(\\beta)).</span>$</p>

    <p class="text-gray-300">To indicate the zero column(s) of a state  <span class="math">x \\in \\mathbb{F}_{28}^{4 \\times 4}</span> , we define  <span class="math">\\nu(x)</span>  which denotes the binary indicator vector which is 0 in position i if the i-th column of x is zero and 1 otherwise. We also are interested to know the zero column of a state after/before the first and last linear layer so we define,  <span class="math">L = SR \\circ MC</span> ,  <span class="math">\\nu_m(x) = \\nu(L^{-1}(x))</span>  and  <span class="math">\\nu_d(x) = \\nu(SR(x))</span> . For a subset  <span class="math">I \\subset \\{0,1,2,3\\}</span> , we write  <span class="math">v^I \\in \\mathbb{F}_2^4</span>  to mean the indicator vector which has value  <span class="math">v^I_i = 1</span>  if  <span class="math">i \\in I</span>  and 0 otherwise.</p>

    <p class="text-gray-300"><strong>Theorem 1.</strong> [2] Let  <span class="math">I, J, K \\subset \\{0, 1, 2, 3\\}</span>  and  <span class="math">\\alpha, \\beta \\in \\mathbb{F}_{28}^{4 \\times 4}</span>  be two random states. Then the probability that a set of diagonals J are exchanged, given that a set of columns I are exchanged when the difference  <span class="math">\\alpha \\oplus \\beta</span>  is zero in columns indicated by K, i.e.</p>

    <p class="text-gray-300"><span class="math">$\\Pr((\\rho_d^{v^J}(\\alpha,\\beta),\\rho_d^{v^J}(\\beta,\\alpha)) = (\\rho_c^{v^I}(\\alpha,\\beta),\\rho_c^{v^I}(\\beta,\\alpha)))</span>$</p>

    <p class="text-gray-300">is given by</p>

    <p class="text-gray-300"><span class="math">$p(|I|, |J|, |K|) = (2^{-8})^{4(|I|+|J|)-|K||J|-2|I|\\cdot|J|}</span>$
.</p>

    <p class="text-gray-300"><strong>Theorem 2.</strong> [2] Let  <span class="math">\\alpha, \\beta \\in \\mathbb{F}_{28}^{4 \\times 4}</span>  denote two plaintexts equal in |K| diagonals indicated by  <span class="math">K \\subset \\{0,1,2,3\\}</span>  and assume  <span class="math">0 &lt; \\operatorname{wt}(\\nu(R^5(\\alpha) \\oplus R^5(\\beta))) &lt; 4</span> . Then for a non-trivial choice of  <span class="math">I \\subset \\{0,1,2,3\\} \\setminus K</span>  the relation</p>

    <p class="text-gray-300"><span class="math">$\\nu_m(R^5(\\alpha) \\oplus R^5(\\beta))) = \\nu_m(R^5(\\rho_d^{v^I}(\\alpha, \\beta)) \\oplus R^5(\\rho_d^{v^I}(\\beta, \\alpha)))</span>$</p>

    <p class="text-gray-300">holds with probability</p>

    <p class="text-gray-300"><span class="math">$p_5(|I|, |K|) = \\sum_{d=1}^{3} {4 \\choose d} p(|I|, d, |K|)</span>$</p>

    <p class="text-gray-300">We remark that the result of previous Theorem works as well in decryption direction by applying an appropriate exchange operation considering the corresponding linear layer.</p>

    </section>

    <section id="sec-3" class="mb-10">
      <h2 class="text-2xl font-bold">3 5-round ACC distinguisher</h2>

    <p class="text-gray-300">In this section we show how to one can use the result of Theorem 2 in an adaptive setting.</p>

    <p class="text-gray-300"><strong>Theorem 3.</strong> Let  <span class="math">p^0, p^1 \\in \\mathbb{F}_{2^8}^{4 \\times 4}</span>  denote two plaintexts and assume  <span class="math">0 &lt; \\text{wt}(\\nu_d(p^0 \\oplus p^1)) &lt; 4</span> . Then for a non-trivial choice of  <span class="math">I \\subset \\{0, 1, 2, 3\\}</span>  the relation</p>

    <p class="text-gray-300"><span class="math">$\\nu_d(p^0 \\oplus p^1) = \\nu_d(R^{-5}(\\rho_m^{v^I}(R^5(p^0), R^5(p^1)) \\oplus R^{-5}(\\rho_m^{v^I}(R^5(p^1), R^5(p^0)))</span>$</p>

    <p class="text-gray-300">holds with probability</p>

    <p class="text-gray-300"><span class="math">$p_5(|I|, 0) = \\sum_{d=1}^{3} {4 \\choose d} p(|I|, d, 0)</span>$</p>

    <p class="text-gray-300">Since ciphertexts are random, we consider only the case |K| = 0 in Theorem 3. We can set up a 5-round distinguisher based on the result of Theorem 3. The idea is to generate a new plaintext pair adaptively such that:</p>

    <p class="text-gray-300"><span class="math">$\\nu_d(p^0 \\oplus p^1) = \\nu_d(R^{-5}(\\rho_m^{v^I}(R^5(p^0), R^5(p^1)) \\oplus R^{-5}(\\rho_m^{v^I}(R^5(p^1), R^5(p^0)))</span>$
<span class="math">$= \\nu_d(p&#x27;^0 \\oplus p&#x27;^1)</span>$</p>

    <p class="text-gray-300">Let  <span class="math">wt(\\nu_d(p^0 \\oplus p^1)) = d</span> , then if  <span class="math">p_5(|I|, 0)</span>  is higher than  <span class="math">2^{-32 \\cdot (4-d)}</span> , the probability of this event at random, we can distinguish 5-round AES from a random permutation. If we set d = 2, (i.e. the difference of the plaintexts is zero in two diagonals, and |I| = 1 then we get that  <span class="math">p_5(|I|, 0) = 2^{-46}</span>  while it is  <span class="math">2^{-64}</span>  for random case.</p>

    <p class="text-gray-300">Now, to set up a 5-round distinguisher, adversary prepares  <span class="math">2^{23.5}</span>  plaintexts where bytes in the first two diagonals take random values and other diagonals take a random constant. Then he can generate  <span class="math">2^{46}</span>  pairs and at least one of them verify the upper trail of Figure 1. Then he applys the Mixed exchange operator to all ciphertext pairs and decrypt new ciphertext pairs. So he expects to observe a new plaintext pair such that</p>

    <p class="text-gray-300"><span class="math">$\\nu_d(p^i \\oplus p^j) = \\nu_d(p&#x27;^i \\oplus p&#x27;^j)</span>$
<span class="math">$= (1, 1, 0, 0)</span>$</p>

    <p class="text-gray-300">Thus adversary can distinguish 5-round AES from a random permutation using  <span class="math">2^{23.5}</span>  chosen plaintexts and  <span class="math">2 \\cdot 2^{46} = 2^{47}</span>  adaptively chosen ciphertexts. The data complexity can be reduced by adding a certain condition on the ciphertext pairs. Suppose that after 3-round encryption, the k-th diagonal in the difference of states,  <span class="math">R^3(p^i) \\oplus R^3(p^j)</span> , is zero then adversary can filter ciphertext pairs which</p>

    <p class="text-gray-300">    <img src="_page_5_Figure_2.jpeg" alt="" class="my-4 max-w-full" />
</p>

    <p class="text-gray-300">Fig. 1: 5-round exchange trail</p>

    <p class="text-gray-300">have a zero column in their difference before last linear layer. So the probability of exchange trail is  <span class="math">2^{-46-24}=2^{-70}</span> . Now adversary prepares  <span class="math">2^{35.5}</span>  plaintexts where the first two diagonals take  <span class="math">2^{35.5}</span>  random values, and the remaining diagonals are fixed to a constant. Thus he can construct  <span class="math">2^{70}</span>  ciphertext pairs and filter the ciphertext pairs such that only  <span class="math">2^{70-32}=2^{38}</span>  of them are remained. For each of remaining pairs, he decrypts the new ciphertext pair formed by applying the mixed exchange operation on them,  <span class="math">\\rho_m^{v^I}</span>  and estimates one of new generated plaintext pair is differ in the first two diagonals. Hence, he can distinguish 5-round AES from a random permutation using  <span class="math">2^{35.5}</span>  chosen plaintexts and  <span class="math">2 \\cdot 2^{38} = 2^{39}</span>  adaptively chosen ciphertexts.</p>

    <p class="text-gray-300">In this section we present a 6-round key-independent distinguisher for AES in an adaptive setting. We extent the 5-round distinguisher to 6-round one by adding one round at beginning of it. Now, the idea of setting up a distinguisher is as follows. Suppose a plaintext pair, which differ in only a diagonal, verifies the upper trail in Figure 2. Then we generate two new ciphertexts by</p>

    <p class="text-gray-300"><span class="math">$(c&#x27;^0,c&#x27;^1)=(\\rho_m^{v^I}(R^6(p^1),R^6(p^0)),\\rho_m^{v^I}(R^6(p^0),R^6(p^1)))</span>$</p>

    <p class="text-gray-300">and decrypt them. Then according to Theorem 3, we have that</p>

    <p class="text-gray-300"><span class="math">$wt(\\nu_d(R(p^0) \\oplus R(p^1))) = wt(\\nu_d(R^{-5}(c&#x27;^0) \\oplus R^{-5}(c&#x27;^1)))</span>$
=1</p>

    <p class="text-gray-300">with probability  <span class="math">2^{-46}</span> . Also we are interested in the following condition:</p>

    <p class="text-gray-300"><span class="math">$wt(\\nu_d(p^0 \\oplus p^1)) = wt(\\nu_d(R^{-6}(c&#x27;^0) \\oplus R^{-6}(c&#x27;^1)))</span>$</p>

    <p class="text-gray-300">=  <span class="math">wt(\\nu_d(p&#x27;^0 \\oplus p&#x27;^1))</span>
= 1</p>

    <p class="text-gray-300">This condition happens with probability  <span class="math">2^{-22} \\cdot 2^{-22}</span>  ( <span class="math">2^{-22}</span>  for each pair). So, in total, with probability  <span class="math">(2^{-22})^2 \\cdot 2^{-46} = 2^{-90}</span>  we expect that we have two new plaintexts,  <span class="math">p^{0}</span>  and  <span class="math">p^{1}</span> , such that they differ in only one diagonal. For a random</p>

    <p class="text-gray-300">    <img src="_page_6_Figure_2.jpeg" alt="" class="my-4 max-w-full" />
</p>

    <p class="text-gray-300">Fig. 2: 6-round exchange trail</p>

    <p class="text-gray-300">permutation, the probability that two plaintexts differ in only one diagonal is  <span class="math">4 \\cdot 2^{-96} = 2^{-94}</span> . Now, we prepare a structure of  <span class="math">2^{32}</span>  plaintexts where the first diagonal takes all possible 2<sup>32</sup> values, and the remaining diagonals are fixed to some constants. Thus we can construct  <span class="math">2^{63}</span>  plaintext pairs and thus we will need to encrypt  <span class="math">2^{90-63}=2^{27}</span>  structures. Hence, we can distinguish 6-round AES from a random permutation using  <span class="math">2^{32+27} = 2^{59}</span>  chosen plaintexts and  <span class="math">2 \\cdot 2^{90} = 2^{91}</span> adaptively chosen ciphertexts. Similar to the 5-round distinguisher, the data complexity can be reduced by adding a certain condition on the ciphertext pairs. Suppose that after 4-round encryption, the k-th diagonal in state difference is zero. Then we can decrypt ciphertext pairs which the k-th column of  <span class="math">L^{-1}(c^i \\oplus c^j)</span> is zero. So the total probability changes to  <span class="math">(2^{-22})^2 \\cdot 2^{-46} \\cdot 2^{-24} = 2^{-114}</span> . The structure of plaintexts can take  <span class="math">2^{32}</span>  values, and so we can construct  <span class="math">2^{63}</span>  pairs. Now we need to encrypt  <span class="math">2^{114-63} = 2^{51}</span>  structures and filter the ciphertext pairs such that only  <span class="math">2^{114-32} = 2^{82}</span>  of them are remained. For each of remaining pairs we decrypt the new pair formed by applying the mixed exchange operation on them,  <span class="math">\\rho_m^{v&#x27;}</span> . Now, we expect that there is a new plaintext pair which differ in a diagonal and thus we can distinguish 6-round AES from a random permutation using  <span class="math">2^{32+51} = 2^{83}</span>  chosen plaintexts and  <span class="math">2 \\cdot 2^{82} = 2^{83}</span>  adaptive chosen ciphertexts.</p>

    <p class="text-gray-300">The author would like thank Sondre R&oslash;njom for fruitful discussions and helpful comments.</p>

    </section>

    <section id="sec-6" class="mb-10">
      <h2 class="text-2xl font-bold">6 Conclusion</h2>

    <p class="text-gray-300">In this paper we have investigated the results of exchange attack in an adaptive setting. So, we improve the current best 6-round key-independent distinguisher. Our proposed distinguisher requires  <span class="math">2^{83}</span>  chosen plaintexts and  <span class="math">2^{83}</span>  adaptively chosen ciphertexts and has a computational cost of  <span class="math">2^{83}</span>  encryption.</p>

    <p class="text-gray-300"><strong>Input:</strong> Ask for 2<sup>51</sup> structures each structure has 2<sup>32</sup> plaintexts <strong>Result:</strong> 1 for an AES permutation, -1 otherwise.</p>

    <pre><code class="language-text">// 2^{51} times on average
for each structure do
     C \\leftarrow \\{\\}
                              // empty hash table containing unordered sets(e.q.
     T = \\{\\} ;
       unordered multisets)
     Ask for a structure \\mathcal{P} of 2^{32} plaintexts p^i where bytes in diagonal 0 take all
     C \\leftarrow C \\cup \\{c^i\\}
     z \\leftarrow |L^{-1}(c^i)_k|
                                      // |L^{-1}(c^i)_k| is a integer value of k&#x27;th column
     T[z] \\leftarrow T[z] \\cup \\{i\\}
     for each c^i in C do
                                                                        // 2^{31} pairs are remained
          for a \\in T[|c^i|] do
               j \\leftarrow T[|c^i|][a]
               c&#x27;^{i} = \\rho_{m}^{vI}(c^{i}, c^{j}), c&#x27;^{j} = \\rho_{m}^{vI}(c^{j}, c^{i}) \\text{ for a fixed } I \\text{ with } |I| = 1
Ask for decryption of c&#x27;^{i} and c&#x27;^{j}\\nif wt(\\nu_{d}(p&#x27;^{i} \\oplus p&#x27;^{j})) equals 1 then
| \\text{ return } 1.
                end
          end
     end
end
return -1
          Algorithm 1: Pseudo-code for 6-round acc distinguisher.
</code></pre>

    </section>

    <section id="references" class="mb-10">
      <h2 class="text-2xl font-bold">References</h2>

    <ul class="space-y-2 text-gray-400 text-sm list-none">
      <li><p class="text-gray-300">Zhenzhen Bao, Jian Guo, and Eik List. Extended expectation cryptanalysis on round-reduced aes. Cryptology ePrint Archive, Report 2019/622, 2019. https://eprint.iacr.org/2019/622.</p></li>
      <li><ul class="space-y-2 text-gray-400 text-sm list-none">
      <li>Navid Ghaedi Bardeh and Sondre R&oslash;njom. The exchange attack: How to distinguish 6 rounds of aes with  <span class="math">2^{88.2}</span>  chosen plaintexts. Cryptology ePrint Archive, Report 2019/652, 2019. https://eprint.iacr.org/2019/652.</li>
    </ul></li>
      <li><ul class="space-y-2 text-gray-400 text-sm list-none">
      <li>Navid Ghaedi Bardeh and Sondre R&oslash;njom. Practical attacks on reduced-round aes. Cryptology ePrint Archive, Report 2019/770, 2019. https://eprint.iacr.org/2019/770.</li>
    </ul></li>
      <li><ul class="space-y-2 text-gray-400 text-sm list-none">
      <li>Eli Biham and Nathan Keller. Cryptanalysis of reduced variants of rijndael. In 3rd AES Conference, volume 230, 2000.</li>
    </ul></li>
      <li><p class="text-gray-300">Andrey Bogdanov, Dmitry Khovratovich, and Christian Rechberger. Biclique cryptanalysis of the full AES. In Advances in Cryptology ASIACRYPT 2011 17th International Conference on the Theory and Application of Cryptology and Information Security, Seoul, South Korea, December 4-8, 2011. Proceedings, pages 344-371, 2011.</p></li>
      <li><ul class="space-y-2 text-gray-400 text-sm list-none">
      <li>C. Bouillaguet, P. Derbez, O. Dunkelman, P. A. Fouque, N. Keller, and V. Rijmen. Low-data complexity attacks on aes. volume 58, pages 7002&ndash;7017, Nov 2012.</li>
    </ul></li>
      <li><ul class="space-y-2 text-gray-400 text-sm list-none">
      <li>J. Daemen and V. Rijmen. Plateau characteristics. volume 1, pages 11&ndash;17, 2007.</li>
    </ul></li>
      <li><ul class="space-y-2 text-gray-400 text-sm list-none">
      <li>Joan Daemen and Vincent Rijmen. The design of rijndael: Aes the advanced encryption standard. In <em>Springer</em>, 2002.</li>
    </ul></li>
      <li><ul class="space-y-2 text-gray-400 text-sm list-none">
      <li>Joan Daemen and Vincent Rijmen. Understanding two-round differentials in aes. In Security and Cryptography for Networks: 5th International Conference, SCN 2006, Maiori, Italy, September 6-8, 2006. Proceedings, pages 78&ndash;94, Berlin, Heidelberg, 2006. Springer Berlin Heidelberg.</li>
    </ul></li>
      <li><ul class="space-y-2 text-gray-400 text-sm list-none">
      <li>Patrick Derbez and Pierre-Alain Fouque. Automatic search of meet-in-the-middle and impossible differential attacks. In Advances in Cryptology &ndash; CRYPTO 2016: 36th Annual International Cryptology Conference, Santa Barbara, CA, USA, August 14-18, 2016, Proceedings, Part II, pages 157&ndash;184, Berlin, Heidelberg, 2016. Springer Berlin Heidelberg.</li>
    </ul></li>
      <li><ul class="space-y-2 text-gray-400 text-sm list-none">
      <li>Lorenzo Grassi and Christian Rechberger. Rigorous analysis of truncated differentials for 5-round aes. Cryptology ePrint Archive, Report 2018/182, 2018. https://eprint.iacr.org/2018/182.</li>
    </ul></li>
      <li><ul class="space-y-2 text-gray-400 text-sm list-none">
      <li>Lorenzo Grassi, Christian Rechberger, and Sondre R&oslash;njom. Subspace trail cryptanalysis and its applications to AES. IACR Trans. Symmetric Cryptol., 2016(2):192&ndash;225, 2016.</li>
    </ul></li>
      <li><ul class="space-y-2 text-gray-400 text-sm list-none">
      <li>Lorenzo Grassi, Christian Rechberger, and Sondre R&oslash;njom. A new structuraldifferential property of 5-round aes. In Advances in Cryptology &ndash; EUROCRYPT 2017: 36th Annual International Conference on the Theory and Applications of Cryptographic Techniques, Paris, France, April 30 &ndash; May 4, 2017, Proceedings, Part II, pages 289&ndash;317, Cham, 2017. Springer International Publishing.</li>
    </ul></li>
      <li><ul class="space-y-2 text-gray-400 text-sm list-none">
      <li>Lars R. Knudsen and David Wagner. Integral cryptanalysis. In Fast Software Encryption, 9th International Workshop, FSE 2002, Leuven, Belgium, February 4-6, 2002, Revised Papers, pages 112&ndash;127, 2002.</li>
    </ul></li>
      <li><ul class="space-y-2 text-gray-400 text-sm list-none">
      <li>Vincent Rijmen. Cryptanalysis and design of iterated block ciphers. Doctoral Dissertation, K.U.Leuven, 1997.</li>
    </ul></li>
      <li><ul class="space-y-2 text-gray-400 text-sm list-none">
      <li>Sondre R&oslash;njom, Navid Ghaedi Bardeh, and Tor Helleseth. Yoyo tricks with AES. In Advances in Cryptology - ASIACRYPT 2017 - 23rd International Conference on the Theory and Applications of Cryptology and Information Security, Hong Kong, China, December 3-7, 2017, Proceedings, Part I, pages 217&ndash;243, 2017.</li>
    </ul></li>
      <li><ul class="space-y-2 text-gray-400 text-sm list-none">
      <li>Bing Sun, Meicheng Liu, Jian Guo, Longjiang Qu, and Vincent Rijmen. New insights on aes-like spn ciphers. In Matthew Robshaw and Jonathan Katz, editors, Advances in Cryptology &ndash; CRYPTO 2016: 36th Annual International Cryptology Conference, Santa Barbara, CA, USA, August 14-18, 2016, Proceedings, Part I, pages 605&ndash;624, Berlin, Heidelberg, 2016. Springer Berlin Heidelberg.</li>
    </ul></li>
    </ul>

    </section>
`;
---

<BaseLayout title="A Key-Independent Distinguisher for 6-round AES in an Adapti... (2019/945)">
  <article class="max-w-4xl mx-auto article-prose">
    <nav class="mb-8">
      <a href="/papers" class="text-blue-400 hover:text-blue-300">
        &larr; Back to Papers
      </a>
    </nav>

    <header class="mb-12">
      <h1 class="text-3xl font-bold mb-4"
        set:html={TITLE_HTML} />
      <p class="text-gray-400 mb-2"
        set:html={AUTHORS_HTML} />
      <p class="text-gray-500 text-sm mb-4">
        2019 &middot; eprint 2019/945
      </p>
      <div class="flex gap-4 text-sm">
        <a
          href={EPRINT_URL}
          target="_blank"
          rel="noopener noreferrer"
          class="text-blue-400 hover:text-blue-300"
        >
          Paper (eprint) &rarr;
        </a>
      </div>
      <PaperDisclaimer eprintUrl={EPRINT_URL} />
      <p class="mt-1 text-xs text-gray-600">
        Converted with: {CRAWLER} &middot; {CONVERTED_DATE}
      </p>
    </header>

    <nav id="toc" class="mb-10 p-6 rounded-lg" style="background: rgba(255,255,255,0.03); border: 1px solid rgba(255,255,255,0.06);">
      <h2 class="text-lg font-bold mb-4">Table of Contents</h2>
      <ol class="space-y-1 text-sm text-gray-300
        list-decimal list-inside">
        <li>
          <a href="#sec-1" class="hover:text-white">Introduction</a>
          <ol class="ml-6 mt-1 space-y-1 list-decimal
            list-inside text-gray-400">
            <li><a href="#sec-1.1" class="hover:text-white">Overview of 6-round distinguishers on AES</a></li>
            <li><a href="#sec-1.2" class="hover:text-white">Our Contribution</a></li>
            <li><a href="#sec-1.3" class="hover:text-white">Overview of This Paper and Main Results</a></li>
          </ol>
        </li>
        <li><a href="#sec-2" class="hover:text-white">Preliminaries</a></li>
        <li><a href="#sec-3" class="hover:text-white">5-round ACC distinguisher</a></li>
        <li><a href="#sec-4" class="hover:text-white">6-round ACC distinguisher</a></li>
        <li><a href="#sec-5" class="hover:text-white">Acknowledgments</a></li>
        <li><a href="#sec-6" class="hover:text-white">Conclusion</a></li>
      </ol>
      <p class="text-xs text-gray-500 mt-4 mb-1 font-semibold">
        Additional
      </p>
      <ul class="space-y-1 text-sm text-gray-400
        list-disc list-inside">
        <li><a href="#references" class="hover:text-white">References</a></li>
      </ul>
    </nav>


    <Fragment set:html={CONTENT} />

    <PaperHistory slug="a-key-independent-distinguisher-for-6-round-aes-in-an-2019" />
  </article>
</BaseLayout>
