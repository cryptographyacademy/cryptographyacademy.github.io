---
import BaseLayout from '../../layouts/BaseLayout.astro';

const EPRINT_URL = 'https://eprint.iacr.org/2020/188';
---

<BaseLayout title="Out of Oddity (2020/188)">
  <article class="max-w-4xl mx-auto article-prose">
    <nav class="mb-8">
      <a href="/papers" class="text-blue-400 hover:text-blue-300">
        &larr; Back to Papers
      </a>
    </nav>

    <!-- ============================================================ -->
    <!-- HEADER                                                       -->
    <!-- ============================================================ -->

    <header class="mb-12">
      <h1 class="text-3xl font-bold mb-4">
        Out of Oddity &ndash; New Cryptanalytic Techniques against
        Symmetric Primitives Optimized for Integrity Proof Systems
      </h1>
      <p class="text-gray-400 mb-2">
        Tim Beyne, Anne Canteaut, Itai Dinur, Maria Eichlseder,
        Gregor Leander, Ga&euml;tan Leurent,
        Mar&iacute;a Naya-Plasencia, L&eacute;o Perrin,
        Yu Sasaki, Yosuke Todo, Friedrich Wiemer
      </p>
      <p class="text-gray-500 text-sm mb-4">
        2020 &middot; Full Version &middot; eprint 2020/188
      </p>
      <div class="flex gap-4 text-sm">
        <a
          href={EPRINT_URL}
          target="_blank"
          rel="noopener noreferrer"
          class="text-blue-400 hover:text-blue-300"
        >
          Paper (eprint) &rarr;
        </a>
      </div>
      <p class="mt-4 text-xs text-gray-500">
        All content below belongs to the original authors. This page
        reproduces the paper for educational purposes. Always
        <a
          href={EPRINT_URL}
          target="_blank"
          rel="noopener noreferrer"
          class="text-blue-400 hover:text-blue-300"
        >cite the original</a>.
      </p>
    </header>

    <!-- ============================================================ -->
    <!-- TABLE OF CONTENTS                                            -->
    <!-- ============================================================ -->

    <nav id="toc" class="mb-10 p-6 rounded-lg"
      style="background: rgba(255,255,255,0.03);
             border: 1px solid rgba(255,255,255,0.06);">
      <h2 class="text-lg font-bold mb-4">Table of Contents</h2>
      <ol class="space-y-1 text-sm text-gray-300
        list-decimal list-inside">
        <li>
          <a href="#abstract"
            class="hover:text-white">Abstract</a>
        </li>
        <li>
          <a href="#sec-1"
            class="hover:text-white">Introduction</a>
        </li>
        <li>
          <a href="#sec-2"
            class="hover:text-white">STARK-Friendly Primitives</a>
          <ol class="ml-6 mt-1 space-y-1 list-decimal
            list-inside text-gray-400">
            <li>
              <a href="#sec-2.1"
                class="hover:text-white">
                Expected Security Level</a>
            </li>
            <li>
              <a href="#sec-2.2"
                class="hover:text-white">
                Concrete Instances</a>
            </li>
            <li>
              <a href="#sec-2.3"
                class="hover:text-white">
                Specifications of GMiMC</a>
            </li>
            <li>
              <a href="#sec-2.4"
                class="hover:text-white">
                Specifications of HadesMiMC</a>
            </li>
          </ol>
        </li>
        <li>
          <a href="#sec-3"
            class="hover:text-white">
            Integral Attacks over Fields of Any Characteristic</a>
        </li>
        <li>
          <a href="#sec-4"
            class="hover:text-white">
            Integral Distinguishers on the Full GMiMC</a>
          <ol class="ml-6 mt-1 space-y-1 list-decimal
            list-inside text-gray-400">
            <li>
              <a href="#sec-4.1"
                class="hover:text-white">
                Integral Distinguisher on GMiMC</a>
            </li>
            <li>
              <a href="#sec-4.2"
                class="hover:text-white">
                Zero-Sum Distinguishers on the Full
                Permutation</a>
            </li>
            <li>
              <a href="#sec-4.3"
                class="hover:text-white">
                Exploiting Integral Distinguishers over
                Multiplicative Subgroups</a>
            </li>
          </ol>
        </li>
        <li>
          <a href="#sec-5"
            class="hover:text-white">
            Differential Attacks on Round-Reduced GMiMC</a>
          <ol class="ml-6 mt-1 space-y-1 list-decimal
            list-inside text-gray-400">
            <li>
              <a href="#sec-5.1"
                class="hover:text-white">
                Impossible Differential Attacks</a>
            </li>
            <li>
              <a href="#sec-5.2"
                class="hover:text-white">
                A Differential Distinguisher</a>
            </li>
            <li>
              <a href="#sec-5.3"
                class="hover:text-white">
                Algebraically Controlled Differential
                Attacks</a>
            </li>
            <li>
              <a href="#sec-5.4"
                class="hover:text-white">
                Reduced-Round Collision Attacks</a>
            </li>
          </ol>
        </li>
        <li>
          <a href="#sec-6"
            class="hover:text-white">
            Attacks on HadesMiMC</a>
          <ol class="ml-6 mt-1 space-y-1 list-decimal
            list-inside text-gray-400">
            <li>
              <a href="#sec-6.1"
                class="hover:text-white">
                Integral Distinguishers</a>
            </li>
            <li>
              <a href="#sec-6.2"
                class="hover:text-white">
                Finding Preimages by Linearization of the
                Partial Rounds</a>
            </li>
          </ol>
        </li>
        <li>
          <a href="#sec-7"
            class="hover:text-white">Conclusions</a>
        </li>
        <li>
          <a href="#references"
            class="hover:text-white">References</a>
        </li>
        <li>
          <a href="#sec-A"
            class="hover:text-white">
            Appendix A: Impossible Differential Attack on
            GMiMC</a>
        </li>
        <li>
          <a href="#sec-B"
            class="hover:text-white">
            Appendix B: Optimality of the Differential
            Characteristics for GMiMC</a>
        </li>
        <li>
          <a href="#sec-C"
            class="hover:text-white">
            Appendix C: Weak Cauchy Matrices</a>
        </li>
        <li>
          <a href="#sec-D"
            class="hover:text-white">
            Appendix D: Cost of the Preimage Attack from
            Section 6.2</a>
        </li>
      </ol>
    </nav>

    <!-- ============================================================ -->
    <!-- ABSTRACT                                                     -->
    <!-- ============================================================ -->

    <section id="abstract" class="mb-10">
      <h2 class="text-2xl font-bold mb-4">Abstract</h2>
      <p class="text-gray-300">
        The security and performance of many integrity proof systems
        like SNARKs, STARKs and Bulletproofs highly depend on the
        underlying hash function. For this reason several new
        proposals have recently been developed. These primitives
        obviously require an in-depth security evaluation, especially
        since their implementation constraints have led to less
        standard design approaches. This work compares the security
        levels offered by two recent families of such primitives,
        namely GMiMC and HadesMiMC. We exhibit low-complexity
        distinguishers against the GMiMC and HadesMiMC permutations
        for most parameters proposed in recently launched public
        challenges for STARK-friendly hash functions. In the more
        concrete setting of the sponge construction corresponding to
        the practical use in the ZK-STARK protocol, we present a
        practical collision attack on a round-reduced version of
        GMiMC and a preimage attack on some instances of HadesMiMC.
        To achieve those results, we adapt and generalize several
        cryptographic techniques to fields of odd characteristic.
      </p>
      <p class="text-gray-300 mt-2">
        <strong>Keywords.</strong> Hash functions &middot; integrity
        proof systems &middot; Integral attacks &middot; GMiMC
        &middot; HadesMiMC.
      </p>
    </section>

    <!-- ============================================================ -->
    <!-- 1. INTRODUCTION                                              -->
    <!-- ============================================================ -->

    <section id="sec-1" class="mb-10">
      <h2 class="text-2xl font-bold mb-4">1 Introduction</h2>

      <p class="text-gray-300">
        The emergence of cryptographic protocols with advanced
        functionalities, such as fully homomorphic encryption,
        multi-party computation and new types of proof systems, has
        led to a strong demand for new symmetric primitives offering
        good performance in the context of these specific
        applications. Indeed, as emphasized by Katz [Kat19] in his
        invited lecture at CRYPTO 2019, symmetric-key cryptography
        has an important role to play in the further practical
        advancement of these applications. However, the standard
        criteria which govern the design of symmetric primitives are
        usually not appropriate in the context of these applications.
        For instance, the cost of the homomorphic evaluation of a
        symmetric primitive is mainly determined by its
        multiplicative size and depth [ARS+15]. Similarly, the area of
        integrity proof systems, like SNARKs, STARKs, Bulletproofs,
        is asking for symmetric primitives optimized for yet another
        cost metric. Moreover, the use of hash functions that are
        defined over finite fields of odd characteristic, in
        particular over prime fields is desirable in many such
        applications. One example of such a use case is the
        zero-knowledge proof system deployed in the Zcash
        cryptocurrency. Another very interesting example is the
        ZK-STARK protocol [BBHR18], which is expected to be deployed on
        top of the Ethereum blockchain within the next year: it uses
        as a building-block a collision-resistant hash function, and
        the performance of the proof system highly depends on the
        number of arithmetic operations required for describing the
        hash function (see [Aly+19] for details).
      </p>

      <p class="text-gray-300">
        Therefore, several new ciphers and hash functions have been
        proposed in the last five years for these advanced protocols.
        They include several FHE-friendly symmetric encryption
        schemes such as LowMC [ARS+15], FLIP [Mea+16], Kreyvium [Can+18] and
        Rasta [Dob+18], some MPC-friendly block ciphers such as
        MiMC [AGR+16] and its variants [Alb+19b,GKK+19], and some primitives
        dedicated to proof systems such as the functions from the
        Marvellous family, including Jarvis, Friday [AD18], Vision
        and Rescue [Aly+19].
      </p>

      <p class="text-gray-300">
        However, all these primitives are very innovative
        constructions and the implementation constraints which govern
        their designs may have introduced some unexpected
        weaknesses. This was the case for LowMC, which was broken a
        few weeks after its publication [DLMW15,DEM16,Rec+18]. More recently, a
        practical attack against Jarvis has been mounted [Alb+19a],
        showing that some of these designs are probably not mature
        enough for practical applications and require a more
        in-depth security evaluation. In particular, several of
        these primitives are defined over an odd prime field, a
        setting in which most of the classical cryptanalytic tools,
        and therefore also related security arguments, do not apply
        directly. This includes linear cryptanalysis and its
        variants, integral attacks and higher-order differential or
        cube attacks.
      </p>

      <p class="text-gray-300">
        <strong>Our contributions.</strong> This work analyses the
        security of two families of such primitives. To be concrete,
        we focus on the concrete proposals of STARK-friendly hash
        functions which have been specified in the context of a
        public competition launched by StarkWare Industries. We aim
        to compare the security levels offered, for similar
        parameters, by two families of primitives: GMiMC [4,5] and
        HadesMiMC [28,29]. More precisely, we evaluate the
        resistance of these two primitives against several general
        types of attacks: attacks exploiting differential
        properties, integral attacks and advanced algebraic attacks.
        As a result, we present low-complexity distinguishers
        against the GMiMC and HadesMiMC permutations for most
        parameters proposed in the challenges. In the more concrete
        setting of the sponge construction corresponding to the
        practical use in the ZK-STARK protocol, we describe a
        collision attack on a round-reduced version of GMiMC and a
        preimage attack on some instances of HadesMiMC. Our findings
        for the most efficient variants of the primitives are
        summarized in <a href="#table-1">Table 1</a>.
      </p>

      <p class="text-gray-300">
        From a technical point, our results required to adapt and
        generalize several cryptanalytic techniques to fields of odd
        characteristic. In particular, for integral attacks, we
        demonstrate that instead of using sums over additive
        subgroups as usually done for ciphers over
        <span class="math">\mathbb&#123;F&#125;_2^n</span>, it is
        possible to use any <em>multiplicative</em> subgroup of
        <span class="math">\mathbb&#123;F&#125;_q^&#123;\times&#125;</span>
        with similar impact. Interestingly, this seems to suggest
        that finite fields
        <span class="math">\mathbb&#123;F&#125;_q</span> with a
        limited number of multiplicative subgroups might be
        preferable, i.e. one might want to avoid
        <span class="math">q-1</span> being smooth. This implies
        that the fields which are suitable for implementing FFT may
        be more vulnerable to integral attacks. We expect that these
        general insights have applications beyond our concrete
        cryptanalytic results.
      </p>

      <p class="text-gray-300">
        An additional technical contribution of this paper is the
        use of algebraic techniques for ensuring that transitions of
        a differential characteristic for a hash function hold for
        many rounds without paying the typical expensive
        probabilistic cost. In particular, we exploit the algebraic
        structure of the hash function to penetrate deep into its
        state and represent the conditions for the differential
        transitions as algebraic equations that can be efficiently
        solved. We refer to these attacks as <em>algebraically
        controlled differential attacks</em>. Algebraic techniques
        have been previously used in combination with differential
        attacks (for example, in the recent cryptanalysis of
        SHA-1 [Ste+17]). However, unlike prior work, in our setting
        each differential transition is very expensive to bypass
        probabilistically. Hence, our attacks are almost entirely
        algebraic and use dedicated techniques to ensure that the
        algebraic equations can be efficiently solved.
      </p>

      <p class="text-gray-300">
        <strong>Organization of the paper.</strong> The following
        section describes the two STARK-friendly primitives
        considered in the paper and their concrete instances.
        <a href="#sec-3">Section 3</a> details how integral attacks
        can be mounted over finite fields of any characteristic.
        Following this new framework,
        <a href="#sec-4">Section 4</a> exhibits low-complexity
        integral distinguishers on the full GMiMC permutation.
        Several differential attacks on round-reduced GMiMC are then
        detailed in <a href="#sec-5">Section 5</a>, including a
        practical collision attack on the corresponding hash
        function. <a href="#sec-6">Section 6</a> presents two
        attacks on HadesMiMC: a general integral distinguisher
        covering all but two rounds of the permutation, and a
        preimage attack on the hash function which applies in the
        specific case where the MDS matrix defining the linear layer
        has a low multiplicative order.
      </p>
    </section>

    <!-- ============================================================ -->
    <!-- 2. STARK-FRIENDLY PRIMITIVES                                 -->
    <!-- ============================================================ -->

    <section id="sec-2" class="mb-10">
      <h2 class="text-2xl font-bold mb-4">
        2 STARK-Friendly Primitives
      </h2>

      <p class="text-gray-300">
        This paper focuses on two families of primitives, which are
        recent evolutions of the block cipher MiMC designed by
        Albrecht <em>et al.</em> in 2016 [AGR+16], and offer much more
        flexibility than the original construction:
      </p>
      <ul class="list-disc list-inside text-gray-300 ml-4 mb-4">
        <li>
          <strong>GMiMC</strong>, designed by Albrecht
          <em>et al.</em> [4,5]
        </li>
        <li>
          <strong>HadesMiMC</strong>, proposed by Grassi
          <em>et al.</em> [28,29], for which two versions are
          distinguished depending on the characteristic of the
          underlying field: Starkad over a field of characteristic
          2, and Poseidon over a prime field.
        </li>
      </ul>

      <!-- Table 1 -->
      <div id="table-1" class="overflow-x-auto mb-6">
        <p class="text-sm text-gray-400 mb-2">
          <strong>Table 1:</strong> Distinguishers on the GMiMC and
          HadesMiMC permutations and attacks breaking the
          corresponding sponge hash functions. The variants aiming
          at 128-bit security operate on
          <span class="math">t=12</span> elements in
          <span class="math">\mathbb&#123;F&#125;_q</span> with
          <span class="math">q=2^&#123;61&#125;+20 \times 2^&#123;32&#125;+1</span>.
          The variants aiming at 256-bit security operate on
          <span class="math">t=14</span> elements in
          <span class="math">\mathbb&#123;F&#125;_q</span> with
          <span class="math">q=2^&#123;125&#125;+266 \times 2^&#123;64&#125;+1</span>.
          The last attack (*) only applies when the linear layer has
          a low multiplicative order. Attacks on full versions are
          typeset in bold.
        </p>
        <table class="w-full text-sm">
          <thead>
            <tr class="border-b border-gray-700">
              <th class="text-left p-2 text-gray-300">
                Primitive (security)</th>
              <th class="text-left p-2 text-gray-300">Rounds</th>
              <th class="text-left p-2 text-gray-300">Target</th>
              <th class="text-left p-2 text-gray-300">Type</th>
              <th class="text-left p-2 text-gray-300">
                Attack Rounds</th>
              <th class="text-left p-2 text-gray-300">Cost</th>
              <th class="text-left p-2 text-gray-300">Sect.</th>
            </tr>
          </thead>
          <tbody class="text-gray-400">
            <tr class="border-b border-gray-800">
              <td class="p-2" rowspan="7">
                GMiMC (128 bits)</td>
              <td class="p-2" rowspan="7">101</td>
              <td class="p-2" rowspan="4">permutation</td>
              <td class="p-2">integral distinguisher</td>
              <td class="p-2">70</td>
              <td class="p-2">
                <span class="math">2^&#123;61&#125;</span></td>
              <td class="p-2">4.1</td>
            </tr>
            <tr class="border-b border-gray-800">
              <td class="p-2">ZS distinguisher</td>
              <td class="p-2"><strong>102</strong></td>
              <td class="p-2">
                <span class="math">2^&#123;48&#125;</span></td>
              <td class="p-2">4.3</td>
            </tr>
            <tr class="border-b border-gray-800">
              <td class="p-2">ZS distinguisher</td>
              <td class="p-2"><strong>128</strong></td>
              <td class="p-2">
                <span class="math">2^&#123;122&#125;</span></td>
              <td class="p-2">4.2</td>
            </tr>
            <tr class="border-b border-gray-800">
              <td class="p-2">diff. distinguisher</td>
              <td class="p-2">64</td>
              <td class="p-2">
                <span class="math">2^&#123;123&#125;</span></td>
              <td class="p-2">5.2</td>
            </tr>
            <tr class="border-b border-gray-800">
              <td class="p-2" rowspan="3">hash function</td>
              <td class="p-2">diff. distinguisher</td>
              <td class="p-2">66</td>
              <td class="p-2">practical</td>
              <td class="p-2">5.2</td>
            </tr>
            <tr class="border-b border-gray-800">
              <td class="p-2">collisions</td>
              <td class="p-2">40</td>
              <td class="p-2">practical</td>
              <td class="p-2">5.4</td>
            </tr>
            <tr class="border-b border-gray-800">
              <td class="p-2">collisions</td>
              <td class="p-2">42</td>
              <td class="p-2">
                <span class="math">2^&#123;92&#125;</span></td>
              <td class="p-2">5.4</td>
            </tr>
            <tr class="border-b border-gray-800">
              <td class="p-2" rowspan="2">
                Poseidon (128 bits)</td>
              <td class="p-2" rowspan="2">8+40</td>
              <td class="p-2">permutation</td>
              <td class="p-2">ZS distinguisher</td>
              <td class="p-2">6+45</td>
              <td class="p-2">
                <span class="math">2^&#123;61&#125;</span></td>
              <td class="p-2">6.1</td>
            </tr>
            <tr class="border-b border-gray-800">
              <td class="p-2" colspan="4">&nbsp;</td>
            </tr>
            <tr class="border-b border-gray-800">
              <td class="p-2" rowspan="4">
                GMiMC (256 bits)</td>
              <td class="p-2" rowspan="4">186</td>
              <td class="p-2" rowspan="3">permutation</td>
              <td class="p-2">integral distinguisher</td>
              <td class="p-2">116</td>
              <td class="p-2">
                <span class="math">2^&#123;125&#125;</span></td>
              <td class="p-2">4.1</td>
            </tr>
            <tr class="border-b border-gray-800">
              <td class="p-2">ZS distinguisher</td>
              <td class="p-2"><strong>206</strong></td>
              <td class="p-2">
                <span class="math">2^&#123;125&#125;</span></td>
              <td class="p-2">4.2</td>
            </tr>
            <tr class="border-b border-gray-800">
              <td class="p-2">ZS distinguisher</td>
              <td class="p-2"><strong>218</strong></td>
              <td class="p-2">
                <span class="math">2^&#123;250&#125;</span></td>
              <td class="p-2">4.2</td>
            </tr>
            <tr class="border-b border-gray-800">
              <td class="p-2">hash function</td>
              <td class="p-2">collisions</td>
              <td class="p-2">50</td>
              <td class="p-2">
                <span class="math">2^&#123;187&#125;</span></td>
              <td class="p-2">5.3</td>
            </tr>
            <tr class="border-b border-gray-800">
              <td class="p-2" rowspan="2">
                Poseidon (256 bits)</td>
              <td class="p-2" rowspan="2">8+83</td>
              <td class="p-2">permutation</td>
              <td class="p-2">ZS distinguisher</td>
              <td class="p-2">6+87</td>
              <td class="p-2">
                <span class="math">2^&#123;125&#125;</span></td>
              <td class="p-2">6.1</td>
            </tr>
            <tr class="border-b border-gray-800">
              <td class="p-2">hash function*</td>
              <td class="p-2">preimages</td>
              <td class="p-2"><strong>8+any</strong></td>
              <td class="p-2">
                <span class="math">2^&#123;236&#125;</span></td>
              <td class="p-2"><strong>6.2</strong></td>
            </tr>
          </tbody>
        </table>
      </div>

      <!-- 2.1 -->
      <h3 id="sec-2.1" class="text-xl font-semibold mt-6">
        2.1 Expected Security Level
      </h3>

      <p class="text-gray-300">
        GMiMC and HadesMiMC are two block ciphers but both of them
        can be turned into permutations by replacing the round-keys
        by fixed independent and randomly chosen round-constants.
        Based on these primitives, hash functions are obtained by
        applying the sponge construction [16,17] and using the
        primitive as an inner permutation.
      </p>

      <p class="text-gray-300">
        In the following, we extensively use the following notation:
        the sponge operates on a state composed of
        <span class="math">t</span> elements in a finite field
        <span class="math">\mathbb&#123;F&#125;_q</span>. The main
        parameters which determine the security level of the sponge
        construction with respect to generic attacks are its
        <em>capacity</em> <span class="math">c</span> and the size
        of the underlying alphabet
        <span class="math">\mathbb&#123;F&#125;_q</span>. Namely,
        a random sponge whose capacity consists of
        <span class="math">c</span> elements in
        <span class="math">\mathbb&#123;F&#125;_q</span> provides
        a generic security level corresponding to
        <span class="math">\frac&#123;c&#125;&#123;2&#125; \log_2 q</span>
        queries both for collision and (second)-preimage
        resistance [Ber+07].
      </p>

      <p class="text-gray-300">
        The primary cryptanalytic goal is to exhibit collision or
        preimage attacks on some weakened variants of the hash
        functions. However, the existence of a property which
        distinguishes a given cryptographic function from an ideal
        function of the same size is also commonly considered as a
        weakness (see e.g. [12, Page 19] for a discussion). In our
        context, since our attacks do not make any assumptions about
        the round-constants in the inner permutations, our
        <em>distinguishers</em> are related to the known-key model
        for block ciphers [KR07].
      </p>

      <p class="text-gray-300">
        While a distinguisher on
        <span class="math">\pi</span> cannot always be turned into
        a distinguisher for the hash function, it invalidates the
        security arguments provided by the indifferentiability proof
        of the sponge construction [Ber+08]. For this reason, the
        authors of Keccak advocate following the so-called
        <em>hermetic sponge strategy</em> [18, Page 13], i.e. using
        the sponge construction with an inner permutation that
        should not have any structural distinguisher (other than the
        existence of a compact description).
      </p>

      <!-- 2.2 -->
      <h3 id="sec-2.2" class="text-xl font-semibold mt-6">
        2.2 Concrete Instances
      </h3>

      <p class="text-gray-300">
        The different members in each of these families are
        determined by the triple
        <span class="math">(c, t, q)</span> representing
        respectively the number of words in the capacity, the
        number of words in the state and the field size.
      </p>

      <!-- Table 2 -->
      <div id="table-2" class="overflow-x-auto mb-6">
        <p class="text-sm text-gray-400 mb-2">
          <strong>Table 2:</strong> Parameters proposed for the
          permutation and sponge construction.
        </p>
        <table class="w-full text-sm">
          <thead>
            <tr class="border-b border-gray-700">
              <th class="text-left p-2 text-gray-300">
                Security level</th>
              <th class="text-left p-2 text-gray-300">
                <span class="math">\log_2 q</span></th>
              <th class="text-left p-2 text-gray-300">
                <span class="math">q</span> (prime)</th>
              <th class="text-left p-2 text-gray-300">
                <span class="math">q</span> (binary)</th>
              <th class="text-left p-2 text-gray-300">
                <span class="math">c</span></th>
              <th class="text-left p-2 text-gray-300">
                <span class="math">t</span></th>
              <th class="text-left p-2 text-gray-300">
                Variant</th>
            </tr>
          </thead>
          <tbody class="text-gray-400">
            <tr class="border-b border-gray-800">
              <td class="p-2" rowspan="5">128 bits</td>
              <td class="p-2">64</td>
              <td class="p-2">
                <span class="math">2^&#123;61&#125;+20 \times 2^&#123;32&#125;+1</span></td>
              <td class="p-2">
                <span class="math">2^&#123;63&#125;</span></td>
              <td class="p-2">4</td>
              <td class="p-2">12</td>
              <td class="p-2">128-d</td>
            </tr>
            <tr class="border-b border-gray-800">
              <td class="p-2">128</td>
              <td class="p-2">
                <span class="math">2^&#123;125&#125;+266 \times 2^&#123;64&#125;+1</span></td>
              <td class="p-2">
                <span class="math">2^&#123;125&#125;</span></td>
              <td class="p-2">2</td>
              <td class="p-2">4</td>
              <td class="p-2">128-a</td>
            </tr>
            <tr class="border-b border-gray-800">
              <td class="p-2">128</td>
              <td class="p-2">
                <span class="math">2^&#123;125&#125;+266 \times 2^&#123;64&#125;+1</span></td>
              <td class="p-2">
                <span class="math">2^&#123;125&#125;</span></td>
              <td class="p-2">2</td>
              <td class="p-2">12</td>
              <td class="p-2">128-c</td>
            </tr>
            <tr class="border-b border-gray-800">
              <td class="p-2">256</td>
              <td class="p-2">
                <span class="math">2^&#123;253&#125;+2^&#123;199&#125;+1</span></td>
              <td class="p-2">
                <span class="math">2^&#123;255&#125;</span></td>
              <td class="p-2">1</td>
              <td class="p-2">3</td>
              <td class="p-2">128-b</td>
            </tr>
            <tr class="border-b border-gray-800">
              <td class="p-2">256</td>
              <td class="p-2">
                <span class="math">2^&#123;253&#125;+2^&#123;199&#125;+1</span></td>
              <td class="p-2">
                <span class="math">2^&#123;255&#125;</span></td>
              <td class="p-2">1</td>
              <td class="p-2">11</td>
              <td class="p-2">128-e</td>
            </tr>
            <tr class="border-b border-gray-800">
              <td class="p-2" rowspan="2">256 bits</td>
              <td class="p-2">128</td>
              <td class="p-2">
                <span class="math">2^&#123;125&#125;+266 \times 2^&#123;64&#125;+1</span></td>
              <td class="p-2">
                <span class="math">2^&#123;125&#125;</span></td>
              <td class="p-2">4</td>
              <td class="p-2">8</td>
              <td class="p-2">256-a</td>
            </tr>
            <tr class="border-b border-gray-800">
              <td class="p-2">128</td>
              <td class="p-2">
                <span class="math">2^&#123;125&#125;+266 \times 2^&#123;64&#125;+1</span></td>
              <td class="p-2">
                <span class="math">2^&#123;125&#125;</span></td>
              <td class="p-2">4</td>
              <td class="p-2">14</td>
              <td class="p-2">256-b</td>
            </tr>
          </tbody>
        </table>
      </div>

      <p class="text-gray-300">
        It is also worth noticing that, in terms of performance
        and suitability, odd prime fields are more STARK-friendly
        than binary fields for a given size.
      </p>

      <!-- 2.3 -->
      <h3 id="sec-2.3" class="text-xl font-semibold mt-6">
        2.3 Specifications of GMiMC
      </h3>

      <p class="text-gray-300">
        <strong>GMiMC</strong> is a family of block ciphers
        designed by Albrecht <em>et al.</em> in 2019 [Alb+19b] based on
        different types of Feistel networks using
        <span class="math">x \mapsto x^3</span> over the field
        corresponding to the branch alphabet as the round function.
        Among the variants proposed by the designers, we focus on
        the one chosen in the StarkWare challenges, namely the
        variant using an unbalanced Feistel network with an
        expanding round function, named
        <span class="math">\mathsf&#123;GMiMC&#125;_&#123;\mathsf&#123;erf&#125;&#125;</span>.
        A specificity of GMiMC is that the designers&rsquo; security
        claims concern the primitive instantiated over a prime
        field. They mention that &ldquo;even if GMiMC can be
        instantiated over
        <span class="math">\mathbb&#123;F&#125;_&#123;2^n&#125;</span>,
        [they] do not provide the number of rounds to guarantee
        security in this scenario.&rdquo;
      </p>

      <p class="text-gray-300">
        In the block cipher setting with a key size equal to
        <span class="math">n = \log_2 q</span> bits, the key
        schedule is trivial, i.e. the master key is added to the
        input of the cube function at every round. This very simple
        key schedule is a major weakness [Bon19]. However, it seems
        difficult to leverage the underlying property in the hash
        function setting we are focusing on.
      </p>

      <!-- 2.4 -->
      <h3 id="sec-2.4" class="text-xl font-semibold mt-6">
        2.4 Specifications of HadesMiMC
      </h3>

      <p class="text-gray-300">
        <strong>HadesMiMC</strong> is a family of permutations
        described by Grassi <em>et al.</em> in [GLR+20] which follows a
        new design strategy for block ciphers called HADES. The
        HADES construction aims to decrease the number of S-boxes
        relative to a traditional Substitution-Permutation Network,
        while guaranteeing that the cipher still resists all known
        attacks, including differential and linear cryptanalysis and
        algebraic attacks. Reducing the number of S-boxes is
        especially important in many applications and this was
        traditionally achieved by using a partial substitution
        layer, i.e., an S-box layer which does not operate on the
        whole internal state. However, several attacks on this type
        of constructions, e.g. [13,22,24,38] show that it is much
        more difficult to estimate the security level of these
        constructions than that of classical SPNs.
      </p>

      <p class="text-gray-300">
        The basic principle of the HADES construction is then to
        combine both aspects: the inner rounds in the cipher have a
        partial S-box layer to increase the resistance to algebraic
        attacks at a reduced implementation cost, whereas the outer
        rounds consist of traditional SPN rounds, with a full S-box
        layer. The resistance against statistical attacks is
        analyzed by removing the inner rounds, while the resistance
        to algebraic attacks, e.g. the evolution of the algebraic
        degree over the cipher, involves the inner rounds.
      </p>

      <p class="text-gray-300">
        HadesMiMC [29, Section 3] is then a keyed permutation
        following the HADES construction dedicated to MPC
        applications or to STARK proof systems, where the S-box is
        defined by the cube mapping over a finite field and the
        linear layer <span class="math">L</span> corresponds to a
        <span class="math">(t \times t)</span>-MDS matrix. Two
        concrete instantiations of HadesMiMC are then detailed by
        Grassi <em>et al.</em> in [GKK+19]:
      </p>
      <ul class="list-disc list-inside text-gray-300 ml-4 mb-4">
        <li>
          <strong>Starkad</strong> operates on
          <span class="math">t</span> elements in a binary field
          of odd absolute degree (which guarantees that the cube
          mapping is bijective);
        </li>
        <li>
          <strong>Poseidon</strong> operates on
          <span class="math">t</span> elements in a prime field
          <span class="math">\mathbb&#123;F&#125;_p</span> with
          <span class="math">p \bmod 3 \neq 1</span>.
        </li>
      </ul>

      <p class="text-gray-300">
        In both cases the partial rounds consist of a single S-box
        operating on the last coordinate of the state. For all
        parameters we consider, the number of full rounds is equal
        to 8 and the number of partial rounds varies between 40
        and 88.
      </p>
    </section>

    <!-- ============================================================ -->
    <!-- 3. INTEGRAL ATTACKS OVER FIELDS OF ANY CHARACTERISTIC        -->
    <!-- ============================================================ -->

    <section id="sec-3" class="mb-10">
      <h2 class="text-2xl font-bold mb-4">
        3 Integral Attacks over Fields of Any Characteristic
      </h2>

      <p class="text-gray-300">
        The notion of <em>integral attacks</em> has been introduced
        by Knudsen and Wagner [KW02] and captures several variants
        including saturation attacks and higher-order differential
        attacks. These attacks have been used for cryptanalyzing
        many ciphers, but to our best knowledge, all of them
        operate on a binary field. Indeed, the main property behind
        these attacks is that, for any
        <span class="math">F : \mathbb&#123;F&#125;_2^m \to \mathbb&#123;F&#125;_2^m</span>
        and for any affine subspace
        <span class="math">V \subset \mathbb&#123;F&#125;_2^m</span>,
      </p>
      <div class="math-block">
        \sum_&#123;x \in V&#125; F(x) = 0
      </div>
      <p class="text-gray-300">
        when
        <span class="math">\deg F &lt; \dim V</span>. This comes
        from the fact that the sum of the images by
        <span class="math">F</span> of all inputs in
        <span class="math">V</span> corresponds to a value of a
        derivative of <span class="math">F</span> of order
        <span class="math">(\dim V)</span> [Lai94]. The fact that the
        sum over all
        <span class="math">x \in V</span> of
        <span class="math">F(x)</span> corresponds to the value of
        a higher-order derivative does not hold anymore in odd
        characteristic, and the same technique cannot be applied
        directly.
      </p>

      <p class="text-gray-300">
        Higher-order differentials over
        <span class="math">\mathbb&#123;F&#125;_q</span> then need
        to use a generalized notion of differentiation as analyzed
        in [Sal+17] (see also [AP11]). However, we can show that for the
        particular case of saturation attacks, the same technique
        can be used in the general case of a field
        <span class="math">\mathbb&#123;F&#125;_q</span> &ndash;
        even in odd characteristic. Indeed, we can exploit the
        following result.
      </p>

      <div class="formal-block formal-block-proposition">
        <div class="formal-block-title text-violet-400">
          Proposition 1
        </div>
        <div class="formal-block-content">
          <p class="text-gray-300">
            For any
            <span class="math">F : \mathbb&#123;F&#125;_q \to \mathbb&#123;F&#125;_q</span>
            with
            <span class="math">\deg(F) &lt; q - 1</span>,
          </p>
          <div class="math-block">
            \sum_&#123;x \in \mathbb&#123;F&#125;_q&#125; F(x) = 0.
          </div>
        </div>
      </div>

      <p class="text-gray-300">
        <em>Proof.</em> The result is due to the following
        well-known property: for any exponent
        <span class="math">k</span> with
        <span class="math">1 \le k \le q-2</span>,
      </p>
      <div class="math-block">
        \sum_&#123;x \in \mathbb&#123;F&#125;_q&#125; x^k = 0.
      </div>
      <p class="text-gray-300">
        Moreover, when <span class="math">k = 0</span>, we have
        <span class="math">\sum_&#123;x \in \mathbb&#123;F&#125;_q&#125; x^0 = q = 0</span>.
      </p>

      <p class="text-gray-300">
        Proposition 1 can be generalized to the multivariate case,
        i.e. to functions from
        <span class="math">\mathbb&#123;F&#125;_q^k</span> to
        <span class="math">\mathbb&#123;F&#125;_q</span>, which
        can be expressed as polynomials in the ring
      </p>
      <div class="math-block">
        \mathbb&#123;F&#125;_q[x_1,\ldots,x_k]/(x_1^q - x_1, \ldots, x_k^q - x_k).
      </div>

      <div class="formal-block formal-block-proposition">
        <div class="formal-block-title text-violet-400">
          Corollary 1
        </div>
        <div class="formal-block-content">
          <p class="text-gray-300">
            For any
            <span class="math">F: \mathbb&#123;F&#125;_q^t \to \mathbb&#123;F&#125;_q</span>
            with
            <span class="math">\deg(F) &lt; k(q-1)</span> and any
            affine subspace
            <span class="math">V \subseteq \mathbb&#123;F&#125;_q^t</span>
            of dimension at least
            <span class="math">k</span>,
          </p>
          <div class="math-block">
            \sum_&#123;x \in V&#125; F(x) = 0.
          </div>
        </div>
      </div>

      <p class="text-gray-300">
        <em>Proof.</em> Let <span class="math">V</span> be an
        affine space of dimension
        <span class="math">\kappa \geq k</span> and
        <span class="math">A</span> an affine permutation over
        <span class="math">\mathbb&#123;F&#125;_q^t</span> such
        that
        <span class="math">A(V) = \&#123;(y, 0, \dots, 0) \mid y \in \mathbb&#123;F&#125;_q^&#123;\kappa&#125;\&#125;</span>.
        Then,
      </p>
      <div class="math-block">
        \sum_&#123;x \in V&#125; F(x)
        = \sum_&#123;y_1, \dots, y_&#123;\kappa&#125; \in \mathbb&#123;F&#125;_q&#125;
        (F \circ A^&#123;-1&#125;)(y_1, \dots, y_&#123;\kappa&#125;, 0, \dots, 0).
      </div>
      <p class="text-gray-300">
        Since
        <span class="math">\deg(F \circ A^&#123;-1&#125;) = \deg F &lt; k(q-1)</span>,
        <span class="math">(F \circ A^&#123;-1&#125;)</span>
        consists of monomials of the form
        <span class="math">y_1^&#123;i_1&#125; y_2^&#123;i_2&#125; \dots y_&#123;\kappa&#125;^&#123;i_&#123;\kappa&#125;&#125;</span>
        with at least one exponent
        <span class="math">i_j &lt; q-1</span>. Then,
        <span class="math">\sum_&#123;y_j \in \mathbb&#123;F&#125;_q&#125; y_j^&#123;i_j&#125; = 0</span>,
        implying that
      </p>
      <div class="math-block">
        \sum_&#123;y_1,\dots,y_&#123;\kappa&#125; \in \mathbb&#123;F&#125;_q&#125;
        y_1^&#123;i_1&#125; y_2^&#123;i_2&#125; \dots y_&#123;\kappa&#125;^&#123;i_&#123;\kappa&#125;&#125; = 0,
      </div>
      <p class="text-gray-300">
        which leads to
        <span class="math">\sum_&#123;x \in V&#125; F(x) = 0</span>.
      </p>

      <p class="text-gray-300">
        Based on this observation, a saturation attack with data
        complexity
        <span class="math">q^k</span> can be mounted whenever the
        degree of <span class="math">F</span> as a polynomial over
        <span class="math">\mathbb&#123;F&#125;_q</span> is
        strictly less than
        <span class="math">k(q-1)</span>, even if
        <span class="math">\mathbb&#123;F&#125;_q</span> is a
        field of odd characteristic.
      </p>

      <p class="text-gray-300">
        Now, we generalize the notion of integral distinguishers to
        multiplicative subgroups using the following property.
      </p>

      <div class="formal-block formal-block-proposition">
        <div class="formal-block-title text-violet-400">
          Proposition 2
        </div>
        <div class="formal-block-content">
          <p class="text-gray-300">
            Let
            <span class="math">\mathbb&#123;G&#125;</span> be a
            multiplicative subgroup of
            <span class="math">\mathbb&#123;F&#125;_q^&#123;\times&#125;</span>.
            For any
            <span class="math">F: \mathbb&#123;F&#125;_q \to \mathbb&#123;F&#125;_q</span>
            such that
            <span class="math">\deg(F) &lt; |\mathbb&#123;G&#125;|</span>,
          </p>
          <div class="math-block">
            \sum_&#123;x \in \mathbb&#123;G&#125;&#125; F(x) - F(0) \cdot |\mathbb&#123;G&#125;| = 0.
          </div>
          <p class="text-gray-300">
            This is a strict generalization of Proposition 1, for
            which
            <span class="math">|\mathbb&#123;G&#125;| = q - 1</span>.
          </p>
        </div>
      </div>

      <p class="text-gray-300">
        <em>Proof.</em> The result is a direct consequence of the
        following well-known property: for any exponent
        <span class="math">k</span> with
        <span class="math">1 \le k \le |\mathbb&#123;G&#125;| - 1</span>,
      </p>
      <div class="math-block">
        \sum_&#123;x \in \mathbb&#123;G&#125;&#125; x^k = 0.
      </div>
      <p class="text-gray-300">
        Moreover, when <span class="math">k = 0</span>, we have
        <span class="math">\sum_&#123;x \in \mathbb&#123;G&#125;&#125; x^0 = |\mathbb&#123;G&#125;|</span>.
      </p>

      <p class="text-gray-300">
        We also note that Corollary 1 can be straightforwardly
        adapted to multiplicative subgroups. The power of summing
        over multiplicative subgroups (rather than over the entire
        field
        <span class="math">\mathbb&#123;F&#125;_q</span>) comes
        from the fact that if
        <span class="math">\mathbb&#123;F&#125;_q</span> contains
        small multiplicative subgroups (as for the fields used for
        the concrete instances specified in
        <a href="#table-2">Table 2</a>), the complexity of the
        attacks may be fine-tuned and significantly reduced. In the
        next sections, such attacks will be applied to both GMiMC
        and HadesMiMC.
      </p>
    </section>

    <!-- 4. INTEGRAL DISTINGUISHERS ON GMiMC -->

    <section id="sec-4" class="mb-10">
      <h2 class="text-2xl font-bold mb-4">4 Integral Distinguishers on the Full GMiMC</h2>

      <h3 id="sec-4.1" class="text-xl font-semibold mt-6">4.1 Integral Distinguisher on GMiMC</h3>
      <p class="text-gray-300">Using Corollary 1, we exhibit a distinguisher for <span class="math">(3t-4+\lfloor\log_3(q-2)\rfloor)</span> rounds of GMiMC, holding for any finite field with data complexity <span class="math">q</span>. We consider inputs</p>
      <div class="math-block">\mathcal&#123;X&#125; = \&#123;(\alpha_1, \dots, \alpha_&#123;t-2&#125;, x, f(x)) \mid x \in \mathbb&#123;F&#125;_q \&#125;</div>
      <p class="text-gray-300">where <span class="math">f</span> is defined by</p>
      <div class="math-block">f(x) = -\left(x + \sum_&#123;i=1&#125;^&#123;t-2&#125; \beta_i + \mathsf&#123;RC&#125;_&#123;t-1&#125;\right)^3 - x - 2\sum_&#123;i=1&#125;^&#123;t-2&#125; \beta_i - \mathsf&#123;RC&#125;_&#123;t-1&#125; - \mathsf&#123;RC&#125;_t</div>
      <p class="text-gray-300">and <span class="math">\beta_1 = (\alpha_1 + \mathsf&#123;RC&#125;_1)^3</span>, <span class="math">\beta_&#123;i+1&#125; = (\alpha_&#123;i+1&#125; + \sum_&#123;j=1&#125;^i \beta_j + \mathsf&#123;RC&#125;_&#123;i+1&#125;)^3</span>. After <span class="math">(t-2)</span> rounds, coordinates become degree <span class="math">3^&#123;r+1&#125;</span> polynomials after <span class="math">r</span> additional rounds. Adding <span class="math">(t-1)</span> rounds via Proposition 3 gives <span class="math">R = 3t - 4 + \lfloor \log_3(q-2) \rfloor</span> rounds (70 for the main parameters).</p>

      <div class="formal-block formal-block-proposition">
        <div class="formal-block-title text-violet-400">Proposition 3</div>
        <div class="formal-block-content">
          <p class="text-gray-300">Let <span class="math">(x_1, \ldots, x_t)</span> and <span class="math">(y_1, \ldots, y_t)</span> denote input and output of <span class="math">(t-1)</span> rounds of GMiMC. Then</p>
          <div class="math-block">\sum_&#123;i=2&#125;^&#123;t&#125; y_i - (t-2)y_1 = \sum_&#123;i=1&#125;^&#123;t-1&#125; x_i - (t-2)x_t.</div>
        </div>
      </div>

      <h3 id="sec-4.2" class="text-xl font-semibold mt-6">4.2 Zero-Sum Distinguishers on the Full Permutation</h3>
      <p class="text-gray-300"><strong>Single branch.</strong> In the known-key setting [KR07], the distinguisher extends to <span class="math">4t - 6 + 2\lfloor\log_3(q-2)\rfloor</span> rounds. <strong>Two branches.</strong> For <span class="math">t \geq 4</span>, complexity <span class="math">q^2</span> covers <span class="math">5t - 8 + 2\lfloor\log_3(q-2)\rfloor</span> rounds.</p>

      <div id="table-3" class="overflow-x-auto mb-6">
        <p class="text-sm text-gray-400 mb-2"><strong>Table 3:</strong> Rounds of GMiMC covered by zero-sum distinguishers.</p>
        <table class="w-full text-sm"><thead><tr class="border-b border-gray-700"><th class="text-left p-2 text-gray-300">Security</th><th class="text-left p-2 text-gray-300"><span class="math">\log_2 q</span></th><th class="text-left p-2 text-gray-300"><span class="math">t</span></th><th class="text-left p-2 text-gray-300">Full</th><th class="text-left p-2 text-gray-300">ZS <span class="math">q</span></th><th class="text-left p-2 text-gray-300">ZS <span class="math">q^2</span></th></tr></thead><tbody class="text-gray-400"><tr class="border-b border-gray-800"><td class="p-2" rowspan="5">128</td><td class="p-2">61</td><td class="p-2">12</td><td class="p-2">101</td><td class="p-2">118</td><td class="p-2">128</td></tr><tr class="border-b border-gray-800"><td class="p-2">125</td><td class="p-2">4</td><td class="p-2">166</td><td class="p-2">166</td><td class="p-2">&ndash;</td></tr><tr class="border-b border-gray-800"><td class="p-2">125</td><td class="p-2">12</td><td class="p-2">182</td><td class="p-2">198</td><td class="p-2">&ndash;</td></tr><tr class="border-b border-gray-800"><td class="p-2">256</td><td class="p-2">3</td><td class="p-2">326</td><td class="p-2">&ndash;</td><td class="p-2">&ndash;</td></tr><tr class="border-b border-gray-800"><td class="p-2">256</td><td class="p-2">11</td><td class="p-2">342</td><td class="p-2">&ndash;</td><td class="p-2">&ndash;</td></tr><tr class="border-b border-gray-800"><td class="p-2" rowspan="2">256</td><td class="p-2">125</td><td class="p-2">8</td><td class="p-2">174</td><td class="p-2">182</td><td class="p-2">188</td></tr><tr class="border-b border-gray-800"><td class="p-2">125</td><td class="p-2">14</td><td class="p-2">186</td><td class="p-2">206</td><td class="p-2">218</td></tr></tbody></table>
      </div>

      <h3 id="sec-4.3" class="text-xl font-semibold mt-6">4.3 Exploiting Multiplicative Subgroups</h3>
      <p class="text-gray-300">For <span class="math">q = 2^&#123;61&#125; + 20 \times 2^&#123;32&#125; + 1</span>, <span class="math">t = 12</span>, a subgroup of size <span class="math">\approx 2^&#123;48&#125;</span> gives a zero-sum on <span class="math">102</span> rounds (full permutation) at complexity <span class="math">\approx 2^&#123;48&#125;</span>.</p>
    </section>

    <!-- 5. DIFFERENTIAL ATTACKS -->

    <section id="sec-5" class="mb-10">
      <h2 class="text-2xl font-bold mb-4">5 Differential Attacks on Round-Reduced GMiMC</h2>

      <h3 id="sec-5.1" class="text-xl font-semibold mt-6">5.1 Impossible Differential Attacks</h3>
      <p class="text-gray-300">We show <span class="math">(0, \ldots, 0, \alpha_1) \not\to (\beta_1, 0, \ldots, 0)</span> is impossible over <span class="math">3t-4</span> rounds when <span class="math">\alpha_1 \neq \beta_1</span>, improving the <span class="math">(2t-2)</span>-round result [Alb+19c]. See <a href="#sec-A">Appendix A</a>.</p>

      <h3 id="sec-5.2" class="text-xl font-semibold mt-6">5.2 A Differential Distinguisher</h3>
      <p class="text-gray-300">The <span class="math">t</span>-round differential <span class="math">(0, \ldots, 0, \alpha, \alpha') \xrightarrow&#123;\mathcal&#123;R&#125;^t&#125; (0,\ldots,0,\alpha-\beta,\alpha'+\beta)</span> holds when <span class="math">\beta' = -\beta</span> (probability <span class="math">2^&#123;-n&#125;</span>). Iterating 8 times for <span class="math">t=12, n=61</span> gives probability <span class="math">2^&#123;-488&#125;</span>. Using structures reduces data complexity to <span class="math">2^&#123;367&#125;</span>. Three active words distinguish the full 101 rounds at <span class="math">2^&#123;320&#125;</span>.</p>

      <h3 id="sec-5.3" class="text-xl font-semibold mt-6">5.3 Algebraically Controlled Differential Attacks</h3>
      <p class="text-gray-300">Representing the state symbolically: <strong><span class="math">3t-2</span> rounds</strong> via a degree-27 univariate equation; <strong><span class="math">4t-2</span> rounds</strong> (inside-out) via two degree-27 bivariate equations (under 1 minute in MAGMA); <strong><span class="math">4t-4</span> rounds</strong> via degrees 243 and 729. All extend by <span class="math">t</span> rounds at cost <span class="math">q</span>.</p>

      <h3 id="sec-5.4" class="text-xl font-semibold mt-6">5.4 Reduced-Round Collision Attacks</h3>
      <p class="text-gray-300"><strong>Structures:</strong> collisions on <span class="math">4t-6</span> rounds &mdash; 42 rounds at <span class="math">2^&#123;92&#125;</span> (GMiMC-128-d), 50 rounds at <span class="math">2^&#123;187&#125;</span> (GMiMC-256). <strong>Algebraic:</strong> practical collision on 40 rounds, extensible to 52 rounds at <span class="math">\approx 2^&#123;90&#125;</span>.</p>
    </section>

    <!-- 6. ATTACKS ON HadesMiMC -->

    <section id="sec-6" class="mb-10">
      <h2 class="text-2xl font-bold mb-4">6 Attacks on HadesMiMC</h2>

      <h3 id="sec-6.1" class="text-xl font-semibold mt-6">6.1 Integral Distinguishers</h3>
      <div class="formal-block formal-block-lemma">
        <div class="formal-block-title text-amber-400">Lemma 1</div>
        <div class="formal-block-content">
          <p class="text-gray-300">Let <span class="math">F: \mathbb&#123;F&#125;_q^t \to \mathbb&#123;F&#125;_q^t</span> be from <span class="math">r \geq 1</span> partial HadesMiMC rounds with linear layer <span class="math">L</span> of order <span class="math">h</span>. There exists <span class="math">V</span> with <span class="math">\dim V \geq t - \min\&#123;h, r\&#125;</span> such that <span class="math">F(x + V) \subseteq F(x) + L^r(V)</span>.</p>
        </div>
      </div>
      <p class="text-gray-300">This covers <span class="math">(t-1) + \lfloor\log_3(q-2)\rfloor</span> rounds. The backwards extension gives a zero-sum on all but the first two rounds.</p>

      <div id="table-4" class="overflow-x-auto mb-6">
        <p class="text-sm text-gray-400 mb-2"><strong>Table 4:</strong> HadesMiMC zero-sum distinguisher rounds.</p>
        <table class="w-full text-sm"><thead><tr class="border-b border-gray-700"><th class="text-left p-2 text-gray-300">Sec.</th><th class="text-left p-2 text-gray-300"><span class="math">t</span></th><th class="text-left p-2 text-gray-300"><span class="math">\log_2 q</span></th><th class="text-left p-2 text-gray-300">Poseidon</th><th class="text-left p-2 text-gray-300">ZS</th><th class="text-left p-2 text-gray-300">Starkad</th><th class="text-left p-2 text-gray-300">ZS</th></tr></thead><tbody class="text-gray-400"><tr class="border-b border-gray-800"><td class="p-2" rowspan="5">128</td><td class="p-2">12</td><td class="p-2">61</td><td class="p-2">8, 40</td><td class="p-2">2+4, 45</td><td class="p-2">8, 43</td><td class="p-2">2+4, 46</td></tr><tr class="border-b border-gray-800"><td class="p-2">4</td><td class="p-2">125</td><td class="p-2">8, 81</td><td class="p-2">2+4, 77</td><td class="p-2">8, 85</td><td class="p-2">2+4, 77</td></tr><tr class="border-b border-gray-800"><td class="p-2">12</td><td class="p-2">125</td><td class="p-2">8, 83</td><td class="p-2">2+4, 85</td><td class="p-2">8, 86</td><td class="p-2">2+4, 85</td></tr><tr class="border-b border-gray-800"><td class="p-2">3</td><td class="p-2">253</td><td class="p-2">8, 83</td><td class="p-2">2+4, 157</td><td class="p-2">8, 85</td><td class="p-2">2+4, 158</td></tr><tr class="border-b border-gray-800"><td class="p-2">12</td><td class="p-2">253</td><td class="p-2">8, 85</td><td class="p-2">2+4, 165</td><td class="p-2">8, 88</td><td class="p-2">2+4, 166</td></tr><tr class="border-b border-gray-800"><td class="p-2" rowspan="2">256</td><td class="p-2">8</td><td class="p-2">125</td><td class="p-2">8, 82</td><td class="p-2">2+4, 81</td><td class="p-2">8, 86</td><td class="p-2">2+4, 81</td></tr><tr class="border-b border-gray-800"><td class="p-2">14</td><td class="p-2">125</td><td class="p-2">8, 83</td><td class="p-2">2+4, 87</td><td class="p-2">8, 83</td><td class="p-2">2+4, 87</td></tr></tbody></table>
      </div>

      <h3 id="sec-6.2" class="text-xl font-semibold mt-6">6.2 Finding Preimages by Linearization</h3>
      <div class="formal-block formal-block-lemma">
        <div class="formal-block-title text-amber-400">Lemma 2</div>
        <div class="formal-block-content">
          <p class="text-gray-300">For <span class="math">V = \langle L(\delta_t), \ldots, L^r(\delta_t) \rangle^&#123;\perp&#125;</span> and all <span class="math">v \in V</span>:</p>
          <div class="math-block">v \cdot F(x) = v \cdot L^&#123;r&#125;(x) + \sum_&#123;i=1&#125;^&#123;r&#125; v \cdot L^&#123;r+1-i&#125;(c_i).</div>
        </div>
      </div>
      <p class="text-gray-300">Guessing <span class="math">U_2 F(x)</span> and solving via Gr&ouml;bner bases gives total cost</p>
      <div class="math-block">2\gamma (2\pi)^&#123;-\omega/2&#125; k^&#123;2-\omega/2&#125; e^&#123;\omega k&#125; 3^&#123;(\omega k+1)(R_F-1)&#125; q^&#123;t-d&#125;.</div>

      <div id="table-5" class="overflow-x-auto mb-6">
        <p class="text-sm text-gray-400 mb-2"><strong>Table 5:</strong> Preimage attack cost (involutive <span class="math">L</span>).</p>
        <table class="w-full text-sm"><thead><tr class="border-b border-gray-700"><th class="text-left p-2 text-gray-300">Variant</th><th class="text-left p-2 text-gray-300"><span class="math">c</span></th><th class="text-left p-2 text-gray-300"><span class="math">\omega \approx 2.8</span></th><th class="text-left p-2 text-gray-300"><span class="math">\omega = 3</span></th></tr></thead><tbody class="text-gray-400"><tr class="border-b border-gray-800"><td class="p-2">128-e</td><td class="p-2">1</td><td class="p-2"><span class="math">2^&#123;114.9&#125;</span></td><td class="p-2"><span class="math">2^&#123;122.3&#125;</span></td></tr><tr class="border-b border-gray-800"><td class="p-2">256-b</td><td class="p-2">4</td><td class="p-2"><span class="math">2^&#123;221.1&#125;</span></td><td class="p-2"><span class="math">2^&#123;235.7&#125;</span></td></tr></tbody></table>
      </div>
    </section>

    <!-- 7. CONCLUSIONS -->

    <section id="sec-7" class="mb-10">
      <h2 class="text-2xl font-bold mb-4">7 Conclusions</h2>
      <p class="text-gray-300">The concrete instances of GMiMC and HadesMiMC present major weaknesses. Vision/Rescue [Aly+19] appears more resistant due to full S-box layers. The extension of integral attacks to odd characteristic raises many open questions.</p>
      <p class="text-gray-300"><em>Acknowledgements.</em> Funding from StarkWare Industries and the Ethereum Foundation. Tim Beyne (FWO), Itai Dinur (ISF grant 573/16). ERC grants 714294, 757731, 681402.</p>
    </section>

    <!-- REFERENCES -->

    <section id="references" class="mb-10">
      <h2 class="text-2xl font-bold mb-4">References</h2>
      <ul class="space-y-2 text-sm text-gray-400 list-none">
        <li><span class="text-gray-500">[Abd+17]</span> Abdelkhalek, A. <em>et al.</em>: MILP modeling for S-boxes. IACR Trans. Symm. Cryptol. 2017(4) (2017)</li>
        <li><span class="text-gray-500">[AP11]</span> Agnesse, A., Pedicini, M.: Cube attack in finite fields of higher order. AISC 2011 (2011)</li>
        <li><span class="text-gray-500">[Alb+19a]</span> Albrecht, M.R. <em>et al.</em>: Algebraic cryptanalysis of STARK-friendly designs. ASIACRYPT 2019 (2019)</li>
        <li><span class="text-gray-500">[Alb+19b]</span> Albrecht, M.R. <em>et al.</em>: Feistel structures for MPC. ESORICS 2019 (2019) <a href="/papers/feistel-structures-mpc-2019" class="text-blue-400 hover:text-blue-300">[page on this site]</a></li>
        <li><span class="text-gray-500">[Alb+19c]</span> Albrecht, M.R. <em>et al.</em>: Feistel structures for MPC. ePrint 2019/397 (2019) <a href="/papers/feistel-structures-mpc-2019" class="text-blue-400 hover:text-blue-300">[page on this site]</a></li>
        <li><span class="text-gray-500">[AGR+16]</span> Albrecht, M.R. <em>et al.</em>: MiMC. ASIACRYPT 2016 (2016)</li>
        <li><span class="text-gray-500">[ARS+15]</span> Albrecht, M.R. <em>et al.</em>: Ciphers for MPC and FHE. EUROCRYPT 2015 (2015)</li>
        <li><span class="text-gray-500">[Aly+19]</span> Aly, A. <em>et al.</em>: Design of symmetric-key primitives. ePrint 2019/426 (2019)</li>
        <li><span class="text-gray-500">[AD18]</span> Ashur, T., Dhooghe, S.: MARVELlous. ePrint 2018/1098 (2018)</li>
        <li><span class="text-gray-500">[Aum+10]</span> Aumasson, J.P. <em>et al.</em>: Distinguishers for Hamsi-256. ACISP 2010 (2010)</li>
        <li><span class="text-gray-500">[AM09]</span> Aumasson, J.P., Meier, W.: Zero-sum distinguishers for reduced Keccak-f. CHES 2009 (2009)</li>
        <li><span class="text-gray-500">[Aum+14]</span> Aumasson, J. <em>et al.</em>: The Hash Function BLAKE. Springer (2014)</li>
        <li><span class="text-gray-500">[Bar+15]</span> Bar-On, A. <em>et al.</em>: Cryptanalysis of SP networks. EUROCRYPT 2015 (2015)</li>
        <li><span class="text-gray-500">[Bar+15b]</span> Bardet, M. <em>et al.</em>: On the complexity of F5. J. Symbolic Computation 70 (2015)</li>
        <li><span class="text-gray-500">[BBHR18]</span> Ben-Sasson, E. <em>et al.</em>: Scalable computational integrity. ePrint 2018/046 (2018)</li>
        <li><span class="text-gray-500">[Ber+07]</span> Bertoni, G. <em>et al.</em>: Sponge functions. ECRYPT Hash Workshop (2007)</li>
        <li><span class="text-gray-500">[Ber+08]</span> Bertoni, G. <em>et al.</em>: On the indifferentiability of the sponge. EUROCRYPT 2008 (2008)</li>
        <li><span class="text-gray-500">[Ber+09]</span> Bertoni, G. <em>et al.</em>: Keccak sponge function family. NIST (2009)</li>
        <li><span class="text-gray-500">[Bon19]</span> Bonnetain, X.: Collisions on Feistel-MiMC. ePrint 2019/951 (2019) <a href="/papers/collisions-feistel-mimc-2019" class="text-blue-400 hover:text-blue-300">[page on this site]</a></li>
        <li><span class="text-gray-500">[Bou+11]</span> Boura, C. <em>et al.</em>: Higher-order differential properties of Keccak. FSE 2011 (2011)</li>
        <li><span class="text-gray-500">[Can+18]</span> Canteaut, A. <em>et al.</em>: Stream ciphers for homomorphic compression. J. Cryptology 31(3) (2018)</li>
        <li><span class="text-gray-500">[DLMW15]</span> Dinur, I. <em>et al.</em>: Optimized interpolation attacks on LowMC. ASIACRYPT 2015 (2015)</li>
        <li><span class="text-gray-500">[Dob+18]</span> Dobraunig, C. <em>et al.</em>: Rasta. CRYPTO 2018 (2018)</li>
        <li><span class="text-gray-500">[DEM16]</span> Dobraunig, C. <em>et al.</em>: Higher-order cryptanalysis of LowMC. ICISC 2015 (2016)</li>
        <li><span class="text-gray-500">[FGM+93]</span> Faug&egrave;re, J.C. <em>et al.</em>: Zero-dimensional Gr&ouml;bner bases. J. Symbolic Computation 16(4) (1993)</li>
        <li><span class="text-gray-500">[FM11]</span> Faug&egrave;re, J.C., Mou, C.: Change of ordering of Gr&ouml;bner bases. ISSAC 2011 (2011)</li>
        <li><span class="text-gray-500">[FP19]</span> Faug&egrave;re, J.C., Perret, L.: Algebraic attacks against STARK-friendly ciphers. (2019)</li>
        <li><span class="text-gray-500">[GKK+19]</span> Grassi, L. <em>et al.</em>: Starkad and Poseidon. ePrint 2019/458 (2019) <a href="/papers/poseidon-2019" class="text-blue-400 hover:text-blue-300">[page on this site]</a></li>
        <li><span class="text-gray-500">[GLR+20]</span> Grassi, L. <em>et al.</em>: The HADES design strategy. ePrint 2019/1107 (2019) <a href="/papers/hades-2019" class="text-blue-400 hover:text-blue-300">[page on this site]</a></li>
        <li><span class="text-gray-500">[Kat19]</span> Katz, J.: Secure computation. CRYPTO 2019 invited talk (2019)</li>
        <li><span class="text-gray-500">[KU08]</span> Kedlaya, K.S., Umans, C.: Fast modular composition. 49th FOCS (2008)</li>
        <li><span class="text-gray-500">[KR07]</span> Knudsen, L.R., Rijmen, V.: Known-key distinguishers. ASIACRYPT 2007 (2007)</li>
        <li><span class="text-gray-500">[KW02]</span> Knudsen, L.R., Wagner, D.: Integral cryptanalysis. FSE 2002 (2002)</li>
        <li><span class="text-gray-500">[Lai94]</span> Lai, X.: Higher order derivatives and differential cryptanalysis. (1994)</li>
        <li><span class="text-gray-500">[Mac02]</span> Macaulay, F.S.: Some formulae in elimination. Proc. London Math. Soc. (1902)</li>
        <li><span class="text-gray-500">[Mea+16]</span> M&eacute;aux, P. <em>et al.</em>: Stream ciphers for FHE. EUROCRYPT 2016 (2016)</li>
        <li><span class="text-gray-500">[Mou+11]</span> Mouha, N. <em>et al.</em>: Differential and linear cryptanalysis using MILP. Inscrypt 2011 (2011)</li>
        <li><span class="text-gray-500">[Rec+18]</span> Rechberger, C. <em>et al.</em>: Cryptanalysis of LowMCv2. IACR Trans. Symm. Cryptol. 2018(3) (2018)</li>
        <li><span class="text-gray-500">[Saj+12]</span> Sajadieh, M. <em>et al.</em>: Involutory MDS matrices. Designs, Codes and Cryptography 64(3) (2012)</li>
        <li><span class="text-gray-500">[Sal+17]</span> S&#259;l&#259;gean, A. <em>et al.</em>: Higher order differentiation over finite fields. Designs, Codes and Cryptography 84(3) (2017)</li>
        <li><span class="text-gray-500">[Sta19]</span> StarkWare Industries: Personal communication (2019)</li>
        <li><span class="text-gray-500">[Ste+17]</span> Stevens, M. <em>et al.</em>: The first collision for full SHA-1. CRYPTO 2017 (2017)</li>
        <li><span class="text-gray-500">[You+96]</span> Youssef, A. <em>et al.</em>: Linear transformations for SPNs. SAC 1996 (1996)</li>
      </ul>
    </section>

    <!-- APPENDICES -->

    <section id="sec-A" class="mb-10">
      <h2 class="text-2xl font-bold mb-4">A Impossible Differential Attack on GMiMC</h2>
      <p class="text-gray-300">The middle <span class="math">t-2</span> rounds yield a linear system giving <span class="math">\alpha_1 = \beta_1</span> as a necessary condition, so the differential is impossible when <span class="math">\alpha_1 \neq \beta_1</span>.</p>
    </section>

    <section id="sec-B" class="mb-10">
      <h2 class="text-2xl font-bold mb-4">B Optimality of the Differential Characteristics for GMiMC</h2>
      <p class="text-gray-300">An MILP model confirms that the proposed characteristics are essentially optimal. Structured characteristics yield cost <span class="math">k+1</span> for <span class="math">kt-1</span> to <span class="math">(k+1)t-2</span> rounds.</p>
    </section>

    <section id="sec-C" class="mb-10">
      <h2 class="text-2xl font-bold mb-4">C Weak Cauchy Matrices</h2>
      <div class="formal-block formal-block-theorem">
        <div class="formal-block-title text-green-400">Theorem 1</div>
        <div class="formal-block-content">
          <p class="text-gray-300">Let <span class="math">G = \&#123;x_1, \ldots, x_t\&#125;</span> be an additive subgroup of <span class="math">\mathbb&#123;F&#125;_&#123;2^n&#125;</span> and <span class="math">a \notin G</span>. For <span class="math">L_&#123;i,j&#125; = 1/(x_i + x_j + a)</span>: <span class="math">L^2 = b^2 I</span> with <span class="math">b = \sum_&#123;i=1&#125;^t 1/(x_i + a)</span>.</p>
        </div>
      </div>
      <p class="text-gray-300"><em>Proof.</em> For <span class="math">i \neq j</span>, <span class="math">(L^2)_&#123;i,j&#125; = \frac&#123;1&#125;&#123;g&#125;\sum_&#123;x \in a+G&#125;(\frac&#123;1&#125;&#123;x&#125; + \frac&#123;1&#125;&#123;x+g&#125;) = 0</span> where <span class="math">g = x_i + x_j</span>.</p>
    </section>

    <section id="sec-D" class="mb-10">
      <h2 class="text-2xl font-bold mb-4">D Cost of the Preimage Attack from Section 6.2</h2>
      <p class="text-gray-300">Cost dominated by <span class="math">T_&#123;\mathrm&#123;gb&#125;&#125; = \mathcal&#123;O&#125;(\binom&#123;D+k&#125;&#123;D&#125;^&#123;\omega&#125;)</span> and <span class="math">T_&#123;\text&#123;fglm&#125;&#125; = \mathcal&#123;O&#125;(k\,\dim(\mathbb&#123;F&#125;_q[x_1,\dots,x_k]/\mathcal&#123;I&#125;)^&#123;\omega&#125;)</span>. Via Stirling:</p>
      <div class="math-block">T_&#123;\mathrm&#123;gb&#125;&#125; \lesssim \gamma(2\pi)^&#123;-\omega/2&#125; k^&#123;2-\omega/2&#125; e^&#123;\omega k&#125; 3^&#123;(\omega k+1)(R_F-1)&#125;.</div>
      <p class="text-gray-300">The attack improves over <span class="math">q^&#123;\min\&#123;c/2,k\&#125;&#125;</span> when</p>
      <div class="math-block">\frac&#123;(t-d)\log_3 q + R_F + \log_3 C&#125;&#123;\log_3 q - \omega(R_F + \log_3 e - 1)&#125; \le k \le \frac&#123;(d-t/2)\log_3 q - R_F - \log_3 C&#125;&#123;\tfrac&#123;1&#125;&#123;2&#125;\log_3 q + \omega(R_F + \log_3 e - 1)&#125;.</div>
    </section>

  </article>
</BaseLayout>
