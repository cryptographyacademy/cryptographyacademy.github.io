---
import BaseLayout from '../../layouts/BaseLayout.astro';
import PaperDisclaimer from '../../components/PaperDisclaimer.astro';
import PaperHistory from '../../components/PaperHistory.astro';

const EPRINT_URL = 'https://eprint.iacr.org/2020/500';
const CRAWLER = 'marker';
const CONVERTED_DATE = '2026-02-16';
const TITLE_HTML = 'Proving Resistance Against Infinitely Long Subspace Trails: How to Choose the Linear Layer';
const AUTHORS_HTML = 'Lorenzo Grassi, Christian Rechberger, Markus Schofnegger';

const CONTENT = `    <section id="abstract" class="mb-10">
      <h2 class="text-2xl font-bold">Abstract</h2>
      <p class="text-gray-300">Designing cryptographic permutations and block ciphers using a substitution-permutation network (SPN) approach where the nonlinear part does not cover the entire state has recently gained attention due to favorable implementation characteristics in various scenarios.

For word-oriented partial SPN (P-SPN) schemes with a fixed linear layer, our goal is to better understand how the details of the linear layer affect the security of the construction. In this paper, we derive conditions that allow us to either set up or prevent attacks based on infinitely long truncated differentials with probability 1. Our analysis is rather broad compared to earlier independent work on this problem since we consider (1) both invariant and non-invariant/iterative trails, and (2) trails with and without active S-boxes.

For these cases, we provide rigorous sufficient and necessary conditions for the matrix that defines the linear layer to prevent the analyzed attacks. On the practical side, we present a tool that can determine whether a given linear layer is vulnerable based on these results.
Furthermore, we propose a sufficient condition for the linear layer that, if satisfied, ensures that no infinitely long truncated differential exists. This condition is related to the degree and the irreducibility of the minimal polynomial of the matrix that defines the linear layer.

Besides P-SPN schemes, our observations may also have a crucial impact on the Hades design strategy, which mixes rounds with full S-box layers and rounds with partial S-box layers.</p>
      <p class="text-gray-300"><strong>Keywords:</strong> Partial SPN &middot; Linear Layer &middot; Invariant Subspace &middot; Subspace Trail &middot; HADES</p>
    </section>

    <section id="sec-8" class="mb-10">
      <h2 class="text-2xl font-bold">8 Security Against Infinitely Long Subspace Trails</h2>

    <p class="text-gray-300">Until now, we presented necessary and sufficient conditions that a (highly nontrivial) linear layer must satisfy in order to prevent the existence of infinitely long subspace trails. Here, we present a sufficient condition on the matrix that defines the linear layer of the P-SPN scheme that &ndash; if satisfied &ndash; ensures that no infinitely long (invariant/iterative) subspace trail (with/without active S-boxes) exists. Finally, we list some open problems that could be interesting for future research.</p>

      <h3 id="sec-8.1" class="text-xl font-semibold mt-8">8.1 Sufficient Condition for Preventing Infinitely Long Subspace Trails</h3>

    <p class="text-gray-300">As a final result, we propose a sufficient condition on the matrix M defining the linear layer of the P-SPN scheme that &ndash; if satisfied &ndash; ensures that no infinitely long (invariant/iterative) subspace trail (with/without active S-boxes) exists. This condition only involves the details of the minimal polynomial of the matrix, and it is independent of the number of S-boxes per round. At the same time, we emphasize that it is only a sufficient condition. Hence, there exist matrices which do not satisfy it but which provide security against the approaches discussed in this paper.</p>

    <p class="text-gray-300">In order to reach this goal, we first prove the following result:</p>

    <p class="text-gray-300"><strong>Proposition 12.</strong> Let  <span class="math">\\phi</span>  be the minimal polynomial of an invertible matrix  <span class="math">M \\in \\mathbb{F}^{t \\times t}</span> . Assume that  <span class="math">\\phi</span>  is irreducible and let  <span class="math">v \\in \\mathbb{F}^t \\setminus \\{0\\}</span> . For each monic polynomial  <span class="math">\\phi&#x27; \\in \\mathbb{F}[x]</span>  such that  <span class="math">\\phi&#x27;(M) \\cdot v = 0</span>  and  <span class="math">\\deg(\\phi&#x27;) \\leq \\deg(\\phi)</span> , it follows that  <span class="math">\\phi&#x27; = \\phi</span> .</p>

    <p class="text-gray-300">Before proving the result, we mention that if  <span class="math">\\phi&#x27;</span>  is a multiple of  <span class="math">\\phi</span> , then  <span class="math">\\deg(\\phi&#x27;) &gt; \\deg(\\phi)</span>  and  <span class="math">\\phi&#x27;(M) \\cdot w = 0</span>  for each  <span class="math">w \\in \\mathbb{F}^t</span> .</p>

    <p class="text-gray-300">Proof. Let  <span class="math">v \\in \\mathbb{F}^t \\setminus \\{0\\}</span>  such that  <span class="math">\\phi&#x27;(M) \\cdot v = 0</span>  for a certain polynomial  <span class="math">\\phi&#x27;</span>  for which  <span class="math">\\deg(\\phi&#x27;) &lt; \\deg(\\phi)</span> . In such a case,  <span class="math">\\{v, M \\cdot v, \\dots, M^{\\deg(\\phi)-1} \\cdot v\\}</span>  are not linearly independent. In particular, the subspace  <span class="math">\\mathcal{V} = \\langle v, M \\cdot v, \\dots, M^{\\deg(\\phi&#x27;)-1} \\cdot v \\rangle</span>  is a proper M-invariant subspace of  <span class="math">\\mathbb{F}^t</span> . Due to [Kai08, Prop. 2], we have that  <span class="math">\\phi|_{\\mathcal{V}} = \\phi&#x27;</span>  divides  <span class="math">\\phi</span> . However, this is not possible, since  <span class="math">\\phi</span>  is irreducible. It follows that each monic polynomial  <span class="math">\\phi&#x27; \\in \\mathbb{F}[x]</span>  such that  <span class="math">\\phi&#x27;(M) \\cdot v = 0</span>  and  <span class="math">\\deg(\\phi&#x27;) \\leq \\deg(\\phi)</span>  has the same degree as  <span class="math">\\phi</span> .</p>

    <p class="text-gray-300">Next, we have to prove that  <span class="math">\\phi&#x27; = \\phi</span> . As before, let  <span class="math">v \\in \\mathbb{F}^t \\setminus \\{0\\}</span>  such that  <span class="math">\\phi&#x27;(M) \\cdot v = 0</span>  for a certain monic polynomial  <span class="math">\\phi&#x27;</span>  where  <span class="math">d = \\deg(\\phi&#x27;) = \\deg(\\phi)</span>  and  <span class="math">\\phi&#x27; \\neq \\phi</span> . It follows that there are two linear combinations of  <span class="math">\\{v, M \\cdot v, \\dots, M^d \\cdot v\\}</span>  that are equal to zero, one induced by  <span class="math">\\phi&#x27;</span>  and one induced by  <span class="math">\\phi</span>  (note that they are different since  <span class="math">\\phi&#x27; \\neq \\phi</span>  and since the two polynomials are monic, that is,  <span class="math">\\phi&#x27;</span>  is not a multiple of  <span class="math">\\phi</span> ). Hence, there exists a linear combination of  <span class="math">\\{v, M \\cdot v, \\dots, M^{d-1} \\cdot v\\}</span>  that is equal to zero. Thus, there also exists a polynomial  <span class="math">\\phi&#x27;&#x27;</span>  of degree strictly less than d for which  <span class="math">\\phi&#x27;&#x27;(M) \\cdot v = 0</span> . Such a polynomial is a nontrivial divisor of  <span class="math">\\phi</span> , which leads to a contradiction.</p>

    <p class="text-gray-300">Based on this result, we can prove the following proposition.</p>

    <p class="text-gray-300"><strong>Proposition 13.</strong> Given a P-SPN scheme over  <span class="math">\\mathbb{F}^t</span>  with s S-boxes defined as in Eq. (1), let  <span class="math">M \\in \\mathbb{F}^{t \\times t}</span>  be the invertible matrix that defines the linear layer. Assume that the S-box has no (nontrivial) linear structure. If the minimal polynomial  <span class="math">\\phi</span>  of M has maximum degree t and is irreducible, there is no infinitely long invariant subspace trail with/without active S-boxes.</p>

    <p class="text-gray-300"><em>Proof.</em> Due to Proposition 12 and since  <span class="math">\\deg(\\phi) = t</span> , for each  <span class="math">v \\in \\mathbb{F}^t \\setminus \\{0\\}</span>  the vectors</p>

    <p class="text-gray-300"><span class="math">$\\{v, M \\cdot v, M^2 \\cdot v, \\dots, M^{t-1} \\cdot v\\}</span>$</p>

    <p class="text-gray-300">are linearly independent. Hence, there is no nontrivial subspace of  <span class="math">\\mathbb{F}^t</span>  that is M-invariant. Indeed, if  <span class="math">\\mathcal{S}</span>  is an M-invariant subspace, then  <span class="math">\\{v, M \\cdot v, M^2 \\cdot v, \\dots, M^{t-1} \\cdot v\\}</span>  must be in  <span class="math">\\mathcal{S}</span>  for each  <span class="math">v \\in \\mathcal{S} \\setminus \\{0\\}</span> . Since  <span class="math">\\{v, M \\cdot v, M^2 \\cdot v, \\dots, M^{t-1} \\cdot v\\}</span>  are linearly independent and since  <span class="math">\\mathcal{S}</span>  is a subspace, it follows that  <span class="math">\\langle v, M \\cdot v, M^2 \\cdot v, \\dots, M^{t-1} \\cdot v \\rangle \\subseteq \\mathcal{S}</span> , that is,  <span class="math">\\dim(\\mathcal{S}) = t</span> , which implies that  <span class="math">\\mathcal{S}</span>  is a trivial subspace. Hence, there is no nontrivial subspace  <span class="math">\\mathcal{S}</span>  in  <span class="math">\\mathbb{F}^t</span>  that generates an infinitely long invariant subspace trail both in the case with and without active S-boxes (under the assumption that the S-box has no nontrivial linear structure).</p>

    <p class="text-gray-300">Note that this result does not imply security against infinitely long <em>iterative</em> subspace trails with active S-boxes. Indeed, as shown in the example given in Eq. (8), there are matrices for which there exists an infinitely long iterative subspace trail with active S-boxes but no infinitely long invariant subspace trails. In order to guarantee security against all infinitely long subspace trails (under the assumption that the S-box has no nontrivial linear structure), we propose the following result.</p>

    <p class="text-gray-300"><strong>Theorem 8.</strong> Let  <span class="math">l \\geq 1</span> . Given a P-SPN scheme over  <span class="math">\\mathbb{F}^t</span>  with s S-boxes defined as in Eq. (1), let  <span class="math">M \\in \\mathbb{F}^{t \\times t}</span>  be the invertible matrix that defines the linear layer. Assume that the S-box has no (nontrivial) linear structure. If all the minimal polynomials of  <span class="math">M, M^2, \\ldots, M^l</span>  are of maximum degree t and irreducible, then there is no infinitely long subspace trail with/without active S-boxes of period less than or equal to l.</p>

    <p class="text-gray-300">The proof is a simple generalization of the previous results, by keeping in mind that an iterative subspace trail of period  <span class="math">l \\geq 2</span>  is an l-round invariant subspace trail.</p>

    <p class="text-gray-300"><sup>12</sup>E.g., if  <span class="math">\\sum_{i=0}^{d} \\alpha_i(M^i \\cdot v) = 0</span>  and  <span class="math">\\sum_{i=0}^{d} \\beta_i(M^i \\cdot v) = 0</span> , then  <span class="math">\\sum_{i=0}^{d-1} (\\alpha_i \\beta_d - \\beta_i \\alpha_d)(M^i \\cdot v) = 0</span> .</p>

    <div class="overflow-x-auto my-4">
      <table class="min-w-full text-sm text-gray-300">
        <thead>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">Cauchy MDS matrices over <span class="math">\\mathbb{F}_p</span></th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"></th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"></th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"></th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"></th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"></th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"></th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"></th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"></th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"></th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"></th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"></th>
        </thead>
        <tbody>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">\\lceil \\log_2(p) \\rceil</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">8</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">4</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">6</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">16</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">8</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">12</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">16</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">8</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">t</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">3</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">4</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">4</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">4</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">8</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">8</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">8</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">12</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Secure (%)</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">$  \\ge 33.79$</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">\\geq 26.52</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">\\geq 24.66</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">\\geq 25.23</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">\\geq 13.42</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">\\geq 12.89</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">\\geq 12.42</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">\\geq 8.10</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Cauchy MDS matrices over <span class="math">\\mathbb{F}_{2^n}</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">\\overline{n}</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">8</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">4</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">6</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">16</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">8</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">12</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">16</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">8</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">t</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">3</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">4</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">4</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">4</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">8</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">8</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">8</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">12</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Secure (%)</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">$  \\ge 33.75$</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">\\geq 18.93</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">\\geq 24.96</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">\\geq 25.42</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">\\geq 12.22</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">\\geq 12.34</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">\\geq 12.78</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">\\geq 8.73</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
        </tbody>
      </table>
    </div>

    <p class="text-gray-300">Table 5: Percentages of Cauchy MDS matrices fulfilling the requirement in Proposition 13.</p>

    <p class="text-gray-300"><strong>Discussion.</strong> Lastly, one may ask how many matrices satisfy the required property just given. Assume an irreducible polynomial  <span class="math">\\phi \\in \\mathbb{F}[x]</span>  of degree t. Working with matrices over  <span class="math">\\mathbb{F}_q^{t \\times t}</span> , it is always possible to associate a companion matrix C to such a minimal polynomial, as given in Definition 10 (the characteristic polynomial and the minimal polynomial are equal in this case). Hence, all matrices M similar to C (i.e., all matrices M of the form  <span class="math">A^{-1} \\cdot C \\cdot A</span>  for an invertible matrix A) satisfy Proposition 13 by construction.</p>

    <p class="text-gray-300">For this reason, here we focus on the case of MDS matrices. We practically evaluated the percentage of Cauchy MDS matrices which satisfy the condition given in Proposition 13. The results are shown in Table 5. For each of the tests, we set the sample size to 10 000. It is possible to observe that increasing the state size leads to a lower probability of the matrix to satisfy the condition given in Proposition 13. In any case, we recall that the condition just given is only a <em>sufficient</em> condition, that is, a matrix does not have to satisfy it in order to provide security against the attacks studied in this paper.</p>

      <h3 id="sec-8.2" class="text-xl font-semibold mt-8">8.2 Open Problems</h3>

    <p class="text-gray-300">As already mentioned, several problems are still open for future research. They are summarized in the following.</p>

    <ul class="list-disc list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li>The goal of this work is to guarantee that the choice of the matrix M prevents infinitely long subspace trails. As a next step, given a matrix for which no infinitely long subspace trail exists, one may ask how many rounds are needed in order to activate at least one S-box. In our practical tests regarding this issue, and when focusing on s=1, we observed that  <span class="math">t+\\varepsilon</span>  rounds for  <span class="math">\\varepsilon\\in\\{0,1\\}</span>  are in general sufficient with high probability. We leave the open problem to find an upper bound on the number of rounds needed for reaching this goal that depends both on (1) the details of the matrix defining the scheme and (2) the number of S-boxes per round.</li>
      <li>If the analyzed S-box has a nontrivial linear structure (namely, there exist nontrivial linear structures  <span class="math">\\mathcal{U}, \\mathcal{V}</span>  such that for each u there exists a certain v such that  <span class="math">S(\\mathcal{U}+u) = \\mathcal{V}+v</span> ), then it is potentially possible to extend the result given in this paper for the case of active S-boxes in order to include this case as well.</li>
      <li>Here, we only considered the case of linear layers defined as invertible matrices over  <span class="math">\\mathbb{F}_q^{t \\times t}</span> . In the binary case (i.e.,  <span class="math">q = 2^n</span> ), it could be interesting to extend our results to the case in which the linear layer M is defined as</li>
    </ul>

    <p class="text-gray-300"><span class="math">$(M(x))[i] = \\sum_{j=1}^{t} L_{i,j}(x[j]), \\text{ where } L_{i,j}(z) = \\sum_{h=0}^{n-1} \\lambda_h^{(i,j)} \\cdot z^{2^h}</span>$</p>

    <p class="text-gray-300">are linearized polynomials (which can be efficiently computed over a binary field) and where <em>z</em> &isin; F.</p>

    <p class="text-gray-300"><strong>Acknowledgements.</strong> We thank the anonymous reviewers for their valuable comments. In particular, we thank them for the hint of using the Frobenius normal form and primary decomposition theorem in order to present the results proposed in the paper, and for the suggestion regarding the condition on the linear layer given in Section <a href="#page-28-1">8.1</a> for preventing infinitely long subspace trails. The authors also thank Christof Beierle for shepherding this final version of the paper. Further, we thank Nathan Keller for interesting discussions regarding the topic. Lorenzo Grassi is supported by the European Research Council under the ERC advanced grant agreement under grant ERC-2017-ADG Nr. 788980 ESCADA.</p>

    </section>

    <section id="references" class="mb-10">
      <h2 class="text-2xl font-bold"><strong>References</strong></h2>

    <ul class="space-y-2 text-gray-400 text-sm list-none">
      <li><p class="text-gray-300">[AAB<sup>+</sup>20] Abdelrahaman Aly, Tomer Ashur, Eli Ben-Sasson, Siemen Dhooghe, and Alan Szepieniec. Design of Symmetric-Key Primitives for Advanced Cryptographic Protocols. <em>IACR Trans. Symmetric Cryptol.</em>, 2020(3):1&ndash;45, 2020.</p></li>
      <li><p class="text-gray-300">[A&Aring;BL12] Mohamed Ahmed Abdelraheem, Martin &Aring;gren, Peter Beelen, and Gregor Leander. On the Distribution of Linear Biases: Three Instructive Examples. In <em>CRYPTO 2012</em>, volume 7417 of <em>LNCS</em>, pages 50&ndash;67, 2012.</p></li>
      <li><p class="text-gray-300">[AD18] Tomer Ashur and Siemen Dhooghe. MARVELlous: a STARK-Friendly Family of Cryptographic Primitives. Cryptology ePrint Archive, Report 2018/1098, 2018.</p></li>
      <li><p class="text-gray-300">[AGP<sup>+</sup>19] Martin R. Albrecht, Lorenzo Grassi, L&eacute;o Perrin, Sebastian Ramacher, Christian Rechberger, Dragos Rotaru, Arnab Roy, and Markus Schofnegger. Feistel Structures for MPC, and More. In <em>Computer Security - ESORICS 2019</em>, volume 11736 of <em>LNCS</em>, pages 151&ndash;171, 2019.</p></li>
      <li><p class="text-gray-300">[AGR<sup>+</sup>16] Martin R. Albrecht, Lorenzo Grassi, Christian Rechberger, Arnab Roy, and Tyge Tiessen. MiMC: Efficient Encryption and Cryptographic Hashing with Minimal Multiplicative Complexity. In <em>ASIACRYPT 2016</em>, volume 10031 of <em>LNCS</em>, pages 191&ndash;219, 2016.</p></li>
      <li><p class="text-gray-300">[ARS<sup>+</sup>15] Martin R. Albrecht, Christian Rechberger, Thomas Schneider, Tyge Tiessen, and Michael Zohner. Ciphers for MPC and FHE. In <em>EUROCRYPT 2015</em>, volume 9056 of <em>LNCS</em>, pages 430&ndash;454, 2015.</p></li>
      <li><p class="text-gray-300">[Ava17] Roberto Avanzi. The QARMA Block Cipher Family. Almost MDS Matrices Over Rings With Zero Divisors, Nearly Symmetric Even-Mansour Constructions With Non-Involutory Central Rounds, and Search Heuristics for Low-Latency S-Boxes. <em>IACR Trans. Symmetric Cryptol.</em>, 2017(1):4&ndash;44, 2017.</p></li>
      <li><p class="text-gray-300">[BBI<sup>+</sup>15] Subhadeep Banik, Andrey Bogdanov, Takanori Isobe, Kyoji Shibutani, Harunaga Hiwatari, Toru Akishita, and Francesco Regazzoni. Midori: A Block Cipher for Low Energy. In <em>ASIACRYPT 2015</em>, volume 9453 of <em>LNCS</em>, pages 411&ndash;436, 2015.</p></li>
      <li><p class="text-gray-300">[BCD<sup>+</sup>20] Tim Beyne, Anne Canteaut, Itai Dinur, Maria Eichlseder, Gregor Leander, Ga&euml;tan Leurent, Mar&iacute;a Naya-Plasencia, L&eacute;o Perrin, Yu Sasaki, Yosuke Todo, and Friedrich Wiemer. Out of Oddity - New Cryptanalytic Techniques Against Symmetric Primitives Optimized for Integrity Proof Systems. In <em>CRYPTO 2020</em>, volume 12172 of <em>LNCS</em>, pages 299&ndash;328, 2020.</p></li>
      <li><p class="text-gray-300">[BCDM20] Tim Beyne, Yu Long Chen, Christoph Dobraunig, and Bart Mennink. Dumbo, Jumbo, and Delirium: Parallel Authenticated Encryption for the Lightweight Circus. <em>IACR Trans. Symmetric Cryptol.</em>, 2020(S1):5&ndash;30, 2020.</p></li>
      <li><p class="text-gray-300">[BCLR17] Christof Beierle, Anne Canteaut, Gregor Leander, and Yann Rotella. Proving Resistance Against Invariant Attacks: How to Choose the Round Constants. In <em>CRYPTO 2017</em>, volume 10402 of <em>LNCS</em>, pages 647&ndash;678, 2017.</p></li>
      <li><p class="text-gray-300">[BDD<sup>+</sup>15] Achiya Bar-On, Itai Dinur, Orr Dunkelman, Virginie Lallemand, Nathan Keller, and Boaz Tsaban. Cryptanalysis of SP Networks with Partial Non-Linear Layers. In <em>EUROCRYPT 2015</em>, volume 9056 of <em>LNCS</em>, pages 315&ndash;342, 2015.</p></li>
      <li><p class="text-gray-300">[Bey18] Tim Beyne. Block Cipher Invariants as Eigenvectors of Correlation Matrices. In <em>ASIACRYPT 2018</em>, volume 11272 of <em>LNCS</em>, pages 3&ndash;31, 2018.</p></li>
      <li><p class="text-gray-300">[BJK<sup>+</sup>16a] Christof Beierle, J&eacute;r&eacute;my Jean, Stefan K&ouml;lbl, Gregor Leander, Amir Moradi, Thomas Peyrin, Yu Sasaki, Pascal Sasdrich, and Siang Meng Sim. The SKINNY Family of Block Ciphers and Its Low-Latency Variant MANTIS. In <em>Advances in Cryptology - CRYPTO 2016</em>, volume 9815 of <em>LNCS</em>, pages 123&ndash;153, 2016.</p></li>
      <li><p class="text-gray-300">[BJK<sup>+</sup>16b] Christof Beierle, J&eacute;r&eacute;my Jean, Stefan K&ouml;lbl, Gregor Leander, Amir Moradi, Thomas Peyrin, Yu Sasaki, Pascal Sasdrich, and Siang Meng Sim. The SKINNY Family of Block Ciphers and its Low-Latency Variant MANTIS. Cryptology ePrint Archive, Report 2016/660, 2016. <a href="https://eprint.iacr.org/2016/660" target="_blank" rel="noopener noreferrer">https://eprint.iacr.</a> <a href="https://eprint.iacr.org/2016/660" target="_blank" rel="noopener noreferrer">org/2016/660</a>.</p></li>
      <li><p class="text-gray-300">[BLN17] C&eacute;line Blondeau, Gregor Leander, and Kaisa Nyberg. Differential-Linear Cryptanalysis Revisited. <em>Journal of Cryptology</em>, 30(3):859&ndash;888, 2017.</p></li>
      <li><p class="text-gray-300">[BS91] Eli Biham and Adi Shamir. Differential Cryptanalysis of DES-like Cryptosystems. <em>Journal of Cryptology</em>, 4(1):3&ndash;72, 1991.</p></li>
      <li><p class="text-gray-300">[BS93] Eli Biham and Adi Shamir. <em>Differential Cryptanalysis of the Data Encryption Standard</em>. Springer, 1993.</p></li>
      <li><p class="text-gray-300">[CCF<sup>+</sup>18] Anne Canteaut, Sergiu Carpov, Caroline Fontaine, Tancr&egrave;de Lepoint, Mar&iacute;a Naya-Plasencia, Pascal Paillier, and Renaud Sirdey. Stream Ciphers: A Practical Solution for Efficient Homomorphic-Ciphertext Compression. <em>J. Cryptology</em>, 31(3):885&ndash;916, 2018.</p></li>
      <li><p class="text-gray-300">[DEG<sup>+</sup>18] Christoph Dobraunig, Maria Eichlseder, Lorenzo Grassi, Virginie Lallemand, Gregor Leander, Eik List, Florian Mendel, and Christian Rechberger. Rasta: A Cipher with Low ANDdepth and Few ANDs per Bit. In <em>CRYPTO 2018</em>, volume 10991 of <em>LNCS</em>, pages 662&ndash;692, 2018.</p></li>
      <li><p class="text-gray-300">[DEMS19] Christoph Dobraunig, Maria Eichlseder, Florian Mendel, and Martin Schl&auml;ffer. ASCON v1.2. NIST Lightweight Cryptography Finalist (2021), CAESAR Finalist, 2019.</p></li>
      <li><p class="text-gray-300">[DGGK19] Christoph Dobraunig, Lorenzo Grassi, Anna Guinet, and Dani&euml;l Kuijsters. Ciminion: Symmetric Encryption Based on Toffoli-Gates over Large Finite Fields. In <em>EUROCRYPT 2021</em>, LNCS, 2019.</p></li>
      <li><p class="text-gray-300">[DKP<sup>+</sup>19] Itai Dinur, Daniel Kales, Angela Promitzer, Sebastian Ramacher, and Christian Rechberger. Linear Equivalence of Block Ciphers with Partial Non-Linear Layers: Application to LowMC. In <em>EUROCRYPT 2019</em>, volume 11476 of <em>LNCS</em>, pages 343&ndash;372, 2019.</p></li>
      <li><p class="text-gray-300">[DLMW15] Itai Dinur, Yunwen Liu, Willi Meier, and Qingju Wang. Optimized Interpolation Attacks on LowMC. In <em>ASIACRYPT 2015</em>, volume 9453 of <em>LNCS</em>, pages 535&ndash;560, 2015.</p></li>
      <li><p class="text-gray-300">[DPAR00] Joan Daemen, Micha&euml;l Peeters, Gilles Van Assche, and Vincent Rijmen. Nessie Proposal: NOEKEON, 2000.</p></li>
      <li><p class="text-gray-300">[DR02] Joan Daemen and Vincent Rijmen. AES and the Wide Trail Design Strategy. In <em>EUROCRYPT 2002</em>, volume 2332 of <em>LNCS</em>, pages 108&ndash;109, 2002.</p></li>
      <li><p class="text-gray-300">[GGNPS13] B. G&eacute;rard, Vincent Grosso, M. Naya-Plasencia, and Fran&ccedil;ois-Xavier Standaert. Block Ciphers That Are Easier to Mask: How Far Can We Go? In <em>Cryptographic Hardware and Embedded Systems - CHES 2013</em>, volume 8086 of <em>LNCS</em>, pages 383&ndash;399, 2013.</p></li>
      <li><p class="text-gray-300">[GKR<sup>+</sup>19] Lorenzo Grassi, Dmitry Khovratovich, Christian Rechberger, Arnab Roy, and Markus Schofnegger. Poseidon: A New Hash Function for Zero-Knowledge Proof Systems. Cryptology ePrint Archive, Report 2019/458, 2019.</p></li>
      <li><p class="text-gray-300">[GKR<sup>+</sup>21] Lorenzo Grassi, Dmitry Khovratovich, Christian Rechberger, Arnab Roy, and Markus Schofnegger. Poseidon: A New Hash Function for Zero-Knowledge Proof Systems. In <em>30th USENIX Security Symposium (USENIX Security 21)</em>. USENIX Association, 2021.</p></li>
      <li><p class="text-gray-300">[GLR<sup>+</sup>20a] Lorenzo Grassi, Gregor Leander, Christian Rechberger, Cihangir Tezcan, and Friedrich Wiemer. Weak-Key Distinguishers for AES. In <em>SAC</em>, LNCS. Springer, 2020.</p></li>
      <li><p class="text-gray-300">[GLR<sup>+</sup>20b] Lorenzo Grassi, Reinhard L&uuml;ftenegger, Christian Rechberger, Dragos Rotaru, and Markus Schofnegger. On a Generalization of Substitution-Permutation Networks: The HADES Design Strategy. In <em>EUROCRYPT</em>, volume 12106 of <em>LNCS</em>, pages 674&ndash;704, 2020.</p></li>
      <li><p class="text-gray-300">[GLSV14] Vincent Grosso, Ga&euml;tan Leurent, Fran&ccedil;ois-Xavier Standaert, and Kerem Varici. LS-Designs: Bitslice Encryption for Efficient Masked Software Implementations. In <em>Fast Software Encryption - FSE 2014</em>, volume 8540 of <em>LNCS</em>, pages 18&ndash;37, 2014.</p></li>
      <li><p class="text-gray-300">[GRR16a] Lorenzo Grassi, Christian Rechberger, and Sondre R&oslash;njom. Subspace Trail Cryptanalysis and its Applications to AES. <em>IACR Trans. Symmetric Cryptol.</em>, 2016(2):192&ndash;225, 2016.</p></li>
      <li><p class="text-gray-300">[GRR<sup>+</sup>16b] Lorenzo Grassi, Christian Rechberger, Dragos Rotaru, Peter Scholl, and Nigel P. Smart. MPC-Friendly Symmetric Key Primitives. In <em>ACM SIGSAC Conference on Computer and Communications Security &ndash; 2016</em>, pages 430&ndash;443. ACM, 2016.</p></li>
      <li><p class="text-gray-300">[GRR17] Lorenzo Grassi, Christian Rechberger, and Sondre R&oslash;njom. A new structuraldifferential property of 5-round AES. In <em>EUROCRYPT 2017</em>, volume 10211 of <em>LNCS</em>, pages 289&ndash;317, 2017.</p></li>
      <li><p class="text-gray-300">[HL20] Phil Hebborn and Gregor Leander. Dasta - Alternative Linear Layer for Rasta. <em>IACR Trans. Symmetric Cryptol.</em>, 2020(3):46&ndash;86, 2020.</p></li>
      <li><p class="text-gray-300">[Hog16] Leslie Hogben. <em>Handbook of Linear Algebra</em>. CRC Press, 2nd edition, 2016.</p></li>
      <li><p class="text-gray-300">[Kai08] Klaus Kaiser. Advanced Linear Algebra. <a href="https://www.math.uh.edu/~klaus/Advanced%20Linear%20Algebra_rev.pdf" target="_blank" rel="noopener noreferrer">https://www.math.uh.edu/</a> <a href="https://www.math.uh.edu/~klaus/Advanced%20Linear%20Algebra_rev.pdf" target="_blank" rel="noopener noreferrer">~klaus/Advanced%20Linear%20Algebra\\_rev.pdf</a>, 2008.</p></li>
      <li><p class="text-gray-300">[Knu94] Lars R. Knudsen. Truncated and Higher Order Differentials. In <em>Fast Software Encryption &ndash; FSE 1994</em>, volume 1008 of <em>LNCS</em>, pages 196&ndash;211, 1994.</p></li>
      <li><p class="text-gray-300">[KPP<sup>+</sup>17] Daniel Kales, L&eacute;o Perrin, Angela Promitzer, Sebastian Ramacher, and Christian Rechberger. Improvements to the Linear Layer of LowMC: A Faster Picnic. Cryptology ePrint Archive, Report 2017/1148, 2017.</p></li>
      <li><p class="text-gray-300">[KR21] Nathan Keller and Asaf Rosemarin. Mind the Middle Layer: The HADES Design Strategy Revisited. In <em>EUROCRYPT 2021</em>, LNCS. Springer, 2021.</p></li>
      <li><p class="text-gray-300">[LAAZ11] Gregor Leander, Mohamed Ahmed Abdelraheem, Hoda AlKhzaimi, and Erik Zenner. A Cryptanalysis of PRINTcipher: The Invariant Subspace Attack. In <em>CRYPTO 2011</em>, volume 6841 of <em>LNCS</em>, pages 206&ndash;221, 2011.</p></li>
      <li><p class="text-gray-300">[LMR15] Gregor Leander, Brice Minaud, and Sondre R&oslash;njom. A Generic Approach to Invariant Subspace Attacks: Cryptanalysis of Robin, iSCREAM and Zorro. In <em>EUROCRYPT 2015</em>, volume 9056 of <em>LNCS</em>, pages 254&ndash;283, 2015.</p></li>
      <li><p class="text-gray-300">[LTW18] Gregor Leander, Cihangir Tezcan, and Friedrich Wiemer. Searching for Subspace Trails and Truncated Differentials. <em>IACR Trans. Symmetric Cryptol.</em>, 2018(1):74&ndash;100, 2018.</p></li>
      <li><p class="text-gray-300">[Mat93] Mitsuru Matsui. Linear Cryptanalysis Method for DES Cipher. In <em>EURO-CRYPT 1993</em>, volume 765 of <em>LNCS</em>, pages 386&ndash;397, 1993.</p></li>
      <li><p class="text-gray-300">[MJSC16] Pierrick M&eacute;aux, Anthony Journault, Fran&ccedil;ois-Xavier Standaert, and Claude Carlet. Towards Stream Ciphers for Efficient FHE with Low-Noise Ciphertexts. In <em>EUROCRYPT 2016</em>, volume 9665 of <em>LNCS</em>, pages 311&ndash;343, 2016.</p></li>
      <li><p class="text-gray-300">[Nag51] T. Nagell. Euler's Criterion and Legendre's Symbol. Introduction to Number Theory, 1951.</p></li>
      <li><p class="text-gray-300">[PRC12] Gilles Piret, Thomas Roche, and Claude Carlet. PICARO - A Block Cipher Allowing Efficient Higher-Order Side-Channel Resistance. In <em>Applied Cryptography and Network Security - ACNS 2012</em>, volume 7341 of <em>LNCS</em>, pages 311&ndash;328, 2012.</p></li>
      <li><p class="text-gray-300">[PW20] Thomas Peyrin and Haoyang Wang. The MALICIOUS Framework: Embedding Backdoors into Tweakable Block Ciphers. In <em>CRYPTO 2020</em>, volume 12172 of <em>LNCS</em>, pages 249&ndash;278, 2020.</p></li>
      <li><p class="text-gray-300">[Sto98] Arne Storjohann. An <em>O</em>(<em>n</em> 3) algorithm for the frobenius normal form. In <em>ISSAC</em>, pages 101&ndash;105. ACM, 1998.</p></li>
      <li><p class="text-gray-300">[TLS16] Yosuke Todo, Gregor Leander, and Yu Sasaki. Nonlinear Invariant Attack - Practical Attack on Full SCREAM, iSCREAM, and Midori64. In <em>ASI-ACRYPT 2016</em>, volume 10032 of <em>LNCS</em>, pages 3&ndash;33, 2016.</p></li>
      <li><p class="text-gray-300">[WWGY14] Yanfeng Wang, Wenling Wu, Zhiyuan Guo, and Xiaoli Yu. Differential Cryptanalysis and Linear Distinguisher of Full-Round Zorro. In <em>ACNS 2014</em>, volume 8479 of <em>LNCS</em>, pages 308&ndash;323, 2014.</p></li>
      <li><p class="text-gray-300">[YMT97] A. M. Youssef, S. Mister, and S. E. Tavares. On the Design of Linear Transformations for Substitution Permutation Encryption Networks. In <em>Selected Areas in Cryptography - SAC 1996</em>, pages 40&ndash;48, 1997.</p></li>
    </ul>

    </section>

    <section id="app-a" class="mb-10">
      <h2 class="text-2xl font-bold">A Truncated Differentials and Subspace Trails</h2>

    <p class="text-gray-300">Differential attacks [BS91] exploit the fact that pairs of inputs with certain differences yield other differences in the corresponding outputs with a probability distribution that is different from that one would expect from a random permutation. A variant of this attack/distinguisher is the truncated differential one [Knu94], in which the attacker can predict only part of the difference between pairs of texts. Using the subspace terminology, given pairs of inputs that belong to the same coset of a subspace  <span class="math">\\mathcal{X}</span> , one considers the probability that the corresponding outputs belong to the same coset of a subspace  <span class="math">\\mathcal{Y}</span>  to set up an attack (see e.g. [BLN17] for details). In particular, note that two texts  <span class="math">x, y \\in \\mathbb{F}^t</span>  are in the same coset of a given subspace (i.e., there exists  <span class="math">v \\in \\mathbb{F}^t</span>  such that  <span class="math">x, y \\in \\mathcal{V} + v</span> ) if and only if their difference belongs to such a subspace (i.e.,  <span class="math">x - y \\in \\mathcal{V}</span> ). The relation between truncated differential trails and subspace trails has been studied in details in [LTW18, BLN17].</p>

    <h3 id="sec-misc-1" class="text-xl font-semibold mt-8"><strong>Proof of Proposition 10</strong></h3>

    <p class="text-gray-300">As done before, in the following we omit the round keys and the constant additions (we recall that they only change the cosets, while here we deal with differences).</p>

    <p class="text-gray-300">The subspace trail defined over the first  <span class="math">\\mathfrak{R}</span>  rounds is already analyzed in Section 3.1. By definition of  <span class="math">\\mathfrak{R}</span> , at least one S-box is active after  <span class="math">\\mathfrak{R}</span>  rounds. It follows that the only way to extend the trail is by increasing the dimension of such a subspace, that is,</p>

    <p class="text-gray-300"><span class="math">$R\\left(M^{\\mathfrak{R}-1}\\cdot\\mathcal{S}^{(\\mathfrak{R})}\\right)\\subseteq\\mathcal{A}^{(1)}=\\left\\langle M^{\\mathfrak{R}}\\cdot\\mathcal{S}^{(\\mathfrak{R})},M(e_1),\\ldots,M(e_s)\\right\\rangle.</span>$</p>

    <p class="text-gray-300">Indeed, the only thing one can do is to consider the biggest subspace for which</p>

    <p class="text-gray-300"><span class="math">$S-box\\left(M^{(\\mathfrak{R})}\\cdot\\mathcal{S}^{(\\mathfrak{R})}\\right)\\subseteq\\big\\langle\\underbrace{e_1,e_2,\\ldots,e_s}_{\\text{Due to S-boxes}},\\underbrace{M^{\\mathfrak{R}}\\cdot\\mathcal{S}^{(\\mathfrak{R})}}_{\\text{Due to identity part}}\\big\\rangle.</span>$</p>

    <p class="text-gray-300">In this way, we lose information about the output of the S-box layer (while nothing changes for the part of the identity layer), but we can extend the subspace trail. Working in the same way, it follows that  <span class="math">R\\left(\\mathcal{A}^{(1)}\\right) \\subseteq \\mathcal{A}^{(2)} = \\left\\langle M \\cdot \\mathcal{A}^{(1)}, M(e_1), \\dots, M(e_s) \\right\\rangle</span> , and, more generally,</p>

    <p class="text-gray-300"><span class="math">$R\\left(\\mathcal{A}^{(r)}\\right) \\subseteq \\mathcal{A}^{(r+1)} = \\langle M \\cdot \\mathcal{A}^{(r)}, M(e_1), \\dots, M(e_s) \\rangle.</span>$</p>

    <p class="text-gray-300">This step can be repeated as long as the dimension of the subspace is smaller than t. Since for a generic scheme the dimension of  <span class="math">\\mathcal{S}^{(\\mathfrak{R})}</span>  is s and the dimension increases by s in each additional round, the dimension remains smaller than t for up to  <span class="math">\\mathfrak{R} + \\left\\lfloor \\frac{t-s}{s} \\right\\rfloor</span>  rounds.</p>

    <p class="text-gray-300"><strong>Remark.</strong> Due to the relation between subspace trails and truncated differentials [LTW18] mentioned before, it is possible to set up a truncated differential distinguisher on at least  <span class="math">\\Re + \\left\\lfloor \\frac{t-s}{s} \\right\\rfloor</span>  rounds with probability 1. We stress that the details of the construction (e.g., the S-box, the linear layer, the key schedule) can potentially be used to improve the previous attacks. That is,  <span class="math">\\Re + \\left\\lfloor \\frac{t-s}{s} \\right\\rfloor</span>  rounds refer only to the &quot;basic&quot; variants of such attacks, and this number must be considered only as a lower bound in order to provide security. Hence, we do not discuss the minimum number of rounds necessary to provide security against these attacks, since they strongly depend on the details of the linear layer.</p>

    <p class="text-gray-300">In this section, we give the algorithm using the results described in Section 7.2.2 for a maximum period of l=2t.</p>

    <p class="text-gray-300">21</p>

    <p class="text-gray-300">found.</p>

    <p class="text-gray-300"><strong>Algorithm 3:</strong> Determining the existence of (iterative) infinitely long subspace trails with <em>active</em> S-boxes of period at most  <span class="math">l \\geq 2</span>  based on [LMR15] and Theorem 6.</p>

    <p class="text-gray-300"><strong>Data:</strong> P-SPN scheme over  <span class="math">\\mathbb{F}^t</span>  with s S-boxes applied to the first s words (where the S-box has no linear structure). <strong>Result:</strong> 1 if (iterative) infinitely long iterative subspace trail with active S-boxes (of period at most  <span class="math">l \\geq 2</span> ) is found, 0 otherwise. 1  <span class="math">flag \\leftarrow 0</span> . 2  <span class="math">T \\leftarrow \\emptyset</span> . // T stores all iterative subspace trails found &#1079; for  <span class="math">r \\leftarrow 2</span>  to l do <strong>foreach</strong>  <span class="math">I \\subseteq \\{1, 2, ..., s\\}</span>  (where  <span class="math">I := \\{\\iota_1, ..., \\iota_{|I|}\\}</span>  and  <span class="math">I \\neq \\emptyset</span> ) <strong>do</strong> Apply Algorithm 2 to  <span class="math">M^r</span> , and let  <span class="math">\\mathcal{I}</span>  be the resulting &quot;invariant&quot; subspace 5 trail with active S-boxes in I, or let  <span class="math">\\mathcal{I} = \\emptyset</span>  if such a trail does not exist. // Check for a meaningful iterative subspace trail if  <span class="math">\\dim(\\mathcal{I}) \\geq 1</span>  then 6 if  <span class="math">\\mathcal{I} = M \\cdot \\mathcal{I}</span>  (i.e., the subspace trail is invariant) then <strong>break</strong> (move to next r) 8  <span class="math">I^{(1)} \\leftarrow \\emptyset, I^{(2)} \\leftarrow \\emptyset, \\dots, I^{(r-1)} \\leftarrow \\emptyset.</span> for  <span class="math">j \\leftarrow 1</span>  to r-1 do 10  <span class="math">\\mathcal{I} \\leftarrow M \\cdot \\mathcal{I}</span> . 11 for  <span class="math">i \\leftarrow 1</span>  to s do  <span class="math">\\mathcal{E}^{(i)} \\leftarrow \\langle e_1, \\dots, e_{i-1}, e_{i+1}, \\dots, e_s, e_{s+1}, \\dots, e_t \\rangle.</span> 13 if  <span class="math">\\mathcal{I} \\cap \\mathcal{E}^{(i)} \\neq \\mathcal{I}</span>  (eq.,  <span class="math">\\mathcal{I} \\not\\subseteq \\mathcal{E}^{(i)}</span> ) then 14 if  <span class="math">\\mathcal{I} \\cap \\langle e_i \\rangle = \\langle e_i \\rangle</span>  then 15  <span class="math">I^{(j)} \\leftarrow I^{(j)} \\cup \\{i\\}.</span> else 17 <strong>break</strong> (move to next r) 18  <span class="math">flag \\leftarrow 1</span> . 19  <span class="math">T \\leftarrow T \\cup \\{\\mathcal{I}, r, \\{I, I^{(1)}, I^{(2)}, \\dots, I^{(r-1)}\\}\\}.</span> 20</p>

    <p class="text-gray-300">Computational Cost of Algorithm 3. We mainly focus on loop iterations for the indicator of the final cost. First, we fix the maximum period l of the iterative non-invariant subspace trail. Now, Algorithm 2 is run l-1 times. After that, the next loop is iterated l'-1 times for each  <span class="math">l&#x27; \\in \\{2, \\ldots, l\\}</span> , leading to a total number of repetitions of at most  <span class="math">\\frac{l(l+1)}{2}</span> . Finally, the last loop is iterated s times. Operation costs inside these iterations are negligible. This leads to the total runtime being an element in  <span class="math">\\mathcal{O}\\left(ls\\left(2^st+l\\right)\\right)</span> , which is not a major issue in the schemes we consider, since in these schemes the number of S-boxes per round (i.e., s) tends to be small.</p>

    <p class="text-gray-300">// In the case flag=0 (hence,  <span class="math">T=\\emptyset</span> ), no infinitely long iterative subspace trail (of period  <span class="math">\\leq l</span> ) was found. return flag: infinitely long iterative subspace trails T with active S-boxes</p>

    <p class="text-gray-300"><strong>Computational Cost in Practice.</strong> We used the same hardware as for the practical tests in Section 5.2, i.e., an Intel Xeon E5-2699v4 with a maximum clock frequency of 3.60 GHz. Again, we evaluate the performance of Algorithm 3 when using matrices over prime fields and for n = 16,  <span class="math">t \\in \\{4, 12\\}</span> , and l = 2t. For t = 4, Algorithm 3 takes about 40 milliseconds. For t = 12, Algorithm 3 takes about 1 second.</p>

    </section>

    <section id="app-c" class="mb-10">
      <h2 class="text-2xl font-bold">C Results Using our Tool and More Examples of Subspace Trails with Active S-Boxes</h2>

      <h3 id="app-c.1" class="text-xl font-semibold mt-8">C.1 Starkad and Poseidon Matrices</h3>

    <p class="text-gray-300">In addition to the statistical tests described in Section 5, we also used our tool for the Cauchy matrices using specific starting sequences defined for STARKAD and POSEIDON [GKR<sup>+</sup>21]. We recall that the matrix M' over  <span class="math">\\mathbb{F}_{2^n}</span>  for STARKAD and the matrix M'' over  <span class="math">\\mathbb{F}_p</span>  for POSEIDON are defined by</p>

    <p class="text-gray-300">
<span class="math">$M&#x27;_{i,j} = \\frac{1}{x_i \\oplus y_j}</span>$
and  <span class="math">M&#x27;&#x27;_{i,j} = \\frac{1}{x_i + y_j}</span> , (10)</p>

    <p class="text-gray-300">where  <span class="math">x_i = i</span> ,  <span class="math">y_i = i + t</span> , and  <span class="math">i \\in [0, t - 1]</span> .</p>

    <p class="text-gray-300"><strong>Table 6:</strong> Vulnerable matrices for Algorithm 1 and orders t and field sizes  <span class="math">n = \\lceil \\log_2(p) \\rceil</span>  when considering the Starkad and Poseidon specifications.</p>

    <div class="overflow-x-auto my-4">
      <table class="min-w-full text-sm text-gray-300">
        <thead>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">Poseidon Specification (over <span class="math">\\mathbb{F}_p</span> )</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"></th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"></th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"></th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"></th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"></th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"></th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"></th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"></th>
        </thead>
        <tbody>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">\\lceil \\log_2(p) \\rceil</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">8</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">4</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">6</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">16</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">8</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">12</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">16</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">8</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">t</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">3</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">4</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">4</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">4</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">8</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">8</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">8</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">12</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Vulnerable</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">No</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">No</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">No</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">No</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">No</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">No</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">No</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">No</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Starkad Specification (over <span class="math">\\mathbb{F}_{2^n}</span> )</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">\\overline{n}</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">8</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">4</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">6</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">16</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">8</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">12</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">16</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">8</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">t</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">3</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">4</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">4</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">4</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">8</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">8</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">8</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">12</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Vulnerable</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">No</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Yes</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Yes</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Yes</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Yes</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Yes</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Yes</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Yes</td>
          </tr>
        </tbody>
      </table>
    </div>

    <p class="text-gray-300">Comparison with Related Results. When using our tool for matrices with various sizes (i.e., different values for t), we can observe that some matrices over  <span class="math">\\mathbb{F}_{2^n}</span>  (i.e., the matrices used for Starkad) are vulnerable to the attacks described in this paper. We can also observe, however, that matrices over  <span class="math">\\mathbb{F}_p</span>  using the same t values are not vulnerable. The detailed results for some instances are shown in Table 6.</p>

    <p class="text-gray-300">These results are not new in the literature, since similar conclusions have already been shown in [KR21, BCD<sup>+</sup>20]. Moreover, in [KR21] the authors explain how to modify the choice of  <span class="math">x_i</span>  and  <span class="math">y_j</span>  in Eq. (10) in order to fix this problem. This solution consists in changing the starting sequences for the Cauchy generation method. For completeness, we also tested our algorithm for the matrices suggested in [KR21]. As expected, we arrive at the same conclusion, namely, that it is not possible to set up infinitely long subspace trails without active S-boxes for the Cauchy matrices proposed in [KR21].</p>

      <h3 id="app-c.2" class="text-xl font-semibold mt-8">C.2 Zorro Matrix</h3>

    <p class="text-gray-300">We also evaluated the Zorro [GGNPS13] matrix with our tool. Zorro is a variant of AES where only 4 S-boxes (at the first row) are applied per round. In our setting, Zorro is a P-SPN scheme over  <span class="math">(\\mathbb{F}_{2^8})^{16}</span>  with s=4 where the linear layer is defined by a  <span class="math">16\\times 16</span>  matrix, where</p>

    <p class="text-gray-300"><span class="math">$\\forall x \\in (\\mathbb{F}_{2^8})^{16}: \\qquad M_{\\mathtt{Zorro}} \\cdot x := MC \\cdot SR \\cdot x,</span>$</p>

    <p class="text-gray-300">where</p>

    <p class="text-gray-300"><span class="math">$SR = \\begin{pmatrix} I &amp; 0 &amp; 0 &amp; 0 \\\\ 0 &amp; I_2 &amp; 0 &amp; 0 \\\\ 0 &amp; 0 &amp; I_3 &amp; 0 \\\\ 0 &amp; 0 &amp; 0 &amp; I_4 \\end{pmatrix},</span>$</p>

    <p class="text-gray-300">where <em>I</em> is the 4 &times; 4 identity matrix, 0 is the 4 &times; 4 null matrix, and</p>

    <p class="text-gray-300"><span class="math">$I_2 = \\begin{pmatrix} 0 &amp; 1 &amp; 0 &amp; 0 \\\\ 0 &amp; 0 &amp; 1 &amp; 0 \\\\ 0 &amp; 0 &amp; 0 &amp; 1 \\\\ 1 &amp; 0 &amp; 0 &amp; 0 \\end{pmatrix}, \\qquad I_3 = \\begin{pmatrix} 0 &amp; 0 &amp; 1 &amp; 0 \\\\ 0 &amp; 0 &amp; 0 &amp; 1 \\\\ 1 &amp; 0 &amp; 0 &amp; 0 \\\\ 0 &amp; 1 &amp; 0 &amp; 0 \\end{pmatrix}, \\qquad I_4 = \\begin{pmatrix} 0 &amp; 0 &amp; 0 &amp; 1 \\\\ 1 &amp; 0 &amp; 0 &amp; 0 \\\\ 0 &amp; 1 &amp; 0 &amp; 0 \\\\ 0 &amp; 0 &amp; 1 &amp; 0 \\end{pmatrix},</span>$</p>

    <p class="text-gray-300">and where</p>

    <p class="text-gray-300"><span class="math">$MC = \\begin{pmatrix} 2 \\cdot I &amp; 3 \\cdot I &amp; I &amp; I \\\\ 3 \\cdot I &amp; I &amp; I &amp; 2 \\cdot I \\\\ I &amp; I &amp; 2 \\cdot I &amp; 3 \\cdot I \\\\ I &amp; 2 \\cdot I &amp; 3 \\cdot I &amp; I \\end{pmatrix},</span>$</p>

    <p class="text-gray-300">where again <em>I</em> is the 4 &times; 4 identity matrix, and where 2 &equiv; <em>X</em> &isin; F<sup>2</sup> <sup>8</sup> and 3 &equiv; <em>X</em> + 1 &isin; F<sup>2</sup> 8 . As expected, using our tool, we found that there exists no infinitely long (iterative or invariant) subspace trail for this matrix, neither with nor without active S-boxes.<a href="#page-38-0">13</a></p>

    <p class="text-gray-300"><sup>13</sup>We recall that the statistical attacks on Zorro <a href="#page-34-3">[WWGY14]</a> exploit the existence of differentials with a probability higher than what was expected by the designers, and not the existence of infinitely long subspace trails.</p>

    </section>
`;
---

<BaseLayout title="Proving Resistance Against Infinitely Long Subspace Trails: ... (2020/500)">
  <article class="max-w-4xl mx-auto article-prose">
    <nav class="mb-8">
      <a href="/papers" class="text-blue-400 hover:text-blue-300">
        &larr; Back to Papers
      </a>
    </nav>

    <header class="mb-12">
      <h1 class="text-3xl font-bold mb-4"
        set:html={TITLE_HTML} />
      <p class="text-gray-400 mb-2"
        set:html={AUTHORS_HTML} />
      <p class="text-gray-500 text-sm mb-4">
        2020 &middot; eprint 2020/500
      </p>
      <div class="flex gap-4 text-sm">
        <a
          href={EPRINT_URL}
          target="_blank"
          rel="noopener noreferrer"
          class="text-blue-400 hover:text-blue-300"
        >
          Paper (eprint) &rarr;
        </a>
      </div>
      <PaperDisclaimer eprintUrl={EPRINT_URL} />
      <p class="mt-1 text-xs text-gray-600">
        Converted with: {CRAWLER} &middot; {CONVERTED_DATE}
      </p>
    </header>

    <nav id="toc" class="mb-10 p-6 rounded-lg" style="background: rgba(255,255,255,0.03); border: 1px solid rgba(255,255,255,0.06);">
      <h2 class="text-lg font-bold mb-4">Table of Contents</h2>
      <ol class="space-y-1 text-sm text-gray-300
        list-decimal list-inside">
        <li>
          <a href="#sec-1" class="hover:text-white">Introduction</a>
          <ol class="ml-6 mt-1 space-y-1 list-decimal
            list-inside text-gray-400">
            <li><a href="#sec-1.1" class="hover:text-white">Choosing the Linear Layer in Partial SPN Schemes</a></li>
            <li><a href="#sec-1.2" class="hover:text-white">Our Contribution and Related Work</a></li>
          </ol>
        </li>
        <li>
          <a href="#sec-2" class="hover:text-white">Preliminaries</a>
          <ol class="ml-6 mt-1 space-y-1 list-decimal
            list-inside text-gray-400">
            <li><a href="#sec-2.1" class="hover:text-white">Partial SPN Schemes</a></li>
            <li><a href="#sec-2.2" class="hover:text-white">Invariant Subspaces and Subspace Trails</a></li>
            <li><a href="#sec-2.3" class="hover:text-white">Decomposition Theorem &amp; Frobenius Normal Form</a></li>
          </ol>
        </li>
        <li>
          <a href="#sec-3" class="hover:text-white">Infinitely Long Invariant Subspace Trails for P-SPN Schemes (Without Active S-Boxes)</a>
          <ol class="ml-6 mt-1 space-y-1 list-decimal
            list-inside text-gray-400">
            <li><a href="#sec-3.1" class="hover:text-white">Preliminary Results</a></li>
            <li><a href="#sec-3.2" class="hover:text-white">Infinitely Long Invariant Subspace Trails via Eigenspaces of M</a></li>
            <li><a href="#sec-3.3" class="hover:text-white">A Necessary and Sufficient Condition for the Existence of Infinitely Long Invariant Subspace Trails (Without Active S-boxes)</a></li>
          </ol>
        </li>
        <li>
          <a href="#sec-4" class="hover:text-white">Iterative Subspace Trails Without Active S-Boxes</a>
          <ol class="ml-6 mt-1 space-y-1 list-decimal
            list-inside text-gray-400">
            <li><a href="#sec-4.1" class="hover:text-white">Linear Layers with Low Multiplicative Order</a></li>
            <li><a href="#sec-4.2" class="hover:text-white">Linear Layers with Low-Degree Minimal Polynomials</a></li>
            <li><a href="#sec-4.2.1" class="hover:text-white">A Concrete Example: The Starkad Matrix</a></li>
            <li><a href="#sec-4.2.2" class="hover:text-white">A Generic Example via the Eigenspaces of M^l</a></li>
          </ol>
        </li>
        <li>
          <a href="#sec-5" class="hover:text-white">Practical Tests (Without Active S-Boxes)</a>
          <ol class="ml-6 mt-1 space-y-1 list-decimal
            list-inside text-gray-400">
            <li><a href="#sec-5.1" class="hover:text-white">Algorithm for Detecting Weak Matrices</a></li>
            <li><a href="#sec-5.2" class="hover:text-white">Percentage of Weak Linear Layers</a></li>
          </ol>
        </li>
        <li>
          <a href="#sec-6" class="hover:text-white">Infinitely Long Subspace Trails for P-SPN Schemes (Active S-Boxes)</a>
          <ol class="ml-6 mt-1 space-y-1 list-decimal
            list-inside text-gray-400">
            <li><a href="#sec-6.1" class="hover:text-white">Preliminary Results: Subspace Trails &amp; Truncated Differentials</a></li>
            <li><a href="#sec-6.2" class="hover:text-white">Infinitely Long Invariant Subspace Trails with Active S-Boxes via the Eigenspaces of M</a></li>
            <li><a href="#sec-6.3" class="hover:text-white">A Necessary and Sufficient Condition for the Existence of Infinitely Long Invariant Subspace Trails with Active S-boxes</a></li>
            <li><a href="#sec-6.4" class="hover:text-white">Infinitely Long Iterative Subspace Trails with Active S-Boxes</a></li>
          </ol>
        </li>
        <li>
          <a href="#sec-7" class="hover:text-white">Practical Tests (Active S-Boxes)</a>
          <ol class="ml-6 mt-1 space-y-1 list-decimal
            list-inside text-gray-400">
            <li><a href="#sec-7.1" class="hover:text-white">Related Strategies in the Literature</a></li>
            <li><a href="#sec-7.2" class="hover:text-white">Algorithms for Detecting &quot;Weak&quot; Matrices</a></li>
            <li><a href="#sec-7.2.1" class="hover:text-white">Infinitely Long Invariant Subspace Trails with Active S-Boxes</a></li>
            <li><a href="#sec-7.2.2" class="hover:text-white">Infinitely Long Iterative Subspace Trails with Active S-Boxes</a></li>
            <li><a href="#sec-7.3" class="hover:text-white">Percentage of &quot;Weak&quot; Linear Layers</a></li>
          </ol>
        </li>
        <li>
          <a href="#sec-8" class="hover:text-white">Security Against Infinitely Long Subspace Trails</a>
          <ol class="ml-6 mt-1 space-y-1 list-decimal
            list-inside text-gray-400">
            <li><a href="#sec-8.1" class="hover:text-white">Sufficient Condition for Preventing Infinitely Long Subspace Trails</a></li>
            <li><a href="#sec-8.2" class="hover:text-white">Open Problems</a></li>
          </ol>
        </li>
      </ol>
      <p class="text-xs text-gray-500 mt-4 mb-1 font-semibold">
        Appendices
      </p>
      <ol class="space-y-1 text-sm text-gray-400
        list-[upper-alpha] list-inside">
        <li><a href="#app-a" class="hover:text-white">Truncated Differentials and Subspace Trails</a></li>
        <li><a href="#app-b" class="hover:text-white">Infinitely Long Iterative Subspace Trails with Active S-Boxes</a></li>
        <li>
          <a href="#app-c" class="hover:text-white">Results Using our Tool and More Examples of Subspace Trails with Active S-Boxes</a>
          <ol class="ml-6 mt-1 space-y-1 list-decimal
            list-inside text-gray-400">
            <li><a href="#app-c.1" class="hover:text-white">Starkad and Poseidon Matrices</a></li>
            <li><a href="#app-c.2" class="hover:text-white">Zorro Matrix</a></li>
          </ol>
        </li>
      </ol>
      <p class="text-xs text-gray-500 mt-4 mb-1 font-semibold">
        Additional
      </p>
      <ul class="space-y-1 text-sm text-gray-400
        list-disc list-inside">
        <li><a href="#references" class="hover:text-white">References</a></li>
      </ul>
    </nav>


    <Fragment set:html={CONTENT} />

    <PaperHistory slug="proving-resistance-against-infinitely-long-subspace-trails-2020" />
  </article>
</BaseLayout>
