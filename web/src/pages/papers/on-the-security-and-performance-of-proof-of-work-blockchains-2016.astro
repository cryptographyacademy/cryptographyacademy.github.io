---
import BaseLayout from '../../layouts/BaseLayout.astro';

const EPRINT_URL = 'https://eprint.iacr.org/2016/555';
const CRAWLER = 'mistral';
const CONVERTED_DATE = '2026-02-16';
const TITLE_HTML = 'On the Security and Performance of Proof of Work Blockchains';
const AUTHORS_HTML = 'Arthur Gervais, Ghassan O.  Karame, Karl Wüst, Vasileios Glykantzis, Hubert Ritzdorf, Srdjan Capkun';

const CONTENT = `    <p class="text-gray-300">Arthur Gervais ETH Zurich, Switzerland arthur.gervais@inf.ethz.ch</p>

    <p class="text-gray-300">Vasileios Glykantzis ETH Zurich, Switzerland glykantv@student.ethz.ch</p>

    <p class="text-gray-300">Ghassan O. Karame NEC Laboratories, Europe ghassan.karame@neclab.eu</p>

    <p class="text-gray-300">Hubert Ritzdorf ETH Zurich, Switzerland hubert.ritzdorf@inf.ethz.ch</p>

    <p class="text-gray-300">Karl Wüst ETH Zurich, Switzerland kwuest@student.ethz.ch</p>

    <p class="text-gray-300">Srdjan Čapkun ETH Zurich, Switzerland srdjan.capkun@inf.ethz.ch</p>

    <p class="text-gray-300">Proof of Work (PoW) powered blockchains currently account for more than  <span class="math">90\\%</span>  of the total market capitalization of existing digital currencies. Although the security provisions of Bitcoin have been thoroughly analysed, the security guarantees of variant (forked) PoW blockchains (which were instantiated with different parameters) have not received much attention in the literature.</p>

    <p class="text-gray-300">In this paper, we introduce a novel quantitative framework to analyse the security and performance implications of various consensus and network parameters of PoW blockchains. Based on our framework, we devise optimal adversarial strategies for double-spending and selfish mining while taking into account real world constraints such as network propagation, different block sizes, block generation intervals, information propagation mechanism, and the impact of eclipse attacks. Our framework therefore allows us to capture existing PoW-based deployments as well as PoW blockchain variants that are instantiated with different parameters, and to objectively compare the tradeoffs between their performance and security provisions.</p>

    <p class="text-gray-300">Since its inception in 2009, Bitcoin's blockchain has fueled innovation and a number of novel applications, such as smart contracts, have been designed to take advantage of the blockchain. Bitcoin has been forked a number of times in order to fine-tune the consensus (i.e., the block generation time and the hash function), and the network parameters (e.g., the size of blocks and the information propagation protocol) and to increase the blockchain's efficiency. For instance, Litecoin and Dogecoin—Bitcoin's most prominent forks—reduce the block generation time from 10 to 2.5 and 1 minute. Parallel to these efforts, alternative decentralised blockchain-based networks (such as Ethereum) emerged with the ambition to optimize the consensus and network parameters and to ease the deployment of decentralised applications on top of the blockchain.</p>

    <p class="text-gray-300">Although a number of consensus protocols (PBFT [5], Proof of Stake [29], Proof of Elapsed Time [20]) have been proposed, most existing blockchains leverage the computationally expensive Proof of Work (PoW) consensus mechanism—which currently accounts for more than  <span class="math">90\\%</span>  of the total market capitalization of existing digital currencies. While the security provisions of Bitcoin have been thoroughly analysed [14, 21, 30, 32], the security guarantees of variant PoW blockchains have not received much attention in the literature. Recent studies hint that the performance of PoW based blockchains cannot be enhanced without impacting their security. However, the relationship between performance and security provisions of PoW blockchains has so far not been studied in much detail.</p>

    <p class="text-gray-300">!<a href="img-0.jpeg">img-0.jpeg</a> Figure 1: Components of our quantitative framework.</p>

    <p class="text-gray-300">In this paper, we address this problem and provide a novel quantitative framework to analyse the security and performance implications of various consensus and network parameters of PoW blockchains. Leveraging our framework, we capture the security properties of existing PoW instantiations (e.g., Bitcoin, Ethereum, Litecoin, and Dogecoin) as well as other possible instantiations subject to different consensus and network parameters.</p>

    <p class="text-gray-300">Our framework (cf. Figure 1) consists of two key elements: (i) a blockchain instance and (ii) a blockchain security model. A blockchain instance is a PoW blockchain instantiated with a given set of consensus and network parameters, such as network delays, block generation times, block sizes, information propagation mechanisms, etc. For example, Bitcoin, Litecoin, and Ethereum correspond to 3 different blockchain instances. To realistically capture any other blockchain instance, we design a simulator that mimics the blockchain consensus and network layer by implementing advertisement-based information propagation, unsolicited block pushes, the relay network, the sendheader propagation mechanism, among others. The main output of the blockchain instance is the (measured or simulated) stale (orphan) block rate, which is fed as input into our security model. On the other hand, our security model is based on Markov Decision Processes (MDP) for double-spending and selfish mining and allows us to reason about optimal adversarial strategies while taking into account the adversarial mining power, the impact of eclipse attacks, block rewards, and real world network and consensus parameters—effectively captured by the stale block rate.</p>

    <p class="text-gray-300">Given the current discussions in the Bitcoin community about a suitable maximum block size that ensures the scalability and growth in the system [1], our work provides a way to holistically compare the security and performance of PoW blockchains when subject to different parameters—including the block size. For instance,</p>

    <p class="text-gray-300">we find that increasing the block size from the current Bitcoin transaction load (average 0.5MB) to up to 4 MB, does not significantly affect the selfish mining and double-spending resilience of the blockchain—provided that the block propagation mechanism ensures a low stale block rate. We summarize our findings as follows.</p>

    <p class="text-gray-300">Summary of findings</p>

    <ul class="list-disc list-inside space-y-1 text-gray-300 my-2 ml-4">

      <li>We show that selfish mining is not always a rational strategy. To capture rational adversaries, we therefore quantify the double-spending resilience of PoW blockchains and objectively compare the security of different PoW blockchains with respect to the required number of transaction confirmations. By doing so, we provide merchants with the knowledge to decide on the required number of confirmations for a given transaction value to ensure security against double-spending.</li>

      <li>Our results show that, due to the smaller block rewards and the higher stale block rate of Ethereum compared to Bitcoin (from 0.41% to 6.8% due to the faster confirmation time), Ethereum (block interval between 10 and 20 seconds) needs at least 37 confirmations to match Bitcoin’s security (block interval of 10 minutes on average) with 6 block confirmations against an adversary with 30% of the total mining power. Similarly, Litecoin would require 28, and Dogecoin 47 block confirmations respectively to match the security of Bitcoin.</li>

      <li>We show that the higher the block reward of a blockchain (in e.g., USD) the more resilient it is against double-spending.</li>

      <li>Finally, we analyze the impact of changing the block size and/or the block interval on selfish mining and double-spending. Our results surprisingly show that setting the block size to an average 1 MB, and decreasing the block interval time to 1 minute do not considerably penalize security. Our results therefore suggest that PoW blockchains can attain an effective throughput above 60 transactions per second (tps) (which implies that the current throughput of Bitcoin of 7 tps can be substantially increased) without compromising the security of the system.</li>

    </ul>

    <p class="text-gray-300">The remainder of the paper is organized as follows. In Section 2, we overview the basic concepts behind PoW blockchain. In Section 3, we introduce our MDP model to quantitatively analyze the security of PoW blockchains. In Section 4, we present our simulator and evaluate the security and performance of a number of variant PoW-based blockchain instances. In Section 5, we overview related work, and we conclude the paper in Section 6.</p>

    <h2 id="sec-4" class="text-2xl font-bold">2 Background</h2>

    <p class="text-gray-300">In this section, we briefly recap the operations of the consensus layer and the network layer of existing PoW blockchains.</p>

    <h3 id="sec-5" class="text-xl font-semibold mt-8">2.1 Consensus Layer</h3>

    <p class="text-gray-300">The proof of work (PoW) consensus mechanism is the widest deployed consensus mechanism in existing blockchains. PoW was introduced by Bitcoin <em>[27]</em> and assumes that each peer votes with his “computing power” by solving proof of work instances and constructing the appropriate blocks. Bitcoin, for example, employs a hash-based PoW which entails finding a nonce value, such that when hashed with additional block parameters (e.g., a Merkle hash, the previous block hash), the value of the hash has to be smaller than the current target value. When such a nonce is found, the miner creates the block and forwards it on the network layer (cf. Section 2.2) to its peers. Other peers in the network can verify the PoW by computing the hash of the block and checking whether it satisfies the condition to be smaller than the current target value.</p>

    <p class="text-gray-300">Block interval: The block interval defines the latency at which content is written to the blockchain. The smaller the block interval is, the faster a transaction is confirmed and the higher is the probability of stale blocks. The block interval adjustment directly relates to the difficulty change of the underlying PoW mechanism. A lower difficulty results in a larger number of blocks in the network, while a higher difficulty results in less blocks within the same timeframe.</p>

    <p class="text-gray-300">It is therefore crucial to analyse whether changing the difficulty affects the adversarial capabilities in attacking the longest chain—which is the main pillar of security of most PoW-based blockchains. This also implies the adjustment of the required number of confirmations that a merchant should wait in order to safely accept transactions (and avoid double-spending attacks) (cf. Section 3).</p>

    <h4 id="sec-6" class="text-lg font-semibold mt-6">2.1.1 PoW security</h4>

    <p class="text-gray-300">PoW’s security relies on the principle that no entity should gather more than 50% of the processing power because such an entity can effectively control the system by sustaining the longest chain. We now briefly outline known attacks on existing PoW-based blockchains.</p>

    <p class="text-gray-300">First, an adversary can attempt to double-spend by using the same coin(s) to issue two (or more) transactions—thus effectively spending more coins than he possesses. Recent studies have shown that accepting transactions without requiring blockchain confirmations is insecure <em>[21]</em>. The more confirmations a transaction obtains, the less likely this transaction will be reversed in the future.</p>

    <p class="text-gray-300">Second, miners might attempt to perform selfish mining <em>[14]</em> attacks in order to increase their relative mining share in the blockchain, by selectively withholding mined blocks and only gradually publishing them <em>[14, 31]</em>. Recent studies show that, as a result of these attacks, a selfish miner equipped with originally 33% mining power can effectively earn 50% of the mining power.</p>

    <p class="text-gray-300">Double-spending attacks and selfish mining can be alleviated if all nodes in the blockchain system are tightly synchronised. Note that, in addition to network latency, synchronisation delays can be aggravated due to eclipse attacks <em>[16, 17]</em> where an adversary creates a logical partition in the network, i.e., provides contradicting block and transaction information to different blockchain network nodes.</p>

    <h3 id="sec-7" class="text-xl font-semibold mt-8">2.2 Network Layer</h3>

    <p class="text-gray-300">On the network layer, we identify two main parameters that are of particular importance for PoW-based blockchains, namely: the block size, and the information propagation mechanism.</p>

    <h4 id="sec-8" class="text-lg font-semibold mt-6">2.2.1 Block size</h4>

    <p class="text-gray-300">The maximum block size indirectly defines the maximum number of transactions carried within a block. This size therefore controls the throughput attained by the system. Large blocks incur slower propagation speeds, which in turn increases the stale block rate (and weaken the security of the blockchain as stated earlier).</p>

    <h4 id="sec-9" class="text-lg font-semibold mt-6">2.2.2 Information propagation mechanism</h4>

    <p class="text-gray-300">The block request management system dictates how information is delivered to peers in the network. Eventually, since all peers are expected to receive all blocks, a broadcast protocol is required. The choice of the underlying broadcast protocol clearly impacts the robustness and scalability of the network (cf. Section 4). In what follows, we briefly describe well-known network layer implementations of existing PoW-based blockchains.</p>

    <p class="text-gray-300">Advertisement-based information dissemination: Most PoW blockchains propagate messages with the help of an advertisement-</p>

    <p class="text-gray-300">based request management system. If node  <span class="math">\\mathcal{A}</span>  receives information about a new object (e.g., a transaction or a block) from another node,  <span class="math">\\mathcal{A}</span>  will advertise this object to its other connections (e.g. node  <span class="math">\\mathcal{B}</span> ) by sending them an inv message (the hash and type of the advertised object). Only if node  <span class="math">\\mathcal{B}</span>  has not previously received the advertised object,  <span class="math">\\mathcal{B}</span>  will request the object from  <span class="math">\\mathcal{A}</span>  with a getdata request. Node  <span class="math">\\mathcal{A}</span>  will subsequently respond with a Bitcoin object, e.g., the contents of a transaction or a block.</p>

    <p class="text-gray-300">Send headers: Peers can alternatively issue a sendheaders message in order to directly receive block headers in the future from their peers—skipping the use of inv messages. This reduces the latency and bandwidth overhead of block message propagation and is adopted by Bitcoin since version 0.12.</p>

    <p class="text-gray-300">Unsolicited block push: This mechanism enables miners to broadcast their generated blocks without advertisement (i.e., since they mined the block). Note that this push system is recommended, but not implemented in Bitcoin.</p>

    <p class="text-gray-300">Relay networks: Relay networks [6] primarily enhance synchronization of miners that share a common pool of transactions. Transactions are typically only referenced in relayed blocks with a transaction ID (2 bytes per transaction instead of an average of 250 bytes per transaction). As a consequence, the resulting block size is smaller than the regular block (cf. Bitcoin Relay Network [6]).</p>

    <p class="text-gray-300">Hybrid Push/Advertisement Systems: A number of systems, such as Ethereum, combine the use of push and advertisement dissemination. Here, a block is directly pushed to a threshold number of peers (e.g., Ethereum directly pushes blocks to  <span class="math">\\sqrt{n}</span>  peers, where  <span class="math">n</span>  is the total number of neighbors connected to the peer). Concurrently, the sender advertises the block hash to all of its neighbors.</p>

    <p class="text-gray-300">Stale blocks refer to blocks that are not included in the longest chain, e.g., due to concurrency, conflicts. Stale blocks are detrimental to the blockchain's security and performance because they trigger chain forks—an inconsistent state which slows down the growth of the main chain and results in significant performance and security implications. On the one hand, stale blocks increase the advantage of the adversary in the network (e.g., double-spending). On the other hand, stale blocks result in additional bandwidth overhead and are typically not awarded mining rewards (except in Ethereum).</p>

    <p class="text-gray-300">In an experiment that we conducted, we measure the stale block rate in the Bitcoin (block generation time  <span class="math">= 10</span>  minutes, average block size  <span class="math">= 534.8\\mathrm{KB}</span> ), Litecoin (block generation time  <span class="math">= 2.5</span>  minutes, average block size  <span class="math">= 6.11\\mathrm{KB}</span> ) and Dogecoin (block generation time  <span class="math">= 1</span>  minute, average block size  <span class="math">= 8\\mathrm{KB}</span> ) network. All three blockchains rely on a PoW-based blockchain (with different generation times) and the same information propagation system (with different block sizes).</p>

    <p class="text-gray-300">We crawled the available nodes in Litecoin and Dogecoin [3] in February 2016 and found about 800 and 600 IP addresses respectively. We then measured the block propagation times by registering the times at which we receive the block advertisements from a particular block from all our connections in the respective network [9]. We operated one node for Litecoin and Dogecoin, which we connected to 340 and 200 peers, respectively. Once one of these peers advertises block information in form of either (i) a new hash of a block (inv message) or (ii) a block header (headers message), we registered the time this block information appeared. Every subsequent reception of a particular piece of block information then provides information about the propagation of the block.</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Bitcoin</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Litecoin</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Dogecoin</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Ethereum</th>

          </tr>

        </thead>

        <tbody>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">Block interval</td>

            <td class="px-3 py-2 border-b border-gray-700">10 min</td>

            <td class="px-3 py-2 border-b border-gray-700">2.5 min</td>

            <td class="px-3 py-2 border-b border-gray-700">1 min</td>

            <td class="px-3 py-2 border-b border-gray-700">10-20 seconds</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">Public nodes</td>

            <td class="px-3 py-2 border-b border-gray-700">6000</td>

            <td class="px-3 py-2 border-b border-gray-700">800</td>

            <td class="px-3 py-2 border-b border-gray-700">600</td>

            <td class="px-3 py-2 border-b border-gray-700">4000 [11]</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">Mining pools</td>

            <td class="px-3 py-2 border-b border-gray-700">16</td>

            <td class="px-3 py-2 border-b border-gray-700">12</td>

            <td class="px-3 py-2 border-b border-gray-700">12</td>

            <td class="px-3 py-2 border-b border-gray-700">13</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">tMBP</td>

            <td class="px-3 py-2 border-b border-gray-700">8.7 s [8]</td>

            <td class="px-3 py-2 border-b border-gray-700">1.02 s</td>

            <td class="px-3 py-2 border-b border-gray-700">0.85 s</td>

            <td class="px-3 py-2 border-b border-gray-700">0.5 - 0.75 s [12]</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">rs</td>

            <td class="px-3 py-2 border-b border-gray-700">0.41%</td>

            <td class="px-3 py-2 border-b border-gray-700">0.273%</td>

            <td class="px-3 py-2 border-b border-gray-700">0.619%</td>

            <td class="px-3 py-2 border-b border-gray-700">6.8%</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">sB</td>

            <td class="px-3 py-2 border-b border-gray-700">534.8KB</td>

            <td class="px-3 py-2 border-b border-gray-700">6.11KB</td>

            <td class="px-3 py-2 border-b border-gray-700">8KB</td>

            <td class="px-3 py-2 border-b border-gray-700">1.5KB</td>

          </tr>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">Table 1: Comparison of different Bitcoin forks, Ethereum and the impact of parameter choices on the network propagation times. Stale block rate  <span class="math">(r_s)</span>  and average block size  <span class="math">(s_B)</span>  were measured over the last 10000 blocks.  <span class="math">t_{MBP}</span>  stands for median block propagation time.</p>

    <p class="text-gray-300">Our results (cf. Table 1) suggest that the stale block rate indeed largely depends on the block interval and the block sizes. For instance, unlike Dogecoin and Litecoin, Bitcoin features larger block sizes due to a higher transaction load (of up to 1MB which results in a higher stale block rate  <span class="math">(0.41\\%</span>  vs.  <span class="math">0.273\\%)</span> —although the block interval of Bitcoin is 4 times longer than that of Litecoin. Moreover, the stale block rate differences between Litecoin and Dogecoin are mainly due to the difference in the block interval (2.5 minutes vs. 1 minute), since their average block sizes are comparable (6.11KB and 8KB). Given a confirmation time reduction of  <span class="math">60\\%</span> , the stale block rate increased by  <span class="math">127\\%</span>  from Litecoin to Dogecoin.</p>

    <p class="text-gray-300">Notice that in Ethereum, uncle blocks correspond to stale blocks that are referenced in the main chain. The uncle block rate in Ethereum is almost  <span class="math">6.8\\%</span> , compared to a stale block rate of  <span class="math">0.41\\%</span>  in Bitcoin. In Section 3, we study the impact of the stale block rate on the security of PoW blockchains.</p>

    <p class="text-gray-300">In this section, we introduce our blockchain security model that we leverage to quantify the optimal adversarial strategies for double-spending and selfish mining. We then use these strategies as a basis to compare the security provisions of PoW-based blockchains when instantiated with different parameters.</p>

    <p class="text-gray-300">Our model extends the Markov Decision Process (MDP) of [31] to determine optimal adversarial strategies, and captures:</p>

    <p class="text-gray-300">Stale block rate The stale block rate  <span class="math">r_s</span>  allows us to account for different block sizes, block intervals, network delays, information propagation mechanisms and network configuration (e.g., number of nodes).</p>

    <p class="text-gray-300">Mining power  <span class="math">\\alpha</span>  is the fraction of the total mining power of the adversary (the rest is controlled by the honest network).</p>

    <p class="text-gray-300">Mining costs The adversarial mining costs  <span class="math">c_{m} \\in [0, \\alpha]</span>  correspond to the expected mining costs of the adversary (i.e., total mining costs such as hardware, electricity, man-power) and are expressed in terms of block rewards. For example, if  <span class="math">c_{m} = \\alpha</span> , the mining costs of the adversary are equivalent to its mining power times the block reward, i.e., the mining costs are covered exactly by the earned block revenue in honest mining.</p>

    <p class="text-gray-300">The number of block confirmations  <span class="math">k</span>  This corresponds to the number of blocks that need to confirm a transaction, such that a merchant accepts the transaction.</p>

    <p class="text-gray-300">Propagation ability The propagation parameter  <span class="math">\\gamma</span>  captures the connectivity of the adversary within the network (i.e., captures the fraction of the network that receives the adversary's blocks in the case when the adversary and the honest miner release their blocks simultaneously in the network).</p>

    <p class="text-gray-300">The impact of eclipse attacks Our model accounts for eclipse attacks. Here, we assume that the miners of the honest network are affected by the stale block rate, while the adversary and the colluding eclipsed victims do not mine stale blocks. This is due to the fact that the adversary can use any mined blocks for an attack and effectively only has a small chance of mining a stale block after adopting the honest chain. Therefore, in practice, the adversary exhibits a significantly lower real stale block rate than the honest network. The honest network features propagation and validation delays—hence it will witness a higher stale block rate. Note that the blocks found by the eclipsed victim can also count towards the private chain of the adversary.</p>

    <p class="text-gray-300">We contrast this to existing models, such as Sapirshtein et al.’s <em>[31]</em>, which only focus on selfish mining and cannot capture different blockchain instances (with various stale block rates and confirmations) and real-world parameters such as network delays.</p>

    <p class="text-gray-300">To analyze optimal double-spending strategies, we define the double-spending amount <span class="math">v_{d}</span> that corresponds to the minimum transaction value that makes double-spending more profitable than honest mining. We argue that <span class="math">v_{d}</span> emerges as a robust metric to quantify security under double-spending attacks. Namely, if the reward of honest mining is larger than that of dishonest behaviour, merchants can safely accept a payment transaction of value <span class="math">v_{d}</span> (since such a value is considered secure, e.g., based on a given confirmation number). If however, adversarial behaviour is financially more rewarding, a merchant should be aware of the associated double-spending risks and of the related incentives of miners.</p>

    <p class="text-gray-300">We capture the blockchain model using a single-player decision problem <span class="math">M:=\\langle S,A,P,R\\rangle</span> where all other participants follow the standard protocol, and <span class="math">S</span> corresponds to the state space, <span class="math">A</span> to the action space, <span class="math">P</span> to the stochastic transition matrix, and <span class="math">R</span> to the reward matrix. We instantiate <span class="math">M</span> as a Markov Decision Process (MDP) as outlined in Section 3.2 and 3.3.</p>

    <p class="text-gray-300">In our model, the following actions are available to the adversary:</p>

    <p class="text-gray-300">The adversary accepts the chain of the honest network, which effectively corresponds to a restart of the attack. This action is appropriate if the adversary deems that the likelihood to win over the honest chain is small. The adversary publishes one block more than the honest chain has and consequently overrides conflicting blocks. This happens when the adversary’s secret chain is longer than the currently known public chain (i.e. <span class="math">l_{a}&gt;l_{h}</span>) and it is optimal for the adversary to publish <span class="math">l_{h}+1</span> of his blocks to replace the honest network’s chain with his own. If the adversary exploits the mining power of the victim, the adversary might use <span class="math">b_{e}</span> blocks from the victim for an <em>override</em> action. The adversary publishes as many blocks as the honest chain has, and triggers an adoption race between the two chains instead of <em>overriding</em> the honest chain. The adversary continues mining on its hidden chain until a block is found. This action is only relevant when studying double-spending as it corresponds to a successful double-spending with <span class="math">k</span> confirmations and is only feasible if <span class="math">l_{a}&gt;l_{h}</span> and <span class="math">l_{a}&gt;k</span>.</p>

    <p class="text-gray-300">The state space <span class="math">S</span> is defined as a four-tuple of the form <span class="math">(l_{a},l_{h},b_{e},\\mathrm{fork})</span>, where <span class="math">l_{a}</span> and <span class="math">l_{h}</span> represent the length of the adversarial and honest chain respectively, <span class="math">b_{e}</span> the blocks mined by the eclipsed victim, and <span class="math">\\mathrm{fork}</span> can take three values, <span class="math">\\mathrm{irrelevant}</span>, <span class="math">\\mathrm{relevant}</span> and <span class="math">\\mathrm{active}</span>:</p>

    <p class="text-gray-300">The label <span class="math">\\mathrm{relevant}</span> signifies that (i) the last block has been found by the honest network, and (ii) if <span class="math">l_{a}\\geq l_{h}</span> the <em>match</em> action is applicable. A state of the form <span class="math">(l_{a},l_{h}-1,b_{e},\\cdot)</span> for instance results in <span class="math">(l_{a},l_{h},b_{e},\\mathrm{relevant})</span>.</p>

    <p class="text-gray-300">When the adversary found the last block, the previous block has likely already reached the majority of the nodes in the network. The adversary is therefore not able to perform a <em>match</em> action. A state of the form <span class="math">(l_{a}-1,l_{h},b_{e},\\cdot)</span> for instance results in <span class="math">(l_{a},l_{h},b_{e},\\mathrm{irrelevant})</span>. The state is described with the label <em>active</em>, if the adversary performed a <em>match</em> action, i.e., the network is currently split and in process of determining the longest chain.</p>

    <p class="text-gray-300">In our model, every state transition (except <em>exit</em>) corresponds to the creation of a block. Consequently, a state transition implies a reward for the honest network, the adversary, or the eclipsed victim.</p>

    <p class="text-gray-300">Given the adversarial mining power <span class="math">\\alpha</span>, the initial state <span class="math">(0,0,0,\\mathrm{irrelevant})</span> transitions to <span class="math">(1,0,0,\\mathrm{irrelevant})</span> with probability <span class="math">\\alpha</span>, i.e., the adversary found one block. If the honest network finds a non-stale block, the resulting state is <span class="math">(0,1,0,\\mathrm{relevant})</span>. On the other hand, if the honest network’s block results in a stale block, the state remains <span class="math">(0,0,0,\\mathrm{irrelevant})</span> since a stale block does not count towards the longest chain. The last case accounts for the eclipsed victim which finds a block with probability <span class="math">\\omega</span>, resulting in state <span class="math">(1,0,1,\\mathrm{irrelevant})</span>.</p>

    <h3 id="sec-13" class="text-xl font-semibold mt-8">Selfish Mining vs. Double-spending.</h3>

    <p class="text-gray-300">In this work, we consider double-spending and selfish mining independently, since selfish mining is not always a rational strategy: the objective of selfish mining is to increase the relative share of the adversarial blocks committed to the main chain, while in double-spending the adversary aims to maximize his absolute revenue.</p>

    <p class="text-gray-300">Namely, as long as the difficulty of a PoW blockchain does not change (e.g. Bitcoin’s difficulty changes only once every two weeks), selfish mining yields fewer block rewards than honest mining. In honest mining, the adversary is rewarded for every mined block, while he will lose any previously mined blocks when adopting the main chain in selfish mining. Since the adversary has less mining power than the honest network, he has a high probability of falling behind the main chain, causing him to adopt the main chain when he has no significant chance of catching up—which in turn leads to lost block rewards. For instance, following our optimal selfish mining strategy (cf. Section 3.2.1), an adversary with 30% of the mining power earns 209 block rewards on average in a duration where 1000 blocks are mined by the whole network (as opposed to 300 for honest mining). Similarly, Eyal and Sirer’s <em>[14]</em> strategy yields on average 205.80 blocks rewards.</p>

    <h3 id="sec-14" class="text-xl font-semibold mt-8">Eclipse attacks.</h3>

    <p class="text-gray-300">In an eclipse attack, a fraction <span class="math">\\omega</span> of the overall mining power is eclipsed <em>[17, 28]</em> from receiving information from the honest network. Here, a number of eclipse attack variants arise:</p>

    <p class="text-gray-300">This case is captured in our model if <span class="math">\\omega=0</span>. This is captured implicitly in our model. Namely, this corresponds to a decrease of the total mining power and thus an increase of the attacker mining power to <span class="math">\\alpha^{\\prime}=\\frac{\\alpha}{1-\\omega}</span>. Here, the adversary exploits the victim’s mining power <span class="math">\\omega</span> and uses it to advance his private chain. This is the most likely choice of a rational adversary when performing double-spending attacks. In this case, we assume that the victim is fully eclipsed from the network and does not receive/send blocks unless permitted by the adversary <em>[17, 28]</em>.</p>

    <h3 id="sec-15" class="text-xl font-semibold mt-8">3.2 Selfish Mining MDP</h3>

    <p class="text-gray-300">Our goal is to find the optimal adversarial strategy for selfish mining. Recall that the objective of the adversary in selfish mining</p>

    <p class="text-gray-300">is not to optimise the absolute reward, but to increase the share of blocks that are included in the chain accepted by the network. We capture this by optimising the relative revenue <span class="math">r_{rel}</span> defined in Equation 1, where <span class="math">r_{a_{i}}</span> and <span class="math">r_{h_{i}}</span> are the rewards in step <span class="math">i</span> for the adversary and the honest network, respectively:</p>

    <p class="text-gray-300"><span class="math">r_{rel}=\\mathbb{E}\\left[\\lim_{n\\rightarrow\\infty}\\frac{\\sum_{i=1}^{n}r_{a_{i}}}{\\sum_{i=1}^{n}(r_{a_{i}}+r_{h_{i}})}\\right]</span> (1)</p>

    <p class="text-gray-300">Since an adversary aims to increase his relative reward <span class="math">r_{rel}</span> (Equation 1) in selfish mining, as opposed to the absolute reward, the single-player decision problem cannot be modelled directly as an MDP, because the reward function is non-linear. In order to transform the problem into a family of MDPs, we apply the technique of Sapirshtein <em>et al.</em>’s <em>[31]</em>, which we describe below.</p>

    <p class="text-gray-300">We assume that the value of the objective function (i.e., the optimal relative reward) is <span class="math">rho</span> and define for any <span class="math">\\rho\\in[0,1]</span> the transformation function <span class="math">w_{\\rho}:\\mathbb{N}^{2}\\rightarrow\\mathbb{R}</span> with the adversarial reward <span class="math">r_{a}</span> and the reward of the honest network <span class="math">r_{h}</span> in Equation 2.</p>

    <p class="text-gray-300"><span class="math">w_{\\rho}(r_{a},r_{h})=(1-\\rho)\\cdot r_{a}-\\rho\\cdot r_{h}</span> (2)</p>

    <p class="text-gray-300">This results in an infinite state MDP <span class="math">M_{\\rho}=\\langle S,A,P,w_{\\rho}(R)\\rangle</span> for each <span class="math">\\rho</span> that has the same action and state space as the original decision problem and the same transition matrix but the reward matrix is transformed using <span class="math">w_{rho}</span>. The expected value of such an MDP under policy <span class="math">\\pi</span> is then defined by <span class="math">v_{\\rho}^{\\pi}</span> in Equation 3, where <span class="math">r_{i}(\\pi)</span> is the reward tuple in step <span class="math">i</span> under policy <span class="math">\\pi</span>.</p>

    <p class="text-gray-300"><span class="math">v_{\\rho}^{\\pi}=\\mathbb{E}\\left[\\lim_{n\\rightarrow\\infty}\\frac{1}{n}\\sum_{i=1}^{n}w_{\\rho}(r_{i}(\\pi))\\right]</span> (3)</p>

    <p class="text-gray-300">The expected value under the optimal policy follows:</p>

    <p class="text-gray-300"><span class="math">v_{\\rho}^{*}=\\max_{\\pi\\in A}\\left\\{v_{\\rho}^{\\pi}\\right\\}</span> (4)</p>

    <p class="text-gray-300">To optimise <span class="math">r_{rel}</span> we adopt the following propositions <em>[31]</em>:</p>

    <ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">

      <li>If <span class="math">v_{\\rho}^{<em>}=0</span> for some <span class="math">\\rho\\in[0,1]</span>, then an optimal policy <span class="math">\\pi^{</em>}</span> in the transformed MDP <span class="math">M_{\\rho}</span> also maximises <span class="math">r_{rel}</span> and <span class="math">r_{rel}=\\rho</span>.</li>

      <li><span class="math">v_{\\rho}^{*}</span> is monotonically decreasing in <span class="math">\\rho</span>.</li>

    </ol>

    <p class="text-gray-300">Since standard MDP solvers are not able to solve infinite state MDPs, we restrict the state space of our family of MDPs by only allowing either chain to be of length at most <span class="math">c</span>, resulting in a finite state MDP <span class="math">M_{\\rho}^{<em>}</span>. If either chain reaches length <span class="math">c</span>, the adversary is only allowed to perform the </em>override<em> or </em>adopt* action. This gives a lower bound for the optimal value of the infinite state MDP.</p>

    <p class="text-gray-300">Intuitively, we can reason about the correctness of the first proposition as follows for the bounded single-player decision problem. In a recurring finite state MDP, the initial state will be visited again in expectation after some finite number of steps <span class="math">S</span>. During that time, the adversary gains an expected reward of <span class="math">R_{a}=\\mathbb{E}\\left[\\sum_{s=1}^{S}r_{a_{i}}\\right]</span> and the honest network gains a reward of <span class="math">R_{h}=\\mathbb{E}\\left[\\sum_{s=1}^{S}r_{h_{i}}\\right]</span> in the original (bounded) decision problem. It follows that the expected reward per step in the Markov Chain is <span class="math">\\overline{r_{a}}=\\mathbb{E}\\left[\\frac{1}{S}\\sum_{s=1}^{S}r_{a_{i}}\\right]</span> and <span class="math">\\overline{r_{h}}=\\mathbb{E}\\left[\\frac{1}{S}\\sum_{s=1}^{S}r_{h_{i}}\\right]</span> for the adversary and the honest network, respectively. We can thus simplify the expected relative revenue <span class="math">r_{rel}</span> to:</p>

    <p class="text-gray-300"><span class="math">r_{rel}</span> <span class="math">=\\mathbb{E}\\left[\\lim_{n\\rightarrow\\infty}\\frac{\\sum_{i=1}^{n}r_{a_{i}}}{\\sum_{i=1}^{n}(r_{a_{i}}+r_{h_{i}})}\\right]</span> (5) <span class="math">=\\mathbb{E}\\left[\\lim_{n\\rightarrow\\infty}\\frac{n\\cdot\\overline{r_{a}}}{n\\cdot(\\overline{r_{a}}+\\overline{r_{h}})}\\right]</span> (6) <span class="math">=\\mathbb{E}\\left[\\lim_{n\\rightarrow\\infty}\\frac{\\overline{r_{a}}}{(\\overline{r_{a}}+\\overline{r_{h}})}\\right]</span> (7) <span class="math">=\\mathbb{E}\\left[\\frac{\\overline{r_{a}}}{\\overline{\\overline{r_{a}}}+\\overline{r_{h}}}\\right]</span> (8) <span class="math">=\\frac{\\overline{r_{a}}}{\\overline{r_{a}}+\\overline{r_{h}}}</span> (9)</p>

    <p class="text-gray-300">Additionally, we develop <span class="math">v_{\\rho}^{*}</span> as follows:</p>

    <p class="text-gray-300"><span class="math">v_{\\rho}^{<em>}</span> <span class="math">=v_{\\rho}^{\\pi^{</em>}}</span> (11) <span class="math">=\\mathbb{E}\\left[\\lim_{n\\rightarrow\\infty}\\frac{1}{n}\\sum_{i=1}^{n}w_{\\rho}(r_{i}(\\pi^{*}))\\right]</span> (12) <span class="math">=\\mathbb{E}\\left[\\lim_{n\\rightarrow\\infty}\\frac{1}{n}\\sum_{i=1}^{n}((1-\\rho)\\cdot r_{a_{i}}-\\rho\\cdot r_{h_{i}})\\right]</span> (13) <span class="math">=\\mathbb{E}\\left[\\lim_{n\\rightarrow\\infty}\\frac{1}{n}\\left((1-\\rho)\\cdot\\sum_{i=1}^{n}r_{a_{i}}-\\rho\\cdot\\sum_{i=1}^{n}r_{h_{i}}\\right)\\right]</span> (14) <span class="math">=\\mathbb{E}\\left[\\lim_{n\\rightarrow\\infty}\\frac{1}{n}\\left(n\\cdot(1-\\rho)\\cdot\\overline{r_{a}}-n\\cdot\\rho\\cdot\\overline{r_{h}}\\right)\\right]</span> (15) <span class="math">=\\mathbb{E}\\left[\\lim_{n\\rightarrow\\infty}\\left((1-\\rho)\\cdot\\overline{r_{a}}-\\rho\\cdot\\overline{r_{h}}\\right)\\right]</span> (16) <span class="math">=\\mathbb{E}\\left[(1-\\rho)\\cdot\\overline{r_{a}}-\\rho\\cdot\\overline{r_{h}}\\right]</span> (17) <span class="math">=(1-\\rho)\\cdot\\overline{r_{a}}-\\rho\\cdot\\overline{r_{h}}</span> (18)</p>

    <p class="text-gray-300">And thus, for the case where <span class="math">\\rho=r_{rel}=\\frac{\\overline{r_{a}}}{\\overline{r_{a}}+\\overline{r_{h}}}</span>:</p>

    <p class="text-gray-300"><span class="math">v_{\\rho}^{*}</span> <span class="math">=(1-\\rho)\\cdot\\overline{r_{a}}-\\rho\\cdot\\overline{r_{h}}</span> (19) <span class="math">=(1-\\frac{\\overline{r_{a}}}{\\overline{r_{a}}+\\overline{r_{h}}})\\cdot\\overline{r_{a}}-\\frac{\\overline{r_{a}}}{\\overline{r_{a}}+\\overline{r_{h}}}\\cdot\\overline{r_{h}}</span> (20) <span class="math">=\\frac{\\overline{r_{a}}\\cdot(\\overline{r_{a}}+\\overline{r_{h}})-\\overline{r_{a}}^{2}}{\\overline{r_{a}}+\\overline{r_{h}}}-\\frac{\\overline{r_{a}}\\cdot\\overline{r_{h}}}{\\overline{r_{a}}+\\overline{r_{h}}}</span> (21) <span class="math">=\\frac{\\overline{r_{a}}^{2}+\\overline{r_{a}}\\cdot\\overline{r_{h}}-\\overline{r_{a}}^{2}-\\overline{r_{a}}\\cdot\\overline{r_{h}}}{\\overline{r_{a}}+\\overline{r_{h}}}</span> (22) <span class="math">=0</span> (23)</p>

    <p class="text-gray-300">The reasoning for the second proposition is straightforward. For any given policy <span class="math">\\pi</span>, it holds for <span class="math">\\rho&gt;\\rho^{\\prime}</span> that <span class="math">w_{\\rho}(r_{a},r_{h})\\leq w_{\\rho^{\\prime}}(r_{a},r_{h})</span> for every transition with rewards <span class="math">r_{a}</span> and <span class="math">r_{h}</span> for the adversary and the honest network, respectively. It follows directly that <span class="math">v_{\\rho}^{<em>}\\leq v_{\\rho}^{</em>}</span>, for every policy <span class="math">\\pi</span> and thus <span class="math">v_{\\rho}^{<em>}\\leq v_{\\rho^{\\prime}}^{</em>}</span>, i.e., <span class="math">v_{\\rho}^{*}</span> is monotonically decreasing in <span class="math">\\rho</span>.</p>

    <p class="text-gray-300">We use binary search on our restricted family of MDPs for <span class="math">\\rho\\in[0,1]</span> in order to find the <span class="math">\\rho</span> for which the expected value in the instantiated MDP is zero and which therefore maximizes the reward in the original single-player decision problem <em>[31]</em>. Since <span class="math">v_{\\rho}^{*}</span> is monotonically decreasing, this can be done efficiently as follows:</p>

    <p class="text-gray-300">function optimal strategy(<span class="math">c,\\epsilon</span>) <span class="math">low\\leftarrow 0</span> <span class="math">high\\leftarrow 1</span> repeat <span class="math">\\rho\\leftarrow(low+high)/2</span> <span class="math">(\\pi,v_{\\rho}^{<em>})\\leftarrow\\textsc{mdp\\_solver}(M_{\\rho}^{c})</span> if <span class="math">v_{\\rho}^{</em>}&gt;0</span> then <span class="math">low\\leftarrow\\rho</span> else <span class="math">high\\leftarrow\\rho</span> end if until <span class="math">high-low&lt;\\epsilon</span> return <span class="math">\\pi,\\rho</span> end function</p>

    <p class="text-gray-300">As far as we are aware, this is the first selfish mining model that (i) captures various parameters such as block propagation times, block size, block generation interval, and (ii) known network vulnerabilities such as eclipse attacks. Note that we do not consider mining costs in the selfish mining MDP since the objective here is to increase the relative mining share (and not the monetary reward).</p>

    <h4 id="sec-16" class="text-lg font-semibold mt-6">3.2.1 Optimal Strategies for Selfish Mining</h4>

    <p class="text-gray-300">In order to solve the MDP’s, we apply an MDP solver for finite state space MDPs <em>[18]</em>, and use a cutoff value of 30 blocks.</p>

    <p class="text-gray-300">We first analyse the impact of the stale block rate on selfish mining. In Figure 2, we compare selfish mining under a stale block rate of <span class="math">1\\%</span> and <span class="math">10\\%</span>, and we observe that the higher the adversarial mining power, the bigger the relative revenue of a selfish miner grows (up to a maximum difference of 0.074). For comparison purposes, we plot an upper bound <span class="math">\\frac{\\alpha}{1-\\alpha}</span> of the adversarial relative revenue from selfish mining which corresponds to the case where the adversary’s advantage is maximized by utilizing one block to override one block generated by the honest network (as reported by Sapirshtein et al. <em>[31]</em>). As we observe, this upper bound is exceeded when taking into account network delays and parameters that we capture via the stale block rate.</p>

    <p class="text-gray-300">For an adversary with a mining power of <span class="math">\\alpha=0.1</span> and <span class="math">\\alpha=0.3</span> respectively, we observe in Figure 3 that there is a non-linear relationship between the stale block rate and the relative mining revenue of selfish mining.</p>

    <p class="text-gray-300">We moreover study the impact of eclipse attacks on selfish mining in Figure 4. Here, we only consider the case where the adversary (i) exploits the victims mining power <span class="math">\\omega</span>, and (ii) uses all the victim’s blocks to advance his private chain. We therefore only determine the optimal adversarial choices given these restraints. We observe that the higher <span class="math">\\omega</span>, the stronger his selfish mining capabilities become. We note that for some values of <span class="math">\\omega</span> (e.g., <span class="math">\\omega=0.3</span>, <span class="math">\\alpha=0.38</span>), it is more rewarding for the adversary not to include some of the victims block in his private chain. This is because the victim’s block rewards count towards the reward of the honest network, and therefore reduce the relative block share of the adversary.</p>

    <h3 id="sec-17" class="text-xl font-semibold mt-8">3.3 Double-Spending MDP</h3>

    <p class="text-gray-300">Unlike selfish mining where the optimal strategy is not always financially rewarding compared to honest mining (cf. Section 3), we proceed in what follows to study optimal double-spending strategies, where we assume a rational adversary that is interested in maximizing his benefits (measured in financial gains) in the network.</p>

    <p class="text-gray-300">We implicitly require that each time the adversary starts a double-spending attack (e.g. after an adopt action), he publishes a transaction <span class="math">T_{l}</span> in the network, and mines on including a conflicting transaction <span class="math">T_{d}</span> in his private chain. We assume that the operational costs of “losing” a double-spending attempt are small, since the adversary effectively receives a good or service in exchange for transaction <span class="math">T_{l}</span>.</p>

    <p class="text-gray-300">In addition to the states described for the selfish mining, the double-spending MDP features the exit state (cf. Table 2). This state can only be reached provided that the adversarial chain is at least one block ahead the honest chain (<span class="math">l_{a}&gt;l_{h}</span>), after <span class="math">k</span> confirmations (<span class="math">l_{a}&gt;k</span>), given an honest network with mining power <span class="math">1-\\alpha</span>. Before reaching the exit state, the adversary adopts an optimal strategy to maximize its reward, given the state and action space described in Section 3. After reaching the exit state, transitions back to the exit state model rewards of honest mining. Note that since we assume that the adversary is rational, an optimal strategy might advise against performing double-spending attacks (i.e. the adversary will never reach the exit state)—depending on the value of the attempted attack. In the exit state, the adversary earns a block reward of <span class="math">l_{a}-b_{e}+v_{d}</span>, <span class="math">\\lfloor(l_{h}+1)\\frac{l_{a}-b_{e}}{l_{a}}\\rfloor-c_{m}</span> block rewards after an override with eclipse attack (because the adversary’s reward needs to discount the <span class="math">b_{e}</span> victim’s blocks and <span class="math">\\lfloor(l_{h})\\frac{l_{a}-b_{e}}{l_{a}}\\rfloor-c_{m}</span> block rewards if the adversary’s chain wins the race after a match action. For every state transition we discount the mining costs <span class="math">-c_{m}</span>.</p>

    <p class="text-gray-300">The adversary either abides by the optimal double-spending strategy <span class="math">\\pi</span> or performs honest mining, depending on the expected reward. We are therefore interested in the minimal double-spending value <span class="math">v_{d}</span>, such that <span class="math">v_{d}</span> is strictly larger than the honest mining reward (cf. Equation 25).</p>

    <p class="text-gray-300"><span class="math">P=(\\alpha,\\gamma,r_{s},k,\\omega,c_{m})</span> (24)</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">$v_{d}=\\min\\{v_{d}</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\exists\\pi\\in A:R(\\pi,P,v_{d})>R(\\text{honest mining},P)\\}$ (25)</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">The double-spending value <span class="math">v_{d}</span> can serve as a generic metric to compare the security of various blockchain instantiations. Namely, if <span class="math">v_{d}</span> of a blockchain instance <span class="math">A</span> is bigger than for blockchain <span class="math">B</span> for given <span class="math">\\alpha</span>, <span class="math">\\gamma</span> and <span class="math">\\omega</span>, then blockchain <span class="math">A</span> can be considered more resistant against double-spending attacks.</p>

    <h4 id="sec-18" class="text-lg font-semibold mt-6">3.3.1 Optimal Strategies for Double-Spending</h4>

    <p class="text-gray-300">In what follows, we analyze the solutions of our aforementioned double-spending MDP given various parameters. To solve for the optimal strategy in our MDP, we rely on the pymdptoolbox library and apply the PolicyIteration algorithm <em>[18]</em> with a discount value of 0.999. This methodology allows us to assess whether the number of transaction confirmations <span class="math">k</span> are sufficient to ensure security in the presence of a rational adversary, with respect to the considered transaction value. That is, if the adversary has a higher expected financial gain in double-spending than honest mining, then the transaction cannot be considered safe given <span class="math">k</span> confirmations, and the merchant should wait additional confirmations.</p>

    <p class="text-gray-300">In order to decide whether the adversary should choose to follow the optimal double-spending policy or honest mining (cf. Equation 25), and to determine the minimum <span class="math">v_{d}</span>, we instantiate the double-spending MDP with a high double-spending value (<span class="math">&gt;10^{9}</span> block rewards), such that the exit state is reachable in the optimal policy. If the policy contains an exit state, the expected gain of following the optimal double-spending strategy is higher than honest mining. Otherwise, honest mining is the preferred strategy. We apply binary search to find the lowest double-spending value (in units of block rewards, within an error margin of <span class="math">0.1</span>), for <span class="math">\\alpha</span>, <span class="math">k</span>, <span class="math">r_{s}</span>, <span class="math">\\gamma</span> and <span class="math">c_{m}</span>.</p>

    <p class="text-gray-300">In Table 3, we sketch an example of an optimal strategy for the case where <span class="math">\\alpha=0.3</span> (adversarial mining power), <span class="math">\\gamma=0</span> (propagation parameter), <span class="math">c_{m}=\\alpha</span> (maximum mining costs), <span class="math">\\omega=0</span> (no eclips</p>

    <p class="text-gray-300">!<a href="img-1.jpeg">img-1.jpeg</a> Figure 2: Selfish mining for  <span class="math">r_s</span>  of  <span class="math">1\\%</span> ,  <span class="math">10\\%</span> .</p>

    <p class="text-gray-300">!<a href="img-2.jpeg">img-2.jpeg</a> Figure 3: Selfish mining for  <span class="math">\\alpha = 0.1</span>  and 0.3.</p>

    <p class="text-gray-300">!<a href="img-3.jpeg">img-3.jpeg</a> Figure 4: Selfish mining with eclipse attacks.</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">State × Action</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Resulting State</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Probability</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Reward (in Block reward)</th>

          </tr>

        </thead>

        <tbody>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">(la, lh, be, ·), adopt</td>

            <td class="px-3 py-2 border-b border-gray-700">(1,0,0,i)</td>

            <td class="px-3 py-2 border-b border-gray-700">α</td>

            <td class="px-3 py-2 border-b border-gray-700">(-cm, lh)</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">(1,0,1,i)</td>

            <td class="px-3 py-2 border-b border-gray-700">ω</td>

            <td class="px-3 py-2 border-b border-gray-700">(-cm, lh)</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">(0,1,0,r)</td>

            <td class="px-3 py-2 border-b border-gray-700">(1 - α - ω) · (1 - rs)</td>

            <td class="px-3 py-2 border-b border-gray-700">(-cm, lh)</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">(0,0,0,i)</td>

            <td class="px-3 py-2 border-b border-gray-700">(1 - α - ω) · rs</td>

            <td class="px-3 py-2 border-b border-gray-700">(-cm, lh)</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">(la, lh, be, ·), override</td>

            <td class="px-3 py-2 border-b border-gray-700">(la - lh, 0, be - [ (lh + 1) be / la ] i)</td>

            <td class="px-3 py-2 border-b border-gray-700">α</td>

            <td class="px-3 py-2 border-b border-gray-700">(↓(lh + 1) la - bv / la] - cm, 0)</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">(la - lh, 0, be - [ (lh + 1) be / la ] + 1, i)</td>

            <td class="px-3 py-2 border-b border-gray-700">ω</td>

            <td class="px-3 py-2 border-b border-gray-700">(↓(lh + 1) la - bv / la] - cm, 0)</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">(la - lh - 1, 1, be - [ (lh + 1) be / la ] r)</td>

            <td class="px-3 py-2 border-b border-gray-700">(1 - α - ω) · (1 - rs)</td>

            <td class="px-3 py-2 border-b border-gray-700">(↓(lh + 1) la - bv / la] - cm, 0)</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">(la - lh - 1, 0, be - [ (lh + 1) be / la ] i)</td>

            <td class="px-3 py-2 border-b border-gray-700">(1 - α - ω) · rs</td>

            <td class="px-3 py-2 border-b border-gray-700">(↓(lh + 1) la - bv / la] - cm, 0)</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">(la, lh, be, i), wait</td>

            <td class="px-3 py-2 border-b border-gray-700">(la + 1, lh, be, i)</td>

            <td class="px-3 py-2 border-b border-gray-700">α</td>

            <td class="px-3 py-2 border-b border-gray-700">(-cm, 0)</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">(la + 1, lh, be, + 1, i)</td>

            <td class="px-3 py-2 border-b border-gray-700">ω</td>

            <td class="px-3 py-2 border-b border-gray-700">(-cm, 0)</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">(la, lh, be, r), wait</td>

            <td class="px-3 py-2 border-b border-gray-700">(la, lh + 1, be, r)</td>

            <td class="px-3 py-2 border-b border-gray-700">(1 - α - ω) · (1 - rs)</td>

            <td class="px-3 py-2 border-b border-gray-700">(-cm, 0)</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">(la, lh, be, i)</td>

            <td class="px-3 py-2 border-b border-gray-700">(1 - α - ω) · rs</td>

            <td class="px-3 py-2 border-b border-gray-700">(-cm, 0)</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">(la, lh, be, a), wait</td>

            <td class="px-3 py-2 border-b border-gray-700">(la + 1, lh, be, a)</td>

            <td class="px-3 py-2 border-b border-gray-700">α</td>

            <td class="px-3 py-2 border-b border-gray-700">(-cm, 0)</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">(la + 1, lh, be + 1, a)</td>

            <td class="px-3 py-2 border-b border-gray-700">ω</td>

            <td class="px-3 py-2 border-b border-gray-700">(-cm, 0)</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">(la - lh, 1, be - [ (lh) be / la ] r)</td>

            <td class="px-3 py-2 border-b border-gray-700">γ · (1 - α - ω) · (1 - rs)</td>

            <td class="px-3 py-2 border-b border-gray-700">(↓(lh) la - bv / la] - cm, 0)</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">(la, lh + 1, be, r)</td>

            <td class="px-3 py-2 border-b border-gray-700">(1 - γ) · (1 - α - ω) · (1 - rs)</td>

            <td class="px-3 py-2 border-b border-gray-700">(-cm, 0)</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">(la, lh, be, a)</td>

            <td class="px-3 py-2 border-b border-gray-700">(la, lh, be, a)</td>

            <td class="px-3 py-2 border-b border-gray-700">(1 - α - ω) · rs</td>

            <td class="px-3 py-2 border-b border-gray-700">(-cm, 0)</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">(la, lh, be, ·), exit</td>

            <td class="px-3 py-2 border-b border-gray-700">exit</td>

            <td class="px-3 py-2 border-b border-gray-700">1</td>

            <td class="px-3 py-2 border-b border-gray-700">(la - be + vd, 0)</td>

          </tr>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">Table 2: State transition and reward matrices for optimal selfish mining and double-spending strategies in PoW blockchains.  <span class="math">\\alpha</span>  is the mining power of the attacker,  <span class="math">\\omega</span>  is the mining power of the eclipsed node,  <span class="math">b_{e}</span>  is the number of blocks in the attacker chain that were mined by the eclipsed node,  <span class="math">\\gamma</span>  is the fraction of nodes that an attacker can reach faster than the honest network,  <span class="math">r_{s}</span>  is the stale block rate and  <span class="math">v_{d}</span>  is the value of the double-spend. The actions override and match are feasible only when  <span class="math">l_{a} &amp;gt; l_{h}</span>  or  <span class="math">l_{a} \\geq l_{h}</span> , respectively. We discount the mining costs  <span class="math">c_{m} \\in [0, \\alpha]</span>  in the state transition reward only for double-spending. The fork label (last element of the state) is denoted by  <span class="math">i</span> ,  <span class="math">r</span>  and  <span class="math">a</span>  for irrelevant, relevant and active respectively. For a reward tuple  <span class="math">(a, b)</span> ,  <span class="math">a</span>  corresponds to the adversary's costs, while  <span class="math">b</span>  represents the reward for the honest network for selfish mining.</p>

    <p class="text-gray-300">attack), where we observe only wait, adopt and exit actions. Because we can only solve finite MDPs, we choose a cutoff value of 20 blocks, i.e., neither the chain of the adversary nor the chain of the honest network can be longer than the cutoff value. In the following paragraphs, we discuss in greater details the impact of  <span class="math">\\alpha</span> ,  <span class="math">\\gamma</span> ,  <span class="math">c_{m}</span> ,  <span class="math">r_{s}</span> ,  <span class="math">k</span> ,  <span class="math">v_{d}</span>  and  <span class="math">\\omega</span>  on the optimal double-spending strategy and its implications on the security of transaction confirmations.</p>

    <p class="text-gray-300">Recall that the absorbing state [22] of the Markov chain of our double-spending MDP is the exit state. By computing the fundamental matrix [22] of the Markov chain, we calculate the expected number of steps in the Markov chain—before being absorbed by the exit state. These steps correspond to the expected number of blocks required for a successful double-spending attack. In Figure 5, we evaluate the expected number of blocks with respect to the adversarial mining power and the number of transaction confirmations  <span class="math">k</span> . We observe that an adversary with a mining power of more than 0.25 is expected to need less than 1000 blocks for a successful double-spending attack (up to  <span class="math">k = 10</span>  confirmations), which corresponds to a one week attack duration in Bitcoin.</p>

    <p class="text-gray-300">Impact of the propagation parameter: Recall that the propagation parameter specifies the connection capability of the adversary. In Figure 8, we depict the minimum double-spending transaction value that would result in financial gain when compared to honest mining (cf. Equation 25) when  <span class="math">\\gamma = 0, 0.5</span>  and 1 respectively. Recall that a merchant is safe as long as he accepts transactions with a value less than  <span class="math">v_{d}</span>  given these parameters.</p>

    <p class="text-gray-300">Clearly, the higher  <span class="math">\\gamma</span>  is, the lower is the transaction value that an adversary is expected to double-spend. For example, if the adversary has  <span class="math">\\alpha = 0.3</span>  of the hashing power in the network, assuming  <span class="math">k = 6</span>  confirmations, and a mining cost of  <span class="math">c_{m} = \\alpha</span> , a double-spending strategy is clearly profitable if the double-spending transaction has a value of at least 0.5 block rewards (one block reward is 25 Bitcoin, where one Bitcoin is about 436.7 USD at the time of writing, for  <span class="math">r_{s} = 0.41\\%</span> ) when  <span class="math">\\gamma = 1</span> . When  <span class="math">\\gamma = 0.5</span> , the minimum transaction value increases to 12.9 block rewards.</p>

    <p class="text-gray-300">Impact of the mining costs: In Figure 6, we analyze the impact of the mining costs on the minimum required double-spending transaction value. Our results show that mining costs have negligible</p>

    <p class="text-gray-300">!<a href="img-4.jpeg">img-4.jpeg</a> Figure 5: Expected number of blocks for successful double-spending given  <span class="math">r_s = 0.41\\%</span> ,  <span class="math">\\gamma = 0</span> ,  <span class="math">c_m = \\alpha</span>  and  <span class="math">\\omega = 0</span> .</p>

    <p class="text-gray-300">!<a href="img-5.jpeg">img-5.jpeg</a> Figure 6: Impact of the mining cost  <span class="math">c_{m}</span>  on the security of double spending ( <span class="math">r_{s} = 0.41\\%</span> ,  <span class="math">\\gamma = 0, \\omega = 0</span> ).  <span class="math">\\Delta_{v_{d}}</span>  is the difference in costs.</p>

    <p class="text-gray-300">!<a href="img-6.jpeg">img-6.jpeg</a> Figure 7: Impact of stale block rate  <span class="math">r_s</span>  on the security of double-spending given  <span class="math">\\gamma = 0.5</span> ,  <span class="math">\\omega = 0</span>  for  <span class="math">\\alpha = 0.1</span> ,  <span class="math">\\alpha = 0.3</span>  and  <span class="math">k = 6</span> .</p>

    <p class="text-gray-300">!<a href="img-7.jpeg">img-7.jpeg</a> (a)  <span class="math">\\gamma = 0</span></p>

    <p class="text-gray-300">!<a href="img-8.jpeg">img-8.jpeg</a> (b)  <span class="math">\\gamma = 0.5</span></p>

    <p class="text-gray-300">!<a href="img-9.jpeg">img-9.jpeg</a> (c)  <span class="math">\\gamma = 1</span> Figure 8: Impact of the propagation parameter  <span class="math">\\gamma</span> . We observe that the higher is  <span class="math">\\gamma</span> , the lower is  <span class="math">v_{d}</span>  for double-spending to be more profitable than honest mining.  <span class="math">r_{s} = 0.41\\%</span>  (Bitcoin's stale block rate),  <span class="math">c_{m} = \\alpha</span>  (maximum mining costs),  <span class="math">\\omega = 0</span>  (no eclipse attack).</p>

    <p class="text-gray-300"><span class="math">l_{h}</span></p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">la</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">0</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">1</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">2</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">3</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">4</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">5</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">6</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">7</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">8</th>

          </tr>

        </thead>

        <tbody>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">0</td>

            <td class="px-3 py-2 border-b border-gray-700">w**</td>

            <td class="px-3 py-2 border-b border-gray-700"><em>a</em></td>

            <td class="px-3 py-2 border-b border-gray-700">***</td>

            <td class="px-3 py-2 border-b border-gray-700">***</td>

            <td class="px-3 py-2 border-b border-gray-700">***</td>

            <td class="px-3 py-2 border-b border-gray-700">***</td>

            <td class="px-3 py-2 border-b border-gray-700">***</td>

            <td class="px-3 py-2 border-b border-gray-700">***</td>

            <td class="px-3 py-2 border-b border-gray-700">***</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">1</td>

            <td class="px-3 py-2 border-b border-gray-700">w**</td>

            <td class="px-3 py-2 border-b border-gray-700">ww*</td>

            <td class="px-3 py-2 border-b border-gray-700">ww*</td>

            <td class="px-3 py-2 border-b border-gray-700"><em>a</em></td>

            <td class="px-3 py-2 border-b border-gray-700">***</td>

            <td class="px-3 py-2 border-b border-gray-700">***</td>

            <td class="px-3 py-2 border-b border-gray-700">***</td>

            <td class="px-3 py-2 border-b border-gray-700">***</td>

            <td class="px-3 py-2 border-b border-gray-700">***</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">2</td>

            <td class="px-3 py-2 border-b border-gray-700">w**</td>

            <td class="px-3 py-2 border-b border-gray-700">ww*</td>

            <td class="px-3 py-2 border-b border-gray-700">ww*</td>

            <td class="px-3 py-2 border-b border-gray-700">ww*</td>

            <td class="px-3 py-2 border-b border-gray-700">ww*</td>

            <td class="px-3 py-2 border-b border-gray-700"><em>a</em></td>

            <td class="px-3 py-2 border-b border-gray-700">***</td>

            <td class="px-3 py-2 border-b border-gray-700">***</td>

            <td class="px-3 py-2 border-b border-gray-700">***</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">3</td>

            <td class="px-3 py-2 border-b border-gray-700">w**</td>

            <td class="px-3 py-2 border-b border-gray-700">ww*</td>

            <td class="px-3 py-2 border-b border-gray-700">ww*</td>

            <td class="px-3 py-2 border-b border-gray-700">ww*</td>

            <td class="px-3 py-2 border-b border-gray-700">ww*</td>

            <td class="px-3 py-2 border-b border-gray-700">ww*</td>

            <td class="px-3 py-2 border-b border-gray-700"><em>a</em></td>

            <td class="px-3 py-2 border-b border-gray-700">***</td>

            <td class="px-3 py-2 border-b border-gray-700">***</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">4</td>

            <td class="px-3 py-2 border-b border-gray-700">w**</td>

            <td class="px-3 py-2 border-b border-gray-700">ww*</td>

            <td class="px-3 py-2 border-b border-gray-700">ww*</td>

            <td class="px-3 py-2 border-b border-gray-700">ww*</td>

            <td class="px-3 py-2 border-b border-gray-700">ww*</td>

            <td class="px-3 py-2 border-b border-gray-700">ww*</td>

            <td class="px-3 py-2 border-b border-gray-700">ww*</td>

            <td class="px-3 py-2 border-b border-gray-700"><em>a</em></td>

            <td class="px-3 py-2 border-b border-gray-700">***</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">5</td>

            <td class="px-3 py-2 border-b border-gray-700">w**</td>

            <td class="px-3 py-2 border-b border-gray-700">ww*</td>

            <td class="px-3 py-2 border-b border-gray-700">ww*</td>

            <td class="px-3 py-2 border-b border-gray-700">ww*</td>

            <td class="px-3 py-2 border-b border-gray-700">ww*</td>

            <td class="px-3 py-2 border-b border-gray-700">ww*</td>

            <td class="px-3 py-2 border-b border-gray-700">ww*</td>

            <td class="px-3 py-2 border-b border-gray-700">ww*</td>

            <td class="px-3 py-2 border-b border-gray-700"><em>a</em></td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">6</td>

            <td class="px-3 py-2 border-b border-gray-700">w**</td>

            <td class="px-3 py-2 border-b border-gray-700">ww*</td>

            <td class="px-3 py-2 border-b border-gray-700">ww*</td>

            <td class="px-3 py-2 border-b border-gray-700">ww*</td>

            <td class="px-3 py-2 border-b border-gray-700">ww*</td>

            <td class="px-3 py-2 border-b border-gray-700">ww*</td>

            <td class="px-3 py-2 border-b border-gray-700">ww*</td>

            <td class="px-3 py-2 border-b border-gray-700">ww*</td>

            <td class="px-3 py-2 border-b border-gray-700">ww*</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">7</td>

            <td class="px-3 py-2 border-b border-gray-700">e**</td>

            <td class="px-3 py-2 border-b border-gray-700">e**</td>

            <td class="px-3 py-2 border-b border-gray-700">e**</td>

            <td class="px-3 py-2 border-b border-gray-700">e**</td>

            <td class="px-3 py-2 border-b border-gray-700">e**</td>

            <td class="px-3 py-2 border-b border-gray-700">e**</td>

            <td class="px-3 py-2 border-b border-gray-700">e**</td>

            <td class="px-3 py-2 border-b border-gray-700">w**</td>

            <td class="px-3 py-2 border-b border-gray-700">ww*</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">8</td>

            <td class="px-3 py-2 border-b border-gray-700">***</td>

            <td class="px-3 py-2 border-b border-gray-700">***</td>

            <td class="px-3 py-2 border-b border-gray-700">***</td>

            <td class="px-3 py-2 border-b border-gray-700">***</td>

            <td class="px-3 py-2 border-b border-gray-700">***</td>

            <td class="px-3 py-2 border-b border-gray-700">***</td>

            <td class="px-3 py-2 border-b border-gray-700">***</td>

            <td class="px-3 py-2 border-b border-gray-700">e**</td>

            <td class="px-3 py-2 border-b border-gray-700">w**</td>

          </tr>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">Table 3: Optimal double-spending strategy for  <span class="math">\\alpha = 0.3, \\gamma = 0, r_s = 0.41\\%</span> ,  <span class="math">c_m = \\alpha, \\omega = 0</span>  and  <span class="math">v_d = 19.5</span> . The rows correspond to the length  <span class="math">l_a</span>  of the adversary's chain and the columns correspond to the length  <span class="math">l_h</span>  of the honest network's chain. The three values in each table entry correspond to the fork labels irrelevant, relevant and active, where * marks an unreachable state and  <span class="math">w</span> ,  <span class="math">a</span>  and  <span class="math">e</span>  denote the wait, adopt and exit actions, respectively.</p>

    <p class="text-gray-300">impact on the adversarial strategy.</p>

    <p class="text-gray-300">Impact of the stale block rate: We evaluate the impact of the stale block rate for adversaries with a mining power of  <span class="math">\\alpha = 0.1</span>  and  <span class="math">\\alpha = 0.3</span>  in Figure 7. We observe that there exists a non-linear relationship between the stale block rate and the double-spending value and that the higher the stale block rate, the worse is the double-spending and selfish mining resistance of a PoW blockchain (cf. Figure 7). For instance, for an adversary with mining power  <span class="math">\\alpha = 0.3</span></p>

    <p class="text-gray-300">and a stale block rate of  <span class="math">10\\%</span>  and  <span class="math">20\\%</span> , the double-spending value  <span class="math">v_{d}</span>  decreases from 9.2 to 6.4 block rewards. Similarly, the relative revenue from selfish mining (cf. Figure 3) increases from 0.37 to 0.43.</p>

    <p class="text-gray-300">Impact of eclipse attacks We evaluate the impact of eclipse attacks on the adversarial strategy given our MDP. We assume that the adversary eclipses a victim with mining power  <span class="math">\\omega</span>  in order to increase its advantage in sustaining his blockchain (cf. Figure 9). We observe that an eclipse attack clearly empowers the adversary, since it allows the adversary to effectively increase its overall mining power. For instance, an adversary with  <span class="math">\\alpha = 0.1</span>  can reduce the double-spending value  <span class="math">v_{d}</span>  from 880 block rewards to 0.75 block reward if eclipsing a miner with  <span class="math">\\omega = 0.025</span> .</p>

    <p class="text-gray-300">In order to alleviate the problem that stale blocks decrease PoW's efficiency, a number of proposals, such as Ethereum, suggest to reward miners for stale blocks [4]. Here, although uncle blocks that are included in a block receive a reward, they do not count towards the total difficulty of a chain, i.e., Ethereum uses a longest chain rule with added rewards for uncle blocks. This clearly contradicts Ethereum's claim of using a blockchain protocol adapting GHOST [33].</p>

    <p class="text-gray-300">Ethereum has also recently modified its longest chain algorithm to incorporate uniform tie breaking [10]. Notice that such a strategy is meant as a selfish mining countermeasure, but allows a selfish miner to increase its chances of catching up to the honest chain [31]. In Table 4, we extend our model to cater for uncle rewards and uniform tie breaking, and describe the resulting double-spending MDP in order to capture the security of Ethereum against double-spending.</p>

    <p class="text-gray-300">!<a href="img-10.jpeg">img-10.jpeg</a> Figure 9: Full eclipse attack for  <span class="math">r_s = 0.41\\%</span> ,  <span class="math">\\gamma = 0</span>  and  <span class="math">c_m = 0</span> .</p>

    <p class="text-gray-300">!<a href="img-11.jpeg">img-11.jpeg</a> Figure 10: Double-spending resistance of Ethereum  <span class="math">(k\\in \\{6,12\\})</span>  vs. Bitcoin  <span class="math">(k = 6)</span>  USD exchange rate of 2016-04-20.</p>

    <p class="text-gray-300">!<a href="img-12.jpeg">img-12.jpeg</a> Figure 11: Direct comparison between Ethereum and Bitcoin with  <span class="math">k = 6</span> ,  <span class="math">r_s = 6.8\\%</span>  and their respective difference  <span class="math">\\Delta_{v_d}</span> .</p>

    <p class="text-gray-300">Building on this analysis, we compare in Figure 10, the double-spending resilience of Bitcoin ( <span class="math">r_s = 0.41\\%</span> , cf. MDP in Table 2) to that of Ethereum ( <span class="math">r_s = 6.8\\%</span> , cf. MDP in Table 4), given  <span class="math">\\gamma = 0</span> ,  <span class="math">c_m = 0</span>  and  <span class="math">\\omega = 0</span> . In order to provide a fair cost comparison, we rely on US dollar based valuation (Bitcoin's block reward is more than 200 times higher than Ethereum's block reward).</p>

    <p class="text-gray-300">We observe that 6 Bitcoin block confirmations are more resilient to double-spending than 6 Ethereum block confirmations. Second, when comparing 12 Ethereum with 6 Bitcoin block confirmations, Ethereum's double-spending resilience is only better than Bitcoin for an adversary with less than  <span class="math">11\\%</span>  of the PoW hashing power. Note that 12 Ethereum blocks are likely to be generated in less than 4 minutes, while 6 Bitcoin blocks last about one hour. Third, we discover that the monetary value of the block reward directly impacts the double-spending security: the higher the block reward of a blockchain (in $) the more resilient it is against double-spending.</p>

    <p class="text-gray-300">In addition to comparing Bitcoin to Ethereum, we compare in Figure 11 the two blockchains by setting Bitcoin's stale block rate equal to Ethereum's stale block rate to objectively evaluate their security implications. We observe that, in spite of the reliance on uncle block rewards, and uniform tie breaking, Ethereum's security is weaker than Bitcoin, and conclude that the uniform tie breaking and the uncle reward lower the security of Ethereum's blockchain.</p>

    <p class="text-gray-300">In this section, we evaluate the performance (and security) of various blockchain instantiations by leveraging our model in Section 3.</p>

    <p class="text-gray-300">To this end, we constructed a Bitcoin blockchain simulator in order to evaluate different blockchain instances from a performance perspective. Relying on simulations emerges as the only workable alternative to realistically capture the blockchain performance under different parameters since neither formal modeling, nor the deployment of a thousands of peers (e.g., currently there are 6000 reachable nodes in Bitcoin) would be practical.</p>

    <p class="text-gray-300">By leveraging our simulator, we evaluate different blockchain parameters, such as the block interval, the block size, the propagation mechanisms by measuring the resulting stale block rate, throughput and block propagation times. This also allows us to connect our blockchain simulator to our MDP model in a unified framework. Namely, we feed the stale block rate output by the simulator into our MDP model in order to assess the security (under selfish mining and double-spending) of the resulting blockchain instance.</p>

    <p class="text-gray-300">In Table 5, we summarize the parameters captured by our simulator. Here, we simulate the PoW for miners, by attributing a particular mining power to each miner. Based on the block interval distribution (which defines at what time a block is found), a new block is then attributed to a miner. Conforming with the operation of existing PoW-blockchains, a miner mines on the first block he receives, and we assume that forks are inherently resolved by the longest chain rule. Once a fork is resolved, the blocks that do not contribute to the main chain are considered stale blocks. Within our simulations, we do not consider difficulty changes among different blocks; the longest chain is therefore simply defined by the number of its blocks.</p>

    <p class="text-gray-300">When establishing the connections between nodes, we create point-to-point channels between them, which abstracts away any intermediate devices (routes, switches, etc). These channels have two characteristics; the latency and bandwidth. To capture realistic latencies in the network, we adopt the global IP latency statistics from Verizon [36] and assume a Pareto traffic distribution with variance accounting for  <span class="math">20\\%</span>  of the mean latency [2]. On the other hand, to model a realistic bandwidth distribution in the network, we adapted the distribution from testmy.net [34].</p>

    <p class="text-gray-300">Our simulator does not model the propagation of transactions, since the focal point of our simulator is to study the impact of the block size, block interval, and the block request management system—all of which can be captured independently of the transaction propagation. Note that transactions are implicitly captured within the block size.</p>

    <p class="text-gray-300">In our simulator, we distinguish between two node types: (i) regular nodes, and (ii) miners. For regular nodes (up to 6000), we retrieved the current geographical node distribution from bitnodes. 21.co (cf. Figure 12a) and adopted this distribution to define the location of our simulated nodes. We also adapted the bandwidth and network latency (according to the geographical location) from Verizon [2,36] and testmy.net [34]. To model miners, we retrieved the mining pool distribution from blockchain.info, and accordingly distributed the mining pool's public node to the respective region (cf. Figure 12b). Mining pools typically maintain private peering connections among themselves—which we capture in our simulations. Besides direct peering, a number of mining pools nowadays participate in Matt Corallo's relay network [6] that is operated independently of the default Bitcoin P2P overlay network (cf. Section 2.2). We also capture the relay network and assume in our simulations that all miners participate in the relay network whenever the relay</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">State × Action</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Resulting State</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Probability</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Reward</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Condition</th>

          </tr>

        </thead>

        <tbody>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">(la, lh, ·, nr), adopt</td>

            <td class="px-3 py-2 border-b border-gray-700">(1, 0, relevant, nr)</td>

            <td class="px-3 py-2 border-b border-gray-700">α</td>

            <td class="px-3 py-2 border-b border-gray-700">-cm</td>

            <td class="px-3 py-2 border-b border-gray-700">-</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">(0, 1, relevant, nr)</td>

            <td class="px-3 py-2 border-b border-gray-700">(1 - α) · (1 - rs)</td>

            <td class="px-3 py-2 border-b border-gray-700">-cm</td>

            <td class="px-3 py-2 border-b border-gray-700">-</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">(0, 0, relevant, nr)</td>

            <td class="px-3 py-2 border-b border-gray-700">(1 - α) · rs</td>

            <td class="px-3 py-2 border-b border-gray-700">-cm</td>

            <td class="px-3 py-2 border-b border-gray-700">-</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">(la, lh, ·, inc), adopt</td>

            <td class="px-3 py-2 border-b border-gray-700">(1, 0, relevant, nr)</td>

            <td class="px-3 py-2 border-b border-gray-700">α</td>

            <td class="px-3 py-2 border-b border-gray-700">r_u - cm</td>

            <td class="px-3 py-2 border-b border-gray-700">-</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">(0, 1, relevant, nr)</td>

            <td class="px-3 py-2 border-b border-gray-700">(1 - α) · (1 - rs)</td>

            <td class="px-3 py-2 border-b border-gray-700">r_u - cm</td>

            <td class="px-3 py-2 border-b border-gray-700">-</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">(0, 0, relevant, nr)</td>

            <td class="px-3 py-2 border-b border-gray-700">(1 - α) · rs</td>

            <td class="px-3 py-2 border-b border-gray-700">r_u - cm</td>

            <td class="px-3 py-2 border-b border-gray-700">-</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">(la, lh, ·, rel), adopt</td>

            <td class="px-3 py-2 border-b border-gray-700">(1, 0, relevant, rel)</td>

            <td class="px-3 py-2 border-b border-gray-700">α</td>

            <td class="px-3 py-2 border-b border-gray-700">-cm</td>

            <td class="px-3 py-2 border-b border-gray-700">-</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">(0, 1, relevant, inc)</td>

            <td class="px-3 py-2 border-b border-gray-700">(1 - α) · (1 - rs)</td>

            <td class="px-3 py-2 border-b border-gray-700">-cm</td>

            <td class="px-3 py-2 border-b border-gray-700">-</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">(0, 0, relevant, rel)</td>

            <td class="px-3 py-2 border-b border-gray-700">(1 - α) · rs</td>

            <td class="px-3 py-2 border-b border-gray-700">-cm</td>

            <td class="px-3 py-2 border-b border-gray-700">-</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">(la, lh, ·, ·), override</td>

            <td class="px-3 py-2 border-b border-gray-700">(la - lh, 0, relevant, nr)</td>

            <td class="px-3 py-2 border-b border-gray-700">α</td>

            <td class="px-3 py-2 border-b border-gray-700">l_h + 1 - cm</td>

            <td class="px-3 py-2 border-b border-gray-700">l_u > l_h</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">(la - lh, - 1, 1, relevant, nr)</td>

            <td class="px-3 py-2 border-b border-gray-700">(1 - α) · (1 - rs)</td>

            <td class="px-3 py-2 border-b border-gray-700">l_h + 1 - cm</td>

            <td class="px-3 py-2 border-b border-gray-700">l_u > l_h</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">(la - lh, - 1, 0, relevant, nr)</td>

            <td class="px-3 py-2 border-b border-gray-700">(1 - α) · rs</td>

            <td class="px-3 py-2 border-b border-gray-700">l_h + 1 - cm</td>

            <td class="px-3 py-2 border-b border-gray-700">l_u > l_h</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">(la, lh, relevant, nr), wait</td>

            <td class="px-3 py-2 border-b border-gray-700">(la + 1, lh, relevant, nr)</td>

            <td class="px-3 py-2 border-b border-gray-700">α</td>

            <td class="px-3 py-2 border-b border-gray-700">-cm</td>

            <td class="px-3 py-2 border-b border-gray-700">-</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">(la - lh + 1, relevant, nr)</td>

            <td class="px-3 py-2 border-b border-gray-700">(1 - α) · (1 - rs)</td>

            <td class="px-3 py-2 border-b border-gray-700">-cm</td>

            <td class="px-3 py-2 border-b border-gray-700">-</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">(la, lh, relevant, nr)</td>

            <td class="px-3 py-2 border-b border-gray-700">(1 - α) · rs</td>

            <td class="px-3 py-2 border-b border-gray-700">-cm</td>

            <td class="px-3 py-2 border-b border-gray-700">-</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">(la, lh, relevant, inc), wait</td>

            <td class="px-3 py-2 border-b border-gray-700">(la + 1, lh, relevant, inc)</td>

            <td class="px-3 py-2 border-b border-gray-700">α</td>

            <td class="px-3 py-2 border-b border-gray-700">-cm</td>

            <td class="px-3 py-2 border-b border-gray-700">-</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">(la - lh + 1, relevant, inc)</td>

            <td class="px-3 py-2 border-b border-gray-700">(1 - α) · (1 - rs)</td>

            <td class="px-3 py-2 border-b border-gray-700">-cm</td>

            <td class="px-3 py-2 border-b border-gray-700">-</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">(la, lh, relevant, inc)</td>

            <td class="px-3 py-2 border-b border-gray-700">(1 - α) · rs</td>

            <td class="px-3 py-2 border-b border-gray-700">-cm</td>

            <td class="px-3 py-2 border-b border-gray-700">-</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">(la, lh, relevant, rel), wait</td>

            <td class="px-3 py-2 border-b border-gray-700">(la + 1, lh, relevant, rel)</td>

            <td class="px-3 py-2 border-b border-gray-700">α</td>

            <td class="px-3 py-2 border-b border-gray-700">-cm</td>

            <td class="px-3 py-2 border-b border-gray-700">-</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">(la - lh + 1, relevant, inc)</td>

            <td class="px-3 py-2 border-b border-gray-700">(1 - α) · (1 - rs)</td>

            <td class="px-3 py-2 border-b border-gray-700">-cm</td>

            <td class="px-3 py-2 border-b border-gray-700">-</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">(la, lh, relevant, rel)</td>

            <td class="px-3 py-2 border-b border-gray-700">(1 - α) · rs</td>

            <td class="px-3 py-2 border-b border-gray-700">-cm</td>

            <td class="px-3 py-2 border-b border-gray-700">-</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">(la, lh, active, nr), wait (la, lh, relevant, nr), match</td>

            <td class="px-3 py-2 border-b border-gray-700">(la + 1, lh, active, nr)</td>

            <td class="px-3 py-2 border-b border-gray-700">α</td>

            <td class="px-3 py-2 border-b border-gray-700">-cm</td>

            <td class="px-3 py-2 border-b border-gray-700">l_h > 6</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">(la + 1, lh, active, rel)</td>

            <td class="px-3 py-2 border-b border-gray-700">α</td>

            <td class="px-3 py-2 border-b border-gray-700">-cm</td>

            <td class="px-3 py-2 border-b border-gray-700">l_h ≤ 6</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">(la - lh, 1, relevant, nr)</td>

            <td class="px-3 py-2 border-b border-gray-700">γ · (1 - α) · (1 - rs)</td>

            <td class="px-3 py-2 border-b border-gray-700">l_h - cm</td>

            <td class="px-3 py-2 border-b border-gray-700">-</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">(la - lh + 1, relevant, nr)</td>

            <td class="px-3 py-2 border-b border-gray-700">(1 - γ) · (1 - α) · (1 - rs)</td>

            <td class="px-3 py-2 border-b border-gray-700">-cm</td>

            <td class="px-3 py-2 border-b border-gray-700">l_h > 6</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">(la, lh + 1, relevant, inc)</td>

            <td class="px-3 py-2 border-b border-gray-700">(1 - γ) · (1 - α) · (1 - rs)</td>

            <td class="px-3 py-2 border-b border-gray-700">-cm</td>

            <td class="px-3 py-2 border-b border-gray-700">l_h ≤ 6</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">(la, lh, active, nr)</td>

            <td class="px-3 py-2 border-b border-gray-700">(1 - α) · rs</td>

            <td class="px-3 py-2 border-b border-gray-700">-cm</td>

            <td class="px-3 py-2 border-b border-gray-700">l_h > 6</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">(la, lh, active, rel)</td>

            <td class="px-3 py-2 border-b border-gray-700">(1 - α) · rs</td>

            <td class="px-3 py-2 border-b border-gray-700">-cm</td>

            <td class="px-3 py-2 border-b border-gray-700">l_h ≤ 6</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">(la, lh, active, inc), wait (la, lh, relevant, inc), match</td>

            <td class="px-3 py-2 border-b border-gray-700">(la + 1, lh, active, inc)</td>

            <td class="px-3 py-2 border-b border-gray-700">α</td>

            <td class="px-3 py-2 border-b border-gray-700">-cm</td>

            <td class="px-3 py-2 border-b border-gray-700">-</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">(la - lh, 1, relevant, nr)</td>

            <td class="px-3 py-2 border-b border-gray-700">γ · (1 - α) · (1 - rs)</td>

            <td class="px-3 py-2 border-b border-gray-700">l_h - cm</td>

            <td class="px-3 py-2 border-b border-gray-700">-</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">(la, lh + 1, relevant, inc)</td>

            <td class="px-3 py-2 border-b border-gray-700">(1 - γ) · (1 - α) · (1 - rs)</td>

            <td class="px-3 py-2 border-b border-gray-700">-cm</td>

            <td class="px-3 py-2 border-b border-gray-700">-</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">(la, lh, active, rel)</td>

            <td class="px-3 py-2 border-b border-gray-700">(1 - α) · rs</td>

            <td class="px-3 py-2 border-b border-gray-700">-cm</td>

            <td class="px-3 py-2 border-b border-gray-700">-</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">(la, lh, active, rel), wait (la, lh, relevant, rel), match</td>

            <td class="px-3 py-2 border-b border-gray-700">(la + 1, lh, active, rel)</td>

            <td class="px-3 py-2 border-b border-gray-700">α</td>

            <td class="px-3 py-2 border-b border-gray-700">-cm</td>

            <td class="px-3 py-2 border-b border-gray-700">-</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">(la - lh, 1, relevant, nr)</td>

            <td class="px-3 py-2 border-b border-gray-700">γ · (1 - α) · (1 - rs)</td>

            <td class="px-3 py-2 border-b border-gray-700">l_h - cm</td>

            <td class="px-3 py-2 border-b border-gray-700">-</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">(la, lh, - 1, relevant, inc)</td>

            <td class="px-3 py-2 border-b border-gray-700">(1 - γ) · (1 - α) · (1 - rs)</td>

            <td class="px-3 py-2 border-b border-gray-700">-cm</td>

            <td class="px-3 py-2 border-b border-gray-700">-</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"></td>

            <td class="px-3 py-2 border-b border-gray-700">(la, lh, active, rel)</td>

            <td class="px-3 py-2 border-b border-gray-700">(1 - α) · rs</td>

            <td class="px-3 py-2 border-b border-gray-700">-cm</td>

            <td class="px-3 py-2 border-b border-gray-700">-</td>

          </tr>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">Table 4: State transition and reward matrices for an MDP for optimal double-spending strategies in Ethereum where  <span class="math">r_u</span>  is the uncle reward (i.e.  <span class="math">\\frac{\\pi}{8}</span> ). Every state includes a flag (where  <span class="math">nr =</span>  not released,  <span class="math">rel =</span>  released,  <span class="math">inc =</span>  included) indicating whether an attacker block has been or will be included as an uncle in the honest chain. The release action corresponds to the release of the first block of the attackers fork with the intention to be included as uncle in the honest chain. Therefore, it is only feasible if  <span class="math">1 &amp;lt; l_h \\leq 6</span>  and  <span class="math">l_u \\geq 1</span> , since it is otherwise equivalent to a match or override or the honest chain is too long to include it as uncle. With the release action, no block is mined and a state transitions from not released to released, which transitions to included with the next block mined on the honest chain. In Ethereum,  <span class="math">\\gamma</span>  is fixed at 0.5 and a match is possible even without a prepared block.</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Consensus parameter</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Description</th>

          </tr>

        </thead>

        <tbody>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">Block interval distribution</td>

            <td class="px-3 py-2 border-b border-gray-700">Time to find a block</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">Mining power distribution of the miners</td>

            <td class="px-3 py-2 border-b border-gray-700">PoW power distribution</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">Network-layer parameter</td>

            <td class="px-3 py-2 border-b border-gray-700">Description</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">Block size distribution</td>

            <td class="px-3 py-2 border-b border-gray-700">Variable transaction load</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"># of reachable network nodes</td>

            <td class="px-3 py-2 border-b border-gray-700">Open TCP port nodes</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">Geo. distribution of nodes</td>

            <td class="px-3 py-2 border-b border-gray-700">Worldwide distribution</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">Geo. mining pool distribution</td>

            <td class="px-3 py-2 border-b border-gray-700">Worldwide distribution</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"># of connections per node</td>

            <td class="px-3 py-2 border-b border-gray-700">Within network</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700"># of connections of the miners</td>

            <td class="px-3 py-2 border-b border-gray-700">Within network</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">Block request management system</td>

            <td class="px-3 py-2 border-b border-gray-700">Possible Protocols</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">Standard mechanism (inv/getdata)</td>

            <td class="px-3 py-2 border-b border-gray-700">Default</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">Unsolicited block push</td>

            <td class="px-3 py-2 border-b border-gray-700">Miner only push block</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">Relay network</td>

            <td class="px-3 py-2 border-b border-gray-700">Miner network</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">Sendheaders</td>

            <td class="px-3 py-2 border-b border-gray-700">Bitcoin v0.12</td>

          </tr>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">Table 5: Parameters of the blockchain simulation. network option is enabled.</p>

    <p class="text-gray-300">In what follows, we present the results from our evaluation.</p>

    <p class="text-gray-300">With the objective to experimentally validate our simulation, we compared Bitcoin, Litecoin, and Dogecoin with their respective simulated counterpart. For each blockchain, we adjusted the parameters of Table 5 according to the current parameters featured</p>

    <p class="text-gray-300">!<a href="img-13.jpeg">img-13.jpeg</a> (a) Node distribution. Figure 12: Geographical distribution of Bitcoin nodes and miners used in our simulator.</p>

    <p class="text-gray-300">!<a href="img-14.jpeg">img-14.jpeg</a> (b) Miner distribution.</p>

    <p class="text-gray-300">by existing deployments of the investigated blockchains. For instance, we measured Bitcoin's block size distribution, as well as the block generation rate in the real Bitcoin network between May to November 2015 [21].</p>

    <p class="text-gray-300">In order to measure the stale block rate  <span class="math">r_s</span>  in the real blockchain networks, we crawled 24,000 Bitcoin blocks <span class="math">^8</span> , 100,000 Litecoin and 240,000 Dogecoin blocks <span class="math">^8</span> . We moreover adopt the miner mining power distribution for the different blockchains from public block</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Bitcoin</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Litecoin</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Dogecoin</th>

          </tr>

        </thead>

        <tbody>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">Block interval</td>

            <td class="px-3 py-2 border-b border-gray-700">10 min</td>

            <td class="px-3 py-2 border-b border-gray-700">2.5 min</td>

            <td class="px-3 py-2 border-b border-gray-700">1 min</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">Measured tMBP</td>

            <td class="px-3 py-2 border-b border-gray-700">8.7 s [8]</td>

            <td class="px-3 py-2 border-b border-gray-700">1.02 s</td>

            <td class="px-3 py-2 border-b border-gray-700">0.98 s</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">Simulated tMBP</td>

            <td class="px-3 py-2 border-b border-gray-700">9.42 s</td>

            <td class="px-3 py-2 border-b border-gray-700">0.86 s</td>

            <td class="px-3 py-2 border-b border-gray-700">0.83 s</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">Measured rs</td>

            <td class="px-3 py-2 border-b border-gray-700">0.41 %</td>

            <td class="px-3 py-2 border-b border-gray-700">0.27 %</td>

            <td class="px-3 py-2 border-b border-gray-700">0.62 %</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">Simulated rs</td>

            <td class="px-3 py-2 border-b border-gray-700">(a)0.14%-(b)1.85%</td>

            <td class="px-3 py-2 border-b border-gray-700">(b)0.24 %</td>

            <td class="px-3 py-2 border-b border-gray-700">(b)0.79 %</td>

          </tr>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">Table 6: Median block propagation time ( <span class="math">t_{MBP}</span> , in seconds), and  <span class="math">r_s</span>  in the real networks and the simulation (10000 blocks for each blockchain). (a) assumes that all miners use the relay network and unsolicited block push, while (b) is only given the standard propagation mechanism. We conclude that not all miners in Bitcoin use the relay network and unsolicited block push.</p>

    <p class="text-gray-300">explorers <span class="math">^{10}</span> . The number of connection per node in our simulations follows the distribution due to Miller et al. [26].</p>

    <p class="text-gray-300">Our findings (cf. Table 6) show that our simulator captures, to a large extent, the performance of existing blockchain deployments. For instance, our results show that the measured and simulated median block propagation times are relatively close. The stale block rates for Litecoin and Dogecoin are particularly close. In the case of Bitcoin, the stale rate falls between the case when all miners use the relay network and unsolicited block push, and the extreme case where the relay network and unsolicited block push is not used by any miner. Note that Litecoin and Dogecoin do not have any relay network.</p>

    <p class="text-gray-300">In this section, we study the impact of the block interval on the median block propagation time and the stale block rate in PoW-based blockchains. To this end, we run our simulator for different block interval times ranging from 25 minutes to 0.5 seconds (cf. Table 7). Each simulation is run independently for 10000 consecutive blocks, and for each of the four different block request management system combinations: (Case 1) the standard block request management, (Case 2) the standard block request management enhanced by unsolicited block push from the miners, (Case 3) both former components plus the relay network, and (Case 4) the send headers mechanism with unsolicited block push and the relay network.</p>

    <p class="text-gray-300">We observe first that for a block interval time of 10 minutes and a standard request management system, our stale block rate is  <span class="math">1.85\\%</span> , which is comparable to  <span class="math">1.69\\%</span>  as reported by Wattenhofer et al. [9]. Recall that at the time of Wattenhofer's study, the unsolicited block push and relay network were not yet available.</p>

    <p class="text-gray-300">Secondly, we observe that the introduction of the unsolicited block push for miners significantly reduces the stale block rate. This is the case since (i) miners are interconnected and profit most from the unsolicited block push, and (ii) the propagation method of the first node is crucial to reach the majority of the network rapidly. The addition of the relay network does not seem to affect the stale block rate significantly (given the Bitcoin's transaction load) compared to the unsolicited block push, and reduces the propagation time only marginally. For bigger block sizes however (e.g.  <span class="math">&amp;gt;2\\mathrm{MB}</span> ) the relay network indeed provides an advantage over the unsolicited block push (cf. Table 8). Moreover, the relay network provides an additional source of block information, in addition to the classical P2P overlay network. Notice that although the impact of the send header mechanisms compared to a fully deployed relay network and unsolicited block push is limited, this mechanism mitigates partial eclipse attacks [16].</p>

    <p class="text-gray-300">To assess the impact of the block interval on the security of PoW blockchains, we feed the resulting stale block rate into our MDP</p>

    <p class="text-gray-300">models as shown in Table 7. Our results show that, for an adversary equipped with  <span class="math">30\\%</span>  of the total mining power[11], the lower is the consensus time, the higher is the relative revenue from selfish mining and the lower is the double-spending value. We observe that the block propagation mechanism significantly impacts the security of the blockchain, since it directly affects the stale block rate. The standard block propagation mechanism offers less resilience (in terms of double-spending and selfish mining) than the other evaluated block propagation mechanisms. We also note that the double-spending value halves in Table 7 for the block propagation mechanism of Case 4 (which results in the lowest stale block rate when compared to the other investigated mechanisms) when reducing the block interval from 25 minutes to 0.5 seconds. Similarly, the relative revenue from selfish mining increases from 0.33 to 0.42.</p>

    <p class="text-gray-300">We now study the impact of the block size on the performance and security of the blockchain (cf. Table 8. To this end, we simulate block sizes ranging from  <span class="math">0.1\\mathrm{MB}</span>  to up to  <span class="math">8\\mathrm{MB}</span> , given a block interval of 10 minutes.</p>

    <p class="text-gray-300">Our results suggest that the block propagation time increases linearly with the block size up to  <span class="math">4\\mathrm{MB}</span> ; after  <span class="math">8\\mathrm{MB}</span>  blocks, the block propagation time and stale block rate increases exponentially. Second, we clearly see that a better block propagation mechanism significantly reduces the propagation times and the stale block rate.</p>

    <p class="text-gray-300">This also suggests, conforming with our MDP models, that the bigger the block size, the higher the relative revenue from selfish mining and the lower the double-spending value (cf. Table 8). It is however apparent that an efficient block propagation mechanism effectively allows the network to keep nearly the same security provisions against selfish mining and double-spending as we can see in Case 3 (standard propagation mechanism, unsolicited block push, relay network) and Case 4 (send headers propagation mechanism, unsolicited block push, relay network). This confirms that an efficient network propagation mechanism helps to increase the security of the blockchain. Interestingly, given the block propagation mechanism of Case 4, the resilience (in terms of double-spending value) does not significantly change in Table 8 when increasing the block size from  <span class="math">0.1\\mathrm{MB}</span>  to  <span class="math">8\\mathrm{MB}</span>  ( <span class="math">v_{d}</span>  changes from 12.9 to 12.68 block rewards respectively). Similarly, the relative revenue from selfish mining stays at  <span class="math">r_{rel} = 0.33</span> , when all miners use the relay network.</p>

    <p class="text-gray-300">Currently, a number of proposals suggest to chunk blocks and download these chunks in parallel (e.g., Blocktorrrent [35]). In a separate experiment that we conducted, we implemented a block propagation mechanisms that divides blocks into chunks of a few kilobytes that can be queried from multiple peers. Our results show that such a protocol does not improve the median block propagation time compared to the send headers and relay network protocol, when dealing with modest block sizes (i.e., smaller than 8 MB). This is due to the fact that a chunked block propagates slower than the  <span class="math">10^{th}</span>  and  <span class="math">25^{th}</span>  percentile of nodes owing to: (i) the communication overhead caused by the chunks, and (ii) because a node only forwards block chunks if the respective block has been validated.</p>

    <p class="text-gray-300">We now evaluate the throughput achieved by various blockchain instantiations. To this end, we vary the block size (from 0.1M B to 8 MB) and the block interval (from 0.5 seconds to 25 minutes) to capture a larger number of blockchain instances with our simulator. Here, we assume that the network relies on an efficient propagation</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Case 1</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Case 2</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Case 3</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Case 4</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

          </tr>

        </thead>

        <tbody>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">Block interval</td>

            <td class="px-3 py-2 border-b border-gray-700">tMBP</td>

            <td class="px-3 py-2 border-b border-gray-700">rs</td>

            <td class="px-3 py-2 border-b border-gray-700">v_d</td>

            <td class="px-3 py-2 border-b border-gray-700">rrel</td>

            <td class="px-3 py-2 border-b border-gray-700">tMBP</td>

            <td class="px-3 py-2 border-b border-gray-700">rs</td>

            <td class="px-3 py-2 border-b border-gray-700">v_d</td>

            <td class="px-3 py-2 border-b border-gray-700">rrel</td>

            <td class="px-3 py-2 border-b border-gray-700">tMBP</td>

            <td class="px-3 py-2 border-b border-gray-700">rs</td>

            <td class="px-3 py-2 border-b border-gray-700">v_d</td>

            <td class="px-3 py-2 border-b border-gray-700">rrel</td>

            <td class="px-3 py-2 border-b border-gray-700">tMBP</td>

            <td class="px-3 py-2 border-b border-gray-700">rs</td>

            <td class="px-3 py-2 border-b border-gray-700">v_d</td>

            <td class="px-3 py-2 border-b border-gray-700">rrel</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">25 minutes</td>

            <td class="px-3 py-2 border-b border-gray-700">35.73</td>

            <td class="px-3 py-2 border-b border-gray-700">1.72 %</td>

            <td class="px-3 py-2 border-b border-gray-700">12.47</td>

            <td class="px-3 py-2 border-b border-gray-700">0.34</td>

            <td class="px-3 py-2 border-b border-gray-700">25.66</td>

            <td class="px-3 py-2 border-b border-gray-700">0.16 %</td>

            <td class="px-3 py-2 border-b border-gray-700">12.86</td>

            <td class="px-3 py-2 border-b border-gray-700">0.33</td>

            <td class="px-3 py-2 border-b border-gray-700">22.50</td>

            <td class="px-3 py-2 border-b border-gray-700">0.03 %</td>

            <td class="px-3 py-2 border-b border-gray-700">12.89</td>

            <td class="px-3 py-2 border-b border-gray-700">0.33</td>

            <td class="px-3 py-2 border-b border-gray-700">22.44</td>

            <td class="px-3 py-2 border-b border-gray-700">0.02 %</td>

            <td class="px-3 py-2 border-b border-gray-700">12.89</td>

            <td class="px-3 py-2 border-b border-gray-700">0.33</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">10 minutes</td>

            <td class="px-3 py-2 border-b border-gray-700">14.7</td>

            <td class="px-3 py-2 border-b border-gray-700">1.51 %</td>

            <td class="px-3 py-2 border-b border-gray-700">12.52</td>

            <td class="px-3 py-2 border-b border-gray-700">0.34</td>

            <td class="px-3 py-2 border-b border-gray-700">10.65</td>

            <td class="px-3 py-2 border-b border-gray-700">0.13 %</td>

            <td class="px-3 py-2 border-b border-gray-700">12.88</td>

            <td class="px-3 py-2 border-b border-gray-700">0.33</td>

            <td class="px-3 py-2 border-b border-gray-700">9.41</td>

            <td class="px-3 py-2 border-b border-gray-700">0.14 %</td>

            <td class="px-3 py-2 border-b border-gray-700">12.86</td>

            <td class="px-3 py-2 border-b border-gray-700">0.33</td>

            <td class="px-3 py-2 border-b border-gray-700">9.18</td>

            <td class="px-3 py-2 border-b border-gray-700">0.13 %</td>

            <td class="px-3 py-2 border-b border-gray-700">12.87</td>

            <td class="px-3 py-2 border-b border-gray-700">0.33</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">2.5 minutes</td>

            <td class="px-3 py-2 border-b border-gray-700">4.18</td>

            <td class="px-3 py-2 border-b border-gray-700">1.82 %</td>

            <td class="px-3 py-2 border-b border-gray-700">12.45</td>

            <td class="px-3 py-2 border-b border-gray-700">0.34</td>

            <td class="px-3 py-2 border-b border-gray-700">2.91</td>

            <td class="px-3 py-2 border-b border-gray-700">0.16 %</td>

            <td class="px-3 py-2 border-b border-gray-700">12.86</td>

            <td class="px-3 py-2 border-b border-gray-700">0.33</td>

            <td class="px-3 py-2 border-b border-gray-700">2.60</td>

            <td class="px-3 py-2 border-b border-gray-700">0.16 %</td>

            <td class="px-3 py-2 border-b border-gray-700">12.86</td>

            <td class="px-3 py-2 border-b border-gray-700">0.33</td>

            <td class="px-3 py-2 border-b border-gray-700">2.59</td>

            <td class="px-3 py-2 border-b border-gray-700">0.15 %</td>

            <td class="px-3 py-2 border-b border-gray-700">12.86</td>

            <td class="px-3 py-2 border-b border-gray-700">0.33</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">1 minute</td>

            <td class="px-3 py-2 border-b border-gray-700">2.08</td>

            <td class="px-3 py-2 border-b border-gray-700">2.15 %</td>

            <td class="px-3 py-2 border-b border-gray-700">12.35</td>

            <td class="px-3 py-2 border-b border-gray-700">0.34</td>

            <td class="px-3 py-2 border-b border-gray-700">1.34</td>

            <td class="px-3 py-2 border-b border-gray-700">0.35 %</td>

            <td class="px-3 py-2 border-b border-gray-700">12.81</td>

            <td class="px-3 py-2 border-b border-gray-700">0.33</td>

            <td class="px-3 py-2 border-b border-gray-700">1.30</td>

            <td class="px-3 py-2 border-b border-gray-700">0.25 %</td>

            <td class="px-3 py-2 border-b border-gray-700">12.83</td>

            <td class="px-3 py-2 border-b border-gray-700">0.33</td>

            <td class="px-3 py-2 border-b border-gray-700">1.27</td>

            <td class="px-3 py-2 border-b border-gray-700">0.29 %</td>

            <td class="px-3 py-2 border-b border-gray-700">12.77</td>

            <td class="px-3 py-2 border-b border-gray-700">0.33</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">30 seconds</td>

            <td class="px-3 py-2 border-b border-gray-700">1.43</td>

            <td class="px-3 py-2 border-b border-gray-700">2.54 %</td>

            <td class="px-3 py-2 border-b border-gray-700">12.06</td>

            <td class="px-3 py-2 border-b border-gray-700">0.34</td>

            <td class="px-3 py-2 border-b border-gray-700">0.84</td>

            <td class="px-3 py-2 border-b border-gray-700">0.45 %</td>

            <td class="px-3 py-2 border-b border-gray-700">12.78</td>

            <td class="px-3 py-2 border-b border-gray-700">0.33</td>

            <td class="px-3 py-2 border-b border-gray-700">0.84</td>

            <td class="px-3 py-2 border-b border-gray-700">0.51 %</td>

            <td class="px-3 py-2 border-b border-gray-700">12.77</td>

            <td class="px-3 py-2 border-b border-gray-700">0.33</td>

            <td class="px-3 py-2 border-b border-gray-700">0.84</td>

            <td class="px-3 py-2 border-b border-gray-700">0.52 %</td>

            <td class="px-3 py-2 border-b border-gray-700">12.69</td>

            <td class="px-3 py-2 border-b border-gray-700">0.33</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">20 seconds</td>

            <td class="px-3 py-2 border-b border-gray-700">1.21</td>

            <td class="px-3 py-2 border-b border-gray-700">3.20 %</td>

            <td class="px-3 py-2 border-b border-gray-700">11.73</td>

            <td class="px-3 py-2 border-b border-gray-700">0.34</td>

            <td class="px-3 py-2 border-b border-gray-700">0.67</td>

            <td class="px-3 py-2 border-b border-gray-700">0.86 %</td>

            <td class="px-3 py-2 border-b border-gray-700">12.68</td>

            <td class="px-3 py-2 border-b border-gray-700">0.33</td>

            <td class="px-3 py-2 border-b border-gray-700">0.69</td>

            <td class="px-3 py-2 border-b border-gray-700">0.85 %</td>

            <td class="px-3 py-2 border-b border-gray-700">12.68</td>

            <td class="px-3 py-2 border-b border-gray-700">0.33</td>

            <td class="px-3 py-2 border-b border-gray-700">0.68</td>

            <td class="px-3 py-2 border-b border-gray-700">0.82 %</td>

            <td class="px-3 py-2 border-b border-gray-700">12.68</td>

            <td class="px-3 py-2 border-b border-gray-700">0.33</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">10 seconds</td>

            <td class="px-3 py-2 border-b border-gray-700">1.00</td>

            <td class="px-3 py-2 border-b border-gray-700">4.77 %</td>

            <td class="px-3 py-2 border-b border-gray-700">10.73</td>

            <td class="px-3 py-2 border-b border-gray-700">0.35</td>

            <td class="px-3 py-2 border-b border-gray-700">0.35</td>

            <td class="px-3 py-2 border-b border-gray-700">1.73 %</td>

            <td class="px-3 py-2 border-b border-gray-700">12.46</td>

            <td class="px-3 py-2 border-b border-gray-700">0.34</td>

            <td class="px-3 py-2 border-b border-gray-700">0.33</td>

            <td class="px-3 py-2 border-b border-gray-700">1.41 %</td>

            <td class="px-3 py-2 border-b border-gray-700">12.54</td>

            <td class="px-3 py-2 border-b border-gray-700">0.34</td>

            <td class="px-3 py-2 border-b border-gray-700">0.53</td>

            <td class="px-3 py-2 border-b border-gray-700">1.59 %</td>

            <td class="px-3 py-2 border-b border-gray-700">12.50</td>

            <td class="px-3 py-2 border-b border-gray-700">0.34</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">5 seconds</td>

            <td class="px-3 py-2 border-b border-gray-700">0.89</td>

            <td class="px-3 py-2 border-b border-gray-700">8.64 %</td>

            <td class="px-3 py-2 border-b border-gray-700">10.08</td>

            <td class="px-3 py-2 border-b border-gray-700">0.37</td>

            <td class="px-3 py-2 border-b border-gray-700">0.37</td>

            <td class="px-3 py-2 border-b border-gray-700">2.94 %</td>

            <td class="px-3 py-2 border-b border-gray-700">11.85</td>

            <td class="px-3 py-2 border-b border-gray-700">0.34</td>

            <td class="px-3 py-2 border-b border-gray-700">0.45</td>

            <td class="px-3 py-2 border-b border-gray-700">2.99 %</td>

            <td class="px-3 py-2 border-b border-gray-700">11.80</td>

            <td class="px-3 py-2 border-b border-gray-700">0.34</td>

            <td class="px-3 py-2 border-b border-gray-700">0.44</td>

            <td class="px-3 py-2 border-b border-gray-700">3.05 %</td>

            <td class="px-3 py-2 border-b border-gray-700">11.78</td>

            <td class="px-3 py-2 border-b border-gray-700">0.34</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">2 seconds</td>

            <td class="px-3 py-2 border-b border-gray-700">0.84</td>

            <td class="px-3 py-2 border-b border-gray-700">16.65 %</td>

            <td class="px-3 py-2 border-b border-gray-700">7.35</td>

            <td class="px-3 py-2 border-b border-gray-700">0.41</td>

            <td class="px-3 py-2 border-b border-gray-700">0.40</td>

            <td class="px-3 py-2 border-b border-gray-700">6.98 %</td>

            <td class="px-3 py-2 border-b border-gray-700">10.47</td>

            <td class="px-3 py-2 border-b border-gray-700">0.36</td>

            <td class="px-3 py-2 border-b border-gray-700">0.39</td>

            <td class="px-3 py-2 border-b border-gray-700">7.28 %</td>

            <td class="px-3 py-2 border-b border-gray-700">10.37</td>

            <td class="px-3 py-2 border-b border-gray-700">0.36</td>

            <td class="px-3 py-2 border-b border-gray-700">0.38</td>

            <td class="px-3 py-2 border-b border-gray-700">7.10 %</td>

            <td class="px-3 py-2 border-b border-gray-700">10.42</td>

            <td class="px-3 py-2 border-b border-gray-700">0.36</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">1 seconds</td>

            <td class="px-3 py-2 border-b border-gray-700">0.82</td>

            <td class="px-3 py-2 border-b border-gray-700">26.74 %</td>

            <td class="px-3 py-2 border-b border-gray-700">4.37</td>

            <td class="px-3 py-2 border-b border-gray-700">0.53</td>

            <td class="px-3 py-2 border-b border-gray-700">0.53</td>

            <td class="px-3 py-2 border-b border-gray-700">12.44 %</td>

            <td class="px-3 py-2 border-b border-gray-700">8.34</td>

            <td class="px-3 py-2 border-b border-gray-700">0.39</td>

            <td class="px-3 py-2 border-b border-gray-700">0.38</td>

            <td class="px-3 py-2 border-b border-gray-700">12.59 %</td>

            <td class="px-3 py-2 border-b border-gray-700">8.24</td>

            <td class="px-3 py-2 border-b border-gray-700">0.39</td>

            <td class="px-3 py-2 border-b border-gray-700">0.37</td>

            <td class="px-3 py-2 border-b border-gray-700">12.52 %</td>

            <td class="px-3 py-2 border-b border-gray-700">8.30</td>

            <td class="px-3 py-2 border-b border-gray-700">0.39</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">0.5 seconds</td>

            <td class="px-3 py-2 border-b border-gray-700">0.82</td>

            <td class="px-3 py-2 border-b border-gray-700">38.15 %</td>

            <td class="px-3 py-2 border-b border-gray-700">2.78</td>

            <td class="px-3 py-2 border-b border-gray-700">0.60</td>

            <td class="px-3 py-2 border-b border-gray-700">0.61</td>

            <td class="px-3 py-2 border-b border-gray-700">20.62 %</td>

            <td class="px-3 py-2 border-b border-gray-700">6.22</td>

            <td class="px-3 py-2 border-b border-gray-700">0.42</td>

            <td class="px-3 py-2 border-b border-gray-700">0.49</td>

            <td class="px-3 py-2 border-b border-gray-700">20.87 %</td>

            <td class="px-3 py-2 border-b border-gray-700">6.16</td>

            <td class="px-3 py-2 border-b border-gray-700">0.42</td>

            <td class="px-3 py-2 border-b border-gray-700">0.36</td>

            <td class="px-3 py-2 border-b border-gray-700">21.10 %</td>

            <td class="px-3 py-2 border-b border-gray-700">6.02</td>

            <td class="px-3 py-2 border-b border-gray-700">0.42</td>

          </tr>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">Table 7: Impact of the block interval on the median block propagation time ( <span class="math">t_{MBP}</span> ) in seconds, and the stale block rate  <span class="math">r_s</span> ,  <span class="math">v_d</span>  and  <span class="math">r_{rel}</span>  given the current Bitcoin block size distribution, an adversary with  <span class="math">\\alpha = 0.3</span>  and  <span class="math">k = 6</span> . Case 1 refers to the standard block propagation mechanism, Case 2 refers to standard mechanism plus unsolicited block push, Case 3 to the combination of Case 2 plus the relay network and Case 4 to the send headers with unsolicited block push and relay network.</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Case 1</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Case 2</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Case 3</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Case 4</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

          </tr>

        </thead>

        <tbody>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">Block Size</td>

            <td class="px-3 py-2 border-b border-gray-700">tMBP</td>

            <td class="px-3 py-2 border-b border-gray-700">rs</td>

            <td class="px-3 py-2 border-b border-gray-700">v_d</td>

            <td class="px-3 py-2 border-b border-gray-700">rrel</td>

            <td class="px-3 py-2 border-b border-gray-700">tMBP</td>

            <td class="px-3 py-2 border-b border-gray-700">rs</td>

            <td class="px-3 py-2 border-b border-gray-700">v_d</td>

            <td class="px-3 py-2 border-b border-gray-700">rrel</td>

            <td class="px-3 py-2 border-b border-gray-700">tMBP</td>

            <td class="px-3 py-2 border-b border-gray-700">rs</td>

            <td class="px-3 py-2 border-b border-gray-700">v_d</td>

            <td class="px-3 py-2 border-b border-gray-700">rrel</td>

            <td class="px-3 py-2 border-b border-gray-700">tMBP</td>

            <td class="px-3 py-2 border-b border-gray-700">rs</td>

            <td class="px-3 py-2 border-b border-gray-700">v_d</td>

            <td class="px-3 py-2 border-b border-gray-700">rrel</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">0.1 MB</td>

            <td class="px-3 py-2 border-b border-gray-700">3.18</td>

            <td class="px-3 py-2 border-b border-gray-700">0.32 %</td>

            <td class="px-3 py-2 border-b border-gray-700">12.80</td>

            <td class="px-3 py-2 border-b border-gray-700">0.33</td>

            <td class="px-3 py-2 border-b border-gray-700">2.12</td>

            <td class="px-3 py-2 border-b border-gray-700">0.03 %</td>

            <td class="px-3 py-2 border-b border-gray-700">12.89</td>

            <td class="px-3 py-2 border-b border-gray-700">0.33</td>

            <td class="px-3 py-2 border-b border-gray-700">2.02</td>

            <td class="px-3 py-2 border-b border-gray-700">0.03 %</td>

            <td class="px-3 py-2 border-b border-gray-700">12.89</td>

            <td class="px-3 py-2 border-b border-gray-700">0.33</td>

            <td class="px-3 py-2 border-b border-gray-700">2.02</td>

            <td class="px-3 py-2 border-b border-gray-700">0.2 %</td>

            <td class="px-3 py-2 border-b border-gray-700">12.90</td>

            <td class="px-3 py-2 border-b border-gray-700">0.33</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">0.25 MB</td>

            <td class="px-3 py-2 border-b border-gray-700">7.03</td>

            <td class="px-3 py-2 border-b border-gray-700">0.88 %</td>

            <td class="px-3 py-2 border-b border-gray-700">12.67</td>

            <td class="px-3 py-2 border-b border-gray-700">0.33</td>

            <td class="px-3 py-2 border-b border-gray-700">4.93</td>

            <td class="px-3 py-2 border-b border-gray-700">0.11 %</td>

            <td class="px-3 py-2 border-b border-gray-700">12.87</td>

            <td class="px-3 py-2 border-b border-gray-700">0.33</td>

            <td class="px-3 py-2 border-b border-gray-700">4.49</td>

            <td class="px-3 py-2 border-b border-gray-700">0.05 %</td>

            <td class="px-3 py-2 border-b border-gray-700">12.88</td>

            <td class="px-3 py-2 border-b border-gray-700">0.33</td>

            <td class="px-3 py-2 border-b border-gray-700">4.46</td>

            <td class="px-3 py-2 border-b border-gray-700">0.17 %</td>

            <td class="px-3 py-2 border-b border-gray-700">12.87</td>

            <td class="px-3 py-2 border-b border-gray-700">0.33</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">0.5 MB</td>

            <td class="px-3 py-2 border-b border-gray-700">13.62</td>

            <td class="px-3 py-2 border-b border-gray-700">1.63 %</td>

            <td class="px-3 py-2 border-b border-gray-700">12.48</td>

            <td class="px-3 py-2 border-b border-gray-700">0.34</td>

            <td class="px-3 py-2 border-b border-gray-700">9.84</td>

            <td class="px-3 py-2 border-b border-gray-700">0.13 %</td>

            <td class="px-3 py-2 border-b border-gray-700">12.87</td>

            <td class="px-3 py-2 border-b border-gray-700">0.33</td>

            <td class="px-3 py-2 border-b border-gray-700">8.65</td>

            <td class="px-3 py-2 border-b border-gray-700">0.05 %</td>

            <td class="px-3 py-2 border-b border-gray-700">12.88</td>

            <td class="px-3 py-2 border-b border-gray-700">0.33</td>

            <td class="px-3 py-2 border-b border-gray-700">8.64</td>

            <td class="px-3 py-2 border-b border-gray-700">0.06 %</td>

            <td class="px-3 py-2 border-b border-gray-700">12.87</td>

            <td class="px-3 py-2 border-b border-gray-700">0.33</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">1 MB</td>

            <td class="px-3 py-2 border-b border-gray-700">27.67</td>

            <td class="px-3 py-2 border-b border-gray-700">3.17 %</td>

            <td class="px-3 py-2 border-b border-gray-700">11.79</td>

            <td class="px-3 py-2 border-b border-gray-700">0.34</td>

            <td class="px-3 py-2 border-b border-gray-700">20.01</td>

            <td class="px-3 py-2 border-b border-gray-700">0.38 %</td>

            <td class="px-3 py-2 border-b border-gray-700">12.79</td>

            <td class="px-3 py-2 border-b border-gray-700">0.33</td>

            <td class="px-3 py-2 border-b border-gray-700">17.24</td>

            <td class="px-3 py-2 border-b border-gray-700">0.07 %</td>

            <td class="px-3 py-2 border-b border-gray-700">12.88</td>

            <td class="px-3 py-2 border-b border-gray-700">0.33</td>

            <td class="px-3 py-2 border-b border-gray-700">17.14</td>

            <td class="px-3 py-2 border-b border-gray-700">0.07 %</td>

            <td class="px-3 py-2 border-b border-gray-700">12.88</td>

            <td class="px-3 py-2 border-b border-gray-700">0.33</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">2 MB</td>

            <td class="px-3 py-2 border-b border-gray-700">57.79</td>

            <td class="px-3 py-2 border-b border-gray-700">6.24 %</td>

            <td class="px-3 py-2 border-b border-gray-700">10.57</td>

            <td class="px-3 py-2 border-b border-gray-700">0.36</td>

            <td class="px-3 py-2 border-b border-gray-700">44.6</td>

            <td class="px-3 py-2 border-b border-gray-700">1.12 %</td>

            <td class="px-3 py-2 border-b border-gray-700">12.61</td>

            <td class="px-3 py-2 border-b border-gray-700">0.34</td>

            <td class="px-3 py-2 border-b border-gray-700">35.49</td>

            <td class="px-3 py-2 border-b border-gray-700">0.08 %</td>

            <td class="px-3 py-2 border-b border-gray-700">12.87</td>

            <td class="px-3 py-2 border-b border-gray-700">0.33</td>

            <td class="px-3 py-2 border-b border-gray-700">35.38</td>

            <td class="px-3 py-2 border-b border-gray-700">0.1 %</td>

            <td class="px-3 py-2 border-b border-gray-700">12.86</td>

            <td class="px-3 py-2 border-b border-gray-700">0.33</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">4 MB</td>

            <td class="px-3 py-2 border-b border-gray-700">133.30</td>

            <td class="px-3 py-2 border-b border-gray-700">11.85 %</td>

            <td class="px-3 py-2 border-b border-gray-700">8.20</td>

            <td class="px-3 py-2 border-b border-gray-700">0.38</td>

            <td class="px-3 py-2 border-b border-gray-700">126.57</td>

            <td class="px-3 py-2 border-b border-gray-700">5.46 %</td>

            <td class="px-3 py-2 border-b border-gray-700">10.51</td>

            <td class="px-3 py-2 border-b border-gray-700">0.35</td>

            <td class="px-3 py-2 border-b border-gray-700">78.01</td>

            <td class="px-3 py-2 border-b border-gray-700">0.12 %</td>

            <td class="px-3 py-2 border-b border-gray-700">12.85</td>

            <td class="px-3 py-2 border-b border-gray-700">0.33</td>

            <td class="px-3 py-2 border-b border-gray-700">78.40</td>

            <td class="px-3 py-2 border-b border-gray-700">0.13 %</td>

            <td class="px-3 py-2 border-b border-gray-700">12.66</td>

            <td class="px-3 py-2 border-b border-gray-700">0.33</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">8 MB</td>

            <td class="px-3 py-2 border-b border-gray-700">571.50</td>

            <td class="px-3 py-2 border-b border-gray-700">29.97 %</td>

            <td class="px-3 py-2 border-b border-gray-700">4.11</td>

            <td class="px-3 py-2 border-b border-gray-700">0.53</td>

            <td class="px-3 py-2 border-b border-gray-700">875.97</td>

            <td class="px-3 py-2 border-b border-gray-700">15.64 %</td>

            <td class="px-3 py-2 border-b border-gray-700">7.64</td>

            <td class="px-3 py-2 border-b border-gray-700">0.41</td>

            <td class="px-3 py-2 border-b border-gray-700">555.49</td>

            <td class="px-3 py-2 border-b border-gray-700">0.43 %</td>

            <td class="px-3 py-2 border-b border-gray-700">12.65</td>

            <td class="px-3 py-2 border-b border-gray-700">0.33</td>

            <td class="px-3 py-2 border-b border-gray-700">550.25</td>

            <td class="px-3 py-2 border-b border-gray-700">0.4 %</td>

            <td class="px-3 py-2 border-b border-gray-700">12.68</td>

            <td class="px-3 py-2 border-b border-gray-700">0.33</td>

          </tr>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">Table 8: Impact of the block size on the median block propagation time ( <span class="math">t_{MBP}</span> ) in seconds, the stale block rate  <span class="math">r_s</span> ,  <span class="math">v_d</span>  and  <span class="math">r_{rel}</span> , given the current Bitcoin block generation interval and an adversary with  <span class="math">\\alpha = 0.3</span>  and  <span class="math">k = 6</span> .</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">tps</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\( v_d \\)</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\( r_{rel} \\)</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Block size</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Block interval</th>

          </tr>

        </thead>

        <tbody>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">33.4</td>

            <td class="px-3 py-2 border-b border-gray-700">12.75</td>

            <td class="px-3 py-2 border-b border-gray-700">0.33</td>

            <td class="px-3 py-2 border-b border-gray-700">0.25MB</td>

            <td class="px-3 py-2 border-b border-gray-700">30 seconds</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">40</td>

            <td class="px-3 py-2 border-b border-gray-700">12.38</td>

            <td class="px-3 py-2 border-b border-gray-700">0.34</td>

            <td class="px-3 py-2 border-b border-gray-700">0.10MB</td>

            <td class="px-3 py-2 border-b border-gray-700">10 seconds</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">50</td>

            <td class="px-3 py-2 border-b border-gray-700">12.45</td>

            <td class="px-3 py-2 border-b border-gray-700">0.34</td>

            <td class="px-3 py-2 border-b border-gray-700">0.25MB</td>

            <td class="px-3 py-2 border-b border-gray-700">20 seconds</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">66.7</td>

            <td class="px-3 py-2 border-b border-gray-700">12.06</td>

            <td class="px-3 py-2 border-b border-gray-700">0.34</td>

            <td class="px-3 py-2 border-b border-gray-700">0.25MB</td>

            <td class="px-3 py-2 border-b border-gray-700">15 seconds</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">66.7</td>

            <td class="px-3 py-2 border-b border-gray-700">12.65</td>

            <td class="px-3 py-2 border-b border-gray-700">0.33</td>

            <td class="px-3 py-2 border-b border-gray-700">0.50MB</td>

            <td class="px-3 py-2 border-b border-gray-700">30 seconds</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">66.7</td>

            <td class="px-3 py-2 border-b border-gray-700">12.71</td>

            <td class="px-3 py-2 border-b border-gray-700">0.33</td>

            <td class="px-3 py-2 border-b border-gray-700">1.00MB</td>

            <td class="px-3 py-2 border-b border-gray-700">1 minute</td>

          </tr>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">Table 9: Throughput in transactions per second (tps) vs. security measured in  <span class="math">v_{d}</span>  and  <span class="math">r_{rel}</span>  for an adversary with  <span class="math">30\\%</span>  mining power,  <span class="math">k = 6</span>  and given 16 mining pools.</p>

    <p class="text-gray-300">mechanism (send headers with unsolicited block push and relay network for all miners). For each simulated blockchain instance, we compute the resulting throughput in transactions per second (tps), measure the stale block rate and infer  <span class="math">v_{d}</span>  and  <span class="math">r_{rel}</span>  in order to assess the blockchain's security with our MDP model (cf. Section 3). We also assume an average transaction size of 250 bytes,  <span class="math">k = 6</span>  confirmations against double-spending and an adversary with 0.3 mining power and  <span class="math">\\gamma = 0.5</span> .</p>

    <p class="text-gray-300">In Table 9, we selectively list candidate blockchain instances which could achieve a transactional throughput beyond 60 tps and achieve similar security provisions to the existing Bitcoin system. Clearly, our results indicate that different parameter configurations can yield the same throughput—though with different security provisions (due to a different stale block rate). In particular, we observe that low consensus intervals offer less security compared to a higher consensus interval given the same overall throughput, since the network requires more round trips in order to commit the same information to the blockchain. Our results show that there is considerable room to enhance the scalability of existing PoW without significantly compromising security.</p>

    <p class="text-gray-300">A number of contributions analyze double-spending attacks in Bitcoin [15, 30]) but they do not consider optimal adversarial strategies.</p>

    <p class="text-gray-300">Eyal and Sirer [14] show that a selfish miner can increase its relative mining revenue by not directly publishing his blocks. Similarly, Courtois and Bahack [7] study subversive mining strategies. Our work shares similarities with Sapirshtein et al. [31]. Here, the authors devise optimal adversarial strategies for selfish mining in Bitcoin. Unlike [31], our work however captures optimal adversarial selfish mining strategies for PoW-powered blockchain and takes into account network delays and eclipse attacks. We additionally capture optimal double-spending strategies—where we also take into account the mining costs of the adversary, the number of required block confirmations, and the double-spending value in order to properly account for costs of the attack.</p>

    <p class="text-gray-300">GHOST [33] is an alternative to the longest chain rule for establishing consensus in PoW based blockchains and aims to alleviate the negative impacts of stale blocks. Many PoW alternatives have been proposed. In Proof of Stake (PoS) [29], the voting power of peers is based on the amount of "stake" they own in the respective blockchain system. Proof of Burn (PoB) is a proposal to replace PoW by burning transaction outputs, such that they can no longer be spent. Existing PoB-based blockchains however rely on PoW in order to create blocks and therefore ultimately rely on PoW for coin creation. Proof of Capacity (PoC), aims to use the available hard-disk space in order to replace PoW. Bitcoin-NG [13] performs leader election of PoW—allowing the leader to sign micro-blocks until a new leader is elected. The literature features a number of additional proposals [19, 23, 25, 37] that rely on classical Byzantine fault tolerant consensus protocols in the hope to increase the consensus efficiency and achieve high transactional throughput. Recent studies propose to combine the use of PoW with BFT protocols to realize highly-performant open consensus protocols (Byzcoin [24]).</p>

    <h2 id="sec-28" class="text-2xl font-bold">6 Concluding Remarks</h2>

    <p class="text-gray-300">In this work, we introduced a novel quantitative framework to objectively compare PoW blockchains given real world network impacts and blockchain parameters. Our framework enables us to evaluate the impact of network-layer parameters on the security of PoW-based blockchain. By doing so, we show how to objectively compare the security provisions of different PoW blockchain instances. Namely, our framework allows us to push the boundaries of PoW powered blockchains in terms of throughput in transactions per second, while observing the impact on the security provisions of the blockchain in terms of optimal selfish mining and double spending strategies.</p>

    <p class="text-gray-300">For instance, we find that Ethereum needs at least 37 block confirmations in order to match Bitcoin’s security with 6 block confirmations, given an adversary with 30% of the total mining power. Our results indirectly suggest that Bitcoin’s blockchain offers more security than Ethereum’s blockchain which rewards miners with uncle rewards and performs uniform tie breaking for blockchain fork resolutions. Our results additionally indicate that existing PoW blockchains can achieve a throughput of 60 transactions per second—without significantly affecting the blockchain’s security. To the best of our knowledge, this is the first contribution that quantitatively evaluates the impact of the stale block rate on optimal double-spending and selfish mining resistance of a PoW blockchain (cf. Figure 7 and Figure 3). By doing so, our results quantitatively capture the security of transactions based on their values, and on the block confirmations—effectively quantifying the level of security achieved by the famous required six block confirmations in Bitcoin.</p>

    <p class="text-gray-300">Our insights do not only allow merchants to take into account the security provisions when accepting transactions and to assess their respective risk of double-spending, but also help miners in quantifying a PoW blockchain’s resilience against selfish mining.</p>

    <h2 id="sec-29" class="text-2xl font-bold">References</h2>

    <ul class="list-disc list-inside space-y-1 text-gray-300 my-2 ml-4">

      <li>[1] Bitcoin block size limit controversy, 2016. Available from: https://en.bitcoin.it/wiki/Block_size_limit_controversy.</li>

      <li>[2] Frederik Armknecht, Jens-Matthias Bohli, Ghassan O Karame, Zongren Liu, and Christian A Reuter. Outsourced proofs of retrievability. In Proceedings of the 2014 ACM SIGSAC Conference on Computer and Communications Security, pages 831–843. ACM, 2014.</li>

      <li>[3] Bitnodes. Bitnodes ip crawler. Available from: https://github.com/ayeowch/bitnodes.</li>

      <li>[4] V. Buterin. A next-generation smart contract and decentralized application platform, 2014.</li>

      <li>[5] Miguel Castro, Barbara Liskov, et al. Practical byzantine fault tolerance. In OSDI, volume 99, pages 173–186, 1999.</li>

      <li>[6] Matt Corallo. Bitcoin relay network. Available from: http://bitcoinrelaynetwork.org/.</li>

      <li>[7] Nicolas T. Courtois and Lear Bahack. On subversive miner strategies and block withholding attack in bitcoin digital currency. CoRR, abs/1402.1718, 2014.</li>

      <li>[8] Kyle Croman, Christian Decker, Ittay Eyal, Adem Efe Gencer, Ari Juels, Ahmed Kosba, Andrew Miller, Prateek Saxena, Elaine Shi, and Emin Gün. On scaling decentralized blockchains.</li>

      <li>[9] C. Decker and R. Wattenhofer. Information Propagation in the Bitcoin Network. In 13-th IEEE International Conference on Peer-to-Peer Computing, 2013.</li>

      <li>[10] Ethereum. Ethereum tie breaking. Available from: https://github.com/ethereum/go-ethereum/commit/bcf565730b1816304947021080981245d084a930.</li>

      <li>[11] Ethereum. ethernodes. Available from: https://www.ethernodes.org/network/1.</li>

      <li>[12] Ethereum. ethstats. Available from: https://ethstats.net/.</li>

      <li>[13] Ittay Eyal, Adem Efe Gencer, Emin Gun Sirer, and Robbert van Renesse. Bitcoin-ng: A scalable blockchain protocol. arXiv preprint arXiv:1510.02037, 2015.</li>

      <li>[14] Ittay Eyal and Emin Gün Sirer. Majority is not enough: Bitcoin mining is vulnerable. In Financial Cryptography and Data Security, pages 436–454. Springer, 2014.</li>

      <li>[15] The Finney Attack, 2013. Available from: https://en.bitcoin.it/wiki/Weaknesses#The_.22Finney.22_attack.</li>

      <li>[16] Arthur Gervais, Hubert Ritzdorf, Ghassan O Karame, and Srdjan Capkun. Tampering with the delivery of blocks and transactions in bitcoin. In Proceedings of the 22nd ACM SIGSAC Conference on Computer and Communications Security, pages 692–705. ACM, 2015.</li>

      <li>[17] E. Heilman, A. Kendler, A. Zohar, and S. Goldberg. Eclipse attacks on bitcoin’s peer-to-peer network. 2015.</li>

      <li>[18] Ronald A Howard. Dynamic Probabilistic Systems, Volume I: Markov Models, volume 1. Courier Corporation, 2012.</li>

      <li>[19] IBM. Ibm openblockchain. Available from: http://www.ibm.com/blockchain/.</li>

      <li>[20] Intel. Proof of elapsed time (poet). Available from: http://intelledger.github.io/.</li>

      <li>[21] Ghassan O. Karame, Elli Androulaki, and Srdjan Capkun. Double-spending fast payments in bitcoin. In Proceedings of the 2012 ACM conference on Computer and communications security, CCS ’12, New York, NY, USA, 2012. ACM.</li>

      <li>[22] John G Kemeny, J Laurie Snell, and Gerald L Thompson. Finite mathematics. DC Murdoch, Linear Algebra for Undergraduates, 1974.</li>

      <li>[23] Eleftherios Kokoris-Kogias, Philipp Jovanovic, Nicolas Gailly, Ismail Khoffi, Linus Gasser, and Bryan Ford. Enhancing bitcoin security and performance with strong consistency via collective signing. arXiv preprint arXiv:1602.06997, 2016.</li>

      <li>[24] Eleftherios Kokoris-Kogias, Philipp Jovanovic, Nicolas Gailly, Ismail Khoffi, Linus Gasser, and Bryan Ford. Enhancing bitcoin security and performance with strong consistency via collective signing. CoRR, abs/1602.06997, 2016.</li>

      <li>[25] D. Mazieres. The stellar consensus protocol: A federated model for internet-level consensus. Available from: https://www.stellar.org/papers/stellar-consensus-protocol.pdf.</li>

      <li>[26] Andrew Miller, James Litton, Andrew Pachulski, Neal Gupta, Dave Levin, Neil Spring, and Bobby Bhattacharjee. Discovering bitcoin’s public topology and influential nodes.</li>

      <li>[27] S. Nakamoto. Bitcoin: A p2p electronic cash system, 2009.</li>

      <li>[28] Kartik Nayak, Srijan Kumar, Andrew Miller, and Elaine Shi. Stubborn mining: Generalizing selfish mining and combining with an eclipse attack. Technical report, IACR Cryptology ePrint Archive 2015, 2015.</li>

      <li>[29] QuantumMechanic. Proof of stake. Available from: https://bitcointalk.org/index.php?topic=27787.0.</li>

      <li>[30] Meni Rosenfeld. Analysis of hashrate-based double spending. arXiv preprint arXiv:1402.2009, 2014.</li>

      <li>[31] Ayelet Sapirshtein, Yonatan Sompolinsky, and Aviv Zohar. Optimal selfish mining strategies in bitcoin. arXiv preprint arXiv:1507.06183, 2015.</li>

      <li>[32] Yonatan Sompolinsky and Aviv Zohar. Accelerating bitcoin’s transaction processing. fast money grows on trees, not chains. IACR Cryptology ePrint Archive, 2013:881, 2013.</li>

      <li>[33] Yonatan Sompolinsky and Aviv Zohar. Secure high-rate transaction processing in bitcoin. In Financial Cryptography and Data Security, pages 507–527. Springer, 2015.</li>

      <li>[34] testmy.net. testmy.net. Available from: http://testmy.net/country.</li>

      <li>[35] Jonathan Toomim. blocktorrent. Available from: http://lists.linuxfoundation.org/pipermail/bitcoin-dev/2015-September/011176.html.</li>

      <li>[36] Verizon. Verizon latency. Available from: http://www.verizonenterprise.com/about/network/latency/.</li>

      <li>[37] Marko Vukolic. The quest for scalable blockchain fabric: Proof-of-work vs. bft replication. In Proceedings of the IFIP WG 11.4 Workshop iNetSec 2015. 2015.</li>

    </ul>`;
---

<BaseLayout title="On the Security and Performance of Proof of Work Blockchains (2016/555)">
  <article class="max-w-4xl mx-auto article-prose">
    <nav class="mb-8">
      <a href="/papers" class="text-blue-400 hover:text-blue-300">
        &larr; Back to Papers
      </a>
    </nav>

    <header class="mb-12">
      <h1 class="text-3xl font-bold mb-4"
        set:html={TITLE_HTML} />
      <p class="text-gray-400 mb-2"
        set:html={AUTHORS_HTML} />
      <p class="text-gray-500 text-sm mb-4">
        2016 &middot; eprint 2016/555
      </p>
      <div class="flex gap-4 text-sm">
        <a
          href={EPRINT_URL}
          target="_blank"
          rel="noopener noreferrer"
          class="text-blue-400 hover:text-blue-300"
        >
          Paper (eprint) &rarr;
        </a>
      </div>
      <p class="mt-4 text-xs text-gray-500">
        All content below belongs to the original authors. This page
        reproduces the paper for educational purposes. Always
        <a
          href={EPRINT_URL}
          target="_blank"
          rel="noopener noreferrer"
          class="text-blue-400 hover:text-blue-300"
        >cite the original</a>.
      </p>
      <p class="mt-1 text-xs text-gray-600">
        Converted with: {CRAWLER} &middot; {CONVERTED_DATE}
      </p>
    </header>

    <Fragment set:html={CONTENT} />

  </article>
</BaseLayout>
