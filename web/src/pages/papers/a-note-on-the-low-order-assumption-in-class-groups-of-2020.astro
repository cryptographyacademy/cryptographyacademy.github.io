---
import BaseLayout from '../../layouts/BaseLayout.astro';

const EPRINT_URL = 'https://eprint.iacr.org/2020/1310';
const CRAWLER = 'mistral';
const CONVERTED_DATE = '2026-02-16';
const TITLE_HTML = 'A note on the low order assumption in class groups of imaginary quadratic number fields';
const AUTHORS_HTML = 'Karim Belabas, Thorsten Kleinjung, Antonio Sanso, Benjamin Wesolowski';

const CONTENT = `    <p class="text-gray-300">Mathematical Cryptology, 1(1): 1-8</p>

    <p class="text-gray-300">Karim Belabas<span class="math">^{1}</span>, Thorsten Kleinjung<span class="math">^{2}</span>, Antonio Sanso<span class="math">^{3,4,*}</span>, Benjamin Wesolowski<span class="math">^{1}</span></p>

    <p class="text-gray-300"><span class="math">^{1}</span>Univ. Bordeaux, CNRS, Bordeaux INP, IMB, UMR 5251, F-33400, Talence, France INRIA, IMB, UMR 5251, F-33400, Talence, France <span class="math">^{2}</span>Laboratory for Cryptologic Algorithms, School of Computer and Communication Sciences, EPFL, Switzerland <span class="math">^{3}</span>Ethereum Foundation <span class="math">^{4}</span>Ruhr Universität Bochum</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Received: July 26, 2023</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Revised: July 26, 2023</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Accepted: July 26, 2023</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">Abstract In this short note we analyze the low order assumption in the imaginary quadratic number fields. We show how this assumption is broken for Mersenne primes. We also provide a description on how to possible attack this assumption for other class of prime numbers leveraging some new mathematical tool coming from higher (cubic) number fields.</p>

    <p class="text-gray-300">Keywords: public-key cryptography, IQC, VDF, class group 2010 Mathematics Subject Classification: 94A60, 11Y40</p>

    <p class="text-gray-300">Cryptography based on class groups of imaginary quadratic orders (IQ cryptography, IQC) is a fascinating area pioneered by Buchmann and Williams in [6]. After a long hiatus where IQC did not find any obvious real life application Lipmaa had the idea to make use of IQ's techniques to build secure accumulators without trusted setup [15], leveraging the unknown order property of class groups of imaginary quadratic fields. In the last years we have seen this unknown order property used as a basis to build Verifiable Delay Functions (VDF) [25, 19], cryptographic accumulators and vector commitments for blockchain applications [5] and polynomial commitment used for zero knowledge [7]. The security of some of this primitives (VDF in the specific case pointed out in [8]) are bound to two complexity assumptions: the low order assumption [8, Definition 1] and the adaptive root assumption [8, Definition 2] with the adaptive root assumption implying the low order assumption.</p>

    <p class="text-gray-300">Breaking the low order assumption consists in finding an element <span class="math">\\mu \\in G</span> and an integer <span class="math">d &amp;lt; 2^4</span> such that <span class="math">\\mu \\neq 1_G</span> and <span class="math">\\mu^d = 1_G</span>. Given an odd integer <span class="math">N</span> with unknown factorization the low order assumption is believed to hold for the group <span class="math">(\\mathbb{Z} / N\\mathbb{Z})^\\times / \\{\\pm 1\\}</span>. The low order assumption in RSA groups has been extensively analyzed in [21].</p>

    <p class="text-gray-300">In this paper we are going to analyze in more details the low order assumption in the class group of an imaginary quadratic number fields.</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">For class group of the number field <span class="math">\\mathbb{Q}(\\sqrt{-p})</span>, with <span class="math">p \\equiv 3 \\pmod{4}</span> we know that the class number (the class group order) is odd and it is believed hard to compute when $</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">p</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">$ is large. The low order assumption in the class group of an imaginary quadratic field has not been studied much and is one of the goal for this work. While the Cohen-Lenstra heuristics [9] suggest that the class group often contains elements of small odd order it seems out of reach by current techniques to find such low order forms. In [22, §2] Shanks provides some interesting relations that can help to shade some light and one in particular caught our attention: if</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <div class="my-4 text-center"><span class="math-block">\\Delta = 2^p - 1</span></div>

    <p class="text-gray-300">then</p>

    <div class="my-4 text-center"><span class="math-block">h(-\\Delta) \\equiv 0 \\pmod{p - 2}</span></div>

    <p class="text-gray-300">and the associated low order element is of the form</p>

    <div class="my-4 text-center"><span class="math-block">(2, 1, 2^{p-3}).</span></div>

    <p class="text-gray-300">*Corresponding Author.</p>

    <p class="text-gray-300">This relation tells us that the low order assumption is violated for Mersenne primes. Other relations exist but require an even class number and are out of our scope. Shanks gives some other hint in <em>[23]</em>: for negative discriminants <span class="math">\\Delta=8k-1</span> the class number <span class="math">h</span> must satisfy <span class="math">h\\geq 1+log_{2}\\,k</span>. Furthermore if the class number respects <span class="math">h(1-8k)=6n\\pm 1</span> then</p>

    <p class="text-gray-300"><span class="math">\\Delta=\\frac{2^{h+2}-(2u+v)^{2}}{v^{2}}</span></p>

    <p class="text-gray-300">with odd <span class="math">v</span> and <span class="math">(2u+v)</span> when <span class="math">h</span> is prime and <span class="math">&gt;3</span>. It is interesting to note that assigning <span class="math">v=1</span> and <span class="math">u=0</span> gives exactly the formula for Mersenne primes above.</p>

    <h3 id="sec-4" class="text-xl font-semibold mt-8">2.1 DIOPHANTINE EQUATIONS AND CLASS NUMBERS</h3>

    <p class="text-gray-300">We have seen above that the <em>low order assumption</em> is broken for a really narrow set of primes namely Mersenne primes. Mersenne primes are number of the form</p>

    <p class="text-gray-300"><span class="math">\\Delta=2^{p}-1</span></p>

    <p class="text-gray-300">So far about 50 Mersenne primes have been discovered making the set of Mersenne primes extremely sparse. In this section we focus on searching for other classes of possible <em>weak primes</em> with regard to the <em>low order assumption</em> in the class group of an imaginary quadratic number field. The weakness of Mersenne primes extends to denser families of discriminants, and the following theorem gives a simple example.</p>

    <h6 id="sec-5" class="text-base font-medium mt-4">Theorem 1.</h6>

    <p class="text-gray-300">If <span class="math">D=4u^{3}-1</span> with <span class="math">u\\in\\mathbb{Z}_{&gt;0}</span>, then the low order assumption is violated for the group of classes of primitive binary quadratic forms with discriminant <span class="math">-D</span>.</p>

    <h6 id="sec-6" class="text-base font-medium mt-4">Proof.</h6>

    <p class="text-gray-300">Let <span class="math">D=4u^{3}-1</span> for some <span class="math">u&gt;0</span>, let <span class="math">\\omega_{D}=(1+\\sqrt{-D})/2</span> and consider the ideal <span class="math">I=(u,\\omega_{D})</span> in the ring <span class="math">\\mathbb{Z}[\\omega_{D}]</span> with norm <span class="math">u</span>. Then <span class="math">I^{3}=(u^{3},\\omega_{D}^{3})</span> is contained in the principal ideal <span class="math">(\\omega_{D})</span> and since both have norm <span class="math">u^{3}</span>, they are equal. Also, for <span class="math">u&gt;1</span>, <span class="math">I</span> is not principal since for <span class="math">a,b\\in\\mathbb{Z}</span> we have</p>

    <p class="text-gray-300"><span class="math">N(a+b\\omega_{D})=(a+b/2)^{2}+b^{2}D/4\\geq D/4&gt;u</span></p>

    <p class="text-gray-300">so the class of <span class="math">I</span> has order 3. ∎</p>

    <p class="text-gray-300">Replacing <span class="math">u</span> with 2 and 3 with <span class="math">p-2</span>, i.e., <span class="math">D=2^{p}-1</span>, proves the Mersenne case (although one has to argue slightly more, namely that the smaller powers of <span class="math">I</span> are not principal because the smallest norm of a principal ideal is <span class="math">2^{p}</span> except for principal ideals arising from integers).</p>

    <p class="text-gray-300">Let us increase the level of generality, and exhibit the source of the weakness of the above examples. In particular, the general case will imply that primes of the form</p>

    <p class="text-gray-300"><span class="math">\\Delta=k2^{n}-1</span></p>

    <p class="text-gray-300">are also weak. This class of primes can leverage on some of the fastest primality tests so far discovered <em>[20]</em> and could be appealing to implementers due to its attractive performance . The generalisation, which actually allows to construct elements of arbitrary prescribed order <span class="math">t</span>, is a consequence of a result of Mollin.</p>

    <h6 id="sec-7" class="text-base font-medium mt-4">Theorem 2 (Mollin <em>[16]</em>).</h6>

    <p class="text-gray-300">Let <span class="math">D</span> be a squarefree number and let <span class="math">\\sigma=2</span> when <span class="math">D\\equiv 3\\pmod{4}</span> and <span class="math">\\sigma=1</span> otherwise. Assume further that <span class="math">D=\\sigma^{2}m^{t}-b^{2}</span> where <span class="math">t&gt;1</span>, <span class="math">m&gt;1</span> and <span class="math">b&gt;0</span> are integers such that <span class="math">b\\neq 2m^{t/2}-1</span> if <span class="math">t</span> is even and <span class="math">b\\neq\\lfloor\\sigma m^{t/2}\\rfloor</span> if <span class="math">t</span> is odd. Then the ideal <span class="math">(m,(b+\\sqrt{-D})/\\sigma)</span> has order <span class="math">t</span> in the ideal class group of the imaginary quadratic field <span class="math">\\mathbb{Q}(\\sqrt{-D})</span>.</p>

    <h6 id="sec-8" class="text-base font-medium mt-4">Corollary 1.</h6>

    <p class="text-gray-300">Let <span class="math">D=4m^{t}-b^{2}</span> be a prime number, where <span class="math">b</span> and <span class="math">t</span> are odd positive integers such that <span class="math">b\\neq\\lfloor 2m^{t/2}\\rfloor</span>. Then the ideal <span class="math">(m,(b+\\sqrt{-D})/2)</span> has order <span class="math">t</span> in the ideal class group of the imaginary quadratic field <span class="math">\\mathbb{Q}(\\sqrt{-D})</span>.</p>

    <p class="text-gray-300">Let us show an example</p>

    <h6 id="sec-9" class="text-base font-medium mt-4">Example 1.</h6>

    <p class="text-gray-300">Let us use as discriminant <span class="math">D=-40407597268924803882495478254939792927447222948200447</span> this corresponds to the entry <span class="math">k=27</span> and <span class="math">n=170</span> in <em>[20, Table 2]</em>. This meets the requirements of Theorem 1. We can easily compute <span class="math">c=\\sqrt[3]{k2^{n-2}}=216172782113783808</span> and obtain the primitive integral binary cubic form</p>

    <p class="text-gray-300"><span class="math">C(x,y)=ax^{3}-3cxy^{2}+dy^{3}.</span></p>

    <p class="text-gray-300">computing the Hessian of <span class="math">C</span> gives</p>

    <p class="text-gray-300"><span class="math">q=(216172782113783808,-1,46730671726813448656774466962980864)</span></p>

    <p class="text-gray-300">that is an element of order 3, as expected.</p>

    <h6 id="sec-10" class="text-base font-medium mt-4">Example 2.</h6>

    <p class="text-gray-300">Now, let us describe a method to generate a prime discriminant of given bit-length <span class="math">B</span>, for any specified order <span class="math">t</span>. First, let <span class="math">m</span> be an integer such that <span class="math">4m^{t}&gt;2^{B}</span>. Now, we have <span class="math">D=4m^{t}-b^{2}\\in\\left[2^{B-1},2^{B}\\right)</span> if and only if</p>

    <p class="text-gray-300"><span class="math">b\\in I_{m}=\\left(\\sqrt{4m^{t}-2^{B}},\\sqrt{4m^{t}-2^{B-1}}\\right].</span></p>

    <p class="text-gray-300">The interval <span class="math">I_{m}</span> contains at least <span class="math">\\left\\lfloor 2^{B-1}/\\left(2\\sqrt{4m^{t}-2^{B-1}}\\right)\\right\\rfloor-1</span> many (positive) odd integers. We deduce that it is non-empty as long as <span class="math">4m^{t}\\leq 2^{2B-6}</span>. We deduce the following algorithm: sample an integer <span class="math">m</span> such that <span class="math">2^{B}&lt;4m^{t}\\leq 2^{2B-6}</span> (for instance, uniformly at random), then sample an odd integer <span class="math">b</span> in <span class="math">I_{m}</span> (again, for instance, uniformly at random), and let <span class="math">D=4m^{t}-b^{2}</span>. If <span class="math">D</span> is prime, return it; otherwise, resample <span class="math">m</span> and <span class="math">b</span>. Heuristically, the algorithm succeeds after an expected number of trials in <span class="math">O(B)</span>. Each trial essentially costs one primality test. Note that this heuristic can only hold if there are sufficiently many candidate values for <span class="math">m</span> satisfying <span class="math">2^{B}&lt;4m^{t}\\leq 2^{2B-6}</span>. If <span class="math">B\\geq t+4</span>, then there are at least <span class="math">2^{(B-2)/t}</span> such candidates, and for this quantity to be at least <span class="math">\\Omega(B)</span>, one needs <span class="math">B/\\log(B)=\\Omega(t)</span>, i.e., <span class="math">B=\\Omega(t\\log(t))</span>.</p>

    <p class="text-gray-300">Using this technique with <span class="math">t=3</span>, we found the following <span class="math">1024</span>-bit discriminant in less than a second:</p>

    <p class="text-gray-300"><span class="math">D=</span> <span class="math">90\\ 035\\ 739\\ 086\\ 996\\ 044\\ 929\\ 657\\ 295\\ 449\\ 404\\ 992\\ 608\\ 896\\ 161\\ 982\\ 818\\ 704\\ 624\\ 734\\ 545\\ 126\\ 784\\ 028\\ 963\\ 989</span> <span class="math">295\\ 482\\ 427\\ 666\\ 032\\ 414\\ 206\\ 561\\ 507\\ 869\\ 372\\ 584\\ 648\\ 836\\ 724\\ 700\\ 200\\ 371\\ 898\\ 954\\ 392\\ 245\\ 245\\ 061\\ 968\\ 868</span> <span class="math">946\\ 034\\ 239\\ 811\\ 453\\ 054\\ 998\\ 654\\ 002\\ 278\\ 345\\ 259\\ 090\\ 130\\ 728\\ 036\\ 489\\ 542\\ 703\\ 762\\ 200\\ 445\\ 320\\ 432\\ 567\\ 297</span> <span class="math">903\\ 573\\ 341\\ 236\\ 871\\ 804\\ 843\\ 115\\ 533\\ 230\\ 239\\ 855\\ 019\\ 834\\ 217\\ 874\\ 752\\ 991\\ 665\\ 910\\ 141\\ 469\\ 207\\ 698\\ 903,</span> <span class="math">m=</span> <span class="math">218\\ 925\\ 934\\ 949\\ 261\\ 543\\ 544\\ 131\\ 625\\ 221\\ 968\\ 979\\ 300\\ 603\\ 770\\ 996\\ 540\\ 319\\ 121\\ 619\\ 328\\ 205\\ 259\\ 561\\ 011\\ 675</span> <span class="math">695\\ 262\\ 296\\ 776\\ 163\\ 956\\ 169\\ 855\\ 807\\ 215\\ 003\\ 614\\ 736\\ 153\\ 253\\ 911\\ 225\\ 535\\ 737\\ 483\\ 310\\ 178\\ 391\\ 503\\ 421\\ 503</span> <span class="math">126\\ 566\\ 813\\ 360\\ 030\\ 441\\ 650\\ 898\\ 331\\ 150\\ 601\\ 389\\ 570\\ 907\\ 140\\ 746,</span> <span class="math">b=</span> <span class="math">204\\ 868\\ 796\\ 081\\ 378\\ 472\\ 490\\ 247\\ 325\\ 165\\ 671\\ 636\\ 711\\ 884\\ 728\\ 224\\ 614\\ 750\\ 308\\ 617\\ 553\\ 085\\ 204\\ 382\\ 480\\ 494</span> <span class="math">821\\ 887\\ 676\\ 095\\ 206\\ 218\\ 471\\ 133\\ 987\\ 706\\ 972\\ 957\\ 990\\ 417\\ 280\\ 683\\ 317\\ 514\\ 601\\ 460\\ 199\\ 389\\ 917\\ 407\\ 988\\ 118</span> <span class="math">574\\ 795\\ 366\\ 336\\ 656\\ 502\\ 721\\ 606\\ 330\\ 850\\ 022\\ 303\\ 048\\ 868\\ 820\\ 453\\ 167\\ 198\\ 073\\ 828\\ 043\\ 334\\ 470\\ 361\\ 185\\ 906</span> <span class="math">258\\ 137\\ 355\\ 516\\ 080\\ 070\\ 634\\ 344\\ 790\\ 004\\ 109\\ 343\\ 866\\ 901\\ 004\\ 192\\ 450\\ 532\\ 710\\ 354\\ 505\\ 639\\ 728\\ 221.</span></p>

    <h6 id="sec-11" class="text-base font-medium mt-4">Example 3.</h6>

    <p class="text-gray-300">For fixed <span class="math">t</span>, the following straightforward GP script (see <em>[18]</em>) produces pairs <span class="math">(m,b)</span> satisfying the hypotheses of Corollary 1 by sampling random <span class="math">B</span>-bit integers. We thus obtain negative prime discriminants <span class="math">b^{2}-4m^{t}</span> with <span class="math">tB+2</span> bits together with a binary quadratic form <span class="math">(m,b,m^{t-1})</span> of low order <span class="math">t</span> in the corresponding classgroup.</p>

    <p class="text-gray-300">loword(B, t) = { while(1, my(b = random(2^B), m = random(2^B), mt = m^t); D = 4*mt - b^2;</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">if (D <= 0</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">b == sqrtint(4*mt)</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">!isprime(D), next);</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">q = qfbred(Qfb(m, b, mt / m)); q0 = q^0; /<em> trivial class </em>/</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">if (q == q0</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"></th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">q^t != q0, error()); /<em> paranoia </em>/</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">return([t, m, b])); }</p>

    <p class="text-gray-300">##</p>

    <p class="text-gray-300">Belabas, K. &amp; Kleinjung T. &amp; Sanso A. &amp; Wesolowski B.</p>

    <p class="text-gray-300">Trying it for  <span class="math">B = 16</span>  for consecutive primes  <span class="math">t</span> , we obtain in about 3 seconds:</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">t</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">form (m, b, *) of order t</th>

          </tr>

        </thead>

        <tbody>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">3</td>

            <td class="px-3 py-2 border-b border-gray-700">(22182, 21373, *)</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">5</td>

            <td class="px-3 py-2 border-b border-gray-700">(30680, 36619, *)</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">7</td>

            <td class="px-3 py-2 border-b border-gray-700">(22862, 59303, *)</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">11</td>

            <td class="px-3 py-2 border-b border-gray-700">(23366, 26165, *)</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">13</td>

            <td class="px-3 py-2 border-b border-gray-700">(29532, 28003, *)</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">17</td>

            <td class="px-3 py-2 border-b border-gray-700">(29454, 9733, *)</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">19</td>

            <td class="px-3 py-2 border-b border-gray-700">(10874, 3913, *)</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">23</td>

            <td class="px-3 py-2 border-b border-gray-700">(13310, 20463, *)</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">29</td>

            <td class="px-3 py-2 border-b border-gray-700">(31418, 64623, *)</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">31</td>

            <td class="px-3 py-2 border-b border-gray-700">(11885, 61429, *)</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">37</td>

            <td class="px-3 py-2 border-b border-gray-700">(45748, 24609, *)</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">41</td>

            <td class="px-3 py-2 border-b border-gray-700">(61340, 50381, *)</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">43</td>

            <td class="px-3 py-2 border-b border-gray-700">(245, 30283, *)</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">47</td>

            <td class="px-3 py-2 border-b border-gray-700">(3962, 53951, *)</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">53</td>

            <td class="px-3 py-2 border-b border-gray-700">(36034, 58875, *)</td>

          </tr>

          <tr>

            <td class="px-3 py-2 border-b border-gray-700">59</td>

            <td class="px-3 py-2 border-b border-gray-700">(32910, 64843, *)</td>

          </tr>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">These examples show how easy it is to construct discriminants together with a low order element in their class group without computing the class number. The likelihood that such a discriminant is chosen at random is negligible, though. On the other hand, given  <span class="math">D</span> , it seems hard to prove that a given number is not of the form specified by Corollary 1 in general, even for a fixed order  <span class="math">t \\geq 3</span> : it amounts to proving that the given hyperelliptic curve has no integer points.</p>

    <p class="text-gray-300">In real life deployments, in order to meet the quantum annoyance property defined in [12], the Chia blockchain <span class="math">^{2}</span>  picks a new random discriminant every 10 minutes. A different situation might arise though if a special prime is chosen to meet specific optimization requirements.</p>

    <p class="text-gray-300">In this section, we investigate an alternative method to design discriminants together with an ideal of order 3. It has the advantage of being very elementary, and allows for easy control of the bits (or digits) of the discriminant. The technique dates back to Nagell [17], who used it to prove that for any  <span class="math">n \\geq 1</span> , there exist (constructively) infinitely many imaginary quadratic fields with a class of order  <span class="math">n</span> . It has since been extended to exhibit various subgroup structures in class groups, yet we only need the simplest case  <span class="math">n = 3</span> .</p>

    <p class="text-gray-300">For any discriminant  <span class="math">\\Delta &amp;lt; 0</span> , the norm of the algebraic number  <span class="math">\\alpha = x + y\\sqrt{\\Delta} \\in \\mathbb{Q}(\\sqrt{\\Delta})</span>  is  <span class="math">N(\\alpha) = x^2 - \\Delta y^2</span> . This element  <span class="math">\\alpha</span>  generates a principal ideal  <span class="math">(\\alpha)</span>  of the same norm, which, by construction, is principal. Now, if  <span class="math">z</span>  is a prime number, and  <span class="math">N(\\alpha) = z^3</span> , we can deduce that  <span class="math">(\\alpha)</span>  factors as a product of 3 prime ideals of norm  <span class="math">z</span> . Indeed  <span class="math">z</span>  cannot be inert in  <span class="math">\\mathbb{Q}(\\sqrt{\\Delta})</span> , and either  <span class="math">(\\alpha) = \\mathfrak{z}^3</span>  or  <span class="math">(\\alpha) = (z)\\mathfrak{z}</span>  where  <span class="math">\\mathfrak{z}</span>  is a prime ideal above  <span class="math">z</span> . The case  <span class="math">(\\alpha) = (z)\\mathfrak{z}</span>  is equivalent to  <span class="math">z</span>  dividing  <span class="math">x</span>  and  <span class="math">y</span>  and  <span class="math">\\mathfrak{z}</span>  is then principal. The case  <span class="math">(\\alpha) = \\mathfrak{z}^3</span>  implies that  <span class="math">\\mathfrak{z}</span>  has order 1 or 3 in the class group.</p>

    <p class="text-gray-300">Given  <span class="math">\\Delta</span> , finding an element  <span class="math">\\alpha</span>  whose norm is a third power of a prime seems computationally hard. However, one can hope to find elements of order 3 in a class group by generating  <span class="math">\\Delta</span>  a posteriori. First fix a prime number  <span class="math">z</span> , then choose any integers  <span class="math">x</span>  and  <span class="math">y</span>  such that  <span class="math">y^2</span>  divides  <span class="math">z^3 - x^2</span> , and define</p>

    <div class="my-4 text-center"><span class="math-block">\\Delta = \\frac {x ^ {2} - z ^ {3}}{y ^ {2}}.</span></div>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">From [13, Lemme 5], the induced ideal  <span class="math">\\mathfrak{z}</span>  is non-principal (hence, of order 3) as soon as  <span class="math">2y</span>  and  <span class="math">z</span>  are coprime, and  $z &lt; \\sqrt{</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">\\Delta</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">/ 4}<span class="math"> . To generate a discriminant with this method, one can fix a prime  </span>z<span class="math">  a priori, then find suitable values of  </span>x<span class="math">  and  </span>y<span class="math"> . Setting  </span>y = 1<span class="math">  ensures  </span>\\mathfrak{z}<span class="math">  has order 3, and actually makes this method a particular case of Section 2.1. One can generate a corresponding prime discriminant of prescribed bit-length  </span>B<span class="math">  in a way similar to Example 2, at the cost of essentially  </span>O(B)$  primality tests.</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">The above strategy allows to find 'random looking' discriminants together with a class of order 3 in the corresponding class group. It does not allow to fix the discriminant a priori. However, we now show that it</p>

    <p class="text-gray-300">A note on the low order assumption in class groups of imaginary quadratic number fields</p>

    <p class="text-gray-300">is possible to fix half the bits of the discriminant. Let  <span class="math">\\delta</span>  a  <span class="math">B / 2</span> -bit integer. We are looking for a discriminant  <span class="math">\\Delta = -(\\delta + 2^{B / 2}\\delta&#x27;)</span> , with  <span class="math">\\delta&#x27;</span>  another  <span class="math">B / 2</span> -bit integer.</p>

    <p class="text-gray-300">Choose a  <span class="math">B/3</span> -bit prime number  <span class="math">z</span>  so that the quadratic equation  <span class="math">x^2 \\equiv \\delta + z^3 \\mod 2^{B/2}</span>  has a solution, and choose  <span class="math">x</span>  a  <span class="math">B/2</span> -bit long solution. Now, let  <span class="math">\\Delta = z^3 - x^2</span> . As above, the prime ideals above  <span class="math">z</span>  in  <span class="math">\\mathbb{Q}(\\sqrt{\\Delta})</span>  are either principal or of order 3 in the class group, and now the  <span class="math">B/2</span>  least significant bits of  <span class="math">\\Delta</span>  are given by  <span class="math">\\delta</span> .</p>

    <p class="text-gray-300">It is well known that there is a close relationship between binary cubic forms of discriminant  <span class="math">\\Delta = -27D</span>  and ideal class group of the quadratic field  <span class="math">\\mathcal{L} = \\mathbb{Q} = (\\sqrt{D})</span> . This section summarizes parts of [14, Chapter 3]. Given a primitive integral binary cubic form in the form</p>

    <div class="my-4 text-center"><span class="math-block">C (x, y) = a x ^ {3} + 3 b x ^ {2} y + 3 c x y ^ {2} + d y ^ {3}.</span></div>

    <p class="text-gray-300">where  <span class="math">a, b, c, d \\in \\mathbb{Z}</span> . Let  <span class="math">Q</span>  be the Hessian of  <span class="math">C</span> . Then we have</p>

    <div class="my-4 text-center"><span class="math-block">Q = 9 q, \\quad \\text {w h e r e} \\quad q = (b ^ {2} - a c, b c - a d, c ^ {2} - b d).</span></div>

    <p class="text-gray-300">The discriminant of the binary quadratic form  <span class="math">q</span>  is equal to</p>

    <div class="my-4 text-center"><span class="math-block">D = - 3 b ^ {2} c ^ {2} + 4 a c ^ {3} + 4 b ^ {3} d - 6 a b c d + a ^ {2} d ^ {2}.</span></div>

    <p class="text-gray-300">Now there is a well defined map between the  <span class="math">SL_2(\\mathbb{Z})</span> -class of  <span class="math">C</span>  and the  <span class="math">SL_2(\\mathbb{Z})</span> -class of the Hessian  <span class="math">Q</span> . Let  <span class="math">Cl^+(bcf(\\Delta))</span>  be the set of  <span class="math">SL_2(\\mathbb{Z})</span> -class of binary cubic forms of discriminant  <span class="math">\\Delta = -27D</span> , let  <span class="math">Cl_{\\mathcal{L}}^+ [3]</span>  be the 3-torsion subgroup of the narrow ideal class group of the quadratic field  <span class="math">\\mathcal{L} = \\mathbb{Q} = (\\sqrt{D})</span>  and let  <span class="math">Cl^+(bqf(D))[3]</span>  be the  <span class="math">SL_2(\\mathbb{Z})</span> -classes of binary quadratic forms isomorphic to  <span class="math">Cl_{\\mathcal{L}}^+ [3]</span> , then the map is given by:</p>

    <div class="my-4 text-center"><span class="math-block">\\varphi : C l ^ {+} (b c f (\\Delta)) \\longrightarrow C l ^ {+} (b q f (D)) [ 3 ]</span></div>

    <div class="my-4 text-center"><span class="math-block">\\varphi : \\left[ (a, 3 b, 3 c, d) \\right] \\longrightarrow \\left[ \\left(b ^ {2} - a c, b c - a d, c ^ {2} - b d\\right) \\right]</span></div>

    <p class="text-gray-300">This allows to exhibit elements of order 3 in class groups of quadratic fields without even computing the class number. Unfortunately, the corresponding algorithms are more expensive than class group computations.</p>

    <p class="text-gray-300">A great way to visualize the correspondence defined in section 4 is using the work by Manjul Bhargava. In his cornerstone paper [4] Bhargava introduced a new composition law for binary quadratic fields (about 200 years after Gauss) and 13 new composition laws for higher degree number fields using what is now known as the Bhargava cube. He noticed that when putting numbers on the corners of a cube (representing a  <span class="math">2 \\times 2 \\times 2</span>  matrix) as below</p>

    <p class="text-gray-300">!<a href="img-0.jpeg">img-0.jpeg</a></p>

    <p class="text-gray-300">the cube can be sliced into pairs of  <span class="math">2 \\times 2</span>  matrices in three different ways</p>

    <div class="my-4 text-center"><span class="math-block">M _ {1} = \\left[ \\begin{array}{c c} a &amp;amp; b \\\\ c &amp;amp; d \\end{array} \\right] N _ {1} = \\left[ \\begin{array}{c c} e &amp;amp; f \\\\ g &amp;amp; h \\end{array} \\right]</span></div>

    <div class="my-4 text-center"><span class="math-block">M _ {2} = \\left[ \\begin{array}{c c} a &amp;amp; c \\\\ e &amp;amp; g \\end{array} \\right] N _ {2} = \\left[ \\begin{array}{c c} b &amp;amp; d \\\\ f &amp;amp; h \\end{array} \\right]</span></div>

    <p class="text-gray-300">Belabas, K. &amp; Kleinjung T. &amp; Sanso A. &amp; Wesolowski B.</p>

    <p class="text-gray-300">!<a href="img-1.jpeg">img-1.jpeg</a></p>

    <p class="text-gray-300">Just as symmetric square matrix defines a quadratic form, a triply symmetric cube defines a cubic form: the above cube induces the cubic form</p>

    <p class="text-gray-300"><span class="math">ax^{3}+3bx^{2}y+3cxy^{2}+dy^{3}.</span></p>

    <p class="text-gray-300">We also know from the discussion above that this cube defines three binary quadratic forms whose product is the identity. So this triply symmetric cube also parametrizes an order in a quadratic fields together with three ideal classes of trivial product. The symmetries in the cube imply that all three quadratic forms are actually the same, therefore it is a quadratic form of order 1 or 3. Next step has been suggested by Bhargava in <em>[3]</em> where he points out that the method described by Belabas in <em>[1]</em> could be used to enumerate order 3 ideal classes in quadratic orders. Let us run through an example.</p>

    <p class="text-gray-300">Example 4. Assume we want to find an element of order 3 for the binary quadratic form with discriminant <span class="math">\\Delta=-470551</span>. <span class="math">-\\Delta</span> is a prime number equal to 7 (mod 8). Now using the algorithm in <em>[1]</em> we can generate the reduced defining polynomial for the binary cubic form having discriminant <span class="math">3^{3}\\Delta=12704877</span>. This outputs the binary cubic form <span class="math">5x^{3}+(3\\cdot 11)x^{2}y-(3\\cdot 17)xy^{2}-26y^{3}</span> that is equivalent to the following Bhargava cube:</p>

    <p class="text-gray-300">!<a href="img-2.jpeg">img-2.jpeg</a></p>

    <p class="text-gray-300">This triple symmetric cube is formed by composing twice the following binary quadratic form of order 3: <span class="math">206x^{2}+57xy+575y</span></p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Some comment about the example above: we were able to find an element of order 3 without computing the class number of the binary quadratic form. All using a combination of Belabas algorithm and Bhargava cube. Unfortunately, the algorithm listing fields with $</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">disc</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"><span class="math"> in the range </span>[X-Y,X]<span class="math"> has complexity </span>O(X^{3/4}+Y)<span class="math"> (see <em>[2]</em>); in our example </span>Y=0<span class="math"> so we can find an element of order 3 in time about </span>O(X^{3/4})$. This is more expensive than</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <p class="text-gray-300">A note on the low order assumption in class groups of imaginary quadratic number fields</p>

    <p class="text-gray-300">computing the full class group <em>per se</em>. The variant introduced by Cremona in <em>[11, Algorithm 2]</em> also runs in time <span class="math">O(X^{3/4})</span>.</p>

    <div class="overflow-x-auto my-4">

      <table class="min-w-full text-sm text-gray-300">

        <thead>

          <tr>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">Finally, Daniel Shanks’s CUFFQI algorithm <em>[24]</em> constructs all cubic fields of a fixed fundamental discriminant <span class="math">X</span> in time polynomial in $\\log</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600">X</th>

            <th class="px-3 py-2 text-left font-semibold border-b border-gray-600"><span class="math"> (see Renate Scheidler’s paper in <em>[14, Chapter 4]</em>) but it requires as input the 3-part of the class group of the quadratic field with that discriminant (that is actually what we are looking for!). More generally, <em>given</em> the class group and units of a number field </span>K<span class="math">, the same techniques using class field theory and virtual units allow to visualize elements of arbitrary order </span>t<span class="math"> in the class group by exhibiting unramified extensions of degree </span>t<span class="math"> of </span>K$, given by a list of irreducible polynomials, see <em>[10]</em>. The complexity is again dominated by the time needed to compute the class number and class group structure.</th>

          </tr>

        </thead>

        <tbody>

        </tbody>

      </table>

    </div>

    <h2 id="sec-16" class="text-2xl font-bold">5 CONCLUSIONS</h2>

    <p class="text-gray-300">ICQ leverages on some well known topic in number theory but many of the assumptions are new in the field of cryptography. The low order assumption is an important assumption that is at the core of some cryptographic primitives: Verifiable Delay Functions, accumulators, polynomial commitments. In this work we were able to break the low order assumption in the class group of an imaginary quadratic number field for some really special class of prime numbers and we have shown how it is possible to construct malicious discriminants having prescribed properties. For applications leveraging the low order assumption over imaginary quadratic field we recommend to generate the discriminant at random and to avoid to mandate fixed discriminants. We hope that this work provides some incentive for researchers to think about this new problems.</p>

    <p class="text-gray-300">We would like to thank Dan Boneh, Bram Cohen, Luca de Feo, Florian Luca, Simon Masson, István András Seres, Renate Scheidler for fruitful discussions. We thank the anonymous reviewer for their critical reading of the manuscript and providing detailed and insightful comments, which greatly enhanced the quality and clarity of the paper.</p>

    <h2 id="sec-17" class="text-2xl font-bold">References</h2>

    <ul class="list-disc list-inside space-y-1 text-gray-300 my-2 ml-4">

      <li>[1] Karim Belabas. “A fast algorithm to compute cubic fields”. In: <em>Math. Comp</em> 66 (1997), pp. 1213–1237.</li>

      <li>[2] Karim Belabas. “On quadratic fields with large 3-rank”. In: <em>Math. Comp.</em> 73.248 (2004), pp. 2061–2074. issn: 0025-5718.</li>

      <li>[3] Manjul Bhargava. “Gauss composition and generalizations”. English (US). In: <em>Algorithmic Number Theory - 5th International Symposium, ANTS-V Sydney, Australia, July 7-12, 2002 Proceedings</em>. Ed. by Claus Fieker and David R. Kohel. Lecture Notes in Computer Science. 5th International Algorithmic Number Theory Symposium, ANTS 2002 ; Conference date: 07-07-2002 Through 12-07-2002. Germany: Springer Verlag, Jan. 2002, pp. 1–8. isbn: 3540438637. doi: 10.1007/3-540-45455-1_1.</li>

      <li>[4] Manjul Bhargava. “Higher composition laws I: A new view on Gauss composition, and quadratic generalizations”. English (US). In: <em>Annals of Mathematics</em> 159.1 (Jan. 2004), pp. 217–250. issn: 0003-486X. doi: 10.4007/annals.2004.159.217.</li>

      <li>[5] Dan Boneh, Benedikt Bünz, and Ben Fisch. “Batching Techniques for Accumulators with Applications to IOPs and Stateless Blockchains”. In: <em>Advances in Cryptology – CRYPTO 2019</em>. Ed. by Alexandra Boldyreva and Daniele Micciancio. Cham: Springer International Publishing, 2019, pp. 561–586. isbn: 978-3-030-26948-7.</li>

      <li>[6] Johannes Buchmann and Hugh C. Williams. “A Key-Exchange System Based on Imaginary Quadratic Fields”. In: <em>J. Cryptology</em> 1 (1988), pp. 107–118. doi: 10.1007/BF02351719.</li>

      <li>[7] Benedikt Bünz, Ben Fisch, and Alan Szepieniec. “Transparent SNARKs from DARK Compilers”. In: <em>Advances in Cryptology – EUROCRYPT 2020</em>. Ed. by Anne Canteaut and Yuval Ishai. Cham: Springer International Publishing, 2020, pp. 677–706. isbn: 978-3-030-45721-1.</li>

      <li>[8] D. Boneh, B. Bünz and B. Fisch. “A Survey of Two Verifiable Delay Functions”. In: <em>Cryptology ePrint Archive, Report 2018/712</em> (2018).</li>

      <li>[9] H. Cohen and H. W. Lenstra Jr. “Heuristics on class groups of number fields”. In: <em>Number theory, No-ordwijkerhout 1983 (Noordwijkerhout, 1983)</em>. Vol. 1068. Lecture Notes in Math. Springer, Berlin, 1984, pp. 33–62.</li>

      <li>[10] Henri Cohen. <em>Advanced topics in computational number theory</em>. Vol. 193. Graduate Texts in Mathematics. New York: Springer-Verlag, 2000, pp. xvi+578. isbn: 0-387-98727-4.</li>

    </ul>

    <p class="text-gray-300">Belabas, K. &amp; Kleinjung T. &amp; Sanso A. &amp; Wesolowski B.</p>

    <ul class="list-disc list-inside space-y-1 text-gray-300 my-2 ml-4">

      <li>[11] J. E. Cremona. “Reduction of Binary Cubic and Quartic Forms”. In: LMS Journal of Computation and Mathematics 2 (1999), pp. 62–92. doi: 10.1112/S1461157000000073.</li>

      <li>[12] Luca De Feo et al. “Verifiable Delay Functions from Supersingular Isogenies and Pairings”. In: Advances in Cryptology – ASIACRYPT 2019. Ed. by Steven D. Galbraith and Shiho Moriai. Cham: Springer International Publishing, 2019, pp. 248–277. isbn: 978-3-030-34578-5.</li>

      <li>[13] Francisco Diaz y Diaz. “Sur les corps quadratiques imaginaires dont le 3-rang du groupe des classes est supérieur à 1”. In: Séminaire Delange-Pisot-Poitou. Théorie des nombres 15.2 (1973-1974). talk:G15.</li>

      <li>[14] Samuel A. Hambleton and Hugh C. Williams. Cubic fields with geometry. CMS Books in Mathematics/Ouvrages de Mathématiques de la SMC. Springer, Cham, 2018, pp. xix+493. isbn: 978-3-030-01402-5; 978-3-030-01404-9. doi: 10.1007/978-3-030-01404-9. url: https://doi.org/10.1007/978-3-030-01404-9.</li>

      <li>[15] Helger Lipmaa. “Secure Accumulators from Euclidean Rings without Trusted Setup”. In: Applied Cryptography and Network Security - 10th International Conference, ACNS 2012, Singapore, June 26-29, 2012. Proceedings. Ed. by Feng Bao, Pierangela Samarati, and Jianying Zhou. Vol. 7341. Lecture Notes in Computer Science. Springer, 2012, pp. 224–240. doi: 10.1007/978-3-642-31284-7\\_14. url: https://doi.org/10.1007/978-3-642-31284-7%5C_14.</li>

      <li>[16] R. A. Mollin. “Solutions of Diophantine equations and divisibility of class numbers of complex quadratic fields”. In: Glasgow Math. J. 38.2 (1996), pp. 195–197. issn: 0017-0895. doi: 10.1017/S0017089500031438. url: https://doi.org/10.1017/S0017089500031438.</li>

      <li>[17] T. Nagell. “Über die Klassenzahl imaginär-quadratisher Zahlkörper”. In: Abh. Math. Sem. Univ. Hamburg 1 (1922), pp. 140–150.</li>

      <li>[18] PARI/GP, version 2.13.0. http://pari.math.u-bordeaux.fr/. The PARI Group. Bordeaux, 2020.</li>

      <li>[19] K. Pietrzak. “Simple verifiable delay functions”. In: Cryptology ePrint Archive, Report 2018/627 (2018).</li>

      <li>[20] Hans Riesel. “Lucasian criteria for the primality of <span class="math">N=h\\cdot 2^{n}-1</span>”. In: Math. Comp. 23 (1969), pp. 869–875. issn: 0025-5718. doi: 10.2307/2004975. url: https://doi.org/10.2307/2004975.</li>

      <li>[21] István András Seres and Péter Burcsi. A Note on Low Order Assumptions in RSA groups. Cryptology ePrint Archive, Report 2020/402. https://eprint.iacr.org/2020/402. 2020.</li>

      <li>[22] D. Shanks. “Class Number, a Theory of Factorization, and Genera”. In: Proceedings of Symposia in Pure Mathematics. 1971.</li>

      <li>[23] Daniel Shanks. “On Gauss’s class number problems”. In: Math. Comp. 23 (1969), pp. 151–163. issn: 0025-5718. doi: 10.2307/2005064. url: https://doi.org/10.2307/2005064.</li>

      <li>[24] Daniel C. Shanks. Determining all cubic fields having a given fundamental discriminant. Unpublished manuscript. 1987.</li>

      <li>[25] Benjamin Wesolowski. “Efficient Verifiable Delay Functions”. In: Advances in Cryptology – EUROCRYPT 2019. Ed. by Yuval Ishai and Vincent Rijmen. Cham: Springer International Publishing, 2019, pp. 379–407. isbn: 978-3-030-17659-4.</li>

    </ul>`;
---

<BaseLayout title="A note on the low order assumption in class groups of imagin... (2020/1310)">
  <article class="max-w-4xl mx-auto article-prose">
    <nav class="mb-8">
      <a href="/papers" class="text-blue-400 hover:text-blue-300">
        &larr; Back to Papers
      </a>
    </nav>

    <header class="mb-12">
      <h1 class="text-3xl font-bold mb-4"
        set:html={TITLE_HTML} />
      <p class="text-gray-400 mb-2"
        set:html={AUTHORS_HTML} />
      <p class="text-gray-500 text-sm mb-4">
        2020 &middot; eprint 2020/1310
      </p>
      <div class="flex gap-4 text-sm">
        <a
          href={EPRINT_URL}
          target="_blank"
          rel="noopener noreferrer"
          class="text-blue-400 hover:text-blue-300"
        >
          Paper (eprint) &rarr;
        </a>
      </div>
      <p class="mt-4 text-xs text-gray-500">
        All content below belongs to the original authors. This page
        reproduces the paper for educational purposes. Always
        <a
          href={EPRINT_URL}
          target="_blank"
          rel="noopener noreferrer"
          class="text-blue-400 hover:text-blue-300"
        >cite the original</a>.
      </p>
      <p class="mt-1 text-xs text-gray-600">
        Converted with: {CRAWLER} &middot; {CONVERTED_DATE}
      </p>
    </header>

    <Fragment set:html={CONTENT} />

  </article>
</BaseLayout>
