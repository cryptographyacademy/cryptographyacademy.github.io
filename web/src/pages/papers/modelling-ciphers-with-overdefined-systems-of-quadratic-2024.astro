---
import BaseLayout from '../../layouts/BaseLayout.astro';
import PaperDisclaimer from '../../components/PaperDisclaimer.astro';
import PaperHistory from '../../components/PaperHistory.astro';

const EPRINT_URL = 'https://eprint.iacr.org/2024/786';
const CRAWLER = 'marker';
const CONVERTED_DATE = '2026-02-16';
const TITLE_HTML = 'Modelling Ciphers with Overdefined Systems of Quadratic Equations: Application to Friday, Vision, RAIN and Biscuit';
const AUTHORS_HTML = 'Fukang Liu, Mohammad Mahzoun, Willi Meier';

const CONTENT = `    <section id="abstract" class="mb-10">
      <h2 class="text-2xl font-bold">Abstract</h2>
      <p class="text-gray-300">It is well-known that a system of equations becomes easier to solve when it is overdefined. In this work, we study how to overdefine the system of equations to describe the arithmetic oriented (AO) ciphers Friday, Vision, and RAIN, as well as a special system of quadratic equations over $\\mathbb F_{2^{\\ell}}$ used in the post-quantum signature scheme Biscuit. Our method is inspired by Courtois-Pieprzyk&#x27;s and Murphy-Robshaw&#x27;s methods to model AES with overdefined systems of quadratic equations over $\\mathbb F_2$ and $\\mathbb F_{2^8}$, respectively. However, our method is more refined and much simplified compared with Murphy-Robshaw&#x27;s method, since it can take full advantage of the low-degree $\\mathbb F_2$-linearized affine polynomials used in Friday and Vision, and the overdefined system of equations over $\\mathbb F_{2^{\\ell}}$ can be described in a clean way with our method. For RAIN, we instead consider quadratic Boolean equations rather than equations over large finite fields $\\mathbb F_{2^{\\ell}}$. Specifically, we demonstrate that the special structure of RAIN allows us to set up much more linearly independent quadratic Boolean equations than those obtained only with Courtois-Pieprzyk&#x27;s method. Moreover, we further demonstrate that the underlying key-recovery problem in Biscuit (NIST PQC Round 1 Additional Signatures) can also be described by solving a much overdefined system of quadratic equations over $\\mathbb F_{2^{\\ell}}$. On the downside, the constructed systems of quadratic equations for these ciphers cannot be viewed as semi-regular, which makes it challenging to upper bound the complexity of the Gr&ouml;bner basis attack. However, such a new modelling method can significantly improve the lower bound of the complexity of the Gr&ouml;bner basis attacks on these ciphers, i.e., we view the complexity of solving a random system of quadratic equations of the same scale as the lower bound. How to better estimate the upper and lower bounds of the Gr&ouml;bner basis attacks on these ciphers based on our modelling method is left as an open problem.</p>
      <p class="text-gray-300"><strong>Keywords:</strong> Friday &middot; Vision &middot; RAIN &middot; Biscuit &middot; overdefined system &middot; algebraic attack &middot; Gr\\&quot;{o}bner basis</p>
    </section>

    <section id="sec-1" class="mb-10">
      <h2 class="text-2xl font-bold">1 Introduction</h2>

    <p class="text-gray-300">In 2002, Courtois and Pieprzyk presented the first algebraic attack on AES in [22] by modelling it with an overdefined system of quadratic equations over  <span class="math">\\mathbb{F}_2</span>  based on their observation on the inverse function  <span class="math">y = x^{-1}</span>  over  <span class="math">\\mathbb{F}_{2^\\ell}</span> . Subsequently at CRYPTO 2002, Murphy and Robshaw presented a similar method to model AES with an overdefined system of quadratic equations directly over  <span class="math">\\mathbb{F}_{2^8}</span>  [40]. To solve such a special system of equations, Courtois and Pieprzyk proposed the so-called XSL algorithm [22], which is a variant of the XL algorithm [21]. However, it has been pointed out in [20, 37] that the assumptions on the XSL algorithm are too optimistic, and that the claimed successful algebraic attacks on full-round AES in [22, 40] are flawed. By these results, the community seems to have reached a consensus that AES [23] is secure against algebraic attacks.</p>

    <p class="text-gray-300">After the seminal papers [22,40], however, there seems to be no other progress on such modelling methods. A closely related technique may be Buchmann-Pyshkin-Weinmann's modelling method proposed at FSE 2006, where AES-128 could be modelled with 200 polynomial equations of degree 254 and 152 linear equations [16]. Although this method allows them to obtain the Gr&ouml;bner basis under a suitable monomial ordering directly, converting the Gr&ouml;bner basis into a lexicographical order or an elimination order [8] will be too costly, and hence it cannot affect the security of AES-128. As conjectured by Buchmann-Pyshkin-Weinmann, this modelling method can be applied to various iterated block ciphers especially with rich algebraic structures. This has been confirmed by some Gr&ouml;bner basis attacks [3,7,35] on AO ciphers including MiMC, Griffin, Arion, Anemoi, whose degree of the nonlinear function (a power map) or its inverse is usually low.</p>

    <p class="text-gray-300">In this work, we will instead follow Murphy-Robshaw's main idea since Buchmann-Pyshkin-Weinmann's method is too inefficient for the inverse function, i.e., its inverse is itself and it is still of extremely high degree. Our main goal is to shed new insight into ciphers with rich algebraic structures over  <span class="math">\\mathbb{F}_{2^{\\ell}}</span> . In particular, we aim to take full advantage of the used nonlinear and linear cryptographic components to improve the modelling method.</p>

    <p class="text-gray-300">Motivation of this work. A number of AO ciphers have been proposed during these years [3,4,5,14,19,24,32,34], and some of them were also broken due to the insufficient understanding of such designs [2,11,25,38,39,43]. Almost all these successful attacks are algebraic attacks with a clever method to exploit the inner algebraic structures, while such a strategy does not usually work well for conventional block ciphers. The very first algebraic attacks on block ciphers date back to Courtois-Pieprzyk's and Murphy-Robshaw's attacks on AES by exploiting its rich algebraic structure. Unfortunately, the two attacks are flawed due to the incorrect estimation of the time complexity of the XLS algorithm. Since then, no similar attacks have been proposed for symmetric-key primitives.</p>

    <p class="text-gray-300">Since there are some AO ciphers resembling AES, e.g., Friday [5], Vision [4] and RAIN [24], it seems important to revisit the modelling techniques to construct an overdefined system of quadratic equations describing these ciphers, and check</p>

    <p class="text-gray-300">whether some unexpected properties have been neglected by the designers. Such a work is meaningful as these AO ciphers are less studied and any potential weakness may lead to a fatal attack in the future. Therefore, we are motivated to dive into the algebraic structures of Friday, Vision and RAIN, and see whether some neglected properties can be identified.</p>

    <p class="text-gray-300">Although Friday has been broken in [2], the same attack cannot apply to its successor Vision. It is thus meaningful to develop a more general algebraic method that can better capture their common underlying algebraic structures, e.g., the low-degree  <span class="math">\\mathbb{F}_2</span> -linearized affine polynomials. Studying Friday is also important to this work since it is the simplest example to explain our new modelling method, though it has been broken.</p>

    <p class="text-gray-300">For the cipher RAIN, it is designed to be friendly to the post-quantum signature scheme Rainier [24] built upon the MPC-in-the-head technique, whose security relies on the difficulty of the key-recovery attack on RAIN from a single plaintext-ciphertext pair. In particular, RAIN has a very small number of rounds, i.e., 3 rounds are sufficient and 4 rounds can be used for higher security. Currently, the best attacks could only reach 2 rounds [39, 43], so attacking 3 or 4 rounds is on demand.</p>

    <p class="text-gray-300">In addition to the above 3 symmetric-key primitives, we also find that the candidate Biscuit [10] in NIST PQC Round 1 Additional Signatures may be prone to our attacks, though the inverse function is not used here. Specifically, it is also built with the MPC-in-the-head technique and relies on the difficulty to solve m structured quadratic equations in n variables over  <span class="math">\\mathbb{F}_{2^{\\ell}}</span> , which is called the powAff2 problem. As a candidate in NIST PQC project, studying Biscuit is meaningful.</p>

    <p class="text-gray-300">Our contributions. We propose a new method to overdefine the polynomial systems describing Friday, Vision, RAIN and powAff2. Solving such systems will either help find the preimage (e.g., Friday and Vision), or solve the secret key (e.g., RAIN and Biscuit). Specifically, we have the following new results:</p>

    <ul class="list-disc list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li><ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li>The preimage attack on r rounds of Friday is reduced to solving 7r quadratic equations in 4r variables over  <span class="math">\\mathbb{F}_{2^{\\ell}}</span> .</li>
    </ol></li>
      <li><ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li>The preimage attack on r rounds of Vision with  <span class="math">s \\geq 2</span>  state words is reduced to solving 5s + 14s(r-1) quadratic equations in 3s + 6s(r-1) variables over  <span class="math">\\mathbb{F}_{2^{\\ell}}</span> .</li>
    </ol></li>
      <li><ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li>The key-recovery attack on  <span class="math">r \\geq 3</span>  rounds of RAIN is reduced to solving  <span class="math">(5r+5)\\ell</span>  quadratic Boolean equations in  <span class="math">r\\ell</span>  variables. In Gr&ouml;bner basis attack, the field equation for each variable  <span class="math">x \\in \\mathbb{F}_2</span> , i.e.,  <span class="math">x^2 = x</span> , is also useful, and hence we indeed need to consider the problem to solve  <span class="math">(6r+5)\\ell</span>  quadratic equations in  <span class="math">r\\ell</span>  variables with Gr&ouml;bner basis. Moreover, we further reveal that the problem can also be reduced to solving  <span class="math">(6r+5)\\ell</span>  quadratic equations in  <span class="math">r\\ell</span>  variables over  <span class="math">\\mathbb{F}_{2^\\ell}</span> .</li>
    </ol></li>
      <li><ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li>The powAff2 problem with m quadratic equations in n variables over  <span class="math">\\mathbb{F}_{2^{\\ell}}</span>  can be overdefined as 4m + n quadratic equations in 2n variables over  <span class="math">\\mathbb{F}_{2^{\\ell}}</span> .</li>
    </ol></li>
    </ul>

    <p class="text-gray-300">However, the constructed systems of quadratic equations  <span class="math">\\{f_1(x_1,\\ldots,x_n)=0,\\ldots,f_m(x_1,\\ldots,x_n)=0\\}</span>  are not semi-regular, since there are many nontrivial syzygies, e.g., there exists a linear polynomial  <span class="math">l_{i,j}(x_1,\\ldots,x_n)=\\sum_{i=1}^n u_ix_i</span>  such that  <span class="math">l_{i,j}\\cdot f_i=f_j</span> , though both  <span class="math">f_i</span>  and  <span class="math">f_j</span>  are quadratic. Note that the trivial syzygies are caused by  <span class="math">f_i\\cdot f_j=f_j\\cdot f_i</span> , which can then generate many other trivial syzygies at a higher degree. Hence, the solving degree computed from the Hilbert series based on the assumption that  <span class="math">\\{f_1,\\ldots,f_m\\}</span>  are semi-regular is just a lower bound on the actual solving degree for solving our constructed system of equations. Intuitively speaking, there are many more rows reduced to zero as the degree of the Macaulay matrix increases (see the definition in Sect. 2) for our equation system, and hence we need to consider a higher degree compared with the case when only trivial syzygies exist.</p>

    <p class="text-gray-300">Indeed, there has been a study [6] on the cost to compute the Gr&ouml;bner basis for polynomials over  <span class="math">\\mathbb{F}_2</span>  where extra syzygies are taken in account, as detailed in Appendix B. We recommend to read it and believe that the lower bound on the solving degree is still meaningful and the difference between the actual solving degree and the one computed based on the semi-regular assumption is small for polynomial systems we study in this work. Additionally, we have experimentally verified that such lower bounds are indeed tight for small-scale equation systems, yet we cannot claim the same for higher dimensions as it lacks theoretic support. If using such lower bounds to estimate the complexity of the Gr&ouml;bner basis attack, we obtain the following results:</p>

    <ul class="list-disc list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li><ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li>As the first third-party analysis of Vision, we can improve the designers' attack by up to 7 rounds.</li>
    </ol></li>
      <li><ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li>Using 3 rounds of RAIN with the 256-bit key is insecure, and we thus recommend to use 4 rounds.</li>
    </ol></li>
      <li><ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li>All parameters of Biscuit are vulnerable to Gr&ouml;bner basis attacks, and therefore they do not meet the security requirement by NIST.</li>
    </ol></li>
    </ul>

    <p class="text-gray-300">Organization. We first briefly recall the Gr&ouml;bner basis in Section 2, and then recall how to model AES with an overdefined system of quadratic equations over  <span class="math">\\mathbb{F}_2</span>  and  <span class="math">\\mathbb{F}_{2^8}</span>  in Section 3. Next, we present our new algebraic modelling methods for Friday, Vision and RAIN, Biscuit in Section 4, Section 5, Section 6, and Section 7, respectively, and give the corresponding analysis of the time complexity as well as the experimental simulation. Finally in Section 8, we conclude this paper by summarizing our new insight into these ciphers with our modelling method.</p>

    </section>

    <section id="sec-2" class="mb-10">
      <h2 class="text-2xl font-bold">2 Preliminaries</h2>

    <p class="text-gray-300">Let  <span class="math">\\mathbb{K} = \\mathbb{F}_q</span>  be a finite field and  <span class="math">\\mathbb{K}[x_1, \\dots, x_n]</span>  be a polynomial ring defined over  <span class="math">\\mathbb{K}</span>  with  <span class="math">x_1, \\dots, x_n</span>  as variables. A multivariate polynomial system is defined as  <span class="math">\\mathcal{F} = \\{f_1(x_1, \\dots, x_n), \\dots, f_m(x_1, \\dots, x_n)\\}.</span></p>

    <p class="text-gray-300"><sup>&amp;</sup>lt;sup&gt;4</sup> This is just an example. A formal definition of syzygy can be referred to Sect. 2.</p>

    <p class="text-gray-300">Let  <span class="math">\\mathcal{I} = \\langle f_1, \\ldots, f_m \\rangle</span>  be the ideal generated by the set of polynomials  <span class="math">\\{f_1, \\ldots, f_m\\}</span> , and  <span class="math">V(\\mathcal{I})</span>  be its corresponding variety. The polynomial systems describing cryptographic primitives usually generate zero-dimensional ideals. In other words, the set of points in their corresponding variety over the algebraic closure of the field is finite. Finding the corresponding variety of an ideal is an NP-hard problem and is used as a security argument in the design of many primitives. The variety  <span class="math">V(\\mathcal{I})</span>  can be computed with the help of a special type of basis for the ideal  <span class="math">\\mathcal{I}</span>  called Gr&ouml;bner basis.</p>

    <p class="text-gray-300"><strong>Definition 1 (Gr&ouml;bner Basis [15]).</strong> The set  <span class="math">G = \\{g_1, \\ldots, g_t\\}</span>  is a Gr&ouml;bner basis for  <span class="math">\\mathcal{I} = \\langle f_1, \\ldots, f_m \\rangle</span>  if and only if  <span class="math">\\langle G \\rangle = \\mathcal{I}</span>  and  <span class="math">\\langle lm(G) \\rangle = \\langle lm(\\mathcal{I}) \\rangle</span>  where  <span class="math">\\langle lm(G) \\rangle</span>  is the ideal generated by the leading monomials of the set G.</p>

    <p class="text-gray-300">For a monomial ordering  <span class="math">\\prec</span>  and polynomial system  <span class="math">\\mathcal{F}</span> , the Macaulay matrix of  <span class="math">\\mathcal{F}</span>  with degree d is denoted by  <span class="math">\\mathcal{M}_{\\prec}[d](\\mathcal{F})</span> . Columns of  <span class="math">\\mathcal{M}_{\\prec}[d](\\mathcal{F})</span>  are labeled by monomials of degree at most d, and sorted in  <span class="math">\\prec</span> -descending order from left to right. Each row of  <span class="math">\\mathcal{M}_{\\prec}[d](\\mathcal{F})</span>  is labeled by a polynomial  <span class="math">m_j f_i</span>  where  <span class="math">deg(m_j) \\leq d - deg(f_i)</span>  and  <span class="math">m_j</span>  is a monomial in  <span class="math">x_1, \\ldots, x_n</span> .</p>

    <p class="text-gray-300">For example, let  <span class="math">\\mathcal{F} = \\{f_1, f_2\\} = \\{x^2 + xy, 4x + 3y\\}</span> . Then  <span class="math">\\mathcal{M}_{\\prec}[2](\\mathcal{F})</span>  for degrevlex order is defined as:</p>

    <p class="text-gray-300"><span class="math">$\\mathcal{M}[2](\\mathcal{F}) = \\begin{pmatrix} x^2 &amp; xy &amp; y^2 &amp; x &amp; y &amp; 1\\\\ 1 &amp; 1 &amp; 0 &amp; 0 &amp; 0 &amp; 0\\\\ 0 &amp; 0 &amp; 0 &amp; 0 &amp; 4 &amp; 3\\\\ 4 &amp; 3 &amp; 0 &amp; 0 &amp; 0 &amp; 0\\\\ 0 &amp; 4 &amp; 3 &amp; 0 &amp; 0 &amp; 0 \\end{pmatrix} \\begin{cases} f_1\\\\ f_2\\\\ xf_2\\\\ yf_2 \\end{cases}</span>$</p>

    <p class="text-gray-300">In [36], it was shown that for a large enough d, the row-echelon form of  <span class="math">\\mathcal{M}_{\\prec}[d](\\mathcal{F})</span>  gives a Gr&ouml;bner basis of  <span class="math">\\mathcal{F}</span> . Later, F4 [26] and F5 [27] were published as more efficient algorithms to compute a Gr&ouml;bner basis, which can efficiently avoid rows reduced to zero when computing  <span class="math">\\mathcal{M}_{\\prec}[d](\\mathcal{F})</span> . Using F4/F5, the complexity of computing the Gr&ouml;bner basis in <em>grevlex</em> order is as follows:</p>

    <p class="text-gray-300">
<span class="math">$\\mathcal{O}\\left(\\binom{n+D_{reg}}{D_{reg}}\\right)^{\\omega},\\tag{1}</span>$</p>

    <p class="text-gray-300">where n is the number of variables in the polynomial system,  <span class="math">D_{reg}</span>  is the degree of regularity of the system, and  <span class="math">\\omega</span>  is the linear algebra constant for Gaussian elimination.</p>

    <p class="text-gray-300">When the polynomial system is not defined over  <span class="math">\\mathbb{F}_2</span> , the Gr&ouml;bner basis in grevlex order must be converted to a Gr&ouml;bner basis in the lex order which has triangular form and can be solved efficiently. To convert the Gr&ouml;bner basis in grevlex order to lex order, the FGLM [28] algorithm is applied and its complexity is detailed as below.</p>

    <p class="text-gray-300"><strong>Proposition 1 (Complexity of the FGLM algorithm [9]).</strong> Given a Gr&ouml;bner basis  <span class="math">G_1 \\subset \\mathbb{K}[x_1, \\ldots, x_n]</span>  w.r.t. a monomial ordering  <span class="math">\\prec_1</span>  of a zero-dimensional</p>

    <p class="text-gray-300"><em>system, the complexity of computing a Gr&ouml;bner basis G</em><sup>2</sup> &sub; K[<em>x</em>1<em>, . . . , xn</em>] <em>w.r.t. a monomial ordering</em> &#8826;<sup>2</sup> <em>with FGLM is</em></p>

    <p class="text-gray-300"><span class="math">$\\mathcal{O}(n \\cdot D^{\\omega}),</span>$</p>

    <p class="text-gray-300"><em>where D is the degree of the ideal generated by G</em>1<em>, i.e., the number of solutions counted with multiplicity in the algebraic closure of</em> K<em>.</em></p>

    <p class="text-gray-300">As commented in <a href="#page-28-12">[9]</a>, the cost of changing monomial ordering is cheaper than computing the Gr&ouml;bner basis when the system has very few solutions. In our attacks, we also use the same assumption. Indeed, this is also widely used in the literature, e.g., solving the LWE problem with algebraic techniques <a href="#page-27-6">[1]</a>, algebraic attacks on cryptographic schemes like Friday <a href="#page-27-4">[2]</a>, Biscuit <a href="#page-28-13">[13]</a>, UOV <a href="#page-28-12">[9,</a> <a href="#page-29-13">29]</a>, and the designers' estimation of the resistance against Gr&ouml;bner basis attacks <a href="#page-27-2">[4,</a> <a href="#page-28-6">14,</a> <a href="#page-28-7">19,</a> <a href="#page-28-8">24,</a> <a href="#page-29-3">32,</a> <a href="#page-29-4">34]</a>, just to name a few. The reason why the Gr&ouml;bner basis attack on AES-128 <a href="#page-28-4">[16]</a> does not fall into this category is that the constructed polynomials are too special, i.e., they directly form a special Gr&ouml;bner basis <em>G</em><sup>1</sup> where each polynomial in <em>G</em><sup>1</sup> has a univariate leading monomial of the same degree as of the nonlinear component, which results in an extremely high degree of the ideal generated by this <em>G</em><sup>1</sup> according to Corollary 1 in <a href="#page-28-4">[16]</a>. Finally, we also mention that there is an improved variant of the FGLM algorithm called the sparse FGLM algorithm <a href="#page-29-12">[28]</a> with complexity O(<em>D</em>(<em>N</em><sup>1</sup> + <em>n</em> log <em>D</em>)) where <em>N</em><sup>1</sup> is the number of non-zero elements in a sparse multiplication matrix.</p>

    <p class="text-gray-300">After performing the FGLM algorithm, solving the triangular system to retrieve the solutions to the system is done via factoring polynomials of degree <em>D</em> defined over the finite field F<em><sup>q</sup></em> using the Cantor-Zassenhaus's algorithm <a href="#page-28-14">[17]</a> with complexity <a href="#page-29-14">[41]</a>:</p>

    <p class="text-gray-300"><span class="math">$\\mathcal{O}(D^2(\\log_2 D \\log_2 \\log_2 D)(\\log_2 q + \\log_2 D)),</span>$</p>

    <p class="text-gray-300">which is also viewed as less costly than computing the Gr&ouml;bner basis in our attacks.</p>

    <p class="text-gray-300"><strong>Degree of regularity.</strong> Computing the complexity of a Gr&ouml;bner basis in <a href="#page-4-0">Equa</a><a href="#page-4-0">tion 1</a> is difficult in general because computing the degree of regularity <em>Dreg</em> is challenging. The complexity of computing a Gr&ouml;bner basis is upper bounded by the <em>solving degree</em> of the system, which we denote by <em>Dsol</em>. The solving degree of a polynomial system is the smallest integer <em>d</em>, such that a row-reduced echelon form of M<a href="F"><em>d</em></a> results in a Gr&ouml;bner basis for F. Unfortunately, computing <em>Dsol</em> without computing the Gr&ouml;bner basis itself is a hard task. However, if the polynomial system F is semi-regular<a href="#page-5-0">5</a> , i.e., <em>m</em> &ge; <em>n</em>, <em>Dreg</em> can be upper bounded by the index of the first non-positive coefficient in the Hilbert series <em>Sm,n</em>(<em>z</em>) <a href="#page-27-5">[6,</a> <a href="#page-29-15">31]</a>:</p>

    <p class="text-gray-300">
<span class="math">$S_{m,n}(z) = \\frac{\\prod_{i=1}^{m} (1 - z^{\\deg(f_i)})}{(1 - z)^n},</span>$
(2)</p>

    <p class="text-gray-300"><sup>5</sup> It is conjectured that this holds for most cases <a href="#page-29-16">[30]</a>.</p>

    <p class="text-gray-300">where  <span class="math">\\deg(f_i)</span>  denotes the degree of the polynomial  <span class="math">f_i</span> . However, as far as we know, no polynomial system can be proved to be semi-regular in Gr&ouml;bner basis attacks on cryptographic primitives. It is mostly conjectured that the system is semi-regular and then experiments are run on small-scale ciphers in order to compare the theoretic solving degree derived from the Hilbert series and the actual solving degree.</p>

    <p class="text-gray-300">Although we could also rely on a similar conjecture, this may not hold for our constructed polynomial system. To understand this, it is necessary to introduce the concept called syzygy. A syzygy on  <span class="math">\\mathcal{F}</span>  is an m-tuple  <span class="math">(g_1, \\ldots, g_m) \\in \\mathbb{K}^m[x_1, \\ldots, x_n]</span>  such that</p>

    <p class="text-gray-300"><span class="math">$g_1f_1+\\ldots+g_mf_m=0.</span>$</p>

    <p class="text-gray-300">When constructing the Macaulay matrix using the naive method, i.e., multiplying all monomials  <span class="math">m_j</span>  of degree smaller than  <span class="math">d - deg(f_i)</span>  with  <span class="math">f_i</span> , there will be many syzygies generated, i.e., many rows will be reduced to 0. If the syzygies are mainly caused by the trivial ones<sup>6</sup>  <span class="math">f_i \\cdot f_j = f_j \\cdot f_i</span> , we can use the Hilbert series to upper bound the solving degree. However, if there are many non-trivial syzygies on  <span class="math">\\mathcal{F}</span> , for the same degree d, much more rows of  <span class="math">\\mathcal{M}_{\\prec}[d](\\mathcal{F})</span>  will be reduced to zero, and hence we may need to use a larger d. Hence, we conjecture that for our constructed polynomial system, the solving degree is lower bounded by the index of the first non-positive coefficient in the Hilbert series  <span class="math">S_{m,n}(z)</span> . The reader can also refer to Appendix B to better understand the above statement.</p>

    <p class="text-gray-300">On the algebra constant  <span class="math">\\omega</span> . In the context of Gr&ouml;bner basis attacks using F4/F5, due to the sparsity of the Macaulay matrix, some practical experiments in the literature suggest that using  <span class="math">\\omega=2</span>  to estimate the time complexity is realistic, e.g., the Gr&ouml;bner basis attacks on UOV [9] and Friday [2]. Our experiments for Friday, Vision and RAIN also support  <span class="math">\\omega=2</span> . Moreover, it is also common for designers to choose  <span class="math">\\omega=2</span>  to estimate the resistance against the Gr&ouml;bner basis attack [4,14,19,24,32,34].</p>

    <p class="text-gray-300">Denote the polynomial basis of the finite field  <span class="math">\\mathbb{F}_{2^{\\ell}}</span>  by  <span class="math">\\{1, t, t^2, \\dots, t^{\\ell-1}\\}</span> . Then, each element  <span class="math">z \\in \\mathbb{F}_{2^{\\ell}}</span>  can be written as  <span class="math">z = \\sum_{i=0}^{\\ell-1} \\mathbf{z}_i t^i</span>  where  <span class="math">(\\mathbf{z}_0, \\dots, \\mathbf{z}_{\\ell-1}) \\in \\mathbb{F}_2^{\\ell}</span> . In this way, it is sufficient to only use  <span class="math">\\overrightarrow{z} = (\\mathbf{z}_0, \\dots, \\mathbf{z}_{\\ell-1}) \\in \\mathbb{F}_2^{\\ell}</span>  to represent the element z in the field  <span class="math">\\mathbb{F}_{2^{\\ell}}</span> .</p>

    <p class="text-gray-300">In the polynomial ring  <span class="math">\\mathbb{F}_{2^{\\ell}}[x]</span> , the following polynomial denoted by  <span class="math">B_{\\ell}(x)</span>  is called an  <span class="math">\\mathbb{F}_2</span> -linearized affine polynomial:</p>

    <p class="text-gray-300"><span class="math">$B_{\\ell}(x) = \\lambda_0 + \\sum_{i=0}^{\\ell-1} \\lambda_{i+1} x^{2^i}.</span>$
(3)</p>

    <p class="text-gray-300"><sup>&amp;</sup>lt;sup&gt;6</sup> At a higher degree, i.e., as d of  <span class="math">\\mathcal{M}_{\\prec}[d](\\mathcal{F})</span>  increases, we then have many other trivial syzygies caused by  <span class="math">p \\cdot f_i \\cdot f_j = p \\cdot f_j \\cdot f_i</span>  for  <span class="math">\\forall p \\in \\mathbb{K}[x_1, \\dots, x_n]</span> .</p>

    <p class="text-gray-300">In particular, it corresponds to an affine transform on  <span class="math">\\overrightarrow{x}</span> . It is clear that this univariate polynomial is uniquely represented by its coefficients  <span class="math">(\\lambda_0, \\ldots, \\lambda_\\ell) \\in \\mathbb{F}_{2^\\ell}^{\\ell+1}</span> . Especially, when it is invertible, we can find its inverse denoted by  <span class="math">B_\\ell^{-1}(x)</span> , which is also of the form:</p>

    <p class="text-gray-300">
<span class="math">$B_{\\ell}^{-1}(x) = \\lambda_0&#x27; + \\sum_{i=0}^{\\ell-1} \\lambda_{i+1}&#x27; x^{2^i}.</span>$
(4)</p>

    <p class="text-gray-300">As the inverse function  <span class="math">y = x^{-1}</span>  over  <span class="math">\\mathbb{F}_{2^{\\ell}}</span>  cannot take 0 as the input, it is common to use it to construct an S-box denoted by  <span class="math">I_{\\ell}(x)</span>  in the following way:</p>

    <p class="text-gray-300">
<span class="math">$I_{\\ell}(x) = \\begin{cases} x^{-1}, &amp; \\text{for } x \\neq 0, \\\\ 0, &amp; \\text{for } x = 0. \\end{cases}</span>$
(5)</p>

    <p class="text-gray-300">For convenience, we use % to denote the modular operation, and use  <span class="math">[i_0, i_1]</span>  to denote the set of integers i satisfying  <span class="math">i_0 \\le i \\le i_1</span>  throughout this paper.</p>

      <h3 id="sec-3.1" class="text-xl font-semibold mt-8">3.1 The AES Round Function</h3>

    <p class="text-gray-300">We will not give the full description of the AES algorithm [23] here. Instead, we only focus on its round function, as it is more relevant to the algebraic modelling methods in [22, 40].</p>

    <p class="text-gray-300">The AES state is a vector of 16 words in  <span class="math">\\mathbb{F}_{2^8}</span>  and the used irreducible polynomial for  <span class="math">\\mathbb{F}_{2^8}[x]</span>  is  <span class="math">x^8+x^4+x^3+x+1</span> . For simplicity, denote the AES state by  <span class="math">(a_0,\\ldots,a_{15})\\in\\mathbb{F}_{2^8}^{16}</span> , and denote its binary representation by  <span class="math">(\\overrightarrow{a_0},\\ldots,\\overrightarrow{a_{15}})\\in\\mathbb{F}_2^{128}</span> . The round function denoted by  <span class="math">R_A</span>  can be written as</p>

    <p class="text-gray-300"><span class="math">$R_A = M_A \\circ Lin_A \\circ I_A(a_0, \\dots, a_{15}),</span>$</p>

    <p class="text-gray-300">where  <span class="math">Lin_A \\circ I_A</span>  forms the S-box layer of AES, and  <span class="math">M_A</span>  is the affine transform layer, i.e., the composition of ShiftRows, MixColumns, round constant additions and round key additions. In particular,  <span class="math">Lin_A \\circ I_A(a_0, \\ldots, a_{15})</span>  is defined as follows:</p>

    <p class="text-gray-300"><span class="math">$(I_8(a_0), \\dots, I_8(a_{15})) = I_A(a_0, \\dots, a_{15}),</span>$</p>

    <p class="text-gray-300"><span class="math">(B_8(a_0), \\dots, B_8(a_{15})) = Lin_A(a_0, \\dots, a_{15}),</span></p>

    <p class="text-gray-300">where the coefficients of  <span class="math">B_8(x)</span> , i.e.,  <span class="math">(\\lambda_0, \\ldots, \\lambda_8)</span> , satisfy  <span class="math">\\lambda_i \\neq 0</span>  for  <span class="math">i \\in [0, 8]</span> .</p>

      <h3 id="sec-3.2" class="text-xl font-semibold mt-8">3.2 Courtois-Pieprzyk's Algebraic Modelling Method</h3>

    <p class="text-gray-300">We first describe Courtois-Pieprzyk's method to construct an overdefined system of quadratic Boolean equations for AES. According to [22], the following 5 equations over  <span class="math">\\mathbb{F}_{2^{\\ell}}</span>  hold for  <span class="math">y = x^{-1}</span> :</p>

    <p class="text-gray-300"><span class="math">$xy = 1</span>$
,  <span class="math">x^2y = x</span> ,  <span class="math">xy^2 = y</span> ,  <span class="math">x^4y = x^3</span> ,  <span class="math">xy^4 = y^3</span> .</p>

    <p class="text-gray-300">If we consider these 5 equations over  <span class="math">\\mathbb{F}_{2^{\\ell}}</span> , their degrees are obviously 2, 3, 3, 5 and 5, respectively. However, if using the isomorphism between  <span class="math">\\mathbb{F}_{2^{\\ell}}</span>  and  <span class="math">\\mathbb{F}_{2^{\\ell}}^{\\ell}</span> , these 5 equations can be transformed into 5n quadratic Boolean equations in 2n Boolean variables  <span class="math">(\\overrightarrow{x}, \\overrightarrow{y})</span> . The reason is that the map  <span class="math">x \\mapsto x^{2^{i}}</span>  over  <span class="math">\\mathbb{F}_{2^{\\ell}}</span>  for a positive integer i corresponds to a linear transform in the elements in  <span class="math">\\overrightarrow{x}</span>  over  <span class="math">\\mathbb{F}_{2}</span> . In particular, it has been proved that these 5n quadratic Boolean equations are linearly independent [18].</p>

    <p class="text-gray-300">With this observation in mind, it is then trivial to construct an overdefined system of quadratic Boolean equations to describe AES by introducing intermediate variables for all outputs of  <span class="math">I_8(x)</span> . Note that except  <span class="math">I_8(x)</span> , all the remaining operations in AES are linear (or affine).</p>

    <p class="text-gray-300">In Murphy-Robshaw's method, they proposed the so-called Big Encryption System (BES), where the BES state is defined by a vector of  <span class="math">16 \\times 8 = 128</span>  elements over  <span class="math">\\mathbb{F}_{2^8}</span> . Note that the AES state is a vector of 16 elements over  <span class="math">\\mathbb{F}_{2^8}</span> . Denote the BES state by  <span class="math">(a_{0,0},\\ldots,a_{0,7},a_{1,0},\\ldots,a_{1,7},\\ldots,a_{15,7}) \\in \\mathbb{F}_{2^8}^{128}</span> , and there will be additional conditions<sup>7</sup> on such an enlarged state such that it is finally equivalent to AES, as specified below:</p>

    <p class="text-gray-300">
<span class="math">$\\forall i \\in [0, 15], \\ j \\in [0, 7]: \\ a_{i,(j+1)\\%8} = a_{i,j}^2.</span>$
(6)</p>

    <p class="text-gray-300">Or alternatively,  <span class="math">\\forall i \\in [0, 15]</span> , there are</p>

    <p class="text-gray-300"><span class="math">$(a_{i,0}, a_{i,1}, a_{i,2}, a_{i,3}, a_{i,4}, a_{i,5}, a_{i,6}, a_{i,7}) = (a_{i,0}, a_{i,0}^2, a_{i,0}^{2^2}, a_{i,0}^{2^3}, a_{i,0}^{2^4}, a_{i,0}^{2^5}, a_{i,0}^{2^7}, a_{i,0}^{2^7}).</span>$</p>

    <p class="text-gray-300">The round function of BES denoted by  <span class="math">R_B</span>  is then defined as</p>

    <p class="text-gray-300"><span class="math">$R_B = M_B \\circ Lin_B \\circ I_B(a_{0,0}, \\dots, a_{15,7}),</span>$</p>

    <p class="text-gray-300">where  <span class="math">M_B</span>  is an affine transform in the BES state words. For  <span class="math">I_B</span> , it is simply defined as:</p>

    <p class="text-gray-300"><span class="math">$(I_8(a_{0,0}),\\ldots,I_8(a_{15,7}))=I_A(a_{0,0},\\ldots,a_{15,7}).</span>$</p>

    <p class="text-gray-300">As for  <span class="math">Lin_B</span> , it is a bit more technical, and it is a block diagonal matrix with 16 identical blocks  <span class="math">L_B</span> , i.e.,  <span class="math">Lin_B = Diag_{16}(L_B)</span> , where</p>

    <p class="text-gray-300"><span class="math">$L_{B} = \\begin{pmatrix} (\\lambda_{1})^{2^{0}} &amp; (\\lambda_{2})^{2^{0}} &amp; (\\lambda_{3})^{2^{0}} &amp; (\\lambda_{4})^{2^{0}} &amp; (\\lambda_{5})^{2^{0}} &amp; (\\lambda_{6})^{2^{0}} &amp; (\\lambda_{7})^{2^{0}} &amp; (\\lambda_{8})^{2^{0}} \\\\ (\\lambda_{8})^{2^{1}} &amp; (\\lambda_{1})^{2^{1}} &amp; (\\lambda_{2})^{2^{1}} &amp; (\\lambda_{3})^{2^{1}} &amp; (\\lambda_{4})^{2^{1}} &amp; (\\lambda_{5})^{2^{1}} &amp; (\\lambda_{6})^{2^{1}} &amp; (\\lambda_{7})^{2^{0}} \\\\ (\\lambda_{7})^{2^{2}} &amp; (\\lambda_{8})^{2^{2}} &amp; (\\lambda_{1})^{2^{2}} &amp; (\\lambda_{2})^{2^{2}} &amp; (\\lambda_{3})^{2^{2}} &amp; (\\lambda_{4})^{2^{2}} &amp; (\\lambda_{5})^{2^{2}} &amp; (\\lambda_{6})^{2^{2}} \\\\ (\\lambda_{6})^{2^{3}} &amp; (\\lambda_{7})^{2^{3}} &amp; (\\lambda_{8})^{2^{3}} &amp; (\\lambda_{1})^{2^{3}} &amp; (\\lambda_{2})^{2^{3}} &amp; (\\lambda_{3})^{2^{3}} &amp; (\\lambda_{4})^{2^{3}} &amp; (\\lambda_{5})^{2^{3}} \\\\ (\\lambda_{5})^{2^{4}} &amp; (\\lambda_{6})^{2^{4}} &amp; (\\lambda_{7})^{2^{4}} &amp; (\\lambda_{8})^{2^{4}} &amp; (\\lambda_{1})^{2^{4}} &amp; (\\lambda_{2})^{2^{4}} &amp; (\\lambda_{3})^{2^{4}} &amp; (\\lambda_{4})^{2^{4}} \\\\ (\\lambda_{4})^{2^{5}} &amp; (\\lambda_{5})^{2^{5}} &amp; (\\lambda_{6})^{2^{5}} &amp; (\\lambda_{7})^{2^{5}} &amp; (\\lambda_{8})^{2^{5}} &amp; (\\lambda_{1})^{2^{5}} &amp; (\\lambda_{2})^{2^{5}} &amp; (\\lambda_{3})^{2^{5}} \\\\ (\\lambda_{3})^{2^{6}} &amp; (\\lambda_{4})^{2^{6}} &amp; (\\lambda_{5})^{2^{6}} &amp; (\\lambda_{6})^{2^{6}} &amp; (\\lambda_{7})^{2^{6}} &amp; (\\lambda_{8})^{2^{6}} &amp; (\\lambda_{1})^{2^{6}} &amp; (\\lambda_{2})^{2^{6}} \\\\ (\\lambda_{2})^{2^{7}} &amp; (\\lambda_{3})^{2^{7}} &amp; (\\lambda_{4})^{2^{7}} &amp; (\\lambda_{5})^{2^{7}} &amp; (\\lambda_{6})^{2^{7}} &amp; (\\lambda_{7})^{2^{7}} &amp; (\\lambda_{8})^{2^{7}} &amp; (\\lambda_{1})^{2^{7}} \\end{pmatrix}</span>$</p>

    <p class="text-gray-300"> <span class="math">&lt;sup&gt;^{7}&lt;/sup&gt;</span>  Indeed, the round function of  <span class="math">{\\sf BES}</span>  is constructed in such a way that these conditions can hold.</p>

    <p class="text-gray-300">In other words,  <span class="math">Lin_B</span>  is also a linear transform<sup>8</sup> in the BES state words. In this way,  <span class="math">M_B \\circ Lin_B</span>  forms an affine transform in the BES state words, and  <span class="math">I_B</span>  is the only nonlinear operation in BES. The above can be similarly performed for the key schedule, and we omit the details as these are less relevant.</p>

    <p class="text-gray-300">In a word, the internal states and round keys will become vectors of 128 elements in  <span class="math">\\mathbb{F}_{2^8}</span> . Then, represent the input state of each  <span class="math">I_8</span>  by an intermediate variable over  <span class="math">\\mathbb{F}_{2^8}</span> . In this way, each output state of  <span class="math">I_8</span>  is also affine in these variables. Moreover, due to the conditions specified in Equation 6 on the BES state, the input denoted by  <span class="math">L_{in}</span>  and output denoted by  <span class="math">L_{out}</span>  of each  <span class="math">I_8</span>  can be expressed as linear functions of the following forms:</p>

    <p class="text-gray-300">
<span class="math">$L_{in} = \\alpha_{0,0} + \\sum_{j=1}^{7} \\sum_{i=0}^{7} \\alpha_{j,i} v_{j,i}, \\quad L_{out} = \\alpha&#x27;_{0,0} + \\sum_{j=1}^{7} \\sum_{i=0}^{7} \\alpha&#x27;_{j,i} v_{j,i},</span>$
(8)</p>

    <p class="text-gray-300">where  <span class="math">v_{j,i}</span>  are those introduced intermediate variables satisfying  <span class="math">v_{j,(i+1)\\%8} = v_{j,i}^2</span>  for  <span class="math">0 \\le i \\le 7</span> , and  <span class="math">(\\alpha_{j,i}, \\alpha&#x27;_{j,i})</span>  are constant coefficients.</p>

    <p class="text-gray-300">For the inverse function  <span class="math">y=x^{-1}</span>  over  <span class="math">\\mathbb{F}_{2^{\\ell}}</span> , according to Courtois-Pieprzyk's observation, there are</p>

    <p class="text-gray-300"><span class="math">$xy = 1</span>$
,  <span class="math">x^2y = x</span> ,  <span class="math">xy^2 = y</span> ,  <span class="math">x^4y = x^3</span> ,  <span class="math">xy^4 = y^3</span></p>

    <p class="text-gray-300">which imply the following 5n quadratic equations over  <span class="math">\\mathbb{F}_{2^{\\ell}}</span>  if  <span class="math">x^{2^{i}}</span>  and  <span class="math">y^{2^{i}}</span>  for  <span class="math">0 \\le i \\le \\ell - 1</span>  are renamed as independent variables  <span class="math">x_i</span>  and  <span class="math">y_i</span> , respectively:</p>

    <p class="text-gray-300">
<span class="math">$\\begin{cases} (xy)^{2^{i}} = 1, \\to x_{i}y_{i} = 1\\\\ (x^{2}y)^{2^{i}} = x^{2^{i}} \\to x_{(i+1)\\%\\ell}y_{i} = x_{i},\\\\ (xy^{2})^{2^{i}} = y^{2^{i}} \\to x_{i}y_{(i+1)\\%\\ell} = y_{i},, &amp; \\text{for } \\forall i \\in [0, \\ell - 1]. \\\\ (x^{4}y)^{2^{i}} = (x^{3})^{2^{i}} \\to x_{(i+2)\\%\\ell}y_{i} = x_{i}x_{(i+1)\\%\\ell},\\\\ (xy^{4})^{2^{i}} = (y^{3})^{2^{i}} \\to x_{i}y_{(i+2)\\%\\ell} = y_{i}y_{(i+1)\\%\\ell}, \\end{cases}</span>$</p>

    <p class="text-gray-300">Compared with the Boolean case, it is much easier to observe that these 5n equations are linearly independent as each equation contains one term that never appears in other equations.</p>

    <p class="text-gray-300">According to the expressions of the input and output of each  <span class="math">I_8</span>  in BES shown in Equation 8, and the fact that  <span class="math">(x^{2^{j_0}} + y^{2^{j_1}})^{2^i} = x^{2^{(i+j_0)\\%\\ell}} + y^{2^{(i+j_1)\\%\\ell}}</span>  holds over  <span class="math">\\mathbb{F}_{2^\\ell}</span>  for  <span class="math">\\forall i, j_0, j_1 \\in \\mathbb{N}</span> , we can set up 5n quadratic equations for each  <span class="math">I_8</span> , resulting in an overdefined system of quadratic equations over  <span class="math">\\mathbb{F}_{2^8}</span>  to describe BES.</p>

    <p class="text-gray-300">Remark 1. The above explanation of BES is rather simplified. In our following new attacks on Friday and Vision, although we exploit a similar method, we never need to construct an equivalent cipher with an enlarged state, nor redefine the</p>

    <p class="text-gray-300"><sup>&amp;</sup>lt;sup&gt;8</sup> While there is a constant term  <span class="math">\\lambda_0</span>  in  <span class="math">B_8(x)</span>  of AES, the authors do not consider it here when defining  <span class="math">Lin_A</span>  for BES. This is because it can be moved to the definition of the affine transform  <span class="math">M_B</span> .</p>

    <p class="text-gray-300">round functions. Instead, our method is much simpler and easier to understand, i.e., we will show how to construct overdefined systems of quadratic equations over  <span class="math">\\mathbb{F}_{2^{\\ell}}</span>  directly based on the ciphers' original descriptions.</p>

    <p class="text-gray-300">In this section, we present the first application of our new modelling method inspired by Murphy-Robshaw's method. As can be observed on the application to Friday, our method is much simpler and can take full advantage of the details of  <span class="math">B_{\\ell}(x)</span> .</p>

    <p class="text-gray-300">Friday [5] is a ZK-friendly hash function over  <span class="math">\\mathbb{F}_{2^{\\ell}}</span>  ( <span class="math">\\ell \\geq 128</span> ) based on the Merkle-Damg&aring;rd (MD) construction. The round function denoted by  <span class="math">R_F</span>  of the underlying permutation denoted by Per(x, key) is defined as follows:</p>

    <p class="text-gray-300"><span class="math">$R_f(x) = k_i + C \\circ B^{-1} \\circ I_n(x),</span>$</p>

    <p class="text-gray-300">where  <span class="math">k_i \\in \\mathbb{F}_{2^{\\ell}}</span>  is the <em>i</em>-th  <span class="math">(i \\ge 1)</span>  round key generated with the master key key, and both B(x) and C(x) are  <span class="math">\\mathbb{F}_2</span> -linearized affine polynomials defined as below:</p>

    <p class="text-gray-300"><span class="math">$B(x) = x^4 + b_2 x^2 + b_1 x + b_0</span>$
,  <span class="math">C(x) = x^4 + c_2 x^2 + c_1 x + c_0</span> .</p>

    <p class="text-gray-300">By the MD construction, the compression function of Friday is</p>

    <p class="text-gray-300"><span class="math">$h_{i+1} = Per(x, h_i) + x + h_i.</span>$</p>

    <p class="text-gray-300">It should be mentioned that Friday was soon broken with Gr&ouml;bner basis at ASIACRYPT 2019 [2], where a smart algebraic modelling method was proposed. The details can be referred to Appendix A. In a word, for r rounds of Friday where r is an even number, the preimage attack can be reduced to solving  <span class="math">\\frac{r}{2}</span>  equations of degree 36 in  <span class="math">\\frac{r}{2}</span>  variables over  <span class="math">\\mathbb{F}_{2^{\\ell}}</span> .</p>

      <h3 id="sec-4.2" class="text-xl font-semibold mt-8">4.2 New Algebraic Modelling Method for Friday</h3>

    <p class="text-gray-300">It is found that the efficiency of the model proposed in [2] comes from a relatively small number of variables, though the degree of equations is high. However, our new modelling method is not related to it. Instead, it is more like Murphy-Robshaw's idea for AES, but it is improved in order to exploit the low degree (or sparsity) of the  <span class="math">\\mathbb{F}_2</span> -linearized affine polynomials B(x) and C(x). Observe that all coefficients in  <span class="math">B_8(x)</span>  of AES are nonzero, while the  <span class="math">B_\\ell(x)</span>  used in Friday satisfies  <span class="math">\\lambda_i = 0</span>  for  <span class="math">i \\in [4, \\ell]</span> .</p>

    <p class="text-gray-300">Let us consider the preimage attack on r rounds of Friday using a single block, i.e., the goal is to find x satisfying  <span class="math">h_1 = Per(x, h_0) + x + h_0</span>  for a given  <span class="math">(h_0, h_1)</span> .</p>

    <p class="text-gray-300">    <img src="_page_11_Figure_0.jpeg" alt="" class="my-4 max-w-full" />
</p>

    <p class="text-gray-300"><strong>Fig. 1:</strong> Modelling the round function of Friday</p>

    <p class="text-gray-300">As shown in <a href="#page-11-0">Figure 1,</a> introduce the variable <em>x<sup>i</sup></em> to denote the input of <em>C</em>(<em>x</em>) at the <em>i</em>-th round. Then, there will be</p>

    <p class="text-gray-300"><span class="math">$\\forall i \\in [1, r-1] : C(x_i + k_i) \\cdot B(x_{i+1}) = 1,</span>$</p>

    <p class="text-gray-300"><span class="math">$B(x_1) \\cdot (C(x_r) + k_r + h_1) = 1,</span>$</p>

    <p class="text-gray-300">where the last equation is to capture the relation between the input and output of the compression function. In more details, these <em>r</em> equations are specified as follows:</p>

    <p class="text-gray-300"><span class="math">$\\forall i \\in [1, r - 1] : (x_i^4 + c_2 x_i^2 + c_1 x_i + c_0 + k_i)(x_{i+1}^4 + b_2 x_{i+1}^2 + b_1 x_{i+1} + b_0) = 1,</span>$
<span class="math">$(x_1^4 + b_2 x_1^2 + b_1 x_1 + b_0)(x_r^4 + c_2 x_r^2 + c_1 x_r + c_0 + k_r + h_1) = 1.</span>$</p>

    <p class="text-gray-300">As can be observed, each of them is of the following form:</p>

    <p class="text-gray-300">
<span class="math">$(y^4 + c_2 y^2 + c_1 y + \\beta_1)(z^4 + b_2 z^2 + b_1 z + \\beta_2) = 1,</span>$
(10)</p>

    <p class="text-gray-300">where <em>&beta;</em>1<em>, &beta;</em><sup>2</sup> are known constants, and <em>y, z</em> are variables over F<sup>2</sup> <em>&#8467;</em> .</p>

    <p class="text-gray-300"><strong>Overdefining the polynomial system.</strong> For an equation of the form as in <a href="#page-11-1">Equation 10,</a> it is feasible to set up more quadratic equations by introducing additional variables. Specifically, let us introduce variables in the following way:</p>

    <p class="text-gray-300"><span class="math">$\\forall i \\in [0, i_{\\ell}]: \\ y_i = y^{2^i}, \\ z_i = z^{2^i}.</span>$</p>

    <p class="text-gray-300">By definition, we have the following 2<em>i<sup>&#8467;</sup></em> quadratic equations:</p>

    <p class="text-gray-300"><span class="math">$\\forall i \\in [0, i_{\\ell} - 1]: \\ y_{(i+1)\\%\\ell} = y_i^2, \\ z_{(i+1)\\%\\ell} = z_i^2.</span>$</p>

    <p class="text-gray-300">First, let us consider <em>i<sup>&#8467;</sup></em> = 2. In this case, <a href="#page-11-1">Equation 10</a> can be rewritten as</p>

    <p class="text-gray-300"><span class="math">$(y_2 + c_2y_1 + c_1y_0 + \\beta_1)(z_2 + b_2z_1 + b_1z_0 + \\beta_2) = 1.</span>$</p>

    <p class="text-gray-300">Unfortunately, it is still a single equation and more quadratic equations cannot be generated.</p>

    <p class="text-gray-300">However, this is not the case if <em>i<sup>&#8467;</sup></em> = 3. In this case, <a href="#page-11-1">Equation 10</a> is first rewritten as</p>

    <p class="text-gray-300"><span class="math">$(y_2 + c_2y_1 + c_1y_0 + \\beta_1)(z_2 + b_2z_1 + b_1z_0 + \\beta_2) = 1.</span>$</p>

    <p class="text-gray-300">Meanwhile, due to the extra variables (<em>y</em>3<em>, z</em>3), we indeed can set up 3 additional quadratic equations:</p>

    <p class="text-gray-300"><span class="math">$(y_2 + c_2y_1 + c_1y_0 + \\beta_1)^2(z_2 + b_2z_1 + b_1z_0 + \\beta_2)</span>$</p>

    <p class="text-gray-300"><span class="math">$= (y_3 + c_2^2 y_2 + c_1^2 y_1 + \\beta_1^2)(z_2 + b_2 z_1 + b_1 z_0 + \\beta_2)</span>$</p>

    <p class="text-gray-300"><span class="math">$= (y_2 + c_2 y_1 + c_1 y_0 + \\beta_1),</span>$</p>

    <p class="text-gray-300"><span class="math">$(y_2 + c_2 y_1 + c_1 y_0 + \\beta_1)(z_2 + b_2 z_1 + b_1 z_0 + \\beta_2)^2</span>$</p>

    <p class="text-gray-300"><span class="math">$= (y_2 + c_2 y_1 + c_1 y_0 + \\beta_1)(z_3 + b_2^2 z_2 + b_1^2 z_1 + \\beta_2^2)</span>$</p>

    <p class="text-gray-300"><span class="math">$= (z_2 + b_2 z_1 + b_1 z_0 + \\beta_2),</span>$</p>

    <p class="text-gray-300"><span class="math">$(y_2 + c_2 y_1 + c_1 y_0 + \\beta_1)^2 (z_2 + b_2 z_1 + b_1 z_0 + \\beta_2)^2</span>$</p>

    <p class="text-gray-300"><span class="math">$= (y_3 + c_2^2 y_2 + c_1^2 y_1 + \\beta_1^2)(z_3 + b_2^2 z_2 + b_1^2 z_1 + \\beta_2^2)</span>$</p>

    <p class="text-gray-300"><span class="math">$= 1.</span>$</p>

    <p class="text-gray-300">Therefore, for <em>r</em> rounds of Friday, by introducing 4<em>r</em> variables <em>xi,j</em> to represent <em>x</em> 2 <em>i</em> for <em>i</em> &isin; [1<em>, r</em>] and <em>j</em> &isin; [0<em>,</em> 3], we can set up (1 + 3)<em>r</em> = 4<em>r</em> quadratic equations in these variables according to the above method, and 3<em>r</em> quadratic equations by definition, i.e.,</p>

    <p class="text-gray-300"><span class="math">$\\forall i \\in [1, r], j \\in [0, 2] : x_{i, (j+1)\\%\\ell} = x_{i, j}^2.</span>$</p>

    <p class="text-gray-300">In total, <em>r</em> rounds of Friday can be modelling as 4<em>r</em> + 3<em>r</em> = 7<em>r</em> quadratic equations in 4<em>r</em> variables over F<sup>2</sup> <em>&#8467;</em> .</p>

    <p class="text-gray-300">Indeed, analyzing Friday is less interesting as it has been broken in <a href="#page-27-4">[2]</a>, but it is a good starting point to understand our new insight into such designs with low-degree <em>B&#8467;</em>(<em>x</em>). Especially, the method in <a href="#page-27-4">[2]</a> will no longer be feasible for Vision, while our new method can still apply, even though Vision is the successor of Friday and shares a very similar structure.</p>

    <p class="text-gray-300">For completeness, we give a comparison between the estimated time complexity to compute Gr&ouml;bner basis for the two methods, as shown in <a href="#page-13-0">Table 1.</a> As already stated, the estimated time complexity for our modelling method is just a lower bound.</p>

    <p class="text-gray-300"><strong>Experimental verification.</strong> To verify the complexity of our new Gr&ouml;bner basis attack, we implemented it on Friday using MAGMA <a href="#page-28-16">[12]</a> on a Linux cluster. As shown in <a href="#page-13-1">Table 2,</a> as <em>r</em> increases, the practical solving degree <em>Dsol</em> is the same with <em>Dreg</em> derived from the Hilbert series, which indicates that the lower bound is indeed tight for small-scale ciphers. Moreover, the practical running time also implies that using <em>&omega;</em> = 2 to estimate the time complexity is reasonable.</p>

    <p class="text-gray-300">After Jarvis and Friday were broken in <a href="#page-27-4">[2]</a>, another two ciphers called Vision and Rescue were proposed for the Marvellous family in <a href="#page-27-2">[4]</a>. Although Rescue</p>

    <p class="text-gray-300"><strong>Table 1:</strong> Comparison between the time complexity of Gr&ouml;bner basis attacks on Friday with different algebraic modelling methods, where the time complexity (# field operations in logarithm base 2) is estimated under <em>&omega;</em> &isin; {2<em>.</em>8<em>,</em> 2} and the complexity with <em>&omega;</em> = 2<em>.</em>8 is given in parenthesis.</p>

    <div class="overflow-x-auto my-4">
      <table class="min-w-full text-sm text-gray-300">
        <thead>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">r</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">6</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">8</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">10</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">12</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">14</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">16</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">18</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">20</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"></th>
        </thead>
        <tbody>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">The algebraic modelling method in [2]</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">#variables</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">3</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">4</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">5</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">6</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">7</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">8</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">9</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">10</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">#equations</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">3</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">4</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">5</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">6</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">7</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">8</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">9</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">10</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Dreg</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">94</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">125</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">156</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">187</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">218</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">249</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">280</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">311</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Complexity 34 (48) 47 (65) 59 (83) 72 (101) 85 (118) 97 (136) 110 (154) 123 (172)</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Our new algebraic modelling method</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">#variables</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">24</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">32</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">40</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">48</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">56</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">64</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">72</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">80</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">#equations</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">42</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">56</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">70</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">84</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">98</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">112</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">126</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">140</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Dreg</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">6</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">7</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">8</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">9</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">10</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">11</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">12</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">13</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Complexity 39 (54) 48 (67) 57 (80)</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">67 (93)</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">76 (106) 85 (119)</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">94 (131)</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">103 (144)</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
        </tbody>
      </table>
    </div>

    <p class="text-gray-300"><strong>Table 2:</strong> Experimental verification of the Gr&ouml;bner basis attack on Friday, where the complexity (# field operations in logarithm base 2) is calculated with <em>&omega;</em> = 2.</p>

    <div class="overflow-x-auto my-4">
      <table class="min-w-full text-sm text-gray-300">
        <thead>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"></th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"></th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">Rounds (r) #variables #equations Dsol</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"></th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">Dreg</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"></th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">Time(s) Complexity</th>
        </thead>
        <tbody>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">2</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">8</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">14</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">3</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">4</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">0.01</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">15</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">3</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">12</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">21</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">4</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">4</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">0.02</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">22</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">4</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">16</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">28</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">5</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">5</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1.88</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">29</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">5</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">20</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">35</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">5</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">6</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">40.35</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">32</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">6</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">24</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">42</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">6</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">6</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">3437</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">39</td>
          </tr>
        </tbody>
      </table>
    </div>

    <p class="text-gray-300">is more popular than Vision, we only focus on Vision in this work as it is very similar to Friday, and our technique can be efficiently applied. As Vision is mainly used for constructing the ZK-friendly hash function, we will no more consider the key-recovery attack as it is less meaningful. Instead, we only consider hash functions built on Vision. We find that the designers suggest to use the sponge construction to build the hash function, and the rate of the sponge construction as well as the length of the hash value are both set as half of the state size. In the following, we will focus on the preimage attack on such hash functions built on Vision.</p>

    <p class="text-gray-300">It has been explicitly stated in <a href="#page-27-2">[4]</a> that the master key will be set to zero and the corresponding generated round keys are treated as round constants when a Marvellous design is used as an unkeyed permutation. As our target is the hash function, we omit the description of the keyed Vision permutation, and only focus on the unkeyed permutation.</p>

    <p class="text-gray-300">The round function of the unkeyed permutation Vision follows the common SPN structure. The Vision state is composed of s words  <span class="math">(a_1, \\ldots, a_s) \\in \\mathbb{F}_{2^\\ell}^s</span>  where s &gt; 1, which makes it different from Friday as the Friday state is simply one word over  <span class="math">\\mathbb{F}_{2^\\ell}</span> . For the round function of Vision at the i-th round, the Vision state will pass through 8 operations, as shown below:</p>

    <p class="text-gray-300"><span class="math">$a_{j} = I_{\\ell}(a_{j}), \\ \\forall j \\in [1, s]</span>$</p>

    <p class="text-gray-300"><span class="math">$a_{j} = B_{3}^{-1}(a_{j}), \\ \\forall j \\in [1, s]</span>$</p>

    <p class="text-gray-300"><span class="math">$(a_{1}, \\dots, a_{s})^{T} = M \\cdot (a_{1}, \\dots, a_{s})^{T},</span>$</p>

    <p class="text-gray-300"><span class="math">$a_{j} = a_{j} + \\sigma_{i,j}, \\ \\forall j \\in [1, s]</span>$</p>

    <p class="text-gray-300"><span class="math">$a_{j} = I_{\\ell}(a_{j}), \\ \\forall j \\in [1, s]</span>$</p>

    <p class="text-gray-300"><span class="math">$a_{j} = B_{3}(w_{j}), \\ \\forall j \\in [1, s]</span>$</p>

    <p class="text-gray-300"><span class="math">$(a_{1}, \\dots, a_{s})^{T} = M \\cdot (a_{1}, \\dots, a_{s})^{T},</span>$</p>

    <p class="text-gray-300"><span class="math">$a_{i} = a_{i} + \\epsilon_{i,j}, \\ \\forall j \\in [1, s],</span>$</p>

    <p class="text-gray-300">where  <span class="math">M = (M[i][j])_{1 \\leq i,j \\leq s} \\in \\mathbb{F}_{2^{\\ell}}^{s \\times s}</span>  is an MDS matrix,  <span class="math">\\sigma_i = (\\sigma_{i,1}, \\ldots, \\sigma_{i,s}) \\in \\mathbb{F}_{2^{\\ell}}^{s}</span> ,  <span class="math">\\epsilon_i = (\\epsilon_{i,1}, \\ldots, \\epsilon_{i,s}) \\in \\mathbb{F}_{2^{\\ell}}^{s}</span>  are round constants, and the definitions of  <span class="math">B_3(x)</span>  and  <span class="math">I_{\\ell}(x)</span>  can be referred to Equation 4 and Equation 5, respectively. For convenience, we denote the total number of rounds of Vision by r.</p>

    <p class="text-gray-300">As can be observed, the round function is similar to Friday, i.e., they both use the inverse function, a degree-4  <span class="math">\\mathbb{F}_2</span> -linear affine polynomial and its inverse. However, the state size is increased, and thus a mixing layer M is introduced. Moreover,  <span class="math">I_{\\ell}(x)</span>  is applied twice in each round. In particular, the degree-4 affine polynomial and its inverse will be applied after the second and first  <span class="math">I_{\\ell}(x)</span>  layers, respectively. Such changes make the advanced algebraic modelling method proposed in [2] infeasible, as stated in [2]. This also implies that the advanced algebraic modelling method in [2] highly relies on the special structure of Friday, and cannot work well for a more general design.</p>

      <h3 id="sec-5.2" class="text-xl font-semibold mt-8">5.2 Modelling Vision with a Polynomial System</h3>

    <p class="text-gray-300">Let us consider r rounds of Friday. As shown in Figure 2, at the i-th round where  <span class="math">(2 \\le i \\le r)</span> , we introduce 2s variables  <span class="math">(w_{i,1}, \\ldots, w_{i,s})</span>  and  <span class="math">(z_{i,1}, \\ldots, z_{i,s})</span>  to represent the outputs of the  <span class="math">B_3^{-1}(x)</span>  layer and the second  <span class="math">I_{\\ell}(x)</span>  layer, respectively.</p>

    <p class="text-gray-300">Equations from the first and second  <span class="math">I_{\\ell}(x)</span>  in the last r-1 rounds. According to the above way to introduce intermediate variables, we can derive the following s equations according to the first  <span class="math">I_{\\ell}(x)</span>  layer at the i-th round  <span class="math">(2 \\le i \\le r)</span> :</p>

    <p class="text-gray-300">
<span class="math">$\\forall k \\in [1, s]: B_3(w_{i,k}) \\cdot \\left(\\sum_{j=1}^s M[k][j] \\cdot B_3(z_{i-1,j}) + \\epsilon_{i-1,k}\\right) = 1.</span>$
(11)</p>

    <p class="text-gray-300">    <img src="_page_15_Figure_0.jpeg" alt="" class="my-4 max-w-full" />
</p>

    <p class="text-gray-300">Fig. 2: Modelling the round function of Vision</p>

    <p class="text-gray-300">For the second  <span class="math">I_{\\ell}(x)</span>  layer at the <em>i</em>-th round  <span class="math">(2 \\le i \\le r)</span> , we similarly derive the following s equations:</p>

    <p class="text-gray-300">
<span class="math">$\\forall k \\in [1, s]: \\ z_{i,k} \\cdot (\\sum_{j=1}^{s} M[k][j] \\cdot w_{i,j} + \\sigma_{i,k}) = 1.</span>$
(12)</p>

    <p class="text-gray-300">In other words, we can set up 2s equations for each round after the 1st round. Of course, it is always assumed that the input to each  <span class="math">I_{\\ell}(x)</span>  is nonzero.</p>

    <p class="text-gray-300"><strong>Dealing with the first round.</strong> Let us consider the case of the sponge construction where the rate part and truncated part are both composed of h state words. The generic preimage attack on such a sponge-based hash function has time complexity  <span class="math">\\min(2^{h\\ell}, 2^{\\frac{(s-h)\\ell}{2}})</span> .</p>

    <p class="text-gray-300">For the preimage attack, we can simply skip the first  <span class="math">I_{\\ell}(x)</span>  layer and the  <span class="math">B_3^{-1}(x)</span>  layer, and only introduce h variables  <span class="math">(w_{1,1},\\ldots,w_{1,h})</span> . For the second  <span class="math">I_{\\ell}(x)</span>  layer, we still introduce variables  <span class="math">(z_{1,1},\\ldots,z_{1,s})</span>  to denote the output. In this way, we can set up s equations derived from the second  <span class="math">I_{\\ell}(x)</span>  layer at the 1st round.</p>

    <p class="text-gray-300">
<span class="math">$\\forall k \\in [1, s]: \\ z_{1,k} \\cdot \\left(\\sum_{j=1}^{h} M[k][j] \\cdot w_{1,j} + \\sigma_{1,k} + \\beta_{3,k}\\right) = 1, \\tag{13}</span>$</p>

    <p class="text-gray-300">where  <span class="math">(\\beta_{3,1}, \\ldots, \\beta_{3,s})</span>  are known constants computed from the capacity part of the input.</p>

    <p class="text-gray-300"><strong>Equations to match the hash value.</strong> In addition to the above equations, we will also have h equations to match the hash value denoted by  <span class="math">(\\iota_1, \\ldots, \\iota_h)</span> , as shown below:</p>

    <p class="text-gray-300">
<span class="math">$\\forall k \\in [1, h]: \\sum_{j=1}^{s} M[k][j] \\cdot B_3(z_{r,j}) + \\epsilon_{r,k} = \\iota_k.</span>$
(14)</p>

    <p class="text-gray-300">Total number of equations and variables. In total, we have introduced 2s(r-1) + h + s variables, and set up 2s(r-1) + s + h equations.</p>

      <h3 id="sec-5.3" class="text-xl font-semibold mt-8"><strong>5.3 Overdefining the Polynomial System for Vision</strong></h3>

    <p class="text-gray-300">According to the above analysis, we mainly have the two forms of equations when describing the last <em>r</em> &minus; 1 rounds of Vision with a system of equations in intermediate variables (<em>wi,k, zi,k, zi</em>&minus;1<em>,k</em>) where 1 &le; <em>k</em> &le; <em>s</em>, as shown in <a href="#page-14-0">Equation 11</a> and <a href="#page-15-1">Equation 12,</a> respectively.</p>

    <p class="text-gray-300"><strong>Dealing with <a href="#page-14-0">Equation 11.</a></strong> For <a href="#page-14-0">Equation 11,</a> it can be written in the following form:</p>

    <p class="text-gray-300">
<span class="math">$B_3(v_1) \\cdot \\left(\\alpha_1 B_3(u_1) + \\ldots + \\alpha_s B_3(u_s) + \\beta_4\\right) = 1,</span>$
(15)</p>

    <p class="text-gray-300">where <em>v</em>1<em>, u</em>1<em>, . . . , u<sup>s</sup></em> are variables, and <em>&beta;</em>4<em>, &alpha;</em>1<em>, . . . , &alpha;<sup>s</sup></em> are known constants. Therefore, we can introduce the following intermediate variables:</p>

    <p class="text-gray-300"><span class="math">$v_{1,i} = v_1^{2^i}, \\ u_{k,i} = u_k^{2^i}, \\ \\text{for} \\ \\forall k \\in [1, s], i \\in [0, i_\\ell].</span>$</p>

    <p class="text-gray-300">Let <em>i<sup>&#8467;</sup></em> = 2, according to the definition of <em>B</em>3(<em>x</em>), <a href="#page-16-0">Equation 15</a> can be written as</p>

    <p class="text-gray-300"><span class="math">$(\\lambda_3 v_{1,2} + \\lambda_2 v_{1,1} + \\lambda_1 v_{1,0} + \\lambda_0) \\left( \\sum_{j=1}^s \\sum_{i=0}^2 \\lambda_{j,i} u_{j,i} + \\beta_5 \\right) = 1,</span>$</p>

    <p class="text-gray-300">where <em>&lambda;<sup>j</sup> , &lambda;j,i, &beta;</em><sup>5</sup> are known constants. Similar to the case in Friday, it is impossible to overdefine this quadratic equation without increasing <em>i&#8467;</em>. However, in the case of Vision, we show that even with <em>i<sup>&#8467;</sup></em> = 2, it is still possible to construct an overdefined polynomial system, which comes from <a href="#page-15-1">Equation 12.</a></p>

    <p class="text-gray-300"><strong>Dealing with <a href="#page-15-1">Equation 12.</a></strong> Abusing notation, for <a href="#page-15-1">Equation 12,</a> it can be written in the following form:</p>

    <p class="text-gray-300"><span class="math">$u_1 \\cdot \\left(\\alpha_1 v_1 + \\ldots + \\alpha_s v_s + \\beta_6\\right) = 1,</span>$</p>

    <p class="text-gray-300">where <em>u</em>1<em>, v</em>1<em>, . . . , v<sup>s</sup></em> are variables, and <em>&beta;</em>6<em>, &alpha;</em>1<em>, . . . , &alpha;<sup>s</sup></em> are known constants. Hence, we also have</p>

    <p class="text-gray-300">
<span class="math">$\\begin{cases} u_{1} \\cdot (\\alpha_{1}v_{1,0} + \\ldots + \\alpha_{s}v_{s,0} + \\beta_{6}) = 1, \\\\ u_{1}^{2} \\cdot (\\alpha_{1}v_{1,0} + \\ldots + \\alpha_{s}v_{s,0} + \\beta_{6})^{2} = 1, \\\\ u_{1}^{4} \\cdot (\\alpha_{1}v_{1,0} + \\ldots + \\alpha_{s}v_{s,0} + \\beta_{6})^{4} = 1, \\\\ u_{1}^{2} \\cdot (\\alpha_{1}v_{1,0} + \\ldots + \\alpha_{s}v_{s,0} + \\beta_{6}) = u_{1}, \\\\ u_{1}^{4} \\cdot (\\alpha_{1}v_{1,0} + \\ldots + \\alpha_{s}v_{s,0} + \\beta_{6})^{2} = u_{1}^{2}, \\\\ u_{1} \\cdot (\\alpha_{1}v_{1,0} + \\ldots + \\alpha_{s}v_{s,0} + \\beta_{6})^{2} = \\alpha_{1}v_{1,0} + \\ldots + \\alpha_{s}v_{s,0} + \\beta_{6}, \\\\ u_{1}^{2} \\cdot (\\alpha_{1}v_{1,0} + \\ldots + \\alpha_{s}v_{s,0} + \\beta_{6})^{4} = (\\alpha_{1}v_{1,0} + \\ldots + \\alpha_{s}v_{s,0} + \\beta_{6})^{2}, \\\\ u_{1}^{4} \\cdot (\\alpha_{1}v_{1,0} + \\ldots + \\alpha_{s}v_{s,0} + \\beta_{6}) = u_{1}^{2} \\cdot u_{1}, \\\\ u_{1} \\cdot (\\alpha_{1}v_{1,0} + \\ldots + \\alpha_{s}v_{s,0} + \\beta_{6})^{4} = (\\alpha_{1}v_{1,0} + \\ldots + \\alpha_{s}v_{s,0} + \\beta_{6})^{2+1}. \\end{cases}</span>$</p>

    <p class="text-gray-300"><span class="math">$(16)</span>$</p>

    <p class="text-gray-300">Let us introduce the following intermediate variables:</p>

    <p class="text-gray-300"><span class="math">$u_{1,i} = u_1^{2^i}, \\ v_{k,i} = v_k^{2^i}, \\ \\text{for} \\ \\forall k \\in [1, s], i \\in [0, 2].</span>$</p>

    <p class="text-gray-300">According to</p>

    <p class="text-gray-300"><span class="math">$\\forall i \\in [0,2]: u_{1,i} = u_1^{2^i}, (\\alpha_1 v_{1,0} + \\ldots + \\alpha_s v_{s,0} + \\beta_6)^{2^i} = \\alpha_1^{2^i} v_{1,i} + \\ldots + \\alpha_s^{2^i} v_{s,i} + \\beta_6^{2^i}.</span>$</p>

    <p class="text-gray-300">Equation 16 indeed is a system of 9 quadratic equations in the introduced intermediate variables:  <span class="math">(u_{1,0}, u_{1,1}, u_{1,2}, v_{1,0}, v_{1,1}, v_{1,2}, \\dots, v_{s,0}, v_{s,1}, v_{s,2})</span> .</p>

    <p class="text-gray-300"><strong>Putting all together.</strong> According to the above analysis, if we introduce 6s(r-1) intermediate variables  <span class="math">(w_{i,k,j}, z_{i,k,j})</span>  as follows:</p>

    <p class="text-gray-300"><span class="math">$\\forall i \\in [2,r], \\forall k \\in [1,s], \\forall j \\in [0,2]: \\ w_{i,k,j} = w_{i,k}^{2^j}, \\ z_{i,k,j} = z_{i,k,j}^{2^j}</span>$</p>

    <p class="text-gray-300">there will be (9+1)(r-1)s = 10s(r-1) quadratic equations to describe the last r-1 rounds, as well as the following 4s(r-1) quadratic equations by definition:</p>

    <p class="text-gray-300"><span class="math">$\\forall i \\in [2, r], \\forall k \\in [1, s], \\forall j \\in [0, 1]: \\ w_{i,k,j+1} = w_{i,k,j}^2, \\ z_{i,k,j+1} = z_{i,k,j}^2</span>$</p>

    <p class="text-gray-300">Moreover, for the first round, we only introduce h+3s variables  <span class="math">(w_{1,1},\\ldots,w_{1,h})</span>  and  <span class="math">(z_{1,1,0},\\ldots,z_{1,s,2})</span>  where</p>

    <p class="text-gray-300"><span class="math">$\\forall k \\in [1, s], \\forall j \\in [0, 1]: \\ z_{1,k,j+1} = z_{1,k,j}^2, \\ z_{1,k,0} = z_{1,k},</span>$</p>

    <p class="text-gray-300">i.e., by definition, there are 2s quadratic equations. Then, we can generate 3s quadratic equations in these variables from Equation 13 as follows:</p>

    <p class="text-gray-300">$$\\begin{cases}
z_{1,k} \\cdot \\left(\\sum_{j=1}^{h} M[k][j] \\cdot w_{1,j} + \\sigma_{1,k} + \\beta_{3,k}\\right) = 1, \\
z_{1,k}^{2} \\cdot \\left(\\sum_{j=1}^{h} M[k][j] \\cdot w_{1,j} + \\sigma_{1,k} + \\beta_{3,k}\\right) = z_{1,k}, \\
z_{1,k}^{4} \\cdot \\left(\\sum_{j=1}^{h} M[k][j] \\cdot w_{1,j} + \\sigma_{1,k} + \\beta_{3,k}\\right) = z_{1,k}^{2} \\cdot z_{1,k}.
\\end{cases} (17)$$</p>

    <p class="text-gray-300">At last, we need to consider h equations specified in Equation 14 to match the hash value, which now becomes h linear equations in the introduced variables  <span class="math">(z_{r,1,0},\\ldots,z_{r,s,2})</span> .</p>

    <p class="text-gray-300">Total number of quadratic equations and variables. According to the above analysis, finding the preimage of r rounds of Vision can be modelled as solving 10s(r-1)+4s(r-1)+2s+3s quadratic equations and h linear equations in 6s(r-1)+h+3s variables. This is equivalent to solving 5s+14s(r-1) quadratic equations in 3s+6s(r-1) variables.</p>

    <p class="text-gray-300">Remark 2. It should be noted that the main reason why we could overdefine the polynomial system for Vision with only 3s+6s(r-1) variables are due to its special structure. More specifically, with these variables, we indeed cannot overdefine the equations describing the first inverse function in the round function, while it becomes feasible for the second inverse function. Hence, this may be an exploitable weakness for attackers to devise advanced attacks on Vision in the future.</p>

    <p class="text-gray-300">Our algebraic modelling method becomes less effective if s is too large as there will be too many variables. Hence, we only focus on the small  <span class="math">s=\\{2,4\\}</span>  and  <span class="math">h=\\frac{s}{2}</span> . For this sponge construction, the generic time complexity to find the preimage is  <span class="math">2^{\\frac{s\\ell}{2}}</span> . The time complexity to compute the Gr&ouml;bner basis for our modelling method is shown in Table 3. Note that the estimated complexity is still a lower bound.</p>

    <p class="text-gray-300">New insight into the security margin of Vision. The designers of Vision choose the secure number of rounds providing l bits of security based on the following formula:</p>

    <p class="text-gray-300"><span class="math">$\\max(10, 2 \\times \\lceil \\frac{l+s+8}{8s} \\rceil),</span>$</p>

    <p class="text-gray-300">which provides 100% security margin. Indeed, the number  <span class="math">\\frac{l+s+8}{8s}</span>  is related to their estimation of the time complexity of the Gr&ouml;bner basis attack under  <span class="math">\\omega = 2</span> , i.e., the minimal number of rounds<sup>9</sup> that can resist the Gr&ouml;bner basis attack under  <span class="math">\\omega = 2</span> . Note that in the hash function Rescue-Prime [42], the security margin is reduced to only 50%, though nothing was mentioned for Vision in [42].</p>

    <p class="text-gray-300">If the lower bound is tight, we shed new insight into the security margin of Vision. For (l,s)=(128,2), we could break up to 10 rounds under the same assumption that  <span class="math">\\omega=2</span> , while the claimed secure number of rounds is 18. For (l,s)=(256,2), we could break up to 24 rounds, while the claimed secure number of rounds is 34. In particular, for the instance with (l,s)=(256,2), if we consider only 50% security margin, the secure number of rounds will be 17+9=26, while we could attack 24 out of 26 rounds. These results have significantly advanced the understanding of the security of the Vision, and have also demonstrated the effectiveness of our new algebraic modelling method.</p>

    <p class="text-gray-300"><strong>Experimental verification.</strong> Our experimental results verify the correctness of Table 3 for s=2 and  <span class="math">r\\in\\{2,3\\}</span> . Note that 1 round of Vision is almost equal to 2 rounds of Friday, and hence we could only practically verify the Gr&ouml;bner basis attack on up to 3 rounds of Vision due to the limitations on the computational resources. The results of the experiments are summarized in Table 4. These experimental data indicate that the estimated lower bound is tight.</p>

    <p class="text-gray-300"><sup>&amp;</sup>lt;sup&gt;9</sup> Note that there is not a matching attack as the designers also made a conjecture on the solving degree according to their experimental results.</p>

    <p class="text-gray-300"><strong>Table 3:</strong> The time complexity (# field operations in logarithm base 2) of Gr&ouml;bner basis attacks on Vision using  <span class="math">\\omega = 2</span> , where those marked with &quot;-&quot; are less interesting as the corresponding time complexity is too high.</p>

    <div class="overflow-x-auto my-4">
      <table class="min-w-full text-sm text-gray-300">
        <thead>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">s</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">N</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">2</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">4</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">6</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">8</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">10</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">12</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">14</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">16</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">18</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">20</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">22</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">24</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">26</th>
        </thead>
        <tbody>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">2</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">#variables #equations <span class="math">D_{reg}</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">94</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">150<br>9</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">206<br>11</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">262<br>13</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">318<br>15</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">374<br>17</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">430<br>19</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">486<br>21</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">542<br>23</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">598<br>25</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">710<br>28</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Complexity</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">31</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">53</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">74</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">95</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">115</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">136</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">156</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">176</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">197</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">217</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">237</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">250</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">271</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">#variables</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">36</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">84</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">132</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">180</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">228</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">276</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">324</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">_</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">_</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">_</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">4</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">#equations</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">76</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">188</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">300</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">412</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">524</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">636</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">748</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">_</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">_</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">_</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">_</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">_</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">_</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">D_{reg}</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">7</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">11</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">15</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">19</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">22</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">26</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">30</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">_</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">_</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">_</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">_</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">Complexity</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">50</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">93</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">134</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">175</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">208</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">249</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">289</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">_</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">_</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">_</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">&ndash;</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">-</td>
          </tr>
        </tbody>
      </table>
    </div>

    <p class="text-gray-300"><strong>Table 4:</strong> Experimental verification of the Gr&ouml;bner basis attack on Vision, where the complexity (# field operations in logarithm base 2) is calculated with  <span class="math">\\omega = 2</span> .</p>

    <div class="overflow-x-auto my-4">
      <table class="min-w-full text-sm text-gray-300">
        <thead>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">Rounds (N</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">(s)   s   #</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">variables</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">#equations</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"><span class="math">D_{sol}</span></th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"><span class="math">D_{reg}</span></th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">Time(s)</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">Complexity</th>
        </thead>
        <tbody>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">2 3</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"><span class="math">\\begin{vmatrix} 2 \\\\ 2 \\end{vmatrix}</span></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">18<br>30</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">38<br>66</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">5 6</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">5<br>6</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1.38<br>100311</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">31<br>42</td>
          </tr>
        </tbody>
      </table>
    </div>

    </section>

    <section id="sec-6" class="mb-10">
      <h2 class="text-2xl font-bold">6 Gr&ouml;bner Basis Attack on 3-Round RAIN</h2>

    <p class="text-gray-300">RAIN [24] is a symmetric-key primitive proposed at ACM CCS 2022, and it is tailored to the post-quantum signature scheme called Rainier constructed with the MPC-in-the-head technique [33]. To improve the performance of Rainier, the designers made an aggressive choice of the secure number of rounds for RAIN, i.e., 3 or 4 rounds. Specifically, it is claimed that 3 rounds are sufficient to resist algebraic attacks, and 4 rounds can be used to further increase the security margin.</p>

    <p class="text-gray-300">It should be emphasized that the security of Rainier is based on the difficulty to recover the secret key of RAIN from a single known plaintext-ciphertext pair. In this attack setting, 2 rounds of RAIN have been shown to be insecure in [39,43]. In this section, we present new attacks on 3-round RAIN with our algebraic modelling method.</p>

    <p class="text-gray-300">    <img src="_page_19_Figure_7.jpeg" alt="" class="my-4 max-w-full" />
</p>

    <p class="text-gray-300">Fig. 3: Illustration of 3-round RAIN</p>

      <h3 id="sec-6.1" class="text-xl font-semibold mt-8">6.1 Description of 3-Round RAIN</h3>

    <p class="text-gray-300">Similar to Friday, the RAIN state is simply one word over  <span class="math">\\mathbb{F}_{2^{\\ell}}</span> . As shown in Figure 3, we denote the input and output of 3-round RAIN by  <span class="math">(x_0, x_3)</span> . Moreover, we denote the output of the first  <span class="math">I_{\\ell}(x)</span>  and the input of the last  <span class="math">I_{\\ell}(x)</span>  by  <span class="math">x_1</span>  and  <span class="math">x_2</span> , respectively. In addition, the secret key is denoted by  <span class="math">\\kappa \\in \\mathbb{F}_{2^{\\ell}}</span> , and the round constants are denoted by  <span class="math">e_0, \\ldots, e_3 \\in \\mathbb{F}_{2^{\\ell}}</span> . For the two linear transformations denoted by  <span class="math">M_1(x)</span>  and  <span class="math">M_2(x)</span> , abusing notation, they are defined as follows:</p>

    <p class="text-gray-300"><span class="math">$M_1(x) = \\sum_{j=0}^{\\ell-1} \\lambda_{1,j} x^{2^j}, \\ M_2(x) = \\sum_{j=0}^{\\ell-1} \\lambda_{2,j} x^{2^j},</span>$</p>

    <p class="text-gray-300">where  <span class="math">\\lambda_{1,j} \\neq 0, \\lambda_{2,j} \\neq 0</span>  are known constants for  <span class="math">0 \\leq j \\leq \\ell - 1</span> . Hence, both  <span class="math">M_1(x)</span>  and  <span class="math">M_2(x)</span>  can also be viewed as multiplying a binary matrix of size  <span class="math">\\ell \\times \\ell</span>  with  <span class="math">\\vec{x}</span> .</p>

    <p class="text-gray-300">By these notations, 3-round  <span class="math">\\mathsf{RAIN}</span>  can be described with the following 3 equations:</p>

    <p class="text-gray-300"><span class="math">$\\begin{cases} x_1 = I_{\\ell}(x_0 + \\kappa + e_0), \\\\ x_2 = M_2 \\left( I_{\\ell} ((M_1(x_1) + \\kappa + e_1)) \\right) + \\kappa + e_2, \\\\ x_3 = I_{\\ell}(x_2) + \\kappa + e_3. \\end{cases}</span>$</p>

    <p class="text-gray-300">If all inputs to  <span class="math">I_{\\ell}(x)</span>  are nonzero, these 3 equations can also be rewritten as</p>

    <p class="text-gray-300">
<span class="math">$\\begin{cases} x_1 \\cdot (x_0 + \\kappa + e_0) = 1, \\\\ M_2^{-1}(x_2 + \\kappa + e_2) \\cdot (M_1(x_1) + \\kappa + e_1) = 1, \\\\ x_2 \\cdot (x_3 + \\kappa + e_3) = 1, \\end{cases}</span>$
(18)</p>

    <p class="text-gray-300">where  <span class="math">M_2^{-1}(x)</span>  is the inverse of  <span class="math">M_2(x)</span> .</p>

      <h3 id="sec-6.2" class="text-xl font-semibold mt-8">6.2 Direct Application of Existing Modelling Methods</h3>

    <p class="text-gray-300">A direct application of Courtois-Pieprzyk's modelling method. Using Courtois-Pieprzyk's observation on xy=1 over  <span class="math">\\mathbb{F}_{2^{\\ell}}</span> , we can directly set up in total  <span class="math">3 \\cdot 5\\ell = 15\\ell</span>  quadratic Boolean equations in  <span class="math">3\\ell</span>  Boolean unknowns  <span class="math">(\\overrightarrow{\\kappa}, \\overrightarrow{x_1}, \\overrightarrow{x_2}) \\in \\mathbb{F}_2^{3\\ell}</span>  according to Equation 18.</p>

    <p class="text-gray-300">A direct application of Murphy-Robshaw modelling method. If we want to construct a polynomial system directly over  <span class="math">\\mathbb{F}_{2^{\\ell}}</span>  as in our attacks on Friday and Vision, we can introduce the following  <span class="math">3\\ell</span>  intermediate variables:</p>

    <p class="text-gray-300"><span class="math">$\\forall i \\in [0, \\ell - 1]: \\ x_{1,i} = x_1^{2^i}, \\ x_{2,j} = x_2^{2^i}, \\ \\kappa_i = \\kappa^{2^i},</span>$</p>

    <p class="text-gray-300">Then, based on Equation 9, we can set up  <span class="math">3 \\cdot 5\\ell = 15\\ell</span>  quadratic equations over  <span class="math">\\mathbb{F}_{2^{\\ell}}</span>  according to Equation 18. In addition, there are  <span class="math">3\\ell</span>  quadratic equations over  <span class="math">\\mathbb{F}_{2^{\\ell}}</span>  by definition:</p>

    <p class="text-gray-300"><span class="math">$\\forall i \\in [0,\\ell-1]: \\ x_{1,(i+1)\\%\\ell} = x_{1,i}^2, \\ x_{2,(i+1)\\%\\ell} = x_{2,i}^2, \\ \\kappa_{(i+1)\\%\\ell} = \\kappa_i^2.</span>$</p>

    <p class="text-gray-300">Hence, we have in total  <span class="math">18\\ell</span>  quadratic equations in  <span class="math">3\\ell</span>  variables over  <span class="math">\\mathbb{F}_{2^{\\ell}}</span> .</p>

    <p class="text-gray-300">Do we really have advantages using equations over  <span class="math">\\mathbb{F}_{2^{\\ell}}</span> ? At the first glance, there seem to be  <span class="math">3\\ell</span>  more quadratic equations if we overdefine Equation 18 directly over  <span class="math">\\mathbb{F}_{2^{\\ell}}</span> . However, in the case of Gr&ouml;bner basis attack, the field equations are also useful if they are of low degree. For Courtois-Pieprzyk's method, as they are over  <span class="math">\\mathbb{F}_2</span> , there are indeed  <span class="math">3\\ell</span>  quadratic field equations neglected, i.e., the field equation for a Boolean variable  <span class="math">x \\in \\mathbb{F}_2</span>  is  <span class="math">x^2 = x</span> . In the case of Murphy-Robshaw's method, although the field equation  <span class="math">x^{2^{\\ell}} = x</span>  for a variable  <span class="math">x \\in \\mathbb{F}_{2^{\\ell}}</span>  is of high degree, it has been implicitly used. Specifically, we have implicitly used</p>

    <p class="text-gray-300"><span class="math">$x_{1,i} = x_{1,i}^{2^{\\ell}} = (x_{1,i}^{2^{\\ell-1}})^2 = x_{1,(\\ell-1+i)\\%\\ell}^2 = x_{1,(i-1)\\%\\ell}^2,</span>$</p>

    <p class="text-gray-300"><span class="math">$x_{2,i} = x_{2,i}^{2^{\\ell}} = (x_{2,i}^{2^{\\ell-1}})^2 = x_{2,(\\ell-1+i)\\%\\ell}^2 = x_{2,(i-1)\\%\\ell}^2,</span>$</p>

    <p class="text-gray-300"><span class="math">$\\kappa_i = \\kappa_i^{2^{\\ell}} = (\\kappa_i^{2^{\\ell-1}})^2 = \\kappa_{(\\ell-1+i)\\%\\ell}^2 = \\kappa_{(i-1)\\%\\ell}^2.</span>$</p>

    <p class="text-gray-300">In other words, if we include the field equations for Courtois-Pieprzyk's method, the two constructed polynomial systems are of the same scale, i.e., the same number of variables and equations. However, one field operation over  <span class="math">\\mathbb{F}_{2^\\ell}</span>  is much more expensive than that over  <span class="math">\\mathbb{F}_2</span>  for large  <span class="math">\\ell</span> . For this perspective, it seems that using Boolean equations for RAIN is a better choice. In our experiments, we have also confirmed this.</p>

    <p class="text-gray-300">Gr&ouml;bner basis attack on 3-round RAIN. Indeed, the application of Courtois-Pieprzyk's method to RAIN has been observed by the designers of AIM, another symmetric-key primitive tailored for the post-quantum signature scheme AIMer proposed at ACM CCS 2023 [34]. By including all field equations, i.e., in total  <span class="math">15\\ell + 3\\ell</span>  quadratic equations in  <span class="math">3\\ell</span>  variables, they have given the corresponding time complexity to attack different parameters of 3-round RAIN, as shown in Table 5. Note that the complexity is not necessarily accurate, as the modelling method suffers a similar problem, i.e., the polynomial system cannot be viewed as semi-regular. However, these numbers are still valuable for designers, as they could even claim the security or do comparisons under an optimistic assumption.</p>

    <p class="text-gray-300"><strong>Table 5:</strong> The time complexity (# field operations in logarithm base 2) of the Gr&ouml;bner basis attack on 3-round RAIN under  <span class="math">\\omega = 2</span>  given in in [34]</p>

    <div class="overflow-x-auto my-4">
      <table class="min-w-full text-sm text-gray-300">
        <thead>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"><span class="math">\\ell</span></th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">#variables</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">#equations</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"><span class="math">D_{reg}</span></th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">Complexity</th>
        </thead>
        <tbody>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">128</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">384</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">2304</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">14</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">169</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">192</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">576</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">3456</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">19</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">236</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">256</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">768</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">4608</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">24</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">304</td>
          </tr>
        </tbody>
      </table>
    </div>

      <h3 id="sec-6.3" class="text-xl font-semibold mt-8">6.3 Finding More Quadratic Equations Exploiting the Structure</h3>

    <p class="text-gray-300">We still follow Courtois-Pieprzyk's method for 3-round RAIN. However, we show that  <span class="math">5\\ell</span>  quadratic Boolean equations have been completely neglected if we only</p>

    <p class="text-gray-300">focus on equations from  <span class="math">I_{\\ell}(x)</span> . Indeed, it will be clear that these  <span class="math">5\\ell</span>  additional equations are indeed caused by the special structure of 3-round RAIN, i.e., there is no linear transform before the first  <span class="math">I_{\\ell}(x)</span>  nor after the last  <span class="math">I_{\\ell}(x)</span> .</p>

    <p class="text-gray-300">Specifically, let us consider the first and last equations in Equation 18:</p>

    <p class="text-gray-300"><span class="math">$x_1 \\cdot (x_0 + \\kappa + e_0) = 1, \\ x_2 \\cdot (x_3 + \\kappa + e_3) = 1.</span>$</p>

    <p class="text-gray-300">It is easy to deduce the following equation only in the unknowns  <span class="math">(x_1, x_2)</span> :</p>

    <p class="text-gray-300"><span class="math">$\\frac{1}{x_1} + x_0 + e_0 = \\frac{1}{x_2} + x_3 + e_3.</span>$</p>

    <p class="text-gray-300">Let</p>

    <p class="text-gray-300"><span class="math">$\\theta = x_0 + e_0 + x_3 + e_3,</span>$</p>

    <p class="text-gray-300">which is a known constant to attackers, and we will have</p>

    <p class="text-gray-300">
<span class="math">$x_1 + x_2 + \\theta x_1 x_2 = 0. \\tag{19}</span>$</p>

    <p class="text-gray-300">Similar to Courtois-Pieprzyk's idea, Equation 19 can be overdefined as follows:</p>

    <p class="text-gray-300">
<span class="math">$\\begin{cases} x_1^2 + x_1 x_2 + \\theta x_1^2 x_2 = 0, \\\\ x_1 x_2 + x_2^2 + \\theta x_1 x_2^2 = 0. \\end{cases}</span>$
(20)</p>

    <p class="text-gray-300">In this way, we can obtain  <span class="math">3\\ell</span>  new quadratic Boolean equations only in  <span class="math">(\\overrightarrow{x_1}, \\overrightarrow{x_2})</span> , which have been neglected if only focusing on equations from  <span class="math">I_{\\ell}(x)</span> .</p>

    <p class="text-gray-300">One may observe that we do not multiply the cubic monomial  <span class="math">x_1^3</span>  or  <span class="math">x_2^3</span>  with  <span class="math">x_1 + x_2 + \\theta x_1 x_2</span>  as in Courtois-Pieprzyk's idea. The reason is simple. If doing so, the term  <span class="math">x_1^3 x_2</span>  or  <span class="math">x_1 x_2^3</span>  will appear, and the corresponding equation can only be converted into cubic Boolean equations in  <span class="math">(\\overrightarrow{x_1}, \\overrightarrow{x_2})</span> , while we only need quadratic Boolean equations. To obtain more quadratic equations, our crucial observation is that we can multiply a more complex polynomial with both sides of Equation 19 such that the terms like  <span class="math">x_1^3 x_2</span>  or  <span class="math">x_1 x_2^3</span>  can be eliminated. With this idea in mind, we find the following 2 new equations:</p>

    <p class="text-gray-300">
<span class="math">$\\begin{cases} (\\theta x_1^3 + x_1^2)(x_1 + x_2 + \\theta x_1 x_2) = \\theta x_1^4 + \\theta^2 x_1^4 x_2 + x_1^3 + x_1^2 x_2 = 0, \\\\ (\\theta x_2^3 + x_2^2)(x_1 + x_2 + \\theta x_1 x_2) = \\theta x_2^4 + \\theta^2 x_1 x_2^4 + x_1 x_2^2 + x_2^3 = 0. \\end{cases}</span>$
(21)</p>

    <p class="text-gray-300">Hence, the 2 new equations can be converted into  <span class="math">2\\ell</span>  new quadratic Boolean equations in  <span class="math">(\\overrightarrow{x_1}, \\overrightarrow{x_2})</span> .</p>

    <p class="text-gray-300">In summary, compared with the direct application of Courtois-Pieprzyk's method, we can set up  <span class="math">5\\ell</span>  more quadratic Boolean equations. Hence, recovering the secret key  <span class="math">\\kappa</span>  from  <span class="math">(x_0, x_3)</span>  is reduced to solving in total  <span class="math">15\\ell + 3\\ell + 5\\ell = 23\\ell</span>  quadratic equations in  <span class="math">3\\ell</span>  variables with Gr&ouml;bner basis.</p>

    <p class="text-gray-300">Remark 3. Note that the 5 new equations in Equation 19, Equation 20, Equation 21 can be easily overdefined to  <span class="math">5\\ell</span>  quadratic equations over  <span class="math">\\mathbb{F}_{2^\\ell}</span>  if we similarly introduce variables</p>

    <p class="text-gray-300"><span class="math">$\\forall i \\in [0,\\ell-1]: \\ x_{1,i} = x_1^{2^i}, \\ x_{2,j} = x_2^{2^i}, \\ \\kappa_i = \\kappa^{2^i}.</span>$</p>

    <p class="text-gray-300">Specifically, for each such equation  <span class="math">f(x_1, x_2) = 0</span> , we can have  <span class="math">f^{2^i}(x_1, x_2) = 0</span>  for  <span class="math">i \\in [0, \\ell - 1]</span> .</p>

    <p class="text-gray-300"><strong>A trivial extension to 4-round RAIN.</strong> The 4 rounds of RAIN simply appends another linear transform <em>M</em>3(<em>x</em>) and <em>In</em>(<em>x</em>), as well as another key addition and round constant addition to 3 rounds of RAIN. Our analysis can thus be trivially applied. Specifically, there are always 5<em>&#8467;</em> new quadratic Boolean equations compared with the direct usage of Courtois-Pieprzyk's method. Hence, recovering the secret key is reduced to solving 20<em>&#8467;</em> + 4<em>&#8467;</em> + 5<em>&#8467;</em> = 29<em>&#8467;</em> quadratic equations in 4<em>&#8467;</em> variables with Gr&ouml;bner basis.</p>

      <h3 id="sec-6.4" class="text-xl font-semibold mt-8"><strong>6.4 Experiments and Discussions</strong></h3>

    <p class="text-gray-300">For 3 rounds of RAIN, the key-recovery attack is equivalent to solving 23<em>&#8467;</em> Boolean equations in 3<em>&#8467;</em> Boolean variables for <em>&#8467;</em> &isin; {128<em>,</em> 192<em>,</em> 256}. We have verified that these 23<em>&#8467;</em> quadratic equations are linearly independent for <em>&#8467;</em> &le; 20, and hence there should be no structural linear dependency. With this polynomial system, our estimation of the time complexity of the Gr&ouml;bner basis attack on 3 rounds of RAIN is shown in <a href="#page-23-0">Table 6.</a> In <a href="#page-33-0">Table 10</a> of Appendix <a href="#page-31-0">B,</a> we also give the solving degree estimated with a different Hilbert series dedicated to Boolean polynomials <a href="#page-27-5">[6]</a>, and find that the time complexity of our attacks on 3-round RAIN remains the same. As already stated, we conjecture that it is a lower bound on the actual complexity. Based on these results, using 3 rounds for 256-bit security may be too aggressive, though the complexity 2 <sup>252</sup> is just a lower bound. However, such a method cannot attack 4-round RAIN according to our calculations.</p>

    <p class="text-gray-300"><strong>Table 6:</strong> The time complexity of Gr&ouml;bner basis attacks on 3-round RAIN, where the time complexity (# field operations in logarithm base 2) is estimated under <em>&omega;</em> &isin; {2<em>.</em>8<em>,</em> 2} and the complexity with <em>&omega;</em> = 2<em>.</em>8 is given in parenthesis.</p>

    <div class="overflow-x-auto my-4">
      <table class="min-w-full text-sm text-gray-300">
        <thead>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">Rounds (N)</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">&#8467;</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">#variables</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">#equations</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">Dreg</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">Complexity</th>
        </thead>
        <tbody>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">3</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">128</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">384</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">2944</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">11</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">139 (195)</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">192</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">576</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">4416</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">15</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">196 (274)</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">256</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">768</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">5888</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">19</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">252 (352)</td>
          </tr>
        </tbody>
      </table>
    </div>

    <p class="text-gray-300"><strong>Experimental verification.</strong> To verify our estimation of the time complexity of the 3-round Gr&ouml;bner basis attack using 23<em>&#8467;</em> quadratic equations, we have performed experiments for <em>&#8467;</em> &le; 20, as shown in <a href="#page-24-0">Table 7.</a> For comparison, we also performed the experiments for the Gr&ouml;bner basis attack using only 18<em>&#8467;</em> quadratic equations by excluding our newly observed 5<em>&#8467;</em> quadratic equations, as shown in <a href="#page-24-0">Table 7.</a> It is interesting to observe from <a href="#page-24-0">Table 7</a> the following facts:</p>

    <ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li>The actual solving degree is always the same under the same <em>&#8467;</em> in the two experiments, which indicates that the performance of the actual 3-round Gr&ouml;bner basis attack using 18<em>&#8467;</em> and 23<em>&#8467;</em> quadratic equations may be the same. A possible explanation is that the additional 5<em>&#8467;</em> quadratic equations can be automatically discovered when computing the Gr&ouml;bner basis of the 18<em>&#8467;</em> quadratic polynomials. However, this also indicates that there will be a degree fall when computing the Gr&ouml;bner basis of the 18<em>&#8467;</em> quadratic equations, and the solving degree will become smaller than that derived from the Hilbert series <em>S</em>18<em>&#8467;,</em>3<em>&#8467;</em>(<em>z</em>) shown in <a href="#page-5-1">Equation 2,</a> which will result in an over-estimation of the complexity of the attack and wrong security claims.</li>
    </ol>

    <ul class="list-disc list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li><ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li>As <em>&#8467;</em> increases, the solving degree derived from the Hilbert series <em>S</em>23<em>&#8467;,</em>3<em><sup>&#8467;</sup></em>(<em>z</em>) becomes tighter. For example, when <em>&#8467;</em> = 20, we have <em>Dsol</em> = <em>Ddeg</em> = 4 for 23<em>&#8467;</em> equations, while it is <em>Dsol</em> = 4 <em>&lt; Dreg</em> = 5 for 18<em>&#8467;</em> equations. In some sense, it supports the above conclusion i.e., the actual solving degree is over-estimated using only 18<em>&#8467;</em> quadratic equations.</li>
    </ol></li>
      <li><ol class="list-decimal list-inside space-y-1 text-gray-300 my-2 ml-4">
      <li>In the cases <em>&#8467;</em> &isin; {13<em>,</em> 14}, it supports our claim that <em>Dreg</em> computed from the Hilbert series is a lower bound on the actual solving degree <em>Dsol</em>.</li>
    </ol></li>
    </ul>

    <p class="text-gray-300">Since it is unclear when cases like <em>&#8467;</em> &isin; {13<em>,</em> 14} will happen again, we cannot conclude that our estimated time complexity of the Gr&ouml;bner basis attack on 3-round RAIN must be correct by using 23<em>&#8467;</em> quadratic equations. However, our experiments also indicate that the time complexity must be underestimated as <em>&#8467;</em> increases if only considering 18<em>&#8467;</em> quadratic equations. We thus believe that the newly observed 5<em>&#8467;</em> quadratic equations do help better estimate the actual solving degree, though finding a theoretic tight upper bound on the actual solving degree looks challenging.</p>

    <p class="text-gray-300"><strong>Table 7:</strong> Experimental results for the Gr&ouml;bner basis attack on 3-round RAIN, where we choose <em>&omega;</em> = 2 to estimate the time complexity (# field operations in logarithm base 2).</p>

    <div class="overflow-x-auto my-4">
      <table class="min-w-full text-sm text-gray-300">
        <thead>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"></th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">(a) (23&#8467; equations, 3&#8467; variables)</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"></th>
        </thead>
        <tbody>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
        </tbody>
      </table>
    </div>

    <div class="overflow-x-auto my-4">
      <table class="min-w-full text-sm text-gray-300">
        <thead>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"></th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">(b) (18&#8467; equations, 3&#8467; variables)</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"></th>
        </thead>
        <tbody>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
          </tr>
        </tbody>
      </table>
    </div>

    <div class="overflow-x-auto my-4">
      <table class="min-w-full text-sm text-gray-300">
        <thead>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">&#8467;</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">Dreg</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">Dsol</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"></th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">Time(s) Complexity</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">&#8467;</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">Dreg</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">Dsol</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"></th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">Time(s) Complexity</th>
        </thead>
        <tbody>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">12</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">3</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">3</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">0.99</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">27</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">12</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">4</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">3</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1.06</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">27</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">13</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">3</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">4</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">4.72</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">34</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">13</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">4</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">4</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">5.88</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">34</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">14</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">3</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">4</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">9.9</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">35</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">14</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">4</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">4</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">10.8</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">35</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">15</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">4</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">4</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">17.09</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">36</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">15</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">4</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">4</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">18.75</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">36</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">16</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">4</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">4</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">33.26</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">37</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">16</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">4</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">4</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">34.56</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">37</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">17</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">4</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">4</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">62.59</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">37</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">17</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">4</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">4</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">64.02</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">37</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">18</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">4</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">4</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">121.57</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">38</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">18</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">4</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">4</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">125.44</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">38</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">19</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">4</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">4</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">262.76</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">38</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">19</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">4</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">4</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">640.27</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">38</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">20</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">4</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">4</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">2625</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">39</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">20</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">5</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">4</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">2911</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">45</td>
          </tr>
        </tbody>
      </table>
    </div>

    <p class="text-gray-300">Biscuit [10] is a post-quantum signature scheme proposed at ACNS 2024, and it is also one candidate in NIST PQC Round 1 Additional Signatures. Similar to Rainier and AlMer, Biscuit is built with the MPC-in-the-head technique. However, its security relies on the hardness of the so-called powAff2 problem defined below, which is a structured variant of the MQ problem.</p>

    <p class="text-gray-300"><strong>Definition 2 (PowAff2 Problem).</strong> Let  <span class="math">d_i, a_{i,j}, b_{i,j}, c_{i,j}</span>  be known elements over  <span class="math">\\mathbb{F}_q</span>  where  <span class="math">i \\in [1, m]</span>  and  <span class="math">j \\in [1, n]</span> . Given m quadratic equations  <span class="math">\\{f_1(x_1, \\ldots, x_n) = 0, \\ldots, f_m(x_1, \\ldots, x_n) = 0\\}</span>  in n variables  <span class="math">(x_1, \\ldots, x_n) \\in \\mathbb{F}_q^n</span> , where each  <span class="math">f_i</span>  is of the following form:</p>

    <p class="text-gray-300"><span class="math">$f_i(x_1, \\dots, x_n) = d_i + \\sum_{j=1}^n a_{i,j} x_j + \\sum_{j=1}^n b_{i,j} x_j \\times \\sum_{j=1}^n c_{i,j} x_j,</span>$</p>

    <p class="text-gray-300">find the solution of  <span class="math">(x_1, \\ldots, x_n)</span> .</p>

    <p class="text-gray-300">Specifically, if the attacker can solve the powAff2 problem, the secret key of Biscuit will be recovered and Biscuit will become insecure. In particular,  <span class="math">q=2^8</span>  is chosen in Biscuit. We should mention that  <span class="math">q=2^4</span>  was used in its first version, but it soon got broken by a guess-and-determine (GnD) attack with time complexity  <span class="math">\\mathcal{O}(n^3q^{n/2})</span>  [13]. In this work, we only consider the later version, i.e.,  <span class="math">q=2^8</span> .</p>

    <p class="text-gray-300">Parameters for Biscuit. Biscuit can provide 128, 192, and 256 bits of security, respectively. The choices of (n, m) for 128/192/256-bit security can be referred to Table 8. In particular, the designers have checked that these parameters are secure against the Gr&ouml;bner basis attack under  <span class="math">\\omega = 2</span>  and the GnD attack in [13].</p>

      <h3 id="sec-7.1" class="text-xl font-semibold mt-8">7.1 New Insight into the PowAff2 Problem over <span class="math">\\mathbb{F}_{2^{\\ell}}</span></h3>

    <p class="text-gray-300">Let us introduce intermediate variables  <span class="math">x_{i+n}</span>  to represent  <span class="math">x_i^2</span> , i.e.,  <span class="math">x_{i+n} = x_i^2</span>  for  <span class="math">i \\in [1, n]</span> . In this way, we can overdefine each  <span class="math">f_i</span>   <span class="math">(1 \\le i \\le m)</span>  with 4 quadratic equations in  <span class="math">(x_1, \\ldots, x_{2n})</span> , as shown below:</p>

    <p class="text-gray-300"><span class="math">$\\begin{cases} d_{i} + \\sum_{j=1}^{n} a_{i,j} x_{j} + \\sum_{j=1}^{n} b_{i,j} x_{j} \\times \\sum_{j=1}^{n} c_{i,j} x_{j} = 0, \\\\ (d_{i} + \\sum_{j=1}^{n} a_{i,j} x_{j}) \\times \\sum_{j=1}^{n} b_{i,j} x_{j} + \\sum_{j=1}^{n} b_{i,j}^{2} x_{j+n} \\times \\sum_{j=1}^{n} c_{i,j} x_{j} = 0, \\\\ (d_{i} + \\sum_{j=1}^{n} a_{i,j} x_{j}) \\times \\sum_{j=1}^{n} c_{i,j} x_{j} + \\sum_{j=1}^{n} b_{i,j} x_{j} \\times \\sum_{j=1}^{n} c_{i,j}^{2} x_{j+n} = 0, \\\\ d_{i}^{2} + \\sum_{j=1}^{n} a_{i,j}^{2} x_{j+n} + \\sum_{j=1}^{n} b_{i,j}^{2} x_{j+n} \\times \\sum_{j=1}^{n} c_{i,j}^{2} x_{j+n} = 0. \\end{cases}</span>$</p>

    <p class="text-gray-300"><span class="math">$(22)</span>$</p>

    <p class="text-gray-300">By the definition that  <span class="math">x_{i+n} = x_i^2</span>  for  <span class="math">i \\in [1, n]</span> , we have n quadratic equations in  <span class="math">(x_1, \\ldots, x_{2n})</span> . Moreover, from each  <span class="math">f_i = 0</span> , we can derive 4 quadratic equations in  <span class="math">(x_1, \\ldots, x_{2n})</span> . As there are m equations  <span class="math">f_i = 0</span> , we can set up in total 4m + n quadratic equations in 2n variables. In other words, solving PowAff2 over  <span class="math">\\mathbb{F}_{2^\\ell}</span>  is reduced to solving 4m + n quadratic equations in 2n variables over  <span class="math">\\mathbb{F}_{2^\\ell}</span> .</p>

    <p class="text-gray-300">To verify that the polynomials are indeed linearly independent, we performed experimental verification. We sampled 50 different polynomial systems with (n,m)=(50,52), and formed the system with 2n variables and 4m+n equations. In all 50 cases, the polynomials are indeed linearly independent. The same also holds for the parameters (n,m)=(89,92) and (n,m)=(127,130).</p>

    <p class="text-gray-300">Complexity and experiments. Similarly, we rely on the Hilbert series to compute the time complexity to solve 4m + n quadratic equations in 2n with Gr&ouml;bner basis, as shown in Table 8. As already stated, it is conjectured that the estimated time complexity is a lower bound. However, we also emphasize that in our experiments on small (n, m), the solving degree computed from Hilbert series  <span class="math">S_{4m+n,2n}(z)</span>  is tight. Since 1 field multiplication over  <span class="math">\\mathbb{F}_{2^{\\ell}}</span>  is roughly equal to  <span class="math">\\ell^2</span>  bit operations, according to Table 8, we claim that the lower bounds are  <span class="math">2^{104}/2^{159}/2^{221}</span>  bits operations for 128/192/256-bit security levels, respectively.</p>

    <p class="text-gray-300"><strong>Table 8:</strong> The time complexity (# field operations in logarithm base 2) of Gr&ouml;bner basis attacks on Biscuit, which is estimated under  <span class="math">\\omega = 2</span> .</p>

    <div class="overflow-x-auto my-4">
      <table class="min-w-full text-sm text-gray-300">
        <thead>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">Security</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">(n,m)</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">#variables</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">#equations</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"><span class="math">D_{sol}</span></th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">Complexity</th>
        </thead>
        <tbody>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">128</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">(50, 52)</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">100</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">258</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">11</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">98</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">192</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">(89, 92)</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">178</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">457</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">16</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">153</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">256</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">(127, 130)</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">254</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">647</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">22</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">215</td>
          </tr>
        </tbody>
      </table>
    </div>

    <p class="text-gray-300">In Table 9, the experimental result for computing the Gr&ouml;bner basis for toy parameters is depicted. These experimental data indicate that  <span class="math">D_{sol} \\leq D_{reg}</span>  for all cases, and hence our time complexity evaluation is tight for the small-scale powAff2 problem. Moreover, the running time of our experiments also indicates that using  <span class="math">\\omega = 2</span>  is reasonable.</p>

    </section>

    <section id="sec-8" class="mb-10">
      <h2 class="text-2xl font-bold">8 Conclusion</h2>

    <p class="text-gray-300">This study aims to deepen the understanding of how to overdefine a polynomial system with Courtois-Pieprzyk's and Murphy-Robshaw's ideas. In particular, it is found that the polynomial systems for Friday, Vision, RAIN and Biscuit can all be overdefined for different reasons. For Friday and Vision, it is mainly due to the low-degree  <span class="math">\\mathbb{F}_2</span> -linearized affine polynomial. For RAIN, the system can be much more overdefined for its special structure, i.e., no linear mixing layers exist before the first nonlinear layer and after the last nonlinear layer defined by the</p>

    <p class="text-gray-300"><strong>Table 9:</strong> Experimental results for Biscuit over  <span class="math">\\mathbb{F}_{2^8}</span> , where the time complexity (# field operations in logarithm base 2) is computed under  <span class="math">\\omega = 2</span> . The complexity of our approach is compared with the complexity of solving the polynomial system with n variables and m equations described in [10]</p>

    <div class="overflow-x-auto my-4">
      <table class="min-w-full text-sm text-gray-300">
        <thead>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">n</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"><span class="math">\\mid m \\mid</span></th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"># variables</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">#equations</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"><span class="math">D_{sol}</span></th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"><span class="math">D_{reg}</span></th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">Complexity</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">Complexity [10</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left"><span class="math">] \\mid Time(s)</span></th>
        </thead>
        <tbody>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">11</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">13</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">22</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">63</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">4</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">4</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">28</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">27</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">2.03</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">12</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">14</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">24</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">68</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">4</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">4</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">29</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">31</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">19.4</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">13</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">15</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">26</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">73</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">5</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">5</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">35</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">34</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">471.8</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">14</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">16</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">28</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">78</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">5</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">5</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">36</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">34</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">3034.2</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">15</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">17</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">30</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">83</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">5</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">5</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">37</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">38</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">12530</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">16</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">18</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">32</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">88</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">5</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">5</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">37</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">39</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">48562</td>
          </tr>
        </tbody>
      </table>
    </div>

    <p class="text-gray-300">inverse function over  <span class="math">\\mathbb{F}_{2^\\ell}</span> . For Biscuit, by exploiting the special structure of the powAff2 problem over  <span class="math">\\mathbb{F}_{2^\\ell}</span> , i.e., all quadratic terms in each quadratic equation are produced by the multiplication of two linear polynomials, an overdefined polynomial system can be efficiently set up by introducing additional variables. However, how to estimate the time complexity to solve these polynomial systems is challenging, since they are not semi-regular. We leave this as an open problem, and believe that it will have many applications in algebraic attacks.</p>

    </section>

    <section id="references" class="mb-10">
      <h2 class="text-2xl font-bold">References</h2>

    <ul class="space-y-2 text-gray-400 text-sm list-none">
      <li><p class="text-gray-300">1. M. R. Albrecht, C. Cid, J. Faug&egrave;re, R. Fitzpatrick, and L. Perret. Algebraic algorithms for LWE problems. <em>ACM Commun. Comput. Algebra</em>, 49(2):62, 2015.</p></li>
      <li><p class="text-gray-300">2. M. R. Albrecht, C. Cid, L. Grassi, D. Khovratovich, R. L&uuml;ftenegger, C. Rechberger, and M. Schofnegger. Algebraic Cryptanalysis of STARK-Friendly Designs: Application to MARVELlous and MiMC. In ASIACRYPT (3), volume 11923 of Lecture Notes in Computer Science, pages 371&ndash;397. Springer, 2019.</p></li>
      <li><p class="text-gray-300">3. M. R. Albrecht, L. Grassi, C. Rechberger, A. Roy, and T. Tiessen. MiMC: Efficient Encryption and Cryptographic Hashing with Minimal Multiplicative Complexity. In <em>ASIACRYPT</em> (1), volume 10031 of <em>Lecture Notes in Computer Science</em>, pages 191&ndash;219, 2016.</p></li>
      <li><p class="text-gray-300">4. A. Aly, T. Ashur, E. Ben-Sasson, S. Dhooghe, and A. Szepieniec. Design of Symmetric-Key Primitives for Advanced Cryptographic Protocols. <em>IACR Trans. Symmetric Cryptol.</em>, 2020(3):1&ndash;45, 2020.</p></li>
      <li><p class="text-gray-300"> T. Ashur and S. Dhooghe. MARVELlous: a STARK-Friendly Family of Cryptographic Primitives. Cryptology ePrint Archive, Paper 2018/1098, 2018. https://eprint.iacr.org/2018/1098.</p></li>
      <li><p class="text-gray-300"> M. Bardet, J.-C. Faug&egrave;re, and B. Salvy. Asymptotic Behaviour of the Index of Regularity of Semi-Regular Quadratic Polynomial Systems. In MEGA 2005 - 8th International Symposium on Effective Methods in Algebraic Geometry, pages 1&ndash;17, Porto Conte, Alghero, Sardinia, Italy, May 2005.</p></li>
      <li><p class="text-gray-300"> A. Bariant, A. Boeuf, A. Lemoine, I. M. Ayala, M. &Oslash;ygarden, L. Perrin, and H. Raddum. The Algebraic Freelunch Efficient Gr&ouml;bner Basis Attacks Against Arithmetization-Oriented Primitives. Cryptology ePrint Archive, Paper 2024/347, 2024. https://eprint.iacr.org/2024/347.</p></li>
      <li><p class="text-gray-300">8. D. Bayer and M. E. Stillman. On the Complexity of Computing Syzygies. <em>J. Symb. Comput.</em>, 6:135&ndash;147, 1988.</p></li>
      <li><p class="text-gray-300">9. L. Bettale, J. Faug&egrave;re, and L. Perret. Hybrid Approach for Solving Multivariate Systems over Finite Fields. <em>J. Math. Cryptol.</em>, 3(3):177&ndash;197, 2009.</p></li>
      <li><p class="text-gray-300">10. L. Bettale, D. Kahrobaei, L. Perret, and J. A. Verbel. Biscuit: New MPCitH Signature Scheme from Structured Multivariate Polynomials. In <em>ACNS (1)</em>, volume 14583 of <em>Lecture Notes in Computer Science</em>, pages 457&ndash;486. Springer, 2024.</p></li>
      <li><p class="text-gray-300">11. T. Beyne, A. Canteaut, I. Dinur, M. Eichlseder, G. Leander, G. Leurent, M. Naya-Plasencia, L. Perrin, Y. Sasaki, Y. Todo, and F. Wiemer. Out of Oddity - New Cryptanalytic Techniques Against Symmetric Primitives Optimized for Integrity Proof Systems. In <em>CRYPTO (3)</em>, volume 12172 of <em>Lecture Notes in Computer Science</em>, pages 299&ndash;328. Springer, 2020.</p></li>
      <li><p class="text-gray-300">12. W. Bosma, J. Cannon, and C. Playoust. The Magma algebra system. I. The user language. <em>J. Symbolic Comput.</em>, 24(3-4):235&ndash;265, 1997. Computational algebra and number theory (London, 1993).</p></li>
      <li><p class="text-gray-300">13. C. Bouillaguet and J. Sauvage. Preliminary cryptanalysis of the biscuit signature scheme. <em>IACR Communications in Cryptology</em>, 1(1), 2024.</p></li>
      <li><p class="text-gray-300">14. C. Bouvier, P. Briaud, P. Chaidos, L. Perrin, R. Salen, V. Velichkov, and D. Willems. New Design Techniques for Efficient Arithmetization-Oriented Hash Functions: Anemoi Permutations and Jive Compression Mode. In <em>CRYPTO (3)</em>, volume 14083 of <em>Lecture Notes in Computer Science</em>, pages 507&ndash;539. Springer, 2023.</p></li>
      <li><p class="text-gray-300">15. B. Buchberger. Bruno Buchberger's PhD thesis 1965: An algorithm for finding the basis elements of the residue class ring of a zero dimensional polynomial ideal. <em>Journal of Symbolic Computation</em>, 41(3):475&ndash;511, 2006. Logic, Mathematics and Computer Science: Interactions in honor of Bruno Buchberger (60th birthday).</p></li>
      <li><p class="text-gray-300">16. J. Buchmann, A. Pyshkin, and R. Weinmann. A Zero-Dimensional Gr&ouml;bner Basis for AES-128. In <em>FSE</em>, volume 4047 of <em>Lecture Notes in Computer Science</em>, pages 78&ndash;88. Springer, 2006.</p></li>
      <li><p class="text-gray-300">17. D. G. Cantor and H. Zassenhaus. A New Algorithm for Factoring Polynomials Over Finite Fields. <em>Mathematics of Computation</em>, 36(154):587&ndash;592, 1981.</p></li>
      <li><p class="text-gray-300">18. J. H. Cheon and D. H. Lee. Resistance of S-Boxes against Algebraic Attacks. In <em>FSE</em>, volume 3017 of <em>Lecture Notes in Computer Science</em>, pages 83&ndash;94. Springer, 2004.</p></li>
      <li><p class="text-gray-300">19. J. Cho, J. Ha, S. Kim, B. Lee, J. Lee, J. Lee, D. Moon, and H. Yoon. Transciphering Framework for Approximate Homomorphic Encryption. In <em>ASIACRYPT (3)</em>, volume 13092 of <em>Lecture Notes in Computer Science</em>, pages 640&ndash;669. Springer, 2021.</p></li>
      <li><p class="text-gray-300">20. C. Cid and G. Leurent. An Analysis of the XSL Algorithm. In <em>ASIACRYPT</em>, volume 3788 of <em>Lecture Notes in Computer Science</em>, pages 333&ndash;352. Springer, 2005.</p></li>
      <li><p class="text-gray-300">21. N. T. Courtois, A. Klimov, J. Patarin, and A. Shamir. Efficient Algorithms for Solving Overdefined Systems of Multivariate Polynomial Equations. In <em>EUROCRYPT</em>, volume 1807 of <em>Lecture Notes in Computer Science</em>, pages 392&ndash;407. Springer, 2000.</p></li>
      <li><p class="text-gray-300">22. N. T. Courtois and J. Pieprzyk. Cryptanalysis of Block Ciphers with Overdefined Systems of Equations. In <em>ASIACRYPT</em>, volume 2501 of <em>Lecture Notes in Computer Science</em>, pages 267&ndash;287. Springer, 2002.</p></li>
      <li><p class="text-gray-300">23. J. Daemen and V. Rijmen. AES and the Wide Trail Design Strategy. In <em>EU-ROCRYPT</em>, volume 2332 of <em>Lecture Notes in Computer Science</em>, pages 108&ndash;109. Springer, 2002.</p></li>
      <li><p class="text-gray-300">24. C. Dobraunig, D. Kales, C. Rechberger, M. Schofnegger, and G. Zaverucha. Shorter Signatures Based on Tailor-Made Minimalist Symmetric-Key Crypto. In <em>CCS</em>, pages 843&ndash;857. ACM, 2022.</p></li>
      <li><p class="text-gray-300">25. M. Eichlseder, L. Grassi, R. L&uuml;ftenegger, M. &Oslash;ygarden, C. Rechberger, M. Schofnegger, and Q. Wang. An Algebraic Attack on Ciphers with Low-Degree Round Functions: Application to Full MiMC. In <em>ASIACRYPT (1)</em>, volume 12491 of <em>Lecture Notes in Computer Science</em>, pages 477&ndash;506. Springer, 2020.</p></li>
      <li><p class="text-gray-300">26. J.-C. Faug&egrave;re. A new efficient algorithm for computing Gr&ouml;bner bases (F4). <em>Journal of Pure and Applied Algebra</em>, 139:61&ndash;88, 1999.</p></li>
      <li><p class="text-gray-300">27. J.-C. Faug&egrave;re. A new Efficient Algorithm for Computing Grobner Bases without Reduction to Zero (F5). <em>ISSAC '02 : Proceedings of the 2002 international symposium on Symbolic and algebraic computation, New York, NY, USA</em>, pages 75&ndash;83, 2002.</p></li>
      <li><p class="text-gray-300">28. J.-C. Faug&egrave;re and C. Mou. Sparse FGLM Algorithms. <em>Journal of Symbolic Computation</em>, 80:538&ndash;569, 2017.</p></li>
      <li><p class="text-gray-300">29. J.-C. Faug&egrave;re and L. Perret. On the Security of UOV. Cryptology ePrint Archive, Paper 2009/483, 2009. <a href="https://eprint.iacr.org/2009/483" target="_blank" rel="noopener noreferrer">https://eprint.iacr.org/2009/483</a>.</p></li>
      <li><p class="text-gray-300">30. R. Fr&ouml;berg. An Inequality for Hilbert Series of Graded Algebras. <em>Mathematica Scandinavica</em>, 56(2):117&ndash;144, 1985.</p></li>
      <li><p class="text-gray-300">31. R. Fr&ouml;berg. An inequality for hilbert series of graded algebras. <em>Mathematica Scandinavica</em>, 56, December 1985.</p></li>
      <li><p class="text-gray-300">32. L. Grassi, D. Khovratovich, C. Rechberger, A. Roy, and M. Schofnegger. Poseidon: A New Hash Function for Zero-Knowledge Proof Systems. In <em>USENIX Security Symposium</em>, pages 519&ndash;535. USENIX Association, 2021.</p></li>
      <li><p class="text-gray-300">33. Y. Ishai, E. Kushilevitz, R. Ostrovsky, and A. Sahai. Zero-knowledge from secure multiparty computation. In <em>STOC</em>, pages 21&ndash;30. ACM, 2007.</p></li>
      <li><p class="text-gray-300">34. S. Kim, J. Ha, M. Son, B. Lee, D. Moon, J. Lee, S. Lee, J. Kwon, J. Cho, H. Yoon, and J. Lee. AIM: Symmetric Primitive for Shorter Signatures with Stronger Security. In <em>CCS</em>, pages 401&ndash;415. ACM, 2023.</p></li>
      <li><p class="text-gray-300">35. K. Koschatko, R. L&uuml;ftenegger, and C. Rechberger. Exploring the Six Worlds of Gr&ouml;bner Basis Cryptanalysis: Application to Anemoi. Cryptology ePrint Archive, Paper 2024/250, 2024. <a href="https://eprint.iacr.org/2024/250" target="_blank" rel="noopener noreferrer">https://eprint.iacr.org/2024/250</a>.</p></li>
      <li><p class="text-gray-300">36. D. Lazard. Gr&ouml;bner bases, gaussian elimination and resolution of systems of algebraic equations. In J. A. van Hulzen, editor, <em>Computer Algebra</em>, pages 146&ndash;156, Berlin, Heidelberg, 1983. Springer Berlin Heidelberg.</p></li>
      <li><p class="text-gray-300">37. C. Lim and K. Khoo. An Analysis of XSL Applied to BES. In <em>FSE</em>, volume 4593 of <em>Lecture Notes in Computer Science</em>, pages 242&ndash;253. Springer, 2007.</p></li>
      <li><p class="text-gray-300">38. F. Liu, R. Anand, L. Wang, W. Meier, and T. Isobe. Coefficient Grouping: Breaking Chaghri and More. In <em>EUROCRYPT (4)</em>, volume 14007 of <em>Lecture Notes in Computer Science</em>, pages 287&ndash;317. Springer, 2023.</p></li>
      <li><p class="text-gray-300">39. F. Liu, M. Mahzoun, M. &Oslash;ygarden, and W. Meier. Algebraic Attacks on RAIN and AIM Using Equivalent Representations. <em>IACR Trans. Symmetric Cryptol.</em>, 2023(4):166&ndash;186, 2023.</p></li>
      <li><p class="text-gray-300">40. S. Murphy and M. J. B. Robshaw. Essential Algebraic Structure within the AES. In <em>CRYPTO</em>, volume 2442 of <em>Lecture Notes in Computer Science</em>, pages 1&ndash;16. Springer, 2002.</p></li>
      <li><p class="text-gray-300">41. V. Shoup. Factoring Polynomials over Finite Fields: Asymptotic Complexity vs. Reality. 1993.</p></li>
      <li><p class="text-gray-300">42. A. Szepieniec, T. Ashur, and S. Dhooghe. Rescue-Prime: a Standard Specification (SoK). Cryptology ePrint Archive, Paper 2020/1143, 2020. <a href="https://eprint.iacr.org/2020/1143" target="_blank" rel="noopener noreferrer">https://eprint.iacr.</a> <a href="https://eprint.iacr.org/2020/1143" target="_blank" rel="noopener noreferrer">org/2020/1143</a>.</p></li>
      <li><p class="text-gray-300">43. K. Zhang, Q. Wang, Y. Yu, C. Guo, and H. Cui. Algebraic Attacks on Round-Reduced Rain and Full AIM-III. In <em>ASIACRYPT (3)</em>, volume 14440 of <em>Lecture Notes in Computer Science</em>, pages 285&ndash;310. Springer, 2023.</p></li>
    </ul>

    <p class="text-gray-300">For the preimage attack on one block of r rounds of Friday, the attacker is given  <span class="math">(h_0, h_1)</span> , and the goal is to recover x such that  <span class="math">h_1 = Per(h_0) + x + h_0</span> . In the naive algebraic modelling method of [2], the intermediate variable  <span class="math">x_i</span>  is introduced to represent the input of C(x) at the i-th round. In this way, there is</p>

    <p class="text-gray-300"><span class="math">$(C(x_i) + k_i) \\cdot B(x_{i+1}) = 1.</span>$</p>

    <p class="text-gray-300">However, this model is inefficient as it requires to introduce too many variables  <span class="math">x_1, \\ldots, x_r</span> . To overcome this obstacle, they observed that</p>

    <p class="text-gray-300"><span class="math">$B(x_i) = \\frac{1}{C(x_{i-1}) + k_{i-1}}, \\quad C(x_i) = \\frac{1}{B(x_{i+1})} + k_i.</span>$</p>

    <p class="text-gray-300">In addition, they also proved that there always exist  <span class="math">\\mathbb{F}_2</span> -linearized affine polynomials</p>

    <p class="text-gray-300"><span class="math">$B&#x27;(x) = x^4 + b_2&#x27;x^2 + b_1&#x27;x + b_0&#x27;, \\quad C&#x27;(x) = x^4 + c_2&#x27;x^2 + c_1&#x27;x + c_0&#x27;</span>$</p>

    <p class="text-gray-300">such that</p>

    <p class="text-gray-300"><span class="math">$B&#x27;(B(x)) = C&#x27;(C(x)).</span>$</p>

    <p class="text-gray-300">This will result in the following equation:</p>

    <p class="text-gray-300">
<span class="math">$B&#x27;(\\frac{1}{C(x_{i-1}) + k_{i-1}}) = C&#x27;(\\frac{1}{B(x_{i+1})} + k_i), \\tag{23}</span>$</p>

    <p class="text-gray-300">which is of degree 36 by clearing all denominators.</p>

    <p class="text-gray-300">For convenience, let the total number of rounds r of Friday be an even number. Then, only the variables  <span class="math">x_2, x_4, \\dots, x_r</span>  are needed. In other words, there are  <span class="math">\\frac{r}{2}</span>  variables and  <span class="math">\\frac{r}{2}-1</span>  equations of degree 36 according to Equation 23. Moreover, to capture the relation inside the input and output of the compression function, an additional equation specified below is needed:</p>

    <p class="text-gray-300"><span class="math">$B(x_1) \\cdot (C(x_r) + k_r + h_1) = 1.</span>$</p>

    <p class="text-gray-300">To cancel  <span class="math">x_1</span> , the relation  <span class="math">C(x_1) = \\frac{1}{B(x_2)} + k_1</span>  can be used. Specifically, the following equation can be set up to cancel  <span class="math">x_1</span> :</p>

    <p class="text-gray-300"><span class="math">$B&#x27;(\\frac{1}{C(x_r) + k_r + h_1}) = C&#x27;(\\frac{1}{B(x_2)} + k_1),</span>$</p>

    <p class="text-gray-300">which is also of degree 36. In this way, finding the preimage of one block of Friday is reduced to solving  <span class="math">\\frac{r}{2}</span>  equations of degree 36 in  <span class="math">\\frac{r}{2}</span>  variables over  <span class="math">\\mathbb{F}_{2^{\\ell}}</span> .</p>

    <p class="text-gray-300">To compute the Gr&ouml;bner basis for polynomials</p>

    <p class="text-gray-300"><span class="math">$\\{f_1(x_1,\\ldots,x_n),\\ldots,f_m(x_1,\\ldots,x_n)\\}</span>$</p>

    <p class="text-gray-300">over  <span class="math">\\mathbb{F}_2</span> , the field equations,  <span class="math">x_i^2 = x_i</span>  for  <span class="math">\\forall i \\in [1, n]</span> , should also be considered. In our paper, for m quadratic Boolean equations in n Boolean variables, by including the n field equations, we indeed consider m+n polynomials  <span class="math">\\{f_1, \\ldots, f_m, f_{m+1}, \\ldots, f_{m+n}\\}</span>  where  <span class="math">f_{m+i} = x_i^2 - x_i</span>  for  <span class="math">i \\in [1, n]</span> , and estimate  <span class="math">D_{sol}</span>  as the first non-positive coefficient in the following Hilbert series:</p>

    <p class="text-gray-300"><span class="math">$\\frac{(1-z^2)^{m+n}}{(1-z)^n}.</span>$</p>

    <p class="text-gray-300">As explained before, this holds only when trivial syzygies are caused by  <span class="math">f_i \\cdot f_j = f_j \\cdot f_i</span>  where  <span class="math">i, j \\in [1, m+n]</span> . However, for polynomials over  <span class="math">\\mathbb{F}_2</span> , including the field equations implies new syzygies, i.e., there will be new syzygies caused by  <span class="math">f_i^2 = f_i</span>  for  <span class="math">i \\in [1, m]</span> . Hence, the assumption that only trivial syzygies exist for this polynomial system does not hold in practice. If taking such new syzygies into account, it has been studied in [6] that the solving degree to compute the Gr&ouml;bner basis of  <span class="math">\\{f_1, \\ldots, f_m\\}</span>  over  <span class="math">\\mathbb{F}_2</span>  can be estimated as the first non-positive coefficient in the following new Hilbert series:</p>

    <p class="text-gray-300"><span class="math">$\\frac{(1+z)^n}{(1+z^2)^m}.</span>$</p>

    <p class="text-gray-300">For convenience, we call the first method to compute  <span class="math">D_{sol}</span>  Method 1 where only trivial syzygies  <span class="math">f_i \\cdot f_j = f_j \\cdot f_i</span>  are considered and call the second method Method 2 where new syzygies formed by field equations are also considered. We tested the degree of regularity using both Method 1 and Method 2 for all n &lt; m &lt; 500 and observed that 1) the two methods give the same  <span class="math">D_{sol}</span>  when the system does not involve too many variables; 2) the difference between  <span class="math">D_{sol}</span>  obtained with the two methods tends to be the same if the system is much overdefined; 3) the gap is still small, i.e., 1 or 2, when the two methods give different  <span class="math">D_{sol}</span> . These may be evidence that the gap will be smaller as the system becomes much more overdefined. The difference of the degree of regularity for the two different methods is depicted in Figure 4. Additionally, We tested (m, n) for different parameters and the corresponding  <span class="math">D_{sol}</span>  computed with Method 1 and Method 2 are described in Table 10. Note that those in bold in Table 10 correspond to the parameters used to attack 3 and 4 rounds of RAIN.</p>

    <p class="text-gray-300">The motivation to explain the above fact is to analyze the impact of newly defined syzygy relations on the solving degree of the polynomial system, as in our constructed overdefined polynomial systems (not necessarily over  <span class="math">\\mathbb{F}_2</span> ), there are also many new syzygies. A natural question is when the estimated solving degree  <span class="math">D_{sol}</span>  based on the assumption that the system is semi-regular will be much larger than the actual solving degree. This is difficult to verify in practice</p>

    <p class="text-gray-300">    <img src="_page_32_Figure_0.jpeg" alt="" class="my-4 max-w-full" />
</p>

    <p class="text-gray-300"><strong>Fig. 4:</strong> The difference of <em>Dsol</em> using Method 1 and Method 2. The green points show a difference of 1, while the red points show a difference of 2. The white area represents the points with the same solving degree using both methods.</p>

    <p class="text-gray-300">as computing the actual solving degree is equivalent to computing the Gr&ouml;bner basis. By the above fact, we may see the evidence that even if there are some new syzygies, estimating the solving degree based on the assumption that the system is semi-regular is still reliable because the difference in the estimated solving degree using the semi-regularity assumption, and the actual solving degree of the system is small, or even zero, for the polynomial systems that we study.</p>

    <p class="text-gray-300"><strong>Table 10:</strong> Estimating <em>Dsol</em> with Method 1 and Method 2 for various (<em>m, n</em>).</p>

    <div class="overflow-x-auto my-4">
      <table class="min-w-full text-sm text-gray-300">
        <thead>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">n</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">m</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">m + n</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">Dsol</th>
            <th class="px-3 py-2 border-b border-gray-600 font-semibold text-left">Method 1 Method 2<br>Dsol</th>
        </thead>
        <tbody>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">128</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">128</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">256</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">17</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">17</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">128</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">192</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">320</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">13</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">13</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">128</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">256</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">384</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">11</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">11</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">256</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">256</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">512</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">29</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">30</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">256</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">384</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">640</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">22</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">23</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">256</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">512</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">768</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">19</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">19</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">384</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">384</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">768</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">41</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">42</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">384</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">768</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1152</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">26</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">26</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">384</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">2560</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">2944</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">11</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">11</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">512</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">512</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1024</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">52</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">54</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">512</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1024</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1536</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">33</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">33</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">512</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">3200</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">3712</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">15</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">15</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">576</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">576</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1152</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">58</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">60</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">576</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1152</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1728</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">37</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">37</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">576</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">3840</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">4416</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">15</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">15</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">768</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1536</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">2304</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">47</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">48</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">768</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">2304</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">3072</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">35</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">35</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">768</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">5120</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">5888</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">19</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">19</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">768</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">4800</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">5568</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">20</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">20</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1024</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">2048</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">3072</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">61</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">61</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1024</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">6144</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">7168</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">26</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">26</td>
          </tr>
          <tr>
            <td class="px-3 py-2 border-b border-gray-700 text-left"></td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">1024 6400</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">7424</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">25</td>
            <td class="px-3 py-2 border-b border-gray-700 text-left">26</td>
          </tr>
        </tbody>
      </table>
    </div>

    </section>
`;
---

<BaseLayout title="Modelling Ciphers with Overdefined Systems of Quadratic Equa... (2024/786)">
  <article class="max-w-4xl mx-auto article-prose">
    <nav class="mb-8">
      <a href="/papers" class="text-blue-400 hover:text-blue-300">
        &larr; Back to Papers
      </a>
    </nav>

    <header class="mb-12">
      <h1 class="text-3xl font-bold mb-4"
        set:html={TITLE_HTML} />
      <p class="text-gray-400 mb-2"
        set:html={AUTHORS_HTML} />
      <p class="text-gray-500 text-sm mb-4">
        2024 &middot; eprint 2024/786
      </p>
      <div class="flex gap-4 text-sm">
        <a
          href={EPRINT_URL}
          target="_blank"
          rel="noopener noreferrer"
          class="text-blue-400 hover:text-blue-300"
        >
          Paper (eprint) &rarr;
        </a>
      </div>
      <PaperDisclaimer eprintUrl={EPRINT_URL} />
      <p class="mt-1 text-xs text-gray-600">
        Converted with: {CRAWLER} &middot; {CONVERTED_DATE}
      </p>
    </header>

    <nav id="toc" class="mb-10 p-6 rounded-lg" style="background: rgba(255,255,255,0.03); border: 1px solid rgba(255,255,255,0.06);">
      <h2 class="text-lg font-bold mb-4">Table of Contents</h2>
      <ol class="space-y-1 text-sm text-gray-300
        list-decimal list-inside">
        <li><a href="#sec-1" class="hover:text-white">Introduction</a></li>
        <li><a href="#sec-2" class="hover:text-white">Preliminaries</a></li>
        <li>
          <a href="#sec-3" class="hover:text-white">Overdefined Systems of Quadratic Equations for AES</a>
          <ol class="ml-6 mt-1 space-y-1 list-decimal
            list-inside text-gray-400">
            <li><a href="#sec-3.1" class="hover:text-white">The AES Round Function</a></li>
            <li><a href="#sec-3.2" class="hover:text-white">Courtois-Pieprzyk&#x27;s Algebraic Modelling Method</a></li>
            <li><a href="#sec-3.3" class="hover:text-white">Murphy-Robshaw&#x27;s Algebraic Modelling Method</a></li>
          </ol>
        </li>
        <li>
          <a href="#sec-4" class="hover:text-white">New Algebraic Modelling Method for Friday</a>
          <ol class="ml-6 mt-1 space-y-1 list-decimal
            list-inside text-gray-400">
            <li><a href="#sec-4.1" class="hover:text-white">Description of Friday</a></li>
            <li><a href="#sec-4.2" class="hover:text-white">New Algebraic Modelling Method for Friday</a></li>
            <li><a href="#sec-4.3" class="hover:text-white">Comparison and Experiments</a></li>
          </ol>
        </li>
        <li>
          <a href="#sec-5" class="hover:text-white">New Algebraic Modelling Method for Vision</a>
          <ol class="ml-6 mt-1 space-y-1 list-decimal
            list-inside text-gray-400">
            <li><a href="#sec-5.1" class="hover:text-white">Description of the Unkeyed Vision Permutation</a></li>
            <li><a href="#sec-5.2" class="hover:text-white">Modelling Vision with a Polynomial System</a></li>
            <li><a href="#sec-5.3" class="hover:text-white">Overdefining the Polynomial System for Vision</a></li>
            <li><a href="#sec-5.4" class="hover:text-white">Complexity Analysis and Experiments</a></li>
          </ol>
        </li>
        <li>
          <a href="#sec-6" class="hover:text-white">Gr&ouml;bner Basis Attack on 3-Round RAIN</a>
          <ol class="ml-6 mt-1 space-y-1 list-decimal
            list-inside text-gray-400">
            <li><a href="#sec-6.1" class="hover:text-white">Description of 3-Round RAIN</a></li>
            <li><a href="#sec-6.2" class="hover:text-white">Direct Application of Existing Modelling Methods</a></li>
            <li><a href="#sec-6.3" class="hover:text-white">Finding More Quadratic Equations Exploiting the Structure</a></li>
            <li><a href="#sec-6.4" class="hover:text-white">Experiments and Discussions</a></li>
          </ol>
        </li>
        <li>
          <a href="#sec-7" class="hover:text-white">New Algebraic Modelling Method for Biscuit</a>
          <ol class="ml-6 mt-1 space-y-1 list-decimal
            list-inside text-gray-400">
            <li><a href="#sec-7.1" class="hover:text-white">New Insight into the PowAff2 Problem over \mathbb&#123;F&#125;_&#123;2^&#123;\ell&#125;&#125;</a></li>
          </ol>
        </li>
        <li><a href="#sec-8" class="hover:text-white">Conclusion</a></li>
      </ol>
      <p class="text-xs text-gray-500 mt-4 mb-1 font-semibold">
        Appendices
      </p>
      <ol class="space-y-1 text-sm text-gray-400
        list-[upper-alpha] list-inside">
        <li><a href="#app-a" class="hover:text-white">Direct Preimage Attack on Friday [2]</a></li>
        <li><a href="#app-b" class="hover:text-white">Computing Gr&ouml;bner Basis for Polynomials over \mathbb&#123;F&#125;_2</a></li>
      </ol>
      <p class="text-xs text-gray-500 mt-4 mb-1 font-semibold">
        Additional
      </p>
      <ul class="space-y-1 text-sm text-gray-400
        list-disc list-inside">
        <li><a href="#references" class="hover:text-white">References</a></li>
      </ul>
    </nav>


    <Fragment set:html={CONTENT} />

    <PaperHistory slug="modelling-ciphers-with-overdefined-systems-of-quadratic-2024" />
  </article>
</BaseLayout>
