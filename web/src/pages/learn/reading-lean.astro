---
import BaseLayout from '../../layouts/BaseLayout.astro';
import { LeanEditor } from '../../components/LeanEditor';
---

<BaseLayout title="Reading Lean Code">
  <div class="max-w-4xl mx-auto">
    <nav class="mb-8">
      <a href="/learn" class="text-blue-400 hover:text-blue-300"
        >← Back to Learn</a
      >
    </nav>

    <header class="mb-12">
      <h1 class="text-4xl font-bold mb-4">Reading Lean Code</h1>
      <p class="text-xl text-gray-300">
        Learn to read definitions and theorems in Lean 4. You'll understand the
        code on this site without writing anything yourself.
      </p>
    </header>

    <article class="prose-custom">
      <section class="mb-12">
        <h2 class="text-2xl font-bold mb-6">The Basics</h2>

        <p class="text-gray-300 mb-6 leading-relaxed">
          Lean code looks like a mix of mathematics and programming. Here's a
          simple example—a definition of what it means for a natural number to
          be even:
        </p>

        <pre
          class="bg-gray-800 p-4 rounded-lg overflow-x-auto mb-4"><code class="text-sm"><span class="text-purple-400">def</span> <span class="text-blue-300">isEven</span> (n : <span class="text-yellow-300">Nat</span>) : <span class="text-yellow-300">Prop</span> :=
  <span class="text-purple-400">∃</span> k, n = 2 * k</code></pre>

        <p class="text-gray-300 mb-6 leading-relaxed">Let's break this down:</p>

        <ul class="space-y-4 mb-8">
          <li class="flex gap-3">
            <code class="bg-gray-800 px-2 py-1 rounded text-purple-400 shrink-0"
              >def</code
            >
            <span class="text-gray-300">Introduces a new definition</span>
          </li>
          <li class="flex gap-3">
            <code class="bg-gray-800 px-2 py-1 rounded text-blue-300 shrink-0"
              >isEven</code
            >
            <span class="text-gray-300">The name we're defining</span>
          </li>
          <li class="flex gap-3">
            <code class="bg-gray-800 px-2 py-1 rounded shrink-0">(n : Nat)</code
            >
            <span class="text-gray-300"
              >Takes a parameter <code class="bg-gray-800 px-1 rounded">n</code> of
              type <code class="bg-gray-800 px-1 rounded">Nat</code> (natural number)</span
            >
          </li>
          <li class="flex gap-3">
            <code class="bg-gray-800 px-2 py-1 rounded text-yellow-300 shrink-0"
              >Prop</code
            >
            <span class="text-gray-300"
              >Returns a proposition (something that can be true or false)</span
            >
          </li>
          <li class="flex gap-3">
            <code class="bg-gray-800 px-2 py-1 rounded text-purple-400 shrink-0"
              >∃</code
            >
            <span class="text-gray-300"
              >"There exists" — the existential quantifier</span
            >
          </li>
        </ul>

        <div class="bg-blue-900/30 border border-blue-700 p-4 rounded-lg mb-8">
          <p class="text-blue-200">
            <strong>Reading tip:</strong> Read <code
              class="bg-gray-800 px-1 rounded">∃ k, n = 2 * k</code
            > as "there exists some k such that n equals 2 times k" — exactly the
            mathematical definition of even!
          </p>
        </div>
      </section>

      <section class="mb-12">
        <h2 class="text-2xl font-bold mb-6">Definitions vs Theorems</h2>

        <p class="text-gray-300 mb-6 leading-relaxed">
          Lean distinguishes between <strong class="text-white"
            >definitions</strong
          > (what things are) and
          <strong class="text-white">theorems</strong> (facts we can prove about them).
        </p>

        <h3 class="text-xl font-semibold mb-4">A Definition</h3>
        <pre
          class="bg-gray-800 p-4 rounded-lg overflow-x-auto mb-4"><code class="text-sm"><span class="text-gray-500">-- A group is a structure with an operation and identity</span>
<span class="text-purple-400">structure</span> <span class="text-blue-300">Group</span> (G : <span class="text-yellow-300">Type</span>) <span class="text-purple-400">where</span>
  mul : G → G → G        <span class="text-gray-500">-- multiplication operation</span>
  one : G                <span class="text-gray-500">-- identity element</span>
  inv : G → G            <span class="text-gray-500">-- inverse function</span>
  mul_assoc : <span class="text-purple-400">∀</span> a b c, mul (mul a b) c = mul a (mul b c)
  one_mul : <span class="text-purple-400">∀</span> a, mul one a = a
  mul_inv : <span class="text-purple-400">∀</span> a, mul (inv a) a = one</code></pre>

        <p class="text-gray-300 mb-6 leading-relaxed">
          This <code class="bg-gray-800 px-1 rounded">structure</code> bundles together
          the data (mul, one, inv) and the axioms (mul_assoc, one_mul, mul_inv) that
          make something a group.
        </p>

        <h3 class="text-xl font-semibold mb-4">A Theorem</h3>
        <pre
          class="bg-gray-800 p-4 rounded-lg overflow-x-auto mb-4"><code class="text-sm"><span class="text-purple-400">theorem</span> <span class="text-blue-300">even_plus_even</span> (m n : <span class="text-yellow-300">Nat</span>)
    (hm : isEven m) (hn : isEven n) : isEven (m + n) := <span class="text-purple-400">by</span>
  <span class="text-gray-500">-- proof goes here</span>
  sorry</code></pre>

        <p class="text-gray-300 mb-6 leading-relaxed">
          This says: if <code class="bg-gray-800 px-1 rounded">m</code> is even (we
          have proof <code class="bg-gray-800 px-1 rounded">hm</code>) and <code
            class="bg-gray-800 px-1 rounded">n</code
          > is even (proof <code class="bg-gray-800 px-1 rounded">hn</code>),
          then <code class="bg-gray-800 px-1 rounded">m + n</code> is also even.
        </p>
      </section>

      <section class="mb-12">
        <h2 class="text-2xl font-bold mb-6">Common Symbols</h2>

        <div class="overflow-x-auto">
          <table class="w-full">
            <thead>
              <tr class="border-b border-gray-700">
                <th class="text-left py-3 pr-4">Symbol</th>
                <th class="text-left py-3 pr-4">Name</th>
                <th class="text-left py-3">Meaning</th>
              </tr>
            </thead>
            <tbody class="text-gray-300">
              <tr class="border-b border-gray-800">
                <td class="py-3 pr-4"
                  ><code class="bg-gray-800 px-2 py-1 rounded">∀</code></td
                >
                <td class="py-3 pr-4">For all</td>
                <td class="py-3">"For every..." (universal quantifier)</td>
              </tr>
              <tr class="border-b border-gray-800">
                <td class="py-3 pr-4"
                  ><code class="bg-gray-800 px-2 py-1 rounded">∃</code></td
                >
                <td class="py-3 pr-4">Exists</td>
                <td class="py-3">"There exists..." (existential quantifier)</td>
              </tr>
              <tr class="border-b border-gray-800">
                <td class="py-3 pr-4"
                  ><code class="bg-gray-800 px-2 py-1 rounded">→</code></td
                >
                <td class="py-3 pr-4">Arrow</td>
                <td class="py-3">Function type or "implies"</td>
              </tr>
              <tr class="border-b border-gray-800">
                <td class="py-3 pr-4"
                  ><code class="bg-gray-800 px-2 py-1 rounded">↔</code></td
                >
                <td class="py-3 pr-4">Iff</td>
                <td class="py-3">"If and only if"</td>
              </tr>
              <tr class="border-b border-gray-800">
                <td class="py-3 pr-4"
                  ><code class="bg-gray-800 px-2 py-1 rounded">∧</code></td
                >
                <td class="py-3 pr-4">And</td>
                <td class="py-3">Logical conjunction</td>
              </tr>
              <tr class="border-b border-gray-800">
                <td class="py-3 pr-4"
                  ><code class="bg-gray-800 px-2 py-1 rounded">∨</code></td
                >
                <td class="py-3 pr-4">Or</td>
                <td class="py-3">Logical disjunction</td>
              </tr>
              <tr class="border-b border-gray-800">
                <td class="py-3 pr-4"
                  ><code class="bg-gray-800 px-2 py-1 rounded">¬</code></td
                >
                <td class="py-3 pr-4">Not</td>
                <td class="py-3">Logical negation</td>
              </tr>
              <tr class="border-b border-gray-800">
                <td class="py-3 pr-4"
                  ><code class="bg-gray-800 px-2 py-1 rounded">:=</code></td
                >
                <td class="py-3 pr-4">Defined as</td>
                <td class="py-3">Definition assignment</td>
              </tr>
              <tr>
                <td class="py-3 pr-4"
                  ><code class="bg-gray-800 px-2 py-1 rounded">by</code></td
                >
                <td class="py-3 pr-4">By</td>
                <td class="py-3">Start a tactic proof</td>
              </tr>
            </tbody>
          </table>
        </div>
      </section>

      <section class="mb-12">
        <h2 class="text-2xl font-bold mb-6">Reading a Real Example</h2>

        <p class="text-gray-300 mb-6 leading-relaxed">
          Here's an example from our cryptography library—the definition of a
          commitment scheme:
        </p>

        <pre
          class="bg-gray-800 p-4 rounded-lg overflow-x-auto mb-6"><code class="text-sm"><span class="text-purple-400">structure</span> <span class="text-blue-300">CommitmentScheme</span> (M R C : <span class="text-yellow-300">Type</span>) <span class="text-purple-400">where</span>
  <span class="text-gray-500">-- Commit takes a message and randomness, returns a commitment</span>
  commit : M → R → C

  <span class="text-gray-500">-- Opening reveals the message</span>
  open : C → R → M

  <span class="text-gray-500">-- Correctness: opening a commitment reveals the original message</span>
  correctness : <span class="text-purple-400">∀</span> (m : M) (r : R),
    open (commit m r) r = m</code></pre>

        <p class="text-gray-300 mb-6 leading-relaxed">Reading this:</p>

        <ul class="list-disc list-inside space-y-2 text-gray-300 mb-6">
          <li>
            <code class="bg-gray-800 px-1 rounded">M</code> is the message type
          </li>
          <li>
            <code class="bg-gray-800 px-1 rounded">R</code> is the randomness type
          </li>
          <li>
            <code class="bg-gray-800 px-1 rounded">C</code> is the commitment type
          </li>
          <li>
            <code class="bg-gray-800 px-1 rounded">commit</code> takes a message and
            randomness, produces a commitment
          </li>
          <li>
            <code class="bg-gray-800 px-1 rounded">open</code> takes a commitment
            and randomness, reveals the message
          </li>
          <li>
            <code class="bg-gray-800 px-1 rounded">correctness</code> states that
            the scheme works: opening always gives back the original
          </li>
        </ul>

        <div class="bg-green-900/30 border border-green-700 p-4 rounded-lg">
          <p class="text-green-200">
            <strong>Key insight:</strong> The structure bundles the <em
              >operations</em
            > (commit, open) with the <em>properties</em> (correctness) they must
            satisfy. This is how we formally specify what a commitment scheme <em
              >is</em
            >.
          </p>
        </div>
      </section>

      <section class="mb-12">
        <h2 class="text-2xl font-bold mb-6">Try It Yourself</h2>

        <p class="text-gray-300 mb-6 leading-relaxed">
          Here's a live Lean editor. Try modifying the code and see what
          happens:
        </p>

        <LeanEditor
          client:load
          code={`-- Try defining your own predicate!
def isEven (n : Nat) : Prop :=
  ∃ k, n = 2 * k

-- Check what type isEven 4 has
#check isEven 4

-- You can evaluate expressions too
#eval 2 + 2`}
          height="300px"
        />

        <p class="text-gray-400 text-sm mt-4">
          The Lean server runs remotely. Changes you make are evaluated in
          real-time.
        </p>
      </section>

      <section class="mb-12">
        <h2 class="text-2xl font-bold mb-6">Next Steps</h2>

        <p class="text-gray-300 mb-6 leading-relaxed">
          You can now read basic Lean definitions! Continue to:
        </p>

        <a
          href="/learn/types-and-terms"
          class="inline-block bg-blue-500 hover:bg-blue-400 text-white px-6 py-3 rounded-lg font-semibold transition-all"
        >
          Next: Types and Terms →
        </a>
      </section>
    </article>
  </div>
</BaseLayout>
