---
import BaseLayout from '../layouts/BaseLayout.astro';
---

<BaseLayout title="Setup">
  <div class="max-w-4xl mx-auto prose prose-invert">
    <h1>Development Setup</h1>

    <p class="lead text-xl text-gray-300">
      Get your environment ready to explore and contribute to Cryptography Academy.
    </p>

    <h2>Prerequisites</h2>

    <ul>
      <li>macOS, Linux, or WSL on Windows</li>
      <li>Node.js 24+ (for the website)</li>
      <li>Git</li>
    </ul>

    <h2>1. Install Lean 4</h2>

    <p>Install <strong>elan</strong>, the Lean version manager:</p>

    <pre><code>curl https://elan.lean-lang.org/elan-init.sh -sSf | sh</code></pre>

    <p>Restart your terminal, then verify:</p>

    <pre><code>elan --version
lean --version</code></pre>

    <h2>2. Clone the Repository</h2>

    <pre><code>git clone https://github.com/cryptographyacademy/cryptographyacademy.github.io.git
cd cryptographyacademy.github.io</code></pre>

    <h2>3. Setup Dependencies</h2>

    <pre><code>make setup</code></pre>

    <p>This will:</p>
    <ul>
      <li>Download Mathlib4 and cache</li>
      <li>Install npm dependencies for the website</li>
    </ul>

    <h2>4. Build Everything</h2>

    <pre><code>make build</code></pre>

    <h2>5. Start Development Server</h2>

    <pre><code>make serve</code></pre>

    <p>Open <a href="http://localhost:4321">http://localhost:4321</a> in your browser.</p>

    <h2>Editor Setup</h2>

    <h3>VS Code (Recommended)</h3>

    <ol>
      <li>Install the <strong>lean4</strong> extension (ID: <code>leanprover.lean4</code>)</li>
      <li>Open the <code>lean/</code> folder in VS Code</li>
      <li>Wait for the Lean server to start</li>
    </ol>

    <h3>Neovim</h3>

    <p>Use <a href="https://github.com/neovim/nvim-lspconfig">nvim-lspconfig</a> with the Lean 4 LSP:</p>

    <pre><code>-- In your init.lua
require('lspconfig').lean4.setup{}</code></pre>

    <h3>Emacs</h3>

    <p>Install <a href="https://github.com/leanprover-community/lean4-mode">lean4-mode</a>:</p>

    <pre><code>;; In your init.el
(use-package lean4-mode
  :straight (lean4-mode
             :type git
             :host github
             :repo "leanprover-community/lean4-mode"))</code></pre>

    <h2>Available Commands</h2>

    <table class="w-full">
      <thead>
        <tr>
          <th class="text-left">Command</th>
          <th class="text-left">Description</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td><code>make help</code></td>
          <td>Show all available commands</td>
        </tr>
        <tr>
          <td><code>make build</code></td>
          <td>Build Lean proofs and website</td>
        </tr>
        <tr>
          <td><code>make serve</code></td>
          <td>Start development server</td>
        </tr>
        <tr>
          <td><code>make test</code></td>
          <td>Run all tests</td>
        </tr>
        <tr>
          <td><code>make lint</code></td>
          <td>Run linters</td>
        </tr>
        <tr>
          <td><code>make format</code></td>
          <td>Format code</td>
        </tr>
        <tr>
          <td><code>make clean</code></td>
          <td>Clean build artifacts</td>
        </tr>
      </tbody>
    </table>

    <h2>Troubleshooting</h2>

    <h3>Mathlib cache download is slow</h3>

    <p>The initial Mathlib download can take time. The cache is stored in <code>lean/.lake/</code>.</p>

    <h3>Lean server not starting</h3>

    <p>Make sure you're opening the <code>lean/</code> directory, not the project root.
    The <code>lakefile.toml</code> must be in the root of the opened folder.</p>

    <h3>Need more help?</h3>

    <p>
      <a href="https://github.com/cryptographyacademy/cryptographyacademy.github.io/issues">
        Open an issue on GitHub
      </a>
    </p>
  </div>
</BaseLayout>
